var xmjd=mstrmojo&&mstrmojo.descriptors;var mstrmojo={descriptors:xmjd||{},meta:{TP:"t",STP:"st"},emptyFn:function(){},tstid:function(B){var A;if(B){if(typeof (B)==="object"){A=B.tstid;}else{A=B;}}return A?'tstid="'+A+'"':"";},getMissingFn:function getMissingFn(){return function(){var C=this.scriptClass,A;try{for(A in this){if(this[A]===arguments.callee){C+="."+A;break;}}}catch(B){}throw new Error("Missing abstract method: "+C);};},now:function now(){return new Date().getTime();},usesFrames:false};(function(){mstrmojo.global=(function(){var F=function(){return this;};return F.call(null);}());mstrmojo.dbg=mstrmojo.emptyFn;mstrmojo.dbg_stack=mstrmojo.emptyFn;mstrmojo.dbg_xhr=mstrmojo.emptyFn;mstrmojo.dbg_profile=mstrmojo.emptyFn;mstrmojo.debugBundles=(function(){return(window.mstrConfig&&(mstrConfig.debugFlags!==undefined)&&((mstrConfig.debugFlags&4)>0));})();mstrmojo.platform={};mstrmojo.prompt={};mstrmojo.settings={};mstrmojo.models={datasets:{},template:{}};mstrmojo.ui={editors:{controls:{}},menus:{},pathbar:{}};mstrmojo.prefs={};mstrmojo.ACL={};mstrmojo.CMS={};mstrmojo.storage={};mstrmojo.maps={};mstrmojo.maps.androidmap={};mstrmojo.maps.jsmap={};mstrmojo.graph={};mstrmojo.IPA={};mstrmojo.IPA.Monitors={};mstrmojo.IPA.Alerts={};mstrmojo.IPA.Environment={};mstrmojo.IPA.Groups={};mstrmojo.IPA.Heartbeat={};mstrmojo.IPA.Managers={};mstrmojo.sm={};mstrmojo.sort={};mstrmojo.ME={};mstrmojo.architect={ui:{editors:{},panels:{},factories:{}},obj:{},menu:{},projectmanagement:{}};mstrmojo.warehouse={ui:{editors:{}},obj:{},dbroles:{},menu:{}};mstrmojo.plugins={};mstrmojo.gmaps={};mstrmojo.DI={controller:{},model:{},ui:{dialogs:{}}};mstrmojo.Refine={};mstrmojo.qb={bigquery:{},es:{},mdx:{},menu:{},thirdParty:{}};mstrmojo.WH={};mstrmojo.fe={};mstrmojo.txEditor={};mstrmojo.condTx={};mstrmojo.threshold={};mstrmojo.express={ui:{}};mstrmojo.rw={model:{},xtab:{}};mstrmojo.util={ui:{}};mstrmojo.android={controllers:{},factories:{},inputControls:{},large:{controllers:{},factories:{},ui:{}},medium:{controllers:{},factories:{},ui:{nativebar:{}}},selectors:{},ui:{},nativedialog:{}};mstrmojo.vi={controllers:{},factories:{},models:{editors:{}},enums:{},ui:{menus:{},editors:{},rw:{selectors:{},xtab:{}},tabs:{},toolbars:{},tutorial:{}},viz:{},util:{}};mstrmojo.onetier={controllers:{},vi:{acl:{},prefs:{model:{}},ui:{tutorial:{}}}};mstrmojo.config={vi:{},onetier:{}};mstrmojo.chart={common:{},enums:{},model:{enums:{}}};mstrmojo.gm={};mstrmojo.heatmap={vi:{}};mstrmojo.netviz={};mstrmojo.imagelayout={};mstrmojo.iphone={};mstrmojo.winphone={};mstrmojo.mstr={search:{}};mstrmojo.mstr.ui={};mstrmojo.gmaps={};mstrmojo.esrimap={};mstrmojo.examples={};mstrmojo.home={controllers:{},models:{},views:{},ui:{}};mstrmojo.err=function D(H){var G=H.name+': "'+H.message+'"';if(mstrmojo.debug){if(H.fileName){G+=" at\n    "+H.fileName;}if(H.hasOwnProperty("lineNumber")){G+=": "+H.lineNumber;}else{if(H.hasOwnProperty("line")&&H.sourceURL){var F=H.sourceURL.split("/");G+="("+F[F.length>1?F.length-1:0]+":"+H.line+")";}}}this.dbg(G);if(mstrmojo.Dialog){mstrmojo.error({longDesc:H.message},null,{title:H.name});}else{window.alert(G);}};mstrmojo.confirm=function B(F){return window.confirm(F);};mstrmojo.alert=function E(F){window.alert(F);};var C=!!(/return true/.test(String(function(){return true;})));mstrmojo.mixin=function A(J,H){if(J){H=H||{};var I=/this\.\_super/;var G=function(N,M){return function L(){var P=this._super;this._super=M;var O=N.apply(this,arguments||[]);this._super=P;return O;};};var F=J.__onmixin__;if(F){delete J.__onmixin__;}var K;for(K in J){if((typeof J[K]==="function")&&(!C||I.test(J[K]))){H[K]=G(J[K],H[K]);}else{H[K]=J[K];}}if(F){J.__onmixin__=F;}}return H;};}());(function(){var $XHR;var $MISSING={};var getApp=function(){return mstrmojo.global.mstrApp||{};},getJsRoot=function(){return getApp().jsRoot||"../javascript/";},getJsBundlesRoot=function(){return getJsRoot()+"bundles/";},getJsMojoRoot=function(){return getApp().jsMojoRoot||"../javascript/mojo/js/source/";},isIE=!!document.all;function getXHR(){$XHR=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){if(params.hasOwnProperty(p)){url[++x]=p+"="+encodeURIComponent(params[p]);}}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function syncXHR(method,baseUrl,params){var result=null;method=method.toUpperCase();if(!$XHR){getXHR();}if($XHR){try{var m=null,app=window.mstrApp;if(window.microstrategy!==undefined&&microstrategy){m=microstrategy;}params.taskContentType=params.taskContentType||"json";params.taskEnv="xhr";params.xts=mstrmojo.now();params=mstrmojo.addCSRFTokenToTaskParams(params);var ptp=(app&&app.persistTaskParams)||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}$XHR.open(method,appendUrlParams(method,baseUrl,params),false);if(method!=="POST"){params=null;}else{params=encodeParams(params);$XHR.setRequestHeader("Content-type","application/x-www-form-urlencoded");}$XHR.send(params);result=$XHR.responseText||null;}catch(localerr){if(window.console){window.console.log(localerr);}}}return result;}function _jsGet(file,nullCheck){var js=mstrmojo.loadFileSync(file);if(js){try{eval(js);return nullCheck?!!eval(nullCheck):true;}catch(localerr){window.alert("JavaScript compile error:\n\nFile: "+file+"\n\nError: "+localerr.message);}}return false;}mstrmojo.requiresBundle=function reqBundle(bundleName){return _jsGet(getJsBundlesRoot()+bundleName);};mstrmojo.loadFileSync=function loadFileSync(file){var result=null;if(!$XHR){getXHR();}if($XHR){try{$XHR.open("GET",file+((window.mstrConfig&&mstrConfig.webVersion)?"?v="+mstrConfig.webVersion:""),false);$XHR.send(null);result=$XHR.responseText||null;}catch(localerr){}if(!isIE&&$XHR.abort){$XHR.abort();}}return result;};mstrmojo.insertCSSLinks=function insertCSSLinks(files){var css,firsthead;if(files&&files.length>0){firsthead=document.getElementsByTagName("head")[0];files.forEach(function(file){css=document.createElement("link");css.setAttribute("id",file.replace(/[^a-zA-Z0-9]/g,""));css.setAttribute("rel","stylesheet");css.setAttribute("type","text/css");css.setAttribute("href",file);firsthead.appendChild(css);});}};mstrmojo.loader={loaded:{mstrmojo:true,"mstrmojo.loader":true},isLoaded:function isLd(fqcn){var o;try{o=eval(fqcn);}catch(localerr){}if(o){this.loaded[fqcn]=true;}return !!o;},load:function ld(fqcn){if($MISSING[fqcn]){return false;}if(this.loaded[fqcn]||this.isLoaded(fqcn)){return true;}if(_jsGet(this.fqcnToFile(fqcn),fqcn)){this.loaded[fqcn]=true;return true;}$MISSING[fqcn]=true;return false;},fqcnToFile:function fqcnToFile(fqcn){if(fqcn.match(/^mstrmojo\.plugins\./)){var pluginName=fqcn.substring(17,fqcn.indexOf(".",17));fqcn="../plugins/"+pluginName+"/javascript/"+getJsMojoRoot()+fqcn.replace("mstrmojo.plugins."+pluginName+".","").replace(/\./gm,"/");}else{if(fqcn.match(/^mstrmojo\./)){fqcn=getJsMojoRoot()+fqcn.replace("mstrmojo.","").replace(/\./gm,"/");}else{fqcn=getJsRoot()+fqcn.replace(/\./gm,"/");}}return fqcn+".js";}};var $LOADER=mstrmojo.loader,isLoaded=$LOADER.loaded;var reqCache={},addPackagesToReqCache=function addPkg(n,ns){var ps=n.split("."),klen=ps.length,k;for(k=1;k<klen;k++){var s=ps.slice(0,k).join(".");if(!reqCache[s]){ns.push(s);reqCache[s]=true;}}},loadInputScripts=function loadInputScripts(ns){var jlen=ns.length,j;for(j=0;j<jlen;j++){if(!$LOADER.load(ns[j])){window.alert("Warning: Javascript class not found:\n"+ns[j]);break;}}};mstrmojo.requiresCls=function reqCls(){var argLen=arguments.length,ns=[],i,len;for(i=0,len=argLen;i<len;i++){var n=arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){addPackagesToReqCache(n,ns);}ns.push(n);reqCache[n]=true;}loadInputScripts(ns);return true;};mstrmojo.requiresClsP=function reqClsP(){var argLen=arguments.length,ns=[],pkgName=arguments[0],i,len;addPackagesToReqCache(pkgName,ns);for(i=1,len=argLen;i<len;i++){var n=pkgName+"."+arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){ns.push(n);reqCache[n]=true;}}loadInputScripts(ns);return true;};var $DESCRIPTORS=mstrmojo.descriptors,descPrefix="mstrWeb.";function populateDescriptors(ds){if(ds){var dlen=ds.length,di;for(di=0;di<dlen;di++){var d=ds[di];$DESCRIPTORS[d.key]=d.v;}}}mstrmojo.populateDescriptors=populateDescriptors;if(window.mstrConfig!==undefined){populateDescriptors(mstrConfig.mstrDescs&&mstrConfig.mstrDescs.descriptors);mstrConfig.mstrDescs=null;}if(window.mstrApp!==undefined){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}var requestDescriptor=function(prefix,ids){var ns=[],len=ids.length,i;for(i=0;i<len;i++){var k=ids[i];if(k&&!($DESCRIPTORS.hasOwnProperty(prefix+k))){ns.push(k);}}if(ns.length>0){var response=syncXHR("POST",(window.mstrConfig&&mstrConfig.taskURL)||"taskProc",{taskId:"getDescriptors",keys:ns.join(","),prefix:prefix});if(response){var r=eval("("+response+")");populateDescriptors(r&&r.descriptors);}}};mstrmojo.requiresDescsWPrefix=function reqDescP(prefix){var args=[].slice.call(arguments);args[0]=null;requestDescriptor(prefix,args);};mstrmojo.requiresDescs=function reqDesc(){if(window.mstrConfig!==undefined&&!mstrConfig.onMobileDevice){requestDescriptor(descPrefix,arguments);}};mstrmojo.desc=function desc(descID,defText){if(descID!==null&&descID!==undefined){mstrmojo.requiresDescs(descID);if($DESCRIPTORS.hasOwnProperty(descPrefix+descID)){return $DESCRIPTORS[descPrefix+descID];}defText=defText||"No string descriptor found for descID="+descID;}var decDefText="["+defText+"]";$DESCRIPTORS[descPrefix+descID]=decDefText;return decDefText;};mstrmojo.descP=function descP(prefix,descID,defText){mstrmojo.requiresDescsWPrefix(prefix,descID);if($DESCRIPTORS.hasOwnProperty(prefix+descID)){return $DESCRIPTORS[prefix+descID];}defText=defText||"No string descriptor found for descID="+descID;var decDefText="*"+defText+"*";$DESCRIPTORS[prefix+descID]=decDefText;return decDefText;};mstrmojo.provide=function prv(fqcn,cls){isLoaded[fqcn]=!!cls;return cls;};mstrmojo.invalidateCls=function rel(fqcn){reqCache[fqcn]=false;isLoaded[fqcn]=false;eval(fqcn+" = null");};var mx=mstrmojo.mixin;mstrmojo.declare=function declare(SuperCls,mixins,config){function Constr(props){if((!props||!props.dontInit)&&this.init){this.init(props);}}if(SuperCls){Constr.prototype=new SuperCls({dontInit:true});Constr.prototype.constructor=Constr;}var proto=Constr.prototype;var cnt=(mixins&&mixins.length)||0,i;for(i=0;i<cnt;i++){mx(mixins[i],proto);}if(config){mx(config,proto);if(config.scriptClass){isLoaded[config.scriptClass]=true;}}return Constr;};mstrmojo.findAncestor=function findAncestor(src,property,value,limitClass){var ancestor=src&&src.parent;while(ancestor&&(!limitClass||!(ancestor instanceof limitClass))){var targetProperty=ancestor[property];if(targetProperty!==undefined){if(value!==undefined&&value!==null){if(targetProperty===value){return ancestor;}}else{return ancestor;}}ancestor=ancestor.parent;}return null;};mstrmojo.isDescendant=function isDescendant(parent,child){var ancestor;if(!child||!parent){return false;}ancestor=child.parent;while(ancestor){if(ancestor===parent){return true;}ancestor=ancestor.parent;}return false;};mstrmojo.getCSRFToken=function getCSRFToken(url){var tkn=null;try{if(url){if(url.indexOf("validateRandNum=")>=0){return tkn;}if(this.isUrlExternal(url)){return tkn;}}if(window.mstrApp&&mstrApp.validateRandNum){tkn=mstrApp.validateRandNum;}else{if(window.mstrConfig&&mstrConfig.validateRandNum){tkn=mstrConfig.validateRandNum;}else{if(window.microstrategy!==undefined&&microstrategy&&microstrategy.validateRandNum){tkn=microstrategy.validateRandNum;}}}}catch(err){}return tkn;};mstrmojo.addCSRFTokenToURL=function addCSRFTknToURL(url){if(!url){return"";}var tkn=mstrmojo.getCSRFToken(url);if(tkn&&tkn.length>0){if(url.indexOf("?")>-1){url+="&";}else{url+="?";}url+="validateRandNum="+tkn;}return url;};mstrmojo.addCSRFTokenToTaskParams=function addCSRFTknToTaskParams(params){if(params){var tkn=mstrmojo.getCSRFToken();if(tkn&&tkn.length>0){params.validateRandNum=tkn;}}return params;};mstrmojo.getInstance=function getInstance(config){var Clazz=mstrmojo.hash.walk(config.scriptClass,window);if(Clazz){return new Clazz(config);}return null;};mstrmojo.isUrlExternal=function isUrlExternal(url){var curURL=window.location.href;var servletName=window.mstrApp&&mstrApp.name,taskProcName=window.mstrConfig.taskURL&&mstrConfig.taskURL,isSameWebApp=(url.indexOf("?")===0||url.indexOf(servletName)===0||url.indexOf("./"+servletName)===0||url.indexOf(taskProcName)===0||url.indexOf("./"+taskProcName)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));return !isSameWebApp;};mstrmojo.resolveFeature=function resolveFeature(feature){var features=mstrApp.features;return features&&features[feature];};mstrmojo.getStyleRoot=function getStyleRoot(){var c=mstrConfig||{},styleRoot=c.styleRoot||"../style";return styleRoot;};}());mstrmojo.mstr.EnumDSSXMLTokenStates={Error:-1,Reserved:0,Initial:1,Okay:2};(function(){function B(J,E){if(!E.domNode){return 0;}var K="_fixed"+J;if(E[K]){return E[K];}var H=E.getFormats(),I=J.toLowerCase();if(H&&H.hasOwnProperty(I)){var F=H[I];if(F.charAt(F.length-1)!=="%"){var G=parseInt(F,10);if(!isNaN(G)){E[K]=G;return G;}}}return(E.domNode["client"+J]||0);}mstrmojo._ContainsDocObjects=mstrmojo.provide("mstrmojo._ContainsDocObjects",{getHeight:function D(){return B("Height",this);},getWidth:function A(){return B("Width",this);},getMaxZIndex:function C(){var F=0;mstrmojo.array.forEach(this.children,function E(G){F=Math.max(F,G.getFormats()["z-index"]);});return F;}});}());(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}if(D.visible){return this._super(D);}var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});}());mstrmojo.requiresDescs(5547,5217,5218,5219,5220,5221);var EnumWebPromptsList=[{n:"Hierarchy Qualification Prompt",desc:"Hierarchy Qualification prompt",descId:5547,value:"editPrompt",name:"hierarchyPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:16}},{n:"Attribute Qualification Prompt",desc:"Attribute Qualification prompt",descId:5217,name:"aqPrompt",value:"editPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:17}},{n:"Attribute Element List",desc:"Att Element List prompt",descId:5218,value:"editPrompt",name:"attributePrompt",params:{evt:3004,target:"editPrompt",promptType:2}},{n:"Metric Qualification Prompt",desc:"Metric Qualification prompt",descId:5219,value:"editPrompt",name:"mqPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:10}},{n:"Object Prompt",desc:"Object",descId:5220,value:"editPrompt",name:"objectPrompt",params:{evt:3004,target:"editPrompt",promptType:4,}},{n:"Value Prompt",desc:"Value",descId:5221,value:"editPrompt",name:"valuePrompt",params:{evt:3004,target:"editPrompt",promptType:1,constDataType:14}}];mstrmojo.mstr.ui.EnumWebPromptsList={get:function(){var A=mstrApp.servletName||mstrApp.name;return mstrmojo.array.map(EnumWebPromptsList,function(B){B.src=A+B.evt;return B;});}};mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};(function(){mstrmojo.requiresDescs(5774,2266,2287,2496,2495,2493,2267,2498,2500,2279,2491,2476,2271,2478,2268,2492,2273,2280,2490,2488,2494,2487,2269,2477,2499,2292,2489,2281,2484,2483,2480,2497,2274,2485,2486,2282,2481,2479,2482,2290,2293);var A=[{n:mstrmojo.desc(5774,"No Fill"),id:"transparent"},{n:mstrmojo.desc(2266,"Black"),id:"#000000"},{n:mstrmojo.desc(2287,"Brown"),id:"#993300"},{n:mstrmojo.desc(2496,"Olive Green"),id:"#333300"},{n:mstrmojo.desc(2495,"Dark Green"),id:"#003300"},{n:mstrmojo.desc(2493,"Dark Teal"),id:"#003366"},{n:mstrmojo.desc(2267,"Dark Blue"),id:"#000080"},{n:mstrmojo.desc(2498,"Indigo"),id:"#333399"},{n:mstrmojo.desc(2500,"Grey-80%"),id:"#333333"},{n:mstrmojo.desc(2279,"Dark Red"),id:"#800000"},{n:mstrmojo.desc(2491,"Orange"),id:"#ff6600"},{n:mstrmojo.desc(2476,"Dark Yellow"),id:"#808000"},{n:mstrmojo.desc(2271,"Green"),id:"#008000"},{n:mstrmojo.desc(2478,"Teal"),id:"#008080"},{n:mstrmojo.desc(2268,"Blue"),id:"#0000ff"},{n:mstrmojo.desc(2492,"Blue-Grey"),id:"#666699"},{n:mstrmojo.desc(2273,"Grey-50%"),id:"#808080"},{n:mstrmojo.desc(2280,"Red"),id:"#ff0000"},{n:mstrmojo.desc(2490,"Light Orange"),id:"#ff9900"},{n:mstrmojo.desc(2488,"Lime"),id:"#99cc00"},{n:mstrmojo.desc(2494,"Sea Green"),id:"#339966"},{n:mstrmojo.desc(2487,"Aqua"),id:"#33cccc"},{n:mstrmojo.desc(2269,"Light Blue"),id:"#3366ff"},{n:mstrmojo.desc(2477,"Violet"),id:"#800080"},{n:mstrmojo.desc(2499,"Grey-40%"),id:"#969696"},{n:mstrmojo.desc(2292,"Pink"),id:"#ff00ff"},{n:mstrmojo.desc(2489,"Gold"),id:"#ffcc00"},{n:mstrmojo.desc(2281,"Yellow"),id:"#ffff00"},{n:mstrmojo.desc(2484,"Bright Green"),id:"#00ff00"},{n:mstrmojo.desc(2483,"Turquoise"),id:"#00ffff"},{n:mstrmojo.desc(2480,"Sky Blue"),id:"#00ccff"},{n:mstrmojo.desc(2497,"Plum"),id:"#993366"},{n:mstrmojo.desc(2274,"Grey-25%"),id:"#c0c0c0"},{n:mstrmojo.desc(2485,"Rose"),id:"#ff99cc"},{n:mstrmojo.desc(2486,"Tan"),id:"#ffcc99"},{n:mstrmojo.desc(2282,"Light Yellow"),id:"#ffff99"},{n:mstrmojo.desc(2481,"Light Green"),id:"#ccffcc"},{n:mstrmojo.desc(2479,"Light Turquoise"),id:"#ccffff"},{n:mstrmojo.desc(2482,"Pale Blue"),id:"#99ccff"},{n:mstrmojo.desc(2290,"Lavender"),id:"#cc99ff"},{n:mstrmojo.desc(2293,"White"),id:"#ffffff"}];var E=[];mstrmojo.util.ui.ColorPicker={getBasicColors:function B(){return A.slice();},getCustomColors:function D(){return E.slice();},addCustomColor:function C(G){var F=function(H){return H.id===G;};if(!A.filter(F)[0]&&!E.filter(F)[0]){E.push({n:G,id:G});if(E.length>8){E.shift();}}}};}());(function(){var B=1,C=2,A=4;mstrmojo._IsThresholdConditionTarget=mstrmojo.provide("mstrmojo._IsThresholdConditionTarget",{_mixinName:"mstrmojo._IsThresholdConditionTarget",update:function D(G){var E=G.data.tta;var F=(E&B)>0,H=(E&C)>0;if(F&&this.preservedEnabled===undefined){this.preservedEnabled=!!this.enabled;}if(H&&this.preservedVisible===undefined){this.preservedVisible=!!this.visible;}this.set("enabled",F?false:this.preservedEnabled!==undefined?this.preservedEnabled:this.enabled);this.set("visible",H?false:this.preservedVisible!==undefined?this.preservedVisible:this.visible);this.set("required",(E&A)>0);if(this._super){this._super(G);}}});}());mstrmojo.mstr.EnumDataType={DataTypeUnknown:-1,DataTypeReserved:0,DataTypeInteger:1,DataTypeUnsigned:2,DataTypeNumeric:3,DataTypeDecimal:4,DataTypeReal:5,DataTypeDouble:6,DataTypeFloat:7,DataTypeChar:8,DataTypeVarChar:9,DataTypeLongVarChar:10,DataTypeBinary:11,DataTypeVarBin:12,DataTypeLongVarBin:13,DataTypeDate:14,DataTypeTime:15,DataTypeTimeStamp:16,DataTypeShort:21,DataTypeLong:22,DataTypeMBChar:23,DataTypeBool:24,DataTypePattern:25,DataTypeBigDecimal:30,DataTypeCellFormatData:31,DataTypeInt64:34};(function(){mstrmojo._Fetchable=mstrmojo.provide("mstrmojo._Fetchable",{_mixinName:"mstrmojo._Fetchable",blockBegin:1,blockCount:-1,concat:false,items:null,size:function A(){var B=this.items;return(B&&B.length)||0;},next:function(B){if(this.hasNext()){this.getItems(this.blockBegin+this.blockCount,B);}},previous:function(B){if(this.hasPrevious()){var C=this.blockBegin-this.blockCount;C=C<0?0:C;this.getItems(C,B);}},getItems:function(G,E){E=E||{};var D=this,C=mstrmojo.emptyFn,B=E.success||C,F=E.failure||C,H=E.complete||C;this._retrieveItems(G,{success:function(I){D.blockBegin=G;D.set("items",(D.concat?(D.items||[]).concat(I.items||[]):(I.items||[])));if(I.totalSize){D.totalSize=I.totalSize;}B(I);},failure:function(I){F(I);},complete:function(I){H(I);}});},_retrieveItems:function(C,B){alert("Object which mixes in this mixin has not implemented this method - _retrieveItems().");},hasNext:function(){return(((this.concat?1:this.blockBegin)+((this.items&&this.items.length)||0))<(this.totalSize+1));},hasPrevious:function(){return this.blockBegin>1;}});}());(function(){mstrmojo.vi._MonitorsAppState=mstrmojo.provide("mstrmojo.vi._MonitorsAppState",{onAppStateChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("appStateChange",this.id,"onAppStateChange");}}});}());(function(){mstrmojo.hash=mstrmojo.provide("mstrmojo.hash",{copy:function B(S,R){if(S){R=R||{};var T;for(T in S){R[T]=S[T];}}return R;},copyProps:function C(T,V,R){R=R||{};if(V){var U=(T&&T.length)||0,S;for(S=0;S<U;S++){var W=T[S];if(V[W]!==undefined){R[W]=V[W];}}}return R;},forEach:function I(U,T,S){if(U){var R;for(R in U){if(S){if(T.call(S,U[R],R,U)===false){break;}}else{if(T(U[R],R,U)===false){break;}}}}return U;},walk:function P(V,S){if(!S){S=mstrmojo.global;}var U=V.split(".");if(U.length===1){return S[V];}var T=(U&&U.length)||0,R;for(R=0;R<T;R++){S=S[U[R]];if(!S){break;}}return S;},isEmpty:function F(S){if(!S){return true;}var R;for(R in S){if(S[R]!==null&&S[R]!==undefined){return false;}}return true;},clear:function G(S){if(S){var R;for(R in S){delete S[R];}}return S;},any:function J(U,V){var T;if(U){var S=this.keyarray(U);if(S.length>0){var R=S[0];T=V?R:U[R];}}return T;},clone:function M(V){if(!V){return null;}var X;if(V.constructor===Array){X=V.concat();var W=X[0];if(W&&typeof W==="object"){var R=X.length,U;for(U=0;U<R;U++){X[U]=this.clone(V[U]);}}}else{X={};var T;for(T in V){var S=V[T];if(S&&typeof S==="object"){X[T]=this.clone(S);}else{X[T]=S;}}}return X;},cloneArray:function E(S){var T=[],R=(S&&S.length)||0,U;for(U=0;U<R;U++){T[U]=this.clone(S[U]);}return T;},keyarray:function K(T,U){var R=[],S;if(T){if(Object.keys&&!U){R=Object.keys(T);}else{for(S in T){R.push(U?Number(S):S);}}}return R;},valarray:function L(T){var R=[];if(T){var S;for(S in T){R.push(T[S]);}}return R;},equals:function Q(Y,X){var S=mstrmojo.hash,W=(Y&&X)||(!Y&&!X&&(Y===X));if(W&&Y){W=(Y.constructor===X.constructor);if(W){if(Y.constructor===Array){var V=Y.length;W=(V===X.length);if(W&&V){var T;for(T=0;T<V;T++){W=W&&S.equals(Y[T],X[T]);}}}else{if(typeof Y==="object"){var Z=S.keyarray(Y),U=S.keyarray(X);W=Z.length===U.length;if(W){var R;for(R in Y){W=W&&(S.equals(Y[R],X[R]));}}}else{W=(Y===X);}}}}return W;},obj2array:function O(W){var X;for(X in W){var V=W[X];if(V&&typeof V==="object"){W[X]=this.obj2array(V);}}var S=W.isArray;if(S!==undefined&&S===true){var U=[],R=W.length,T;for(T=0;T<R;T++){U.push(W[T]);}return U;}return W;},min:function D(U,V,W){var R=null,T;if(U){for(T in U){var S=V?U[T]:T;if(W){S=Number(S);}if((R===null)||(S<R)){R=S;}}}return R;},max:function N(U,V,W){var R=null,T;if(U){for(T in U){var S=V?U[T]:T;if(W){S=Number(S);}if((R===null)||(S>R)){R=S;}}}return R;},make:function A(S,T,R){if(!S||!T){return null;}if(S.attachEventListener){return S;}if(T.makeObservable){S=T.makeObservable(S,R)||S;}else{this.copy(T.prototype,S);if(S.init){S=S.init(R)||S;}}return S;},mergeHashes:function H(R,S){R=this.clone(R)||{};if(S){mstrmojo.array.forEach(mstrmojo.array.distinct(this.keyarray(S).concat(this.keyarray(R))),function(T){var V=R[T],U=S[T];if(!V){R[T]=U;}else{if(V&&U){if(typeof V==="object"){if(V.constructor===Array){R[T]=V.concat(U);}else{R[T]=this.mergeHashes(V,U);}}else{R[T]=U;}}}},this);}return R;}});}());(function(){var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",G=String.fromCharCode;function D(H){H=H.replace(/\r\n/g,"\n");var I="";for(var K=0;K<H.length;K++){var J=H.charCodeAt(K);if(J<128){I+=G(J);}else{if((J>127)&&(J<2048)){I+=G((J>>6)|192);I+=G((J&63)|128);}else{I+=G((J>>12)|224);I+=G(((J>>6)&63)|128);I+=G((J&63)|128);}}}return I;}function F(L){var H="",J=0,M=0,K=0,I=0;while(J<L.length){M=L.charCodeAt(J);if(M<128){H+=G(M);J++;}else{if((M>191)&&(M<224)){K=L.charCodeAt(J+1);H+=G(((M&31)<<6)|(K&63));J+=2;}else{K=L.charCodeAt(J+1);I=L.charCodeAt(J+2);H+=G(((M&15)<<12)|((K&63)<<6)|(I&63));J+=3;}}}return H;}mstrmojo.base64=mstrmojo.provide("mstrmojo.base64",{decodeHttpHeader:function E(K){var I=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(K&&K.indexOf("=?UTF-8?B?")===0){var J="",H;while((H=I.exec(K))!==null){J+=mstrmojo.base64.decode(H[1]);}return J;}return K;},encode:function B(J){var H="";var Q,O,M,P,N,L,K;var I=0;J=D(J);while(I<J.length){Q=J.charCodeAt(I++);O=J.charCodeAt(I++);M=J.charCodeAt(I++);P=Q>>2;N=((Q&3)<<4)|(O>>4);L=((O&15)<<2)|(M>>6);K=M&63;if(isNaN(O)){L=K=64;}else{if(isNaN(M)){K=64;}}H+=A.charAt(P)+A.charAt(N)+A.charAt(L)+A.charAt(K);}return H;},decode:function C(J){var H="",I=0;var Q,O,M,P,N,L,K;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(I<J.length){P=A.indexOf(J.charAt(I++));N=A.indexOf(J.charAt(I++));L=A.indexOf(J.charAt(I++));K=A.indexOf(J.charAt(I++));Q=(P<<2)|(N>>4);O=((N&15)<<4)|(L>>2);M=((L&3)<<6)|K;H+=G(Q);if(L!==64){H+=G(O);}if(K!==64){H+=G(M);}}H=F(H);return H;}});})();(function(){function Q(U,R,S){if(U.nodeType===3&&R){return U;}else{var T=(R&&U.nodeType===1&&U.lastChild)?U.lastChild:F(U,S);return T?D(T,S):null;}}function F(S,R){return(S===R)?null:(S.previousSibling||F(S.parentNode,R));}function D(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.lastChild){return D(S.lastChild);}else{return D(F(S,R));}}}function I(R){return R.textContent||R.nodeValue||R.innerText;}function M(U,R,S){if(U.nodeType===3&&R){return U;}else{var T=(R&&U.nodeType===1&&U.firstChild)?U.firstChild:B(U,S);return T?E(T,S):null;}}function B(S,R){return(S===R)?null:(S.nextSibling||B(S.parentNode,R));}function E(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.firstChild){return E(S.firstChild);}else{return E(B(S,R));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function P(T,U){var R=0,S;if(T.nodeType===1){if(window.getSelection){S=document.createRange();S.selectNode(T);R=S.toString().length;}else{S=document.body.createTextRange();S.moveToElementText(T);R=S.text.length;}}else{R=I(T).length;}return U===R?this.EDGE.EDGE_END:(U===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function K(U,S){if(!U.offsetParent){return ;}var T=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(U);R.collapse(S);T.removeAllRanges();T.addRange(R);}else{R.moveToElementText(U);R.collapse(S);R.select();}},collapseOnTextNode:function L(U,V){var T=this.getSelection(),S=this.getRange();if(window.getSelection){var R=M(U,true);S.setStart(R,V);S.collapse(true);T.removeAllRanges();T.addRange(S);}else{S.moveToElementText(U);S.collapse(true);S.move("character",V);S.select();}},collapseOnTextNodeIE:function C(S,T){var U=M(S,true),R;while(U!==null){R=I(U).length;if(R>=T){this.collapseOnTextNode(U,T);break;}else{T-=R;U=M(U,false);}}},getRangeInfo:function J(X,e){var Z=null,l,c=this.getRange(),b;if(X&&X===c.startContainer){var g=c.startContainer.firstChild,U=g&&g.firstChild,d=U&&U.firstChild;if(d){c.setStart(d,c.startOffset);c.setEnd(d,c.endOffset);}}if(window.getSelection){var W=function(n,p,o){var m=n.cloneRange();m.collapse(o);m.setStartBefore(p);return m.toString().length;},S=c.startContainer,f=c.startOffset;if(S.nodeType===1){f=W(c,S,true);}Z={collapsed:c.collapsed,startContainer:S,startOffset:e?e.startOffset:f};if(!c.collapsed){var V=c.endContainer,R=c.endOffset;if(V.nodeType===1){R=W(c,V,false);}Z.endContainer=V;Z.endOffset=R;}Z.range=c;}else{var k,a,Y=function(p,q){var o=p.duplicate(),m=document.body.createTextRange(),n;o.collapse(q);n=o.parentElement();m.moveToElementText(n);m.setEndPoint("EndToStart",o);return{container:n,offset:m.text.length};},h=Y(c,true),T;Z={collapsed:(c.compareEndPoints("StartToEnd",c)===0),startContainer:h.container,startOffset:h.offset};if(!Z.collapsed){T=Y(c,false);Z.endContainer=T.container;Z.endOffset=T.offset;}}return Z;},collapse:function O(S){if(window.getSelection){var T=this.getSelection();if(S){T.collapseToStart();}else{T.collapseToEnd();}}else{var R=this.getRange();R.collapse(S);R.select();}},selectSingleNode:function H(T){var S=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(T);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(T);R.select();}},selectMultipleNodes:function N(W,S,X,U){var V=this.getSelection(),T=this.getRange();if(window.getSelection){T.setStart(W,S);T.setEnd(X,U);V.removeAllRanges();V.addRange(T);}else{W=(W.nodeType===3)?W.parentNode:W;T.moveToElementText(W);T.move("character",S);X=(X.nodeType===3)?X.parentNode:X;var R=document.body.createTextRange();R.moveToElementText(X);R.move("character",U);T.setEndPoint("EndToStart",R);T.select();}},getSelection:function G(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});}());mstrmojo.EnumAuthenticationModes={DEFAULT:0,STANDARD:1,NTCREDENTIAL:2,PASSTHRU:4,ANONYMOUS:8,LDAP:16,DATABASE:32,PLUGIN:64,INTEGRATED:128,USHER:256};mstrmojo.vi.enums.EnumDerivedElementType={LIST:1,CALCULATION:2,RESIDUE:4};mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){function E(H,G,F){return H>=G&&H<=F;}function A(G,F){return{start:G,end:F};}function C(I,G){var L=this.renderedRowsArr,K=B.call(this,I,1),J=K.index,H=L[J],F;if(!K.between){if(H&&I>H.end+1){J++;L.splice(J,0,A(I,G));}else{L.splice(J,0,A(I,G));}H=L[J];}else{H.end=Math.max(H.end,G);}while(J<L.length-1){J++;F=L[J];if(H.end+1>=F.start){H.end=Math.max(H.end,F.end);L.splice(J,1);J--;}else{break;}}}function B(G,L){var K=this.renderedRowsArr,H=0,I=K.length-1,F,J;while(H<=I){F=(H+I)/2|0;J=K[F];if(E(G,J.start,J.end+L||0)){return{between:true,index:F};}else{if(G<J.start){I=F-1;}else{H=F+1;}}}return{between:false,index:F};}mstrmojo._RowRendTracker=mstrmojo.provide("mstrmojo._RowRendTracker",{_mixinName:"mstrmojo._RowRendTracker",renderedRowsArr:undefined,init:function D(F){this._super(F);this.renderedRowsArr=[];},markPages:function(G,F){C.call(this,G,F);},searchRow:function(H){var G=B.call(this,H,0),F;if(G.between){F=this.renderedRowsArr[G.index];return{rendered:true,min:F.start,max:F.end};}return null;},unMarkAllPages:function(){this.renderedRowsArr.length=[];}});}());mstrmojo.mstr.EnumDSSXMLDrillType={DssXmlDrillReserved:0,DssXmlDrillToParent:1,DssXmlDrillToChild:2,DssXmlDrillToUnit:3,DssXmlDrillToTemplate:4,DssXmlDrillToForm:5,DssXmlDrillToDetails:6,DssXmlDrillToMetric:7,DssXmlDrillFixTemplate:8,DssXmlDrillRemoveMetric:9,DssXmlDrillRemoveUnit:10,DssXmlDrillToGraphCoordinates:11};(function(){mstrmojo.func=mstrmojo.provide("mstrmojo.func",{composite:function D(E){if(!E||!E.length){return mstrmojo.emptyFn;}return function(){var F=E.length,G;for(G=0;G<F;G++){E[G].apply(this,arguments);}};},wrapMethods:function C(J,H){function I(L,K){K=K||{};mstrmojo.hash.forEach(L,function(M,N){K[N]=(K.hasOwnProperty(N)&&typeof M==="function")?mstrmojo.func.composite([M,K[N]]):M;});return K;}if(arguments.length<3){return I(J,H);}var F=arguments.length,G=[].slice.call(arguments,0,F-1).reverse(),E=arguments[F-1];mstrmojo.array.forEach(G,function(K){E=I(K,E);});return E;},override:function A(G,E){var F=function(J,I){return function H(){var L=this._super,K;this._super=I||mstrmojo.emptyFn;try{K=J.apply(this,arguments||[]);}finally{this._super=L;}return K;};};E=E||{};mstrmojo.hash.forEach(G,function(H,I){E[I]=F(H,E[I]);});return E;},throttle:function(G,I,E){var F,K,N,L=null,J=0,M=E||{};var H=function(){J=M.leading===false?0:mstrmojo.date.now();L=null;N=G.apply(F,K);F=K=null;};return function(){var O=mstrmojo.date.now();if(!J&&M.leading===false){J=O;}var P=I-(O-J);F=this;K=arguments;if(P<=0){clearTimeout(L);L=null;J=O;N=G.apply(F,K);F=K=null;}else{if(!L&&M.trailing!==false){L=setTimeout(H,P);}}return N;};},debounce:function(H,J,G){var M,L,F,K,N,E=mstrmojo.date.now;var I=function(){var O=E()-K;if(O<J){M=setTimeout(I,J-O);}else{M=null;if(!G){N=H.apply(F,L);F=L=null;}}};return function(){F=this;L=arguments;K=E();var O=G&&!M;if(!M){M=setTimeout(I,J);}if(O){N=H.apply(F,L);F=L=null;}return N;};},addMethods:function B(F,E){E=E||{};mstrmojo.hash.forEach(F,function(G,H){if(!E.hasOwnProperty(H)&&typeof G==="function"){E[H]=G;}});return E;}});}());(function(){mstrmojo._HasPopup=mstrmojo.provide("mstrmojo._HasPopup",{_mixinName:"mstrmojo._HasPopup",_lastOpened:null,openPopup:function A(G,E){var C=!!G&&(typeof G==="string")&&!G.match(/\./)&&!!this[G],D=mstrmojo.registry.ref(C?this[G]:G);if(D&&D.open){if(C){this[G]=D;}if(D.disposable!==false){this.addDisposable(D);}var J=D.slot&&this[D.slot];if(J){if(D.parent!==this){if(this.addChildren){this.addChildren([D]);}else{var I=false,F=D.domNode||D.placeholder;if(F&&typeof F==="string"){F=document.getElementById(F);}if(!F){I=true;F=document.createElement("span");D.placeholder=F;}if(I||(F.parentNode!==J)){J.appendChild(F);}}}}try{D.open(this,E);}catch(H){console.log("Error opening popup: "+H);}this._lastOpened=D;}},closePopup:function B(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}});}());(function(){mstrmojo.vi.ui.rw._SavesChildPositions=mstrmojo.provide("mstrmojo.vi.ui.rw._SavesChildPositions",{scriptClass:"mstrmojo.vi.ui.rw._SavesChildPositions",getChildPositionActions:function A(){var B=this.children,C=[];B.forEach(function(D){if(D.addFormatProps){C.push(D.addFormatProps());}if(D.getChildPositionActions){C=C.concat(D.getChildPositionActions());}});return C;}});}());mstrmojo.mstr.EnumFunction={FunctionCustom:-1,FunctionReserved:0,FunctionPlus:1,FunctionMinus:2,FunctionTimes:3,FunctionDivide:4,FunctionUnaryMinus:5,FunctionEquals:6,FunctionNotEqual:7,FunctionGreater:8,FunctionLess:9,FunctionGreaterEqual:10,FunctionLessEqual:11,FunctionSum:12,FunctionCount:13,FunctionAvg:14,FunctionMin:15,FunctionMax:16,FunctionBetween:17,FunctionLike:18,FunctionAnd:19,FunctionOr:20,FunctionNot:21,FunctionIn:22,FunctionRank:23,FunctionAbs:24,FunctionRunningSum:25,FunctionRunningAvg:26,FunctionMovingSum:28,FunctionMovingAvg:27,FunctionProduct:29,FunctionMedian:30,FunctionMode:31,FunctionStdev:32,FunctionVar:33,FunctionGeomean:34,FunctionEqualEnhanced:35,FunctionNotEqualEnhanced:36,FunctionGreaterEqualEnhanced:37,FunctionLessEqualEnhanced:38,FunctionBetweenEnhanced:39,FunctionBanding:40,FunctionBandingC:41,FunctionBandingP:42,FunctionNotLike:43,FunctionNotBetween:44,FunctionIntersect:45,FunctionIntersectIn:46,FunctionNullToZero:47,FunctionZeroToNull:48,FunctionApplySimple:49,FunctionApplyAggregation:50,FunctionApplyLogic:51,FunctionApplyComparison:52,FunctionApplyRelative:53,FunctionIsNull:54,FunctionIsNotNull:55,FunctionUcase:56,FunctionNotIn:57,FunctionNTile:58,FunctionPercentile:59,FunctionMovingMax:60,FunctionMovingMin:61,FunctionMovingDifference:62,FunctionMovingStdev:63,FunctionExpWghMovingAvg:64,FunctionMovingCount:65,FunctionRunningMax:66,FunctionRunningMin:67,FunctionRunningStdev:68,FunctionRunningCount:69,FunctionExpWghRunningAvg:70,FunctionNotBetweenEnhanced:71,FunctionConcat:72,FunctionFirstInRange:73,FunctionLastInRange:74,FunctionValueSegment:75,FunctionContains:76,FunctionBeginsWith:77,FunctionEndsWith:78,FunctionNotContains:79,FunctionNotBeginsWith:80,FunctionNotEndsWith:81,FunctionCase:82,FunctionCaseV:83,FunctionStdevP:84,FunctionRunningStdevP:85,FunctionMovingStdevP:86,FunctionNTileS:87,FunctionNTileVS:88,FunctionVarP:89,FunctionCurrentDate:90,FunctionDayOfMonth:91,FunctionDayOfWeek:92,FunctionDayOfYear:93,FunctionWeek:94,FunctionMonth:95,FunctionQuarter:96,FunctionYear:97,FunctionCurrentDateTime:98,FunctionCurrentTime:99,FunctionHour:100,FunctionMinute:101,FunctionSecond:102,FunctionMilliSecond:103,FunctionConcatNoBlank:104,FunctionLength:105,FunctionLower:106,FunctionLTrim:107,FunctionPosition:108,FunctionRTrim:109,FunctionSubStr:110,FunctionInitCap:111,FunctionTrim:112,FunctionRightStr:113,FunctionLeftStr:114,FunctionGreatest:115,FunctionLeast:116,FunctionFirst:117,FunctionLast:118,FunctionAdd:134,FunctionAverage:135,FunctionMultiply:136,FunctionBandingM:137,FunctionOLAPSum:138,FunctionOLAPAvg:139,FunctionOLAPCount:140,FunctionOLAPMax:141,FunctionOLAPMin:142,FunctionLag:143,FunctionLead:144,FunctionPercentRank:166,FunctionTuple:1000};mstrmojo.vi.enums.EnumDSSAccessRightFlags={DssAccessRightReservedFlag:0,DssAccessRightBrowseFlag:1,DssAccessRightUseExecuteFlag:2,DssAccessRightReadFlag:4,DssAccessRightWriteFlag:8,DssAccessRightDeleteFlag:16,DssAccessRightControlFlag:32,DssAccessRightUseFlag:64,DssAccessRightExecuteFlag:128,DssAccessRightFullControlFlag:255,DssAccessRightInheritable:536870912,DssAccessRightAudit:1073741824,DssAccessRightAuditInheritable:1610612736};(function(){mstrmojo.ui.editors._HostsControls=mstrmojo.provide("mstrmojo.ui.editors._HostsControls",{_mixinName:"mstrmojo.ui.editors._HostsControls",setFormatSource:function C(E){this.throwAbstractMethodError("setFormatSource");},syncControls:function A(E){var F=this._sync;this._sync=true;E.call(this);this._sync=F;},raiseFormatValueChange:function D(F,G,E){if(this._sync){return false;}this.onGroupValueChange(F,G,E);return true;},onGroupValueChange:function B(F,G,E){}});}());(function(){mstrmojo.gmaps.MapPropertiesHelper=mstrmojo.provide("mstrmojo.gmaps.MapPropertiesHelper",{getMatchingShape:function A(B,H,G){var F,D,C,E;if(!B){return null;}if(!!H){for(F=0;F<B.length;F++){if(B[F].id==H){D=B[F];break;}}}else{if(!!G){for(F=0;F<B.length;F++){if(!!B[F].custom&&B[F].custom==true&&B[F].roleId==G){if(!C){C=B[F];}if(!!B[F]["default"]&&(B[F]["default"]+"").toLowerCase()==="true"){D=B[F];break;}}else{if(!E&&B[F].roleId==G&&!!B[F]["default"]&&(B[F]["default"]+"").toLowerCase()==="true"){E=B[F];}}}if(!D){if(!!E){D=E;}else{if(!!C){D=C;}}}}}return D;}});}());mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap={DssXmlAxisNone:0,DssXmlAxisRowsBit:1,DssXmlAxisColumnsBit:2,DssXmlAxisPagesBit:4,DssXmlAxisChaptersBit:8};mstrmojo.VisEnum={ControlType:{BUTTON:"button",LASSO_SELECTOR:"lasso-selector",LASSO_RESIZER:"lasso-resizer",SPLITTER:"splitter",GM_ROW_HEADER:"rh",GM_ROW_HEADER_TEXT:"rhtext",GM_ROW_HEADER_EXTRA:"rhext",GM_COL_HEADER:"ch",GM_COL_HEADER_TEXT:"chtext",GM_COL_HEADER_EXTRA:"chext",GM_YAXIS:"y",GM_XAXIS:"x",GM_YLABEL:"y-label",GM_XLABEL:"x-label",GM_ROW_HEADER_TITLE:"rht",GM_ROW_HEADER_TITLE_TEXT:"rhttext",GM_COL_HEADER_TITLE:"cht",GM_COL_HEADER_TITLE_TEXT:"chttext",GM_MINI_CHART:"chart",GM_TEXT_BODY:"text-body",GM_SHAPE:"shape",GM_MARKER:"marker",GM_SET_SHAPE:"set-shape",GM_YAXIS2:"y2",GM_XAXIS2:"x2",GM_TREND_LINE:"trendLine",GM_TREND_LINE_HOVER:"trendLineHover",GM_TREND_LINE_SELECT:"trendLineSelect",GM_REF_LINE:"referenceLine",GM_REF_LINE_HOVER:"referenceLineHover",GM_REL_LINE_SELECT:"referenceLineSelect",GM_HIGHLIGHT_BOX:"highlight-box",GM_AXIS_TEXT:"axis-text",GM_AXIS_WORD:"axis-word",GM_SVG_X_NUMERIC:"svg-x-numeric",GM_SVG_X_CATEGORY:"svg-x-category",GM_SVG_Y_NUMERIC:"svg-y-numeric",GM_SVG_Y_CATEGORY:"svg-y-category",GM_X_NUMERIC:"x-numeric",GM_X_CATEGORY:"x-category",GM_Y_NUMERIC:"y-numeric",GM_Y_CATEGORY:"y-category",GM_SVG_CHART:"svg-chart",GM_DATA_LABEL:"data-label",GM_YAXIS_LINE:"y-line",GM_XAXIS_LINE:"x-line",GM_YAXIS2_LINE:"y2-line",GM_XAXIS2_LINE:"x2-line",LGD_TITLE:"lgd-title",LGD_TEXT:"lgd-text",LGD_COLORBOX:"lgd-colorbox",LGD_COLORBOX_CTN:"lgd-colorbox-ctn",LGD_CANVAS:"lgd-canvas",LINE_CONTAINER:"line-ctn",GM_V_MATRIX_LINE:"v-line",GM_H_MATRIX_LINE:"h-line",GM_V_CHART_LINE:"v-ctline",GM_H_CHART_LINE:"h-ctline",GM_CHART_ROW:"ct-row",GM_CHART_COL:"ct-col",GM_H_GRID_LINE:"h-gline",GM_V_GRID_LINE:"v-gline",GM_H_MINOR_GRID_LINE:"h-gline-minor",GM_V_MINOR_GRID_LINE:"v-gline-minor",GM_ORIGIN_LINE:"originLine",GM_ORIGIN_LABEL:"origin-label",GM_ORIGIN_LINE_H:"origin-line-h",GM_ORIGIN_LINE_V:"origin-line-v",GM_ORIGIN_LABEL_H:"origin-label-h",GM_ORIGIN_LABEL_V:"origin-label-v",GM_DUMMY_A:"dummy-a",GM_V_EXTRA_LINE:"v-extra-line",GM_REF_LABEL:"ref-label",GM_RIGHT_BORDER:"border-r",GM_BOTTOM_BORDER:"border-b"},GMDropZoneID:{ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10},NETWORK_LOCAL_PROPS:{ZOOM_FACTOR:"zf",NODE_POSITION:"np"},NETWORK_PROPERTIES:{showLegend:"showLegend",showEdgeDirection:"showedgearrow",showTransition:"animatelayout",nodeSizeAggregation:"nodesizeaggfunc",minNodeSize:"minns",maxNodeSize:"maxns",themeType:"th",circleLabelFont:"BubFnt",modifiedNodes:"mn",layoutMode:"layout",legendPosition:"legendposition",dragMode:"mode",bubbleStyle:"bbs",propsCategory:"pc",lgdBgFillClr:"lgdBgFillClr",lgdBgFillTrans:"lgdBgFillTrans",lgdFntClr:"lgdFntClr",lgdFntSz:"lgdFntSz",lgdFntFml:"lgdFntFml",lgdFntStyle:"lgdFntStyle"},NETWORK_LAYOUT:{CIRCULAR:"circular",LINEAR:"linear",FORCE_DIRECTED:"forceDirected"},NETWORK_DRAG_MODE:{pan:0,select:1},NETWORK_AGGREGATION_METHOD:{"Count of":0,"Sum of":1,"Average of":2,"Min of":3,"Max of":4},NETWORK_MIN_NODE_SIZE_TYPE:{PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3},NETWORK_MAX_NODE_SIZE_TYPE:{AUTOMATIC:1,MANUAL:2},NETWORK_FORCE_DIRECTED_LAYOUT_EDGE_CURVATURE:[0,0.2],HEATMAP_PROPERTIES:{showLegend:"showLegend",deleteButton:"ed",showMetricValues:"mv",labelSize:"lb",layout:"la",themeType:"th",headerType:"he",deletedList:"dl",refreshType:"rt",metricList:"ml",colorByType:"cbt",absoluteFixed:"abs",blendColor:"blc",background:"bg",legendBackground:"lbg",headerColors:"hcl",fonts:"fts",propsCategory:"pc",attrColorByOpacity:"acbo",metricColorByOpacity:"mcbo"},HEATMAP_LABEL_SIZE:{On:0,Off:1,Proportional:2},MAPS_PROPERTIES:{SHOW_LEGEND:"showLegend"},VIS_CARDLIMIT:{GRID:250,NON_GRID:8000},GMLegendDataType:{COLOR_BY:1,SIZE_BY:2},GMLegendFormatingPropertyTag:{LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",COLOR_SQUARE_COLOR:"clrSqrClr"},LegendPropertyTag:{LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr"},EnumLegendMode:{RESTORED:1,MINIMIZED:2},EnumColorRankMode:{INVALID:-1,VALUE:0,TOP:1,BOTTOM:2,TOP_PERCENT:3,BOTTOM_PERCENT:4},FormNameDisplayType:{OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4},SERVER_JSON_ERROR_TYPE:{EMPTY_DATA:0,NO_DATASET:1,AE_ERROR:2,NO_TEMPLATE_UNIT:3},NETWORK_CIRCLE_BORDER_WIDTH:8,IMAGELAYOUT_PROPERTIES:{DISPLAY_MODE:"mt",MAX_SIZE_TYPE:"ty",MAX_SIZE_VALUE:"val",MIN_SIZE_TYPE:"mst",MIN_SIZE_VALUE:"msv",MAP_FILE_PATH:"mf",SHAPE_FILL_OPC_PER:"shapeFillTrans",SHAPE_FILL_COLOR:"shapeClr",SHAPE_BORDER_STYLE:"shapeBorderCmbStyle",SHAPE_BORDER_COLOR:"shapeBorderClr",DATA_LABEL_SWITCH:"dls",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",BLANK_MAP_BORDER_STYLE:"blankMapBorderStyle",BLANK_MAP_BORDER_COLOR:"blankMapBorderClr",BLANK_MAP_COLOR:"blankMapClr",DEFAULT_MAP_COLOR:"dftMapClr",DEFAULT_BUBBLE_COLOR:"dftBubbleClr",DEFAULT_MAP_BORDER_COLOR:"dftMapBorderClr",DEFAULT_BUBBLE_BORDER_COLOR:"dftBubbleBorderClr",LEGEND_FONT_SIZE:"lgFntSz",LEGEND_FONT_FAMILY:"lgFntFml",LEGEND_FONT_COLOR:"lgFntClr",LEGEND_FONT_STYLE:"lgFntStyle",LEGEND_BACKGROUND_COLOR:"lgBgClr",LEGEND_OPC_PER:"lgBgFillTrans",LEGEND_POSITION:"lgPos",LEGEND_SHOW:"lgShow",LEGEND_MODE:"lgMode",LEGEND_SCALE:"lgScale",H_MATRIX_LINE_COLOR:"hMatrixLnClr",V_MATRIX_LINE_COLOR:"vMatrixLnClr",ALL_MATRIX_LINE_COLOR:"allMatrixLnClr",H_MATRIX_LINE_STYLE:"hMatrixLnCmbStyle",V_MATRIX_LINE_STYLE:"vMatrixLnCmbStyle",ALL_MATRIX_LINE_STYLE:"allMatrixLnCmbStyle"}};mstrmojo.mstr.EnumDSSXMLTokenTypes={EndOfInput:-1,Reserved:0,Error:1,Unknown:2,Empty:3,ExclamationPoint:33,NumberSign:35,Dollar:36,Percent:37,Ampersand:38,LeftParen:40,RightParen:41,Asterisk:42,PlusSign:43,Comma:44,MinusSign:45,Dot:46,FwdSlash:47,Colon:58,Semicolon:59,LeftAngleBracket:60,EqualSign:61,RightAngleBracket:62,QuestionMark:63,AtSign:64,LeftSquareBracket:91,RightSquareBracket:93,Caret:94,Underscore:95,LeftAccolade:123,VerticalBar:124,RightAccolade:125,Tilda:126,Literal:258,Identifier:259,Reserved1:260,DoubleQString:261,Integer:262,Float:263,AttrRef:264,DimRef:265,MetricRef:266,AggMetricRef:267,FactRef:268,ReportRef:269,FilterRef:270,RoleRef:271,TableRef:272,PromptRef:273,ColumnRef:274,AttrFormRef:275,DimFormRef:276,SimpInfixFun1:277,SimpInfixFun2:278,SimpPrefixFun:279,AggFun:280,RelativeFun:281,CompareFun:282,AndFun:283,OrFun:284,NotFun:285,BoolPrefixFun:286,IntersectFun:287,Reserved2:288,InSetFun:289,BetweenFun:290,LikeFun:291,EnhCompareFun:292,EnhBetweenFun:293,ArrowUp:294,ArrowDown:295,ArrowUpDown:296,AggFirstInFact:297,AggLastInFact:298,KwdTrue:299,KwdFalse:300,KwdBreakBy:301,KwdSortBy:302,KwdFactID:303,DateTime:304,CaseFun:305,FreeVariable:306,LongNumber:307,RWMetricRef:308,CSQLRef:309,ConsolidationRef:310,DssTokenTypeKwdCSIUpdate:312,DssTokenTypeKwdCSISet:313,DssTokenTypeKwdCSIInsert:314,DssTokenTypeKwdCSIDelete:315,DssTokenTypeKwdCSIWhere:316,DssTokenTypeKwdCSIInto:317,DssTokenTypeKwdCSIValues:318,DssTokenTypeKwdCSIFrom:319,DssTokenTypeCSIFieldUnit:321,Elements:323,ConsolidationElementRef:324,EndOfTypes:340};mstrmojo.warehouse.EnumObjectTypes={FILTER:1,METRIC:4,ATTRIBUTE:12,FACT:13,DIMENSION:14,TABLE:15,TABLE_LOGICAL_VIEW:151,TABLE_PARTITION:152,FORM:21,COLUMN:26,DBROLE:29,PROJECT:32,TRANSFORMATION:43,DBTABLE:53,LAYER:70,RELATIONSHIP:99,COMPOUND_FORM:1001,RELATIONSHIP_ATTRIBUTE:1002};(function(){mstrmojo.vi.ui.theme=mstrmojo.provide("mstrmojo.vi.ui.theme",{getThemeClass:function A(){var C=this.parent||this.opener,B="";while(C){var D=C.themeClassName;if(D){B=D;break;}C=C.parent||C.opener;}return B;}});}());(function(){mstrmojo.models.template.Title=mstrmojo.declare(null,null,{init:function G(J){this.title=J.title;},getActionType:function(){return this.title.at;},getDrillPath:function(){return this.title.dp;},getHeaderValues:function B(){return this.title.es;},getHeaderName:function F(J){return this.title.es[J].n;},getHeaderId:function F(J){return this.title.es[J].id;},getForms:function E(){return this.title.fs;},getFormId:function D(){return this.title.fid;},getFormType:function I(){return this.title.ftp;},getUnitId:function H(){return this.title.id;},getLinkMap:function C(){return this.title.lm;},getName:function A(){return this.title.n;},getUnitDssType:function(){return this.title.otp;},getSelectorControl:function(){return this.title.sc;}});}());(function(){function AJ(Ap,Aq){return Aq||(Ap||window).event;}mstrmojo.PositionType=null;var Am=!!document.all,AH=document.documentMode,r=navigator.userAgent,k=false,g=false,e=false,d=false,R=false,u=false;if(Am){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){k=!!r.match(/MSIE 6/);g=((!!r.match(/MSIE 7/)&&!AH)||AH===7);e=(AH===8);d=(AH===9);R=(AH===10);u=(!AH||AH<=9);}else{k=!!r.match(/MSIE 6/);g=!!r.match(/MSIE 7/);e=!!r.match(/MSIE 8/);d=!!r.match(/MSIE 9/);R=!!r.match(/MSIE 10/);u=!R;}}var c=!Am&&!!r.match(/Firefox/),m=0,t=!!r.match(/Android/),Ad=!!r.match(/iPad/),AN=!!r.match(/iPhone/),AV=!!document.createTouch||t,q=!!r.match(/PlayBook/),O=!!r.match(/Windows Phone/),An=!Am&&!!r.match(/Trident.*rv/),b=c?"-moz-":(Am||An)?"":"-webkit-",AI=c?"Moz":(R||An)?"":Am?"ms":"webkit",AS=((R||An)?"t":"T"),AM=AI+AS+"ransition";function Ah(){return AI+AS+"ransform";}function AF(){return AM+"Property";}function S(){return AM+"Duration";}function N(){return(R||c)?"transitionend":"webkitTransitionEnd";}function f(){return AI+"BoxShadow";}var Ak=Ah(),Aa=AF(),AA=S(),A=N(),o=f();function AR(){if(!m&&c){var Ap=r.match(/.*Firefox\/([\d|\.]*).*/);if(Ap){m=parseFloat(Ap[1]);}}return m;}function AX(){var Aq=0,Au=0,Ar=window,As=document,Ap=As.body,At=As.documentElement;if(typeof Ar.pageYOffset==="number"){Au=Ar.pageYOffset;Aq=Ar.pageXOffset;}else{if(Ap&&(Ap.scrollLeft||Ap.scrollTop)){Au=Ap.scrollTop;Aq=Ap.scrollLeft;}else{if(At&&(At.scrollLeft||At.scrollTop)){Au=At.scrollTop;Aq=At.scrollLeft;}}}return{x:Aq,y:Au};}function AG(Ap){Ap=Ap||0;Ap=String(Ap);return((Ap.indexOf("%",0))!==-1)?Ap:(Ap+"px");}function AP(Ar,Av,Au,At,As){if(!mstrmojo.dom.isWinPhone){At=(At||false||this.isHWAccelerated);}else{At=false;}var Aq=As+(At?"3d":"")+"(",Ap=At?(","+Au+")"):")";return Aq+Ar+","+Av+Ap;}var Ab=2,V=3;function v(Av,Au,Ay){var Ax=Av.style,Ar=Ax.display,At=this.windowDim(),As=AX();Ax.display="block";var Aw=At.w-Av.clientWidth,Az=Math.max(At.h-Av.clientHeight,0),Ap={4:0,5:Aw,3:Aw/2},Aq={1:0,3:Az/2,2:Az};Ax.left=Ap[Au]+As.x+"px";Ax.top=Aq[Ay]+As.y+"px";Ax.display=Ar;}function n(As,Ar,At,Ap){if(As.addEventListener){return As.addEventListener(Ar,At,!!Ap);}At._id=At._id||n.guid++;As.events=As.events||{};var Aq=As.events[Ar];if(!Aq){Aq=As.events[Ar]={};if(As["on"+Ar]){Aq[0]=As["on"+Ar];}}Aq[At._id]=At;function Au(Ax){Ax=Ax||window.event;var Aw=this.events[Ax.type],Av;for(Av in Aw){Aw[Av].call(this,Ax);}}As["on"+Ar]=Au;}n.guid=1;function h(Ar,Aq,As,Ap){if(!Ar){return ;}if(Ar.removeEventListener){Ar.removeEventListener(Aq,As,!!Ap);}else{if(Ar.events&&Ar.events[Aq]){delete Ar.events[Aq][As._id];}}}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:r,isIE:Am,isIE6:k,isIE7:g,isIE8:e,isIE9:d,isIE10:R,isIEW3C:An,isNSIE:u,isDXIE:u,isFF:c,isWK:!!r.match(/AppleWebKit/),isSafari:!!r.match(/Safari/)&&!r.match(/Chrome/),isChrome:!!r.match(/AppleWebKit/)&&r.match(/Chrome/),isHWAccelerated:!t,isAndroid:t,isIPad:Ad,isPlayBook:q,isWinPhone:O,isMobile:Ad||AN||O||t,supportsTouches:AV,TOUCHSTART:AV?"touchstart":"mousedown",TOUCHMOVE:AV?"touchmove":"mousemove",TOUCHEND:AV?"touchend":"mouseup",TOUCHCANCEL:AV?"touchcancel":"",RESIZE:AV?"orientationchange":"resize",CSS3_PREFIX:b,CSS3_BOXSHADOW:o,CSS3_TRANSFORM:Ak,CSS3_TRANSITION:AM,CSS3_TRANSITION_PROPERTY:Aa,CSS3_TRANSITION_DURATION:AA,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},htmlFeatures:{FILE_READER:"fr"},MOUSE_BUTTON:{LEFT:1,RIGHT:2},supports:function B(Ap){var Aq=this.isFF&&AR();switch(Ap){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||Aq>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||Aq>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);case this.htmlFeatures.FILE_READER:return !!(window.FileReader);}return false;},getOSInfo:function AO(){var Au="Unknown",Aq=navigator.appVersion,At=navigator.userAgent,As=Au;var Ap=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];var Ar;for(Ar=0;Ar<Ap.length;Ar++){var Aw=Ap[Ar];if(Aw.r.test(At)){As=Aw.s;break;}}var Av=Au;if(/Windows/.test(As)){Av=/Windows (.*)/.exec(As)[1];As="Windows";}switch(As){case"Mac OS X":Av=/Mac OS X (10[\.\_\d]+)/.exec(At)[1];break;case"Android":Av=/Android ([\.\_\d]+)/.exec(At)[1];break;case"iOS":Av=/OS (\d+)_(\d+)_?(\d+)?/.exec(Aq);Av=Av[1]+"."+Av[2]+"."+(Av[3]|0);break;}return{name:As,version:Av};},transEndEvtNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},replace:function p(Ar,Ap){if(Ar&&Ap){var Aq=Ar.parentNode;if(Aq){Aq.replaceChild(Ap,Ar);}}return Ap;},attachEvent:function X(Ar,Aq,As,Ap){if(Ar.addEventListener){return Ar.addEventListener(Aq,As,!!Ap);}return Ar.attachEvent("on"+Aq,As);},detachEvent:function AZ(Ar,Aq,As,Ap){if(!Ar){return ;}if(Ar.removeEventListener){Ar.removeEventListener(Aq,As,!!Ap);}else{Ar.detachEvent("on"+Aq,As);}},attachMarkupEvent:function x(As,Ar,Ap){var Aq=function(At){mstrmojo.all[As].captureDomEvent(Ap,window,At);};this.attachEvent(Ar,Ap,Aq);return Aq;},attachOneTimeEvent:function W(As,Aq,At,Ap){var Ar=function(Au){At(Au);if(Ap){h(this,Aq,Ar);}else{mstrmojo.dom.detachEvent(this,Aq,Ar);}};if(Ap){n(As,Aq,Ar);}else{this.attachEvent(As,Aq,Ar);}As=null;return Ar;},attachMouseMoveEvents:function D(As,Ap){var Ar=this,Aq=function(At){if(Ap){Ap(At);}Ar.detachEvent(document,"mousemove",As);Ar.detachEvent(document,"mouseup",Aq);};Ar.attachEvent(document,"mousemove",As);Ar.attachEvent(document,"mouseup",Aq);},captureDomEvent:function AL(Au,As,Aq,At,Ar){var Ap=mstrmojo.all[Au];if(Ap){Ap.captureDomEvent(As,Aq,At,Ar);}},translate:function L(Ar,Aq,Au,At,Ap,As){Ap=(Ap&&" "+Ap)||"";Ar.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(Aq,Au,At,As)+Ap;},createTranslateString:function P(Ap,As,Ar,Aq){Ap=AG(Ap);As=AG(As);Ar=AG(Ar);return AP(Ap,As,Ar,Aq,"translate");},createScaleString:function w(Ap,As,Ar,Aq){Ap=Ap||0;As=As||0;Ar=Ar||0;return AP(Ap,As,Ar,Aq,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function C(Ar,Ap,As,Au){var Aq=Ar.id+"-"+Ap,At=this._bufferConnects[Aq];if(!At){At=this._bufferConnects[Aq]={elId:Ar.id,eventName:Ap,timer:null,bufferSize:Au,listeners:[],callback:function(Av){mstrmojo.dom._callback(Av,mstrmojo.global,Aq);return true;}};this.attachEvent(Ar,Ap,At.callback);}At.listeners.push(As);},_callback:function Ag(At,Ap,Ar){var As=this._bufferConnects[Ar],Au=As&&As.timer;if(As&&!Au){var Aq=(As.bufferSize===null)?this._bufferSize:As.bufferSize;if(As.bufferSize){As.timer=Ap.setTimeout(function(){mstrmojo.dom.updateBuffers(Ar);},Aq);}else{mstrmojo.dom.updateBuffers(Ar);}}},updateBuffers:function H(As){var At=this._bufferConnects[As],Aq=At&&At.listeners,Ap=(Aq&&Aq.length)||0,Ar;for(Ar=0;Ar<Ap;Ar++){Aq[Ar]();}if(At&&At.timer){delete At.timer;}},detachBufferedEvent:function AD(Aq,Au,Av){if(!Aq){return ;}var Ax=Aq.id+"-"+Au,Ar=this._bufferConnects[Ax],At=Ar&&Ar.listeners,Aw=(At&&At.length)||0,As;if(Aw){for(As=Aw-1;As>-1;As--){if(At[As]===Av){At.splice(As,1);}}if(!At.length){this.detachEvent(Aq,Au,Ar.callback);delete this._bufferConnects[Ax];if(Ar.timer){var Ap=mstrmojo.global;Ap.clearTimeout(Ar.timer);}}}},eventTarget:function AB(Ap,Aq){Aq=AJ(Ap,Aq);return Aq.target||Aq.srcElement;},isMac:function z(){return this.getOSInfo().name.toLowerCase().indexOf("mac")>=0;},isMetaKey:function J(Ap,As){var Ar=this.getOSInfo().name.toLowerCase().indexOf("mac")>=0,Aq=AJ(Ap,As)||{};return(Aq.ctrlKey&&!Ar)||(Aq.metaKey&&Ar);},ctrlKey:function Aj(Ap,Aq){return(AJ(Ap,Aq)||{}).ctrlKey;},shiftKey:function AC(Ap,Aq){return(AJ(Ap,Aq)||{}).shiftKey;},metaKey:function Z(Ap,Aq){return(AJ(Ap,Aq)||{}).metaKey;},getButton:function AT(Ap,Aq){return((Number(AJ(Ap,Aq).button))===2)?2:1;},isPrimaryMouseBtn:function Ae(Aq,Ap){return this.getButton(Ap||window,Aq)===1;},getMousePosition:function l(As,Ar){Ar=Ar||window;var Aq,Av;if(mstrmojo.dom.isIE){As=As||Ar.event;var At=document,Ap=At.body,Au=At.documentElement;Aq=As.clientX+Ap.scrollLeft+(Au.scrollLeft||0);Av=As.clientY+Ap.scrollTop+(Au.scrollTop||0);}else{Aq=As.pageX;Av=As.pageY;}return{x:Aq,y:Av};},position:function AU(Aq,Ar){var Au={x:0,y:0,w:0,h:0};if(Aq&&Aq.getBoundingClientRect){try{Au=Aq.getBoundingClientRect();}catch(At){Au={left:0,top:0,right:0,bottom:0,height:0,width:0};}Au={x:Au.left,y:Au.top,w:Au.right-Au.left,h:Au.bottom-Au.top};if(this.isIE6||this.isIE7){var Ap=Aq.ownerDocument;if(Ap){var Aw=Ap.documentElement,Av=Aw.getBoundingClientRect();Au.x-=Av.left;Au.y-=Av.top;}}}if(Ar){var As=AX();Au.x+=As.x;Au.y+=As.y;}return Au;},delta:function F(Ar,Ap){Ap=Ap||document.body;var Aq=this.position(Ar),As=this.position(Ap);return{x:Math.round(Aq.x-As.x),y:Math.round(Aq.y-As.y)};},windowDim:function Q(){var Ap=0,Ar=0,As=window,At=document,Au=At.documentElement,Aq=At.body;if(typeof (As.innerWidth)=="number"&&typeof (As.innerHeight)=="number"){Ap=As.innerWidth;Ar=As.innerHeight;}else{if(Au&&(Au.clientWidth||Au.clientHeight)){Ap=Au.clientWidth;Ar=Au.clientHeight;}else{if(Aq&&(Aq.clientWidth||Aq.clientHeight)){Ap=Aq.clientWidth;Ar=Aq.clientHeight;}}}return{w:Ap,h:Ar};},center:function AK(Ap){v.call(this,Ap,V,V);},bottomCenter:function E(Ap){v.call(this,Ap,V,Ab);},clearBrowserHighlights:function K(Ap){Ap=Ap||self;if(!Ap.getSelection){var Av=Ap.document,Au=Av&&Av.selection,As=Au&&Au.empty;if(As){try{Au.empty();}catch(Ar){}}}else{var Aq=Ap.getSelection,At=Aq&&Ap.getSelection();if(At&&!At.isCollapsed){if(At.empty){At.empty();}else{if(At.removeAllRanges){At.removeAllRanges();}}}}},findAncestorByAttr:function AQ(At,Ar,Aq,Ap){var Au=Aq?At:At&&At.parentNode;while(Au&&(Au!==Ap)){var As=Au.getAttribute&&Au.getAttribute(Ar);if(As!=null){return{node:Au,value:As};}Au=Au.parentNode;}return null;},findAncestorByName:function Ai(Ar,Au,Aq,Ap){Au=Au&&Au.toLowerCase();var As=Aq?Ar:Ar&&Ar.parentNode;while(As&&(As!==Ap)){var At=As.nodeName;if(At&&(At.toLowerCase()===Au)){return As;}As=As.parentNode;}return null;},contains:function I(As,At,Aq,Ap){var Ar=At;if(!Aq){Ar=Ar.parentNode;}while(Ar){if(Ar===As){return true;}if(Ar===Ap){break;}Ar=Ar.parentNode;}return false;},toggleSelection:function Ao(Aq,Ap){Aq.setAttribute("unselectable",Ap?"off":"on");mstrmojo.css.toggleClass(Aq,"unselectable",!Ap);Aq.onselectstart=function(){return Ap;};if(!Ap){this.clearBrowserHighlights();}},preventDefault:function U(Ap,Aq){Aq=Aq||Ap.event;if(Aq.preventDefault){Aq.preventDefault();}else{Aq.returnValue=false;}},stopPropogation:function M(Ap,Aq){Aq=Aq||Ap.event;if(Aq.stopPropagation){Aq.stopPropagation();}else{Aq.cancelBubble=true;}},firstTouch:function AW(Ap,Aq){return Aq&&Aq.touches&&Aq.touches.length?Aq.touches[0]:(Aq||Ap.event);},firstChangedTouch:function Ac(Ap,Aq){return Aq&&Aq.changedTouches&&Aq.changedTouches.length?Aq.changedTouches[0]:(Aq||Ap.event);},isLandscape:function T(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function AY(Ap){while(Ap){var Aq=Ap.mstrmojoId;if(Aq!==null&&Aq!==undefined){return mstrmojo.all[Aq];}Ap=Ap.parentNode;}return null;},setCaret:function G(Ap,Ar){if(Ap.setSelectionRange){Ap.focus();Ap.setSelectionRange(Ar,Ar);}else{if(Ap.createTextRange){var Aq=Ap.createTextRange();Aq.move("character",Ar);Aq.select();}}},setInputSelection:function Y(Ap){if(Ap.select){Ap.focus();Ap.select();}else{if(Ap.createTextRange){Ap.createTextRange().select();}}},setElementSelection:function a(Ar){if(window.getSelection){var Ap=document.createRange(),Aq=window.getSelection();Ap.selectNodeContents(Ar);Aq.removeAllRanges();Aq.addRange(Ap);}else{if(document.body.createTextRange){var As=document.body.createTextRange();As.moveToElementText(Ar);As.select();}}},getHorizontalScroll:function Al(){return AX().x;},getVerticalScroll:function AE(){return AX().y;},removeNode:function Af(Ar){var Aq=document.getElementById(Ar),Ap=Aq&&Aq.parentNode;if(Ap){return Ap.removeChild(Aq);}}});}());mstrmojo.vi.viz.EnumWidgetTypes={GRID:0,GRAPH_MATRIX:1,HEATMAP:2,NETWORK:3,IMAGELAYOUT:4,ESRIMAP:5,GOOGLEMAP:6,CUSTOM:7};mstrmojo.chart.model.enums.EnumDSSAxisName={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5,DssAxisDropZoneIndexRoot:8,DssAxisDropZoneIndexEnd:8+255,DssAxisDynamicShortcutRoot:300,DssAxisDynamicShortcutEnd:300+255};(function(){var C="xviPopopNode";function A(G){var H={};H[C]=G;return H;}mstrmojo.ui.menus._IsMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._IsMenuPopup",{init:function E(G){this._super(G);var J=this.popupConfig;if(!J){throw new Error("Cannot instantiate popup without supplying the popupConfig property.");}this.addDisposable(J);var H=mstrmojo.all[J.hostId],I=J.hostElement;if(J.isHostedWithin&&H&&I){H.addSlots(A(I));this.slot=C;}},closeAllMenus:function F(){var G=this.opener;if(G&&G.closePopup){G.closePopup();}if(G&&G.closeAllMenus){G.closeAllMenus();}},open:function B(H,G){if(this._super){this._super(H,G);}},close:function D(G){if(this.slot===C){this.opener.removeSlots(A(null));}if(this._super){this._super(G);}this.destroy();var H=mstrmojo.all[this.popupConfig.hostId];if(H){H.closePopup();}}});}());(function(){mstrmojo.cookies={};var C="%26",E="%3D",B=mstrmojo.cookies,D=function(){var F=document.cookie;if(!F||!(typeof F==="string")||F.indexOf("bSet")<0){return false;}return true;},A=function(){var F=document.cookie;F=F.split(";");for(s in F){if(F[s].indexOf("bSet")>=0){return F[s];}}return null;};mstrmojo.cookies.updateCookieSetting=function(H,N,J){try{if(!D()&&!J){return ;}var K=document.cookie,M=H+E+N+C;if(K.indexOf(H)>=0){var F=H+E,G=F+(B.getCookieSetting(H)||0),I=F+N;if(I!=G){document.cookie=K.replace(G,I);}}else{if(K.indexOf("bSet")>=0){document.cookie=K.replace("bSet=","bSet="+M);}else{if(J){document.cookie="bSet="+M+";"+K;}}}}catch(L){mstrmojo.alert(L);return ;}};mstrmojo.cookies.getCookieSetting=function(F){try{return B.getCookieList()[F];}catch(G){mstrmojo.alert(G);return ;}};mstrmojo.cookies.getCookieList=function(){try{if(!D()){return[];}var G=A(),F={},H=null;G=G.replace("bSet=","").split(C);for(H in G){H=G[H].split(E);F[H[0]]=H[1];}return F;}catch(I){mstrmojo.alert(I);return ;}};mstrmojo.cookies.enabledCookieOnBrowser=function(){var F=document.cookie;if(!F||!(typeof F==="string")){return false;}return true;};})();(function(){function A(C){return function B(H){if(!this.domNode){return 0;}var G=this.children;if(H!==undefined&&!isNaN(H)){G=(G&&[G[H-1]]);}var E=(G&&G.length)||0,D=0,F;for(F=0;F<E;F++){D+=G[F]["get"+C]();}return D;};}mstrmojo._CanMeasureChildren=mstrmojo.provide("mstrmojo._CanMeasureChildren",{getHeight:A("Height"),getWidth:A("Width")});}());mstrmojo.vi.viz.EnumAxisNames={RESERVED:0,ROWS:1,COLUMNS:2,PAGES:3,CHAPTERS:4,ALL:5};(function(){mstrmojo.imageUtils=mstrmojo.provide("mstrmojo.imageUtils",{compress:function(C,H,G){var E="image/jpeg";if(G==="png"||G==="image/png"){E="image/png";}var D=parseInt(H);D=D>1&&D<=100?D:100;var F=document.createElement("canvas");if(!!(F.getContext&&F.getContext("2d"))){F.width=C.naturalWidth;F.height=C.naturalHeight;F.getContext("2d").drawImage(C,0,0);var B=F.toDataURL(E,D/100);var A=new Image();A.src=B;return A;}return C;},dataURLToBlob:function(G){var A=";base64,",F,H,B;G=G||"";if(G.indexOf(A)===-1){F=G.split(",");H=F[0].split(":")[1];B=decodeURIComponent(F[1]);return new Blob([B],{type:H});}F=G.split(A);H=F[0].split(":")[1];B=window.atob(F[1]);var E=B.length;var D=new Uint8Array(E);for(var C=0;C<E;++C){D[C]=B.charCodeAt(C);}return new Blob([D],{type:H});}});})();(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());mstrmojo.vi.viz.EnumDSSDropZones={Reserved:0,Rows:1,Columns:2,XAxis:3,YAxis:4,BreakBy:5,SliceBy:6,ColorBy:7,SizeBy:8,AdditionalMetrics:9,Angle:10,Grouping:11,GeoAttribute:12,Layout:13,FromItem:14,ToItem:15,ItemSize:16,Latitude:17,Longitude:18};(function(){mstrmojo._IsSelectorTarget=mstrmojo.provide("mstrmojo._IsSelectorTarget",{_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(C){var D=(C?"add":"remove")+"DirtyKey",B=this.parent;if(B&&B[D]){this.parent[D](this.k);}}});}());(function(){var A={};mstrmojo.NumberFormat={getInstance:function B(F,G){var E=F+"--"+G;if(E in A){return A[E];}var C={parse:function(H){},format:function(H){}};if(F==="."&&G===","){C.parse=function(H){if(!H){return NaN;}var I=H.replace(/,/g,"");return Number(I);};C.format=function(H){return Number(H).toString();};}else{var D=new RegExp("\\"+G,"g");C.parse=function(I){if(!I){return NaN;}var H=I.replace(D,"").replace(F,".");return Number(H);};C.format=function(I){var H=Number(I).toString();return H.replace(".",F);};}A[E]=C;return C;}};})();mstrmojo.vi.viz.EnumVizStyles={GRAPH_MATRIX:"GraphMatrixVisualizationStyle",NETWORK:"NetworkVisualizationStyle",HEAT_MAP:"VIHeatMapVisualizationStyle",GOOGLE_MAP:"GoogleMapVisualizationStyle",ESRI_MAP:"ESRIMapVisualizationStyle",IMAGE_LAYOUT:"ImageLayoutVisualizationStyle"};mstrmojo._ShowsStatus=mstrmojo.provide("mstrmojo._ShowsStatus",{showStatus:function showStatus(A,G,D){var C=this._STATUS;if(!this.hasRendered||!C){return ;}var E=C.style;if(!A){if(this.showingStatus){E.display="none";}}else{if(C){var F=this._STATUS_TXT;if(F){F.innerHTML=G||"";}var B=this._STATUS_BAR;if(B){B.style.width=(D||0)+"%";}if(!this.isStatusBarPositioned){E.top=Math.max((this.scrollboxHeight||0)-50,12)+"px";this.isStatusBarPositioned=true;}if(!this.showingStatus){E.display="block";}}}this.showingStatus=A;},updateStatus:function updateStatus(A,B){this.showStatus(this.showingStatus,A,B);}});mstrmojo.LoadedExternalJSURLs={};function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function requiresMethod(B){if(!B){return false;}if(typeof this[B]==="function"){return true;}var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof A==="string"){this.requiresCls(A);return typeof this[B]==="function";}return false;},requiresCls:function req(mixins,callback){if(mixins){if(typeof mixins==="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin,i,len;for(i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof A==="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresExternalScripts(F,G,C){if(F&&F instanceof Array){if(F.length===0){if(G){G.call(C);}return false;}if(F[0]&&F[0].forceReload===false&&mstrmojo.LoadedExternalJSURLs[F[0].url]){F.splice(0,1);return this.requiresExternalScripts(F,G,C);}var A=document.createElement("script"),D=!!document.all,B=F[0].url;if(B.substr(0,7)==="file://"){B=B.substr(7);}else{if(mstrApp.isSingleTier&&B.substr(0,4)!=="http"){B="http:"+B;}}A.type="text/javascript";A.src=B;if(!F[0].callbackParamName){if(D){A.onreadystatechange=function(){if(A.readyState==="loaded"||A.readyState==="complete"){A.onreadystatechange=null;if(F.length>1){mstrmojo.LoadedExternalJSURLs[F.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(F,G);}else{if(F.length===1){mstrmojo.LoadedExternalJSURLs[F[0].url]=true;if(G){G.call(C);}}}}};}else{A.onload=function(){A.onload=null;if(F.length>1){mstrmojo.LoadedExternalJSURLs[F.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(F,G);}else{if(F.length===1){mstrmojo.LoadedExternalJSURLs[F[0].url]=true;if(G){G.call(C);}}}};}}else{if(F[0].callbackParamName.length!==0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy===true){var E=this;window.setTimeout(function(){E.requiresExternalScripts(F,G,C);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+F[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=F;mstrmojo._LoadsScript.callback=G;mstrmojo._LoadsScript.esScritsContext=C;}}document.getElementsByTagName("head")[0].appendChild(A);}}});mstrmojo.chart.model.enums.EnumDSSGraphMarkerShape={DssGraphMarkerShapeNone:0,DssGraphMarkerShapeRectangle:1,DssGraphMarkerShapeStar45:2,DssGraphMarkerShapePlus:3,DssGraphMarkerShapeCircle:4,DssGraphMarkerShapeDiamond:5,DssGraphMarkerShapeSpikedX:6,DssGraphMarkerShapePlainX:7,DssGraphMarkerShapeTriangle1:8,DssGraphMarkerShapeFatPlus:10,DssGraphMarkerShapeSquare:24,DssGraphMarkerShapeHouse:27,DssGraphMarkerShapeStar5:37,DssGraphMarkerShapeGMTick:200,DssGraphMarkerShape2DPie:201,DssGraphMarkerShape2DRingPie:202,DssGraphMarkerShapeCombined:203,DssGraphMarkerShapeGMPolyLine:204,DssGraphMarkerShapeGMBar:205,DssGraphMarkerShapeGMArea:206,DssGraphMarkerBullet:207};mstrmojo.EnumDSSDisplayMode={RESERVED:0,GRID:1,GRAPH:2,ENGINE:3,TEXT:4,DATAMART:5,BASE:6,GRIDGRAPH:7,NONINTERACTIVE:8};mstrmojo.chart.model.enums.EnumDSSGraphObject={DssGraphNull:-3,DssGraphBackground:1,DssGraphFrame:2,DssGraphFootnote:3,DssGraphSubtitle:4,DssGraphTitle:5,DssGraphLegendArea:6,DssGraphLegendLine:7,DssGraphLegendMarker:8,DssGraphLegendText:9,DssGraphCurve:257,DssGraphDataLine:258,DssGraphDataMarker:259,DssGraphDataText:260,DssGraphDivBiPolar:261,DssGraphErrorBar:262,DssGraphLinrExp:263,DssGraphLinrLine:264,DssGraphLinrLog:265,DssGraphLinrNatLog:266,DssGraphLinrNPoly:267,DssGraphLinrText:268,DssGraphMeanLine:269,DssGraphMovAvgLine:270,DssGraphO1Body:271,DssGraph2DO1Label:272,DssGraphO1Major:273,DssGraphO1Minor:274,DssGraphO1Super:275,DssGraphO1Title:276,DssGraphO2Body:277,DssGraph2DO2Label:278,DssGraphO2Major:279,DssGraphO2Minor:280,DssGraphO2Title:281,DssGraphConnectDataLine:282,DssGraphRiser:286,DssGraphRiserShadow:287,DssGraphStdDevLine:288,DssGraphX1Body:289,DssGraphX1Label:290,DssGraphX1Major:291,DssGraphX1Minor:292,DssGraphXTitle:293,DssGraphY1Body:295,DssGraphY1Label:296,DssGraphY1Major:297,DssGraphY1Minor:298,DssGraphY1Title:299,DssGraphY2Body:301,DssGraphY2Label:302,DssGraphY2Major:303,DssGraphY2Minor:304,DssGraphY2Title:305,DssGraph3DShowColumnHeaders:318,DssGraph3DShowLeftHeaders:321,DssGraph3DShowRightHeaders:323,DssGraph3DShowRowHeaders:325,DssGraphOBPBox:329,DssGraphOBPMedian:330,DssGraphOBPStem:331,DssGraphOBPTail:332,DssGraphPieFeelerLine:337,DssGraphPieFeelerLabel:338,DssGraphPieGroupLabel:339,DssGraphPieRingLabel:340,DssGraphPieSlice:341,DssGraphSeriesTitle:398,DssGraphConnectStackLine:399,DssGraphDataTextStackTotal:401,DssGraphOPILBLValue:418,DssGraphUserLine1:414,DssGraphUserLine2:415,DssGraphUserLine3:416,DssGraphUserLine4:417,DssGraphDataTextConnectLine:431,DssGraphGauge:444,DssGraphGaugeTitle:450,DssGraphGaugeRange:451,DssGraphY3Body:477,DssGraphY3Label:478,DssGraphY3Major:479,DssGraphY3Minor:480,DssGraphY4Body:483,DssGraphY4Label:484,DssGraphY4Major:485,DssGraphY4Minor:486,DssGraph3DColHeader:512,DssGraph3DColTitle:515,DssGraph3DDataText:518,DssGraph3DRowHeader:552,DssGraph3DRowTitle:555,DssGraph3DRYHeader:558,DssGraph3DRYTitle:561,DssGraphGaugeBorder:1319,DssGraphGaugeNeedleBase:1320,DssGraphGaugeNeedleBaseLine:1330,DssGraphZBody:10003,DssGraphTrendLine:10004,DssGraphY1RightBody:10005,DssGraphY1RightTitle:10006,DssGraphReferenceLine:10007,DssGraphStraightLine:10008,DssGraphTargetLine:10009,DssGraphRefLineText:10010,DssGraphTrendLineText:10011,DssGraphUserLabel1:100100,DssGraphUserLabel2:100101,DssGraphUserLabel3:100102,DssGraphUserLabel4:100103,DssGraphX2Body:100200,DssGraphX2Label:100201,DssGraphX2Major:100202,DssGraphX2Minor:100203,DssGraphX2Title:100204};mstrmojo.chart.model.enums.EnumDSSGraphProperty={DssGraphTextContent:9999,DssGraphContent:9999,DssGraphPropertyReserved:0,DssGraphAutoFitO1:4,DssGraphAutoFitO2:5,DssGraphAutoFitX:6,DssGraphAutoFitY1:7,DssGraphAutoFitY2:8,DssGraphGroupSpacing:10,DssGraphRiserWidth:11,DssGraphColorBySeries:12,DssGraphCurveColorAsSeries:13,DssGraphSDMOVAFactor:14,DssGraph2DAngle:18,DssGraph2DDepth:20,DssGraphDepthMode:21,DssGraph2ScaleDirectionX:22,DssGraph2ScaleDirectionY1:23,DssGraph2ScaleDirectionY2:24,DssGraph2ExcludeZeroX:25,DssGraph2ExcludeZeroY1:26,DssGraph2ExcludeZeroY2:27,DssGraphFormatDataTextX:28,DssGraphFormatDataTextY1:29,DssGraphFormatDataTextY2:30,DssGraphFormatX:33,DssGraphFormatY1:34,DssGraphFormatY2:35,DssGraphFormatZ:36,DssGraphGridLineO1:37,DssGraphGridLineO2:38,DssGraphGridLineX:39,DssGraphGridLineY1:40,DssGraphGridLineY2:41,DssGraphLabelModeO1:48,DssGraphLabelModeO2:49,DssGraphLegendLocation:52,DssGraphTitleXLocation:54,DssGraphTitleY1Location:55,DssGraphTitleY2Location:56,DssGraph2LogScaleX:57,DssGraph2LogScaleY1:58,DssGraph2LogScaleY2:59,DssGraphMarkerShape:60,DssGraphMarkerSize:61,DssGraph2DPlaceX:65,DssGraph2DPlaceY1:66,DssGraph2DPlaceY2:67,DssGraphConnectLine:68,DssGraphShowStepLine:70,DssGraph2ScaleEndX:74,DssGraph2ScaleEndY1:75,DssGraph2ScaleEndY2:76,DssGraph2DScaleFreqO1:87,DssGraph2DScaleFreqO2:88,DssGraph2DScaleFreqX:89,DssGraph2DScaleFreqY1:90,DssGraph2DScaleFreqY2:91,DssGraphScaleX:92,DssGraphScaleY1:93,DssGraphScaleY2:94,DssGraphShowSDDataLineType:96,DssGraphSDRiserType:97,DssGraphShowSDLine:98,DssGraphShowSDCurve:99,DssGraphShowSDLinrCorr:101,DssGraphShowSDLinrExp:102,DssGraphShowSDLinrFormula:103,DssGraphShowSDLinrLine:104,DssGraphShowSDLinrLog:105,DssGraphShowSDLinrNatLog:106,DssGraphShowSDLinrNPoly:107,DssGraphSDPolyFactor:108,DssGraphShowSDMeanLine:109,DssGraphShowSDMOVALine:110,DssGraphShowSDSTDDLine:111,DssGraphShowDataText:113,DssGraphShowDivBiPolar:114,DssGraphShowErrorBar:115,DssGraphShowLegendText:116,DssGraphShow2DO1Label:117,DssGraphShow2DO1:-117,DssGraphShow2DO2:118,DssGraphOffScaleTypeX:119,DssGraphOffScaleTypeY1:120,DssGraphOffScaleTypeY2:121,DssGraphShowQuadrants:122,DssGraphShowRiserShadows:123,DssGraphShow2DXTitle:124,DssGraphShow2DY1Title:125,DssGraphShow2DY2Title:126,DssGraphShow2DXLabel:127,DssGraphShow2DX:-127,DssGraphShow2DY1Label:128,DssGraphShow2DY1:-128,DssGraphShow2DY2Label:129,DssGraphShow2DY2:-129,DssGraphShowZeroLineX:130,DssGraphShowZeroLineY1:131,DssGraphShowZeroLineY2:132,DssGraph2DSideO1:133,DssGraph2DSideO2:134,DssGraph2DSideX:135,DssGraph2DSideY1:136,DssGraph2DSideY2:137,DssGraph2DSDSplitY:140,DssGraphStaggerO1:142,DssGraphStaggerO2:143,DssGraphStaggerX:144,DssGraphStaggerY1:145,DssGraphStaggerY2:146,DssGraphUniformBorders:148,DssGraphPieDepthValue:192,DssGraphPieHoleSizeValue:198,DssGraphPieInset:200,DssGraphPiesPerRowValue:201,DssGraphPieRotationValue:202,DssGraphShowFeeler:204,DssGraphShowLBLFeelerLabel:205,DssGraphShowLBLFeeler:-205,DssGraphShowLBLPie:206,DssGraphShowLBLRing:207,DssGraphDeleteSlice:208,DssGraphDetachSlice:209,DssGraphPieRestore:210,DssGraphPieTiltValue:211,DssGraphPieTiltOn:212,DssGraphShowPolarCoordinateAxis:215,DssGraphShowPolarConnectLines:218,DssGraphStockDataValueType:222,DssGraphShowBubbleGrid:245,DssGraphSDShowDataText:247,DssGraphShowTitleSeries:248,DssGraphConnectStackBars:249,DssGraphLegendBox:250,DssGraphLinkColors:260,DssGraph3DCustomView:265,DssGraph3DGridFloor:277,DssGraph3DGridLWall:278,DssGraph3DGridRiser:279,DssGraph3DGridRWall:280,DssGraph3DColTitleLocation:285,DssGraph3DLYTitleLocation:287,DssGraph3DRowTitleLocation:288,DssGraph3DRYTitleLocation:289,DssGraph3DScalefreqX:299,DssGraph3DScalefreqY:300,DssGraph3DScalefreqZ:301,DssGraphShow3DScatterLine:308,DssGraphShow3DLineToLWall:309,DssGraphShow3DLineToFloor:310,DssGraphShow3DLineToRWall:311,DssGraphSD3DRiserType:312,DssGraphShow3DShowDataLabelsBox:313,DssGraph3DOffScaleTypeX:314,DssGraph3DOffScaleTypeY:315,DssGraph3DOffScaleTypeZ:316,DssGraphShow3DCHeader:318,DssGraphShow3DColTitle:319,DssGraph3DShowDataText:320,DssGraphShow3DLNumber:321,DssGraphShow3DLYTitle:322,DssGraphShow3DRNumber:323,DssGraphShow3DRYTitle:324,DssGraphShow3DRHeader:325,DssGraphShow3DRowTitle:326,DssGraphShow3DFloor:327,DssGraphShow3DLegend:328,DssGraphShow3DLWall:329,DssGraphShow3DRWall:330,DssGraph3DViewStruct:337,DssGraphACMColorModel:549,DssGraphLegendItems:554,DssGraphSeriesColor:556,DssGraphReverseGroup:558,DssGraphReverseSeries:559,DssGraphSeriesByColumn:560,DssGraphAreaBackColor:561,DssGraphAreaTransparency:563,DssGraphAreaColor:564,DssGraphAreaPattern:566,DssGraphAreaSFX:567,DssGraphFontAlign:570,DssGraphFontTransparency:573,DssGraphFontColor:574,DssGraphFontName:576,DssGraphFontRotation:578,DssGraphVirtualFontSize:583,DssGraphFontStyle:584,DssGraphType:585,DssGraphLineTransparency:587,DssGraphLineColor:588,DssGraphLinePattern:589,DssGraphVirtualLineWidth:591,DssGraphFootnoteLocation:592,DssGraphFrameLocation:593,DssGraphSubTitleLocation:594,DssGraphTitleLocation:595,DssGraphShowfootnote:596,DssGraphShowSubtitle:597,DssGraphShowTitle:598,DssGraphFontBox:601,DssGraphFontSize:603,DssGraphLockFontSize:604,DssGraphLineWidth:605,DssGraphAreaAlpha:608,DssGraphLineAlpha:609,DssGraphFontAlpha:610,DssGraphAreaCustomBevelEffect:612,DssGraphFormatDataTextAdv:616,DssGraphFormatXAdv:618,DssGraphFormatY1Adv:619,DssGraphFormatY2Adv:620,DssGraphFormatZAdv:621,DssGraphMiddleValue:630,DssGraphSplitYPosition:631,DssGraphAxisShowUserLine:632,DssGraphAxisUserLineValue:633,DssGraphAxisUserLineAxis:634,DssGraphMarkerLayout:637,DssGraphPieDataValueLoc:638,DssGraphPieDataLabelLoc:639,DssGraph2DOrdSpaceMode:642,DssGraphLegendLock:644,DssGraphGridStepY1:645,DssGraphGridStepY2:646,DssGraphGridStepX:647,DssGraphDataTextShowConnectLine:652,DssGraphGridLineZ:658,DssGraphScaleZ:659,DssGraphStaggerZ:660,DssGraph2ScaleEndZ:662,DssGraph2ExcludeZeroZ:663,DssGraph2ScaleDirectionZ:664,DssGraphGridStepZ:665,DssGraphGaugeInfo:668,DssGraphGaugeFancyBox:669,DssGraphSDMarkerSize:671,DssGraphSDMarkerShape:683,DssGraphMetric1:690,DssGraphMetric2:691,DssGraphStockStyle:692,DssGraph2ScaleDirectionY3:693,DssGraph2ExcludeZeroY3:694,DssGraphGridLineY3:697,DssGraphFormatY3Adv:699,DssGraphGridStepY3:701,DssGraphOffScaleTypeY3:702,DssGraphShow2DY3:704,DssGraph2DSideY3:706,DssGraphStaggerY3:707,DssGraph2DPlaceY3:709,DssGraph2ScaleEndY3:710,DssGraph2DScaleFreqY3:713,DssGraphScaleY3:714,DssGraph2ScaleDirectionY4:715,DssGraph2ExcludeZeroY4:716,DssGraphGridLineY4:719,DssGraphFormatY4Adv:721,DssGraphGridStepY4:723,DssGraphOffScaleTypeY4:724,DssGraphShow2DY4:726,DssGraph2DSideY4:728,DssGraphStaggerY4:729,DssGraph2DPlaceY4:731,DssGraph2ScaleEndY4:732,DssGraph2DScaleFreqY4:735,DssGraphScaleY4:736,DssGraphSpiderLines:739,DssGraphPolarStartAngle:740,DssGraphMetric3:742,DssGraphRadarCircularDataLines:782,DssGraphRemoteAxis:784,DssGraphConnectFirstLast:790,DssGraphGaugeShowAxisLabelsOutside:791,DssGraphGaugeShowNeedle:792,DssGraphTailShape:793,DssGraphPieForceRound:794,DssGraphGaugeStyleValue:795,DssGraphGaugeBorderStyleValue:796,DssGraphGaugeBorderThicknessValue:797,DssGraphGaugeRangeThicknessValue:798,DssGraphGaugeRangeStartAngleValue:799,DssGraphGaugeRangeStopAngleValue:800,DssGraphGaugeNeedleStyleValue:801,DssGraphCurvedLines:804,DssGraphAreaBevelEffect:879,DssGraphFontAntiAlias:881,DssGraphFormatDataTextY3:695,DssGraphFormatDataTextY4:717,DssGraphColorPalette:10000,DssGraphOriContent:10001,DssGraphFillEffect:10002,DssGraphGradient:10003,DssGraphSDShowToolTip:10004,DssGraphSDToolTip:10005,DssGraphSDRegressionType:10006,DssGraph2LogScale:10007,DssGraphManualMajor:10008,DssGraphManualMinor:10009,DssGraph2ScaleDirection:10010,DssGraphShow2DAxisLine:10011,DssGraph2ExcludeZero:10012,DssGraph2ScaleUseMax:10013,DssGraph2ScaleUseMin:10014,DssGraph2ScaleMax:10015,DssGraph2ScaleMin:10016,DssGraphShow2DAxisLabels:10017,DssGraph2ScaleEndMax:10018,DssGraph2ScaleEndMin:10019,DssGraphShow2DAxisMajor:10020,DssGraphShow2DAxisMinor:10021,DssGraph2DSide:10022,DssGraphStyleMajor:10023,DssGraphStyleMinor:10024,DssGraphCountMajor:10025,DssGraphCountMinor:10026,DssGraphShowTotalValue:10027,DssGraph2DPie:10028,DssGraphShowDataValue:10029,DssGraphShowDVPercent:10030,DssGraphShowDataLabel:10031,DssGraphShowPieLabelOnSide:10032,DssGraphShowMarker:10033,DssGraphShowMetric1:10034,DssGraphShowMetric2:10035,DssGraphShowMetric3:10036,DssGraphMetric1Style:10037,DssGraphMetric2Style:10038,DssGraphMetric3Style:10039,DssGraphShowLine:10040,DssGraphShowToolTip:10041,DssGraphToolTip:10042,DssGraphAxisAutoFit:10043,DssGraphAxisStagger:10044,DssGraphAxisScaleFreq:10045,DssGraphMetric1Value:10046,DssGraphMetric2Value:10047,DssGraphMetric3Value:10048,DssGraph2AxisFormatText:10049,DssGraph2AxisFormatDataText:10050,DssGraphDPI:10051,DssGraphDocSize:10052,DssGraphAutoArrange:10053,DssGraph2DSplitYAutomatic:10054,DssGraphHistogramRangeMin:10055,DssGraphHistogramRangeMax:10056,DssGraphHistogramBuckets:10057,DssGraphGaugeSAngle:10058,DssGraphGaugeEAngle:10059,DssGraphGaugeThickness:10060,DssGraphGauge1Show:10061,DssGraphGauge1Min:10062,DssGraphGauge1Max:10063,DssGraphGauge2Show:10064,DssGraphGauge2Min:10065,DssGraphGauge2Max:10066,DssGraphGauge3Show:10067,DssGraphGauge3Min:10068,DssGraphGauge3Max:10069,DssGraphGauge4Show:10070,DssGraphGauge4Min:10071,DssGraphGauge4Max:10072,DssGraphGauge5Show:10073,DssGraphGauge5Min:10074,DssGraphGauge5Max:10075,DssGraphAxisDataTextPlace:10076,DssGraphAxisNumberFormat:10077,DssGraphAxisDataNumberFormat:10078,DssGraphAxisHasErrorBar:10079,DssGraphAxisHasMiddleValue:10080,DssGraphHeight:10081,DssGraphWidth:10082,DssGraphPicture:10083,DssGraph3DTurnXCounterClockwise:10084,DssGraph3DTurnYCounterClockwise:10085,DssGraph3DTurnZCounterClockwise:10086,DssGraph3DTurnXClockwise:10087,DssGraph3DTurnYClockwise:10088,DssGraph3DTurnZClockwise:10089,DssGraph3DMoveXTowardsOrigin:10090,DssGraph3DMoveYTowardsOrigin:10091,DssGraph3DMoveZTowardsOrigin:10092,DssGraph3DMoveXAwayFromOrigin:10093,DssGraph3DMoveYAwayFromOrigin:10094,DssGraph3DMoveZAwayFromOrigin:10095,DssGraph3DDecreaseCubeX:10096,DssGraph3DDecreaseCubeY:10097,DssGraph3DDecreaseCubeZ:10098,DssGraph3DIncreaseCubeX:10099,DssGraph3DIncreaseCubeY:10100,DssGraph3DIncreaseCubeZ:10101,DssGraph3DDecreaseWallX:10102,DssGraph3DDecreaseWallY:10103,DssGraph3DDecreaseWallZ:10104,DssGraph3DIncreaseWallX:10105,DssGraph3DIncreaseWallY:10106,DssGraph3DIncreaseWallZ:10107,DssGraph3DPanXLeft:10108,DssGraph3DPanYUp:10109,DssGraph3DRelative:10110,DssGraph3DPanXRight:10111,DssGraph3DPanYDown:10112,DssGraph3DAbsolute:10113,DssGraph3DZoomIn:10114,DssGraph3DIncreasePerspectiveDistortion:10115,DssGraph3DStepSize:10116,DssGraph3DZoomOut:10117,DssGraph3DDecreasePerspectiveDistortion:10118,DssGraph3DInitMatrix:10119,DssGraphGaugeQBShow:10120,DssGraphGaugeQBStart:10121,DssGraphGaugeQBStop:10122,DssGraphEnhancedSeriesEffect:10123,DssGraphLocale:10124,DssGraph3DViewStructName:10125,DssGraphLabelsDistance:10126,DssGraphLegendDetails:10127,DssGraphDefaultsInitialized:10128,DssGraphShow3DAxisMajor:10129,DssGraphGradientColorMode:10130,DssGraphLegendDetailsNEW:10131,DssGraphFrameLocationNEW:10132,DssGraph3DColTitleLocationNEW:10133,DssGraph3DRowTitleLocationNEW:10134,DssGraphLabelsDistanceNEW:10135,DssGraphDocSizeNEW:10136,DssGraphUseManualHistogramBuckets:10137,DssGraphFontSize100:10138,DssGraphUseSpecialSeries:10140,DssGraphIsOnlyAdditionalMetrics:10170};mstrmojo.vi.models.EnumDragSources={DATASETS:1,VIZ_EDITOR:2,FILTERS:3,ALL_OBJECT_LIST:4,VIZ:5};mstrmojo.chart.enums.EnumGraphMajorType={GMT_INVALID:0,GMT_CATEGORY:1,GMT_PIE:2,GMT_SCATTER:3,GMT_POLAR:4,GMT_RADAR:5,GMT_BUBBLE:6,GMT_STOCK:7,GMT_HISTOGRAM:8,GMT_GAUGE:9,GMT_FUNNEL:10,GMT_BOX:11,GMT_GANTT:12,GMT_SPECTRAL:13,GMT_TABLE:14,GMT_3D_CATEGORY:15,GMT_3D_SCATTER:16,GMT_GRID:17};mstrmojo.chart.model.enums.EnumDSSGraphDataTextShowType={DssGraphDataTextNone:0,DssGraphDataTextValue:1,DssGraphDataTextLabel:2,DssGraphDataTextBoth:3,DssGraphDataTextAbs:4,DssGraphDataTextAbsValue:5,DssGraphDataTextAbsBoth:7,DssGraphDataTextTotal:8,DssGraphDataTextZValue:16,DssGraphDataTextPercent:32,DssGraphDataTextYValue:64,DssGraphDataTextInternal:128,DssGraphDataTextSeriesDependent:256,DssGraphDataTextQualityObjectMode:512};(function(){mstrmojo.mstr.search._IconCssClassBuilder=mstrmojo.provide("mstrmojo.mstr.search._IconCssClassBuilder",{_mixinName:"mstrmojo.mstr.search._IconCssClassBuilder",getIconCssClass:function A(B){B=B||this.data;return"t"+B.t+(B.st?" st"+B.st:"")+(B.isc?" isc":"")+(B.dvm?" dvm"+B.dvm:"");}});}());mstrmojo.mstr.EnumDSSXMLBaseFormType={DssXmlBaseFormReserved:0,DssXmlBaseFormHidden:-1,DssXmlBaseFormDateTime:1,DssXmlBaseFormNumber:2,DssXmlBaseFormText:3,DssXmlBaseFormPicture:4,DssXmlBaseFormUrl:5,DssXmlBaseFormEmail:6,DssXmlBaseFormHTMLTag:7,DssXmlBaseFormDate:8,DssXmlBaseFormTime:9,DssXmlBaseFormSymbol:10,DssXmlBaseFormBigDecimal:11,DssXmlBaseFormPhoneNumber:12};mstrmojo.mstr.EnumDSSXMLBaseFormType.convertDataType2BaseFormType=function(B){var A={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2};return A[B]||0;};(function(){var A=/^mstrmojo./;mstrmojo.DynamicClassFactory={newComponent:function(C,B,F){var H=C.prototype.scriptClass.replace(A,"");for(var E=0,D=B&&B.length||0;E<D;E++){if(!B[E]._mixinName){throw new Error('Mixins must have a "_mixinName" property to be used with DynamicClassFactory');}H+="_"+B[E]._mixinName.replace(A,"");}var G=mstrmojo[H];if(!G){G=mstrmojo.declare(C,B,F);mstrmojo[H]=G;}return G;}};}());mstrmojo.gmaps.MapEnums={};mstrmojo.gmaps.EnumMapType={Marker:"1",Bubble:"2",Area:"3",Density:"4",Path:"5"};mstrmojo.gmaps.PropertyTypes={mapType:"mtp",clusterMode:"mc",shapeFile:"lid",mapStyle:"dv",themeType:"dms",markerType:"mtp",redrawType:"rosa",legendSwitch:"ls",legendWidthScale:"lwr"};mstrmojo.gmaps.EnumGeographicRole={EnumGeographicRoleNone:"0",EnumGeographicRoleCity:"1",EnumGeographicRoleState:"2",EnumGeographicRoleCountry:"3",EnumGeographicRoleLocation:"4",EnumGeographicRoleLatitiude:"5",EnumGeographicRoleLongitude:"6",EnumGeographicRoleOther:"7",EnumGeographicRoleZipCode:"8",EnumGeographicRoleCounty:"9",EnumGeographicRoleLastOne:"10"};mstrmojo.gmaps.EnumClusterMode={MOBILE_OFF:"0",MOBILE_ON:"1",ON:"2",OFF:"3",PIE:"4"};mstrmojo.gmaps.EnumZoomBehavior={Keep:"0",Automatic:"1"};mstrmojo.gmaps.EnumDataLabel={DATA_LABEL_SHOW:"dlShw",DATA_LABEL_SHOW_ALL:"dlShwAll",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle"};mstrmojo.gmaps.EnumDataLabelShowOption={NONE:0,SHOW_TEXT:1,SHOW_VALUE:2,SHOW_BOTH:3};mstrmojo.gmaps.MarkerAlignOption={CENTER:0,TOP:1,LEFT:2,RIGHT:3,BOTTOM:4,TOP_LEFT:5,TOP_RIGHT:6,BOTTOM_LEFT:7,BOTTOM_RIGHT:8};(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());(function(){var B={NetworkVisualizationStyle:{vib:"vi-network.js",oivmb:"oivm-network.js",b:"vi-network.js",s:"VisualizationServerJsonDataStyle",c:"netviz.VisNetwork"},GraphMatrixVisualizationStyle:{vib:"vi-gm.js",oivmb:"oivm-gm.js",b:"vi-gm.js",s:"VisualizationServerJsonDataStyle",c:"gm.VisGraphMatrix"},SurveyVisualizationStyle:{s:"VisualizationDataStyle",c:"SurveyVis"},ReportTimelineAjaxVisualizationStyle:{s:"TimelineMojoVisualizationDataStyle",c:"VisTimeline"},VIHeatMapVisualizationStyle:{vib:"vi-heatmap.js",oivmb:"oivm-heatmap.js",b:"vi-heatmap.js",s:"VisualizationServerJsonDataStyle",c:"heatmap.vi.VisHeatMap"},visAjaxDatePicker:{s:"AjaxDatePickerReportStyle",c:"VisDateSelection"},ESRIMapVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"esrimap.ESRIMapOIVM"}};var E={"com.microstrategy.web.vf.viewer.DatePickerApplicationViewer":"visAjaxDatePicker","com.microstrategy.web.vf.viewer.EsriMapApplicationViewer":"ESRIMapVisualizationStyle","com.microstrategy.flex.viewer.NetViz":"NetworkVisualizationStyle","com.microstrategy.flex.viewer.GraphMatrixViewer":"GraphMatrixVisualizationStyle","com.microstrategy.web.vf.viewer.HeatMapApplicationViewer":"VIHeatMapVisualizationStyle"};mstrmojo.ExpressVisList=mstrmojo.provide("mstrmojo.ExpressVisList",{getVis:function D(F){return B[F]||(mstrConfig&&mstrConfig.pluginsVisList&&mstrConfig.pluginsVisList[F])||null;},findVisName:function(F){return E[F]||(mstrConfig&&mstrConfig.pluginsWidgetVisMap[F])||null;},findWidgetName:function C(H){var G;for(var F in E){if(E.hasOwnProperty(F)&&E[F]===H){G=F;break;}}if(!G&&mstrConfig&&mstrConfig.pluginsWidgetVisMap){for(var F in mstrConfig.pluginsWidgetVisMap){if(mstrConfig.pluginsWidgetVisMap.hasOwnProperty(F)&&mstrConfig.pluginsWidgetVisMap[F]===H){G=F;break;}}}return G;},getVisClass:function A(F,G){if(G.txi&&G.t===115){F=mstrmojo.DynamicClassFactory.newComponent(F,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return F;}});}());mstrmojo.chart.model.enums.EnumDSSObjectType={DssTypeUnknown:-1,DssTypeReserved:0,DssTypeGeneric:5,DssTypeFormatBAD:46,DssTypeFilter:1,DssTypeTemplate:2,DssTypeReportDefinition:3,DssTypeMetric:4,DssTypeStyle:6,DssTypeAggMetric:7,DssTypeFolder:8,DssTypeDevice:9,DssTypePrompt:10,DssTypeFunction:11,DssTypeAttribute:12,DssTypeFact:13,DssTypeDimension:14,DssTypeTable:15,DssTypeDatamartReport:16,DssTypeFactGroup:17,DssTypeShortcut:18,DssTypeResolution:19,DssTypeMonitor:20,DssTypeAttributeForm:21,DssTypeSchema:22,DssTypeFormat:23,DssTypeCatalog:24,DssTypeCatalogDefn:25,DssTypeColumn:26,DssTypePropertyGroup:27,DssTypePropertySet:28,DssTypeDBRole:29,DssTypeDBLogin:30,DssTypeDBConnection:31,DssTypeProject:32,DssTypeServerDef:33,DssTypeUser:34,DssTypeTransmitter:35,DssTypeConfiguration:36,DssTypeRequest:37,DssTypeScript:38,DssTypeSearch:39,DssTypeSearchFolder:40,DssTypeDatamart:41,DssTypeFunctionPackageDefinition:42,DssTypeRole:43,DssTypeSecurityRole:44,DssTypeLocale:45,DssTypeConsolidation:47,DssTypeConsolidationElement:48,DssTypeScheduleEvent:49,DssTypeScheduleObject:50,DssTypeScheduleTrigger:51,DssTypeLink:52,DssTypeDbTable:53,DssTypeTableSource:54,DssTypeDocumentDefinition:55,DssTypeDrillMap:56,DssTypeDBMS:57,DssTypeMDSecurityFilter:58,DssTypePromptAnswer:59,DssTypePromptAnswers:60,DssTypeGraphStyle:61,DssTypeChangeJournalSearch:62,DssTypeNCSObjects:255,DssTypeReservedLastOne:63};(function(){mstrmojo.boxmodel=mstrmojo.provide("mstrmojo.boxmodel",{rangeIntersect:function E(J,H,I,G){if(J<I){return I<=H;}if(J>I){return J<=G;}return true;},px2Inches:function C(H,G){G=parseInt(G,10);return mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep).format(parseFloat((G/H.zf/H.dpi).toFixed(4)));},offset:function F(I,H){var L=I,G=0,K=0;while(I){G+=I.offsetLeft;K+=I.offsetTop;I=I.offsetParent;if(I===H){break;}}var J;for(J=L&&L.parentNode;J&&J!==H;J=J.parentNode){if(J.scrollTop){K-=J.scrollTop;}if(J.scrollLeft){G-=J.scrollLeft;}}return{left:G,top:K};},convert2px:function D(K,I){if(!/px$/.test(I)){var H=document.createElement("img"),G=H.style,J;G.zIndex=-1;G.left=I;K.appendChild(H);J=G.pixelLeft;K.removeChild(H);return J+"px";}return I;},getEdgeQuadrantByPoint:function B(I,H){var G=H.x-I.x,M=H.y-I.y,J=I.w,L=I.h,K=[["Left","Bottom"],["Top","Right"]];if(M>L/J*G){K=K[0];}else{K=K[1];}return(M<-L/J*G+L)?K[0]:K[1];},isPtInPolygon:function A(I,K){var G=I.x,J=I.y,H=false;K.forEach(function(N,L){var M=K[L-1]||K[K.length-1];if((N.y>=J)!==(M.y>=J)){if((G<(M.x-N.x)*(J-N.y)/(M.y-N.y)+N.x)){H=!H;}}});return H;}});}());mstrmojo.mstr.EnumDSSXMLObjectTypes={Generic:-2,Unknown:-1,Reserved:0,Filter:1,Template:2,ReportDefinition:3,Metric:4,Style:6,AggMetric:7,Folder:8,SubscriptionDevice:9,Prompt:10,Function:11,Attribute:12,Fact:13,Dimension:14,Table:15,DatamartReport:16,FactGroup:17,Shortcut:18,Resolution:19,Monitor:20,AttributeForm:21,Schema:22,Format:23,Catalog:24,CatalogDefn:25,Column:26,PropertySet:28,DBRole:29,DBLogin:30,DBConnection:31,Project:32,ServerDef:33,User:34,Configuration:36,Request:37,Script:38,Search:39,SearchFolder:40,Datamart:41,FunctionPackageDefinition:42,Role:43,SecurityRole:44,Locale:45,Consolidation:47,ConsolidationElement:48,ScheduleEvent:49,ScheduleObject:50,ScheduleTrigger:51,Link:52,DbTable:53,TableSource:54,DocumentDefinition:55,DrillMap:56,DBMS:57,MDSecurityFilter:58,PromptAnswer:59,PromptAnswers:60,ObjectTag:65,ReservedLastOne:66};mstrmojo.mstr.EnumNodeDimty={NodeDimtyReserved:0,NodeDimtyNone:1,NodeDimtyContinuation:2,NodeDimtyExclusiveContinuation:3,NodeDimtyOutputLevel:4,NodeDimtyBreakBy:5,NodeDimtyEmbedded:6,NodeDimtyUnspecified:7};mstrmojo.chart.enums.EnumFontStyle={FS_NORMAL:0,FS_BOLD:1,FS_ITALIC:2,FS_BOTH:3,FS_UNDERLINE:4,FS_STRIKETHROUGH:8};mstrmojo.chart.model.enums.EnumDSSBaseFormType={DssBaseFormReserved:0,DssBaseFormDateTime:1,DssBaseFormNumber:2,DssBaseFormText:3,DssBaseFormPicture:4,DssBaseFormUrl:5,DssBaseFormEmail:6,DssBaseFormHTMLTag:7,DssBaseFormDate:8,DssBaseFormTime:9,DssBaseFormSymbol:10,DssBaseFormBigDecimal:11};mstrmojo.vi.models.EnumFieldTypes={TEXT:3,IMAGE:2,HTML_CONTAINER:10};mstrmojo.vi.models.EnumPanelTypes={FILTERS:1,VIS_CONTENT:2,PAGEBY:3,VISUALIZATION:4};mstrmojo.vi.viz.EnumVisualizationTemplates={UNKNOWN_GRAPHMATRIX_TYPE:-1,GRID:0,HEATMAP:1,GOOGLEMAP:2,PIE:3,RING:4,GRAPHMATRIXVERTICALBARSTACKED:6,GRAPHMATRIXVERTICALBARCLUSTERED:7,GRAPHMATRIXVERTICALBARPERCENT:8,GRAPHMATRIXHORIZONTALBARSTACKED:9,GRAPHMATRIXHORIZONTALBARCLUSTERED:10,GRAPHMATRIXHORIZONTALBARPERCENT:11,GRAPHMATRIXVERTICALLINESTACKED:12,GRAPHMATRIXVERTICALLINECLUSTERED:13,GRAPHMATRIXVERTICALLINEPERCENT:14,GRAPHMATRIXHORIZONTALLINESTACKED:15,GRAPHMATRIXHORIZONTALLINECLUSTERED:16,GRAPHMATRIXHORIZONTALLINEPERCENT:17,GRAPHMATRIXSCATTERCIRCLEMM:18,GRAPHMATRIXSCATTERGRIDCIRCLEAA:19,GRAPHMATRIXBUBBLECIRCLEMM:21,GRAPHMATRIXBUBBLEGRIDCIRCLEAA:22,GRAPHMATRIXSCATTERSQUAREAM:23,GRAPHMATRIXSCATTERSQUAREMM:24,GRAPHMATRIXSCATTERGRIDSQUAREAA:25,GRAPHMATRIXBUBBLESQUAREAM:26,GRAPHMATRIXBUBBLESQUAREMM:27,GRAPHMATRIXBUBBLEGRIDSQUAREAA:28,GRAPHHORIZONTALBARCLUSTERED:29,GRAPHMATRIXVERTICALAREASTACKED:30,GRAPHMATRIXVERTICALAREAPERCENT:31,GRAPHMATRIXVERTICALAREACLUSTERED:32,GRAPHMATRIXHORIZONTALAREASTACKED:40,GRAPHMATRIXHORIZONTALAREAPERCENT:41,GRAPHMATRIXHORIZONTALAREACLUSTERED:42,GRAPHHORIZONTALBARDUALAXISCLUSTERED:33,GRAPHHORIZONTALBARDUALAXISABSOLUTE:34,GRAPHHORIZONTALLINEABSOLUTE:35,GRAPHHORIZONTALLINEDUALAXISABSOLUTE:36,GRAPHHORIZONTALAREAABSOLUTE:37,GRAPHHORIZONTALAREADUALAXISABSOLUTE:38,GRAPHVERTICALBARCLUSTERED:39,GRAPHVERTICALBARDUALAXISCLUSTERED:43,GRAPHVERTICALBARDUALAXISABSOLUTE:44,GRAPHVERTICALBARDUALAXISSTACKED:45,GRAPHVERTICALLINEABSOLUTE:46,GRAPHVERTICALLINESTACKED:47,GRAPHVERTICALLINEPERCENT:48,GRAPHVERTICALLINEDUALAXISABSOLUTE:49,GRAPHVERTICALLINEDUALAXISSTACKED:50,GRAPHVERTICALAREAABSOLUTE:51,GRAPHVERTICALAREAPERCENT:52,GRAPHVERTICALAREASTACKED:53,GRAPHVERTICALAREADUALAXISABSOLUTE:54,GRAPHVERTICALAREADUALAXISSTACKED:55,GRAPHCOMBINATIONBARAREA:56,GRAPHCOMBINATIONBARAREADUALAXIS:57,NETWORK:58,IMAGELAYOUT:59,GOOGLEMAPDENSITY:60,GRAPHMATRIXPIE:61,GRAPHMATRIXRING:62,GRAPHHORIZONTALBARABSOLUTE:63,GRAPHHORIZONTALBARPERCENT:64,GRAPHHORIZONTALBARSTACKED:65,GRAPHVERTICALBARABSOLUTE:66,GRAPHVERTICALBARPERCENT:67,GRAPHVERTICALBARSTACKED:68,ESRIMAP:69,GRAPHMATRIXVERTICALBARAUTOMATIC:70,GRAPHMATRIXHORIZONTALBARAUTOMATIC:71,GRAPHMATRIXVERTICALLINEAUTOMATIC:72,GRAPHMATRIXHORIZONTALLINEAUTOMATIC:73,GRAPHMATRIXVERTICALAREAAUTOMATIC:74,GRAPHMATRIXHORIZONTALAREAAUTOMATIC:75};mstrmojo.gm.GMEnums={};mstrmojo.gm.DualAxisSubAxisBit={PRIMARY:0,SECONDARY:1};mstrmojo.gm.StackExetrmeId={PRIMARY_Y_AXIS:-2,SECONDARY_Y_AXIS:-18,PRIMARY_X_AXIS:-1,SECONDARY_X_AXIS:-17};mstrmojo.gm.FormNameType={OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4};mstrmojo.gm.EnumSelectionOptionLevel={GLOBAL:1,ITSELF:2,ATTS_METRIC_COMBINATION:3,METRIC_AXIS:4,METRIC:5,AXIS:6,COLOR_BY:7,ALL_SHAPE:8,ITSELF_RESOLVED:9};mstrmojo.gm.EnumLabelRotation={VERTICAL:2,HORIZONTAL:0,AUTOMATIC:-1};mstrmojo.gm.EnumIdentityType={LEGEND:Math.pow(2,0),GRAPH_SHAPE:Math.pow(2,1),X_AXIS:Math.pow(2,2),Y_AXIS:Math.pow(2,3),X2_AXIS:Math.pow(2,4),Y2_AXIS:Math.pow(2,5),GRID_LINE:Math.pow(2,6),TREND_LINE:Math.pow(2,7),REF_LINE:Math.pow(2,8),DATA_LABEL:Math.pow(2,9),COLOR_SQUARE:Math.pow(2,10),ROW_TITLE:Math.pow(2,11),COL_TITLE:Math.pow(2,12),ROW_HEADER:Math.pow(2,13),COL_HEADER:Math.pow(2,14),LOG_SCALE:Math.pow(2,15),H_MATRIX_LINE:Math.pow(2,16),V_MATRIX_LINE:Math.pow(2,17),LEGEND_TEXT:Math.pow(2,18),SHAPE_COLLECTION:Math.pow(2,19),MINOR_GRID_LINE:Math.pow(2,20),AXIS_SCALE:Math.pow(2,22),AXIS_ORIGIN:Math.pow(2,23),ROWS_BACKGROUND:Math.pow(2,24),COLS_BACKGROUND:Math.pow(2,25),X_NUMERIC:Math.pow(2,26),X_CATEGORY:Math.pow(2,27),Y_NUMERIC:Math.pow(2,28),Y_CATEGORY:Math.pow(2,29),X_METRIC_AXIS_TITLE:Math.pow(2,30),Y_METRIC_AXIS_TITLE:Math.pow(2,31),VIZ_BOX_TITLE:Math.pow(2,32),REF_LINE_LABEL:Math.pow(2,33),LINE_MARKER:Math.pow(2,34),X_AXIS_ORIGIN_LABEL:Math.pow(2,35),Y_AXIS_ORIGIN_LABEL:Math.pow(2,36),X_AXIS_ORIGIN_LINE:Math.pow(2,37),Y_AXIS_ORIGIN_LINE:Math.pow(2,38),Y_ATTRIBUTE_AXIS_TITLE:Math.pow(2,39),ROW_HEADER_TEXT:Math.pow(2,40),ROW_TITLE_TEXT:Math.pow(2,41),COL_HEADER_TEXT:Math.pow(2,42),COL_TITLE_TEXT:Math.pow(2,43),VIZ_BOX_CONTAINER:Math.pow(2,44),X_ATTRIBUTE_AXIS_TITLE:Math.pow(2,45),AXIS_ORIGIN_DEFINE:Math.pow(2,46)};mstrmojo.gm.EnumGMZoneIds={ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10};mstrmojo.gm.EnumClickType={NONE:-1,LEFT_CLICK:1,RIGHT_CLICK:2,DOUBLE_CLICK:3};mstrmojo.gm.EnumLegendSlot={RIGHT_TOP:1,RIGHT_MIDDLE:2,RIGHT_BOTTOM:3,LEFT_TOP:4,LEFT_MIDDLE:5,LEFT_BOTTOM:6,LEFT:7,RIGHT:8};mstrmojo.gm.EnumAxisType={ATTRIBUTE:0,METRIC:1};mstrmojo.gm.EnumGraphType={UNDEFINED:-1,AREA:1,BAR:2,LINE:3,SCATTER:4,BUBBLE:5,PIE:6,GRID:7};mstrmojo.gm.EnumContextMenu={SEPARATOR:0,KEEP_ONLY:1,EXCLUDE:2,SORT_ASCENDING:3,SORT_DESCENDING:4,CLEAR_SORT:5,SHOW_DATA:6,SWITCH_THEME:7,KEEP_ONLY_AND_SHOW:8,CLOSE_LEGEND:9,OPEN_LEGEND:10,AXIS_SCALE:11,DRILL_TO:100,CHART_TYPE:200,AREA_ABS:201,AREA_STACKED:202,AREA_PERCENT:203,BAR_SBS:204,BAR_ABS:205,BAR_STACKED:206,BAR_PERCENT:207,LINE_ABS:208,LINE_STACKED:209,LINE_PERCENT:210,BUBBLE:211,SCATTER:212,H_AREA_ABS:213,H_AREA_STACKED:214,H_AREA_PERCENT:215,H_BAR_SBS:216,H_BAR_ABS:217,H_BAR_STACKED:218,H_BAR_PERCENT:219,H_LINE_ABS:220,H_LINE_STACKED:221,H_LINE_PERCENT:222,GRID:223,CIRCLE:224,SQUARE:225,PIE:226,TICKER:227,RING:228,CANVAS:229,SVG:230,LARGE_ABL:231,OUTPUT_EXTREMES:232,COMBINATION:233,ENABLE_PARTIAL_RENDERING:234,DISABLE_PARTIAL_RENDERING:235,OUTPUT_DATA_COUNT:236,ENABLE_TIMER:239,DISABLE_TIMER:240,ENABLE_CE_TIMER:241,DISABLE_CE_TIMER:242};mstrmojo.gm.EnumColorRankMode={RANK_MODE_VALUE:0,RANK_MODE_TOP:1,RANK_MODE_BOTTOM:2,RANK_MODE_TOP_PERCENT:3,RANK_MODE_BOTTOM_PERCENT:4};mstrmojo.gm.EnumColorByType={NULL:0,ATT:1,METRICS_ITEM:2,METRICS:3,ATT_METRICS:4};mstrmojo.gm.EnumDockPosition={TOP:1,RIGHT:2,BOTTOM:3,LEFT:4};mstrmojo.gm.EnumXAxisLabelStatus={NORMAL:1,STAGGER:2,ROTATE:3,HORI_DROP:4};mstrmojo.gm.EnumABLDirection={HORIZONTAL:1,VERTICAL:2};mstrmojo.gm.EnumMetricsPosition={MetricsByRow:0,MetricsByColumn:1,MetricsByAxis:2,MetricsByBreakBy:3,MetricsBySlice:4,MetricsByXAxis:5,MetricsByYAxis:6};mstrmojo.gm.EnumDrawingAPI={GET_CHART_WIDTH:0,GET_CHART_HEIGHT:1,GET_ROW_HEADER:2,GET_COLUMN_HEADER:3,CREATE_UNIT_Y_AXIS:4,CREATE_UNIT_X_AXIS:5,GET_FULL_FLEDGED_CHART:6,GET_ROW_SPAN:7,GET_COLUMN_SPAN:8,GET_METRICS_ON_X:9,GET_METRICS_ON_Y:10,GET_METRICS_ON_SIZE_BY:11,UPDATE_MINI_CHART:12,UPDATE_X_AXIS:13,UPDATE_Y_AXIS:14,MAX_RADIUS_CALC:15,GET_EXTRA_COLUMN_HEADER:16,UPDATE_COLUMN_HEADER:17,UPDATE_ROW_HEADER:18,LAYOUT_ALL_X_AXIS_LABELS:19,LAYOUT_ONE_X_AXIS_LABELS:20};mstrmojo.gm.WidgetPropertyTag={FIT_TO:"FitTo",AXIS_SCALE:"MinMax",SHAPE:"Shape",SUB_TYPE:"Subtype",DATA_LABEL:"DataLabel",DATA_LABELS_PLACEMENT:"DataLabelPalcement",METRIC_LEVEL_DATA_LABEL:"mtcLvlDataLabel",BANDING:"Banding",LEGEND_VISIBLE:"LegendVisibleness",COL_ALIGNMENT:"Columnalignment",ROW_ALIGNMENT:"Rowalignment",MAX_SIZE_TYPE:"SizeType",MAX_SIZE_VALUE:"SizeValue",MIN_SIZE_TYPE:"minSizeType",MIN_SIZE_VALUE:"minSizeValue",OUTSIDE_BORDER:"OutSideBorder",AXES:"AxisLine",MATRIX_LINES:"MatrixLine",GRID_LINES:"GridLine",SELECTION_TYPE:"SelectionType",SELECTIONS:"Selections",LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr",SCALE_CHART_HEIGHT:"rr",SCALE_CHART_WIDTH:"cr",SCALE_ROW_HEADERS:"rvr",SCALE_COL_HEADERS:"chr",SCALE_Y:"yr",SCALE_X:"xr",SCALE_Y2:"y2r",SCALE_X2:"x2r",SCALE_ALL:"scales",SCALE_V_EXTRA_LINE:"vExtraLine",SORT_ORDER:"so",SORT_INDEX:"si",AXIS_SCALE_DATA:"AxisScale",AXIS_SCALE_REAL_MIN:"rMin",AXIS_SCALE_REAL_MAX:"rMax",AXIS_SCALE_MANUAL_MIN:"mMin",AXIS_SCALE_MANUAL_MAX:"mMax",AXIS_SCALE_AUTO_MIN:"autoMin",AXIS_SCALE_AUTO_MAX:"autoMax",SINGLE_AXIS_SCALE_TYPE:"scaleType",LOG_SCALE:"logScale",GROUP_INFO:"groupInfo",METRIC_SHAPES:"metricShapes",AXIS_ORIGIN:"axisOrigin",AXIS_ORIGIN_AUTO:"axOriAuto",AXIS_ORIGIN_VALUE:"axOriValue",TREND_LINE_DEF:"trdDef",REF_LINE_DEF:"refDef",TREND_TYPE:"trdTp",TREND_LEVEL:"trdLvl",TREND_ENABLED:"trdEnabled",TREND_INCLUDE_BREAK_BY:"trdIncBB",TREND_POLY_DEGREE:"trdDgr",TREND_FORECAST_ENABLED:"trdFstEnabled",TREND_BWD_FORECAST:"trdBwdFst",TREND_FWD_FORECAST:"trdFwdFst",TREND_SEASONALITY:"trdSeason",TREND_BUBBLE_FORE_DEF:"trdBbForeDef",TREND_BUBBLE_FORE_FWD:"trdBbForeFwd",TREND_BUBBLE_FORE_BWD:"trdBbForeBwd",TREND_BUBBLE_FORE_ENABLED:"trdBbForeEnabled",TREND_BUBBLE_MAX:"trdBbMax",TREND_BUBBLE_MIN:"trdBbMin",REF_TYPE:"refTp",REF_LEVEL:"refLvl",REF_ENABLED:"refEnabled",REF_SHOW_LABEL:"refLbShw",REF_LABEL_TYPE:"refLbTp",REF_CONST_VALUE:"refCstVl",REF_LINE_NAME:"refLnName",TREND_REF_LINE_THICKNESS:"trdRefLnThk",TREND_REF_LINE_COLOR:"trdRefLnClr",TREND_REF_LINE_STYLE:"trdRefLnStyle",TREND_REF_LINE_COMBINED_STYLE:"trdRefLnCmbStyle",FORMATS_ON_COMBINATION:"fmtOnComb",PARTIAL_RENDER:"prtRdn"};mstrmojo.gm.FormatingPropertyTag={IS_DEFAULT_VALUE:"_default",MODIFIED_DEF_FILL_COLOR:"modDefFillClr",ALL_SHAPE_FORMAT:"allShpFmt",SHAPE_LINE_THICKNESS:"shpLnThk",SHAPE_LINE_COLOR:"shpLnClr",SHAPE_LINE_STYLE:"shpLnStyle",SHAPE_LINE_COMBINED_STYLE:"shpLnCmbStyle",SHAPE_FILL_COLOR:"shpFillClr",SHAPE_FILL_COLOR_DEFAULT:"shpFillClr_default",SHAPE_FILL_STYLE:"shpFillStyle",SHAPE_FILL_TRANSPARENCY:"shpFillTrans",SHAPE_FILL_EFFECT:"shpFillEff",SHAPE_BORDER_COLOR:"shpBdrClr",SHAPE_BORDER_STYLE:"shpBdrStyle",SHAPE_BORDER_COMBINED_STYLE:"shpBdrCmbStyle",SHAPE_BORDER_THICKNESS:"shpBdrThk",LINE_MARKER_SHOW:"lnMkShw",LINE_MARKER_SHAPE:"lnMkShp",LINE_MARKER_SIZE:"lnMkSz",LINE_MARKER_COLOR:"lnMkClr",LINE_MARKER_COLOR_EQUAL:"lnMkClrEq",LINE_MARKER_BORDER_COLOR:"lnMkBdrClr",PIE_EXPLODE:"pieExpl",DATA_LABELS_SHOW:"dlShw",DATA_LABELS_FONT_FAMILY:"dlFntFml",DATA_LABELS_FONT_SIZE:"dlFntSz",DATA_LABELS_FONT_STYLE:"dlFntStyle",DATA_LABELS_FONT_COLOR:"dlFntClr",REF_LABELS_FONT_FAMILY:"rfLnFntFml",REF_LABELS_FONT_SIZE:"rfLnFntSz",REF_LABELS_FONT_STYLE:"rfLnFntStyle",REF_LABELS_FONT_COLOR:"rfLnFntClr",LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",ALL_LINE_SHOW:"allLnShw",ALL_LINE_COLOR:"allLnClr",ALL_LINE_STYLE:"allLnStyle",ALL_LINE_COMBINED_STYLE:"allLnCmbStyle",ALL_LINE_THICKNESS:"allLnThk",ALL_AXIS_ORIGIN_LINE_SHOW:"axOriLnShw",ALL_AXIS_ORIGIN_LINE_COLOR:"axOriLnClr",ALL_AXIS_ORIGIN_LINE_COMBINED_STYLE:"axOriLnCmbStyle",X_AXIS_ORIGIN_LINE_SHOW:"xAxOriLnShw",X_AXIS_ORIGIN_LINE_COLOR:"xAxOriLnClr",X_AXIS_ORIGIN_LINE_STYLE:"xAxOriLnStyle",X_AXIS_ORIGIN_LINE_COMBINED_STYLE:"xAxOriLnCmbStyle",X_AXIS_ORIGIN_LINE_THICKNESS:"xAxOriLnThk",Y_AXIS_ORIGIN_LINE_SHOW:"yAxOriLnShw",Y_AXIS_ORIGIN_LINE_COLOR:"yAxOriLnClr",Y_AXIS_ORIGIN_LINE_STYLE:"yAxOriLnStyle",Y_AXIS_ORIGIN_LINE_COMBINED_STYLE:"yAxOriLnCmbStyle",Y_AXIS_ORIGIN_LINE_THICKNESS:"yAxOriLnThk",ALL_AXIS_LINE_SHOW:"allAxLnShw",ALL_AXIS_LINE_COLOR:"allAxLnClr",ALL_AXIS_LINE_STYLE:"allAxLnStyle",ALL_AXIS_LINE_COMBINED_STYLE:"allAxLnCmbStyle",ALL_AXIS_LINE_THICKNESS:"allAxLnThk",ALL_AXIS_TITLE_SHOW:"allAxTtShw",ALL_AXIS_TITLE_CONTENT:"allAxTtCtt",ALL_AXIS_TITLE_FONT_COLOR:"allAxTtFntClr",ALL_AXIS_TITLE_FONT_FAMILY:"allAxTtFntFml",ALL_AXIS_TITLE_FONT_STYLE:"allAxTtFntStyle",ALL_AXIS_TITLE_FONT_SIZE:"allAxTtFntSz",ALL_AXIS_LABELS_FONT_SIZE:"allAxLbFntSz",ALL_AXIS_LABELS_FONT_FAMILY:"allAxLbFntFml",ALL_AXIS_LABELS_FONT_STYLE:"allAxLbFntStyle",ALL_AXIS_LABELS_FONT_COLOR:"allAxLbFntClr",ALL_AXIS_LABELS_ROTATION:"allAxLbRtt",ALL_AXIS_LABELS_SHOW:"allAxLbShw",X_AXIS_LINE_SHOW:"xAxLnShw",X_AXIS_LINE_COLOR:"xAxLnClr",X_AXIS_LINE_STYLE:"xAxLnStyle",X_AXIS_LINE_COMBINED_STYLE:"xAxLnCmbStyle",X_AXIS_LINE_THICKNESS:"xAxLnThk",X_AXIS_TITLE_SHOW:"xAxTtShw",X_AXIS_TITLE_CONTENT:"xAxTtCtt",X_AXIS_TITLE_FONT_COLOR:"xAxTtFntClr",X_AXIS_TITLE_FONT_FAMILY:"xAxTtFntFml",X_AXIS_TITLE_FONT_STYLE:"xAxTtFntStyle",X_AXIS_TITLE_FONT_SIZE:"xAxTtFntSz",X_AXIS_LABELS_FONT_SIZE:"xAxLbFntSz",X_AXIS_LABELS_FONT_FAMILY:"xAxLbFntFml",X_AXIS_LABELS_FONT_STYLE:"xAxLbFntStyle",X_AXIS_LABELS_FONT_COLOR:"xAxLbFntClr",X_AXIS_LABELS_ROTATION:"xAxLbRtt",X_AXIS_LABELS_SHOW:"xAxLbShw",Y_AXIS_LINE_SHOW:"yAxLnShw",Y_AXIS_LINE_COLOR:"yAxLnClr",Y_AXIS_LINE_STYLE:"yAxLnStyle",Y_AXIS_LINE_COMBINED_STYLE:"yAxLnCmbStyle",Y_AXIS_LINE_THICKNESS:"yAxLnThk",Y_AXIS_TITLE_SHOW:"yAxTtShw",Y_AXIS_TITLE_CONTENT:"yAxTtCtt",Y_AXIS_TITLE_FONT_COLOR:"yAxTtFntClr",Y_AXIS_TITLE_FONT_FAMILY:"yAxTtFntFml",Y_AXIS_TITLE_FONT_STYLE:"yAxTtFntStyle",Y_AXIS_TITLE_FONT_SIZE:"yAxTtFntSz",Y_AXIS_LABELS_FONT_SIZE:"yAxLbFntSz",Y_AXIS_LABELS_FONT_FAMILY:"yAxLbFntFml",Y_AXIS_LABELS_FONT_STYLE:"yAxLbFntStyle",Y_AXIS_LABELS_FONT_COLOR:"yAxLbFntClr",Y_AXIS_LABELS_ROTATION:"yAxLbRtt",Y_AXIS_LABELS_SHOW:"yAxLbShw",ALL_FILL_COLOR:"allFillClr",ALL_FILL_TRANSPARENCY:"allFillTrans",BG_COLOR:"bgFillClr",BG_FILL_EFFECT:"bgFillEff",BG_FILL_STYLE:"bgFillStyle",BG_FILL_TRANSPARENCY:"bgFillTrans",ROW_HEADER_FILL_COLOR:"rwHdrFillClr",ROW_HEADER_FILL_EFFECT:"rwHdrFillEff",ROW_HEADER_FILL_STYLE:"rwHdrFillStyle",ROW_HEADER_FILL_TRANSPARENCY:"rwHdrFillTrans",COLUMN_HEADER_FILL_COLOR:"colHdrFillClr",COLUMN_HEADER_FILL_EFFECT:"colHdrFillEff",COLUMN_HEADER_FILL_STYLE:"colHdrFillStyle",COLUMN_HEADER_FILL_TRANSPARENCY:"colHdrFillTrans",ALL_MATRIX_LINES_SHOW:"allMatrixLnShw",ALL_MATRIX_LINES_COLOR:"allMatrixLnClr",ALL_MATRIX_LINES_THICKNESS:"allMatrixLnThk",ALL_MATRIX_LINES_STYLE:"allMatrixLnStyle",ALL_MATRIX_LINES_COMBINED_STYLE:"allMatrixLnCmbStyle",V_MATRIX_LINES_SHOW:"vMatrixLnShw",V_MATRIX_LINES_COLOR:"vMatrixLnClr",V_MATRIX_LINES_THICKNESS:"vMatrixLnThk",V_MATRIX_LINES_STYLE:"vMatrixLnStyle",V_MATRIX_LINES_COMBINED_STYLE:"vMatrixLnCmbStyle",H_MATRIX_LINES_SHOW:"hMatrixLnShw",H_MATRIX_LINES_COLOR:"hMatrixLnClr",H_MATRIX_LINES_THICKNESS:"hMatrixLnThk",H_MATRIX_LINES_STYLE:"hMatrixLnStyle",H_MATRIX_LINES_COMBINED_STYLE:"hMatrixLnCmbStyle",OUTSIDE_BORDER_SHOW:"outBdrShw",OUTSIDE_BORDER_COLOR:"outBdrClr",OUTSIDE_BORDER_STYLE:"outBdrStyle",OUTSIDE_BORDER_THICKNESS:"outBdrThk",OUTSIDE_BORDER_COMBINED_STYLE:"outBdrCmbStyle",GRID_LINE_AUTO:"gridLineAuto",ALL_GRID_LINES_SHOW:"allGridLnShw",ALL_GRID_LINES_COLOR:"allGridLnClr",ALL_GRID_LINES_THICKNESS:"allGridLnThk",ALL_GRID_LINES_STYLE:"allGridLnStyle",ALL_GRID_LINES_COMBINED_STYLE:"allGridLnCmbStyle",AUTO_GRID_LINES_COLOR:"autoGridLnClr",AUTO_GRID_LINES_COMBINED_STYLE:"autoGridLnCmbStyle",MAJOR_GRID_LINES_SHOW:"majorGridLnShw",MAJOR_GRID_LINES_COLOR:"majorGridLnClr",MAJOR_GRID_LINES_THICKNESS:"majorGridLnThk",MAJOR_GRID_LINES_STYLE:"majorGridLnStyle",MAJOR_GRID_LINES_COMBINED_STYLE:"majorGridLnCmbStyle",MINOR_GRID_LINES_SHOW:"minerGridLnShw",MINER_GRID_LINES_COLOR:"minerGridLnClr",MINER_GRID_LINES_THICKNESS:"minerGridLnThk",MINER_GRID_LINES_STYLE:"minerGridLnStyle",MINER_GRID_LINES_COMBINED_STYLE:"minerGridLnCmbStyle",ALL_ROW_COLUMN_SHOW:"allRwColShw",COLUMN_TEXT_SHOW:"colTxtShw",ROW_TEXT_SHOW:"rwTxtShw",COLUMN_HEADER_SHOW:"colHdrShw",ROW_HEADER_SHOW:"rwHdrShw",COLUMN_VALUES_SHOW:"colVlShw",ROW_VALUES_SHOW:"rwVlShw",ALL_TEXT_FONT_COLOR:"allTxtFntClr",ALL_TEXT_FONT_SIZE:"allTxtFntSz",ALL_TEXT_FONT_FAMILY:"allTxtFntFml",ALL_TEXT_FONT_STYLE:"allTxtFntStyle",ALL_ROW_COLUMN_TEXT_FONT_COLOR:"allRwColTxtFntClr",ALL_ROW_COLUMN_TEXT_FONT_SIZE:"allRwColTxtFntSz",ALL_ROW_COLUMN_TEXT_FONT_FAMILY:"allRwColTxtFntFml",ALL_ROW_COLUMN_TEXT_FONT_STYLE:"allRwColTxtFntStyle",ALL_ROW_COLUMN_TEXT_ALIGNMENT_HORIZONTAL:"allRwColTxtAlignH",ALL_ROW_COLUMN_TEXT_ALIGNMENT_VERTICAL:"allRwColTxtAlignV",ROW_TEXT_TEXT_FONT_COLOR:"rwTxtTxtFntClr",ROW_TEXT_TEXT_FONT_SIZE:"rwTxtTxtFntSz",ROW_TEXT_TEXT_FONT_FAMILY:"rwTxtTxtFntFml",ROW_TEXT_TEXT_FONT_STYLE:"rwTxtTxtFntStyle",ROW_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"rwTxtTxtAlignH",ROW_TEXT_TEXT_ALIGNMENT_VERTICAL:"rwTxtTxtAlignV",COLUMN_TEXT_TEXT_FONT_COLOR:"colTxtTxtFntClr",COLUMN_TEXT_TEXT_FONT_SIZE:"colTxtTxtFntSz",COLUMN_TEXT_TEXT_FONT_FAMILY:"colTxtTxtFntFml",COLUMN_TEXT_TEXT_FONT_STYLE:"colTxtTxtFntStyle",COLUMN_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"colTxtTxtAlignH",COLUMN_TEXT_TEXT_ALIGNMENT_VERTICAL:"colTxtTxtAlignV",ROW_HEADER_TEXT_FONT_COLOR:"rwHdrTxtFntClr",ROW_HEADER_TEXT_FONT_SIZE:"rwHdrTxtFntSz",ROW_HEADER_TEXT_FONT_FAMILY:"rwHdrTxtFntFml",ROW_HEADER_TEXT_FONT_STYLE:"rwHdrTxtFntStyle",ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"rwHdrTxtAlignH",ROW_HEADER_TEXT_ALIGNMENT_VERTICAL:"rwHdrTxtAlignV",COLUMN_HEADER_TEXT_FONT_COLOR:"colHdrTxtFntClr",COLUMN_HEADER_TEXT_FONT_SIZE:"colHdrTxtFntSz",COLUMN_HEADER_TEXT_FONT_FAMILY:"colHdrTxtFntFml",COLUMN_HEADER_TEXT_FONT_STYLE:"colHdrTxtFntStyle",COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"colHdrTxtAlignH",COLUMN_HEADER_TEXT_ALIGNMENT_VERTICAL:"colHdrTxtAlignV",ROW_VAVLUE_TEXT_FONT_COLOR:"rwVlTxtFntClr",ROW_VAVLUE_TEXT_FONT_SIZE:"rwVlTxtFntSz",ROW_VAVLUE_TEXT_FONT_FAMILY:"rwVlTxtFntFml",ROW_VAVLUE_TEXT_FONT_STYLE:"rwVlTxtFntStyle",ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"rwVlTxtAlignH",ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"rwVlTxtAlignV",COLUMN_VAVLUE_TEXT_FONT_COLOR:"colVlTxtFntClr",COLUMN_VAVLUE_TEXT_FONT_SIZE:"colVlTxtFntSz",COLUMN_VAVLUE_TEXT_FONT_FAMILY:"colVlTxtFntFml",COLUMN_VAVLUE_TEXT_FONT_STYLE:"colVlTxtFntStyle",COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"colVlTxtAlignH",COLUMN_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"colVlTxtAlignV",TITLE_FONT_COLOR:"ttlFntClr",TITLE_FONT_SIZE:"ttlFntSz",TITLE_FONT_FAMILY:"ttlFntFml",TITLE_FONT_STYLE:"ttlFntStyle",COLOR_SQUARE_COLOR:"clrSqrClr"};mstrmojo.gm.EnumAxis={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5};mstrmojo.gm.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gm.EnumSizeByType={SQUARE:1,CIRCLE:4};mstrmojo.gm.EnumTheme={DARK:0,LIGHT:1};mstrmojo.gm.EnumFitTo={CONTENT:1,PANEL:2,COMPACT:3};mstrmojo.gm.EnumAxisScale={GLOBAL:0,PERROWCOL:1,PERCELL:2,CUSTOM:3,DIFFERENT:4};mstrmojo.gm.EnumShape={GENERIC:-1,AREA:0,BAR:1,LINE:2,STEPLINE:3,CIRCLE:4,RECTANGLE:5,SQUARE:6,TICK:7,PIESLICE:8,POLYGON:9,PIE:10,RING:11,DEFAULT:12,BULLET:13};mstrmojo.gm.EnumSubtype={AUTO:1,ABSOLUTE:2,STACKED:3,CLUSTERED:4,PERCENT:5};mstrmojo.gm.EnumDataLabels={HIDE:1,SHOW_VALUE_ONLY:2,SHOW_TEXT_ONLY:3};mstrmojo.gm.EnumDataLabelPlacements={AUTOMATIC:1,GENERIC:2,RESERVED:3};mstrmojo.gm.EnumLegend={SHOW:0,HIDE:1,MINIMIZED:2};mstrmojo.gm.EnumLegendMode={RESTORED:1,MINIMIZED:2};mstrmojo.gm.EnumTextAlignH={LEFT:0,MIDDLE:1,RIGHT:2};mstrmojo.gm.EnumTextAlignV={TOP:0,MIDDLE:1,BOTTOM:2};mstrmojo.gm.EnumMaxSizeType={AUTO:1,MANUAL:2,AUTO_FIT:3};mstrmojo.gm.EnumMinSizeType={AUTO:1,MANUAL:2,PROPORTIONAL:3};mstrmojo.gm.EnumAxes={SHOW_BOTH:1,SHOW_NONE:2,SHOW_X:3,SHOW_Y:4};mstrmojo.gm.EnumMatrixLines={SHOW_ALL:1,SHOW_NONE:2,SHOW_HORIZONTAL:3,SHOW_VERTICAL:4};mstrmojo.gm.EnumGridLines={AUTO:1,SHOW:2,HIDE:3,SHOW_MAJOR_ONLY:4};mstrmojo.gm.LineMarkerShape={Circle:4,Square:1};mstrmojo.gm.ShapeFillType={Solid:0,Gradient:14,Pattern:3};mstrmojo.gm.ShapeFillEffect={None:1,Bevel:2};mstrmojo.gm.Enum3DGMapping={SizeType:"9999_1002",SizeValue:"9999_1003",lgdBgFillClr:"6_564",lgdBgFillStyle:"6_10002",lgdBgFillEff:"6_608",lgdFntSz:"9_603",lgdFntFml:"9_576",lgdFntStyle:"9_584",lgdFntClr:"9_574",LegendVisibleness:"9999_116",xAxShw:"9999_124",xAxTtCtt:"293_9999",xAxTtFntClr:"293_574",xAxTtFntFml:"293_576",xAxTtFntStyle:"293_584",xAxLbFntSz:"272_603",xAxLbFntFml:"272_576",xAxLbFntStyle:"272_584",yAxShw:"9999_125",yAxTtCtt:"299_9999",yAxTtFntClr:"299_574",yAxTtFntFml:"299_576",yAxTtFntStyle:"299_584",yAxLbFntSz:"296_603",yAxLbFntFml:"296_576",yAxLbFntStyle:"296_584",bgFillClr:"1_564",bgFillEff:"1_879",bgFillTrans:"1_608",outBdrClr:"1_588"};mstrmojo.gm.EnumRefLineModelType={MAX:1,MIN:2,AVG:3,MED:4,FIRST:5,LAST:6,CONST:7};mstrmojo.gm.EnumTrendLineModelType={BEST_FIT:256,LINEAR:257,LOG:258,EXP:259,POW:260,POLY:261};mstrmojo.gm.EnumTrendRefLevel={DssModelLevelReserved:0,DssModelLevelPerCell:1,DssModelLevelPerRow:2,DssModelLevelPerColumn:3,DssModelLevelPerPanel:4,DssModelLevelLastOne:5};mstrmojo.gm.EnumTimeRole={None:0,YearOfDecade:3083,QuarterOfYear:2826,MonthOfYear:2825,MonthOfQuarter:2569,WeekOfYear:2824,WeekOfQuarter:2568,WeekOfMonth:2312,DayOfYear:2823,DayOfQuarter:2567,DayOfMonth:2311,DayOfWeek:2055,HourOfDay:1798,MinuteOfDay:1797,MinuteOfHour:1541,SecondOfDay:1796,SecondOfHour:1540,SecondOfMinute:1284};mstrmojo.gm.EnumTrendRefModelLabels={DssModelLabelsReserved:-1,DssModelLabelsNone:0,DssModelLabelsType:1,DssModelLabelsMetric:2,DssModelLabelsValue:4};mstrmojo.gm.EnumTRFManipulations={AddTRLine:"141",RemoveTRLine:"142",UpdateTRLine:"143",UpdateForecastInfo:"144"};mstrmojo.gm.EnumShapeFormatStatus={NORMAL:0,PER_COLORBY:1,PER_SHAPE:2};(function(){mstrmojo.models.template.MetricValue=mstrmojo.declare(null,null,{init:function G(H){this.data=H.data;this.value=H.value;},getValue:function B(){return this.value.v;},getThresholdType:function D(){return this.value.ty;},getRawValue:function A(){return this.value.rv;},getCSS:function C(){return this.data.css[this.value.cni].n;},getThresholdValue:function F(H){if(this.value.ti===undefined){return H;}return this.data.th[this.value.ti].n;},getFillColor:function E(H){if(this.value.ci===undefined){return H;}return this.data.fc[this.value.ci].n;}});}());(function(){function A(C){return C.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");}mstrmojo._ImageHelper=mstrmojo.provide("mstrmojo._ImageHelper",{getImage:function B(D){var E=mstrApp,C=E.getConfiguration();if(D){if(D.indexOf("\\")>=0){D=D.replace(/\\/g,"/");}D=A(D);if(D===decodeURI(D)){D=encodeURI(D);}}if(C&&D&&D.indexOf("://")===-1){D=C.getHostUrlByProject(E.getCurrentProjectId())+D;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(D)):D;}});}());mstrmojo.chart.model.enums.EnumDSSDynamicShortcut={DssDynamicShortcutReserved:0,DssDynamicShortcutAuto:1,DssDynamicShortcutAcrossThenDown:2,DssDynamicShortcutDownThenAcross:3,DssDynamicShortcutColumns:4,DssDynamicShortcutRows:5,DssDynamicShortcutCell:6,DssDynamicShortcutShape:7,DssDynamicShortcutLastOne:8,DssDynamicShortcutRangeEnd:255};(function(){function B(L,Q,N){var M,O;M=0;if(N){M=Math.max(L,L-Q);M=Math.max(M,-Q);}else{M=L-Q;}if(M===0){this.mIsShown=false;return 1;}var P=M;O=1;while(M<1){M*=10;O/=10;}while(M>=10){M/=10;O*=10;}if(M<1.8){O*=2;O/=10;}else{if(M<3.1){O*=4;O/=10;}else{if(M<4.6){O*=5;O/=10;}else{if(M>=8.1){O*=2;}}}}return O;}function K(P){var L,N;this.mStep=B.call(this,this.mMaximum,this.mMinimum,P.mAlwaysIncludeZero);this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:this.mMinTick;if(P.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}var M=this.mMaxTick-this.mMinTick;if(this.mStep>=M){return ;}L=Math.floor((this.mMaxTick-this.mMinTick+this.mStep/100)/this.mStep)+1;for(N=1;N<L-1;++N){var O=this.mMinTick+N*this.mStep;this.mTicks.push(O);}}function C(M){var L;this.mMaxTick=1;this.mStep=this.mMinimum<0?0.2:0.1;if(M.mUseCustomMinMax){this.mMaxTick=M.mAxisMaxValue;this.mMinTick=M.mAxisMinValue;this.mMaxTick=Math.min(1,this.mMaxTick);this.mMinTick=Math.max(-1,this.mMinTick);this.mStep=0.1;}else{if(this.mMaximum>=0.5){this.mMaxTick=1;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:(this.mMinTick>0?0:this.mMinTick);if(this.mMinimum<-0.5){this.mMinTick=-1;}}else{if(this.mMaximum>0){this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=-1;}else{this.mStep=0.1;this.mMaxTick=0;this.mMinTick=-1;}}}for(L=this.mMinTick+this.mStep;L+0.01<this.mMaxTick;L+=this.mStep){this.mTicks.push(Math.round(L*100)/100);}}function I(L){return Math.log(L)/Math.log(10);}function H(O){var N,L,M;this.mStep=1;if(this.mMaximum<=0){this.mMinTick=1;this.mMaxTick=10;return ;}if(this.mMinimum<=0){L=this.mMaximum>1?0:-1;this.mMinTick=Math.pow(10,L);if(O.mUseCustomMinMax){this.mMaxTick=this.mMaximum;N=Math.floor(I.call(this,this.mMaximum));if(I.call(this,this.mMaximum)===N){N--;}}else{N=Math.ceil(I.call(this,this.mMaximum));this.mMaxTick=Math.pow(10,N);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}return ;}if(O.mUseCustomMinMax){N=I.call(this,this.mMaximum);L=I.call(this,this.mMinimum);this.mMaxTick=this.mMaximum;this.mMinTick=this.mMinimum;}else{N=Math.ceil(I.call(this,this.mMaximum));L=Math.floor(I.call(this,this.mMinimum));this.mMaxTick=Math.pow(10,N);this.mMinTick=Math.pow(10,L);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}}function J(L){this.mTicks.splice(0,this.mTicks.length);if(this.mIsPercent){return C.call(this,L);}if(L.mUseLogarithmicScale){return H.call(this,L);}K.call(this,L);}function G(Q){if(Q.mUseCustomMinMax||Q.mUseLogarithmicScale){return ;}var M=0.1,O=false,L=false,P=[];this.GetTicks(P);if(P.length>=2){var N=P.length;L=((Math.abs(this.mMaximum-P[N-2])<M*this.mStep));O=((Math.abs(this.mMinimum-P[1])<M*this.mStep));if(this.mIsPercent){L=false;}}if(L&&O){this.mMinTick=this.mMinimum;this.mMaxTick=this.mMaximum;Q.mUseMinValue=Q.mShowMinLabel=true;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(L){this.mMaxTick=this.mMaximum;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(O){this.mMinTick=this.mMinimum;Q.mUseMinValue=Q.mShowMinLabel=true;}else{}}}if(Q.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}}mstrmojo.chart.common.ScalePlate=mstrmojo.provide("mstrmojo.chart.common.ScalePlate",{mOptions:{mShowMinLabel:true,mShowMaxLabel:true},isStackedChart:false,mStep:0,mIsPercent:false,mMinimum:0,mMaximum:0,mMaxTick:0,mMinTick:0,mTicks:[],clear:function F(){this.isStackedChart=this.mIsPercent=false;this.mMinimum=this.mMaximum=0;this.mMinTick=this.mMaxTick=0;this.mStep=0;this.mTicks=[];},GetTicks:function A(M){if(this.mOptions.mShowMinLabel){M.push(this.mMinTick);}var L;for(L=0;L<this.mTicks.length;++L){M.push(this.mTicks[L]);}if(this.mOptions.mShowMaxLabel){M.push(this.mMaxTick);}},getMaxMinTickValue:function D(O,N,L,M){this.computeTicks(O,N,L,M);return{Max:this.mMaxTick,Min:this.mMinTick};},computeTicks:function E(Q,P,L,N){this.mMinimum=N;this.mMaximum=L;this.mIsPercent=!!(P&1);this.isStackedChart=!!(P&2);var O=1e-14;if(!Q.mUseLogarithmicScale&&this.isStackedChart){this.mMinimum=Math.min(this.mMinimum,0);this.mMaximum=Math.max(this.mMaximum,0);}if(Q.mDrawCustomLine){this.mMinimum=Math.min(this.mMinimum,Q.mAxisCustomValue);this.mMaximum=Math.max(this.mMaximum,Q.mAxisCustomValue);}if(this.mIsPercent&&this.mMinimum===this.mMaximum&&1===this.mMaximum){if(this.mMinimum===1){this.mMinimum=0;}}if(Math.abs(this.mMinimum-this.mMaximum)<O){if(this.mMinimum<-O||this.mMinimum>O){var M=Math.abs(this.mMinimum)*0.5;this.mMaximum=this.mMaximum+M;this.mMinimum=this.mMinimum-M;}else{this.mMinimum=-6;this.mMaximum=6;}}J.call(this,Q);if(Q.mUseLogarithmicScale&&this.isStackedChart){this.mMaximum=Q.mDrawCustomLine?Math.max(this.mMaximum+this.mMinTick,Q.mAxisCustomValue):this.mMaximum+this.mMinTick;this.mMinimum=Math.min(this.mMinimum,0);this.mTicks.splice(0,this.mTicks.length);H.call(this,Q);}G.call(this,Q);}});}());mstrmojo.mstr.EnumWebAPIErrorCodes={MSI_INBOX_MSG_NOT_FOUND:-2147468986,AUTHEN_E_LOGIN_FAIL_EXPIRED_PWD:-2147216963,AUTHEN_E_LOGIN_FAILED_NEW_PASSWORD_REQD:-2147216960,AUTHEN_E_LOGIN_FAIL:-2147216959,DOCDATA_PREPARE_TASK_REPORT_INCOMP:-2147466604,E_MSI_USERMGR_USER_NOTFOUND:-2147209051,MSI_SERVER_NOT_FOUND:-2147206923,DFC_QRYENG_RES_TRUNC:-2147205488,POOL_OBJECT_NOT_FOUND_BY_ID:-2147467398,MSI_CUBE_NOT_PUBLISHED:-2147072488,MSI_DocumentDataPreparationTask_ReportIncomplete:-2147466604,E_UNUSED:4294967295};(function(){function X(a){var b=[].slice.call(a),c=b[b.length-1],d=function(f,e){return f===e;};if(/function|string/.test(typeof c)){d=typeof c==="function"?c:function(f,e){return f[c]===e[c];};b=b.slice(0,b.length-1);}return{sets:b,compareFunc:d};}mstrmojo.array=mstrmojo.provide("mstrmojo.array",{indexOf:function D(b,d){var a=(b&&b.length)||0,c;for(c=0;c<a;c++){if(b[c]==d){return c;}}return -1;},indexOfMulti:function T(a,b){var f=[],e={},d=0,c=this;c.forEach(a,function(h,g){c.forEach(b,function(k,l){var m=(k===h);if(m){f[l]=e[l]=g;d++;}return !m;});});return{indices:f.length?f:null,map:e,count:d};},forEach:function R(b,g,d){var a=(b&&b.length)||0,c;for(c=0;c<a;c++){var e=c===(a-1);if(d){if(g.call(d,b[c],c,b,e)===false){break;}}else{if(g(b[c],c,b,e)===false){break;}}}return b;},map:function Y(b,e){var a=(b&&b.length)||0,c=[],d;for(d=0;d<a;d++){c[d]=e(b[d],d);}return c;},filter:function I(c,d,e){var h=[],g=0,b=(c&&c.length)||0,a=(e&&e.max)||0,f;for(f=0;f<b;f++){if(d(c[f],f,c)){h[g]=c[f];g++;if(a&&g>=a){break;}}}return h;},filterOne:function L(a,b){var c=this.filter(a,b,{max:1});if(c.length){return c[0];}return null;},ensureArray:function P(a){return[].concat(a||[]);},find:function M(b,f,c){var a=(b&&b.length)||0,d;for(d=0;d<a;d++){var e=b[d];if(e&&e[f]==c){return d;}}return -1;},distinct:function B(b,f){if(b.reduce&&!f){return b.reduce(function(h,g){if(h.indexOf(g)<0){h.push(g);}return h;},[]);}var a=(b&&b.length)||0,c,e,d=[];for(c=0;c<a;c++){e=b[c];if((e!==undefined)&&((f&&this.find(d,f,e[f])<0)||(!f&&this.indexOf(d,e)<0))){d.push(e);}}return d;},findBin:function E(c,g,k,b){var f=(b||c.length)-1,d=0,a,e=g[k];while(f-d>1){if(c[a=f+d>>1][k]<e){d=a;}else{f=a;}}if(c[d][k]===e){return d;}return c[f][k]===e?f:-1;},search:function H(k,d,f){var e=k.length,c=-1,b,g=d.toUpperCase(),a=d.length;while(e-c>1){if(k[b=e+c>>1][f].substr(0,a).toUpperCase()<g){c=b;}else{e=b;}}return e;},findMulti:function Q(h,d,m){if(!m){return{indices:null,map:{},count:0};}var l=m.length,q=[],b={},o=0,f=(h&&h.length)||0,g;for(g=0;g<f;g++){var p=h[g][d],e;for(e=0;e<l;e++){if(m[e][d]===p){q[e]=g;b[e]=g;o++;break;}}}return{indices:q,map:b,count:o};},removeItem:function W(a,c){var b=this.indexOf(a,c);if(b>-1){this.removeIndices(a,b,1);}return b;},removeItems:function N(a,f,b){var c=this.findMulti(a,f,b);if(c.count){var e=c.indices.concat().sort(this.numSorter).slice(0,c.count),d;for(d=e.length-1;d>-1;d--){a.splice(e[d],1);}}},numSorter:function Z(d,c){return Number(d)-Number(c);},stringSorter:function J(e,d){var c=e.toLowerCase(),f=d.toLowerCase();if(c<f){return -1;}if(c>f){return 1;}return 0;},removeIndices:function O(a,c,b){a.splice(c,b);},insert:function F(b,a,c){if(!b){b=[];}if(a===null||a===undefined){a=b.length;}Array.prototype.splice.apply(b,[a,0].concat(c));return b;},hash:function C(b,d){d=d||{};var a=(b&&b.length)||0,c;for(c=0;c<a;c++){d[b[c]]=true;}return d;},get:function U(b,e){if(!e){return null;}var c=[],a=e.length,d;for(d=0;d<a;d++){c[d]=b[e[d]];}return c;},deepSortArr:function G(b,d,a,c){return b.sort(function(g,e){var h=g[a][d],f=e[a][d];if(!c){return(h<=f);}return(h>f)?-1:1;});},isArray:function(a){var b=Array.isArray;if(b){return b(a);}return Object.prototype.toString.call(a)==="[object Array]";},some:function K(b,c){if(!b){return false;}if(b.some){return b.some(c);}var a=false;this.forEach(b,function(e,d){a=c(e,d,b);return !a;});return a;},difference:function V(){if(arguments.length<2){throw new Error("difference should get at least 2 parameters");}var d=X(arguments),b=d.sets,c=d.compareFunc,e=b[0],a=[].concat.apply([],b.slice(1));return e.filter(function(f){return !a.some(function(g){return c(f,g);});});},intersection:function S(){if(arguments.length<2){throw new Error("intersection should get at least 2 parameters");}var e=X(arguments),c=e.sets,d=e.compareFunc,a=c[0],b=c.slice(1);b.forEach(function(f){a=a.filter(function(g){return f.some(function(h){return d(g,h);});});});return a;},fnReduceNumber:function A(a,b){return a+b;}});}());(function(){mstrmojo.vi.ui._IsUnitContainerTitleBar=mstrmojo.provide("mstrmojo.vi.ui._IsUnitContainerTitleBar",{_mixinName:"mstrmojo.vi.ui._IsUnitContainerTitleBar",layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},xt:true},setDimensions:function A(C,B){return this._super("auto",B);}});}());(function(){function D(K){var J=this.h.idx;if(J!==-1){return this.t.es[J][K];}return"";}mstrmojo.models.template.Header=mstrmojo.declare(null,null,{init:function H(J){this.h=J.h;this.t=J.t;},getName:function A(){return D.call(this,"n");},getElementId:function I(){return D.call(this,"id");},getObjectId:function B(){return D.call(this,"oid");},getElementIndex:function G(){return this.h.idx;},getActionType:function F(){return this.h.at;},isTotal:function E(){return this.h.otr===1;},getFormIndex:function C(){return this.h.fi;}});}());(function(){mstrmojo.requiresCls("mstrmojo.models.template.Header");mstrmojo.models.template.Headers=mstrmojo.declare(null,null,{init:function D(K){var O=this.isRow=K.isRow,J=this.data=K.data,L=J.gts,G=J.ghs,F=this.hs=O?G.rhs:G.chs,M=this.i=K.i,N=0,I;this.titles=O?L.row:L.col;this.headers=F.items&&F.items[M]&&F.items[M].items;if(O&&this.headers){N=this.titles.length-this.headers.length;if(N){for(I=M-1;I>=0;I--){var E=F.items[I].items,H=E.length-this.headers.length;if(H>0){this.headers=E.slice(0,H).concat(this.headers);if(this.titles.length===this.headers.length){break;}}}}}},size:function B(){var E=this.headers;return(!E?0:E.length);},getHeader:function C(H){var F=this.headers,G=F&&F[H],E=H;if(G&&mstrApp&&mstrApp.isVI){E=isNaN(G.tui)?G.ui:G.tui;}return G&&new mstrmojo.models.template.Header({h:G,t:this.titles[this.isRow?E:this.i]});},getCSS:function A(F){var E=this.headers;return E&&this.data.css[E[F].cni].n;},getHeaderCell:function(F){var E=this.headers;return E&&E[F];}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var N=/\{\@(en@)?([^\}]+)\}/gm,J=/\</gm,R=/\>/gm,E=/\S/,Q=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],F=new RegExp("(\\"+Q.join("|\\")+")","g"),S={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},C={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#039;",'"':"&quot;"},M={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'},D={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#039;",'"':"&quot;","\u20ac":"&#8364;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&#039;":"'","&quot;":'"',"&#8364;":"\u20ac"};var L=function(V){if(V===null){return"null";}var W=typeof V;if(W!=="object"){return W;}if(V.length===undefined){return"object";}return"array";};var T={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function G(W,Z,Y){var V;Y=Y||[];if(!W){return"";}var X=[];for(V in Z){if(mstrmojo.array.indexOf(Y,V)===-1){X.push(V.k||V);}}return W.replace(new RegExp(X.join("|"),"g"),function(a){var b=Z[a];return b.v||b;});},trim:function P(V){return(V&&V.replace)?V.replace(/^\s+/,"").replace(/\s+$/,""):V;},startsWith:function U(W,V){return W.length>=V.length&&W.substring(0,V.length)==V;},ellipsize:function A(X,W){var V=this.trim(X.substr(0,(W||1)-1));if(V!==X){V+="&hellip;";}return V;},isEmpty:function I(V){return(V===null)||(V===undefined)||!(E.test(V));},regEscape:function O(V){return V.replace(F,"\\$1");},encodeXMLAttribute:function(V){return mstrmojo.string.multiReplace(V,S);},encodeHtmlString:function(W,V,X){if(!W||!W.replace){return W;}if(X){return mstrmojo.string.multiReplace(W,D);}return mstrmojo.string.multiReplace(W,C,V?[" "]:[]);},decodeHtmlString:function(W,V){return V?mstrmojo.string.multiReplace(W,K):mstrmojo.string.multiReplace(W,M);},htmlAngles:function(V){if(!mstrmojo.string.isEmpty(V)){V=String(V);return V.replace(J,"&lt;").replace(R,"&gt;");}return V;},apply:function H(V,X){if(!V){return"";}var W=this;return V.replace(N,function Y(b,c,d){var Z;try{Z=mstrmojo.hash.walk(d,X);}catch(a){}Z=(Z===null||Z===undefined)?"":Z;return(!!c)?W.encodeHtmlString(Z,true):Z;});},json2xml:function(V,l,m){if(!(l instanceof Array)){l=[l];}var W=m&&m.isSerializable,k=(m.convertBoolean!==false),p=m&&m.skipFunctions,h,b;var d=[],Z=[],c,Y,a;for(h=0,b=l.length;h<b;h++){var g=l[h];for(c in g){if(p&&typeof g[c]==="function"){continue;}if(W){var o=W(c,l,h);if(o!==true){if(o===false){continue;}else{if(o.att){d.push(o.att);}if(o.child){Z.push(o.child);}continue;}}}Y=g[c];a=L(Y);switch(a){case"array":var e,f;Z.push("<"+c+">");for(e=0,f=Y.length;e<f;e++){var X=m.getArrItemName(c,Y,e)||e;Z.push(this.json2xml(X,Y[e],m));}Z.push("</"+c+">");break;case"object":Z.push(this.json2xml(c,Y,m));break;case"string":d.push(c+'="'+mstrmojo.string.encodeXMLAttribute(Y)+'"');break;case"boolean":d.push(c+'="'+(k?(Y?"-1":"0"):Y)+'"');break;case"null":if(!m.skipNull){d.push(c+'="'+m.nullValue+'"');}break;default:d.push(c+'="'+Y+'"');break;}}}return"<"+V+" "+d.join(" ")+">"+Z.join("")+"</"+V+">";},escape4HTMLText:function B(c){if(!c||!c.replace){return c;}var Z=/"/gm;var X="&quot;";var d=/&/gm;var b="&amp;";var a=/</gm;var V="&lt;";var Y=/>/gm;var W="&gt;";return c.replace(d,b).replace(Z,X).replace(a,V).replace(Y,W);},parseUri:function(Z,W){W=W||T;var V=W.parser[((W.strictMode)?"strict":"loose")].exec(Z),Y={},X=14;while(X--){Y[W.key[X]]=V[X]||"";}Y[W.q.name]={};Y[W.key[12]].replace(W.q.parser,function(b,a,c){if(a){Y[W.q.name][a]=c;}});return Y;},removeSpecialChars:function(V){return V.replace(/[^a-zA-Z0-9]/g,"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,M=mstrmojo.hash;function J(U){if(U!==null){return(U.constructor!==Array)?[U]:U;}return null;}function F(e,c,Y){if(!c){return null;}var f=[],V=e.selectedIndices,U=e.allIdx,a=e.noneIdx;if(e.multiSelect&&(a>-1)&&(I.indexOf(c,a)>-1)){return f;}var X,Z,d=e.items,b=e.itemIdField,W=e.selectedItems,h;if(e.multiSelect&&(U>-1)&&(I.indexOf(c,e.allIdx)>-1)){for(X=0,Z=d.length;X<Z;X++){if(!V[X]){f.push(X);V[X]=true;e.selectedIndex=X;e.selectedItem=d[X];}}}else{for(X=0,Z=c.length;X<Z;X++){var g=c[X];if(!V[g]){V[g]=true;if(Y){f.push({idx:g,positions:Y});}else{f.push(g);}e.selectedIndex=g;h=e.selectedItem=d[g];if(W){W[h[b]]=h;}}}}return f;}function D(X,U){var W=[],Y=X.selectedIndices,Z=X.selectedItems,V;for(V in Y){delete Y[V];if(U){W.push({idx:parseInt(V,10),positions:U});}else{W.push(parseInt(V,10));}}X.selectedIndex=-1;X.selectedItem=null;if(Z){X.selectedItems={};}return W;}function T(e,d,Y){if(!d){return null;}var a=[],V=e.selectedIndices,g=I.indexOf,U=e.allIdx,b=e.noneIdx,c=e.itemIdField,W=e.selectedItems;if(e.multiSelect&&(((U>-1)&&(g(d,U)>-1))||((b>-1)&&(g(d,b)>-1)))){return D(e);}if(d.length>0&&V[U]){if(g(d,U)<0){d.push(U);}}var Z=d.length,X;for(X=0;X<Z;X++){var f=d[X];if(V[f]){delete V[f];if(Y){a.push({idx:f,positions:Y});}else{a.push(f);}if(W){delete W[e.items[f][c]];}if(e.selectedIndex===f){e.selectedIndex=-1;e.selectedItem=null;}}}return a;}function C(X,Y,V,U){if(U){return ;}if(this.raiseEvent){if((X&&X.length)||(Y&&Y.length)){try{this.raiseEvent({name:"selectionChange",added:X,removed:Y});}catch(W){T(this,X);F(this,Y);throw W;}}}}function B(V){var W=this.itemIdField,U=this.items;if(typeof V==="object"&&W){return I.find(U,W,V[W]);}return I.indexOf(U,V);}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,noneIdx:-1,itemIdField:"",items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(U){this._super(U);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function K(d){d=J(d);if(!d){return ;}var a=this.items,U=this.items.length,W=this.selectedItems,Y=[],V;a=this.items=a.concat(d);V=a.length;if(W){var Z=this.itemIdField,X,c;for(X=U;X<a.length;X++){c=a[X];if(W[c[Z]]){Y.push(X);}}}if(Y&&Y.length){F(this,Y);}if(V>U){var b=this.itemsContainerNode;if(b){b.innerHTML+=this._buildItemsMarkup(U,V-1).join("");}}},addSelectedItems:function S(U){this.selectItems(U,false);},setSelectedItems:function L(U){this.selectItems(U,true);},selectItems:function R(c,e){c=J(c);if(!c){return ;}if(e&&this.selectedItems){this.selectedItems={};}var W=this.selectedItems,a=this.itemIdField,U=[],Y=this.items.length,Z=[],V=this.allowUnlistedValues,d,b,X;for(X=0;X<c.length;X++){d=c[X];b=B.call(this,d);if(b<0){if(W===null){if(V){U.push(d);b=Y++;Z.push(b);}}else{W[d[a]]=d;}}else{Z.push(b);}}if(U.length>0){this.addItems(U);}if(Z.length>0){if(e){this.select(Z);}else{this.addSelect(Z);}}},unselectItems:function A(V){V=J(V);if(!V){return ;}var a=this.selectedItems,W=[],Z=this.itemIdField,Y,U,X;if(a===null){return ;}for(X=0;X<V.length;X++){Y=V[X];if(a){delete a[Y[Z]];}U=B.call(this,Y);if(U<0){W.push(U);}}if(W.length>0){this.removeSelect(W);}},getSelectedItems:function G(){if(this.selectedItems){return M.valarray(this.selectedItems);}return I.get(this.items,M.keyarray(this.selectedIndices,true));},singleSelect:function(V,W,U){if(V!==-1){this.select([V],W,U);}},singleSelectByField:function O(V,W,U){this.singleSelect(I.find(this.items,W,V),U);},toggleSelect:function Q(U){var W,V;if(this.selectedIndices[U]){V=T(this,[U]);}else{W=F(this,[U]);}C.call(this,W,V,[U]);},select:function(W,V,U){W=J(W);if(!W){return ;}var Y=D(this,U),a=F(this,W,U),X;if(this.selectionPolicy!=="reselect"){for(X=Y.length-1;X>=0;X--){var Z=I.indexOf(a,Y[X]);if(Z>-1){Y.splice(X,1);a.splice(Z,1);}}}C.call(this,a,Y,W,V);},rangeSelect:function H(V,U){var a=this.selectedIndex,Y=a,Z=this.allIdx,W=[],X;if(V===Z||this.selectedIndices[Z]){W.push(Z);}else{if(Y===-1&&this.selectedIndices){for(X in this.selectedIndices){Y=parseInt(X,10);break;}}Y=Y===-1?0:Y;if(Y>V){Y=V;V=a;}for(X=Y;X<=V;X++){W.push(X);}}this.select(W,U);this.selectedIndex=a;},clearSelect:function(U){C.call(this,null,D(this),[],U);if(!U){this.raiseEvent({name:"clearSelection"});}},addSelect:function(X,U,V){X=J(X);if(!X){return ;}var W=F(this,X,V),Z=null,Y=this.noneIdx;if(this.multiSelect&&(Y>-1&&I.indexOf(X,Y)>-1)){Z=T(this,X);}C.call(this,W,Z,X,U);},removeSelect:function(W,U,V){W=J(W);if(!W){return ;}C.call(this,null,T(this,W,V),W,U);},_set_selectedIndices:function P(W,c,U){if(this.selectedItems){this.selectedItems={};}var V=this.selectedIndices;if(V===c){return false;}if(!V){V={};this.selectedIndices=V;}if(!c){c={};}var a=this.selectedIndex,Z=[],b;for(b in V){if(!c[b]){b=parseInt(b,10);delete V[b];Z.push(b);if(a===b){this.selectedIndex=-1;this.selectedItem=null;}}}var f=[],d=this.items,Y=this.itemIdField,e;for(b in c){if(!V[b]){b=parseInt(b,10);V[b]=true;f.push(b);this.selectedIndex=b;e=this.selectedItem=d[b];if(this.selectedItems){this.selectedItems[e[Y]]=e;}}}if(U!==true){var X=[];for(b in c){if(V[b]){b=parseInt(b,10);X.push(b);}}C.call(this,f,Z,X);}return(f.length||Z.length);},_set_selectedIndex:function N(X,V,U){var W={};if(V>-1){W[V]=true;}return this._set_selectedIndices("selectedIndices",W,U);},_set_selectedItem:function E(X,W,V){var U=B.call(this,W);if((U<0)&&(W!==null&&W!==undefined)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(W));U=this.items.length-1;}return this._set_selectedIndex("selectedIndex",U,V);},_addSelections:function(U){return F(this,U);},_removeAll:function(){return D(this);}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._IsPanelStack=mstrmojo.provide("mstrmojo._IsPanelStack",{_mixinName:"mstrmojo._IsPanelStack",TTL_SRC_PANEL:0,model:null,selectedIdx:undefined,init:function J(O){this._super(O);var N=this.defn;if(!N){N=this.defn=this.node&&this.node.defn;this.titleSrc=this.titleSrc||N.ttlSrc;}var M=this.selectedKey=this.defn.selKey=this.node.data.selKey;this.set("selectedIdx",E.find(this.node.data.panels,"k",M));N.attachEventListener("selKeyChange",this.id,function(P){this.set("selectedKey",P.value);});},addChildren:function L(O,U,S){var T=this.getFormats(),Q=T&&T.overflow,P=O.length,R;for(R=0;R<P;R++){var N=O[R],V=N.k;if(V){N.selected=N.visible=V===this.selectedKey;if(Q){var M=N.getFormats()||N.createEmptyFormats();if(M){M.overflow=Q;}}}}return this._super(O,U,S);},refresh:function F(){if(this.hasRendered){var M=this.defn.newSelKey||this.selectedKey;E.forEach(this.children,function(O){var N=O.k;if(N){O._delayRefresh=(N!==M);if(!O._delayRefresh){O.refresh();}}});}delete this.defn.newSelKey;},selectPanel:function B(N,O,M){var P=this.model.getDataService(),Q=P.newUpdateWithoutCmd();this.selectPanelDeferred(Q,N,O,M);if(Q.actions&&Q.actions.length>0){P.addSuppressData(Q.extras);Q.submit();}},selectPanelDeferred:function(P,N,O,M){if(N!==this.selectedKey){this.defn.set("selKeyChange",N);this.model.selectPanelDeferred(P,this.k,N,this.node.data.wid,O,M);}},onselectedKeyChange:function K(N){var O=0,R,M,P;E.forEach(this.children,function(T,S){var U=T.k;if(U){if(N.value===U){M=T;P=S-O;T.set("visible",true);T.set("selected",true);}else{if(N.valueWas===U){R=T;T.set("selected",false);T.set("visible",false);}}if(M&&R){return false;}}else{O++;}return true;});if(this.titleSrc===this.TTL_SRC_PANEL&&this.title){var Q=M&&M.title;this.set("title",Q);this.defn.ttl=Q;}this.prevSelectIdx=this.selectedIdx;this.set("selectedIdx",P);this.raiseEvent({name:"panelSelected",key:M.k});return{on:M,off:R};},getSelectedPanel:function D(){var M=0,N=this.selectedIdx,O;E.forEach(this.children,function(Q,P){if(Q.k){if(P-M===N){O=Q;return false;}}else{M++;}return true;});return O;},setDirtyChildren:function H(M){var N=this.selectedKey;E.forEach(this.children,function(P){var O=P.k;if(O){P[((M||O!==N)?"add":"remove")+"DirtyKey"](O);}});},clearDirtyChild:function I(O){var N=this.children,M=N[E.find(N,"k",O)];if(M){M.removeDirtyKey(M.k);}},isPanelStack:true,checkRequiredObjects:function C(){var M=this.txWidgets||{},N=true,O;for(O in M){N&=!!M[O].checkRequiredObjects();}return N;},updateSelectedIdx:mstrmojo.emptyFn,unrender:function G(M){delete this.defn.newSelKey;this._super(M);},switchToPanel:function A(M,N){if(N!==undefined){this.set("selectedIdx",N);}else{this.updateSelectedIdx(M);}this.children[this.selectedIdx]&&this.selectPanel(this.children[this.selectedIdx].k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.vi.ui.rw.SelectionType={EMPTY:"empty",ATTS:"att",METRICS:"metric",COL_HEADERS:"col-headers",ROW_HEADERS:"row-headers",METRIC_VALUES:"metric-values"};var D=function(Z){var Y=(mstrApp.docModelData&&mstrApp.docModelData.mid)||"";return Z.k+"-"+Y;},M={},Q=mstrmojo.hash,V=mstrmojo.array,S=function(a){var Y=Q.keyarray(a).sort(),Z=[],b;V.forEach(Y,function(c){b=[];V.forEach(a[c],function(d){b.push(this.model.getNormalizedFormElementId(d.id));},this);Z.push(c+"-"+b.sort().join("@"));},this);return Z.join("#");},X=function(Y){var Z=S.call(this,Y);if(!this._viSelections[Z]){this._viSelections[Z]=Y;M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}},C=function(Z){var a=S.call(this,Z),Y=this._viSelections[a];if(Y){delete this._viSelections[a];M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}return Y;},K=function(Z,Y,b){var a={};a[Z]=[{id:Y,n:b}];return a;},O=mstrmojo.vi.ui.rw.SelectionType;mstrmojo.vi.ui.rw._HasVisSelections=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisSelections",{_mixinName:"mstrmojo.vi.ui.rw._HasVisSelections",init:function(Y){if(this._super){this._super(Y);}this._viSelections={};},update:function F(Z){var Y=true;if(this._super){Y=this._super(Z);}Q.copy(M[D(this)],this);return Y;},onSelectionChange:function L(Y){if(this._super){this._super(Y);}},_viSelections:{},_selectionType:O.EMPTY,getSelectionType:function(){return this._selectionType;},isSingleAttrSelection:function(){var Z=null,Y;if(this.getSelectionType()===O.ATTS){Y=this.getSelections();if(Y.length>1){return !Y.some(function(a){if(!Z){Z=a[0].tid;return false;}return Z!=a[0].tid;},this);}return true;}return false;},isSingleSelection:function(){return(this._viSelections&&Q.keyarray(this._viSelections).length===1);},getSelectionSize:function U(){return(this._viSelections&&Q.keyarray(this._viSelections).length)||0;},getSelectionHash:function E(){return this._viSelections;},getSelections:function I(){var Y=[],Z;Q.forEach(this._viSelections,function(a){Z=[];Y.push(Z);Q.forEach(a,function(b,c){V.forEach(b,function(d){Z.push({tid:c,eid:d.id,v:d.n});});});});return Y;},isMetricValueSelected:function G(Y){return !!this._viSelections[S.call(this,Y)];},isAttSelected:function B(Z,Y){return this.isMetricValueSelected(K(Z,Y));},addAttributeSelection:function N(Z,Y,a){if(this._selectionType!==O.ATTS){this.clearSelections();this._selectionType=O.ATTS;}var b=K.call(this,Z,Y,a);X.call(this,b);return b[Z];},removeAttributeSelection:function W(Z,Y){return C.call(this,K.call(this,Z,Y));},addMetricValueSelection:function J(Y){if(this._selectionType!==O.METRICS){this.clearSelections();this._selectionType=O.METRICS;}X.call(this,Y);},removeMetricValueSelection:function R(Y){return C.call(this,Y);},clearSelections:function A(){if(this._super){this._super();}this._viSelections={};this._selectionType=O.EMPTY;},clearSelectionsCache:function H(){M={};},clearUnitSelections:function A(Z){if(this._super){this._super();}var Y={};Q.forEach(this._viSelections,function(b,a){if(Q.keyarray(b)[0]!==Z){Y[a]=b;}});this._viSelections=Y;},endSelections:function P(){M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};this.onSelectionChange(this.getSelectionHash());},addSelectionsFromExpression:function T(a){this.clearSelections();this._selectionType=a.type;var Y=this,Z=function(g){var h=20,e=19,f=function(k){return k.nds.length===1?h:k.fn;},d=function(k){return parseInt(k.et,10)===5||parseInt(f(k),10)===e;},b=function(k){V.forEach(k.es,function(l){Y.addAttributeSelection(k.a.did,l.v,l.n);});},c=function(m){var l={},k=function(o){V.forEach(o.es,function(n){Q.copy(K.call(Y,o.a.did,n.v,n.n),l);});};if(m.nds){V.forEach(m.nds,k);}else{if(m.es){k(m);}}Y.addMetricValueSelection(l);};if(d(g)){g={nds:[g]};}V.forEach(g.nds,function(k){if(d(k)){if(a.type===O.ATTS){b(k);}else{c(k);}}else{Z(k);}});};Z(a.data);}});mstrmojo.vi.ui.rw._HasVisSelections.VisSelectionType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo,D=A.array;mstrmojo.vi.util.TemplateUtils=mstrmojo.provide("mstrmojo.vi.util.TemplateUtils",{getTemplateUnits:function B(F){var E=[].concat(F.mx);(F.rows||[]).concat(F.cols||[]).forEach(function(G){if(G.did!=="-1"){E.push({did:G.did,t:G.t,n:G.n});}});return E;},findUnitsById:function C(H,F){var E=mstrmojo.vi.util.TemplateUtils.getTemplateUnits(H),G=[];D.ensureArray(F).forEach(function(K){var J=D.find(E,"did",K),I=J>-1?E[J]:null;if(I){G.push(I);}});return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,B=mstrmojo.hash,D="u;",C="-1";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function F(P,O,R){var N,M;for(M in P){N=P[M];if(N.v){var Q=N.v.split(";");if(Q&&Q.length>1){Q[1]=O;if(R&&Q.length>2){Q.pop();}N.v=Q.join(";");}}}return P;},buildElemsCountStr:function K(P,N){P=(!P||!P.length)?[]:P;N=(!N||!N.length)?[]:N;var O=P.length,M=N.length;if(I.find(N,"v",D)>-1){M-=1;}if(I.find(N,"v",C)>-1){M-=1;}if(I.find(P,"v",D)>-1||I.indexOf(P,D)>-1){O=M;}return this.buildElemsCountStrByNum(O,M);},buildElemsCountStrByNum:function K(N,M){if(N===M){if(M===0){return"";}return M.toString();}else{if(M===0){return N+" "+mstrmojo.desc(514);}else{if(N>M){return"("+M+")";}}}return mstrmojo.desc(4891,"").replace("##",String(N)).replace("###",String(M));},browseElements:function G(O,P,N){var M={doNotHold:!(N&&mstrApp.serverProxy),silent:true};mstrApp.serverRequest(mstrmojo.hash.copy(N,P),O,M);},getIdPresentation:function J(P){if(!!P){var O=P.charAt(0),M,N,Q;if((O>="g"&&O<="w")||(O>="V"&&O<="Z")){N=false;for(Q=1;Q<P.length;++Q){if(N){N=false;}else{switch(P.charAt(Q)){case";":return"terseLong";case"\\":N=true;break;}}}return"terse";}if(O>="B"&&O<="Q"){if(P.length>2){M=P.charAt(1);if(M>="A"&&M<="Q"){if(P.charAt(2)===":"){return"oldLong";}}}}if(P.length>=33&&P.charAt(32)===":"){return"old";}}return null;},isNullElem:function H(M){if(!M){return true;}var P=this.getIdPresentation(M),N=false,O;switch(P){case"terse":case"terseLong":O=M.substring(1,M.length).split(";");N=O[0].indexOf(this.TERSE_NULL)>-1;break;case"old":case"oldLong":N=M.indexOf(this.OLD_NULL)>-1;break;}return N;},isNonGroupNull:function(O){var M=O.eid||(O._e&&O._e.id),N=M&&M.split(":")[0];return N&&N===this.NON_GROUP_NULL;},getAttributeId:function L(O){var N,M;if(O){M=O.split(";");N=M[1];}return N;},getElementValue:function A(N){var O,M;if(N){M=N.split(";");if(M.length>2){O=M[0]+" "+M[2];}else{O=M[0];}}return O;},isAttributeIdsLinked:function E(N,M,O){var Q=false,P=B.keyarray(O);I.forEach(P,function(R){if(R===N){I.forEach(O[R],function(S){if(S===M){Q=true;return false;}});}if(Q){return false;}});return Q;},ELEM_ALL_ID:"u;",ELEM_DUMMY_ID:"-1",ELEM_SEPARATOR:"\u001E",OLD_NULL:"~!@@~~!@@~",TERSE_NULL:"\\N",NON_GROUP_NULL:"n00000000000000000000000000000000"});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo.array;mstrmojo.fe._IsRelationTreeNode=mstrmojo.provide("mstrmojo.fe._IsRelationTreeNode",{createSetHtml:'<span class="mstrmojo-textset mstrmojo-create-set-text" mstrAttach:click >'+mstrmojo.desc(12034,"Create a Set")+"</span>",syncRootOperator:function(){var F=this.parent,H=function(){var J=this.parent,I=[];if(J){I=J.ctxtBuilder.itemWidgets;}return I;},E,D,B,C,G;if(F){E=H.call(this);B=E.length;D=A.find(E,"noRelationOperator",true)!==-1;for(C=0;C<B;C++){G=E[C];G&&G.set("noRelationOperator",D);}this.set("noRelationOperator",D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var H=mstrmojo.array,B=mstrmojo.hash,J=B.isEmpty;var G=1;function D(Q){return(typeof Q==="object")?Q:{};}function E(R,Q){B.forEach(Q,function(S,V){var T=R[V];if(T===undefined){delete Q[V];return true;}S=Q[V]=D(S);T=R[V]=D(T);if(J(S)&&J(T)){throw (G);}else{if(J(T)){delete R[V];if(J(R[V])){E(R,Q);}}else{if(J(S)){delete R[V];if(J(R[V])){E(R,Q);}}else{try{E(R[V],Q[V]);}catch(U){switch(U){case G:R[V]=Q[V]={};break;}}}}}});}function I(Q){B.forEach(Q,function(R){B.forEach(R,function(U,S){var T=U.include,W=U.exclude;if(J(T)||J(W)){return true;}if(!J(T)&&!J(W)){try{E(W,T);}catch(V){switch(V){case G:R[S]={};break;}}}});});return Q;}function F(S,R,Q){B.forEach(S,function(U,T){if(U===true||J(U)){Q.push(R+T);}else{F(U,R+T+".",Q);}});return Q;}function P(Q){B.forEach(Q,function(R){B.forEach(R,function(U,S){var T=[];F(U.include,"",T);F(U.exclude,"!",T);R[S]=T.join(";");});});return Q;}function K(Q,R){B.forEach(Q,function(S,U){var T=R[U];if(T!==undefined){if(S!==true&&T!==true){K(S,T);}else{if(S===true&&T!==true){R[U]=true;}else{if(S!==true&&T===true){Q[U]=true;}}}}});}function L(R,S){var Q=true;B.forEach(R,function(Y,T){var W=S[T];if(W){var U=Y.include,Z=Y.exclude,X=W.include,V=W.exclude;if(!J(V)&&!J(Z)){Q=false;return Q;}if(!J(X)&&!J(U)){K(X,U);}}return Q;});return Q;}function C(S,Q){Q=Q||{};if(S){var R=Q;H.forEach(S.split("."),function(W,U,T,V){R[W]=V?true:{};R=R[W];});}return Q;}mstrmojo.rw.model.RetrievalKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.RetrievalKeysConfig",init:function M(){this.nodes=[];this.filters={};},addNode:function A(R,T){var S=this.filters,Q=S[R];if(!Q){this.nodes.push(R);Q=S[R]={data:{},defn:{}};}if(T){if(L(Q,T)){S[R]=B.mergeHashes(Q,T);}else{throw ("The new filters for node key ## cannot be merged with the filters currently defined".replace("##",R));}}return this;}});mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig=function O(T){var Q={},U={},S={};H.forEach(T,function R(W){var V=W.partialRetrieval;if(V){H.forEach(V.nodes,function(X){U[X]=true;});S=B.mergeHashes(S,V.filters);delete W.partialRetrieval;}H.forEach(W.actions,R);});if(!J(U)){Q.nodes=B.keyarray(U);}if(!J(S)){Q.filters=P(I(S));}return Q;};mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters=function N(R){var Q=function(T){var S={};B.forEach(T,function(W,V){var U=S[V]={serialized:W,include:{},exclude:{}};H.forEach(W.split(";"),function(Y){var X=Y.indexOf("!")===0;Y=X?Y.slice(1):Y;C(Y,X?U.exclude:U.include);});});return S;};return{data:Q(R.data),defn:Q(R.defn)};};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom");var D=mstrmojo.dom,I=mstrmojo.array;function F(){var S=this;S.selectedRows=[];S.headersData="";S.rowsData="";S.clipBoardText="";S.globalRowCounter=0;S.allRows=new Array();}function H(T){F.call(this);var X,S=T.length;var W=N.call(this,D.findAncestorByName(T[0],"tr",true,this.domNode)),Y=W.headerRowCount,U=W.maxHeaderChildCount,V=W.gridOffset;for(X=0;X<S;X++){E.call(this,T[X],"tr",true,this.domNode,Y,U,V);}}function N(b){var S=this.rhsCP.startIndexInContainer||0,X=0;var V,U=0,W=b&&b.parentNode;while(W.hasAttribute("n")&&parseInt(W.getAttribute("n"),10)>0){W=W.previousElementSibling;}var T=W.firstChild,Z=T.childNodes;for(V=0;V<Z.length;V++){X+=parseInt(Z[V].getAttribute("colspan"));}var Y=O(T,S,X);this.headersData=Y.headerText;var a=Y.firstDataRow;if(a&&a.childElementCount>X){U=1;}return{headerRowCount:S,maxHeaderChildCount:X,gridOffset:U};}function O(a,Y,T){var V=0,U,X="",S=0,b,Z,W;while(S<Y){W=a.childNodes;b=W.length;if(S!=0){X+="\n";for(V=0;V<(T-b);V++){X+="\t";}}for(V=0;a&&V<b;V++){U=W[V].innerText||W[V].textContent;X+=U?(U+"\t"):"";Z=W[V].getAttribute("colspan");while(Z>1){X+="\t";Z--;}}a=a.nextSibling;S++;}return{headerText:X,firstDataRow:a};}function K(S){return this.allRows[this.globalRowCounter-1][S];}function E(W,e,f,S,Z,V,b){var a=[],U=[],T=W.rowSpan,X=0,k="",Y=0,h="",g=D.findAncestorByName(W,e,f,S),d=this,c=d.allRows;if((g.childElementCount-b)<V){U=d.rhsCP.getUnmergedCells(W.getAttribute("r")-Z);for(X=0;X<U.length;X++){a[X]=(U[X]._e)?U[X]._e.n:" ";}}if(T===1){c[d.globalRowCounter]=new Array(V);Y=0;if(a.length>0){a.forEach(function(l){k+=l+"\t";c[d.globalRowCounter][Y++]=l;});}k=G.call(d,g,k,Y);P.call(d,k);this.globalRowCounter++;}else{while(T>0){Y=0;c[d.globalRowCounter]=new Array(V);k="";X=V-(g.childElementCount-b);while(X>0){h=a[Y]?a[Y]:K.call(d,Y);k+=h+"\t";c[d.globalRowCounter][Y++]=h;X--;}k=G.call(d,g,k,Y);P.call(d,k);d.globalRowCounter++;g=g.nextSibling;T--;}}}function G(S,W,X){var T,U,V=S.childNodes;for(T=0;T<V.length;T++){U=V[T].innerText||V[T].textContent;W+=U?(U+"\t"):"";this.allRows[this.globalRowCounter][X++]=U?(U):"";}return W;}function P(S){if(I.indexOf(this.selectedRows,S)<0){this.selectedRows.push(S);this.rowsData+=S+"\n";}}function C(){this.clipBoardText=(this.headersData)?this.headersData+"\n"+this.rowsData:this.rowsData;}function Q(){var S=this.xTabHiddenTextArea;S.readOnly=false;S.value=this.clipBoardText;S.readOnly=true;S.focus();S.select();}function A(){try{document.execCommand("copy");}catch(S){console.log("Exception while copying data"+S);}}function J(){var S=this;S.selectedRows=null;S.allRows=null;S.headersData=null;S.rowsData=null;}mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste=mstrmojo.provide("mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste",{_mixinName:"mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste",xTabHiddenTextArea:undefined,isCopySupported:false,selectedRows:[],headersData:"",rowsData:"",clipBoardText:"",globalRowCounter:0,allRows:undefined,init:function M(S){this._super(S);this.isCopySupported=!(mstrApp.isSingleTier&&D.isMac()||D.isSafari||D.isFF);},onclick:function R(S){this._super(S);if(this.selCells.length>0&&!D.isMobile){this.prepareClipBoardData.call(this,this.selCells);}},prepareClipBoardData:function L(S){H.call(this,S);C.call(this);Q.call(this);J.call(this);},copyRowsFromXtab:function B(T,S){if(S.length<1){return ;}if(this.isCopySupported){Q.call(this);A.call(this);}J.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.hasRendered&&D.doEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsize,this.shouldEllipsizeChildren);},onshouldEllipsizeChildrenChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsizeChildren,this.shouldEllipsize);},_onEllipsizeFlagChange:function(D,C){if(D&&!C){A(this);this.markupMethods=mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered){this.doEllipsize();}}},mstrmojo.hash.copy(this.markupMethods));}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var H="#000000",E=Math.round;function N(X){return("0"+parseInt(X,10).toString(16)).slice(-2);}mstrmojo.color=mstrmojo.provide("mstrmojo.color",{rgbStr2rgb:function V(X){return X.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i).slice(1);},rgbStr2hex:function F(X){if(X.indexOf("rgb")>=0){var Y=this.rgbStr2rgb(X);return"#"+this.rgb2hex(Y[0],Y[1],Y[2]);}return X;},rgb2hex:function B(Z,Y,X){return N(Z)+N(Y)+N(X);},rgb2hsv:function U(X,e,k){var a=Math.min(X,e,k),l=Math.max(X,e,k),c=0,o,n;n=l/255;o=(l!==0)?(parseFloat(l)-parseFloat(a))/parseFloat(l):0;if(o===0){c=0;}else{var f=l-a,Y=(l-X)/f,Z=(l-e)/f,m=(l-k)/f;if(X===l){c=m-Z;}else{if(e===l){c=2+Y-m;}else{c=4+Z-Y;}}c=c/6;if(c<0){c=c+1;}}return[E(c*360),E(o*100),E(n*100)];},rgb2hsl:function D(X,c,d){X/=255;c/=255;d/=255;var e=Math.max(X,c,d),Z=Math.min(X,c,d),Y=(e+Z)/2,a,k;if(e===Z){a=k=0;}else{var f=e-Z;k=Y>0.5?f/(2-e-Z):f/(e+Z);switch(e){case X:a=(c-d)/f+(c<d?6:0);break;case c:a=(d-X)/f+2;break;case d:a=(X-c)/f+4;break;}a/=6;}return[a,k,Y];},hsl2rgb:function C(d,k,c){var a=function a(h,g,b){if(b<0){b+=1;}if(b>1){b-=1;}if(b<1/6){return h+(g-h)*6*b;}if(b<1/2){return g;}if(b<2/3){return h+(g-h)*(2/3-b)*6;}return h;},X,e,f;if(k===0){X=e=f=c;}else{var Y=c<0.5?c*(1+k):c+k-c*k,Z=2*c-Y;X=a(Z,Y,d+1/3);e=a(Z,Y,d);f=a(Z,Y,d-1/3);}return[E(X*255),E(e*255),E(f*255)];},hsl2hex:function I(Z,Y,X){return"#"+mstrmojo.array.map(this.hsl2rgb(Z,Y,X),function(a){return N(a);}).join("");},hex2rgb:function P(a){var X=this.fixFullHexValue("#"+a.replace("#","")),Y=[],Z;X=X.replace("#","");for(Z=0;Z<3;Z++){Y.push(parseInt(X.substr(Z*2,2),16));}return Y;},hex2bgr:function K(X){return this.hex2rgb(X).reverse();},hex2hsv:function S(Y){var X=this.hex2rgb(Y);return this.rgb2hsv(X[0],X[1],X[2]);},hex2hsl:function W(X){return this.rgb2hsl.apply(this,this.hex2rgb(X));},hsv2rgb:function G(f,u,n){f=f/360;u=u/100;n=n/100;var X,k,m;if(u===0){X=n*255;k=n*255;m=n*255;}else{var a=f*6;if(a===6){a=0;}var e=Math.floor(a);var Z=n*(1-u);var Y=n*(1-u*(a-e));var o=n*(1-u*(1-(a-e)));var l,c,d;switch(e){case 0:l=n;c=o;d=Z;break;case 1:l=Y;c=n;d=Z;break;case 2:l=Z;c=n;d=o;break;case 3:l=Z;c=Y;d=n;break;case 4:l=o;c=Z;d=n;break;default:l=n;c=Z;d=Y;break;}X=l*255;k=c*255;m=d*255;}return[E(X),E(k),E(m)];},hsv2hex:function L(a,Z,X){var Y=this.hsv2rgb(a,Z,X);return this.rgb2hex(Y[0],Y[1],Y[2]);},getContrastingColor:function M(a,Y,X){var Z=this.hex2rgb(a);return(((Z[0]*299)+(Z[1]*587)+(Z[2]*114))/1000<125)?Y:X;},getHighlightColor:function R(f,d){var X,e,h,k,l=this.hex2rgb(!d?"#FFCE7F":"#EFE6D8"),c=parseInt(f[0],10),Z=parseInt(f[1],10),n=parseInt(f[2],10),a=parseInt(l[0],10),Y=parseInt(l[1],10),m=parseInt(l[2],10);X=(c*a)/255;e=(Z*Y)/255;h=(n*m)/255;k=c*0.3+Z*0.59+n*0.11;if(k<85){X=X+(63*(85-k)/85);X=X>255?255:X;e=e+(63*(85-k)/85);e=e>255?255:e;h=h+(63*(85-k)/85);h=h>255?255:h;}return"#"+this.rgb2hex(E(X),E(e),E(h));},get3DBorderColor:function Q(Z,d){var Y=parseInt(Z[0],10)*0.3+parseInt(Z[1],10)*0.59+parseInt(Z[2],10)*0.11;var c=parseInt(Z[0],10);var a=parseInt(Z[1],10);var X=parseInt(Z[2],10);switch(d){case"light":if(Y>150){c=c*0.9;a=a*0.9;X=X*0.9;}else{c=c*0.6+102;a=a*0.6+102;X=X*0.6+102;}break;case"dark":if(Y>10){c=c*0.4;a=a*0.4;X=X*0.4;}else{c=c*0.8+30;a=a*0.8+30;X=X*0.8+30;}break;}return"#"+this.rgb2hex(E(c),E(a),E(X));},encodeColor:function J(X,Y){if(Y!==undefined&&(X===null||X.length===0||X==="undefined")){X=Y;}if(X==="transparent"){return -1;}if(parseInt(X,10)===-2){return -2;}if(X.substring(0,1)==="#"){X=X.substring(1);}return parseInt(X.substring(4)+X.substring(2,4)+X.substring(0,2),16);},decodeColor:function A(X){X=parseInt(X,10);if(X===0){return H;}var Y=16777216+(X&255)*65536+(X&65280)+(X&16711680)/65536;return"#"+Y.toString(16).substring(1).toUpperCase();},fixFullHexValue:function T(X){if(X&&X.length===4){return X.replace(/([0-9a-f])/ig,"$1$1");}return X;},findMidColorHex:function O(a,Z){var b=this.hex2rgb(a),X=this.hex2rgb(Z),Y=[];b.forEach(function(c,d){Y.push(parseInt((c+X[d])/2,10));});return("#"+this.rgb2hex(Y[0],Y[1],Y[2]));}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var B={};var E={};mstrmojo.publisher=mstrmojo.provide("mstrmojo.publisher",{publish:function F(H,Q,L){var M=B[H]&&B[H][Q],O;if(!M){return ;}for(O in M){var J=null;if(O){J=mstrmojo.all[O];if(!J){delete M[O];continue;}}var R=M[O].methods;if(R){var P=J||mstrmojo.global,I;for(I in R){if(P[I]){P[I](L);}}}var N=M[O]&&M[O].functions,S=(N&&N.length)||0;if(S){var K;if(J){for(K=S-1;K>-1;K--){if(N[K]){N[K].apply(J,[L]);}}}else{for(K=S-1;K>-1;K--){if(N[K]){N[K](L);}}}}}},subscribe:function D(I,N,R,J){var S=B[I];if(!S){S={};B[I]=S;}var M=S[N];if(!M){M={};S[N]=M;}var K=M[J||""];if(!K){K={};M[J||""]=K;}if(typeof R==="function"){var L=K.functions;if(!L){L=[];K.functions=L;}L.push(R);}else{var H=K.methods;if(!H){H={};K.methods=H;}H[R]=true;}var Q=E,P=Q[J||""];if(!P){P={};Q[J||""]=P;}var O=P[I];if(!O){O={};P[I]=O;}O[N]=true;return{id:I,type:N,callback:R,listener:J,clear:function(){mstrmojo.publisher.unsubscribe(this);}};},unsubscribe:function C(I){var R=B[I.id],O=R&&R[I.type],L=O&&O[I.listener||""];if(!L){return ;}var K=mstrmojo.array,Q=mstrmojo.hash,P=typeof I.callback,M=false;if(P==="function"){var N=L.functions;if(N){K.removeItem(N,I.callback);if(!N.length){delete L.functions;if(Q.isEmpty(L.methods)){M=true;}}}}else{var J=L.methods;if(J){delete J[I.callback];if(Q.isEmpty(J)){delete L.methods;if(!L.functions||!L.functions.length){M=true;}}}}if(M){delete O[I.listener||""];if(Q.isEmpty(O)){delete R[I.type];}}},hasSubs:function G(K,J){var I=B[K],H=I&&I[J];return !!H;},clearSubscriptions:function A(I){if(!I){I="";}var P=B,M=mstrmojo.hash,H;if(P[I]){delete P[I];}var O=E[I];if(O){for(H in O){var N=P[H],L=O[H],K;if(!N){continue;}for(K in L){var J=N[K];if(!J){continue;}delete J[I];if(M.isEmpty(J)){delete N[K];}}}}delete E[I];}});mstrmojo.publisher.NO_SRC="NO_SRC";mstrmojo.publisher.CONNECTIVITY_CHANGED_EVENT="CONNECTIVITY_CHANGED";mstrmojo.publisher.RECONCILE_END_EVENT="RECONCILE_END";}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array;function B(){var H=this.buildConfig=this.buildConfig||{};H.pk=this.k;H.fgk=this.defn&&this.defn.fgk;return H;}mstrmojo._HasBuilder={builder:null,postBuildRendering:function D(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function F(){return this.model.getChildren(this.node,false);},buildChildren:function E(H){if(!this.builder||!this.model){return false;}var J=this.children;if(J&&J.length){this.set("children",[]);}var I=this.builder.build(this.getChildren(),this.model,B.call(this));if(!H){this.addChildren(I);}this.builtChildren=true;return H?I:true;},rebuildChildren:function C(K){var H=this.children.slice(0),I=this.model,J=[];K=K||H.slice(0);K.forEach(function(P){var N=G.indexOf(H,P),O=P.k;if(N===-1){throw new Error("Invalid child requested rebuild in mstrmojo._HasBuilder::rebuildChild.");}this.removeChildren(P);P.destroy();J.push(O);},this);var L=I.getChildrenByKey(this.node,false,J);var M=this.builder.build(L,I,B.call(this));this.addChildren(M);return M;},rebuildChild:function A(H){return this.rebuildChildren([H])[0];}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StringBuffer");var G=mstrmojo.dom,T=mstrmojo.hash,P=mstrmojo.array;function X(){T.forEach(this.ifwMap,function(a){a.destroy();});this.ifwMap={};}function A(){var a=[],c=null,b=null;T.forEach(this.ifwMap,function(d){if(d.visible){a.push({psId:d.psId,psKey:d.psKey,autoCloseLocks:d.autoCloseLocks,lockInfoWinId:d.lockIW?d.lockIW.id:false,anchorPos:d.anchorPosition||G.position(d.anchor,true),anchorOrn:d.anchorOrientation});}});if(a.length>0){c=this.getSelectedLayoutWidget();b=c&&c.getScrollPos();}return{ifwRecords:a,docScrollRecord:b};}function O(e){var a=(e&&e.ifwRecords)||[],b=e&&e.docScrollRecord,c=this.getSelectedLayoutWidget(),d=this,f={};if(a.length>0){if(b&&c){c.scrollTo(b);}P.forEach(a,function(g){if(g.lockInfoWinId){f.lockInfoWinId=g.lockInfoWinId;}d.showInfoWindow(g.psId,g.psKey,f,null,g.anchorOrn,g.anchorPos,g.autoCloseLocks);});}}function K(){if(mstrmojo.DICPopup&&mstrmojo.DICPopup.cancel){mstrmojo.DICPopup.cancel();}}function S(){P.forEach(this.xtabStyleSheets,function(b){var a=b.parentNode;if(a){a.removeChild(b);}});}function Z(b,e){var c=this.getLayout(b),a=c.docGroupBy,d=this.controller;if(a){a.set("data",e.groupbys);c.gb=e;}if(d.getPageByTree){d.getPageByTree(true);}}mstrmojo._IsRwDocument=mstrmojo.provide("mstrmojo._IsRwDocument",{_mixinName:"mstrmojo._IsRwDocument",updateXtabStyles:function M(g,c){var o=this.xtabStyleSheets&&this.xtabStyleSheets[0],n=this.styleList||{},b=function(v,t){var u;for(u in t){var r=t[u].css||"";if(t[u].app){r=(v[u]||"")+r;}v[u]=r;}return v;},p=document;if(!n[g]){n[g]=b({},this.model.getSelectedXtabStyles(g));}b(n[g],c);if(!this.xtabStyleSheets){this.xtabStyleSheets=[];o=this.xtabStyleSheets[0]=p.getElementsByTagName("head")[0].appendChild(p.createElement("style"));}var q=new mstrmojo.StringBuffer(),e,f;for(e in n){for(f in n[e]){q.append(n[e][f]);}q.append("\n");}var d=q.toString();if(o&&d){o=o.styleSheet||o;if(G.isWK){var m=o.firstChild;if(m){m.nodeValue=d;}else{o.appendChild(p.createTextNode(d));}}else{if(G.isIE){o.cssText=d;var l,k,a,h;for(l=1;o.rules.length===4095&&p.styleSheets.length<31;l++){k=o.rules[4094];a=new RegExp(k.selectorText,"i");h=d.search(a);if(h===-1){break;}h=d.indexOf("}",h+1);d=d.slice(h+1);if(!this.xtabStyleSheets[l]){this.xtabStyleSheets[l]=p.getElementsByTagName("head")[0].appendChild(p.createElement("style"));}o=this.xtabStyleSheets[l].styleSheet;o.cssText=d;}}else{o.innerHTML=d;}}}this.styleList=n;},postBuildRendering:function W(){var a=document.getElementsByTagName("head")[0];P.forEach(this.xtabStyleSheets,function(b){a.appendChild(b);});return this._super();},buildChildren:function B(e){var k;try{var f=this.model;if(f){var g=this.buildSubs||{},q=f.id+"-partialUpdate",b=f.id+"-rebuildLayout",n=f.id+"-updateStyles",d=f.id+"-showInfoWin",c=this.id;var l=this,p=function(){P.forEach(l.getLayouts(),function(m){if(m.k!==f.currlaykey){m.defn.loaded=false;}});};if(g[q]===undefined){var o=function a(AA){var u=this.model,t=u&&u.getLayoutDataCache(u.getCurrentLayoutKey()),r=AA&&AA.ids;if(T.isEmpty(t)||!r){return ;}P.forEach(AA.tree.layouts,function(m){if(m.k===u.currlaykey){this.updateXtabStyles(m.k,m.xtabStyles);if(m.gbys){Z.call(this,m.k,m.gbys);}return false;}return true;},this);var w=T.forEach,AB=false,x={update:r.upd,refresh:r.tgts,adjustSectionSize:r.secs};w(r.ifws,function(AD,AC){var m=mstrmojo.all[AD+"_ifw"];if(m&&m.visible){this.updateInfoWindowPS(AD,AC);}},this);w(x,function(AC,m){w(AC,function(AF,AJ){var AE=mstrmojo.all[AJ],AI;if(AE&&AE[m]!==undefined){var AH=t[AJ],AD=(m==="update"?AH:null),AG=m;if(m==="update"){if(AE.updateForPU){AG="updateForPU";}else{AE.node=AH;}}else{if(m==="refresh"&&AE.refreshForPU){AG="refreshForPU";}}AI=AE[AG](AD);if(m==="adjustSectionSize"&&AI){AB=AB||(!!AI.heightReduced);}}},this);},this);var v=this.getSelectedLayoutWidget();if(AB){v.notifyScrollListeners();}var z=v.docLayout;if(z){z.resizeOrReposition();}if(AA&&AA.unloadCache){p();}};g[q]=f.attachEventListener("partialUpdate",c,o);}g[b]=g[b]||f.attachEventListener("rebuildLayout",c,function(m){var t=m&&m.restoreIW,r;if(t){r=A.call(this);this.model.aws=null;}this.onLayoutRebuilt(this.rebuildLayout(m.src.currlaykey,this.getLayouts()));if(m&&m.unloadCache){p();}if(t){O.call(this,r);}});g[n]=g[n]||f.attachEventListener("updateStyles",c,function(m){this.updateXtabStyles(m.key,m.updatedStyles);});g[d]=g[d]||f.attachEventListener("showInfoWin",c,function(m){this.showInfoWindow(m.psId,m.psKey,m.anchor,m.invalidate,m.anchorOrientation,m.anchorPosition);});this.updateXtabStyles(f.getCurrentLayoutKey());f.attachEventListener("refresh",this.id,function(){this.refresh();});}k=this._super(e);}catch(h){mstrmojo.err(h);}return k;},updateInfoWindowPS:mstrmojo.emptyFn,showInfoWindow:function J(b,u,l,n,q,r,AD){var d=this.model,g=d.getLayoutDataCache(d.getCurrentLayoutKey()),x=this.builder,a=g[b]&&g[b].defn,f=a&&a.iwpl,w=b+"_ifw",AC=mstrmojo.all[w],z=this.domNode,c=mstrmojo.DocInfoWindow.PLACEMENT.FIXED,AA=function(AE,AF,AG,AI,AH){if(f===c){if(AF){var AJ=G.delta(AF,z);AE.popPosition={left:(AJ&&AJ.x)?AI+AJ.x:AI,top:(AJ&&AJ.y)?AH+AJ.y:AH};}else{if(AG){AE.popPosition={left:(AG.scrollboxLeft)?AI-AG.scrollboxLeft:AI,top:(AG.scrollboxTop)?AH-AG.scrollboxTop:AH};}else{AE.popPosition={left:AI,top:AH};}}}};var p=this.getLayout(d.getCurrentLayoutKey());if(AC){if(n){AC.refresh();}AC.anchorOrientation=q;AC.anchorPosition=r;if(f===c&&AC._ifwpdn.style.display==="none"){AC._ifwpdn=document.getElementById(AC._ifwpdn.id);}AA(AC,AC._ifwpdn,p,AC._ifwfl,AC._ifwft);AC.open(this,{anchor:l,boundary:z});}else{var h={opener:this,anchor:l,anchorOrientation:q,boundary:z,parent:this,builder:x,model:this.model,psKey:u,psId:b,id:w,autoCloses:true,locksHover:true,closeOnClick:false,autoCloseLocks:AD,anchorPosition:r};if(f){f=parseInt(f,10);h.placement=f;if(f===c){var k=a.fmts,e=h._ifwfl=k&&k.left&&parseInt(k.left.replace("px",""),10),v=h._ifwft=k&&k.top&&parseInt(k.top.replace("px",""),10),m=g[b]&&g[b].p,t=m&&d.getUnitInstance(m.k,m.wid),o=h._ifwpdn=t&&t.domNode;AA(h,o,p,e,v);}}AC=x.newInfoWindow(h);this.renderInfoWindow(AC);var AB=this.ifwMap=(this.ifwMap||{});AB[b]=AC;}},renderInfoWindow:function L(a){a.render();},_lockInfoWinContainer:function I(c){var f=this.ifwMap,b=function(g,h){return function(){g.releaseLock(h);};},a;for(a in f){var d=f[a],e=c.xtab;if(d&&e&&G.contains(d.infoNode,e.domNode,true,document.body)){d.registerLock(e);c.onClose=b(d,e);break;}}},unrender:function V(a){X.call(this);this._super(a);S.call(this);},getLayouts:function Q(){return this._layouts;},getLayout:function U(a){a=a||this.model.getCurrentLayoutKey();var b=this.getLayouts();return b[P.find(b,"k",a)];},getSelectedLayoutWidget:mstrmojo.emptyFn,needLoadLayout:function R(a,b){return a.defn&&(b&&b.reload||a.defn.loaded===false||(this.model.zt&&(window.mstrMobileApp!==undefined)&&(a.defn.lastOrientation!==mstrMobileApp.getOrientation())));},getNewLayout:function F(b,g,a,l,c){var f=this,d=f.model,k=b.layoutKey,e=g[P.find(g,"k",k)];if(this.needLoadLayout(e,b)){var h=l.success;l.success=function(m){d.replaceLayout(k,m,false);d.currlaykey=k;if(a){f.selectLayout(e,false,null,c);}var n=f.rebuildLayout(k,g);if(f.controller.getPageByTree){f.controller.getPageByTree(true);}h(n);};this.loadDocLayout(b,l,c);}else{if(a){this.selectLayout(e,true,{success:function(m){T.copyProps(["bs"],m,d);}},c);}if(!e.hasRendered){e=this.rebuildLayout(k,g);if(f.controller.getPageByTree){f.controller.getPageByTree(true);}}l.success(e);}},selectLayout:function E(d,e,g,f){var a=this.model,b=d.k,c=(b!==a.currlaykey);a.currlaykey=b;if(this.controller){this.controller.updateZoom();}this.restoreLayoutState(d);if(e&&c){this.setCurrentDocLayout(b,g,f);}else{if(g&&g.complete){g.complete();}}return d;},rebuildLayout:function C(b,h){var e=this.model,d=P.find,f=h[d(h,"k",b)],a=e.getChildren(this.node,false);var g=a[d(a,"k",b)];if(window.mstrMobileApp!==undefined){g.defn.lastOrientation=mstrMobileApp.getOrientation();}var l=this.replaceLayout(f,g);this.updateXtabStyles(b,e.getSelectedXtabStyles(b));X.call(this);K();return l;},destroy:function Y(){X.call(this);if(this._super){this._super();}S.call(this);},replaceLayout:mstrmojo.emptyFn,restoreLayoutState:mstrmojo.emptyFn,onLayoutRebuilt:mstrmojo.emptyFn,unloadGbLayuts:function H(c){var h=this.getLayouts(),e=this.model.getCurrentLayoutKey(),g,f,l,b,d,a;g=this.getLayout();b=g.gb&&g.gb.groupbys;for(d=0;d<b.length;d++){l=b[d];if(l.k===c){a=l.unit.target.did;break;}}for(f=0;f<h.length;f++){g=h[f];if(g.k===e){continue;}b=g.gb&&g.gb.groupbys;if(b&&b.length){for(d=0;d<b.length;d++){l=b[d];if(l.unit.target.did===a){g.defn.loaded=false;break;}}}}},loadDocLayout:function N(a,c,b){this.model.getDataService().loadDocLayout(a,c,b);},setCurrentDocLayout:function D(a,c,b){this.model.getDataService().setCurrentDocLayout(a,c,b);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var C=function(R){var Q=(mstrApp.docModelData&&mstrApp.docModelData.mid)||"";return R.k+"-"+Q;},E={},L=mstrmojo.array;mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",{_mixinName:"mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",postBuildRendering:function G(){this._super();this.setup();if(!this.getExp()){if(E[C(this)]){this.highlight.apply(this,E[C(this)]);}else{this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}},getExp:function(){var Q=this.model.data,R=Q&&Q.sc&&Q.sc.exp;return R;},clearsBrushingOnHighlight:true,brushSub:null,clearSub:null,getAssociatedNodes:function B(){var Q=this.defn.an;return Q&&Q.length>0?Q:[];},hasAssociatedNodes:function K(){var Q=this.getAssociatedNodes();return Q.length>0;},getDocModelForEvent:function P(){return this.model&&this.model.docModel;},setup:function H(){var Q=this.getDocModelForEvent(),R=this.id;if(Q){[this.brushSub,this.clearSub].forEach(function(S){if(S){S.clear();}});this.brushSub=Q.attachEventListener("brushing",R,this.onBrushing);this.clearSub=Q.attachEventListener("clearBrush",R,this.onClearBrushing);}},handlesMultiSelection:function I(){return(this._super&&this._super())||this.getAssociatedNodes().length>0;},getHighlightKeys:function F(){var R=[],Q=this.getAssociatedNodes();Q.forEach(function(S){R.push(S.k);});return R;},onSelectionChange:function J(R){var S=false;if(this._super){S=this._super(R);}var Q=this.getDocModelForEvent();if(this.clearsBrushingOnHighlight){Q.raiseEvent({name:"clearBrush",from:this});}if(this.handlesMultiSelection()&&!S){Q.raiseEvent({name:"brushing",from:this,keys:this.getHighlightKeys()});return true;}return false;},onBrushing:function A(R){var Q=R.keys.slice();if(Q.indexOf(this.k)!==-1){if(this.highlight){var S=R.from;this.highlight(S.getSelectionType(),S.getSelectionHash());Q.push(S.k);this.getDocModelForEvent().raiseEvent({name:"clearBrush",from:this,excludeKeys:Q});}else{throw new Error(this.scriptClass+" must implement highlight method.");}}},onClearBrushing:function O(R){var Q=false;if(L.indexOf(R.excludeKeys,this.k)===-1){if(this._super){Q=this._super(R);}if(!Q){var S=this.getAssociatedNodes();if(L.find(S,"k",R.from.k)!==-1){this.clearSelections(true);}}}return true;},highlight:function D(){E[C(this)]=arguments;if(this._super){this._super.apply(this,arguments);}},clearSelections:function N(){delete E[C(this)];if(this._super){this._super.apply(this,arguments);}},updateAssociatedNodesOnMove:function M(){this.clearSelections(true);this.endSelections();delete this.defn.an;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array,E=mstrmojo.desc(2412,"Default"),H=mstrmojo.desc(3433,"Font"),B=mstrmojo.desc(3434,"Number"),C=mstrmojo.desc(3435,"Alignment"),A=mstrmojo.desc(2886,"Borders"),F=mstrmojo.desc(3905,"Background");var L=[{n:E,v:"pru"}];G.forEach(["Arial","Arial Black","Arial Narrow","Arial Unicode MS","Batang","Book Antiqua","Bookman Old Style","Comic Sans MS","Courier New","Garamond","Haettenschweiler","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Map Symbols","Marlett","Monotype Corsiva","Monotype Sorts","MS Gothic","MS Outlook","Microsoft Sans Serif","MT Extra","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings"],function(M){L.push({n:M,v:M});});function K(N,M,O){return(M&&M>=N)?K(N,M-O,O).concat(M):[];}var J=K(2,12,1);J=J.concat(K(14,24,2));J=J.concat(K(36,48,12));J=J.concat(K(72,72,1));var D=[{n:E,v:"pru"}];G.forEach(J,function(M){D.push({n:String(M),v:String(M)});});mstrmojo._FormatDefinition={Formats:[{n:H},{n:B},{n:C},{n:mstrmojo.desc(3436,"Color and Lines")}],FormatTarget:[{n:mstrmojo.desc(7942,"Element Header"),v:1,p:"header_format"},{n:mstrmojo.desc(7943,"Element Value"),v:2,p:"grid_format"},{n:mstrmojo.desc(7944,"Individual Items Header"),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945,"Individual Items Value"),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:B},{n:C},{n:H},{n:A},{n:F}],MetricHeaderFormats:[{n:B},{n:C},{n:H},{n:A},{n:F},{n:mstrmojo.desc(12139,"Chart")}],NumberFormatCategory:{Automatic:-3,Default:-2,General:9,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7},DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0"}},Families:L,Sizes:D,SizesInVI:D.slice(7,19),Styles:[{n:E,v:"pru"},{n:mstrmojo.desc(3440,"Regular"),v:"0,0"},{n:mstrmojo.desc(2718,"Bold"),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719,"Italic"),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441,"Bold Italic"),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:E,v:-2},{n:mstrmojo.desc(2378,"General"),v:9},{n:mstrmojo.desc(2050,"Fixed"),v:0},{n:mstrmojo.desc(2051,"Currency"),v:1},{n:mstrmojo.desc(2052,"Date"),v:2},{n:mstrmojo.desc(2170,"Time"),v:3},{n:mstrmojo.desc(2053,"Percentage"),v:4},{n:mstrmojo.desc(2054,"Fraction"),v:5},{n:mstrmojo.desc(2055,"Scientific"),v:6},{n:mstrmojo.desc(2056,"Custom"),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:"-1,234.12",v:1,f:"#,##0.00"},{n:"-1,234.12",r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:"1,234.12",r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:"(1,234.12)",v:3,f:"#,##0.00;(#,##0.00)"},{n:"(1,234.12)",r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:"-$1,234.12",v:1,f:'"$"#,##0.00'},{n:"-$1,234.12",r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:"$1,234.12",r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:"($1,234.12)",v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:"($1,234.12)",r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194,"Left"),v:0},{n:mstrmojo.desc(2195,"Right"),v:1},{n:mstrmojo.desc(2183,"Left with space"),v:2},{n:mstrmojo.desc(2182,"Right with space"),v:3}],Date:[{n:mstrmojo.desc(2231,"4/7"),v:"m/d"},{n:mstrmojo.desc(2232,"04/07"),v:"mm/dd"},{n:mstrmojo.desc(2233,"4/7/98"),v:"m/d/yy"},{n:mstrmojo.desc(2234,"04/07/98"),v:"mm/dd/yy"},{n:mstrmojo.desc(2235,"04/07/1998"),v:"mm/dd/yyyy"},{n:mstrmojo.desc(2236,"7-Apr"),v:"d-mmm"},{n:mstrmojo.desc(2237,"7-Apr-98"),v:"d-mmm-yy"},{n:mstrmojo.desc(2238,"Apr-98"),v:"mmm-yy"},{n:mstrmojo.desc(2239,"Apr '98"),v:"mmm 'yy"},{n:mstrmojo.desc(2240,"April 1998"),v:"mmmm yyyy"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243,"April 7, 1998"),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244,"15:41"),v:"h:mm"},{n:mstrmojo.desc(2245,"3:41 PM"),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246,"15:41:46"),v:"h:mm:ss"},{n:mstrmojo.desc(2247,"3:41:46 PM"),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250,"04/07/98 15:41"),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248,"04/07/98 3:41 PM"),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:E,v:"pru"},{n:mstrmojo.desc(4601,"Horizontal"),v:0},{n:mstrmojo.desc(5156,"-90 Degree"),v:-90}],Horizontal:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2378,"General"),v:1},{n:mstrmojo.desc(2194,"Left"),v:2},{n:mstrmojo.desc(2193,"Center"),v:3},{n:mstrmojo.desc(2195,"Right"),v:4},{n:mstrmojo.desc(2068,"Justify"),v:6}],Vertical:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2256,"Top"),v:1},{n:mstrmojo.desc(2067,"Center"),v:2},{n:mstrmojo.desc(2257,"Bottom"),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:E,v:"pru"},{n:mstrmojo.desc(2258,"None"),v:0},{n:mstrmojo.desc(2259,"Dashed"),v:3},{n:mstrmojo.desc(2260,"Dotted"),v:4},{n:mstrmojo.desc(2261,"Hair"),v:7},{n:mstrmojo.desc(2262,"Thin"),v:1},{n:mstrmojo.desc(2264,"Thick"),v:5},{n:mstrmojo.desc(2265,"Double"),v:6}],extractModel:function(O,Q,N){var S=N||this.DefaultFormat,R;for(R in O){var M=O[R];if(!M.attachEventListener){if(!mstrmojo.hash.isEmpty(M)){Q[R]=M;}}else{var P;for(P in M){if(S[R]&&S[R][P]){if(!Q[R]){Q[R]={};}Q[R][P]=M[P];}}}}},getAvailableFonts:function I(){var M={success:function(O){if(O.name==="fontPicker"){var N=[{n:E,v:"pru"}];mstrmojo.array.forEach(O.shortcuts,function(P){N.push({n:P.attributes[1].value,v:P.attributes[1].value});});mstrmojo._FormatDefinition.Families=N;}}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,M,{taskId:"getSystemPickerJson",name:"fontPicker"},false,null,true);},getStandardFormat:function(N,M){var P=mstrmojo.hash.clone(M||this.DefaultFormat),O;N=N||{};for(O in P){N[O]=N[O]||{};}for(O in N){if(!N[O].attachEventListener){N[O]=mstrmojo.hash.make(N[O],mstrmojo.Obj);}}return N;},saveFormatModel:function(Q,W,N,X){var V=X||this.DefaultFormat,S,M;for(S=0;S<N.length;S++){var R=N[S],P=W[R]||null,U=Q[R];if(U===undefined){delete W[R];continue;}for(M in V){var T=V[M],O;if((!P&&!U)||(P&&!P[M]&&!U[M])){continue;}for(O in T){if(U[M]===undefined||U[M]===""||U[M][O]==="pru"||U[M][O]===undefined){if(P&&P[M]&&(P[M][O]!==undefined&&P[M][O]!==null&&P[M][O]!=="pru")){P[M][O]="pru";}}else{P=P||{};P[M]=P[M]||{};P[M][O]=U[M][O];}}}if(P){W[R]=P;}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array");var H=mstrmojo.array,G=mstrmojo.dom;mstrmojo._IsDocXtab={_mixinName:"mstrmojo._IsDocXtab",isDocXtab:true,formatHandlers:{domNode:["RW","T","font"],msgNode:["height","background-color"],viewport:["D","background-color","B","fx"]},preBuildRendering:function B(){var I=this.getFormats(),L="",K=function K(M){if(I[M]){var N=this[M]||I[M];this[M]=N;if(this.isFullScreenWidget){I[M]=N;}this[M+"Limit"]=parseInt(N,10);}};K.call(this,"height");K.call(this,"width");var J=function(P,O){var M=I[P];if(M&&M.charAt(M.length-1)!=="%"){var N=parseInt(M,10);if(!isNaN(N)){if(O){N-=O;}L+=P+":"+N+"px;";}}return null;};J("height",0);J("width",0);this.scrollboxNodeCssText=L;return this._super();},postBuildRendering:function D(){var J=this._super();var I=this.gridData;if((I.afw||I.afc)&&this.hasCustomScrollbar&&!this.node.data.eg&&this.scrollboxNode.firstChild){this.scrollboxNode.firstChild.style.width=this.getFormats().width;}return J;},resize:function A(){this.clearCache();var K=this.getFormats(),J=parseInt(K.height,10),I=parseInt(K.width,10);if(I>0&&J>0){if(!this.visible&&this.forcedHidden){this.set("visible",true);this.forcedHidden=false;}H.forEach([this.scrollboxNode,this.viewport],function(M){var L=M.style;L.height=J+"px";L.width=I+"px";});if(this.scrollboxNode){this.scrollboxHeightFixed=J&&(J!=="auto");if(this.scrollboxHeightFixed){this.scrollboxHeight=parseInt(J,10);this.scrollboxBottom=this.scrollboxTop+J;}if(this.lockHeadersCase){this.heightLimit=J;this.resizeScrollBox(G.isIE);}}this.delegateGridAction(function(L){if(L&&L.onscroll){L.onscroll();}},"scrollOnResize");if(!(this.gridData&&this.gridData.eg)){this.onGridWidthChanged();}if(this.lockHeadersCase){this._refreshClonedNodes();}}else{if(this.visible){this.set("visible",false);this.forcedHidden=true;}}},renderPortalState:function E(){this.clearCache();this.unrender();this.render();},unrender:function F(I){this.clearCache();if(this._super){this._super(I);}},defaultAction:function C(N,I){if(this._super(N,I)){var M=this.model.sti,L=M&&M.titleId,K=M&&M.deselectCurrent;this._currentSelectedTD=K?undefined:N;if(L){var J=this.zone;this.delegateGridAction(function(P){var O=P.domNode,Q=O&&O.firstChild;if(!J&&Q&&(N.offsetParent===Q||N.offsetParent===O)){J=P;}},"defaultClickAction");if(J){J.clearHilites(L);if(!K){J.setHilites(L,N);}J.hiliteKey=L;this.model.sti=null;}}return true;}return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var C=mstrmojo.hash,E=mstrmojo.array;function D(F){return function(G){F[G]=true;};}mstrmojo.rw.model.UpdateKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.UpdateKeysConfig",init:function B(){this.nodes=[];this.selectors={};this.objects={};}});mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig=function A(J){var F={},K={},G={},I={};E.forEach(J,function H(M){var L=M.partialUpdate;if(L){E.forEach(L.nodes,D(K));E.forEach(L.selectors,D(G));E.forEach(L.objects,function(N){if(!I[N.id]||N.flag>I[N.id].flag){I[N.id]=N;}});delete M.partialUpdate;}E.forEach(M.actions,H);});if(!C.isEmpty(K)){F.nodes=C.keyarray(K);}if(!C.isEmpty(G)){F.selectors=C.keyarray(G);}if(!C.isEmpty(I)){F.objects=C.valarray(I);}return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",H="";var N=/\+/g,I,F;for(I=0,F=M.length;I<F;I++){var E=M[I].split("=");L=E[0];H=E[1];if(H){H=decodeURIComponent(H.replace(N," "));}var G=document.createElement("INPUT");G.type="HIDDEN";G.name=L;G.value=H;K.appendChild(G);}return false;}mstrmojo.form={createDynamicForm:function A(E){var F=document.createElement("FORM"),G=E.indexOf("?")>0;F.name="dynamic_form";F.method="POST";F.action=(G?E.substring(0,E.indexOf("?")):E);if(G){B(F,E);}document.body.appendChild(F);return F;},sendLinkAsForm:function(E,G){var F=this.createDynamicForm(E);this.send({},F.action,F.method,G,null,null,F);},sendLink:function(E,F){if(!mstrmojo.isUrlExternal(E)){mstrmojo.form.sendLinkAsForm(E,F);}else{if(mstrmojo.array.indexOf(["_new","_blank"],F)>-1){window.open(E);}else{window.location.href=E;}}},send:function D(K,L,E,N,I,G,F){var P=((I&&I.hWin)||window).document,M=F||P.createElement("form"),J=mstrApp;K=mstrmojo.addCSRFTokenToTaskParams(K);M.method=E||"POST";if(N){M.target=N;}M.action=L||J.name;G=(G!==undefined)?G:!(M.action&&M.action.indexOf("aspx")>0)&&mstrConfig.addTimeStampToPreventCaching;if(!!J.addJSessionIdToURL&&J.httpSessionId){M.action+=";jsessionid="+J.httpSessionId;}if(G){M.action+=";uxts"+mstrmojo.now();}M.appendChild(C(P,"xts",String(mstrmojo.now())));var Q;for(Q in J.persistTaskParams){K[Q]=J.persistTaskParams[Q];}if(J.servletState&&J.name){K[J.name]=J.servletState;}if(K){var H;for(H in K){if(K[H].constructor===Array){mstrmojo.array.forEach(K[H],function(R){M.appendChild(C(P,H,R));});}else{M.appendChild(C(P,H,K[H]));}}}P.body.appendChild(M);try{M.submit();}catch(O){if(N&&O.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}P.body.removeChild(M);},addURLAsHiddenInputsToForm:B};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var C=mstrmojo.array;mstrmojo.vi.ui.rw._IsPanelStack=mstrmojo.provide("mstrmojo.vi.ui.rw._IsPanelStack",{_mixinName:"mstrmojo.vi.ui.rw._IsPanelStack",getFormats:function A(){return{};},selectPanel:function B(F,G,E){var H=this.model.getDataService().newUpdateWithoutCmd(),D=this.controller.cmdMgr;this.selectPanelDeferred(H,F,G,E);this.model.getDataService().addSuppressData(H.extras);C.forEach(this.children,function(I){if(I.visible&&I.hasRendered&&I.children&&I.children.length===0){I.refresh();}});if(!E&&H.actions&&H.actions.length>0){D.execute({execute:function(){H.cmd=this;H.submit();},urInfo:{extras:{style:{params:{treesToRender:3}},params:{suppressData:true}}}});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._BindTargetChildren=mstrmojo.provide("mstrmojo._BindTargetChildren",{target:null,targetProps:null,addTabButtons:null,removeTabButtons:null,clearButtons:null,ontargetChange:function D(L){var M=L&&L.valueWas;if(M){var J=this._targetSubs;if(J){M.detachEventListener(J.add);M.detachEventListener(J.rem);M.detachEventListener(J.sel);}this.clearButtons();}var N=this.target;if(N){var I=this.targetProps,H=(I&&I.children)||"children",F=N[H];this.addTabButtons(F,0);this._onTargetSelChg();if(N.attachEventListener){var G=this.id,K="attachEventListener";this._targetSubs={add:N[K]("addChild",G,"_onTargetAddChild"),rem:N[K]("removeChild",G,"_onTargetRemoveChild"),sel:N[K]("selectedChange",G,"_onTargetSelChg")};}}this._ontargetChange();},_ontargetChange:mstrmojo.emptyFn,_onTargetAddChild:function A(F){var G=F&&F.value;if(G&&G.length){this.addTabButtons(G,F.index);}this._postTargetAddChild();},_postTargetAddChild:mstrmojo.emptyFn,_onTargetRemoveChild:function B(G){var F=G&&G.value,H;for(H=((F&&F.length)||0)-1;H>-1;H--){this.removeTabButton(F[H]);}this._postTargetRemoveChild();},_postTargetRemoveChild:mstrmojo.emptyFn,_onTargetSelChg:function C(L){var G=this.targetProps||{},F=this[G.names||"children"],J=function(O,P){if(O.set){O.set("selected",P);}else{O.selected=P;}};if(L){var H=L.valueWas,K=H?E.find(F,"target",H):-1;if(K>-1){J(F[K],false);}}var M=this.target,N=M&&M.selected,I=N?E.find(F,"target",N):-1;if(I>-1){J(F[I],true);}this._postTargetSelChg();},_postTargetSelChg:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,B=mstrmojo.hash;mstrmojo.models.datasets.DataInterface=mstrmojo.provide("mstrmojo.models.datasets.DataInterface",{getFormsByAttrId:function A(F,E){var D=[];E=E||[];B.forEach(E,function(G){C.forEach(G.att||[],function(H){if(H.did===F){D=D.concat(H.fs||[]);return false;}});});D=C.filter(D,function(G){return !!G.obf;});return C.distinct(D,"fid");}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var C=mstrmojo.array;mstrmojo.vi.ui.rw._HasBufferSlice=mstrmojo.provide("mstrmojo.vi.ui.rw._HasBufferSlice",{_mixinName:"mstrmojo.vi.ui.rw._HasBufferSlice",_bufferedSlices:null,bufferSlice:function B(E){var D=this._bufferedSlices=this._bufferedSlices||{};if(E.ctlKey){D[E.ctlKey]=E;this.set("applyEnabled",true);}},applyBufferedSlices:function A(F,J,E){var H=this._bufferedSlices;if(!H){return ;}var I,G;for(G in H){I=H[G]&&H[G].tks;if(I){break;}}var D={tks:I,events:H};if(F){if(E){C.forEach(this.model.buildSliceUrInfo(D).extraPuKeys,function(K){E.push(K);});}this.model.sliceDeferred(J,D);}else{this.model.slice(D);}this.clearBuffSlices();},clearBuffSlices:function(){this._bufferedSlices=null;this.set("applyEnabled",false);},clearSingleBuffSlice:function(D){var E=this._bufferedSlices;if(E&&E[D]){delete E[D];}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var K=mstrmojo.array,D=mstrmojo.hash;function E(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(K.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function J(R){var Q=[],S=R.selectedIndices,P;for(P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function H(V,U){var S=[],Q=V.selectedIndices,X=K.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return J(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}var T=U.length,R;for(R=0;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex===W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V,Q;for(Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U===V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function G(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function F(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=J(this),S=E(this,[P]);if(Q!==true){G(this,S,R);}}},toggleSelect:function O(P,Q){var S,R;if(this.selectedIndices[P]){R=H(this,[P]);}else{S=E(this,[P]);}if(Q!==true){G(this,S,R);}},rangeSelect:function N(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=J(this);if(P!==true){G(this,null,Q);}},select:function L(R,P){var Q=A(this,K.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){G(this,Q.add,Q.rmv);}},addSelect:function B(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=E(this,R);if(P!==true){G(this,Q,null);}return Q;},removeSelect:function M(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=H(this,R);if(P!==true){G(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){G(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof T==="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=K.find(U,V,T[V]);}else{if(T!=null){Q=K.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function C(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!==null&&P!==undefined){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return D.keyarray(this.selectedIndices,true).sort(K.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return K.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,d){if(!Q||!Q.length){return ;}var S=this.items||[],t=this.itemIdField!=null?K.findMulti(S,this.itemIdField,Q):K.indexOfMulti(S,Q),V=Q.length,T=V-t.count,q=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(q&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],f=t.map;if(T&&q){var p=0,e;for(e=0;e<V;e++){if(f[e]==null){R.push(Q[e]);U.push(b+p++);}}this.add(R,b);}var W=[],h;for(h in f){var o=f[h];if(o>=b){o+=X;}W.push(o);}var r=W.concat(U),Y=this.addSelect(r,!d);if(!d){var Z=K.hash(Y),g=this.selectedIndices,a=[],l;for(l in g){if(!Z[l]){a.push(parseInt(l,10));}}var P=this.removeSelect(a,true);G(this,Y,P);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array;function A(E){var D=(E&&E.gts&&E.gts.col)||[],G=(E&&E.gts&&E.gts.row)||[];var F=C.filter(D.concat(G),function(H){return H.otp===-1;})[0];return{tpltProp:E.prop,mxProp:C.map((F&&F.es)||[],function(H){var I={};I[H.oid]=mstrmojo.hash.copy(H.prop,{n:H.n,t:H.otp});return I;})};}mstrmojo._IsDocumentTemplate=mstrmojo.provide("mstrmojo._IsDocumentTemplate",{_mixinName:"mstrmojo._IsDocumentTemplate",gridInfo:null,tmsProps:null,update:function B(D){if(D&&D.data){this.gridInfo=D.data.gsi;this.tmsProps=A(D.data);}if(this._super){return this._super(D);}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumPanelTypes","mstrmojo.hash");var F=mstrmojo.hash;function B(J,H){var I=false,G=false;F.keyarray(H).every(function(K){(H[K].att||[]).every(function(L){if(L.did===J){I=true;if(L.de){G=true;}}return !I;});return !I;});return G;}mstrmojo.vi.ui.rw.selectors._IsFilterSelector=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsFilterSelector",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsFilterSelector",model:null,cachedFps:null,hasDE:false,init:function E(H){this._super(H);var G=this.node.defn;this.hasDE=(G.srct===12&&B(G.srcid,this.model.datasets));},isInFilterPanel:function A(){return true;},getFilterPanel:function C(){var G=this.cachedFps;if(!G){this.cachedFps=G=mstrmojo.findAncestor(this.parent,"scriptClass","mstrmojo.vi.ui.rw.FilterPanelStack");}return G;},slice:function D(H){var G=this.getFilterPanel();if(G){if(H.forceBuffer){G.bufferSlice(H);return ;}if(H.forceApply){this.model.slice(H);return ;}if(G.autoApply){this.model.slice(H);}else{G.bufferSlice(H);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources");function D(H){this.cleanUpAfterTarget(H);var G=H.tgtData;if(G){delete H.tgtData;}var I=this.getContextDragData(H);if(I&&I.setAvatarClass){I.setAvatarClass("");}}mstrmojo.vi.ui._IsDropTarget=mstrmojo.provide("mstrmojo.vi.ui._IsDropTarget",{_mixinName:"mstrmojo.vi.ui._IsDropTarget",dropZone:true,getDropAvatarIcon:function B(G){return"add";},getContextDragData:function F(G){return G.getCtxtDragData();},cleanUpAfterTarget:mstrmojo.emptyFn,ondragenter:function A(G){var H=this.getContextDragData(G);if(H&&H.setAvatarClass){H.setAvatarClass(this.getDropAvatarIcon(G));}if(this._super){this._super(G);}},ondragleave:function E(G){D.call(this,G);if(this._super){this._super(G);}},ondrop:function C(G){D.call(this,G);if(this._super){this._super(G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumDSSDisplayMode");mstrmojo.requiresDescs(981);var B=mstrmojo.vi.viz;mstrmojo.vi.viz.KnownVisualizations={CUSTOM:-2,UNKNOWN:-1,GRID:0,ESRIMAP:2,GRAPHMATRIX:3,IMAGELAYOUT:4,HEATMAP:16,GOOGLEMAP:17,NETWORK:18,getDefinition:function A(E){var F=B.KnownVisualizations,H={Grid:{id:F.GRID,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,title:mstrmojo.desc(981,"Grid")},visAjaxDatePicker:{id:1},ESRIMapVisualizationStyle:{id:F.ESRIMAP,mobileVIStyles:{IPhoneVisualization:"ViEsriMapAdapter",IPadVisualization:"ViEsriMapAdapter"}},GraphMatrixVisualizationStyle:{id:F.GRAPHMATRIX,displayMode:mstrmojo.EnumDSSDisplayMode.GRID,widgetEnable:"-1",mobileVIStyles:{IPadVisualization:"IPadGraphMatrix2Style"}},ImageLayoutVisualizationStyle:{id:F.IMAGELAYOUT,mobileVIStyles:{IPadVisualization:"IPhoneImageMapStyle",ATabletVisualization:"AndroidImageMapStyle"}},SurveyVisualizationStyle:{id:8,mobileVIStyles:{IPadVisualization:"SurveyVisualizationStyle"}},VIHeatMapVisualizationStyle:{id:F.HEATMAP,mobileVIStyles:{IPadVisualization:"IPadHeatMapStyle",ATabletVisualization:"HeatMapVisualizationStyle"}},GoogleMapVisualizationStyle:{id:F.GOOGLEMAP,mobileVIStyles:{IPhoneVisualization:"IPhoneMapStyle",IPadVisualization:"IPadMapStyle"}},NetworkVisualizationStyle:{id:F.NETWORK,mobileVIStyles:{IPadVisualization:"IPhoneNetVizStyle"}}};var G=H[E];if(!G){var C=mstrConfig.pluginsVisList,D=C&&C[E];G={id:D?F.CUSTOM:F.UNKNOWN};G.mobileVIStyles=(D&&D.mobileVIStyles)||{};}return G;}};}());(function(){mstrmojo.requiresCls("mstrmojo.cookies");mstrmojo.requiresDescs(14356,11866);mstrmojo.mstr._RecentObjectsHelper=mstrmojo.provide("mstrmojo.mstr._RecentObjectsHelper",{_mixinName:"mstrmojo.mstr._RecentObjectsHelper",handleRecentObjects:function B(){var F=this.recentObjects();var D=Math.min(F.length,10);var C=-1;for(i=0;i<D;i++){if(F[i].lastRecovered!==undefined&&F[i].lastRecovered===true){F[i].iconClass="mstrIcon-lv mstrIcon-recover";F[i].recoveryName=mstrmojo.desc(11866,"Recover #").replace("#",F[i].recoveryName);F[i].itemClass="mstr-recent-item";C=i;}else{F[i].itemClass="mstr-recent-item";F[i].iconClass="mstrIcon-lv "+F[i].iconClass;}}if(C!=-1){F[C].cssText="border-bottom: 1px solid #D6D6D6;";}var E={};if(D==0){E.recoveryURL="";E.recoveryName=mstrmojo.desc(14356,"No recent items");E.iconClass="";E.lastRecovered=false;F.push(E);}return F;},recentObjects:function A(){try{var J=window.localStorage,P=window.sessionStorage;if(!J||!window.JSON){return ;}var E=[];var N=function(U){var V="";switch(U){case 3:V="reportID=";break;case 55:V="documentID=";break;default:V="messageID=";break;}return V;};var H=function(Y){var X=Y.ty;var U="";switch(X){case 55:var W=Y.vm;switch(W){case 8192:case 2048:U="mstrIcon-lv-rw avm";break;case 1:default:U="mstrIcon-lv-rw";break;}break;case 3:var V=Y.viewMode;switch(V){case 1:U="mstrIcon-lv-g";break;case 2:U="mstrIcon-lv-gp";break;case 3:U="mstrIcon-lv-gpgs";break;default:U="";break;}break;}return U;};var T=JSON.parse(J.getItem("recentObjects"+mstrConfig.lastMsgKey));try{var S=mstrConfig.lastMsgKey,D="lastMsgID"+S,G=(JSON.parse(decodeURIComponent(mstrmojo.cookies.getCookieSetting("lastMsgID")||"{}")))[S],I=function(U){return U&&(U.length===32)&&/^[A-Z0-9]{32}$/.test(U);};}catch(R){}if(I(G)){var K={};var O="lastMsgRecoveryInfo"+S,C=J.getItem(O);if(C){var C=JSON.parse(C);K.recoveryInfo=C;K.recoveryURL=mstrmojo.addCSRFTokenToURL("?"+C.url.replace(/messageID.*/,"messageID="+G)),K.recoveryName=C.n;K.recoveryType=C.ty;K.did=C.did;K.iconClass=H(C);K.lastRecovered=true;E.push(K);}}for(var Q in T){var L=T[Q];if(L===""){continue;}var K={};var C=JSON.parse(L);K.recoveryInfo=C;K.recoveryURL=mstrmojo.addCSRFTokenToURL("?"+C.url.replace(/messageID.*/,N(C.ty)+C.did));K.recoveryName=C.n;K.recoveryType=C.ty;K.did=C.did;K.iconClass=H(C);K.lastRecovered=false;var M=mstrmojo.array.find(E,"did",K.did);if(M===-1){E.push(K);}else{E[M].recoveryInfo.imgData=K.recoveryInfo.imgData;}}return E;}catch(F){mstrmojo.errors.log(F);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var D=mstrmojo.dom,L=mstrmojo.hash;var O=100;var F=D.supportsTouches?0.5:1;var G=1;var R=100;var P={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var M=L.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[D.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[D.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[D.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[D.CSS3_TRANSITION]=this.decelerating?(D.CSS3_PREFIX+"transform 0.2s linear"):"";}},L.copy(P));var H=L.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},L.copy(P));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function N(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=L.copy(D.isSafari?M:H,L.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}D.attachEvent(U,D.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){D.detachEvent(T,D.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function J(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}D.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=D.getMousePosition(D.firstTouch(T,V),T);this.dragging=false;D.attachEvent(window,D.TOUCHMOVE,this._tmCallback);D.attachEvent(window,D.TOUCHEND,this._teCallback);},touchesMoved:function E(b,d){var Z=D.getMousePosition(D.firstTouch(b,d),b);D.preventDefault(b,d);if(!this.dragging){var T=5,h=Math.abs;if((this.scrollsHoriz&&h(Z.x-this.pos.x)>T)||(this.scrollsVert&&h(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},f={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=f;this.maxPos={x:Math.max(f.x-Y.x,0),y:Math.max(f.y-Y.y,0)};this.showScroll();}}if(this.dragging){D.stopPropogation(b,d);var c=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(c.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(c.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),g=this.lastDragTime;this.nextLastDragTime=g;this.lastDragTime=U;if((U-g)>R){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function I(T,U){D.preventDefault(T,U);D.detachEvent(window,D.TOUCHMOVE,this._tmCallback);D.detachEvent(window,D.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;D.stopPropogation(T,U);if((new Date())-this.lastDragTime<=R){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=D.getMousePosition(D.firstChangedTouch(Y,Z),Y),c=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-c.x,y:W.y-c.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),d=T?(new Date())-T:0,V={x:d?Number(b.x*O*F/d).toFixed(2):0,y:d?Number(b.y*O*F/d).toFixed(2):0};var a=this,U=function(e){return(a.scrollsHoriz&&Math.abs(e.x)>=G)||(a.scrollsVert&&Math.abs(e.y)>=G);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,O);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=b?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=b?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function K(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function Q(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom,E=100;function I(K,J){return function(L){mstrmojo.all[K][(J?"move":"show")+"Tooltip"](L,self);};}function A(){var K=this.tooltipNode||this.domNode,M=this.id,J,L="_ontooltip"+(this.isDynamicTooltip?"move":"over");if(!this._ontooltipout){this._ontooltipout=function(N){mstrmojo.all[M].hideTooltip(N,self);};}if(!this[L]){this[L]=I(M,this.isDynamicTooltip);}K=[].concat(K);for(J=0;J<K.length;J++){K[J].removeAttribute("title");B.attachEvent(K[J],(this.isDynamicTooltip?"mousemove":"mouseover"),this[L]);B.attachEvent(K[J],"mouseout",this._ontooltipout);}}mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,isDynamicTooltip:false,tooltipNode:null,tooltipOpenDelay:700,hasOpenTooltip:false,postBuildRendering:function(){var J=this._super();if(this.useRichTooltip){A.call(this);}return J;},onuseRichTooltipChange:function H(){if(this.hasRendered){var K=this.tooltipNode||this.domNode,J;if(this.useRichTooltip){A.call(this);}else{if(this._ontooltipout){if(K&&K.constructor!==Array){K=[K];}for(J=0;J<K.length;J++){B.detachEvent(K[J],this.isDynamicTooltip?"mousemove":"mouseover",this["_ontooltip"+(this.isDynamicTooltip?"move":"over")]);B.detachEvent(K[J],"mouseout",this._ontooltipout);}}this.hideTooltip();}}},showTooltip:function G(M,L){var K=this;if(!K.hasOpenTooltip&&(!mstrApp.isInteractive||mstrApp.isInteractive&&mstrApp.isInteractive())){mstrmojo.requiresCls("mstrmojo.tooltip");if(this.updateTooltipConfig){this.updateTooltipConfig(M);}window.clearTimeout(this._tooltipTimeOut);if(mstrmojo.dom.isIE){var N={};for(var J in M){N[J]=M[J];}M=N;}var O=this.richTooltip?this.richTooltip.areaId:undefined;this._tooltipTimeOut=window.setTimeout(function(){if(K._closeTooltipTimeout){window.clearTimeout(K._closeTooltipTimeout);delete K._closeTooltipTimeout;}mstrmojo.tooltip.open(K,M,L);K.tooltip.onmouseover=function(){if(K.richTooltip&&K.richTooltip.enableHover){window.clearTimeout(K._closeTooltipTimeout);window.clearTimeout(K._deactivationTimeout);if(K.tooltip){K.tooltip.onmouseout=function(P){if(!B.contains(this.domNode,P.e.toElement||P.e.relatedTarget)){K.hideTooltip();}};}}};K.hasOpenTooltip=true;K._hasActiveArea=true;K._tooltipAreaId=O;window.clearTimeout(K._deactivationTimeout);delete K._deactivationTimeout;},(this._hasActiveArea&&O&&O===this._tooltipAreaId)?0:this.tooltipOpenDelay);}},moveTooltip:function C(J,L){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;mstrmojo.tooltip.close();}var N=this,K=J,M=L;this._tooltipTimeOut=setTimeout(function(){mstrmojo.tooltip.open(N,K,M);},this.tooltipOpenDelay);},hideTooltip:function F(){var J=this;window.clearTimeout(this._tooltipTimeOut);if(this._closeTooltipTimeout){window.clearTimeout(this._closeTooltipTimeout);}if(this._hasActiveArea&&!this._deactivationTimeout){this._deactivationTimeout=window.setTimeout(function(){delete J._deactivationTimeout;delete J._hasActiveArea;delete J._tooltipAreaId;},100);}mstrmojo.requiresCls("mstrmojo.tooltip");if(J.richTooltip&&J.richTooltip.enableHover){this._closeTooltipTimeout=window.setTimeout(function(){mstrmojo.tooltip.close();delete J._closeTooltipTimeout;},E);}else{mstrmojo.tooltip.close();}this.hasOpenTooltip=false;},unrender:function D(M){var N=this.tooltipNode||this.domNode,L;if(N&&N.constructor!==Array){N=[N];}if(N){var O=this._ontooltipover,K=this._ontooltipout,J=this._ontooltipmove;for(L=0;L<N.length;L++){if(O){B.detachEvent(N[L],"mouseover",O);}if(K){B.detachEvent(N[L],"mouseout",K);}if(J){B.detachEvent(N[L],"mousemove",J);}}}this._super(M);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function E(G){if(G){return{w:G.innerWidth,h:G.innerHeight};}var F=C.windowDim(),H=(C.isFF||C.isWK)?0:2;return{w:Math.max(F.w,0)+"px",h:Math.max(F.h-H,0)+"px"};},preBuildRendering:function A(){var H=this._super(),G=this.getBrowserDimensions();if(!this.browserResized||this.browserResized(G)!==true){this.height=G.h;this.width=G.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return H;},destroy:function B(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function D(F){var I=F.currentTarget,H=this.getBrowserDimensions(),G={w:(I?I.innerWidth+"px":H.w),h:(I?I.innerHeight+"px":H.h)};if((G.h===this.height&&G.w===this.width)||parseInt(G.h,10)<=20||parseInt(G.w,10)<=20){return ;}if(!this.browserResized||this.browserResized(G,true)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=false,P=mstrmojo.dom,T=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(U){return false;},queryEnabled:function(U){return true;},queryVisible:function(U){return true;},executeCommand:function O(U){},item2textCss:function E(U){return U.cssClass||U.cmdId||("cmd"+U[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var a=this._subMenu,Y=this.getMenuPosition();if(!a){var c=(this.menuZIndex||this.zIndex||10)+1,W={left:Y.x+"px",top:Y.y+"px",zIndex:c,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};a=new mstrmojo.ContextMenu(W);a.render();this._subMenu=a;}else{a.set("left",Y.x+"px");a.set("top",Y.y+"px");}if(this.dynamicUpdate){var V=a.ctxtBuilder.itemWidgets,X=V&&V.length,U,Z,b=this.getContextMenuSource();for(U=0;U<X;U++){Z=V[U];if(b.queryVisible){Z.set("visible",b.queryVisible(Z.data));}if(b.queryChecked){Z.set("checked",b.queryChecked(Z.data));}if(b.queryEnabled){Z.set("enabled",b.queryEnabled(Z.data));}}}a.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var U=this._subMenu;if(U&&U.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function N(){var U=this._subMenu,X=this._subMenu.domNode,W=X.offsetHeight,V=X.offsetWidth,a=P.windowDim(),Z=P.position(X,false),Y=P.position(X,true);if((Z.x+V+T)>a.w){U.set("left",(a.w-V-T+(Y.x-Z.x))+"px");}if((Z.y+W+T)>a.h){U.set("top",(a.h-W-T+(Y.y-Z.y))+"px");}},attachMousedownEvent:function L(){var U=this;if(!this._close_handler){this._close_handler=function(V){U.closeMenuHandler(V);};}P.attachEvent(document.body,"mousedown",this._close_handler);},closeMenuHandler:function Q(U){if(!this.isOnMySubmenu(P.eventTarget(self,U))){this.closeMenuTree();}},isOnMySubmenu:function M(Y){var V=this._subMenu;if(!V){return false;}if(P.contains(V.domNode,Y,true,document.body)){return true;}var Z=V.ctxtBuilder.itemWidgets,U=Z&&Z.length,X,W;for(X=0;X<U;X++){W=Z[X];if(W.isOnMySubmenu(Y)){return true;}}return false;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function S(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var U=P.position(this.domNode,true);return{x:Math.round(U.x),y:Math.round(U.y+U.h)};},isSeparatorItem:function G(U){return U[this.itemIdField]===-1||U[this.itemField]==="-";},hasSubmenu:function K(U){return !!U[this.itemChildrenField];},closeMenuTree:function R(W){var V=this.activeMenuItem,U=this._cmSource||this;if(!V){if(W){this.activeMenuItem=W;}else{U.hideContextMenu();}return ;}if(V===W){return ;}if(W){this.activeMenuItem=W;if(W.parent.parent===V){return ;}if(W.parent===V.parent){V.hideContextMenu();return ;}}else{W=U;this.activeMenuItem=null;}V.hideContextMenu();while(V!==U){V=V.parent.parent;if(V!==W||U===W){V.hideContextMenu();if(U===W){P.detachEvent(document.body,"mousedown",this._close_handler);}}if(V.parent===W.parent){break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox=mstrmojo.provide("mstrmojo._HasScrollbox",{_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,scrollInterval:50,scrollboxNode:undefined,scrollTo:function F(L,K){var J=this.scrollboxNode;J.scrollLeft=L.x;J.scrollTop=L.y;if(K){this.notifyScrollListeners(L);}},connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount===1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L&&L.hasOwnProperty(J)){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(K){var N=K||this.getScrollPos(),M=N.y,L=N.x;this.scrollboxTop=M;this.scrollboxLeft=L;this.scrollboxRight=L+this.scrollboxWidth;this.scrollboxBottom=M+this.scrollboxHeight;var J=this.scrollListeners,O;for(O in J){J[O].onscroll(this);}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=L?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=L?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;mstrmojo.ui._IsIncFetchList=mstrmojo.provide("mstrmojo.ui._IsIncFetchList",{_mixinName:"mstrmojo.ui._IsIncFetchList",ifDataHelper:null,supportsIncFetch:false,isFetching:false,initScroll:function A(){var G=this.ifDataHelper,F=this,E=this.scrollNode||this.domNode;this.supportsIncFetch=G&&G.hasNext();if(G&&this.supportsIncFetch){this._scroll=function D(){if(E.offsetHeight+E.scrollTop>=E.scrollHeight){F.raiseEvent({name:"incFetch",id:F.id});}};C.attachEvent(E,"scroll",this._scroll);this.attachEventListener("incFetch",this.id,function(H){if(!this.supportsIncFetch||this.isFetching){return ;}if(this.preNext){this.preNext();}this.set("isFetching",true);G.next({complete:function(I){if(F.postNext){F.postNext();}F.set("isFetching",false);},success:function(I){F.addItems(I.items);},failure:function(I){F.supportsIncFetch=false;mstrmojo.alert("Error in fetching next: "+I);}});});}},addItems:function B(D){if(this._super){this._super(D);}if(!this.ifDataHelper.hasNext()){this.supportsIncFetch=false;var E=this.scrollNode||this.domNode;C.detachEvent(E,"scroll",this._scroll);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var Y=5;var l=1;var V=2;var N=4;var k=0;var O=true;var I=0;var F=86400000;mstrmojo.VisChartUtils=mstrmojo.provide("mstrmojo.VisChartUtils",{getScreenZoomFactor:function Z(){if(I==0){if(mstrMobileApp){var p=mstrMobileApp.getDeviceDPI();console.log("dpi:"+p);I=p/160;}else{I=1;}}return I;},changeElementSize:function a(t,x,w){if(x=="fontSize"||x=="height"||x=="line-height"){var v=mstrmojo.css.getStyleValue(t,x);var r=Math.round(w*parseInt(v));t.style[x]=r+"px";}else{if(x=="font"){var u=mstrmojo.css.getStyleValue(t,"fontSize");var r=Math.round(w*parseInt(u));var q=mstrmojo.css.getStyleValue(t,"fontWeight");var p=mstrmojo.css.getStyleValue(t,"fontFamily");t.style.font=q+" "+r+"px "+p;}}},rgbaStr2rgba:function L(p){var r=null;p=p.replace(/ /g,"");var q=p.indexOf("rgba");if(q>=0){p=p.substring(q+5,p.length-1);r=p.split(",");}return r;},fillBackground:function b(t,p,AC,q,v){var u=q||t.context,r=p||t.canvas.width,z=AC||t.canvas.height,AA=t.themeColor||"#000000",x=null,AB=v||1;if(!u){u=t.canvas.getContext("2d");if(!u){return ;}}u.save();if(t.noBackground){}else{if(!t.isAndroid&&!t.isTimeSeries){x=u.createLinearGradient(0,0,0,z/2);u.fillStyle=AA;u.fillRect(0,0,r,z);u.globalAlpha=0.4;x.addColorStop(0,"#fff");x.addColorStop(0.1,"#fff");x.addColorStop(1,AA);u.fillStyle=x;u.rect(0,0,r,z/2);u.fill();u.globalAlpha=0.1;u.fillStyle="#fff";u.fillRect(0,0,r,z/2);}else{if(t.isTimeSeries){var w=t.formatProp;x=u.createLinearGradient(0,0,0,z);u.globalAlpha=w.backgroundAlpha;u.fillStyle=this.rgb2rgbStr(w.backgroundClr)||"#000000";u.rect(0,0,r,z);u.fill();}else{u.globalAlpha=AB;u.fillStyle=AA;u.fillRect(0,0,r,z);}}}u.restore();},rgb2rgbStr:function W(q,r){var p="";if(!q||q.length!=3){return p;}if(r||r==0){p="rgba("+q[0]+","+q[1]+","+q[2]+","+r+")";}else{p="rgb("+q[0]+","+q[1]+","+q[2]+")";}return p;},getRGBWithOpacity:function R(q,p,r){if(isNaN(p)){return ;}if(!r){r=[255,255,255];}var t=[];for(color in q){t[color]=parseInt(q[color]*(1-p)+r[color]*p);}return t;},fillMasterChartBackground:function S(x,q,p,t,AE,w,u){var z=u||x.context,v=t||x.canvas.width,AC=AE||x.canvas.height,AD=x.themeColor,AB=null;var AA=x.formatProp;z.save();z.globalAlpha=AA.backgroundAlpha;z.fillStyle=this.rgb2rgbStr(AA.backgroundClr)||"#000000";z.fillRect(0,0,v,p+AE+w);z.globalAlpha=1;z.strokeStyle=this.rgb2rgbStr(x.formatProp.textClr,0.5);z.lineWidth=1;var r=p+0.5;this.drawLineSet(this,[{x:q,y:r},{x:q+v,y:r}],false,z);r=p+AC-0.5;this.drawLineSet(this,[{x:q,y:r},{x:q+v,y:r}],false,z);z.restore();},drawLineSetWithSplit:function(v,AA,z,q,w){var r=AA.length,x=Math.ceil(r/w),p,t;for(var u=0;u<x;u++){p=u*w;t=Math.min(p+w+1,r);this.drawLineSet(v,AA.slice(p,t),z,q);}},drawLineSet:function M(u,AB,AA,p){var v=null,r=AB.length,z=null;if(p){v=p;}else{v=u.context;}var w=null,q=false;v.beginPath();var t=0;while(t<r){if(AB[t]){v.moveTo(AB[t].x,AB[t].y);w=AB[t];q=true;t++;break;}t++;}var x=false;for(;t<r;t++){z=AB[t];if(z){if(!x){v.lineTo(z.x,z.y);q=false;}else{v.moveTo(z.x,z.y);q=true;w=z;x=false;}}else{if(!x){x=true;if(q){v.arc(w.x,w.y,1,0,Math.PI*2,false);}}}}if(AA){v.closePath();v.fill();}else{v.stroke();}},getMinYPosition:function H(q,u,p){var t=u,r;while(t<=p){if(q[t]){r=q[t].y;break;}t++;}for(t=u;t<=p;t++){if(q[t]){r=Math.min(r,q[t].y);}}return r;},drawLineAreaWithSplit:function(w,AD,p,u,t,x,q,z){var r=u-p+1,AB=Math.ceil(r/z),AC,AA;for(var v=0;v<AB;v++){AC=p+v*z;AA=Math.min(AC+z,p+r-1);this.drawLineArea(w,AD,AC,AA,t,x,q);}},drawLineArea:function M(v,p,z,u,x,AD,r){var AC=null,AG=p.length,AB=null,AH=0,AA=0;if(r){AC=r;}else{AC=v.context;}var t=null,AF=false;AC.save();AC.lineWidth=0;AC.beginPath();var AI=z,w;while(AI<=u){if(p[AI]){AH=p[AI].x;AC.moveTo(AH,x);t=p[AI];AF=true;break;}AI++;}w=AI;var AE=false;for(;AI<=u;AI++){AB=p[AI];if(AB){if(!AE){AC.lineTo(AB.x,AB.y);AF=false;AA=AB.x;}else{AH=AB.x;AC.moveTo(AH,x);if(AI+1<=u&&p[AI+1]){AC.lineTo(AB.x,AB.y);}t=AB;AE=false;w=AI;}}else{if(!AE){AE=true;if(!AF){AC.lineTo(AA,x);AC.lineTo(AH,x);var q=this.getMinYPosition(p,w,AI)||0;AC.fillStyle=this.rgb2rgbStr(AD,1);AC.globalAlpha=0.65;AC.fill();}}}}if(!AF){AC.lineTo(AA,x);AC.lineTo(AH,x);var q=this.getMinYPosition(p,w,u)||0;AC.closePath();AC.fillStyle=this.rgb2rgbStr(AD,1);AC.globalAlpha=0.65;AC.fill();}AC.restore();},drawRectangle:function m(v,p,AA,r,u,z,t){var q=null;if(t){q=t;}else{q=v.context;}if(z){q.fillRect(p,AA,r,u);}else{q.strokeRect(p,AA,r,u);}},drawArc:function Q(t,AA,z,v,w,q,r,AB,p){var u=null;if(p){u=p;}else{u=t.context;}u.beginPath();u.arc(AA,z,v,w,q,r);if(AB){u.fill();}else{u.stroke();}},drawRoundRect:function K(t,p,AA,q,u,v,z){v=Math.min(q/2,u/2,v);t.beginPath();t.moveTo(p+v,AA);t.arcTo(p+q,AA,p+q,AA+u,v);t.arcTo(p+q,AA+u,p,AA+u,v);t.arcTo(p,AA+u,p,AA,v);t.arcTo(p,AA,p+q,AA,v);t.closePath();if(z){t.fill();}else{t.stroke();}},drawHalfRoundedRectangle:function o(t,AA,z,AB,u,p,AC,q){var v=null;if(q){v=q;}else{v=t.context;}v.beginPath();v.moveTo(AA+AB,z);v.lineTo(AA+p,z);v.arcTo(AA,z,AA,z+p,p);v.lineTo(AA,z+u-p);v.arcTo(AA,z+u,AA+p,z+u,p);v.lineTo(AA+AB,z+u);if(AC){v.fill();}else{v.stroke();}},drawStartEndPoints:function X(x,AE,q,u){var t=AE.length;var z=null,p=x.startEndPointRadius;if(q){z=q;}else{z=x.context;}z.save();var AB="#f0f43e",AA="#f0f43e",AC="#663300";if(x.startPointColor){AB=x.startPointColor;}if(x.endPointColor){AA=x.endPointColor;}else{var AD=AE[0].y,w=AE[t-1].y;if(AD>w){AA="#008000";}else{if(AD<w){AA="#8d1616";}else{AA=AB;}}}if(x.otherPointColor){AC=x.otherPointColor;}if(u&l&&AE[0]){z.strokeStyle=AB;z.fillStyle=AB;this.drawArc(this,AE[0].x,AE[0].y,p,0,Math.PI*2,true,true,z);}if(u&V&&AE[t-1]){z.strokeStyle=AA;z.fillStyle=AA;this.drawArc(this,AE[t-1].x,AE[t-1].y,p,0,Math.PI*2,true,true,z);}if(u&N){z.strokeStyle=AC;z.fillStyle=AC;for(var v=1;v<t-1;v++){if(AE[v]){this.drawArc(this,AE[v].x,AE[v].y,p,0,Math.PI*2,true,true,z);}}}z.restore();},getColor:function T(p){return(parseInt(p.themeColor.substr(1),16)>8388607)?"#000000":"#ffffff";},drawHighlightLine:function d(q,v){var p=q.context,u=q.margin,t=u.l,r=q.isTimeSeries?q.chartWidth+u.l:q.getWidth()-u.r;p.save();p.globalAlpha=1;p.strokeStyle=this.rgb2rgbStr(q.formatProp.textClr,0.35);p.lineWidth=1;p.lineCap="round";while(t<r){p.beginPath();p.moveTo(t,v);t+=2;p.lineTo(t,v);p.stroke();t+=3;}p.restore();},addLabel:function n(AH,AI,AG,AE,q,AA,AB){var AD=document.createElement("div");AD.className="mstrmojo-Chart-lbl";AD.style.color=this.rgb2rgbStr(AH.formatProp.textClr,0.8);AD.innerHTML=AI;if(q){AD.style.width=q+"px";}var u=null;var AC=0;if(AH.isTimeSeries){if(AB.w>=0){u=AH.xdiv;AC=AH.animationCanvas.width;}else{u=AH.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(!u){u=document.createElement("div");u.id="mstrmojo-chart-ylbl-div";u.className="mstrmojo-chart-ylbl-div";AH.domNode.appendChild(u);}u.style.width=AH.margin.l-1+"px";}}else{u=AH.domNode;AC=AH.getWidth();}u.appendChild(AD);var t=AD.offsetWidth||(AH.getTextWidth&&AH.getTextWidthByElem(AI,AD));var AF=AD.offsetHeight||22*(I||1);var r=q||t||100;var z=AH.xLabelPadding/2;var v=AH.yLabelPadding/2;if(AB.w>=0&&AH.isTimeSeries&&AH._scroller.origin){var AJ=AG-AH._scroller.origin.x;if(AJ<=0&&(AJ+t/2>-AH.maxYLblWidth)){AH.needRedrawVerticalLine=true;u.removeChild(AD);return null;}var p=AJ-AH.getChartWidthOnScreen();if((p-t/2)<=0&&p>=0){AH.needRedrawVerticalLine=true;u.removeChild(AD);return null;}}if(AB.w>=0){AG=AG-r/2;}if(AB.h>=0&&((AE>=AB.y-v&&AE<=AB.y+AB.h)||(AE+AF>=AB.y-v&&AE+AF<=AB.y+AB.h)||(AE+AF>=AH.canvas.height-AH.margin.b))){u.removeChild(AD);return null;}if(AB.w>=0&&(((AG>=AB.x&&AG<AB.x+AB.w+z))||AG<AB.x||AG<AH.margin.l||AG+r>AC)){u.removeChild(AD);return null;}if(AH.isTimeSeries&&AB.h>=0){u.style.top=(AH.margin.t-AF/2)+"px";u.style.height=(AH.canvas.height-AH.margin.t-AH.margin.b-1+AF/2)+"px";this.translateCSS(AG,(AE-AH.margin.t)+AF/2,AA,AD);}else{this.translateCSS(AG,AE,AA,AD);AD.style.maxHeight=AF+"px";}AB.x=AG;AB.y=AE;if(AB.h>=0){AB.h=AF;}if(AB.w>=0){AB.w=r;AD.style.textAlign="center";}return AD;},addDataLabel:function n(q,t,v,r){var p=(q.margin.l>q.margin.r)?Y:q.getWidth()-q.margin.r+Y,u=(q.margin.l>q.margin.r)?q.margin.l:q.margin.r;return this.addLabel(q,t,p,v-10,u-Y*2,false,r);},translateCSS:function f(p,u,q,t){var r="translate("+p+"px,"+u+"px)";if(q){r+=" rotate(45deg)";}t.style[J.CSS3_TRANSFORM]=r;},getTouchXYOnWidget:function B(q,p,u){var t=mstrmojo.TouchScroller,r=(t&&u.parent&&t.getScrollPositionTotals(u.parent))||{x:0,y:0};q=q-u.offsetLeft+r.x;p=p-u.offsetTop+r.y;return{touchX:q,touchY:p};},getYValue:function A(u,q){var p=u.canvas.height,t=u.margin,r=u.model.mvalues;return p-t.b-4-((parseFloat(q)-r[0])*u.RTY);},getMasterYValue:function e(t,q,u){var p=t.masterCanvas.height,r=t.model.mvalues;return p-u.b-3-((parseFloat(q)-r[0])*t.MRTY);},getSeriesIndexAndYValue:function C(z,p,AA){var AB=z.model.series,t=AB.length,v=0;y=this.getYValue(z,AB[v].rv[p])||0;var x=AA-y<0?-(AA-y):AA-y,q=x;for(var u=1;u<t;u++){var r=this.getYValue(z,AB[u].rv[p])||0;x=AA-r<0?-(AA-r):AA-r;if(x<q){y=r;q=x;v=u;}}return{y:y,si:v};},getLabelWidthForMargin:function h(p,t){var r=document.createElement("div");r.className="mstrmojo-Chart-lbl";r.innerHTML=t;p.domNode.appendChild(r);var q=r.offsetWidth||60;p.domNode.removeChild(r);return q+Y*2;},animateLineSet:function U(AC,r,AA,v){var AD=[],AB=AC.animationContext,t=AA.length;AB.clearRect(0,0,AC.getWidth(),AC.canvas.height);if(!v.index){v.index=0;}else{if(v.index>=v.rate){this.drawLineSet(AC,AA,false,AB);AC.drawLabels();if(AC.isFillLinesArea){this.fillLinesArea(AC,AA.slice(0));}if(AC.isDrawStartEndPoints){this.drawStartEndPoints(AC,AA,AB,AC.isDrawStartEndPoints);}return ;}}for(var u=0;u<t;u++){var q=AA[u],p=r[u];AD[u]={x:(v.index*(q.x-p.x)/v.rate)+p.x,y:(v.index*(q.y-p.y)/v.rate)+p.y};}this.drawLineSet(AC,AD,false,AB);var z=this;v.index++;window.setTimeout(function(){z.animateLineSet(AC,r,AA,v);},40);},fillLinesArea:function G(q,u){var r=q.canvas.height;u.push({x:q.getWidth()-q.margin.r,y:r-q.margin.b});u.push({x:q.margin.l,y:r-q.margin.b});var v=new Array();if(q.fillinColor){mstrmojo.requiresCls("mstrmojo.color");var t=mstrmojo.color.hex2rgb(q.fillinColor).join(",");v[0]="rgba("+t+", 0.8)";v[1]="rgba("+t+", 0.2)";}else{v=["rgba(255,128,0,0.8)","rgba(255,128,0,0.2)"];}var p=q.animationContext;var t=p.createLinearGradient(0,0,0,r);t.addColorStop(0,v[0]);t.addColorStop(0.75,v[1]);p.fillStyle=t;this.drawLineSet(q,u,true,p);},convertRawValueToMilliseconds:function g(r){var t=Number(r),p=t-((Date.UTC(1970,1,1)-Date.UTC(1899,12,30))/F)-k,q=new Date(p*F);return new Date(q.getUTCFullYear(),q.getUTCMonth(),q.getUTCDate()).getTime();},getAncestorBgColor:function D(r){var w=null,v=r,AB=v.modelData?v.modelData:v.model,AA=null;if(v.hasOwnProperty("xtabModel")&&v.xtabModel.hasOwnProperty("docModel")){AA=v.xtabModel.docModel;}if(AA&&AA.defn&&AA.defn.layouts&&AA.defn.layouts.length>0){var z=AA.defn.layouts,t;var q;for(q in z){if(z[q].loaded){t=z[q];}}if(t&&t.hasOwnProperty("units")){var u=t.units;var x=AB.parent;while(x){var p=x.k||null;if(u[p]&&u[p].fmts&&u[p].fmts["background-color"]){w=u[p].fmts["background-color"];break;}else{x=x.parent||null;}}if(!w){if(t.fmts&&t.fmts["background-color"]){w=t.fmts["background-color"];}}}}return w;},isLightColor:function c(v){var q=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,w,p,x,AB,AA,u=false;if(v){var AC,z;if(/^(rgba|RGBA)/.test(v)){z=v.replace(/rgba\(|RGBA\(/,"");z=z.replace(")","");AC=z.split(",");p=AC[0];x=AC[1];AB=AC[2];}else{if(/^(rgb|RGB)/.test(v)){z=v.replace(/rgb\(|RGB\(/,"");z=z.replace(")","");AC=z.split(",");p=AC[0];x=AC[1];AB=AC[2];}else{if(q.test(v)){if(v.length===4){AC="#";for(w=1;w<4;w++){AC+=v.slice(w,w+1).concat(v.slice(w,w+1));}v=AC;}var t=[];for(w=1;w<7;w+=2){t.push(parseInt("0x"+v.slice(w,w+2)));}p=t[0];x=t[1];AB=t[2];}}}AA=(p*299+x*587+AB*114)/1000;if(AA>150){u=true;}}return u;},getPointDistanceSquare:function E(q,p){return(q.x-p.x)*(q.x-p.x)+(q.y-p.y)*(q.y-p.y);},truncateTextToLine:function(q,AC,AG){AC.className=q.className;AC.style.whiteSpace="nowrap";var w=AC.innerHTML=q.innerHTML;var t=parseInt(q.offsetWidth)-parseInt(q.style.width);var AE=AG*parseInt(q.style.width)+t;var u=w;if(AC.offsetWidth>AE){var x=0,r=w.length-1;while(x<=r){var AB=Math.round((x+r)/2);var AF=w.substr(0,AB+1);var AD=w.substr(0,AB+2);AC.innerHTML=AF;var AA=AC.offsetWidth;AC.innerHTML=AD;var v=AC.offsetWidth;if(AA<=AE&&v>AE){break;}else{if(AA>AE){r=AB-1;}else{if(v<=AE){x=AB+1;}}}}u=w.substr(0,AB+1);if(u.length<w.length){if(u.charAt(u.length-1)===" "){u=u.substr(0,u.length-1);}var z=u.lastIndexOf(" ");var p=u.length-1-z;if(p>=2&&p<=8){u=u.substr(0,u.length-p-1)+"...";}else{u=u.substr(0,u.length-3)+"...";}}}q.innerHTML=u;},getLen:function(t,r,q,p){r.innerHTML=t;var u=r.offsetWidth+q-p;return u;},splitWordIfTooLong:function(u,AF,AC,x,AA){var AE=u.split(" ");var z=[];var AB=AE.length;var v=0;var t=0;for(v=0;v<AB;v++){var q=AE[v];while(true){var AG=this.getLen(q,AF,AA,x);if(AG>AC){var AD=(AC/AG)*q.length;var p=Math.round(AD);while(p>0){var w=q.substr(0,p);var r=this.getLen(w,AF,AA,x);if(r<=AC){z.push(w);break;}else{p--;}}q=q.substr(p,q.length-p);}else{z.push(q);break;}}}return z.join(" ");},truncateTextToLineWithWordWrap:function(AP,AL,AI){AL.className=AP.className;AL.style.whiteSpace="nowrap";var AH=7;var z=-1;if(AP.style&&AP.style.width&&AP.style.width.length>0){z=parseFloat(AP.style.width);}if(z<0){z=parseFloat(mstrmojo.css.getComputedStyle(AP).width);}var AJ=AP.innerHTML;var AO=parseFloat(AP.offsetWidth)-z;AJ=this.splitWordIfTooLong(AJ,AL,z,AO,AH);var AB=AJ.split(" ");var u=[];var AE=[];var AN=0;var p=0;var AG=AB.length;AL.innerHTML="&nbsp;";var AQ=AL.offsetWidth-AO;AE.push(0);for(AN=0;AN<AG;AN++){var q=this.getLen(AB[AN],AL,AH,AO);if(q>z){var AA=AB[AN];var AM=(z/q)*AA.length;AB[AN]=AA.substr(0,parseInt(AM));q=z;}u.push(q);p+=q;AE.push(p);if(AN!==AG-1){p+=AQ;}}var AD=0,AK=0;var AC=AI;for(;AK<AE.length;){var x=AE[AK]-AE[AD];if(AD>0&&AK!=AD){x-=AQ;}var w=AE[AK+1]-AE[AD];if(AD>0&&AK+1!=AD){w-=AQ;}if(x<=z&&((AK+1==AE.length)||(w>z))){AC--;if(AC==0||AK===AG){break;}else{AD=AK;AK++;}}else{AK++;}}if(AK>AG){AK=AG;}var AF=AE[AK]-AE[AD];if(AD>0&&AK!=AD){AF-=AQ;}var AR;if(AK>=AG&&AF<z){AR=AB.join(" ");}else{AR=AB.slice(0,AK).join(" ");var t=this.getLen("...",AL,AH,AO);if(AF+t<=z){AR+="...";}else{if(AR.charAt(AR.length-1)===" "){AR=AR.substr(0,AR.length-1);}var v=AR.lastIndexOf(" ");var r=AR.length-1-v;if(r===3){AR=AR.substr(0,AR.length-3)+" ...";}else{AR=AR.substr(0,AR.length-3)+"...";}}}AP.innerHTML=AR;},getLen2:function(w,q,p){var r=p;var t=r.getContext("2d");t.font=q;t.textAlign="center";t.fillStyle="blue";var v=t.measureText(w);var u=v.width;return u;},splitWordIfTooLong2:function(v,AC,u,w){var AE=v.split(" ");var AA=[];var AB=AE.length;var x=0;var t=0;for(x=0;x<AB;x++){var q=AE[x];while(true){var AF=this.getLen2(q,u,w);if(AF>AC){var AD=(AC/AF)*q.length;var p=Math.max(Math.round(AD),1);while(p>0){var z=q.substr(0,p);var r=this.getLen2(z,u,w);if(r<=AC||p==1){AA.push(z);break;}else{p--;}}q=q.substr(p,q.length-p);}else{AA.push(q);break;}}}return AA.join(" ");},getComputedFontStyle:function P(p){var q=p.fontStyle+" "+p.fontWeight+" "+p.fontSize+"/"+p.fontVariant+" "+p.fontFamily;return q;},truncateTextToLineWithWordWrap2:function(AS,AL,AC,AK){var AB=-1;if(AS.style&&AS.style.width&&AS.style.width.length>0){var AP=0;var AR=mstrmojo.css.getComputedStyle(AS);if(AR.paddingLeft){AP+=parseFloat(AR.paddingLeft);}if(AR.paddingRight){AP+=parseFloat(AR.paddingRight);}var AQ=AS.offsetWidth;AB=AQ?AQ-AP:parseInt(AS.style.width);}if(AB<0){AS.innerHTML="...";return ;}var x=mstrmojo.css.getComputedStyle(AS);var r=this.getComputedFontStyle(x);AL=this.splitWordIfTooLong2(AL,AB,r,AC);var AE=AL.split(" ");var v=[];var AH=[];var AO=0;var p=0;var AJ=AE.length;var AT=this.getLen2(" ",r,AC);AH.push(0);for(AO=0;AO<AJ;AO++){var q=this.getLen2(AE[AO],r,AC);if(q>AB){var AD=AE[AO];var AN=(AB/q)*AD.length;AE[AO]=AD.substr(0,parseInt(AN));q=AB;}v.push(q);p+=q;AH.push(p);if(AO!==AJ-1){p+=AT;}}var AG=0,AM=0;var AF=AK;for(;AM<AH.length;){var AA=AH[AM]-AH[AG];if(AG>0&&AM!=AG){AA-=AT;}var z=AH[AM+1]-AH[AG];if(AG>0&&AM+1!=AG){z-=AT;}if(AA<=AB&&((AM+1==AH.length)||(z>AB))){AF--;if(AF==0||AM===AJ){break;}else{AG=AM;AM++;}}else{AM++;}}if(AM>AJ){AM=AJ;}var AI=AH[AM]-AH[AG];if(AG>0&&AM!=AG){AI-=AT;}var AU;if(AM>=AJ&&AI<AB){AU=AE.join(" ");}else{AU=AE.slice(0,AM).join(" ");var u=this.getLen2("...",r,AC);if(AI+u<=AB){AU+="...";}else{if(AU.charAt(AU.length-1)===" "){AU=AU.substr(0,AU.length-1);}var w=AU.lastIndexOf(" ");var t=AU.length-1-w;if(t===3){AU=AU.substr(0,AU.length-3)+" ...";}else{AU=AU.substr(0,AU.length-3)+"...";}}}AS.innerHTML=AU;return AU.indexOf("...")>-1;},truncateDivContent:function(v,AA,r){AA.innerHTML=v;if(AA.offsetHeight>r){var w=0,q=v.length-1;while(w<=q){var AB=Math.round((w+q)/2);var AD=v.substr(0,AB+1);var AC=v.substr(0,AB+2);AA.innerHTML=AD;var z=AA.offsetHeight;AA.innerHTML=AC;var u=AA.offsetHeight;if(z<=r&&u>r){break;}else{if(z>r){q=AB-1;}else{if(u<=r){w=AB+1;}}}}var t=v.substr(0,AB+1);if(t.length<v.length){if(t.charAt(t.length-1)===" "){t=t.substr(0,t.length-1);}var x=t.lastIndexOf(" ");var p=t.length-1-x;if(p>=2&&p<=8){t=t.substr(0,t.length-p-1)+"...";}else{t=t.substr(0,t.length-3)+"...";}}return t;}else{return v;}},positionTooltip:function(AI,r,AN,x){if(!AI||!r||!AN){return ;}if(isNaN(x)){x=45;}var AK=AN.offsetWidth,z=AN.offsetHeight,v=AI.offsetWidth,AH=AI.offsetHeight,AD=AI.style,AA=0,AL=0;function w(){return v+x<r.x&&AH<z;}function t(){return AH+x<r.y&&v<AK;}function u(){return r.x+x+v<AK&&AH<z;}function AC(){return r.y+x+AH<z&&v<AK;}function q(){return r.x>v/2&&(AK-r.x)>v/2;}function p(){return r.y>AH/2&&(z-r.y)>AH/2;}function AM(){return t()&&w();}function AJ(){return t()&&q();}function AG(){return t()&&u();}function AO(){return w()&&p();}function AF(){return AC()&&w();}function AP(){return u()&&p();}function AE(){return AC()&&q();}function AB(){return AC()&&u();}if(AM()){AA=r.x-x-v;AL=r.y-x-AH;}else{if(AJ()){AA=r.x-v/2;AL=r.y-x-AH;}else{if(AG()){AA=r.x+x;AL=r.y-x-AH;}else{if(AO()){AA=r.x-x-v;AL=r.y-AH/2;}else{if(AF()){AA=r.x-x-v;AL=r.y+x;}else{if(AP()){AA=r.x+x;AL=r.y-AH/2;}else{if(AE()){AA=r.x-v/2;AL=r.y+x;}else{if(AB()){AA=r.x+x;AL=r.y+x;}}}}}}}}AD.left=AA+"px";AD.top=AL+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var E=mstrmojo.dom;var P=mstrmojo.dom;var O="mousedown";function S(U){var T=U[U.hotSlot||"domNode"];if(T){if(!U._closeCallback){var W=U.id,V=function(X){return function(Z){var Y=mstrmojo.all[W];if(Y&&!Y.ignoreHover){Y["auto"+X](Z,self);}};};U._uncloseCallback=V("Unclose");U._closeCallback=V("Close");}E.attachEvent(T,"mouseover",U._uncloseCallback);E.attachEvent(T,"mouseout",U._closeCallback);}}function B(U){if(U._closeCallback){var T=U[U.hotSlot||"domNode"];if(T){E.detachEvent(T,"mouseover",U._uncloseCallback);E.detachEvent(T,"mouseout",U._closeCallback);}}}function F(V,U){var T=V;while(T){if(T.open||T.openPopup){if(T.set){T.set("ignoreHover",U);}else{T.ignoreHover=U;}}T=T.opener||T.parent;if(T&&T.shouldPropagateLockHover&&!T.shouldPropagateLockHover()){break;}}}function D(){var T=this._lockHoverCallback;if(T){E.detachEvent(document.body,O,T,true);delete this._lockHoverCallback;}}mstrmojo._CanAutoClose=mstrmojo.provide("mstrmojo._CanAutoClose",{autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function Q(){this._super();if(this.autoCloses){S(this);}this.oncloseOnClickChange();},onautoClosesChange:function L(){var T=(this.autoCloses)?S:B;T(this);},oncloseOnClickChange:function H(){if(!this.curtainNode){return ;}var V=this,U="click",T=(mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp());if(T){U="touchstart";}E.attachEvent(V.curtainNode,U,function(){V.close();if(T){mstrmojo.touchManager.notify([]);}});},autoUnclose:function G(){var T=this._autoCloseTimer;if(T){self.clearTimeout(T);delete this._autoCloseTimer;}},autoClose:function J(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var T=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[T].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function R(T){D.call(this);this._super(T);},lockHover:function N(){F(this,true);if(!this._lockHoverCallback){var U=this.id,T=this._lockHoverCallback=function(V){mstrmojo.all[U]._unlockHoverCheck(V,self);};if((E.isIE7||E.isIE8)&&window.event&&(window.event.type===O)&&this.opener){this.opener._ignoreMousedown=true;}E.attachEvent(document.body,O,T,true);}},unlockHover:function M(){F(this,false);D.call(this);},_unlockHoverCheck:function C(X,T){var U=this.opener;if(U&&U._ignoreMousedown){delete U._ignoreMousedown;return ;}var W=E.eventTarget(T,X);if(!P.contains(this.domNode,W,true,document.body)){var V=P.findWidget(W);while(V){if(V===this){return ;}V=V.parent||V.opener;}if(U&&U.onPopupAutoClosed){U.onPopupAutoClosed(X,T);}this.close();}},open:function I(U,T){if(this.autoCloses){this.autoUnclose();}this._super(U,T);if(this.locksHover){this.lockHover();}},close:function K(T){if(this.locksHover){this.unlockHover();}this._super(T);},shouldPropagateLockHover:function A(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom;mstrmojo.ui.pathbar._PreAppExit=mstrmojo.provide("mstrmojo.ui.pathbar._PreAppExit",{_mixinName:"mstrmojo.ui.pathbar._PreAppExit",onmouseover:function C(E){if(this._super){this._super(E);}if(this.handleMouseOver){var H=E.target||B.eventTarget(E.hWin,E.e),F=B.findAncestorByAttr(H,"idx",true,this.domNode),D=F&&parseInt(F.value,10),G=this.items[D];this.handleMouseOver(E,G);}},onclick:function A(E){var J=E.target||B.eventTarget(E.hWin,E.e),H=B.findAncestorByAttr(J,"idx",true,this.domNode),D=H&&parseInt(H.value,10),I=this.items[D];if(this.handleClick){var F=this.handleClick(E,I);if(F){E.cancel();return ;}}if(this._super){this._super(E);}if(!J.attributes.menu&&I&&I.en!==false){var G=function(){mstrmojo.form.sendLink(I.href,I.target);};if(mstrApp.onNavigateOut(I,G)!==true){G();}return false;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var E=mstrmojo.dom,M=mstrmojo.hash,B,I=mstrmojo.global.document,K="mousedown",P="mousemove",R="mouseup";function G(Y){if(E.isPrimaryMouseBtn(Y)){B.startDragCheck(self,Y);}}var V,Q,A="mstrmojo-dnd-avatar",U;function F(Z,Y){if(Y!==undefined&&Y!==null){Q.innerHTML=Y;}U.left=Z.x+"px";U.top=Z.y+"px";}function L(Z,Y){if(!V){V=I.createElement("div");U=V.style;V.className=A;V.innerHTML='<div class="'+A+'-inner"></div>';Q=V.firstChild;I.body.appendChild(V);}F(Z,Y);U.display="block";}function S(){if(U){U.display="none";}}function H(Y){var Z=++B.ctxt.moveCount;if(Z>=B.minMoves){B.stopDragCheck();if((Y.buttons===1||Y.buttons===undefined||E.isIE9)&&(Y.which===1||Y.button===0||E.isIE8)){B.startDrag(self,Y);}}}function O(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDragCheck();delete B.ctxt;}}function D(Y){B.onDragMove(self,Y);}function C(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDrag(window,Y);}}function N(b){var Z=mstrmojo.hash.copy(b,{}),a=Z.hWin=Z.hWin||window,Y=Z.e=Z.e||a.event;Z.node=E.eventTarget(a,Y);Z.pos=E.getMousePosition(Y,a);return Z;}function J(Z){var Y=E.findWidget(Z);while(Y){if(Y.draggable){return Y;}Y=Y.parent;}return null;}function T(Y){var a=Y.src,Z=J(a.node);if(!Z){return null;}if(Z.getDragAction){Y.action=Z.getDragAction(Y);}a.widget=Z;a.data=Z.getDragData&&Z.getDragData(Y);if(Z.isDragValid){if(!Z.isDragValid(Y)){if(!Z.shouldDragBubble||Z.shouldDragBubble(Y)!==true){Y.src.node=Z.domNode.parentNode;return T(Y);}return null;}}if(Z.ondragstart){Z.ondragstart(Y);}return Z;}function X(a,Z){var Y=E.findWidget(a),b=Z.tgt&&Z.tgt.widget;while(Y){if(Y.dropZone){if(Y===b){return Y;}if(Y.allowDrop&&Y.allowDrop(Z)){return Y;}}Y=Y.parent;}return null;}function W(){if(this.set){this.set("allowingDrop",false);}}mstrmojo.dnd=mstrmojo.dnd||mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){E.attachEvent(I,K,G);mstrmojo.dndEnabled=true;}},disable:function(){mstrmojo.dndEnabled=false;E.detachEvent(I,K,G);},startDragCheck:function(Y,Z){delete this.ctxt;var a=N({hWin:Y,e:Z});this.ctxt={src:a,moveCount:0,last:M.copy(a.pos),getDirection:function(b){return !!this.dir[b];},getCtxtDragData:function(){var b=this.src;return(b&&b.data)||{};},getCtxtDropData:function(){var b=this.tgt;return(b&&b.data)||{};}};if(this.minMoves){E.attachEvent(I,P,H);E.attachEvent(I,R,O);}else{this.startDrag(Y,Z);}},stopDragCheck:function(){E.detachEvent(I,P,H);E.detachEvent(I,R,O);},startDrag:function(Y,b){var Z=this.ctxt;Z.id=mstrmojo.now();var a=T(Z);if(!a){return ;}E.clearBrowserHighlights(Y);E.preventDefault(self,b);E.attachEvent(I,P,D);E.attachEvent(I,R,C);var d=window.mstrApp;if(d&&d.setInteractive){this._changeAppStatus=d.setInteractive(false);}if(!a.ownAvatar){var c=Z.src;L(c.pos,c.data&&c.data.html);}},stopDrag:function(Y,f){E.detachEvent(I,P,D);E.detachEvent(I,R,C);var b=this.ctxt,a=b.tgt||{},Z=N({hWin:Y,e:f,data:a.data}),d=X(Z.node,b);Z.widget=d;b.tgt=Z;if(d){if(d.ondrop){d.ondrop(b);}else{W.call(d);}}var c=b.src.widget;if(c&&c.ondragend){c.ondragend(b);}if(c&&!c.ownAvatar){S();}if(this._changeAppStatus){window.mstrApp.setInteractive(true);delete this._changeAppStatus;}},onDragMove:function(c,f){if(E.isSafari){E.clearBrowserHighlights();}var Y=this.ctxt,b=Y.tgt||{},Z=b.widget,d=N({hWin:c,e:f,data:b.data}),k=d.widget=X(d.node,Y),h=Y.last,a=d.pos;Y.dir={x:a.x>h.x,y:a.y>h.y};Y.last=M.copy(d.pos);Y.tgt=d;if(Z!==k){if(Z){if(Z.ondragleave){Z.ondragleave(Y);}else{W.call(Z);}}if(k){Y.tgt.data=(k.getDropData&&k.getDropData(Y))||{};if(k.ondragenter){k.ondragenter(Y);}else{if(k.set){k.set("allowingDrop",true);}}}}if(k){if(k.ondragover){k.ondragover(Y);}}var g=Y.src.widget;if(g&&g.ondragmove){g.ondragmove(Y);}if(g&&!g.ownAvatar){F(d.pos);}}});B=mstrmojo.dnd;B.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;function D(J,I){var G=[];if(J){var F;for(F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function E(L,F,N){if(C.isPrimaryMouseBtn(N.e)){var I=N.hWin,J=N.e,G=C.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=C.ctrlKey(I,J),O=C.shiftKey(I,J);if(K||O){C.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}}},premouseup:function B(H,K,G){var F=G.hWin,J=G.e,L=C.ctrlKey(F,J),I=C.shiftKey(F,J);if(L||I){C.clearBrowserHighlights(F);}},onadd:function A(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=D(K,G),J;for(J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function A(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){var H;for(H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);var J,N;for(J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(W){mstrmojo.hash.copy(W,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var W=this;this.delayTimer=window.setTimeout(function(){W._start();W=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function U(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var W=this.ease;if(typeof W==="string"){this.ease=mstrmojo.registry.ref(W);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var X=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Y(){if(X){X.exec();X.counter++;if(X.counter>=X.steps){X._end();X=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function T(){if(this.getTarget){this.target=this.getTarget();}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var X=this.target;if(X&&this.slot&&X.scriptClass){var Y=X[this.slot];if(Y){this.widget=X;this.target=Y;}}}}}if(!this.target){var W=this;while(W=W.parent){if(!W||W.domNode){break;}}if(W){this.widget=W;this.target=W[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(Z,a){var X=Z.children,W=(X&&X.length)||0,Y;for(Y=0;Y<W;Y++){X[Y][a]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(Z){this._super(Z);var Y=this.children;mstrmojo.registry.refArray(Y);var W=(Y&&Y.length)||0,X;for(X=0;X<W;X++){Y[X].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function U(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Y=this.props,Z;for(Z in Y){var X=Y[Z],W=X.ease;if(typeof W==="string"){X.ease=mstrmojo.registry.ref(W,{dontInst:true});}}this._super();},exec:function P(){var Z=this.props,a;for(a in Z){var X=Z[a],W=(X.ease||mstrmojo.ease.sin)(this.counter,X.start,X.stop-X.start,this.steps-1);if(X.fn){W=X.fn(W);}if(X.suffix){W+=X.suffix;}var Y=X.isStyle===false?this.target:this.target.style;Y[a]=W;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var a=this.srcProp,Y;if(a){var W=this.widget||this.parent;Y=W&&W[a];if((Y!=null)&&(typeof (Y)!=="string")){Y=String(Y);}}this.stop=Y;this._dynStop=true;}if(this.stop==null){this.stop="";}var Z=this.target,b=null,X=1;if(Z){Z.innerHTML="";b=document.createTextNode("");Z.appendChild(b);X=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=b;this.charGroupSize=X;},exec:function(){var X=this.targetTextNode;if(!X){return ;}var W;if(this.counter>=this.steps-1){W=this.stop;}else{if(this.counter===0){W="";}else{W=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}X.nodeValue=W;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function U(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(W){if(W==null){W=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(W*100,10)+")";}else{this.target.style.opacity=W;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function U(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function V(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Y,X,Z){var W=Math.pow(10,Z||2);if(X){return parseInt(W*Y/X,10)/W;}return parseInt(W*Y,10)/W;}mstrmojo.ease={linear:function L(X,W,Z,Y){if(X===Y){return W+Z;}if(X===0){return W;}return W+Z*I(X,Y);},sin:function A(X,W,Z,Y){return W+Z*Math.sin((Math.PI/2)*X/Y);},cos:function B(X,W,Z,Y){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},sincos:function K(X,W,Z,Y){if(X>Y/2){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}return W+Z*Math.sin((Math.PI/2)*X/Y);},cossin:function Q(X,W,Z,Y){if(X>Y/2){return W+Z*Math.sin((Math.PI/2)*X/Y);}return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},bounce:function G(X,W,Z,Y){if((X/=Y)<(1/2.75)){return Z*(7.5625*X*X)+W;}if(X<(2/2.75)){return Z*(7.5625*(X-=(1.5/2.75))*X+0.75)+W;}if(X<(2.5/2.75)){return Z*(7.5625*(X-=(2.25/2.75))*X+0.9375)+W;}return Z*(7.5625*(X-=(2.625/2.75))*X+0.984375)+W;},shake:function J(X,W,Z,Y){if(X<Y/2){return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*X/Y;}return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*(1-X/Y);}};}());(function(){mstrmojo.requiresCls("mstrmojo.models.template.Title");mstrmojo.models.template.Titles=mstrmojo.declare(null,null,{init:function D(G){var F=this.gridData=G.data,E=F.gts;this.titles=G.isRow?E.row:E.col;},size:function C(){return this.titles.length;},getTitle:function B(E){return new mstrmojo.models.template.Title({title:this.titles[E]});},getCSS:function A(E){return this.gridData.css[this.titles[E].cni].n;}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.base64","mstrmojo.func","mstrmojo.hash");mstrmojo.XhrCallbackType=null;function decodeHeader(value){var rEncoded=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(value&&value.indexOf("=?UTF-8?B?")===0){var decMsg="",result;while((result=rEncoded.exec(value))!==null){decMsg+=mstrmojo.base64.decode(result[1]);}return decMsg;}return value;}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function sendXhr(xhr,method,baseUrl,params){method=method.toUpperCase();var app=mstrApp,m=window.microstrategy;if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);params.taskContentType=params.taskContentType||"json";params.taskEnv=params.taskEnv||"xhr";params.xts=new Date().getTime();params[mstrApp.name]=mstrApp.servletState||"";baseUrl=baseUrl||mstrConfig.taskURL;}var ptp=app.persistTaskParams||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}xhr.open(method,appendUrlParams(method,baseUrl,params),this.async);if(method!=="POST"){xhr.send(null);}else{xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(encodeParams(params));}if(this.async===false){xhr.onreadystatechange();}}function createXhr(){var methods=[function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}],cnt=methods.length,i;for(i=0;i<cnt;i++){var xhr;try{xhr=methods[i]();}catch(e){continue;}createXhr=methods[i];return xhr;}throw new Error("mstrmojo.SimpleXHR: Could not create an XHR object.");}function evalResponse(rt){var rtn=null;try{rtn=eval("("+rt+")");}catch(ex){rtn=rt&&mstrmojo.string.trim(rt);}return rtn;}var MSI_SERVER_NAME_NOT_INITIALIZED=2147760371,MSI_INVALID_SESSION_ID=2147760372,E_MSI_USERMGR_USER_NOTFOUND=2147758245,E_MSI_CONNECT_FAILED=2147759877;function isSessionExpiredError(res){var c=res&&res.getResponseHeader("X-MSTR-TaskErrorCode");c=(c<0)?(4294967296+parseInt(c,10)):c;switch(c){case MSI_SERVER_NAME_NOT_INITIALIZED:case MSI_INVALID_SESSION_ID:case E_MSI_USERMGR_USER_NOTFOUND:case E_MSI_CONNECT_FAILED:return true;}return false;}function xhrSupportsProgress(xhr){return !!(xhr&&xhr.upload&&xhr.upload.onprogress);}mstrmojo.SimpleXHR=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.SimpleXHR",isTask:true,async:true,init:function init(props){mstrmojo.hash.copy(props,this);},onreadystatechange:function onreadystatechange(xhr,callback,prevRequest){if(xhr.readyState!==4){return ;}if(typeof callback!=="object"){return ;}try{if((xhr.status===200)||(xhr.status===304)){this.response=callback.textResponse?xhr.responseText:evalResponse(xhr.responseText);if(typeof callback.success==="function"){callback.success(this.response);}}else{if(xhr.status!==0){var app=mstrApp,sessionExp=app&&app.onSessionExpired;if(sessionExp&&isSessionExpiredError(xhr)){sessionExp.call(app,prevRequest);}else{var orig=xhr.getResponseHeader;xhr.getResponseHeader=function(name){return decodeHeader(orig.apply?orig.apply(xhr,[name]):orig(name));};if(typeof callback.failure==="function"){callback.failure(xhr);}}}}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(typeof callback.complete==="function"){callback.complete();}if(!isSessionExpiredError(xhr)&&!prevRequest.params.notRestartSessionManager){var sm=mstrApp.sessionManager;if(sm&&sm.restart){sm.restart();}}}},cancel:function(){var didCancel=false;var xhr=this.xhr;if(xhr){delete xhr.onreadystatechange;xhr.isAborted=true;if(xhr.readyState<4){xhr.abort();didCancel=true;}this.xhr=null;}return didCancel;},request:function request(method,baseUrl,callback,params,webSvrUrl,useResFeed,webSrvParams){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{var xhr=createXhr();xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}this.xhr=xhr;sendXhr.call(this,xhr,method,baseUrl,params);}}});mstrmojo.QueuedXHR=mstrmojo.declare(mstrmojo.SimpleXHR,null,{scriptClass:"mstrmojo.QueuedXHR",queue:null,requestCount:0,retryDelay:1,lookup:null,cancel:function cancel(){var didCancel=this._super();while(this.queue.length){var x=this.queue.pop();var cb=x.callback;if(cb&&cb.complete){cb.complete();}}this.queue=[];this.requestCount--;return didCancel;},init:function init(){this.queue=[];this.lookup=[];},request:function request(method,baseUrl,callback,params,override,webSvrUrl,useResFeed,webSrvParams,useCache){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue();};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}sendXhr.call(this,xhr,method,baseUrl,params);}}}},upload:function upload(method,baseUrl,callback,params,data,config,override,webSrvParams,useCache){if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);}if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params,data:data,config:config});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();var self=this;callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue.call(ths);};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});var handleProgress=function(event){callback.progress(event,config);};var url=baseUrl;xhr.open("POST",url,false);var formData=new FormData();var a;for(a in params){formData.append(a,params[a]);}if(data){if(params.fileName){formData.append("myFile",data,params.fileName);}else{formData.append("myFile",data);}}if(xhrSupportsProgress(xhr)&&callback.progress){xhr.upload.onprogress=handleProgress;}xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(self,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));xhr.send(formData);}}},advanceQueue:function advanceQueue(){this.requestCount--;if(this.queue.length===0){this.requestCount=0;return ;}var req=this.queue.shift();if(req.params.taskId==="importFile"){this.upload(req.method,req.baseUrl,req.callback,req.params,req.data,req.config);}else{this.request(req.method,req.baseUrl,req.callback,req.params,true);}},_searchForCacheRequest:function _searchForCacheRequest(params){var i;for(i in this.lookup){if(mstrmojo.hash.equals(params,this.lookup[i].params)){return this.lookup[i];}}return null;},hasRequests:function hasRequests(){return this.requestCount>0||mstrmojo.jsonp.hasRequests();}});mstrmojo.xhr=new mstrmojo.QueuedXHR();mstrmojo.jsonp={jsc:new Date().getTime(),timeToWait:20000,requestCount:0,request:function(url,params,callback){var head=document.getElementsByTagName("head")[0]||document.documentElement,jsonp="jsonp"+(this.jsc++),script=document.createElement("script");params.jsonp=jsonp+"(@R@);";params.taskContentType="jsonp";params.taskEnv="jsonp";params.xts=new Date().getTime();window[jsonp]=function(response){mstrmojo.jsonp.requestCount--;if(!response){if(callback.timeout){callback.timeout();}}else{if(response.status===200){callback.success(response.content);}else{var res={status:response.status,getResponseHeader:function(name){switch(name){case"X-MSTR-TaskFailureMsg":return response.errorMsg;case"X-MSTR-TaskErrorCode":return response.errorCode;}}};if(mstrApp.onSessionExpired&&isSessionExpiredError(res)){if(callback.onSessionExpired){callback.onSessionExpired();}else{mstrApp.onSessionExpired();}}else{callback.failure(res);}}}if(window[jsonp]){if(callback.complete){callback.complete();}window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}head.removeChild(script);}};head.insertBefore(script,head.firstChild);this.requestCount++;script.src=appendUrlParams("GET",url,params);setTimeout(function(){var fn=window[jsonp];if(fn){fn();}},this.timeToWait);},hasRequests:function(){return this.requestCount>0;}};}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ACL.UserDataService=mstrmojo.provide("mstrmojo.ACL.UserDataService",{topgroups:null,userCandidates:null,getMembers:function(G,E){var F={taskId:"getUserEntityInfo",blockBegin:G.blockBegin,blockCount:G.blockCount,userEntityID:G.data.did,userEntityName:G.data.n||"",incremental:true,outputElements:G.outputElements||3};mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);},getTopLevelGroups:function D(G,F){var E=this;if(this.topgroups){F.success({items:this.topgroups});return ;}F.success=mstrmojo.func.composite([F.success,function(H){E.topgroups=H.items;}]);this.getUsers({topGroupsOnly:true},F);},searchUserCandidates:function C(F,I,G,E){var H={blockBegin:1,blockCount:G,searchPattern:F,nameWildcards:I?1:2};this.getUsers(H,E);},getUserCandidates:function B(H,G){if(this.userCandidates){G.success(this.userCandidates);return ;}var E=G.success,F=this;G.success=function(J){F.userCandidates={items:J.items,isComplete:(parseInt(J.bc,10)===-1||(J.bb+J.bc>J.sz))};E(F.userCandidates);};var I={blockBegin:1,blockCount:H,nameWildcards:1};this.getUsers(I,G);},getUsers:function A(G,E){var F={taskId:"getUserServices"};mstrmojo.hash.copy(G,F);mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var B=mstrmojo.hash;mstrmojo.Base=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Base",init:function A(C){B.copy(C,this);if(this.postApplyProperties){this.postApplyProperties();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.vi.ui.rw.selectors._IsPageBySelector=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsPageBySelector",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsPageBySelector",isViPageBy:true,preBuildRendering:function A(){var C=this.defn;C.horiz=true;var B=mstrmojo.hash.copyProps(["n","srcid","srct","style","ck","ckey","tks"],C);B.n=C.ttl||B.n||"";B.id=this.id;this.parent.set("unit",B);delete this.getFormats().color;return this._super();}});mstrmojo.vi.ui.rw.selectors._IsPageBySelector.PageByUnitType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.requiresDescs(521,522,523,524,525,526,529,530,534,535,546,547,587,686,687,688,696,746,1101,1102,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,2171,2202,2203,2204,2219,2220,2784,2785,2786,2795,2796,3086,3344,3852,3853,3854,3855,3856,3857,3858,3859,3860,3861,3862,3863,3945,3946,4406,4407,5282,5283,5924,5925,6076,6077,6078,6079,6080,6081,6082,7899,7900,7901,7902,7903,9379,9380,9381,9382,9383,9384,9385,12298,13889,13890,13896,13897);mstrmojo.locales=mstrmojo.provide("mstrmojo.locales",{load:function(C){var A=this;if(this.isLoaded){C();C=null;}else{var B={taskId:"getLocaleInfo"};if(mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){B.sessionState=mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(D){A.update(D);C();C=null;if(mstrmojo.expr){mstrmojo.expr.onLocaleUpdated();}mstrmojo.locales.isLoaded=true;},failure:function(D){alert(D.getResponseHeader("X-MSTR-TaskFailureMsg"));}},B);}},update:function(A){if(A){mstrmojo.hash.copy(mstrmojo.hash.obj2array(A),this);}},isLoaded:false,datetime:{MONTHNAME_SHORT:[mstrmojo.desc(3852,"Jan"),mstrmojo.desc(3853,"Feb"),mstrmojo.desc(3854,"Mar"),mstrmojo.desc(3855,"Apr"),mstrmojo.desc(3856,"May"),mstrmojo.desc(3857,"Jun"),mstrmojo.desc(3858,"Jul"),mstrmojo.desc(3859,"Aug"),mstrmojo.desc(3860,"Sep"),mstrmojo.desc(3861,"Oct"),mstrmojo.desc(3862,"Nov"),mstrmojo.desc(3863,"Dec")],MONTHNAME_FULL:[mstrmojo.desc(1956,"January"),mstrmojo.desc(1957,"February"),mstrmojo.desc(1958,"March"),mstrmojo.desc(1959,"April"),mstrmojo.desc(1960,"May"),mstrmojo.desc(1961,"June"),mstrmojo.desc(1962,"July"),mstrmojo.desc(1963,"August"),mstrmojo.desc(1964,"September"),mstrmojo.desc(1965,"October"),mstrmojo.desc(1966,"November"),mstrmojo.desc(1967,"December")],dayShortNames:["S","M","T","W","T","F","S"],dayNames:[mstrmojo.desc(9379,"Sunday"),mstrmojo.desc(9380,"Monday"),mstrmojo.desc(9381,"Tuesday"),mstrmojo.desc(9382,"Wednesday"),mstrmojo.desc(9383,"Thursday"),mstrmojo.desc(9384,"Friday"),mstrmojo.desc(9385,"Saturday")],DATEINPUTFORMATS:["M/d/yy","M/d/yyyy","MMM d, yy"],TIMEINPUTFORMATS:["h:mm a","H:mm","h:mm:ss a","H:mm:ss","h:mm:ss a z"],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",DATEDISPLAYFORMAT:"M/d/yy",TIMEDISPLAYFORMAT:"h:mm:ss",AM_NAME:"AM",PM_NAME:"PM",TWODIGITYEARSTART:"2029"},number:{NUMBERINPUTFORMATS:{"0":"#,##0.###"},INTEGERINPUTFORMATS:{"0":"#,##0"},NUMBEROUTPUTFORMAT:"#0.##########",INTEGEROUTPUTFORMAT:"#0",DECIMALSEPARATOR:".",THOUSANDSEPARATOR:","},expression:{METRICVALIDATIONLEVEL:"0",PRESERVEWHITESPACE:false,Include:[{did:"1",n:mstrmojo.desc(3945,"Include")},{did:"2",n:mstrmojo.desc(3946,"Exclude")}],BranchQual:[{did:"19",n:mstrmojo.desc(5282,"AND")},{did:"20",n:mstrmojo.desc(5283,"OR")},{did:"21",n:mstrmojo.desc(12298,"NOT")},{did:"19_21",n:mstrmojo.desc(5924,"AND NOT")},{did:"20_21",n:mstrmojo.desc(5925,"OR NOT")}],RootOperator:[{did:"19",n:mstrmojo.desc(534,"All selections")},{did:"20",n:mstrmojo.desc(535,"Any selection")}],ExprType:[{did:"2",n:mstrmojo.desc(546,"Qualify")},{did:"5",n:mstrmojo.desc(547,"Select")}],DimtyLevels:[{did:"1",n:mstrmojo.desc(2171,"Default")},{did:"2",n:mstrmojo.desc(3086,"Metric")},{did:"3",n:mstrmojo.desc(3344,"Report")}],Attribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,76",n:mstrmojo.desc(686,"Contains"),t:1,tp:1},{did:"1,79",n:mstrmojo.desc(2784,"Does not contain"),t:1,tp:1},{did:"1,77",n:mstrmojo.desc(687,"Begins with"),t:1,tp:1},{did:"1,80",n:mstrmojo.desc(2785,"Does not begin with"),t:1,tp:1},{did:"1,78",n:mstrmojo.desc(688,"Ends with"),t:1,tp:1},{did:"1,81",n:mstrmojo.desc(2786,"Does not end with"),t:1,tp:1},{did:"1,18",n:mstrmojo.desc(525,"Like"),t:1,tp:1},{did:"1,43",n:mstrmojo.desc(526,"Not Like"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],Metric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"2,1",n:mstrmojo.desc(529,"Highest"),t:2,tp:2},{did:"2,2",n:mstrmojo.desc(530,"Lowest"),t:2,tp:2},{did:"3,1",n:mstrmojo.desc(4407,"Highest %"),t:3,tp:3},{did:"3,2",n:mstrmojo.desc(4406,"Lowest %"),t:3,tp:3}],MetricRP:[{did:"2,13",n:mstrmojo.desc(13897,"Rank between highest"),t:2,tp:2},{did:"2,4",n:mstrmojo.desc(1101,"Exclude highest"),t:2,tp:2},{did:"2,3",n:mstrmojo.desc(13896,"Rank between lowest"),t:2,tp:2},{did:"2,5",n:mstrmojo.desc(1102,"Exclude lowest"),t:2,tp:2},{did:"3,13",n:mstrmojo.desc(13890,"Between highest")+"%",t:3,tp:3},{did:"3,4",n:mstrmojo.desc(1101,"Exclude highest")+"%",t:3,tp:3},{did:"3,3",n:mstrmojo.desc(13889,"Between lowest")+"%",t:3,tp:3},{did:"3,5",n:mstrmojo.desc(1102,"Exclude lowest")+"%",t:3,tp:3}],MDXAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],MDXMetric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],SAPAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],Element:[{did:"1,22",n:mstrmojo.desc(2219,"In List"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2220,"Not In List"),t:1,tp:1}]},validation:{requiredFieldError:mstrmojo.desc(6078,"This field is required."),invalidCharError:mstrmojo.desc(7899,"This field contains invalid characters for #."),invalidDateStringError:mstrmojo.desc(7900,"This field contains invalid date/time string."),invalidNumericFormatError:mstrmojo.desc(7901,"This field contains numeric value with incorrect format."),outofRangeError:mstrmojo.desc(6079,"This field should be # between ## and ###."),noLessMinError:mstrmojo.desc(6081,"This field should be # greater than or equal to ##."),noGreaterMaxError:mstrmojo.desc(6080,"This field should be # less than or equal to ###."),failRegexTestError:mstrmojo.desc(6082,"This field failed regular expression validation."),invalidValueInListError:mstrmojo.desc(7902,"One of the value (#) in this list is not valid."),integerDataType:mstrmojo.desc(6076,"an Integer value"),numericDataType:mstrmojo.desc(6077,"a Number value"),dateDataType:mstrmojo.desc(7903,"a Date/Time value")},color:{colors:[{n:"Black",v:"#000000"},{n:"Brown",v:"#993300"},{n:"Olive Green",v:"#333300"},{n:"Dark Green",v:"#003300"},{n:"Dark Teal",v:"#003366"},{n:"Dark Blue",v:"#000080"},{n:"Indigo",v:"#333399"},{n:"Grey-80%",v:"#333333"},{n:"Dark Red",v:"#800000"},{n:"Orange",v:"#FF6600"},{n:"Dark Yellow",v:"#808000"},{n:"Green",v:"#008000"},{n:"Teal",v:"#008080"},{n:"Blue",v:"#0000FF"},{n:"Blue-Grey",v:"#666699"},{n:"Grey-50%",v:"#808080"},{n:"Red",v:"#FF0000"},{n:"Light Orange",v:"#FF9900"},{n:"Lime",v:"#99CC00"},{n:"Sea Green",v:"#339966"},{n:"Aqua",v:"#33CCCC"},{n:"Light Blue",v:"#3366FF"},{n:"Violet",v:"#800080"},{n:"Grey-40%",v:"#969696"},{n:"Pink",v:"#FF00FF"},{n:"Gold",v:"#FFCC00"},{n:"Yellow",v:"#FFFF00"},{n:"Bright Green",v:"#00FF00"},{n:"Turquoise",v:"#00FFFF"},{n:"Sky Blue",v:"#00CCFF"},{n:"Plum",v:"#993366"},{n:"Grey-25%",v:"#C0C0C0"},{n:"Rose",v:"#FF99CC"},{n:"Tan",v:"#FFCC99"},{n:"Light Yellow",v:"#FFFF99"},{n:"Light Green",v:"#CCFFCC"},{n:"Light Turquoise",v:"#CCFFFF"},{n:"Pale Blue",v:"#99CCFF"},{n:"Lavender",v:"#CC99FF"},{n:"White",v:"#ffffff"}],userPalette:[{n:"#F00E0E",v:"#F00E0E"},{n:"#080000",v:"#080000"},{n:"#E81A1A",v:"#E81A1A"},{n:"#6E0909",v:"#6E0909"},{n:"#4F2828",v:"#4F2828"},{n:"#141212",v:"#141212"},{n:"#D60202",v:"#D60202"},{n:"#C40404",v:"#C40404"}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.requiresDescs(2213,3326,3327,3329,4531,13283,13284,13285,13286);mstrmojo.ME.Enum={METRIC_ACTIONS:{ADD:"add",EDIT:"edit",EIDT_NEW:"editNew"},EDITOR_IDS:{ADVANCED:"mstrME",FORMULA:"mstrME",WIZARD:"mstrFE",SIMPLE:"mstrSME",SELECOTR:"mstrFSE"},EDITOR_TYPES:{ADVANCED:"ADVANCED",FUNCTION:"FUNCTION",SIMPLE:"SIMPLE",SELECTOR:"SELECTOR"},METRIC_EDIT_TYPES:{ADVANCED:65536,SIMPLE:131072,FUNCTION:196608},METRIC_TYPES:{65536:"ADVANCED",131072:"SIMPLE",196608:"FUNCTION"},NEW_METRIC_DEFINITION:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}},getNewDefinition:function(){return{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};},FBFlag:{Automatic:0,Manual:3},AFB:{Automatic:-1,False:0,True:1},SFB:{Automatic:-1,False:1,True:2},UI_OBJECT_TYPE:{Dimty:-1,Sub_Expression:-2,Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},UI_DATA_TYPE:{Sortby:-1,Breakby:-2,Level:-4,Condition:-5,Transformation:-6},SHORTCUT_FUNCTIONS:{Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},DYNAMIC_DIMTY:{CODES:{auto:{n:mstrmojo.desc(4531,"Automatic"),did:"@auto",t:-1},page:{n:mstrmojo.desc(3329,"Grand Total"),did:"@p",t:-1},byCol:{n:mstrmojo.desc(3326,"By Columns"),did:"@cols",t:-1},byRow:{n:mstrmojo.desc(3327,"By Rows"),did:"@rows",t:-1},byCell:{n:mstrmojo.desc(13283,"By Cell"),did:"@cell",t:-1},byShape:{n:mstrmojo.desc(13284,"By Shape"),did:"@shape",t:-1},downCross:{n:mstrmojo.desc(13285,"Down, Then Across"),did:"@cr",t:-1},crossDown:{n:mstrmojo.desc(13286,"Across, Then Down"),did:"@rc",t:-1}},getItems:function D(G){var F=this.CODES,E=[];switch(G){case"breakby":E=[F.auto,A.copy({n:mstrmojo.desc(2057,"None")},A.copy(F.page)),A.copy({n:mstrmojo.desc(122,"Columns")},A.copy(F.byCol)),A.copy({n:mstrmojo.desc(2968,"Rows")},A.copy(F.byRow)),A.copy({n:mstrmojo.desc(13399,"Cell")},A.copy(F.byCell)),A.copy({n:mstrmojo.desc(2923,"Shape")},A.copy(F.byShape))];break;case"level":E=[F.auto,F.page,F.byCol,F.byRow,F.byCell,F.byShape];break;case"sortby":E=[F.auto,F.downCross,F.crossDown];}return E;},getAutomaticDimtyObject:function C(){return A.copy(this.CODES.auto);},getDimtyObject:function B(E,H){var F=null;var G=false;if(H){A.forEach(mstrmojo.ME.Enum.DYNAMIC_DIMTY.CODES,function(I){if(I.did===E){F=A.copy(I);G=true;return false;}});}if(!G){F={n:E,t:-1,dimty:true};}return F;}},NonExposableParams:["IsNewOLAP","OLAPPattern","OLAPHasWindow"]};mstrmojo.ME.Enum.DEFAULT_MPS={mps:{afb:mstrmojo.ME.Enum.AFB.False,sfb:mstrmojo.ME.Enum.SFB.False,fbf:mstrmojo.ME.Enum.FBFlag.Automatic}};}());mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){document.msCSSOMElementFloatMetrics=true;mstrmojo.requiresCls("mstrmojo.hash");var S=mstrmojo.hash,H="containerNode",G="auto",Q="px";var I={v:G,c:undefined,sv:G};function E(c,f,e){var g=this._layoutWidgets[f],l=c.slot||H,h=g.f,k=g.p,d=(h&&h[l]!==undefined),b=(k&&k[l]!==undefined);if(l&&((!e&&d)||b)){return d?h[l]:(g.x*parseInt(k[l],10)/100)+Q;}return c[(f==="h")?"height":"width"];}function K(g,d,b){if(g.ignoreLayout){return ;}var c=(d===G)||d==="NaNpx",f=(b===G)||b==="NaNpx";var e=g.getLayoutOffsets&&g.getLayoutOffsets();if(e){if(!c){d=(parseInt(d,10)-e.h)+Q;}if(!f){b=(parseInt(b,10)-e.w)+Q;}}if(g.setDimensions){g.setDimensions(d,b);}else{if(g.set){if(!c){g.set("height",d);}if(!f){g.set("width",b);}}}}function Z(e){var c=this.children,g,l;for(g=0,l=(c&&c.length)||0;g<l;g++){var d=c[g],m=d.slot||H;if(m){var k=E.call(this,d,"h",e),n=E.call(this,d,"w",e);this.setSlotDimensions(m,k,n);K(d,k,n);var b=E.call(this,d,"h",e),f=E.call(this,d,"w",e);if(b!==k||f!==n){K(d,b,f);}this.setSlotDimensions(m,b,f);}}this.afterLayout();}function B(){var c=this.children,b=this._layoutWidgets;S.forEach(this.slotNames,function(g,k){if(!g||this.skipsSlotLayout(k)){return ;}var f=(b.h&&b.h.getSlotSizeInfo(k,c))||I,d=(b.w&&b.w.getSlotSizeInfo(k,c))||I,e=f.c||d.c;mstrmojo.array.forEach(e,function(h){K(h,f.v,d.v);});this.setSlotDimensions(k,f.sv,d.sv);},this);this.afterLayout();}function D(c){var b=this.layoutConfig.xt?B:Z;b.call(this,c);}function T(k,e,g){var h=k.slot||H,f=e&&e.a;if(!f||f[h]===undefined){return ;}var b=this[h]["offset"+g],c=f[h];if(b===c){return ;}e.x-=(b-c);f[h]=b;}function J(b){this.beforeLayout();var c=this._layoutWidgets,d=b.src;T.call(this,d,c.h,"Height");T.call(this,d,c.w,"Width");D.call(this,true);}function O(d,g){if(!d){return null;}var b=this.children,r=g.toLowerCase(),h=parseInt(this[r],10),l=h,n={},p={},f={},c={},o={},k,m,e,t,q;for(q in d){if(!d.hasOwnProperty(q)){continue;}t=d[q];if(t.match(/px$/)){h-=parseInt(t,10);n[q]=t;}else{if(t.match(/%$/)){p[q]=t;}else{if(t.match(/all/)){o[q]=l;}else{f[q]=t;}}}}if(!S.isEmpty(f)&&!S.isEmpty(p)){for(k=0,m=(b&&b.length)||0;k<m;k++){e=b[k];q=e.slot||H;if(q&&f[q]&&!e.ignoreLayout){if(e.hasRendered){c[q]=this[q]["offset"+g];h-=c[q];}else{c[q]=0;e.attachEventListener((e instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,J);}}}}return{f:S.isEmpty(n)?undefined:n,p:S.isEmpty(p)?undefined:p,a:S.isEmpty(c)?undefined:c,n:S.isEmpty(o)?undefined:o,x:h,getSlotSizeInfo:function(AC,w){if(!d[AC]){return I;}var v=mstrmojo.array.filter(w,function(AE){var AD=AE.slot;return AD===AC||(AC===H&&!AD);}),AA,AB;var u=n[AC];if(u){AB=u;}var z=p[AC];if(z){AB=(this.x*parseInt(z,10)/100)+Q;}if(f[AC]){AB=c[AC];if(AB){AB+=Q;}else{AB=G;}AA=G;}var x=o[AC];if(x){AB=AA=x+Q;}AB=AB||"0px";return{v:AB,c:v,sv:AA||AB};}};}function R(c){var b=this.domNode;if(!b||!this.layoutConfig){return ;}b.style[c]=this[c];this.doLayout();}mstrmojo._HasLayout=mstrmojo.provide("mstrmojo._HasLayout",{_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",ignoreLayout:false,beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function V(b){this._super(b);this.layoutConfig=S.clone(this.layoutConfig);},preBuildRendering:function C(){var d=this.cssText||"";var b=this.height;if(b&&b!==G){d+="height:"+this.height+";";}var c=this.width;if(c&&c!==G){d+="width:"+this.width+";";}this.cssText=d;return(this._super)?this._super():true;},postBuildRendering:function W(){this.doLayout();return this._super();},modifyLayoutConfig:function Y(d,c){var b=this.layoutConfig=this.layoutConfig||{};b.h=S.copy(d,b.h);b.w=S.copy(c,b.w);this.doLayout();},getLayoutOffsets:mstrmojo.emptyFn,set:function P(d,b){var c=this._super(d,b);if(d==="visible"&&this._pendingLayoutOnVisible){delete this._pendingLayoutOnVisible;this.doLayout();}return c;},doLayout:function A(){var b=this.layoutConfig;if(!b||(this.height===G&&this.width===G)){return ;}if(b.xt){if(!this.visible){this._pendingLayoutOnVisible=true;return ;}}this.beforeLayout();this._layoutWidgets={h:O.call(this,b.h,"Height"),w:O.call(this,b.w,"Width")};D.call(this,false);this.widgetResized();},browserResized:function F(b){this.setDimensions(b.h,b.w);return true;},onwidthChange:function N(){R.call(this,"width");},onheightChange:function M(){R.call(this,"height");},skipsSlotLayout:function(b){return false;},adjustParentDimensions:function L(){var c=this.parent,b=c&&c._layoutWidgets;if(b){T.call(c,this,b.h,"Height");T.call(c,this,b.w,"Width");}},setDimensions:function U(e,c){var d=(e===G)||e==="NaNpx",f=(c===G)||c==="NaNpx";if((!d&&parseInt(this.height,10)!==parseInt(e,10))||(!f&&parseInt(this.width,10)!==parseInt(c,10))){if(!d){this.height=e;}if(!f){this.width=c;}var b=this.domNode,g=b&&b.style;if(g){if(!d){g.height=e;}if(!f){g.width=c;}this.doLayout();}return true;}return false;},setSlotDimensions:function X(e,d,c){var b=this[e]&&this[e].style;if(!b){return ;}if(d!==G&&d!==undefined&&d!=="NaNpx"&&b.height!==d&&parseInt(d)>=0){b.height=d;}if(c!==G&&c!==undefined&&c!=="NaNpx"&&b.width!==c&&parseInt(c)>=0){b.width=c;}}});mstrmojo._HasLayout.getSlotSize=function a(e,f){var c=e&&e.prototype.layoutConfig;if(c){var d=c.h,b=c.w;return{h:(d&&d[f])||undefined,w:(b&&b[f])||undefined};}return null;};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var W=this._sourceFn;if(!W){var V=this.source;if(V!=null){if(typeof (V)=="string"){if(!(V.match("return "))&&!(V.match(/\;\s*\S/))){V="return "+V;}W=new Function(V);}else{if(typeof (V)=="function"){W=V;}}this._sourceFn=W;}}var S,X=this.parent;if(W){try{S=W.apply(X,[]);}catch(U){}}var T=this.setter,Y=this.destination;if(T==null){X[Y]=S;}else{if(typeof (T)=="string"){X[T](Y,S);}else{if(typeof (T)=="function"){T.apply(X,[Y,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var T=this._chains;if(!T){this._parseChains();T=this._chains;}for(var S in T){this._attachChain(T[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var T=this._chains;if(T){for(var S in T){this._detachChain(T[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var U=this._chains;var T=this.source;if(T&&(typeof (T)=="function")){T=T.toString&&T.toString();}if(!T){return ;}function S(b,e,V,X){var W=b,Z;while(Z=W.match(e)){var c=Z[0],a=c.length,d=true;c=c.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Y in U){if(Y.substr(0,a)===c){d=false;break;}else{if(c.indexOf(Y)===0){delete U[Y];}}}if(d){U[c]={host:(V==null)?null:Z[V],parts:Z[X].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}W=W.substr(Z.index+a);}}if(D.test(T)){S(T,O,null,1);}if(R.test(T)){S(T,M,1,2);}if(B.test(T)){S(T,L,1,2);}},_attachChain:function Q(S,U){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var d=S.evt2idx,g=S.idx2evt,Z=S.parts;var e=(U>=0)?U:0,b=this.id,W=mstrmojo.all,c=(U>0)?W[g[e-1].context][Z[e-1]]:(S.host?W[S.host]:this.parent),T=Z[e];var V=mstrmojo.array;while(c&&T){if(c.attachEventListener){var f=c[T+"_bindEvents"]||(T+"Change");if(typeof (f)=="string"){f=[f];}var Y=[];for(var a=0,X=f.length;a<X;a++){Y[a]=c.attachEventListener(f[a],b,"_callback");}for(var a=0;a<f.length;a++){d[c.id+"_"+f[a]]=e;}g[e]={context:c.id,evts:f,subs:Y};}c=c[T];T=S.parts[++e];}},_detachChain:function G(S,T){var U=mstrmojo.all,h=S.idx2evt,d=S.evt2idx,a=this.id;var Y=(T>-1)?T:0,b=h.length;if(Y<b){for(;Y<b;Y++){var Z=h[Y];if(!Z){break;}var W=Z.context,c=U[W],g=Z.evts;if(c&&c.detachEventListener){var k=Z.subs;for(var f=0,V=k.length;f<V;f++){c.detachEventListener(k[f]);}}h[Y]=null;for(var X=0,e=g.length;X<e;X++){delete d[W+"_"+g[X]];}}}},_callback:function I(T){this.exec();if(!T||!T.name||!T.src){return ;}var U=T.src.id+"_"+T.name,W=this._chains;for(var X in W){var V=W[X],S=V.evt2idx[U];if(S!=null){this._detachChain(V,S+1);this._attachChain(V,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.all={};var E=mstrmojo.all,G=mstrmojo.hash;var A=0;function D(){var I;while(!I){var H="mstr"+(A++);if(!E[H]){I=H;}}return I;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function F(H){if(!H){return ;}var I=H.id;if(!I){H.id=I=D();}else{if(E[I]){throw new Error("Tried to register 2 objects with same id: "+I);}}E[I]=H;},remove:function C(H){if(H&&H.id){delete E[H.id];}},dumpAll:function(){var H;for(H in E){var I=E[H].id;if(I){mstrmojo.dbg(I+"("+(E[H].scriptClass||"[unknown class]")+")");}}},ref:function B(I,H){H=H||{};if(I){var L=I;while(L){switch(typeof L){case"string":if(H.skipLoadChecks!==true){mstrmojo.requiresCls(L);}L=G.walk(L,window);break;case"function":return(H.dontInst!==true)?new L():L;case"object":if(L.constructor===Object){var K=L.scriptClass;if(K){if(H.skipLoadChecks!==true){mstrmojo.requiresCls(K);}var J=G.walk(K,window);if(J){return new J((H.clone===true)?G.clone(L):L);}return null;}return L;}return L;default:return null;}}}return null;}});mstrmojo.insert=mstrmojo.registry.ref;}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var C=mstrmojo.EnumReadystate;function E(G){return(G.getKey&&G.getKey())||G.k;}mstrmojo._IsDocController={_mixinName:"mstrmojo._IsDocController",_getXtabCallback:function(L,H){var G={},J=G[E(L)]=L.defn,K=this,I=K.model;return I.newCallback({submission:function(){if(J.set){J.set("readyState",C.WAITING);}},success:function(N){var M=N.pukeys,O=M&&M.split("\u001E");if(M){G=I.getUnitDefinitions(M);}I.partialUpdate(N.data,G,N.defn,O,N.puFilters);},failure:function(M){if(!(mstrApp.isSingleTier&&M.code===403)){mstrmojo.alert(M.code+": "+M.message);}},complete:function(){if(J.set){J.set("readyState",C.IDLE);}K.docRequestComplete();}});},_addNodeKeyToAction:function(G,H){H.nodeKey=E(G);return H;},onGridSelector:function(H,K){var G=this.model,J=[].concat(G.getTargetInfoWin(K.ifw)).concat(G.getTargetInfoWin(K.tks));if(J&&J.length){var I;for(I=0;I<J.length;I++){G.showInfoWin(J[I],K.anchor,"h",true);}}K.sid=H.sid;G.slice(K);},onVisSelector:function(H,J){if(J.anchor){var G=this.model,I=G.getTargetInfoWin(J.tks);if(I&&I.length){G.showInfoWin(I[0],J.anchor,"h",true);}}if(H.xtabModel&&H.xtabModel.docModel&&H.xtabModel.docModel.slice){H.xtabModel.docModel.slice(J);}},isInRequest:function D(){var G=!!this._inProcess;if(!G){this._inProcess=true;}return G;},docRequestComplete:function F(){this._inProcess=false;},nudgeWidget:mstrmojo.emptyFn,getGroupByElements:function B(I){var M=[],L;while(I){L=I.node&&I.node.data&&I.node.data.pbes;if(L){break;}I=I.parent;}if(L){var J=this.model.data.elems;var H=L.length,K;for(K=0;K<H;K++){var G=L[K];M.push(isNaN(G)?G:J&&J[G]);}}return M;},setData:function A(H,J){var G=this.view,I=J;if(J&&G&&G.unloadLayouts){G.unloadLayouts(null,false);I=false;}this.model.loadLayout(H,I);if(this.hasPageBy&&this.hasPageBy()){this.getPageByTree(true);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var D=mstrmojo.registry,K=mstrmojo.array,I=mstrmojo.publisher;function G(Q,R){if(R){R.parent=Q;var P=D.ref(R);if(R!==P){delete R.parent;}return P;}return null;}function L(Q,R){var P=R.alias;if(P!==null&&P!==""){Q[P]=R;}}function N(Q,R){var P=R.alias;if(R.parent===Q){delete R.parent;}if((P!==null&&P!=="")&&(Q[P]===R)){delete Q[P];}}function A(T,Q){var P=Q&&Q.length,S,R;if(P){S=[];for(R=0;R<P;R++){var U=G(T,Q[R]);if(!U){continue;}S.push(U);L(T,U);}}return S;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,children:null,postCreateChildren:mstrmojo.emptyFn,onaddChild:null,onremoveChild:null,initChildren:function F(){var P="children",Q=this[P];if(!Q){return ;}this[P]=null;this._set_children(P,Q,true);this.postCreateChildren();},_set_children:function E(S,Q,P){var R=this.children;if(Q!==R){if(R){this.removeChildren(null,P);}this.addChildren(Q,0,P);}return false;},destroyChildren:function C(S){var R=this.children,P=(R&&R.length)||0,Q;if(P){for(Q=P-1;Q>-1;Q--){var T=R[Q];if(T&&T.destroy){T.destroy(S);if(!S){N(this,T);}}}if(!S){R.length=0;}}},invalidateChildren:function B(){mstrmojo.array.forEach(this.children,function(P){P.invalidate();});},invalidate:function H(){this.invalidateChildren();},addChildren:function O(U,Q,R){if(!U){return U;}var T=U.constructor===Array,P=A(this,T?U:[U]);if(P&&P.length){var S=this.children||[];if(Q===null||Q===undefined){Q=S.length;}this.children=K.insert(S,Q,P);if(!R&&(this.onaddChild||I.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:P,index:Q});}}return T?P:(P&&P[0]);},removeChildren:function J(V,R){var T=this.children,U=V?[V]:(this.children||[]).concat(),Q=U.length,P=-1,S;if(Q){for(S=Q-1;S>-1;S--){N(this,U[S]);}if(V){P=K.removeItem(T,V);}else{if(T){T.length=0;P=0;}}if(!R&&(this.onremoveChild||I.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:U,index:P});}}return P;},removeAndDestroyChild:function M(R,P,Q){if(R){if(R.parent!==this){throw"Unable to remove an object that is not in the children collection.";}this.removeChildren(R,P);R.destroy(Q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var A=false,D="mstrmojo.Binding",I="bindings",H=mstrmojo.registry;function B(K){var L;for(L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function C(K,M){if(!A){mstrmojo.requiresCls(D);A=true;}var N;for(N in K){var J=K[N];if(J===null||J===undefined){continue;}var L=typeof J;if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=H.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function E(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[I]);if(K){delete this[I];this._set_bindings(I,K);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children,J=(M&&M.length)||0;if(J){var L;for(L=0;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function G(){var J=this.bindings;if(J){B(J);delete this.bindings;}},_set_bindings:function F(L,J){var K=this[I];if(J!==K){if(K){B(K);}this[I]=J;if(J){C(J,this);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.locales");var c=mstrmojo.array,P=mstrmojo.meta.TP,G=mstrmojo.meta.STP,O=mstrmojo.hash,F={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1,RLS:15},B={};var W;for(W in F){B[F[W]]=true;}var a={};a[F.AQ]="a";a[F.AL]="a";a[F.AC]="a";a[F.AE]="a";a[F.MQ]="m";a[F.MC]="m";a[F.F]="f";a[F.R]="r";a[F.XML]="p";var K={};K[F.MQ]=["not","m","fn","fnt","cs","dmy","idcsi"];K[F.MC]=["not","m","fn","fnt","m2","m3","p","dmy","idcsi"];K[F.AE]=["not","a","fn","es","a2","fm2","p"];K[F.AQ]=["not","a","fm","fn","cs"];K[F.AL]=["not","a","fm","fn","cs"];K[F.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];K[F.R]=["not","r"];K[F.F]=["not","f"];K[F.XML]=["not","n","p"];var M={};M[F.MQ]="METRIC_FNS";M[F.MC]="METRIC_FNS";M[F.AQ]="FORM_FNS";M[F.AL]="FORM_FNS";M[F.AC]="FORM_FNS";M[F.AE]="ELEM_FNS";var N={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43,CONS:47},b={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776,REPORT_EMMACUBE:779,CONS:12032,NDE:12033},T={a:N.ATTR,a2:N.ATTR,m:N.METRIC,m2:N.METRIC,r:N.REPORT,f:N.FILTER,p:N.PROMPT},U={f:b.FILTER};var V={};V[F.MQ]=N.METRIC;V[F.MC]=N.METRIC;V[F.AQ]=N.ATTR;V[F.AL]=N.ATTR;V[F.AC]=N.ATTR;V[F.AE]=N.ATTR;V[F.F]=N.FILTER;V[F.R]=N.REPORT;var J=function(d){var H=d.length,g={},e;for(e=0;e<H;e++){var h=d[e];g[h.did]=h.n;}return g;},E=function(e){var H=e.length,f;for(f=0;f<H;f++){var d=e[f];if("tp" in d){d.t=d.tp;}}return e;},X=function(e,g){var H=e.length,f;for(f=0;f<H;f++){var d=e[f];if("tp" in d){if(g){d.t=g;}else{delete d.t;}}}return e;},Z=function(d,f){if(!f){f=[];}f.length=0;var e,H;for(e=0,H=d.length;e<H;e++){f[e]=d[e];}return f;},L={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};var R={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:F,ETs:B,ET2TGT:a,ET2COND:K,ET2TP:V,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21,SEARCH:158},FN_MRP:{BETWEEN:3,EXCLUDE_TOP:4,EXCLUDE_BOTTOM:5,BETWEEN_DESCENDING:13},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:N,STP:b,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},BFTP:{RESERVED:0,HIDDEN:-1,DATETIME:1,NUMBER:2,TEXT:3,PICTURE:4,URL:5,EMAIL:6,TAG:7,DATE:8,TIME:9,SYMBOL:10,BIGDECIMAL:11,PHONENUMBER:12},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":b.PROMPT,1:b.PROMPT_LONG,2:b.PROMPT_LONG,3:b.PROMPT_LONG,4:b.PROMPT_DOUBLE,5:b.PROMPT_DOUBLE,6:b.PROMPT_DOUBLE,7:b.PROMPT_DOUBLE,8:b.PROMPT_STRING,9:b.PROMPT_STRING,10:b.PROMPT_STRING,14:b.PROMPT_DATE,15:b.PROMPT_DATE,16:b.PROMPT_DATE,21:b.PROMPT_LONG,22:b.PROMPT_LONG,23:b.PROMPT_STRING,24:b.PROMPT_BOOLEAN,30:b.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0,34:0},fnCstCount:function A(e,d){var g=this.FN,h=this.FN_MRP,H=this.FNT;if(d===H.DEF||d===undefined){switch(e){case g.BETWEEN:case g.NOT_BETWEEN:return 2;case g.IS_NULL:case g.IS_NOT_NULL:return 0;}}else{if(d===H.PER||d===H.RANK){switch(e){case h.BETWEEN:case h.BETWEEN_DESCENDING:return 2;}}}return 1;},fn_List:function S(d,H){var e=this.FN;return d==e.IN_LIST||d==e.NOT_IN_LIST;},fn_AC_MC:function Y(d,H){var e=this.FN;return(d==e.EQUAL)||(d==e.NOT_EQUAL)||(d==e.GREATER)||(d==e.LESS)||(d==e.GREATER_EQUAL)||(d==e.LESS_EQUAL);},fnName:function Q(h,g,d,f){var H=this[M[h]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[f]]||H["*"];}if(h===F.MQ){H=H.concat(mstrmojo.locales.expression.MetricRP);}var e=c.find(H,"did",(d||1)+this.FN_SEP+g);if(e>-1){return H[e].n;}return"";},findTargets:function I(o,f,q){if(!q){q={};}if(o){var n;for(n in T){var AA=o[n];if(AA){if(!AA[P]){AA[P]=T[n];}if(!AA[G]&&U[n]){AA[G]=U[n];}q[AA[f]]=AA;}}if(o.dmy){var l=this.TP.ATTR,r=this.DMY_TP.ATTR,e=o.dmy.uts,z,d;for(z=0,d=(e&&e.length)||0;z<d;z++){var m=e[z];if(m&&m.utp===r){var g=m.utgt;if(!g.t){g.t=l;}q[g[f]]=g;}}}var H=o.nds,p,w;for(p=0,w=(H&&H.length)||0;p<w;p++){this.findTargets(H[p],f,q);}var v=o.cs,x=v&&v.length;if(x){for(p=0;p<x;p++){this.findTargets(v[p],f,q);}}}return q;},onLocaleUpdated:function(){var d=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=O.copy(J(d.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=Z(X(d.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":X(c.filter(d.Metric.concat(d.MetricRP),function(e){return e.did&&(c.find(R["0"],"did",e.did)<0);}))};H.FORM_FNS={0:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["0"],"did",e.did)<0);})),1:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["1"],"did",e.did)<0);})),2:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["0"],"did",e.did)<0)&&(c.find(L["1"],"did",e.did)<0);}))};H.DIMTYLEVELS=Z(X(d.DimtyLevels),H.DIMTYLEVELS);},getSortedObjectsByTypeGroup:function D(f){var H=0,d=1,e=2;function g(h){switch(h.t){case N.METRIC:return d;case N.ATTR:case N.DIM:case N.CONS:return H;case N.FILTER:return h.st===b.CUSTOMGROUP?H:e;default:return e;}}return f.slice(0).sort(function(n,m){var o=g(n)-g(m);if(o){return o;}var l=n.n.toUpperCase(),k=m.n.toUpperCase(),h=l.localeCompare(k);if(h){return h;}return n.n.localeCompare(m.n);});},mapBaseFormTypeToDataType:function C(e){e=parseInt(e);if(e===NaN){return -1;}var d=this.BFTP,H=this.DTP;switch(e){case d.DATETIME:return H.TIMESTAMP;case d.DATE:return H.DATE;case d.TIME:return H.TIME;case d.NUMBER:return H.REAL;case d.TEXT:return H.CHAR;case d.BIGDECIMAL:return H.BIGDECIMAL;default:return H.CHAR;}}});mstrmojo.expr.onLocaleUpdated();}());(function(){mstrmojo.requiresCls("mstrmojo.locales");var X=function(){return mstrmojo.locales.datetime;},L=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},now:Date.now||function D(){return new Date().getTime();},isDate:function Y(b,f,a){var d=this.parseDate(b,a);var e=!!(d&&this.doesDateExist(d.month,d.day,d.year));if(f){if(e){var c=this.formatDateInfo(d,X().DATEOUTPUTFORMAT);if(a){return{match:d.match,formatted:c};}return c;}return null;}return !!e;},formatDateInfo:function R(d,f){if(!f){return"";}var a=d.day,e=d.month,c=d.year;var b=f.replace(/dd/g,this.formatInteger(a,2)).replace(/d/g,Number(a)).replace(/yyyy/g,Number(c)).replace(/yy/g,this.formatInteger(Number(c)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,X().MONTHNAME_FULL[Number(e)-1]).replace(/\~\~\~\~/g,X().MONTHNAME_SHORT[Number(e)-1]).replace(/\@\@/g,this.formatInteger(e,2)).replace(/\^/g,Number(d.month));return b;},parseDate:function Z(m,f,k){if(m==null){return false;}if(typeof m!=="string"){m=String(m);}m=L.trim(m);var a=this.CACHE.PARSEDATE[f?"CONTAINS":"EQUALS"],c=a[m];if(c||(c===null)){return c;}var b=null;var h;if(k){h=[k];}else{h=[].concat(X().DATEINPUTFORMATS);h.unshift(X().DATEOUTPUTFORMAT);}var d,e;for(d=0,e=h.length;d<e;d++){var g=this._buildRegExp4DateFormat(h[d]),l=g&&m.match(f?g.reContains:g.reEquals);if(l){b={match:l[0],year:g.yearIndex&&this.fourDigitYear(l[g.yearIndex]),day:g.dayIndex&&parseInt(Number(l[g.dayIndex]),10),month:g.monthIndex&&this.numericMonth(l[g.monthIndex])};break;}}a[m]=b;return b;},isTime:function I(b,e,a){var f=this.parseTime(b,a);var d=!!(f&&this.doesTimeExist(f.hour,f.min,f.sec));if(e){if(d){var c=this.formatTimeInfo(f,X().TIMEOUTPUTFORMAT);if(a){return{match:f.match,formatted:c};}return c;}return null;}return !!d;},parseTime:function J(n,f,l){if(n==null){return false;}if(typeof n!=="string"){n=String(n);}n=L.trim(n);var a=this.CACHE.PARSETIME[f?"CONTAINS":"EQUALS"],c=a[n];if(c||(c===null)){return c;}var b=null;var k;if(l){k=[l];}else{k=[].concat(X().TIMEINPUTFORMATS);k.unshift(X().TIMEOUTPUTFORMAT);}var d,e;for(d=0,e=k.length;d<e;d++){var h=this._buildRegExp4TimeFormat(k[d]),m=h&&n.match(f?h.reContains:h.reEquals);if(m){var g=h.ampmIndex&&m[h.ampmIndex];b={match:m[0],hour:h.hourIndex&&this.capitalHour(m[h.hourIndex],g),min:h.minIndex&&parseInt(Number(m[h.minIndex]),10),sec:h.secIndex&&parseInt(Number(m[h.secIndex]),10)};break;}}a[n]=b;return b;},formatTimeInfo:function S(d,b){if(!b){return"";}var c=!(Number(d.hour)%12)?12:(Number(d.hour)%12),a=b.replace(/HH/g,this.formatInteger(d.hour,2)).replace(/H/g,Number(d.hour)).replace(/hh/g,this.formatInteger(c,2)).replace(/h/g,c).replace(/mm/g,this.formatInteger(Number(d.min)||0,2)).replace(/m/g,Number(d.min)||0).replace(/ss/g,this.formatInteger(Number(d.sec)||0,2)).replace(/s/g,Number(d.sec)||0).replace(/a/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME).replace(/tt/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME).replace(/AM\/PM/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME);return a;},doesTimeExist:function G(f,b,e){var d=parseInt(f,10);if(d>=0&&d<=23){var a=parseInt(b,10);if(a>=0&&a<=59){if(!e){return true;}var c=parseInt(e,10);if(c>=0&&c<=59){return true;}}}return false;},capitalHour:function C(a,b){a=parseInt(Number(a),10);if(b&&(b.match(X().AM_NAME)||b.match(/AM/i))){return a%12;}if(b&&(b.match(X().PM_NAME)||b.match(/PM/i))){return 12+(a%12);}return a;},getTimeStamp:function O(){var b=new Date();var a=[b.getMonth()+1,b.getDate(),b.getFullYear()];var e=[b.getHours(),b.getMinutes(),b.getSeconds()];var d=(e[0]<12)?"AM":"PM";e[0]=(e[0]<12)?e[0]:e[0]-12;e[0]=e[0]||12;for(var c=1;c<3;c++){if(e[c]<10){e[c]="0"+e[c];}}return a.join("-")+" "+e.join(":")+" "+d;},isDateAndOrTime:function V(a,b){return this.isDateTime(a,b)||this.isDate(a,b)||this.isTime(a,b);},isDateTime:function B(l,a){var e=this.parseDateAndOrTime(l),h=e&&e.date,d=e&&e.time,g=!!h&&!!d&&this.doesDateExist(h.month,h.day,h.year)&&this.doesTimeExist(d.hour,d.min,d.sec);if(a){if(g){var b=this.formatDateInfo(h,X().DATEOUTPUTFORMAT),c=this.formatTimeInfo(d,X().TIMEOUTPUTFORMAT),k=l.indexOf(h.match),f=l.indexOf(d.match);return(f<k)?c+" "+b:b+" "+c;}return null;}return !!g;},parseDateAndOrTime:function Q(b,a,f){var c=this.parseDate(b,true,a);var d=L.trim((c&&c.match)?b.replace(c.match,""):b),e=this.parseTime(d,false,f);if(!c&&!e){return null;}return{date:c,time:e};},inDateTimeRange:function P(c,e,h){var b=this.parseDateAndOrTime(c),f=b&&b.date,k=b&&b.time;if(!f&&!k){return 0;}if(e!=null){var d=this.parseDateAndOrTime(e);if(f&&d&&d.date){var l=this.compareDate(f,d.date);if(l<0){return -1;}if(l==0){if(k&&d.time&&(this.compareTime(k,d.time)<0)){return -1;}}}}if(h!=null){var a=this.parseDateAndOrTime(h);if(f&&a&&a.date){var g=this.compareDate(f,a.date);if(g>0){return 1;}if(g==0){if(k&&a.time&&(this.compareTime(k,a.time)>0)){return 1;}}}}return 0;},compareDate:function A(c,a){if(c===a){return 0;}var d=typeof c==="string"?this.parseDate(c):c,b=typeof a==="string"?this.parseDate(a):a;if(!d){return -1;}if(!b){return 1;}return(d.year-b.year)||(d.month-b.month)||(d.day-b.day)||0;},compareTime:function K(b,a){if(b===a){return 0;}var d=typeof b==="string"?this.parseTime(b):b,c=typeof a==="string"?this.parseTime(a):a;if(!d){return -1;}if(!c){return 1;}return(d.hour-c.hour)||(d.min-c.min)||(d.sec-c.sec)||0;},compareDateTime:function U(b,a){return this.compareDate(b,a)||this.compareTime(b,a);},compareDateAndOrTime:function E(h,f){if(h===f){return 0;}var b=typeof h==="string"?this.parseDateAndOrTime(h):h,a=typeof f==="string"?this.parseDateAndOrTime(f):f;if(!b){return -1;}if(!a){return 1;}var g=b.date,e=a.date,d=b.time,c=a.time;return this.compareDate(g,e)||this.compareTime(d,c);},_buildRegExp4DateFormat:function N(c){if(!c){return null;}var e=this.REGEXPS.DATES[c];if(!e){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=X().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=X().MONTHNAME_SHORT.join("|");}e=this.REGEXPS.DATES[c]={};e.formatStr=c;var b=e.reStr=c.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");e.reEquals=new RegExp("^"+b+"$");e.reContains=new RegExp("^"+b+"\\b");var f=[{key:"monthIndex",index:c.indexOf("M")},{key:"dayIndex",index:c.indexOf("d")},{key:"yearIndex",index:c.indexOf("y")}];f.sort(function(h,g){return h.index-g.index;});var a=1,d;for(d=0;d<3;d++){e[f[d].key]=f[d].index>-1?a++:null;}}return e;},_buildRegExp4TimeFormat:function F(d){if(!d){return null;}var f=this.REGEXPS.TIMES[d];if(!f){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[X().AM_NAME,X().PM_NAME,String(X().AM_NAME).toLowerCase(),String(X().PM_NAME).toLowerCase()].join("|");}f=this.REGEXPS.TIMES[d]={};f.formatStr=d;var c=d.replace(/\'\'/g,'"');var g=c.match(/\'(.+?)\'/g);c.replace(/\'(.+?)\'/g,"*");c=c.replace(/([^H|h|m|s|z|Z|a|t|\s|A|P|M|\/])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/g,"("+this.REGEXPSTR_AMPM+")").replace(/AM\/PM/,"("+this.REGEXPSTR_AMPM+")").replace(/tt/g,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");var e,a;for(e=1,a=(g&&g.length)||0;e<a;e++){c=c.replace(/\*/,g[e]);}c=c.replace(/\"/g,"'");f.reEquals=new RegExp("^"+c+"$");f.reContains=new RegExp(c);var h=[{key:"hourIndex",index:d.search(/h|H/)},{key:"minIndex",index:d.indexOf("m")},{key:"secIndex",index:d.indexOf("s")},{key:"ampmIndex",index:d.search(/tt|a|AM\/PM/)},{key:"zoneIndex",index:d.search(/z|Z/)}];h.sort(function(l,k){return l.index-k.index;});var b=1;for(e=0;e<5;e++){f[h[e].key]=h[e].index>-1?b++:null;}}return f;},doesDateExist:function M(d,a,b){var c=new Date(b,d-1,a);return b==c.getFullYear()&&d==c.getMonth()+1&&a==c.getDate();},fourDigitYear:function T(b){b=parseInt(Number(b),10);if(!isNaN(b)){var a=(X().TWODIGITYEARSTART%100)||0;if(b>=0&&b<=a){b=2000+b;}else{if(b>a&&b<100){b=1900+b;}}}return b;},numericMonth:function W(e){var d=parseInt(Number(e),10),c=mstrmojo.array;if(!isNaN(d)){return d;}var a=(e&&e.length)||0,b=-1;if(a){if(a<=3){b=c.indexOf(X().MONTHNAME_SHORT,e);}if(b===-1){b=c.indexOf(X().MONTHNAME_FULL,e);}}return b+1;},formatInteger:function H(c,b){var f=String(c),e=Math.max(b-f.length,0);if(e>0){var a=[f],d;for(d=1;d<=e;d++){a.push("0");}f=a.reverse().join("");}return f;},getFirstDateOfMonth:function(b,a){return new Date(b,a-1,1);},getDateObject:function(g,a,f,c,e,b){g=g||0;a=a||1;f=f||1;c=c||0;e=e||0;b=b||0;return new Date(g,a-1,f,c,e,b);},getDateFromDateInfo:function(a){return this.getDateObject(a.date&&a.date.year,a.date&&a.date.month,a.date&&a.date.day,a.time&&a.time.hour,a.time&&a.time.min,a.time&&a.time.sec);},getDateJson:function(a){return{year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),min:a.getMinutes(),sec:a.getSeconds()};},isLeapYear:function(a){return !(a%400)||(!(a%4)&&!!(a%100));},getDaysOfMonth:function(c,a){var b=[31,28,31,30,31,30,31,31,30,31,30,31];if(a==2&&this.isLeapYear(c)){return 29;}return b[a-1];},getPreMonth:function(b,a){if(a===1){return{y:b-1,m:12};}return{y:b,m:a-1};},getNextMonth:function(b,a){if(a===12){return{y:b+1,m:1};}return{y:b,m:a+1};}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string","mstrmojo.array");var N=mstrmojo.locales,I=mstrmojo.string,Q=window.mstrConfig,F=mstrmojo.array,K=function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},R=function(){return mstrmojo.locales.number.DECIMALSEPARATOR;},C=Q.units,T={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},A={1:"cm",2:"in",3:"mm",4:"pt",5:"pc",6:"px"},E={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var G=96;String.prototype.reverse=function(){var W="",V;for(V=this.length;V>0;--V){W+=this.charAt(V-1);}return W;};function M(V,X){V=V||"";X=X||V.match(/\".+?\"/g)||[];for(var W=0;W<X.length;W++){V=V.replace(X[W],X[W].substring(1,X[W].length-1).replace(/\$/g,"$$$$"));}return V;}function U(a){var V=86400000,Z=new Date(1900,0,1,0,0,0,0),W=Math.floor(a)-1,Y=a-W-1;if(a>=59){W--;}var X=new Date(Z.getTime()+(W*V));X.setTime(X.getTime()+Y*V+500);return X;}function H(Z,g,l){var a={"d+":Z.getDate(),"h+|H":Z.getHours(),"s+":Z.getSeconds()},V=N.datetime,b;if(/(y+)/.test(g)){var Y=Z.getFullYear().toString(),f=RegExp.$1,X=f.length===2,W=Y.length;g=g.replace(f,Y.substr(X?W-2:0,X?2:W));}if(/(^\[h\])/.test(g)&&l){g=g.replace(RegExp.$1,""+(Math.floor(l*24)));}if(/(\"?:\"?mm)/.test(g)){var c=Z.getMinutes();g=g.replace(RegExp.$1,":"+(RegExp.$1.length===1?c:("00"+c).substr(c.toString().length)));}if(/(AM\/PM)/.test(g)){var h=a["h+"],d=h>11;a["h+"]=h-(d?12:0);g=g.replace(RegExp.$1,d?"PM":"AM");}for(b in a){if(new RegExp("("+b+")").test(g)){g=g.replace(RegExp.$1,RegExp.$1.length===1?a[b]:("00"+a[b]).substr((a[b].toString()).length));}}if(/(mmmm)/.test(g)){g=g.replace(RegExp.$1,V.MONTHNAME_FULL[Z.getMonth()]);}else{if(/(mmm)/.test(g)){g=g.replace(RegExp.$1,V.MONTHNAME_SHORT[Z.getMonth()].substr(0,3));}else{if(/((m|M)+)/.test(g)){var e=(Z.getMonth()+1).toString();g=g.replace(RegExp.$1,RegExp.$1.length===1?e:("00"+e).substr(e.length));}}}return M(g);}function O(W,Z){var X=0,V=Z.length,Y=0;for(;X<V;X++){if(Z[X]==="0"){Y++;}else{if(Z[X]==="#"){if(Y<W){Y++;}}else{continue;}}}return Y;}mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function D(V){var Y=K(),X=new RegExp("^(-)?[0-9]{1,3}(\\"+Y+"[0-9]{3})*$"),W=new RegExp("^(-)?[0-9]+$");return(String(V).indexOf(Y)&&X.test(V))||W.test(V);},isNumeric:function P(Y,Z){var X=R(),a=K(),W=new RegExp("^(-)?[0-9]{1,3}(\\"+a+"[0-9]{3})*(\\"+X+"[0-9]+)?$"),V=new RegExp("^(-)?[0-9]*(\\"+X+")?[0-9]+$");return(String(Y).indexOf(a)&&W.test(Y))||V.test(Y);},parseInteger:function L(V,W){if(!this.isInt(V)){return Number.NaN;}return parseInt(this.toString(V,true),W);},parseNumeric:function B(V){if(!this.isNumeric(V)){return Number.NaN;}return parseFloat(this.toString(V,true));},inNumericRange:function S(W,X,V){W=this.parseNumeric(W);V=(V!=null)?this.parseNumeric(String(V)):Number.NaN;X=(X!=null)?this.parseNumeric(String(X)):Number.NaN;if(V!=Number.NaN&&(W>V||isNaN(W))){return 1;}if(X!=Number.NaN&&(W<X||isNaN(W))){return -1;}return 0;},convertToUSUnits:function(Y,X,W){var V=Y;X=X||C;switch(parseInt(X,10)){case T.CM:V=parseFloat(this.toString(Y))/2.54+"";break;case T.MM:V=parseFloat(this.toString(Y))/25.4+"";break;case T.PT:V=parseFloat(this.toString(Y))/72+"";break;case T.PC:V=parseFloat(this.toString(Y))/6+"";break;case T.PX:V=parseFloat(this.toString(Y))/G+"";break;}return W?V:this.toLocaleString(V);},convertToLocalUnits:function(Y,X,W){var V;X=X||C;switch(parseInt(X,10)){case T.CM:V=(parseFloat(this.toString(Y))*2.54).toFixed(4)+"";break;case T.MM:V=(parseFloat(this.toString(Y))*25.4).toFixed(4)+"";break;case T.PT:V=(parseFloat(this.toString(Y))*72).toFixed(4)+"";break;case T.PC:V=(parseFloat(this.toString(Y))*6).toFixed(4)+"";break;case T.PX:V=(parseFloat(this.toString(Y))*G)+"";break;default:V=parseFloat(this.toString(Y)).toFixed(4)+"";}return W?V:this.toLocaleString(V);},convertUnits:function(W,X,V){return this.convertToLocalUnits(this.convertToUSUnits(V,W,true),X,true);},toLocaleString:function(V){return(V+"").replace(".",R());},toString:function(X,V){if(V===true){var W=this.getThousandSepRegex();if(W){X=String(X).replace(W,"");}}return String(X).replace(R(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(K().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(X,W){var V=W;if(W=="."||W=="*"||W=="\\"){V="\\"+W;}return X.reverse().replace(/(\d{3})/g,"$1"+W).reverse().replace(new RegExp("^(-)?"+V),"$1");},format:function(Z,Y,c,V){var b="",a=(Y>0)?".":"",W=[];c=(c)?c:"";for(var X=0;X<Y;X++){W.push("0");}W=W.join("");switch(Z){case E.GENERAL:b="0.00";break;case E.PERCENT:b="0"+a+W+"%";break;case E.SCIENTIFIC:b="0"+a+W+"E+00";break;default:b='"'+c+'"#,##0'+a+W;}return this.formatByMask(b,V);},getDecimalLength:function J(X){var V=X.indexOf("."),Y=0;if(V!==-1){var W=X.substr(V+1,X.length).match(/\d+/);if(W&&W.length>0){Y=W[0].length;}}return Y;},formatByMask:function(AD,AT){var AA,r;if(isNaN(AT)){AA=new Date(AT);if(isNaN(AA)){return AT;}r=true;}if(AD==="General"){return String(parseFloat(AT).toFixed(2));}var q=String(AD).split(";"),l="",Y=q[0],h="\u00A4",AM=/"[^"]*"/g,k=(AD&&AD.replace(AM,h).replace(/\[.*\]/g,h))||"",AS=["m","y","d","h","s"],AI=false;F.forEach(AS,function(m){AI=AI||k.indexOf(m,0)!==-1;});if(AI){if(window.SSF){l=window.SSF.format(AD,AT);}if(l!==""){return l;}else{return H(r?AA:U(AT),AD,AT);}}var AH=Y.indexOf("E+"),e=Y.indexOf("%"),w=Y.match(/\".+?\"/g),x=Y.indexOf("?/?")>-1,AB=(AH!=-1)?E.SCIENTIFIC:((e!=-1)?E.PERCENT:((w)?E.CURR:x?E.FRACTION:E.FIXED)),p="",AO="",n=false,W=new String(AT),d=this.parseNumeric(AT)||parseFloat(AT);if(w){if(Y.match(/\[\$.+?\]/g)){for(var f=0;f<w.length;f++){Y=Y.replace(w[f],w[f].substring(1,w[f].length-1));if(w[f].match(/\[\$.+?\]/g)){w[f]=w[f].replace(/\[\$.+?\]/g,w[f][w[f].indexOf("[$")+2]);}}Y=Y.replace(/\[\$.+?\]/g,'"#"'.replace("#",Y[Y.indexOf("[$")+2]));}p=M(Y,w);p=p.replace(Y.replace(/\".+?\"/g,""),h);}if(d<0){W=W.substring(1,W.length);d=-d,n=true;if(q.length>1){var b=q[1].replace(/\[.*\]/,"");AO=M(b.replace(q[0],h));}}var c=function(v,m){return(m)?m.replace(h,v):"-"+v;};if(AB==E.FRACTION){var AL,AK,AR,o=10,z,u=0,AF,AN,Z,X=false,AC;if(AD.indexOf("# ")>-1){X=true;}for(AL=5;AL>0;AL--){AC="/";for(AK=0;AK<AL;AK++){AC+="?";}if(AD.indexOf(AC)>-1){for(AK=1;AK<AL;AK++){o*=10;}break;}}if(X){u=Math.floor(Number(d));d-=u;}AN=o/2;AR=-1;AF=d*o;for(AL=o-1;AL>=2;AL--){Z=(AF*AL)/o;Z=Z-Math.floor(Z);Z=Z*o;if(Math.abs(Z-o)<Z){Z=Math.abs(Z-o);}Z=Z/AL;if(Z<AN){AN=Z;AR=AL;}else{if((Z==AN)&&(Z==0)){AN=Z;AR=AL;}}}z=Math.round(AR*AF/o);for(AL=AR;AL>=2;AL--){if((z%AL==0)&&(AR%AL==0)){z=z/AL;AR=AR/AL;break;}}if(AR==o){AR=1;z=0;}if(z==0){AR=1;}if(z==AR){if(X){l=""+(u+1);}else{l="1";}}else{if(X&&u>0){if(z==0){l=u;}else{l=u+" "+z+"/"+AR;}}else{if(z==0){l="0";}else{l=z+"/"+AR;}}}if(n){l=c(l,AO);}}else{if(AB==E.SCIENTIFIC){if(d!=0){var AU=Math.floor(Math.log(d)/Math.LN10),AJ=d/Math.pow(10,AU),AV=Y.substring(0,AH),g=AV.indexOf("."),AE=Y.length-Y.indexOf("E+")-(""+Math.abs(AU)).length-2,AL,V=AU<0;AU=Math.abs(AU);for(AL=0;AL<AE;AL++){AU="0"+AU;}l+=Number(AJ).toFixed((g!=-1)?AV.length-g-1:0);l=((n)?c(l,AO):l)+"E"+(V?"-":"+")+AU;}else{l="0";}}else{if(AB==E.PERCENT){Y=Y.substring(0,Y.length-1);W=String(d*100);}var g=Y.indexOf("."),a=0,AQ,t=g>=0?Y.substring(0,g):Y;if(t.match(/[#0\?],$/)){d/=1000;W=String(d);}AQ=this.getDecimalLength(W);if(g!=-1){a=O(AQ,Y.substr(g+1,Y.length));}l=String(parseFloat(W).toFixed(Math.min(a,20)));var AP=l.split(".");var AG=Y.replace(/"[^"]*"/g,"").match(/[#\d]+[^\.\d#]+[#\d]+/);if(AG!==null){AP[0]=this.addSeparators(AP[0],K());}l=AP.join(R());if(AB==E.CURR){l=p.replace(h,l);if(l===p&&window.SSF){l=window.SSF.format(AD,AT);}}if(AB==E.PERCENT){l+="%";}if(n){l=c(l,AO);}}}return l;},validateFormat:function(V){var W=true,X=String(V).split(";");if(X[1]&&X[1].indexOf(X[0])<0){W=false;}return W;},generateUniqueID:function(V){var X="0123456789ABCDEF".split(""),Y=[];for(var W=0;W<V;W++){Y[W]=X[0|Math.random()*16];}return Y.join("");},countOfDecimals:function(W,X){var V=String(W);return V.length-(V.indexOf(X!==undefined?X:R())+1);}});mstrmojo.num.UNIT=T;mstrmojo.num.UNIT_SYMBOL=A;})();(function(){mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.chart.common.DSSTimeUtil=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSTimeUtil",DaysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],DaysBeforeMonth:[0,31,59,90,120,151,181,212,243,273,304,334],DateAbove1970:[1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981]});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.hash");var J=mstrmojo.hash,H="t",L=14;mstrmojo.vi.ui.rw.selectors.CollapsibleCheckListHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.CollapsibleCheckListHelper",init:function M(S){if(!S.checkList){throw new Error(this.scriptClass+" must be initialized with a CollapsibleCheckList instance.");}this._super(S);this.preDataProcess();},preDataProcess:function G(){var S=this.checkList,T=S.docSelector.node.data,Z=T.elms,a,U=Z.length,X=S.rootIndices,V=T.p_relation,W,Y;if(!X||!Z[0].childrenIndices){X=S.rootIndices=[];this.resetChildrenIndices();for(W=0;W<U;W++){Y=V[W].p_index;if(Y<0){if(Z[W][H]!==L){X.push(W);}else{Z[W]._renderIdx=0;}}else{Z[Y].childrenIndices.push(W);}}this.setHasChildren();this.initItemExpandStatus();}},resetChildrenIndices:function C(){var S=this.checkList.items,U=S.length,T;for(T=0;T<U;T++){S[T].childrenIndices=[];}},setHasChildren:function Q(){var S=this.checkList.items,U=S.length,T;for(T=0;T<U;T++){S[T].hcd=S[T].childrenIndices.length>0;}},initItemExpandStatus:function I(){var T=this.checkList.items,S=this.checkList.docSelector.node.data.p_relation,V=T.length,U;for(U=0;U<V;U++){T[U].epd=false;T[U].isCollapsedHidden=S[U].p_index>=0;}},updateCachedSelectedDescendantsCount:function B(){var U=this.checkList.rootIndices,T,S=U.length;for(T=0;T<S;T++){this.getAndCacheSelectedDescendantsCount(U[T],false);}},getAndCacheSelectedDescendantsCount:function N(T,S){var V=this.checkList.docSelector.node.data.elms[T],W,U;if(V.nSelectedDescendants===undefined||!S){V.nSelectedDescendants=this.getAndCacheSelectedChildrenCount(T,S);W=V.childrenIndices.length;for(U=0;U<W;U++){V.nSelectedDescendants+=this.getAndCacheSelectedDescendantsCount(V.childrenIndices[U],S);}}return V.nSelectedDescendants;},getAndCacheSelectedChildrenCount:function D(T,S){var V=this.checkList.docSelector.node.data.elms[T],W,U;if(V.nSelectedChildren===undefined||!S){V.nSelectedChildren=0;W=V.childrenIndices.length;for(U=0;U<W;U++){if(this.checkList.selectedIndices[V.childrenIndices[U]]){V.nSelectedChildren+=1;}}}return V.nSelectedChildren;},getAndCacheDescendantsCount:function F(S){var U=this.checkList.docSelector.node.data.elms[S],V,T;if(U.nDescendants===undefined){V=U.childrenIndices.length;U.nDescendants=V;for(T=0;T<V;T++){U.nDescendants+=this.getAndCacheDescendantsCount(U.childrenIndices[T]);}}return U.nDescendants;},isAllItemsSelected:function P(){var T=this.checkList,W=T.selectedIndices,V,U,S=T.items.length-1;U=0;for(V in W){if(V==="0"){continue;}U++;}return U===S;},getLevelCount:function O(){var T,S=this.checkList;if(isNaN(S.levelCount)){T=0;J.forEach(S.items,function(V,U,W){if(!isNaN(V.lv)&&T<V.lv){T=V.lv;}});S.levelCount=T+1;}return S.levelCount;},isBranchSelected:function K(S){var U=this.checkList,T=U.items[S].childrenIndices;if(U.selectedIndices[S]){for(var V in T){if(!K.call(this,T[V])){return false;}}return true;}return false;},isLevelSelected:function E(W,V){var S=this.checkList,U=S.selectedIndices;if(U[0]){return true;}else{var T,X=V||this.getLevelIndices(W),Y=X.length;for(T=0;T<Y;T++){if(!U[X[T]]){return false;}}}return true;},getBranchIndices:function R(S){var V=[],T=this.checkList.items;function U(Y,W){var X=Y[W].childrenIndices;V.push(W);for(var Z in X){U(Y,X[Z]);}}U(T,S);return V;},getLevelIndices:function A(T){var U=[];J.forEach(this.checkList.items,function S(W,V,X){if(W.lv===T){U.push(parseInt(V,10));}});return U;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.desc","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.hash");var B=mstrmojo.hash,J=Math.max,C=Math.min,E=Math.round;mstrmojo.vi.ui.rw.selectors.SliderHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.SliderHelper",_children:[{scriptClass:"mstrmojo.Label",slot:"controlNode",alias:"summary"}],init:function L(M){if(!M.slider){throw new Error(this.scriptClass+"must be initialized with a slider instance.");}if(this._children){M.slider.set("children",this._children.slice(0));}return this._super(M);},getUnit:function H(){var M=this.slider;return M._effectiveLength/J((M.items.length-1),1);},getIdxByPx:function A(M,N){var O=this.slider.unit||this.getUnit();return J(Math[N?"ceil":"floor"](M/O+0.5),0);},updateThumb:function K(){var M=this.slider,N=M.cs1Idx,P=M.cs2Idx;if(this.notNull(N,P)){var O=M.unit;B.copy(this.positionSliderElements(M,E(N*O),E(P*O)),M);}},positionSliderElements:function D(a,W,V){var c=this.slider,X="px",g=c.multiSelect,R=c._effectiveLength,O=c.thumbWidth,k=c.cssBkBW,N=c.orCfg,h=N.posCssP,S=N.lenCssP;W=C(J(W,-1),R);V=J(C(V,R),0);var d=C(W,V),e=J(W,V),b=0,Y=d+(g?O:0),P=e+O-k,Z=J(d,0),f=J(e-Y,0),T=J(R-e,0);if(c.hasRendered){a.handle1Node.style[h]=W+X;a.handle2Node.style[h]=V+X;var M=a.lowerRange.style,U=a.thumbNode.style,Q=a.upperRange.style;M[h]=b+X;U[h]=Y+X;Q[h]=P+X;M[S]=Z+X;U[S]=f+X;Q[S]=T+X;}else{X+=";";h+=":";S+=":";c.handle1CssText=h+W+X;c.handel2CssText=h+V+X;c.lowerRangeCssText=S+Z+X;c.thumbCssText=h+Y+X+S+f+X;c.upperRangeCssText=h+P+X+S+T+X;}return{handle1:W,handle2:V};},updateSummary:function I(){var O=this.slider,T=O.items,M=O.include,U,R,Q="";if(O.multiSelect){U=B.keyarray(O.selectedIndices,true);R=U&&U.length||0;var N=mstrmojo.desc(2058,"All");try{var P=O.parent.node.data.del.elem;if(P.v===mstrmojo.elementHelper.ELEM_ALL_ID){N=P.n;}}catch(S){}if(R===0){Q=M?mstrmojo.desc(2057,"None"):N;}else{if(R===T.length){Q=N;}else{Q=(M?"":mstrmojo.desc(1099,"Not")+" ")+T[U[0]].n+(R>1?(" - "+T[U[R-1]].n):"");}}}else{U=O.selectedIndex;if(U>=0){Q=(M?"":mstrmojo.desc(1099,"Not")+" ")+T[U].n;}}O.summary.set("text",Q);},initialSlider:function G(){var N=this.slider,P=N.items,S=P.length,R,O,Q;if(S>0){if(N.multiSelect){var M=N.selectedIndices;O=B.min(M,false,true)||0;Q=B.max(M,false,true)||0;}else{O=0;Q=J(N.selectedIndex,0);}N.cs1Idx=O;R=P[O];N.cs1Vl=R.v;N.cs1Nm=R.n;N.cs2Idx=Q;R=P[Q];N.cs2Vl=R.v;N.cs2Nm=R.n;N.set("lowText",P[0].n);N.set("highText",P[S-1].n);}N.include=N.parent.include;N.unit=this.getUnit();},updateSelection:function F(){var N=this.slider,P=N.items,O=N.cs1Idx,T=N.cs2Idx,R=C(O,T),M=J(O,T),S={},Q;if(N.multiSelect){for(Q=R;Q<=M;Q++){if(P[Q]){S[Q]=true;}}N.selectedIndices=S;}else{N.selectedIndex=T;}},notNull:function(){var M=function(O){return O===undefined||O===null;},N;for(N=0;N<arguments.length;N++){if(M(arguments[N])){return false;}}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.array");var H=mstrmojo,F=H.array,A="00000000000000000000000000000000",E=-1;function J(K){return K.t===4&&K.id!==A;}function G(L){var K,M=(L&&L.length)||0;if(M===0){return false;}for(K=0;K<M;K++){if(!J(L[K])){return false;}}return true;}mstrmojo.VisProps=null;mstrmojo.vi.viz.DropZoneHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.viz.DropZoneHelper",getXml:function B(){return"";},setData:function I(K){},isMetric:function(K){return J(K);},isMetricZone:function(K){return G(K);},getMetricCountInZone:function D(L){var K=0;F.forEach(L,function(M){if(J(M)){K++;}});return K;}});mstrmojo.vi.viz.DropZoneHelper.METRIC_NAMES_ID=A;mstrmojo.vi.viz.DropZoneHelper.isMetricNames=function C(K){return(parseInt(K.did,10)===E)||(K.id===A)||(K.did===A);};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.QueuedXHR");var F=mstrmojo.hash;function J(K,L){return function(){if(K[L]){K[L]();}};}var B=[];function H(L){var K;switch(L.cacheLevel){case mstrmojo.AjaxCall.CACHELEVEL_LOCAL:if(L._cache==null){L._cache=[];}K=L._cache;break;default:if(B==null){B=[];}K=B;break;}return K;}function E(N){var M=H(N);var P={cache:M,idx:-1},O=N.params;if("xts" in O){delete O.xts;}for(var L=0,K=M.length;L<K;L++){var Q=M[L];if(Q&&F.equals(Q.url,N.url)&&F.equals(Q.params,O)){P.idx=L;break;}}return P;}function C(L){var K=H(L),M=F.copy(L.params);delete M.xts;K.push({url:L.url,params:M,res:F.copy(L.response)});}function D(K){var L=E(K);if(L&&L.idx>=0){K.response=L.cache[L.idx].res;return true;}return false;}mstrmojo.AjaxCall=mstrmojo.declare(mstrmojo.QueuedXHR,null,{scriptClass:"mstrmojo.AjaxCall",method:"POST",url:"",params:null,onsuccess:null,onerr:null,oncomplete:null,oncancel:null,readCache:false,writeCache:false,cacheLevel:"",_cache:null,useQueue:false,init:function I(K){this._super(K);F.copy(K,this);},send:function A(){var K=this;if(this.readCache&&D(this)){this.onsuccess();return ;}this.request(this.method,this.url,{success:function(){if(K.writeCache){C(K);}if(K&&K.onsuccess){K.onsuccess();}},failure:J(K,"onerr"),complete:J(K,"oncomplete")},this.params,!this.useQueue);},cancel:function G(){this._super();if(this.oncancel){this.oncancel();}}});mstrmojo.AjaxCall.CACHELEVEL_GLOBAL="global";mstrmojo.AjaxCall.CACHELEVEL_LOCAL="local";})();(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");if(F.params&&!F.params.sessionState&&mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){F.params.sessionState=mstrApp.sessionState;}H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){if(J.mstrerr){J.code=J.mstrerr.code;J.message=J.mstrerr.message;}E.response(G,true,J);},failure:function(J){E.response(G,false,{code:J.getResponseHeader("X-MSTR-TaskErrorCode"),message:J.getResponseHeader("X-MSTR-TaskFailureMsg")});},complete:function(){delete D[G];},textResponse:F.callback.textResponse},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.models.template.Titles","mstrmojo.models.template.MetricValue","mstrmojo.models.template.Headers","mstrmojo.models.datasets.DataInterface");var O=mstrmojo.array,U=mstrmojo.hash,D=mstrmojo.string,E=mstrmojo.models.datasets.DataInterface,g=D.decodeHtmlString;var G=-1,F=1,W=2,P=3;var N=1,H=2,c=3;function b(l){var m={};U.forEach(l,function(p,o){var n=[];O.forEach(p,function(q){n.push({fillColor:q.fillclr,text:q.n});});m[o]=n;});return m;}function k(o){var AA=this.getTotalRows(),q=this.data,u=[],w=q.gts.col[0],n=w?w.es:[],z=n.length,r=0;o=U.copy(o,{minAttribute:1,minMetric:1});if(AA<o.minAttribute||z<o.minMetric){throw"Error";}do{var m=this.getRowHeaders(r),p,l={},v=m.size();for(p=0;p<v;p++){while(p<v&&m.getHeader(p).getFormIndex()!==undefined){p++;}if(p<v){var t=m.getHeader(p);l[t.t.n]=t.getName();}}for(p=0;p<n.length;p++){var x=this.getMetricValue(r,p).value;l[n[p].n]={v:x.v,rv:x.rv};}u.push(l);r++;}while(r<AA);return u;}function K(m){var l=[],n=this.data.gts.row;O.forEach(n,function(p,o){O.forEach(m,function(q){if(p.id===q.id){l[o]=true;}});});return l;}function Q(AP){var w=this.getTotalRows(),AR=this.data,v=[],z=AR.gts.col[0],q=z?z.es:[],AG=q.length,u,AK=0;AP=U.copy(AP,{minAttribute:1,minMetric:1,colorByInfo:[],hasTitleName:false,hasSelection:false,needDecode:false});if(w<AP.minAttribute||AG<AP.minMetric){throw"Error";}var l=AP.needDecode,AM=AP.hasTitleName,AL=AP.hasSelection,AS=AP.hasThreshold,AE=AP.colorByInfo;var AQ=AS?b(AR.th):undefined;u=K.call(this,AE);do{var n=this.getRowHeaders(AK),p={},AI,AH=[],AO=AE.length,m={headers:[],values:[],colorInfo:[]};for(AI=0;AI<n.size();AI++){var AJ=n.getHeader(AI),AB=AJ.getName(),AU=AJ.t,t={name:l?g(AB):AB};if(AM){var AT=AU&&AU.n;t.tname=l?g(AT):AT;}if(AL){var AD=AU&&AU.id,x=AJ.getElementId();t.attributeSelector={n:AB,tid:AD,eid:x,isSelectAttr:true};p[AD]=[{n:AB,id:x}];}if(AO&&u[AI]===true){var AA=AJ.getElementId();AH.push(AA);}m.headers.push(t);}if(AO){m.colorInfo=AH;}for(AI=0;AI<q.length;AI++){var AF=this.getMetricValue(AK,AI).value,AN={v:AF.v,rv:AF.rv};if(AS){var r=AQ[AI],o=r&&r[AF.ti];if(o){AN.threshold=o;}}if(AM){var AC=this.getColTitles().titles[0].es[AI].n;AN.name=l?g(AC):AC;}m.values.push(AN);}if(AL){m.metricSelector=p;}v.push(m);AK++;}while(AK<w);return v;}function A(AF){var AI=this.data,p=this.getTotalRows(),q=AI.gts.col[0],n=q?q.es:[],u=n.length,v={},w=[],z,AA=0,x;AF=U.copy(AF,{minAttribute:1,minMetric:1,descKey:"name",childrenKey:"children",hasTitleName:false,hasSelection:false,needDecode:false,nestedLevel:undefined,colorByInfo:[]});if(p<AF.minAttribute||u<AF.minMetric){throw"Error";}var o=AF.descKey,r=AF.childrenKey,l=AF.needDecode,AC=AF.hasTitleName,AB=AF.hasSelection,m=AF.nestedLevel||0,AH=AF.hasThreshold,t=AF.colorByInfo,AD=t.length;var AG=AH?b(AI.th):undefined;v[o]="root";z=K.call(this,t);var AE=function(Aa,AK,AR,AT,AN){var AO=(Aa[r]=Aa[r]||[]),Ab=AK.getHeader(AR),Ad=Ab&&Ab.t,AY=Ad&&Ad.id,AW=Ab&&Ab.getName(),AS=AK&&AK.headers&&AK.headers.length||0,Ac,AV=Ab&&Ab.getElementId(),AJ=O.filterOne(AO,function(Af){return(Af._eid===AV);});Ac=O.some(z,function(Ag,Af){return Ag&&((AR-Af)%AS===0);});if(AD&&Ac){w.push(AV);}if(!AJ||(AR===m-1)){AJ={_eid:AV};var AQ=(Ab!==undefined);if(AQ){AJ[o]=l?g(AW):AW;}if(AC&&AQ){var Ae=Ad&&Ad.n;AJ.tname=l?g(Ae):Ae;}if(AB&&AQ){AJ.attributeSelector={n:AW,tid:AY,eid:AV,isSelectAttr:true};}AO.push(AJ);}if(AB&&AQ){AN[AY]=[{n:AW,id:AV}];}if(AR<AK.size()-1&&(!m||(AR<m-1))){AE.call(this,AJ,AK,AR+1,AT,AN);}else{var AU=this.getMetricValue(AT,0).value;if(AU){AJ.value=AU.rv;AJ.formattedValue=AU.v;}if(AD){AJ.colorInfo=w;w=[];}AJ.values=[];for(x=0;x<n.length;x++){var AZ=this.getMetricValue(AT,x).value,AL={v:AZ.v,rv:AZ.rv};if(AH){var AP=AG[x],AM=AP&&AP[AZ.ti];if(AM){AL.threshold=AM;}}if(AC){var AX=this.getColTitles().titles[0].es[x].n;AL[o]=l?g(AX):AX;}AJ.values.push(AL);}if(AB){AJ.metricSelector=AN;}}};do{AE.call(this,v,this.getRowHeaders(AA),0,AA,{});AA++;}while(AA<p);return v;}function C(l,m){var n=[];O.forEach((l.row||[]).concat(l.col||[]),function(o){if((o.id===m)&&(o.fs)){n=n.concat(o.fs);}});return n;}mstrmojo.models.template.DataInterface=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.models.template.DataInterface",data:null,init:function(l){this.data=l;},getRowTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:true});},getColTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:false});},getTotalRows:function V(){if(this.data.eg){return 0;}var n=this.data,m=n&&n.ghs,l=m&&m.rhs,o=l&&l.items;return(o&&o.length)||0;},getTotalColHeaderRows:function T(){var l=this.data.ghs.chs.items;return(l&&l.length)||0;},getTotalCols:function Y(){return this.getColHeaders(0).size();},getRowHeaders:function J(l){return new mstrmojo.models.template.Headers({data:this.data,i:l,isRow:true});},getColHeaders:function a(l){return new mstrmojo.models.template.Headers({data:this.data,i:l,isRow:false});},getMetricValue:function I(n,l){var m=this.data;return new mstrmojo.models.template.MetricValue({data:m,value:m.gvs.items&&m.gvs.items[n].items[l]});},getColumnHeaderCount:function M(){var l=this.data.gvs.items;return l?l[0].items.length:0;},getCSSString:function f(){return this.data.cssString;},isEmpty:function S(){var l=this.data.gsi;return !l||(!l.rows.length&&!l.cols.length&&!l.mx.length);},getAggregatePadding:function e(){var m=this.data.gsi&&this.data.gsi.fmts,n=function(p,o){return p+o;},l=function(p){var o=0;return["ch","rh","va"].map(function(q){var r=false;return p.map(function(t){if(m[q]&&m[q].hasOwnProperty(t)){if(!r){r=true;o++;}return m[q][t];}return 0;}).reduce(n)/p.length;}).reduce(n)/(o||1);};if(!m){return null;}return{v:l(["tp","bp"]),h:l(["rp","lp"])};},getColResizeScenario:function B(){var l=this.data;if(l.afw){return F;}else{if(l.afc===false){return P;}else{return W;}}},getColResizeInfo:function L(q){var r=this.data,o={v:this.getColResizeScenario(),widths:null};var t=r.gsi,m=r.gts||{},w=[],p=r.twm||{},u=p.top||[],v=p.bottom||[],n=0,l=function(z,x){if(t){t[z].every(function(AB){var AC=AB.did,AD=C(m,AC),AA=E.getFormsByAttrId(AC,q);(AD.length?AD:[]).forEach(function(AG,AF){var AH=AA[O.find(AA,"fid",AG.id)],AE=(v&&v[n])||{};w.push({n:AB.n+(AA.length?(" - "+AH.fnm):""),did:AC,depth:AF+1,t:AB.t||4,width:parseInt(AE.w||0,10),widthModel:{top:(u&&u[n])||{},bottom:AE}});n++;});return !x;});}};l("rows",false);l("mx",t.tma===1);o.widths=w;return o;},getRowResizeScenario:function R(){return !!this.data.rh?P:W;},getRowResizeInfo:function X(){var m=this.data,l=m.rh;return{v:this.getRowResizeScenario(),height:(l===undefined||l==="")?m.xrh:l};},getColumnHeaderData:function h(){var r=this.data,x=r.gts,w=r.gts.rec,z=[],m=[],u=x.row;O.forEach(u,function(AB){var AA=AB.fs,AC=AB.otp===G;if(AA&&AA.length>1){O.forEach(AA,function(){z.push(AB);});}else{z.push(AB);}if(AC){m=AB.es;}});var q=x.col;if(q&&q.length>0){var p=r.ghs,n=p.chs,l=n.items,v=l[l.length-1].items,o=function o(AA){var AB=AA.pi,AC=AB&&AB.ci,AD=AB&&AB.ri;if(AA.mix!==undefined){return AA;}if(AD===undefined||AC===undefined){return ;}return o(l[AD].items[AC]);};O.forEach(q,function(AA){var AB=AA.otp===G;if((AB&&(!w||u.length===0))){z.push(AA);}if(AB){m=AA.es;}});var t=z.length;O.forEach(v,function(AA){delete AA._ridx;});if(m.length>0){O.forEach(v,function(AD){var AA=o(AD);var AE=AA?AA.mix:(AD.pi?0:AD.idx),AC=m[AE]||m[0];var AB=AC._ridx=AC._ridx||[];if(AB.length===0){O.forEach(v,function(AG,AH){var AF=o(AG);if(!AA||AF.mix===AE){AB.push(t+AH);}});}z.push(AC);});}}else{if(m.length>0){z.push(m[0]);}}return z;},getUnitById:function Z(n){var m=this.data.gsi,l=null;[m.rows,m.cols,m.mx].some(function(o,p){if(p===2){p=-2;}o.some(function(q,r){if(q.did===n){l={axis:p+1,depth:r+1,unit:q};}return !!l;});return !!l;});return l;},getRawData:function d(l,m){switch(l){case H:return k.call(this,m);case c:return Q.call(this,m);}return A.call(this,m);}});mstrmojo.models.template.DataInterface.inflateGridData=function(n){var o=n.gvs,m=n.ghs;if(n.egt===undefined&&(n.eg===undefined||n.eg===null)&&!!o&&U.isEmpty(o)){var l={v:"",rv:""},p={items:(m.chs.cws||[0]).map(function(){return l;})};o.items=m.rhs.items?m.rhs.items.map(function(){return p;}):[];o.show=true;}};mstrmojo.models.template.DataInterface.ENUM_GRID_RESIZE={FIT_TO_WINDOW:F,FIT_TO_CONTENTS:W,FIXED:P};mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT={TREE:N,ROWS:H,ROWS_ADV:c};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var C=mstrmojo.dom,B=C.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function A(E,I,D){var G=(E&&E.tree)||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}return true;}},mstrmojo.hash.copy(mstrmojo.ListSelector)));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom;mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function B(F,I,E){if(A.isPrimaryMouseBtn(E.e)){var D=E.hWin,H=E.e,G=A.eventTarget(D,H),C=F.listMapper.findIndex(F,I,G);if(C>-1){F.toggleSelect(C);}}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dnd");var N=mstrmojo.hash,b=mstrmojo.array.fnReduceNumber;mstrmojo.vi.ui.BoxLayoutType=null;var X="c";var c="b";var P="h";var u="v";var O="|";function I(v){mstrmojo.all[this.hostId].buildBoxLayout(v);}function R(w){w=w||"";var v=w.split(O);return{target:parseInt(v.pop(),10),parentPathArray:v,parentPath:v.join(O)};}function B(z,w){if(!z){return undefined;}w=w||this.box;var x=R(z),v=w;x.parentPathArray.forEach(function(AB){v=v.children[AB];});var AA=function(AC,AG,AE){var AI=AG.children,AB=AI[AC],AH=function(AM,AK,AL){if(AM.t===X){return mstrmojo.all[AM.id].getMinBoxSize(AG.o)+(AL?this.padding:0);}var AJ=AM.children.map(function(AN){return AH(AN,AK,AL);});if(AM.o===AK){return AJ.reduce(b);}return Math.max.apply(null,AJ);}.bind(this),AF=function(AK,AM,AJ,AL){return AK.map(function(AO,AN){return AA(AN+AM,AJ||AG,parseInt(AL)===0?0:(AL||AE));});},AD=function(AK){var AJ=[0,AC];if(AK){AJ=[AC+1];}return AF(Array.prototype.slice.apply(AI,AJ),AK?AC+1:0);};return{idx:AC,path:(AE||parseInt(AE)===0)?(AE+O+AC):AC,parent:AG,parentPath:AE,siblings:AI,box:AB,getBoxLength:function(){return AB[AG.o==="v"?"h":"w"];},getSiblings:function(){return AF(AI,0);},getPreviousSiblings:function(){return AD();},getNextSiblings:function(){return AD(true);},getMinimumBoxSize:function(AJ,AK){return AH(AB,AJ,AK);},getChildren:function(){return AF(AB.children||[],0,AB,this.path);}};}.bind(this);return AA(x.target,v,x.parentPath);}function M(x,w){var v=mstrmojo.all[x].getBoxConfiguration().f;return v&&v[w];}function D(v){return v.filter(function(w){return !w.f;});}function V(v){return !v.some(function(w){return !w.f;});}function d(AB,v,AA){if(AB.length){var x=AA?0:v,z=AA?v:0,w=AB[0];AB.forEach(function(AD){var AC=Math.round((AD.l/(100-x))*v);AD.l+=AA?-AC:AC;z+=AD.l;w=AD;});w.l+=100-z;}}function g(x,w){var v=D(x);w=w||Math.round(100/(v.length+1));d(v,w,true);return w;}function E(w,v){d(D(w),v);}function F(v){return !v.children.some(function(w){if(w.t===X){return !mstrmojo.all[w.id].getBoxConfiguration().f;}return !F(w);});}function m(AB,x){var z=AB.children,w=z.reduce(function(AC,AD){return AD.l+AC;},0);z.forEach(function(AC){delete AC.f;AC.l=Math.round((AC.l/w)*100);});if(AB!==this.box){AB.f=true;AB.l=AB[AB.o==="h"?"h":"w"];if(x){var v=B.call(this,x),AA=v.box;if(V(AA.children)){m.call(this,AA,v.parentPath);}}}}function e(AB,w){var AE=AB.children,v=0;AE.filter(function(AF){return AF.t===X;}).forEach(function(AF){v+=AF.l;AF.f=true;AF.l=M(AF.id,AB.o);});D(AE).forEach(function(AF){AF.l=Math.round(AF.l*(100/v));});var AC=this.box;if(AB!==AC){var AA=w&&B.call(this,w),z=(AA&&AA.box)||AC;if(F(z)){e.call(this,z,AA&&AA.parentPath);return ;}var x=z.children,AD=x.indexOf(AB);delete AB.f;x.splice(AD,1);AB.l=g(x);x.splice(AD,0,AB);}}function q(v){if(typeof v!=="string"){return undefined;}return parseInt(v,10);}function f(v,z){var w=false;var x=q(v);if(x!==undefined){v=x;w=true;}return{f:w,l:v===undefined?100:v,r:!!z};}function G(v,AD,z,AA){var AC=this.identifier,w=this.box,x=w.children,AE={t:X,f:false,l:100,id:v.id},AB=J(AA);AE[AC]=v[AC];if(F(w)){if(AD){AD=0;}else{e.call(this,w);}}AE.f=!!AD;if(z){if(z===w.o){AE.l=AD||g(x);AB(x,AE);}else{L.call(this,z,AE,AB,AD);}}else{AE.l=AD||g(x);AB(x,AE);}Y.call(this,"addRootChild");}var k=false;function Y(v){if(k){console.log(JSON.stringify({t:v,cfg:this.box}));}}function L(AA,AC,z,AB){var AD=this.getNewRootBox(AA===u),w=this.box,x=w.children,v=x.length>1?w:x[0];AC.l=AB||50;v.l=AB?100:50;AD.children=z([v],AC);this.box=AD;}function J(v){return function(w,x){if(!!v){w.push(x);}else{w.splice(0,0,x);}return w;};}mstrmojo.vi.ui.BoxLayoutConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.BoxLayoutConfig",identifier:"k",padding:4,hostId:"",box:null,boxPaths:null,init:function p(v){N.copy(v,this);},validateBoxLayout:function C(v,w){w=w||this.box;var AA=this.identifier,x=function(AD){var AC=AD.children,AE=AC.filter(function(AF){return AF.t===c;});var AB=AC.length;if(AB===AE.length&&AB===1){return false;}return AE.map(x).reduce(function(AF,AG){return AF&&AG;},true);},z=function(){var AC=v.map(function(AE){return AE[AA];}),AD=function(AF){var AE=[];AF.children.forEach(function(AG){if(AG.t===c){AE=AE.concat(AD(AG));}else{AE.push(AG[AA]);}});return AE;},AB=AD(w);return(AB.length===AC.length)&&AC.every(function(AE){return AB.indexOf(AE)>-1;});}.bind(this);return x(w)&&z();},useDefaultBox:function(z,AC){var x=this.identifier,w=Math.round(100/z.length),AA=this.getNewRootBox(),v=0,AB=null;AA.children=z.map(function(AJ,AG){var AE={t:X},AF=w,AH=false;if(AC){AF=AC[AG];var AI=q(AF);if(AI!==undefined){AF=AI;AH=true;}}if(!AH){v+=AF;AB=AE;}AE.l=AF;AE.f=AH;AE[x]=AJ[x];return AE;});if(AB){var AD=100-v;if(AD){AB.l+=AD;}}this.box=AA;return AA;},getNewRootBox:function S(v){return{t:c,o:v?u:P,children:[]};},addNewChild:function T(x,w,AA,z){var v=f(w,z);v.t=X;v[this.identifier]=AA;x.children.push(v);},getBoxState:function a(){return JSON.parse(JSON.stringify(this.box));},getResizeBoundaries:function r(AA,x){var w={min:0,max:0},v=function(AC,AB){if(!AB){return ;}AB.getPreviousSiblings().forEach(function(AD){w.min+=AD.getMinimumBoxSize(x,true);});AB.getNextSiblings().forEach(function(AD){w.max+=AD.getMinimumBoxSize(x,true);});AC.pop();AC.pop();v(AC,B.call(this,AC.join(O)));}.bind(this);var z=B.call(this,AA);w.min+=z.getMinimumBoxSize(x,true)-this.padding;v(AA.split(O),z);return w;},resizeBox:function o(AA,AB){var v=0,AC=1,z=2,x=function(AF,AJ,AH,AI){var AG=Math.abs(AH);AH=-AG;AF.forEach(function(AM){var AN=AM.getBoxLength(),AK=0;if(AH){var AL=Math.max(AN+AH,AM.getMinimumBoxSize(AM.parent.o,false));AK=AN-AL;AH+=AK;AN=AL;}AI.push({idx:AM.idx,l:AN,f:AM.box.f,d:-AK});});AJ.forEach(function(AM,AL){var AN=AM.getBoxLength(),AK=0;if(!AL){AK=AG;AN+=AG;}AI.push({idx:AM.idx,l:AN,f:AM.box.f,d:AK});});return AH;},w=function(AG,AF,AH){var AJ=B.call(this,AG),AK=AJ.getPreviousSiblings().concat(AJ),AI=AK,AL=AJ.getNextSiblings();AK.reverse();if(AF>=0){AI=AL;AL=AK;}return x(AI,AL,AF,AH);},AD=function(AG,AF){return function(AI,AH,AJ){var AL=B.call(this,AI),AM=AL.getSiblings(),AK=AM,AN=[];if(AG){AM.reverse();}if(AF){AK=[];AN=AM;}return x(AK,AN,AH,AJ);};},AE=function(AI,AL,AK,AF){var AH=B.call(this,AI),AQ=AH.idx,AN=AH.getSiblings(),AJ=[],AO=AK.call(this,AI,AL,AJ);var AG=AJ.filter(function(AR){return !AR.f;}),AM=AG.map(function(AR){return AR.l;}).reduce(b,0);AG.forEach(function(AR){AR.l=(AR.l/AM)*100;});AJ.forEach(function(AT){var AV=AT.idx,AS=AN[AV],AR=AT.d;if(AR!==0&&(AF!==z||AV!==AQ)){var AU=AD(AV<AQ,AR>0);AS.getChildren().forEach(function(AW){if(AW.box.t===c){AE(AW.path+O+"0",AR,AU,AC);}});}AS.box.l=AT.l;});if(AF!==AC&&AO){var AP=AI.split(O);AP.pop();AP.pop();if(AP.length){AE(AP.join(O),AL<0?AO:-AO,w,z);}}}.bind(this);AE(AA,AB,w,v);},insertNewRootChild:function t(z,x){var v=z.getBoxConfiguration(),w=v.o,AA=v.addToEnd;if(x){w=x==="Left"||x==="Right"?"h":"v";AA=x==="Right"||x==="Bottom";}G.call(this,z,(v.f&&v.f[w])||0,w,AA);},insertExistingRootChild:function Q(AA,AB){var w=AA.src.widget,z=AA.box.oldPathInfo,v=w.getBoxConfiguration(),x=AB==="Left"||AB==="Right"?"h":"v",AC=(v.f&&v.f[x])||0;if(AC&&z.parent.o===x){AC=z.box.l;}G.call(this,w,AC,x,AB==="Right"||AB==="Bottom");AA.dropSuccessful=true;},getBoxOrientation:function K(w){var v=B.call(this,w);return v&&v.parent&&v.parent.o;},getBoxPath:function h(v){return this.boxPaths[v[this.identifier]];},deleteBox:function W(v,AK){var AJ=B.call(this,this.getBoxPath(v)),AG=AJ.box,AL=AJ.idx,x=AJ.parent,AB=AJ.parentPath,AE=B.call(this,AB),AC=AJ.siblings;AC.splice(AL,1);if(AC.length>1){if(V(AC)){m.call(this,x,AB);}else{if(!AG.f){E(AC,AG.l);}}}else{var AM=AC[0],AA=AM&&(AM.t===c),AN=AM&&AM.f;if(AE){var AD=AE.parent,AI=F(AD),AF=[];if(AA){AF=AM.children;if(AI){e.call(this,AD,R(AD.parentPath).parentPath);}if(AN){AF.forEach(function(AO){AO.f=true;AO.l=Math.round((AO.l/100)*AM.ps);});}else{D(AF).forEach(function(AO){AO.l=Math.round((AO.l/100)*x.l);});}}else{AF.push(AM);var w=M(AM.id,AD.o);if(!AI&&w){AN=AM.f=true;}if(AN){AM.l=w;}else{AM.l=x.l;}}var AH=AD.children;AH.splice.apply(AH,[AE.idx,1].concat(AF));}else{var z=this.box;if(AA){z.children=AM.children;z.o=AM.o;if(AN){m.call(this,z);}}else{if(AM){delete AM.f;AM.l=100;}}}}Y.call(this,"delete");if(!AK){I.call(this,true);}else{mstrmojo.all[this.hostId].updateBoxPaths();}},beginBoxMove:function U(w,z,x){var AA=B.call(this,this.getBoxPath(z)),v=AA.box;w.box={initState:this.getBoxState(),oldPathInfo:AA,boxId:z.id,parentPath:AA.parentPath,length:v.l,orientation:AA.parent.o};if(!x){this.deleteBox(z);}},addDropBox:function A(AG,AF,AC){var AE=(AF==="Right"||AF==="Bottom"),AI=(AF==="Top"||AF==="Bottom")?u:P,AW=this.identifier,AB=B.call(this,this.getBoxPath(AG)),AJ=AB.idx,AM=AB.parent,AP=AB.siblings,AS=AB.parentPath,AT=F(AM),AL=AM.f,x=AC.box,z=x.boxId,AU=mstrmojo.all[z],AO=AU.getBoxConfiguration(),AV=AO.f&&AO.f[AI],AA=AU.getMinBoxSize(AI),AN=M(AG.id,AI),AQ=AG.getMinBoxSize(AI),v=x.length,w={t:X,f:!!AV,l:AV,id:z,r:!!AO.r};w[AW]=AU[AW];if(AV&&x.orientation===AI){AV=v;}if(!AV&&AT){e.call(this,AM,R(AS).parentPath);AL=false;}if(AI===AM.o){if(AV){if(AT){delete w.f;AV=undefined;}}if(AS!==x.parentPath){v=undefined;}w.l=AV||g(AP,v);AP.splice(AE?AJ+1:AJ,0,w);}else{if(AM===this.box&&AP.length===1){L.call(this,AI,w,J(AE),AV);}else{var AR=AB.box,AH=AR.f;var AK={l:AR.l,f:AH,o:AI,t:c};var AD=AK.children=[w,AR];AP.splice(AJ,1);if(AE){AD.reverse();}if(AL){if(AV){AM.l=Math.max(AM.l,AV+AN);w.l=AR.l=50;delete w.f;}else{w.l=100;AR.l=AN;AM.l=Math.max(AM.l,AA+AN);}}else{if(AV&&AH){AK.h=AR.h;AK.w=AR.w;w.l=AV;AR.l=AN;m.call(this,AK,AS);}else{if(AV){w.l=AV;AR.l=100;}else{if(AN){AR.l=AN;w.l=100;if(!AK.f){AK.l=g(AP,null);}}else{AR.f=false;AR.l=100;w.l=g([AR]);}}}}AP.splice(AJ,0,AK);}}AU.postDropBox();Y.call(this,"drop");I.call(this);AC.dropSuccessful=true;},cancelBoxMove:function Z(v){this.revertBoxState(v.box.initState);},revertBoxState:function l(v){this.box=v;I.call(this);},getBoxChildClass:function H(v){var x=v.id,w=x&&mstrmojo.all[x];if(w){return w.scriptClass;}return"";},replaceLayoutXmlKeys:function n(x){var w=false;var v=function(AE){if(!AE){return ;}var AA=AE.children,z=AA&&AA.length,AB;for(AB=0;z&&AB<z;AB++){var AC=AA[AB];switch(AC.t){case c:v(AC);break;case X:var AD=x[AC.k]||x["default"];if(AD){AC.k=AD;w=true;}break;}}};v(this.box);return w;}});mstrmojo.vi.ui.BoxLayoutConfig.getMinimumChildSizes=function(x,z,AA){var w=AA.getBoxChildClass(x);if(!w){throw"BoxLayoutConfig::getMinimumChildSizes - unable to obtain script class for box.";}var v=mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums(w);if(x.f){v[z]=x.l;}return v;};mstrmojo.vi.ui.BoxLayoutConfig.BoxInfoType=null;mstrmojo.vi.ui.BoxLayoutConfig.BoxAddContextType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var E=mstrmojo.dom;function B(I){return E.contains(this.getMovingHandle(),I.src.node,true,document.body);}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function G(){return this.domNode;},getMovingTarget:function H(){return this.domNode;},isDragValid:function A(I){return B.call(this,I)||(this._super&&this._super(I))||false;},ondragstart:function C(J){if(B.call(this,J)){var K=this.getMovingHandle(),I=this.getMovingTarget().style;this._leftPos=parseInt(I.left,10);this._topPos=parseInt(I.top,10);this._hWidth=K.clientWidth;this._hHeight=K.clientHeight;}if(this._super){this._super();}},ondragmove:function F(L){if(B.call(this,L)){var M=L.tgt.pos,J=L.src.pos,K=this.getMovingTarget().style,I=E.windowDim();K.left=this.left=Math.min(Math.max(this._leftPos+M.x-J.x,-this._hWidth+40),I.w-40)+"px";K.top=this.top=Math.min(Math.max(this._topPos+M.y-J.y,-this._hHeight+20),I.h-20)+"px";}if(this._super){this._super();}},ondragend:function D(I){if(B.call(this,I)){delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.form");var DOM=mstrmojo.dom;var FORM=mstrmojo.form;function findChildWithAtt(el,tagName,att,value){var nodes=el.getElementsByTagName(tagName);var found=mstrmojo.array.filter(nodes,function(node){return node.getAttribute(att)===value;});return found[0];}function uploadDashboardFile(formId){var form=document.getElementById(formId),myFileInput=findChildWithAtt(form,"input","name","myFile"),file=myFileInput.value,resetFileInput=function(){if(DOM.isIE){var fm=document.createElement("form");myFileInput.parentNode.insertBefore(fm,myFileInput);fm.appendChild(myFileInput);fm.reset();fm.removeNode(false);}};if(file===""){return ;}else{if(/\.mstr$/.test(file.toLowerCase())){mstrApp.showWait(true);FORM.addURLAsHiddenInputsToForm(form,mstrmojo.addCSRFTokenToURL(mstrApp.name+"="+encodeURIComponent(mstrApp.servletState)));if(mstrApp.currentFolderId){var folderIDInput=document.getElementById("import_folderID");folderIDInput.value=mstrApp.currentFolderId;}if(!findChildWithAtt(form,"input","name","formId")){var formInput=document.createElement("input");formInput.type="hidden";formInput.name="formId";formInput.value=form.id;form.appendChild(formInput);}form.submit();form.reset();}else{mstrmojo.alert(mstrmojo.desc(11227),null,mstrmojo.desc(11226));}}resetFileInput();}function uploadCallback(res){var success=res.status===200,resContent=res.content,sn=mstrApp.name,updateAndSubmitForm=function(params){mstrApp.showWait();var form=document.getElementById(resContent.formId||"import_form"),newInputsAdded=[],i=0,formInput;mstrmojo.hash.forEach(params,function(value,key){if(key==="folderId"){if(DOM.isIE8){var folder_id=document.getElementById("import_folderID");if(folder_id){folder_id.value=value;}}}else{formInput=document.createElement("input");formInput.type="hidden";formInput.name=key;formInput.value=value;form.appendChild(formInput);newInputsAdded[i++]=formInput;}});window.setTimeout(function(){form.submit();for(var i=0;i<newInputsAdded.length;i++){form.removeChild(newInputsAdded[i]);}},0);};if(resContent&&resContent.messageID){var folderId=(resContent.fdid?resContent.fdid:"");if(resContent.isConflict){var replaceFn=function(){updateAndSubmitForm({messageID:resContent.messageID,resume:true});},saveAsFn=function(){var renameEditor=mstrmojo.insert({scriptClass:"mstrmojo.ui.editors.RenameEditor",renameText:resContent.n,title:mstrmojo.desc(13052,"Upload"),zIndex:1002,onRename:function(newName){if(mstrmojo.string.isEmpty(newName)){mstrmojo.alert("Please enter a valid name",null,null,1004);return false;}else{updateAndSubmitForm({messageID:resContent.messageID,resume:true,dashboardName:newName});var conflictDialog=mstrmojo.all.ImportNameConflictDialog;if(conflictDialog){conflictDialog.destroy();}}}});renameEditor.open();return false;},closeFn=function(){mstrApp.hideWait();};closeFn();mstrmojo.confirm(mstrmojo.desc(8134,"The Dashboard ## already exists. Do you want to replace the existing Dashboard?").replace("##",("<strong>"+resContent.n+"</strong>")),null,{id:"ImportNameConflictDialog",title:mstrmojo.desc(13052,"Upload"),allowHTML:true,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(219,"Yes"),replaceFn,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3167,"Save As"),saveAsFn,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),closeFn)],onPreClose:function(){closeFn();return true;}});}else{updateAndSubmitForm({messageID:resContent.messageID,folderId:folderId});}}else{if(success){var okUrl=mstrmojo.addCSRFTokenToURL(sn+"?evt=2001&src="+sn+".2001"+((resContent&&resContent.fdid)?("&folderID="+resContent.fdid):"&systemFolder=20")),dashboarUrl=getExecuteDashboardUrl(resContent.did),closeAndLoadUrl=function(url){if(this.parent===null&&this.close){this.close();}else{this.parent.parent.close();}if(url){eval(url);}},viewDashboardFn=mstrmojo.emptyFn,shareDashboardFn=function(){mstrmojo.mstr._ObjectActions.openSharingEditor(resContent.servletPath+dashboarUrl,{objectName:resContent.n,objId:resContent.did,objType:"55",mid:-1},false,{showLinkOnOpen:true});};if(!mstrmojo.resolveFeature("flashvi")&&(DOM.isIE8)){viewDashboardFn=function(){closeAndLoadUrl.call(this);mstrmojo.alert(mstrmojo.desc(12187));};}else{viewDashboardFn=function(){closeAndLoadUrl.call(this,"location.href = '"+dashboarUrl+"'");};}var currentFolderName=mstrApp.currentFolderName&&mstrApp.currentFolderName();var uploadResultEditor=mstrmojo.insert({scriptClass:"mstrmojo.onetier.vi.ui.UploadResultEditor",folderName:currentFolderName||"My Reports",dashboardName:resContent.n,okFn:function(){closeAndLoadUrl.call(this,currentFolderName&&"location.href = '"+okUrl+"'");},viewDashboardFn:viewDashboardFn,shareDashboardFn:shareDashboardFn});uploadResultEditor.open();}else{mstrmojo.error({longDesc:res.errorMsg});}mstrApp.hideWait(true);}}function getExecuteDashboardUrl(documentId){var servletName=mstrApp.name,eventId,params;if(mstrmojo.resolveFeature("flashvi")){eventId=2048001;params={visMode:0};}else{eventId=3140;params={};}params.documentID=documentId;params.evt=eventId;params.src=servletName+"."+eventId;var paramArray=[];for(var k in params){if(!params.hasOwnProperty(k)){continue;}paramArray.push(encodeURIComponent(k)+"="+encodeURIComponent(params[k]));}return mstrmojo.addCSRFTokenToURL(servletName+"?"+paramArray.join("&"));}mstrmojo.mstr.ui.MstrFileUploadHelper={uploadDashboardFile:uploadDashboardFile,uploadCallback:uploadCallback};}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;this.preHandleEvent(H);var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){this.postHandleEvent(H);C.publish(this.id,M,H);}return H;},preHandleEvent:mstrmojo.emptyFn,postHandleEvent:mstrmojo.emptyFn,attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.hash");var M=mstrmojo.string,L=mstrmojo.hash,E=mstrmojo.dom;var R=mstrmojo.usesFrames?null:document.createElement("span");var J=/mstrAttach:([\w,]+)/g;var Q;function U(a){if(Q===undefined){Q=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return a.replace(J,function Z(g,k){var c=k.split(","),d=[],b=c.length,f;for(f=0;f<b;f++){var h=c[f];if(h){if(Q){if(h.indexOf("mouse")>-1){continue;}else{if(h==="click"){h="touchend";}}}d.push("on"+h+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+h+"', self, event)\"");}}return d.join(" ");});}var N="preBuildRendering",C="buildRendering",B="postBuildRendering";function X(b){var a=b.markupString;if(a.match(/mstrAttach:/)){a=U(a);if(b.markupString===b.constructor.prototype.markupString){b.constructor.prototype.markupString=a;}}var Z=M.apply(a,b);if(Z){if(mstrmojo.usesFrames){var c=(b.domNode&&b.domNode.ownerDocument)||window.document;if(!R||R.ownerDocument!==c){R=c.createElement("span");}}R.innerHTML=Z;var e=R.removeChild(R.firstChild);e.mstrmojoId=b.id;return e;}return null;}function A(b){var a=b.markupSlots,Z,c;if(a){Z={};for(c in a){Z[c]=a[c].call(b);}}return Z;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{markupString:null,markupMethods:null,markupSlots:null,onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function Y(){if((this[N]&&this[N]()===false)||(this[C]()===false)||(this[B]&&this[B]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var Z="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,Z)){this.raiseEvent({name:Z});}return true;},buildDom:function T(){return X(this);},postBuildDom:null,preBuildRendering:mstrmojo.emptyFn,buildRendering:function F(){var Z=this.domNode,a=this.buildDom();this.domNode=a;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(A(this));this.paint();if(a){var d=Z;if(!d){d=this.placeholder;if(d){if(typeof d==="string"){d=document.getElementById(d);}delete this.placeholder;}}if(d){E.replace(d,a);}}var b="onchildRenderingChange",c=this.parent;if(c&&c[b]){c[b](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function S(b){if(this.hasRendered){if(!b){try{var Z=this.domNode;if(Z.parentNode){Z.parentNode.removeChild(Z);}if(mstrmojo.dom.isIE&&Z.outerHTML!=="undefined"){Z.outerHTML="";}}catch(a){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function K(){var a=this.markupMethods;if(!a){return ;}var d=this,e=function(k){var h=a[k];if(h){try{h.apply(d,[true]);}catch(g){throw new Error(["Error in markup method.","Script class: "+d.scriptClass,"Widget id: "+d.id,"Method name: "+k,"Err: "+g.message].join("\n\n"));}}};var c=a.sequence,Z,b,f;if(c){Z=c.length||0;for(b=0;b<Z;b++){e(c[b]);}}else{for(f in a){e(f);}}},redraw:function P(){return false;},refresh:function D(Z){if(this.hasRendered){if(this.redraw()!==true){var a=this.domNode;this.unrender(true);this.placeholder=a;if(Z){Z();}this.render();}}},set:function I(c,Z){this._super(c,Z);if(this.domNode){var a=this.markupMethods,b=a&&a["on"+c+"Change"];if(b){b.apply(this);}}return this;},slotNames:null,addSlots:function G(a){var Z=this.slotNames,b;if(!Z){Z={};this.slotNames=Z;}for(b in a){this[b]=a[b];Z[b]=true;}},removeSlots:function H(Z){if(Z){var a=this.slotNames,b;for(b in Z){delete this[b];if(a){delete a[b];}}}},captureDomEvent:function W(b,Z,c,a){if(this.enabled!==false){this.raiseEvent(mstrmojo._HasMarkup.newDomEvent(b,Z,c||Z.event,a));}},playEffect:function V(a){var Z=this[a];if(Z&&Z.constructor===Object){Z=mstrmojo.insert(mstrmojo.hash.clone(Z));Z.widget=this;this[a]=Z;}if(Z){Z.play();}}});mstrmojo._HasMarkup.addMarkupMethods=function O(a,Z){a.prototype.markupMethods=L.copy(Z,L.copy(a.prototype.markupMethods));};mstrmojo._HasMarkup.MSTRDomEventType=null;mstrmojo._HasMarkup.newDomEvent=function(c,Z,b,a){return{name:c,hWin:Z,e:b,config:a,ctrlKey:E.ctrlKey(Z,b),shiftKey:E.shiftKey(Z,b),metaKey:E.isMetaKey(Z,b),cancel:function(){E.stopPropogation(Z,b);},preventDefault:function(){E.preventDefault(Z,b);},getTarget:function(){return E.eventTarget(Z,b);}};};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var T=mstrmojo.dom,K=mstrmojo.string,X=mstrmojo.array;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:T.isNSIE?"block":"table",DISPLAY_CELL:T.isNSIE?"block":"table-cell",MINHEIGHT:T.isIE6?"height":"minHeight",addClass:function L(e,d){if(e){if(d.constructor!==Array){d=[d];}var Z=e.className||"",g=" "+Z+" ",a=false,Y=d.length,b;for(b=0;b<Y;b++){var f=d[b];if(!g.match(new RegExp("\\s"+f+"\\s"))){Z+=" "+f;a=true;}}if(a){e.className=K.trim(Z);}}return e;},removeClass:function N(c,b){if(!c){return ;}if(b.constructor!==Array){b=[b];}var Z=" "+(c.className||"")+" ",Y=b.length,a;for(a=0;a<Y;a++){Z=Z.replace(new RegExp("\\s"+b[a]+"\\s","g")," ");}c.className=K.trim(Z);},addWidgetCssClass:function M(d,b){var Z=d.cssClass,c=(Z&&Z.split(" "))||[],a;b=[].concat(b);for(a=0;a<b.length;a++){var Y=b[a];if(X.indexOf(c,Y)===-1){c.push(Y);}}d.cssClass=c.join(" ");},removeWidgetCssClass:function F(e,c){var Z=e.cssClass,d=(Z&&Z.split(" "))||[],b;c=[].concat(c);for(b=0;b<c.length;b++){var Y=c[b];var a=X.indexOf(d,Y);if(a!==-1){d.splice(a,1);}}e.cssClass=d.join(" ");},toggleClass:function S(a,Z,Y){if(Y){this.addClass(a,Z);}else{this.removeClass(a,Z);}},applyShadow:function G(c,d,b,a,Y){var Z=c.style;if(T.isDXIE){Z.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+d+"px, OffY="+b+"px, Color='"+Y+"')";}else{if(T.isFF||T.isWK||T.isIE10){Z[T.CSS3_BOXSHADOW]=d+"px "+b+"px "+a+"px "+Y;}}},removeShadow:function B(Z){var Y=Z.style;if(T.isFF||T.isWK||T.isIE10){Y[T.CSS3_BOXSHADOW]="";}},setOpacity:function U(Z,b){if(T.isDXIE&&!T.isIE9){var c=Z.currentStyle.filter;var Y=null;if(c.length>0){Y=Z.filters["DXImageTransform.Microsoft.Alpha"];}if(Y){Y.opacity=b;Y.enabled=(b!==100);}else{if(b<100){var a="progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")";Z.style.filter=(c||"")+" "+a;}}}else{Z.style.opacity=b/100-(T.isIE9?0.00001:0);}},buildGradient:function O(Z,b,Y){if(T.supports(T.cssFeatures.GRADIENTS)){var a={};if(T.isDXIE){a.n="filter";a.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+Z+",StartColorStr='"+b+"',EndColorStr='"+Y+"')";}else{if(T.isFF){a.n="background-image";a.v="-moz-linear-gradient("+((Z===0)?"top":"left")+","+b+","+Y+")";}else{if(T.isWK){a.n="background";a.v="-webkit-gradient(linear,"+((Z===0)?"left top, left bottom":"left top, right top")+",from("+b+"),to("+Y+"))";}else{if(T.isIE10||T.isIEW3C){a.n="background";a.v="linear-gradient("+((Z===0)?"to bottom":"to right")+","+b+","+Y+")";}}}}return a;}return null;},buildRoundCorners:function Q(d,c){if(T.supports(T.cssFeatures.ROUND_CORNERS)){var Z=d+"px";var f=Z+(c?" "+Z+" 0 0":"")+";";if(T.isFF||T.isWinPhone||T.isIE10){return"border-radius:"+f;}if(T.isWK){if(!c){return"-webkit-border-radius:"+Z+";";}var e=["left","right"],b=[],Y=-1,a;for(a=0;a<2;a++){b[++Y]="-webkit-border-top-"+e[a]+"-radius:"+Z;b[++Y]="-webkit-border-bottom-"+e[a]+"-radius:0";}return b.join(";");}}return"";},getBorderWidthsOrPaddings:function D(Z,e){var f={t:0,r:0,b:0,l:0,h:0,w:0};if(!Z){return f;}var c=Z.split(" "),Y=c.length,d;for(d=0;d<Y;d++){c[d]=Math.round(e*parseFloat(c[d])/72);}if(Y<4){if(Y===1){c[1]=c[2]=c[3]=c[0];}else{c[3]=c[1];if(Y===2){c[2]=c[0];}}}f.t=c[0];f.r=c[1];f.b=c[2];f.l=c[3];f.h=f.t+f.b;f.w=f.l+f.r;return f;},getBorderWidths:function H(Z,Y){return this.getBorderWidthsOrPaddings(Z,Y);},getPaddings:function C(Z,Y){return this.getBorderWidthsOrPaddings(Z,Y);},parkAfterFade:function A(Y){var Z=Y.target.style;if(Z.opacity===0){Z.left="-10000px";window.setTimeout(function(){Z.opacity=0.99;},0);return true;}return false;},getStyleValue:function I(Y,c){var a=(c==="float"),b;if(Y.currentStyle){c=a?"styleFloat":c;b=Y.currentStyle[c];}else{if(document.defaultView&&document.defaultView.getComputedStyle){c=a?"cssFloat":c;var Z=document.defaultView.getComputedStyle(Y,null);b=Z?Z[c]:null;}}return b;},getComputedStyle:function R(Y,a){var Z=(window.getComputedStyle)?function(b,c){return window.getComputedStyle(b,c||null);}:function(b){return b.currentStyle||{};};mstrmojo.css.getComputedStyle=Z;return Z(Y,a);},getCssTextFromObj:function E(a){var Z="",Y;for(Y in a){Z+=Y+":"+a[Y]+";";}return Z;},onTransitionEnd:function W(a,Y){var Z="transition",b=window.Modernizr;if(b.testProp(Z)){T.attachOneTimeEvent(a,T.transEndEvtNames[b.prefixed(Z)],Y);}else{window.setTimeout(Y,0);}},flashClass:function P(Z,Y,b){this.toggleClass(Z,Y,true);var a=this;window.setTimeout(function(){a.toggleClass(Z,Y,false);},b);},convertCssToCamelCase:function J(Y){return Y.replace(/\-([a-z])/gi,function(Z,a){return a.toUpperCase();});},printCSSInfo:function V(c){var g=document.styleSheets,l=g.length,d,e;for(e=0;e<l;e++){var f=g[e],h=f.cssRules,a=h?h.length:0,k=0;for(d=0;d<a;d++){var Y=h[d].selectorText;if(Y){try{k+=Y.split(",").length;}catch(b){}}}var Z=f.href;if(!c||(Z&&X.indexOf(Z,c)>-1)){console.log("Stylesheet: "+Z||"Inline CSS Block");console.log("Total rules: "+a);console.log("Total selectors: "+k);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.string","mstrmojo.StringBuffer");mstrmojo._XMLNode=mstrmojo.declare(null,null,{nodeName:null,init:function N(O){mstrmojo.hash.copy(O,this);},addChild:function F(P){var O=new mstrmojo._XMLNode({nodeName:P});return this.appendNode(O);},appendNode:function J(O){if(O){if(!this.children){this.children=[];}this.children.push(O);O.parent=this;}return O;},addAttribute:function L(O,P){if(O!=null){if(!this.attributes){this.attributes={};}this.attributes[O]=P;}return this;},addText:function M(O){this._addToStringMember("text",O);return this;},addRawXML:function K(O){this._addToStringMember("rawXML",O);return this;},getXMLString:function I(){var O=new mstrmojo.StringBuffer();this.buildXMLString(O);return O.toString();},buildXMLString:function E(O){O=O||new mstrmojo.StringBuffer();O.append("<").append(this.nodeName).append(" ");this._buildAttributesXMLString(O).append(">").append(((this.text!=null)?this._escapeString(this.text):"")).append(((this.rawXML!=null)?this.rawXML:""));this._buildChildrenXMLString(O).append("</").append(this.nodeName).append(">");return O;},_buildAttributesXMLString:function D(O){var Q=this.attributes;if(Q){var R;for(R in Q){if(Q[R]!=null){var P=String(Q[R]);switch(R){case"et":case"nt":case"dmt":case"ddt":case"fnt":case"tp":case"stp":break;default:P=this._escapeString(P);}O.append(R+'="'+P+'" ');}}}return O;},_escapeString:function C(O){return mstrmojo.string.escape4HTMLText(O);},_buildChildrenXMLString:function H(P){var R=this.children;var O=R&&R.length;if(O){var Q;for(Q=0;Q<O;Q++){if(R[Q]&&R[Q].buildXMLString){R[Q].buildXMLString(P);}}}return P;},_addToStringMember:function A(O,Q){var P=this[O];if(P==null){this[O]=Q;}else{this[O]=P+Q;}}});mstrmojo.XMLBuilder=mstrmojo.declare(null,null,{root:null,curNode:null,addChild:function F(O){if(!this.root){this.currentNode=this.root=new mstrmojo._XMLNode({nodeName:O});}else{this.currentNode=this.currentNode.addChild(O);}return this;},appendNode:function J(O){if(!this.root){this.currentNode=this.root=O;}else{this.currentNode=this.currentNode.appendNode(O);}return this;},addAttribute:function L(O,P){if(this.currentNode){this.currentNode.addAttribute(O,P);}else{alert("no root node");}return this;},addText:function M(O){if(this.currentNode){this.currentNode.addText(O);}else{alert("no root node");}return this;},addRawXML:function K(O){if(this.currentNode){this.currentNode.addRawXML(O);}else{alert("no root node");}return this;},closeElement:function G(){this.currentNode=this.currentNode.parent;},toString:function B(){if(this.root){return this.root.getXMLString();}return"";}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.XMLBuilder");var B=mstrmojo.hash,G=mstrmojo.array,H="fromitem",D="toitem",E="edgecolorby",J="edgesizeby",C="nodesizeby";mstrmojo.vi.viz.NetworkVisualizationHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.NetworkVisualizationHelper",fromItemAttribute:null,toItemAttribute:null,edgeColorMetric:null,edgeSizeMetric:null,nodeSizeMetric:null,getNetworkMetrics:function(){return[this.nodeSizeMetric,this.edgeSizeMetric,this.edgeColorMetric].filter(function(K){return K!==null;});},getXml:function A(){var K=new mstrmojo.XMLBuilder(),L=function(R,P,Q){if(Q){K.addChild(R);K.addAttribute(P,Q.did);K.closeElement();}},N="value";K.addChild("props");K.addChild("widgetProps");K.addChild("fmt");var O=this.fromItemAttribute,M=this.toItemAttribute;L(H,N,this.fromItemAttribute);L(D,N,this.toItemAttribute);L(E,N,this.edgeColorMetric);L(J,N,this.edgeSizeMetric);L(C,N,this.nodeSizeMetric);K.closeElement();K.closeElement();K.closeElement();return K.toString();},setData:function I(M){if(!M){return ;}var K=this,L=function(N,O){if(N){var P=K[O];arr=N.TemplateUnit||N.TemplateMetric;if(arr){arr.forEach(function(Q){var R=B.copy(Q);if(!R.did){R.did=R.id;}if(P instanceof Array){P.push(R);}else{K[O]=R;}});}}};L(M[F.PROP_FROMITEM],"fromItemAttribute");L(M[F.PROP_TOITEM],"toItemAttribute");L(M[F.PROP_COLORBY],"edgeColorMetric");L(M[F.PROP_SIZEBY],"edgeSizeMetric");L(M[F.PROP_ITEMSIZE],"nodeSizeMetric");},getAddDropZonesAction:function(){var K=this,L={act:"updateTemplate",keyContext:this.node.k,actions:[]};[{n:"fromItemAttribute",zone:"FromItem"},{n:"toItemAttribute",zone:"ToItem"},{n:"edgeColorMetric",zone:"ColorBy",t:4},{n:"nodeSizeMetric",zone:"ItemSize",t:4},{n:"edgeSizeMetric",zone:"SizeBy",t:4}].forEach(function(M){var N=[].concat(K[M.n]||[]),O=mstrmojo.vi.viz.EnumDSSDropZones[M.zone];if(N&&N.length){N.forEach(function(P){L.actions.push({act:"addDropZoneUnit",zoneId:O,unitId:P.did,unitType:P.t});});}});return L;}});var F=mstrmojo.vi.viz.NetworkVisualizationHelper;F.PROP_FROMITEM="from";F.PROP_TOITEM="to";F.PROP_COLORBY="ColorBy";F.PROP_SIZEBY="SizeBy";F.PROP_ITEMSIZE="itemsz";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.XMLBuilder","mstrmojo.gm.GMEnums");var L=mstrmojo,F=L.hash,I=L.array,P=L.vi.viz,B=P.EnumDSSDropZones,A=1,H=0,D=P.DropZoneHelper.METRIC_NAMES_ID,O,E=mstrmojo.gm.DualAxisSubAxisBit,G=E.PRIMARY;mstrmojo.vi.viz.GraphMatrixHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.GraphMatrixHelper",handled:false,rowObjects:null,columnObjects:null,xAxisObjects:null,yAxisObjects:null,angleObjects:null,sliceObjects:null,breakByObjects:null,colorByObjects:null,currentXML:"",sizeByObjects:null,tooltipMetrics:null,data:null,metricsDropZone:"",secondaryMetricsDropZone:"",shape:"",subtype:"",metricShapes:null,visType:-1,init:function N(Q){this._super(Q);this.rowObjects=[];this.columnObjects=[];this.xAxisObjects=[];this.yAxisObjects=[];this.angleObjects=[];this.sliceObjects=[];this.breakByObjects=[];this.colorByObjects=[];this.sizeByObjects=[];this.tooltipMetrics=[];this.currentXML="";this.metricsDropZone="";this.secondaryMetricsDropZone="";this.shape="";this.subtype="";this.metricShapes="{}";},clone:function J(R){var Q=this;Q.rowObjects=R.rowObjects.concat();Q.columnObjects=R.columnObjects.concat();Q.xAxisObjects=R.xAxisObjects.concat();Q.yAxisObjects=R.yAxisObjects.concat();Q.angleObjects=R.angleObjects.concat();Q.sliceObjects=R.sliceObjects.concat();Q.breakByObjects=R.breakByObjects.concat();Q.colorByObjects=R.colorByObjects.concat();Q.sizeByObjects=R.sizeByObjects.concat();Q.tooltipMetrics=R.tooltipMetrics.concat();Q.currentXML=R.currentXML;Q.metricsDropZone=R.metricsDropZone;Q.secondaryMetricsDropZone=R.secondaryMetricsDropZone;Q.shape=R.shape;Q.subtype=R.subtype;Q.metricShapes=R.metricShapes;},exists:function(S,Q){var T=this[Q],R=false;I.forEach(T,function(U){R=(U.did===S.did);if(R){return false;}});return R;},removeAngleMetricFromOthers:function(Q){["xAxisObjects","yAxisObjects","tooltipMetrics"].every(function(T){var S=this[T],R=I.find(S,"did",Q.did);if(R>-1){S.splice(R,1);return false;}});},getXml:function C(){var Q=this.data.dz,R=Q?F.copy(Q.visProp&&Q.visProp.fmt,{}):{},S=new mstrmojo.XMLBuilder();if(this.shape){R.Shape=this.shape;}if(this.subtype){R.Subtype=this.subtype;}if(this.metricShapes){R.metricShapes=this.metricShapes;}R.visType=this.visType;S.addChild("props");S.addChild("widgetProps");S.addChild("fmt");F.forEach(R,function(T,U){S.addChild(U);S.addAttribute("value",T);S.closeElement();});S.closeElement();S.closeElement();S.closeElement();return S.toString();},setData:function K(T){if(!T){return ;}var R=this,S=function(V,W){if(V){var U=V.TemplateUnit||V.TemplateMetric;if(U){U.forEach(function(X){var Y=F.copy(X);if(!Y.did){Y.did=Y.id;}W.push(Y);});}}};S(T[O.PROP_ROWS],this.rowObjects);S(T[O.PROP_COLUMNS],this.columnObjects);S(T[O.PROP_XAXIS],this.xAxisObjects);S(T[O.PROP_YAXIS],this.yAxisObjects);S(T[O.PROP_BREAKBY],this.breakByObjects);S(T[O.PROP_COLORBY],this.colorByObjects);S(T[O.PROP_SIZEBY],this.sizeByObjects);S(T[O.PROP_SLICE],this.sliceObjects);S(T[O.PROP_ANGLE],this.angleObjects);S(T[O.PROP_TOOLTIPMETRICS],this.tooltipMetrics);var Q=T.visProp.fmt;this.shape=Q[O.PROP_SHAPE];this.subtype=Q[O.PROP_SUBTYPE];},setMetricsDropZone:function M(Q){if(!Q){return ;}var R=this;[O.PROP_ROWS,O.PROP_COLUMNS,O.PROP_XAXIS,O.PROP_YAXIS,O.PROP_BREAKBY,O.PROP_SLICE,O.PROP_COLORBY].forEach(function(S){if(Q[S]&&Q[S].hasOwnProperty("MetricNames")){if(R.metricsDropZone){R.secondaryMetricsDropZone=S;}else{R.metricsDropZone=S;}}});},getAddDropZonesAction:function(){var U=this,R=this.metricsDropZone,Q=this.secondaryMetricsDropZone,S={act:"updateTemplate",keyContext:this.data.k,actions:[]},T=function(V){S.actions.push({act:"addDropZoneUnit",zoneId:B[V],unitId:D,unitType:H});};[{p:"rowObjects",v:"Rows"},{p:"columnObjects",v:"Columns"},{p:"xAxisObjects",v:"XAxis"},{p:"yAxisObjects",v:"YAxis"},{p:"breakByObjects",v:"BreakBy"},{p:"colorByObjects",v:"ColorBy"},{p:"sizeByObjects",v:"SizeBy"},{p:"angleObjects",v:"Angle"},{p:"sliceObjects",v:"SliceBy"},{p:"tooltipMetrics",v:"AdditionalMetrics"}].forEach(function(X){var V=U[X.p],Y=B[X.v];V.forEach(function(Z){S.actions.push({act:"addDropZoneUnit",zoneId:Y,unitId:Z.did,unitType:Z.t,ax:Z.ax||G});});if(R===X.v){var W=function(Z){return(Z&&(Z.length>A)&&U.isMetricZone(Z));};if(W(U.xAxisObjects)||W(U.yAxisObjects)||W(U.angleObjects)){T(R);}}});if(Q==="ColorBy"){T(Q);}return S;}});O=mstrmojo.vi.viz.GraphMatrixHelper;O.PROP_ROWS="Rows";O.PROP_COLUMNS="Columns";O.PROP_HORIZONTAL_AXIS="HorizontalAxis";O.PROP_VERTICAL_AXIS="VerticalAxis";O.PROP_XAXIS="XAxis";O.PROP_YAXIS="YAxis";O.PROP_SLICE="SliceBy";O.PROP_ANGLE="AngleBy";O.PROP_BREAKBY="BreakBy";O.PROP_COLORBY="ColorBy";O.PROP_SIZEBY="SizeBy";O.PROP_TOOLTIPMETRICS="AdditionalMetrics";O.PROP_SHAPE="Shape";O.PROP_SUBTYPE="Subtype";O.PROP_METRICSHAPES="metricShapes";O.PROP_SHAPE_AREA="Area";O.PROP_SHAPE_LINE="Line";O.PROP_SHAPE_BAR="Bar";O.PROP_SHAPE_CIRCLE="Circle";O.PROP_SHAPE_SQUARE="Square";O.PROP_SHAPE_PIE="Pie";O.PROP_SHAPE_RING="Ring";O.PROP_SHAPE_TICK="Tick";O.PROP_SUBTYPE_CLUSTERED="Clustered";O.PROP_SUBTYPE_AUTOMATIC="Automatic";O.PROP_SUBTYPE_STACKED="Stacked";O.PROP_SUBTYPE_ABSOLUTE="Absolute";O.PROP_SUBTYPE_PERCENT="Percent";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.viz.DropZoneHelper");var V=mstrmojo,I=V.array,T=V.vi.viz.EnumDSSDropZones,N=V.hash,M;function C(b,a){var c=b.getDropZoneItems(a);return c[0];}function R(b,a){var c=C(b,a);return c?c.id:"";}mstrmojo.vi.viz.MapHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.MapHelper",widget:null,data:null,vp:null,geoAttribute:null,latitude:null,longitude:null,angle:null,colorBy:null,sizeBy:null,tooltip:null,mapType:null,useAttributeForm:null,supportAreaMap:true,defaultView:null,init:function S(a){this._super(a);this.tooltip=[];this.data=this.data||{};this.vp=this.data.vp||{};},setWidget:function W(a){this.widget=a;var b=a.model.data.vp;this.geoAttribute=R(a,T.GeoAttribute);this.latitude=R(a,T.Latitude);this.longitude=R(a,T.Longitude);this.angle=R(a,T.Angle);this.colorBy=R(a,T.ColorBy);this.sizeBy=R(a,T.SizeBy);this.tooltip=a.getDropZoneItems(T.AdditionalMetrics).map(function(c){return c.id;});this.mapType=b.mtp;this.useAttributeForm=b.af;this.defaultView=b.dv;},getGeoUnit:function P(){return C(this.widget,T.GeoAttribute);},getLatitudeUnit:function H(){return C(this.widget,T.Latitude);},getLongitudeUnit:function L(){return C(this.widget,T.Longitude);},getAngleUnit:function A(){return C(this.widget,T.Angle);},getColorByUnit:function B(){return C(this.widget,T.ColorBy);},getSizeByUnit:function K(){return C(this.widget,T.SizeBy);},getTooltipUnits:function G(){return this.widget.getDropZoneItems(T.AdditionalMetrics);},setMapType:function(a){this.mapType=a;},setUseAttributeForm:function J(a){this.useAttributeForm=a?M.USE_ATTRIBUTE_FORM:M.USE_ATTRIBUTE;},getGeoForm:function F(d,b){var a=d&&d.fs,c=null;if(!b){b=function(){return true;};}if((d.otp===12||d.t===12)&&a){I.forEach(a,function(e){if(b(e)){c=e;return false;}});}return c;},getLatitudeForm:function Z(a){return this.getGeoForm(a,function(b){return M.isLatitude(b.fnm,b.fgr)&&b.obf;});},getLongitudeForm:function D(a){return this.getGeoForm(a,function(b){return M.isLongitude(b.fnm,b.fgr)&&b.obf;});},getXml:function O(){return M.getXmlFromJson(this.vp);}});M=mstrmojo.vi.viz.MapHelper;M.USE_ATTRIBUTE="0";M.USE_ATTRIBUTE_FORM="1";M.MTP_MARKER="1";M.MTP_BUBBLE="2";M.MTP_AREA="3";M.MTP_DENSITY="4";M.MTP_PATH="5";M.canShowColorByZone=function(a){return a===M.MTP_MARKER||a===M.MTP_BUBBLE||a===M.MTP_AREA||a===M.MTP_PATH;};M.canShowSizeByZone=function(a){return a===M.MTP_BUBBLE;};M.supportImageThreshold=function(a){return a!==M.MTP_BUBBLE&&a!==M.MTP_AREA;};M.isLatitude=function Y(b,a){return a===5||(b&&b.toLowerCase().indexOf("latitude")>-1);};M.isLongitude=function X(b,a){return a===6||(b&&b.toLowerCase().indexOf("longitude")>-1);};M.getXmlFromJson=function E(a){var b=new mstrmojo.XMLBuilder();b.addChild("widgetProps");b.addChild("fmt");N.forEach(a,function(c,d){b.addChild(d);b.addAttribute("value",c);b.closeElement();});b.closeElement();b.closeElement();return b.toString();};M.getMapTypeByElementCount=function Q(a){return a>500?M.MTP_DENSITY:M.MTP_MARKER;};M.isGeoRoleSupportArea=function U(d){var c=1,e=3,g=2,b=8,f=9,a=7;return d===e||d===g||d===b||d===f||d===c||d===a;};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.XMLBuilder");mstrmojo.requiresClsP("mstrmojo.vi.viz","DropZoneHelper","EnumDSSDropZones");var B=mstrmojo,G=B.hash,H=B.vi.viz;function F(){var K,I,J=this.tooltipMetrics;if(J.length>0){K=J[0].did;for(I=1;I<J.length;I++){K=K+","+J[I].did;}}return K;}mstrmojo.vi.viz.ImageLayoutHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.ImageLayoutHelper",geoAttribute:null,colorByMetric:null,sizeByMetric:null,layoutAttribute:null,tooltipMetrics:null,mapFile:null,init:function E(I){this._super(I);this.tooltipMetrics=[];if(I&&I.node.data){this.mapFile=I&&I.node.data.vp&&I.node.data.vp.mf;}},getAddDropZonesAction:function(){var I=this,J={act:"updateTemplate",keyContext:this.node.k,actions:[]};[{n:"geoAttribute",zone:"GeoAttribute"},{n:"colorByMetric",zone:"ColorBy",t:4},{n:"sizeByMetric",zone:"SizeBy",t:4},{n:"layoutAttribute",zone:"Layout"},{n:"tooltipMetrics",zone:"AdditionalMetrics",t:4}].forEach(function(K){var L=[].concat(I[K.n]||[]),M=H.EnumDSSDropZones[K.zone];if(L&&L.length){L.forEach(function(N){J.actions.push({act:"addDropZoneUnit",zoneId:M,unitId:N.did,unitType:N.t});});}});return J;},setData:function A(K){if(!K){return ;}var I=this,J=function(M,N){if(M){var O=I[N],L=M.TemplateUnit||M.TemplateMetric;if(L){L.forEach(function(P){var Q=G.copy(P);if(!Q.did){Q.did=Q.id;}if(O instanceof Array){O.push(Q);}else{I[N]=Q;}});}}};J(K[C.PROP_GEO],"geoAttribute");J(K[C.PROP_COLORBY],"colorByMetric");J(K[C.PROP_SIZEBY],"sizeByMetric");J(K[C.PROP_LAYOUT],"layoutAttribute");J(K[C.PROP_TOOLTIPMETRICS],"tooltipMetrics");},getXml:function D(){var J="ga",L="PathToMap",N="ColorBy",I="mf",Q="SizeBy",O="Tooltip";var K=new mstrmojo.XMLBuilder(),M,P=function(T,R,S){if(S&&S.did!==undefined){K.addChild(T);K.addAttribute(R,S.did);K.closeElement();}};K.addChild("props");K.addChild("widgetProps");K.addChild("fmt");P(J,"value",this.geoAttribute);P(N,"value",this.colorByMetric);P(Q,"value",this.sizeByMetric);P(L,"value",this.layoutAttribute);M=F.call(this);P(O,"value",M);P(I,"value",this.mapFile);K.closeElement();K.closeElement();K.closeElement();return K.toString();}});var C=mstrmojo.vi.viz.ImageLayoutHelper;C.PROP_GEO="Geo";C.PROP_COLORBY="ColorBy";C.PROP_SIZEBY="SizeBy";C.PROP_LAYOUT="layout";C.PROP_TOOLTIPMETRICS="AdditionalMetrics";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.XMLBuilder");var F=mstrmojo.hash,H=mstrmojo.array;function E(){var K,I,J=this.tooltipMetrics;if(J.length>0){K=J[0].did;for(I=1;I<J.length;I++){K=K+","+J[I].did;}}return K;}mstrmojo.vi.viz.HeatMapVisualizationHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.HeatMapVisualizationHelper",groupingObjects:null,colorBy:null,sizeByMetric:null,tooltipMetrics:null,init:function D(I){this._super(I);this.colorBy=[];this.groupingObjects=[];this.tooltipMetrics=[];},getAddDropZonesAction:function(){var I=this,J={act:"updateTemplate",keyContext:this.node.k,actions:[]};[{n:"groupingObjects",zone:"Grouping"},{n:"colorBy",zone:"ColorBy"},{n:"sizeByMetric",zone:"SizeBy",t:4},{n:"tooltipMetrics",zone:"AdditionalMetrics",t:4}].forEach(function(K){var L=[].concat(I[K.n]||[]),M=mstrmojo.vi.viz.EnumDSSDropZones[K.zone];if(L&&L.length){L.forEach(function(N){J.actions.push({act:"addDropZoneUnit",zoneId:M,unitId:N.did,unitType:N.t});});}});return J;},setData:function A(K){if(!K){return ;}var I=this,J=function(M,N){if(M){var O=I[N],L=M.TemplateUnit||M.TemplateMetric;if(L){L.forEach(function(P){var Q=F.copy(P);if(!Q.did){Q.did=Q.id;}if(O instanceof Array){O.push(Q);}else{I[N]=Q;}});}}};J(K[G.PROP_GROUPING],"groupingObjects");J(K[G.PROP_COLORBY],"colorBy");J(K[G.PROP_SIZEBY],"sizeByMetric");J(K[G.PROP_TOOLTIPMETRICS],"tooltipMetrics");},getXml:function B(){var I=new mstrmojo.XMLBuilder(),M,K,J=function(Q,O,P){if(P){I.addChild(Q);I.addAttribute(O,P);I.closeElement();}};I.addChild("props");I.addChild("widgetProps");I.addChild("fmt");var L=this.sizeByMetric,N=this.colorBy[0];if(L&&N){M=L.did+","+N.did;}else{if(L&&!N){M=L.did+","+L.did;}else{if(!L&&N){M=N.did+","+N.did;}}}J("ml","value",M);K=E.call(this);J("am","value",K);I.closeElement();I.closeElement();I.closeElement();return I.toString();},getFirstColorByUnit:function C(L){var J=this.colorBy,I;if(J.length){var K=J[0];if(L){if(this.isMetric(K)){I=K;}}else{I=K;}}return I;}});var G=mstrmojo.vi.viz.HeatMapVisualizationHelper;G.PROP_GROUPING="Grp";G.PROP_COLORBY="ColorBy";G.PROP_SIZEBY="SizeBy";G.PROP_TOOLTIPMETRICS="AdditionalMetrics";}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,K="mstrmojo-itemwrap",J="&nbsp;",I=mstrmojo.array;function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function N(l,Z,k,o,W,c,q,n){if(!Z){return{start:0,end:0};}var e=this.wrapperNodes(l),g=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,f=k+o,d=e[0].offsetTop,b;for(var m=1;m<=Y;m++){b=e[g].offsetTop-d+n;if(b<k){X=g;}else{if(b>f){V=g;}}var a=Math.round(Z/Math.pow(2,m+1));g+=(b>k)?-a:a;g=Math.min(Math.max(0,g),Z-1);}return{start:X,end:V};},findWrapper:function L(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function F(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function S(c,V,X,b,W){var Y=this._nd2iw(c,V,X),d,a,e;if(Y){a=this._iw2idx(c,V,Y);d=a;e=this.itemOffsetTop(c,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+e+Z/2){d++;e+=Z;}}else{return c.dropCuePos;}return{left:0,top:e,idx:d,idxActual:a};},getWrapperCss:function(V){return K;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function P(e,b,h,d,a,l){var m=this.itemWrapperPrefix(h),g=this.itemWrapperSuffix,Z=m+this.itemWrapperPrefill+g,Y=[this.markupPrefix],W=1,V=h.selectedIndices||{},o=function n(p,k){for(var q=p;q<k;q++){Y[W++]=m;var r=b.build(h,d,e[q],q);if(V[q]){r=r.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=r;Y[W++]=g;}};var c=(e&&e.length)||0;a=a&&b?Math.min(a,c):0;if(a){o(0,a);}l=l&&b?Math.min(l,c-a):0;var f=c-l;for(var X=a;X<f;X++){Y[W++]=Z;}if(l){o(f,c);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,g,d,n,f,W,b,m){var e=(g&&g.length)||0,l=this.wrapperNodes(X),o=f.itemStatus,V=mstrmojo.css,Z=n.selectedIndices||{};for(var c=W,h=Math.min(b+1,e),a=0;c<h;c++){if(o[c]!==A){l[c].innerHTML=d.build(n,f,g[c],c);if(Z[c]){var Y=l[c].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===m){break;}}}return a;},onadd:function O(e,V,Z,f){if(V&&f){var a=f.value.length,b=this.wrapperNodes(V),d=b[f.index],Y=this.getWrapperCss(e);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=J;if(d){this.wrapperParentNode(V).insertBefore(W,d);}else{this.wrapperParentNode(V).appendChild(W);}}T(e,this);}},onremove:function Q(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var d=X.value.length;for(var Z=X.index+d-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function R(g,X,c,k){if(X&&k){var d=this.wrapperNodes(X);if(d){var W=mstrmojo.css,l=c.itemStatus,h;for(var b=0,V=k.removed,f=V&&V.length;b<f;b++){h=V[b];if(l[h]){W.removeClass(d[h].firstChild,["selected"]);}}for(var Z=0,e=k.added,Y=e&&e.length;Z<Y;Z++){h=e[Z];if(l[h]){W.addClass(d[h].firstChild,["selected"]);}}}}},_nd2iw:function E(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}if(X===V){break;}Y=X;X=Y.parentNode;}}return null;},_iw2idx:function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=I.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;},toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,e=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=e.clientHeight,d=e.scrollTop,Y=d;if(V<d){Y=V;}else{if(d+W-b<V){Y=Math.min(V,V-W+b);}}e.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.css");mstrmojo.vi.ui._HasMask=mstrmojo.provide("mstrmojo.vi.ui._HasMask",{_mixinName:"mstrmojo.vi.ui._HasMask",isMasked:false,onisMaskedChange:function A(){if(!this.hasRendered){return ;}var B=this.maskNode,C=this.isMasked;B.style.display=C?"block":"none";mstrmojo.css.toggleClass(B,"masked",C);}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.hash","mstrmojo.css");var F=mstrmojo.hash,C=mstrmojo.css;var D="open";function E(G){return G?G.popupConfig.hostElement:null;}mstrmojo.ui.menus._HasMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._HasMenuPopup",F.copy(mstrmojo._HasPopup));mstrmojo.ui.menus._HasMenuPopup.openPopup=function A(I,G){var H=this._lastOpened;if(H){this.closePopup();}mstrmojo._HasPopup.openPopup.call(this,I,G);C.addClass(E(I),D);};mstrmojo.ui.menus._HasMenuPopup.closePopup=function B(){C.removeClass(E(this._lastOpened),D);mstrmojo._HasPopup.closePopup.call(this);};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.fx");var Y=mstrmojo.css,H=mstrmojo.dom,O=mstrmojo.array,K={v:{styleDim:"height",styleDir:"top",dimension:"h",position:"y",scroll:"scrollTop",scrollDimension:"scrollHeight",cls:"vertical",hostCls:"hasVertical",scrollNodeCls:"hasVertical"},h:{styleDim:"width",styleDir:"left",dimension:"w",position:"x",scroll:"scrollLeft",scrollDimension:"scrollWidth",cls:"horizontal",hostCls:"hasHorizontal",scrollNodeCls:"hasHorizontal"}},W="scrollingMode",R="scrolling",b=3;var L=H.getOSInfo().name.toLowerCase().indexOf("mac")>=0;function J(){return(this.scrollbarHostNode||(this.scrollNode&&this.scrollNode.parentNode));}function P(d,c){var k=H.eventTarget(c,d),g=this.scrollNode,f=H.position(g),h=this.scrollTrackNodes,e=this.scrollBarNodes,l=function l(u){var r=k===h[u];if(r){var v=K[u],m=e[u],w=H.position(m),o=H.getMousePosition(d,c)[v.position],p=o-w[v.position],n=p>0?1:-1,t=g[v.scrollDimension],x=Math.abs(p-(w.h/2))*(t/f[v.dimension]),q={};q[v.scroll]={isStyle:false,start:g[v.scroll],stop:g[v.scroll]+(n*Math.min(t/3,500,x)),ease:mstrmojo.ease.linear};(new mstrmojo.fx.AnimateProp({props:q,duration:200,interval:10,target:g})).play();}};l.call(this,"h");l.call(this,"v");}function B(d,c){var g=this.scrollNode,f=d.type==="mousewheel",e=f?-1:1;mstrmojo.array.forEach(["h","v"],function(p){var n=K[p],k=f?"wheelDelta":"delta",m=d[k+{h:"X",v:"Y"}[p]]*e,l=Math.abs(m),h=m/l,o=l===3&&H.isFF&&!L;g[n.scroll]+=o?h*40:m;});H.stopPropogation(c,d);H.preventDefault(c,d);}function a(h){var g=K[h],f=this.scrollNode,e=H.position(f),d=e[g.dimension],k=f[g.scrollDimension],c=Math.ceil(d)/k;return A(c,d,k);}function A(d,c,e){return(!isNaN(d)&&d<1)&&(Math.abs(c-e)>b);}function C(AB){var t="px",m=K[AB],e=this.scrollNode,n=J.call(this),AC=H.position(e),o=AC[m.dimension],v=e[m.scrollDimension],d=Math.ceil(o)/v,AA=this.scrollBarNodes,k=AA[AB],q=this.scrollTrackNodes,r=q[AB],x=A(d,o,v),f=m.cls;if(!k){r=q[AB]=document.createElement("div");var g=this,p=function(AE){P.call(g,AE);},l=function(AE){B.call(g,AE);},w=function(AG,AE,AF){H.attachEvent(AG,AE,AF);g.installedEventListeners.push({e:AG,evt:AE,fn:AF});};w(r,"click",p);r.className="mstrmojo-scrolltrack "+f;k=AA[AB]=document.createElement("div");k.className="mstrmojo-scrollbar "+f;r.appendChild(k);n.appendChild(r);var z=mstrApp.isSingleTier?"mousewheel":"wheel";w(r,z,l);w(k,z,l);}var AD=k.style,h=(e[m.scroll]/e[m.scrollDimension]),c=H.delta(e,J.call(this))[m.position],u=r.style;if(x){u[m.styleDir]=c+t;AD[m.styleDim]=(d*o)+t;AD[m.styleDir]=(o*h)+t;}Y.toggleClass(n,m.hostCls,x);Y.toggleClass(e,m.scrollNodeCls,x);return x;}function G(){return !(mstrApp.isSingleTier&&L);}mstrmojo.ui._HasScroller=mstrmojo.provide("mstrmojo.ui._HasScroller",{_mixinName:"mstrmojo.ui._HasScroller",hasCustomScrollbar:null,draggable:true,ownAvatar:true,scrollNode:undefined,scrollbarHostNode:undefined,scrollBarNodes:undefined,setupScrollNodes:mstrmojo.emptyFn,installedEventListeners:null,init:function T(c){this._super(c);if(this.hasCustomScrollbar===null){this.hasCustomScrollbar=G();}this.installedEventListeners=[];},onRender:function I(){if(this._super){this._super();}this.updateScrollbars();this.addScrollNodeProperties();},addScrollNodeProperties:function F(){var d=this.scrollNode;if(d){var c=H.attachMarkupEvent(this.id,d,"scroll");this.installedEventListeners.push({e:d,evt:"scroll",fn:c});}if(!this.hasCustomScrollbar){Y.addClass(d,"mstrmojo-sb-show-default");return ;}if(d){Y.addClass(J.call(this),"mstrmojo-scrollbar-host");Y.addClass(d,"mstrmojo-scrollNode");}},updateScrollbars:function Z(){if(!this.hasRendered){return ;}this.setupScrollNodes();if(!this.hasCustomScrollbar){if(this.scrollNode){this.scrollNode.style.overflowX=a.call(this,"h")?"scroll":"hidden";}return ;}if(this.scrollNode){this.scrollBarNodes=this.scrollBarNodes||{};this.scrollTrackNodes=this.scrollTrackNodes||{};var c=this.scrollNode.style;c.overflowY=C.call(this,"v")?"scroll":"hidden";c.overflowX=C.call(this,"h")?"scroll":"hidden";}},onscroll:function V(){var l=this.scrollNode;if(l&&this.hasCustomScrollbar){var g=function g(m){var o=parseInt(m);return o===null||isNaN(o)?0:o;},h=H.position(l),k=h.h-g(Y.getStyleValue(l,"padding-bottom")),d=h.w-g(Y.getStyleValue(l,"padding-right")),f=this.scrollBarNodes,e=f.v,c=f.h;if(l.scrollHeight-k>0){e.style.top=((k-H.position(e).h)*(l.scrollTop/(l.scrollHeight-k)))+"px";}if(l.scrollWidth-d>0){c.style.left=((d-H.position(c).w)*(l.scrollLeft/(l.scrollWidth-d)))+"px";}}if(this._super){this._super();}if(this.onScrollEnd){this.onScrollEnd();}},getDragData:function E(d){var g=this.scrollNode,f=H.position(g),e=d.src.node,c=this.scrollBarNodes;if(this.isDraggingScrollBar(d)){return{isScrollBar:true,direction:e===c.v?"v":"h",scrollTop:g.scrollTop,scrollLeft:g.scrollLeft,conversionRatio:{y:g.scrollHeight/f.h,x:g.scrollWidth/f.w}};}return(this._super&&this._super(d));},isDragValid:function D(c){return this.isDraggingScrollBar(c)||(this._super&&this._super(c))||false;},isDraggingScrollBar:function S(d){var e=d.src.node,c=this.scrollBarNodes;return !!c&&(e===c.v||e===c.h);},ondragstart:function X(c){if(this.isDraggingScrollBar(c)){Y.addClass(c.src.node,R);Y.addClass(J.call(this),W);}if(this._super){this._super(c);}},shouldDragBubble:function Q(c){var d=c.src.node,e=this.scrollTrackNodes;return !!e&&(d===e.v||d===e.h);},ondragmove:function N(d){if(this.isDraggingScrollBar(d)){var n=d.tgt,c=d.src,o=n.pos,e=c.pos,k=c.node,h=this.scrollNode,m=this.scrollBarNodes,l=c.data,g={y:(o.y-e.y),x:(o.x-e.x)},f=l.conversionRatio;if(k===m.v){h.scrollTop=l.scrollTop+(g.y*f.y);}else{h.scrollLeft=l.scrollLeft+(g.x*f.x);}}if(this._super){this._super(d);}},ondragend:function N(c){if(this.isDraggingScrollBar(c)){Y.toggleClass(c.src.node,R,false);Y.toggleClass(J.call(this),W,false);}if(this._super){this._super(c);}},widgetResized:function M(){if(this._super){this._super();}this.updateScrollbars();},unrender:function U(c){O.forEach(this.installedEventListeners,function(d){H.detachEvent(d.e,d.evt,d.fn);});delete this.scrollNode;delete this.scrollbarHostNode;delete this.scrollBarNodes;delete this.scrollTrackNodes;this._super(c);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.string","mstrmojo.css");var K=mstrmojo.css,N=mstrmojo.string,H=mstrmojo.dom,L=13,C=27;function I(S){if(this._editComplete){return ;}var W,Q=false,V=this.text,T=false;if(S===C){W=V;T=true;Q=true;}if(!S||(!this.allowNewLine&&S===L)){var R=this[this.editableSlot],U=R.innerText||R.textContent||"";if(!this.allowNewLine){W=U.replace(/\n/g,"");}else{W=U;}Q=true;if(!this.allowEmptyText&&W.length===0){W=V;T=true;}}if(Q){this._editComplete=true;W=W.replace(/\u00A0/g,"\u0020");this.text=W;this.set("isEditing",false);this.onTextEditComplete(W!==V,V);delete this._editComplete;}if(T){this.refresh();}}function E(Q){var R={dblclick:"editOnDoubleClick",click:"editOnClick"};if(this[R[Q.name]]&&Q.getTarget()===this[this.editableSlot]){this.set("isEditing",true);}}function F(S,R,Q){if(typeof R["on"+Q]!=="function"){H.attachMarkupEvent(S,R,Q);}}mstrmojo._HasEditableText=mstrmojo.provide("mstrmojo._HasEditableText",{_mixinName:"mstrmojo._HasEditableText",editableSlot:"domNode",editButtonSlot:null,isEditing:false,editOnClick:true,allowEmptyText:false,allowNewLine:false,editOnDoubleClick:false,onTextEditComplete:mstrmojo.emptyFn,postBuildRendering:function A(){this._super();var S=this.editableSlot,Q=this[S],T=this[this.editButtonSlot||S];K.addClass(Q,"hasEditableText");this.text=this.text||Q.innerText||Q.textContent||"";Q.innerHTML=N.encodeHtmlString(this.text,true).replace(/ (?= )/g,"&nbsp;");var R=this.id;if(this.editOnClick){F(R,T,"click");}F(R,T,"dblclick");F(R,Q,"blur");F(R,Q,"keyup");F(R,Q,"keydown");},onclick:function P(Q){E.call(this,Q);if(this._super){this._super(Q);}},ondblclick:function G(Q){E.call(this,Q);},onblur:function M(){I.call(this);},onkeyup:function B(R){var Q=window.event||R.e;I.call(this,Q.keyCode);},onkeydown:function J(R){var Q=window.event||R.e;if(Q.keyCode===L){I.call(this,Q.keyCode);R.cancel();}},_set_text:function D(S,Q){var R=this.text;this.text=Q;if(this.hasRendered){this[this.editableSlot].innerHTML=N.encodeHtmlString(Q||"",true);}return(R!==Q);},onisEditingChange:function O(){if(this.hasRendered){var Q=this[this.editableSlot],R=!!this.isEditing;Q.contentEditable=R;Q.spellcheck=false;K.toggleClass(Q,"editable",R);if(R){Q.focus();H.setElementSelection(Q);}else{Q.blur();Q.scrollLeft=0;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","fx"],RW:[]};J.RW=["z-index"].concat(J.T.concat(J.D));var D=mstrmojo.dom,O=mstrmojo.css;function N(T,V,S){var U=T[V]||[];U.push(S);T[V]=U;}function L(W,V){var U=((W&&W.fmts)||null);if(V){var Y=W.thresholds,T=Y&&Y[V];if(T){var X={},Z;for(Z in U){X[Z]=T[Z]||U[Z];}for(Z in T){var S=T[Z];X[Z]=(typeof S==="string")?(S+" !important"):S;}U=X;}}return U;}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(T){var S=true;this.invisible=!!(T&&T.data&&T.data.invisible);if(this._super){S=this._super(T);}return S;},buildCSSFormatString:function H(U,d){var h=this.formatHandlers[U],l=h.src?d[h.src]:d;if(!l){return null;}var b=h.props||h;if(!b){return null;}var X=[],g=-1;var V=b.length-1;for(V;V>=0;V--){var k=b[V];var c=J[k]||[k];var a=c.length-1;for(a;a>=0;a--){k=c[a];var T=l[k];if(T!==undefined){if(k==="fx"){var Y=T,S={};var e=Y.gd;if(e){this.formatGradient(e,S);}var W=parseInt(Y.rt,10);if(W){if(W===1||W===3){this.formatTextRotation(Y.rt,S);}}if(Y.ds){this.formatDropShadow(Y,S);}var Z;for(Z in S){X[++g]=Z+":"+S[Z].join(" ");}}else{X[++g]=k+":"+T;}}}}if(this.invisible){X.push("visibility:hidden");}return X.join(";")+";";},applyCSSFormatToNode:function I(U,S){var V=this[U],T=V&&V.style;if(T){this.buildCSSFormatString(U,S).split(";").forEach(function(W){var X=W.split(":");T[O.convertCssToCamelCase(X[0])]=X[1];});}},clearSlotBackgroundCSS:function F(T){var U=this[T],S=U&&U.style;if(S){S.background="transparent none 0 0 no-repeat";S.filter="none";}},preBuildRendering:function B(){this._super();var V=this.formatHandlers,S=this.getFormats();if(V&&S){var W=this.defn=this.defn||{},X=this.getCacheKey(),U=W[X];if(!U){U=W[X]={};for(var T in V){var Z=T+"CssText";this[Z]=U[Z]=this.buildCSSFormatString(T,S)||"";}}else{var Y;for(Y in U){this[Y]=U[Y];}}}return true;},formatGradient:function P(S,U){var T=O.buildGradient(S.t,S.sc,S.ec);if(T){N(U,T.n,T.v);}},formatDropShadow:function K(W,U){if(D.supports(D.cssFeatures.DROP_SHADOW)){var V=W.ds;if(D.isDXIE){N(U,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+V+",OffY="+V+")");}else{var S=[V,V],T=parseInt(W.rt,10);if(T===1||T===3){S[((T===1)?1:0)]=-V;}N(U,(D.isWK?"-webkit-":"")+"box-shadow",S.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(T,S){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){N(S,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+T+")");}else{var U=(T===1)?90:-90;N(S,D.CSS3_PREFIX+"transform-origin","top left");N(S,D.CSS3_PREFIX+"transform","rotate("+U+"deg)");}}},getFormats:function R(){if(!this.fmts){this.fmts=L.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function Q(){delete this.defn[this.getCacheKey()];},unrender:function M(S){if(this.thresholdId){this.fmts=null;}this._super(S);}});mstrmojo._Formattable.getBorderWidths=function(W){var V=W.getFormats(),S=(V.border)?V.border.match(/(\d*|\d*\.\d*)pt/)[0]:V["border-width"],U=W.model,T=U.docModel;return O.getBorderWidths(S,(T&&T.dpi)||U.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var E=mstrmojo.dom,H=mstrmojo.css,C="active";var A=false;mstrmojo.util.ui.SplitterParamsType=null;function G(M,P){var O=P.info,N=O&&O.min,L=O&&O.max,K=P.start+(E.getMousePosition(M,window)[P.mouseProp]-P.mousePosition)*(O&&!!O.isReverseMove?-1:1);if(N!==undefined){K=Math.max(K,N);}if(L!==undefined){K=Math.min(K,L);}return K;}function F(L,K,M){return function(N){L.call(mstrmojo.all[K],N,M);};}function B(K,L){L.target.style[L.styleProp]=G(K,L)+"px";}function J(K,M){if(!A){return ;}var L=window.document;E.detachEvent(L,"mousemove",M.fnMove);E.detachEvent(L,"mouseup",M.fnUp);delete M.fnMove;delete M.fnUp;A=false;mstrApp.setInteractive(true);this.splitterMoved(G(K,M)-M.start,M.info);H.removeClass(M.target,C);(this.children||[]).forEach(function(N){N.domNode.style.pointerEvents="inherit";});this.splitterMouseUp();}function I(U){if(A){return ;}mstrApp.setInteractive(false);var K=this.id,L,M,P=E.eventTarget(window,U),R=(P.className.indexOf("v")===-1),Q=R?"y":"x",O={};O.target=P;O.info=this.getSplitterInfo(P);M=O.info&&!!O.info.isReverseMove;L=R?"Top":M?"Right":"Left";O.start=M?parseInt(P.style.right):P["offset"+L];O.mouseProp=Q;O.mousePosition=E.getMousePosition(U,window)[Q];O.styleProp=L.toLowerCase();H.addClass(P,C);(this.children||[]).forEach(function(V){V.domNode.style.pointerEvents="none";});this.splitterMouseDown();var N=F(B,K,O),T=F(J,K,O);var S=window.document;E.attachEvent(S,"mousemove",N);E.attachEvent(S,"mouseup",T);O.fnMove=N;O.fnUp=T;A=true;}mstrmojo.util.ui._HostsSplitter=mstrmojo.provide("mstrmojo.util.ui._HostsSplitter",{_mixinName:"mstrmojo.util.ui._HostsSplitter",registerSplitter:function D(K){E.attachEvent(K,"mousedown",F(I,this.id));},getSplitterInfo:mstrmojo.emptyFn,splitterMoved:mstrmojo.emptyFn,splitterMouseDown:mstrmojo.emptyFn,splitterMouseUp:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.css");var F=mstrmojo.dom,G=mstrmojo.array,B=mstrmojo.hash,H=mstrmojo.css;var E;function J(M){var O=this.model,L=O.data.gts,Q=G.filterOne(L.row.concat(L.col),function(R){return R.id===M[0];}).es,K=[],N=[];function P(R){N.push(R);(Q[R].ch||[]).forEach(function(S){P(S);});}Q.forEach(function(T,R,U){var S=U[T.p_index];if(O.compareElementsId(T.id,M[1])){K.push(R);}if(S){if(S.ch){S.ch.push(R);}else{S.ch=[R];}}});K.forEach(function(R){P(R);});return N;}mstrmojo.vi.ui.rw._XtabRA=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabRA",{_mixinName:"mstrmojo.vi.ui.rw._XtabRA",onclick:function I(L){var P=L.getTarget&&L.getTarget();if(E){window.clearTimeout(E);E=null;}if(P.hasAttribute("rabtn")){var O=this,M=this.model,K=P&&F.findAncestorByName(P,"td",true,this.viewport),N=this.getCellForNode(K);this.clearSelections();this.controller.submitUndoRedoTemplateUpdates(this,M.getRAExpandAction(N,this.sid),{success:function(){O.highlightGroupCells(O.getRACellGroups(O.getSelectionHash()));E=window.setTimeout(function(){O.clearSelections();O.clearSelectionsCache();},1000);}});}this._super(L);},raExpandAll:function D(K,L){this.controller.submitUndoRedoTemplateUpdates(this,this.model.getRAExpandAllAction(K.id,L));},raExpandDescendants:function A(K){this.controller.submitUndoRedoTemplateUpdates(this,this.model.getRAExpandAction(K,this.sid,true));},getRACellGroups:function C(L){var M=(function(){var N=[];B.forEach(L,function(O){B.forEach(O,function(P,Q){G.forEach(P,function(R){N.push([Q,R.id]);});});});return N;}()),K=[];G.forEach(M,function(N){var P=this.model,O=[],Q=J.call(this,N);G.forEach(this.interactiveCellsArray,function(S){var T=!S.hasOwnProperty("mix")&&S._e&&S.fi===undefined;if(T&&P.getCellTitleInfo(S).title.id===N[0]){var R=S.idx;if(P.compareElementsId(S._e.id,N[1])||Q.indexOf(R)===-1){if(O.length>0){K.push(O);O=[];}}if(Q.indexOf(R)>-1){O.push(S);}}},this);if(O.length>0){K.push(O);}},this);return K;}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var G=mstrmojo.dom,J=mstrmojo.css,H="selected";function B(S,T,U,R,W){var V=W.listHooks[S];if(V&&V.call(W,T,U,R)){return ;}J.toggleClass(T,H,S==="select");}function I(U,T,S){var V=this[U],R=V?V.split(T):[];this[U]=mstrmojo.array.distinct(R.concat(S.split(T))).join(T);}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},useListModKeys:false,init:function Q(R){this._super(R);this._shiftStartIndex=-1;},getItemMarkup:function O(S,R){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';},getItemDisplayName:function E(R){return R.n||"";},getItemProps:function K(V,R){var S=!!this.selectedIndices[R],W={tag:"div",sel:S,cls:"",n:this.getItemDisplayName(V),style:"",idx:R,addCls:function T(Y){I.call(this,"cls"," ",Y);},addStyle:function U(Y){I.call(this,"style",";",Y);},title:V.title||""};if(S){W.addCls(H);}var X=V.cls;if(X){W.addCls(X);}return W;},itemRenderer:{render:function A(S,R,T){S._renderIdx=R;return mstrmojo.string.apply(T.getItemMarkup(S,R),T.getItemProps(S,R));},select:function L(S,T,R,U){B("select",S,T,R,U);},unselect:function D(S,T,R,U){B("unselect",S,T,R,U);}},onclick:function P(R){try{var T=this.getItemFromTarget(R.getTarget());if(T){R.cancel();this.doItemSelect(T,R||{});}}catch(S){mstrApp.onerror(S);}},doItemSelect:function F(k,b){var R=b.hWin,h=b.e,c=k._renderIdx,W=k._positionIdx,S=G.isMetaKey(R,h),Z=G.shiftKey(R,h),Y=this.multiSelect,U=this.useListModKeys,d=this._shiftStartIndex,X=this.selectedIndices;if(Y&&U&&Z&&d>-1){var g=[],T=[],V=Math.min(d,c),l=Math.max(d,c),f;for(f=0;f<this.items.length;f++){if(V<=f&&f<=l){if(!X[f]){g.push(f);}}else{if(X[f]){T.push(f);}}}this.addSelect(g);this.removeSelect(T);}else{if(Y&&(!U||S)){var a=(X[c])?"remove":"add";this[a+"Select"](c,false,W);}else{this.singleSelect(c,false,W);}this._shiftStartIndex=c;}},onclearSelection:function N(){this._shiftStartIndex=-1;},getItemNodeFromTarget:function C(S){var R=G.findAncestorByAttr(S,"idx",true,this.domNode);return(R&&R.node)||null;},getItemFromTarget:function M(T){var S=this.getItemNodeFromTarget(T),R=S&&parseInt(S.getAttribute("idx"),10);if(R!==null&&!isNaN(R)&&this.items){return this.items[R];}return undefined;}});mstrmojo._IsList.SELECTED_CLS=H;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.color","mstrmojo.hash","mstrmojo.array");var AD=mstrmojo.color,V=mstrmojo.hash,BG=mstrmojo.array,BC=mstrmojo.css,d=mstrmojo.num;var BE=1,Am=2,An=3,A0=4,AU=5,AV=6;var BL="FormattingFont",I="FormattingAppearance",X="FormattingAlignment",Ab="FormattingSize",Q="FormattingPatterns",F="FormattingBorder",Az="FormattingOrder",E="FormattingView",O="FormattingSelector",Ap="Template Formatting",L="FormattingPadding",Ak="AnalyticalEngineProperties",As="RWDocumentProperties",A9="FormattingPage",N="Mobile",T="VLDB Select";var Aj=1;var g="n",M="h",BH="w",AB="wm",A6="pw",W="ml",A7="mr",t="upwalw",p="ff",Ae="fsz",BA="fw",AC="fit",BB="fun",m="fst",r="fc",U="alh",q="alv",AY="atw",AI="atd",a="textOverflow",Ai="bc",D="bgs",H="btc",Ah="brc",AR="bbc",o="blc",k="bts",BJ="brs",A1="bbs",AX="bls",AO="borderColor",Aw="borderStyle",c="zIndex",AP="showTitleBar",h="title",Av="ctrlStyle",v="ctrlOrientation",Au="ctrlOrientationBehavior",f="ctrlMultiselect",C="ciwm",A8="cmcy",Ax="sec",n="easow",AH="layoutXml",J="lockAspectRatio",Ag="ism",e="shw",Ay="mg",BI="lhv",Y="gridVPadding",Ad="gridHPadding",Ac="ln",AG="sar",B="hnv",Aa="iw",AW="ih",AK="tsp",AS="visible",R="rf",BK="jad",Al="jdc",A2="fs",A5="ssc",b="sstyle",AA="hgl";function P(BM){return BM;}function AM(BM){return parseInt(BM,10);}var z={name:"encode",_def:P};z[An]=function(BM){return BM?1:0;};z[Am]=function(BM){if(BM==="transparent"){return -1;}if(BM.length===4){BM=BM.replace(/([0-9a-f])/ig,"$1$1");}BM=AD.rgbStr2hex(BM);return parseInt(BM.substring(5)+BM.substring(3,5)+BM.substring(1,3),16);};z[A0]=AM;z[BE]=function(BM){if(typeof BM==="number"){return d.toLocaleString(BM);}return P(BM);};z[AV]=function(BO){if(BO==="none"){return 0;}var BN=BO.match(/([0-9]+[,\.]?[0-9]*pt)/)[0],BM=BO.match(/pt ([\w\W]*)/)[1];if(BN==="2pt"){return 5;}switch(BM){case"solid":return 1;case"dashed":return 3;case"dotted":return 4;default:throw new Error("Invalid border style value in FormatModel::encodeValue.");}};var BF={name:"decode",_def:P};BF[An]=function(BM){return parseInt(BM,10)===1;};BF[Am]=function(BM){if(BM===-1){return"transparent";}if(typeof BM==="number"){return AD.decodeColor(BM);}if(BM.length===4){return BM.replace(/([0-9a-f])/ig,"$1$1");}return AD.rgbStr2hex(BM);};BF[A0]=AM;BF[AV]=function(BO){if(BO===undefined||BO===0){return"none";}var BN="1pt",BM="solid";if(BO===5){BN="2pt";}if(BO===3){BM="dashed";}else{if(BO===4){BM="dotted";}}return BN+" "+BM;};function A3(){return this.pn.toLowerCase();}function AJ(BM,BO,BP){var BN=document.createElement("div");BN.style[BP||BO]=BM[BO];return BN;}function G(BM){return function(){return AD.rgbStr2hex(BM.apply(this,arguments));};}function Af(){var BM=A3.call(this);return BM==="underline"?BM:"line-through";}var Ar={name:"extract"},S=Ar._def=function(BM,BO,BP){var BN=AJ(BM,BO||this.getFormatBlockName(),BP);return BN.style[this.getCssName()];};Ar[Am]=G(S);function u(BM){return S.call(this,BM,this.getFormatBlockName())===A3.call(this);}function A(BM){var BN=S.call(this,BM,this.getFormatBlockName(),this.getCssName());return BN.indexOf(Af.call(this))>-1;}function Aq(BM){var BN=this.getFormatBlockName();return AD.rgbStr2hex(S.call(this,BM,BN,BN+this.pn));}var BD={name:"resolve"},Z=BD._def=function(BM,BP,BO,BQ){BO=BO||this.getFormatBlockName();var BN=AJ(BM,BO);BN.style[BQ||this.getCssName()]=BP;return BN.style[BC.convertCssToCamelCase(BO)];};BD[Am]=function(BM,BO,BN,BP){if(BO.or!==undefined){return BO;}return AD.rgbStr2hex(Z.call(this,BM,BO,BN,BP));};function AQ(BM,BN){return Z.call(this,BM,BN?A3.call(this):"normal");}function AN(BN,BP){var BO=(BN[this.getFormatBlockName()]||"").split(" "),BM=Af.call(this);if(BP){if(BO.indexOf(BM)===-1){BO.push(BM);}}else{BO=BO.filter(function(BQ){return BQ!==BM;});}return Z.call(this,BN,BO.join(" "));}var AZ={name:"update"},A4=AZ._def=function(BM,BN){BM[this.getFormatBlockName()]=this.resolve(BM,BN);return BM;};var AL={};AL[g]={ps:I,pn:"Name",pt:BE};AL[M]={ps:Ab,pn:"Height",pt:BE};AL[BH]={ps:Ab,pn:"Width",pt:BE};AL[AB]={ps:Ab,pn:"WidthMode",pt:A0};AL[A6]={ps:A9,pn:"PageWidth",pt:BE};AL[W]={ps:A9,pn:"MarginLeft",pt:BE,fn:"margin-left"};AL[A7]={ps:A9,pn:"MarginRight",pt:BE,fn:"margin-right"};AL[t]={ps:A9,pn:"UsePageWidthAsLayoutWidth",pt:An};AL[p]={ps:BL,pn:"Name",pt:BE,fn:"font",cn:"fontFamily",extract:function(){return S.apply(this,arguments).replace(/['"]/g,"");}};AL[Ae]={ps:BL,pn:"Size",pt:A0,fn:"font",cn:"fontSize"};AL[BA]={ps:BL,pn:"Bold",pt:An,fn:"font",cn:"fontWeight",extract:u,resolve:AQ};AL[AC]={ps:BL,pn:"Italic",pt:An,fn:"font",cn:"fontStyle",extract:u,resolve:AQ};AL[BB]={ps:BL,pn:"Underline",pt:An,fn:"text-decoration",extract:A,resolve:AN};AL[m]={ps:BL,pn:"Strikeout",pt:An,fn:"text-decoration",extract:A,resolve:AN};AL[r]={ps:BL,pn:"Color",pt:Am};AL[U]={ps:X,pn:"Horizontal",pt:A0,fn:"text-align"};AL[AY]={ps:X,pn:"TextWrap",pt:An,fn:"white-space"};AL[AI]={ps:X,pn:"TextDirection",pt:A0};AL[q]={ps:X,pn:"Vertical",pt:A0};AL[a]={ps:Ab,pn:"TextOverflow",pt:An};AL[Ai]={ps:Q,pn:"FillColor",pt:Am,x:Aj,fn:"background-color",update:function(BM,BO){var BN=BM.fx;if(BO.or!==undefined){if(!BN){BN=BM.fx={};}var BP=BN.gd=BN.gd||{};BP.ec=BO.c2;BP.sc=BO.c1;BP.t=BO.or;delete BM[this.getFormatBlockName()];BM.fx=BN;}else{if(BN){delete BN.gd;}A4.call(this,BM,BO);}return BM;}};AL[D]={ps:Q,pn:"FillStyle",pt:A0};AL[A5]={ps:Q,pn:"SelectorSelectionColor",pt:Am};AL[b]={ps:Q,pn:"SelectorSelectionFillStyle",pt:A0};AL[H]={ps:F,pn:"TopColor",pt:Am,fn:"border",extract:Aq};AL[Ah]={ps:F,pn:"RightColor",pt:Am,fn:"border",extract:Aq};AL[AR]={ps:F,pn:"BottomColor",pt:Am,fn:"border",extract:Aq};AL[o]={ps:F,pn:"LeftColor",pt:Am,fn:"border",extract:Aq};AL[AO]={ps:F,pn:["TopColor","RightColor","BottomColor","LeftColor"],pt:Am,fn:"border",extract:Aq,resolve:G(function(BM,BO){var BP=this.getFormatBlockName(),BN=Z.call(this,BM,BO,BP,BP+"Color"),BQ=BN.indexOf("rgb");if(BQ>-1){BN=BN.slice(0,BQ)+AD.rgbStr2hex(BN.slice(BQ));}return BN;})};AL[Aw]={ps:F,pn:["TopStyle","RightStyle","BottomStyle","LeftStyle"],pt:AV,fn:"border",extract:Aq,resolve:function(BM,BP){var BN=BP.split(" "),BQ=this.getFormatBlockName();BM[BQ]=Z.call(this,BM,BN[0],BQ,BQ+"Width");var BO=Z.call(this,BM,BN[1]||"none",BQ,BQ+"Style"),BR=BO.indexOf("rgb");if(BR>-1){BO=BO.slice(0,BR)+AD.rgbStr2hex(BO.slice(BR));}if(BO.indexOf("#")===-1&&BO.indexOf("transparent")===-1){BO+=" transparent";}return BO;}};AL[k]={ps:F,pn:"TopStyle",pt:AV,fn:"border",extract:Aq};AL[BJ]={ps:F,pn:"RightStyle",pt:AV,fn:"border"};AL[A1]={ps:F,pn:"BottomStyle",pt:AV,fn:"border",extract:Aq};AL[AX]={ps:F,pn:"LeftStyle",pt:AV,fn:"border",extract:Aq};AL[c]={ps:Az,pn:"ZIndex",pt:A0,fn:"z-index"};AL[AP]={ps:E,pn:"ShowTitleBar",pt:An};AL[h]={ps:E,pn:"Title",pt:BE};AL[Av]={ps:O,pn:"Style",pt:A0};AL[v]={ps:O,pn:"Orientation",pt:A0};AL[Au]={ps:O,pn:"OrientationBehavior",pt:A0};AL[f]={ps:O,pn:"Multiselect",pt:An};AL[C]={ps:O,pn:"ItemWidthMode",pt:A0};AL[A8]={ps:O,pn:"MetricConditionType",pt:A0};AL[Ax]={ps:O,pn:"ShowElementCount",pt:A0};AL[n]={ps:O,pn:"ExportAsShownOnWeb",pt:A0};AL[AH]={ps:Ab,pn:"LayoutXML",pt:AU};AL[J]={ps:Ab,pn:"LockAspectRatio",pt:An};AL[Ag]={ps:Ab,pn:"ImageSizeMode",pt:A0};AL[AW]={ps:Ab,pn:"ImageHeight",pt:BE};AL[Aa]={ps:Ab,pn:"ImageWidth",pt:BE};AL[AK]={ps:As,pn:"layoutBarPosition",pt:An};AL[A2]={ps:As,pn:"ExecutionFullScreenMode",pt:An};AL[AS]={ps:I,pn:"Visible",pt:An};AL[Ac]={ps:Ap,pn:"LongNames",pt:BE};AL[AG]={ps:Ak,pn:"ShowAllRows",pt:BE};AL[B]={ps:Ak,pn:"HideNullZeroValues",pt:BE};AL[Ad]={ps:L,pn:["LeftPadding","RightPadding"],pt:BE};AL[Y]={ps:L,pn:["TopPadding","BottomPadding"],pt:BE};AL.rowsshw={ps:Ap,pn:"ShowRowHeaders",pt:BE};AL.rowsmg={ps:Ap,pn:"MergeCells",pt:BE};AL.rowslhv={ps:Ap,pn:"LockRowHeaders",pt:BE};AL.colsshw={ps:Ap,pn:"ShowColumnHeaders",pt:BE};AL.colsmg={ps:Ap,pn:"MergeColumnCells",pt:BE};AL.colslhv={ps:Ap,pn:"LockColumnHeaders",pt:BE};AL[R]={ps:N,pn:"RefreshFrequency",pt:A0};AL[BK]={ps:T,pn:"Join Across Datasets",pt:A0};AL[Al]={ps:T,pn:"MCE Join To Get Data Combination",pt:A0};AL[AA]={ps:I,pn:"Highlight",pt:A0};BG.forEach(V.keyarray(AL),function(BM){var BN=AL[BM];BN.getFormatBlockName=function(){var BP=this.fn;if(!BP){var BO=this.pn;BP=BO.charAt(0).toLowerCase()+BO.substr(1);}return BP;};BN.getCssName=function(){var BO=this.getFormatBlockName.call(this),BP=this.cn;if(!BP){BP=BC.convertCssToCamelCase(BO);}return BP;};BG.forEach([z,BF,Ar,BD,AZ],function(BO){var BP=BO.name;BN[BP]=BN[BP]||BO[BN.pt]||BO._def;});});function At(BP,BO,BM){var BN=BM[BP.ps]=BM[BP.ps]||{};BO=BP.encode(BO);BG.forEach([].concat(BP.pn),function(BQ){BN[BQ]=BO;});return BM;}function AF(BS,BR,BM){var BQ=BS.x;if(BQ){if((BQ&Aj)>0){var BP=!!BR.c1,BO=0;if(BP){At(BS,BR.c1,BM);var BN=BM[Q];BN.GradientColor=BS.encode(BR.c2);BN.GradientAngle=BR.or?0:90;BN.GradientXOffset=0;BN.GradientYOffset=0;BO=2;}else{if(BS.encode(BR)===-1){BO=1;}else{At(BS,BR,BM);}}return At(AL[D],BO,BM);}}return null;}mstrmojo.models.FormatModel={getFormatUpdate:function AT(BN,BQ,BM){var BP=AL[BN];if(!BP){throw new Error("Invalid property "+BN+" in FormatModel::getFormatUpdate.");}BM=BM||{};var BO=AF.call(this,BP,BQ,BM);if(BO){return BO;}return At(BP,BQ,BM);},getFormatPropertyInfo:function l(BM){return AL[BM];},getValueFromUpdate:function K(BN,BO){var BQ=AL[BN],BM=null;try{BM=BO[BQ.ps][BQ.pn];}catch(BP){}return BM;},getGradientValues:function AE(BN){var BM=BN.fx&&BN.fx.gd;if(BM){var BP={c1:BM.sc,c2:BM.ec,or:BM.t};return BP;}if(BN[D]===2){var BO={c1:BN.bc,c2:BN.gdc,or:BN.gda===90?0:1};return BO;}return null;},decodeValue:function x(BM,BN){return AL[BM].decode(BN);},updateFormatBlock:function Ao(BM,BN,BO){return AL[BN].update(BM,BO);},getFormatBlockValue:function w(BM,BN){return AL[BN].extract(BM);},GradientType:null,FormatObjectType:null,PROPERTY_INFO_TYPE:null,ENUM_PROPERTY_NAMES:{NAME:g,HEIGHT:M,WIDTH:BH,WIDTH_MODE:AB,PAGE_WIDTH:A6,MARGIN_LEFT:W,MARGIN_RIGHT:A7,USE_PAGE_WIDTH_AS_LAYOUT_WIDTH:t,FONT_FAMILY:p,FONT_SIZE:Ae,FONT_WEIGHT:BA,FONT_STYLE:AC,UNDERLINE:BB,LINE_THROUGH:m,COLOR:r,TEXT_ALIGN:U,VERTICAL_ALIGN:q,TEXT_WRAP:AY,TEXT_DIRECTION:AI,TEXT_OVERFLOW:a,BACKGROUND_COLOR:Ai,FILL_STYLE:D,BORDER_TOP_COLOR:H,BORDER_RIGHT_COLOR:Ah,BORDER_BOTTOM_COLOR:AR,BORDER_LEFT_COLOR:o,BORDER_TOP_STYLE:k,BORDER_RIGHT_STYLE:BJ,BORDER_BOTTOM_STYLE:A1,BORDER_LEFT_STYLE:AX,BORDER_COLOR:AO,BORDER_STYLE:Aw,Z_INDEX:c,SHOW_TITLE_BAR:AP,TITLE:h,CONTROL_STYLE:Av,CONTROL_ORIENTATION:v,CONTROL_ORIENTATION_BEHAVIOR:Au,CONTROL_MULTISELECT:f,CONTROL_ITEM_WIDTH_MODE:C,CONTROL_METRIC_CONDITION_TYPE:A8,CONTROL_SHOW_ELEMENT_COUNT:Ax,CONTROL_EXPORT_AS_SHOWN_ON_WEB:n,LAYOUT_XML:AH,LOCK_ASPECT_RATIO:J,IMAGE_SIZE_MODE:Ag,SHOW_HEADER:e,MERGE_HEADER:Ay,LOCK_HEADER:BI,LONG_NAME:Ac,SHOW_ALL_ROWS:AG,HIDE_NULL:B,IMAGE_WIDTH:Aa,IMAGE_HEIGHT:AW,VISIBLE:AS,LAYOUT_TAB_POSITION:AK,GRID_VERTICAL_PADDING:Y,GRID_HORIZONTAL_PADDING:Ad,REFRESH:R,JOIN_ACROSS_DATASET:BK,MCE_JOIN_TO_GET_DATA_COMBINATION:Al,FULL_SCREEN_MODE:A2,SELECTOR_SELECTION_COLOR:A5,SELECTOR_SELECTION_FILL_STYLE:b,VIZ_HIGHLIGHTING:AA}};}());(function(){mstrmojo.requiresCls("mstrmojo.css");var F=mstrmojo.css,E="px",J="hasOwnAvatar",I={x:0,y:0};function B(L){var K=this.createAvatar(L.src.node,L);if(K){F.addClass(K,[this.avatarCssClass,J]);this.avatar=L.avatar=document.body.appendChild(K);}}function C(){var K=this.avatar;if(K){K.parentNode.removeChild(K);delete this.avatar;F.removeClass(K,[this.avatarCssClass,J]);}}mstrmojo._HasOwnAvatar=mstrmojo.provide("mstrmojo._HasOwnAvatar",{_mixinName:"mstrmojo._HasOwnAvatar",draggable:true,ownAvatar:true,avatarCssClass:"",restrictedToAxis:undefined,isDragValid:function H(K){if(this._super){return this._super(K);}return false;},ondragstart:function D(K){B.call(this,K);this.positionAvatar(K.src.pos,K);if(this._super){this._super(K);}},ondragmove:function A(K){this.positionAvatar(K.tgt.pos,K);if(this._super){this._super(K);}},ondragend:function A(K){C.call(this);if(this._super){this._super(K);}},createAvatar:mstrmojo.emptyFn,positionAvatar:function G(O,L){var N=this.avatar.style,M=this.restrictedToAxis,K=(L&&L.dragOffsets)||I;if(M!=="y"){N.left=O.x+K.x+E;}if(M!=="x"){N.top=O.y+K.y+E;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var S=mstrmojo.css,D=mstrmojo.dom,I=mstrmojo.array,J=[],E=null,K=function(V){return(V&&V.rw&&V.rw.row&&V.rw.row.tc)||0;},B=function(W,V){if(V){if(W===1){return mstrmojo.desc(11944,"1 of 1 Row selected");}return mstrmojo.desc(11945,"# of ## Rows selected").replace("##",W).replace("#",V);}return W===1?mstrmojo.desc(11946,"1 Row"):mstrmojo.desc(11947,"## Rows").replace("##",W);},H=function(){var a="",X,Y,b=J[0]&&J[0].parentNode.firstChild,V=this.hiddenField,Z=J.length,W=K(this.gridData);for(X=0;b&&X<b.childNodes.length;X++){Y=b.childNodes[X].innerText||b.childNodes[X].textContent;a+=Y?(Y+"\t"):"";}a+="\n";J.forEach(function(c){for(X=0;X<c.childNodes.length;X++){Y=c.childNodes[X].innerText||c.childNodes[X].textContent;a+=Y?(Y+"\t"):"";}a+="\n";});V.value=a;V.focus();V.select();a=B(W,Z);this.viewDataDialog.tools.rowCount.set("text",a);},M=function M(Y,V){var W=this.controller,X=W.cmdMgr;X.getInterimCmd().submitInterim(Y,W._getXtabCallback(this,V||{}),{preserveUndo:true});},G=function G(W,V){M.call(this,this.controller.dataService().getUpdateTemplateAction(this.k,W),V);},P=function(W,Y){var V=I.indexOf(J,W),X=V>-1;if(X||Y===false){J.splice(V,1);}if(!X||Y===true){J.push(W);E=W;}S.toggleClass(W,"selected",!X||Y===true);},C=function C(){J.forEach(function(V){S.removeClass(V,"selected");});J=[];};mstrmojo.vi.ui.rw._IsViewDataGrid=mstrmojo.provide("mstrmojo.vi.ui.rw._IsViewDataGrid",{_mixinName:"mstrmojo.vi.ui.rw._IsViewDataGrid",submitUndoRedoActionsWithCallback:function A(V,W){M.call(this,V,W);},doSelection:function N(p,V,c){if(c.getAttribute("r")==="0"){var q=this.getCellForNode(c);if(q.at&8&&D.getButton(V,p)!==D.MOUSE_BUTTON.RIGHT){this.sort(q);}return ;}if(c&&~c.className.indexOf("xtab-td")){var d=D.isMetaKey(V,p),n=D.shiftKey(V,p),Z=D.findAncestorByName(c,"tr",true,this.domNode),W=D.findAncestorByName(c,"tbody",true,this.domNode);if(d||(n&&!E)){P(Z);}else{if(n&&W){var Y=D.findAncestorByName(E,"tbody",true,this.domNode),o=this.zone.rowsPerPage,m=function(e){return e.tBodyN*o+e.index;},h=function(e){return this.zone.tableNode.childNodes[e+1].childNodes;}.bind(this),a={row:E,tBodyN:parseInt(Y.getAttribute("n")||0),index:I.indexOf(Y.childNodes,E),body:Y},f={row:Z,tBodyN:parseInt(W.getAttribute("n")||0),index:I.indexOf(W.childNodes,Z),body:W},g,X,l,k,b;if(m(a)<m(f)){g=a;X=f;}else{g=f;X=a;}P(g.row,true);if(g.tBodyN===X.tBodyN){b=g.body.childNodes;for(k=g.index+1;k<X.index;k++){P(b[k]);}}else{for(l=g.tBodyN;l<=X.tBodyN;l++){if(l===g.tBodyN){b=g.body.childNodes;for(k=g.index+1;k<b.length;k++){P(b[k]);}}else{if(l===X.tBodyN){b=X.body.childNodes;for(k=0;k<X.index;k++){P(b[k]);}}else{b=h(l);for(k=0;k<b.length;k++){P(b[k]);}}}}}P(X.row,true);}else{C();P(Z,true);}}}else{C();}H.call(this);},onclick:function U(Z,V){if(!this.interactiveCellsArray.length){return ;}Z=Z.e||Z;var W=mstrmojo.dom,Y=W.eventTarget(V,Z),X=Y&&W.findAncestorByName(Y,"td",true,this.viewport);if(X){this.doSelection(Z,V,X);W.clearBrowserHighlights();}},changeColumnWidth:function L(Z,X,Y,W,V){G.call(this,this._super(Z,X,Y,W,V,true));},postBuildRendering:function O(){this._super();var V=K(this.gridData);this.viewDataDialog.tools.rowCount.set("text",B(V));},lastSortedCell:[],sort:function Q(d,b){var W=d._ei,a=b===undefined,c=a?true:!!b,V=this.lastSortedCell,X={success:function(){try{var k=this.tableContainerNode.lastElementChild.firstChild.firstChild.firstChild.lastChild.firstChild.childNodes,f=this.tableContainerNode.childNodes[1].firstChild.firstChild.lastChild.firstChild.childNodes,g;for(g=0;g<k.length;g++){if(W===Number(k[g].getAttribute("ei"))){S.addClass(k[g],c?"asc":"desc");S.addClass(f[g],c?"asc":"desc");}}}catch(h){}}.bind(this)};if(V){if(V[0]===W){c=a?!V[1]:b;}}V[0]=W;V[1]=c;var Z=this.controller,e=Z.getSorts(this.model.getSortAction(d,c)),Y={act:"sort",sorts:e.sorts,nodeKey:this.k,subTotalsPos:e.subTotalsPos};G.call(this,Y,X);},pivot:function F(V,W){var X=this.model.getPivotAction(V,W);G.call(this,X);},selectAll:function R(){var W=this.zone,X=W.tableNode.childNodes,Z,Y,a,V,b,c=true;C();for(Z=0;Z<X.length;Z++){a=X[Z];if(a.tagName.toLowerCase()==="tbody"){V=a.getAttribute("n")||0;if(!W.pageStatus[V].isOnDemand()){b=a.childNodes;for(Y=0;Y<b.length;Y++){if(!c){P(b[Y],true);}c=false;}}}}H.call(this);},isMultiSelect:false,onHandleDblClick:function T(){var V={act:"changeXtabColWidthScenario",value:2};G.call(this,V);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css");var A=mstrmojo.css;mstrmojo.ui._HasUITheme=mstrmojo.provide("mstrmojo.ui._HasUITheme",{_mixinName:"mstrmojo.ui._HasUITheme",themeClassName:"",postBuildRendering:function B(){var D=this.themeClassName;if(D){this.onthemeClassNameChange({value:D});}return this._super();},onthemeClassNameChange:function C(D){var F=this.domNode;if(F){var G=D.value,E=D.valueWas;if(G){A.addClass(F,D.value);}if(E){A.removeClass(F,D.valueWas);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.css","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.elementHelper");var R=mstrmojo.css,O=mstrmojo.hash,G=mstrmojo.dom,L=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType,Q=mstrmojo.elementHelper,S={cssClass:"grpHlt",top:"grpT",bottom:"grpB",left:"grpL",right:"grpR",midHoriz:"grpMidH",midVert:"grpMidV"},F=function(Y,X){var V=this.zone;X=X||(V&&V.tableNode);if(X){var W=[],Z=X.tBodies,a=function(d,c){var f=d.length,b=-1,e;while(f-b>1){if(d[e=f+b>>1].getAttribute("ei")<c){b=e;}else{f=e;}}return(d[f]&&parseInt(d[f].getAttribute("ei"),10)===c)?d[f]:null;};L.forEach(Y,function(c){var f=c._ei,d;for(d=0;d<Z.length;d++){var b=Z[d],e=a(b.getElementsByClassName(c.css),f);if(e){W.push(e);}}});return W;}return[];},E=function(V){var X=this.model.getCellDataUnion(V),W={};L.forEach(X,function(Y){W[Y.tid]=[{id:Y.eid,n:Y.v}];});return W;},T=function(a){var Z=a[O.keyarray(a)[0]],V=O.keyarray(Z),X,Y=this,W=this.model,b={};return F.call(this,L.filter(this.interactiveCellsArray,function(d){if(d.hasOwnProperty("mix")){var e=E.call(Y,d);X=L.filter(V,function(f){var g=W.getLinkedAttributes(f),h=false;if(!!e[f]){b[f]=f;h=true;}else{L.forEach(g,function(k){if(!!e[k]){b[f]=k;h=true;return false;}});}return h;});var c=false;O.forEach(a,function(f){L.forEach(X,function(g){if(!W.compareElementsId(e[b[g]][0].id,f[g][0].id)){c=false;return false;}c=true;});if(c){return false;}});return c;}return false;}));},C=function(Z,d){var e=(function(){var g=[];O.forEach(Z,function(h){O.forEach(h,function(k,l){L.forEach(k,function(m){g.push([l,m.id]);});});});return g;}()),c,a=this,V=L.filter(this.interactiveCellsArray,function(h){c=false;var k=!h.hasOwnProperty("mix")&&h._e&&h.fi===undefined,g=!k&&E.call(a,h);if(k){L.forEach(e,function(l){if((!d||a.model.getCellTitleInfo(h).title.id===l[0])){c=a.model.compareElementsId(h._e.id,l[1]);}if(c){return false;}});}else{if(!d&&g){O.forEach(g,function(l){L.forEach(e,function(m){L.forEach((l||[]),function(n){if(n.id){c=a.model.compareElementsId(n.id,m[1]);}});if(c){return false;}});if(c){return false;}});}}return c;}),b=F.call(this,V),f=[],Y,X,W;if(d){f=b;}else{L.forEach(b,function(g){Y=V[L.find(V,"_ei",g.getAttribute("ei"))];if(Y.axis===1){var l=0,k=g.rowSpan||1,h=g.parentNode;do{W=h.childNodes;for(X=0;X<W.length;X++){f.push(W[X]);}}while((++l<k)&&(h=h.nextSibling));}else{f.push(g);}});}return f;},K=function(V){if(!this.getFormatTargetFromCell){return[];}var W=this.id;return F.call(this,L.filter(this.interactiveCellsArray,function(X){return mstrmojo.all[W].getFormatTargetFromCell(X)===V;}));},J=function(){var X=[],Y;if(this.getFormatTargetFromCell){L.forEach(this.interactiveCellsArray,function(Z){if(this.getFormatTargetFromCell(Z)!==2){return false;}X.push(Z);return true;},this);}var W=this.xtabClonedNodes;if(W){var V=L.filterOne(W,function(Z){return Z.lockType===2;});if(V){Y=V.domNode.getElementsByTagName("table")[0];}}return F.call(this,X,Y);},H=function(V,W,Y){var X=["xtabSel"].concat(G.isIE||G.isIEW3C?"ie":[],"sc_"+this.k);if(!W||Y){X.push("range");}if(!W){X=X.concat(O.valarray(S));}R.toggleClass(V,X,W);};mstrmojo.vi.ui.rw._XtabHighlights=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabHighlights",{_mixinName:"mstrmojo.vi.ui.rw._XtabHighlights",highlights:null,highlight:function I(X,Z,V){if(this._super){this._super.apply(this,arguments);}var Y=mstrmojo.vi.ui.rw.SelectionType,W=[];this.clearHighlights();switch(X){case Y.METRICS:W=T.call(this,Z);break;case Y.ATTS:W=C.call(this,Z,V);break;}this.highlightCells(W,V);},highlightRange:function U(W,Z){var X=mstrmojo.vi.ui.rw.SelectionType,Y=Z?this.highlights.slice():null,V=[];this.clearHighlights();switch(W){case X.COL_HEADERS:V=J.call(this);break;case X.ROW_HEADERS:V=K.call(this,3);break;case X.METRIC_VALUES:V=K.call(this,4);break;}L.forEach(V,function(c){var b=true;if(Y){var a=L.indexOf(Y,c);b=a===-1;if(!b){Y.splice(a,1);}}H.call(this,c,true,b);},this);this.highlights=V;},clearSelections:function D(){if(this._super){this._super();}this.clearHighlights();},clearHighlights:function B(){L.forEach(this.highlights,function(a){H.call(this,a,false);},this);this.highlights=[];try{var W=this.getCellForNode(this.lastSelectedCell),Z=W&&this.gridData.gts[W.axis===1?"row":"col"],V=Z&&Z[W.tui||W.ui],X=V&&V.id;if(X){this.zone.clearHilites(X);}}catch(Y){}},highlightCellsById:function N(a,Z,Y){var X=this.model,V=function(b,c,d){return b[c]&&b[c]._e&&b[c]._e[d]===a;},W=F.call(this,L.filter(this.interactiveCellsArray,function(c){var b=false;if(Z===A.DssTypeMetric){b=V(c,"_tp","oid")||V(c,"_lp","oid");}else{if(Z===A.DssTypeAttribute){if(Y){b=V(c,"_tp","id")||V(c,"_lp","id");}else{if(X&&X.getNormalizedFormElementId&&c._e&&c._e.id){b=Q.getAttributeId(X.getNormalizedFormElementId(c._e.id))===a;}}}}return b;}));this.clearHighlights();this.highlightCells(W);},highlightCells:function(W,V){if(this._super){this._super(W,V);}L.forEach(W,function(X){H.call(this,X,true);},this);this.highlights=W;},configureActions:function M(){if(this._super){this._super();}if(!!this.selectorControl){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}},highlightGroupCells:function P(W,V){var X=[];L.forEach(W,function(Z){var d=Z[0]&&Z[0].axis||1,e=(d===1),a=this[e?"clonedRowHeader":"clonedColHeader"],c=(a?a.getTableNode():this.zone.tableNode),b=F.call(this,Z,c),Y=b.length;X=X.concat(b);L.forEach(b,function(k,f){var h=S,g=[h.cssClass];if(Y>1){if(e){g.push(f>0?(f<Y-1?h.midVert:h.bottom):h.top);}else{g.push(f>0?(f<Y-1?h.midHoriz:h.right):h.left);}}R.addClass(k,g);},this);},this);this.highlights=X;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css");var G=mstrmojo.array,F=mstrmojo.expr,H=mstrmojo.css;mstrmojo._IsExprNode=mstrmojo.provide("mstrmojo._IsExprNode",{ind:function B(){var L=this.parent;if(L&&L.indent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.indent(K);}}},out:function D(){var L=this.parent;if(L&&L.outdent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.outdent(K);}}},andOrTxt:function A(){var M=this.parent,K=M&&M.data,L="",N=this.data;if(K&&(K.et===F.ET.ANDOR)&&K.fn){L=K.fn+(N&&N.not?"_"+F.FN.NOT:"");L=F.BRANCH_FNS[L];}return'<span class="mstrmojo-text mstrmojo-andor">'+L+"</span>";},getPrefixAndOrToolsMarkup:function(){return('<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5896,"Ungroup Conditions")+"</span>");},premousedown:function J(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e);if(this.prefixHoverNode&&mstrmojo.dom.contains(this.prefixHoverNode,L,false)){mstrmojo.dom.stopPropogation(K.hWin,K.e);return ;}if(this._super){this._super(K);}},isSelectableArea:function E(K){return true;},childIndex:function I(){var M=this.parent,K=M&&M.data,L=K&&K.nds,N=this.data;if(L&&N){return G.indexOf(L,N);}return -1;},toggleGroupBorder:function C(K){H.toggleClass(this.parent.itemsContainerNode.childNodes[this.childIndex()-1].firstChild,"upgroup",K);H.toggleClass(this.domNode,"downgroup",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var V=mstrmojo.dom,U=mstrmojo.hash,W=mstrmojo.array,J=function J(u,r){var t=this.getCellForNode(u),q=this.getCellForNode(r);return !t||!q||t.hasOwnProperty("mix")===q.hasOwnProperty("mix");},l=function l(t,u,v){var q=t.childNodes.length,r;for(r=0;r<q;r++){if(t.childNodes[r]===u){return r+(v||0);}}return -1;},G=function G(u){var t=[],q=this.zone.tableNode.tBodies,r;W.forEach(q,function(v){for(r=0;r<v.childNodes.length;r++){t.push(v.childNodes[r]);}if(u&&v.childNodes.length<this.zone.rowsPerPage){t.push.apply(t,new Array(this.zone.rowsPerPage-v.childNodes.length));}},this);return t;},R=function R(){var r=0,q=this.zone.tableNode.tBodies;W.forEach(q,function(t){r+=t.childNodes.length;},this);return r;},C=function C(r,u){var t=G.call(this,true)[u],q;for(q=0;q<t.childNodes.length;q++){if(k.call(this,t.childNodes[q])>r){return null;}if(k.call(this,t.childNodes[q])===r){return t.childNodes[q];}}},Q=function Q(q){var r=this.getCellForNode(q);return r&&r.o+Z.call(this)||0;},k=function k(q){var r=this.getCellForNode(q);return r&&r.colIx||0;},A={REPLACE_ALL:1,REMOVE:2,APPEND:3,TOGGLE:4},f={CONTROL:"Ctrl",SHIFT:"Shft",SINGLE:"Single"},Z=function Z(){return this.rhsCP.startIndexInContainer;},L=function L(r,t){var q=this.rhsCP.getUnmergedCells(r)||[];if(q.length>t){return q[t];}else{return this.rhsCP.getCell(r,t-q.length);}},P=function P(AC,x,q){var w=AC.o,r=w,u=AC._gd,AB=AC._e&&AC._e.id,AA,z=this.zone.searchRow(w+x),v,t=AC.colIx;if(z!==null){v=q===1?z.max-x:z.min;while(Math.abs(w-v)>0){AA=L.call(this,w+q,t);if(!AA||AB!==(AA._e&&AA._e.id)||(r!==AA.o&&u===AA._gd)){break;}w+=q;}return w+x;}else{return null;}},Y=function(q){var u=this.model.getCellDataUnion(q),r={},t;W.forEach(u,function(v){t=v.v;if(r[v.tid]&&r[v.tid][0]&&r[v.tid][0].n){t=r[v.tid][0].n+":"+v.v;}r[v.tid]=[{id:v.eid,n:t}];});return r;},d=function d(r){if(!r){return null;}if(!this.selectSiblings(r)){return[r];}var v=[],AD=this.getCellForNode(r),AJ=this.gridData,AI=AJ.gsi,x,AH,w,AC,AE,AA,t,AG,z,q,u,AF=function(AL,AK){var AM=true;if(AL.length===AK.length){W.forEach((AL||[]),function(AN){AM=AM&&W.find(AK,"id",AN.id)!==-1;return AM;});return AM;}return false;},AB=this.model.getCellInfo(AD);if(AB.isMetric){if(AI.tma===2){x=r.parentNode.childNodes;for(AH=0;AH<x.length;AH++){z=true;w=this.getCellForNode(x[AH]);if(w&&w.hasOwnProperty("mix")){q=Y.call(this,w);u=Y.call(this,AD);t=U.keyarray(q);AG=U.keyarray(u);if(!!t.length&&t.length===AG.length){W.forEach((t||[]),function(AK){z=z&&AF(q[AK],u[AK]);return z;},this);}else{z=false;}if(z){v.push(x[AH]);}}}}else{v.push(r);}}else{if(this.isSelectAllCell(r)){v.push(r);}else{if(AD&&AD._e&&AD.axis===1){AC=G.call(this,false);W.forEach((AC||[]),function(AK){for(AH=0;AH<=AK.childNodes.length;AH++){AA=AK.childNodes[AH];w=this.getCellForNode(AA);if(w&&w._e){if(this.model.compareElementsId(AD._e.id,w._e.id)){v.push(AA);}}}},this);}else{if(AD&&AD._e&&AD.axis===2){x=r.parentNode.childNodes;for(AH=0;AH<x.length;AH++){z=true;w=this.getCellForNode(x[AH]);if(w&&w._e){if(AD._e.id===w._e.id){v.push(x[AH]);}}}}}}}return v;},a=function a(){this.selCells=[];this.clearSelections();},S=function S(t){var r=this,q=r.getCellForNode(t);this.selCells=W.filter(this.selCells,function(v){var u=r.getCellForNode(v);return u&&q&&(u.tui||u.ui)!==(q.tui||q.ui);});this.clearUnitSelections(this.model.data.gts[q.axis===1?"row":"col"][q.tui||q.ui].id);},o=function o(t){var r=this.isSelectAllCell(t),u=this.getCellForNode(t),v=this.model.getCellInfo(u),q=this.model.getCellTitleInfo(u);if(!r){if(W.indexOf(this.selCells,t)===-1){this.selCells.push(t);}}else{if(!u.hasOwnProperty("mix")){var w=v.isMetric?"Metrics":(q.title&&q.title.id),z=this.model.scm,x=w&&z&&z[w];if(x&&(x.all||x.showall)){this.addAttributeSelection(q.title.id,"OA:(All)","all");}}return ;}if(u.hasOwnProperty("mix")){this.addMetricValueSelection(Y.call(this,u));}else{this.addAttributeSelection(q.title.id,u._e.id,u._e.n);}},H=function H(q){var t=this.selCells.indexOf(q),r=this.getCellForNode(q);this.selCells.splice(t,1);if(r.hasOwnProperty("mix")){this.removeMetricValueSelection(Y.call(this,r));}else{this.removeAttributeSelection(this.model.getCellTitleInfo(r).title.id,r._e.id);}},B=function B(q){return W.some(this.model.getCellDataUnion(this.getCellForNode(q)),function(r){return r.isSubtotal;});},T=function T(t,v,r){var u,q,w=this;if(U.isEmpty(t)&&(!r&&this.clearAllSelections&&this.clearAllSelections())){a.call(this);}t=W.filter((t||[]),function(x){return !B.call(w,x);});W.forEach(t,function(x){q=v;u=~W.indexOf(this.selCells,x);if(A.TOGGLE===q){q=u?A.REMOVE:A.APPEND;}if(A.REPLACE_ALL===q){if(r){S.call(this,x);}else{a.call(this);}v=q=A.APPEND;}switch(q){case A.APPEND:o.call(this,x);break;case A.REMOVE:H.call(this,x);break;}},this);},I=function I(w,z,r,u){var t=Math.min(z,u),v=Math.min(w,r),AE=Math.max(z,u),q=Math.max(w,r),AB,AA,AD=[],AC=function(x,AF){W.forEach((AF||[]),function(AG){if(W.indexOf(x,AG)===-1){x.push(AG);}});};for(AB=v;AB<=q;AB++){for(AA=t;AA<=AE;AA++){AC(AD,d.call(this,C.call(this,AB,AA)));}}T.call(this,AD,A.APPEND);},X=function X(q,x){var z,v=this.selectorControl&&this.selectorControl.showall,AA=!!this.defn.msuc,r=this.isSelectAllCell(x),AB=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),t=!this.selectorControl&&(AB&&AB.length>0),AC,u,AE,w,AD=this.parent&&this.parent.defn&&this.parent.defn.t===527;if(AD){AA=!!this.parent.defn.msuc;}if(t){if(!AA){q=f.SINGLE;}AE=this.getCellForNode(x);u=AE&&AE.id;w=W.find(AB,"did",u);if(w>=0){AC=AB[w].sc;v=AC.showall||AC.all;}}if(x.attributes.getNamedItem("ei")!==null&&(t||(!B.call(this,x)&&(v||!r)))){z=this.getSelectionHash();if(U.isEmpty(z)){this.selCells=[];}if(q===f.SINGLE&&x.className.indexOf(this.CELL_HIGHLIGHT)!==-1&&this.selCells.length>0){if(g.call(this,x)){q=f.CONTROL;this.xTabHiddenTextArea.blur();}}this.clearHighlights();this["on"+q+"Select"](x,t);this.lastSelectedCell=x;if(q!==f.SHIFT){this.shiftInfo={lastCell:x,selCells:[].concat(this.selCells)};}this.markSelections();this.endSelections();}},g=function g(x){var t=this.selCells,v=true;if(this.selectSiblings(x)){var r=this.getCellForNode(t[0]),q=this.model.getCellInfo(r).isMetric,u=q?r._ei:r._e&&r._e.id,w=q?r._tp&&r._tp._e&&r._tp._e.id:undefined;v=!W.some(t,function(z){z=this.getCellForNode(z);if(q){return z._tp._e.id===w&&z._ei!==u;}else{return z._e&&z._e.id!==u;}}.bind(this));}else{if(t.length>1){v=false;}}return v;};mstrmojo.vi.ui.rw._IsMultiselectXtab=mstrmojo.provide("mstrmojo.vi.ui.rw._IsMultiselectXtab",{_mixinName:"mstrmojo.vi.ui.rw._IsMultiselectXtab",selCells:[],lastSelectedCell:null,isMultiSelect:false,getLastSelectedCell:function F(){return this.lastSelectedCell;},onCtrlSelect:function b(q,r){T.call(this,d.call(this,q),A.TOGGLE,r);},onShftSelect:function p(AH,t){if(t){return this.onSingleSelect(AH,t);}var r=this.shiftInfo.lastCell;if(J.call(this,AH,r)){this.selCells=[].concat(this.shiftInfo.selCells);var AC=Z.call(this),AD,v,AA,u,AB,AF,AE=k.call(this,r),z=k.call(this,AH),q=parseInt(r.getAttribute("r"),10),AG=parseInt(AH.getAttribute("r"),10),x=this.model.getCellInfo(this.getCellForNode(AH));if(x.isMetric){AD=q;v=AG;}else{if(AE===z){AB=this.getCellForNode(r);AF=this.getCellForNode(AH);}else{var w=Math.min(AE,z);AB=L.call(this,q-AC,w);AF=L.call(this,AG-AC,w);if(this.zone.searchRow(AB.o+AC)===null){AB=this.getCellForNode(r);}if(this.zone.searchRow(AF.o+AC)===null){AF=this.getCellForNode(AH);}}AA=(AB.o<AF.o)?AB:AF;AD=P.call(this,AA,AC,-1);u=(AB.o>AF.o)?AB:AF;v=P.call(this,u,AC,1);}I.call(this,AE,AD,z,v);}},onSingleSelect:function O(q,r){T.call(this,d.call(this,q),A.REPLACE_ALL,r);},handleSelection:function E(w,q,v){var u=v&&V.findAncestorByName(v,"td",true,this.viewport),t=J.call(this,u,this.lastSelectedCell),x,r=w.button===2||V.isMac()&&V.ctrlKey(q,w)&&w.button===0;if(!(this.isSelected(u)&&r)){if(V.isMetaKey(q,w)&&t){x=f.CONTROL;}else{if(V.shiftKey(q,w)&&t){x=f.SHIFT;}else{x=f.SINGLE;}}X.call(this,x,u);}},markSelections:function D(){this.highlightCells(this.selCells);},handlesMultiSelection:function e(q){return(this._super&&this._super(q))||this.isMultiSelect;},isSelected:function n(q){return W.indexOf(this.selCells,q)!==-1;},addSelection:function N(q){if(!this.isSelected(q)){X.call(this,f.CONTROL,q);}},onclick:function c(r){V.clearBrowserHighlights();var u=r.getTarget&&r.getTarget();if(this.handlesMultiSelection(r)){if(mstrApp.isExpress){var t=u&&V.findAncestorByName(u,"td",true,this.viewport),q=V.findAncestorByName(u,"span",true,t);if(q){this.handleSelection(r.e,r.hWin,u);}}else{this.handleSelection(r.e,r.hWin,u);}}else{this._super(r);}},singleUnitSelect:function h(){var r=this.lastSelectedCell,q=this.getCellForNode(r);this.defaultAction(r,q);},getActionCells:function K(q){var t=this,r=W.map(W.filter(this.selCells,function(v){var u=t.getCellForNode(v);return u&&q&&(u.tui||u.ui)===(q.tui||q.ui);}),function(u){return t.getCellForNode(u);});if((r.length===0)||!this.model.getCellTitleInfo(q).isSrcTitle){r=this._super(q);}return r;},openXtabCellMenu:function M(t){var q=mstrmojo.findAncestor(this,"openXtabCellMenu");if(q){if(t.evt){if(V.isMetaKey(t.hWin,t.evt)){var r=t.td&&V.findAncestorByName(t.td,"td",true,this.viewport);this.addSelection(r);}}q.openXtabCellMenu(t);if(this.parent&&this.parent.selectVIUnit){this.parent.selectVIUnit();}}},highlightCells:function(r,q){if(this._super){this._super(r,q);}if(q){this.selCells=r;}},selectSiblings:function(){return true;},isSelectAllCell:function m(t){var q=this.getCellForNode(t),r=q&&this.model.getCellDataUnion(q);return !!q&&(r.length===0||(r.length===1&&!r[0].eid));}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom");var D=mstrmojo.dom,H=D.position,I=Math;function F(U,P,N){var O=this._ellTestNodes||{},K=O[U],M=mstrmojo.css.getComputedStyle(P),J=["width","height"];if(N){J.reverse();}var S=J[0],Q=J[1];if(!K||!D.contains(this.domNode,K.n,true,document.body)){var L=P.cloneNode(true);L.removeAttribute("id");L.removeAttribute("onclick");var T=L.style;T.position="absolute";T.top="-10000px";T.maxHeight=T.maxWidth="none";T[S]="auto";P.parentNode.appendChild(L);var R=parseInt(M["max-"+S],10);if(isNaN(R)){R=parseInt(M[S],10);}K=O[U]={n:L,m:R,d:S.substr(0,1)};if(K.m>0){this._ellTestNodes=O;}}else{K.n.innerHTML=P.innerHTML;}K.n.style[Q]=M[Q];return K;}function B(K,L){var M=this.ellipsisText;switch(this.ellipsisPosition){case"middle":var J=I.floor(L/2);return K.slice(0,J).join("")+M+K.slice(-J).join("");case"end":return K.slice(0,L).join("")+M;default:return K.join("");}}var G=4;mstrmojo._SupportsEllipsisText=mstrmojo.provide("mstrmojo._SupportsEllipsisText",{_mixinName:"mstrmojo._SupportsEllipsisText",ellipsisText:"\u2026",ellipsisPosition:"end",ellipsize:function A(U,P,O){var V=P.innerHTML;if(!V){return false;}var K=F.call(this,U,P,O),M=function(){var W=H(K.n)[K.d];return(W<=K.m);};if(M()){return false;}var L=K.n,J=V.split(""),R=0,N=J.length,Q,S;while(R<N){var T=I.floor((R+N)/2);V=L.innerHTML=B.call(this,J,T);if(M()){R=T+1;}else{N=T-1;}if(N-R<G){for(S=R-1;S<N+1;S++){V=L.innerHTML=B.call(this,J,S);if(!M()){break;}Q=V;}}if(Q){P.innerHTML=Q;break;}}return true;},ellipsizeElements:function C(T,O,N){var L=F.apply(this,arguments),M=function(){var U=H(L.n)[L.d];return(U<=L.m);};if(M()){return false;}var Q=this.ellipsisText;var P=this;var K=document.createElement("span");K.innerHTML=Q;var J=function(Y,X){var U=Y.slice(0,X).concat([K]);var W=document.createElement("div");for(var V=0;V<U.length;V++){W.appendChild(U[V]);}return W.innerHTML;};var S=function(V,Z,Y,U){var b=0,W=Z.length,a,e,c;var X=function(f){while(f.hasChildNodes()){f.removeChild(f.lastChild);}};while(b<W){var d=I.floor((b+W)/2);if(U){e=Y.call(P,Z,d);V.nodeValue=e;}else{X(V);e=Y.call(P,Z,d);V.innerHTML=e;}if(M()){b=d+1;}else{W=d-1;}if(W-b<G){c=b==0?0:b-1;for(;c<W+1;c++){if(U){e=Y.call(P,Z,c);V.nodeValue=e;}else{X(V);e=Y.call(P,Z,c+1);V.innerHTML=e;}if(!M()){if(!U){V.removeChild(V.lastChild);a=e=V.innerHTML;}break;}if(!U){V.removeChild(V.lastChild);e=V.innerHTML;}a=e;}}if(a){if(U){V.nodeValue=a;}else{V.innerHTML=a;}break;}}};var R=function(X){if(X.nodeType==3){var Y=X.nodeValue;if(!Y){return false;}S(X,Y.split(""),B,true);return true;}else{var V=X.childNodes;if(!V||V.length===0){return false;}var W=[];for(var U=0;U<V.length;U++){W[U]=V[U];}if(W.length!=1||W[0].nodeType!=3){S(X,W,J,false);}return R(X.lastChild);}};O.style.visibility="visible";L.n.style.visibility="hidden";R(L.n);O.style.visibility="hidden";L.n.style.visibility="visible";return true;},unrender:function E(J){delete this._ellTestNodes;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash");var K=1,B=2;function N(Q,P){return D(Q,P)&&Q.o===P.o;}function D(Q,P){return Q&&P&&Q.ui===P.ui&&Q.axis===P.axis&&Q.mix===P.mix;}function A(T,Q,R){var S=R.getCellTitleId(Q),P=R.getCellUnitIndex(Q);R.selections[S]=R.selections[S]||{};R.selections[S][P]=R.selections[S][P]||[];R.selections[S][P].push(T);M(T,Q,R);}function M(T,Q,R){if(Q){var S=R.getCellTitleId(Q),P=R.getCellUnitIndex(Q);if(!R.selectionsForCopy){R.selectionsForCopy={};}R.selectionsForCopy[S]=R.selectionsForCopy[S]||{};R.selectionsForCopy[S][P]=R.selectionsForCopy[S][P]||[];R.selectionsForCopy[S][P].push(T);C(T);}}function O(Q){var U=Q.selectionsForCopy;for(var T in U){for(var S in U[T]){for(var R=0,P=U[T][S].length;R<P;R++){J(U[T][S][R]);}}}Q.selections={};Q.selectionsForCopy={};}function C(P){mstrmojo.css.setOpacity(P,50);if(P.nodeName.toLowerCase()==="td"&&mstrmojo.dom.isIE8){mstrmojo.css.addClass(P,"showGridBorder");}}function J(P){mstrmojo.css.setOpacity(P,100);if(P.nodeName.toLowerCase()==="td"&&mstrmojo.dom.isIE8){mstrmojo.css.addClass(P,"showGridBorder");}}function F(R,S){if(R.mix===undefined){var V=S.gridData.gts[R.axis===K?"row":"col"],Q=V[R.tui||R.ui],U=0;for(var T=0,P=V.length;T<P;T++){if(V[T].id===Q.id){U++;}}return U;}return 0;}function H(){var Q="_xtabSelectionsHiddenField",P;P=document.getElementById(Q);if(!P){P=document.createElement("textarea");P.id=Q;P.style.opacity=0;P.style.position="absolute";P.style.top=0;P.style.height=0;P.style.width=0;document.body.appendChild(P);}return P;}function G(){var W="",Y={},R,b=[],f=[],Q={},S={},P=this.selectionsForCopy,V=mstrmojo.hash,X=mstrmojo.array,d=function(g,h){if(g.hasOwnProperty("mix")){return h.es[g.mix].n;}else{return h.n;}},T,Z,U,e,c,a=0;V.forEach(P,function(h,g){V.forEach(h,function(k){X.forEach(k,function(l){a++;Z=l.offsetLeft;U=l.offsetTop;if(!Y[Z]){Y[Z]={};}R=Y[Z];R[U]=l.innerText;if(X.indexOf(b,Z)==-1){b.push(Z);}if(X.indexOf(b,U)==-1){f.push(U);}e=this.getCellForNode(l);c=this.model.getCellTitleInfo(e).title;if((!c.id&&c.axis==K)||(c.id&&c.axis==B)){S[U]=d.call(this,e,c);}else{Q[Z]=d.call(this,e,c);}},this);},this);},this);b.sort(function(h,g){return h-g;});f.sort(function(h,g){return h-g;});if(a>1&&!V.isEmpty(S)){W="\t";}if(a>1&&!V.isEmpty(Q)){X.forEach(b,function(g){W+=(Q[g]||"")+"\t";});W+="\n";}X.forEach(f,function(g){if(a>1&&!V.isEmpty(S)){W+=(S[g]||"")+"\t";}X.forEach(b,function(h){W+=(Y[h][g]||"")+(a>1?"\t":"");});if(a>1){W+="\n";}});T=H();T.value=W;T.focus();T.select();}mstrmojo._XtabSelections={lastSelectedTD:null,singleSelectForCopy:function I(P){var U=this.getCellForNode(P),b,c,Z,a=U&&U.mix!=undefined,S=function(e,d){d=d||{};e=e||{};if(a){return e.mix==d.mix;}else{return e.mix==d.mix&&e.ui==d.ui;}};Z=mstrmojo.dom.findAncestorByName(P,"table",false);c=Z.rows;for(var V=0,W=c.length;V<W;V++){var Y=c[V].cells;for(var T=0,R=Y.length;T<R;T++){var Q=Y[T],X=this.getCellForNode(Q);if(Q!=P&&S(X,U)){M(Q,X,this);}}}},singleSelect:function E(Q,Y){var W=this.getCellForNode(Q),f=Q.parentNode;if(Y){var V=this.getCellTitleId(W),b=this.getCellUnitIndex(W);selectedTitle=this.selections[V];selectedUnit=selectedTitle&&selectedTitle[b];if(selectedUnit){for(var X=0,Z=selectedUnit.length;X<Z;X++){J(selectedUnit[X]);}delete selectedTitle[b];return ;}}var U=F(W,this);if(W.axis===K){for(var X=0,P=0,Z=f.cells.length;X<Z&&P<U;X++){var S=f.cells[X],a=this.getCellForNode(S);if(N(a,W)){A(S,a,this);P++;}}}else{if(W.axis===B){var d=mstrmojo.dom.findAncestorByName(Q,"table",false),e=d.rows;for(var X=0,P=0,Z=e.length;X<Z&&P<U;X++){var c=e[X].cells;for(var T=0,R=c.length;T<R;T++){var S=c[T],a=this.getCellForNode(S);if(N(a,W)){A(S,a,this);P++;break;}}}}else{A(Q,W,this);}}},rangeSelect:function L(h,k){var e=this.getCellForNode(h),P=this.getCellForNode(k);if(D(e,P)){if(e.o>P.o||e._ei>P._ei){var n=h;h=k;e=this.getCellForNode(h);k=n;P=this.getCellForNode(k);}var a=F(e,this),Q=e.axis,l=mstrmojo.dom.findAncestorByName(h,"table",false),X=l.rows,f=h.parentNode,o=f.rowIndex,Z=f.cells,c=k.parentNode.rowIndex;if(Q===K){for(var d=o;d<=c;d++){var R=X[d].cells,S=false;for(var b=0,g=R.length,T=0;b<g&&T<a;b++){var V=R[b],Y=this.getCellForNode(V);if(D(Y,e)){A(V,Y,this);T++;}}}}else{if(Q===B){for(var d=0,g=X.length,m=0;d<g&&m<a;d++){var R=X[d].cells,W=false;for(var b=0,U=R.length;b<U;b++){var V=R[b],Y=this.getCellForNode(V);if(N(Y,e)){W=true;}if(W){A(V,Y,this);}if(N(Y,P)){break;}}if(W){m++;}}}else{if(o==c){for(var d=h.cellIndex,g=k.cellIndex;d<=g;d++){var V=Z[d],Y=this.getCellForNode(V);A(V,Y,this);}}else{for(var d=o,g=c;d<=g;d++){var R=X[d].cells;for(var b=0,U=R.length;b<U;b++){var V=R[b],Y=this.getCellForNode(V);if(D(Y,e)){A(V,Y,this);break;}}}}}}}},doSelection:function(W,V,T){var X=mstrmojo.dom,P=X.ctrlKey(V,W),Q=X.shiftKey(V,W);if(!P){O(this);}var U=this.getCellForNode(T);var R=U&&(U.mix===undefined&&U.o!==undefined),S=U&&(U.mix!==undefined&&(U._lp||U._tp));if(R||S){if(Q){this.rangeSelect(this.lastSelectedTD,T);}else{this.singleSelect(T,P);this.lastSelectedTD=T;}}else{this.singleSelectForCopy(T,P);}G.call(this);}};})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.fx.AnimateProp");var S=mstrmojo.css;var Q=10;function C(W,Z,Y){W.pauseScrollRendering(true);var X=W.scrollboxNode,V=W.animate?W.scrollEffect:null;if(V&&V.play){if(V.isPlaying){V.cancel();}V.props={scrollTop:{start:X.scrollTop,stop:Z,isStyle:false}};V.onEnd=function(){W.pauseScrollRendering(false,null,Y);};V.play();}else{X.scrollTop=Z;W.pauseScrollRendering(false,null,Y);}}function K(c,e,V){var W=4;if(!V){V=0;}var f=Math.round(c.renderBlockSize/2);c.fillAt(Math.max(0,e-f),e+f);var b=c.itemsContainerNode,a=b.childNodes[e],Z=c.listMapper.itemOffsetTop(c,b,null,a),d=parseInt(c.scrollboxNode.clientHeight/2,10)-a.offsetHeight/2,X=Math.max(0,c.spacerMargin+Z-d);if(Math.abs(c.scrollboxNode.scrollTop-X)>2){C(c,X,c.renderOnScroll?function(){if(V<=W){K(c,e,V++);}}:null);}else{var Y=c.animate?c.scrollEffect:null;if(Y&&Y.isPlaying&&Y.cancel){Y.cancel();c.pauseScrollRendering(false);}}}function J(X){var Y=X.itemsContainerNode,V=Y.lastChild,W=V?V.offsetTop+V.offsetHeight-Y.firstChild.offsetTop:0;return W;}function U(W){var V=J(W),X=Math.max(0,parseInt((W.scrollboxNode.clientHeight-V)/2,10));C(W,Math.max(0,W.spacerMargin-X));}function H(X){var V=X.selectedIndex,W=V>-1;X.set("hasSelection",W);if(!X.domNode){return ;}if(W){K(X,V);}else{U(X);}}function E(W){var Y=W.scrollboxNode,V=J(W),X=V>Y.clientHeight/2;S.toggleClass(W.upArrowNode,["enabled"],X);S.toggleClass(W.downArrowNode,["enabled"],X);}function N(V,W){var X=V.scrollboxNode;X.scrollTop=Math.min(Math.max(X.scrollTop+W,0),X.scrollHeight-X.offsetHeight);}function B(W,V){if(!W._scrollInter){var X=Q*(V?-1:1);W._scrollInter=window.setInterval(function(){N(W,X);},50);}}function R(V){if(V._scrollInter){window.clearInterval(V._scrollInter);V._scrollInter=null;}}mstrmojo._IsDial=mstrmojo.provide("mstrmojo._IsDial",{markupString:'<div id="{@id}" class="mstrmojo-Dial {@cssClass}" style="position:relative;"><div class="mstrmojo-Dial-uparrow"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], true)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], true)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"></div><div class="mstrmojo-Dial-scrollbox {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-Dial-spacer" style="{@spacerCssText}"><div class="mstrmojo-Dial-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div></div></div><div class="mstrmojo-Dial-dnarrow" onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], false)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], false)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.childNodes[1];},spacerNode:function(){return this.domNode.childNodes[1].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},upArrowNode:function(){return this.domNode.childNodes[0];},downArrowNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){S.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);}},animate:true,itemsEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:500,interval:25,slot:"itemsContainerNode",preStart:function(){var W=this.widget[this.slot],V=(W&&W.offsetWidth)||0;this.props=V?{left:{start:-V,stop:0,suffix:"px",isStyle:true}}:{};},revertOnCancel:false},scrollEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:250,interval:25,slot:"scrollboxNode",revertOnCancel:false},multiSelect:false,holdJumpOnly:true,audibles:{"*":true,hasSelection:false},initSpacer:function I(){var V=(this.cssText||"").match(/height:\s*(\d*)px/);if(V){this.spacerMargin=parseInt(Number(V[1])/2,10);var W=this.spacerMargin+"px";this.spacerCssText="padding-top: "+W+"; padding-bottom: "+W+";";}else{this.spacerMargin=0;delete this.spacerCssText;}},center:function T(){H(this);},preBuildRendering:function(){this.initSpacer();return this._super();},postBuildRendering:function D(){this._super();this.center();E(this);},refreshScroll:function G(){this.center();E(this);},prechange:function O(V){this._super(V);if(this.hasRendered){if(!this.multiSelect||(V&&V.added&&V.added.length)){this.center();}}},onclickarrow:function A(X,W,V){N(this,Q*(V?-1:1));},onmouseoverarrow:function L(X,W,V){if(!this.holdJumpOnly){B(this,V);}},onmouseoutarrow:function M(X,W,V){R(this);},onmousedownarrow:function F(X,W,V){if(this.holdJumpOnly){B(this,V);}},onmouseuparrow:function P(X,W,V){R(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.css");var E=null;function D(H){var G=1;if(H.tstp===769){G=2;}else{if(H.tstp===774){G=3;}}return G;}function B(K){var G=mstrApp.name,J=G+"?",H=-1,I=function(M,L){J+=M+"="+L+"&";};if(!!K){switch(K.ttp){case 3:I("evt","4001");I("reportID",K.tid);H=D(K);if(H!==-1){I("reportViewMode",H);}break;case 55:if(K.tstp===14080){I("evt","32001");I("documentID",K.tid);}else{if(K.tvmd&(8192|2048)&&!((K.tvmd&2048&&mstrApp.features["run-vi-flash"]))){I("evt","3140");I("documentID",K.tid);if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(12187,"To work with HTML5 dashboards, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}}else{I("evt","2048001");I("objectID",K.tid);I("visMode","0");}}break;}}return J;}mstrmojo._HasDocLink=mstrmojo.provide("mstrmojo._HasDocLink",{_mixinName:"mstrmojo._HasDocLink",url:"",target:"",linkEnabled:true,ifw:"",update:function F(G){var H=G.defn;this.url=G.data.url||H.url;if(H.target){this.target=H.target;}if(H.ifw){this.ifw=H.ifw;}this._super(G);},postBuildRendering:function A(){if(this.url||this.ifw){mstrmojo.css.addClass(this.domNode,"hasLink");}var H=this.controller&&this.controller.view,G=H&&H.getCurrentLayout&&H.getCurrentLayout();if(G&&G.addLinkInfo){G.addLinkInfo(this.id,{url:this.url,target:this.target,src:this});}return this._super();},setLinkEnabled:function C(K){this.linkEnabled=K;var J=this.domNode;if(!J){return ;}var L=J.childNodes,I=L[L.length-1],G=this.id+"_mask",H=(I.id===G)?I:null;if(K){if(H){J.removeChild(H);delete this._mask;}}else{if(!H){H=document.createElement("div");H.className="mstrmojo-DocLinkMask";H.id=G;H.innerHTML="&nbsp;";J.appendChild(H);}}},cancelDocLink:false,onclick:function(){if(E===null){var H=this,G=function(){if(H.linkEnabled&&!H.isEditing){var K=H.drillLinkItems,I=K&&K[0],J=H.url||(I&&I.url);if(H.ifw){H.model.showInfoWin(H.ifw,(H.getAnchor&&H.getAnchor())||H.domNode,"v",true);}else{if(J){H.model.executeLink(J,H.target,H);}else{if(H.node&&H.node.data&&H.node.data.tid){J=B(H.node.data);if(!!J){H.model.executeLink(J,H.target,H);}}}}}};E=window.setTimeout(function(){if(!H.cancelDocLink){G();}H.cancelDocLink=false;E=null;},200);}},hasActiveLink:function(){var I=false;if(this.linkEnabled){var J=this.drillLinkItems,G=J&&J[0],H=this.url||(G&&G.url);if(this.node&&this.node.data&&this.node.data.tid){I=true;}else{if(H){I=true;}}}return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var H=mstrmojo.hash,E=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=H.clone(I);O.data=M;O.parent=N;return E.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length),N,I;for(N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L,O,I,R;for(O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}var M,Q,K;for(M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},H.copy(mstrmojo.ListBuilder)));}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var B=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(mstrmojo.Base,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",id:"",init:function I(J){this.disposables=[];this._super(J);B.add(this);if(this.postCreate){this.postCreate();}},addDisposable:function G(M){var K=this.disposables,L,J;if(M.constructor===Array){for(L=0,J=M.length;L<J;L++){K.push(M[L]);}}else{K.push(M);}return M;},destroyDisposables:function D(J){F.forEach(this.disposables,function(K){if(K.destroy){K.destroy(J);}else{if(K.clear){K.clear();}}});this.disposables=[];},throwAbstractMethodError:function A(J){throw new Error(this.scriptClass+" must implement "+J+".");},destroy:function H(J){if(this.destroyed){return ;}this._super(J);this.destroyDisposables(J);B.remove(this);delete this.parent;this.destroyed=true;}});var C=mstrmojo.Obj;C.free=function E(J){if(J instanceof C){J.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.DropZoneHelper");var A="mstrmojo-VIUnitList",G="icn clsx_sub",B=mstrmojo.vi.viz.DropZoneHelper.isMetricNames;mstrmojo.vi.ui.VIDragUnit=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.ui.VIDragUnit",getItemDisplayName:function F(I){return I.n;},getUnitAvatar:function D(L){var K=document.createElement("div"),N=L.getCtxtDragData(),I=N.items,J=['<div class="',[A,mstrApp.getThemeClassName()].join(" "),'">'],M=this;I.forEach(function(P){var Q=M.getItemDisplayName(P),O="item unit isAvatar ic"+P.t;if(P.t===12&&P.st&&P.st===3076){O+=" st"+P.st;}if(B(P)){Q=mstrmojo.desc(3582,"Metrics");O+=" is-mh";}J.push('<div class="'+O+'"><span class="txt" unselectable="on">'+Q+"</span></div>");});J.push("</div>");K.innerHTML=J.join("");return K.removeChild(K.firstChild);},getUnitDragData:function C(K,I){var J=this.setAvatarClass.bind(this);return{items:I,item:I[0],setAvatarClass:function L(N){J(K,N);},setInvalidAvatarClass:function M(){J(K,G);}};},getDragUnitOffsets:function H(){return{x:21,y:16};},setAvatarClass:function E(L,I){var J=L.avatar;if(J){var K=[A,"hasOwnAvatar",mstrApp.getThemeClassName(),I||""];J.className=K.join(" ");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.chart.common.DSSTimeUtil");var H=24*60*60*1000;var A=60*60*1000;var L=60*1000;var C=1000;var K=24;var D=24*60;var J=24*60*60;var B=new mstrmojo.chart.common.DSSTimeUtil();mstrmojo.chart.common.DSSDateTime=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSDateTime",mnYear:1899,mnMonth:12,mnDay:30,mnHour:0,mnMinute:0,mnSecond:0,mnMillisecond:0,mnWeek:-1,mnDayOfWeek:-1,init:function P(T){if(!T||!T.ifTime){this.mnYear=1899;this.mnMonth=12;this.mnDay=30;this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;this.mnWeek=-1;this.mnDayOfWeek=-1;return ;}var S=0;var V=23242571;var R=-693593;if(T.ifTime>V){this.mnYear=65535;this.mnMonth=12;this.mnDay=30;S=T.ifTime-Math.floor(T.ifTime);}else{if(T.ifTime<R){this.mnYear=1;this.mnMonth=1;this.mnDay=1;S=Math.abs(T.ifTime)+Math.ceil(T.ifTime);}else{if(T.ifTime>0){var W=this.DAYSToYMD(Math.floor(T.ifTime));this.mnYear=W.year;this.mnMonth=W.month;this.mnDay=W.day;S=T.ifTime-Math.floor(T.ifTime);}else{if(T.ifTime<0){var W=this.DAYSToYMD(Math.ceil(T.ifTime));this.mnYear=W.year;this.mnMonth=W.month;this.mnDay=W.day;S=Math.abs(T.ifTime)+Math.ceil(T.ifTime);}}}}S*=H;var U=S+0.5;if(U==H){U--;}if(U>0){this.mnHour=Math.floor(U/A);U-=this.mnHour*A;this.mnMinute=Math.floor(U/L);U-=this.mnMinute*L;this.mnSecond=Math.floor(U/C);U-=this.mnSecond*C;this.mnMillisecond=Math.floor(U);}else{this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;}this.mnWeek=-1;this.mnDayOfWeek=-1;this.Sanitize();},Sanitize:function O(){var R=false;if(this.mnHour==24&&this.mnMinute==0&&this.mnSecond==0){R=true;this.mnHour=0;}if(this.mnMonth<1){this.mnMonth=1;}else{if(this.mnMonth>12){this.mnMonth=12;}}if(this.mnDay<1){this.mnDay=1;}else{if(this.mnDay>B.DaysInMonth[this.mnMonth-1]){this.mnDay=B.DaysInMonth[this.mnMonth-1];if(this.mnMonth==2&&this.IsLeapYear(this.mnYear)){this.mnDay++;}}}if(this.mnHour<0){this.mnHour=0;}else{if(this.mnHour>23){this.mnHour=23;}}if(this.mnMinute<0){this.mnMinute=0;}else{if(this.mnMinute>59){this.mnMinute=59;}}if(this.mnSecond<0){this.mnSecond=0;}else{if(this.mnSecond>59){this.mnSecond=59;}}if(this.mnMillisecond<0){this.mnMillisecond=0;}else{if(this.mnMillisecond>999){this.mnMillisecond=999;}}if(R){var S=this.ToMilliseconds();S=S+H;this.init({ifTime:this.MillisecondsToDATE(S)});}},IsLeapYear:function Q(R){return((R&3)==0)&&((R%100)!=0||(R%400)==0);},ToMilliseconds:function I(){var R=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var S=R*H;S+=this.mnHour*A+this.mnMinute*L+this.mnSecond*C+this.mnMillisecond;return S;},MillisecondsToDATE:function E(S){var R=Math.floor(S/H);var T=(S-R*H)/H;if(T<0){R--;T+=1;}return R>=0?R+T:R-T;},DAYSToYMD:function N(T){var W=0;var Y=0;var S=0;T+=693959;var V=Math.floor(T/365);var U=T-V*365;var X=Math.floor(V/4)-Math.floor(V/100)+Math.floor(V/400);U=U-X;if(U<0){V--;U+=365;while(U<=0){V--;U+=365;}}var R=T-(V*365+Math.floor(V/4)+(V%4?1:0)-Math.floor((V-1)/100)+Math.floor((V-1)/400));if(R==365&&!this.IsLeapYear(V)){W=V+1;Y=1;S=1;return{year:W,month:Y,day:S};}if(R==-1){W=V-1;Y=12;S=31;return{year:W,month:Y,day:S};}W=V;Y=12;while(R<B.DaysBeforeMonth[Y-1]){Y--;}S=R-B.DaysBeforeMonth[Y-1]+1;if(Y>2&&this.IsLeapYear(W)){S--;if(S==0){Y--;S=B.DaysInMonth[Y-1];if(Y==2){S++;}}}return{year:W,month:Y,day:S};},YMDToDAYS:function G(U,T,S){if(T<1||T>12){return 0;}var R=U*365+Math.floor(U/4)+(U%4?1:0)-Math.floor((U-1)/100)+Math.floor((U-1)/400);R+=B.DaysBeforeMonth[T-1];if(T>2&&this.IsLeapYear(U)){R++;}R+=S-1;R-=693959;return R;},ToDATE:function F(){var S=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var R=this.mnHour/K+this.mnMinute/D+this.mnSecond/J+this.mnMillisecond/H;if(S>=0){return S+R;}else{return S-R;}},DateTimeOrder:function M(R){if(this.mnYear>R.mnYear){return 1;}else{if(this.mnYear<R.mnYear){return -1;}}if(this.mnMonth>R.mnMonth){return 1;}else{if(this.mnMonth<R.mnMonth){return -1;}}if(this.mnDay>R.mnDay){return 1;}else{if(this.mnDay<R.mnDay){return -1;}}if(this.mnHour>R.mnHour){return 1;}else{if(this.mnHour<R.mnHour){return -1;}}if(this.mnMinute>R.mnMinute){return 1;}else{if(this.mnMinute<R.mnMinute){return -1;}}if(this.mnSecond>R.mnSecond){return 1;}else{if(this.mnSecond<R.mnSecond){return -1;}}if(this.mnMillisecond>R.mnMillisecond){return 1;}else{if(this.mnMillisecond<R.mnMillisecond){return -1;}}return 0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([\- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')}};var H=mstrmojo.validation,B=H.TRIGGER,b=H.STATUSCODE,A={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,17:3,18:3,21:2,22:2,23:3,24:4,25:3,30:5,34:5};H.VALIDATOR={DEMO:function N(e){var d=parseInt(e,10),f=mstrmojo.validation.STATUSCODE;if(d===0||d===1||d>10){return{code:f.VALID};}return{code:f.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function I(d){var e=String(d).replace(/[^\d]/g,"");if(e.length<10){return{code:b.INVALID,msg:mstrmojo.desc(9203,"A telephone number must contain at least 10 digits.")};}if(!H.REGEXP.PHONE_NUMBER.test(d)){return{code:b.INVALID,msg:mstrmojo.desc(9204,"The telephone number contains invalid characters.")};}return{code:b.VALID};},VALIDATE_ZIPCODE:function G(d){var f="",e=this.dtp;if(!H.REGEXP.US_ZIP.test(d)){if(H.isNumeric(e)||H.isInt(e)){f=mstrmojo.desc(9208,"A zip code must be 5 digits or 5+4 digits.");}else{if(H.isString(e)){f=mstrmojo.desc(9206,"The zip code is invalid");}}return{code:b.INVALID,msg:f};}return{code:b.VALID};},VALIDATE_EMAIL:function T(d){var e=d.indexOf("@");if(e===-1){return{code:b.INVALID,msg:mstrmojo.desc(9197,"The email address is missing an at sign (@).")};}if(d.substring(e).indexOf(".")===-1){return{code:b.INVALID,msg:mstrmojo.desc(9198,"The email address is missing a period on the domain.")};}return H.REGEXP.EMAIL_ADDRESS.test(d)?{code:b.VALID}:{code:b.INVALID,msg:mstrmojo.desc(9207,"The email address is invalid.")};},VALIDATE_SSN:function Q(d){var f=this.dtp,e;if(H.isNumeric(f)||H.isInt(f)){e=String(d).replace(/[^\d]/g,"");if(e.length!==9){return{code:b.INVALID,msg:mstrmojo.desc(9209,"A Social Security Number must be 9 digits.")};}}if(!H.REGEXP.SOCIAL_SECURITY_NUMBER.test(d)){return{code:b.INVALID,msg:mstrmojo.desc(9210,"The Social Security Number is invalid.")};}return{code:b.VALID};}};H.isInt=function D(d){return A[d]===1;};H.isNumeric=function Y(d){return A[d]===2||A[d]===5;};H.isString=function J(d){return A[d]===3;};var C=window.mstrConfig,L=C.listSep,S=mstrmojo.expr,M=S.DTP,Z=mstrmojo.num,U=mstrmojo.string,F=mstrmojo.date;function P(m,n){var h=m.dtp,l=m.constraints,p=l.allowedFormatChars||"",g=(A[h]===1),d=(A[h]===2),e=(A[h]===6),o=mstrmojo.locales.number.THOUSANDSEPARATOR,f=mstrmojo.locales.number.DECIMALSEPARATOR,k;if(g){if(!m._intRegExp){p+="0-9-"+(m.isList?L:"")+o;m._intRegExp=new RegExp("[^"+p+"]");}k=m._intRegExp;}if(d){if(!m._numericRegExp){p+="0-9-"+(m.isList?L:"")+f+o;m._numericRegExp=new RegExp("[^"+p+"]");}k=m._numericRegExp;}return !!k&&k.test(n);}function c(m,o){var h=m.dtp,l=m.constraints,g=(A[h]===1),d=(A[h]===2),e=(A[h]===6),f=l.min,n=l.max,k;if(f===undefined&&n===undefined){return false;}if(g||d){return Z.inNumericRange(o,f,n)!==0;}if(e){return F.inDateTimeRange(o,f,n)!==0;}return false;}function K(e,d){return !Z.isNumeric(d);}function R(g,e){var f=(g.dtp===M.DATE),d=(g.dtp===M.TIME);return(f?!F.isDate(e):(d?!F.isTime(e):!F.isDateAndOrTime(e)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:M.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function W(d){this._super(d);if(!this.constraints){this.constraints={};}var e=this.constraints;if(!e.hasOwnProperty("trigger")){e.trigger=B.NONE;}},_set_value:function(k,f){var g=this.value,e=(g!==f);if(e){this.value=f;var h=this.constraints.trigger,d=(h&B.VALUESET)>0;if(d){this.validate(f);}}return e;},validate:function O(){var f=(this.value!==null&&this.value!==undefined)?this.value:"",k=this.isList?f.split(L):[f],h,e,l,d=k.length,g;for(g=0;g<d;g++){h=this.doValidation(k[g]);e=(h.code>b.VALID);if(e){if(d>1){h.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",k[g]||" ");}break;}}l=e?"onInvalid":"onValid";if(!e&&this.autoFormat){this.format();}this.set("validationStatus",h);if(this[l]){this[l](h);}},format:function X(){var k=this.dtp,f=(A[k]===6);if(!f){return ;}var m=mstrConfig.listSep,p=this.value||"",e=this.isList?p.split(m):[p],o=k===14,n=[],d,g=mstrmojo.locales.datetime,l=e.length,h;for(h=0;h<l;h++){p=e[h];d=F.parseDateAndOrTime(p);if(d){if(o&&d.date){n.push(F.formatDateInfo(d.date,g.DATEOUTPUTFORMAT));}else{n.push((d.date?F.formatDateInfo(d.date,g.DATEOUTPUTFORMAT):"")+" "+(d.time?F.formatTimeInfo(d.time,g.TIMEOUTPUTFORMAT):""));}}}this.set("value",n.join(m));},isValid:function V(){var d=this.validationStatus;if(!d){this.validate();}return this.validationStatus.code===b.VALID;},clearValidation:function a(){this.set("validationStatus",{code:b.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function E(t){var o=this.constraints,p=o.regExp,f=o.validator,d={id:this.id,code:b.VALID,msg:""},n=this.dtp,m=(A[n]===1),e=(A[n]===2||A[n]===5),g=(A[n]===3),h=(A[n]===6),l=U.isEmpty(t),q=String(t).length,k="",w=mstrmojo.locales.validation;if(this.required&&l){d.code=b.INVALID_EMPTY;d.msg=w.requiredFieldError;return d;}t=U.trim(t);if(!l&&P(this,t)){if(m){k=w.integerDataType;}if(e){k=w.numericDataType;}if(h){k=w.dateDataType;}d.code=b.INVALID_CHAR;d.msg=w.invalidCharError.replace("#",k);return d;}if(!l&&h&&R(this,t)){d.code=b.INVALID_BAD_DATESTRING;d.msg=w.invalidDateStringError;return d;}if(!l&&(e||m)&&K(this,t)){d.code=b.INVALID_BAD_NUMERICFORMAT;d.msg=w.invalidNumericFormatError;return d;}if(!l&&(m||e||h)&&c(this,t)){d.code=b.INVALID_OUTOFRANGE;if(o.min!==null&&o.max!==null){k=w.outofRangeError.replace("# ","").replace("##",o.min).replace("###",o.max);}else{if(o.min!==null){k=w.noLessMinError.replace("##",o.min).replace("# ","");}else{if(o.max!==null){k=w.noGreaterMaxError.replace("###",o.max).replace("# ","");}}}d.msg=k;return d;}if(g&&o.minLen!==null&&o.maxLen!==null){if(q<o.minLen||q>o.maxLen){d.code=b.INVALID;d.msg=mstrmojo.desc(9211).replace(/#/,o.minLen).replace(/##/,o.maxLen);return d;}}if(p&&!p.test(t)){d.code=b.INVALID_REGEX;d.msg=mstrmojo.desc(9205);return d;}var u=f&&f.apply(this,[t]);if(u){d.code=u.code;d.msg=u.msg;return d;}return d;}});}());(function(){mstrmojo.requiresCls("mstrmojo.num","mstrmojo.hash","mstrmojo.string","mstrmojo.array");var A=mstrmojo.num,D=mstrmojo.hash,C=mstrmojo.string,B=mstrmojo.array;mstrmojo.MetricSelectorUtility=mstrmojo.provide("mstrmojo.MetricSelectorUtility",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},OP_NAMES:[{n:mstrmojo.desc(2795,"Equals"),v:0},{n:mstrmojo.desc(2796,"Does not equals"),v:1},{n:mstrmojo.desc(521,"Greater than"),v:2},{n:mstrmojo.desc(522,"Greater than or equal to"),v:3},{n:mstrmojo.desc(523,"Less than"),v:4},{n:mstrmojo.desc(524,"Less than or equal to"),v:5},{n:mstrmojo.desc(696,"Between"),v:6},{n:mstrmojo.desc(746,"Not between"),v:7},{n:mstrmojo.desc(587,"In"),v:8},{n:mstrmojo.desc(2204,"Not In"),v:9},{n:mstrmojo.desc(2202,"Is null"),v:10},{n:mstrmojo.desc(2203,"Is not null"),v:11}],RANK_OP_NAMES:[{n:mstrmojo.desc(529,"Highest"),v:1},{n:mstrmojo.desc(530,"Lowest"),v:2},{n:mstrmojo.desc(4407,"Highest %"),v:3},{n:mstrmojo.desc(4406,"Lowest %"),v:4}],Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],EnumNumberCategory:{Default:-2,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7,Special:8,General:9,FromGrid:10},typeHelperCls:{0:"MetricValueSliderHelper",defaultCls:"MetricRankSliderHelper"},ErrorType:{_GENERIC:mstrmojo.desc(11689,"Invalid Number"),_RANK:mstrmojo.desc(11856,"Please enter value between ## and ###.")},getQuaByFunc:function(I,J){var F=this.F,E=this.Q,H=E._G,G=function(K){return B.indexOf(F[1],K)!==-1;};if(G(I)){H=(J===this._RANK)?E._RT:E._PT;}else{H=(J===this._RANK)?E._RB:E._PB;}return H;},getFuncInfo:function(H,I){var G={},F=this.Q,E=this.F;G[F._G]={ft:this._GENERIC,f:E[0][H]};G[F._RT]={ft:this._RANK,f:E[1][H]};G[F._RB]={ft:this._RANK,f:E[2][H]};G[F._PT]={ft:this._PERCENT,f:E[1][H]};G[F._PB]={ft:this._PERCENT,f:E[2][H]};return G[I]||{};},getOpIdxByfunc:function(G,H){if(!G||!H){return -1;}var E=this.F,F=-1;switch(H){case this._GENERIC:F=B.indexOf(E[0],G);break;case this._RANK:case this._PERCENT:F=B.indexOf(E[1],G);if(F===-1){F=B.indexOf(E[2],G);}break;}return F;},getIncludeByOp:function(F){var E=this.OP;return F===E._EQUALS||F===E._GREATER_EQUAL||F===E._LESS_EQUAL||F===E._BETWEEN||F===E._IN;},formatNumber:function(F,H,E){var I,G=this.Q,J=E.fm;if(!A.validateFormat(J)){J="#,##0.00;(#,##0.00)";}if(F===G._G){I=(J)?A.formatByMask(J,H):A.format(E.cat,E.dp,E.curr,H);}else{if(F===G._RB||F===G._RT){I=String(parseInt(H,10));}else{if(F===G._PB||F===G._PT){I=parseFloat(H)+"%";}}}return I;},doValidation:function(N,H,K){var J=H.qua,L=H.low,G=H.high,I=this.Q,O=J===I._RT||J===I._RB,E=J===I._PT||J===I._PB,M="",F;if(C.isEmpty(N)){M="emptyValueVIWarning";}else{if(!(A.isNumeric(N)||(E&&String(N).match(/^\d+(\.\d+)?%$/)))){M="invalidValueVIWarning";}else{if((J===I._PT||J===I._PB)&&A.inNumericRange(parseFloat(N),L,G)){M="outOfRangeVIWarning";F=E?["0","100%"]:[L,G];}else{if(O&&!A.isInt(N)){M="notIntegerVIWarning";}}}}return D.copy(K,{invalid:!!M,errorCode:M,args:F||[]});}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.expr");var C=mstrmojo.string,B=mstrmojo.expr,A=B.ET;mstrmojo.fe.FilterUtils=mstrmojo.provide("mstrmojo.fe.FilterUtils",{getExprXml:function(J){var E="<exp>",D="</exp>",H={a:true,a2:true,a3:true,agg:true,cc:true,ce:true,cgp:true,cs:true,conid:true,desc:true,did:true,attId:true,dmt:true,dmy:true,dtp:true,es:true,et:true,expr:true,f:true,flat:true,flt:true,fm:true,fm2:true,fm3:true,fn:true,fnt:true,fres:true,gb:true,isp:true,items:true,m:true,m2:true,m3:true,n:true,nds:true,not:true,pf:true,p:true,r:true,rps:true,st:true,t:true,utgt:true,utp:true,uts:true,v:true,xml:true,relation:true,applySubExpr:true,useSchema:true,guide:true,rsTp:true,joTp:true,paTp:true,erTp:true,exp:true,joAttrs:true,ph:true,idx:true,idc:true,idcsi:true,ucfg:true},G={getArrItemName:function(K){return K.substr(0,K.length-1);},isSerializable:function(U,S,R){if(U==="xml"){var M=S[R].xml;return{att:'hasXML = "-1"',child:M};}else{if(mstrmojo.array.indexOf(["header_format","grid_format","child_header_format","child_grid_format"],U)>-1){var V=S[R][U];if(!V){return{};}var O="<"+U+">";for(var T in V){O+="<prs n='"+T+"'>";var N=V[T];for(var K in N){var Q=N[K];O+="<pr n='"+K+"' v='"+(Q==="pru"?"":Q)+"'";O+=Q==="pru"?' pru="1"':"";O+="/>";}O+="</prs>";}O+="</"+U+">";return{child:O};}else{if(U==="cs"){var L=S[R],P=S[R][U];if(L&&L.fnt&&L.fnt==B.FNT.PER&&P){if(P[0]){P[0].v+="%";}if(P[1]){P[1].v+="%";}}return true;}}}return(H[U])?true:false;},skipNull:true},F=J;if(!F||F.et!=A.ANDOR){F={et:A.ANDOR,fn:B.FN.AND,nds:F?[F]:[]};}var I=C.json2xml("nd",[{},F],G);return E+I+D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.desc","mstrmojo.dom","mstrmojo.hash","mstrmojo.MetricSelectorUtility","mstrmojo.mstr.EnumDataType","mstrmojo._FormatDefinition","mstrmojo.num","mstrmojo.array");var M=mstrmojo.MetricSelectorUtility,I=mstrmojo.mstr.EnumDataType,U=mstrmojo._FormatDefinition.NumberFormatCategory,B=M.FN,Q=M.Q,C=M.OP,W=mstrmojo.num,H=Math.max,D=Math.min,A=Math.round;mstrmojo.vi.ui.rw.selectors.ISliderHelper=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.SliderHelper,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.ISliderHelper",initAsStaticStatus:function K(){var X=this.slider;X.staticStatus=X.disableDrag=this.isStatic();if(X.staticStatus){X.da.low=1;X.da.high=7;X.ft=M._GENERIC;X.f=B.BETWEEN;X.cs=[{n:"",v:1},{n:"",v:7}];X.numFmts={cat:9,dp:0,fm:""};}if(this.displayInvalid()){X.f=B.BETWEEN;X.cs=[];}},initialSlider:function V(){this.initAsStaticStatus();this.createDataRangeItems();this.updateCurrentSelectionFromModel();},createDataRangeItems:function L(){var Z=this.slider,h=this.fixDigitByNumFormat,a=this.notNull,b=Z.numFmts,k=Z.qua,Y=Z.da.cnt,X,e;switch(k){case Q._G:X=h(Z.da.low,b);e=h(Z.da.high,b);Z.step=this.getValueStep(X,e);break;case Q._RB:case Q._RT:X=Y?1:0;e=Y;Z.step=this.getValueStep(X,e);break;case Q._PB:case Q._PT:X=0;e=100;Z.step=this.getValueStep(X,e);break;}var d=this.isEmpty();Z.set("lowText",d?"":this.formatNumber(X));Z.set("highText",d?"":this.formatNumber(e));Z.low=X;Z.high=e;var g=[],f,c;if(a(X,e)){if(X+Z.step<=X){Z.set("validation",{refNode:Z.docSelector.parent.domNode,position:1,invalid:true,errorCode:"bigDecimalMetricSliderVIWaring"});}else{for(c=X;c<=e;c+=Z.step){g.push(this.getItem(k,c,b));}f=g.length;if(f>0){g[f-1]=this.getItem(k,e,b);}}}Z.items=g;Z.unit=this.getUnit();},getItem:function O(Y,Z,X){return{n:M.formatNumber(Y,Z,X),v:this.fixDigitByNumFormat(Z,X)};},getValueStep:function G(Z,a){var Y=this.slider,X=Y._effectiveLength;return this.fixDigitByNumFormat((a-Z)/(X-2),Y.numFmts)||1;},getIdxByValue:function J(Y){var X=this.slider;return D(H(A((Y-X.low)/X.step),0),X.items.length-1);},isStatic:function P(){var X=this.slider;return !this.notNull(X.da,X.da.low,X.da.high,X.da.cnt,X.qua);},isEmpty:function R(){var X=this.slider;return this.isStatic()||!!X.da.nov;},displayInvalid:function F(){var X=this.slider;var b=parseInt(X.ft,10),Z=parseInt(X.f,10),a,Y;if(b===M._GENERIC){a=Z===B.ISNULL||Z===B.ISNOTNULL||Z===B.NOTIN||Z===B.IN;}else{if(b===M._PERCENT||b===M._RANK){Y=Z===M.MRPFN.INASCENDING||Z===M.MRPFN.INDESCENDING||Z===M.MRPFN.NOTINDESCENDING||Z===M.MRPFN.NOTINASCENDING;}}return !!a||!!Y;},fixDigitByNumFormat:function E(Y,c){var a=parseInt(c.cat,10),X=(a===U.Custom&&c.fm&&c.fm.indexOf("%")>=0),Z=X?2:c.dp,b=(a===U.Percentage||a===U.General||X)?2:(a===U.Fraction)?4:0;return Number(Number(Y).toFixed(Math.min(Z+b,20)));},formatNumber:function N(c){var Z=this.slider,g=Math.abs(c),f=Z.numFmts.cat,Y=1000,h=["K","M","B","T","P","E","Z","Y"],d=h.length,b;if(g>=Y&&(f===U.Default||f===U.Fixed||f===U.General||f===U.Currency)){for(b=0;b<d;b++,Y*=1000){if(g<Y*1000){var X=g/Y,a=(X*10).toFixed(0)%10>0?1:0,e=X.toFixed(a)+h[b];return c<0?"("+e+")":e;}}}return M.formatNumber(Z.qua,c,Z.numFmts);},updateCurrentSelectionFromModel:function S(){var Z=this.slider,a=this.notNull,k=Z.cs,h=Z.f,e=Z.ft,X=Z.low,g=Z.high,m=Z.qua,c=Z.numFmts,d=(k&&k.length>0)?W.parseNumeric(String(k[0].v).replace("%","")):m?g:X,b=(k&&k.length>1)?W.parseNumeric(String(k[1].v).replace("%","")):g,Y=Z.include=Z.parent.include,l;if(Z.dt===I.DataTypeTimeStamp){c.fm=c.fm.replace(/\\/g,"");}if(m===Q._PT||m===Q._PB){d=(k&&k.length>0&&!String(k[0].v).match("%"))?d*100:d;}Z.frtUst=d<X;Z.ndUst=b>g;Z.unSet=!k||k.length===0;if(a(h,e)){l=M.getOpIdxByfunc(h,e);}else{if(Y){l=m?C._LESS_EQUAL:C._BETWEEN;}else{l=m?C._GREATER:C._NOT_BETWEEN;}}Z.opId=l;switch(l){case C._EQUALS:case C._NOT_EQUALS:Z.cs1Vl=Z.cs2Vl=d;break;case C._LESS_EQUAL:case C._GREATER:Z.cs1Vl=X;Z.cs2Vl=d;break;case C._GREATER_EQUAL:case C._LESS:Z.cs1Vl=d;Z.cs2Vl=g;break;case C._IN:case C._NOT_IN:case C._IS_NULL:case C._IS_NOT_NULL:break;default:Z.cs1Vl=d;Z.cs2Vl=b;break;}Z.cs1Idx=this.getIdxByValue(Z.cs1Vl);Z.cs2Idx=this.getIdxByValue(Z.cs2Vl);Z.cs1Nm=a(Z.cs1Vl)?M.formatNumber(m,Z.cs1Vl,c):Z.items[Z.cs1Idx].n;Z.cs2Nm=a(Z.cs2Vl)?M.formatNumber(m,Z.cs2Vl,c):Z.items[Z.cs2Idx].n;if(m){Z.rankon.selectItemByField("v",m);}},updateSelection:function T(){var Y=this.slider,a=Y.cs1Vl,Z=Y.cs2Vl,X=parseInt(Y.qua,10),b=Y.numFmts;Y.cs1Idx=this.getIdxByValue(a);Y.cs2Idx=this.getIdxByValue(Z);Y.cs1Nm=M.formatNumber(X,a,b);Y.cs2Nm=M.formatNumber(X,Z,b);Y.unSet=false;this.updateOpCs();Y.parent.node.data.cs=Y.cs;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.array","mstrmojo.vi.ui.theme","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui.VIDragUnit");var F=mstrmojo.css,D=mstrmojo.dom,A=mstrmojo.vi.ui.theme,E=mstrmojo.array;function C(M,N,L){var K=false;E.forEach(this.getSelectedItems(),function(O){if(O.itemNode===N){K=true;}});if(M&&!K){this.doItemSelect(M,L||{});}}mstrmojo.vi.ui._HasUnitListAvatar=mstrmojo.provide("mstrmojo.vi.ui._HasUnitListAvatar",mstrmojo.mixin({avatarCssClass:"mstrmojo-VIUnitList",getDragData:function J(K){var L=K.src.node,N=D.findAncestorByAttr(L,"idx",true,this.domNode);K.src.node=N?N.node:L;var M=(K.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit()).getUnitDragData(K,this.getSelectedItems());if(this.getItemDisplayName){mstrmojo.func.override({getItemDisplayName:this.getItemDisplayName},K.dragUnitHelper);}M.srcId=this.id;return M;},createAvatar:function B(L,K){return K.dragUnitHelper.getUnitAvatar(K);},selectDragNode:function I(K){var L=K.src;C.call(this,this.getItemFromTarget(L.node),this.getItemNodeFromTarget(L.node),L);},onItemContextMenu:function H(L,K){C.call(this,L,this.getItemNodeFromTarget(K.getTarget()),K);if(this._super){return this._super(L,K);}},positionAvatar:function G(L,K){K.dragOffsets=K.dragUnitHelper.getDragUnitOffsets();if(this._super){this._super(L,K);}}},mstrmojo.mixin(mstrmojo._HasOwnAvatar)));}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Obj","mstrmojo.string","mstrmojo.hash","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty");var D=mstrmojo.array,P=mstrmojo.expr,J=P.ET,I=P.TP,K=mstrmojo.mstr.EnumNodeDimty,N=P.ET2TGT,M=P.ET2COND,B=mstrmojo.meta.TP;function O(S,A){var R=(A&&A.did)?A.did.split(P.FN_SEP):null,E=R&&parseInt(R[0],10),Q=R&&parseInt(R[1],10),T=S.et;S.fnt=E;S.fn=Q;if(T!=J.AE&&P.fn_List(Q,E)){S.et=J.AL;S.a2=null;S.cs=null;}else{if(T==J.AL&&!P.fn_List(Q,E)){S.et=J.AQ;S.cs=null;}else{if(T==J.MC&&!P.fn_AC_MC(Q,E)){S.et=J.MQ;S.m2=null;}else{if(T==J.AC&&!P.fn_AC_MC(Q,E)){S.et=J.AQ;S.a2=null;}}}}switch(Q){case P.FN.IS_NULL:case P.FN.IS_NOT_NULL:S.a2=null;S.a3=null;S.fm2=null;S.fm3=null;S.m2=null;S.m3=null;S.cs=null;break;case P.FN.BETWEEN:case P.FN.NOT_BETWEEN:break;default:S.a3=null;S.fm3=null;S.m3=null;while(S.cs&&S.cs.length>1){S.cs.pop();}}}function F(W,X,Y){var E=true,A=2+X;switch(Y.t){case I.PROMPT:var U=W.cs,V;if(!U){U=[];W.cs=U;}U[X]={};V=U[X];V.p=Y;W["a"+A]=null;W["m"+A]=null;switch(W.et){case J.AC:W.et=J.AQ;break;case J.MC:W.et=J.MQ;break;}break;case I.METRIC:W["a"+A]=null;W.cs=null;W.et=J.MC;W["m"+A]=Y;break;case I.ATTR:W["m"+A]=null;W.cs=null;W.et=J.AC;W["a"+A]=Y;W["fm"+A]=null;break;default:W["a"+A]=null;W["m"+A]=null;var U=W.cs;if(!U){U=[];W.cs=U;}if("did" in Y){W["a"+A]=null;W["fm"+A]=null;W["m"+A]=null;if(U[X]&&U[X].p){U[X].p=null;}}else{if(Y&&Y.v!=null){U[X]=Y;}else{if(U[X]){U=U.splice(X,1);}}E=false;}if(!Y.skipET){switch(W.et){case J.MC:W.et=J.MQ;break;case J.AC:W.et=J.AQ;break;case J.AL:if(!("did" in Y)&&Y.v){var Q,S=Y.dtp,U=[];Q=Y.v.split(mstrConfig.listSep);for(var R=0,T=Q.length;R<T;R++){U.push({v:mstrmojo.string.trim(Q[R]),dtp:S});}W.cs=U;}break;}}}return E;}var H={};H[J.AQ]={target:1,fm:1,fn:1,cs:1};H[J.AL]={target:1,fm:1,fn:1,cs:1};H[J.AE]={target:1,fn:1,es:1};H[J.AC]={target:1,a2:1,a3:1,fm:1,fm2:1,fm3:1,fn:1};H[J.MQ]={target:1,fn:1,cs:1,dmy:1};H[J.MC]={target:1,fn:1,m2:1,m3:1,dmy:1};H[J.F]={target:1};H[J.R]=H[J.F];H[J.XML]={target:1};var G=function(A){return A!==null&&A!==undefined;};var L=function(W){if(!W||!G(W.et)){return false;}var V=true,A=H[W.et],T=W.cs,S;V=V&&(!A.target||W[N[W.et]]);V=V&&(!A.fm||W.fm);V=V&&(!A.fn||G(W.fn));var R=P.fnCstCount(W.fn,W.fnt);if(V&&A.cs){for(S=0;S<R;S++){V=V&&T&&G(T[S]);}}if(V){var U=[N[W.et],"fm"];for(var E=0;E<2;E++){for(S=0;S<R;S++){var X=U[E]+(2+S);V=V&&(!A[X]||W[X]);}}}V=V&&(!A.es||W.es&&(W.es.length>0));var Q=W.dimtyTypes;V=V&&(!A.dmy||Q[K.NodeDimtyUnspecified]||Q[K.NodeDimtyNone]||(Q[K.NodeDimtyOutputLevel]&&W.dmy&&W.dmy.uts&&(W.dmy.uts.length>0)));return V;};mstrmojo.ConditionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ConditionModel",completed:false,init:function(A){if(this._super){this._super(A);}this._updateCompleted();},edit:function(m,Y){var S=this[m],l=true;this.etWas=this.et;switch(m){case"not":Y=!!(Y&&Y.did===P.FN.NOT);S=!!this.not;if(Y===S){return ;}this.not=!!Y||null;break;case"target":var AD=this.et;if(Y){switch(Y[B]){case I.ATTR:case I.CONS:S=this.a;if(AD!==J.AQ&&AD!==J.AE){this.et=J.AQ;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}if(AD!==J.AE){this.fn=null;this.fnt=null;}this.fm=null;this.fm2=null;this.fm3=null;this.cs=null;break;case I.METRIC:S=this.m;if((AD!==J.MQ)&&(AD!==J.MC)){this.et=J.MQ;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.r=null;this.f=null;this.cs=null;this.dmt=K.NodeDimtyUnspecified;}this.m2=null;break;case I.REPORT:S=this.r;if(AD!==J.R){this.et=J.R;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.f=null;}break;case I.FILTER:S=this.f;if(AD!==J.F){this.et=J.F;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;}break;case I.PROMPT:S=this.prms&&this.prms[0];if(AD!==J.XML){this.et=J.XML;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}break;}}this.es=null;this[N[this.et]]=Y;break;case"fm":if(Y&&Y[B]==="fn"){this.et=J.AE;this.fm=null;O(this,Y);}else{this.fm=Y;if(Y&&(this.et==J.AE)){this.et=J.AQ;}this.fnt=null;this.fn=null;this.cs=null;this.a2=null;this.fm2=null;}break;case"fm2":case"fm3":this[m]=Y;break;case"fn":O(this,Y);break;case"es":var AG=this.es;if(Y&&Y.removed&&AG){D.removeItems(AG,Y.itemIdField,Y.removed);}if(Y&&Y.added){if(!AG){AG=Y.added.concat();this.es=AG;}else{D.insert(AG,AG.length,Y.added);}}break;case"c0":l=F(this,0,Y);break;case"c1":l=F(this,1,Y);break;case"dmy":var AA=this.dmy;if(!AA){AA={cc:true,fres:true,uts:[]};this.dmy=AA;}var w=AA&&AA.uts;if(!w){w=[];AA.uts=w;this.dmt=K.NodeDimtyOutputLevel;}var Q={};Q[P.TP.ATTR]=true;Q[P.TP.DIM]=true;if(Y&&Y.removed){var f=[],A=false,W=[],R=false;for(var k=0,T=Y.removed,E=T.length;k<E;k++){var V=T[k],AC=V[B] in Q;if(AC){R=true;}else{A=true;}var h=AC?W:f;h.push(V);}if(A){D.removeItems(w,"did",f);}if(R){var AF={};for(var d=0,Z=w&&w.length;d<Z;d++){var X=w[d];if(X&&X.utgt){AF[X.utgt.did]=d;}}var U=[];for(var AB=0,z=W.length;AB<z;AB++){var g=AF[W[AB].did];if(g>-1){U.push(g);}}U.sort(D.numSorter);for(var t=U.length-1;t>-1;t--){w.splice(U[t],1);}}}if(Y&&Y.added){var AH=[],o=P.DMY_TP.DIM,q=P.DMY_TP.ATTR;for(var AE=0,x=Y.added,e=x.length;AE<e;AE++){var p=x[AE];AH.push((p[B] in Q)?{utgt:p,utp:p[B]===I.DIM?o:q,agg:1,flt:2,gb:true,rps:0,n:p.n}:p);}D.insert(w,w.length,AH);}break;}this._updateCompleted();if(l){this.raiseEvent({name:"edit",prop:m,value:Y,valueWas:S});}},get:function C(){var A=M[this.et]||[];A.push("et");return mstrmojo.hash.copyProps(A,this);},_updateCompleted:function(){this.set("completed",L(this));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var E=mstrmojo.hash;mstrmojo.threshold.PropertyModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.PropertyModel",threshold:undefined,gridValueFormat:undefined,submitChange:function F(){this.raiseEvent({name:"propertyModelChange",threshold:this.threshold});},updateControl:function D(H){var G=this.threshold,I=E.copy(G.fmt,this.gridValueFormat);H.textGroup.setFormatSource(G);H.charGroup.setFormatSource(I);H.containerGroup.setFormatSource(I);},changeFormatProperty:function B(H,I,K){var G=this.threshold,J=H==="threshold"?G:G.fmt;if(!J&&H==="fmt"){J=G.fmt={};}J[I]=K;},getReplaceTypeName:function A(){return"rtp";},getReplaceTextName:function C(){return"rtxt";}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");var B={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4};mstrmojo.ui.PopupConfig=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ui.PopupConfig",ENUM_CORNERS:B,isHostedWithin:true,position:null,hostProxyCssClass:"",hostId:"",hostElement:null,anchorElement:null,popupHandlers:null,alignment:null,alignWithAnchor:false,useTooltip:false,init:function E(F){this.clear();this._super(F);},setAlignment:function C(F,G){this.alignment={host:F,popup:G};},addPopupHandlers:function D(F,H,G){this.popupHandlers[F]={open:H,close:G};},clear:function A(){this.popupHandlers={};var F=this.ENUM_CORNERS;this.alignment={host:F.BOTTOM_LEFT,popup:F.TOP_LEFT};}});mstrmojo.ui.PopupConfig.ENUM_CORNERS=B;}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func","mstrmojo._ImageHelper","mstrmojo.rw.model.RetrievalKeysConfig","mstrmojo.rw.model.UpdateKeysConfig");var a=mstrmojo.hash,A=a.copy,R=mstrmojo.array,AP=mstrmojo.dom,t=mstrmojo.func,AH=[mstrmojo.desc(8445,"Loading")],Ai=mstrmojo.array.ensureArray,N=0;function T(BG){BG=BG||{};BG.preserveUndo=true;return BG;}function Af(BK,BL,BG){if(this.blockRequests){throw ("The data service is currently ignoring all requests to the server.");}var BH=N++,BJ=this.getTxUpdates(BH);BG=BG||{};BG.src=Af.caller.name;if(!mstrmojo.string.isEmpty(BJ)){BK.updateChanges=BJ;}BK.zoomFactor=this.model.getZoomFactor();var BI=this.cmdMgr;if(!BG.preserveUndo&&BI){BI.onSubmitUpdates();}mstrApp.serverRequest(BK,this.wrapCallback(BL,BH),BG);}function L(BI,BH,BG){a.copy({unitType:BH.defn&&BH.defn.t,unitKey:BH.k},BI);if(BG.layoutKey){a.copy({toKey:BG.layoutKey,analysisSectionType:BG.analysisSectionType},BI);}else{a.copy({toKey:BG.parentKey},BI);}return BI;}function Ak(BH){BH=BH||{};var BG=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(BG){BH.styleName="RWDocumentMobileStyle";BH.availableWidth=BG.w;BH.availableHeight=BG.h;}else{BH.innerWidth=mstrmojo.dom.windowDim().w;BH.innerHeight=mstrmojo.dom.windowDim().h;}return BH;}function BB(BH){var BG=BH&&BH.style,BI=BG&&BG.params;return BI&&BI.treesToRender;}function B(BG,BH){return{act:"moveUnit",toKey:BG,unitType:BH};}function Aj(BG){return BG.split("\u001E")[2];}function K(BH,BL){if(BH!==mstrmojo.DocDataService.UNDO_KEY){return BH;}if(!this.undoSectionKey){var BK=this.undoSectionKey=this.model.getNextKey(),BI=this.undoFGKey=this.model.getNextKey();BL.addActions({act:"addUndoSection",cbKey:this.cbKey,nodeKey:BK,fgKey:BI});var BJ=this;BL.addCallbacks({failure:function BG(){delete BJ.undoSectionKey;}});}return this.undoSectionKey;}function Ae(BI,BH){var BG={dsid:BI.dsid,formula:BI.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BI.tokenStreamXML),name:BI.alias,afb:BI.afb,sfb:BI.sfb};if(BH){BG.Ids=["$GUID_135"];}return this.getAddDerivedMetricToDatasetAction(BG);}function AG(BJ,BM,BH,BN,BG,BI){var BK=[this.getNodeKeyFromKeyContext(BM)];if(!BI){BK=Ai(BN).concat(BK);}var BL={act:BJ,keyContext:BM,tgtKey:BH,partialRetrieval:{nodes:BK}};if(!BG){BL.partialUpdate={selectors:[Aj(BM)]};}return BL;}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.DocDataService",defaultStyle:{params:{treesToRender:2}},cmdMgr:null,stid:-1,blockRequests:false,init:function Ac(BG){this._super(BG);this.cmdMgr=this.model.controller.cmdMgr;},wrapCallback:function AV(BK,BH){var BI=this;return t.wrapMethods({success:function BJ(BL){if(BL){BI.model.bs=BI.rwb=BL.bs||BI.rwb;BI.msgId=BL.mid||BI.msgId;BI.cbKey=BL.cbKey||BI.cbKey;if(BL.stid!==undefined){BI.stid=BL.stid;}}BI.clearTxUpdates(BH);},failure:function BG(){BI.resetTxUpdates(BH);}},BK);},getNodeKeyFromKeyContext:function V(BG){return BG.split("\u001E")[1];},refresh:function Ap(BI,BJ){var BH=!!BI.useRefreshProgress,BG=BH?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:AH;delete BI.useRefreshProgress;BI=Ak(BI);Af.call(this,A(BI,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false}),BJ,{showProgress:true,hideProgress:true,progressStateText:BG,useRefreshProgress:BH});},saveRW:function As(BG,BH){Af.call(this,A(BG,{taskId:"saveRW",msgID:this.msgId}),BH);},saveThresholds:function e(BH,BI,BG){Af.call(this,A(BH,{taskId:"saveThresholds"}),BI,BG);},getThresholds:function A5(BH,BI,BG){Af.call(this,A(BH,{taskId:"getThresholds"}),BI,BG);},browseElements:function AD(BG,BH){Af.call(this,A(BG,{taskId:"browseElements",styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30}),BH);},removeUnit:function U(BH,BI){var BG=A(BH,{act:"removeUnit"});this.submitTemplateUpdates(BG.nodeKey,BG,BI);},removeLayout:function AK(BH,BG,BI){this.submitUpdates({act:"removeLayout",unitKey:BH,isCurrent:BG},BI);},moveLayout:function q(BI,BG,BH){this.submitUpdates(this.getMoveNodeAction(BI,BG,BH),mstrmojo.DocDataService.EMPTY_CALLBACK,mstrmojo.DocDataService.SUPPRESS_DATA);},getMacroCopyNodeAction:function Ag(BH,BG,BJ){var BI={act:"macroCopyUnit",newKey:BJ,partialRetrieval:this.newRetrievalKeysConfig().addNode(BJ)};L(BI,BH,BG);return BI;},getMacroMoveNodeAction:function z(BH,BG){var BI={act:"macroMoveUnit",partialRetrieval:this.newRetrievalKeysConfig().addNode(BH.k)};L(BI,BH,BG);return BI;},getMoveNodeAction:function m(BK,BG,BH){var BJ=BK.defn,BI=BJ?BJ.t:mstrmojo.EnumRWUnitType.LAYOUT;var BL=B(BG,BI);BL.unitKey=BK.k;if(BH!==undefined){BL.index=BH;}return BL;},getMoveControlAction:function Z(BJ,BH,BG){var BI=B(BH,mstrmojo.EnumRWUnitType.SELECTOR);BI.keyContext=BJ;if(BG){BI.partialRetrieval={nodes:Ai(BG)};}return BI;},addMoveControlAction:function H(BJ,BI,BH,BG){BJ.addActions(this.getMoveControlAction(BI,K.call(this,BH,BJ),BG));},getSetCtrlSourceAction:function AE(BH,BI,BG){return{act:"setControlSource",keyContext:BH,unitId:BI,unitType:BG,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BH)),partialUpdate:{selectors:[Aj(BH)]}};},getRemoveCtrlTargetAction:function F(BI,BH,BJ,BG){return AG.call(this,"removeControlTarget",BI,BH,BJ,BG);},getClearCtrlTargetAction:function A1(BG){return{act:"clearControlTarget",keyContext:BG};},getAddCtrlTargetAction:function An(BK,BH,BL,BM,BG,BI){var BJ=AG.call(this,"addControlTarget",BK,BH,BL,BG,BI);BJ.isUC=!BM;return BJ;},getAddCtrlTargetDatasetAction:function Ay(BH,BG){return{act:"addControlTargetDataset",keyContext:BH,tgtDid:BG};},getRemoveCtrlTargetDatasetAction:function d(BH,BG){return{act:"removeControlTargetDataset",keyContext:BH,tgtDid:BG};},getClearCtrlTargetDatasetAction:function AJ(BG){return{act:"clearControlTargetDataset",keyContext:BG};},getChangeControlElementSource:function BA(BH,BG){return{act:"changeControlElementSource",keyContext:BH,ctlElementSrc:BG};},getSetAttributesJoinTypeAction:function AZ(BG,BH){return{act:"setAttributesJoinType",nodeKey:BG,value:BH,partialRetrieval:this.newRetrievalKeysConfig().addNode(BG)};},getSetMetricJoinTypeAction:function AR(BI,BK,BG,BH,BJ){return{act:"setMetricJoinType",nodeKey:BI,unitId:BK,dataType:BG,unitType:BH,value:BJ,partialRetrieval:this.newRetrievalKeysConfig().addNode(BI)};},getTxUpdates:function AO(BH){var BG=this.model;return BG&&BG.getTransactionUpdates&&BG.getTransactionUpdates(BH);},clearTxUpdates:function Ad(BH){var BG=this.model;if(BG&&BG.clearTransactionUpdates){BG.clearTransactionUpdates(BH);}},resetTxUpdates:function C(BH){var BG=this.model;if(BG&&BG.resetTransactionUpdates){BG.resetTransactionUpdates(BH);}},loadDocLayout:function J(BI,BK,BJ){var BH={act:"setCurrentLayout",unitKey:BI.layoutKey,disablePU:true},BG={style:{params:{treesToRender:3}},params:Ak.call(this)};if(BJ){BJ.add(BH,BK,BG);}else{this.submitUpdates(BH,BK,BG);}},checkMissingCredentials:function u(BG,BH){Af.call(this,A(BG,{taskId:"checkMissingCredentials"}),BH);},setCurrentDocLayout:function Am(BG,BK,BJ){var BI={act:"setCurrentLayout",unitKey:BG},BH={config:{silent:(BK===null)}};BK=BK||null;if(BJ){BJ.add(BI,BK,BH);}else{this.submitUpdates(BI,BK,BH);}if(window.mstrMobileApp!==undefined){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function A2(BG,BH){Af.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:BG},BH);},requestPanelChangeDeferred:function A9(BM,BL,BG,BH,BJ,BK){var BI={act:"setCurrentPanel",unitKey:BL};if(BG){BI.partialRetrieval={nodes:BG.split(",")};}BM.add(BI,BK,{config:{showProgress:BJ,hideProgress:BJ,progressStateText:AH},style:{params:{treesToRender:BH?3:0}}});},getGraphSelectionAction:function D(BK,BG,BI,BN,BM,BH){var BL=this.model.getCurrentLayoutDef(),BO=(BL&&BL.dzf)||1,BJ={act:"graphSelector",nodeKey:BK,sliceID:BI,x:Math.round(BN/BO),y:Math.round(BM/BO)};if(BH){BJ.usePartialUpdate="0";}else{BJ.partialUpdate={selectors:BG.split("\u001E")};}return BJ;},getSelectorElementsAction:function n(BI){var BH={act:"setSelectorElements",keyContext:BI.ck,ctlKey:BI.ctlKey,elemList:mstrmojo.string.decodeHtmlString(BI.eid),isVisualization:!!BI.isDocVis},BG=BI.include;if(BG!==undefined){BH.include=!!BG;}if(BI.tks){BH.tks=BI.tks;}if(BI.disablePU){BH.usePartialUpdate="0";}else{if(BI.ignoreTargetData){BH.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BI.ck));}else{BH.partialUpdate={selectors:BI.ctlKey.split("\u001F")};}}return BH;},getUpdateTransactionAction:function BE(BH){var BG={act:"updateTransaction"};if(BH){if(BH.ctlKey){BG.partialUpdate={selectors:[BH.ctlKey]};}}return BG;},getSelectorFromGMAction:function k(BH){var BG={act:"setSelectorFromGM",keyContext:BH.ck,ctlKey:BH.ctlKey,keepOnly:!!BH.keepOnly,selectorObjects:BH.selectorObjects,isVisualization:!!BH.isDocVis,include:!!BH.include};if(BH.tks){BG.tks=BH.tks;}if(BH.disablePU){BG.usePartialUpdate="0";}else{BG.partialUpdate={selectors:[BH.ctlKey]};}return BG;},getGMViewFilterAction:function AC(BH){var BG={act:"keepOnlyGM",selectorObjects:BH.selectorObjects,isVisualization:!!BH.isDocVis,keepOnly:!!BH.keepOnly};if(BH.tks){BG.tks=BH.tks;}if(BH.disablePU){BG.usePartialUpdate="0";}else{BG.partialUpdate={selectors:[BH.ctlKey]};}return BG;},setMultiDocSelectorElements:function AA(BG,BH,BJ){var BI={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:BH,selectorObjects:BG};Af.call(this,BI,BJ,{showWait:true,hideWait:true,delay:true});},setDocSelectorTexts:function Q(BL,BN,BP,BM,BO,BH,BG,BI,BK){var BJ={taskId:"setDocSelectorTexts",rwb:this.rwb,unitKeyContext:BL,ctlTexts:BN,ctlKey:BP,zoomFactor:BH};if(AP.isAndroid||BG){BJ.taskId="androidSetDocSelectorElements";}if(BM!==null&&BM!==undefined){BJ.include=BM;}if(BI!==null&&BI!==undefined){BJ.usePartDisplay=BI;}if(BK!==null&&BK!==undefined){BJ.treesToRender=BK;}Af.call(this,BJ,BO);},getSelectorExpressionAction:function o(BI){var BH={act:"setSelectorExpression",keyContext:BI.ck,ctlType:BI.type,objId:BI.srcid,objType:BI.srct,expFunction:BI.f,expFunctionType:BI.ft,include:!!BI.include,qt:BI.qt,unset:!!BI.unset};if(BI.disablePU){BH.usePartialUpdate="0";}else{BH.partialUpdate={selectors:[BI.ckey]};}if(BI.changeQual){BH.changeQual=BI.changeQual;}var BG=BI.cs;if(BG!==null&&BG!==undefined){BH.expConstants=BG;BH.dataType=BI.dtp;}if(BI.fid){BH.fid=BI.fid;}return BH;},getMultiUnitSelectorAction:function A7(BG){return{act:"multiUnitSelection",keyContext:BG.ck,sels:BG.selections,partialUpdate:{selectors:[BG.ctlKey]}};},getRemoveCtrlAction:function Ah(BH,BG){return{act:"removeControl",key:BH,partialUpdate:{selectors:[BH]},partialRetrieval:{nodes:Ai(BG)}};},getAddCtrlAction:function AY(BN,BL,BH,BM,BI,BO,BG,BJ,BP){if(isNaN(BP)){BP=1;}var BK={act:"addControl",parentKey:BN,nodeKey:BL,ctlKey:BH,isUC:!!BI,unitType:BO||-1,unitId:BG||"",targetKeys:Ai(BJ),ctlType:BP,gpType:BP,partialRetrieval:{nodes:Ai(BM)}};if(!BK.isUC){BK.partialUpdate={selectors:[BH]};}return BK;},getSaveGraphPropertiesAction:function h(BG,BH){return{act:"saveGraphProperties",nodeKey:BG,properties:BH};},getSelectorIncludeAction:function Au(BH){var BG=BH.ckey;return{act:"setSelectorInclude",keyContext:BH.ck,ctlKey:BG,ctlType:BH.type,include:BH.include,partialUpdate:{selectors:[BG]}};},getSelectorShowAllAction:function O(BG){return{act:"setSelectorShowAll",keyContext:BG.ck,ctlKey:BG.ckey,ctlType:BG.type,showAll:BG.showAll,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BG.ck))};},getUnsetSelectorAction:function c(BJ){var BI=BJ.ckey,BG=BJ.ck,BH={act:"unsetSelector",keyContext:BG,ctlKey:BI,ctlType:BJ.type};if(BJ.ignoreTargetData){BH.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BG));}else{BH.partialUpdate={selectors:[BI]};}return BH;},getChangeFilteringAction:function Ar(BG,BJ,BI,BH){return{act:"changeFiltering",nodeKey:BG,filterMode:BJ,isUC:BI,partialRetrieval:{nodes:(BH?Ai(BH):[])}};},getAddDerivedMetricToDatasetAction:function Ax(BG){return{act:"addDerivedMetricToDataset",dsid:BG.dsid,formula:BG.formula,isTokenStream:BG.isTokenStream,name:BG.name,newObjectIds:BG.Ids,afb:BG.afb,sfb:BG.sfb};},getEditDocUnitPropAction:function x(BG){return{act:"editDocUnitProp",dsid:BG.dsid,formId:BG.formId,unitId:BG.unitId,unitType:BG.unitType,prop:BG.prop,value:BG.value};},getRWGraphImage:function BD(BK,BO){var BJ=mstrApp,BG=this.id,BH={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:BK.k,sliceID:parseInt(BK.sid,10),width:parseInt(BK.w,10),height:parseInt(BK.h,10)};if(BJ.onMobileDevice()&&BJ.useBinaryFormat){window.setTimeout(function(){Af.call(mstrmojo.all[BG],BH,BO,T());},0);}else{if(BK.encodeImage){BH.taskContentEncoding="base64";delete BH.taskEnv;Af.call(this,BH,{success:function BP(BQ){BO.success("data:image/png;base64,"+BQ);},failure:function BI(BQ){(BO.failure||BJ.onerror)(BQ);}},T());}else{var BM=BJ.getConfiguration(),BL=BJ.getCurrentProjectId(),BN=new mstrmojo.StringBuffer();BH.__ts__=new Date().getTime();BH.sessionState=BJ.getSessionState(BL);a.forEach(BH,function(BQ,BR){BN.append(BR+"="+encodeURIComponent(BQ));});BO.success(BM.getTaskUrlByProject(BL)+"?"+BN.toString("&"));}}},getImage:function BC(BH){var BI=mstrApp,BG=BI.getConfiguration();if(BG&&BH&&BH.indexOf("://")===-1){BH=BG.getHostUrlByProject(BI.getCurrentProjectId())+BH;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(BH)):BH;},setGridDisplayMode:function p(BI,BH,BJ,BG){a.copy({params:{suppressData:true}},BG);this.submitUpdates({act:"setGridDisplayMode",unitKey:BI,displayMode:BH},BJ,BG);},setDocZoom:function G(BG,BH){this.submitUpdates(A(BG,{act:"setDocZoom",disablePU:true}),BH,{style:{params:{treesToRender:3}}});},sortGrid:function AI(BG,BH){this.submitTemplateUpdates(BG.nodeKey,A({act:"sort"},BG),BH);},getAdvSortData:function Ab(BG,BH){this.rwExecute(A(BG,{styleName:"RWGridStyle"}),BH);},rwExecute:function A4(BG,BH){Af.call(this,A(BG,{taskId:"RWExecute",rwb:this.rwb,messageID:this.msgId}),BH);},pivot:function l(BG,BH){this.submitTemplateUpdates(BG.nodeKey,{act:"pivot",unitId:BG.unitId,unitType:BG.unitType,attFormId:BG.attFormId,axis:BG.axis,unitPos:BG.unitPos},BH);},resizeXtabColumn:function A0(BG,BH){this.submitUpdates([this.getUpdateTemplateAction(BG.nodeKey,BG),{act:"format",unitType:52,unitKey:BG.nodeKey,formatType:1,format:{FormattingSize:{WidthMode:2}}}],BH);},showTotals:function S(BG,BH){this.submitTemplateUpdates(BG.nodeKey,{act:"showTotals",unitId:BG.unitId,unitType:BG.unitType,subtotalType:BG.subtotalType,clearSubtotalType:BG.clearSubtotalType},BH);},drillGrid:function AF(BG,BH){this.submitUpdates(this.getDrillGridAction(BG),BH,{config:{showProgress:true,hideProgress:true,progressStateText:AH,delay:true}});},getDrillGridAction:function A6(BH){var BG={act:"gridDrillWithin",messageID:this.msgId,nodeKey:BH.nodeKey,sliceId:BH.sliceId,drillPathIndex:BH.drillPathIndex,drillPathKey:BH.drillPathKey,elementList:BH.drillElements,retainParent:BH.retainParent,partialUpdate:{nodes:[BH.nodeKey]}};if(BH.x){BG.x=BH.x;BG.y=BH.y;}return BG;},changeDocGroupBy:function M(BI,BJ,BG){var BH={act:"changeDocGroupBy",disablePU:true};if(BI.flags){BH.flags=BI.flags;}if(BI.groupbyKey){BH.gbKey=BI.groupbyKey;BH.elemId=BI.elementId;}else{BH.gbUnits=BI.gbUnits;}this.submitUpdates(BH,BJ,{config:BG,style:{params:{treesToRender:3}},params:Ak.call(this)});},retrieveServerJson:function b(BI,BR,BJ){var BL=this.model,BM=BL.controller,BP={},BG,BH,BN;var BO=BI.nodes;if(BO){BP.partialRetrieval=BO;}var BQ=BI.slices;if(BQ){BP.slices=BQ;}if(BJ){BG=BJ.style;BH=BJ.config;BN=BJ.params;}if(!BH){BH={showProgress:true,hideProgress:true,progressStateText:AH};}var BS=BI.style=a.clone(this.defaultStyle);A(BG.params,BS.params);var BK={taskId:"getServerJSONResults",styleName:"ServerJsonRWDStyle",compress:1,rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(BP),treesToRender:BS.params.treesToRender};A(BN,BK);BH.preserveUndo=(BJ&&BJ.preserveUndo)||false;Af.call(this,BK,BR,BH);},downloadGridData:function I(BH,BI){var BG={act:"gridIncrementalFetch",nodeKey:BH.nodeKey,rowPosition:BH.rowPosition,maxRows:BH.maxRows,colPosition:BH.colPosition,sliceId:BH.sliceId,maxColumns:BH.maxColumns,partialRetrieval:this.newRetrievalKeysConfig().addNode(BH.nodeKey)};if(BH.partialUpdate){BG.partialUpdate=BH.partialUpdate;}this.submitUpdates(BG,BI,a.copy(T(),{noUpdate:true,config:{silent:true}}));},txMarkRows:function AN(BG,BH){Af.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:BG.nodeKey,sliceId:BG.sliceId,rowOrdinal:BG.rowOrdinal,actionType:BG.actionType},BH);},txChangeData:function r(BG,BH){Af.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:BG.nodeKey,sliceId:BG.sliceId,cells:BG.cells,autoRefresh:BG.autoRefresh},BH);},sendTransactionActions:function Y(BH,BI){var BG={taskId:"DocTransaction",rwb:this.rwb,keyContext:BH.keyContext,actions:BH.actions,messageID:this.msgId};if(BH.txrcd){BG.isPending=BH.txrcd.pending;BG.timestamp=BH.txrcd.timestamp;}Af.call(this,BG,BI,{silent:!!BI});},newUpdate:function Aw(BI,BH){var BG=new mstrmojo.DocDataService.Update(BH);BG.ds=this;BG.cmd=BI;return BG;},newUpdateWithoutCmd:function g(BH){var BG=new mstrmojo.DocDataService.Update(BH);BG.ds=this;return BG;},newRetrievalKeysConfig:function AX(){return new mstrmojo.rw.model.RetrievalKeysConfig();},newUpdateKeysConfig:function P(){return new mstrmojo.rw.model.UpdateKeysConfig();},submitCmd:function A3(BH,BG){this.newUpdate(BH,BG).submit();},submitUpdates:function Aa(BP,BU,BM){BP=Ai(BP);var BL={actions:BP},BG,BJ,BR,BI=false;R.forEach(BP,function BO(BW){if(BW.disablePU){BI=true;delete BW.disablePU;}R.forEach(BW.actions,BO);return !BI;});if(!BI){var BH=mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig(BP),BT=mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig(BP);if(!a.isEmpty(BH)){BL.partialRetrieval=BH;}if(!a.isEmpty(BT)){BL.partialUpdate=BT;}}if(BM){BG=BM.style;BJ=BM.config;BR=BM.params;}if(!BJ){BJ={showProgress:true,hideProgress:true,progressStateText:AH};}if(!BG){BL.style=this.defaultStyle;}else{var BV=BL.style=a.clone(this.defaultStyle);A(BG.params,BV.params);}BL.style.name=(BG&&BG.name)||mstrApp.styleName;var BN={taskId:"mojoRWManipulation",rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(BL)};A(BR,BN);BJ.preserveUndo=(BM&&BM.noUpdate)||false;var BQ=this,BS=true,BK=t.override({success:function(BW,BX){if(BW.status===2){BS=false;BQ.submitUpdates([],BU,BM);}else{BS=true;return this._super(BW,BX);}},complete:function(){if(this._super&&BS){this._super();}}},A(BU));if(!(BM&&BM.hideCancel)){BJ.waitBoxCfg=a.copy({showCancel:true},BJ.waitBoxCfg);}if(BM&&BM.message){BJ.waitBoxCfg=a.copy({message:BM.message},BJ.waitBoxCfg);}Af.call(this,BN,BK,BJ);},submitTemplateUpdates:function v(BG,BI,BJ,BH){this.submitUpdates(this.getUpdateTemplateAction(BG,BI),BJ,BH);},getUpdateTemplateAction:function AU(BG,BI,BH){return{act:"updateTemplate",keyContext:BG,partialRetrieval:this.newRetrievalKeysConfig().addNode(BG,BH),actions:Ai(BI)};},addUpdateTemplateAction:function A8(BI,BG,BH){BI.addActions(this.getUpdateTemplateAction(BG,BH));},applySegment:function AL(BH,BG,BI){Af.call(this,{taskId:"applySegment",rwb:this.rwb,segmentID:BH,nodeKey:BG},BI);},getPageByTree:function AM(BG){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},BG);},getUserDICubeInfo:function W(BG,BH){Af.call(this,{taskId:"getUserDICubeInfo",cubeIds:BG.join(",")},BH);},applySorts:function Av(BH,BI,BG,BJ){Af.call(this,{taskId:"applySorts",key:BH,sortType:BI,sortList:BG},BJ,mstrmojo.DocDataService.PROGRESS_CONFIG);},getAddNewDerivedMetricToDatasetSubmitFunc:function At(BH){var BG=this;return function(BK){var BL=BG.model,BJ=BL.controller,BI=a.copy(BK,BH),BM=[Ae.call(BG,BI,false)],BN=BL.getDatasetsUpdateCallback();BJ.submitUndoRedoUpdates(BM,null,BN,{style:{params:{treesToRender:1}}});};},getAddNewDerivedMetricToXtabSubmitFunc:function Al(BH){var BG=this;return function(BL){var BM=BG.model,BK=BM.controller,BJ=a.copy(BL,BH),BI=BJ.idx,BO=[],BP=t.wrapMethods(BM.getDatasetsUpdateCallback(),BK._getXtabCallback(BJ.host));BO.push(Ae.call(BG,BJ,true));if(BJ.replace){BO.push(BG.getUpdateTemplateAction(BJ.nodeKey,[BJ.host.model.getRemoveTemplateUnitAction({did:BJ.replace.did,t:BJ.replace.t})]));}else{BI++;}var BN=BG.getUpdateTemplateAction(BJ.nodeKey,[BJ.host.model.getAddTemplateUnitAction({did:"$GUID_135",t:4},BJ.dsid,BJ.zoneid,BI),{act:"renameUnit",id:"$GUID_135",type:4,name:BJ.alias,isDynamicAlias:true}]);BO.push(BN);BK.submitUndoRedoUpdates(BO,null,BP);};},getAddNewDerivedMetricToDropzoneSubmitFunc:function AB(BH){var BG=this;return function(BN){var BO=BG.model,BP=BO.controller,BR=a.copy(BN,BH),BT=BR.host.zonesModel,BU=BR.idx,BM=[],BI=[],BS={id:BR.zoneid},BQ={did:"$GUID_135",t:4},BV=t.wrapMethods(BO.getDatasetsUpdateCallback(),BP._getXtabCallback(BR.host));BM.push(Ae.call(BG,BR,true));if(BR.replace){var BK={did:BR.replace.did,t:BR.replace.t};BI.push(BT.getRemoveDropZoneUnitAction(BS,BK));}else{BU++;}BI.push(BT.getAddDropZoneUnitAction(BS,BQ,BU,{datasetId:BR.dsid}));var BJ=(BH.zoneid===4)?1:2,BL=BT.getAddMetricNameAction(BH.host,BJ);if(BL){BM.push(BL);}if(!BR.replace&&BT.gmZones){BL=BT.gmZones.getUpdateGroupInfoActionForNewMetric(BH.zoneid,BU,true);if(BL){BM.push(BL);}}BT.checkAndAddThresholdAction(BR.zoneid,BQ,BI);BM.push(BG.getUpdateTemplateAction(BR.nodeKey,BI));BP.submitUndoRedoUpdates(BM,null,BV);};},getEditDerivedMetricSubmitFunc:function f(BH){var BG=this;return function(BK){var BM=BG.model,BJ=BM.controller,BI=a.copy(BK,BH),BL=BH.nodeKey,BN={act:"editDM",formula:BI.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BI.tokenStreamXML),afb:BH.afb,sfb:BH.sfb,dsid:BI.dsid||"",did:BI.did},BO=[BM.addUpdateObjects(BN,{id:BI.did,type:4,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE})],BP=t.wrapMethods(BM.getDatasetsUpdateCallback(),BJ.getPartialUpdateCallback());if(BL){BO.push(BG.getUpdateTemplateAction(BL,[{act:"renameUnit",id:BI.did,type:4,name:BI.alias,isDynamicAlias:true}]));}else{BN.name=BI.alias;}BJ.submitUndoRedoUpdates(BO,null,BP);};},resetSelections:function Az(BH,BG,BI){Af.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:BH||"",usePartDisplay:BG?"0":"1",treesToRender:BG?3:2},BI);},setPreference:function E(BG,BH){Af.call(this,{taskId:"setPreference",prefs:BG},BH);},getObjectInfo:function AS(BG,BH){Af.call(this,A(BG,{taskId:"getObjectInfo"}),BH,T());},addSuppressData:function Ao(BG){if(BB(BG)===mstrmojo.DocDataService.EnumTreesToRender.NONE){a.copy({params:{suppressData:true}},BG);}},uploadImageToServer:function(BI,BJ){var BH={taskId:"importImage",imageFieldName:"imageData",isEdit:1,fieldKey:BI.fieldKey,fieldName:BI.fieldName,imageName:encodeURIComponent(BI.imageName),imageSize:BI.imageSize,nodeKey:BI.nodeKey,sectionKey:BI.sectionKey};if(mstrApp.isSingleTier){var BG=";base64,";BH.rwNodeKey=BI.fieldGroupKey;BH.imageData=BI.base64Str.split(BG)[1]||BI.base64Str;mstrApp.serverRequest(BH,BJ);}else{BH.msgID=this.msgId;BH.imageData=BI.imageData;mstrmojo.xhr.upload("POST",mstrConfig.taskURL,BJ,BH);}}});mstrmojo.DocDataService.Update=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DocDataService.Update",actions:null,callback:null,extras:null,init:function Ac(BG){A(BG,this);this.actions=this.actions||[];this.callback=this.callback||{};this.extras=this.extras||{};},addActions:function AW(BG){this.actions=this.actions.concat(Ai(BG));},addCallbacks:function Aq(BG){this.callback=t.wrapMethods(this.callback,BG);},addExtras:function AQ(BH){var BG=BB(BH),BI=BB(this.extras);this.extras=A(BH,this.extras);if(BG!==undefined&&BI!==undefined){this.extras.style.params.treesToRender|=BI;}},addUpdate:function AT(BG){this.add(BG.actions,BG.callback,BG.extras);},setTreesToRender:function BF(BG){if(BG){this.addExtras({style:{params:{treesToRender:BG}}});}return this.extras.style.params.treesToRender;},add:function X(BH,BI,BG){if(BH){this.addActions(BH);}if(BI){this.addCallbacks(BI);}if(BG){this.addExtras(BG);}},submit:function w(){var BH=this.actions,BI=this.callback,BG=this.extras;if(this.cmd){this.cmd.submit(BH,BI,BG);}else{this.ds.submitUpdates(BH,BI,BG);}}});mstrmojo.DocDataService.PUInfoType=null;mstrmojo.DocDataService.ExtrasType=null;mstrmojo.DocDataService.PROGRESS_CONFIG={showProgress:true,hideProgress:true,progressStateText:AH,delay:true};mstrmojo.DocDataService.UNDO_KEY="undo";mstrmojo.DocDataService.REQUEST_DEFN_DATA={style:{params:{treesToRender:3}}};mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION={style:{params:{treesToRender:1}}};mstrmojo.DocDataService.REQUEST_ONLY_DATASETS={style:{params:{treesToRender:0}}};mstrmojo.DocDataService.SUPPRESS_DATA={params:{suppressData:true}};mstrmojo.DocDataService.EMPTY_CALLBACK={success:mstrmojo.emptyFn};mstrmojo.DocDataService.CopyMoveDestinationType=null;mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS={FORMAT_CHANGE:1,DATA_CHANGE:2};mstrmojo.DocDataService.EnumTreesToRender={NONE:0,DEFN:1,DATA:2,BOTH:3};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.color","mstrmojo.hash","mstrmojo.num","mstrmojo.array");var e=1,c=2,m=3,G=4,W=5,f=6,d=7,A=-1,H=-2,F=mstrmojo.color,K=mstrmojo.hash,Z=mstrmojo.array,E=mstrmojo.num,I,V;function l(v,u){return v.every(function(w){return u(w);});}function a(w,v,u){return l(w,function(x){return x.ttp===v||x.ttp===u;});}function Y(v){var u=v.toFixed(2);return parseFloat(u);}function k(u){this.raiseEvent(K.copy(u,{name:"modelEdit"}));}function o(u){this.raiseEvent(K.copy(u,{name:"selectedThresholdsChange"}));}function P(){var u=this.basedOnId||this.metricId;return Z.filterOne(this.data.gsi.mx,function(v){return v.did===u;});}function g(x){var u=x.expr.nds,v=u.length;if(v!==1){return false;}var w=u[0],AH=w.cs;if(!w.m||!AH){return false;}var AG=w.fnt,AB=w.fn,AF=AH[0],AD=AH[1],AA=AF&&AF.v,z=AD&&AD.v,AE=E.parseNumeric(AA)||parseFloat(AA),AC=E.parseNumeric(z)||parseFloat(z);switch(AG){case 2:case 3:switch(AB){case 1:case 2:x.flr=AG===2?-Infinity:0;x.ceil=AE;x.ttp=AG===2?(AB===1?W:G):(AB===1?c:e);break;case 3:case 4:case 5:case 13:x.flr=AE;x.ceil=isNaN(AC)?(AG===2?Infinity:100):AC;x.ttp=AG===2?(AB===4?W:(AB===5?G:f)):(AB===4?c:(AB===5?e:m));break;default:return false;}break;default:switch(AB){case 11:x.flr=-Infinity;x.ceil=AE;x.ttp=d;break;case 17:case 10:x.flr=AE;x.ceil=isNaN(AC)?Infinity:AC;x.ttp=d;break;default:return false;}}return true;}mstrmojo.threshold.MetricThresholdData=null;mstrmojo.threshold.ThresholdModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdModel",data:undefined,thresholds:undefined,orgThresholds:undefined,selectedThresholds:[],metricId:undefined,basedOnId:undefined,editorMode:0,init:function n(v){this._super(v);var u=mstrApp.customization.getCustomThresholds();I=I||u.color;V=V||u.image;},ondataChange:function h(){this.thresholds=this.data.gsi.thresholds;this.saveOriginalData();},isAdvanced:function D(z){var v=this.thresholds;if(v){var AC=v[z]||[],AQ=false,AP,AJ,AN="The expression is not supported by the Simple Threshold Exception Parser.";if(AC.length===0){return false;}if(AC.some(function(AW){if(AW.ttp===A){return true;}try{if(!g(AW)){throw AN;}AJ=AW.expr.nds[0].m.did;}catch(AV){return true;}if(AP&&AP!==AJ){return true;}AP=AJ;var AU=AW.rtp;if(AU===3||AU===10){return true;}var AR=AW.scope;if(AR&&AR!==1){return true;}var AT=AW.fmt||{};for(var AS in AT){if(AS!=="bc"&&AS!=="bgs"){return true;}else{AQ=true;}}return false;})){return true;}if(AQ&&!l(AC,function(AR){return AR.fmt&&(AR.fmt.bc||AR.fmt.bgs);})){return true;}this.basedOnId=AP;var AK=false,AI=this.getSimpleThresholdType(z),AB=AC.length;if(AB>0&&AI!==H){var AM,AE,AG;for(AM=0;AM<AB-1;AM++){AE=AC[AM];AG=AC[AM+1];if(AE.ceil!==AG.flr&&AE.flr!==AG.ceil){AK=true;break;}}if(!AK){var u=AC[0],w=AC[AB-1],AF=u.flr,AL=w.ceil,x=u.ceil,AA=w.flr,AD=this.getMetricsCount(),AH=this.getMetricsMinValue(),AO=this.getMetricsMaxValue();switch(AI){case W:case G:AK=!(((AF===0||AF===-Infinity)&&(AL===AD||AL===Infinity))||((x===AD||x===Infinity)&&(AA===0||AA===-Infinity)));break;case c:case e:AK=!((parseInt(AF,10)===0&&parseInt(AL,10)===100)||(parseInt(x,10)===100&&parseInt(AA,10)===0));break;case d:AK=!(((AF===AH||AF===-Infinity)&&(AL===AO||AL===Infinity))||((x===AO||x===Infinity)&&(AA===AH||AA===-Infinity)));break;}}return AK;}else{return true;}}return false;},getSimpleThresholdType:function(v){var w=this.thresholds&&this.thresholds[v],u=H;if(w){if(a(w,m,c)){u=c;}else{if(a(w,m,e)){u=e;}else{if(a(w,f,G)){u=G;}else{if(a(w,f,W)){u=W;}else{if(a(w,d)){u=d;}}}}}}return u;},isImageBasedType:function L(u){var v=this.thresholds&&this.thresholds[u];return v&&!v.some(function(w){return w.rtp!==4;});},getMetricsMaxValue:function(){var u=P.call(this).max;return u===undefined?3000000:u;},getMetricsMinValue:function(){var u=P.call(this).min;return u===undefined?-3000000:u;},getMetricsCount:function(){var u=P.call(this).cnt;return u===undefined?100:u;},getFormatString:function(){var w=this.data.nf,v=this,u=Z.filterOne(w,function(x){return x.id===v.basedOnId;})||{};return u.nfs||"";},getDefaultColors:function r(){return I;},getDefaultImages:function J(){return V;},getNormalizedValue:function(x,w){var u=null;if(w===m||w===c||w===e){u=x/100;}if(w===f||w===W||w===G){u=x/(this.getMetricsCount());}if(w===d){u=(x-this.getMetricsMinValue())/(this.getMetricsMaxValue()-this.getMetricsMinValue());}if(u<0){u=0;}if(u>1){u=1;}return u;},getRealValue:function(v,u){if(u===m||u===c||u===e){return Y(v*100);}if(u===f||u===W||u===G){return Y(v*this.getMetricsCount());}if(u===d){return this.getMetricsMinValue()+v*(this.getMetricsMaxValue()-this.getMetricsMinValue());}return null;},getColorScheme:function(v){var u="custom",w,x,z;I.forEach(function(AA){z=AA.bands;x=v.length;if(x!==z.length){return ;}for(var AB=0;AB<x;AB++){w=mstrmojo.color.fixFullHexValue(v[AB]);if(z[AB].bc!==w&&z[x-AB-1].bc!==w){return ;}}u=AA.id;});return u;},getImageSetName:function U(z){var x=V[0].id,u,w=function(AA){return AA===u.bands[0].url;};for(var v=0;v<V.length;v++){u=V[v];if(z.some(w)){x=u.id;break;}}return x;},getGridValueFormat:function M(){return this.data.gsi.fmts.va;},isMapReversed:function N(w,u,z){var x=(z?V:I).filter(function(AA){return AA.id===w;})[0],v=u[0];if(!z){v=F.fixFullHexValue(v);}return x&&x.bands[0][z?"url":"bc"]!==v;},setConditionData:function Q(x,v){var w=x.data,u=w.isNew;K.copy(v,K.clear(w));delete w.isNew;x.paint();x.tree.onConditionEdit(x,u);},hasSelectedThresholds:function q(){return this.selectedThresholds.length>0;},isThresholdSelected:function b(u){return this.selectedThresholds.indexOf(u)!==-1;},toggleThresholdSelected:function X(u,w){var AB=this.selectedThresholds,AA=AB.indexOf(u),v=AA!==-1,z=this.thresholds[this.metricId],x=z.indexOf(u)!==-1;if(x){if(w&&!v){AB.push(u);}else{if(!w&&v){AB.splice(AA,1);}}o.call(this);}},addThresholds:function T(u){var v=this.thresholds[this.metricId];this.thresholds[this.metricId]=(v||[]).concat(u);k.call(this);},duplicateThreshold:function p(v){var x=this.thresholds[this.metricId],u=x[v],w=K.clone(u);x.push(w);if(this.isThresholdSelected(u)){this.toggleThresholdSelected(w,true);}k.call(this);},deleteThreshold:function t(u){var w=this.thresholds[this.metricId];var v=w.indexOf(u);if(v!==-1){this.toggleThresholdSelected(u,false);w.splice(v,1);}k.call(this);},moveThreshold:function C(v,x){var w=this.thresholds[this.metricId],u=w.splice(v,1);this.thresholds[this.metricId]=w.slice(0,x).concat(u,w.slice(x,w.length));k.call(this);},cleanUp:function O(){this.selectedThresholds=[];this.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.AUTO;},clearData:function S(){var u=this.thresholds;if(u){u[this.metricId]=undefined;}},saveOriginalData:function R(){this.orgThresholds=K.clone(this.thresholds);},setAttIdToNDE:function B(w){if(!(w instanceof Array)){w=[w];}var v,AC,x,u,AB,z=function(AD){AD.att.forEach(function(AE){if(AE.did===AB.did){AB.attId=AE.attId;}});},AA=function(AD){AD.conid=AB.did;};for(v=0;v<w.length;v++){u=w[v];for(AC in u){AB=u[AC];if(typeof AB==="function"||!(AB instanceof Object)){continue;}else{if(AC==="a"){if(AB.t===47&&AB.st===12033){K.forEach(this.controller.datasets,z);x=u.fn;if(x===22||x===57){(u.es||[]).forEach(AA);}}}else{this.setAttIdToNDE(u[AC]);}}}}}});mstrmojo.threshold.ThresholdModel.SLIDER_MODE={COLOR_BASED:0,IMAGE_BASED:1};mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL=[{n:"&#9679;",v:"1"},{n:"&#9632;",v:"2"},{n:"&#9830;",v:"3"},{n:"&#9670;",v:"4"},{n:"&#10070;",v:"5"},{n:"&#9784;",v:"6"},{n:"&#10047;",v:"7"},{n:"&#8984;",v:"8"},{n:"&#8680;",v:"29"},{n:"&#8679;",v:"30"},{n:"&#8681;",v:"31"}];mstrmojo.threshold.ThresholdModel.FEATURES={SHOW_ADVANCED_EDITOR:1,SHOW_BASED_ON:2,SHOW_IMAGE:3,SHOW_VALUE_ITEM:4};mstrmojo.threshold.ThresholdModel.EDITOR_TYPES={AUTO:0,ADVANCED_EDITOR:1,SIMPLE_EDITOR:2};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._Fetchable");mstrmojo.mstr.ElementsDataHelper=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.ElementsDataHelper",items:null,browseConfig:null,concat:true,init:function(A){var B=A&&A.browseConfig;if(B){this.blockBegin=B.blockBegin||1;this.blockCount=B.blockCount||mstrApp.elementsBlockCount||30;}if(this._super){this._super(A);}},getBrowseConfig:function(B){var A=this.browseConfig;A.blockBegin=B||1;A.silent=true;if(!A.datasetID){delete A.datasetID;delete A.messageID;}return A;},_retrieveItems:function(B,A){mstrApp.modelFactory.newElementDataService().getElements(this.getBrowseConfig(B),{success:function(C){if(A&&A.success){A.success({items:C.es,totalSize:C.sz});}},failure:function(C){if(A&&A.failure){A.failure(C);}},complete:function(C){if(A&&A.complete){A.complete(C);}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip","mstrmojo.css");mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",slot:"",alias:"",parent:null,init:function A(C){this._super(C);var D=this.parent;if(!D||D.hasInitBindings){this.initBindings();}},destroy:function B(C){if(this.hasRendered){this.unrender(C);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn,widgetResized:mstrmojo.emptyFn});mstrmojo.Widget.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};mstrmojo.Widget.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};mstrmojo.Widget.topMarkupMethod=function(){var C=this.top;if(C){this.domNode.style.top=C;}};mstrmojo.Widget.leftMarkupMethod=function(){var C=this.left;if(C){this.domNode.style.left=C;}};mstrmojo.Widget.heightMarkupMethod=function(){var C=this.height;if(C){this.domNode.style.height=C;}this.widgetResized();};mstrmojo.Widget.widthMarkupMethod=function(){var C=this.width;if(C){this.domNode.style.width=C;}this.widgetResized();};mstrmojo.Widget.enabledMarkupMethod=function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.StepperContentProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.StepperContentProvider",item:null,renderer:null,min:null,max:null,interval:1,minField:"min",maxField:"max",valField:"value",intField:"interval",canLoop:false,next:mstrmojo.emptyFn,prev:mstrmojo.emptyFn,hasPrev:mstrmojo.emptyFn,hasNext:mstrmojo.emptyFn,renderItemAt:mstrmojo.emptyFn,setVal:mstrmojo.emptyFn,getVal:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9,toXml:function A(){var K=this,D=function(Q,R){return" "+Q+'="'+R+'"';},C=function(Q,R){return D(Q,mstrmojo.string.encodeXMLAttribute(R));},G=new mstrmojo.StringBuffer(),E=function(R,S){var Q=mstrmojo.string.multiReplace(S.disp_n,{"&nbsp;":" "});R.append("<e"+C("ei",S.ei)+C("disp_n",Q)+D("emt",S.emt)+"/>");};var I=this.prms,B=I&&I.length;if(B||K.aopam!=K.DO_NOT_ANSWER){G.append("<hl"+D("mid",K.mid)+D("srct",K.srct)+D("aopam",K.aopam)+">");if(B){G.append("<prms>");for(var F=0;F<B;F++){var P=I[F];G.append("<prm"+D("id",P.id)+D("am",P.am)+D("pt",P.pt));if(P.orid){G.append(D("orid",P.orid)+D("ortp",P.ortp));}G.append(">");switch(P.am){case K.DO_NOT_ANSWER:case K.CLOSE:case K.USE_DEFAULT_ANSWER:case K.SAME_PROMPT:break;case K.STATIC:G.append('<pa ia="1"><es>');var O=P.pa.es,N=O&&O.length||0;for(var J=N-1;J>=0;--J){var H=O[J];E(G,H);}G.append("</es></pa>");break;case K.DYNAMIC:case K.ALL_VALID_UNITS:case K.CURRENT_UNIT:case K.DYNAMIC_OR_SAME_PROMPT:var M=P.pa;if(M){G.append('<pa ia="1">');var L=M.a;if(L){G.append("<a"+D("id",L.id)+C("n",L.n)+">");}if(P.pt===1){G.append(mstrmojo.string.encodeXMLAttribute(M.v));}else{G.append("<es"+D("dispForms",L&&L.dispForms>=0?L.dispForms:"")+">");var O=M.es;N=O&&O.length||0;for(var J=N-1;J>=0;--J){var H=O[J];E(G,H);}G.append("</es>");if(L){G.append("</a>");}}G.append("</pa>");}break;}G.append("</prm>");}G.append("</prms>");}G.append("</hl>");}return G.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.vi.enums.EnumDerivedElementType","mstrmojo.mstr.EnumFunction","mstrmojo.func");var I=mstrmojo.array.forEach,C=mstrmojo.hash.forEach,D=mstrmojo.hash.copy,J=mstrmojo.vi.enums.EnumDerivedElementType,O=mstrmojo.mstr.EnumFunction,R=mstrmojo.func.wrapMethods,G={};function B(T){var S=function(V){var U=[];I(V,function(W){U.push(W.n||mstrmojo.desc(14561,"(null)"));});return U.join(", ");};switch(T.t){case J.RESIDUE:return"";case J.LIST:return S(T.es);case J.CALCULATION:return G[T.func]+"("+S(T.es)+")";default:return"";}}function K(S,T){return{act:"remove",eId:T.id};}function M(T,U,S){return{act:"update",position:S+1,item:U};}function Q(T,U,S){return{act:"add",position:S+1,item:U};}G[O.FunctionAbs]="ABS";G[O.FunctionAdd]="ADD";G[O.FunctionAverage]="AVG";G[O.FunctionLeast]="MIN";G[O.FunctionGreatest]="MAX";G[O.FunctionMinus]="SUB";G[O.FunctionDivide]="DIV";mstrmojo.vi.models.DEConsolidation=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.DEConsolidation",items:null,isNameChanged:false,deleted:null,xtab:null,controller:null,othersDE:null,init:function N(S){this._super(S);this.items=[];this.deleted=[];this.isNameChanged=this.isNew=!(S.deObj);this.otherDE=null;this.populate();},populate:function F(){var S=this.deObj,U=this,T;if(!S){return ;}U.n=S.n;U.t=S.t;U.dsId=S.dsId;U.attId=S.attId;U.deId=S.did;I(S.des,function(W,V){if(W.ido){return false;}T=new mstrmojo.vi.models.DEConsolidationElem();T.populate(W,V);U.items.push(T);if(T.t===J.RESIDUE){U.othersDE=T;}});},addDE:function L(S,U){var T=new mstrmojo.vi.models.DEConsolidationElem();T.isNew=true;T.es=U;T.n=S;T.t=J.LIST;T.prev=B(T);this.items.splice(0,0,T);if(this.items.length===1){T=new mstrmojo.vi.models.DEConsolidationElem();T.isNew=true;T.t=J.RESIDUE;T.n=mstrmojo.desc(13655,"All Other Elements");if(this.othersConfig){C(this.othersConfig,function(V,W){T[W]=V;});delete this.othersConfig;}else{T.showChildren=true;}this.othersDE=T;this.items.splice(1,0,T);}return T;},updateDE:function A(S,T,V){var U=this.items[S];U.isDirty=true;U.n=T;U.es=V;U.prev=B(U);return U;},editOthers:function E(S){var T=this.othersDE;if(T){C(S,function(U,V){if(T[V]!==U){T[V]=U;T.isDirty=true;}});}else{this.othersConfig=S;}},isDirty:function H(){var T=this.items,S=this.deleted||[],U=this.deObj&&this.deObj.des||[];return(this.isNameChanged||S.length>0||T.length!==U.length||mstrmojo.array.filter(T,function(V){return V.isNew||V.isDirty;}).length>0||mstrmojo.array.filter(T,function(V){return V.n===(U[V._renderIdx]&&U[V._renderIdx].n);}).length!==T.length);},save:function P(){if(!this.isDirty()){return ;}var X=this,T=[],V=function(c){if(!c.isNew){T.push(K(X,c));I(X.items,function(d){if(!d.isNew&&d.origPos>c.origPos){d.origPos--;}});}},S=function(d,c){if(d.isNew){T.push(Q(X,d,c));I(X.items,function(f){if(!f.isNew&&f.origPos>=c){f.origPos++;}});}else{if(d.isDirty||d.origPos>c){T.push(M(X,d,c));}if(d.origPos>c){I(X.items,function(f){if(!f.isNew&&f.origPos>=c&&f.origPos<d.origPos){f.origPos++;}});}}};I(this.deleted,V);I(this.items,S);var U=this.controller,a=this.xtab,b=this.docModel,Z=a?U._getXtabCallback(a):(this.fromDS?b.getRebuildCallback():mstrmojo.emptyFn),W={act:"applyDEChanges",deId:this.deId,attId:this.attId,attName:this.attName,dsId:this.dsId,k:a&&a.k,actions:T};if(this.isNew){W.n=this.n;}if(this.fromDS){W.actions.push({act:"updateDeObject",name:this.n});}b.addUpdateObjects(W,{id:W.deId||W.attId,type:47,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});Z=R(Z,b.getDatasetsUpdateCallback(),b.getHighLightNDECallback());var Y=(W.actions&&W.actions.length>0)?[W]:[];if(this.getExtraSaveActions){Y=Y.concat(this.getExtraSaveActions());}if(!this.isNew&&!this.fromDS&&this.isNameChanged){Y=Y.concat({act:"updateTemplate",keyContext:a&&a.k,actions:[{act:"renameUnit",id:this.deId,type:47,name:this.dispName}],partialRetrieval:{nodes:[a&&a.k]}});}U.submitUndoRedoUpdates(Y,{},Z);}});mstrmojo.vi.models.DEConsolidationElem=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.models.DEConsolidationElem",origPos:null,isDirty:false,isNew:false,prev:null,populate:function F(T,S){D(T,this);this.origPos=S;this.prev=B(this);this.isDirty=false;this.isNew=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var K=mstrmojo.hash;var P=0;var F=[];var J={};var L=false;function I(T){var U=T.callback;if(U.submission){U.submission(T.id,this.userInteractionRequired(T),T);}this.submitRequest(T);}function G(){if(F.length&&!L){I.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(d,a,U,V){if(U){this.cancelRequests();}var X=this.id,Y=this.transport,T=mstrmojo.now()+a.taskId+P++,W=d.canceled||mstrmojo.emptyFn;d.canceled=function(e){W();d.complete(true);return Y.cancelRequest(e);};d=mstrmojo.func.wrapMethods(d,{complete:function(e){mstrmojo.all[X].deleteRequest(e);}});var Z=!K.isEmpty(this._requests),b=this.createRequest(T,d,a,V),c=(L||Z)&&!V.doNotHold;if(c){F.push(b);}else{I.call(this,b);}return T;},hasRequests:function O(){return !K.isEmpty(this._requests)||L;},createRequest:function Q(V,X,W,T){var U=this._requests;if(!U){U=this._requests={};}U[V]={id:V,callback:X,params:W,config:T};return U[V];},submitRequest:function M(T){this.transport.serverRequest(this.id,T.id,T);},cancelRequests:function S(){var T=false;K.forEach(this._requests,function(U){if(U.gotResponse===undefined){T|=U.callback.canceled(U.id);}});this._requests={};F=[];return T;},cancelRequest:function B(X){var U=false,W=this._requests[X],V,T=F.length;for(V=0;V<T;V++){if(F[V]===W){break;}}if(V<T){F.splice(V,1);delete this._requests[X];U|=W.callback.canceled(W.id);}return U;},response:function A(X,T,V){$MAPF(false,"AndroidServerTransport","transportRequest");var W=this.getRequest(X);if(W){W.gotResponse=true;var Y=W.callback,U=(T&&!V.mstrerr)?"success":"failure";try{if(Y[U]){Y[U](V,W);}}finally{Y.complete(X);}}G.call(this);},deleteRequest:function N(U){var T=this._requests;delete T[U];},getRequest:function H(U){var T=this._requests;return T&&T[U];},userInteractionRequired:function C(T){return false;},addLoadingGraph:function D(T){J[T]=true;L=true;},removeLoadingGraph:function R(T){delete J[T];if(K.isEmpty(J)){L=false;G.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._Fetchable");mstrmojo.mstr.DocElementDataHelper=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.DocElementDataHelper",source:null,items:null,browseConfig:null,concat:true,init:function(A){var B=A&&A.browseConfig;this.blockBegin=(B&&B.blockBegin)||1;this.blockCount=(B&&B.blockCount)||mstrApp.elementsBlockCount||30;if(this._super){this._super(A);}},getBrowseConfig:function(){if(!this.browseConfig){this.browseConfig={blockBegin:this.blockBegin,blockCount:this.blockCount};}return this.browseConfig;},_retrieveItems:function(C,B){var A=this.getBrowseConfig();A.blockBegin=C;mstrmojo.func.override({success:function(D){if(this._super){this._super(mstrmojo.hash.copy(D,{items:D.es,totalSize:D.sz}));}}},B);this.source.browseElements(A,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");function B(J,I){this.raiseEvent({name:"viCompBuilt",type:J,widget:I});}mstrmojo.vi.models.VIComponentMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.VIComponentMap",init:function G(I){this._super(I);this.relativePanels={};this.comps={};},addRelativePanel:function H(I){this.relativePanels[I]=true;},isRelativePanel:function F(I){return !!this.relativePanels[I];},isComponent:function C(J,I){return this.getComponentKey(J)===I;},getComponent:function A(I){return this.comps[I];},getComponentKey:function D(J){var I=this.getComponent(J);return(I&&I.k)||"";},createComponent:function E(L,K,J){B.call(this,L);var I=new K(J);this.comps[L]=I;B.call(this,L,I);return I;}});mstrmojo.vi.models.VIComponentMap.TYPES={FILTER_STACK:1,FILTER_PANEL:2,PAGEBY_STACK:3,PAGEBY_PANEL:4,VIZ_CONTENT:5,MAIN_CONTENT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array");var B=mstrmojo.array;mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",path:mstrConfig.taskURL,serverRequest:function(C,D){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(C,D,{silent:true});}else{mstrmojo.xhr.request("POST",this.path,D,C,undefined,this.XServer,this.baseParams);}},fetchFolderContents:function(C,D,G){var E=C.blockCount,F={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:E,includeAncestorInfo:"true",includeObjectDesc:C.includeObjectDesc};if(C.folderLinksContextId){F.folderLinksContextId=C.folderLinksContextId;}if(C.sId){F.sessionState=C.sId;}if(D.fid){F.rootFolderID=D.fid;}else{if(D.fty){F.rootFolderType=D.fty;}}if(C.browsableTypes){F.objectType=C.browsableTypes;}if(D.blockBegin){F.blockBegin=D.blockBegin;}if(D.searchPattern){if(C.enableQuickSearch){F.quickSearch=C.enableQuickSearch;}F.searchPattern=D.searchPattern;if(D.recursive){F.recursive=D.recursive;}}this.serverRequest(F,G);},newFolder:function(F,G,E,C){var D={taskId:"createFolder",taskContentType:"json",folderID:F,name:G,description:E};this.serverRequest(D,C);},loadObjects:function A(G,H,C,F){var D=[],E=[];B.forEach(G,function(I){D.push(I.did);E.push(I.t);});if(G.length>0&&F){this.serverRequest({taskId:"getObjectInfo",objectIDs:D.join(","),objectTypes:E.join(","),includeDetails:true},H,C);}else{H.success();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.MapHelper","mstrmojo.vi.viz.EnumDSSDropZones");var E=mstrmojo.vi.viz.MapHelper,D=mstrmojo.vi.viz.EnumDSSDropZones,H=mstrmojo.gmaps,A=new RegExp(".{32}","g");function C(I){return(I.sa==="1")?E.MTP_AREA:I.mtp;}mstrmojo.vi.viz.ESRIMapHelper=mstrmojo.declare(mstrmojo.vi.viz.MapHelper,null,{scriptClass:"mstrmojo.vi.viz.ESRIMapHelper",setWidget:function G(I){this._super(I);this.mapType=C(I.model.data.vp);},setMapType:function F(I){this._super(I);if(I===mstrmojo.vi.viz.MapHelper.MTP_AREA){this.vp.sa="1";this.vp.sm="0";}else{this.vp.sm="1";this.vp.sa="0";}},showAngleZone:function(){return(vp.mtp===H.EnumMapType.Marker||vp.mtp===H.EnumMapType.Bubble)&&vp.mc===H.EnumClusterMode.PIE;},showColorByZone:function(){return E.canShowColorByZone(this.mapType||C(this.vp));},showSizeByZone:function(){return E.canShowSizeByZone(this.mapType||C(this.vp));},getXml:function B(){var K=this.vp,P=this.geoAttribute,N=this.latitude,O=this.longitude,Q=this.colorBy,I=this.sizeBy,R=this.tooltip,M=this.mapType,J=this.defaultView,L=this.useAttributeForm;if(M){K.mtp=M;K.sa=M===E.MTP_AREA?"1":"0";K.sm=M===(E.MTP_MARKER||M===E.MTP_BUBBLE)?"1":"0";}if(J){K.dv=J;}K.ma=P||"";K.lat=N||"";K.lng=O||"";K.cmt=Q||"";K.smt=I||"";if(L){K.af=L;}K.tooltip="";R.forEach(function(S){K.tooltip+=S;});return this._super();}});mstrmojo.vi.viz.ESRIMapHelper.zonesCfg=[{n:mstrmojo.desc(11661,"Geo Attribute"),id:D.GeoAttribute,prm:true,show:function(I){return true;},v:function(I){return[I.ma];},onDel:function(I){I.ma="";},onAdd:function(I,J){I.ma=J.item.did;I.af=E.USE_ATTRIBUTE_FORM;I.lid="";}},{n:mstrmojo.desc(7696,"Latitude"),id:D.Latitude,prm:true,show:function(I){return I.sa!=="1";},v:function(I){return I.lat?[I.lat]:[];},onDel:function(I){I.lat="";},onAdd:function(I,J){var K=J.item;I.lat=K.did;I.af=K.t===21?E.USE_ATTRIBUTE_FORM:E.USE_ATTRIBUTE;}},{n:mstrmojo.desc(7697,"Longitude"),id:D.Longitude,prm:true,show:function(I){return I.sa!=="1";},v:function(I){return I.lng?[I.lng]:[];},onDel:function(I){I.lng="";},onAdd:function(I,J){var K=J.item;I.lng=K.did;I.af=K.t===21?E.USE_ATTRIBUTE_FORM:E.USE_ATTRIBUTE;}},{n:mstrmojo.desc(14294,"Angle"),id:D.Angle,prm:true,show:function(I){return(I.mtp===H.EnumMapType.Marker||I.mtp===H.EnumMapType.Bubble)&&I.mc===H.EnumClusterMode.PIE;},v:function(I){return[I.amt];},onDel:function(I){I.amt="";},onAdd:function(I,J){I.amt=J.item.did;}},{n:mstrmojo.desc(11662,"Color By"),id:D.ColorBy,prm:true,show:function(I){return E.canShowColorByZone(C(I));},v:function(I){return[I.cmt];},onDel:function(I){I.cmt="";},onAdd:function(I,J){I.cmt=J.item.did;}},{n:mstrmojo.desc(11663,"Size By"),id:D.SizeBy,prm:true,show:function(I){return E.canShowSizeByZone(C(I));},v:function(I){return[I.smt];},onDel:function(I){I.smt="";},onAdd:function(I,J){I.smt=J.item.did;}},{n:mstrmojo.desc(2962,"Tooltip"),id:D.AdditionalMetrics,prm:false,show:function(I){return true;},v:function(I){var J=I.tooltip;return J&&J.match(A);},onDel:function(I,J){I.tooltip=I.tooltip.replace(J.item.did,"");},onAdd:function(I,J){var K=I.tooltip?I.tooltip.match(A):[];K.splice(J.idx,0,J.item.did);I.tooltip=K.join("");}}];}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.MapHelper","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.hash");var C=mstrmojo.vi.viz.EnumDSSDropZones,D=mstrmojo.vi.viz.MapHelper,A=new RegExp(".{32}","g");mstrmojo.vi.viz.GoogleMapHelper=mstrmojo.declare(mstrmojo.vi.viz.MapHelper,null,{scriptClass:"mstrmojo.vi.viz.GoogleMapHelper",supportAreaMap:false,tooltip:[],showColorByZone:function(){return D.canShowColorByZone(this.mapType||this.vp.mtp);},showSizeByZone:function(){return D.canShowSizeByZone(this.mapType||this.vp.mtp);},getXml:function B(){var G=this.vp,L=this.geoAttribute,J=this.latitude,K=this.longitude,M=this.colorBy,E=this.sizeBy,N=this.tooltip,I=this.mapType,F=this.defaultView,H=this.useAttributeForm;if(I){G.mtp=I;}if(F){G.dv=F;}G.ga=L||"";G.flat=J||"";G.flong=K||"";G.cmt=M||"";G.smt=E||"";if(H){G.af=H;}G.tooltip="";N.forEach(function(O){G.tooltip+=O;});return this._super();}});mstrmojo.vi.viz.GoogleMapHelper.zonesCfg=[{n:mstrmojo.desc(11661,"Geo Attribute"),id:C.GeoAttribute,prm:true,show:function(E){return true;},v:function(E){return E.ga?[E.ga]:[];},onDel:function(E){E.ga="";},onAdd:function(E,F){E.ga=F.item.did;E.af=D.USE_ATTRIBUTE_FORM;}},{n:mstrmojo.desc(7696,"Latitude"),id:C.Latitude,prm:true,show:function(E){return E.mtp!=="3";},v:function(E){return E.flat?[E.flat]:[];},onDel:function(E){E.flat="";},onAdd:function(E,F){var G=F.item;E.flat=G.did;E.af=G.t===21?D.USE_ATTRIBUTE_FORM:D.USE_ATTRIBUTE;}},{n:mstrmojo.desc(7697,"Longitude"),id:C.Longitude,prm:true,show:function(E){return E.mtp!=="3";},v:function(E){return E.flong?[E.flong]:[];},onDel:function(E){E.flong="";},onAdd:function(E,F){var G=F.item;E.flong=G.did;E.af=G.t===21?D.USE_ATTRIBUTE_FORM:D.USE_ATTRIBUTE;}},{n:mstrmojo.desc(11662,"Color By"),id:C.ColorBy,prm:true,show:function(E){return D.canShowColorByZone(E.mtp);},v:function(E){return E.cmt?[E.cmt]:[];},onDel:function(E){E.cmt="";},onAdd:function(E,F){E.cmt=F.item.did;}},{n:mstrmojo.desc(11663,"Size By"),id:C.SizeBy,prm:true,show:function(E){return D.canShowSizeByZone(E.mtp);},v:function(E){return E.smt?[E.smt]:[];},onDel:function(E){E.smt="";},onAdd:function(E,F){E.smt=F.item.did;}},{n:mstrmojo.desc(2962,"Tooltip"),id:C.AdditionalMetrics,prm:false,show:function(E){return true;},v:function(E){var F=E.tooltip;return F?F.match(A):[];},onDel:function(E,F){E.tooltip=E.tooltip.replace(F.item.did,"");},onAdd:function(E,F){var G=E.tooltip?E.tooltip.match(A):[];G.splice(F.idx,0,F.item.did);E.tooltip=G.join("");}}];}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport");var BasicAggMap={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"},RankMap={"8107C326DD9911D3B98100C04F2233EA":"Rank"},OLAPAggMap={D221F90EB35540E3A1204ED6CC9A8267:"Avg",D221F90FB35540E3A1204ED6CC9A8267:"Count",D221F910B35540E3A1204ED6CC9A8267:"Max",D221F911B35540E3A1204ED6CC9A8267:"Min",D221F90DB35540E3A1204ED6CC9A8267:"Sum"},MovingAggMap={"8107C32ADD9911D3B98100C04F2233EA":"Avg","8107C350DD9911D3B98100C04F2233EA":"Count","8107C34BDD9911D3B98100C04F2233EA":"Max","8107C34CDD9911D3B98100C04F2233EA":"Min","8107C32BDD9911D3B98100C04F2233EA":"Sum"},RunningAggMap={"8107C329DD9911D3B98100C04F2233EA":"Avg","8107C354DD9911D3B98100C04F2233EA":"Count","8107C351DD9911D3B98100C04F2233EA":"Max","8107C352DD9911D3B98100C04F2233EA":"Min","8107C328DD9911D3B98100C04F2233EA":"Sum"},BandingMap={"8107C337DD9911D3B98100C04F2233EA":"Banding","8107C338DD9911D3B98100C04F2233EA":"BandingC","8107C339DD9911D3B98100C04F2233EA":"BandingP"};function _sortFunctions(fcts){var fs=function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);},i,len;fcts=fcts.sort(fs);for(i=0,len=fcts.length;i<len;i++){fcts[i].fns=fcts[i].fns.sort(fs);}return fcts;}function getFuncCatIndex(fcts,funcDid){var len=fcts.length,ci;for(ci=0;ci<len;ci++){var fns=fcts[ci].fns;if(mstrmojo.array.find(fns,"did",funcDid)>-1){return ci;}}return -1;}function buildTaskParams(params){var qse=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();params=mstrmojo.hash.copy(params,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false});if(qse){params.quickSearch=qse;params.nameWildcards=16;params.sortKey=-1;}return params;}function serverRequest(callback,taskParams){if(mstrApp.serverRequest){mstrApp.serverRequest(taskParams,callback);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(callback,taskParams,false,{});}}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getServerProxy:function getServerProxy(){if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}return this.serverProxy;},getMetricDefintion:function getMetricDefintion(params,callbacks){var taskParams={taskId:"getMetricDefinition",metricId:params.id,outputFlags:65599};if(params.msgID){taskParams.msgID=params.msgID;}serverRequest.call(this,callbacks,taskParams);},validateMetric:function validateMetric(params,callbacks){var taskParams={taskId:"validateMetric",metricId:params.metricId,tokenStreamXML:params.tokenStreamXML,metricXML:params.metricXML,outputFlags:327695};if(mstrmojo.string.isEmpty(params.metricId)){taskParams.isNew=true;}if(params.msgID){taskParams.msgID=params.msgID;}if(params.formID){taskParams.frmid=params.formID;}if(params.isIDForm){taskParams.isIDForm=params.isIDForm;}if(params.objectType){taskParams.objectType=params.objectType;}serverRequest.call(this,callbacks,taskParams);},getMetricComponents:function getMetricComponents(params,callbacks){var me=this,mc=this.metricComponents;if(!this.noCache&&mc&&mc.items.length==mc.sz){callbacks.success(mc);return ;}callbacks.success=mstrmojo.func.composite([callbacks.success,function(res){if(me.metricComponents&&me.metricComponents.items){me.metricComponents.items.push(res.items);}else{me.metricComponents=res;}}]);var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||24,objectType:params.objectType||"12,13,43"});serverRequest.call(this,callbacks,taskParams);},getAttributes:function getAttributes(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||26,objectType:12});serverRequest.call(this,callbacks,taskParams);},getFacts:function getFacts(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||29,objectType:13});serverRequest.call(this,callbacks,taskParams);},getMetrics:function getMetrics(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||5,objectType:4});if(params.isVerify){taskParams.nameWildcards=2;}serverRequest.call(this,callbacks,taskParams);},getFunctions:function getFunctions(callbacks){var me=this,wss=window.sessionStorage,fcts=this.functions||(wss&&wss.getItem("functions")),localeId=wss&&wss.getItem("mstrLocaleId"),cLocaleId=mstrApp&&mstrApp.localeId;if(fcts&&localeId==cLocaleId){fcts=_sortFunctions(eval("("+fcts+")").fncs);callbacks.success(fcts);}else{var cb={failure:callbacks.failure,textResponse:true},taskParams={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2|2147483648,includeFunctionHelpTopic:true};cb.success=function(res){if(typeof res==="string"||!mstrApp.isSingleTier){if(wss){wss.setItem("functions",res);wss.setItem("mstrLocaleId",cLocaleId);}me.functions=res;fcts=_sortFunctions(eval("("+res+")").fncs);}else{fcts=_sortFunctions(res.fncs);me.functions=JSON.stringify(res);}callbacks.success(fcts);};serverRequest.call(this,cb,taskParams);}},getAggFunctions:function getAggFunctions(){if(this._aggFunctions){return this._aggFunctions;}var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.array.filter(fcts[this.getBasicCategoryIndex(fcts)].fns,function(item){var did=item.did,retVal;if(did!=="B2C0FA4020C711D6AD1400C04F0423DE"&&did!=="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=BasicAggMap[did];}return retVal;});return fcts;},getOLAPAggFunctions:function getOLAPAggFunctions(type){var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.array.filter(fcts[this.getOLAPCategoryIndex(fcts)].fns,function(item){switch(type){case"moving":return MovingAggMap[item.did];case"running":return RunningAggMap[item.did];case"olap":default:return OLAPAggMap[item.did];}return false;});return fcts;},getFunctionCatList:function getFunctionCatList(){if(this._functionCatList){return this._functionCatList;}var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.hash.make(fcts,mstrmojo.Arr);this._functionCatList=fcts;return fcts;},getCategoryIndex:function getCategoryIndex(funcDid,fcts){return getFuncCatIndex(fcts||this.getFunctionCatList(),funcDid);},getBasicCategoryIndex:function getBasicCategoryIndex(fcts){var Agg_Func_Greatest="B2C0FA4020C711D6AD1400C04F0423DE";return getFuncCatIndex(fcts||this.getFunctionCatList(),Agg_Func_Greatest);},getDataMiningCatIndex:function getDataMiningCatIndex(fcts){var DataMining_Func_MiningModel="F17CD4F3FF134D91B80DDAB9CA73C919";return getFuncCatIndex(fcts||this.getFunctionCatList(),DataMining_Func_MiningModel);},getDateTimeCategoryIndex:function getDateTimeCategoryIndex(fcts){var DateTime_Func_Date="C50F2A4F75AE49D6B20E00224967B500";return getFuncCatIndex(fcts||this.getFunctionCatList(),DateTime_Func_Date);},getStringCategoryIndex:function getStringCategoryIndex(fcts){var String_Func_Concat="6F7DF5FF449111D5BEA300B0D01A55EF";return getFuncCatIndex(fcts||this.getFunctionCatList(),String_Func_Concat);},getOLAPCategoryIndex:function getBasicCategoryIndex(fcts){var OLAP_Func_Avg="D221F90EB35540E3A1204ED6CC9A8267";return getFuncCatIndex(fcts||this.getFunctionCatList(),OLAP_Func_Avg);},getInternalCategoryIndex:function getInternalCategoryIndex(fcts){var INTER_Func_Band="8107C337DD9911D3B98100C04F2233EA";return getFuncCatIndex(fcts||this.getFunctionCatList(),INTER_Func_Band);},getFunctionDetails:function getFunctionDetails(params,callbacks){var taskParams={taskId:"getSystemFunctions",functionId:params.did,includeFunctionDetails:true,includeFunctionHelpTopic:true};serverRequest.call(this,callbacks,taskParams);},getTransformations:function getTransformations(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||38,objectType:43});serverRequest.call(this,callbacks,taskParams);},getFilters:function getFilters(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||4,objectType:1});serverRequest.call(this,callbacks,taskParams);},getAttributeForms:function getAttributeForms(params,callbacks){var taskParams={taskId:"getAttributeForms",attributeID:params.attributeID,displayedForms:params.displayedForms,styleName:"WidgetElementListStyle"};serverRequest.call(this,callbacks,taskParams);},getSubtotalFunctions:function getSubTotalFunctions(params,callbacks){var taskParams=buildTaskParams({objectType:"1025,1026",searchPattern:""});serverRequest.call(this,callbacks,taskParams);},isBasicAggMap:function isBasicAggMap(did){var retVal=!!BasicAggMap[did];if(did==="B2C0FA4020C711D6AD1400C04F0423DE"||did==="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=false;}return retVal;},isOLAPAgg:function isOLAPAgg(did){return !!OLAPAggMap[did];},isMovingAgg:function isMovingAgg(did){return !!MovingAggMap[did];},isRunningAgg:function isRunningAgg(did){return !!RunningAggMap[did];},isBanding:function isBanding(did){return !!BandingMap[did];},isOLAP:function isOLAP(did){var fcts=this.getFunctionCatList(),olapFns=fcts[this.getOLAPCategoryIndex(fcts)].fns;return mstrmojo.array.find(olapFns,"did",did)>-1;},isRank:function isRank(did){return !!RankMap[did];},isScalar:function isScalar(fctOi){return(fctOi||{}).sqt===3;},getFunctionHelpTopic:function getFunctionHelpTopic(h){return'<a href="'+((mstrApp.helpUrl||"../help/")+"FunctionsRef/index.html?context=functionsref&topic="+(h||""))+'" target="_new">'+mstrmojo.desc(5811,"Details ...")+"</a>";},sortFunctions:function sortFunctions(functions){var allfuncs={},fs=function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);};mstrmojo.array.forEach(functions,function(funcs){mstrmojo.array.forEach(funcs&&funcs.fns,function(func){if(func&&func.did){allfuncs[func.did]=func;}});});return mstrmojo.hash.valarray(allfuncs).sort(fs);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.func","mstrmojo.array","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.VisEnum");mstrmojo.requiresClsP("mstrmojo.vi.models","EnumPanelTypes");var J=mstrmojo.array,L=mstrmojo.hash,S=mstrmojo.func,I=mstrmojo.EnumRWUnitType,K=mstrmojo.vi.models.VIComponentMap.TYPES,C=mstrmojo.vi.viz.KnownVisualizations,Y=mstrmojo.vi.models.EnumPanelTypes,X="\u001E",H=mstrmojo.DocDataService.REQUEST_DEFN_DATA,G=mstrmojo.DocDataService.SUPPRESS_DATA,Z=mstrmojo.VisEnum.VIS_CARDLIMIT.NON_GRID;var Q=4;function D(b){b=b||{};return this.createNewUnitNode(function(c){c.eg="";if(b.fnData){c=b.fnData(c);}return c;},function(c){c.t=I.GRID;c.n=b.n||"";c.ttl=b.title||c.n;c.ds=0;c.tt=1;c.eo=0;if(b.fnDefn){c=b.fnDefn(c);}return new mstrmojo.Model(c);},b.fnNode,b.nodeKey,b.layoutKey);}function M(e,f,c,d,b,g){e.execute({execute:function(){var AC=e.getDataService(),v=e.cmdMgr(),AE=this,w=e.controller.view,r=AC.newUpdate(),u=f.parent,z=u.k,m=e.getCurrentLayoutKey(),AG,t=b===m,k=f.k,AB,AA,AD,x,n;if(g&&f.boxContent&&f.boxContent.updateAssociatedNodesOnMove){f.boxContent.updateAssociatedNodesOnMove();}if(t){x=!!d;if(!x){AG=e.addPanel(r,c);d=AG.k;AD=true;var p=c.id,AF=c.parent.id,q=c.k,h=function(){this.urInfo.puKeys=[q];}.bind(this);this.urInfo=L.copy({undo:h,redo:h,callback:S.wrapMethods({success:function(AH){e.controller.view.updateXtabStyles(b,AH.data.layouts[J.find(AH.data.layouts,"k",b)].xtabStyles);e.updateDefnCache(AH.defn,[q,z,d]);e.updateDataCache(AH.data,e.getTargetDefn(q));var AI=mstrmojo.all[AF];AI.rebuildChild(mstrmojo.all[p]);AI.doLayout();}})},this.urInfo);}else{AG=e.getPanel(d);AD=d===z||AG.defn.l;if(d!==z){this.urInfo=L.copy({undo:function(){this.urInfo.puKeys=[z];},redo:function(){this.urInfo.puKeys=[d];},callback:S.wrapMethods({success:function(){e.getPanel(z).unload();e.getPanel(d).unload();}},e.getRebuildCallback()),treesToRender:3},this.urInfo);}}AA={parentKey:d};}else{if(b){AD=false;x=true;e.markDirtyLayout(b);w.showLayout(w.getLayout(b),null,r);AA={layoutKey:b,analysisSectionType:Y.VISUALIZATION};AE.urInfo=L.copy({callback:S.wrapMethods({success:function(){if(g){e.markDirtyLayout(m);}e.markDirtyLayout(b);}},e.getRebuildCallback())},this.urInfo);}else{AD=false;x=false;b=e.getNextKey();d=e.getNextKey();n=v.CMD_PHASE.FIRST;w.addNewLayout(r,-1,{nodeKey:b,newPanelKey:d,analysisSectionType:Y.VISUALIZATION});AA={parentKey:d};}}if(g){AB=k;if(!u.hasMultipleChildren()){e.addVisualizationDeferred(r,z);}u.deleteBoxAndSubmitDeferred(r,f,undefined,true,true);r.addActions(AC.getMacroMoveNodeAction(f,AA));if(AD){f.unrender();AG.insertNewBoxAndSaveDeferred(r,f);r.addCallbacks({success:function(AI){var AH=[d,f.k];e.updateDefnCache(AI.defn,AH);e.updateDataCache(AI.data,e.getTargetDefn(AH.join(X)));AG.rebuildChild(f);}});}else{if(!t){e.markDirtyLayout(m);}f.destroy();}}else{var l=D.call(e,{n:f.title,layoutKey:b});AB=l.k;r.addActions(AC.getMacroCopyNodeAction(f,AA,AB));if(AD){var o=e.createUnit(l,d);e.deferredInsertUnit(r,o,d);if(z===d){B(e,f,o,r);this.urInfo.puKeys=[z];}}}if(t){if(!x){e.selectNewPanel(r,d);}else{if(z!==d){c.selectPanelDeferred(r,d);}}}if(x){if(!AD){n=v.CMD_PHASE.FIRST;r.addCallbacks({success:function(){AG=e.getPanel();var AI=AG.getUnitByKey(AB),AH=v.getInterimCmd();if(!AG.hasBoxLayoutChild(AI)){AG.insertNewBox(AI);}if(AG.defn.layoutXML){AG.saveBoxLayout(AH,v.CMD_PHASE.LAST,null,null,true);}else{AG.saveBoxLayout(AH,v.CMD_PHASE.LAST,null,null,true);}}});}r.addCallbacks({success:function(){AG.getUnitByKey(AB).selectVIUnit();}});}r.addExtras(H);this.submitUpdate(r,n);},urInfo:{treesToRender:3}});}function B(x,p,f,n){var c=p.k,u=f.k,r=p.parent.children,w=[],l=p.boxContent,h=l.getFilterType()===1,m=true,q,e,v=x.getDataService();J.forEach(r,function(AB){var AA=AB.defn.an,z=J.find(AA,"k",c)!==-1,AC;if(m){q=x.getNextKey();}if(z){AC=AB.boxContent.selectorControl;w.push(AB.k);AA.push({k:u,muc:24});n.addActions({act:"associateNodes",nodeKey:AB.k,targetKeys:[u],partialRetrieval:v.newRetrievalKeysConfig().addNode(AB.k)});if(AC){AC.cgb[L.keyarray(AC.cgb).length+1]=q;n.addActions({act:"addVisToFilter",parentKey:c,targetKey:u,ctrlKey:AC.ckey,newCGB:m,cgbKey:q});}}if(!h){m=false;}});if(l&&l.selectorControl){var o=x.getCurrentLayoutDef().cgbMap,d=[],t=[],k=[],b=l.selectorControl,g=function(z){var AA;L.forEach(o,function(AB,AC){if(L.valarray(b.cgb).indexOf(AC)!==-1&&z===AB){AA=AC;}});return AA;};e=(b.tks||"").split("\u001E");e.forEach(function(z){var AE,AD,AB,AA,AC=(r.filter(function(AF){return AF.k===z;}))[0];AE=AC.boxContent.getFilterType();if(AE===1){d.push(z);AD=x.getNextKey();o[AD]=z;t.push([AD,true]);AB=g(z);L.forEach(b.cgb,function(AG,AF){if(AG===AB){AA=AF;}});if(AA){b.cgb[AA]=AD;}k.push([AB,false]);}});if(d.length){n.addActions({act:"replaceControlCGB",oldCGBNodeKey:k,targetKeys:d,newCGBNodeKeys:t,controlKey:l.selectorControl.ckey,sourceKey:c});}}if(w.length>0){n.addCallbacks({success:function(z){x.partialUpdate(z.data,x.getTargetDefn(w),z.defn,w);}});}}mstrmojo.vi.models._VisActions=mstrmojo.provide("mstrmojo.vi.models._VisActions",{_mixinName:"mstrmojo.vi.models._VisActions",createNewVizNode:D,addVisualizationDeferred:function(g,f){var b=this,e=mstrmojo.desc(11659,"New Visualization"),d=b.createNewUnitNode();L.copy({t:I.GRID,ttl:e,n:e,ds:0,tt:1,eo:0},d.defn);d.data.eg="";var c=b.createUnit(d,f);g.addActions([b.getCopyEmptyTemplateAction(c.k,f)]);b.deferredInsertUnit(g,c,f);g.actions.some(function(h){if(h.unitKey===c.k){h.partialRetrieval={nodes:[c.k]};return true;}});g.addExtras(H);return c;},addVisualization:function T(){var b=this,c,d,e=this.getPanel().k;b.execute({execute:function(){var g=b.getDataService(),h=g.newUpdate(this);var f=b.addVisualizationDeferred(h,e);c=f.k;d=f.boxContent.node;this.submitUpdate(h);},urInfo:{treesToRender:3,undo:function(){this.urInfo.puKeys=[];this.urInfo.callback={};var g=b.getUnitInstance(e,1),f=g.getUnitByKey(c),k=b.getLayoutUnitDefn(c),l=b.getLayoutUnitDefn(k.pnk),h=l.layoutXML;k._isDeleted=true;h.children=h.children.filter(function(m){return m.k!==c;});g.removeChildren(f);f.destroy();b.restoreUIState(this.undoUIState);return true;},redo:function(){this.urInfo.puKeys=[c];this.urInfo.callback={success:function(g){var k=b.createUnit(d,e),f=b.getUnitInstance(e,1),h=b.getLayoutUnitDefn(c);if(h){delete h._isDeleted;}f.addChildren(k);f.boxLayoutConfig.dirty=true;b.partialUpdate(g.data,b.getTargetDefn([c]),g.defn,[c]);f.rebuildChild(k);}};return false;}}});},duplicateVisualization:function V(d){var b=this.getCurrentLayoutKey(),c=d.boxContent.builder.getLayoutVIMap(b).getComponent(K.VIZ_CONTENT);M(this,d,c,c.selectedKey,b,false);},copyVisualization:function(e,c,d,b){M(this,e,c,d,b,false);},moveVisualization:function(e,c,d,b){M(this,e,c,d,b,true);},renameRWUnitTitle:function P(d,c,b,e){this.updateTitle(d,c,b,this.currlaykey,"ttl",e);},changeSelectedVisType:function W(AA,t,e,m){var v=this.getSelectedViUnit();if(!v){return ;}var u=[],n=v.boxContent,AC=n.node.data,r=C.getDefinition(AA),b=this.controller.visTransitionFactory.newVisualizationTransition(AA||"Grid",{vis:n,newVizInfo:{s:AA,dz:m}});if(C.getDefinition(AC.visName||"Grid").id===C.GRID){var c=[];b.addClearAllThresholdsActions(c);u.push({act:"updateTemplate",keyContext:n.k,actions:c});}if(AA!==""&&r.id!==C.UNKNOWN){u.push({act:"updateTemplate",keyContext:n.k,actions:[{act:"createDefaultDropZones",nodeKey:n.k,treeType:n.defn.tt,datasetId:AC.datasetId,datasetType:3,widgetType:e,partialUpdate:{nodes:[n.k]}}]});}var q=b?b.transitionDropZones(u,t):{wp:""},k=q.wp,g=q.handled,o=[],l=b&&b.vis,z=l&&l.node&&l.node.data&&l.node.data.gts||{},p=(z.col||[]).concat(z.row||[]);if(e){J.forEach(p,function(h){o.push(h);});}var d=[],AB={},f=function(w){if(!w.id){w.id=w.did;}var h=w.id;AB[h]=w.card;};L.keyarray(this.datasets).forEach(function(h){d.push(h);});for(var x=0;x<d.length;x++){J.forEach(this.datasets[d[x]].att,f);}J.forEach(o,function(h){if(!h.id){h.id=h.did;}if(!h.cardg&&!h.card){h.card=AB[h.id];}});b.vis.zonesModel.checkAndWarnLargeItemsForAddUnits(o,function(AD,AG){if(k.length>0&&!g){var h=mstrmojo.ExpressVisList.findWidgetName(AA)||"",AF=H,AE=AG.k;u.push(this.getUnitChangeVizAction(AA,h,AG,k));u.push({act:"changeGridDisplayMode",nodeKey:AE,displayMode:AA===mstrmojo.vi.viz.EnumVizStyles.GRAPH_MATRIX?2:1});if(AD.model.data.eg!==undefined){AF=L.copy(AF,{preserveUndo:true});}this.controller.submitUndoRedoUpdates(u,null,{success:function AH(AJ){var AI=this.getCurrentLayoutKey(),w=this.getPanel();this.refreshDefinition(AE,this.getRawLayoutUnitDefn(AE,AJ.defn));this.updateDataCache(AJ.data,this.getTargetDefn(AE));if(AJ.data){AJ.data.layouts.some(function(AL){var AK=AL.k===AI;if(AK){this.controller.view.updateXtabStyles(AI,AL.xtabStyles);}return AK;},this);}this.selectVIUnit(w.rebuildChild(w.getUnitByKey(AE)).id,true);}.bind(this)},AF);}}.bind(this,n,v),null,!e,null,false,Z);},getUnitChangeVizAction:function F(h,b,g,f){var c=C.getDefinition(h);var e={IPhoneVisualization:"",IPadVisualization:"",APhoneVisualization:"",ATabletVisualization:""};if(c&&c.mobileVIStyles){e=L.copy(c.mobileVIStyles,e);}var d={Visualization:L.copy(e,{VisualizationsEnabled:h?-1:0,ViewMode:h?51:0,SelectedVisualization:h||"",VisualizationList:h||""}),FormattingIncrementalFetch:{EnableIFOnGrid:h?0:-1},FormattingWidget:{ClassName:h?b:"",Enable:(b!=="")?1:0}};if(f){d.FormattingWidget.WidgetProps=f;}return this.getUnitFormatAction(g,1,d);},setVisAsFilter:function a(AB,AK,q){var v=[],AD=AK.sc,AL=AK.targetKeys,AF=AK.isFilter,x=AK.clearAll,k=this,z=[],AH=[],b=[],AC=[],AE=false,AJ,m,h,l=[],c=[],g=AK.forAllData!==undefined&&AK.forAllData,AG=false,AA=false,f=AK.singleUnit,w=k.getCurrentLayoutDef().cgbMap,t={},o,d=[],e,n=function n(){delete AB.defn.an;},u=function(){if(x===undefined&&AD){return AD.all||AD.showall;}return x===undefined?true:!!x;},p=function(){if(AE&&AF===undefined){if(b.length===AC.length){return true;}return !!AD;}else{if(AF!==undefined){return AF;}}return true;},r=G,AI=function(AN){var AM=false;L.forEach(AL,function(AO){if(AO.cgbs&&AO.cgbs.length){AO.cgbs.forEach(function(AP){AM=AM||L.valarray(AP.sc.cgb).indexOf(AN)!==-1;});}});return AM;};mstrmojo.hash.forEach(AL,function(AN,AM){if(AN.c){AE=true;AC.push(AM);}if((AN.v&&!AN.c)||(!AN.v&&AN.c)){AH.push(AM);}if(AN.v){b.push(AM);}return true;},this);if(f){z=[AB.k];r=H;}if(f&&!g&&AE){J.forEach(L.valarray(AD.cgb),function(AM){d.push([AM,true]);delete w[AM];});if(!b.length){AJ={act:"clearVisAsFilter",nodeKey:AB.k,associatedNodes:AH,cgbNodeKeys:d,controlKey:AD.ckey};z=z.concat(AH);AG=true;}else{b.forEach(function(AM){l.push(k.getNextKey());if(z.indexOf(AM)===-1){z.push(AM);}},this);AJ={act:"updateSingleUnitControl",controlKey:AD.ckey,nodeKey:AB.k,removeTargetKeys:d,newTargetKeys:b,CGBKeys:l,unitId:AK.unitId};}v.push(AJ);}else{if(g||AE||AF!==undefined){AJ={act:"clearVisAsFilter",nodeKey:AB.k};if(AH){AJ.associatedNodes=AH;z=z.concat(AH);}if(AD){J.forEach(L.valarray(AD.cgb),function(AN){var AM=k.getSourceControls(AB,AN).length<=1;if(AM){delete w[AN];}d.push([AN,AM]);});AJ.cgbNodeKeys=d;AJ.controlKey=AD.ckey;}if(AD||!L.isEmpty(AH)){AG=true;v.push(AJ);r=H;}}if(g||(AE&&b.length>0)||AF!==undefined){if(p()){h=k.getNextKey();}b.forEach(function(AM){if(p()){m=AL[AM].ft;if(!m){o=true;L.forEach(w,function(AN,AO){if(AM===AN&&!AI(AO)){l.push([AO,false]);o=false;}});if(o){e=k.getNextKey();t[e]=AM;l.push([e,true]);}}else{e=k.getNextKey();t[e]=AM;l.push([e,true]);}}if(z.indexOf(AM)===-1){z.push(AM);}c.push(AM);},this);v.push({act:"setVisAsFilter",sourceKey:AB.k,targetKeys:c,controlKey:h,CGBKeys:l,showAll:u(),fos:p()});r=p()&&k.hasUnitSelector?H:r;AA=true;}}if(!AA&&x!==undefined){v.push({act:"setControlShowAll",nodeKey:AB.k,controlKey:AD.ckey,showAll:x});}if(v.length){L.copy(t,w);v[0].partialUpdate={nodes:z};if(!q){this.execute({execute:function(){var AM=k.getDataService(),AN=AM.newUpdate(this);AN.addActions(v);AN.addExtras(r);if(r!==G){AN.addCallbacks(k.getRebuildCallback());}AN.addCallbacks({success:function(){var AP=AB.boxContent.node,AR=[],AO,AQ=AB.boxContent;if(AG){delete AP.data.sc;delete AP.defn.an;}if(AA){if(p()){J.forEach(l,function(AS){AR.push(AS[0]);});AP.data.sc={ck:[1].concat([AB.k,h]).join(X),ckey:h,ct:6,showall:u(),cgb:AR,tks:c.join(X)};}AO=AP.defn.an=[];c.forEach(function(AS){AO.push({k:AS,muc:24});},this);}if(!AA&&x!==undefined){AP.data.sc.showall=x;}if(AQ&&AQ.findSelectorControl){AQ.findSelectorControl();}}});this.submitUpdate(AN);},urInfo:{treesToRender:3,undo:n,redo:n,extraPuKeys:f?null:[AB.k],puKeys:r===G&&[AB.k].concat(z)}});}else{q.addActions(v);}}return AG;},getSourceControls:function A(e,d){var c=e.parent.children,g,b=[],f;J.forEach(c,function(h){f=h.boxContent;g=f.selectorControl||(f.findSelectorControl&&f.findSelectorControl());if(g&&L.valarray(g.cgb).indexOf(d)>=0){b.push({bc:f,sourceKey:h.k,control:g});}});return J.filter(b,function(h){return Number(h.control.ct)===6;});},clearVisAsFilterAction:function O(c,n){var g=this,l=c.boxContent.selectorControl,f=c.defn.an,m=[],k=[],o,d,b=[],p=this.getCGBMap(),h=function(){return J.filter(L.keyarray(p),function(q){return c.k===p[q];});},e;if(f){f.forEach(function(q){m.push(q.k);});o={act:"clearVisAsFilter",nodeKey:c.k,associatedNodes:m,partialRetrieval:{nodes:m}};if(l){J.forEach(L.valarray(l.cgb),function(q){b.push([q,g.getSourceControls(c,q).length<=1]);});o.cgbNodeKeys=b;o.controlKey=l.ckey;}d=n?{success:function(q){g.partialUpdate(q.data,g.getTargetDefn(m));}}:S.wrapMethods(this.associatedNodesUpdate([c]).callback,this.controller._getXtabCallback(c.boxContent));k.push(o);}if(n){e=h();J.forEach(e,function(u){delete p[u];var t=g.getSourceControls(c,u),r=false,v,q;J.forEach(t,function(x){v=x.control.tks.split("\u001E");o={act:"clearVisAsFilter",nodeKey:x.sourceKey,associatedNodes:[c.k],cgbNodeKeys:[[u,!r]],controlKey:x.control.ckey,removeControl:v.length===1,partialRetrieval:{nodes:[x.sourceKey]}};r=true;if(v.length>1){q=L.valarray(x.control.cgb);q.splice(q.indexOf(u),1);x.control.cgb={};J.forEach(q,function(AA,z){x.control.cgb[z]=AA;});v.splice(v.indexOf(c.k),1);x.control.tks=v.join("\u001E");}else{var w=x.bc.node;delete w.data.sc;delete w.defn.an;delete x.bc.selectorControl;}k.push(o);});});if(k.length>0){return{actions:k,callback:d,extras:{style:{params:{treesToRender:n?2:3}}}};}}},associatedNodesUpdate:function E(c){var b=this,d=b.getCurrentLayoutKey(),e;return{callback:{success:function(f){f.defn.layouts.some(function(g){e=g;return g.k===d&&g.loaded;});J.forEach(c,function(g){var h=e.units[g.k];if(h){if(L.isEmpty(h.an)){delete g.defn.an;}else{g.defn.an=h.an;}}});}},extras:{style:{params:{treesToRender:1}}}};},redoFilterAssociations:function U(c,f,e,b,g,d){return{act:"redoFilterAssociations",isNewCGB:c,controlKey:f,sourceKey:e,targetKey:b,removeCGB:g,addCGB:d,partialUpdate:{nodes:[e,b]}};},setFilterType:function N(d,c,b){d.addActions({act:"setVisFilterType",nodeKey:c.k,type:b});},getSourceFilterKeys:function R(b,c){var f=[],d=this.getVIComponent(K.FILTER_STACK),e=this.getVizContentPanel(this.getCurrentLayoutKey());if(d){if(c){J.forEach(d.getFilters(),function(g){if(g.node.defn.srct===Q){f.push(g.k);}});}else{f.push(d.k);}}if(e){e.children.forEach(function(g){var h=g.getTargetKeys&&g.getTargetKeys()||[];if(J.indexOf(h,b)>-1){f.push(g.k);}});}return f;}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.boxmodel","mstrmojo.Model","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.models.template.DataInterface","mstrmojo.StringBuffer","mstrmojo.EnumReadystate");var Aj=mstrmojo.EnumRWUnitType,K=mstrmojo.EnumReadystate,R=mstrmojo.hash,Aw=R.forEach,Au=mstrmojo.func.wrapMethods,As=mstrmojo.Obj.free,M=mstrmojo.array,AJ=mstrmojo.boxmodel,C=mstrmojo.mixin,b="\u001E";var F={},T={},N=[11826975,1381846,1810715,950271,12407690,2276796,13614615,8355711,15255470,9869567,9101208,7912447,14004421,9296859,15063710,13092807];mstrmojo.MultiRWUnitFormatEventsType=null;var AK={isObservable:function(A4){var A3=A4&&A4.t;if((!A3&&A3!==Aj.LAYOUT)||!this.hasOwnProperty(A3)||A4.scriptClass){return false;}return(A3!==Aj.SUBSECTION||!A4.dt);},makeObservable:function(A3){var A4=A3.audibles=this[A3.t]||{};if(A4.hasOwnProperty("readyState")){A3.readyState=K.IDLE;}return new mstrmojo.Model(A3);}};AK[Aj.PANELSTACK]={"*":false,selKey:true,readyState:true};AK[Aj.GRID]={"*":false,readyState:true,ds:true};AK[Aj.GRAPH]={"*":false,readyState:true,ds:true};AK[Aj.GRIDGRAPH]={"*":false,qsm:true,ds:true};AK[Aj.SUBSECTION]={"*":false,resize:true,adjustSize:true};AK[Aj.VISUALIZATION]={"*":false,ds:true};AK[Aj.SELECTOR]={"*":false,cek:true,ds:true,readyState:true};AK[Aj.MOJOVISUALIZATION]={"*":false,ds:true};AK[Aj.LAYOUT]={"*":false,readyState:true};var Ae={};function Al(A3){return Ae[A3]||Ae["*"];}Ae["*"]={update:function m(A4,A5,A3,A6){R.copy(A3,A5);}};Ae[Aj.PANEL]=C({update:function m(A4,A5,A3,A6){delete A5.layoutXML;this._super(A4,A5,A3);}},Ae["*"]);function f(A8,A9){var A4=A8.layoutMap&&A8.layoutMap[A9];if(A4){if(!A4.t){A4.t=Aj.LAYOUT;}if(AK.isObservable(A4)){A4=A8.layoutMap[A9]=this.addDisposable(AK.makeObservable(A4));}return A4;}var A3=A8.layouts,A7=(A3&&A3.length)||0,A6;for(A6=0;A6<A7;A6++){if(A3[A6].k===A9){var A5=A3[A6];if(!A5.t){A5.t=Aj.LAYOUT;}if(AK.isObservable(A5)){A3[A6]=this.addDisposable(AK.makeObservable(A5));}return A3[A6];}}return null;}function AA(A6,A8,A5,A4){var A3=f.call(this,A6,A8);if(A5===A8){A3._lkz=A8;return A3;}if(A3){var A7=A3.units[A5];if(A7){if(parseInt(A7.t,10)===Aj.GRIDGRAPH){if(!A3.units[A5+"_0"]){A3.units[A5+"_0"]={ck:A7.ck,fmts:A7.fmts.gd,txi:A7.txi,t:Aj.GRID};A3.units[A5+"_1"]={ck:A7.ck,fmts:A7.fmts.gp,t:Aj.GRAPH};}}if(!A4&&AK.isObservable(A7)){A7=A3.units[A5]=AK.makeObservable(A7);this.disposables.push(A7);}A7._lkz=A8;}}return A3&&A3.units[A5];}function AQ(A7,A6,A5,A3){var A4=this.getChildren(A7,A6,0);return(mstrApp.isMobile?(M.filter(A4,function(BA){var A8=A5&&A5.indexOf(BA.defn.t),A9=BA.defn.dk;return A3?(A8>-1&&A9===-1):(A8<0||A9!==-1);})):(A3?[]:A4));}var I=function(A3,A4){var A5=new mstrmojo.StringBuffer();if(A4){A5.append("*l"+A4);}A5.append("*k"+A3.k);if(A3.hasOwnProperty("wid")){A5.append("*x"+A3.wid);}A5.append("*t"+this.buildTime);return A5.toString();};function AG(A5){var A4,A3,A8=this.delta,A6=this.pendingUpdate=this.pendingUpdate||{},A7=[];if(!R.isEmpty(A8)){A7.push("<updates>");for(A4 in A8){if(A8.hasOwnProperty(A4)){A3=A8[A4];A7.push(A3.getUpdates());}}A6[A5]=A8;this.delta={};A7.push("</updates>");}return A7.join("");}function Az(A8,A4){var A7;if(A8){var A3=M.isArray(A8)?A8:A8.split(A4||b),A6=A3.length,A5;for(A5=0;A5<A6;A5++){A7=A7||{};A7[A3[A5]]=AA.call(this,this.defn,this.currlaykey,A3[A5]);}}return A7;}function p(A3,A4){return mstrmojo.all[I.call(this,{k:A3,wid:A4},this.currlaykey)];}function Af(A4,A3){var A5=this.getLayoutUnitDefn(A4,A3);return(A5&&A5.t===Aj.PANELSTACK&&A5.ifw);}function Ah(A4,A3){return !A3||(A4.wid===A3);}function e(A7,BF){var BA=this,BG=BA.getSliceCallback(BF),A5=BG.shared,BH=BF.tks,A4=BF.eid,BD=BA.getDataService();if(!BH){return ;}var BC=AA.call(BA,BA.defn,BA.currlaykey,A4);if(!BC){return ;}var A9=A4,BB=A5.tgtDefs[BH],A3=function(){BB.set("selKey",A4);},A6;BB.newSelKey=A4;if(BC.l){var A8=BC.dirtyKeys;if(!!A8){A9=R.keyarray(A8).join(",");A5.orignalTargetDefs=A5.tgtDefs=Az.call(BA,A9,",");A6=function(){A3();Aw(A5.dataCacheUpdate.upd,function(BI,BJ){var BK=mstrmojo.all[BJ];if(BK&&BK.setDirty){BK.setDirty(false);}});};}else{if(BF.skipServerCall){A3();return ;}BD.requestPanelChangeDeferred(A7,A4,null,false,false,BA.newCallback({method:"slice",success:A3}));return ;}}else{A6=function(){A3();BC.l=true;};}var BE=BG.success;BG.success=function(BJ){if(!BA.checkStatus(BJ)){return ;}BA.updateDefnCache(BJ.defn,[A4]);BE(BJ);A6();var BI=p.call(BA,BF.tks,0);if(BI){BI.clearDirtyChild(A4);}};BD.requestPanelChangeDeferred(A7,A4,A9,true,!BF.hasLoader,BG);}function W(A4,A3){if(A4.defn&&A4.defn.t>=Aj.GRID){mstrmojo.models.template.DataInterface.inflateGridData(A4.data);}A3[A4.id]=A4;return A4;}function AN(BM,BC,A3,A9){var BF=this.currlaykey,A6;if(BM){A6=BM.defn;BF=(A6&&A6._lkz)||BM.k;}var BX=this.getLayoutDataCache(BF),BN=(!A3&&!R.isEmpty(BX)),BT;if(!BM){BT=this.data;}else{var BB=BM.data||BM;if(BN){BT=BX[I.call(this,BB,BF)];BT=(BT&&BT.data)||BT||BB;}else{BT=BB;}}if(!!BT.sections){this._buildingLayoutKey=BT.k;}var A4=BT?this.extractChildren(BT):[],BH=[];var BQ=(A4&&A4.length)||0;if(BQ){A6=this.defn;var BJ=!BM,BE=BM?BF:null,A8=(BM&&((BM.defn)?BM.defn.t:AA.call(this,A6,BE,BM.k).t));var A5=(A8===Aj.GRIDGRAPH),BR=(A8===Aj.DETAILS),BP,BO;A4=BC(A4);for(BP=0,BO=A4.length;BP<BO;BP++){var BV=A4[BP];if(A5){BV.k=BM.k;BV.wid=BM.data.wid;}var BZ=BV.k,BL=I.call(this,BV,BE),BU;if(!BJ&&!A3&&Af.call(this,BZ,BE)){var BS=this.getLayoutUnitDefn(BZ),BI=W({data:BV,defn:BS,id:BL,k:BZ,p:BT},BX);if(!this.infoWinByKey||!this.infoWinByKey[BZ]){var A7=this.infoWindows=this.infoWindows||{};var BW=this.infoWinByKey=this.infoWinByKey||{};A7[BS.n]=BW[BZ]=BI;}continue;}if(A5){BL+="_"+BP;BU=AA.call(this,A6,BE,BV.k+"_"+BP);}else{BU=AA.call(this,A6,BE||BV.k,BV.k);}if(BR){BU.dt=true;}if(BX===null&&(BU.t===Aj.LAYOUT)){BX=this.getLayoutDataCache(BV.k);}var BY;if(BU.t===Aj.PANEL&&BX[BL]&&BN){var BA=this.extractChildren(BV)||[],BG=this.extractChildren(BX[BL].data)||[],BD=false;if(BA.length!=BG.length){M.forEach(BG,function(Bb){var Ba=M.find(BA,"k",Bb.k);if(Ba>-1){BA[Ba]=Bb;BD=true;}});if(BD){BG.splice(0,BG.length);M.forEach(BA,function(Ba){BG.push(Ba);});}}BY=BV;}else{BY=BN?(BX[BL]&&BX[BL].data)||BV:BV;}var BK={k:BV.k,id:BL,defn:BU,data:BY};if(!BX[BL]){W(BK,BX);}BH.push(BK);}}return A9?{nodes:BH,total:BQ}:BH;}function A0(A9,A4,A8){var A3=AJ.px2Inches,A5=this.getZoomProps(),A7=1,A6=2;if((A8&A7)>0){A9.FormattingPosition={Left:A3(A5,A4.x||0),Top:A3(A5,A4.y||0)};}if((A8&A6)>0){A9.FormattingSize={Height:A3(A5,A4.h||0),Width:A3(A5,A4.w||0)};}}function u(A4){function A3(A6,A5){return A6<A5?-1:(A6>A5?1:0);}A4.sort(function(A6,A5){var A7=A3(A6.levelID,A5.levelID);return A7!==0?A7:A3(A6.elemID,A5.elemID);});return A4;}function Ax(A3,A4){return A3.map(function(A5){return A5[A4];}).join(b);}function J(A3){return Ax(A3,"levelID");}function Ay(A3){return Ax(A3,"elemID");}function AH(A4){if(A4){T={};}F={};var A3=this.defn.epm;if(A3){A3.forEach(function(A5){A5.epmv.forEach(function(A6){var A8=u(A6.k.chn.map(function(BB){var BA=BB.emt!==2;return{levelID:BA?BB.at.did:"-1",elemID:BA?BB.ei:BB.mt.did};})),A9=J(A8),A7=Ay(A8);if(!F[A9]){F[A9]={};}F[A9][A7]=JSON.parse(A6.v.vv);});});}}function a(A3){if(A3){A3=mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters(A3);}return A3;}function AD(){var A4=this.data&&this.data.layouts,A3=A4[M.find(A4,"k",this.getCurrentLayoutKey())],A6=A3&&A3.gbys&&A3.gbys.groupbys,A5=false;M.forEach(A6,function(A7){if(A7.unit&&A7.unit.elms&&A7.unit.elms[A7.unit.idx].v==="u;"){A5=true;return false;}});return A5;}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true,tsp:true},features:null,dataCache:null,searchElemsCache:null,controller:null,sdp:null,dpi:96,keySeed:0,currlaykey:"",init:function AS(A3){this._super(A3);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();AH.call(this);this.buildTime=mstrmojo.now();},hasFeatures:function AP(A7){var A5=this.features;if(!A5){return false;}var A4=A7.split(","),A3=A4.length,A6;for(A6=0;A6<A3;A6++){var A8=A4[A6],A9=A8.match(/^!/);if(A9){A8=A8.replace("!","");}if(!!A9===!!A5[A8]){return false;}}return true;},makeObservable:function AR(A3){return AK.makeObservable(A3);},checkStatus:function At(A3){if(parseInt(A3.status,10)===4){A3.message=mstrmojo.desc(5781,"Request timed out.");mstrmojo.err(A3);return false;}return true;},getDataService:function Ac(){var A4=this.dataService;if(!A4){var A3={rwb:this.bs,msgId:this.mid,stid:this.stid,cbKey:this.cbKey,model:this};if(mstrApp.modelFactory){A4=mstrApp.modelFactory.newDataService("Document",A3);}else{A4=mstrApp.viewFactory.newDocDataService(A3);}this.dataService=A4;this.disposables.push(A4);}return A4;},getNextKey:function Ak(){return"W"+this.keySeed++;},resetKeySeed:function D(A3){this.keySeed=A3;},getWidgetId:function H(A3,A4){return I.call(this,A3,A4||this.getCurrentLayoutKey());},getUIState:function S(){return{};},ondefnChange:function v(){var A8=this.defn,A5=A8&&A8.layouts,A4={};if(A8){A8.layoutMap=A4;var A7=(A5&&A5.length)||0,A6;for(A6=0;A6<A7;A6++){var A3=A5[A6];A4[A3.k]=A3;}}},extractChildren:function w(A3){return(A3.sections||A3.subsections||A3.objects||A3.panels||A3.layouts||A3.children);},getChildren:function O(A5,A4,A8,A3,A7){A8=A8||0;var A6=function(A9){return A9.slice(A8,A8+(A3||A9.length));};return AN.call(this,A5,A6,A4,A7);},getChildrenByKey:function AM(A5,A4,A3,A7){var A6=function(A9){var A8=[],BA;M.forEach(A3,function(BB){BA=M.find(A9,"k",BB);if(BA!==-1){A8.push(A9[BA]);}});return A8;};return AN.call(this,A5,A6,A4,A7);},getTargetDefn:function AL(A3){return Az.call(this,A3);},getUnitDefinitions:function(A4,A3){return Az.call(this,A4,A3);},getUnitInstance:function r(A3,A4){return mstrmojo.all[I.call(this,{k:A3,wid:A4},this.currlaykey)];},getFirstUnitInstanceByName:function x(A6){var A3=f.call(this,this.defn,this.currlaykey);if(A3){var A4=A3.units,A5;for(A5 in A4){var A7=A4[A5];if(A7.n===A6){return this.getUnitInstance(A5,1);}}}return null;},getLayoutUnitDefn:function B(A4,A3){return AA.call(this,this.defn,A3||this.currlaykey,A4);},getRawLayoutUnitDefn:function U(A4,A5,A3){return AA.call(this,A5||this.defn,A3||this.currlaykey,A4,true);},getSelectedKey:function Ao(A3){return(!A3&&this.currlaykey)||null;},getCurrentLayoutKey:function q(){return this.currlaykey;},getLayoutDefn:function AU(A3){var A4=this.defn,A5=A4&&A4.layouts;return A5&&A5[M.find(A5,"k",A3)];},getCurrentLayoutDef:function AX(){return this.getLayoutDefn(this.getCurrentLayoutKey());},replaceLayout:function Av(BB,A4,BC){var A8=this.defn,A7=this.data,A5=A4&&A4.defn,A3=A4&&A4.data,BD=this.dataCache;if(BD&&BD[BB]){BD[BB]={};}var BA=(A7&&A7.layouts)||(A8&&A8.layouts),A6,A9=false;for(A6=(BA&&BA.length-1)||0;A6>=0;A6--){if(BA[A6].k===BB){break;}}if(BC&&A6<0){A6=M.find(A3.layouts||A5.layouts,"k",BB);A9=true;}this.bs=A4.bs;if(A3){if(A9){M.insert(A7.layouts,A6,[A3.layouts[A6]]);}else{A7.layouts[A6]=A3.layouts[A6];}A7.elems=A3.elems;}if(A5){if(A9){M.insert(A8.layouts,A6,[A5.layouts[A6]]);}else{A8.layouts[A6]=A5.layouts[A6];}this.ondefnChange();}},loadLayout:function Z(A3,A5,A4){this.replaceLayout(A3.currlaykey,A3);this.raiseEvent({name:"rebuildLayout",unloadCache:!!A5,restoreIW:!!A4});},getLayoutDataNode:function A1(A4){var A3=this.data&&this.data.layouts;return M.filterOne(A3,function(A5){return A5.k===A4;});},getLayoutDataCache:function n(A4){if(!A4){return null;}var A3=this.dataCache;if(!A3){A3=this.dataCache={};}if(!A3[A4]){A3[A4]={};}return A3[A4];},saveRW:function Am(A4,A6){var A5=mstrmojo.desc,A3=this.getDataService();A3.saveRW({objName:A4||this.n,folderID:this.pfid,saveAsFlags:1},A6||{success:function(A7){mstrmojo.alert(A5(3819,"Document Saved")+": "+A7.n);}});},saveAsRW:function A2(A5,A4){var A3=this,A6=mstrmojo.hash.copy(A5,{evt:3102,applyChanges:false,executionMode:2,parentFolderID:mstrApp.saveFolderId||A3.sfid||A3.pfid,saveFromDesignMode:false,rwb:A3.bs});if(A4){A6.target=A4;A6.saveAsOrigin=13;}mstrmojo.form.send(A6,null,"post");},saveDocProps:function AF(A3,A4,A5,A9){var A8=this.getDataService(),A7=A5?null:mstrmojo.DocDataService.SUPPRESS_DATA,A6=[{act:"setDocumentProperties",props:A3}];R.forEach(A3.RWDocumentProperties,function(BB,BA,BC){BC[BA]=String(BB);});if(A4){this.controller.cmdMgr.execute({execute:function(){this.submit(A6,A9||{},A7);},urInfo:A4});}else{A8.submitUpdates(A6,A9||{},R.copy(A7,{preserveUndo:true}));}},partialUpdate:function AB(A8,A3,A6,A5,A4){if(A6){this.updateDefnCache(A6,A5,A4);}if(A8){var A7=this.updateDataCache(A8,A3,undefined,A4);this.raiseEvent({name:"partialUpdate",tree:A8,ids:A7});return A7;}},refreshDefinition:function Y(A6,A5,A4,A7){var A3=this.getLayoutUnitDefn(A6,A4||this.getCurrentLayoutKey());if(!A3){return ;}Al(A3.t).update(this,A3,A5,A7);},loadPartialData:function z(A8,A4){var A6={};A6[A4]=AA.call(this,this.defn,this.currlaykey,A4);var A5=this.updateDataCache(A8,A6),A3=this.getLayoutDataCache(this.getCurrentLayoutKey()),A7=this;M.forEach(A8.layouts,function(A9){var BA=A9&&A9.xtabStyles;if(BA){A7.raiseEvent({name:"updateStyles",key:A9.k,updatedStyles:BA});}});Aw(A5,function(BA,A9){if(A9==="upd"){Aw(BA,function(BC,BD){var BB=mstrmojo.all[BD];if(BB&&BB.update){BB.update(A3[BD]);}});}});},updateDefnCache:function A(A4,BA,A7){var BD=this.currlaykey,A6=f.call(this,A4,BD),BF=f.call(this,this.defn,BD),BB=function(BG,BH){var BI;for(BI in BH){if(BG[BI]===undefined){BG[BI]=BH[BI];}}},BE=A6&&A6.units,BC=BF&&BF.units,A5=A6&&A6.cgbMap,A3=BF&&BF.cgbMap,A8=A7&&a(A7).defn,A9=this;M.forEach(BA,function(BG){A9.refreshDefinition(BG,BE[BG],null,A8&&A8[BG]);});if(BE){BB(BC,BE);}if(A5){BB(A3,A5);this.raiseEvent({name:"CGBMapChange",cgbMap:A3});}},deleteDataCache:function P(A4){var A3=this.getLayoutDataCache(this.getCurrentLayoutKey());if(A3[A4]){delete A3[A4];}},updateDataCache:function AT(BC,BB,A3,A7){var A5=this.getLayoutDataCache(this.getCurrentLayoutKey()),A4=A7&&a(A7).data,BD={ifws:{},upd:{},tgts:{},def:{},secs:{}},A8=function(BJ,BE){var BI=A5[BJ];if(A4){var BH=mstrmojo.all[BJ];if(BH){var BF=BI.k,BG=A4[BF];if(BG){if(!R.isEmpty(BG.exclude)){R.copy(BE.data,BI.data);}else{BE.data=R.copyProps(BG.serialized.split(";"),BE.data,BI.data);}}}}W(BE,A5);};function BA(BS,BX,BF,BI){var BK=false,BP=this.getChildren(BS,true),BO;if(!BP.length){return ;}if(BF){BO=mstrmojo.all[BS.id];BK=!BS.id||!!BO;}var BJ=BS.defn,BG=BS.data,BU;if(BJ&&BJ.t===Aj.PANELSTACK&&BJ.od){BU=BG.selKey;}var BT,BN,BY=function(BZ){return(BZ.k===BN);};for(BT in BP){var BQ=BP[BT],BR=BQ.id,BH=null,BV;BN=BQ.k;if(BX){var BL=this.extractChildren(BX);if(BL){BV=M.filterOne(BL,BY);if(!BV){BL.push(R.clone(BQ.data));}}else{R.copy(R.clone(BS.data),BX);}}if(mstrmojo.all[BR]){BK=true;}if(BB.hasOwnProperty(BN)){if(Af.call(this,BN)&&Ah(BQ.data,A3)){A8(BR,BQ);if(!BI){BD.ifws[BN]=this.infoWinByKey[BN].id;}}BH=BN;if(BK){if(BU&&BU!==BN){continue;}if(!BI){BD.tgts[BR]=true;}var BE=BO&&BO.defn,BW=BE&&BE.t,BM=BE&&BE.ck;if(BW===Aj.SUBSECTION&&(BM&&BM.hasOwnProperty(BN))){BD.secs[BO.id]=true;}}}if((BI||BH)&&(!BU||BU===BN)){A8(BR,BQ);BD.def[BN]=true;if(BK){BD.upd[BR]=true;}}BA.call(this,BQ,BV,BK,BI||BH);}}if(BC&&BC.layouts&&BB){var A6=M.filterOne(BC.layouts,function(BE){return(BE.loaded);}),A9=this.data.layouts;if(A6){BA.call(this,A6,A9[M.find(A9,"k",A6.k)],true);}}return BD;},getDimensionAndPositionAction:function Q(A4,A3,A6){var A5=this.getUnitFormatAction(A4,null,null,A6);A0.call(this,A5.format,A3,3);return A5;},getDimensionAction:function Q(A4,A3,A6){var A5=this.getUnitFormatAction(A4,null,null,A6);A0.call(this,A5.format,A3,2);return A5;},getUnitFormatAction:function d(BB,A4,BA,A6){var A8=BB.defn,BC=A8.t||1,A9=BB.k,A7=[A9];var A3={act:"format",unitKey:A9,unitType:BC===115?521:BC,formatType:A4||1,format:BA||{}};if(!A6){A3.partialRetrieval={nodes:A7};}if(BC===Aj.SELECTOR){var BD=A8.ck;A3.keyContext=BD;A7[0]=this.getDataService().getNodeKeyFromKeyContext(BD);}if(BC===Aj.TEXTFIELD||BC===Aj.IMAGE||BC===Aj.HTMLCONTAINER){var A5=BB.nk||A8.fgk;A3.fieldKey=A9;A3.nodeKey=A5;A3.keyContext=BC+b+A5+b+A9;A7[0]=A5;}return A3;},updateUnitFormat:function Ai(A4,A6,A7,A8,A3){var A5=this.getUnitFormatAction(A4,A6,A7);this.getDataService().submitUpdates(A5,A8,A3);},selectPanelDeferred:function(A8,A7,A6,A5,A4,A3){e.call(this,A8,{type:3,tks:A7,eid:A6,sid:A5||1,ck:A7,hasLoader:A4,skipServerCall:A3});},getSearchElemsCache:function Ar(){var A3=this.searchElemsCache;if(!A3){A3=this.searchElemsCache={};}return A3;},getCGBMap:function AZ(){var A3=f.call(this,this.defn,this.currlaykey);return A3&&A3.cgbMap;},getSliceCallback:function AE(A3){var A6=this,A7={};A7.dataCacheUpdate=null;A7.tgtDefs=A3.tks?Az.call(this,A3.tks):null;A7.orignalTargetDefs=A7.tgtDefs;var A5=A7.tgtDefs,A4=function(BA){var BB=A5;if(A3.disablePU){BB=Az.call(A6,A6.currlaykey);}Aw(BB,function(BC){if(BC&&BC.set){BC.set("readyState",BA);}});},A9=this.newCallback({method:"slice",shared:A7,submission:function(){A4(K.WAITING);},success:function(BB){if(!A6.checkStatus(BB)){return ;}if(A3.disablePU){A6.loadLayout(BB,A3.isUConDS,A3.restoreIW);return ;}if(BB.pukeys){A7.tgtDefs=Az.call(A6,BB.pukeys);}A7.dataCacheUpdate=A6.updateDataCache(BB.data,A7.tgtDefs,A3&&A3.sid,BB.puFilters);if(typeof BB==="object"){R.copyProps(["bs","exopt","dty"],BB,A6);}var BA={name:"partialUpdate",tree:BB.data,ids:A7.dataCacheUpdate,unloadCache:A3.isUConDS};if(!mstrmojo.hash.isEmpty(BA.ids.ifws)){if(A3&&!A3.suppressIW&&(A3.type===Aj.GRID||A3.type===Aj.GRAPH)){BA.anchor=A3.anchor;}else{BA.ids.ifws={};}}A6.raiseEvent(BA);},complete:function(){A4(K.IDLE);}}),A8={success:function(){Aw(A7.orignalTargetDefs,function(BK,BI){var BJ=p.call(A6,BI,1);if(!BJ){if(!!A6.sdp&&!!A6.sdp[BI]){var BH=A6.getLayoutDataCache(A6.getCurrentLayoutKey());var BL=I.call(A6,{k:BI,wid:1},A6.currlaykey);A6.raiseEvent({name:"secondaryDataSliced",key:BI,data:BH[BL].data});}return ;}if(A7.dataCacheUpdate&&!A7.dataCacheUpdate.def.hasOwnProperty(BI)){if(BJ.setDirty){BJ.setDirty(true);}}else{if(parseInt(BK.t,10)===Aj.PANELSTACK){BJ.setDirtyChildren();}}});var BA=p.call(A6,A3.ctlKey,1);if(BA&&A7.dataCacheUpdate&&!A7.dataCacheUpdate.upd.hasOwnProperty(BA.id)){var BF=(BA.children&&BA.children[0].selectedIndices)||{},BD=BA.node.data,BG=mstrmojo.DocSelector.STYLES,BE=[];if(BA.style===BG.SEARCH_BOX){var BB=(BA.children&&BA.children[0].items)||[];M.forEach(BB,function(BH){BE.push(R.clone(BH));});}else{R.forEach(BF,function(BI,BH){if(BI){BE.push(BD.elms[BH]);}});}var BC=M.find(BE,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(BC>-1){BE=[BE[BC]];}BD.ces=BE;BA.selIdx=BF;}}};if(A3.isUConDS||(parseInt(A3.type,10)===Aj.GRAPH&&A3.tty===1)){A9.success=function(BA){A6.controller.setData(BA,true);};return A9;}if((parseInt(A3.type,10)===3)){return A9;}return Au(A9,A8);},slice:function X(A3){var A4=this.getDataService(),A5=A4.newUpdateWithoutCmd();this.sliceDeferred(A5,A3);if(A5.actions&&A5.actions.length>0){A4.addSuppressData(A5.extras);A5.submit();}},sliceDeferred:function(A6,BF){var A3={};try{if(!BF||(!mstrmojo.dom.isAndroid&&!BF.tks&&!BF.multiSelect&&(BF.type===3||(BF.type===Aj.GRAPH&&parseInt(BF.tty,10)!==1)))){return A3;}var BG=this.getSliceCallback(BF),BC=this,BE=this.getDataService();var BI=parseInt(BF.type,10);if(BI===3){e.call(BC,A6,BF);return ;}if(BF.multiSelect){if(BF.selectorObjects.length>0){BE.setMultiDocSelectorElements(BF.selectorObjects,BF.multiSelect,BG);}return ;}if(BI===Aj.GRAPH){A6.add(BE.getGraphSelectionAction(BF.src,BF.cks,BF.sid,BF.x,BF.y,(BF.tty===1)),BG);if(!!BF.showLoadingIcon){A6.addExtras({config:mstrmojo.DocDataService.PROGRESS_CONFIG});}return ;}var BH=BF.events||{K0:BF},A5=[],A8,A4={config:mstrmojo.DocDataService.PROGRESS_CONFIG},BB=A4.params={},A7,BA={},BD=function(BK,BJ){if(BK){BA[BJ]=BK.visName;}};for(A7 in BH){BF=BH[A7];if(!BF){break;}if(BF.hasOwnProperty("eid")){if(BF.isUConDS){BF.disablePU=true;}if(AD.call(this)){BF.disablePU=true;BF.restoreIW=true;}A8=BE.getSelectorElementsAction(BF);if(BC.sdp){BA={};Aw(BC.sdp,BD);BB.sdpKeys=JSON.stringify(BA);}if(BF.disablePU){BB.disablePU=true;}}else{if(BF.fromGM){A8=BE.getSelectorFromGMAction(BF);}else{if(parseInt(BF.srct,10)===4||BF.fid){if(BF.fid&&AD.call(this)){BF.disablePU=true;}A8=BE.getSelectorExpressionAction(BF);}else{if(BF.unset){A8=BE.getUnsetSelectorAction(BF);}else{if(parseInt(BF.ct,10)===6){A8=BE.getMultiUnitSelectorAction(BF);BC.hasUnitSelector=BF.selections&&BF.selections.hasElements;}else{A8=BE.getSelectorIncludeAction(BF);}}}}}A5.push(A8);}A6.add(A5,BG,A4);}catch(A9){mstrmojo.err(A9);}},getInfoWindow:function t(A4){var A3=this.infoWindows;return A3&&A3[A4];},getTargetInfoWin:function(A4){var A3=[],A5=Az.call(this,A4);if(A5){var A6;for(A6 in A5){if(A5[A6]&&A5[A6].ifw){A3.push(A6);}}}return A3;},showInfoWin:function o(A6,A5,A3,A7,A8){var A4=this.infoWinByKey&&this.infoWinByKey[A6];if(A4===undefined){return ;}this.raiseEvent({name:"showInfoWin",psId:A4.id,psKey:A4.k,anchor:A5,anchorOrientation:A3,anchorPosition:A8,invalidate:A7});},getSelectedXtabStyles:function l(A5){var A4=A5||this.currlaykey;var A7={};var A3=this.data&&this.data.layouts,A6;for(A6 in A3){if(A3[A6].k===A4){A7=A3[A6].xtabStyles;break;}}return A7;},downloadGridData:function E(A7){var A5=this,A4=A7.xtabId,A3=A7.memo,A6=mstrmojo.all[A4];this.getDataService().downloadGridData(A7,this.newCallback({success:function(BF){function A8(BJ,BL){var BM=A5.getChildren(BJ,true),BK=BM.length,BI;for(BI=0;BI<BK;BI++){var BN=BM[BI];if(BL===BN.id){return BN;}var BH=A8(BN,BL);if(BH){return BH;}}return null;}var BC=BF.data&&f.call(A5,BF.data,A5.currlaykey);if(BC){var BB=A8(BC,A4);if(BB){mstrmojo.models.template.DataInterface.inflateGridData(BB.data);if(A6){A6.dataDownloaded(BB,A3);}}var BE=BC.xtabStyles;if(BE){A5.raiseEvent({name:"updateStyles",key:BC.k,updatedStyles:BE});}}var BD=AA.call(A5,A5.defn,A5.currlaykey,A7.nodeKey);if(BD&&BD.t===Aj.GRIDGRAPH&&A3.recalculating){var BA=A6.parent,BG=BA&&BA.getGraphWidget();if(BG&&BA.updateGraph){BA.updateGraph(A8(BC,BG.id));}}if(BF.pukeys){var A9=Az.call(A5,BF.pukeys);delete A9[A7.nodeKey];if(!R.isEmpty(A9)){A5.partialUpdate(BF.data,A9);}}},failure:A6.dataDownloadErr||mstrmojo.emptyFn}));},clearDisposables:function AY(){var A3=[];M.forEach(this.disposables,function(A4){if(A4._lkz){As(A4);}else{A3.push(A4);}});this.disposables=A3;},getFixedHeaders:function(A4,A3){return AQ.call(this,A4,A3,[Aj.PAGEHEADER],true);},getFixedFooters:function(A4,A3){return AQ.call(this,A4,A3,[Aj.PAGEFOOTER],true);},getNonFixedSections:function(A4,A3){return AQ.call(this,A4,A3,[Aj.PAGEHEADER,Aj.PAGEFOOTER],false);},addAutoWidthID:function g(A5){var A4=this.aws||{},A3=A4[this.currlaykey]||[];A3.push(A5);A4[this.currlaykey]=A3;this.aws=A4;},getAutoWidthIDs:function L(){var A5=this.aws,A3=this.currlaykey;var A4=A5&&A5[A3];if(A4){delete A5[A3];}return A4;},getTransactionUpdates:function k(A3){return this.txDiscardTargets?"":AG.call(this,A3);},clearTransactionUpdates:function AI(A3){this.clearTxDeltaUpdate(A3);},resetTransactionUpdates:function Ad(A3){var A4=this.pendingUpdate,A5=this.delta;if(A4&&A4[A3]){Aw(A4[A3],function(A6,A7){if(A5&&!A5[A7]){A5[A7]=A6;}});delete A4[A3];}},transactionUpdate:function Aq(A5,A4){if(!A5.data){return null;}var A7;if(A4&&A4.tks){A7=Az.call(this,A4.tks);}if(A5.pukeys){A7=Az.call(this,A5.pukeys);var A8;for(A8 in A7){if(A7[A8]&&A7[A8].cek){A7[A8].cek=null;}}}if(A5.txrcd){this.txrcd=A5.txrcd;}else{delete this.txrcd;}var A6=this.updateDataCache(A5.data,A7,A4&&A4.sid),A3={name:"partialUpdate",tree:A5.data,ids:A6};if(!R.isEmpty(A6.ifws)){if(A4&&A4.type===Aj.GRID){A3.anchor=A4.anchor;}else{A6.ifws={};}}this.raiseEvent(A3);return A6;},deltaUpdate:function Ab(A3){var A4=this.delta;if(!A4){A4=this.delta={};}A4[A3.id]=A3;},clearTxDeltaUpdate:function V(A4){var A7=this.txDiscardTargets,A3=!A7,A6=this.pendingUpdate,A5=this;if(!A3){Aw(A7,function(A8,A9){if(A5.delta&&A5.delta[A9]){A5.delta[A9].clear();delete A5.delta[A9];}});}if(A6&&A6[A4]){Aw(A6[A4],function(A8){A8.clear();});delete this.pendingUpdate[A4];}},sendTransactionActions:function G(A4,A3,A6){var A5=this;if(!A6){A6={success:function(A7){A5.transactionUpdate(A7);}};}A5.getDataService().sendTransactionActions({keyContext:A4,actions:A3,txrcd:this.txrcd},A6);},sendTransactionUpdates:function AW(A3){var A5=this.getSliceCallback(A3),A4=this.getDataService();A4.submitUpdates([A4.getUpdateTransactionAction(A3)],A5);},addSDP:function An(A4,A3){if(!A4||!A3){return ;}if(!this.sdp){this.sdp={};}this.sdp[A4]={k:A3.k,visName:A3.visName};},removeSDP:function Ag(A3){if(!A3||!this.sdp[A3]){return ;}delete this.sdp[A3];},getUpdateColorMapCallback:function c(){var A3=this;return{success:function(A4){A3.defn.epm=A4.defn&&A4.defn.epm;AH.call(A3);A3.raiseEvent({name:"colorMapChanged"});}};},getUpdateThemePaletteCallback:function Aa(A3){var A4=this;return{success:function(A5){A4.thm=A5.thm;A4.plt=A5.plt;A4.defmts=A5.defmts;AH.call(A4,!A3);}};},getCurrentPaletteColors:function AO(){return(this.plt&&this.plt.colors)||N;},getColorBy:function(A9,A3){var A7=A3.map(function(BB,BA){return{levelID:A9[BA].toString(),elemID:BB};});if(A7&&A7.length>1){u(A7);}var A8=J(A7),A6=Ay(A7),A5=T[A8];if(!A5){A5=T[A8]={_currentColorIdx:0};}if(!A5[A6]){var A4=this.getCurrentPaletteColors();A5[A6]=A4[A5._currentColorIdx];A5._currentColorIdx=(A5._currentColorIdx+1)%A4.length;}if(F[A8]&&F[A8][A6]){return{color:F[A8][A6].color,isManual:true};}return{color:A5[A6],isManual:false};},getZoomFactor:function AC(){return this.getCurrentLayoutDef().zf||1;},getZoomProps:function AV(){return{dpi:this.dpi,zf:this.getZoomFactor()};},executeLink:function h(A3,A5,A6){if(A3.indexOf("prevMsgID")>0){var A4="prevMsgID="+this.mid;A3=A3.replace(/prevMsgID=0($|&)/g,function(A7,A8){if(A8==="&"){return(A4+"&");}return A4;});if(mstrmojo.dom.isIE){A3+="&cb"+mstrmojo.now()+"=1";}}A3=mstrmojo.addCSRFTokenToURL(A3);this.controller.onLink(this,{url:A3,target:A5,src:A6||null,submitAsPost:!mstrmojo.isUrlExternal(A3)});},getDatasetUnits:function Ap(A4,A3,A6,A8){var A7=this.datasets,A5=[];R.keyarray(A7).forEach(function(BA){if(!A6||BA===A6){var BB=A7[BA],A9=BB,BC=[];A4.forEach(function(BD){if(A8!==undefined){A9=BB.tables[A8];}(A9[BD]||[]).forEach(function(BE){if(!A3||A3(BE)){BC.push(BE);}});});A5=A5.concat(BC.map(function(BD){return mstrmojo.hash.copyProps(["did","n","t","st","formType","dt","f","hide","usedInDropZones","card","lock","fs"],BD,{ds:BB.name,dsId:BA,dm:!!BD.um,da:!!BD.da,de:!!BD.de});}));}});return A5;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Model","mstrmojo._HasPopup","mstrmojo.string");var D=mstrmojo.dom,B=mstrmojo.string;var L=1,C=2,J=4,T=8,S=16,K=512;function N(Z,V){var Y=Z.getCellForNode(V),U=Y&&Y.at,X=0;if(U){X=(U&C)||(U&J)||(U&L);}if(X===J){var c=Z.model.getCellLinksInfo(Y);if(!c||isNaN(c.di)){return"";}var b=c.links[c.di];return b.n;}if(X===L){var a=Z.model.getCellDrillsInfo(Y);return a&&(mstrmojo.desc(183,"Drill to")+" "+a.n)||"";}if(Y){var W=("mix" in Y)?Y._e:Y;if(W&&W.desc){return B.decodeHtmlString(W.desc);}}return Z.tooltip||"";}function I(Z,b){var W=Z.getCellForNode(b),V=W&&W.at;if((V&T)>0||(V&S)>0||(V&K)>0){return true;}var a=0;if((V&L)>0){return true;}if((V&J)>0){a++;}if((V&C)>0){a++;}if(a>1){return true;}if((V&J)>0){var Y=Z.model.getCellLinksInfo(W),X=Y&&Y.links;var U=(X&&X.length)||0;if(Y&&!isNaN(Y.di)){U--;}if(U>0){return true;}}return false;}function H(U){return U.viewport.clientWidth-(U.scrollboxNode.offsetWidth-U.scrollboxNode.clientWidth);}mstrmojo._XtabCellHoverMgr=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo._XtabCellHoverMgr",parent:null,td:null,audibles:{"*":false},startup:function E(){var V=this.parent;if(V&&V.getCellForNode){var U=V.zones,W;for(W in U){this.addMgrElement(W);}if(!this._sub_ihc){this._sub_ihc=V.attachEventListener("ignoreHoverChange",this.id,"onChangeIgnoreHover");}window.setTimeout(function(){V._pl=H(V);},0);}},addMgrElement:function P(W){var Z=this.parent,Y=this,a=Z&&Z.zones[W].tableNode;if(a&&Z&&Z.getCellForNode){if(!this.fCtxMenu){this.fCtxMenu=function(b){Y.oncontextmenu(b,self);};}if(!this.fOver){this.fOver=function(b){Y.onhover(b,self);};}if(!this.fOut){this.fOut=function(b){Y.onunhover(b,self);};}var X=this.fCtxMenu,V=this.fOver,U=this.fOut;D.attachEvent(a,"mouseover",V);D.attachEvent(a,"mouseout",U);D.attachEvent(a,"contextmenu",X);}},shutdown:function A(){var V=this.parent&&this.parent.zones,W;for(W in V){var U=V[W].tableNode;if(U){D.detachEvent(U,"mouseover",this.fOver);D.detachEvent(U,"mouseout",this.fOut);D.detachEvent(U,"contextmenu",this.fCtxMenu);}}},onXtabWidthChanged:function(){var U=this.parent;U._pl=H(U);},onChangeIgnoreHover:function(){var U=this.parent;if(!U.ignoreHover&&this._ignored){this.onhover(null,null,this._ignored);}},onhover:function F(X,U,W){if(this.parent.ignoreHover){this._ignored=D.eventTarget(U,X);return ;}var V=this.parent,Y=this.getEvtTargetCell(X,U,V,W);if(Y&&V){Y.title=N(V,Y);}if(this.showHvrBtn(V,Y)){this.td=Y;if(!V._pl){V._pl=H(V);}V.openPopup("cellHoverPopupRef",{xtab:V,td:Y});}else{this.onunhover(X,U,W);}},onunhover:function M(){if(this.parent.ignoreHover){return ;}var V=this.parent,U=V._lastOpened;if(!U){return ;}if(U.autoCloses){U.autoClose();}else{V.closePopup();}},getEvtTargetCell:function G(Y,U,X,W){var V=W||D.eventTarget(U,Y);return V&&D.findAncestorByName(V,"td",true,X.viewport);},oncontextmenu:function O(X,U,W){var V=this.parent,Y=this.getEvtTargetCell(X,U,V,W);this.processRightClick(X,U,Y);if(Y&&this.shouldShowPopup(V,Y,true)){V.openPopup("cellHoverPopupRef",{xtab:V,td:Y,cmPos:D.getMousePosition(X,U)});V.cellHoverPopupRef.btn.openPopup();V.closePopup();D.preventDefault(U,X);D.stopPropogation(U,X);}},processRightClick:mstrmojo.emptyFn,shouldShowPopup:function R(W,X,V){var U=X.mstrShowPopup;if(U!==undefined){return U;}U=I(W,X);X.mstrShowPopup=U;return U;},showHvrBtn:function Q(U,V){return this.shouldShowPopup(U,V,false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.array","mstrmojo.hash");var A=mstrmojo,G=A.hash,E=A.array,C=A.EnumRWUnitType,F=A.DocDataService.REQUEST_DEFN_DATA;mstrmojo.vi.models._DataGridActions=mstrmojo.provide("mstrmojo.vi.models._DataGridActions",{_mixinName:"mstrmojo.vi.models._DataGridActions",createViewDataGrid:function D(Y,e,H,K,J,g,Q){var W=false,b=this.dataService,V=function(){if(g){return g.k;}var k="K51";try{var m=this.getCurrentLayoutDef().btsd;if(m){k=m;W=true;}else{if(this.getTargetDefn("K48").K48){k="K48";W=true;}}}catch(l){}return k;}.call(this),X=this.createNewUnitNode(function(k){k.gsi={cols:[],rows:[],mx:[]};return k;},function(l){l.t=C.GRID;var k=l.fmts;k.height="350px";k.width="600px";return new mstrmojo.Model(l);},null,W?V:this.getNextKey()),f=X.k,T=this.id,P=this.getDocBuilder().build([X],this,{pk:e,isViewDataGrid:true})[0],Z=[{act:"changeXtabColWidthScenario",value:2}],O=this.getDataService().newUpdate(),d=0,S=0,U=[],h=[],c=g&&G.copy(g.model.data);if(c){c.gsi=G.clone(g.model.data.gsi);mstrmojo.vi.util.ThresholdUtils.addClearAllThresholdsActions(g.model,{data:c},Z);}(Y||[]).forEach(function(k){Z.push(P.model.getAddTemplateUnitAction(k,k.dsId||J,k.t===4?2:1,k.t===4?S++:d++));});if(g&&Q){h.push({act:"pivot",unitId:"",unitType:"",axis:2,unitPos:1});E.forEach(Q.zones,function(k){if(k.id!==1){E.forEach(k.items,function(l){if(l.t===12){h.push({act:"pivot",unitId:l.did,unitType:12,axis:1,unitPos:1});}});}E.forEach(k.items,function(l){if(l.t===4&&l.did!=="-1"){U.push({unitId:l.did,unitType:4,regions:["g"]});}});});if(!W){if(U.length>0){Z.push({act:"formatGridZone",nodeKey:f,props:{FormattingPatterns:{FillColor:16777215,FillStyle:0},FormattingFont:{Color:6974058},FormattingAlignment:{Horizontal:4}},units:U,axis:[{axis:1,regions:["sg"]},{axis:2,regions:["sg"]}]});}Z.push({act:"formatGridZone",nodeKey:f,props:{FormattingPatterns:{FillColor:16777215,FillStyle:0},FormattingFont:{Color:6974058},FormattingAlignment:{Horizontal:2}},units:[],axis:[{axis:1,regions:["g","sh"]}]},{act:"formatGridZone",nodeKey:f,props:{FormattingPatterns:{FillColor:15461355,FillStyle:0},FormattingFont:{Color:6974058},FormattingAlignment:{Horizontal:2}},units:[],axis:[{axis:1,regions:["h"]},{axis:2,regions:["h","g","sh"]}]},{act:"formatGridZone",nodeKey:f,props:{FormattingAlignment:{Horizontal:4}},units:[],axis:[{axis:2,regions:["h","g","sh"]}]});}Z=Z.concat(h);Z.push({act:"advancedProperties",props:{"Template Formatting":{MergeCells:"0",MergeColumnCells:"0",LockColumnHeaders:"-1"}}});}O.addActions(W?b.getMoveNodeAction(X,e):{act:"copyUnit",unitKey:V,unitType:521,newKey:f,toKey:e});O.addActions({act:"updateTemplate",keyContext:f,partialRetrieval:b.newRetrievalKeysConfig().addNode(f,{data:{exclude:{vfexpr:true}}}),actions:Z});O.addActions(this.getUnitFormatAction(X,1,{FormattingSize:{Height:0,Width:0}}));if(g&&Q){O.addActions({act:"format",unitKey:f,unitType:521,formatType:1,format:{Visualization:{VisualizationsEnabled:0,ViewMode:0,SelectedVisualization:"",IPhoneVisualization:"",IPadVisualization:"",APhoneVisualization:"",ATabletVisualization:""},FormattingIncrementalFetch:{EnableIFOnGrid:-1},FormattingWidget:{ClassName:"",Enable:0,WidgetProps:""}}});}if(!G.isEmpty(H)){O.addActions(this.getKeepOnlyOrExcludeAction(f,H));}if(J){O.addActions({act:"editNode",nodeKey:f,datasetId:J});}if(g&&Q){var a=g.parent.parent;E.forEach(a.getTargetKeysByType([C.SELECTOR]),function(o){var k=a.getUnitByKey(o).defn,l=k.srct,n=k.srcst,p=((l===47&&n!==12033)||l===1),m;if((k.tks||"").indexOf(g.k)>-1){m=this.dataService.getAddCtrlTargetAction(k.ck,f,null,p,true,true);delete m.partialRetrieval;O.addActions(m);}},this);var N=true,R,I=g.getFilterType()===1;E.forEach(a.getTargetKeysByType([C.GRID,C.GRAPH,C.MOJOVISUALIZATION]),function(l){var n=a.getUnitByKey(l).boxContent,m=n.defn.an,k=E.find(m,"k",g.k)!==-1,o;if(k){if(N){R=this.getNextKey();}o=n.findSelectorControl();if(o){O.addActions({act:"addVisToFilter",parentKey:l,targetKey:f,ctrlKey:o.ckey,newCGB:N,cgbKey:R});if(!I){N=false;}}}},this);}O.addActions({act:"changeGridDisplayMode",nodeKey:f,displayMode:1});O.addCallbacks({success:function L(l){var k=mstrmojo.all[T];k.partialUpdate(l.data,k.getTargetDefn(f),l.defn,l.pukeys&&l.pukeys.split("\u001E"),l.puFilters);K.success(P);},failure:K.failure});O.addExtras(F);this.execute({execute:function M(){this.submitUpdate(O,mstrmojo.all[T].cmdMgr().CMD_PHASE.FIRST);}});return W;},removeViewDataGrid:function B(H,I,U,T){var O=this.cmdMgr().getInterimCmd();if(!I){O.cancel();}else{var M=this.getDataService(),W=this.id,X=[],Q=[],L=H.zonesModel.getDropZones().zones,K,N,S,J,R,P=M.newUpdateWithoutCmd();P.addCallbacks(T);if(I){N=this.createNewVizNode({title:mstrmojo.desc(11693,"Visualization")});S=this.getCurrentLayoutKey();J=this.getPanel(null,S);K=J.k;R=this.getDocBuilder().build([N],this,{pk:K})[0];P.addActions([{act:"macroCopyUnit",unitKey:H.k,unitType:521,newKey:R.k,toKey:K},mstrmojo.all[W].getUnitFormatAction(N,1,{FormattingView:{Title:mstrmojo.desc(11693,"Visualization")}})]);J.insertNewBoxAndSaveDeferred(P,R);P.actions.forEach(function(Y){delete Y.partialRetrieval;});P.actions[0].partialRetrieval=M.newRetrievalKeysConfig().addNode(R.k);}if(U){L.forEach(function(Y){Y.items.forEach(function(Z){if(parseInt(Z.did,10)!==-1){X.push(H.model.getRemoveTemplateUnitAction(Z));}});});if(X.length>0){Q.push({act:"updateTemplate",keyContext:H.k,actions:X});}Q.push(M.getMoveNodeAction(H,"K12"));}else{Q.push({act:"removeUnit",unitKey:H.k,unitType:H.defn.t});}P.addActions(Q);P.addCallbacks({success:function V(Z){var Y=mstrmojo.all[W];Y.partialUpdate(Z.data,Y.getTargetDefn(R.k),Z.defn);Y.updateDataCache(Y.data,Y.getTargetDefn(K));Y.selectVIUnit(J.rebuildChild(R).id);}});P.addExtras(F);O.urInfo.extraPuKeys=[J.k];O.submit(P.actions,P.callback,P.extras,this.cmdMgr().CMD_PHASE.LAST);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var h=1,S=2;var E=2,K=4,D=5;var V=1,N=4;var f=mstrmojo.array;function H(k,l){return k[((l===h)?"row":"col")];}function B(k,m){var l=m.lm;return l&&l[k.mix||0];}function b(l,q,x){var v=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:2,aopam:q.daMode});var r=q.ans,w=r&&r.length;if(w){var t=v.prms=[],m=0;for(m=0;m<w;m++){var AC=r[m];var n=AC.pid,p=parseInt(AC.m,10),AB={id:n,am:p,pt:AC.pt};t.push(AB);if(AC.po){AB.orid=AC.po.did;AB.ortp=AC.po.t;}switch(p){case v.DO_NOT_ANSWER:case v.CLOSE:case v.USE_DEFAULT_ANSWER:case v.SAME_PROMPT:break;case v.STATIC:var k=AC.es,AA=(k&&k.length)||0,u;AB.pa={es:[]};for(u=AA-1;u>=0;--u){var o=k[u];AB.pa.es.push({ei:o.id,disp_n:o.n,emt:1});}break;case v.DYNAMIC:case v.ALL_VALID_UNITS:case v.CURRENT_UNIT:case v.DYNAMIC_OR_SAME_PROMPT:if(x.els){A.call(this,AC,x,AB,p,v);}else{J.call(this,AC,x,AB,p,v);}break;}}}return v;}function A(r,l,k,q,p){var o=r.dunits,m=l.els,n=k.pa={};f.forEach(m,function(t){if(f.find(o,"id",t.id)>=0){if(q!==p.DYNAMIC&&q!==p.DYNAMIC_OR_SAME_PROMPT){n.a={id:t.id,n:t.disp_n,dispForms:t.dfi};}if(r.pt===1){n.v=t.v;}else{n.es=[];n.es.push({ei:t.ei,emt:t.emt,disp_n:t.disp_n});}}});}function J(z,u,x,o,q,p){var r=z.dunits;if(r&&r.length&&u){var t=x.pa={};var n=u,m=(u.mix!==undefined)&&(u._lp||u._tp);if(m){n=u._lp||u._tp;}var l=parseInt(n.axis,10);while(n){var v=this.getPTitle(n,l);if(v&&f.find(r,"id",v.id)>=0){if(o!==q.DYNAMIC&&o!==q.DYNAMIC_OR_SAME_PROMPT){t.a={id:v.id,n:v.n,dispForms:v.dfi};}if(z.pt===1){t.v=n.v;break;}else{var k=n._e.id,w=n._e.n;t.es=[];t.es.push({ei:k,emt:1,disp_n:w});}if(o===q.CURRENT_UNIT){break;}}n=this.getPCellParentNode(n,l);if(m&&!n&&l===h){l=S;n=u._tp;}}}}function Q(m){var l=this.getCellTitleInfo(m[0]),o=[],q=function(r){if(r){if(mstrApp.useBinaryFormat){if(r._e){o.push(r.axis+"A"+(r.ui+1)+"A"+r._e.id);}q(r._p);}else{o.push(r.axis+"A"+(r.ui+1)+"A"+r.o);}}},n,k;if(!l.isSrcTitle){for(n=0,k=m.length;n<k;n++){var p=m[n];if(p.mix!==undefined&&(p._lp||p._tp)){q(p._lp);q(p._tp);}else{q(p);}}}return(mstrApp.useBinaryFormat)?o:o.join(",");}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function R(){return this.data.mid;},getCellTitleInfo:function c(l,o){var m=o?o.gts:this.data.gts;var n=null;if(l&&l.mix===undefined){n=H(m,l.axis)[l.tui||l.ui];}else{var k=function(r){var p=(r&&r.length)||0,q;for(q=p-1;q>=0;--q){if(parseInt(r[q].otp,10)===-1){return r[q];}}return null;};n=k(m.col)||k(m.row);}return{isSrcTitle:!!l&&(l.o===undefined)&&!((l.mix!==undefined)&&(l._lp||l._tp)),title:n};},getCellInfo:function I(l){var k=this.getCellTitleInfo(l),m={isTitle:false,isHeader:false,isMetric:false};if(l&&(l.hasOwnProperty("mix")||l.otp===-1)){m.isMetric=true;if(l._e){m.isHeader=true;}}if(k.isSrcTitle){m.isTitle=true;}return m;},getCellLinksInfo:function e(l,m){if(!m){var k=this.getCellTitleInfo(l);m=k&&k.title;}return B(l,m);},getAllDrillPathsForCell:function Z(l,m){if(!m){var k=this.getCellTitleInfo(l);m=k&&k.title;}return m.dp||[];},getCellDrillsInfo:function G(k,m){var l=this.getAllDrillPathsForCell(k,m);return l&&l[k.mix||0];},getLinkDrillAction:function O(k){return this.getActionObject(k);},getAction:function U(k){return this.getActionObject(k);},getActionObject:function L(l){var k=l[0]&&l[0].at,m=null;if(k){if((k&N)>0){m={h:"onLink",a:this.getLinkAction(l[0])};}else{if((k&V)>0){m={h:"onDrill",a:this.getDrillAction(l)};}}}return m;},getSortAction:function F(AA,t){var o=this.getCellTitleInfo(AA),w=o.title,z=this.data.gts[((AA.axis===h)?"row":"col")+"SubPos"],l=[],n=w.axis,q,v,u,x,AB;t=(t===null||t===undefined)?!(AA&&AA.so):t;if(o.isSrcTitle){q=E;v=w.id;u=w.otp;x=w.fid;}else{q=K;u=4;n=f.find(this.data.gts.col,"otp",-1)>-1?h:S;z=this.data.gts.rowSubPos;AB=w.stt;var r,k;do{r=AA._e;if(r){if(r.oid){v=r.oid;}else{k=r.id.replace(/;/g,"\\;");l.push(k);}}AA=AA._p;}while(AA);}var p={sortType:q,axis:n,isAsc:t,unitID:v,unitType:u,elementList:l.join(";"),subTotalsPos:z};if(v){p.unitID=v;}if(x){p.formId=x;}if(AB){p.sortType=D;p.stt=AB;}var m;if((q===K)||(q===D)){m=["","",p.elementList||"",p.axis];}else{m=[p.formId,"21","",p.axis];}m=[p.unitType,p.unitID].concat(m);p.sortKey=m.join("!");return p;},getSubTotalsPos:function X(){var k=this.data.gts;if(k){return[k.rowSubPos,k.colSubPos];}return[0,0];},getPivotAction:function M(z,m){var w=false,AA=z.hasOwnProperty("mix"),k=AA?null:z.axis,x=(AA?z.idx:z.ui)+1,l=(z.otp===-1);if(!isNaN(m)){k=parseInt(m,10);x=1;if(AA){AA=false;l=true;}}else{var q=(m==="u"||m==="l"||m==="b");if(!AA){var p=H(this.data.gts,k),o=0,n={},t=false;mstrmojo.array.forEach(p,function(AB){if(n[AB.id]){n[AB.id].frm++;}else{o++;n[AB.id]={pos:o,frm:1};if(AB.id===z.id){t=true;}else{if(t){return false;}}}});x=n[z.id].pos;var u=z.fix;if(u){if(!q||u>1){if(q||u!==n[z.id].frm){x=u;w=true;}}}}if(m==="b"){x=1;}else{x=x+(q?-1:1);}}var r={act:"pivot",unitPos:x};if(w){r.attFormId=z.fid;}else{if(!AA){r.axis=k;}}if(!l){var v=AA?z._e:z;if(!w){r.unitType=v.otp;}r.unitId=AA?v.oid:z.id;}return r;},isPvtButtonVisible:function d(r,m){var o=r.axis,n=H(this.data.gts,o),q=r.ui,l=r.hasOwnProperty("mix");if(m==="b"&&q===0){return false;}if(!isNaN(m)){if(parseInt(m,10)===o){return false;}if(l){return !!n[r.ui]._hid;}return true;}var p=n[r.ui].es,k=l?p.length:n.length;if(k===1){return false;}if(o===(l?S:h)){if(m==="u"||m==="d"){return false;}}else{if(m==="l"||m==="r"){return false;}}if(l?r._e===p[0]:q===0){if(m==="l"||m==="u"){return false;}}if(l?r._e===p[k-1]:q===k-1){if(m==="r"||m==="d"){return false;}}return true;},getDrillAction:function C(k,m){var l=m||this.getCellDrillsInfo(k[0]);return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,isWithin:l.within,drillPathKey:l.k,drillPathIndex:l.dpi,drillElements:Q.call(this,k)};},isVis:function a(){if(this.xtab){return this.xtab.isVis&&this.xtab.isVis();}else{var k=this.controller&&this.controller.view;if(k&&k.isVis){return k.isVis();}}return false;},getPTitle:function g(m,l){var k;if(this.isVis()){k=m.titleInfo;}else{k=H(this.data.gts,l)[m.tui];}return k;},getPCellParentNode:function P(m,l){var k;if(this.isVis()){k=(l==h)?m._lp:m._tp;}else{k=m._p;}return k;},getLinkAction:function T(m,l){var k,n;if(this.isVis()){m=m.node;n=m.titleInfo;}else{k=this.getCellTitleInfo(m);n=k.title;}return this.getLinkActionImpl(m,n,l);},getLinkActionImpl:function Y(x,t,v){var m=B(x,t),u=m&&m.links,z=(m&&m.onw)?"_blank":"";if(v===null||v===undefined){v=(m&&m.di)||0;}var p=u&&u[v];if(!p){return null;}var n={linkInfo:p,linkTarget:z};var k=p.url;if(k){var o="&CurrentElement";if(x&&t&&k.indexOf(o)>-1){k=k.replace(o,x._e.id);}n.url=k;}else{var q=p.target,w,l;switch(parseInt(q&&q.t,10)){case 55:if(parseInt(q.st,10)===14081){if(q.dvm&(8192|2048)&&!((q.dvm&2048&&mstrApp.features["run-vi-flash"]))){w=3140;if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(12187,"To work with HTML5 dashboards, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}}else{w=2048001;}l="objectID";}else{w=32001;l="documentID";}break;case 3:w=4001;l="reportID";n.reportViewMode=((parseInt(q.st,10)===769)?2:1);break;default:return null;}n.evt=w;n[l]=q.did;n.srcMsgId=this.getMessageId();var r=b.call(this,m,p,x);if(r){n.link=r;}return n;}},getDownloadAction:function W(n,l,p,m,o,k){return{xtabId:o,rowPosition:n,maxRows:l,colPosition:p,maxColumns:m,memo:k};}});}());(function(){mstrmojo.requiresCls("mstrmojo.StepperContentProvider","mstrmojo.num");var A=mstrmojo.num;function B(G,F){var H=F?G.max:G.min,D=F?G.min:G.max,E=G.getVal(F?1:-1);return(H===null||(F?(E<=H):(E>=H))||(D!==null&&G.canLoop));}function C(H,G){var F=H.min,D=H.max,E=H.getVal(G?1:-1);if((G&&D!==null&&E>D)||(!G&&F!==null&&(E<F))){if(H.canLoop){E=((E-F)%(D-F+1))+F;E=(E>=F)?E:E+(D-F+1);}else{return ;}}H.item[H.valField]=H.curVal=E;H.onTraverse();}mstrmojo.NumStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.NumStepperContentProvider",curVal:null,init:function(E){this._super(E);var F=this.item,D=function(I){var H=I&&F[I];return(H===null||H===undefined);},G=function(I,K,H){var J=H&&D.call(this,K)?null:F[K];if(J!==null&&J!==undefined){this[I]=J;}};G.call(this,"min",this.minField,true);G.call(this,"max",this.maxField,true);G.call(this,"interval",this.intField);this._initCurrent();},_initCurrent:function(){var E=this.item,F=this.curVal=E[this.valField];if(F===null||F===undefined){var D=this.min;this.curVal=D!==null?D:0;}},next:function(){C(this,true);},prev:function(){C(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},renderItemAt:function(F){var E=this.getVal(F),D=this.renderer;return D?D.render(E,this):E;},getVal:function(D){return this.curVal+(this.interval*(D||0));},setVal:function(F){var G=this.min,D=this.max,E=this.getVal();if(typeof F!=="number"||isNaN(F)||F===E||A.inNumericRange(F,G,D)!==0){return ;}this.item[this.valField]=this.curVal=F;this.onTraverse();},onTraverse:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.css","mstrmojo.string","mstrmojo._IsExprNode","mstrmojo._HasPopup","mstrmojo.Widget");var O=mstrmojo.dom,B=mstrmojo.css,E=mstrmojo.string.htmlAngles,M=mstrmojo.expr,N=M.ET,K=M.FN,A=M.BRANCH_FNS[K.NOT],D={};D[K.BETWEEN]=1;D[K.NOT_BETWEEN]=1;var C={"*":function(Q,P){return Q?('<span class="mstrmojo-unknown">'+(E(Q.n||Q.xml)||"...")+"</span>"):null;}};function H(Q,P,S,R){return S&&((R?'<span class="mstrmojo-ListIcon t'+R+'"></span>':"")+'<span class="mstrmojo-text mstrmojo-embedobj">'+E(S)+"</span>");}C[N.R]=function(Q,P){return H(Q,P,Q.r&&Q.r.n,Q.r&&Q.r.t);};C[N.F]=function(Q,P){return H(Q,P,Q.f&&Q.f.n,Q.f&&Q.f.t);};C[N.XML]=function(Q,P){return H(Q,P,Q.n||Q.p&&Q.p.n||Q.xml,Q.p&&Q.p.t);};C[N.AE]=function(V,S){var R=[];if(V&&V.a&&V.a.n){R.push('<span class="mstrmojo-text mstrmojo-attr">'+E(V.a.n)+"</span>");if(V.fn!==M.FN.IN_LIST){R.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(V.et,V.fn,V.fnt))+"</span>");}var U=V.es,P=U&&U.length||0;if(P){R.push('<span class="mstrmojo-elems">');var Q=R.length;for(var T=0;T<P;T++){R[Q++]='<span class="mstrmojo-text mstrmojo-elem">';R[Q++]=E(U[T].n);if(T<P-1){R[Q++]=", ";}R[Q++]="</span>";}R[Q++]="</span>";}else{R.push('<span class="mstrmojo-text mstrmojo-emptyelems">(Empty)</span>');}}return R.join("");};C[N.AQ]=function(W,X){var T=[];if(W&&W.a&&W.a.n){T.push('<span class="mstrmojo-text mstrmojo-attr">'+E(W.a.n)+"</span>");if(W.fm&&W.fm.n){T.push('<span class="mstrmojo-text mstrmojo-form">'+E(W.fm.n)+"</span>");if(W.fn!=null){T.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(W.et,W.fn,W.fnt,W.fm.dtp))+"</span>");var P=M.fnCstCount(W.fn,W.fnt);if(W.et===N.AC){if(P>=1){if(W.a2&&W.a2.n){T.push('<span class="mstrmojo-text mstrmojo-attr2">'+E(W.a2.n)+"</span>");if(W.fm2&&W.fm2.n){T.push('<span class="mstrmojo-text mstrmojo-form2">'+E(W.fm2.n)+"</span>");}}if(P>1){T.push('<span class="mstrmojo-text mstrmojo-btwn">'+X.betweenText+"</span>");if(W.a3&&W.a3.n){T.push('<span class="mstrmojo-text mstrmojo-attr3">'+E(W.a3.n)+"</span>");if(W.fm3&&W.fm3.n){T.push('<span class="mstrmojo-text mstrmojo-form3">'+E(W.fm3.n)+"</span>");}}}}}else{if(W.et===N.AL){var U=W.cs,Y=[];for(var R=0,V=U.length;R<V;R++){Y.push(U[R].v);}T.push('<span class="mstrmojo-text mstrmojo-c1">'+Y.join(mstrConfig.listSep)+"</span>");}else{if(P>=1){var U=W.cs,S=U&&U[0];T.push('<span class="mstrmojo-text mstrmojo-c1">'+E(S&&S.p&&S.p.n||S&&S.v)+"</span>");if(P>1){var Q=U&&U[1];T.push('<span class="mstrmojo-text mstrmojo-btwn">'+X.betweenText+"</span>");T.push('<span class="mstrmojo-text mstrmojo-c1">'+E(Q&&Q.p&&Q.p.n||Q&&Q.v)+"</span>");}}}}}}}return T.join("");};C[N.AC]=C[N.AQ];C[N.AL]=C[N.AQ];C[N.MQ]=function(f,g){var e=[],Z=f&&f.m,l=Z&&Z.n;if(l){var Q=f.fnt,U=M.FNT.PER,c=M.FNT.RANK;l=Q===U?mstrmojo.desc(2787,"Percentage of ##").replace("##",l):Q===c?mstrmojo.desc(2788,"Rank of ##").replace("##",l):l;e.push('<span class="mstrmojo-text mstrmojo-metric">'+E(l)+"</span>");if(f.fn!=null){e.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(f.et,f.fn,Q,M.DTP.REAL))+"</span>");var X=M.fnCstCount(f.fn,Q);if(f.et==M.ET.MC){if(X>=1){var k=(f.m2&&f.m2.n)||"?";e.push('<span class="mstrmojo-text mstrmojo-m2">'+E(k)+"</span>");if(X>1){e.push('<span class="mstrmojo-text mstrmojo-btwn">'+g.betweenText+"</span>");var S=(f.m3&&f.m3.n)||"?";e.push('<span class="mstrmojo-text mstrmojo-m3">'+E(S)+"</span>");}}}else{if(X>=1){var R=f.cs,a=R&&R[0];var P=function(h){var d=h.v;if(f.fnt==U){if(d.replace){h.v=d.replace(/%$/,"");}d=h.v+"%";}return d;};e.push('<span class="mstrmojo-text mstrmojo-c1">'+E(a&&a.p&&a.p.n||a&&a.v&&P(a))+"</span>");if(X>1){var Y=R&&R[1];e.push('<span class="mstrmojo-text mstrmojo-btwn">'+g.betweenText+"</span>");e.push('<span class="mstrmojo-text mstrmojo-c2">'+E(Y&&Y.p&&Y.p.n||Y&&Y.v&&P(Y))+"</span>");}}}var b=f.dmy&&f.dmy.uts,W=b&&b.length;if(W){e.push('<span class="mstrmojo-text mstrmojo-at">'+g.atText+"</span>");e.push('<span class="mstrmojo-dmy">');for(var V=0;V<W;V++){var T=b[V];e.push('<span class="mstrmojo-text mstrmojo-dmyunit">');e.push(E(T.utgt?T.utgt.n:T.n));if(V<W-1){e.push(",");}e.push("</span>");}e.push("</span>");}}}return e.join("");};C[N.MC]=C[N.MQ];function G(P){var Q=P.data;if(Q.not){return'<span class="mstrmojo-text mstrmojo-not">'+A+"</span>";}return"";}function F(P){var R=P.data,Q=C[R&&R.et]||C["*"];return G(P)+((Q&&Q(R,P))||('<span class="mstrmojo-text">'+P.emptyText+"</span>"));}mstrmojo.ConditionNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){B.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},oneditableChange:function(){B.toggleClass(this.textNode,["editable"],this.editable);},onselectedChange:function(){B.toggleClass(this.condNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=F(this);this.textPostfixNode.innerHTML=this.getConditionTextPostfix();}},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),init:function L(P){this._super(P);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());},getConditionTextPostfix:function(){return"";},del:function J(){var P=this.parent;if(P&&P.remove&&this.data){P.remove(this.data);}},isEmpty:function(){var Q=this.data,P=Q&&Q.et,R=P&&mstrmojo.expr.ET2TGT[P];return !(R&&Q[R]);},isSelectableArea:function(P){return O.contains(this.condNode,P,true);},preclick:function I(P){var R=null,Q=O.eventTarget(P.hWin,P.e);if(O.contains(this.prefixNode,Q,true)){R="andor";}else{if(O.contains(this.textNode,Q,true)){R="condition";}else{if(O.contains(this.textPostfixNode,Q,true)){O.stopPropogation(P.hWin,P.e);return false;}}}P.part=R;}});mstrmojo.ConditionNode.getFunctionNode=F;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.string");function C(H,D,E){var K=[];var G=H.optionRenderer,I=G&&G.render;if(I&&typeof I==="function"){var L=H.options,J=Math.min(E,((L&&L.length)||0)),F;for(F=D;F<J;F++){K.push(I(L[F],F,H));}}return K.join("");}mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,options:null,optionValueField:"v",optionNameField:"n",idx:-1,renderedOptions:"",markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onidxChange:function(){var D=this.domNode.getElementsByTagName("select");if(D&&D.length){D[0].selectedIndex=this.idx;}},onvalueChange:function(){var I=this.selectNode,G=I.options,F=this.value,E,H;for(H=0;H<G.length;H++){var D=G[H].value.toString()===F;if(D){E=H;if(F!==""){mstrmojo.css.toggleClass(G[H],"selected",D);}break;}}if(I.length>0&&E>0&&this.unset){if(this.options[0].v==="-1"){I.remove(0);E--;}this.unset=false;}this.set("idx",E);},onwidthChange:function(){var D=this.width;if(D>=0){this.selectNode.style.width=D+"px";}}},_set_selected:function(G,D){var E=this.selectNode,F=this[G]!==D;this[G]=D;if(E){this.set("value",D);}return F;},preBuildRendering:function A(){var F=this;if(F.unset){F.idx=0;}var E=F.options,D=(E&&E.length)||0;if(D){F.renderedOptions=C(F,0,D);}return this._super();},optionRenderer:{render:function(E,D,F){return mstrmojo.string.apply(F.getOptionMarkup(E),F.getOptionProps(E,D));}},getOptionMarkup:function(D){return'<option value="{@en@v}" class="{@cls}" style="{@style}" {@sel}>{@en@n}</option>';},getOptionProps:function B(F,D){var G=this,H=F[G.optionValueField],E=D===parseInt(G.idx,10);G.selected=G.value=E?H.toString():G.value;return{cls:E?"selected":"",v:H===undefined?"":H,n:F[G.optionNameField]||"",style:"",sel:E?"selected":""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string");var B=mstrmojo.string;mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",allowHTML:false,text:"",title:"",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" title="{@title} "mstrAttach:click></div>',markupMethods:{ontitleChange:function(){this.domNode.title=this.title;},ontextChange:function(){var C=this.text;C=B.isEmpty(C)?"":C.toString();this.domNode.innerHTML=this.allowHTML?C:B.encodeHtmlString(C,true);},oncssTextChange:mstrmojo.Widget.cssTextMarkupMethod,onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod},autoHide:false,_set_text:function A(E,C){if(this.autoHide){this.set("visible",(C!==null)&&(C!=="")&&(C!==undefined));}var D=this.text;this.text=C;return(D!==C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.Widget;mstrmojo.ui.Checkbox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.Checkbox",markupString:'<div id="{@id}" class="mstrmojo-ui-Checkbox {@cssClass}" mstrAttach:click></div>',markupMethods:{onvisibleChange:C.visibleMarkupMethod,oncheckedChange:function B(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},onenabledChange:C.enabledMarkupMethod},checked:false,onclick:function A(){this.set("checked",!this.checked);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget");var R=["(",")","{","}","-","+","*","/","<",">","|","~",","],G={" ":true,"@":true},Q=null;function J(V){if(!Q){Q={};var U,T;for(U=0,T=R.length;U<T;U++){Q[R[U]]=true;}}return Q.hasOwnProperty(V);}function S(V){if(!V){return false;}var T=V.length,U,W;for(U=0;U<T;U++){W=V.charAt(U);if(J(W)||G[W]){return true;}}return false;}function A(T){return S(T)?"["+T+"]":T;}var M={8:true,9:true,10:true};var C=function(U,T){return M[U]&&!/^\".*\"$/.test(T)?'"'+T+'"':T;};var D=function(U,T,V){var W=typeof V==="undefined"?true:M[V];return U.tp===261&&T.length>=2&&W?(/^\s+$/.test(T.substr(1,T.length-2))?T:T.substr(1,T.length-2)):T;};mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,null,{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}"></span>',active:false,markupMethods:{ondataChange:function(){var U=this.data,T=mstrmojo.string.encodeHtmlString(String(U.v));if(U.v===","){this.domNode.innerHTML=T+"&nbsp;";}else{if(U.tp===259&&U.v==="Desc"){this.domNode.innerHTML="&nbsp;"+T;}else{this.domNode.innerHTML=T;}}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());mstrmojo.css.toggleClass(this.domNode,["nfn"],!this.isFunction());mstrmojo.css.toggleClass(this.domNode,["invalid"],U.sta===-1);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},isMstrO:function P(){return !!this.data.oi||!!this.data.rfd;},isFunction:function B(){return this.isMstrO()&&(this.data.oi&&this.data.oi.t==11);},brackets:A,length:function E(){return this.data.v.toString().length;},isDelimiter:function O(){return this.data.isDelimiter||(this.length()===1&&J(this.data.v));},split2Tokens:function H(W){var V=this.data,U=V&&V.v.toString(),X=U.substring(0,W),T=U.substring(W);return[{v:X,isNew:true},{v:T,isNew:true}];},mergeTo:function I(U){var W=this.data,V=W&&W.v.toString(),T=U.data.v.toString();return{v:V+T,isNew:true};},brackets:A,setItemInfo:function N(T){var U=this.data;U.v=this.brackets(T.n);U.oi=T;U.sta=1;U.isNew=true;this.set("data",U);this.paint();},spliceContent:function K(Z,X,U){var Y=this.data,W=Y&&Y.v.toString(),a=W.substring(0,Z);X=(X===null||X===undefined)?(W.length-Z):X;var T=W.substring(Z+X),V=a+(U||"")+T;Y.v=V;Y.isNew=true;Y.sta=1;Y.ift=(this.isAttributeToken()||Y.at)&&(Y.v.indexOf("@")>=0);if(Y.ift){Y.at=Y.oi||Y.at;}else{delete Y.at;}delete Y.oi;delete Y.exv;delete Y.extp;delete Y.tp;this.set("data",Y);this.paint();},isAttributeToken:function F(){return this.data&&this.data.oi&&this.data.oi.t===12;},setFormInfo:function L(U){var V=this.data,T=V.oi||V.at;V.v=this.brackets(T.n)+"@"+this.brackets(U.n);V.exv=U.did;V.extp=8;V.sta=1;V.isNew=true;V.oi=V.at;delete V.at;this.set("data",V);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=J;mstrmojo.ME.MetricToken.brackets=A;mstrmojo.ME.MetricToken.quotes=C;mstrmojo.ME.MetricToken.unquotes=D;mstrmojo.ME.MetricToken.QUOTABLE_DATATYPES=M;mstrmojo.ME.MetricToken.argDelimiter={".":",",",":";"}[mstrConfig&&mstrConfig.decimalSep]||",";})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasLayout","mstrmojo.css","mstrmojo.string");var G=mstrmojo.css,D="clear";function E(){this.searchTriggered(this.inputNode.value);}mstrmojo.ui.SearchBox=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.SearchBox",markupString:'<div id={@id} class="mstrmojo-ui-SearchBox cf {@cssClass}" style="{@cssText}"><input class="mstrmojo-ui-sb-input" type="text" mstrAttach:keyup,blur/><div class="mstrmojo-ui-sb-btn" mstrAttach:click ></div></div>',markupSlots:{inputNode:function H(){return this.domNode.firstChild;},searchNode:function B(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{inputNode:"20px",searchNode:"20px"},w:{inputNode:"100%",searchNode:"22px"},xt:true},getLayoutOffsets:function(){return{w:2,h:0};},searchNode:undefined,inputNode:undefined,searchDelay:-1,init:function K(N){this._super(N);var M=this.searchDelay;if(M===-1||isNaN(M)){this.searchDelay=parseInt(mstrApp.getSearchAutoCompleteDelay(),10);}},onclick:function L(M){var N=M.getTarget();if(N===this.searchNode){if(this._hasText){this.clearSearch();}else{E.call(this);}}},onkeyup:function A(O){var N=O.hWin,R=O.e||N.event;if(R.keyCode===27){this.clearSearch();return ;}var Q=this,M=this.text,S=this.text=this.inputNode.value,P=this._hasText=S.length>0;if(M!==S){G.toggleClass(this.searchNode,[D],P);window.clearTimeout(this._searchTimeoutId);this._searchTimeoutId=window.setTimeout(function(){E.call(Q);},this.searchDelay);}},unrender:function F(){this.text="";this._super();},clearSearch:function I(M){this.text=this.inputNode.value="";G.removeClass(this.searchNode,[D]);delete this._hasText;if(!M){E.call(this);}this.postClearSearch();},isClear:function C(){return !this.text||this.text.length===0;},postClearSearch:mstrmojo.emptyFn,searchTriggered:function J(M){}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(K,N,G,L){var I=K.domNode,M=I.offsetWidth,D=K.scrollableIncFetch;var E=K.hasAnimation&&(!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5),J=L?1:-1,F=parseInt(M,10)*J,H=E?500:0;A(0,-F,H,{target:G,duration:H,preStart:function(){this.target.style.overflowY="hidden";},onEnd:function(){this.target.style.display="none";}});A(F,0,H,{target:N,preStart:function(){this.target.style.display="block";this.target.style.overflowY=(D?"visible":"auto");}});if(K.waiting){A(0,-F,H,{widget:K,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}else{if(this.scrollableIncFetch){E.style.overflowY="visible";}}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,hasAnimation:true,scrollableIncFetch:false,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.boxmodel","mstrmojo.Widget");var X=mstrmojo.hash,f=mstrmojo.css,L=mstrmojo.dom,c="animate",P="px";function a(g){return X.copy(X.walk(g,window).boxConfiguration||mstrmojo.vi.ui._IsBoxLayoutChild.boxConfiguration);}function H(k){var h=k.boxCache,l=h&&h[this.id],g=false;if(!l){g=this.domNode.className.indexOf(c)>-1;this.cacheCtxtBoxPosition(k);}k.boxAnimating=g;}mstrmojo.vi.ui._IsBoxLayoutChild=mstrmojo.provide("mstrmojo.vi.ui._IsBoxLayoutChild",{_mixinName:"mstrmojo.vi.ui._IsBoxLayoutChild",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onzIndexChange:function(){this.domNode.style.zIndex=this.zIndex||1;}},id:null,left:"0px",top:"0px",zIndex:1,draggable:false,dropZone:false,getBoxConfiguration:function C(){return a(this.scriptClass);},getBoxBorderWidth:function I(){return 0;},getMinBoxSize:function A(g){return mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums(this.scriptClass)[g];},getIdentifier:function Q(){return this.id;},updateLayout:function O(k,g){if(X.equals(k,this._currentLayout)){return ;}var h=this.domNode,m=window.Modernizr,l=this.getBoxBorderWidth();if(h&&g&&m.testProp("transition")){f.addClass(h,c);f.onTransitionEnd(h,function(){f.removeClass(h,c);});}this._currentLayout=k;this.applyBoxSize(Math.max((parseInt(k.height,10)-l),0)+P,Math.max((parseInt(k.width,10)-l),0)+P,k.top,k.left);if(this.hasRendered&&this.doLayout){this.doLayout();}this.postUpdateLayout();},postUpdateLayout:function D(){},applyBoxSize:function Y(g,l,n,m){this.height=g;this.width=l;this.top=n;this.left=m;var k=this.domNode;if(k){var h=this.domNode.style;h.top=n;h.left=m;h.height=g;h.width=l;if(parseInt(g,10)<=0||parseInt(l,10)<=0){h.borderWidth="0";}}},createAvatar:function V(){return this.offsetAvatar(this.domNode);},offsetAvatar:function S(g){g.style.margin="20px 0 0 20px";return g;},setMaskVisibility:function T(g){var h=this.maskNode.style;h.display=g?"block":"none";if(!g){this.resetMask();}},isDragValid:function F(g){return true;},initializeDrag:function G(g){},ondragstart:function e(g){this.initializeDrag(g);delete this._currentLayout;this.parent.beginBoxMove(g,this);this._super(g);},ondragend:function N(g){this._super(g);this.parent.endBoxMove(g,this);if(!g.dropSuccessful){this.parent.cancelBoxMove(g);}var h=this.domNode;h.style.margin="0";},allowDrop:function K(g){var k=g.src,h=k&&k.widget;return(h&&h.parent===this.parent);},wasDropped:function M(g){},cancelBoxMove:function J(g){return false;},ondragenter:function U(g){this.setMaskVisibility(true);},ondragover:function W(g){H.call(this,g);this.highlightMask(this.parent.getPanelTargetEdge(g)||this.getTargetDropZone(g),g);if(g.boxAnimating){delete g.boxCache[this.id];}},cacheCtxtBoxPosition:function E(h){var g=h.boxCache=h.boxCache||{};g[this.id]=L.position(this.domNode);},ondrop:function b(g){H.call(this,g);var k=g.src.widget;if(k.wasDropped){k.wasDropped(g);}var h=this.parent;if(k.parent===h){h.dropBox(g,this,this.maskNode.zone,true);}this.setMaskVisibility(false);},ondragleave:function B(){this.setMaskVisibility(false);},highlightMask:function d(l,k){var g=this.maskNode,h=k.boxAnimating;if(l!==g.zone||h||g.isAnimating!==h){g.zone=l;g.isAnimating=h;this.parent.updateDropCue(l,k,k.boxCache[this.id]);}},getTargetDropZone:function R(g){return mstrmojo.boxmodel.getEdgeQuadrantByPoint(g.boxCache[this.id],g.tgt.pos);},resetMask:function Z(){this.parent.updateDropCue("");var g=this.maskNode;delete g.zone;delete g.isAnimating;},getBoxDimension:mstrmojo.emptyFn,postDropBox:mstrmojo.emptyFn});mstrmojo.vi.ui._IsBoxLayoutChild.boxConfiguration={addToEnd:true};mstrmojo.vi.ui._IsBoxLayoutChild.getBoxMinimums=function(g){var h=a(g);return X.copy(h.minSize||h.f||{h:75,v:75});};mstrmojo.vi.ui._IsBoxLayoutChild.BoxConfigurationType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui._HasScroller","mstrmojo.css");var C=mstrmojo.css,E=mstrmojo.desc(14058,"Show Details"),A=mstrmojo.desc(14059,"Hide Details"),F=mstrmojo.desc(14060,"We are sorry for the inconvenience. Please {contact} your administrator for help.").replace("{",'<span class="dyn-link">').replace("}","</span>");mstrmojo.ui.editors.ErrorDialogContent=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",markupString:'<div class="mstrmojo-error-content" mstrAttach:click><div class="scroll-container"><div>{@shortDesc}</div><div>'+F+'</div><div class="toggle-details-link" >'+E+'</div><div class="error-details">{@en@longDesc}</div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild;},contactNode:function(){return this.domNode.firstChild.children[1].getElementsByClassName("dyn-link")[0];},toggleDetailsNode:function(){return this.domNode.firstChild.children[2];}},markupMethods:{onshowDetailsChange:function(){var H=this.showDetails;this.toggleDetailsNode.innerHTML=H?A:E;C.toggleClass(this.domNode,"show-details",H);this.updateScrollbars();}},shortDesc:undefined,longDesc:undefined,showDetails:false,init:function G(H){this._super(H);this.shortDesc=this.shortDesc||mstrmojo.desc(14061,"An error has occurred");},onclick:function B(H){var J=H.getTarget(),I,K=this.longDesc;if(J===this.contactNode){I="mailto:?subject="+encodeURI("Issue: "+this.shortDesc)+(K?("&body="+encodeURI("Detail:\r\n"+K)):"");mstrApp.openPage(I,"_self");}else{if(J===this.toggleDetailsNode){this.set("showDetails",!this.showDetails);}}},setupScrollNodes:function D(){this.scrollNode=this.scrollNode;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");var E=mstrmojo.Widget;mstrmojo.ui._IsPulldown=mstrmojo.provide("mstrmojo.ui._IsPulldown",{scriptClass:"mstrmojo.ui._IsPulldown",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click><div class="mstrmojo-ui-Pulldown-text {@cssTextClass}" title="{@title}" style="{@labelCssText}">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function D(){return this.domNode.firstChild;},containerNode:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:E.visibleMarkupMethod,onheightChange:E.heightMarkupMethod,onwidthChange:E.widthMarkupMethod,onvalueChange:function F(){this.selectedNode.innerHTML=this.value||"";},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},getPopupList:mstrmojo.emptyFn,anchorSlot:"selectedNode",postBuildRendering:function B(){this._super();this.getPopupList().set("items",this.items);var G=this.selectedIndex,H=this.selectedIndices;if(G!==undefined){this.set("selectedIndex",G);}if(H!==undefined){this.set("selectedIndices",mstrmojo.hash.copy(H||{}));}},onitemsChange:function C(){var G=this.getPopupList();if(G){G.set("items",this.items);}},onPopupWidgetOpened:function(){var G=this.getPopupList();if(G&&(!G.items||G.items.length===0)){G.close();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var a=mstrmojo.hash,f=mstrmojo.array,e=mstrmojo.boxmodel,c=mstrmojo.dom;function A(k,m,h){var l=k.listSelector;if(l){l[m](k,k.itemsContainerNode,h);}}function L(k,h){var l=k.lastPagePos;if(!l||l.dragId!==h){l=e.offset(k.itemsContainerNode);l.dragId=h;k.lastPagePos=l;var m=k.scrollboxNode;k.lastScrollPos={left:m.scrollLeft,top:m.scrollTop,width:m.clientWidth,height:m.clientHeight};}}function O(m,p,k){var l=p&&p.node;if(l===m.dropCueNode||l===m.dropCueNode.firstChild){return m.dropCuePos;}var n=m.listMapper;var h=n&&n.whereDrop(m,m.itemsContainerNode,l,p.pos,{left:m.lastPagePos.left-m.lastScrollPos.left,top:m.lastPagePos.top-m.lastScrollPos.top,width:m.lastScrollPos.width,height:m.lastScrollPos.height});var o=m.dropCuePos;return((k!==false)&&o&&h&&(o.idx===h.idx)&&(o.left===h.left)&&(o.top===h.top))?o:h;}var g="attachEventListener";function D(k,h){if(k.makeObservable){h=h||[];if(!h[g]){mstrmojo.hash.make(h,k.itemsScriptClass||mstrmojo.Arr);}}return h;}function H(k,h){if(h&&h[g]){k._sub_its=h;k._sub_add=h[g]("add",k.id,"preadd");k._sub_rmv=h[g]("remove",k.id,"preremove");}}function G(h){if(h._sub_its){var k=mstrmojo.publisher;k.unsubscribe(h._sub_add);k.unsubscribe(h._sub_rmv);delete h._sub_add;delete h._sub_rmv;delete h._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var k=this.dropCueNode,h=k&&k.style;if(!h){return ;}var m=this.dropCuePos,l=!!m;if(l){h.left=m.left+"px";h.top=m.top+"px";}h.display=l?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}},onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Z(n){this._super(n);this.items=this.initItems(this.items);var m=this.selectedIndices,k=this.selectedIndicesList,l=this.selectedIndex,p=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(m||k||(l>-1)||p){this.initSelections(m,k,l,p);}if(this.postInitItems){this.postInitItems();}},initItems:function I(h){return D(this,h);},preBuildRendering:function W(){var n=this.listBuilder,q=n.newContext(this);this.ctxtBuilder=q;var k=this.markupSlots,m=!!(this.renderOnScroll&&this.renderBlockSize&&k&&k.scrollboxNode),l=this.items,h=(l&&l.length)||0,o=m?this.firstRenderBlockSize:h,p=m?this.firstRenderBlockSize:0;this._eros=m;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(l,n,this,q,o,p).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function E(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}H(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var n=mstrmojo.all[q];n.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],h=k.length;l<h;l++){var p=k[l],m=this[p];if(m&&m.constructor===Object){m=mstrmojo.insert(mstrmojo.hash.clone(m));m.widget=this;this[p]=m;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function X(m){G(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],h=l.length;k<h;k++){var n=this[l[k]];if(n&&n.isPlaying){n.cancel();}}this._super(m);},pauseScrollRendering:function P(l,h,k){if(l!==false){l=true;}if(this.paused===!!l){return ;}this.paused=!!l;if(l){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(h,k);}},onscroll:function K(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var h=this;this._fillTmr=self.setTimeout(function(){h.fill();h=null;},50);}}if(this._super){this._super();}},fill:function b(h,n){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var o=(this.items&&this.items.length)||0;if(!o){if(n){n();}}else{var l=this.scrollboxNode,p=this.itemsContainerNode,m=mstrmojo.boxmodel.offset(p,l),r=this.listMapper,q=r.findScrollRange(p,o,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||l.scrollTop,l.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||l.scrollLeft,l.clientWidth,m.left,m.top);if(this.fillAt(q.start,q.end)){if(h){h();}var k=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[k].fill(h,n);},100);}else{if(n){n();}}}},fillAt:function M(l,k){var h=this.listMapper;if(h){return h.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,l,k,this.renderBlockSize);}else{return false;}},add:function R(k,h){if(!k||!k.length){return -1;}var l=this.items;if(h==null){h=a.min(this.selectedIndices,false,true);if(h!==null&&h!==undefined){h++;}}if(h==null||h===-1){h=(l&&l.length)||0;}if(l&&l.add){l.add(k,h);}else{this.set("items",l?f.insert(l.concat(),h,k):k);}return h;},preadd:function B(l){if(this.hasRendered){var o=this.listMapper;if(o){o.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var n=this.listBuilder;if(n){n.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var m=l.index,h=l.value.length;this.fillAt(m,m+h-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function U(h){if(h==null){return -1;}if(h.constructor!==Array){return this._remove(h);}var l=this.items;if(l){var k;if(l.remove){for(k=h.length-1;k>-1;k--){l.remove(h[k],1);}}else{l=l.concat();for(k=h.length-1;k>-1;k--){l.splice(h[k],1);}this.set("items",l);}return h[0];}return -1;},_remove:function U(l){var k=this.items;if(!k||(l==null)){return -1;}var h;if(!isNaN(l)){h=l;}else{h=this.itemIndex(l);}if(h>-1){if(k.remove){k.remove(h,1);}else{k=k.concat();k.splice(h,1);this.set("items",k);}}return h;},duplicate:function Y(o,k,l){var m=this.items,h=-1;if(!m||(o==null)){return -1;}if(!isNaN(o)){if(k===null||k===undefined){k=o+1;}o=m[o];}else{if(k===null||k===undefined){k=this.itemIndex(o)+1;}}if(o){var n;n=a.copy(l,a.clone(o));h=this.add([n],k);}return h;},preremove:function N(k){if(this.hasRendered){var m=this.listMapper;if(m){m.onremove(this,this.itemsContainerNode,this.ctxtBuilder,k);}var l=this.listBuilder;if(l){l.onremove(this,this.ctxtBuilder,k);}var h=this.listSelector;if(h){h.onremove(this,k);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(k);}if(this._super){this._super(k);}},move:function S(m,t){function q(v,u){v=parseInt(v,10);return u===1||(t>=v&&t<v+u);}var r=(this.items&&this.items.length)||0;if(t===-1||t==null||isNaN(t)){t=r;}else{t=Math.min(t,r);}var l,h,o,n;if(m.constructor===Array){h=m;o=m;n=(h&&h.length)||0;if(q(m[0],m.length)){return false;}l=f.get(this.items,m);}else{if(typeof (m)==="object"){l=[m];n=1;h=this.itemIndex(l[0]);o=[h];if(q(h,1)){return false;}}else{h=m;o=[m];n=1;if(q(h,1)){return false;}l=[this.items[h]];}}var p=0;for(var k=0;k<n;k++){if(o[k]<=t){t--;p++;}}if(p==o.length){t++;}if(l[0]!=null){this.remove(h);this.add(l,t);}return true;},itemIndex:function F(h){if(h==null){return -1;}var k=this.itemIdField;return k?f.find(this.items,k,h[k]):f.indexOf(this.items,h);},prechange:function T(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var m=0,h=k.length;m<h;m++){var n=k[m];if(n&&n.onchange){n.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function J(p,h){var o=this.items;h=this.initItems(h);this.items=h;if(o!==h){var m=this,l=function(){if(m.autoHide){m.set("visible",!!(h&&h.length));}m=null;},k=this.hasRendered;if(k){this.refresh(l);}else{l();}}return o!==h;},premousedown:function d(h){A(this,"premousedown",h);},premouseup:function Q(h){A(this,"premouseup",h);},scrollTo:function V(k){var h,l=this.listMapper;if(l&&l.toItem){if(!isNaN(k)){h=k;}else{h=this.itemIndex(k);}if(h>=0){l.toItem(this,h);}}},draggable:false,getDragData:function(n){L(this,n.id);var l=O(this,n.src),k=l&&l.idxActual;if((k>-1)&&this.selectedIndices[k]){var m=this.sortSelectedIndices(),h=f.get(this.items,m)||[];switch(h.length){case 1:return a.copy({html:h[0][this.itemDisplayField],index:m[0]},a.copy(h[0]));case 0:return null;default:return a.copy({html:h.length+" selections",indices:m},h);}}},dropZone:false,ondragenter:function(h){L(this,h.id);this.set("dropCuePos",O(this,h.tgt));},ondragover:function(h){this.set("dropCuePos",O(this,h.tgt));},ondragleave:function(h){this.set("dropCuePos",null);},isDragValid:function C(h){return h&&h.src&&h.src.data;},ondragstart:function(h){if(!(h&&h.src&&h.src.data)){return false;}},allowCopy:false,ondragend:function(m){var k=m&&m.tgt,h=k&&k.widget;if(h===this){}else{if(this.tree&&h&&h.tree===this.tree){if(!this.allowCopy||!c.ctrlKey(k.hWin,k.e)){var l=m.src&&m.src.data;if(l&&(l.indices||(l.index!==null))){this.remove(l.indices||l.index);}}}}},ondrop:function(r){var v=r&&r.src,q=v&&v.data;if(q){var l=O(this,r.tgt,false),t=l&&l.idx,m=(q&&q.constructor===Array),k=this.sortSelectedIndices();var o=this.items;t=Math.min(t,o&&o.length)||0;var u=true;if(v.widget===this){u=this.move(k,t);f.forEach(k,function(w){if(w<=t){t--;}});}else{this.add(m?q:[q],t);}if(u){var p=m?q.length:1,h={};for(var n=0;n<p;n++){h[t+n]=true;}this.set("selectedIndices",h);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});}());mstrmojo.ToolSeparator=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ToolSeparator",markupString:'<div class="mstrmojo-ToolSeparator {@cssClass}" style="{@cssText}"></div>',markupSlots:{},markupMethods:{}});(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo._ListSelections");var E=mstrmojo.dom;mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" tstid="{@tstid}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function G(){return this.domNode.firstChild;},scrollboxNode:function A(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},autoHide:false,itemsContainerNode:null,_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,init:function J(K){this._super(K);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},buildRendering:function D(){this.itemsHtml="";var K=(this.renderOnScroll?this.items&&((this.renderIndex+1)*this.renderBlockSize):this.items&&this.items.length);if(K){this.itemsHtml=this._buildItemsMarkup(0,K-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_buildItemsMarkup:function B(K,N,U,L,V,M){var W=[],Q=0;W[Q++]=U||"";var P=this.itemRenderer,T=P&&P.render;if(T&&typeof T==="function"){var R=this.items,S=Math.min(N+1,((R&&R.length)||0)),O;for(O=K;O<S;O++){W[Q++]=V||"";W[Q++]=T(R[O],O,this);W[Q++]=M||"";}}W[Q+1]=L||"";return W;},onselectionChange:function H(V){if(!V){return ;}var S=this.itemRenderer;if(!S){return ;}var O=S.unselect,R=this.items||[],W=V.removed,N,M,L,P,X;if(O&&W){for(P=0,X=W.length;P<X;P++){N=W[P];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){O(L,R[N],M,this);}}}var K=S.select,U=V.added,Q,T;if(K&&U){for(Q=0,T=U.length;Q<T;Q++){N=U[Q];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){K(L,R[N],M,this);}}}if(this.onchange){this.onchange({added:V.added,removed:V.removed});}},_set_items:function C(N,K){this.renderIndex=0;if(this.autoHide){this.set("visible",!!(K&&K.length));}var M=this.items;this.items=K;if(M!==K){var L=this.hasRendered;if(L){this.unrender(false);}this.clearSelect();if(L){this.render();}return true;}return false;},onItemContextMenu:mstrmojo.emptyFn,oncontextmenu:function F(K){E.preventDefault(window,K.e);var M=K.getTarget(),L=this.getItemFromTarget&&this.getItemFromTarget(M);if(L){if(this.onItemContextMenu(L,K)){K.cancel();}}},_getItemNode:function I(K){var L=this.itemsContainerNode;return(L&&L.childNodes[K])||null;},renderOnScroll:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,A="selected";mstrmojo.ButtonSwitch=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ButtonSwitch",markupString:'<div id="{@id}" class="mstrmojo-ButtonSwitch {@cssClass}" style="{@cssText}" mstrAttach:click><div class="left selected" > {@label1} </div><div class="right"> {@label2} </div></div>',markupSlots:{left:function(){return this.domNode.children[0];},right:function(){return this.domNode.children[1];}},switchFn:mstrmojo.emptyFn,onselectedChange:function(){var D;for(D=0;D<2;D++){C.toggleClass(this.domNode.children[D],A,this.selected===D);}this.switchFn();},onclick:function B(D){this.set("selected",(D.getTarget()===this.left)?0:1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._RowRendTracker","mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var T="<tr>";var d=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var W="&nbsp;";var I="fsbp_1 ";var b="fsbp_2 ";var B="fsbp_3 ";var Z=1,a=2,F=3,f=4,L=5,V={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" stack-bottom-last",5:" no-stack",6:" stack-full"},O=1,A=3;var e=mstrmojo.css,Q=mstrmojo.array,c=mstrmojo.chart.model.enums.EnumDSSBaseFormType;var K=4;function E(l,k){for(var m=0,h=l.length;m<h;m++){var o=l[m];var n=k.rows[o.rows].cells[o.cells];if(n){mstrmojo.css.addClass(n,I);}}}function X(l){var n=l.indexOf('src="');if(n<0){return l;}var m=l.substring(n+5),k=m.indexOf('"'),o;m=m.substring(0,k);o=m;var h=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(h&&h.getImage){o=h.getImage(m);}return l.replace(m,o);}var R=(function(){var p=/\n/g,k="<br/>",AB=/<a\s[^>]+>/gi,z="<a ",o='<a target="_blank" ',w="target=";var x='<a href="',v='" target="_blank">',t="</a>",r="<span>",m="</span>",q='<span rabtn class="raBtn ',l='"></span>',u="icon-expand",AA="icon-collapse",n="<span>",h="</span>";return function(AL,AJ){var AM=(AL.v||AL.n||W).replace(p,k),AN=AL.ts===c.DssBaseFormUrl,AH=AL.ts===c.DssBaseFormHTMLTag,AE=AL.lv!==undefined;if(AN){AM=x+AM+v+AM+t;}else{if(AH){(AM.match(AB)||[]).forEach(function(AO){if(AO.indexOf(w)===-1){AM=AM.replace(AO,AO.replace(z,o));}});}}if((AL.css&&AL.css.indexOf("hl")>-1)||AN){AM=r+AM+m;}if(AE){var AF=AL.lv,AC="&nbsp;&nbsp;&nbsp;&nbsp;",AD="",AI="",AK="",AG;for(AG=0;AG<AF;AG++){AD+=AC;}if(AL.hcd&&AL.fi===undefined){AK=q+(AL.epd?AA:u)+l;}else{AD+=AC;}if(AL.axis===1){AI=n+AD+h;}AM=AI+AK+AM;}return AM;};}());mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._RowRendTracker],{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function J(h){this._super(h);},numColumnCanMerge:0,preBuildRendering:function D(){var h=this.cp;if(!h){return ;}h.initContent();this.rc=h.rc||0;this.cws=h.colWidths||[];this.cc=this.cws.length;this.tdWidths=h.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=h.getNumAutoHeightRows&&h.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function H(k){var h=this._super(k);this.renderGrid();return h;},renderGrid:function U(k){var h=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(h,k);this.postBuildGridTable();},getGridContainer:function g(){return this.gridContainerNode;},buildGridTable:function G(l,h){var k=this.getTableStartMarkup();var r=this.getTableEndMarkup();if(h){this.mergeHdrsAcrossBlks=true;}var p=this.buildTableRowsMarkup(this.start,this.end,k,r).join("");if(h){var n=document.createElement("div");n.innerHTML=p;var q=l.firstChild,t=q&&q.tBodies,m=n.firstChild.tBodies[0],o=this.matchedHdrsAcrossBlks;q.appendChild(m);if(o&&o.length>0){E(o,t[t.length-2]);}}else{l.innerHTML=p;}this.markPages(this.start,this.end);},getTableStartMarkup:function P(){var k=this._getGridWidths(),h=d;h[1]=k.tableLayout;h[3]=k.totalColWidths;h[5]=this.tableCssClass?"class="+this.tableCssClass:"";h[7]="<colgroup>"+k.colgroup+"</colgroup>";if(this.tbodyStyle){h[8]='<tbody style="'+this.tbodyStyle+'">';}return h.join("");},getTableEndMarkup:function N(){return"</tbody></table>";},_getGridWidths:function Y(){var r={};var n="",l=[],q="fixed",k=this.cws,o=k.length;if(o){n=0;l=[];for(var m=0;m<o;m++){if(k[m].w!==""){n+=parseInt(k[m].w,10);}}for(m=0;m<o;m++){var h=k[m];if(h.w!==""&&!this.autoFitWindow){var p=parseInt(h.w,10);if(mstrmojo.dom.isIE7){if(p===0){l.push('<col style="width:0%;display:none"></col>');}else{l.push('<col style="width:'+(p/n*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&p===0){l.push('<col style="width:-1px"></col>');}else{l.push('<col style="width:'+h.w+'"></col>');}}}else{l.push("<col />");q="auto";}}this.totalColWidth=n;}r.colgroup=l.join("");q=this.tableLayout||q;if(this.autoFitWindow){q=this.tableLayout||q||"fixed";n="100%";}else{if(q==="fixed"){n+="px";}else{n="auto";}}r.totalColWidths=n;r.tableLayout=q;return r;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function S(AU,AD,A1,t,AF){var Ak=[],Aw=0;Ak[Aw++]=A1||"<table><tbody>";var AX=this.cp,AG=this.acws,AW=this.rowMerge,AB=this.headerOffset,o=this.mxPos,AJ=!!AX.gemh,Ag=AX.getRowHeight(),Au=this._CELL_MARKUP,Aj=Ag?'<tr style="height:'+(Ag?Ag+"px":"")+'">':T;var z=true,AS=true,Aq=[],Am;var Ax=function Ax(r){var m=-1;mstrmojo.array.forEach(AG,function(A2,v){r=r-A2;if(r<0){m=v;return false;}});return m;};var AC=function AC(v,r){var m=-1;mstrmojo.hash.forEach(AX.gemh,function(A2,A3){if(v<=A3&&v+r>A3){m=A3;return false;}});return m;};var AL=function AL(A3,A4,A2){var v="",r,m;m=A3.gemh&&A3.gemh[A4];if(m){r=Ax(A2);if(m[r]&&m[r].v===0||o===A2){v+=I;}}m=A3.gsmh&&A3.gsmh[A4];if(m){r=Ax(A2);if(m[r]&&m[r].v===0||o===A2){v+=B;}}return v;};var Ap,AQ,AH,At=[],Av,Al,AE=0,k=0,p,w,Ad=AX.colWidths&&AX.colWidths.length,AZ=0,n=0,h=AF||((A1&&A1.indexOf("table-layout:fixed;")!==-1)?"fixed":"auto");if(AG&&AJ){for(Av=0;Av<AG.length-1;Av++){n+=AG[Av];}}n=n||this.numColumnCanMerge;if(h==="fixed"){Ap=[];for(AQ=0,AH=this.cws.length;AQ<AH;AQ++){if(window.parseFloat(this.cws[AQ].w)<=0){Ap[AQ]=true;}else{Ap[AQ]=false;}}}this.matchedHdrsAcrossBlks=[];for(var An=AU;An<=AD;An++){AE=0;Am=Aw++;Ak[Am]=An<this.numAutoHeightRows?T:Aj;var AK=AX.getRowCells(An);var Ai=AD+1-An;var Ah=0;w=AW;p="";if(!this.mergeHdrsAcrossBlks){if(z&&AU>0&&AK.length<AX.colWidths.length){var Af=AX.getUnmergedCells(AU),AN;if(Af){Ah=Af.length;}for(Av=0,AH=Ah;Av<AH;Av++){var AP=Af[Av],AA=AP.rs;if(AA>Ai){Au[1]=Ai;Au[5]=b+AP.css;}else{Au[1]=AA||1;Au[5]=B+AP.css;}if(Ap&&Ap[k+AE]){Au[5]+=" nwFixedWidth0 ";}if(AA&&AA>1){At.push(AA);}AE+=AP.cs||1;if(AP.cet){Au[5]+=" mstrmojo-selected-cell";this.addHilitePosition(AP.cet,An,Av);}if(AP._ei){this.addExtraInfoMap(AP._ei,An,Av);Au[5]+=" pt";}Au[9]="";Au[13]=W;Au[3]=AP.cs;if(AP._ei===undefined){AN=AX.getRowCells(AP.o+(AX.cps[0]&&AX.cps[0].rc||0));AP=Q.filterOne(AN,function(m){return m.dpt===AP.dpt&&m.idx===AP.idx;});}Au[7]=AP._ei;Au[11]=An;if(AJ){if(w){p=AL(AX,An-AB,Av);}if(!!p){Au[5]=p+Au[5];}else{w=false;}p=AL(AX,AC(An-AB,Au[1]),Av);if(!!p){Au[5]=I+Au[5];w=true;}}Ak[Aw++]=Au.join("");}z=false;}}AZ=Ad;AH=AK.length;var A0;for(A0=0;A0<AH;A0++){AZ-=AK[A0].cs||1;}for(A0=0;A0<AH;A0++){var Ab=AK[A0],Ac;Ab.colIx=AZ;if(Ab.rs&&Ab.rs>Ai){Au[1]=Ai;Au[5]=I+Ab.css;if(Ab._ei){this.addExtraInfoMap(Ab._ei,An,A0);}}else{Au[1]=Ab.rs||1;Au[5]=Ab.css;}if(Ap&&Ap[k+AE]){if((Ab.cs==undefined)||((Ab.cs!=undefined)&&(Ab.cs==1))){Au[5]+=" nwFixedWidth0 ";}}if(Ab.rs&&Ab.rs>1){At.push(Ab.rs);}AE+=Ab.cs||1;if(Ab.rowType!==Z){Au[5]+=" xtab-td ";}if(Ab.cet){Au[5]+="sc_"+this.parent.k;this.addHilitePosition(Ab.cet,An,A0);}if(Ab.lv){Au[5]+=" ra ";}Ac=Ab.rowType;if(Ac){Au[5]+=V[Ac]||"";var AI=AX.getRowHeight(Ac);if(AI){Ak[Am]='<tr style="height:'+(AI?AI+"px":"")+'">';}}Au[3]=Ab.cs||1;Au[7]=Ab._ei!==undefined?Ab._ei:"";if(Ab.fs||Ab._e){this.addTitleHeaderPositionMap(An,A0+Ah,Ab);}if(Ab._ei!=null){this.addPositionMap(Ab._ei,An,A0+Ah);}Au[11]=An;if(Ab.ts===K){var AO=Ab.v;if(this.imgCacheMap){var Ar=this.imgCacheMap,Al=AO&&AO.replace(/\\/g,"/");if(Ar.cachedImg[Al]){Ab.v=AO=Ar.baseURL+Ar.cachedImg[Al];}else{if(Al&&!Ar.unCachedImg[Al]){Ar.unCachedImg[Al]=Al;}}}else{var u=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(u&&u.getImage){AO=u.getImage(AO);}}if(Ab.rowType){var l=(AX.getRowHeight(Ab.rowType)||AX.rh||Ag),Ao=l,AT=this.tdWidths,Ae=Ab.colIdx,AY=0,As=0;var Az=AX.getPadding(O),AV=AX.getPadding(A);if(Ab.rowType===Z||Ab.rowType===f){As=l>(Az+AV)?(l-Az-AV):0;}else{if(Ab.rowType===a||Ab.rowType===F){As=l>2*AV?(l-2*AV):0;}else{if(Ab.rowType===L){As=l>(AV*2)?(l-AV*2):0;}}}if(Ae!=="undefined"&&Ae>-1&&AT&&AT.length>Ae){var AM=AT[Ae]&&AT[Ae].w;if(AM!=="undefined"){AY=parseInt(AM,10);}}var AR=AY>30?(AY-30):0;Au[13]='<div><div style="top:'+(-parseInt(Ao/2,10))+"px;height:"+(l-1)+"px;line-height:"+(l-1)+'px !important;">&nbsp;<img style="max-height:'+As+"px; max-width: "+AR+'px;" src="'+AO+'"></img></div></div>';}else{Au[9]="";var Ay="",x=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model,q=x.getZoomFactor();if(q!=1){Ay='onload="this.style.height='+q+"*this.offsetHeight+'px';\"";}Au[13]='<img src="'+AO+'" '+Ay+"></img>";if(Ab.css&&Ab.css.indexOf("hl")>-1){Au[13]="<span>"+Au[13]+"</span>";}}}else{Au[9]="";if(mstrApp.useBinaryFormat&&Ab.v&&Ab.v.indexOf("img")>=0){Ab.v=X.call(this,Ab.v);}Au[13]=R(Ab,AX);}if(A0<n){if(An===AU&&this.mergeHdrsAcrossBlks){var Aa=this.rowHdsAcrossBlks;if(AS&&Ab.v&&Aa&&Aa[A0]){if(Ab.v===Aa[A0].v){Au[1]=Ab.rs||1;Au[5]=B+Ab.css;Au[13]="";this.matchedHdrsAcrossBlks.push(Aa[A0]);}else{AS=false;}}}if(AJ){if(w){p=AL(AX,An-AB,AZ);if(!!p){Au[5]=p+Au[5];if(p.indexOf(B)>=0&&An-AB>1){Au[13]=W;}}else{w=false;}p=AL(AX,AC(An-AB,Au[1]),AZ);if(!!p){Au[5]=I+Au[5];w=true;}}}if(Au[1]>=Ai&&Ab.v){Aq.push({rows:An-AU,cells:A0,v:Ab.v});}}AZ+=Ab.cs||1;Ak[Aw++]=Au.join("");}Ak[Aw++]="</tr>";for(A0=At.length-1;A0>=0;A0--){Al=At[A0];if(Al<=1){At.pop();}else{At[A0]=--Al;}}k=At.length;}Ak[Aw++]=t||"</tbody></table>";this.rowHdsAcrossBlks=Aq;return Ak;},addHilitePosition:function(k,l,h){var m=this.hiliteCellsMap[k];if(!m){this.hiliteCellsMap[k]={pos:[],nodes:[]};}this.hiliteCellsMap[k].pos.push({row:l,cell:h,page:0});},addExtraInfoMap:function(k,h,l){if(!this.eiMap[k]){this.eiMap[k]=[];}this.eiMap[k].push({row:h,cell:l,page:0});},addPositionMap:function(k,h,l){if(!this.posMap[k]){this.posMap[k]={row:h,cell:l,page:0};}},addTitleHeaderPositionMap:function(h,l,k){this.thPosMap.push({row:h,cell:l,page:0,obj:k});},clearHilites:function(m){var q=this.hiliteCellsMap[m],o=q&&q.nodes,n=this.parent;if(o){if(o.length==0&&q.pos){o=this.getNodesByPositions(q.pos);}for(var l=0,k=o.length;l<k;l++){var p=o[l],h=n.getCellForNode(p);if(h){delete h.cet;}e.removeClass(p,"sc_"+n.k);}this.hiliteCellsMap[m].nodes=[];}},setHilites:function(k,l){e.addClass(l,"sc_"+this.parent.k);if(!this.hiliteCellsMap[k]){this.hiliteCellsMap[k]={pos:[],nodes:[]};}this.hiliteCellsMap[k].nodes.push(l);var h=this.parent.getCellForNode(l);if(h){h.cet=k;}},getNodesByPositions:function(n){var m=this.tableNode,h=[];for(var l in n){var k=n[l];h.push(m.tBodies[0].rows[k.row].cells[k.cell]);}return h;},preBuildGridTable:function C(){},postBuildGridTable:function M(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var C=mstrmojo.dom,B=mstrmojo.hash,E=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);},onselectedChange:function(){E.toggleClass(this.domNode,"selected",this.selected);},ontextChange:function(){this.textNode.innerHTML=this.text;},ontitleChange:function(){this.domNode.title=this.title;},onwidthChange:mstrmojo.Widget.widthMarkupMethod},oniconClassChange:function D(J){var K=this.domNode;if(this.hasRendered&&K){K.className=K.className.replace(J.valueWas,"")+" "+J.value;}},onclick:mstrmojo.emptyFn,ontouchend:function I(J){this.onclick(J);}});mstrmojo.Button.newIconButton=function H(L,O,M,J,N){var K={scriptClass:"mstrmojo.Button",title:L,cssClass:O,text:"",onclick:M};if(J){K.bindings=J;}B.copy(N,K);return K;};function F(M,N,J,P){var L=[];if(J){L.push(J);}var O=P&&P.cssClass;if(O){L.push(O);delete P.cssClass;}var K={scriptClass:"mstrmojo.Button",cssClass:L.join(" "),text:M};if(N){K.onclick=N;}return B.copy(P,K);}mstrmojo.Button.newInteractiveButton=function G(M,N,P,O){var L={glowClass:"glow"};if(P&&(C.isFF||C.isWK)){B.copy({onmousedown:function J(){E.applyShadow(this.domNode,0,0,10,P);},onmouseup:function K(){E.removeShadow(this.domNode);}},L);}return F(M,N,"mstrmojo-InteractiveButton",B.copy(O,L));};mstrmojo.Button.newWebButton=function A(K,J,M,L){return F(K,J,"mstrmojo-WebButton"+(M?" hot":""),L);};mstrmojo.Button.newActionButton=function(K,L,M){var J=mstrmojo.Button.newWebButton(K,L,false,M);J.cssClass=J.cssClass+" action-button";return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.array","mstrmojo._HasChildren");var G=mstrmojo.array;function E(P){if(!this.shouldPropagateEnabled){return ;}var O=this._disabledChildren;G.forEach(P,function(Q){if(Q.enabled){O.push(Q.id);Q.set("enabled",false);}});}function J(){G.forEach(this._disabledChildren,function(O){var P=mstrmojo.all[O];if(P&&P.parent===this){P.set("enabled",true);}},this);this._disabledChildren=[];}mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",containerNode:null,preserveChildDomOrder:true,shouldPropagateEnabled:false,init:function M(P){this._super(P);this._disabledChildren=[];this.attachEventListener("addChild",this.id,function(Q){if(this.shouldPropagateEnabled&&!this.enabled){E.call(this,Q.value);}});if(this.children){this.initChildren();}var O=this.parent;if(!O||O.hasInitBindings){this.initBindings();}},destroy:function H(O){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(O);},unrender:function I(Q){var R=this.children,O=(R&&R.length)||0,P;for(P=O-1;P>-1;P--){R[P].unrender(true);}this._super(Q);},postBuildRendering:function A(){if(this._super()!==false){this.renderChildren();return true;}return false;},renderChildren:function L(){var Q=this.children,O=(Q&&Q.length)||0,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}}},childRenderCheck:function D(P){if(P&&!P.hasRendered){var O=P.slot||this.defaultChildSlot;return !!this[O];}return false;},addChildren:function N(R,P,Q){var O=this._super(R,P,Q);if(O){this.childRenderOnAddCheck(O);}return O;},removeChildren:function F(V,R){var U=V?[V]:(this.children||[]),O=U.length,S;for(S=O-1;S>-1;S--){var Q=U[S],P=Q&&Q.domNode;if(P){var T=this[(Q.slot||this.defaultChildSlot)];if(P.parentNode===T){T.removeChild(P);}}}return this._super(V,R);},childRenderOnAddCheck:function B(Q){if(this.hasRendered&&Q){var O=Q.length,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}else{if(R&&R.hasRendered){this.onchildRenderingChange(R);}}}}},onchildRenderingChange:function K(O){var W=O&&O.domNode;if(!W){return ;}var P=this.defaultChildSlot,V=O.slot||P,Y=this[V],Q=this.children;if(!Y){if(W.parentNode){W.parentNode.removeChild(W);}}else{if(W.parentNode===Y){return ;}if(!this.preserveChildDomOrder){Y.appendChild(W);}else{var R,U;for(U=Q.length-1;U>=0;U--){var X=Q[U];if(X===O){break;}if(V===(X.slot||P)){var Z=X.domNode;if(Z&&Z.parentNode===Y){R=Z;}}}if(R){Y.insertBefore(W,R);}else{Y.appendChild(W);}}}if(mstrmojo.publisher.hasSubs(this.id,"childrenRendered")){var S=Q.length,T;for(T=0;T<S;T++){if(!Q[T].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}},propagateChildProps:function C(S){var R=this[S],Q=this.children||[],O=Q.length,P;for(P=0;P<O;P++){Q[P].set(S,R);}}});mstrmojo.Container.enabledMarkupMethod=function(){mstrmojo.Widget.enabledMarkupMethod.apply(this,arguments);if(this.shouldPropagateEnabled){if(this.enabled){J.call(this);}else{E.call(this,this.children);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocHTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocHTMLContainer",scrolling:"auto",markupString:'<iframe id="{@id}" k="{@k}" class="mstrmojo-DocHTMLContainer" title="{@tooltip}" style="{@domNodeCssText}" src="{@v}" scrolling="{@scrolling}"></iframe>',formatHandlers:{domNode:["RW","B","F","background-color","text-align","white-space","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function A(B){this.v=B.data.v;if(mstrApp&&mstrApp.isTouchApp()){this.scrolling="no";}if(this.thresholdId||B.data.tid){delete this.fmts;}this.thresholdId=B.data.tid;this.set("visible",!B.data.hidden);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.dom");var H=mstrmojo.color,F=mstrmojo.dom;var G=68.5,I=77.5,C=83;function A(L,K){var J=F.getMousePosition(L,window);return{x:J.x-K.x-I,y:J.y-K.y-I};}function B(L){var K=this._hsl,J=K[0],N=K[1],P=K[2],Q=J*2*Math.PI;var M=this.hueHandleNode.style;M.left=Math.round(Math.sin(Q)*G+I)+"px";M.top=Math.round(-Math.cos(Q)*G+I)+"px";var O=this.slHandleNode.style;O.left=Math.round(C*(0.5-N)+I)+"px";O.top=Math.round(C*(0.5-P)+I)+"px";this.slNode.style.backgroundColor=H.hsl2hex(J,1,0.5);if(!L){this.onColorPicked(H.hsl2hex(J,N,P));}}mstrmojo.ui.editors.controls.ColorWheel=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",markupString:'<div id="{@id}" class="mstrmojo-ui-ColorWheel {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="cwHue"></div><div class="cwColorField"></div><div class="cwHandle"><div></div></div><div class="cwHandle"><div></div></div></div>',markupSlots:{slNode:function(){return this.domNode.childNodes[1];},hueHandleNode:function(){return this.domNode.childNodes[2];},slHandleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,oncolorChange:function(){this._hsl=H.hex2hsl(this.color);B.call(this,true);}},slNode:null,hueHandleNode:null,slHandleNode:null,color:"#ffffff",onColorPicked:function E(J){},onmousedown:function D(M){var O=this,J=F.position(this.domNode),P=this._hsl,L=M.e,N=A(L,J),Q=Math.max(Math.abs(N.x),Math.abs(N.y))*2>C,K=function(S){var V=A(S,J),R=P[0],T=P[1],U=P[2];if(Q){R=Math.atan2(V.x,-V.y)/(2*Math.PI);if(R<0){R+=1;}}else{T=Math.max(0,Math.min(1,-(V.x/C)+0.5));U=Math.max(0,Math.min(1,-(V.y/C)+0.5));}O._hsl=[R,T,U];B.call(O);F.stopPropogation(window,S);return false;};F.attachMouseMoveEvents(K);K(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Widget");var B=mstrmojo.dom;mstrmojo.InlineEditBox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.InlineEditBox",text:null,editMode:false,allowEdit:true,okSave:false,emptyHint:"Enter your text here.",markupString:'<div id="{@id}" class="mstrmojo-InlineEditBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-InlineEditBox-text"></div><div class="mstrmojo-InlineEditBox-edit"><input type="text" class="mstrmojo-InlineEditBox-input" mstrAttach:keyup/><img class="mstrmojo-InlineEditBox-ok" src="../images/1ptrans.gif" title="Save"/><img class="mstrmojo-InlineEditBox-cancel" src="../images/1ptrans.gif" title="Cancel"/></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.lastChild;},inputNode:function(){return this.domNode.lastChild.firstChild;},okNode:function(){return this.domNode.lastChild.childNodes[1];},cancelNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text||this.emptyHint||"");},oneditModeChange:function(){var H=this.editMode,E=this.domNode,D=this.textNode,G=this.editNode;mstrmojo.css.toggleClass(E,["edit"],H);if(H){D.style.display="none";G.style.display="block";D=this.inputNode;var F=D.style;D.value=this.text||"";F.width=(E.clientWidth-(this.okSave?(this.okNode.offsetWidth+this.cancelNode.offsetWidth):0))+"px";F.height=E.clientHeight+"px";D.focus();if(D.createTextRange){var I=D.createTextRange(),C=D.value.length;I.move("character",C);I.select();}}else{D.style.display="block";G.style.display="none";}},onokSaveChange:function(){var C=this.okSave?"inline":"none";this.okNode.style.display=C;this.cancelNode.style.display=C;},onallowEditChange:function(){mstrmojo.css.toggleClass(this.domNode,["disable"],!this.allowEdit);}},onvisibleChange:function A(){if(this.domNode){this.domNode.style.display=(this.visible?"block":"none");}},preclick:function(C){var E=C.e,D=B.eventTarget(C.hWin,E);if(D===this.okNode){this.save();}else{if(D===this.cancelNode){this.cancel();}else{if(this.editMode!==this.allowEdit){this.set("editMode",this.allowEdit);}}}},prekeyup:function(C){var E=C.e,D=E.keyCode||E.charCode;if(D===mstrmojo.Enum_Keys.ENTER){this.save();}else{if(D===mstrmojo.Enum_Keys.ESCAPE){this.cancel();}}},_attachEvents:function(){var C=this;if(this.editMode){if(!this._save_handler){this._save_handler=function(){var D=B.eventTarget(self,arguments[0]);if(!B.contains(C.domNode,D,true,document.body)){C.save();}};}B.attachEvent(document.body,"mousedown",this._save_handler);}else{if(this._save_handler){B.detachEvent(document.body,"mousedown",this._save_handler);}}},postBuildRendering:function(){if(this._super){this._super();}this._em_sub=this.attachEventListener("editModeChange",this.id,"_attachEvents");},destroy:function(){this.detachEventListener(this._em_sub);if(this._super){this._super();}},save:function(){this.set("text",this.inputNode.value);this.set("editMode",false);if(this.onSave){this.onSave();}},cancel:function(){this.set("editMode",false);if(this.onCancel){this.onCancel();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click tstid="{@tstid}"/><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,G=mstrmojo.array;function F(H,J){var I={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[H]||{};if(typeof J==="object"){mstrmojo.hash.copy(J,I);}return I;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,forceResetCache:false,onUpdateSearchParams:mstrmojo.emptyFn,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(4326,"Case Sensitive")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},searchNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;},optionNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function E(H){var J=this;var I=J.searchTimer;if(I){window.clearTimeout(I);}J.searchTimer=window.setTimeout(function(){J.onkeyupDelayed(H);delete J._searchTimer;},parseInt(H.e.keyCode||H.e.charCode,10)===13?0:J.searchDelay);},onkeyupDelayed:function A(I){var H=I.hWin,K=I.e||H.event;var J=mstrmojo.string.trim(this.inputNode.value);if(this.searchNode){C.toggleClass(this.searchNode,["clear"],J.length>0);}this.showTaskError=false;this.click2Search=false;if(J.length==0||this.autoSubmit||this.onEnter&&K.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(I){var H=I.hWin,K=I.e||H.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var J=this.optionNode.parentNode.style;J.display=J.display=="block"?"none":"block";}break;case"sbSearch":if(this.inputNode.value.length>0){this.clearSearch();}break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);var I=this.searchCache,H=this.rootID;if(I&&I[H]){I[H][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache(this.forceResetCache);var I=this.searchCache[this.rootID];if(I){var H=I[B]||"";this.inputNode.value=H;if(H.length>0){if(H.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(I){var H=this.contentWidget||this;H.set("items",I[0]);if(this.supportIncFetch){var J=I[1],L=I[2],K=this.blockCount;H.set("ifs",{np:Math.floor(J/K)+((J%K>0)?1:0),cp:Math.floor(L/K)+((L%K>0)?1:0)});}},_onsearch:function(H){this.getRootID();this._setupCache();var K=mstrmojo.string.trim(this.inputNode.value);if(K.length===0){H=true;}var L=this.token[this.taskId];if(L.test(K)){}if(this.searchPattern==K&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var M=this.rootID,J=this.searchCache[M];if((K.length<this.minSearchLength&&!this.click2Search)&&!H){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(J[M]);this.searchPattern=K;}}else{this.searchPattern=K;J[B]=this.searchPattern;var I=this.filterCache(K,J,H);if((this.click2Search||I===null)&&!H){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(I);}}J[B]=K;},_setupCache:function(J){var K=this.searchCache,I=this.rootID;if(K&&(J||!K[I])){K[I]=K[I]||{};var H=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];K[I][I]=[H,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",serverRequest:function D(H,I){mstrmojo.xhr.request("POST",this.path,I,H,undefined,this.XServer,this.baseParams);},fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var H=this,I=F.apply(this,[this.taskId]);I.searchPattern=this.searchPattern;this.onUpdateSearchParams(I);var J={success:function(K){var L=K.items||K.es||[];L=[L,K.totalSize||K.sz||0,K.blockBegin||K.bb];mstrmojo.all[H.id].searchCache[H.rootID][(I.searchPattern.length==0?H.rootID:H.buildIndex(I.searchPattern))]=L;H._notifyContentWidget(L);},failure:function(K){if(H.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+K.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(H.spinnerNode){H.spinnerNode.style.display="none";}if(H.postFetch){H.postFetch();}}};this.serverRequest(I,J);},fetchPage:function(H){this.blockBegin=H*this.blockCount+1;this.fetch();},filterCache:function(J,M,I){var H=M&&M[I?this.rootID:this.buildIndex(J)];if(H){return H;}var K=this.token[this.taskId];if(K.test(J)||this.totalSize>this.blockCount){return null;}var O=J.replace(/.$/,"");H=M&&M[this.buildIndex(O)];while(H===undefined&&(O=O.replace(/.$/,"")).length>0){H=M&&M[this.buildIndex(O)];}if(H!==undefined){if(H[1]>this.blockCount){return null;}var L=H[0],N=[];G.forEach(L,function(P){if(P.n.search(new RegExp(J,this.matchCase?"":"i"))>-1){N.push(P);}});this.totalSize=N.length;return(M[this.buildIndex(J)]=[N,N.length,this.blockBegin].concat());}return null;},buildIndex:function(H){if(H.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?H.toUpperCase():H+"::0";},init:function(H){if(this._super){this._super(H);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.css");var G=mstrmojo.css,E={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"},C="sbClear",K="sbSearch";mstrmojo.SearchWidget=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchWidget",quickSearch:false,placeholderText:"",markupString:'<table id={@id} cellspacing="0" cellpadding="0" class="mstrmojo-SearchWidget mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" placeholder="{@placeholderText}" mstrAttach:keyup,blur/></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}'+C+'" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}'+K+'" mstrAttach:click ></div></div></td></tr></table>',markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;},searchNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},markupMethods:{onquickSearchChange:function(){G.toggleClass(this.domNode,"quick-search",this.quickSearch);},onwidthChange:function(){if(this.inputNode&&this.inputNode.style&&this.inputNode.style.width){this.inputNode.style.width=this.width;}}},clearNode:null,searchNode:null,onsearch:mstrmojo.emptyFn,onclear:mstrmojo.emptyFn,prekeyup:function J(M){var L=M.hWin,Q=M.e||L.event;var O=this.getSearchPattern(),N=(O.length===0),P=this.quickSearch;G.toggleClass(this.clearNode,"show",!N&&!P);G.toggleClass(this.searchNode,"clear",!N&&P);if(P){this[N?"clearSearch":"onsearch"](O);}var R=E[Q.keyCode];if(this["on"+R]){this["on"+R](M);}},onEnter:function B(L){this.onsearch(this.getSearchPattern());},onEsc:function A(L){this.clearSearch();},getSearchPattern:function H(){return mstrmojo.string.trim(this.inputNode.value);},preclick:function F(L){var N=L.getTarget(),M=N&&N.id;switch(M.replace(this.id,"")){case K:if(this.quickSearch){this.clearSearch();}else{this.onsearch(this.getSearchPattern());}break;case C:this.clearSearch();break;}},clearSearch:function I(){var L=this.getSearchPattern();this.reset();this.onclear(L);},reset:function D(){this.inputNode.value="";G.removeClass(this.clearNode,"show");G.removeClass(this.searchNode,"clear");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var C=mstrmojo.css,A=mstrmojo.dom,F=mstrmojo.string,E=function(H){this._super&&this._super(H);A.stopPropogation(H.hWin,H.e);},G=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.DynamicNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.fe.DynamicNode",markupString:'<div id="{@id}" class="mstrmojo-dynamic {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-dynamic-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-dynamic-prefix-text"  mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">'+G+'<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-onhoverparent mstrmojo-dynamicNode" title="'+mstrmojo.desc(13229,"Add this condition to the target list of a selector.")+'"><span class="mstrmojo-dynamicNode-info"><span class="mstrmojo-textset"></span></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" ></img></span><span class="mstrmojo-textset mstrmojo-rename-text" mstrAttach:click >'+mstrmojo.desc(1388,"Rename")+"</span>"+G+"</div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},dynamicNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.lastChild.firstChild.lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},createSetNode:function(){return this.domNode.lastChild.lastChild;},renameNode:function(){return this.domNode.lastChild.childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.dynamicNode,["selected"],this.selected);},onisEditingChange:function(){C.toggleClass(this.domNode,["renaming"],this.isEditing);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=this.data.ph.n;},onglowChange:function(){var H=this;C.toggleClass(H.dynamicNode,["glow"],this.glow);if(this.glow){setTimeout(function(){C.toggleClass(H.dynamicNode,["glow"],false);H.glow=false;},1000);}},onnoRelationOperatorChange:function(){C.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){C.toggleClass(this.dynamicNode,["noRelation"],this.noRelation);}},editableSlot:"textNode",editButtonSlot:"renameNode",init:function(H){var J=H.data;if(J){var I=H.tree.nameFactory;if(J.ph.n){I.setName(J.ph.n,this);}else{J.ph.n=I.getNewName(this,mstrmojo.desc(12033,"Dynamic Condition")+" ");}}this._super(H);},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;this.text=H.ph.n;}return J;},preclick:function D(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.createSetOptNode,I,true)&&!this.noRelationOperator&&!this.noRelation){J="createSetOpt";}else{if(A.contains(this.createSetNode,I,true)&&!this.noRelation){J="createSet";}else{if(A.contains(this.renameNode,I,true)){this.set("isEditing",true);}}}}H.part=J;},isEmpty:function(){var I=this.data,H=I&&I.ph;return !(H&&H.n);},del:function B(){var I=this.parent,H=this.tree.nameFactory;if(I&&I.remove&&this.data){I.remove(this.data);H.removeName(this.data.ph.n);}},onkeyup:E,onkeydown:E,onTextEditComplete:function(){var J=this.tree,K=J.nameFactory,H=F.trim(this.text||""),I=this.data.ph.n;if(H&&H!==I){if(K.isNameExist(H)){K.names[H].set("glow",true);this.set("isEditing",true);}else{K.changeName(I,H,this);this.data.ph.n=H;}}},isSelectableArea:function(H){return mstrmojo.dom.contains(this.dynamicNode,H,true);},avatarCssCls:"mstrmojo-FE mstrmojo-dynamicNode",getAvatarNode:function(){return this.dynamicNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var F=mstrmojo.dom,K=mstrmojo.css,N=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var U=document.createElement("tr"),V=this.data,Y=this._cmSource,R,S;U.id=this.id;U.className="mstrmojo-ContextMenuItem "+(Y.isSeparatorItem(V)?"separator":Y.item2textCss(V));var W=this,X=function(){W.handleMouseOver();},T=function(){W.handleMouseOut();},Q=function(){W.handleClick();};F.attachEvent(U,"mouseover",X);F.attachEvent(U,"mouseout",T);F.attachEvent(U,"click",Q);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-text";if(Y.isSeparatorItem(V)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=V.itemWidget?"&nbsp":V[this.itemField];}R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return U;},buildRendering:function L(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){K.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){K.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=F.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function B(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function D(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function M(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function P(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,T=this._subMenu.domNode,S=T.offsetHeight,R=T.offsetWidth,W=F.windowDim(),V=F.position(T,false),U=F.position(T,true);if((V.x+R+N)>W.w){Q.set("left",(F.position(this.domNode,true).x-R)+"px");}if((V.y+S+N)>W.h){Q.set("top",(W.h-S-N+(U.y-V.y))+"px");}},handleMouseOver:function O(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function C(){this._cmSource.closeMenuTree();},handleClick:function E(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.threshold.ThresholdModel","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel");var I=mstrmojo,E=mstrmojo.chart.model.enums.EnumDSSObjectType,F=1,C=["#97D2FC","#62B4EE","#2798EB","#2387CF","#1F77B4"],G=[0.2,0.4,0.6,0.8],B=I.models.FormatModel,H=B.ENUM_PROPERTY_NAMES;function D(L,K,M,N){K.reverse().forEach(function(O){N.push(L.getClearThresholdAction(M.did,M.t||E.DssTypeMetric,O.tid));});}mstrmojo.vi.util.ThresholdUtils=mstrmojo.provide("mstrmojo.vi.util.ThresholdUtils",{addClearAllThresholdsActions:function J(K,M,Q){var P=M.data.gsi,L=P.mx,N=P.thresholds,O;if(N){L.forEach(function(R){O=N[R.did];if(O){D(K,O,R,Q);}});P.thresholds={};}},addThresholds:function A(S,X,N,R,P,K,L,O){var Q,U=[],T=new mstrmojo.threshold.ThresholdModel({data:N.data}),V=T.data.gsi.thresholds,M=V&&V[R.did];P=P||[];if(!M||O){K=K||C;L=L||G;for(Q=0;Q<K.length;Q++){var W={};W.fmt=B.getFormatUpdate(H.BACKGROUND_COLOR,K[Q]);B.getFormatUpdate(H.FILL_STYLE,0,W.fmt);if(Q>0){W.flr=T.getRealValue(L[Q-1],F);}if(Q<L.length){W.ceil=T.getRealValue(L[Q],F);}U.push(W);}if(M){D(S,M,R,P);}P.push(S.getCreateSimpleThresholdAction(U,X.k,R.did,F,null,4));}T.destroy();return P;}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.boxmodel","mstrmojo.string","mstrmojo.DocDataService");var E=mstrmojo,D=E.boxmodel,H=mstrmojo.string,F=E.EnumRWUnitType,I=E.DocDataService.REQUEST_DEFN_DATA;function C(N,M,L){(L.children||[]).forEach(function(O){C(N,M,O);});var K=N.indexOf(L.k);if(K!==-1){L.k=M[K];}}mstrmojo.vi.models._PanelActions=mstrmojo.provide("mstrmojo.vi.models._PanelActions",{_mixinName:"mstrmojo.vi.models._PanelActions",addPanel:function(R,N){var M=N.builder,L=this.createNewUnitNode(null,function(S){S.t=F.PANEL;return S;}),Q=L.k,P=N.k,O=this.id,K=M.build([L],this,{pk:P})[0];N.addChildren([K],null,false,true);N.doLayout();K.boxLayoutConfig.useDefaultBox([]);R.add([{act:"addPanel",nodeKey:Q,parentKey:P,index:0}],{success:function(T){var S=mstrmojo.all[O];S.partialUpdate(T.data,S.getUnitDefinitions(Q),T.defn);L.defn=S.getUnitDefinitions(Q)[Q];K.defn=L.defn;K.node.defn=L.defn;}},I);return K;},selectNewPanel:function(L,K){L.add([{act:"setCurrentPanel",unitKey:K}],{success:function(){var M=this.getPanel(K);M.parent.selectPanel(K,null,true);}.bind(this)});},duplicatePanel:function J(K,T,R,L){var W=this.createNewUnitNode(null,function(X){X.t=F.PANEL;return X;}),M=W.k,O=K.k,V=T.k,N=this.id,S=mstrmojo.desc(11450,"## copy ###"),Q=[{act:"duplicatePanel",nodeKey:O,parentKey:V,duplicateKey:S.replace("###",K.numDupl===0?"":K.numDupl).replace("##",K.titleText),newKey:M},{act:"setCurrentPanel",unitKey:M}],P;var U=this.getDataService();this.execute({execute:function(){var X=this,Y=U.newUpdate(X,{actions:Q,extras:I,callback:{success:function(a){var Z=mstrmojo.all[N];Z.partialUpdate(a.data,Z.getUnitDefinitions(a.pukeys||M),a.defn);W.defn=Z.getUnitDefinitions(M)[M];var b=R.build([W],Z,{pk:V});P=b[0];T.addChildren(b);if(P.defn.layoutXML){C.call(this,K.getTargetKeysExcludingTypes(),P.getTargetKeysExcludingTypes(),W.defn.layoutXML);}K.numDupl=K.numDupl+1;T.selectPanel(M,null,true);T.doLayout();Z.getPanel().saveBoxLayout(null,Z.cmdMgr().CMD_PHASE.LAST);}}});Y.submit();},urInfo:{disablePU:true,treesToRender:3,undo:L.undo,redo:L.redo},discard:L.discard});},movePanel:function A(K,M,L,O){var N=this.getDataService();this.execute({execute:function(){this.submit([N.getMoveNodeAction(K,K.parent.k,M),{act:"setCurrentPanel",unitKey:K.k}],{success:function(){O(L,M);}},{params:{suppressData:true}});},urInfo:{silent:true,undo:function(){O(M,L);},redo:function(){O(L,M);}}});},getRemoveUnitAction:function G(K){return{act:"removeUnit",unitKey:K.k,unitType:K.defn.t};},getSetCurrentPanelAction:function B(K){return{act:"setCurrentPanel",unitKey:K.k};}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.func","mstrmojo.DocDataService","mstrmojo.vi.models.EnumFieldTypes");mstrmojo.requiresDescs(1013,2922,4538);var N=mstrmojo.func,H=mstrmojo.EnumRWUnitType,S=mstrmojo.models.FormatModel,D=S.getFormatUpdate,J=S.ENUM_PROPERTY_NAMES,Q="\u001E",I={106:{id:"1013",desc:"Text"},102:{id:"2922",desc:"Image"},107:{id:"4538",desc:"HTML Container"}},C=mstrmojo.vi.models.EnumFieldTypes;function G(U,T,V,W){if(T!==V){return{act:"editField",fieldKey:U.k,fieldType:W,fieldValue:T,nodeKey:U.nk,treeType:1,fieldName:U.defn&&U.defn.n||U.k,partialRetrieval:{nodes:[U.k,U.nk]}};}return undefined;}function P(T){switch(T){case H.TEXTFIELD:case H.IMAGE:case H.HTMLCONTAINER:return mstrmojo.desc(I[T].id,I[T].desc)+this.updateTypeCounter(T);default:return null;}}function A(X,W,Z){var V=H.HTMLCONTAINER,U=X.nk,T=X.k,Y={act:"format",unitType:V,formatType:1,nodeKey:U,fieldKey:T,keyContext:V+Q+U+Q+T,format:{FormattingHTML:{HTMLType:W}},partialRetrieval:{nodes:[T,U]}};Y.format.FormattingHTML[W===1?"HTMLText":"URL"]=Z;return Y;}mstrmojo.vi.models._FieldActions=mstrmojo.provide("mstrmojo.vi.models._FieldActions",{_mixinName:"mstrmojo.vi.models._FieldActions",insertNewField:function B(T){var b=this,Z=b.getVizContentPanel(),d=T.t,U,X=this.id,e=P.call(this,d),Y=b.getVizContentPanel().k,a=b.getNextKey(),c=Z.nk,W=Z.defn.fgk,V;this.execute({execute:function(){var k=b.getDataService(),l=k.newUpdate(this,{extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA});var h=b.createNewUnitNode(function(m){m.v=T.v;return m;},function(m){m.t=d;m.n=e||a;return m;},function(m){U=Z.defn.fgk||Z.nk;m.nk=a=U||mstrmojo.all[X].getNextKey();return m;});var g=b.createUnit(h,Y);V=g.k;g.nk=Z.nk=a;var f=function(m){m.fieldKey=V;m.fieldType=T.ft;m.nodeKey=a;m.treeType=1;m.fieldName=e||a;m.partialRetrieval={nodes:[a]};return m;};l.addActions([f({act:"addField",createNode:!U,nodeKeyParent:Z.k}),f({act:"editField",fieldValue:T.v})]);if(T.getAdditionalActions){l.addActions(T.getAdditionalActions(g)||[]);}b.deferredInsertUnit(l,g,Y);this.submitUpdate(l);},urInfo:{treesToRender:3,undo:function(){var g=b.getVizContentPanel();g.nk=c;g.defn.fgk=W;var f=g.getUnitByKey(V);f.defn._isDeleted=true;f.undoInsert();delete this.callback;return true;},redo:function(){var g=b.createNewUnitNode(function(l){l.v=T.v;return l;},function(l){l.t=d;l.n=e||a;return l;},function(l){l.nk=a;return l;},V);var f=b.createUnit(g,Y);f.nk=b.getVizContentPanel().nk=a;var h=b.getDataService(),k=h.newUpdate(this,{extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA});b.deferredInsertUnit(k,f,Y);if(this.urInfo){this.urInfo.callback=k.callback;}this.callback=k.callback;return false;}}});},insertNewText:function K(){var T=H.TEXTFIELD;this.insertNewField({v:"",t:T,ft:C.TEXT,getAdditionalActions:function U(W){var X=W.k,V=W.nk;return[{act:"format",unitKey:X,unitType:T,formatType:1,fieldKey:X,nodeKey:V,keyContext:T+Q+V+Q+X,format:{FormattingSize:{TextOverflow:1}}}];}});},editField:function O(d,Y,e,a,U,T){var c=this,X=(T&&T.actions)||[],Z=T&&T.callback,W,V=T&&T.extras,b=d.k;W=G.call(c,d,a,U,Y);if(W){X.push(W);}this.execute({execute:function(){this.submit(X,N.wrapMethods(Z,{success:function(f){if(Y===C.IMAGE&&d.defn.oid){delete d.defn.oid;}c.partialUpdate(f.data,c.getTargetDefn(d.k),f.defn,[b]);c.selectVIUnit(d.id);if(e&&e.success){e.success(f);}},failure:function(){if(e&&e.fail){e.fail();}}}),V);}});},getRemoveFieldUpdate:function F(T){return this.getDataService().newUpdate(null,{actions:[{act:"removeField",treeType:"1",nodeKey:T.nk,fieldKey:T.k}]});},editLink:function E(T,Y,U,X){var V=this.getUnitFormatAction(T,1,{FormattingNavigation:{Hyperlinks:U}});var W=this.getDataService();this.execute({execute:function(){var Z=this,a=W.newUpdate(Z,{actions:[V],callback:X});a.submit();},urInfo:{silent:true,undo:X.undo,redo:X.redo}});},editHtmlContainer:function R(V,U,X,Z){var Y=this.id,W=mstrmojo.DocDataService,T={callback:mstrmojo.DocDataService.EMPTY_CALLBACK,undo:Z.undo,redo:Z.redo};if(U!==1){T.extras=W.SUPPRESS_DATA;}this.execute({execute:function(){var b=mstrmojo.all[Y],d=b.getDataService(),c=(U!==1?{extras:W.SUPPRESS_DATA}:null),e=d.newUpdate(this,c),a=V.k;e.addActions([A(V,U,X)]);e.addCallbacks(N.wrapMethods(Z,{success:function(f){b.partialUpdate(f.data,b.getTargetDefn(a),f.defn);}}));this.submitUpdate(e);},urInfo:T});},insertNewImage:function M(){this.insertNewField({v:"",t:H.IMAGE,ft:C.IMAGE,getAdditionalActions:function T(U){var V=U.model.getUnitFormatAction;return[V(U,1,D(J.IMAGE_HEIGHT,0),true),V(U,1,D(J.IMAGE_WIDTH,0),true)];}});},insertNewHtmlContainer:function L(){this.insertNewField({v:"",t:H.HTMLCONTAINER,ft:C.HTML_CONTAINER});}});}());(function(){mstrmojo.requiresCls("mstrmojo.util.ui._HostsSplitter","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.css");var b=mstrmojo.array,S=mstrmojo.hash,C=mstrmojo.css,Q=mstrmojo.dom,g=mstrmojo.models.FormatModel,m=g.getFormatUpdate,c=g.ENUM_PROPERTY_NAMES,J={h:{dimension:{shared:"width",full:"height"},position:{shared:"left",full:"top"}},v:{dimension:{shared:"height",full:"width"},position:{shared:"top",full:"left"}}},M=mstrmojo.DocDataService.SUPPRESS_DATA;mstrmojo.vi.ui.BoxLayoutDimensionsType=null;function I(v){var u=S.copy(v);var t="px";u.left=Math.max(u.left,0)+t;u.top=Math.max(u.top,0)+t;u.height=Math.max(u.height,0)+t;u.width=Math.max(u.width,0)+t;return u;}function p(v,z,x,u){var AA=J[v].dimension,t=J[v].position,w={};w[AA.shared]=z;w[AA.full]=x[AA.full];w[t.shared]=u;w[t.full]=x[t.full];return w;}function N(t,AA,x,z){var w=t==="v"?"h":"v",v=[],u=function(AB){if(AB===t){return v.reduce(function(AC,AD){return AC+AD[t];},0);}return Math.max.apply(null,v.map(function(AC){return AC[w];}));};AA.forEach(function(AB,AC){var AD={};if(AB.t===this.componentType){AD=mstrmojo.vi.ui.BoxLayoutConfig.getMinimumChildSizes(AB,t,z);}else{AD=N.call(this,AB.o,AB.children,x,z);}if(AC!==AA.length-1){AD[t]+=x;}v.push(AD);},this);return{sizes:v.map(function(AB){return AB[t];}),v:u("v"),h:u("h")};}function e(u,AJ,z,AD,AL){var t=N.call(this,u,AJ,AD,AL),AH=z[J[u].dimension.shared],AG=AH,AB=AJ.length-1,x=0,AA=function(AO,AN){return AN===AB?AO:AO+AD;},v=0,w={},AM={},AF=false,AC=function(AO){var AN=this.getUnitByKey&&this.getUnitByKey(AO);return AN&&AN.height&&parseInt(AN.height,10)||0;};AJ.forEach(function(AP,AN){var AO=parseFloat(AP.l);if(AP.f){AH-=AA(AO,AN);}else{x+=AO;}});if(x>100){AF=true;}AJ.forEach(function(AO,AN){var AQ=AO.l;if(AO.f){w[AN]=AA(AQ,AN);return ;}var AP=AF&&AO.type===this.componentType?AC.call(this,AO.k):Math.round(AH*(AQ/x)),AR=t.sizes[AN];if(AR>AP){w[AN]=AR;v+=AR-AP;return ;}AM[AN]={c:AP,m:AR};}.bind(this));if(v){var AE=function(){var AP=Object.keys(AM),AO=v/AP.length,AN=true;AP.forEach(function(AQ){var AR=AM[AQ];if(AR.m>AR.c-AO){w[AQ]=AR.m;v-=AR.c-AR.m;AN=false;delete AM[AQ];}});if(AN){AP.forEach(function(AQ){w[AQ]=AM[AQ].c-AO;});AM={};return ;}AE();};AE();}Object.keys(AM).forEach(function(AN){w[AN]=AM[AN].c;});var AI=Object.keys(w).sort().map(function(AO,AN){return w[AO]-(AN<AB?AD:0);}),AK=AG-AI.reduce(b.fnReduceNumber,0)-(AB*AD);if(AK!==0){AI[AB]+=AK;}return AI;}var K=document.createElement("div");K.setAttribute("unselectable","on");K.className="splitter";mstrmojo.vi.ui._HasBoxLayout=mstrmojo.provide("mstrmojo.vi.ui._HasBoxLayout",{_mixinName:"mstrmojo.vi.ui._HasBoxLayout",boxType:"b",componentType:"c",boxLayoutConfig:null,firstBoxId:null,splitterCache:null,isInteractive:true,allowPanelEdgeTargeting:false,postBuildBoxLayout:mstrmojo.emptyFn,getBoxLayoutSaveAction:function T(t,u){return this.model.getUnitFormatAction(this,1,m(c.LAYOUT_XML,t),u);},getBoxLayoutSaveCallback:function f(){return null;},getChildPositionActions:function F(t){return[];},saveBoxLayout:function a(t,AC,AE,x,z,u){var AB=this.boxLayoutConfig,AA=this.model,AD=AA.getDataService(),w=[].concat(this.getBoxLayoutSaveAction(AB.getBoxState(),z)).concat(this.getChildPositionActions(z)),v=S.copy(u,S.copy(M,{preserveUndo:true}));AE=AE||{success:mstrmojo.emptyFn};if(!x){if(t){t.submit(w,AE,v,AC);}else{AD.submitUpdates(w,AE,v);}}else{x.add(w,AE);}},buildBoxLayout:function L(v,z){var x=this.boxLayoutConfig;if(!x||(this.height===undefined&&this.width===undefined)){return ;}if(z){x.box=z;}var AA=this.splitterCache=this.splitterCache||[],u={height:parseInt(this.height,10),width:parseInt(this.width,10),top:0,left:0},AC=this.calculateBoxLayout(x,u),AH=AC.box,AD=AC.splitter,AF=this.getSplitterHost(),AE=x.identifier,w=this.children,AB=x.boxPaths={};this.firstBoxId=null;Object.keys(AH).forEach(function(AJ){var AK=w[b.find(w,AE,AJ)];if(AK){var AI=AH[AJ],AL=AK.id;if(AI.first){this.firstBoxId=AL;}AI.boxChild.id=AL;AB[AJ]=AI.boxLevel;AK.updateLayout(AI.dim,v);}},this);AD.forEach(function(AM,AK){var AI=AM.dim;var AL=AA[AK];if(!AL){AL=AA[AK]=K.cloneNode(false);this.registerSplitter(AL);}AL.path=AM.boxLevel;AL.orientation=AM.orientation;var AJ=AL.style;S.copy(I(AI),AJ);AJ.display="block";C.toggleClass(AL,"v",AM.orientation==="h");if(!AL.parentNode){AF.appendChild(AL);}},this);AA.slice(AD.length).forEach(function(AI){AI.style.display="none";});var AG=AF.style,t=AC.size;AG.height=t.height+"px";AG.width=t.width+"px";if(this.updateScrollbars){this.updateScrollbars();}this.postBuildBoxLayout();delete x.dirty;},calculateBoxLayout:function P(u,AA){var z=u.padding||0,x=[],AC={},t=[];var w=function(AM,AD,AE){var AF=AM.o,AJ=J[AF].dimension,AL=J[AF].position,AG=AJ.shared,AH=AL.shared,AO=AD[AH],AN=AM.children,AK=AN.length-1,AI=e.call(this,AF,AN,AD,z,u);if(x.length===AE){x[AE]=-1;}AN.forEach(function(AQ,AS){var AU=AQ.t,AV=AI[AS],AT=p.call(this,AF,AV,AD,AO);AQ.h=AT.height;AQ.w=AT.width;x[AE]=x[AE]+1;var AR=x.join("|");if(AU===this.componentType){AC[AQ[u.identifier]]={boxLevel:AR,boxChild:AQ,dim:I(AT),first:(AT.top===0&&AT.left===0)};}else{if(AU===this.boxType){w.call(this,AQ,AT,AE+1);x.splice(AE+1);}}if(this.isInteractive&&!AQ.r&&AS<AK){var AP=(JSON.parse(JSON.stringify(AT)));AP[AH]+=AV;AP[AG]=z;t.push({boxLevel:AR,dim:AP,orientation:AF});}AO+=AV+z;},this);};var v=u.box||u.useDefaultBox(this.children),AB=N.call(this,v.o,v.children,z,u);AA.height=Math.max(AA.height,AB.v);AA.width=Math.max(AA.width,AB.h);w.call(this,v,AA,0);return{box:AC,splitter:t,size:{height:AA.height,width:AA.width}};},updateBoxPaths:function q(){var v=[],u=this.boxLayoutConfig,w=this.boxLayoutConfig.boxPaths={};var t=function(x,z){if(v.length===z){v[z]=-1;}x.children.forEach(function(AA){var AC=AA.t;v[z]=v[z]+1;var AB=v.join("|");if(AC===this.componentType){w[AA[u.identifier]]=AB;}else{if(AC===this.boxType){t.call(this,AA,z+1);v.splice(z+1);}}},this);};t.call(this,u.box,0);},getBoxLayoutChild:function V(t){var u=t.id;if(u){return mstrmojo.all[u];}return null;},setDimensions:function k(v,t){if(this.height!==v||this.width!==t){this.height=v;this.width=t;if(this.hasRendered){var u=this.domNode.style;u.height=v;u.width=t;}this.buildBoxLayout();}},onAppStateChange:function d(t){this.isInteractive=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION!==t.value;},getSplitterInfo:function o(v){var x=v.path,u=v.orientation,t=this.boxLayoutConfig.getResizeBoundaries(x,u),w=parseInt(u==="v"?this.height:this.width,10);return{path:x,min:t.min,max:w-t.max};},shouldSaveSplitterMoves:function D(){return true;},splitterMoved:function R(t,AA){var x=this,u=x.boxLayoutConfig,w=x.model,z=mstrmojo.DocDataService,v=function(AB){u.resizeBox(AA.path,t);x.buildBoxLayout();x.saveBoxLayout(AB);};if(this.shouldSaveSplitterMoves()){w.execute({execute:function(){v(this);},urInfo:{callback:z.EMPTY_CALLBACK,extras:z.SUPPRESS_DATA}});}else{v();}},insertNewBox:function E(w,u,v,x){var t=this.boxLayoutConfig;if(x){x.oldBoxState=t.getBoxState();}if(u){t.addDropBox(u,v,{box:{boxId:w.id}});}else{t.insertNewRootChild(w,v);this.buildBoxLayout(true);}},insertNewBoxAndSaveDeferred:function(z,v,w,x,t,u){this.insertNewBox(v,t,u);this.saveBoxLayout(undefined,-1,x,z);},deleteBoxAndSubmitDeferred:function(x,u,w,v,t){this.deleteBox(u,t);this.saveBoxLayout(undefined,-1,w,x,v);},deleteBox:function W(t,u){this.boxLayoutConfig.deleteBox(t,u);this.removeChildren(t);},deleteBoxAndSubmit:function n(u,x,t){var w=this.model.getDataService(),v=this;this.model.execute({execute:function(){var z=this,AA=w.newUpdate(z,x);v.deleteBoxAndSubmitDeferred(AA,u);AA.addExtras(S.copy(M,t));AA.submit();}});},getBoxOrientation:function O(t){var u=this.boxLayoutConfig;return u.getBoxOrientation(u.getBoxPath(t));},hasBoxLayoutChild:function h(v){var t=this.boxLayoutConfig,x=t.identifier,w=v[x],u=function(z){if(!z){return false;}if(z.t===this.componentType){return z[x]===w;}return(z.children||[]).some(u);}.bind(this);return v.parent===this&&u(t.box);},beginBoxMove:function U(u,t,v){this.boxLayoutConfig.beginBoxMove(u,t,v);},dropBox:function Z(w,u,z,AA){var v=this.getPanelTargetEdge(w),t=this,x=this.boxLayoutConfig;if(v){x.insertExistingRootChild(w,v.substr(1));}else{x.addDropBox(u,z,w);}t.buildBoxLayout();if(AA){this.saveBoxLayout();}},cancelBoxMove:function Y(t){var u=t.src.widget;if(!u.cancelBoxMove(t)){this.boxLayoutConfig.cancelBoxMove(t);}},endBoxMove:mstrmojo.emptyFn,getPanelTargetEdge:function r(v){if(!this.allowPanelEdgeTargeting){return"";}var z=v.panelPos;if(!z){var t=Q.position(this.domNode);z=v.panelPos={p:t,q:{Top:t.y,Right:t.x+t.w,Bottom:t.y+t.h,Left:t.x}};}var x=v.tgt.pos,w=mstrmojo.boxmodel.getEdgeQuadrantByPoint(z.p,x),u=w==="Left"||w==="Right"?x.x:x.y;return Math.abs(z.q[w]-u)<=12?"p"+w:"";},updateDropCue:function H(z,w,x){var v=this._dropCue;if(!v){v=this._dropCue=document.body.appendChild(document.createElement("div"));v.className="mstrmojo-vi-hbl-cue";}var AA=v.style;if(z===""){AA.display="none";AA.top="-10000px";return ;}if(z.charAt(0)==="p"){z=z.substr(1);x=w.panelPos.p;}var u=z==="All",t={top:x.y-3,left:x.x-3,height:x.h+6,width:x.w+6};if(!u){var AB=true;if(z==="Bottom"){t.top=x.y+x.h+1;}else{if(z==="Right"){t.left=x.x+x.w+1;AB=false;}else{AB=z==="Top";}}t[AB?"height":"width"]=2;}C.toggleClass(v,"all",u);AA.cssText=Object.keys(t).map(function(AC){return AC+":"+t[AC]+"px";}).join(";");AA.display="block";},unrender:function B(u){var t=this._dropCue;if(t){t.parentNode.removeChild(t);delete this._dropCue;}return this._super(u);},getSplitterHost:function A(){throw new Error(this.scriptClass+" must implement getSplitterHost.");},getBoxState:function X(){return this.boxLayoutConfig.getBoxState();},restoreBoxState:function l(t){this.boxLayoutConfig.revertBoxState(t);}});var G=mstrmojo.vi.ui._HasBoxLayout;S.forEach(mstrmojo.util.ui._HostsSplitter,function(u,t){if(!G.hasOwnProperty(t)){G[t]=u;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.DocDataService");mstrmojo.requiresDescs(5421,5422);var P=mstrmojo.hash,L=mstrmojo.array,F=mstrmojo.desc,G=mstrmojo.DocDataService,B=mstrmojo.string;function K(f,g,c,Y){var h=f.selCells,d=[],b=f.model.getCellTitleInfo(g).title,e,a,Z=function(k){var l=f.getCellForNode(k);d.push(f.getCellUnitIndex(l));e=l.dpt;},X;if(typeof Y==="string"&&Y.indexOf(";")>0){a=parseInt(Y.substring(Y.indexOf(";")+1),10);Y=parseInt(Y.substring(0,Y.indexOf(";")),10);}if(a===1&&!c){h.reverse().forEach(Z);}else{if(a===1){X=1;h.forEach(Z);}else{h.forEach(Z);}}return{oId:b.id,oTp:b.otp,depth:e,ordinals:d.join(","),sliceId:f.sid,viewKey:f.k,funcVal:Y,switchOrder:X};}function C(Z,Y,b){var e=Z.getDEInfo(Y),d=e&&e.deObject&&e.deObject.des,c=1,a=b===-1?F(5187,"Group"):F(5188,"Calculation"),X=function(f){return f.n===a+" "+c;};while(true&&d){if(d.some(X)){c++;}else{break;}}Z.controller.onAddQuickDE(Z,P.copy(K(Z,Y,false,b),{act:"addQuickDE",deName:a+" "+c}));}function W(X,Y){for(did in X){if(L.find(X[did].att,"did",Y)>-1){return did;}}return undefined;}function A(k,Y,f,b,X){var e=f.es,Z=f.id,d;X.forEach(function(l){d=l[0];if(d.eid.indexOf(Z)<0){e.push({n:B.decodeHtmlString(d.v,true),t:mstrmojo.vi.enums.EnumDerivedElementType.LIST,v:d.eid.split(";")[0].slice(1)});}});var a=k.controller,h=k.model&&k.model.docModel,g=a._getXtabCallback(k),c={act:"applyDEChanges",deId:Y.did,attId:Y.attId,attName:Y.attName,dsId:Y.dsId,k:k&&k.k,actions:[U(f,b)]};h.addUpdateObjects(c,{id:c.deId||c.attId,type:47,flag:G.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});g=mstrmojo.func.wrapMethods(g,h.getDatasetsUpdateCallback(),{success:function(){h.callOnNDECreated([f]);}});a.submitUndoRedoUpdates(c,{},g);}function U(Y,X){return{act:"update",position:X+1,item:Y};}function E(Z,Y,c,b,a){var X=Z.model.getCellTitleInfo(Y).title;Z.controller.onSetDEHierachyOptions(Z,{act:"setDEHierarchyOptions",oId:X.id,eId:c.id,splice:b,expand:a});}function O(b,Y){var X=[],a=Y.t,Z=Y.did;b.getDropZones().zones.forEach(function(c){((c&&c.items)||[]).forEach(function(e){var f=e.t,d=e.did;if(f!==21&&d!=="-1"&&d!=="00000000000000000000000000000000"&&((f===4&&a===4)||(f!==4&&a!==4))&&d!==Z&&L.find(X,"did",d)===-1){X.push(e);}});});b.docModel.getDatasetUnits(a===4?["mx"]:["att"]).forEach(function(c){if(L.find(X,"did",c.did)===-1&&c.did!==Z&&!c.hide){X.push(c);}});return mstrmojo.vi.ui.DatasetUnitMenuUtils.getSortedDatasetUnits(X);}mstrmojo.vi.ui.rw._XtabDE=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabDE",{scriptClass:"mstrmojo.vi.ui.rw._XtabDE",derivedElementGroup:function M(X){C(this,X,-1);},addElementsToGroup:function N(Z,a,Y,X){A(this,Z,a,Y,X);},derivedElementCalculation:function D(Y,X){C(this,Y,X);},separateOthers:function Q(X,Y){E(this,X,Y,1,1);},renameDEList:function I(X){this.controller.onEditQuickDEList(this,P.copy(K(this,X,true,-1),{act:"editQuickDEList",deName:X.v}));},editQuickDECalculationNumberFormat:function J(Y,Z){var X=K(this,Y);X.deId=Z.de.id;X.act="editQuickDECalculationNumberFormat";this.controller.editQuickDECalculationNumberFormat(this,P.copy(X,this.model.docModel.createNumberFormatParams(Z)));},editDECalculation:function H(Y,X){if(X!==undefined&&X!==null){this.controller.editQuickDECalculation(this,P.copy(K(this,Y,true,X),{act:"editQuickDECalculation"}));}else{this.controller.onEditQuickDECalculation(this,P.copy(K(this,Y,true),{act:"editQuickDECalculation",deName:Y.v}));}},removeQuickDE:function S(d,h){var a=h&&h.deObject,b=(a&&a.des)||[],k=this,m=2,g=L.filter(b,function(n){return !n.ido;},{max:m+1}),l={success:function(p){var q=k.controller.view.getLayouts(),n=q.length,o;for(o=0;o<n;o++){k.controller.model.data.layouts[o].loaded=false;q[o].defn.loaded=false;}}};if(a&&(b.length<=m||g.length<=m)){var c=[],f=this.zonesModel.getZoneForObject(a.did),Z=O(this.zonesModel,a),Y=L.find(Z,"did",a.attId),X=Y>=0?Z[Y]:null,e={};if(X&&f){c.push(this.model.getAddTemplateUnitAction(X,a.dsId,f.id,L.find(f.items,"dsId",a.dsId)));c=[this.zonesModel.getUpdateTemplateAction(c)];e=this.controller._getXtabCallback(this);}c.push({act:"removeNDEFromDS",dsid:a.dsId,oid:a.did,partialRetrieval:{nodes:this.model.docModel.getSourceFilterKeys(this.zonesModel.getHost().k)}});e=mstrmojo.func.wrapMethods(e,this.controller.model.getDatasetsUpdateCallback(),this.controller.getReloadLayoutViewCallback(),l);this.controller.submitUndoRedoUpdates(c,null,e,G.REQUEST_DEFN_DATA);}else{this.controller.removeQuickDE(this,P.copy(K(this,d),{act:"removeQuickDE"}));}},derivedElementsEdit:function T(f,a){if(!a){a=this.getDEInfo(f);}var b=this.model,Y=b.getCellTitleInfo(f).title,Z=a&&a.deObject,e=a&&a.de,X,d,c;if(!Z){X=this.gridData.datasetId||W(b.docModel.datasets,Y.id);d=Y.id;c=Y.n;}this.controller.openDEEditor(this,{dsId:X,attId:d,attName:c,deObj:Z,elemId:e&&e.id,dispName:f.n});},getDEInfo:function V(Y){var Z=this.model,X=Z.getCellTitleInfo(Y).title,a=Y.dei,b,c;if(X.ost!==12033){return null;}b=Z.docModel.getDEObject(X.id);if(b&&a!==undefined){c=b.des[a];}return{deObject:b,de:c,ttl:X};},getOthersDEInfo:function R(Y){var X;L.forEach(Y.des,function(Z){if(Z.t===4){X=Z;return false;}});return X;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService");mstrmojo.OIVMViewFactory=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.OIVMViewFactory",newDocDataService:function A(B){return new mstrmojo.DocDataService(B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService");var K=mstrmojo,A=K.func,J=K.array,L=K.DocDataService.REQUEST_DEFN_DATA,F=K.mstr.EnumWebAPIErrorCodes;mstrmojo.vi.models._LayoutActions=mstrmojo.provide("mstrmojo.vi.models._LayoutActions",{_mixinName:"mstrmojo.vi.models._LayoutActions",addNewLayout:function I(Q,O,P){var M=this,N={act:"addLayout",nodeKey:O.nodeKey,newPanelKey:O.newPanelKey,analysisSectionType:O.analysisSectionType,index:O.index,disablePU:true};Q.add(N,A.wrapMethods({success:function(R){M.replaceLayout(N.nodeKey,R,true);M.mapLayKeys={newKey:N.nodeKey};}},P),L);},addExistingLayouts:function H(R,P,Q){var M=this,O=[F.E_UNUSED],N={act:"importDashboard",newPanelKey:P.newPanelKey,analysisSectionType:P.analysisSectionType,index:P.index,disablePU:true};R.extras.skipUICmdMgrOnFailure=O;R.extras.config={hideFailureErr:true};R.add(N,A.wrapMethods({success:function(S){if(M.resetKeySeed){M.resetKeySeed(S.keySeed);}M.updateLayouts(S);},failure:function(S,U){var T=function(){M.controller.undo();};mstrmojo.error({longDesc:S.message},T,{onClose:T,title:"Error"});}},M.controller.getUpdateLayoutsCallback()),L);},duplicateLayout:function(Q,O,P){var M=this,N={act:"duplLayout",srcKey:O.srcKey,destKey:O.destKey,name:O.name,index:O.index,disablePU:true};Q.add(N,A.wrapMethods({success:function(U){M.replaceLayout(N.destKey,U,true);M.mapLayKeys={oldKey:N.srcKey,newKey:N.destKey};var R=M.getLayoutDefn(N.srcKey),V=(U.defn&&U.defn.layouts||[]).filter(function(X){return X.k===N.srcKey;})[0],T;for(T in R.units){var W=R.units[T],S=V&&V.units[T];W.pnk=S?S.pnk:W.pnk;W.chdidx=S?S.chdidx:-1;}}},P),L);},moveLayout:function C(N,P){var M=this.defn.layouts,O=this.data.layouts,Q=[M,O];Q.forEach(function(R){R.splice(P,0,R.splice(N,1)[0]);});},getMoveLayoutAction:function B(M,N){return this.getDataService().getMoveNodeAction(this.data.layouts[M],this.defn.root.k,N);},removeLayout:function G(P,S,R){var O=this,N=this.defn.layouts,Q=this.data.layouts,M=J.find(N,"k",P);if(M===-1){throw new Error("Layout with key "+P+" not found.");}R.add({act:"removeLayout",unitKey:P,isCurrent:P===O.currlaykey},A.wrapMethods({success:function(T){N.splice(M,1);Q.splice(M,1);var U=Q[J.find(Q,"k",T.currlaykey)];if(!U||!U.loaded){O.replaceLayout(T.currlaykey,T,true);}}},S));},renameLayout:function E(M,O,N,P){this.updateTitle(O,N,M,M,"title",P);},updateLayouts:function D(O){var S=this,N=false,R=(S.defn&&S.defn.layouts)||[],T=(S.data&&S.data.layouts)||[],Q=(O.defn&&O.defn.layouts)||[],M=(O.data&&O.data.layouts)||[],P=[],U=[];Q.forEach(function(W){var V=mstrmojo.array.find(R,"k",W.k);if(V>=0&&!W.loaded){P.push(R[V]);}else{P.push(W);}});M.forEach(function(W){var V=mstrmojo.array.find(T,"k",W.k);if(V>=0&&!W.loaded){U.push(T[V]);}else{U.push(W);}});if(S.defn){S.defn.layouts=P.length?P:R;}if(S.data){S.data.layouts=U.length?U:T;}(M||Q||[]).forEach(function(V){if(V.loaded){S.replaceLayout(V.k,O,true);N=true;}});if(!N){S.ondefnChange();}return Q.length!==0||M.length!==0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.func","mstrmojo.DocDataService");var R=mstrmojo.hash.copy,c=mstrmojo.array.forEach,m=mstrmojo.func,I=m.wrapMethods;var F=2,U=1,f=1,k=2,a=3;var A={FIRST:1,MIDDLE:2,LAST:3};var l={BUSY:1,INTERIM:2,DONE:3,SILENT:4,CANCELED:5};var S=R(mstrmojo.DocDataService.SUPPRESS_DATA,{preserveUndo:true,config:{silent:true}});function G(){c(this._delayRemovedCmds,function(u){u.discard();});this._delayRemovedCmds=null;}function V(){this.cmds=this.cmds.concat(this._delayRemovedCmds);this._delayRemovedCmds=null;}function J(v){var u=this.cmds,w=this.pos;this._delayRemovedCmds=u.splice(w+1);if(w>=this.size-1){u.shift().discard();}u.push(v);this.pos=u.length-1;}function r(u,v){u.reset();throw new Error(v||"Invalid state.");}mstrmojo.vi.controllers.UICmdMgr=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmdMgr",cmds:null,pos:-1,size:20,_delayRemovedCmds:null,controller:null,dataService:null,model:null,state:U,STATE:{EXECUTING:F,IDLE:U},CMD_PHASE:A,init:function n(u){R(u,this);this.cmds=[];},execute:function d(w){if(this.state===F){r(this);}try{w=R(w,{mgr:this,undoUIState:this.model.getUIState(),action:k});var u=this.curCmd=new mstrmojo.vi.controllers.UICmd(w);J.call(this,u);this.state=F;u.execute();}catch(v){this.reset();throw v;}},getInterimCmd:function B(){if(this.state===F){var u=this.cmds[this.pos];if(u.state===l.INTERIM){return u;}}return null;},undo:function T(w){if(this.canUndo()){this.state=F;try{var u=this.curCmd=this.cmds[this.pos--];u.action=f;u.redoUIState=this.model.getUIState();u.undoRedo(w);}catch(v){this.reset();throw v;}}},redo:function H(){if(this.canRedo()){this.state=F;try{var u=this.curCmd=this.cmds[++this.pos];u.action=a;u.undoUIState=this.model.getUIState();u.undoRedo();}catch(v){this.reset();throw v;}}},onSuccess:function b(u){if(this.state===U){r(this);}if(u!==this.curCmd){r(this,"Wrong command");}this.state=U;G.call(this);this.controller.onCmdMgrChanged();},onFailure:function q(){G.call(this);this.reset();},onCancel:function Z(v,w){this.state=U;var u=!!v.submitCount;if(u){this.undo(w);}else{this.pos--;}this.cmds.pop();v.discard();if(u){G.call(this);}else{V.call(this);}this.controller.onCmdMgrChanged();},reset:function e(){c(this.cmds,function(u){u.discard();});this.cmds.length=0;this.pos=-1;this.state=U;this.controller.onCmdMgrChanged();},resetState:function Y(){this.state=U;},canUndo:function X(){return this.state===U&&this.pos>=0;},canRedo:function L(){return this.state===U&&this.pos<this.cmds.length-1;},onSubmitUpdates:function P(){if(this.state===U){this.cmds.splice(this.pos+1);this.controller.onCmdMgrChanged();}},isUndoRedo:function C(){var u=this.curCmd||{};if(this.state===F&&(u.action===f||u.action===a)){return true;}return false;}});function W(u,w,v){if(w.stid==="undefined"){v.submission=function(AB,x,z){var AC=z.params,AA=JSON.parse(AC.params);AA.actions[0].stid=u.action===f?u.undoStateId:u.redoStateId;AC.params=JSON.stringify(AA);};}return v;}function E(v,AA){var w=v.mgr;AA.disablePU=true;var z=W(v,AA,{success:function x(){v.state=l.DONE;},failure:function u(){w.onFailure();}});v.state=l.SILENT;w.dataService.submitUpdates(AA,z,S);w.onSuccess(v);}function g(AF,AA){var AE=AF.urInfo,AD=AE.puKeys,AK=AE.puObjs,AB=AE.puFilters,AG=AF.mgr,AC=AG.model,AH=AG.dataService;if(AD||AK){if(AD){AA.partialRetrieval={nodes:AD,filters:AB};}if(AK){AC.addUpdateObjects(AA,AK);}}else{AA.disablePU=true;}var x=W(AF,AA,{success:function AJ(){AF.state=l.DONE;AG.onSuccess(AF);AC.restoreUIState(AF.action===f?AF.undoUIState:AF.redoUIState);},failure:function w(){AG.onFailure();},complete:function v(){AG.resetState();}}),u=AE.callback||AC.getRebuildCallback(),AI=I(u,x),z=R(AE.extras);if(AA.act==="undo"&&z!==undefined){z.hideCancel=true;if(AA.killJob){z.message=mstrmojo.desc(14586,"Canceling...");}}AF.state=l.BUSY;AH.submitUpdates(AA,AI,z);}function N(x){var u=x.urInfo,v=x.mgr.model;if(!u.extras){var w=(u.treesToRender!==undefined)?u.treesToRender:x._treesFromRes;if(!u.disablePU&&!x._hasFullUpdate&&(!u.puKeys||!u.puKeys.length)){w=0;u.callback=I(v.getDatasetsUpdateCallback(),u.callback);}u.extras={style:{params:{treesToRender:w}}};}}mstrmojo.vi.controllers.UICmd=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmd",mgr:null,redoStateId:null,undoStateId:null,execute:mstrmojo.getMissingFn(),discard:mstrmojo.emptyFn,action:null,state:l.INTERIM,urInfo:null,getStateValue:function Q(v,u){return this.action===f?u:v;},init:function n(u){R(u,this);this._treesFromRes=0;this.urInfo=this.urInfo||{};this.submitCount=0;},undoRedo:function h(AB){var w=this,z,v=this.urInfo,u=v.silent,AC,x=this.mgr,AA=x.dataService;if(w.action===a){z={act:"redo",stid:w.redoStateId};AC=v.redo;}else{if(w.action===f){z={act:"undo",stid:w.undoStateId,killJob:AB};AC=v.undo;}else{r(this.mgr);}}if(AC){AA.blockRequests=true;try{u=!!AC.call(w)||u;}finally{AA.blockRequests=false;}}if(u){E(w,z);}else{g(w,z);}},submitUpdate:function O(v,u){this.submit(v.actions,v.callback,v.extras,u);},submit:function M(z,AJ,x,AH){var AE=this,AF=AE.mgr,AB=AF.model,AG=AF.dataService,AD=mstrmojo.array.ensureArray(z);AJ=AJ?R(AJ):AB.getRebuildCallback();AE.state=l.BUSY;function AA(AK,AL){return !(AK&&AK[AL]&&AK[AL].length);}if(AE._hasFullUpdate||AD.some(function(AK){return AK.disablePU;})||AD.every(function(AL){var AM=AL.partialRetrieval,AK=AL.partialUpdate;return AA(AM,"nodes")&&AA(AK,"nodes")&&AA(AK,"selectors")&&AA(AK,"objects");})){AE._hasFullUpdate=true;}m.override({submission:function w(){if(AE.submitCount===0){AE.undoStateId=AG.stid;}AE.submitCount++;},success:function AI(AO,AP){if(AE.action!==k){r(AF);}AE.redoStateId=AO.stid;var AN=!AH||AH===A.LAST;if(AN){AE.state=l.DONE;}else{AE.state=l.INTERIM;}var AM=AE.urInfo;if(!AM.disablePU){var AK=AM.puKeys||[],AQ=AO.pukeys&&AO.pukeys.split("\u001E");if(AQ&&AQ.length){AK=AK.concat(AQ);var AL=AM.extraPuKeys;if(AL){AK=AK.concat(AL);delete AM.extraPuKeys;}}if(AK.length){AM.puKeys=AK;}}AE._treesFromRes|=(AO.defn?1:0)|(AO.data?2:0);if(this._super){this._super(AO,AP);}if(AN){AE.completeSubmit();}},failure:function v(AK,AN){var AM=(x&&x.skipUICmdMgrOnFailure)||[],AL=parseInt(AK.code||(AK.getResponseHeader&&AK.getResponseHeader("X-MSTR-TaskErrorCode"),10));if(AM.indexOf(AL)===-1&&AM.indexOf(mstrmojo.mstr.EnumWebAPIErrorCodes.E_UNUSED)===-1){AF.onFailure();}if(this._super){this._super(AK,AN);}},canceled:function AC(AK){if(this._super){this._super(AK);}window.setTimeout(function(){AE.cancel(true);},0);},complete:function u(){if(!AH||AH===A.LAST){AF.resetState();}if(this._super){this._super();}}},AJ);AG.submitUpdates(z,AJ,x);},submitInterim:function p(v,w,u){this.submit(v,w,u,A.MIDDLE);},resetCmdMgrOnComplete:function o(){this._resetMgr=true;},completeSubmit:function K(){var v=this,w=v.mgr,u=w.model;if(!v.completed){v.completed=true;v.state=l.DONE;w.onSuccess(v);N(v);v.redoUIState=u.getUIState();if(v._resetMgr){w.reset();}}},cancel:function D(u){this.state=l.CANCELED;N(this);this.mgr.onCancel(this,u);},submitSilent:function t(w){var z=this,AA=z.mgr,x=AA.model,AB=AA.dataService;z.state=l.SILENT;AA.onSuccess(z);z.redoUIState=x.getUIState();var AC={submission:function v(){z.undoStateId=AB.stid;z.submitCount++;},success:function AD(AE){z.state=l.DONE;z.redoStateId=AE.stid;},failure:function u(){AA.onFailure();}};AB.submitUpdates(w,AC,S);}});mstrmojo.vi.controllers.UICmd.CMD_PHASE=A;mstrmojo.vi.controllers.UICmd.STATES={BUSY:F,IDLE:U};}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.DocDataService");mstrmojo.vi.models.PanelFormatSaver=mstrmojo.provide("mstrmojo.vi.models.PanelFormatSaver",{getPanelSaver:function A(C,B,D){return{saveProperty:function E(G,H){var J=B[G];if(J){if(J.convert){H=mstrmojo.boxmodel.px2Inches(C.getZoomProps(),H);}var I={},F=I[J.set]={};F[J.name]=H;C.updateUnitFormat(D||C.getRootNode(),1,I,undefined,mstrmojo.DocDataService.SUPPRESS_DATA);}}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom");function Z(a,c){if(!mstrmojo.DocInfoWindow){return ;}var b=a;while(b){if(b instanceof mstrmojo.DocInfoWindow){b[c?"registerScrollLock":"releaseScrollLock"](this);break;}b=b.parent;}}var L=mstrmojo.array,C=mstrmojo.dom,P=mstrmojo.hash,W=mstrmojo.css,F="px";var B=false;function K(a,c){if(!mstrmojo.DocInfoWindow){return ;}var b=a;while(b){if(b instanceof mstrmojo.DocInfoWindow){b[c?"registerLock":"releaseLock"](this);this.lockIW=c?b:null;break;}b=b.parent;}}var A=mstrmojo.ui.PopupConfig.ENUM_CORNERS,T=A.TOP_LEFT,R=A.TOP_RIGHT,H=A.BOTTOM_RIGHT,G=A.BOTTOM_LEFT;function I(a){return(a===G||a===T);}function X(a){return(a===R||a===H);}function N(a){return(a===H||a===G);}function Q(a){return(a===R||a===T);}function U(h,c,p,v){var z=p.x,x=p.y,u=p.w||0,l=p.h||0,b=v.w,q=v.h,t=h.alignment,f=t.popup,e=t.host,w=X(e),AA=N(e),r=false,n=false,d=false,o=false;if(I(f)){var g=z+b+(w?u:0);r=c.w<g;}if(Q(f)){var m=x+q+(AA?l:0);n=c.h<m;}if(X(f)){var k=z-b+(w?u:0);d=k<0;}if(N(f)){var a=x-q+(AA?l:0);o=a<0;}return{top:o,bottom:n,left:d,right:r};}function E(b){var a=this.popupConfig;if(a){P.forEach(a.popupHandlers,function(d,e){var c=d[b?"open":"close"];if(c){c.call(mstrmojo.all[e]||c,!!b);}});}}function J(b){var a=this.popupConfig;if(a&&!a.isHostedWithin){var c=this.hostProxy;if(c){c.style.display=b?"":"none";}}}function Y(a){return a!==undefined&&a!==null&&!isNaN(a);}mstrmojo._IsPopup={visible:false,lockIWForScroll:false,disposable:true,opener:null,onOpen:mstrmojo.emptyFn,onClose:mstrmojo.emptyFn,popupConfig:null,hostProxy:undefined,open:function M(c,a){E.call(this,true);if(this.updatePopupConfig){this.updatePopupConfig(a,c);}else{P.forEach(a,function(f,e){this.set(e,f);},this);}var b="popup-mid-render";this.set("opener",c);if(!this.hasRendered){var d=this.visible;this.visible=false;this.render();W.addClass(this.domNode,b);this.set("visible",d);}if(this.nudge){this.domNode.style.top="-10000px";}J.call(this,true);this.set("visible",true);if(this.lockIWForScroll){Z.call(this,this.opener,true);}if(a&&a.lockIW){K.call(this,a.lockIW,true);}if(this.nudge){this.nudge();}this.adjustCornersForPopupOverflow();this.onOpen();W.removeClass(this.domNode,b);},adjustCornersForPopupOverflow:function V(){var m=this.popupConfig;if(!m){return false;}var AK=(m.includeScroll!==undefined)?m.includeScroll:true;var p=m.position||C.position(m.anchorElement||m.hostElement,AK);if(!m.isHostedWithin){var AA=this.hostProxy,t=this.hostProxy=document.createElement("div");document.body.appendChild(t);t.appendChild(this.domNode);if(AA){AA.parentNode.removeChild(AA);}var e=t.style,u={x:"left",y:"top",w:"width"};t.className=m.hostProxyCssClass;e.position="absolute";e.background="none";e.height="0";L.forEach(["x","y","w"],function(AN){var AM=p[AN];if(Y(AM)){e[u[AN]]=AM+F;}});}var AH=m.ENUM_CORNERS,x=AH.BOTTOM_LEFT,k=AH.BOTTOM_RIGHT,h=AH.TOP_RIGHT,AD=AH.TOP_LEFT;var AE=U(m,C.position(document.body),p,C.position(this.domNode)),z=AE.right,q=AE.bottom,d=AE.left,w=AE.top,AC=m.alignment,r=AC.popup,AL=AC.host,g=r,c=AL;if(z||d){if(I(c)){c=Q(c)?h:k;}else{if(X(c)){c=Q(c)?AD:x;}}if(z&&I(g)){g=Q(g)?h:k;}else{if(d&&X(g)){g=Q(g)?AD:x;}}}if(q||w){if(I(c)){c=Q(c)?x:AD;}else{if(X(c)){c=Q(c)?k:h;}}if(q&&Q(g)){g=I(g)?x:k;}else{if(w&&N(g)){g=I(g)?AD:h;}}}if(w||z||q||d){if(B){console.log("Overflow directions: "+JSON.stringify(AE));}this._orgalgn={host:AL,popup:r};m.setAlignment(c,g);}if(!m.isHostedWithin){if(Y(p.y)&&Y(p.h)){this.hostProxy.style.top=(p.y+(N(g)?(m.alignWithAnchor===true?p.h:0):(m.alignWithAnchor===true?0:p.h)))+F;}}var AB=N(c),AG=X(c),AF=N(g),o=X(g),l="auto",b="100%",a="0";var v=l,AI=l,n=l,f=l;if(AF){n=AB?a:b;}else{v=AB?b:a;}if(o){AI=AG?a:b;}else{f=AG?b:a;}var AJ=this.domNode.style;AJ.top=v;AJ.right=AI;AJ.bottom=n;AJ.left=f;return true;},close:function O(b){if(this.onClose){this.onClose(b);}J.call(this,false);if(this.lockIWForScroll){Z.call(this,this.opener,false);}this.set("visible",false);this.set("opener",null);if(this.lockIW){K.call(this,this.lockIW,false);}E.call(this,false);var a=this._orgalgn;if(a){this.popupConfig.setAlignment(a.host,a.popup);}},buildRendering:function D(){var a=this._super();if(a){if(!this.parent&&!this.domNode.parentElement){document.body.appendChild(this.domNode);}}return a;},unrender:function S(a){if(this.popupConfig&&!this.popupConfig.isHostedWithin&&this.hostProxy){document.body.removeChild(this.hostProxy);delete this.hostProxy;}this._super(a);}};}());(function(){mstrmojo.requiresCls("mstrmojo.desc","mstrmojo.dom","mstrmojo.MetricSelectorUtility","mstrmojo.num","mstrmojo.css","mstrmojo.vi.ui.rw.selectors.ISliderHelper");var C=mstrmojo.MetricSelectorUtility,H=C.OP,A=C.FN,J=C.Q,D=mstrmojo.num,E=mstrmojo.css,F=Math.min,I=Math.max;mstrmojo.vi.ui.rw.selectors.MetricRankSliderHelper=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.ISliderHelper,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.MetricRankSliderHelper",_children:[{scriptClass:"mstrmojo.ui.Pulldown",slot:"controlNode",alias:"rankon",isHostedWithin:false,items:C.RANK_OP_NAMES,onitemSelected:function(){this.parent.set("qua",this.getSelectedItem().v);}},{scriptClass:"mstrmojo.Label",slot:"controlNode",alias:"summary"}],init:function(K){this._super(K);this.slider.set("multiSelect",false);},updateOpCs:function B(){var M=this.slider,L=parseInt(M.qua,10),K=M.include,N=I(M.cs1Vl,M.cs2Vl),O=(L===J._PT||L===J._PB);if(N===M.high){M.unSet=true;M.cs=[];return ;}M.opId=K?H._LESS_EQUAL:H._GREATER;M.cs=[{dtp:5,v:D.toLocaleString(N)+(O?"%":"")}];},updateSummary:function G(){var L=this.slider,O=C.getFuncInfo(L.opId,L.qua).f,N=C.MRPFN,K="",M=L.cs1Vl<L.cs2Vl?L.cs2Nm:L.cs1Nm;if(L.unSet){K=mstrmojo.desc(2058,"All");}else{switch(O){case N.TOP:case N.BOTTOM:case N.BETWEENDESCENDING:K=String.fromCharCode(8804)+" "+M;break;case N.EXCLUDETOP:case N.EXCLUDEBOTTOM:case N.NOTBETWEENDESCENDING:K="> "+M;break;default:K=String.fromCharCode(8804)+" "+M;break;}}L.summary.set("text",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.ui._HasScroller");var L=mstrmojo.boxmodel,I=mstrmojo.dom,M=mstrmojo.css,O="mstrmojo-Tooltip",A="mstrmojo-scrollNode",E=20;function C(S,T,R){var U="connectScrollbox";if(R){U="dis"+U;}var Q=S&&S.parent;while(Q){if(Q[U]){Q[U](T);}Q=Q.parent;}}function G(){if(!this._paintHandle){var R=this.id,Q=function(V){var Z=mstrmojo.all[R];if(!Z){return ;}delete Z._paintHandle;var T=[O],a=Z.cssClass;if(a){T.push(a);}var S=mstrApp.getThemeClassName&&mstrApp.getThemeClassName(),X=Z.opener;if(X&&X.getTooltipThemeClass){S=X.getTooltipThemeClass();}T.push(S);Z.domNode.className=T.join(" ");var Y=Z.content,U=Z.contentNode,W=Z.arrowNode;U.className=(O+"-content "+A+" "+Z.contentNodeCssClass);U.style.cssText=Z.contentNodeCssText;U.innerHTML=Y;W.style.cssText="";Z.domNode.style.visibility=!!Y?"visible":"hidden";Z.updatePosition();if(!V&&Z.optimizePos){Z.optimizePos();}Z.updateScrollbars();};if(!this._hasPaint){Q(true);this._hasPaint=true;}else{this._paintHandle=window.setTimeout(Q,0);}}}function B(h,c,a,Y){var T=c&&(c.richTooltip||c.tooltip),f=a?I.getMousePosition(a,Y||self):null,Q=T&&(typeof T==="string");var U="",g="",d="",Z=T,X=null,W=mstrmojo.tooltip.POS_TOPLEFT,S=null,b=null;var V=false,R=false;if(T&&!Q){g=T.cssClass||g;U=T.contentNodeCssClass||U;d=T.contentNodeCssText||d;Z=T.content||"";X=T.refNode||X;W=T.posType||W;S=T.left||0;b=T.top||0;V=T.keepArrowXPos||V;R=T.keepArrowYPos||R;}h.set("contentNodeCssClass",U);h.set("cssClass",g);h.set("contentNodeCssText",d);h.set("content",Z);h.set("refNode",X);h.set("posType",W);h.set("left",Q?((f&&f.x)||h.left):S);h.set("top",(Q||!T)?((f&&(f.y+E))||h.top):b);h.set("keepArrowXPos",V);h.set("keepArrowYPos",R);}mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,keepArrowXPos:false,keepArrowYPos:false,posType:"TL",markupString:'<div id="{@id}" class="'+O+' {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout><div class="'+O+'-shadow {@shadowNodeCssClass}"></div><div class="'+O+'-contentWrapper"><div class="'+O+"-content "+A+' {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div><div class="'+O+'-arrow"></div></div>',markupSlots:{containerNode:function(){return this.domNode.children[1];},contentNode:function(){return this.domNode.children[1].firstChild;},shadowNode:function(){return this.domNode.firstChild;},arrowNode:function(){return this.domNode.children[2];}},setupScrollNodes:function D(){this.scrollNode=this.contentNode;this.scrollbarHostNode=this.containerNode;},_previousVisible:false,markupMethods:{onvisibleChange:function(){var R=this.domNode.style,Q=!!this.visible;if(this._previousVisible!==Q){R.visibility="hidden";}R.display=Q?"block":"none";this._previousVisible=Q;if(Q){this.updatePosition();if(this.content){G.call(this);}}},onleftChange:G,ontopChange:G,onrefNodeChange:G,onposTypeChange:G,oncontentNodeCssClassChange:G,oncontentNodeCssTextChange:G,oncontentChange:G,oncssClassChange:G},preBuildRendering:function N(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}return this._super();},updatePosition:function H(V){if(!this.visible&&!V){return ;}var U=this.refNode,T=U?L.offset(U,document.body):{left:I.getHorizontalScroll(),top:I.getVerticalScroll()},m=this.domNode.style,e=this.containerNode,g=e.offsetWidth,Y=e.offsetHeight,R=this.posType,b=R.indexOf("R")>-1,W=R.indexOf("B")>-1,a=this.top!==null?parseInt(this.top,10)+T.top-(W?Y:0):null,S=this.left!==null?parseInt(this.left,10)+T.left-(b?g:((R.indexOf("C")>-1)?Math.floor(g/2):0)):null,k=false,Z=false,c,X,h=I.windowDim(),f=I.getHorizontalScroll()+h.w,Q=I.getVerticalScroll()+h.h,d=this.arrowNode,l=null;if(S!==null){c=Math.min(Math.max(S,0),f-g);m.left=c+"px";k=S!==c;}if(a!==null){X=Math.min(Math.max(a,0),Q-Y);m.top=X+"px";Z=a!==X;}if(k||Z){if((this.keepArrowXPos&&k)||(this.keepArrowYPos&&Z)){l=M.getComputedStyle(d);}if(this.keepArrowXPos&&k){d.style.left=(parseInt(l.left,10)+S-c)+"px";}if(this.keepArrowYPos&&Z){d.style.top=(parseInt(l.top,10)+a-X)+"px";}}M.toggleClass(this.domNode,"offset",k||Z);},_on_tooltip_change:function(Q){B(this,Q&&Q.src);},_set_opener:function(T,S){var R=this.opener,Q=S!==R;if(Q){if(S){C(S,this);}if(R){C(S,this,true);}if(R&&R.detachEventListener){R.detachEventListener(this._richSubs);R.detachEventListener(this._ttpSubs);}if(S&&S.attachEventListener){this._richSubs=S.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=S.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=S;}return Q;},updatePopupConfig:function(Q,R){B(this,R,Q&&Q.e,Q&&Q.win);},onscroll:function K(){if(this.visible&&this.nudge){this.nudge();}this._super();},onmouseover:mstrmojo.emptyFn,onmouseout:mstrmojo.emptyFn});var J=null;mstrmojo.tooltip={POS_TOPLEFT:"TL",POS_BOTTOMLEFT:"BL",POS_TOPRIGHT:"TR",POS_BOTTOMRIGHT:"BR",POS_BOTTOMCENTER:"BC",POS_TOPCENTER:"TC",open:function F(R,T,S,Q){if(!J||!mstrmojo.all[J.id]){J=new mstrmojo.Tooltip();}Q=Q||{};Q.e=T;Q.win=S;J.open(R,Q);R.tooltip=J;},close:function P(){if(J){if(J.opener){J.opener.tooltip=null;}J.close();}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");function A(B){return function(){this.domNode.style[B]=this[B]||"";};}mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",titleNodeCssClass:"mstrmojo-popup-title",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}"><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-title {@titleNodeCssClass}">{@title}</div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onleftChange:A("left"),ontopChange:A("top"),onzIndexChange:A("zIndex")}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo._IsPopup","mstrmojo._CanAutoClose");var C=mstrmojo.dom;mstrmojo.ui.PopupWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.PopupWidget",markupString:'<div id="{@id}" class="mstrmojo-ui-PopupWidget {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="pw-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},autoCloses:true,locksHover:true,closeOnClick:true,visible:true,onclick:function B(D){C.stopPropogation(null,D.e);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.hash");mstrmojo.requiresClsP("mstrmojo.vi.models","PanelFormatSaver","EnumPanelTypes","VIComponentMap");var Y=mstrmojo,Q=Y.hash,K=Y.array,H=Y.vi.models,U=H.VIComponentMap.TYPES,c=H.EnumPanelTypes,D=U.FILTER_STACK,d=Y.models.FormatModel,G=d.getFormatUpdate,O=d.ENUM_PROPERTY_NAMES,L=Y.EnumRWUnitType,S=Y.mstr.EnumWebAPIErrorCodes,E=c.FILTERS,M=Y.DocDataService.UNDO_KEY,Z="\u001E",J=Y.DocDataService.REQUEST_DEFN_DATA,C="sections.0.subsections.0";var P=8;function V(e){return e.t!==1&&(e.t!==47||e.st===12033);}function I(e,g,f,l,h){var k=[];if(!e){return k;}h=h||{};e.getFilters().forEach(function(n){var m=parseInt(n.defn.fmts["z-index"],10);if(m>=g&&(!f||m<=f)){k.push(this.getUnitFormatAction(n,1,G(O.Z_INDEX,m+l)));h[n.ckey]=n.id;}},this);return k;}function X(t,k,o,g,r){var n=[],u=this.getCtrlStyleFromDatasetUnit(t,true),l=this.getCurrentLayoutDef().units,m=this.getVIPanelKeyFromUnits(E),h=Q.keyarray(l).filter(function(v){return l[v].t===L.PANEL&&l[v].isFilterPanel;})[0],p=this.getTargetDefn(h)[h].fmts,q=p&&p.width,f=(q&&q.charAt(q.length-1)!=="%")?parseInt(q,10):undefined,e;if(r===undefined||r===null){r=999;}n.push(this.getDataService().getAddCtrlAction(h,o,g,[m],V(t),t.t,t.did,k));if(u===1){e=1;}n=n.concat(this.getCtrlActionsByStyle(t,this.buildKeyContext(o,g),u,e,this.getCtrlHeightByStyle(u,t.card||P+1),f,r,1));return n;}function F(k,g,m,o,n,f){var l=this.getVIMap(),p=l.getComponent(D);if(f&&f.preInfo){k.addActions(f.preInfo.actions);}if(!g.length){var h=o;m.forEach(function(u){var t=this.getNextKey(),v=this.getNextKey(),r=this.buildKeyContext(t,v);g.push(r);k.addActions(X.call(this,u,[l.getComponentKey(U.MAIN_CONTENT)],t,v,(h!==null?h++:null)));},this);var e=g.length&&(p.getFilters().length-1);k.addActions(I.call(this,p,o,e,g.length,n));}else{var q=this.getDataService();g.forEach(function(r){q.addMoveControlAction(k,r,p.contents.k);});k.addActions(I.call(this,p,o,null,g.length,n));}if(f&&f.postInfo){k.addActions(f.postInfo.actions);}}function b(m,h,l,g){var f=this.getVIMap(),e=f.getComponent(D),k=this.getDataService();h.forEach(function(n){k.addMoveControlAction(m,n,M);});m.addActions(I.call(this,e,l+1,undefined,-h.length,g));}function T(h,l,n,m,k){var o=l.getDocBuilder().getLayoutVIMap(l.getCurrentLayoutKey()).getComponent(D),g=o.contents.k,q=l.getDataService();var f=o.getFilters(),e={},p=0;n.forEach(function(r){e[r.ckey]=r;});f.forEach(function(t){var x=parseInt(t.defn.fmts["z-index"],10);if(!e[t.ckey]){if(p!==0){h.addActions(l.getUnitFormatAction(t,1,G(O.Z_INDEX,x-p)));m[t.ckey]=t.id;}else{var w=t.tks?t.tks.split(Z):[];for(var r in e){if(w.indexOf(e[r].ckey)>=0){m[t.ckey]=t.id;break;}}}}else{var u=e[t.ckey],w=u.tks?u.tks.split(Z):[],AA=u.dsTks?u.dsTks.split(Z):[],AB=u.ck,z=q.getRemoveCtrlTargetAction,v=q.getRemoveCtrlTargetDatasetAction;w.forEach(function(AD){if(k){h.addActions(z.call(q,AB,AD,[],true));}else{h.addActions(z.call(q,AB,AD,AD));}});AA.forEach(function(AD){h.addActions(v.call(q,AB,AD));});if(l.datasetsSettings.unitOpr(u.ttl,"isDeleteWithFilter")){h.addActions({act:"removeDerivedMetricFromDataset",dsid:l.findDatasetIdFromUnit(u.srcid),metricId:u.srcid});l.datasetsSettings.unitOpr(u.ttl,"isDeleteWithFilter",false);l.datasetsSettings.unitOpr(u.ttl,"completeHide",false);h.addActions(l.datasetsSettings.getSaveActions());}var AC=[g];if(!k){AC.concat(w);}h.addActions(q.getRemoveCtrlAction(u.ckey,AC));p=p+1;}},this);}function a(l,e,h,g,k){var f=this;if(mstrmojo.array.find(l.actions,"act","removeDerivedMetricFromDataset")>=0){l.addCallbacks(f.getDatasetsUpdateCallback());}if(k&&k.preInfo){l.addCallbacks(k.preInfo.callback);}l.addCallbacks({success:function(p,r){var o=e.contents,n=e.k,q=r.params.params,t=q&&JSON.parse(q).partialRetrieval,u=t&&t.nodes;if(g){n=p.pukeys;}else{if(u){n=Q.keyarray(h||{}).concat(u).join(Z);}}f.partialUpdate(p.data,f.getTargetDefn(n),p.defn,Q.keyarray(h||{}));if(o&&o.children){o.rebuildChildren();}e.getFilterDefinitions().forEach(function(w){if(!w.sfs){var v=[],x=f.getDatasetUnits(["att","mx"],function(z){return z.did===w.srcid;})[0]||{};(x.fs||[]).forEach(function(z){v.push({did:z.fid});});if(v.length){w.sfs=v;}}});var m=e.parent&&e.parent.tabList;if(m){m.singleSelect(K.find(m.items,"id","vi_flt"));}},failure:function(m,o){var n=null;if(m.code==S.DFC_QRYENG_RES_TRUNC){n=function(){f.controller.undo();};}mstrmojo.error({longDesc:m.message},n,{title:"Error"});}});if(k&&k.postInfo){l.addCallbacks(k.postInfo.callback);}}mstrmojo.vi.models._FilterStackActions=mstrmojo.provide("mstrmojo.vi.models._FilterStackActions",{_mixinName:"mstrmojo.vi.models._FilterStackActions",addFilterStackSelectors:function B(n,r,f,e){var q=this.getDataService(),l=this,m=this.getVIMap(),p=m.getComponent(D),h=[],o=r!==undefined?r:(p?p.getFilters().length:null),k=l.getDataService();var g=function(){var t=(!p||K.find(p.getFilterDefinitions(),"srcid",n[0]&&n[0].did)===-1);if(t){e=e||!!n.filter(function(u){return !V(u);}).length;l.execute({execute:function(){var x=q.newUpdate(this,{extras:J}),w={},v=p.contents;x.extras.skipUICmdMgrOnFailure=[S.DFC_QRYENG_RES_TRUNC];x.extras.config={hideFailureErr:true};w[v.k]=true;F.call(l,x,h,n,o,w,f);a.call(l,x,p,w,e,f);var u=o===null?this.mgr.CMD_PHASE.FIRST:this.mgr.CMD_PHASE.LAST;this.submitUpdate(x,u);}});}};if(!p){k.submitUpdates(l.getShowVIStackAction(E),{success:function(t,u){l.buildLoadedVIStack(E,C,t,l.getDocBuilder());l.controller.view.openViPanel("filterPanel",{success:g});p=l.getVIMap().getComponent(D);}},{preserveUndo:true});}else{if(p.getOpenStatus()){g();}else{l.controller.view.openViPanel("filterPanel",{success:g});}}},pivotFilterStackSelector:function N(g,e,o){var n=this.getDataService(),m=g.id,l=this.getVIMap().getComponent(D),h=this,f=e<o;function k(){var u=n.newUpdate(this,{extras:J}),q={},p=this.getStateValue(e,o),t=this.getStateValue(o,e),r=this.getStateValue(f,!f);g=mstrmojo.all[m];u.addActions(I.call(h,l,t,p+(r?1:-1),r?-1:1,q));u.addActions(h.getUnitFormatAction(g,1,G(O.Z_INDEX,t)));q[g.ckey]=m;a.call(h,u,l,q);this.urInfo=this.urInfo||{};this.urInfo.callback=u.callback;u.submit();}this.execute({execute:k});},deleteFilterStackSelectors:function A(m,f){var l=this.getDataService(),e=this.getVIMap().getComponent(D),h=this,g=e.model.getDataService().newUpdate(e);if(e.applyBufferedSlices){e.applyBufferedSlices(true,g);}function k(){var p=l.newUpdate(this,{extras:J}),n={};n[e.contents.k]=true;T.call(this,p,h,m,n,f);a.call(h,p,e,n);this.urInfo=this.urInfo||{};this.urInfo.callback=p.callback;var o=(g.actions||[]).concat(p.actions);this.submit(o,p.callback,p.extras);}this.execute({execute:k});},changeFilterStackSelectors:function R(m,h){var n=this.getDataService(),g=this,f=this.getVIMap(),e=f.getComponent(D),l=!!m.filter(function(o){return !V(o);}).length,k=[];this.execute({execute:function(){var p=n.newUpdate(this,{extras:J}),o={};o[e.contents.k]=true;T.call(this,p,g,h,o);F.call(g,p,k,m,e.getFilters().length+1,o);a.call(g,p,e,o,l);if(h.length&&m.length){this.submitUpdate(p,this.mgr.CMD_PHASE.FIRST);}else{this.submitUpdate(p);}}});},loadHiddenFilterStack:function W(e,f){this.loadHiddenVIStack(E,C,e,f);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.PanelFormatSaver");mstrmojo.vi.ui._IsViPanel=mstrmojo.provide("mstrmojo.vi.ui._IsViPanel",{_mixinName:"mstrmojo.vi.ui._IsViPanel",getPanelSaver:function A(){return null;},setOpenStatus:function D(F,E,I,H){if(this.visible!==F){this.set("visible",F);if(!H){this.resetLayout(H);}if(!E){var G=this.getPanelSaver();if(G){G.saveProperty("visible",F);}}mstrApp.rootCtrl.generateToolbar();}},getOpenStatus:function C(){return !!this.visible;},resetLayout:function B(){this.height=this.width="1px";this.parent.doLayout();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr");var R=mstrmojo.func,N=mstrmojo.hash,K=mstrmojo.array,H=mstrmojo.vi.controllers.UICmd.STATES,F={SHARED:0,SEPARATE:1},I={AND:19,OR:20},X=function X(b,a){var Y={},Z=function(e,d){var c=[];if(!d){return e;}K.forEach((d||[]),function(f){c.push(f);});K.forEach((e||[]),function(g){var f=K.find(d,"id",g.id);if(!~f){c.push(g);}});return c;};N.forEach(a,function(c,d){Y[d]=c;});N.forEach(b,function(c,d){Y[d]=Z(c,a[d]);});return Y;},D=function D(Y){var Z=[];N.forEach(Y,function(a){Z.push({ft:I.AND,d:a});});return Z;},G=function(Z){var Y={},a=function(b){var c=N.keyarray(b)[0];return{id:c,d:b[c][0]};};N.forEach(Z,function(e){var d={},b=a(e),c=d[b.id];if(b.id){if(!c){d[b.id]=c=[];}c.push(b.d);}Y=X(Y,d);},this);return[{ft:I.OR,d:Y}];},C=function C(e){var a=this.model,d,c=[],Z=this.getSelectionType(),Y=mstrmojo.vi.ui.rw.SelectionType,f=true,b=false;if(!N.isEmpty(e)){if(Z===Y.METRICS){d=D.call(this,e);}else{d=G.call(this,e);}}N.forEach(d,function(g){f=false;var h=[];N.forEach(g.d,function(k,o){if(a.supportsViewFilterActions(o)){b=true;var l=[],n={id:o,elems:l},m=a.getObjectInfo(o);if(m){n.t=m.t;n.st=m.st;if(m.st===12033){n.attId=m.attId;}}K.forEach((k||[]),function(p){l.push(p.id);});h.push(n);}});if(h.length){c.push({ft:g.ft,d:h});}});c.hasElements=b;c.clearSelections=f;return c;},U=function U(b){var c=this.selectorControl,Z,Y,a=this;if(c){if(b.clearSelections||b.hasElements){Z=this.controller;c.exp=null;if(Z.onGridSelector){Y=function(){Z.onGridSelector(a,{type:mstrmojo.EnumRWUnitType.GRID,ck:c.ck,tks:c.tks,ctlKey:c.ckey,sliceId:this.sid,isUConDS:c.isUConDS,ct:c.ct,selections:b});};if(this.multiUnitCtrlInterval){window.clearInterval(this.multiUnitCtrlInterval);this.multiUnitCtrlInterval=null;}if(Z.cmdMgr.state===H.BUSY){this.multiUnitCtrlInterval=window.setInterval(function(){if(Z.cmdMgr.state!==H.BUSY){window.clearInterval(a.multiUnitCtrlInterval);if(!a.destroyed){a.multiUnitCtrlInterval=null;Y();}}},1000);}else{Y();}}}}},B=function B(a){var Y={type:mstrmojo.vi.ui.rw.SelectionType.ATTS,data:a},Z=function(b,c){if(parseInt(b.fn,10)===22&&parseInt(c,10)===19){Y.type=mstrmojo.vi.ui.rw.SelectionType.METRICS;}K.forEach((b.nds||[]),function(d){Z(d,b.fn);});};Z(a,null);return Y;},V=function V(){return this.parent.model.getCurrentLayoutDef().cgbMap;},J=function J(){var Y=V.call(this),Z=[];N.forEach(Y,function(b,a){if(this.k===b){Z.push(a);}},this);return Z;},W=function W(){var Y=this.controller&&this.controller.cmdMgr;if(Y&&Y.isUndoRedo()){return true;}return false;};mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",selectorControl:null,multiUnitCtrlInterval:null,postBuildRendering:function S(){this._super&&this._super();var Y=this.findSelectorControl();if(W.call(this)){this.clearSelections();}if(Y&&!N.isEmpty(Y.exp)&&this.addSelectionsFromExpression){this.addSelectionsFromExpression(B(Y.exp));if(this.highlight){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}},findSelectorControl:function Q(){if(this._super){return this._super();}else{this.throwAbstractMethodError("findSelectorControl");}},handlesMultiSelection:function E(Y){return(this._super&&this._super(Y))||!!this.selectorControl;},onSelectionChange:function L(Z){var b=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),a=false;if(this._super){a=this._super(Z);}if(b.length>0){this.singleUnitSelect();a=true;}else{if(!!this.selectorControl){var Y=C.call(this,Z);U.call(this,Y);return true;}}return a;},singleUnitSelect:function A(){if(this._super){this._super();}},clearAllSelections:function P(){return this.selectorControl&&this.selectorControl.showall;},onClearBrushing:function T(Y){if(this.selectorControl){return true;}if(this._super){return this._super(Y);}return false;},getFilterType:function M(){return this.defn.ins||F.SHARED;},switchFilterType:function O(k){var f=this,h,g=f.getFilterType(),d=f.parent.model,c,b={actions:[]},l,a=V.call(f),Y,e=false;if(g!==k){h=J.call(f);if(h.length>0&&g===F.SHARED){l=h[0];c=d.getSourceControls(f.parent,l);K.forEach(c,function(n,o){if(o!==0){Y=d.getNextKey();a[Y]=f.k;b.actions.push(d.redoFilterAssociations(true,n.control.ckey,n.sourceKey,f.k,l,Y));e=true;}}.bind(f));}else{var Z;K.forEach(h,function(n,o){c=d.getSourceControls(f.parent,n);if(o===0){Z=n;}else{delete a[n];b.actions.push(d.redoFilterAssociations(false,c[0].control.ckey,c[0].sourceKey,f.k,n,Z));e=true;}}.bind(f));}b.actions.push(d.getUnitFormatAction(f,1,{FormattingSelector:{IndependentNodeSelector:k}},true));var m=false;b.callback=({success:function(){f.defn.ins=m?g:k;m=!m;}});if(e){b.callback=R.wrapMethods(b.callback,d.getRebuildCallback());}}b.extras={style:{params:{treesToRender:3}}};return b;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.vi.util.ThresholdUtils","mstrmojo.array");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates");var G=mstrmojo,F=G.array,J=G.vi.viz,D=J.EnumVisualizationTemplates,E=mstrmojo.vi.util.ThresholdUtils;mstrmojo.vi.viz.VisualizationTransition=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.viz.VisualizationTransition",vis:null,transitionDropZones:mstrmojo.getMissingFn(),addClearAllThresholdsActions:function I(L){var K=this.vis;E.addClearAllThresholdsActions(K.model,K.node,L);},addThresholds:function B(O,P,Q,L,K,M){var N=this.vis;return E.addThresholds(N.model,N,N.node,P,Q,L,K,M);},clearImageThreshold:function C(N,M){var L,K;for(key in N){if(N.hasOwnProperty(key)){L=N[key];if(L&&L.length){for(K=0;K<L.length;K++){if(!(L[K].fmt&&L[K].fmt.bc)){this.addClearAllThresholdsActions(M);break;}}}}}},isGraphMatrix:function H(L){var K=false;switch(L){case D.UNKNOWN_GRAPHMATRIX_TYPE:case D.GRAPHMATRIXBUBBLECIRCLEMM:case D.GRAPHMATRIXBUBBLEGRIDCIRCLEAA:case D.GRAPHMATRIXBUBBLEGRIDSQUAREAA:case D.GRAPHMATRIXBUBBLESQUAREAM:case D.GRAPHMATRIXBUBBLESQUAREMM:case D.GRAPHMATRIXHORIZONTALBARCLUSTERED:case D.GRAPHMATRIXHORIZONTALBARSTACKED:case D.GRAPHMATRIXHORIZONTALBARPERCENT:case D.GRAPHMATRIXHORIZONTALLINECLUSTERED:case D.GRAPHMATRIXHORIZONTALLINESTACKED:case D.GRAPHMATRIXHORIZONTALLINEPERCENT:case D.GRAPHMATRIXHORIZONTALAREACLUSTERED:case D.GRAPHMATRIXHORIZONTALAREASTACKED:case D.GRAPHMATRIXHORIZONTALAREAPERCENT:case D.GRAPHMATRIXSCATTERCIRCLEMM:case D.GRAPHMATRIXSCATTERGRIDCIRCLEAA:case D.GRAPHMATRIXSCATTERGRIDSQUAREAA:case D.GRAPHMATRIXSCATTERSQUAREAM:case D.GRAPHMATRIXSCATTERSQUAREMM:case D.GRAPHMATRIXVERTICALBARCLUSTERED:case D.GRAPHMATRIXVERTICALBARSTACKED:case D.GRAPHMATRIXVERTICALBARPERCENT:case D.GRAPHMATRIXVERTICALLINECLUSTERED:case D.GRAPHMATRIXVERTICALLINESTACKED:case D.GRAPHMATRIXVERTICALLINEPERCENT:case D.GRAPHMATRIXVERTICALAREACLUSTERED:case D.GRAPHMATRIXVERTICALAREASTACKED:case D.GRAPHMATRIXVERTICALAREAPERCENT:case D.GRAPHMATRIXPIE:case D.GRAPHMATRIXRING:K=true;break;default:break;}return K;},filterGMTrainingMetric:function A(K,P){var L,M,O=[];if(!K||!K.ColorBy||!P){return P;}var N=function(Q){return(Q&&Q.TemplateMetric)||[];};L=N(K.AngleBy).concat(N(K.Rows)).concat(N(K.YAxis)).concat(N(K.Columns)).concat(N(K.XAxis)).concat(N(K.ColorBy)).concat(N(K.SizeBy)).concat(N(K.AdditionalMetrics));F.forEach(P,function(Q){M=false;F.forEach(L,function(R){if(Q.did===R.id){M=true;return false;}});if(M){O.push(Q);}});return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.viz.GraphMatrixHelper","mstrmojo.vi.viz.GoogleMapHelper","mstrmojo.vi.viz.ESRIMapHelper","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.vi.util.ThresholdUtils","mstrmojo.gm.GMEnums");var N=mstrmojo,K=N.array,P=N.vi.viz,B=P.GraphMatrixHelper,A=P.EnumDSSDropZones,H=P.KnownVisualizations,I=N.vi.util.ThresholdUtils,L=mstrmojo.gm.EnumABLDirection;function C(Q){return Q&&Q.getHostModel&&Q.getHostModel();}function M(R){var Q=false;if(R.t!==4){K.forEach(R.fs||[],function(S){if(S.ftr||S.bftp===1||S.bftp===8||S.bftp===9){Q=true;return false;}});}return Q;}function F(o,V,t,Z,c){var U=t.dz,q=t.gsi||{},R=[],W=false,Q=false,S=false,a=function(u){return u.shape==="Pie"||u.shape==="Ring";},n=function(){var u=Z.getHost();return u&&u.GMController&&u.GMController.isBubbleOrScatter();},h=function(u,z){R.push({act:"addDropZoneUnit",zoneId:u,datasetId:V,unitId:o.did,unitType:o.t,unitPos:z||0});W=true;S=(u===A.ColorBy);Q=(u===A.AdditionalMetrics);var x=["Reserved","Rows","Columns","XAxis","YAxis","BreakBy","SliceBy","ColorBy","SizeBy"],w=x[u],v=o.t===4?"TemplateMetric":"TemplateUnit";if(U[w]){if(!U[w][v]){U[w][v]=[];}U[w][v].push(o);}},g=function(u,v){R.push({act:"removeDropZoneUnit",zoneId:u,unitId:v.did,unitType:v.t});},m=function(u){R.push({act:"addDropZoneUnit",zoneId:u,unitId:"00000000000000000000000000000000",unitType:0});},p=new P.GraphMatrixHelper({data:t}),r=function(u){if(!p.shape){p.shape=u;c=true;}},X=function(u,AB){h(u,AB);if(!p.metricsDropZone){if(u===A.XAxis&&p.xAxisObjects.length){m(A.Columns);}else{if(u===A.YAxis&&p.yAxisObjects.length){m(A.Rows);}}}var x=Z.getHost(),z=x.GMController,w,AA=z.getChartInfo(),v={dndGM:false};if(z.shallWeUseGroupInfo){w=z.getGroupInfo();if((AA.dirc===L.VERTICAL&&u===A.YAxis)||(AA.dirc===L.HORIZONTAL&&u===A.XAxis)){w=Z.fillGroupInfo(v,w,o.did,true);}z.setGroupInfo(w);c=true;}};p.setData(t.dz);p.setMetricsDropZone(t.dz);if(o.t===4){if(p.exists(o,"yAxisObjects")||p.exists(o,"xAxisObjects")||p.exists(o,"sizeByObjects")||p.exists(o,"colorByObjects")||p.exists(o,"angleObjects")){var l=!p.exists(o,"yAxisObjects")&&!p.exists(o,"xAxisObjects");if(l&&(!p.yAxisObjects.length||p.yAxisObjects[0].t===4)){X(A.YAxis);}else{if(l&&(!p.xAxisObjects.length||p.xAxisObjects[0].t===4)){X(A.XAxis);}else{if(!p.angleObjects.length&&a(p)){h(A.Angle);}else{if(!p.colorByObjects.length){h(A.ColorBy);}else{if(!p.sizeByObjects.length||(!p.exists(o,"sizeByObjects")&&n())){h(A.SizeBy);}}}}}}else{if(!p.angleObjects.length&&a(p)){h(A.Angle);}else{if((!p.yAxisObjects.length)&&(!p.xAxisObjects.length)){X(A.YAxis);r(B.PROP_SHAPE_BAR);}else{if(p.yAxisObjects.length&&!p.xAxisObjects.length){if(!p.exists(o,"yAxisObjects")){X(A.XAxis);r(Z.isMetricZone(A.YAxis)?B.PROP_SHAPE_CIRCLE:B.PROP_SHAPE_BAR);}}else{if((!p.yAxisObjects.length)&&p.xAxisObjects.length){if(!p.exists(o,"xAxisObjects")){X(A.YAxis);r(Z.isMetricZone(A.XAxis)?B.PROP_SHAPE_CIRCLE:B.PROP_SHAPE_BAR);}}else{if((p.xAxisObjects[0].t!==4)&&(p.yAxisObjects[0].t===4)&&!p.exists(o,"yAxisObjects")&&!p.exists(o,"sizeByObjects")&&!p.exists(o,"colorByObjects")){X(A.YAxis);if(p.metricsDropZone!==B.PROP_COLUMNS&&p.metricsDropZone!==B.PROP_ROWS&&(!p.colorByObjects.length||p.colorByObjects[0].t!==4)){m(A.ColorBy);}}else{if((p.xAxisObjects[0].t===4)&&(p.yAxisObjects[0].t!==4)&&!p.exists(o,"xAxisObjects")&&!p.exists(o,"sizeByObjects")&&!p.exists(o,"colorByObjects")){X(A.XAxis);if(p.metricsDropZone!==B.PROP_COLUMNS&&p.metricsDropZone!==B.PROP_ROWS&&(!p.colorByObjects.length||p.colorByObjects[0].t!==4)){m(A.ColorBy);}}else{if((p.xAxisObjects[0].t===4)&&(p.yAxisObjects[0].t===4)&&!p.exists(o,"xAxisObjects")&&!p.exists(o,"yAxisObjects")&&!p.exists(o,"sizeByObjects")&&!p.exists(o,"colorByObjects")){if(!p.colorByObjects.length&&p.metricsDropZone!==B.PROP_COLORBY){h(A.ColorBy);}else{if(!p.sizeByObjects.length&&p.shape!=="Area"){h(A.SizeBy);}else{if(p.xAxisObjects.length===1){X(A.XAxis);}else{if(p.yAxisObjects.length===1){X(A.YAxis);}else{if(p.sizeByObjects.length===1&&p.shape!=="Area"){h(A.SizeBy);}else{if(!p.exists(o,"tooltipMetrics")){h(A.AdditionalMetrics);}}}}}}}else{if(!p.colorByObjects.length&&p.metricsDropZone!==B.PROP_COLORBY){h(A.ColorBy);}else{if(!p.sizeByObjects.length){h(A.SizeBy);}else{if(!p.exists(o,"tooltipMetrics")){h(A.AdditionalMetrics);}}}}}}}}}}if((!Q)&&W){if(p.exists(o,"tooltipMetrics")){var f=K.find(p.tooltipMetrics,"did",o.did);if(f>-1){p.tooltipMetrics.splice(f,1);g(A.AdditionalMetrics,o);}}}}if(W&&S){var e=Z.getHost();I.addThresholds(e.model,e,e.node,o,R);}}else{if((q.rows||[]).concat(q.cols||[]).some(function(u){return u.did===o.did;})){if(!p.colorByObjects.length||(p.colorByObjects[0].t!==4&&!p.exists(o,"colorByObjects"))){h(A.ColorBy);}}else{if(!p.sliceObjects.length&&a(p)){h(A.SliceBy);if(!p.colorByObjects.length){h(A.ColorBy);}}else{if((!p.yAxisObjects.length)&&(!p.xAxisObjects.length)){h(A.XAxis);r(M(o)?B.PROP_SHAPE_LINE:B.PROP_SHAPE_BAR);}else{if((p.yAxisObjects.length)&&(!p.xAxisObjects.length)){h(A.XAxis);r(M(o)&&p.yAxisObjects[0]===4?B.PROP_SHAPE_LINE:B.PROP_SHAPE_BAR);}else{if((!p.yAxisObjects.length)&&(p.xAxisObjects.length)){h(A.YAxis);r(M(o)&&p.xAxisObjects[0]===4?B.PROP_SHAPE_LINE:B.PROP_SHAPE_BAR);}else{if((p.xAxisObjects[0].t!==4)&&(p.yAxisObjects[0].t===4)){if(!p.colorByObjects.length){h(A.ColorBy);if(!p.exists(o,"breakByObjects")){h(A.BreakBy);}}else{h(A.Columns);}}else{if((p.xAxisObjects[0].t===4)&&(p.yAxisObjects[0].t!==4)){if(!p.colorByObjects.length){h(A.ColorBy);if(!p.exists(o,"breakByObjects")){h(A.BreakBy);}}else{h(A.Rows);}}else{if((p.xAxisObjects[0].t!==4)&&(p.yAxisObjects[0].t!==4)){h(A.Columns);}else{if((p.xAxisObjects[0].t===4)&&(p.yAxisObjects[0].t===4)){if(!p.colorByObjects.length){h(A.ColorBy);if(!p.exists(o,"breakByObjects")){h(A.BreakBy);}}else{if(!p.columnObjects.length&&p.rowObjects.length&&p.rowObjects[0].t!==4){h(A.Rows);}else{h(A.Columns);}}}}}}}}}}}}var Y=[];if(R.length){var d=Z.getUpdateTemplateAction(R);var T=Z.docModel,k=T.controller.view.builder,b=k.getLayoutVIMap(T.getCurrentLayoutKey()).getComponent(mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK);if(b){d.partialRetrieval.nodes.push(b.k);}Y.push(d);}if(c){Y.push({act:"setProperty",nodeKey:t.k,prs:"FormattingWidget",pri:4,v:mstrmojo.string.encodeXMLAttribute(p.getXml())});}if(Y.length){Z.clearCardinalityFlags();Z.findLargeItemsForAddUnits([o]);}return Y;}function J(T,V,U,Q){var R,S=true;function W(a,c,Z){var b=Q.getZoneModelByZoneId(a);if(Q.getUnitIndexInZone(b,T)===-1&&(!Z||Z(b))){var Y=c?0:b.items.length;R=Q.getAddItemActions(b,[T],Y,false,c?b.items[Y]:null,V);b.items.push(T);return false;}return true;}function X(Y){return Y.items.length===0;}if(!Q.isMetric(T)){S=W(A.ColorBy,false,function(Y){return X(Y)&&Q.getItemCountInZone(A.Grouping)>=2;});S=S&&W(A.Grouping);if(R){Q.clearCardinalityFlags();Q.findLargeItemsForAddUnits([T]);}}else{S=W(A.ColorBy,false,X);S=S&&W(A.SizeBy,false,X);S=S&&W(A.SizeBy,true,function(Y){return Y.items[0].did===Q.getZoneModelByZoneId(A.ColorBy).items[0].did;});S=S&&W(A.AdditionalMetrics,false,function(){return Q.getUnitIndexInZone(Q.getZoneModelByZoneId(A.SizeBy),T)===-1&&Q.getUnitIndexInZone(Q.getZoneModelByZoneId(A.ColorBy),T)===-1;});}return R?[Q.docModel.getDataService().getUpdateTemplateAction(Q.getHost().k,R)]:[];}function D(S,U,T,Q){var R=null,V=!Q.isMetric(S)?[A.FromItem,A.ToItem]:[A.ColorBy,A.ItemSize,A.SizeBy];K.forEach(V,function(W){var X=Q.getZoneModelByZoneId(W);if(X.items.length===0){R=Q.getAddItemActions(X,[S],0,U);X.items.push(S);return false;}});if(R){Q.clearCardinalityFlags();Q.findLargeItemsForAddUnits([S]);return[Q.docModel.getDataService().getUpdateTemplateAction(Q.getHost().k,R)];}return[];}function G(S,U,T,Q){var R=null,V=!Q.isMetric(S)?[A.GeoAttribute,A.Layout]:[A.ColorBy,A.SizeBy,A.AdditionalMetrics];K.forEach(V,function(W){var X=Q.getZoneModelByZoneId(W);if((W===A.AdditionalMetrics||X.items.length===0)&&Q.isZoneAvalaible(W)){R=Q.getAddDropZoneUnitsActions(X,[S],0,{datasetId:U});return false;}});return R?[Q.docModel.getDataService().getUpdateTemplateAction(Q.getHost().k,R)]:[];}function E(h,V,m,Z,S){var k=m.gsi||{},Y=Z.getHost(),a=[],c=false,e=Z.getZoneModelByZoneId(A.ColorBy),f=Z.getZoneModelByZoneId(A.SizeBy),T=Z.getZoneModelByZoneId(A.AdditionalMetrics),g=mstrmojo.vi.viz,b=g.MapHelper,W=false,X=function(r,q,p,u){if(r){a.push(Z.getUpdateTemplateAction([{act:"addDropZoneUnit",zoneId:p,unitId:r,unitType:q,datasetId:u}]));if(p===A.ColorBy){a.push(Z.getUpdateTemplateAction(I.addThresholds(Y.model,Y,Y.node,h)));}}switch(p){case A.GeoAttribute:S.geoAttribute=r;break;case A.Latitude:S.latitude=r;break;case A.Longitude:S.longitude=r;break;case A.ColorBy:S.colorBy=r;break;case A.SizeBy:S.sizeBy=r;break;case A.AdditionalMetrics:S.tooltip.push(r);break;}W=true;},o=function(r,q,p){if(r){a.push(Z.getUpdateTemplateAction([{act:"removeDropZoneUnit",zoneId:p,unitId:r,unitType:q}]));}switch(p){case A.geoAttribute:S.geoAttribute="";break;case A.Latitude:S.latitude="";break;case A.Longitude:S.longitude="";break;case A.ColorBy:S.colorBy="";break;case A.SizeBy:S.sizeBy="";break;case A.AdditionalMetrics:S.tooltip=K.filter(S.tooltip,function(t){return t!==r;},{max:S.tooltip.length});break;}},l=function(p,q){a.push(Z.getUpdateTemplateAction({act:"addForm",unitId:p,attFormId:q,unitPos:1}));};S.setWidget(Y);K.forEach((k.rows||[]).concat(k.cols||[]),function(p){if(p.did===h.did){c=true;return false;}});if(c){return[];}switch(h.t){case 4:if(e&&!e.items.length){X(h.did,h.t,A.ColorBy,V);}else{if(f&&!f.items.length){X(h.did,h.t,A.SizeBy,V);}else{if(T){X(h.did,h.t,A.AdditionalMetrics,V);}}}break;default:var Q=!S.geoAttribute&&!S.latitude&&!S.longitude,R=S.getGeoForm(h,function(p){return b.isGeoRoleSupportArea(p.fgr);}),d=function(){var p=S.mapType,q=S.tooltip;if(!b.canShowSizeByZone(p)&&S.sizeBy&&q.indexOf(S.sizeBy)<0){X(S.sizeBy,4,A.AdditionalMetrics);o(S.sizeBy,4,A.SizeBy);}if(!b.canShowColorByZone(p)&&S.colorBy&&q.indexOf(S.colorBy)<0){X(S.colorBy,4,A.AdditionalMetrics);o(S.colorBy,4,A.ColorBy);}};if(Q&&S.supportAreaMap&&R){S.setMapType(b.MTP_AREA);S.setUseAttributeForm(false);X(h.did,h.t,A.GeoAttribute,V);l(h.did,R.fid);}else{var U=S.getLatitudeForm(h),n=S.getLongitudeForm(h);if(U&&n&&Q){X(h.did,h.t,A.GeoAttribute,V);S.setMapType(b.getMapTypeByElementCount(h.card));S.setUseAttributeForm(true);l(h.did,U.fid);l(h.did,n.fid);X(U.fid,21,A.Latitude,V);X(n.fid,21,A.Longitude,V);}else{if((U||b.isLatitude(h.n))&&(!n&&!b.isLongitude(h.n))&&!S.geoAttribute&&!S.latitude){X(h.did,h.t,A.Latitude,V);S.setMapType(b.getMapTypeByElementCount(h.card));S.setUseAttributeForm(false);}else{if((!U&&!b.isLatitude(h.n))&&(n||b.isLongitude(h.n))&&!S.geoAttribute&&!S.longitude){X(h.did,h.t,A.Longitude,V);S.setMapType(b.getMapTypeByElementCount(h.card));S.setUseAttributeForm(false);}else{if(S.tooltip.indexOf(h.did)<0){X(h.did,h.t,A.AdditionalMetrics,V);}}}}}if(W){d();}break;}if(W){a.push({act:"setProperty",nodeKey:m.k,prs:"FormattingWidget",pri:4,v:mstrmojo.string.encodeXMLAttribute(S.getXml())});}return a;}function O(b,U,T,Z){var Y=T.gsi||{},c=Y.rows||[],W=Y.cols||[],V=Y.mx||[],S=[],R,X,Q,a;Z.clearCardinalityFlags();if(K.find(c.concat(W).concat(V),"did",b.did)===-1){a=!!K.filterOne(W,function(d){return d.t!==4;});Q=!!K.filterOne(c,function(d){return d.t!==4;});if(b.t===4){R=-1;if(V.length===0){if(!Q&&!!a){R=1;X=c.length;}else{R=2;X=W.length;}}X=V.length;}else{if(a&&!Q){R=2;X=W.length;Z.findLargeItemsForAddUnits([b]);Z.findTotalColumnCount([b],null);}else{R=1;X=c.length;}}S.push({act:"updateTemplate",keyContext:T.k,actions:[Z.getHost().model.getAddTemplateUnitAction(b,U,R,X)]});}return S;}mstrmojo.vi.models.DatasetDoubleClick=mstrmojo.provide("mstrmojo.vi.models.DatasetDoubleClick",{addObject:function(X,S,W){var R=C(W),Q=[],V=W.getHost();if(!X||!R){return Q;}var Y=R.visName||"Grid";switch(H.getDefinition(Y).id){case H.GRAPHMATRIX:Q=F(X,S,R,W);break;case H.ESRIMAP:Q=E(X,S,R,W,new P.ESRIMapHelper({data:R}));break;case H.GOOGLEMAP:Q=E(X,S,R,W,new P.GoogleMapHelper({data:R}));break;case H.HEATMAP:Q=J(X,S,R,W);break;case H.NETWORK:Q=D(X,S,R,W);break;case H.IMAGELAYOUT:Q=G(X,S,R,W);break;case H.CUSTOM:Q=(W.getCustomDropZones&&W.getCustomDropZones())?[]:O(X,S,R,W);break;default:Q=O(X,S,R,W);break;}if(S!==R.datasetId){var U=W.getHost().model.data.gsi;var T=U?(U.rows||[]).concat(U.cols||[]).concat(U.mx||[]):[];if(S&&(Q.length||mstrmojo.array.find(T,"did",X.did)!==-1)){Q.push({act:"editNode",nodeKey:V.k,datasetId:S});}}return Q;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.CheckBox","mstrmojo.array");var E=mstrmojo.hash,A=mstrmojo._FormatDefinition,F=mstrmojo.array;var D=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.TextBox",alias:"decimalPlaces",bindings:{m:G.modelBinding,value:function(){return this.m.DecimalPlaces||"2";},category:function(){var H=this.m.Category;this.onkeyup();}},onkeyup:function(H){if(/^\d{1,2}$/.test(this.value)){var O=this.m.DecimalPlaces,J=this.value;this.m.DecimalPlaces=J;if(O!=J&&this.negative){var K=this.parent[this.negative],M;if(K&&K.refreshFormatList){K.refreshFormatList();}else{M=mstrmojo.hash.clone(A[this.negative]);if(M){var N=J>0?".":"",I=N,L;for(L=0;L<Math.min(J,A.MaxNegativeDidigts);L++){N+=L%9;I+="0";}for(L=0;L<M.length;L++){M[L].n=M[L].n.replace(/\.\d{2}/g,N);M[L].f=M[L].f.replace(/\.\d{2}/g,I);}K.set("items",M);}}}}}});},B=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList",itemMarkupFunction:function(J,H,K){var I=J.r?"color: red":"";return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text" style="'+I+'">'+J.n+"</div></div>";},selectionPolicy:"reselect",bindings:{m:G.modelBinding,selectedIndex:function(){var H=F.find(this.items,"v",this.m.NegativeNumbers);if(H===-1){H=F.find(this.items,"f",this.m.Format);}this.singleSelect(H);return H==-1?3:H;},category:function(){var H=this.m.Category;this.onchange();}},onchange:function(H){if(this.parent.idx===F.find(A.Category,"v",this.m.Category)&&this.selectedItem){this.m.NegativeNumbers=this.selectedItem.v;this.m.set("Format",this.selectedItem.f||this.selectedItem.v);}},onmChange:function(H){if(this.m){var M=this.m.DecimalPlaces;if(M!=2){var K=mstrmojo.hash.clone(A[this.alias]);if(K){var L=M>0?".":"",I=L,J;for(J=0;J<Math.min(M,A.MaxNegativeDidigts);J++){L+=J%9;I+="0";}for(J=0;J<K.length;J++){K[J].n=K[J].n.replace(/\.\d{2}/g,L);K[J].f=K[J].f.replace(/\.\d{2}/g,I);}this.set("items",K);}}}},postCreate:function(){this.onmChange();}});},C=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList "+G.alias,itemMarkupFunction:function(I,H,J){return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">'+I.n+"</div></div>";},selectedIndex:0,bindings:{m:G.modelBinding,selectedIndex:function(I){var H=F.find(this.items,"v",this.m.Format);return H===-1?0:H;},category:function(){var H=this.m.Category;this.onchange();}},onchange:function(H){if(this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.set("Format",this.selectedItem.f||this.selectedItem.v);}}});};mstrmojo.NumberFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.NumberFormatter",cssClass:"mstrmojo-NumberFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){E.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:2}]},{cells:[{},{}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7940),cssClass:"category",cssText:"font-weight: bold"},{slot:"1,0",scriptClass:"mstrmojo.List",alias:"numberCategory",cssClass:"mstrmojo-FormatEditor-numberCategory",items:A.Category,selectionPolicy:"reselect",bindings:{m:"this.parent.parent.model",selectedIndex:function(){var H=this.m.Category,G=F.find(this.items,"v",(H==="pru"?-2:H));return(G===-1)?0:G;}},onchange:function(G){if(this.m){this.m.set("Category",this.selectedIndex===0?"pru":this.selectedItem.v);}}},{slot:"1,1",scriptClass:"mstrmojo.Container",alias:"numberSubpanelContainer",width:"300px",markupString:'<div id={@id} class="mstrmojo-FormatEditor-numberPanel-subpanel {@cssClass}"><div class="mstrmojo-FormatEditor-numberPanel-subpanel-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},postBuildRendering:function(){var G=mstrmojo.Container.prototype.postBuildRendering.apply(this);this.parent.numberCategory.singleSelect(this.parent.numberCategory.selectedIndex);return G;},children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item",idx:0,rows:1,cols:1,children:[{scriptClass:"mstrmojo.Label",text:" ",slot:"0,0"}],bindings:{visible:'this.parent.parent.parent.model.Category=="pru"',category:function(){var H=this.parent.parent.parent.model,G=this.parent.parent.parent.model.Category;if(H&&this.idx===F.find(A.Category,"v",G)){H.set("Format","");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item",idx:1,rows:1,cols:1,children:[{scriptClass:"mstrmojo.Label",text:" ",slot:"0,0"}],bindings:{visible:"this.parent.parent.parent.model.Category==9",category:function(){var H=this.parent.parent.parent.model,G=this.parent.parent.parent.model.Category;if(H&&this.idx===F.find(A.Category,"v",G)){H.set("Format","");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item fixed",idx:2,rows:3,cols:2,layout:[{cells:[{},{}]},{cells:[{},{}]},{cells:[{colSpan:2}]}],bindings:{visible:"this.parent.parent.parent.model.Category==0"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"FixedNegative",alias:"FixedDecimalPlaces",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"1,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.FixedNegative,refreshFormatList:function(){var H=this.parent,K=H&&H.FixedDecimalPlaces,N=H&&H.ThousandSeparator;if(!K||!N){return ;}var I=K.value||0,R=mstrmojo.hash.clone(A.FixedNegative),G=N.checked,Q=I>0?".":"",P=Q,O,M,L;for(M=0,L=Math.min(I,A.MaxNegativeDidigts);M<L;M++){Q+=M%9;P+="0";}var J;for(J=0;J<R.length;J++){O=R[J].n.replace(/\.\d{2}/g,Q);if(!G){O=O.replace("1,234","1234");}R[J].n=O;O=R[J].f.replace(/\.\d{2}/g,P);if(!G){O=O.replace(/#,##/g,"###");}R[J].f=O;}this.set("items",R);},alias:"FixedNegative",slot:"1,1"}),{scriptClass:"mstrmojo.ImageCheckBox",alias:"ThousandSeparator",label:mstrmojo.desc(2049),cssText:"width:auto;",bindings:{m:"this.parent.parent.parent.parent.model",checked:function(){var G=this.m.ThousandSeparator;if(G==null){G=-1;}return parseInt(G,10)!==0;}},oncheckedChange:function(){if(this.m&&this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.ThousandSeparator=this.checked?-1:0;this.parent.FixedNegative.refreshFormatList();}},slot:"2,0"}]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item currency",idx:3,rows:4,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==1"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"CurrencyNegative",alias:"currencyDecimal",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2047),slot:"1,0"},{scriptClass:"mstrmojo.TextBox",alias:"currencySymbol",maxLength:5,bindings:{m:"this.parent.parent.parent.parent.model",value:function(){return this.m.CurrencySymbol||mstrmojo.desc("2369");},category:function(){var G=this.m.Category;this.onkeyup();}},onkeyup:function(G){this._update();},onvalueChange:function(){this._update();},_update:function(){if(this.m){var H=this.m.CurrencySymbol;this.m.CurrencySymbol=this.value;var G=this.parent.CurrencyNegative;if(G&&(H!=this.value)){G.refreshFormatList();}}},slot:"1,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2048),slot:"2,0"},{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList",alias:"CurrencyPosition",items:A.CurrencyPosition,itemMarkupFunction:function(H,G,I){return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">'+H.n+"</div></div>";},bindings:{m:"this.parent.parent.parent.parent.model",selectedIndex:function(){var G=F.find(A.CurrencyPosition,"v",this.m.CurrencyPosition);return(G===-1?0:G);},category:function(){var G=this.m.Category;this.onchange();}},onchange:function(G){if(this.m){this.m.CurrencyPosition=this.selectedItem.v;var H=this.parent.CurrencyNegative;if(H){H.refreshFormatList();}}},slot:"2,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"3,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.CurrencyNegative,refreshFormatList:function(){var O=this.parent,J=O&&O.currencyDecimal,N=O&&O.CurrencyPosition,K=O&&O.currencySymbol;if(!J||!N||!K){return ;}var M=J.value||0,I=parseInt(N.selectedIndex,10)||0,H=K.value||"",L=mstrmojo.hash.clone(A.CurrencyNegative),Y=M>0?".":"",W=Y,Q,X,U;H=(I===2?H+" ":(I===3?" "+H:H));for(X=0,U=Math.min(M,A.MaxNegativeDidigts);X<U;X++){Y+=X%9;W+="0";}var P=mstrConfig.decimalSep,G=mstrConfig.thousandsSep,T;for(T=0;T<L.length;T++){var R=L[T].n,V=L[T].f,S;if(I===1||I===3){Q=V.split(";");for(S=0,U=Q.length;S<U;S++){Q[S]=Q[S].replace(/(\"\$\")(.*)/g,"$2$1");}R=R.replace(/(\$)(.*)/g,"$2$1");V=Q.join(";");}R=R.replace(/\$/g,H).replace(/\.\d{2}/g,Y);V=V.replace(/\$/g,H).replace(/\.\d{2}/g,W);L[T].n=R.replace(/,/,G).replace(/(\d{2,3})\./,"$1"+P);L[T].f=V.replace(/,/,G).replace(/(\d{2,3})\./,"$1"+P);}this.set("items",L);},alias:"CurrencyNegative",slot:"3,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Date",idx:4,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==2"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Date,alias:"Date",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Time",idx:5,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==3"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Time,alias:"Time",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item percentage",idx:6,rows:2,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==4"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"PercentNegative",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044,"Negative numbers"),slot:"1,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.PercentNegative,alias:"PercentNegative",slot:"1,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Fraction",idx:7,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==5"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Fraction,alias:"Fraction",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item scientific",idx:8,rows:1,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"})],bindings:{m:"this.parent.parent.parent.model",visible:"this.m.Category==6",category:function(){if(this.m&&this.idx===F.find(A.Category,"v",this.m.Category)){this.m.set("Format","0.00E+00");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item custom",idx:9,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==7"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2133),slot:"0,0"},{scriptClass:"mstrmojo.TextBox",alias:"custom",value:"",bindings:{m:"this.parent.parent.parent.parent.model",value:function(){return this.m.Format;}},onvalueChange:function(){if(this.m&&this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.Format=this.value;}},slot:"0,1"}]}]}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var M=mstrmojo.Widget,G=mstrmojo.dom,N=mstrmojo.global.document,C=50,B=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:M.visibleMarkupMethod,onheightChange:M.heightMarkupMethod,onwidthChange:M.widthMarkupMethod,onenabledChange:function I(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},preBuildRendering:function J(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function A(O){if(G.contains(this.textNode,O)||O===this.titleNode){return ;}var Q=this.provider,P=((O===this.nextNode)?"Next":"Prev");if(Q["has"+P]()){Q[P.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function E(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function F(O,P){var Q=this;this._holdTimer=setInterval(function(){Q[P](O);},C);},stopStepperInterval:function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function L(O){this.processEvent(O.e.target);},onmousedown:function D(O){if(!this._holdTimer&&!this._startHoldTimer){var P=this;this._startHoldTimer=setTimeout(function(){delete P._startHoldTimer;P.startStepperInterval(O,"onclick");},B);G.attachOneTimeEvent(N,"mouseup",function(){if(P._startHoldTimer){clearTimeout(P._startHoldTimer);delete P._startHoldTimer;}P.stopStepperInterval();},true);}},onselectstart:function K(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.ThreeColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ThreeColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-ThreeColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider1"'+D+'></div><div class="vi-col2"'+D+'></div><div class="divider2"'+D+'></div><div class="vi-col3"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},divider1Node:function H(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.childNodes[2];},divider2Node:function B(){return this.domNode.childNodes[3];},col3Node:function E(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"30%",divider1Node:"5px",col2Node:"30%",divider2Node:"5px",col3Node:"40%"},xt:true},shouldPropagateEnabled:true,col1Width:"30%",divider1Width:"5px",col2Width:"30%",divider2Width:"5px",col3Width:"40%",init:function G(I){this._super(I);var J=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),K=J.w;K.col1Node=this.col1Width;K.divider1Node=this.divider1Width;K.col2Node=this.col2Width;K.divider2Node=this.divider2Width;K.col3Node=this.col3Width;},getControl:function F(I){return(this.children||[]).filter(function(J){return J.slot==="col"+I+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder");mstrmojo.rw.DocSubsection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder],{scriptClass:"mstrmojo.rw.DocSubsection",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSubsection" style="{@domNodeCssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},formatHandlers:{domNode:["D","B","background-color","fx"]},update:function C(E){var D=E.data.tid;if(this.thresholdId||D){delete this.fmts;}this.thresholdId=D;if(this._super){this._super(E);}},postBuildRendering:function B(){return(this.renderMode!=="scroll")?this._super():true;},childRenderOnAddCheck:function A(D){return(this.renderMode!=="scroll")?this._super(D):false;},preserveChildDomOrder:false,performCanGrowCanShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.css");var J=1,G=2,H=4,E=8,I=16,F=32;function A(P,O,M,N,Q,L){return mstrmojo.Button.newWebButton(P,function(R){this.parent.set("_targetMode",O);R.cancel();},M,{alias:N,flgVis:Q,flgEnabled:L||undefined});}mstrmojo.vi.ui.TargetSelector=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.vi.ui.TargetSelector",markupString:'<div id="{@id}" class="mstrmojo-TargetSelector {@cssClass}" style="{@cssText}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},init:function K(L){this._super(L);if(!this.hostId){throw new Error("You must pass the hostId when instantiating mstrmojo.vi.ui.TargetSelector.");}this._targetMode=J;},hostId:null,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,on_targetModeChange:function(){var O=this._targetMode,N=mstrmojo.all[this.hostId],M=N.parent,Q=this.id;this.children.forEach(function(R){R.set("visible",(R.flgVis&O)>0);R.set("enabled",(!R.flgEnabled||(R.flgEnabled&O)>0));});this.set("visible",O!==J);var P=O===F;if(P||O===G){M.exitTargetSelectionMode(P);if(!P){this.set("_targetMode",this._cancelMode);}N.generateToolbar();}else{if(O===E){M.enterTargetSelectionMode(function(S,T){var R=T?J:E;if(!T&&S.length){R=I;}mstrmojo.all[Q].set("_targetMode",R);if(T){N.setTargets(S);}},N.id,N.getTargetKeys());}}var L=mstrmojo.vi.VisualInsightApp.APP_STATES;mstrApp.set("appState",O===E||O===I?L.SELECTOR_TARGETING:L.DEFAULT);}},ignoreLayout:true,enterPreSelectMode:function B(){this._cancelMode=H;this.set("_targetMode",H);},enterSelectMode:function D(){this._cancelMode=J;this.set("_targetMode",E);},enterOffMode:function C(){this._cancelMode=J;this.set("_targetMode",J);},children:[A(mstrmojo.desc(4799,"Select Target"),E,true,"btnSelect",H),A(mstrmojo.desc(221,"Cancel"),G,false,"btnCancel",E+I),A(mstrmojo.desc(134,"Apply"),F,true,"btnApply",E+I,I)]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder","mstrmojo._SupportsEllipsisText","mstrmojo._HasEllipsis","mstrmojo.css","mstrmojo.array");var V=mstrmojo.css,U=mstrmojo.array;var R=2;function D(Z,X,Y){var a=Z.parent.parent;if(a&&a instanceof mstrmojo.DocPanel){a[X+"DirtyKey"](Y);}}function O(Y,X,Z){if(Y===X.k){mstrmojo.array.forEach(X.children,function(a){if(a.setDirtyChildren){a.setDirtyChildren(Z);}});}}function I(X){return X._isFP()&&!X.parent.defn.od;}mstrmojo.DocPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder,mstrmojo._SupportsEllipsisText,mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.DocPanel",visible:false,selected:false,k:"",cssDisplay:"block",subPanelCssText:"height:100%;width:100%;position:absolute;",topStart:R,contentWidth:0,markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="{@containerNodeCssText}{@subPanelCssText}"></div></div>',markupMethods:{onvisibleChange:function(){var Y=this.domNode.style,X=this.visible;if(I(this)){Y.visibility=(X?"":"hidden");Y.zIndex=(X?10:1);}else{Y.display=(X?this.cssDisplay:"none");}}},markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{containerNode:["background-color","fx","overflow"]},title:"",init:function Q(X){this._super(X);if(!this.title){this.title=this.node.defn.ttl||"";}if(this._isSearchBoxPanel()){this.isSbp=true;this.set("canApplySbp",false);}},childRenderCheck:function L(X){return(this._super(X)&&(this.selected||I(this)));},postBuildRendering:function T(){if(!this.defn.l&&!this._forceRender){V.addClass(this.domNode,"placeholder");}var Y=this._super();if(this.isSbp){var X=this.addChildren({scriptClass:"mstrmojo.Button",cssClass:"sbp-apply",title:mstrmojo.desc(134,"Apply"),cssText:"top:"+((parseInt(this.parent.fmts.height,10)||0)-28)/2+"px",bindings:{enabled:"this.parent.canApplySbp&&this.parent.parent.applyEnabled"},onclick:function(){this.parent.parent.applyBufferedSlices();}});X.render();}if(this._isFSP()){this.set("shouldEllipsize",true);}if(mstrApp.isOIVM&&mstrApp.isOIVM()&&mstrmojo.dom.isChrome){var a=this.containerNode.style.overflow;this.containerNode.style.overflow="hidden";var Z=this;window.setTimeout(function(){if(Z.containerNode&&Z.containerNode.style&&Z.containerNode.style.overflow){Z.containerNode.style.overflow=a;}},2000);}return Y;},onselectedChange:function M(X){if(X.value){this.renderChildren();}this.model&&this.model.raiseEvent({name:"panelSelected",panelId:this.id,panelVisible:!!X.value});},updateForPU:function S(X){this.node=X;this.update(X);},refreshForPU:function A(){this._isPartial=true;this.refresh();this._isPartial=false;},_isPartial:false,refresh:function E(){if(!this.hasRendered){return ;}this._inRendering=true;var Z=[].concat(this.getPanelChildren()||[]),Y=[].concat(this.getChildren(this._isPartial)),X;U.removeItems(Z,"k",Y);U.removeItems(Y,"k",this.getPanelChildren());if(Z.length!==0){U.forEach(Z,function(a){this.removeChildren(a);a.destroy();},this);}if(Y.length!==0){U.forEach(Y,function(c){var b=c.id&&mstrmojo.all[c.id];var a=b&&b.defn;if(a){a._isDeleted=true;}if(b&&b.destroy){b.destroy();}},this);this.addChildren(this.builder.build(Y,this.model,this.buildConfig));}Z=[].concat(this.getPanelChildren()||[]);for(X=Z.length-1;X>=0;X--){Z[X].refresh();}if(this._isFP()&&this.selected){this.refreshFP();}if(this._isFSP()){this.set("richTooltip",{content:this.containerNode.innerHTML,contentNodeCssClass:"sp-tooltip",left:-20,top:20,refNode:this.domNode});this.ellipsizeElements("div",this.containerNode,true);}this._inRendering=false;},setDirty:function N(X){this[(X?"add":"remove")+"DirtyKey"](this.k);},addDirtyKey:function H(X){var Z=this.defn,Y=Z.dirtyKeys||{};Y[X]=true;Z.dirtyKeys=Y;if(X===this.k){mstrmojo.array.forEach(this.children,function(a){if(a.setDirtyChildren){a.setDirtyChildren(true);}});}O(X,this,true);D(this,"add",X);},removeDirtyKey:function K(Y){D(this,"remove",Y);O(Y,this,false);if(Y===this.k){mstrmojo.array.forEach(this.children,function(a){if(a.setDirtyChildren){a.setDirtyChildren(false);}});}var Z=this.defn,X=Z.dirtyKeys;if(!X){return ;}delete X[Y];if(!mstrmojo.hash.isEmpty(X)){return ;}delete Z.dirtyKeys;},getPanelChildren:function G(){return U.filter(this.children||[],function(X){return X.scriptClass!=="mstrmojo.Button";});},preBuildRendering:function(){if(this._isFSP()){this.useRichTooltip=true;}if(this._super){this._super();}},renderChildren:function J(){this._inRendering=true;var d=this.children;if(d&&(this._isFP()||this._isFSP())){U.forEach(d,function(g){g.getFormats();});}if(this.isSbp){V.addClass(this.domNode,"mstrmojo-sbp");}if(this._isFP()){V.addClass(this.parent.domNode,"fpgb");if(d){var e=this.domNode.clientWidth-2*R,b,X;this.topStart=R+1;for(b=0,X=(d&&d.length)||0;b<X;b++){var Z=this.domNode.clientWidth-2*R;this.contentWidth=(Z>0)?Z:0;if(Z!==e){this.topStart=R+1;var a;for(a=0;a<b;a++){var Y=d[a];Y.refresh();if(Y.getContainerHeight){this.topStart+=Y.getContainerHeight()+R+1;}}}var f=d[b];if(this.childRenderCheck(f)){f.render(null);if(f.getContainerHeight){this.topStart+=f.getContainerHeight()+R+1;}}}}}else{this._super();}if(this._isFSP()){this.set("richTooltip",{content:this.containerNode.innerHTML,contentNodeCssClass:"sp-tooltip",left:-20,top:20,refNode:this.domNode});this.ellipsizeElements("div",this.containerNode,true);}this._inRendering=false;},refreshFP:function F(){if(!this.hasRendered){return ;}var a=this.children,X=(a&&a.length)||0,Z;this.topStart=R+1;var Y=this.domNode.clientWidth-2*R;this.contentWidth=(Y>0)?Y:0;for(Z=0;Z<X;Z++){var b=a[Z];if(b.relocate){b.relocate(this.topStart,this.contentWidth);}if(b.updateContentHeight){b.updateContentHeight();}if(b.getContainerHeight){this.topStart+=b.getContainerHeight()+R+1;}}},getChildren:function C(a){var Z=this.model.getChildren(this.node,a);if(this._isFP()||this._isFSP()){var X=(Z&&Z.length)||0,Y;for(Y=0;Y<X;Y++){var b=Z[Y];if(this._isFP()&&!b.defn.iifp){b.defn.iifp=true;}if(this._isFSP()&&!b.defn.iifs){b.defn.iifs=true;}}}Z=U.filter(Z||[],function(c){if(typeof c.defn.ifw==="boolean"){return !c.defn.ifw;}return true;});return Z;},onchildRenderingChange:function B(X){this._super(X);if(this._isFSP()&&!this._inRendering){this.ellipsizeElements("div",this.containerNode,true);}},_isFP:function W(){return !!this.parent.defn.ifp;},_isFSP:function P(){return !!this.parent.defn.ifsp;},_isSearchBoxPanel:function(){return false;},canApplySearchBoxPanel:function(){var Y=this.model.getChildren(this.node,false),X;for(X=0;X<Y.length;X++){var a=Y[X],Z=mstrmojo.all[a.id];if(Z&&Z.canApply&&!Z.canApply()){return false;}}return true;},doEllipsize:function(){if(this.shouldEllipsize){this.ellipsizeElements("div",this.containerNode,true);}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Container","mstrmojo._Formattable","mstrmojo._IsThresholdConditionTarget","mstrmojo.EnumRWUnitType");var TP_HTML_CONTAINER=mstrmojo.EnumRWUnitType.HTMLCONTAINER;var $DOM=mstrmojo.dom,$HASH=mstrmojo.hash;mstrmojo.DocTextfield=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsThresholdConditionTarget],{scriptClass:"mstrmojo.DocTextfield",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@v}</div>{@buttonNodeMarkup}</div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","P","background-color","fx","text-align","white-space","overflow"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function update(node){var d=node.data,v=d.v||"";if(node.defn.t===TP_HTML_CONTAINER){var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value;div=null;}this.v=v;this.tooltip=d.tooltip||this.tooltip;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.set("visible",!node.data.hidden);if(this._super){this._super(node);}},init:function(props){this._super(props);},postBuildRendering:function postBuildRendering(){var i,len;this.handleRotatedText();if(this.defn.t===TP_HTML_CONTAINER){var scripts=this.domNode.getElementsByTagName("script");for(i=0,len=scripts.length;i<len;i++){try{eval(scripts[i].innerHTML);}catch(err){console.log(err);}}}return this._super();},isTextFieldRotated:function isTextFieldRotated(){var formats=this.getFormats();return(formats.fx&&formats.fx.rt&&!$DOM.isDXIE&&$DOM.supports($DOM.cssFeatures.TEXT_ROTATION));},handleRotatedText:function handleRotatedText(){var formats=this.getFormats(),rotateValue=formats.fx&&formats.fx.rt;if(this.isTextFieldRotated()){var domNode=this.domNode,domNodeStyle=domNode.style;switch(rotateValue){case 1:domNodeStyle.left=(parseInt(formats.left,10)+domNode.offsetHeight)+"px";break;case 3:domNodeStyle.top=(parseInt(formats.top,10)+domNode.offsetWidth)+"px";break;}}},getAnchor:function getAnchor(){return this.valueNode;}});mstrmojo.DocSummaryTextfield=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocSummaryTextfield",markupString:'<span id="{@id}" class="mstrmojo-DocSumTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><span class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@openLink}{@v}{@closeLink}</span>{@buttonNodeMarkup}</span>',formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","background-color","fx","text-align","white-space","overflow"]},update:function update(node){this._super(node);if(this.v){var v=this.v,p1=new RegExp("&lt;bold&gt;","g"),p2=new RegExp("&lt;/bold&gt;","g");if(v.indexOf("&lt;empty/&gt;")>-1){this.v="";return ;}v=v.replace(p1,"<b>");v=v.replace(p2,"</b>");this.v=v;}},preBuildRendering:function preBuildRendering(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.color","mstrmojo.dom","mstrmojo.css","mstrmojo._HasOwnAvatar","mstrmojo.Container","mstrmojo.threshold.ThresholdModel");var Q=mstrmojo.color,F=mstrmojo.dom,I=mstrmojo.css;function G(T){var S=this.parent,R=S.width,U=Math.min(Math.max(T.last.x-F.position(this.domNode).x,0),R-1);return U/R;}mstrmojo.threshold.MarkersNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.MarkersNode",cssClass:"markers",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"  mstrAttach:click,mousedown,mouseover,mouseout></div>',markupSlots:{containerNode:function D(){return this.domNode;}},dropZone:true,draggable:true,avatarCssClass:"marker-drag-avatar",addMarker:function J(R){this.parent.parent.switchToCustomScheme();var V=this.parent,T=F.position(this.containerNode).w,S=V.getPalette(),X=V.addMarkerToMap(R/T),U=S.length;if(U===(X+1)){X--;}var Y=S[X+1],W=X===-1?Y:S[X];S.splice(X+1,0,Q.findMidColorHex(W,Y));V.update();},remove:function H(T){var S=this.parent.getComp(),R=this.parent.getPalette();S.splice(T,1);R.splice(T+1,1);},onclick:function O(S){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&S.getTarget()===this.domNode){var T=F.position(this.containerNode),R=S.e.clientX-T.x;this.addMarker(R);}},premousedown:function N(){this.parent.unselectAll();},createAvatar:function B(U,T){var S;for(S=0;S<this.children.length;S++){if(this.children[S].id===U.id){T.tgtNode=this.children[S];T.i=S;}}var R=U.cloneNode(true),V=document.createElement("div");I.addClass(V,"bar");R.appendChild(V);return R;},positionAvatar:function L(X){var R=this.avatar,T=R.style,V=this.restrictedToAxis,S=F.position(this.domNode),U=S.y;if(R){if(V!=="y"){var W=X.x;if(W<S.x){W=S.x;}if(W>S.x+S.w){W=S.x+S.w-1;}T.left=W-2+"px";}if(V!=="x"){T.top=U+"px";}}},isDragValid:function K(R){return R.src.node!==this.domNode;},ondragstart:function C(S){this._super(S);var R=this.parent.getComp();this.removeChildren(this.children[S.i]);R.splice(S.i,1);},ondragmove:function A(R){this._super(R);this.parent.editableBubble.showBubble(G.call(this,R));},ondragend:function E(T){var S=this.parent,R=S.addMarkerToMap(G.call(this,T));S.update();this.children[R].set("selected",true);this._super(T);},onmouseover:function P(S){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&!this._cursorAvatar){var V=document,U=this.domNode,T=this._cursorAvatar=V.createElement("div"),R=this._mouseMoveHandler=function(Z){var Y=F.eventTarget(self,Z),X=F.getMousePosition(Z,self),W=T.style;W.top=X.y+12+"px";W.left=X.x+12+"px";W.display=(Y===U&&mstrApp.isInteractive())?"block":"none";};V.body.appendChild(T);I.addClass(T,"mstrmojo-SimpleThresholdEditor add-cursor");F.attachEvent(U,"mousemove",R);}if(this._super){return this._super(S);}},onmouseout:function M(R){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED){F.detachEvent(this.domNode,"mousemove",this._mouseMoveHandler);var S=this._cursorAvatar;S.parentNode.removeChild(S);delete this._cursorAvatar;delete this._mouseMoveHandler;}if(this._super){return this._super(R);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var B=mstrmojo.func,C=mstrmojo.dom,F="mstrmojo-popup-widget-hosted";mstrmojo.ui.PopupButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ui.PopupButton",onPopupWidgetClosed:mstrmojo.emptyFn,onPopupWidgetOpened:mstrmojo.emptyFn,anchorSlot:"domNode",isHostedWithin:true,hostedCSSClass:"",destroy:function H(L){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(L);},getPopupWidget:mstrmojo.emptyFn,postCreateChildren:function D(){var L=this.getPopupWidget();if(!L||L._pbCfg){return ;}var M=function M(O,N){return function(){O.apply(N,arguments);};};L.onOpen=B.composite([M(this.onPopupWidgetOpened,this),L.onOpen||mstrmojo.emptyFn]);L.onClose=B.composite([M(this.onPopupWidgetClosed,this),L.onClose||mstrmojo.emptyFn]);L._pbCfg=true;},onclick:function K(L){var N=L.getTarget();if(N===this[this.anchorSlot]||N.parentNode===this[this.anchorSlot]){var M=this.getPopupWidget();if(!M.visible){this.openPopup(M);}else{this.closePopup();}}},onPopupAutoClosed:function I(M,L){if(C.contains(this[this.anchorSlot],C.eventTarget(L,M),true)){return false;}},getPopupHostNode:function J(){return this.containerNode;},getPopupConfig:function G(){var M=[F],L=this.hostedCSSClass;if(L){M.push(L);}return new mstrmojo.ui.PopupConfig({hostId:this.id,hostElement:this.getPopupHostNode(),anchorElement:this[this.anchorSlot],isHostedWithin:this.isHostedWithin,hostProxyCssClass:M.join(" ")});},unrender:function E(L){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);delete this._listenerProc;}this._super(L);},postBuildRendering:function A(){var P=this.getPopupWidget();if(P){var R=this.getPopupConfig();if(!R.isHostedWithin){var N=this.parent||this.opener,M=R.hostProxyCssClass.split(" ");M.push(this.domNode.className);while(N){var Q=N.themeClassName;if(Q){M.push(Q);break;}N=N.parent||N.opener;}R.hostProxyCssClass=M.join(" ");}P.popupConfig=P.addDisposable(R);}var L=P.id,O=this._listenerProc=function(){var S=mstrmojo.all[L];if(S&&S.visible&&S.adjustCornersForPopupOverflow){S.adjustCornersForPopupOverflow();}};if(this.isHostedWithin===false){C.attachEvent(window,"resize",O);}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui._HasScroller");var D=mstrmojo.Widget;mstrmojo.ui.ScrollableContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ScrollableContainer {@cssClass}" style="{@cssText}"><div class="ScrollableContainer-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:D.visibleMarkupMethod,onheightChange:D.heightMarkupMethod,onwidthChange:D.widthMarkupMethod},setupScrollNodes:function C(){this.scrollNode=this.containerNode;},onOpen:function B(){this.updateScrollbars();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Widget","mstrmojo.css","mstrmojo.dom");var Y=mstrmojo.css,F=mstrmojo.dom;var Z={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};function A(){var c=this.value,b=this.inputNode,d=b.value,a=(c!==null&&c!==undefined)?String(c):"";if(a!==d&&(!this.keepEmpty||d!==this.emptyText)){b.value=a;}if(b.mstrmojoEmpty){Y.removeClass(b,[this.emptyClass]);b.mstrmojoEmpty=null;}}function X(){var a=this.inputNode;a.value=this.emptyText||"";Y.addClass(a,[this.emptyClass]);a.mstrmojoEmpty=true;}function N(){var a=this.inputNode;if(a){this.readingDom=true;this.set("value",a.value);this.readingDom=false;}}function U(a){var b=this;if(a===-1){N.call(this);}else{if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete b._lastTimeoutId;N.call(b);},a||100);}}mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",emptyText:"",keepEmpty:false,emptyClass:"mstrmojo-empty",valueChangeDelay:-1,textValid:true,autoComplete:true,autoCorrect:true,autoCapitalize:true,markupString:'<input id="{@id}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click,keydown  tstid="{@tstid}"/>',markupSlots:{inputNode:function D(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,oncssClassChange:function S(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function O(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function E(){var a=this.inputNode;a.disabled=!this.enabled;Y.toggleClass(a,"disabled",!this.enabled);},onvalueChange:function P(){var a=this.value,b=(a===undefined)||(a===null)||(a==="");if(b){if(!this.hasFocus){X.call(this);}else{this.inputNode.value="";}}else{A.call(this);}if(F.isIE9){this.inputNode.type=b?"text":this.type;}},ontooltipChange:function R(){this.domNode.title=this.tooltip;},onreadOnlyChange:function H(){this.inputNode.readOnly=this.readOnly;},ontextValidChange:function B(){Y.toggleClass(this.inputNode,["err"],!this.textValid);}},postBuildRendering:function V(){this._super();var a=this.inputNode;a.setAttribute("autocomplete",this.autoComplete?"on":"off");a.setAttribute("autocorrect",this.autoCorrect?"on":"off");a.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function Q(){if(this.inputNode&&this.inputNode.offsetParent){try{this.inputNode.focus();}catch(a){}}},prefocus:function M(){this.hasFocus=true;A.call(this);},blur:function T(){this.inputNode.blur();},preblur:function W(){window.setTimeout(function(){},200);this.hasFocus=false;N.call(this);var a=this.value;if(((a===null||a==="")&&this.emptyText)||(this.keepEmpty&&a===this.emptyText)){X.call(this);}},prekeyup:function I(b){var a=b.hWin,c=b.e||a.event;U.call(this,this.valueChangeDelay);var d=Z[c.keyCode];if(this["on"+d]){this["on"+d](b);}},preinput:function J(){U.call(this,this.valueChangeDelay);},prepaste:function K(){U.call(this);},precut:function G(){U.call(this);},setInvalidState:function C(a){this.set("textValid",true);if(a){this.domNode.setAttribute("title",a);}},cleanUp:function L(){this.inputNode.value="";this.set("textValid",false);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.TwoColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-TwoColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider"'+D+'></div><div class="vi-col2"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},dividerNode:function B(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"40%",dividerNode:"5px",col2Node:"60%"},xt:true},shouldPropagateEnabled:true,col1Width:"40%",dividerWidth:"5px",col2Width:"60%",init:function F(G){this._super(G);var H=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),I=H.w;I.col1Node=this.col1Width;I.dividerNode=this.dividerWidth;I.col2Node=this.col2Width;},getControl:function E(G){return(this.children||[]).filter(function(H){return H.slot==="col"+G+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.FieldSet=mstrmojo.declare(mstrmojo.Container,null,{legend:null,scriptClass:"mstrmojo.FieldSet",markupString:'<fieldset id="{@id}" class="mstrmojo-FieldSet {@cssClass}" style="{@cssText}"><legend class="{@cssClass}-legend">{@legend}</legend></fieldset>',markupSlots:{legendNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode;}},markupMethods:{onlegendChange:function(){this.legendNode.innerHTML=mstrmojo.string.encodeHtmlString((this.legend!=null)?this.legend:"");},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable");var D=function D(F){return F.data.dl||F.defn.dl;};mstrmojo.DocImage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocImage",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocImage" title="{@tooltip}" style="{@domNodeCssText}"><div style="{@shadowNodeCssText}"><img src="{@v}" style="{@imgNodeCssText}" mstrAttach:click></div>{@buttonNodeMarkup}</div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function E(H){var I=this.model.getDataService(),F=H.data.v,G=D(H);this.origV=F;this.v=(I&&I.getImage&&I.getImage(F))||F;this.oid=H.defn.oid;if(G){this.tooltip=G.items[0].n;}if(this.thresholdId||H.data.tid){delete this.fmts;}this.thresholdId=H.data.tid;this.set("visible",!H.data.hidden);if(this._super){this._super(H);}},formatHandlers:{domNode:["left","top","z-index"],shadowNode:["width","height","B","fx"],imgNode:["height","width"]},preBuildRendering:function B(){this._super();if(mstrApp.isMobile&&mstrApp.useBinaryFormat){var F=this.v,I=mstrMobileApp.isOnline(),H=this.model.getDataService();if((!I&&F.indexOf("http")===0)||(I&&F.indexOf("http")!==0)){this.v=(H&&H.getDocImage&&H.getDocImage(this.origV))||F;}}var G=mstrmojo.string;if(this.node.data.ut===4){this.v=mstrConfig.taskURL+"?taskId=getRWEmbeddedImage&msgID="+this.model.mid+"&oid="+G.decodeHtmlString(this.v,true);}this.updateDimensionsFromFormats();},updateDimensionsFromFormats:function C(){if(!mstrmojo.dom.isIE7){var F=this.getFormats(),I=(F.fx&&F.fx.ds)||0,G=mstrmojo._Formattable.getBorderWidths(this),H=1;if((mstrmojo.dom.isIE||mstrmojo.dom.isIEW3C)&&this.model.getZoomFactor){H=this.model.getZoomFactor()>1?this.model.getZoomFactor():1;G.w=Math.ceil(G.w*H);G.h=Math.ceil(G.h*H);}this.domNodeCssText+="width:"+((parseInt(F.width,10)||0)+I+G.w)+"px; height: "+((parseInt(F.height,10)||0)+I+G.h)+"px;";}},getAnchor:function A(){return this.imgNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K.slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.TBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TBox",markupString:'<table id="{@id}" class="mstrmojo-TBox {@cssClass}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}" style="{@cssText}"><tbody><tr><td></td></tr></tbody></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},cellSpacing:0,cellPadding:0});(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton mstrButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton mstrButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Button","mstrmojo.EnumRWUnitType","mstrmojo.vi.models.VIComponentMap","mstrmojo.VisEnum");mstrmojo.requiresDescs(14292,14293,14607);var F=mstrmojo.array,B=12,A=1,E=2,D=mstrmojo.Button.newWebButton,C=mstrmojo.vi.models.VIComponentMap.TYPES;mstrmojo.vi.models._CheckDataCards=mstrmojo.provide("mstrmojo.vi.models._CheckDataCards",{_mixinName:"mstrmojo.vi.models._CheckDataCards",CARDLIMIT:mstrmojo.VisEnum.VIS_CARDLIMIT.NON_GRID,isUnitRestrictedInViz:function(){var G=this.docModel,H=[],I=G.getVIComponent(C.FILTER_PANEL),J=I&&I.parent;H=H.concat((J&&J.getFilterDefinitions())||[]);return H.length;},_addInLargeItems:[],_columnCardinalityCount:1,clearCardinalityFlags:function(){this._addInLargeItems=[];this._columnCardinalityCount=1;},existLargeOrManyItems:function(){return(!!this._addInLargeItems.length||this._columnCardinalityCount>this.CARDLIMIT);},findTotalColumnCount:function(L,M){var N=this,P,I=1,K=0,O=this.getHost().gridData;N._columnCardinalityCount=1;if(O){if(M&&M.id===A){var G=O.rw,Q=G&&G.row;N._columnCardinalityCount=(Q&&Q.tc)||1;return ;}var H=O.ghs,J=H&&H.chs;F.forEach(J&&J.items,function(R){if(R.items){I=Math.max(I,R.items.length);}});}F.forEach(L,function(R){if(M&&M.id===E){M.items.every(function(S){if(S.t===B&&S.did===R.did&&S.card){K++;I=I/S.card;return false;}return true;});}P=R.cardg>0?R.cardg:R.card;if(!P&&R.otp===B&&R.es){P=R.es.length+1;}if(P){I=I*P;}});N._columnCardinalityCount=(K===L.length)?1:I;},findLargeItemsForAddUnits:function(G,H,J){var I=this,K;if((!H&&!I.isUnitRestrictedInViz())||H){G.forEach(function(M){var L=M.cardg>0?M.cardg:M.card;K=!!J?J:I.CARDLIMIT;if(L&&L>K){I._addInLargeItems.push(M.n+" ("+L+")");}});}},warnAndExecCallBackForAddUnits:function(M,L,I){if(this.existLargeOrManyItems()){var J=this._addInLargeItems,K=J.length,H;if(K>1){H=mstrmojo.desc(14292,"The following attributes contain a large number of elements: ##. This action may impact dashboard performance.").replace("##",J);}else{if(K===1){H=mstrmojo.desc(14293,"The attribute ## has too many elements. This action may impact dashboard performance.").replace("##",J);}else{H=mstrmojo.desc(14607,"The dashboard will attempt to display more than ### columns. This can affect performance and stability.").replace("###",this.CARDLIMIT);}}var G=[];if(K&&L){G.push(D(mstrmojo.desc(7977,"Move to Rows"),function(){L();},true));}G.push(D(mstrmojo.desc(212,"Continue"),function(){M();}));G.push(D(mstrmojo.desc(2140,"Cancel"),function(){if(I){mstrmojo._DocToolbarActions.close.call({model:{isnew:false}});}}));mstrmojo.warn(H,{},{buttons:G});J.splice(0,J.length);return ;}M();},checkAndWarnLargeItemsForAddUnits:function(J,M,L,G,I,H,K){this.clearCardinalityFlags();if(!I||I.id===E){this.findLargeItemsForAddUnits(J,H,K);}if(G){this.findTotalColumnCount(J,I);}this.warnAndExecCallBackForAddUnits(M,L,H);}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.hash","mstrmojo.Button","mstrmojo.css");var A=mstrmojo.EnumRWUnitType,N=mstrmojo.hash,B={},P=mstrmojo.Button.newWebButton,K=mstrmojo.array;B[A.HEADER]=B[A.FOOTER]=B[A.PAGEHEADER]=B[A.PAGEFOOTER]=B[A.DETAILS]={n:"Section"};B[A.HTMLCONTAINER]={n:"HTMLContainer"};B[A.SELECTOR]={n:"Selector"};B[A.GRID]={n:"Xtab"};B[A.MOJOVISUALIZATION]={n:"MojoVisualization"};function C(W){return(W&&W.t)||mstrmojo.EnumRWUnitType.LAYOUT;}mstrmojo.DocBuilder=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocBuilder",visList:null,selectorFactory:null,classMap:null,init:function R(W){this._super(W);var X=this.selectorFactory=this.createSelectorFactory();this.addDisposable(X);this.classMap=this.createClassMap();},createSelectorFactory:function V(){this.throwAbstractMethodError("getSelectorFactory");},createClassMap:function E(){return N.copy(B);},getMojoVisName:function S(Z){var a="",Y=Z.data,W=C(Z.defn),X=Y&&Y.vis;if(X&&(W===A.GRID||W===A.GRAPH||W===A.GRIDGRAPH)){if(X.vn&&X.ve&&X.vm===51){a=X.vn;}else{if(X.we&&X.wcn){a=this.visList.findVisName(X.wcn);}}}return a;},build:function M(W,d,n){var l=this.classMap,e=[],g=((W&&W.length)||0),c,Z,a,X,b,Y,k,h,m;for(c=0;c<g;c++){Z=W[c];a=Z&&Z.defn;X=Z&&Z.data;b=C(a);Y=l[b];if(b===A.TEXTFIELD&&((a&&a.dpst))){Y=l[b+"B"];}k=X&&(X.visName||X.vis&&this.getMojoVisName(Z));if(k){X.visName=k;Y=B[A.MOJOVISUALIZATION];}h=(Y&&Y.n)?"new"+Y.n:"";m=undefined;if(this[h]){m=this[h](d,Z,Y,n);}else{if(Y&&Y.scriptClass){var f=Y.cls;if(!f){f=N.walk(Y.scriptClass,window);}if(f){m=this.newRWUnitInstance(d,Z,f);}}}if(m){m.k=Z.k;m.builder=this;m.tooltip=X.tooltip||a.tooltip||"";if(!m.defn){m.defn=a;m.disposables.push(m.defn);}if(m.update){m.update(Z);}if(this.isPortlet(a)){m=this.createPortlet(b,Z,m,n);}if(!this.extractWidget(m,Z)){e.push(m);}}}return e;},createPortlet:function G(X,Y,W,Z){return W;},newRWUnitInstance:function Q(W,Y,Z,X){return new Z(N.copy(X||{},{id:Y.id,node:Y,controller:this.parent.controller,model:W}));},newSection:function T(W,X){this.throwAbstractMethodError("newSection");},newSelector:function J(Y,Z,X,a){var W=this.selectorFactory.newDocSelector(Y,Z,X,a);W.controller=this.parent.controller;return W;},isPortlet:function O(W){return !!((W.t!==A.PANEL&&W.ttl!==undefined)||W.qsm);},extractWidget:function L(X,W){return !X;},getDefaultMojoVisModel:function H(){this.throwAbstractMethodError("getDefaultMojoVisModel");},newMojoVisualization:function(c,l){var n=this.visList,X=l.data,m=n.getVis(X.visName),r=m&&((m.dc!==undefined)?m.dc:m.c),t=this;if(!m){var a=X.className,u=false;if(!a){if(!this.widgetNotFound){this.widgetNotFound=[];}K.forEach(this.widgetNotFound,function(w){if(w.key===X.k){u=true;}});if(!u){this.widgetNotFound.push({key:X.k,name:X.visName});}else{this.widgetNotFound=[];this.widgetNotFound.push({key:X.k,name:X.visName});}var Z=this.widgetNotFound.length,b=Z>1?14642:14643,p=Z>1?"The following custom visualization plug-ins are missing and will be displayed as grids: ##.":"The following custom visualization plug-in is missing and will be displayed as a grid: ##.";if(!k){var k=window.setTimeout(function(){var w=[];K.forEach(this.widgetNotFound,function(x){w.push(x.name);});mstrmojo.warn(mstrmojo.desc(b,p).replace("##",w),{},{buttons:[P(mstrmojo.desc(1442,"OK"),function(){})]});}.bind(this),0);}var v=this.newXtab(c,l);v.cssDefault=!!v.cssDefault?v.cssDefault+" noVis":"noVis";return v;}m={dc:a};}var Y="mstrmojo."+r,g=m.b;if(mstrApp.isVI&&m.vib){g=m.vib;}else{if(mstrApp.isExpress&&m.oivmb){g=m.oivmb;}}if(g&&!mstrmojo.loader.isLoaded(Y)){mstrmojo.requiresBundle(g);}mstrmojo.requiresCls(Y);var W=this.visList.getVis(l.data.visName).m,h=N.walk(r,mstrmojo),q=W?N.walk(W,mstrmojo):this.getDefaultMojoVisModel();if(!h||!q){throw new Error("Missing visualization class.");}h=n.getVisClass(h,l.defn);var f=new h(N.copy(X.extProps,{id:l.id,node:l,n:l.defn.title,controller:this.parent.controller,gb:X.gbys}));var d=new q({xtab:f,controller:this.parent.controller,docModel:c});f.setModel(d);d.set("data",X);if(!!l.data.sdp){var o;for(o in l.data.sdp){l.data.sdp[o].defn={};var e=this.newXtab(c,l.data.sdp[o]);e.setModel(new q({xtab:e,controller:this.parent.controller,docModel:c,data:l.data.sdp[o]}));e.k=o;}}return f;},getEditableXtab:function F(W){this.throwAbstractMethodError("getEditableXtab");},getDefaultXtab:function D(W){this.throwAbstractMethodError("getDefaultXtab");},newXtab:function I(X,Y,W,a){var Z=mstrmojo.all[Y.id];if(!Z){Z=this.newRWUnitInstance(X,Y,Y.defn.txi?this.getEditableXtab(Y):this.getDefaultXtab(a));Z.model=this.newXtabModel({xtab:Z,docModel:X});}else{Z.set("node",Y);Z.model.set("docModel",X);}return Z;},newXtabModel:function U(W){this.throwAbstractMethodError("newXtabModel");}});mstrmojo.DocBuilder.ClassMapItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.Image");mstrmojo.threshold.ImageBand=mstrmojo.declare(mstrmojo.Image,null,{scriptClass:"mstrmojo.threshold.ImageBand",cssClass:"mstrmojo-Image color-band"});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ImageBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.GridBase");var V=mstrmojo.css,M=mstrmojo.color,a=mstrmojo.css;function C(c,d){var e=c&&c.parent;while(e&&e.scriptClass.indexOf("DocPanelStack")===-1){if(d in e){return e;}e=e.parent;}return null;}function B(d){var c=document.createElement("img");d.appendChild(c);d.removeChild(c);}function E(c,d){var f=Math.floor(c/d.rowsPerPage),h=c%d.rowsPerPage,g=d.tableNode.tBodies[f],e=g.rows[h].cells;return e;}function H(){var c=this._renderTimer;if(c){self.clearInterval(c);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:14,defaultRowsPerPage:100,minRowsPerPage:50,init:function G(c){this._super(c);this.forceFixedSizes=true;},initPageSettings:function N(){var e=this.parent,c=this.defaultRowsPerPage,d=this.cp.getAvailableRowsCount();this.effectiveRh=this.rh||this.rhMin||1;this.effectiveRh=this.effectiveRh*e.model.docModel.getZoomFactor();if(e&&e.numRowFixed){c=d;}else{if(e&&e.scrollboxHeightFixed){c=Math.ceil(e.scrollboxHeight/this.effectiveRh);c=Math.max(c,this.minRowsPerPage);if(e.alwaysShowFirstBlockData&&d<c){c=d;this._shouldRenderNextPage=true;}}}this.pageStatus=[];this.rowsPerPage=c;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function Y(f){var e=this.rowsPerPage,c,h,d,g=function(m,n,k){var l=this;return function(){if(l._onDemand===undefined){l._onDemand=!m.isDataAvailable(n,k);}return l._onDemand;};};this.totalPages=(e&&Math.ceil(this.cp.rc/e))||0;f=f||this.pageStatus;for(c=0;c<this.totalPages;++c){h=c*e;d=h+e-1;if(!f[c]){f[c]={};}delete f[c]._onDemand;f[c].isOnDemand=g.call(f[c],this.cp,h,d);}},buildRendering:function F(){var c=false;if(this.renderMode==="vscroll"){this.initPageSettings();var g=this.pageStatus[0];c=g&&g.isOnDemand();this.start=0;this.end=-1;if(!c){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!c);}this._super();if(this.renderMode==="vscroll"){var f=this.parent,e=this,h=function(){e.gridContainerNode.style[a.MINHEIGHT]=(e.cp.rc*e.effectiveRh)+"px";};if(mstrmojo.dom.isIE7){this.gridContainerNode.style.zoom="1";window.setTimeout(h,10);}else{h();}if(!this.connectedScrollbox){if(f&&f.connectScrollbox){f.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!c);this.postRenderPages();var d=f&&!f.scrollboxHeightFixed&&!f.numRowFixed;if(d&&this.numPagesRendered>=this.totalPages&&!c){this.postRenderingCleanup();}else{if(c||d||this._shouldRenderNextPage){this.onscroll();delete this._shouldRenderNextPage;}}}},preRenderPages:function Q(){},postRenderPages:function Z(){},configureActions:function L(){var c=this.parent;if(c&&c.configureActions){c.configureActions();}},preRenderPage:function O(c,d){this.pageNum=c;},postRenderPage:function J(d,f,g){if(d+1>this.numPagesRendered){this.numPagesRendered=d+1;}var c=this.pageStatus,e=c[d];if(!e){e=c[d]={};}if(f){e.filled=true;e.dirty=false;}var h=this.gridContainerNode.style;if(d===this.totalPages-1&&h){h[a.MINHEIGHT]="";}},invalidAllPages:function(){for(var c=0;c<this.totalPages;++c){var d=this.pageStatus[c];if(d.filled){d.dirty=true;}delete d._onDemand;d.filled=false;d.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function b(c){var d=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var g=mstrmojo.all[d];if(!g){return ;}var e=g.getPagesToRender(c);if(e.length>0){g.preRenderPages();g.renderPages(e);g.postRenderPages();g._postPagesClearup=true;}else{if(g._postPagesClearup){g.postRenderPagesCleanup();g.configureActions();g._postPagesClearup=false;}H.call(g);if(g.isRenderingComplete()){g.postRenderingCleanup();}}}catch(f){H.call(mstrmojo.all[d]);throw f;}},this.renderPause);},onscroll:function X(d,c){if(!this.renderingRows){if(d===true){var e=this.parent;if(e&&e.maskNode){V.addClass(e.maskNode,"wait");}}this._startPageRenderThread(c);}},isRenderingComplete:function P(){if(this.end>=this.cp.rc-1){for(var c=this.pageStatus,d=this.totalPages-1;d>-1;d--){if(!c[d]||!c[d].filled){return false;}}return true;}return false;},renderPages:function D(d){for(var e=0,c=d.length;e<c;++e){this.renderPage(d[e].idx,d[e].fill);}},renderPage:function W(m,e){var r=this.pageStatus,h=(this.numPagesRendered>=m+1);if(h){if(!e||(r[m]&&r[m].filled)){return ;}}var q=this.rowsPerPage,k=this.domNode;this.start=m*q;this.end=Math.min(this.start+q,this.cp.rc)-1;this.preRenderPage(m,e);var d=this.tempTable;if(!d){d=this.tempTable=k.ownerDocument.createElement("div");}var o=this.tableNode,n=this.start,f=this.end,l=e?this.buildTableRowsMarkup(n,f,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>",o.style.tableLayout).join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(this.effectiveRh*(this.end-this.start+1))+'px">&nbsp;</td></tr></tbody></table>';d.innerHTML=l;var g=d.firstChild.tBodies[0];if(!h){o.appendChild(g);}else{o.replaceChild(g,o.tBodies[m]);}if(e){this.markPages(n,f);}this.postRenderPage(m,e,g);var c=this.parent;if(c.onPageRendered){c.onPageRendered(g,m,h,e);}},getPagesToRender:function S(t){var q=[],v=this.parent,AF=this._defaultPageHeight,g=null,AG=this.pageStatus,AH=this;function l(m){var n=AG[m];if(n&&(n.filled||n.dirty)){if(!n.height){if(!g){g=AH.tableNode.tBodies;}n.height=g[m].offsetHeight;}return n.height;}else{return AF;}}var k=0,h=null,r=null,d=v.scrollboxTop;for(var AB=0,AC=this.totalPages,c=this.pageStatus;AB<AC;AB++){k+=l(AB);if(k>=d){h=AB;break;}}if(h===null){h=r=AC-1;}else{var u=v.scrollboxBottom;if(isNaN(u)&&v.numRowFixed){u=d;}for(var AA=h+1;AA<AC;AA++){if(k>u){r=AA-1;break;}k+=l(AA);}}if(r===null){r=AC-1;}for(var w=this.numPagesRendered;w<h;++w){q.push({idx:w,fill:false});}var z=0,AD=this.rowsPerPage,o=false;for(var x=h;x<=r;++x){var AE=AG[x];if(!AE||!AE.filled){if(AE&&AE.isOnDemand()){o=true;if(!AE.isDownloading&&!this.isDownloading){z+=AD;AE.isDownloading=true;this.isDownloading=true;var f=x*AD,e=f+AD-1;this.cp.download(f,e,t);}q.push({idx:x,fill:false});}else{q.push({idx:x,fill:true});}}}if(o){this.parent.showDownloadStatus(z);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return q;},addHilitePosition:function(d,f,c){var g=this.hiliteCellsMap[d];if(!g){this.hiliteCellsMap[d]={pos:[],nodes:[]};}var e=f-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[d].pos.push({row:e,cell:c,page:this.pageNum});},setHilites:function(f,g){var h=g.getAttribute("ei"),k=this.eiMap[h],c=this.getNodesByPositions(k);if(!c.length){this._super(f,g);return ;}for(var e=0,d=c.length;e<d;e++){this._super(f,c[e]);}},addExtraInfoMap:function(d,e,c){if(!this.eiMap[d]){this.eiMap[d]=[];}this.eiMap[d].push(this.getPosObj(e,c));},addPositionMap:function(d,e,c){if(!this.posMap[d]){this.posMap[d]=this.getPosObj(e,c);}},addTitleHeaderPositionMap:function(e,c,d){var f=this.getPosObj(e,c);f.obj=d;this.thPosMap.push(f);},getPosObj:function(e,g){var f=this.pageNum||0,d=this.rowsPerPage||0;return{row:e-f*d,cell:g,page:f};},getNodeByPosition:function(c){return this.tableNode.tBodies[c.page].rows[c.row].cells[c.cell];},getRowIdxByCell:function(c){var d=this.posMap[c._ei];return d.page*this.rowsPerPage+d.row;},getNodesByPositions:function(m){var h=[];for(var f in m){var o=m[f],e=(o&&o.page)||0,d=o&&o.row,k=o&&o.cell,g=this.tableNode.tBodies[e],l=g&&g.rows[d],n=l&&l.cells[k];if(n){h.push(n);}}return h;},getPageHeight:function R(c){var d=this.tableNode.tBodies;return(d&&d[c]&&d[c].offsetHeight)||0;},getTargetCell:function(l,k){var f=0,d=0,g;for(g=this.totalPages;d<g;d++){f+=this.getPageHeight(d);if(k<=f){break;}}var e=this.tableNode.tBodies[d];if(e){for(d=0,g=e.rows.length;d<g;d++){var o=e.rows[d];for(var c=0,n=o.cells.length;c<n;c++){var m=o.cells[c];if(m.offsetTop+m.offsetHeight>=k){if(l>=m.offsetLeft&&l<=m.offsetLeft+m.offsetWidth){return m;}}else{break;}}}}},postRenderPagesCleanup:function I(){var e=this.parent;if(e&&e.gridData&&e.gridData.afc){var d=this.tableNode;if(d&&(this.lastWidth!==d.offsetWidth)){if(e.onGridWidthChanged){e.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(f){delete f.height;});this.lastWidth=d.offsetWidth;}var c=C(e,"adjustAutoWidth");if(c){c.adjustAutoWidth(e);}}if(e.gridPagesRendered){e.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(e&&e.maskNode){V.removeClass(e.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function K(){var n=this.cp.getUpdatedRows(),h=this,m,d,l,o,f,g,k,e=[];if(n){mstrmojo.hash.forEach(n,function(p,c){k=parseInt(c,10);m=h.cp.getRowCells(k);d=E(k,h);l=d.length;o=m.length-1;if(o>=0){for(f=l-1;f>=0;f--){g=d[f];if(o<0){break;}if(m[f]._d){var r=g.style.backgroundColor,q=g.style.color;e.push({dom:g,bgcolor:r,ftcolor:q});g.style.backgroundColor=M.getHighlightColor(M.rgbStr2rgb(a.getStyleValue(g,"backgroundColor"),true));g.style.color=M.getContrastingColor(M.rgbStr2hex(a.getStyleValue(g,"backgroundColor")),"#ffffff","#000000");delete m[f]._d;}o--;}}});if(e.length>0){window.setTimeout(function(){mstrmojo.array.forEach(e,function(c){c.dom.style.backgroundColor=c.bgcolor;c.dom.style.color=c.ftcolor;});},300);}}},postRenderingCleanup:function A(){var d=this.parent;if(d&&this.connectedScrollbox){d.disconnectScrollbox(this);}this.connectedScrollbox=false;if(d&&!d.scrollboxHeightFixed){var e=C(d,"performCanGrowCanShrink");if(e){e.performCanGrowCanShrink([d],true);}}},getRowInfoByPosition:function(c){return this.cp.getRowCellInfo(c);},unrender:function U(c){H.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this.unMarkAllPages();this._super(c);},dataDownloaded:function T(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var D=mstrmojo.dom,F=mstrmojo.array,E=mstrmojo.hash;var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(H,G){if(!A){var I=this.itemField;A=this._super(H).replace(">{@en@n}<",' title="{@en@'+I+'}">{@en@'+I+"}<");}return A;},getItemProps:function C(I,G){var H=this._super(I,G),J=this.itemField;H[J]=I[J];return H;},onclick:function B(G){if(this.disableClick){return false;}var L=this,I=this.parent,K=I.opener,H=D.isMetaKey(G.hWin,G.e);if(H&&!this.multiSelect){this.multiSelect=K.parent.defn.multi;if(this.multiSelect){D.attachOneTimeEvent(document.documentElement,"keyup",function(){var N=L.selectedIndices;if(K){K.suggestionShown=false;if(N&&!E.isEmpty(N)){var M=[];E.forEach(L.selectedIndices,function(P,O){M.push(L.items[O]);});K.handleSuggestionItemSelect(M);}I.close();}L.multiSelect=false;});}}this._super(G);if(!this.multiSelect){K.suggestionShown=false;var J=this.selectedItem;if(J){K.handleSuggestionItemSelect(J);}I.close();}},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems",disableClick:"this.parent.opener.disableClick"}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.ui.editors.controls.ColorList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.editors.controls.ColorList",init:function D(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ColorList");},getItemMarkup:function C(F,E){if(!A){A=this._super(F,E).replace(">{@en@n}<",">{@en@msg}<");}return A;},getItemProps:function B(G,E){var F=this._super(G,E);if(G.id==="transparent"){F.msg=mstrmojo.desc(5774,"No Fill");F.addCls("noFill");}else{F.msg="";G.title=G.n;F.addStyle("background-color:"+G.id);}return F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.css");var B=mstrmojo.css;var A;var D;mstrmojo.ui.ButtonBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.ButtonBar",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenabledChange:function G(){B.toggleClass(this.domNode,"disabled",!this.enabled);}},cssDisplay:"table",icnCssText:"display:table-row;",items:null,showIcon:true,init:function F(I){this._super(I);var H=["mstrmojo-ui-ButtonBar"];if(!this.showIcon){H.push("btn-text");}B.addWidgetCssClass(this,H);},getItemMarkup:function E(H){if(!D){D=this._super(H);}if(!A){A=D.replace(">{@en@n}<",'title="{@en@n}"><div>&nbsp;</div><');}return this.showIcon?A:D;},getItemProps:function C(J,H){var I=this._super(J,H);var K=J.css;if(K){I.addCls(K);}I.n=J.n||"";return I;}});mstrmojo.ui.ButtonBar.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.SelectBox=mstrmojo.declare(mstrmojo.ListBase,null,{scriptClass:"mstrmojo.SelectBox",size:10,cssDisplay:"inline",markupString:'<select id="{@id}" class="mstrmojo-SelectBox {@cssClass}" style="{@cssText}" size="{@size}" {@multipleHtml} mstrAttach:keyup,change tstid="{@tstid}">{@itemsHtml}</select>',markupSlots:{itemsContainerNode:function(){return this.domNode;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){this.domNode.disabled=!this.enabled;}},itemCssClass:"mstrmojo-selectbox-item",itemDisplayField:"n",itemIdField:"v",showItemTooltip:false,itemRenderer:{render:function(E,D,F){var G=mstrmojo.string.htmlAngles((F.getItemName)?F.getItemName(E,D):(F.itemDisplayField&&E[F.itemDisplayField]));return'<option class="'+F.itemCssClass+'" value="'+((F.getItemValue)?F.getItemValue(E,D):(F.itemIdField&&E[F.itemIdField]))+'" '+((F.selectedIndices[D])?'selected="true" ':"")+((F.showItemTooltip)?'title="'+mstrmojo.string.encodeXMLAttribute(G)+'"':"")+">"+G+"</option>";},select:function(E,F,D,G){E.selected=true;},unselect:function(E,F,D,G){E.selected=false;}},buildRendering:function C(){this.multipleHtml=this.multiSelect?' multiple="true" ':"";this._super();delete this.multipleHtml;},_getItemNode:function(D){var E=this.scrollboxNode;return E&&E.options[D];},prechange:function A(E){if(this._syncDom){return ;}this._syncDom=true;var H=this.scrollboxNode;if(this.multiSelect){var I=H.options,F=[];for(var G=0,D=I.length;G<D;G++){if(I[G].selected){F.push(G);}}this.select(F);}else{this.singleSelect(H.selectedIndex);}delete this._syncDom;},prekeyup:function(E){var H=this.scrollboxNode,F=false;if(this.multiSelect){var I=H.options;for(var G=0,D=I.length;G<D;G++){if(I[G].selected!==!!this.selectedIndices[G]){F=true;break;}}}else{if(H.selectedIndex!==this.selectedIndex){F=true;}}if(F){var J=E;J.name="change";this.raiseEvent(E);}},onselectionChange:function B(D){if(!this._syncDom){this._super(D);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui._HasScroller");var F=mstrmojo.dom,J=mstrmojo.string;var D;function G(){var O=this._getItemNode(0);if(O){var N=(Math.min(this.maxVisibleButtons,this.items.length)*O.offsetWidth)+"px",M=this.domNode.style;if(N!==M.width){M.width=N;if(!this._sbto){this._sbto=window.setTimeout(function(){delete this._sbto;this.updateScrollbars();}.bind(this),0);}}}}mstrmojo.vi.ui.rw.PanelSelectorList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.rw.PanelSelectorList",init:function L(M){this._super(M);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-PanelSelectorList");},multiSelect:false,maxVisibleButtons:10,getItemMarkup:function K(M){if(!D){D=this._super(M).replace(">{@en@n}<",' title="{@en@n}"><div></div><');}return D;},getItemProps:function H(O,M){var N=this._super(O,M);N.n=O.n+" ("+(M+1)+"/"+this.items.length+")";return N;},setupScrollNodes:function E(){this.scrollNode=this.itemsContainerNode;},_set_items:function C(M,N){this._super(M,N);G.call(this);},selectPanel:function B(O){var N=this.items,M=mstrmojo.array.find(N,"id",O);this.singleSelect(M);return N[M];},postBuildRendering:function A(){var M=this._super();G.call(this);return M;},useRichTooltip:true,getItemTooltip:function(P,Q){var N=F.position(Q),O="<div>"+J.encodeHtmlString(P.n,true)+" "+((P.idx+1)+"/"+this.items.length)+"</div>";var M={areaId:P._renderIdx+"text",cssClass:"vi-regular vi-tooltip-V V-center",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMCENTER,content:O,top:N.y-4,left:N.x+10,enableHover:true};return M;},showTooltip:function I(M,P){var O=M.target||F.eventTarget(M.hWin,M.e),N=this.getItemFromTarget(O);if(N&&N.n){this.richTooltip=this.getItemTooltip(N,this.getItemNodeFromTarget(O));this._super(M,P);}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.VisMenuList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.VisMenuList",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);},getItemProps:function A(F,D){var E=this._super(F,D);E.tag="a";E.addCls("mstrmojo-ui-Menu-item");return E;},onselectionChange:function B(D){this._super(D);this.parent.data.set("valid",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");mstrmojo.ui.List=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.List",postselectionChange:function C(D){var G=D.added||[],F=G.length,I=D.removed||[],E=I.length;if(E){this.selectionRemoved({added:G,removed:I,isReselect:false});}if(F){var H=function(J){return[].concat(J).sort().join(",");};this.selectionAdded({added:G,removed:I,isReselect:H(G)===H(I)});}},selectionAdded:function A(D){},selectionRemoved:function B(D){}});mstrmojo.ui.List.SelectionChangeEvtType=null;}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.vi.ui.CalculationWidget=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.CalculationWidget",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-calculation");},_set_selectedItems:function(G,E){var D=(E||[]).map(function(H){return H.t;}),F=this.prevSelection={};D.forEach(function(H){F[H]=true;});this.setSelectedItems(this.items.filter(function(H){return D.indexOf(H.v)>-1;}));},getCalculationTypes:function A(){var F=this.items,G=this.selectedIndices,I=this.prevSelection,E=F.filter(function(K,J){return G[J]&&!I[K.v];}),H=F.filter(function(K,J){return !G[J]&&I[K.v];}),D=function(J){return J.v;};return[E.map(D),H.map(D)];},onselectionChange:function B(D){this._super(D);this.parent.applyCalculation(this.selectedItem.v);}});}());(function(){mstrmojo.requiresCls("mstrmojo.string");mstrmojo.DivItemRenderer={render:function(E,C,F){var D=mstrmojo.string.encodeHtmlString((F.getItemName?F.getItemName(E,C):(F.itemDisplayField&&E[F.itemDisplayField])));return'<div mstridx="'+C+'" class="'+F.itemCssClass+(F.selectedIndices[C]?" "+F.itemSelectedCssClass:"")+(E.cssClass?" "+E.cssClass:"")+'" style="'+F.itemCssText+'">'+D+"</div>";},select:function(D,E,C,F){D.className+=" selected";},unselect:function(D,E,C,F){D.className=D.className.replace(/selected/g,"");},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,rangeSelected:false,_findMatch:function(C,D){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(C,D),"mstridx",true,this.itemsNode);},premousedown:function A(C){if(mstrmojo.dom.shiftKey(C.hWin,C.e)){mstrmojo.dom.preventDefault(C.hWin,C.e);}},preclick:function B(L){var H=L.hWin,I=L.e,G=this._findMatch(H,I);if(G){var E=G.node,K=parseInt(G.value,10),J=mstrmojo.dom,C=J.ctrlKey(H,I),D=J.shiftKey(H,I);if(C||D){J.clearBrowserHighlights(H);}if(this.multiSelect&&(this.selectionPolicy==="toggle"||C)){var F=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(K);if(F&&K<this.items.length&&this.selectedIndices[K+1]){K++;}this.selectedIndex=K;this.rangeSelected=false;}else{if(this.multiSelect&&D){this.rangeSelected=true;this.rangeSelect(K);}else{this.singleSelect(K);this.rangeSelected=false;}}}}};mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._RendersItemDivs");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var C=this.itemRenderer;return(C&&C.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var C=this.itemRenderer;return(C&&C.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var C=this.itemRenderer;return(C&&C.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var C=this.itemRenderer;return(C&&C.itemSuffix)||"</td></tr>";},_getItemNode:function(C){var E=this.itemsNode,D=E&&E.rows,F=D&&D[C];return F&&F.cells[0].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasEditableText","mstrmojo.css");var B=mstrmojo.css;mstrmojo.EditableLabel=mstrmojo.declare(mstrmojo.Label,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.EditableLabel",autoApplyDelay:-1,markupString:'<div id="{@id}" class="mstrmojo-EditableLabel {@cssClass}" title="{@title}" contenteditable="{@isEditing}" style="{@cssText}" mstrAttach:click,mousedown,blur,keydown,keyup></div>',onkeyup:function C(D){this._super(D);if(this._autoApplyTimer){window.clearTimeout(this._autoApplyTimer);}if(this.autoApplyDelay!==-1){var E=this;this._autoApplyTimer=window.setTimeout(function(){E.set("isEditing",false);},this.autoApplyDelay);}},selectable:true});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.EditableLabel,{onselectableChange:function A(){var E=this[this.editableSlot],D=!!this.selectable;E.selectable=D;E.setAttribute("unselectable",!D?"on":"off");B.toggleClass(E,"unselectable",!D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.desc","mstrmojo.Label","mstrmojo.dom","mstrmojo.hash","mstrmojo.MetricSelectorUtility","mstrmojo.num","mstrmojo.vi.ui.rw.selectors.ISliderHelper");var C=mstrmojo.MetricSelectorUtility,A=C.FN,G=C.OP,I=C.Q,D=mstrmojo.num,H=Math.max,E=Math.min;mstrmojo.vi.ui.rw.selectors.MetricValueSliderHelper=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.ISliderHelper,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.MetricValueSliderHelper",init:function(J){this._super(J);this.slider.set("multiSelect",true);},updateOpCs:function B(){var L=this.slider,Q=L.cs1Vl,P=L.cs2Vl,O=E(Q,P),M=H(Q,P),S=L.low,N=L.high,K=L.include,T=parseInt(L.qua,10),J=(T===I._PT||T===I._PB),R=[];if((O>S&&M<N)||O<S||M>N){L.opId=K?G._BETWEEN:G._NOT_BETWEEN;}if(O===S&&M<N){L.opId=K?G._LESS_EQUAL:G._GREATER;}if(O>S&&M===N){L.opId=K?G._GREATER_EQUAL:G._LESS;}if(O===M){L.opId=K?G._EQUALS:G._NOT_EQUALS;}if(O===S&&M===N){L.unSet=true;L.cs=[];return ;}switch(L.opId){case G._BETWEEN:case G._NOT_BETWEEN:R.push({dtp:5,v:D.toLocaleString(O)+(J?"%":"")});case G._EQUALS:case G._NOT_EQUALS:R.push({dtp:5,v:D.toLocaleString(M)+(J?"%":"")});break;default:if(O>S){R.push({dtp:5,v:D.toLocaleString(O)+(J?"%":"")});}if(M<N){R.push({dtp:5,v:D.toLocaleString(M)+(J?"%":"")});}}L.cs=R;},updateSummary:function F(){var K=this.slider,N=K.opId,J="",M=K.cs1Vl>K.cs2Vl?K.cs2Vl:K.cs1Vl,O=K.cs1Vl<K.cs2Vl?K.cs2Vl:K.cs1Vl,P=this.formatNumber(M),L=this.formatNumber(O);if(K.unSet||M<=K.low&&O>=K.high&&K.include){J=mstrmojo.desc(2058,"All");}else{switch(N){case G._EQUALS:J="= "+P;break;case G._NOT_EQUALS:J=String.fromCharCode(8800)+" "+P;break;case G._GREATER:J="> "+L;break;case G._GREATER_EQUAL:J=String.fromCharCode(8805)+" "+P;break;case G._LESS:J="< "+P;break;case G._LESS_EQUAL:J=String.fromCharCode(8804)+" "+L;break;case G._BETWEEN:J=P+" - "+L;break;case G._NOT_BETWEEN:J="Not "+P+" - "+L;break;default:J=P+" - "+L;break;}}K.summary.set("text",J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.dom,B=mstrmojo.css,D=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span>"+D+"</div></div>",getPrefixAndOrToolsMarkup:function(){return(D+this._super());},markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},createSetNode:function(){return this.domNode.childNodes[1].lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){B.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noRelation);},onnoCreateSetChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noCreateSet);}},mstrmojo.hash.copy(mstrmojo.ConditionNode.prototype.markupMethods)),init:function(E){if(this._super){this._super(E);}var F=this.data&&this.data.et;if(F){this.set("noCreateSet",F===10||F===12);}},preclick:function C(E){var H=null,G=A.eventTarget(E.hWin,E.e),F=this._super(E);if(A.contains(this.createSetOptNode,G,true)&&!this.noRelationOperator&&!this.noRelation){H="createSetOpt";}else{if(A.contains(this.createSetNode,G,true)&&!this.noRelation){H="createSet";}else{if(A.contains(this.addConditionNode,G,true)){H="addCondition";}}}E.part=H||E.part;return F;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.dom");var B=mstrmojo.dom;mstrmojo.threshold.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,null,{scriptClass:"mstrmojo.threshold.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass} mstrAttach:mousedown"><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span></div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},preclick:function A(C){var F=null,E=B.eventTarget(C.hWin,C.e),D=this._super(C);if(B.contains(this.addConditionNode,E,true)){F="addCondition";}C.part=F||C.part;return D;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.num","mstrmojo.array");var A=mstrmojo.num,E=mstrmojo.array;var C="?";function B(H,G){var J=G?H.max:H.min,F=G?H.min:H.max,I=H.getValGroup(G?1:-1);return(J===null||(G?(I.every(function(K){return K<=J;})):(I.every(function(K){return K>=J;})))||(F!==null&&H.canLoop));}function D(I,H){var G=I.min,F=I.max,J=I.getValGroup(H?1:-1)||[];if((H&&F!==null&&J.some(function(K){return K>F;})||(!H&&G!==null&&J.some(function(K){return K<G;})))){if(I.canLoop){J.forEach(function(L,K){L=((L-G)%(F-G+1))+G;L=(L>=G)?L:L+(F-G+1);J[K]=L;});}else{return ;}}I.item[I.valField]=I.curValGroup=J;I.onTraverse();}mstrmojo.NumGroupStepperContentProvider=mstrmojo.declare(mstrmojo.NumStepperContentProvider,null,{scriptClass:"mstrmojo.NumGroupStepperContentProvider",curValGroup:null,init:function(F){this._super(F);},_initCurrent:function(){var H=this.item,F=this.curValGroup=H[this.valField];if(F===null||F===undefined){var G=this.min;this.curValGroup=G!==null?[G]:0;}this.curValGroup=E.ensureArray(this.curValGroup);},next:function(){D(this,true);},prev:function(){D(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},getValGroup:function(I){var F=this.curValGroup,G=this.interval,H=[];(F||[]).forEach(function(K,J){H[J]=F[J]+(G*(I||0));});return H;},getVal:function(){var F=null;(this.curValGroup||[]).forEach(function(G){if(F===null){F=G;}else{if(F!==C&&G!==F){F=C;}}});return F;},setVal:function(H){var I=this.min,G=this.max,F=this.curValGroup;if(typeof H!=="number"||isNaN(H)||A.inNumericRange(H,I,G)!==0){return ;}(F||[]).forEach(function(K,J){F[J]=H;});this.onTraverse();},_set_curValGroup:function(J,I){var H=this.min,G=this.max,F=this.getValGroup();if(I.some(function(K){return typeof K!=="number";})||I.some(function(K){return isNaN(K);})||I.every(function(L,K){return L===F[K];})||I.every(function(K){return A.inNumericRange(K,H,G)!==0;})){return false;}this.item[this.valField]=this.curValGroup=I;return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.elementHelper");var r="Metrics",E=2,Z=mstrmojo.array,H=mstrmojo.hash,T=mstrmojo.elementHelper;function P(AF){if(!AF){return false;}var AD=this.scm,z="\u001E",AB,x,AC,AA,w,AE=false;for(x in AD){AC=AD[x];AA=AC.cgb;for(AB in AA){w=AF[AA[AB]];if(w){if(!AC.tks){AC.tks=w;AE=true;}else{if(AC.tks&&(AC.tks.indexOf(w)<0)){AC.tks+=z+w;AE=true;}}}}}return AE;}function d(){var x=this.data,w=x.gts;if(!w){return ;}var z;Z.forEach([w.row,w.col],function(AA){Z.forEach(AA,function(AB){if(AB.sc){z=z||{};z[AB.id||r]=AB.sc;if(AB.fid){z[AB.id+"_"+AB.fid]=AB.sc;}}});});this.scm=z;P.call(this,this.docModel.getCGBMap());}function v(w,x){var z=this.getDataService();z[w].apply(z,x);}function R(AD,AE,AM){var AC=AE||T.getIdPresentation(AD),AL,AJ;switch(AC){case"terse":case"terseLong":AL=AD.substring(1,AD.length).split(";");return"h"+AL[0]+";"+AL[1]+(AM?";"+AM:"");case"old":AD=AD.replace(/\*:/g,"*COLON*");AL=AD.split(":");return("h"+AL[1]+(AL[2]?":"+AL[2]:"")+";"+AL[0]+(AM?";"+AM:"")).replace(/\*COLON\*/g,"*:");case"oldLong":var AG=0,w,AK,AI=[],AF=[],AB,AA,z,AH=function AH(){if(AG<0){return null;}var AP=false,AN=-1,AQ,AO=null;for(AB=AG;AB<AD.length;AB++){AQ=AD.charAt(AB);if(AQ==="*"&&!AP){AP=true;}else{if(AQ===":"&&!AP){AN=AB;break;}else{AP=false;}}}if(AN===-1){AO=AD.substring(AG);AG=-1;}else{AO=AD.substring(AG,AN);AG=AN+1;}return AO;};z=AH();if(z!=="BB"&&z!=="BF"){return AD;}AJ=AH();if(z==="BF"){AJ=AH();}w=parseInt(AH(),10);AK=parseInt(AH(),10);for(AA=0;AA<AK;AA++){AF[AA]=parseInt(AH(),10);AH();}for(AA=0;AA<AK;AA++){var x=AH();if(AF[AA]<w&&AF[AA]>=0){AI[AF[AA]]=x;}}return"h"+AI.join(":")+";"+AJ+(AM?";"+AM:"");}return AD;}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function n(w){this._super(w);var x=this;this.docModel.attachEventListener("CGBMapChange",this.id,function(z){if(x.xtab.onCBGMapChange){x.xtab.onCGBMapChange(z);}});},ondataChange:function g(){d.call(this);},getMessageId:function F(){return this.docModel.mid;},getDataService:function G(){return this.docModel.getDataService();},getAction:function X(AL,AB,AG){var AJ=AL[0],x=AJ&&AJ.at;var AA;if(x){if((x&E)>0){var z=this.getCellTitleInfo(AJ),AH=z&&z.title,w=AH&&AH.id,AI=this.scm;this.sti={titleId:w||r};var AF=(w&&AI[w])||AI[r],AE=function(){var AM=[];Z.forEach(AL,function(AN){if(AN._e&&AN._e.id){AM.push(AN._e.id);}});return AM.join("\u001E");};if(AF){var AK=this.xtab,AC=(AK.allowToggleSelections&&AF.all&&AG),AD=(z.isSrcTitle||AC);this.sti.deselectCurrent=AC;AA={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:AB,ck:AF.ck,tks:AF.tks,eid:AD?"OA:(All)":AE(),ctlKey:AF.ckey,sliceId:AK.sid,isUConDS:AF.isUConDS,ifw:AF.ifw}};}}}if(!AA){AA=this._super(AL);}if(AA&&AA.a){AA.a.sliceId=this.xtab.sid;}return AA;},getDownloadAction:function l(AB,z,AD,AA,AC,x,w){var AE=this._super(AB,z,AD,AA,AC,x);AE.sliceId=this.xtab.sid;if(w&&w.name==="TransactionUpdates"){if(AE.partialUpdate){if(AE.partialUpdate.selectors){AE.partialUpdate.selectors.push(w.ctlKey);}else{AE.partialUpdate.selectors=[w.ctlKey];}}else{AE.partialUpdate={selectors:[w.ctlKey]};}}return AE;},getDrillAction:function f(x,AA){var z=this._super(x,AA),w=this.getCellTitleInfo(x[0]);if(z&&z.isWithin){z.attrObj=w.title;}z.srcMsgId=this.docModel.mid;return z;},sort:function p(x,z){var w=this.xtab;x.stp=x.stp||this.getSubTotalsPos();x.subTotalsPos=x.stp;x.nodeKey=w.k;x.treeType=w.treeType||1;v.call(this,"sortGrid",arguments);},getAdvSortData:function Q(w,x){v.call(this,"getAdvSortData",arguments);},pivot:function I(w,x){v.call(this,"pivot",arguments);},removeUnit:function O(w,x){v.call(this,"removeUnit",arguments);},getTotalsAction:function J(w,AA,x){var z=this.getPivotAction(w);z.act="showTotals";z.subtotalType=AA;z.clearSubtotalType=x;return z;},getRemoveAxisTotalsAction:function b(x,w){return{act:"removeAxisTotals",axis:w,subtotalType:x};},showTotals:function B(w,x){v.call(this,"showTotals",arguments);},drillGrid:function W(w,x){v.call(this,"drillGrid",arguments);},downloadGridData:function c(w,x){v.call(this,"downloadGridData",arguments);},loadLayout:function a(w){this.docModel.loadLayout(w);},resizeXtabColumn:function L(w,x){v.call(this,"resizeXtabColumn",arguments);},submitTemplateActions:function o(w,x,z){v.call(this,"submitTemplateUpdates",arguments);},getDerivedMetricAction:function h(w,x){return{did:w._e.oid,um:w.um,alias:w._e.n,n:w._e.n,v:w.um?w.formula:w._e.v,mix:w.mix,cmd:x,model:this};},getAddTemplateUnitAction:function C(AB,AD,z,w){var x=AB.t,AC=this.data.gsi,AA={act:"addUnit",unitId:AB.did,unitType:x,unitPos:++w,dsId:AD,isFirst:!AC||(AC.cols.length===0&&AC.rows.length===0)};if(x!==4||!AC||!AC.mx.length){AA.axis=z;}return AA;},getRemoveTemplateUnitAction:function m(w){return{act:"removeUnit",unitId:w.did||w.id,unitType:w.t||4};},getRenameTemplateUnitAction:function m(AB,z,w,x){var AA={act:"renameUnit",id:AB,type:z,name:w};if(x){AA.isDynamicAlias=true;}return AA;},doesNameExistOnTemplate:function A(z,AD,AB,x){var AC=z.node.data.gsi,w=AB===4,AA=w?AC.mx:AC.rows.concat(AC.cols);return AA.some(function(AE){return AE.did!==AD&&(w||AE.t===AB)&&AE.n===x;});},getPivotUnitAction:function M(z,w,AA,x){w++;return{act:"pivot",unitId:String(AA||""),unitType:x||"",axis:z,unitPos:w};},getShowTotalsUnitAction:function U(AA,x,z,w){return{act:"showTotals",unitId:String(AA||""),unitType:x||"",subtotalType:z,clearSubtotalType:w};},getSortGridAction:function q(AA,x,z,w){return{sortKey:x,subTotalsPos:AA,axis:z,isAsc:w};},getColumnResizeAction:function N(AA,w,x,z,AB){return{act:"changeXtabColumnWidth",unitId:AA,unitType:w,width:x||0,depth:z||1,ec:AB};},getNormalizedFormElementId:function u(x,w){return R(x,null,w);},compareNormalizedElementsId:function k(x,w){if(x===w){return true;}else{if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}if(T.isAttributeIdsLinked(T.getAttributeId(x),T.getAttributeId(w),this.docModel.als&&this.docModel.als.idLinks||{})){return T.getElementValue(x)===T.getElementValue(w);}}return false;},compareElementsId:function S(AB,AA){if(!this.docModel.als){return this.compareElementsIdInSingleGrid(AB,AA);}var z=T.getIdPresentation(AB),x=T.getIdPresentation(AA),w=R(AB,z),AC=R(AA,x);return this.compareNormalizedElementsId(w,AC);},compareElementsIdInSingleGrid:function Y(AA,z){var x=T.getIdPresentation(AA),w=T.getIdPresentation(z);if(x!==w||x==="oldLong"||x==="terseLong"){return R(AA,x)===R(z,w);}return AA===z;},getLinkedAttributes:function e(w){var x=[],z;if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}z=this.docModel.als&&this.docModel.als.idLinks||{};return z[w];},getCellDataUnion:function V(z){var AA=this,x=z.hasOwnProperty("mix"),AB=[],AC,w=function w(AE){var AD=AA.getCellTitleInfo(AE),AG=AD.title,AF=AG&&AG.id;if(AF){AC={};if(AE.stt){AC.isSubtotal=true;}AB.push(H.copy(AC,{tid:AF,eid:AE._e&&AE._e.id,v:AE.v}));}};if(z){if(!x){w(z);}else{Z.forEach([z._lp,z._tp],function(AD){var AE=AD;while(AE&&AE!==AE._p){w(AE);AE=AE._p;}});}}return AB;},getObjectInfo:function D(w){var x;Z.forEach((this.data.gsi.cols||[]).concat(this.data.gsi.rows||[]),function(z){if(z.did===w){x=z;}});return x;},supportsViewFilterActions:function K(w){if(this.data&&this.data.gsi){var x=this.getObjectInfo(w);return x&&!x.de&&(x.t!==1)&&(x.t!==47||x.st===12033);}return false;},getSelectorControlMapInfo:function t(){var x=[],AA=this.data.gsi,z=[],w;if(this.scm){H.forEach(AA,function(AB){if(AB instanceof Array){z=z.concat(AB);}});H.forEach(this.scm,function(AC,AB){w=Z.find(z,"did",AB);if(w!==-1){x.push({did:AB,n:z[w].n,sc:AC});}});}return x;},getShowDefinedSubtotalsAction:function(){return{act:"showDefinedSubtotals"};}});}());(function(){mstrmojo.requiresCls("mstrmojo._XtabCellHoverMgr","mstrmojo.dom");var D=mstrmojo.dom;mstrmojo.vi.ui._XtabCellHoverMgr=mstrmojo.declare(mstrmojo._XtabCellHoverMgr,null,{scriptClass:"mstrmojo.vi.ui._XtabCellHoverMgr",oncontextmenu:function E(I,F,H){this._super(I,F,H);var G=this.parent,J=this.getEvtTargetCell(I,F,G,H);if(!J||!this.shouldShowPopup(G,J,true)){D.preventDefault(F,I);D.stopPropogation(F,I);}},processRightClick:function B(G,F,H){this.parent.doSelection(G,F,H);},shouldShowPopup:function A(J,K,I){var G=J.getCellForNode(K),F=false,H=G&&G.at;if(G){if(!J.model.canShowCellMenu(G)){return false;}F=this._super(J,K,I);if(!F&&H!==undefined){K.mstrShowPopup=F=true;}}return F;},showHvrBtn:function C(H,I){var G,F=false;if(this._super(H,I)){G=H.model.getCellInfo(H.getCellForNode(I));F=(G.isMetric&&G.isHeader)||(!G.isMetric&&G.isTitle);}return F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.TristateCheckBox","mstrmojo.FieldSet","mstrmojo.Table");var A=mstrmojo.hash,B=mstrmojo._FormatDefinition;mstrmojo.AlignmentFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.AlignmentFormatter",cssClass:"mstrmojo-AlignmentFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){A.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"textAlignment",cssClass:"mstrmojo-FormatEditor-textAlignment",legend:mstrmojo.desc(2065),children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3691),slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.Horizontal,bindings:{m:"this.parent.parent.parent.model",value:"this.m.Horizontal"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.Horizontal=this.value;}},slot:"0,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3692),slot:"1,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.Vertical,bindings:{m:"this.parent.parent.parent.model",value:"this.m.Vertical"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.Vertical=this.value;}},slot:"1,1"}]}]},{scriptClass:"mstrmojo.FieldSet",alias:"textControl",cssClass:"mstrmojo-FormatEditor-textControl",legend:mstrmojo.desc(2884),children:[{alias:"TextWrap",scriptClass:"mstrmojo.TristateCheckBox",text:mstrmojo.desc(2070),checked:false,grayed:false,pr:"TextWrap",bindings:{m:"this.parent.parent.model",checked:function(){return this.m[this.pr]==-1;},grayed:function(){return(typeof this.m[this.pr]=="undefined")||this.m[this.pr]=="pru";}},oncheckedChange:function(C){if(this.m){this.m.set(this.pr,this.checked?-1:0);}}},{scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(5159)},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.TextDirection,bindings:{m:"this.parent.parent.parent.model",value:"this.m.TextDirection"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.TextDirection=this.value;}},slot:"1,1"}]}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo._BindTargetChildren","mstrmojo.List");mstrmojo.TabNameList=mstrmojo.declare(mstrmojo.List,[mstrmojo._BindTargetChildren],{scriptClass:"mstrmojo.TabNameList",isStrip:true,targetProps:{names:"items"},makeObservable:true,postchange:function A(){var E=this.selectedIndex,F=this.target;if(F&&E!=null&&parseInt(E,10)!==-1){F.set("selected",F.children[E]);}},addTabButtons:function B(E,M){var J=this.targetProps||{},Q=J.childTitle||"n",G=this.itemIdField||"v",F=this.itemField||"n",P=[],I=(this.items)?this.items.length:0,L=(E&&E.length)||0,K;for(K=0;K<L;K++,I++){var O=E[K],H=O[Q];if(H){var N={target:O};N[F]=H;N[G]=I;P.push(N);}}if(P.length){this.add(P,M);}},removeTabButton:function D(F){var E=mstrmojo.array.filter(this.items,function(G){return(G.target===F);},{max:1});if(E&&E[0]){this.remove(E[0]);}},clearButtons:function C(){this.remove(this.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var B=mstrmojo.dom;mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",itemTitleField:null,defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(H,F){var G=this.items;this.items=F||[];return G!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var G=this.value,F=this.selectedIndex,I=this.items||[],J,H;if(F===undefined||(G!==null&&(F===-1||(F!==-1&&I[F]&&I[F][this.itemIdField]!==G)))){F=mstrmojo.array.find(I,this.itemIdField,G);F=(F>-1)?F:this.defaultSelection;this.selectedIndex=F;}else{if(G===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=J=I[this.selectedIndex];if(J){H=J[this.itemField];}else{H=this.defaultText||"";}this.set("text",H);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function D(){var G=this.value,F=-1;if(G!==null){F=mstrmojo.array.find(this.items,this.itemIdField,G);}if(F>-1){this.selectedItem=this.items[F];this.selectedIndex=F;}},togglePopup:function E(){if(this.popupToBody){var I=B.position(this.popupNode,true),H=this.popupRef,F={left:Math.round(I.x)+"px",top:Math.round(I.y)+"px"};if(!H.hasRendered){delete H.slot;F.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(F,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var G=this.popupRef.domNode;if(G){if(this.fixWidth){G.style.width=(this.domNode.offsetWidth-2)+"px";}else{G.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(F){if(B.getButton(F.hWin,F.e)===B.MOUSE_BUTTON.LEFT){this.togglePopup();}},unrender:function C(F){var G=this.popupRef;if(this.popupToBody&&G.hasRendered){G.unrender(false);}if(this._super){this._super(F);}},itemName:function(H,F,G){return mstrmojo.string.encodeHtmlString(H[G.itemField]);},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var H=this.opener,G=H&&H.popupZIndex,I=(H&&H.popupCssClass)||"",F=this.domNode;if(G){F.style.zIndex=G;}if(I){mstrmojo.css.addClass(F,[I]);}if(H&&H.fixWidth){mstrmojo.css.addClass(F,["fix-width"]);}if(H&&H.fixHeight){mstrmojo.css.addClass(F,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(I,F,G){var H=I[G.itemCSS]||G.parent.opener.item2textCss&&G.parent.opener.item2textCss(I)||"",J=G.parent.opener.itemName;return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+H+'" title="'+I[G.itemTitleField||G.itemField]+'">'+(J(I,F,G)||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",itemTitleField:"this.parent.opener.itemTitleField",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var H=this.parent,I=H.visible,F=H.opener,G=this.selectedItem;if(!F||!G||!I){return ;}F.set("value",G[this.itemIdField]);}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.CheckBox","mstrmojo.HBox","mstrmojo.VBox","mstrmojo.Box","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var A=function(E){E.attachEventListener("pfChange",E.id,"positionChange");E.boxes.left.flat.attachEventListener("checkedChange",E.id,"flatChange");var D={pf:"this.boxes.left.pf.value",flat:"!this.boxes.left.flat.checked",agg:function(){return this.boxes.left.agg.checked?"2":"1";},rfi:"this.boxes.left.rfi.value"};E.set("bindings",D);},C=function(E){var D=E.boxes.left;D.pf.set("value",E.pf);D.flat.set("checked",!E.flat);D.agg.set("checked",E.agg==2);D.rfi.set("value",E.rfi);};function B(M,I,E,F,L,D,H,K){var J={target:I,onEnd:function(){if(D){D();}},props:{}};J.props[E]={ease:H||mstrmojo.ease.sin,start:parseInt(F,10),stop:parseInt(L,10),suffix:"px"};J=mstrmojo.hash.copy(K,J);var G=new mstrmojo.fx.AnimateProp(J);G.play();}mstrmojo.CGEOptions=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.CGEOptions",children:[{scriptClass:"mstrmojo.HBox",alias:"boxes",cellCssClass:"cell",children:[{alias:"left",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-CGEOptions-options",children:[{scriptClass:"mstrmojo.ImageCheckBox",alias:"flat",cssClass:"row",label:mstrmojo.desc(7954,"Enable hierarchical display")},{scriptClass:"mstrmojo.ImageCheckBox",alias:"agg",cssClass:"row",label:mstrmojo.desc(7955,"Enable subtotals display")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7956,"Position parent header:"),cssClass:"row"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",alias:"pf",cssClass:"CGE-parent-header mstrmojo-FormatEditor-DropDownButton",items:[{n:mstrmojo.desc(7957,"Above child items"),v:true},{n:mstrmojo.desc(7958,"Below child items"),v:false}],bindings:{value:"this.parent.parent.parent.pf"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7959,"Interaction with report filter:"),cssClass:"row"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",alias:"rfi",cssClass:"CGE-report-filter mstrmojo-FormatEditor-DropDownButton",items:[{n:mstrmojo.desc(7960,"Default (Database Instance level)"),v:-1},{n:mstrmojo.desc(7961,"No interaction"),v:0},{n:mstrmojo.desc(2398,"Apply"),v:1},{n:mstrmojo.desc(7962,"Apply but ignore related elements"),v:2}],bindings:{value:function(){var D=this.parent.parent.parent.rfi,D=D==undefined?"-1":D;return D;}}}]},{scriptClass:"mstrmojo.Box",alias:"preview",cssClass:"mstrmojo-CGEOptions-preview",children:[{scriptClass:"mstrmojo.Label",cssClass:"title",text:mstrmojo.desc(3389,"Preview")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7963,"Element Header 1"),alias:"g1t"},{scriptClass:"mstrmojo.Box",alias:"e1",cssClass:"e",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7965,"Item 1-1")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7966,"Item 1-2")}],onflatChange:function(){mstrmojo.css.toggleClass(this.domNode,["flat"],this.flat);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7963,"Element Header 1"),cssText:"margin-bottom:10px;",alias:"g1b"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7964,"Element Header 2"),cssText:"margin-top:10px;",alias:"g2t"},{scriptClass:"mstrmojo.Box",alias:"e2",cssClass:"e",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7967,"Item 2-1")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7968,"Item 2-2")}],onflatChange:function(){mstrmojo.css.toggleClass(this.domNode,["flat"],this.flat);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7964,"Element Header 2"),alias:"g2b"}]}]},{scriptClass:"mstrmojo.HBox",alias:"btns",cssClass:"mstrmojo-Editor-buttonBar",cssText:"margin-top: 10px;",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(2397,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.save();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(2399,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.cancel();}}]}],pf:true,flat:false,agg:"1",rfi:"-1",postBuildRendering:function(){if(this._super){this._super();}A(this);this.preview();},open:function(E,F){var D=E.cgp;this.pp=D;this.set("pf",D.pf);this.set("flat",D.flat);this.set("agg",D.agg);this.set("rfi",D.rfi);C(this);for(var G in F){this[G]=F[G];}this.set("visible",true);if(!this.hasRendered){this.render();}},cancel:function(){var D=this.closeCB;if(D){D[0][D[1]]();}},save:function(){this.pp.pf=this.pf;this.pp.flat=this.flat;this.pp.agg=this.agg;this.pp.rfi=this.rfi;this.cancel();},positionChange:function(D){this.preview(D.value,null);},flatChange:function(D){this.preview(null,!D.value);},preview:function(G,E){G=!!G?String(G)==="true":!(String(this.pf)==="false");E=(E==null?this.flat:E);var F=!!G,D=this.boxes.preview;D.g1t.set("visible",F);D.g1b.set("visible",!F);D.g2t.set("visible",F);D.g2b.set("visible",!F);D.e1.set("flat",E);D.e2.set("flat",E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+(C[B.itemType]?" t_"+C[B.itemType]:"")+(C[B.itemSubType]?" st_"+C[B.itemSubType]:"")+(C[this.itemISC]?" isc":"")+(C[B.itemViewMedia]?" vm_"+C[B.itemViewMedia]:"")+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(F){var E=F[this.itemType],D=F[this.itemSubType],B=" t"+E,C=(parseInt(E,10)===1||parseInt(E,10)===3||parseInt(D,10)===14082)?" st"+D:"",G=F[this.itemISC]?'class="mstrmojo-ListIcon isc"':"",A=(F[this.itemViewMedia]===2048||F[this.itemViewMedia]===8192)?" hvi":"";return'<span class="mstrmojo-ListIcon '+B+C+A+'"><span '+G+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length,B;if(A>0){for(B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+E.substring(0,G)+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc",itemViewMedia:"dvm",useDblSelect:false});}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo._IsDial");mstrmojo.Dial=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsDial],{scriptClass:"mstrmojo.Dial",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){mstrmojo.css.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);},hideIfEmpty:function(){this.onadd();}},hideIfEmpty:false,onadd:function(A){if(this._super){this._super(A);}if(this.hideIfEmpty){if(this.domNode){this.domNode.style.display=(!this.items||this.items.length==0)?"none":"block";}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var M=this,L=this._renderTimer=self.setInterval(function(){if(!M){self.clearInterval(L);return ;}var N=M.getPagesToRender();if(N.length>0){M.renderPages(N);}else{M.renderingRows=false;self.clearInterval(M._renderTimer);delete M._renderTimer;if(M.isRenderingComplete()){M.postRenderingCleanup();}M=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],Z=this._pageHeight,b=null,W=this._pageStatus,Y=this;function R(c){var d=W[c];if(d&&d.filled){if(!d.height){if(!b){b=Y.itemsNode.tBodies;}d.height=b[c].offsetHeight;}return d.height;}else{return Z;}}var a=0,S=null,O=null,M=this.scrollboxTop;for(var V=0,X=this._totalPages;V<X;V++){a+=R(V);if(a>=M){S=V;break;}}if(S==null){S=O=X-1;}else{var L=this.scrollboxBottom;for(var T=S+1;T<X;T++){if(a>=L){O=T-1;break;}a+=R(T);}}if(O==null){O=X-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var U=W[Q];if(!U||!U.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var V=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(V[R]&&V[R].filled)){return ;}}var U=this._rowsPerPage,L=R*U,N=Math.min(L+U,this._rc)-1;var T=this.tempTableCont;if(!T){T=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';T.innerHTML=Q;var O=T.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresClsP("mstrmojo","Button","Box","vi.ui.CalculationWidget","mstr.EnumFunction");mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869);var C=mstrmojo.desc,B=mstrmojo.mstr.EnumFunction,I=4,E=5,H=6,F=7;var D={SINGLE:[{n:C(358,"Absolute"),v:B.FunctionAbs}],PAIR:[{n:C(6017,"Add"),v:B.FunctionAdd},{n:C(2122,"Average"),v:B.FunctionAverage},{n:C(5868,"Least"),v:B.FunctionLeast},{n:C(5869,"Greatest"),v:B.FunctionGreatest},{n:"A-B",v:B.FunctionMinus+";0"},{n:"B-A",v:B.FunctionMinus+";1"},{n:"A/B",v:B.FunctionDivide+";0"},{n:"B/A",v:B.FunctionDivide+";1"}],MORE:[{n:C(6017,"Add"),v:B.FunctionAdd},{n:C(2122,"Average"),v:B.FunctionAverage},{n:C(5868,"Least"),v:B.FunctionLeast},{n:C(5869,"Greatest"),v:B.FunctionGreatest}]};mstrmojo.vi.ui.CalculationMenuEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.CalculationMenuEditor",onSubmenuOpen:function G(){var P=this.parent,O=P.de,Q=O&&O.es,J=(Q&&Q.length)||P.cellsNum,L=(J===1)?"SINGLE":((J===2)?"PAIR":"MORE"),N=D[L],K=(O&&O.func)||P.func,M,R;if(L==="PAIR"){if(O){N[I].n=Q[0].n+" - "+Q[1].n;N[E].n=Q[1].n+" - "+Q[0].n;N[H].n=Q[0].n+" / "+Q[1].n;N[F].n=Q[1].n+" / "+Q[0].n;}else{R=this.xtab.selCells;N[I].n=R[0].innerText+" - "+R[1].innerText;N[E].n=R[1].innerText+" - "+R[0].innerText;N[H].n=R[0].innerText+" / "+R[1].innerText;N[F].n=R[1].innerText+" / "+R[0].innerText;}}this.checkList.set("items",N);for(M in N){if(typeof N[M].v==="string"&&N[M].v.indexOf(K)===0&&N[M].v.indexOf(";0")>0){this.checkList.set("selectedItem",N[M]);break;}if(N[M].v===K){this.checkList.set("selectedItem",N[M]);break;}}},applyCalculation:function A(L){var K=this.xtab,J=this.parent;if((J.de&&J.de.func===L)||(typeof L==="string"&&L.indexOf(J.de.func)===0&&L.indexOf(";0")>0)){return ;}if(this.parent.isEdit===true){K.editDECalculation(J.node,L);}else{K.derivedElementCalculation(J.node,L);}this.onSubmenuClosed();},children:[{scriptClass:"mstrmojo.vi.ui.CalculationWidget",alias:"checkList"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller");mstrmojo.ui.ScrollableList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function C(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function E(){return this.domNode.firstChild;}},postBuildRendering:function B(){if(this.renderOnScroll){if(!this.onScrollEnd){var G=this.id;this.onScrollEnd=function F(){var H=mstrmojo.all[G];H.doScroll();H.updateScrollbars();};}}if(this._super){this._super();}},renderBlockSize:150,renderIndex:0,onScrollEnd:undefined,doScroll:function A(){if(this.renderOnScroll){var G,H=this.scrollNode,F=(this.renderIndex+1)*this.renderBlockSize;if(F>=this.items.length){return ;}if(mstrmojo.dom.position(H).h===H.scrollHeight){G=this.domNode;}else{G=H;}if((mstrmojo.dom.position(G).h+G.scrollTop)>=G.scrollHeight){this.renderIndex++;var I=this._buildItemsMarkup(this.renderIndex*this.renderBlockSize,((this.renderIndex+1)*this.renderBlockSize)-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");G.innerHTML+=I;this.itemsContainerNode.innerHTML+=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.dom","mstrmojo.array","mstrmojo.hash");var E=mstrmojo.dom,G=mstrmojo.array,I=mstrmojo.hash,L=2;var S;function Q(V){var U=[];G.forEach(this.itemsContainerNode.childNodes,function(Y,W){if(Y!==V){var X=E.position(Y);U.push({i:W,m:X.x+(X.w/2)});}});return U;}mstrmojo.vi.ui.IconTabList=mstrmojo.declare(mstrmojo.ui.List,null,{scriptClass:"mstrmojo.vi.ui.IconTabList",init:function M(U){this._super(U);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIIconTabList");},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},items:null,useRichTooltip:true,listHooks:{select:function(V){var W=this.getItemNodeFromTarget(V);if(W){var U=E.position(W.firstChild);this.set("richTooltip",I.copy({top:U.y+U.h,left:U.x-L},I.clone(this.richTooltip)));}}},showTooltip:function C(V,Y){var X=V.target||E.eventTarget(V.hWin,V.e),W=this.getItemFromTarget(X);if(!W||W===this.getSelectedItems()[0]){return ;}if(W&&W.n){var U=E.position(this.getItemNodeFromTarget(X).firstChild);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:W.n,top:U.y+U.h+3,left:U.x-L};this._super(V,Y);}},getItemMarkup:function D(U){if(!S){S=this._super(U).replace(">{@en@n}<","><div>{@en@n}</div><");}return S;},getItemProps:function T(W,U){var V=this._super(W,U);V.addCls(W.cls);return V;},selectionAdded:function F(U){this.hideTooltip();this.tabSelected(this.items[U.added[0]]);},tabSelected:function J(U){},getTabIds:function H(){var U=this.getSelectedItems()[0];return this.items.map(function(V){return V.id+((V===U)?"*":"");}).join("|");},getDragTabInfo:function B(X){var W=E.findAncestorByAttr(X,"idx",true,this.domNode),V=this.items,Y=V.length===1;if(W){var U=parseInt(W.value,10);return{id:this.parent.id,node:W.node,homeIdx:U,idx:U,item:V[W.value],isSingleTab:Y,active:!Y,pos:null,panel:null};}return null;},enterDragMode:function R(U,W){this.selectItems(U.item,true);var b=U.node,Y=E.position(this.domNode),Z=b.nextSibling,X=b.offsetWidth,V=Q.call(this,b);var a=W.src.pos.x-E.position(b).x;if(a<0||a>X){a=Math.round(X/2);}U.pos={offset:a,map:V,width:X,left:Y.x,max:Y.x+Y.w-X};b.style.left=(b.offsetLeft-1)+"px";if(Z){Z.style.marginLeft=X+"px";U.pos.idx=U.idx+1;}mstrmojo.css.addClass(this.domNode,"dnd");U.active=true;},dragTab:function K(b,V){var f=b.pos,d=Math.max(Math.min(V.tgt.pos.x-f.offset,f.max),f.left),U=f.width;var e=V.getDirection("x"),Z=f.map,c,X;b.node.style.left=d-f.left+"px";Z.sort(function(h,g){return e?h-g:g-h;});G.forEach(Z,function(g){if(!X&&(e?d+U<g.m:d<g.m)){X=g;}if(g.i===f.idx){c=g;}});if(X!==c){var Y=this.itemsContainerNode.childNodes,a=X&&X.i,W=c&&c.i;f.idx=undefined;if(c){Y[W].style.marginLeft=0;}if(X){Y[a].style.marginLeft=U+"px";f.idx=a;}if(c&&X){if(W<a){c.m-=U;}else{X.m+=U;}}else{if(c){c.m-=U;}else{X.m+=U;}}}},exitDragMode:function N(U){mstrmojo.css.removeClass(this.domNode,"dnd");G.forEach(this.itemsContainerNode.childNodes,function(V){V.style.marginLeft=0;});U.active=false;delete U.pos;},removeTab:function A(X){var U=[].concat(this.items),V=G.find(U,"id",X),W=this.getSelectedItems()[0];if(W===U[V]){W=U[V+1]||U[0];}U.splice(V,1);this.set("items",U);this.selectItems(W,true);},pivotTab:function P(U){var V=[].concat(this.items),X=U.item,W=U.idx,Y=U.pos.idx;if(Y===undefined){Y=V.length;}if(W<Y){Y--;}V.splice(W,1);V.splice(Y,0,X);this.set("items",V);this.selectItems(X,true);},addTab:function O(X,W,V){var U=[].concat(this.items),Y=this.getSelectedItems()[0];if(V||!Y){Y=X;}if(G.indexOf(U,X)===-1){W=isNaN(W)?U.length:W;U.splice(W,0,X);this.set("items",U);}this.selectItems(Y,true);return{idx:W,node:this._getItemNode(W)};}});mstrmojo.vi.ui.IconTabList.TabInfoType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller","mstrmojo.css");var F=mstrmojo.css;var C;mstrmojo.ui.CheckList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.CheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{scrollboxNode:function A(){return this.domNode.firstChild;},itemsContainerNode:function I(){return this.domNode.firstChild.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onorientationChange:function L(){F.toggleClass(this.domNode,"horizontal",this.orientation!=="v");},onmultiSelectChange:function J(){F.toggleClass(this.domNode,"radio",!this.multiSelect);},onenabledChange:function H(){F.toggleClass(this.domNode,"disabled",!this.enabled);}},multiSelect:true,orientation:"v",minimumSelectCnt:0,icnCss:"icn",items:null,getItemMarkup:function K(M){if(!C){C=this._super(M).replace(">{@en@n}<",'title="{@tt}"><span>{@en@n}</span><');}return C;},getItemProps:function G(O,M){var N=this._super(O,M);var P=O.css;if(P){N.addCls(P);}N.tt=O.tt||"";N.n=O.n||" ";return N;},setupScrollNodes:function D(){this.scrollNode=this.scrollboxNode;},preselectionChange:function B(N){var O=this.minimumSelectCnt,M=this.getSelectedItems().length,P=N.removed;if(P&&O){if(M<O){this.select(P,true);return false;}}F.toggleClass(this.itemsContainerNode,"disableSelected",M<=O);return true;},buildRendering:function E(){this._super();F.toggleClass(this.itemsContainerNode,"disableSelected",this.getSelectedItems().length<=this.minimumSelectCnt);}});mstrmojo.ui.CheckList.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate","mstrmojo.MetricSelectorUtility");var D=mstrmojo.MetricSelectorUtility,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,N=D.OP,F=[{n:mstrmojo.desc(2795,"Equals"),v:N._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:N._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:N._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:N._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:N._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:N._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:N._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:N._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:N._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:N._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:N._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:N._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var C=function(Z,S,T,V,U){var W;if(U===2){return S;}var a=String(Z).split(";"),X=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(V&&a&&a.length>1){S.code=X;}else{for(W=0;W<a.length;W++){var Y=parseFloat(a[W],10);if(isNaN(Y)||(T&&((a[W].match(/^\d+(\.\d+)?%$/)===null&&a[W].match(/^\d+(\.\d+)?$/)==null)||Y<0||Y>100))||(!T&&a[W].match(/\d+$/)===null)){S.code=X;}if(S.code!==R){break;}}}if(S.code!==R){S.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return S;};var M=function(R){R=parseFloat(R);return isNaN(R)?"54px":((R*72/16)+"pt;");},Q=function(T){if(T.hasRendered){var S=T.domNode.style;S.font=T.font;S.width=M(S.fontSize);}else{var R=T.font.match(/[^\s]*?pt/)||[];T.cssText=T.cssText+" font:"+T.font+"; width:"+M(R[0]);}},I=function(R){if((R>=8&&R<=16)||(R>=23&&R<=25)){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function P(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(R){if(this._super){this._super(R);}this._init();},_init:function(T){var S;switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(T){this.cs=[];this.f=this.ft=null;}var V=D.getOpIdxByfunc(this.f,this.ft),U=I(this.dt)?N._GREATER_EQUAL:N._IS_NULL;this.set("opId",(V==-1)?U:V);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId===N._IN||this.opId===N._NOT_IN){for(S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function B(R,S){this.da=R;this.updateExpr(S);},updateExpr:function A(R){if(R){this.cs=R.cs;this.f=R.f;this.ft=R.ft;this.qua=R.qua;}this._init();},onquaChange:function O(R){this._init(true);this.func.items=(this.qua!==0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!==0)?L:I(this.parent.dt)?F:H;},onchange:function(){var S=this.parent,T=this.selectedItem;if(T&&T.v!==null&&T.v!==undefined){var R=D.getIncludeByOp(T.v);S.include=R;if(S.parent&&R!==S.parent.include){S.changeInclude=true;}else{S.changeInclude=false;}S.set("opId",T.v);}if(mstrApp.isMobile&&(T.v===N._IS_NULL||T.v===N._IS_NOT_NULL)){if(S.onchange){S.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},T=this.parent;C(R,S,(T.qua===3||T.qua===4),(T.opId!==8&&T.opId!==9),(T.numFmts&&T.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){var S=this.parent,R=this.domNode;S.set("cs1",this.value);if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(S){var R=S.hWin,V=S.e||R.event,U=this.parent,T=S.src.domNode;if(V.keyCode===13&&U.apply&&U.apply.enabled){U.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},T=this.parent;C(R,S,(T.qua===3||T.qua===4),(T.opId!==8&&T.opId!==9),(T.numFmts&&T.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){this.parent.set("cs2",this.value);var R=this.domNode;if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(S){var R=S.hWin,U=S.e||R.event,T=this.parent;if(U.keyCode===13&&T.apply&&T.apply.enabled){T.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var T=this.parent,W=(T.qua===D.Q._PT||T.qua===D.Q._PB),R;T.cs=[];var U=function(X){return X+((W&&!String(X).match(/^\d+%$/))?"%":"");};var S=function(X,Y){return((X===2||X===3)&&Y===0)?14:5;};if(T.opId===N._IN||T.opId===N._NOT_IN){var V=String(T.cs1).split(";");for(R=0;R<V.length;R++){if(!mstrmojo.string.isEmpty(V[R])){T.cs.push({dtp:5,v:U(V[R])});}}}else{if(T.vldTbL.visible){T.cs.push({dtp:S((T.numFmts&&T.numFmts.cat),T.qua),v:U(T.cs1)});}if(T.vldTbH.visible){T.cs.push({dtp:S((T.numFmts&&T.numFmts.cat),T.qua),v:U(T.cs2)});}}if(T.onchange){T.onchange();}if(T.makeSelection){T.makeSelection();}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.ui.ButtonBar");mstrmojo.vi.ui.TextAlignButtonBar=mstrmojo.declare(mstrmojo.ui.ButtonBar,null,{scriptClass:"mstrmojo.vi.ui.TextAlignButtonBar",includeJustify:true,init:function B(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"txtAlign");var D=this.itemsValueMap,C=this.items;if(!this.includeJustify){C=C.filter(function(F){return F.id!=="justify";});}this.items=C.map(function(G){var F=mstrmojo.hash.copy(G);F.v=D[F.id];return F;});},onValueChange:mstrmojo.emptyFn,itemsValueMap:{left:0,center:2,right:1,justify:6},items:[{n:mstrmojo.desc(3049,"Left"),id:"left"},{n:mstrmojo.desc(2193,"Center"),id:"center"},{n:mstrmojo.desc(2166,"Right"),id:"right"},{n:mstrmojo.desc(2068,"Justify"),id:"justify"}],getItemProps:function A(E,C){var D=this._super(E,C);D.addCls(E.id);return D;},postselectionChange:function(C){var D=this.items,E=D[C.added[0]],F=D[C.removed&&C.removed[0]];this.onValueChange(E.v,F&&F.v);}});}());(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var C=function(S,U,T){var R=S.parent.opener,J=R&&R.showDesc,Q=R&&R.showPath,I=U[S.itemField];var P=mstrmojo.string.escape4HTMLText,V="";if(Q){var M=U.anc&&U.anc.items,O=M&&M.length;if(O>0){for(var L=0;L<O-1;L++){V+=M[L].n+" > ";}V+=P(M[O-1].n);}else{if(U.path){V+=U.path;}}}if(!T){V+=(V.length===0?"":" > ")+P(I);}if(J){var N=U[S.itemDescField],K=120;if(N){V+="\r\n\r\n<br>"+P(N.substring(0,K)+(N.length>K?"...":""));}}return V;};var A=function(I,J,K){I.path=null;if(!J||!K||K.path){if(K&&K.path){I.set("path",K.path);}return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var L=J.path||J.getAttribute("path");if(L){I.set("path",K.path);return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(M){var N=H(M.toString())||"";K.path=N;I.set("path",N);}},{taskId:"getObjectDetails",objectID:K.did,objectType:K.t},undefined);},200);};var H=function(K){var N;if(window.DOMParser){N=(new DOMParser()).parseFromString(K,"text/xml");}else{N=new ActiveXObject("Microsoft.XMLDOM");N.async="false";N.loadXML(K);}var P=N.getElementsByTagName("path")[0],L=P.childNodes,O="";if(L){for(var J=0,I=L.length;J<I;J++){var M=L[J].childNodes&&L[J].childNodes[0];if(M){O+=mstrmojo.string.escape4HTMLText(M.nodeValue)+(J<I-1?"> ":"");}}}return O;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",useRichTooltip:false,itemDescField:"desc",getItemMarkup:function(K,I){var J=this.parent.opener,L=this.useRichTooltip?"":this.buildTooltip(K);return'<div class="mstrmojo-suggest-text '+((J&&J.item2textCss(K))||"")+'" idx="'+I+'" title="'+L+'">'+J.getHighlightedText(J.getSearchPattern(),mstrmojo.string.escape4HTMLText(K[this.itemField]))+"</div>";},getItemProps:function E(){return{};},onmouseover:function(J){var M=this.parent.opener;if(M&&M.showPath){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),I=K.getAttribute("idx"),L=I!=null?this.items[I]:null;if(L&&L.t>-1){this.targetEl=K;this.targetItem=L;this.requestPath(K,L);}}},requestPath:function D(I,K){var J=this.parent.opener;if(K.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function&&J.showFunctionSyntaxAsPath){this.buildFunctionSyntax(K);}else{A(this,I,K);}},buildFunctionSyntax:function G(J){var K=J.path;if(!K&&J.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){var I=function I(P){if(P.did<0){return P.n;}var O=P.pars,M=[],N,L;M.push(P.n);if(O){M.push("(");for(N=0,L=O.length;N<L;N++){M.push(O[N].n);if(N!==(L-1)){M.push(", ");}}M.push(")");}return M.join("");};J.path=I(J);}this.set("path",{path:J.path,excludeSelf:true});},buildTooltip:function B(I,J){return C(this,I,J);},onpathChange:function F(){var I=this.targetEl;I.path=1;var J=this.buildTooltip(this.targetItem,this.path.excludeSelf);if(this.useRichTooltip){this.useRichTooltip=true;this.hasOpenTooltip=false;if(!I.ttp){I.ttp=J;this.showTooltip();}}else{I.title=J;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function K(L){mstrmojo.hash.copy(L,this);},initContent:function D(O){this.startIndexInContainer=O||this.startIndexInContainer||0;var N=this.base||[],M=N.show,L=N.items;this.rc=M&&L?L.length:0;this.colWidths=(M&&N.cws)||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function B(M,L){return !this.invalidData;},download:function A(N,M,L){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0,L);}},invalid:function E(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function C(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function J(){return this.rc;},getUpdatedRows:function H(){return this.updatedRows;},getRowCells:function(d){var V=this.base||[],R=V.items||[],f=R[d]||[],T=f.items,h=this.lookupBase,Y=this.interactiveCellsArray,g=this.gridData.css,n=this.gridData.gsi,Z=n&&n.prop&&n.prop.cols&&n.prop.cols.mg,l=null,U,b,Q,k,p,P,c,O,S,N,a="-1";if(this.oldGridData){U=this.oldBase;b=U&&U.items;Q=b[d]&&b[d].items;}for(p=0,k=(T&&T.length)||0;p<k;p++){P=T[p];if(P){P.v=P.v||P.n;if(h&&!P._e){c=h[P.tui];O=P.fi;S=(c&&c.fs)||[];N=S[O]||S[0];P.ts=P.ts||N&&N.bftp;l=c&&c.es[P.idx];if(l){P.v=P.v||l.n;if(l.rv){P.rv=l.rv;}P._e=l;}}if(!P.css){var u=P.cni;if(u!==undefined){P.css=g[u].n;}else{P.css="";}}if(!P._d&&Q&&this.preServeUpdatedRows){var M=Q[p];if(!M||(M.rs!==P.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((M.v&&P.v!==M.v)){var t={};if(P.v!==M.v){t.v=M.v;}if(P.css!==M.css){t.css=M.css;}P._d=t;this.updatedRows[this.startIndexInContainer+d]=true;}}}P._gd=this.gridData._bidx||0;if(Y){if(P._ei===undefined||Y[P._ei]!==P){P._ei=Y.push(P)-1;}}if(this.axis){P.axis=this.axis;}var m=P.pi,W=function W(r,e){var v=h&&h[r];return v&&v.es[e];},X=function X(v,r,w){var e=v[r].items[w];if(e&&e._e===undefined){e._e=W(e.tui,e.idx);}return e;};if(m){if(m.ri!==undefined&&m.ci!==undefined){if(P.axis===2&&Z!==a){P._p=R[m.ri].items[p];}else{P._p=R[m.ri].items[m.ci];}}else{var q=this.gridData.ghs,o=m.left,L=m.top;if(o){P._lp=X(q.rhs.items,o.ri,o.ci);}if(L){P._tp=X(q.chs.items,L.ri,L.ci);}}}}}return T;},getUnmergedCells:function F(M){var Q=[];rows=(this.base&&this.base.items)||[];if(M>rows.length-1||M<0){return Q;}var O=this.gridData.css,L=rows[M].items[0],R=L&&L.pi,P=R&&R.ri,S=R&&R.ci;while(R&&P>-1&&S>-1){L=L._p||rows[P].items[S];var N={};mstrmojo.hash.copy(L,N);if(!N.css){N.css=O[N.cni].n;}N.rs=L.rs-M+P;Q.splice(0,0,N);R=L&&L.pi;P=R&&R.ri;S=R&&R.ci;}return Q;},getIndentPadding:function I(L){return L*14;},getCell:function G(L,M){var N=this.base.items;return N[L].items[M];}});}());(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];var J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getRowCells(I);},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},getCell:function(I,K){var J=0,L=this.cps[J];while(I>=L.rc){I-=L.rc;L=this.cps[++J];}return L.getCell(I,K);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K),I;for(I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0,I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){var I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={},J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}mstrmojo.hash.copy(K.getUpdatedRows(),I);}this.updatedRows=I;return I;},download:function B(N,M,I){var L=this._getCPs(N,M),J;for(J=0;J<L.length;++J){var K=L[J];K.download(N,M,I);}}});}());(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];var I;for(I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var M=this.cps,J=[],H=M.length,L;for(L=0;L<H;L++){if(M[L].getAvailableRowsCount()>0&&M[L].rc>I){var K=M[L].getRowCells(I);if(K){J=J.concat(K);}}}return J;},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={},I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}mstrmojo.hash.copy(J.getUpdatedRows(),H);}this.updatedRows=H;return H;},download:function B(K,I,H){var J=this.cps[1];J.download(K,I,H);}});}());(function(){mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function F(I){this._super(I);},download:function B(K,J,I){},shouldClonedLastTitleCell:function H(){return(this.gridData.lhv!==0);},initContent:function E(Q){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var J=this.gridData.gts,L=J.row||[],I=J.col||[],S=J.show,P=J.rec,Y=this.cts||[],X=L.length,R=Y.length,V=this.gridData.css;this.base={items:[]};this.rc=(S&&Y.length)||0;if(this.rc===0&&S){this.rc=X>0?1:0;}this.colWidths=(S&&J.cws)||[];if(!this.rc){this.nRowSpan=this.nColSpan=0;return ;}var N={items:[]},T=0,K=1,U,W,a=this,M=a.base.items,Z=function(b,c){if(a.shouldClonedLastTitleCell()&&c>1){b.rs=1;U=mstrmojo.hash.clone(b,{});U.n="&nbsp;";b.cni=V.push({n:(V[b.cni].n||"")+" fsbp_1"})-1;}},O=function(d){var b=d;while(b-->1){if(a.shouldClonedLastTitleCell()){var c=mstrmojo.hash.clone(U,{});c.cni=V.push({n:(V[c.cni].n||"")+" fsbp_"+((b==1)?"3":"2")})-1;M.push({items:[c]});}else{M.push({items:[]});}}};for(W=0;W<X;++W){L[W].axis=1;L[W].ui=W;T+=L[W].cs||1;N.items.push(L[W]);}if(R>0){Y[0].axis=2;Y[0].ui=0;I[0].axis=2;I[0].ui=0;K=Y[0].rs||1;Z(Y[0],K);T+=Y[0].cs||1;N.items.push(Y[0]);}M.push(N);for(W=1;W<R;++W){if(K>1){O(K);}Y[W].axis=2;Y[W].ui=W;I[W].axis=2;I[W].ui=W;K=Y[W].rs||1;Z(Y[W],K);M.push({items:[Y[W]]});}this.rc=M.length;this.nRowSpan=this.rc+K-1;this.nColSpan=T;if(P){this._removeExtraColumn(L,Y);}},getAvailableRowsCount:function D(){return this.rc;},getSpanDimension:function A(){return{nRow:this.nRowSpan||0,nCol:this.nColSpan||0};},isDataAvailable:function C(J,I){return true;},_removeExtraColumn:function G(L,b){var Z=L&&L.length,Q=b&&b.length,I=this.gridData.gts,T=I.row||[],O=I.col||[],J=T.length,X=O.length;if(!Z||!Q){if(Q===1){var c=b[Q-1];if(c.otp==-1){if(X>0){O[X-1]._hid=true;}this.base.items=[];this.nRowSpan=this.nColSpan=this.rc=0;}}return ;}var K=L[Z-1],U=this.rc,M=this.base.items;if(K){if(K.otp==-1){if(J>0){T[J-1]._hid=true;}if(this.nColSpan){this.nColSpan-=K.cs||1;}M[0].items.splice(Z-1,1);}else{var R=U>1?U-1:0,S=M[R],a=S.items.length;if(a>0&&X>0){O[X-1]._hid=true;}var N=K.fix;if(N){var Y;for(Y=0;Y<N;Y++){S.items[a-1+Y]=L[Z-N+Y];}}else{S.items[a-1]=K;}for(var W=0,V=Q-1;W<V;W++){b[W].cs=N?N:K.cs;}var P=N?N:1;M[0].items.splice(Z-P,P);if(this.nColSpan){this.nColSpan-=1;}}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(F){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum,F);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var a=1,e=2,o=4,W=8,g=1,h=2,G=3,c=4,n=5,U=6,M=7,l=8,X=4,F={},B={},I=4,R=1,J={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},T=mstrmojo.hash,V=mstrmojo.array;function Z(u,r){var t=u[0],p=r.gts,q=p.cws.length;return(r.vp.gr==="1"&&(q>1));}function k(q,w){var u=function(x,z){if(z&&x&&x.css&&x.css.indexOf(z)<0){x.css+=" "+z;}};var t=w.type,r=w.col,v=(r&&r.cl)||0,p=(t===e||t===a);if(t===e||t===W){u(q,J.RIGHT_ALIGN);}else{if(t===a||t===o){u(q,J.LEFT_ALIGN);}}if(p){if(r&&r.tg&&v>1){if(!q._v){q._v=q.v;q.v="<span class='toggleHeader'>"+q.v+"</span>";}}u(q,J.TITLE);}V.forEach(w.extraCss,function(x){u(q,x);});}function A(p){return 0;}function m(u){var r,t=u.cg,p=t&&t.cgc,q=1;for(r=0;r<p;r++){if(t&&t[r]&&!t[r].tg&&t[r].cl>q){q=t[r].cl;}}return q;}function N(q,p){var r=n;if(p===2){if(q===0){r=g;}else{if(q===1){r=c;}}}else{if(p>2){if(q===0){r=g;}else{if(q===1){r=h;}else{if(q===p-1){r=c;}else{if(q<p-1&&q>1){r=G;}}}}}}return r;}function L(p,u,r,q){var w=q&&q.cols&&q.cols.cg,t,x=0,v=0;if(w){for(t=0;t<u;t++){if(p[t]){x+=p[t].length;}}x+=(r+1);for(t=0;t<w.cgc;t++){v+=w[t].cl;if(v>=x){return t;}}}return -1;}function P(x,t,q,p){var w=[],v,r,u,z;for(r=0,u=x.length;r<u;r++){if(x[r].length===1){v=x[r][0];v.rowType=(v.rowType!==l)?N(t,q):l;v.singleStack=(q>1);v=T.copy(v);if(v.ts===I){if(q===1){v.rowType=n;v.colIdx=L(x,r,t,p);}else{if(!t){v.colIdx=L(x,r,t,p);}else{delete v.ts;v.v="";}}}else{if(t){v.v="";}}}else{v=x[r][t];if(!v){z=x[r].length;v=T.copy(x[r][z-1],{});v.v="";if(v.hasOwnProperty("ts")){delete v.ts;}}else{if(v.ts===I){v.colIdx=L(x,r,t,p);}}v.rowType=(v.rowType!==l)?N(t,q):l;}w.push(v);}return w;}function Q(p){if(p===0){return 0;}var q=this.sectionMap[p-1]||0;return Math.floor((p-q)/this.stackLevels);}function D(w){var u,v,t=this.sectionInfo,p=t.length,r=this.srh,q=this.lastSectionIndex;v=t[q];if(w>=v.rs&&w<(v.rs+r)){return v;}if(w<v.rs){u=q-1;if(u<=0){this.lastSectionIndex=0;return null;}do{v=t[u];if(w>v.rs&&w<=(v.rs+r)){this.lastSectionIndex=u;return v;}}while(w<v.rs&&--u>0);this.lastSectionIndex=u;return v;}else{u=q+1;if(u>=p){this.lastSectionIndex=p-1;return null;}do{v=t[u];if(w>v.rs&&w<=(v.rs+r)){this.lastSectionIndex=u;return v;}}while(w>(v.rs+r)&&++u<p);this.lastSectionIndex=u-1;return null;}}function d(z,r,p,x){var w=z[0],u,v=z.length,q=w&&w.rowType,t={v:"",css:"empty-igcell",rowType:q};if(p!==undefined&&w&&(q===g||q===n||q===U)){t={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+x+"px;top:-"+(0.5*F[q])+'px;"></div></div>',css:"IG-ActionArrow",_ei:p};}for(u=v-1;u>=v-r;u--){w=z&&z[u];if(w){w.css+=" IG-lastdatacolumn";}}z.push(t);}function S(AM,AH,r){var AD=AM.cols,AE=AD.cg,p=[{w:"0px"}];if(AD&&AH){var AN=AD.cws,q=[],AL=AN.length,AP=0,z=(parseInt(AM.ar,10)===1)?(AH/AL):-1,AC,t,AB=false,u=0,AF=AH,AG=0,AK;for(AK=0;AK<AL;AK++){t=q[AK]=AN[AK];AC=t.w;if(AC===""){AB=true;}else{if(t.xc){AP+=parseInt(AC);AF-=AP;u++;}else{AG+=parseFloat(AC,10);}}}if(AB||AG<100){z=AF/(AL-u);}for(AK=0;AK<AL;AK++){t=AN[AK];if(t.xc){continue;}else{if(z===-1){AC=parseInt(t.w,10)*AF/100;if(!AC&&AC!==0){AC=parseInt(AF/AE.cgc,10);}}else{AC=(parseInt(t.w,10)<0)?0:z;}}q[AK]={w:AC+"px"};}if(r){return q;}var AA=[],AJ=0;for(AK=0;AK<AL;AK++){var AO=AE[AK],x=AO.tg?AO.cl:1,AI=0;for(AI=0;AI<x;AI++){var v="0px";if(AI===AO.cc){v=q[AK].w;}AA[AJ+AI]={w:v};}AJ+=x;}return AA.concat(p);}else{if(r){return null;}else{return cp.cws.concat(p);}}}function C(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function O(){var AA=this.cps,z=this.cps[0],AF=Math.max(AA[0].rc,AA[1].rc);if(z.type!==a){var AK=this.gridData,AE=function(AN,AQ){var AM=AN.base.items,AO=AN.lookupBase[0].es,AP=AM[AQ].items[0],AL=AO&&AO[AP.idx];return(AL&&AL.n)||((AP.pi&&AO[AP.pi.ri||0])||"");},AI,AH,p=1,w,q,AC,t=0,r=-1,AD,AJ,AG=0,AB=this.groupEnabled;for(AD=0,AI=0,AJ=z.cps?z.cps.length:1;AD<AJ;AD++){var v=z.cps?z.cps[AD]:z,x=v.rc;t=r+1;r=t+x-1;if(v.isDataAvailable(t,r)){if(v.lastRow){AG=v.lastRow;q=v.lastSection;}else{AI=AG||0;for(AH=0,p=this.sectionMap[AI-1]||0;AH<x;AH++){var u=this.stackLevels;AC=AE(v,AH);if(AB&&AC!==q){q=AC;this.sectionInfo.push({sn:AC,rs:this.srh*p+this.stackedRh*Math.floor((AI-p)/this.stackLevels)});this.sectionMap[AI]=++p;AI++;}while(u){this.sectionMap[AI]=p;u--;AI++;}}AG=v.lastRow=AI;v.lastSection=AC;}}else{break;}}this.rc=(this.stackLevels>1?AF*this.stackLevels:AF)+(AB?p:0);}},onDemandDataReady:function b(){this.adjustCPMaps();},initContent:function Y(AA){var z=this.cps,AL=this.gridData=z[0].gridData||z[0].cps[0].gridData,AH=AL.vp=this.gridVp=this.gridVp||AL.vp,r=AH.daf&&AH.daf.split(":"),AB=AH.cols,AC=AB.cg,AI=AB.cws,x=z[A(AC)],AF=AL.gts.row,q=AL.gts,AJ=Z(z,AL),w=x.type!==a,AE,AG,u,p,AD,v,AK,t=(typeof (mstrMobileApp)!=="undefined"&&mstrMobileApp.getDeviceDPI)?mstrMobileApp.getDeviceDPI():160;if(t===160){F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}else{if(t===213){F={1:45,2:31,3:26,4:39,5:71,6:40,7:35,8:71};B={1:15,2:15,3:2,4:21,5:21};}else{if(t===240){F={1:50,2:34,3:30,4:44,5:80,6:40,7:40,8:80};B={1:16,2:16,3:2,4:24,5:24};}else{if(t===320){F={1:67,2:44,3:38,4:58,5:107,6:40,7:53,8:107};B={1:22,2:22,3:2,4:32,5:32};}else{F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}}}}if(w){if(AH.dafIdx===undefined&&r){for(AE=0;AE<AF.length;AE++){if(AF[AE].id===r[0]&&AF[AE].fid===r[1]){AH.dafIdx=AE;break;}}}}for(AE=0;AE<AC.cgc;AE++){if(AC[AE]&&AC[AE].tg){break;}}if(AE===AC.cgc){AL.gts.show=false;AL.ghs.chs.show=false;}this._super(AA);this.colWidths=S(AH,this.gridWidth);this.tdWidths=S(AH,this.gridWidth,true);if(w){this.stackLevels=m(AB);if(this.stackLevels>1){this.srh=F[M];this.rh=F[n];this.mrh=F[G];this.stackedRh=F[g]+(this.stackLevels-2)*F[h]+F[G];}else{this.srh=F[M];this.rh=this.stackedRh=this.mrh=F[n];}if(AJ||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AJ;this.adjustCPMaps();p=this.cps[0].cps;if(p){AK=this;for(AE=0,AG=p.length;AE<AG;AE++){v=p[AE];if(v&&v.addCPListener){v.addCPListener(AK);}}}}}},getUnmergedCells:function(p){return ;},getResolvedGroupHeader:function(t,v){var q=this.gridData,u=q.gts.row[v].es,p=q.ghs.rhs.items[t].items[v];if(p){if(!p.css){p.css=q.css[p.cni].n+" iggroup";p.n=u[p.idx].n;}}else{return{css:" iggroup",n:""};}return p;},getRowCells:function(AJ){var AE=this.cps,w=[],AX=this.gridData,AT=AX.vp,AH=AT.cols.cg,AC=AE[A(AH)],AG=this.groupEnabled,r=AT.bn==="1",AU=[],AI=Q.call(this,AJ),x,t,AK=1,AD,q,AA,AQ,AP,AS,AW,AB;if(AG&&(this.sectionMap[AJ]!==this.sectionMap[AJ-1])){var u=T.copy(AC.getRowCells(AI)[0],{});u.cs=this.colWidths.length;u.rowType=M;k(u,{col:null,type:AC.type,extraCss:[J.GROUPING]});return[u];}if(!AJ){C.call(this);}this.lastAttRow=this.lastAttRow||(AE[0].rc?AE[0].getRowCells(AI):[]);this.lastMtxRow=this.lastMtxRow||(AE[1].rc?AE[1].getRowCells(AI):[]);AA=this.lastAttRow;AS=AA.length;if(AS>0&&AA[0].stt){AD=true;for(AQ=0;AQ<AS;AQ++){AW=AA[AQ];if(AW.stt===R){q=AW;break;}}}if(!this.lastStackCols){V.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AQ=0;AQ<p.length;AQ++){if(p[AQ]._ei!==undefined){if(AT.dafIdx>=0){AB=AC.getRowCells(AI)[AT.dafIdx];}x=(AT.dafIdx>=0)?(AB&&AB._ei):"";return false;}}},this);var AO=function(p,AY){if(p&&(AY.type===a||AY.type===e)){if(AM.tg===false){p.n=p.v="";}p.rowType=l;}k(p,{col:AM,type:AY.type,extraCss:[((AY.type===W||AY.type===o)&&r&&(AI%2===1))?J.BANDING:null,AD?J.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AT.dafIdx!==undefined){p._ei=x;}}};this.lastRowIndex=0;for(AP=0;AP<AH.cgc;AP++){var AM=AH[AP],AR=AM["mix"+AM.cc],v=AR!==undefined,z=AE[v?1:0],AN,AL,AF,AV={n:"",stt:R,css:"xtab-td"};arr=[];if(AM.tg){for(var AQ=0;AQ<AM.cl;AQ++){arr=[];AF=v?AM["mix"+AQ]:AM.attForms[AQ].idx;var AA=v?this.lastMtxRow:this.lastAttRow;AW=AA[AF];if(AD){if(!AW){AW=AV;}else{if(AW&&AW.stt===R){AW=T.copy(q,AV);}else{AW=T.copy(AW,{});}}}else{AW=T.copy(AW,{});}AO(AW,z);arr.push(AW);AU.push(arr);}if(AP+1===AH.cgc){AK=AM.cl;}}else{for(AN=0,AS=AM.cl;AN<AS;AN++){if(v){AL=AM["mix"+AN];if(AL!==undefined){AW=this.lastMtxRow[AL];}}else{AL=AM.attForms[AN];if(AL){AW=this.lastAttRow[AL.idx];}if(AD&&!AW){AW=AV;}}AO(AW,z);arr.push(AW);}AU.push(arr);}}this.lastStackCols=AU;}w=P(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AT);if(this.lastRowIndex>=this.stackLevels){C.call(this);}return w;},getRowHeight:function E(q){var p=F[n];return F[q]||p;},getPadding:function K(p){return B[p]||B[X];},isDataAvailable:function f(q,p){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var t=this.sectionMap.length,r;if(!t){return this.cps[1].isDataAvailable(q,p);}if(p>t){if(q<t){r=Q.call(this,q);return this.cps[1].isDataAvailable(r,r+(p-q));}else{return false;}}else{return this.cps[1].isDataAvailable(Q.call(this,q),Q.call(this,p));}}},download:function H(w,t,x){var r=Q.call(this,w),p=r+Math.ceil((t-w)/this.stackLevels),u=this.cps[0],q,z,v=!u.cps?[u]:this.cps[0]._getCPs(r,p);for(q=0;q<v.length;++q){z=v[q];z.download(r,p,x);}},getRowCellInfo:function(t){var r=D.call(this,t+this.srh),p,q=this.lastSectionIndex;if(r){p=this.sectionInfo[q-1];return{rowStart:r.rs,isNextRowNewSection:true,sectionName:p&&p.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[q].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocImage","mstrmojo.HBox","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.Button","mstrmojo._HasDocLink","mstrmojo.css","mstrmojo.dom","mstrmojo.DocDataService","mstrmojo.vi.models.EnumFieldTypes");var E=mstrmojo.dom;var N=-1,b=0,Y=1,I=2,M=3,D=4,X=mstrmojo.boxmodel.px2Inches,c=mstrmojo.models.FormatModel,L=c.ENUM_PROPERTY_NAMES,F=mstrmojo.vi.models.EnumFieldTypes,P=function P(){var d=this.domNode;if(!d){return ;}mstrmojo.css.toggleClass(d,"hasLink",this.hasActiveLink());},a=function a(){var e=this.imgNode.firstChild;this.originalImgDim={w:e.naturalWidth,h:e.naturalHeight};var d=this.getCalculatedImageDimensions();this.defn.ih=this.imgNode.style.height=d.h+"px";this.defn.iw=this.imgNode.style.width=d.w+"px";if(d.ml){this.imgNode.style.marginLeft=d.ml+"px";}if(d.mt){this.imgNode.style.marginTop=d.mt+"px";}};function G(){if(this._isNewUrl){V.call(this);delete this._isNewUrl;}else{if(this._isNewEmbeddedImg){S.call(this);delete this._isNewEmbeddedImg;}}a.call(this);}function Z(d,h){var f=this.parent,n=this.imgNode.firstChild,p=this.model.getZoomProps(),e={},o=c.getFormatUpdate,m=n.naturalHeight,g=n.naturalWidth,l,k;if(m===0||g===0){l="30";k="30";}else{l=m;k=g;}o(L.IMAGE_HEIGHT,X(p,parseFloat(l)),e);o(L.IMAGE_WIDTH,X(p,parseFloat(k)),e);f.model.editField(f,F.IMAGE,{success:function(){f.selectVIUnit(true);}.bind(this)},d,h,{actions:[this.model.getUnitFormatAction(this,1,e,true)],extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA});}function S(){Z.call(this,"","");}function V(){Z.call(this,this.v,null);}mstrmojo.vi.ui.rw.DocImage=mstrmojo.declare(mstrmojo.DocImage,[mstrmojo._HasDocLink],{scriptClass:"mstrmojo.vi.ui.rw.DocImage",markupString:'<div id="{@id}" class="mstrmojo-DocImage {@imgStateClass}" style="{@domNodeCssText}"><div class="img-cntr"><img src="{@v}" mstrAttach:load,error><div mstrAttach:click></div></div>{@buttonNodeMarkup}</div>',markupMethods:{onheightChange:function J(){this.domNode.style.height=this.height;},onwidthChange:function K(){this.domNode.style.width=this.width;},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["BG"]},originalImgDim:undefined,model:undefined,onload:function W(){G.call(this);},onerror:function C(){G.call(this);},update:function H(e){var g=this;var m=this._super;var f=function(){m.call(this,e);var o=this.parent;if(o){o.updateOverlay();}P.call(this);}.bind(this);if(e&&e.defn&&e.defn.oid){var h=e.defn.fmts,k=h&&h["img-name"];if(this.parent&&k){this.parent.embeddedImageName=decodeURIComponent(k);}if(mstrApp.isSingleTier){var n={taskId:"getRWEmbeddedImage",fieldKey:e.k};var l={success:function(o){if(o&&o.imageData){e.data.v=o.imageData;}f();g.refresh();}};mstrApp.serverRequest(n,l);}else{var d=this.model.getDataService();e.data.v=mstrConfig.taskURL+"?taskId=getRWEmbeddedImage&amp;msgID="+d.msgId+"&amp;oid="+e.defn.oid;}}f();},postBuildRendering:function U(){this._super();P.call(this);a.call(this);},unrender:function T(d){this.clearCache();this._super(d);},isAspectRatioLocked:function A(){return this.defn.lock;},getSizeMode:function R(){return this.defn.ism;},getImageWidth:function O(){return this.defn.iw;},getImageHeight:function B(){return this.defn.ih;},updateDimensionsFromFormats:mstrmojo.emptyFn,getCalculatedImageDimensions:function Q(g){g=g||{mode:this.getSizeMode(),iw:parseFloat(this.getImageWidth()),ih:parseFloat(this.getImageHeight()),lock:this.isAspectRatioLocked()};var t={},n=this.parent,r=this.originalImgDim,k=g.mode;if(!r||!n.width){return t;}var f={w:parseFloat(n.width),h:parseFloat(n.height)};var m=(r.h!==0)?r.w/r.h:1,q=f.w/f.h;switch(k){case N:case Y:var e=g.iw,l=g.ih;if(g.lock&&(e!==undefined||l!==undefined)&&(r.h!==0&&r.w!==0)){var p=l===undefined;if(p){t.w=e;t.h=(e/m).toFixed(0);}else{t.h=l;t.w=(l*m).toFixed(0);}}else{t.w=e;t.h=l;}break;case I:case M:var h=((k===M&&(m>q))||(k===I&&(m<q))),d=E.isFF;if(h){t.h=f.h;t.w=parseInt(f.h*m);if(d){t.ml=parseFloat((f.w-t.w)/2);}}else{t.w=f.w;t.h=parseInt(f.w/m);if(d){t.mt=parseFloat((f.h-t.h)/2);}}break;case D:case b:var o=k===D?f:r;t.w=o.w;t.h=o.h;break;default:break;}return t;}});mstrmojo.vi.ui.rw.DocImage.EnumSizeModes={ORIGINAL:b,FIT_TO_CONTAINER:I,FILL_CONTAINER:M,STRETCH:D,FIXED:Y};mstrmojo.vi.ui.rw.DocImage.ImgDimConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.HBox","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren");function D(){return(this.renderMode!=="scroll")?this._super():true;}function C(){if(!this.hasRendered){return ;}var F=this.children||[],E=F.length-1;for(E;E>=0;E--){if(F[E].refresh){F[E].refresh();}}}mstrmojo.DocSection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSection",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSection" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},postBuildRendering:D,childRenderOnAddCheck:D,refresh:C,getWidth:function A(){return this._super(1);}});mstrmojo.DocSectionHoriz=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSectionHoriz",postBuildRendering:D,childRenderOnAddCheck:D,refresh:C,getHeight:function B(){return this._super(1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var D=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" style="z-index: 1100;" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},editorNode:null,btnHbox:null,markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(L){if(L){return ;}var J=this.visible,K=J?"block":"none";this.editorNode.style.display=K;if(this.modal){this.curtainNode.style.display=K;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function F(){var J;var K=this.buttons;if(K&&!this.btnHbox){for(J in K){K[J].cssClass=(K[J].cssClass||"")+(this.noButtonCls?"":" mstrmojo-Editor-button");}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:K},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function B(){var J=this.placeholder;if(this._super()){if(!this.parent&&!J){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function E(){var J=this.id;return function(){var K=mstrmojo.all[J];K.resizeDialog();K.positionDialog();};},postBuildRendering:function A(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var K=this._resizeHandler=this.getResizeHandler();D.attachEvent(window,"resize",K);}this.resizeDialog();this.positionDialog();try{this.domNode.focus();}catch(J){}return true;},resizeDialog:function G(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function C(){var K=this,O=K.curtainNode,J=document.body,M=document.documentElement,N=O.style,L=K.curtainPosition;N.width=Math.max(J.clientWidth,M.scrollWidth)+"px";if(L&&L.h){N.height=L.h+"px";}else{N.height=Math.max(J.clientHeight,M.scrollHeight)+"px";}if(L&&L.y){N.top=L.y+"px";}K.raiseEvent({name:"resizeCurtain"});},positionDialog:function H(){var K=this.editorNode,M=this.left,L=this.top;if(!M||!L){D.center(K);var J=K.style;if(this.alignment==="top"){J.top="10px";}if(M){J.left=M;}if(L){J.top=L;}}},destroy:function(K){var J=this._resizeHandler;if(J){D.detachEvent(window,"resize",J);}this._super(K);}});mstrmojo.toast=function I(O,M,Q,J){var P="mojoToast9",N,L=M||3000;if(J&&J.id){P=J.id+"-"+P;}try{mstrmojo.all[P].destroy();}catch(K){}mstrmojo.insert({id:P,scriptClass:"mstrmojo.Label",cssClass:(J&&J.cssClass)?J.cssClass:"toastCss",text:O}).render();N=mstrmojo.all[P].domNode;if(J&&J.dom){J.dom.appendChild(N);}else{document.body.appendChild(N);D.bottomCenter(N);}window.setTimeout(function(){if(Q){Q();}try{mstrmojo.all[P].destroy();}catch(R){}},L);};mstrmojo.mask={show:function(){var J=mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});J.render();document.body.appendChild(J.domNode);},hide:function(){mstrmojo.mask.win.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.FieldSet","mstrmojo.Table");var D=mstrmojo.hash,B=mstrmojo.num;var C=function(F){return D.copy(F,{scriptClass:"mstrmojo.ValidationTextBox",maxLength:6,dtp:4,min:0,max:100,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP},bindings:{m:F.modelBinding,value:function(){var G=this.m[this.pr];return G==null?"":this._PT2UserUnits(G).replace(/([\.,][1-9]{1,})0{1,}$/,"$1").replace(/\.$/,".0").replace(/,$/,",0");}},postCreate:function(){this.markupMethods=D.copy({onvalueChange:function(){this.inputNode.value=this.value;}},D.copy(this.markupMethods));},onValid:function(){this.m[this.pr]=this._UserUnits2PT(this.value);},_PT2UserUnits:function(G){return B.toLocaleString(B.convertToLocalUnits(B.toString(G),mstrApp.units));},_UserUnits2PT:function(G){return B.toLocaleString(B.toString(B.convertToUSUnits(G,mstrApp.units)));}});};var A=function(F,G){return{scriptClass:"mstrmojo.Label",text:F,slot:G};};mstrmojo.PaddingFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.PaddingFormatter",cssClass:"mstrmojo-PaddingFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},init:function E(F){var G=mstrConfig.unitsLabel||mstrApp.unitsLabel;this.children=[{scriptClass:"mstrmojo.FieldSet",alias:"padding",cssClass:"mstrmojo-FormatEditor-padding",legend:mstrmojo.desc(2883),children:[{scriptClass:"mstrmojo.HBox",cssClass:"paddingBox",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:3,children:[A(mstrmojo.desc(3528),"0,0"),C({pr:"LeftPadding",slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"0,2"),A(mstrmojo.desc(3526),"1,0"),C({pr:"TopPadding",slot:"1,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"1,2")]},{scriptClass:"mstrmojo.Table",rows:2,cols:3,children:[A(mstrmojo.desc(3529),"0,0"),C({pr:"RightPadding",slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"0,2"),A(mstrmojo.desc(3527),"1,0"),C({pr:"BottomPadding",slot:"1,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"1,2")]}]}]}];this._super(F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.Box","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo.Label","mstrmojo.Button","mstrmojo.TextBox");var A=mstrmojo.string;mstrmojo.vi.ui.rw.ImageBoxOverlay=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo._Formattable],{scriptClass:"mstrmojo.vi.ui.rw.ImageBoxOverlay",markupString:'<div id="{@id}" class="mstrmojo-ImageBoxOverlay cf {@cssClass}" style="{@domNodeCssText}"><div class="lbl"></div><div class="txt"></div><div class="btn"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},labelNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.children[1];},buttonNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},formatHandlers:{domNode:["BG"]},imageBox:undefined,imgURL:undefined,origURLStr:undefined,children:[{scriptClass:"mstrmojo.Label",slot:"labelNode",cssClass:"init-label",text:mstrmojo.desc(12277,"Input image path:")},mstrmojo.Button.newActionButton(mstrmojo.desc(1442,"OK"),function(){var C=this.parent;if(C.imgURL.value!==C.origURLStr){C.imageBox.urlEdited(C.imgURL.value);}else{C.imageBox.hideControlOverlay();}},{alias:"okBtn",slot:"buttonNode",enabled:false}),{scriptClass:"mstrmojo.TextBox",cssClass:"init-input",alias:"imgURL",slot:"textNode",hint:mstrmojo.desc(10493,"Image URL"),onkeydown:function(C){if(C.e.keyCode===13){var D=this.parent;if(D.imgURL.value!==D.origURLStr){D.imageBox.urlEdited(this.value);}else{D.imageBox.hideControlOverlay();}}},getLayoutOffsets:function B(){return{h:0,w:2};},_set_value:function(F,C){var D=this.value;if(D!==C){this.value=C;var E=this.parent.okBtn;E.set("enabled",!A.isEmpty(C));E.set("iconClass",!A.isEmpty(C)?"hot":"");}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.TextBox");var A=mstrmojo.css,C=mstrmojo.dom;mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur></textarea>',maxLength:256,onkeydown:function B(K){var I=this.inputNode,J=this.value,E=this.maxLength,F=(J&&J.length)||0,M=K.e,L=M.keyCode;this.isDeleteKeys=L===8||L===46;this.isArrowKeys=L===37||L===38||L===39||L===40;if(E!==undefined&&E<=F){var G=I.selectionEnd,H=(G!==undefined)?(G-I.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!H){if(C.isIE7||C.isIE8||C.isIE9){I.blur();window.setTimeout(function(){I.focus();},1);}C.preventDefault(window,M);return false;}}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.TextArea,{oncssClassChange:function D(){A.addClass(this.domNode,this.cssClass||"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo.hash");var A="mstrmojo-TextBoxWithLabel";mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="'+A+' {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur/><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;},lblNode:function(){return this.domNode.firstChild;}}});mstrmojo.TextBoxWithLabel.prototype.markupMethods=mstrmojo.hash.copy({oncssClassChange:function(){var B=this.cssClass;this.domNode.className=A+(B?" "+B:"");},onlabelChange:function(){this.lblNode.innerText=this.label||"";}},mstrmojo.hash.copy(mstrmojo.TextBoxWithLabel.prototype.markupMethods));}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasLayout");mstrmojo.ui.editors.controls.PreviewButton=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.PreviewButton",markupString:'<div id="{@id}" class="mstrmojo-ui-PreviewButton {@cssClass}" style="{@cssText}"><div class="cf" mstrAttach:click><div class="preview"></div><div class="btn">&nbsp;</div></div><div class="host"></div></div>',markupSlots:{previewNode:function(){return this.domNode.firstChild.firstChild;},btnNode:function(){return this.domNode.firstChild.lastChild;},widgetHostNode:function(){return this.domNode.lastChild;},clickableNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{previewNode:"100%",btnNode:"100%",widgetHostNode:"0px"},w:{previewNode:"100%",btnNode:"20px",widgetHostNode:"all"},xt:true},isHostedWithin:false,getLayoutOffsets:function B(){return{h:2,w:2};},anchorSlot:"clickableNode",updatePreview:function C(){throw new Error(this.scriptClass+" must implement updatePreview.");},getPopupHostNode:function A(){return this.widgetHostNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.css","mstrmojo.array");mstrmojo.vi.ui.PanelContents=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.PanelContents",layoutConfig:{w:{containerNode:"100%"},xt:true},slot:"containerNode",init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIPanelContents");},setDimensions:function A(D,C){this.set("width",C);(this.children||[]).forEach(function(H){var F=H.getLayoutOffsets&&H.getLayoutOffsets(),G=(F&&F.w)||0,E=parseInt(C,10)-G+"px";if(H.setDimensions){H.setDimensions("auto",E);}else{H.set("width",E);}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout");mstrmojo.ui.LayoutBox=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.LayoutBox",layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ui.ColumnContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnContainer {@cssClass}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.firstChild;}},markupMethods:{onnextChange:function A(){B.toggleClass(this.domNode,"hasNext",!!this.next);}},active:false,next:null,idx:undefined,updateColumnContainer:function D(){var E=this.next;if(E){E.updateColumnContainer();}},onactiveChange:function C(){B.toggleClass(this.domNode,"active",this.active);var E=this.next;if(E){E.updateColumnContainer();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasOwnAvatar","mstrmojo.css","mstrmojo.dom");var E=mstrmojo.css,D=mstrmojo.dom;function F(K){var L=K.src.node,M=this.children.filter(function(N){return D.contains(N.domNode,L,true,this.domNode);});return M[0];}function J(K){var N=K.tgt,V=this.children,R=D.getMousePosition(N.e,N.hWin),Q,S,U,M,T,P,L=R.y;for(var O=V.length-1;O>=0;O--){U=V[O];Q=D.position(U.domNode);T=Q.h;M=Q.y;P=M+T/2;if(P<L&&(O===V.length-1||L<=M+T)){S=O;break;}else{if((O===0||M<L)&&L<=P){S=O-1;break;}}}return S;}function I(K){return K===-1?"top":"bottom";}mstrmojo.threshold.ThresholdRowPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",dropZone:true,draggable:true,restrictedToAxis:"y",avatarCssClass:"threshold-drag-avatar",getDragData:function H(K){return{row:F.call(this,K)};},createAvatar:function B(M,L){var K=L.src.data.row.domNode.cloneNode(true);K.style.left=D.position(this.domNode).x+"px";return K;},isDragValid:function G(K){var L=K.getCtxtDragData().row;return !(this.children.length===1||!L||L.draggableNode!==K.src.node)||this._super(K);},ondragstart:function(K){this._super(K);this.removeChildren(K.getCtxtDragData().row);},ondragmove:function A(M){var O=M.getCtxtDragData(),N=this.children,L=J.call(this,M);var K=O.lastRowIdx;if(K!==L){if(K!==undefined){E.removeClass(N[Math.max(K,0)].domNode,I(K));}E.addClass(N[Math.max(L,0)].domNode,I(L));O.lastRowIdx=L;}this._super(M);},ondragend:function C(L){var M=L.src.data,K=M.lastRowIdx;if(K!==undefined){E.removeClass(this.children[Math.max(K,0)].domNode,I(K));}this._super(L);this.parent.parent.model.moveThreshold(L.getCtxtDragData().row.idx,K+1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.ME.Enum");mstrmojo.requiresDescs();var M=mstrmojo.dom,B=mstrmojo.string,D=mstrmojo.Widget;var H=/\r?\n?----\r?\n?/;function F(N){var O=B.decodeHtmlString((N||{}).desc||"",true).split(H);return{desc:O[0],example:O.length===2?O[1]:""};}mstrmojo.ME.FunctionInfo=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.FunctionInfo",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="mstrmojo-FunctionInfo-container"><div class="mstrmojo-FunctionInfo-syntax"></div><div class="mstrmojo-FunctionInfo-desc"></div><div class="mstrmojo-FunctionInfo-eg"><span class="icon" t="icon"></span><span class="text"></span></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},syntaxNode:function(){return this.domNode.firstChild.firstChild;},descNode:function(){return this.domNode.firstChild.childNodes[1];},egNode:function(){return this.domNode.firstChild.lastChild;},egTextNode:function(){return this.domNode.firstChild.lastChild.lastChild;}},markupMethods:{onvisibleChange:D.visibleMarkupMethod,onfoiChange:function(){this.syntaxNode.innerHTML=B.htmlAngles(this.syntax)||"";this.descNode.innerHTML=this.desc;this.egTextNode.innerHTML=this.example;this.egNode.style.display=this.example?"block":"none";this.updateScrollbars();}},foi:{},syntax:"",desc:"",example:"",init:function L(N){this._super(N);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-FunctionInfo");},setupScrollNodes:function C(){if(!mstrmojo.dom.ISIE8){this.scrollNode=this.containerNode;}},onfoiChange:function A(){this.set("syntax",this.getFunctionSyntax());this.set("desc",this.getDesc()+" "+this.getHelpTopic());this.set("example",this.getExample());},getFunctionSyntax:function K(R){var T=R||this.foi;if(!T){return"";}if(T.did<0){return T.n;}var Q=T.pars,S=T.pros,O=[],P,N;O.push(T.n);S=mstrmojo.hash.clone(S)||[];if(T.ios){S.push({n:"SortBy"});}if(T.sqt===5){S.push({n:"BreakBy"});}if(this.showFullSyntax){if(S.length>0){O.push("<");for(P=0,N=S.length;P<N;P++){if(mstrmojo.array.indexOf(mstrmojo.ME.Enum.NonExposableParams,S[P].n)===-1){O.push(S[P].n);O.push(", ");}}O.pop();O.push(">");}}O.push("(");for(P=0,N=Q.length;P<N;P++){O.push(Q[P].n);if(P!==(N-1)){O.push(", ");}}O.push(")");return O.join("");},getDesc:function E(){return F(this.foi).desc;},getExample:function J(){return F(this.foi).example;},getHelpTopic:function G(N){var O=N||this.foi;if(!O||O.did===mstrmojo.ME.Enum.SHORTCUT_FUNCTIONS.Row_Count){return"";}return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(O.h);},useRichTooltip:true,showTooltip:function I(N,Q){var P=M.eventTarget(Q,N),O=this.foi;if(P&&P.getAttribute("t")==="icon"){this.richTooltip=this.getTooltip(O,P);if(this.richTooltip){this._super(N,Q);}}},getTooltip:function(Q,R){var O=M.position(R),P=R.egTip||"";var N={areaId:Q._renderIdx+"text",cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:P,top:O.y-75,left:O.x+O.w-30,enableHover:false};return N;}});mstrmojo.ME.FunctionInfo.getDescAndExample=F;}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.css");var B=mstrmojo.css;mstrmojo.vi.ui.editors.EditorGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},showDivider:true,isNested:false,isContainer:false,init:function D(E){this._super(E);B.addWidgetCssClass(this,["mstrmojo-vi-EditorGroup","ctrl-group"]);},preBuildRendering:function A(){var E=[];if(this.showDivider){E.push("divide");}if(this.isContainer){E.push("container");}if(E.length){B.addWidgetCssClass(this,E);}return this._super();},getLayoutOffsets:function C(){return{h:0,w:this.isNested?0:18};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.editors._HostsControls","mstrmojo._HasLayout","mstrmojo.css");mstrmojo.ui.editors.controls.ControlGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.editors._HostsControls,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ControlGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},shouldPropagateEnabled:true,init:function A(B){this._super(B);mstrmojo.css.addWidgetCssClass(this,"ctrl-group");}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ui.editors.controls.ControlGroup,{onenabledChange:mstrmojo.Container.enabledMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui.PopupConfig","mstrmojo.css");mstrmojo.ui.editors.ToolbarPopup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.ToolbarPopup",popupConfig:null,anchorElement:null,autoCloses:false,locksHover:true,init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ToolbarPopup");this.popupConfig=new mstrmojo.ui.PopupConfig({isHostedWithin:false,hostProxyCssClass:(mstrApp&&mstrApp.getThemeClassName())||"",anchorElement:this.anchorElement});},open:function A(D,C){D.closePopup();this._super(D,C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocTextfield","mstrmojo.ui._HasScroller");mstrmojo.vi.ui.ScrollableDocTextfield=mstrmojo.declare(mstrmojo.DocTextfield,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.ScrollableDocTextfield",setupScrollNodes:function A(){this.scrollNode=this.valueNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo._HasLayout","mstrmojo.vi.ui.rw._SavesChildPositions");var A="100%";mstrmojo.vi.ui.rw.DocVIMainPanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo._HasLayout,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocVIMainPanel",layoutConfig:{h:{containerNode:A},w:{containerNode:A},xt:true}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.StackContainer");mstrmojo.TabContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.TabContainer",markupString:'<div id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><div class="mstrmojo-tabcontainer-tabs"></div><div class="mstrmojo-tabcontainer-stack"></div><div></div></div>',markupMethods:{onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{top:function(){return this.domNode.childNodes[0];},stack:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1];},bottom:function(){return this.domNode.childNodes[2];}},addChildren:function A(D,K,H){var G=this._super(D,K,H);var B=this.children,F=B.length;if(F>=2){var L,I,E;for(E=0;E<F;E++){var C=B[E],J=C&&C.slot;if(!L&&C.isStrip){L=C;}else{if(!I&&(!J||J==="stack")){I=C;}}if(L&&I){L.set("target",I);break;}}}return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label","mstrmojo.WaitIcon");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div class="mstrmojo-IncFetch-content"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,T=this.parent.parent;if(R===""){T.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);T.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.rw.DocSubsection","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo._HasLayout");mstrmojo.vi.ui.rw.DocSubsection=mstrmojo.declare(mstrmojo.rw.DocSubsection,[mstrmojo._HasLayout,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocSubsection",alias:"docSubSection",formatHandlers:null,layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true}});}());(function(){mstrmojo.requiresClsP("mstrmojo.vi.viz","VisualizationTransition","EnumAxisNames");mstrmojo.requiresCls("mstrmojo.chart.model.enums.EnumDSSObjectType");var A=mstrmojo,E=A.vi.viz,C=E.EnumAxisNames,D=A.chart.model.enums.EnumDSSObjectType;mstrmojo.vi.viz.BaseVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.BaseVisualizationTransition",transitionDropZones:function B(H,O){var F=this.vis,G=F.node,N=G.k,M=G.data.gsi,Q=M.rows,K=M.cols,I,L,J=[],P=function(U,T,R,S){U.push({act:"pivot",unitId:T.did!=="-1"?T.did:"",unitType:T.did!=="-1"?T.t:"",axis:S,unitPos:R+1});};for(I=0;I<K.length;I++){L=K[I];if(L.t!==D.DssTypeMetric){P(J,L,I,C.ROWS);}}for(I=0;I<Q.length;I++){L=Q[I];if(L.did==="-1"){P(J,L,I,C.COLUMNS);break;}}if(J.length){H.push({act:"updateTemplate",keyContext:N,partialRetrieval:{nodes:[N]},actions:J});}return{wp:"<props><widgetProps /></props>",handled:false};}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.gm.GMEnums","mstrmojo.gm.EnumShape");mstrmojo.requiresClsP("mstrmojo.vi.viz","KnownVisualizations","EnumVisualizationTemplates","VisualizationTransition","GraphMatrixHelper","HeatMapVisualizationHelper","NetworkVisualizationHelper","ImageLayoutHelper","ESRIMapHelper","GoogleMapHelper");var Q=mstrmojo,BA=mstrmojo.gm,BU=Q.array,AW=Q.hash,BV=Q.vi.viz,BL=BV.KnownVisualizations,BE=BV.EnumVisualizationTemplates,n=BV.GraphMatrixHelper,H=mstrmojo.chart.model.enums.EnumDSSObjectType,AN="Grid",K=BA.EnumShape,N=BA.DualAxisSubAxisBit,Bb=N.PRIMARY,D=N.SECONDARY,Bc=BV.EnumDSSDropZones,AE=Bc.XAxis,I=Bc.YAxis,AS=Bc.Angle,r=Bc.ColorBy,Bg=1;var AC=BE.GRAPHMATRIXVERTICALBARAUTOMATIC,A=BE.GRAPHMATRIXVERTICALLINEAUTOMATIC,U=BE.GRAPHMATRIXVERTICALAREAAUTOMATIC,Au=BE.GRAPHMATRIXVERTICALBARSTACKED,A3=BE.GRAPHMATRIXVERTICALLINESTACKED,An=BE.GRAPHMATRIXVERTICALAREASTACKED,q=BE.GRAPHMATRIXBUBBLECIRCLEMM,AV=BE.GRAPHMATRIXBUBBLESQUAREMM,Be=BE.GRAPHMATRIXSCATTERCIRCLEMM,t=BE.GRAPHMATRIXSCATTERSQUAREMM,T=BE.GRAPHMATRIXBUBBLEGRIDCIRCLEAA,AT=BE.GRAPHMATRIXBUBBLEGRIDSQUAREAA,Av=BE.GRAPHMATRIXSCATTERGRIDCIRCLEAA,BS=BE.GRAPHMATRIXSCATTERGRIDSQUAREAA,Ad=BE.GRAPHMATRIXVERTICALBARCLUSTERED,p=BE.GRAPHMATRIXVERTICALLINECLUSTERED,AH=BE.GRAPHMATRIXVERTICALAREACLUSTERED,AL=BE.GRAPHMATRIXVERTICALBARPERCENT,AU=BE.GRAPHMATRIXVERTICALLINEPERCENT,AB=BE.GRAPHMATRIXVERTICALAREAPERCENT,m=BE.GRAPHMATRIXHORIZONTALBARAUTOMATIC,AR=BE.GRAPHMATRIXHORIZONTALLINEAUTOMATIC,Ak=BE.GRAPHMATRIXHORIZONTALAREAAUTOMATIC,AJ=BE.GRAPHMATRIXHORIZONTALBARCLUSTERED,Al=BE.GRAPHMATRIXHORIZONTALLINECLUSTERED,A1=BE.GRAPHMATRIXHORIZONTALAREACLUSTERED,w=BE.GRAPHMATRIXHORIZONTALBARSTACKED,Am=BE.GRAPHMATRIXHORIZONTALLINESTACKED,Ai=BE.GRAPHMATRIXHORIZONTALAREASTACKED,J=BE.GRAPHMATRIXHORIZONTALBARPERCENT,x=BE.GRAPHMATRIXHORIZONTALLINEPERCENT,h=BE.GRAPHMATRIXHORIZONTALAREAPERCENT,Z=BE.GRAPHMATRIXPIE,Ar=BE.GRAPHMATRIXRING,V=BE.GRAPHCOMBINATIONBARAREA,M=BE.GRAPHCOMBINATIONBARAREADUALAXIS,AO=BE.GRAPHMATRIXBUBBLESQUAREAM,l=BE.GRAPHMATRIXSCATTERSQUAREAM;var Ay="nm",B="m",A7="none",R="any",Ah="toggle",Ac="MetricsInAny",Ab="MetricsInNone";function BO(Bl){var Bo=AW.copy(Bl.data.gsi),Bm=Bo.tma===1?"rows":"cols",Bk=Bo[Bm],Bn=Bo.mx;Bo[Bm]=Bk.filter(function(Bp){return Bp.t!==-1&&Bp.did!=="-1";});if(Bn){Bn.forEach(function(Bp){Bp.t=4;});}return Bo;}function Bi(Bm){var Bl=this.templateInfo,Bk;for(Bk=0;Bk<Bl.rows.length;Bk++){if(Bl.rows[Bk].did===Bm.id){Bl.rows.splice(Bk,1);return ;}}for(Bk=0;Bk<Bl.cols.length;Bk++){if(Bl.cols[Bk].did===Bm.id){Bl.cols.splice(Bk,1);return ;}}for(Bk=0;Bk<Bl.mx.length;Bk++){if(Bl.mx[Bk].did===Bm.id){Bl.mx.splice(Bk,1);return ;}}}function At(Bk,Bl){Bk.MetricsDropZone=Bl;}function BT(Bn,Bk,Bl,Bm){Bn.Zones[Bk]={type:Bl,min:Bm};}function Bf(Bm,Bl,Bk){Bm.Properties[Bl]=Bk;}function BP(Bl,Bk){return Bl.Zones[Bk];}function Af(Bk){var Bl={Zones:[],Properties:[]};switch(Bk){case q:case AV:At(Bl,Ac);BT(Bl,n.PROP_XAXIS,B,1);BT(Bl,n.PROP_YAXIS,B,1);BT(Bl,n.PROP_SIZEBY,B,1);BT(Bl,n.PROP_BREAKBY,R,1);BT(Bl,n.PROP_COLORBY,R,0);break;case Be:case t:At(Bl,Ac);BT(Bl,n.PROP_XAXIS,B,1);BT(Bl,n.PROP_YAXIS,B,1);BT(Bl,n.PROP_SIZEBY,A7,1);BT(Bl,n.PROP_BREAKBY,Ay,1);BT(Bl,n.PROP_COLORBY,Ay,0);break;case T:case AT:At(Bl,Ab);BT(Bl,n.PROP_XAXIS,Ay,1);BT(Bl,n.PROP_YAXIS,Ay,1);BT(Bl,n.PROP_BREAKBY,A7,0);BT(Bl,n.PROP_SIZEBY,B,1);break;case Av:case BS:At(Bl,Ab);BT(Bl,n.PROP_XAXIS,Ay,1);BT(Bl,n.PROP_YAXIS,Ay,1);BT(Bl,n.PROP_BREAKBY,A7,0);BT(Bl,n.PROP_SIZEBY,A7,0);BT(Bl,n.PROP_COLORBY,B,1);break;case AC:case A:case U:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,Ay,1);BT(Bl,n.PROP_YAXIS,B,1);break;case Ad:case p:case AH:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,Ay,1);BT(Bl,n.PROP_YAXIS,B,1);break;case Au:case A3:case An:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,Ay,1);BT(Bl,n.PROP_YAXIS,B,1);break;case AL:case AU:case AB:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,Ay,1);BT(Bl,n.PROP_YAXIS,B,1);break;case m:case AR:case Ak:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,B,1);BT(Bl,n.PROP_YAXIS,Ay,1);break;case AJ:case Al:case A1:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,B,1);BT(Bl,n.PROP_YAXIS,Ay,1);break;case w:case Am:case Ai:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,B,1);BT(Bl,n.PROP_YAXIS,Ay,1);break;case J:case x:case h:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,B,1);BT(Bl,n.PROP_YAXIS,Ay,1);break;case Z:case Ar:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_SLICE,Ay,1);BT(Bl,n.PROP_ANGLE,B,1);BT(Bl,n.PROP_COLORBY,Ay,0);break;case V:case M:At(Bl,n.PROP_ROWS);BT(Bl,n.PROP_XAXIS,Ay,1);BT(Bl,n.PROP_YAXIS,B,1);break;}switch(Bk){case q:case T:case Be:case Av:Bf(Bl,n.PROP_SHAPE,n.PROP_SHAPE_CIRCLE);break;case AO:case AV:case AT:case l:case t:case BS:Bf(Bl,n.PROP_SHAPE,n.PROP_SHAPE_SQUARE);break;case Ad:case Au:case AL:case AJ:case w:case J:case AC:case m:Bf(Bl,n.PROP_SHAPE,n.PROP_SHAPE_BAR);break;case p:case A3:case AU:case Al:case Am:case x:case A:case AR:Bf(Bl,n.PROP_SHAPE,n.PROP_SHAPE_LINE);break;case AH:case An:case AB:case A1:case Ai:case h:case U:case Ak:Bf(Bl,n.PROP_SHAPE,n.PROP_SHAPE_AREA);break;case Z:Bf(Bl,n.PROP_SHAPE,n.PROP_SHAPE_PIE);break;case Ar:Bf(Bl,n.PROP_SHAPE,n.PROP_SHAPE_RING);break;case M:Bf(Bl,n.PROP_SHAPE,n.PROP_SHAPE_BAR);break;}switch(Bk){case Ad:case p:case AH:case AJ:case Al:case A1:Bf(Bl,n.PROP_SUBTYPE,n.PROP_SUBTYPE_CLUSTERED);break;case Au:case A3:case An:case w:case Am:case Ai:Bf(Bl,n.PROP_SUBTYPE,n.PROP_SUBTYPE_STACKED);break;case AL:case AU:case AB:case J:case x:case h:Bf(Bl,n.PROP_SUBTYPE,n.PROP_SUBTYPE_PERCENT);break;case Z:case Ar:case AC:case m:case A:case AR:case U:case Ak:case M:Bf(Bl,n.PROP_SUBTYPE,n.PROP_SUBTYPE_AUTOMATIC);break;}return Bl;}function BC(Bk,Bm,Bl){if(Bm===A7){return false;}if(Bm===R){return true;}if((Bk.t===H.DssTypeMetric)&&(Bm===B)){return true;}if((Bk.t!==H.DssTypeMetric)&&(Bm===Ay)){return true;}if(Bm===Ah){var Bn=BP(Bl,n.PROP_XAXIS);if((Bn&&Bn.t===B)&&(Bk.t!==H.DssTypeMetric)){return true;}if((Bn&&Bn.t===Ay)&&(Bk.t===H.DssTypeMetric)){return true;}return false;}return false;}function L(Bl){var Bk=false;switch(Bl){case AJ:case w:case J:case Al:case Am:case x:case A1:case Ai:case h:case m:case AR:case Ak:Bk=true;break;default:break;}return Bk;}function Aw(Bl){var Bk=false;switch(Bl){case q:case T:case AO:case AV:case AT:case Be:case Av:case l:case t:case BS:Bk=true;break;default:break;}return Bk;}function C(Bk){return(Bk===V||Bk===M);}function A6(Bl,Bm,Bn,Bk,Bo){if(Bm.length+Bn.length>=Bo.min){if(Bn.length){Bl[Bk].push(Bn.pop());}else{if(Bm.length){Bl[Bk].push(Bm.pop());}}}}function A9(Bn,Bm,Bl){var Br=this.templateInfo,Bo=Br.rows,Bp=Br.cols,Bq=BP(Bn,n.PROP_SLICE);if(Bq&&Bq.type===Ay&&!Bm.sliceObjects.length){A6(Bm,Bo,Bp,"sliceObjects",Bq);}Bq=BP(Bn,n.PROP_XAXIS);if(Bq&&(Bq.type===Ay||Bq.type===R)&&!Bm.xAxisObjects.length){A6(Bm,Bp,Bo,"xAxisObjects",Bq);}Bq=BP(Bn,n.PROP_YAXIS);var Bk=Bq&&((Bq.type===Ay)||(Bq.type===R));if(!Bk&&Bq&&Bq.type===Ah&&Bm.xAxisObjects.length){if(Bm.xAxisObjects[0].t===4){Bk=true;}}if(Bk){A6(Bm,Bo,Bp,"yAxisObjects",Bq);}Bq=BP(Bn,n.PROP_BREAKBY);if(Bq&&Bq.type===Ay&&!Bm.breakByObjects.length){if(L(Bl)){A6(Bm,Bo,Bp,"breakByObjects",Bq);}else{A6(Bm,Bp,Bo,"breakByObjects",Bq);}}Bq=BP(Bn,n.PROP_COLORBY);if(Bq&&Bq.type===Ay&&!Bm.colorByObjects.length){if(Bm.sliceObjects.length){Bm.colorByObjects.push(Bm.sliceObjects[0]);}else{if(Bo.length+Bp.length>=Bq.min){if(L(Bl)){A6(Bm,Bo,Bp,"colorByObjects",Bq);}else{A6(Bm,Bp,Bo,"colorByObjects",Bq);}}}}}function Y(Bk){if(Bk.getMetricCountInZone(Bk.xAxisObjects)>Bg){return true;}if(Bk.getMetricCountInZone(Bk.yAxisObjects)>Bg){return true;}if(Bk.angleObjects&&Bk.getMetricCountInZone(Bk.angleObjects)>Bg){return true;}return false;}function BD(Bn,Bl,Bm){if(Y(Bm)){if(!Az(Bm.colorByObjects)){Bm.secondaryMetricsDropZone=n.PROP_COLORBY;}var Bk=Bn.MetricsDropZone;if(!Bk||Bk!=="null"){switch(Bk){case Ab:Bm.metricsDropZone="";break;case Ac:Bm.metricsDropZone=n.PROP_COLUMNS;break;default:Bm.metricsDropZone=Bk;break;}}}}function BK(Bm,Bl,Bk){var Bo=this.templateInfo.mx,Bn;if(!Bo.length){return ;}Bn=BP(Bm,n.PROP_ANGLE);if(Bn&&Bn.type===B&&!Bl.angleObjects.length&&Bo.length>=Bn.min){Bl.angleObjects.push(Bo[0]);Bo.splice(0,1);}Bn=BP(Bm,n.PROP_XAXIS);if(Bn&&Bn.type===B&&!Bl.xAxisObjects.length&&Bo.length>=Bn.min){Bl.xAxisObjects.push(Bo[0]);Bo.splice(0,1);}Bn=BP(Bm,n.PROP_YAXIS);if(Bn){var Bp=(Bn.type===B);if(!Bp&&Bn.type===Ah){if(!Bl.xAxisObjects.length||Bl.xAxisObjects[0].t!==4){Bp=true;}}if(Bp&&!Bl.yAxisObjects.length){if(Bo.length>=Bn.min){Bl.yAxisObjects.push(Bo[0]);Bo.splice(0,1);if(Bo.length>0&&(Bk===V||Bk===M)){Bl.yAxisObjects.push(AW.copy({ax:D},Bo[0]));Bo.splice(0,1);}}}}Bn=BP(Bm,n.PROP_COLORBY);if(Bn&&Bn.type===B&&!Bl.colorByObjects.length){if(Bo.length>0){Bl.colorByObjects.push(Bo[0]);this.markedObjects.push(Bo[0]);}else{[{n:"sizeByObjects",fn:function(Bq){return Bl[Bq].length;}},{n:"xAxisObjects",fn:function(Bq){return Bl[Bq].length&&Bl[Bq][0].t===4;}},{n:"yAxisObjects",fn:function(Bq){return Bl[Bq].length&&Bl[Bq][0].t===4;}}].forEach(function(Br){if(Br.fn(Br.n)){var Bs=Bl[Br.n],Bq=AW.copy(Bs[Bs.length-1]);Bq.ax=1;Bl.colorByObjects.push(Bq);}});}}Bn=BP(Bm,n.PROP_SIZEBY);if(Bn&&Bn.type===B&&!Bl.sizeByObjects.length){if(Bo.length){Bl.sizeByObjects.push(Bo[0]);this.markedObjects.push(Bo[0]);}else{["colorByObjects","xAxisObjects","yAxisObjects"].forEach(function(Bs){var Br=Bl[Bs],Bq=Br.length;if(Bq&&Br[0].t===4){Bl.sizeByObjects.push(Br[Bq-1]);}});}}}function G(Bl){var Bk=false;BU.forEach(this.markedObjects,function(Bm){if(Bm.did===Bl){Bk=true;return false;}});return Bk;}function Bj(Bl){var Bk=this,Bm=this.templateInfo;Bm.rows.forEach(function(Bn){Bl.rowObjects.push(Bn);});Bm.cols.forEach(function(Bn){Bl.columnObjects.push(Bn);});Bm.mx.forEach(function(Bn){if(!G.call(Bk,Bn.did)){Bl.tooltipMetrics.push(Bn);}});}function Bh(Bk,Bm){var Bl=Bk.Properties;if(Bl[n.PROP_SHAPE]){Bm.shape=Bl[n.PROP_SHAPE];}if(Bl[n.PROP_SUBTYPE]&&(Bm.subtype===""||Bm.subtype===n.PROP_SUBTYPE_AUTOMATIC)){Bm.subtype=Bl[n.PROP_SUBTYPE];}}function b(Bl,Bk,Bn){if(Bk.colorByObjects.length<=0){return ;}var Bm=Bk.colorByObjects[0];if(Bm.t===H.DssTypeMetric){this.addThresholds(Bl,Bm,Bn,undefined,undefined);}}function Aa(Bk,Bm){var Bl=(Bk.data.gts&&Bk.data.gts.row)||[];Bl.forEach(function(Bn){if(Bn.otp===12&&Bn.ast&&Bn.ast.length){Bm.push({act:"showTotals",unitId:Bn.id,unitType:Bn.otp,subtotalType:[],clearSubtotalType:Bn.ast.map(function(Bo){return Bo.t;})});}});}function Az(Bk){var Bl,Bm;for(Bl=0;Bl<Bk.length;Bl++){Bm=Bk[Bl];if(Bm.t===H.DssTypeMetric){return true;}}return false;}function o(Bm){var Bp,Bo,Bn,Bk=false,Bl;for(Bo=0;Bo<Bm.sliceObjects.length;Bo++){Bp=Bm.sliceObjects[Bo];if(Bp.t===H.DssTypeAttribute){Bn=Bp;Bk=true;break;}}if(!Bk){return ;}Bl=Az(Bm.xAxisObjects);if(!Bl){Bl=Az(Bm.yAxisObjects);}if(!Bl){Bl=Az(Bm.sizeByObjects);}if(!Bl){return ;}}function BM(Bk){switch(Bk){case Ad:case Au:case AL:case p:case A3:case AU:case AH:case An:case AB:case AC:case A:case U:return true;default:return false;}}function As(Bn){if(!Bn.data.dz){return false;}var Bk=Bn.data.dz,Bm=mstrmojo.vi.viz.GraphMatrixHelper,Bo=Bk[Bm.PROP_XAXIS],Bq=Bo.TemplateUnit||Bo.TemplateMetric||[],Bl=Bk[Bm.PROP_YAXIS],Bp=Bl.TemplateUnit||Bl.TemplateMetric||[];if(Bp.length>0&&Bp[0].t===H.DssTypeMetric){if(Bq.length===0||Bq[0].t!==H.DssTypeMetric){return true;}}return false;}function AY(Bn){if(!Bn.data.dz){return false;}var Bk=Bn.data.dz,Bm=mstrmojo.vi.viz.GraphMatrixHelper,Bo=Bk[Bm.PROP_XAXIS],Bq=[],Bl=Bk[Bm.PROP_YAXIS],Bp=[];if(Bo){Bq=Bo.TemplateUnit||Bo.TemplateMetric||[];}if(Bl){Bp=Bl.TemplateUnit||Bl.TemplateMetric||[];}if(Bq.length>0&&(Bq[0].t===H.DssTypeMetric)){if(Bp.length===0||(Bp[0].t!==H.DssTypeMetric)){return true;}}return false;}function AF(Bk){return BM(Bk)||L(Bk);}function AX(Bk){switch(Bk){case AH:case An:case AB:case A1:case Ai:case h:case U:case Ak:return true;default:return false;}}function AQ(Bp,Bl,Bk,Bm,Bo){if(this.isGraphMatrix(Bp)){if((AY(Bo)&&BM(Bl))||(L(Bl)&&As(Bo))){var Bn;for(Bn=0;Bn<Bk.xAxisObjects.length;Bn++){Bm.yAxisObjects.push(Bk.xAxisObjects[Bn]);Bi.call(this,Bk.xAxisObjects[Bn]);}for(Bn=0;Bn<Bk.yAxisObjects.length;Bn++){Bm.xAxisObjects.push(Bk.yAxisObjects[Bn]);Bi.call(this,Bk.yAxisObjects[Bn]);}}}}function AK(Bk,Bl){Bl.breakByObjects=Bk.sliceObjects.concat();Bl.tooltipMetrics=Bk.angleObjects.concat();}function BX(Bq,Bk,Bn,Bz,Bv,Bx){var Bt,By,Bw,B0,Bl=(Bz===BE.GOOGLEMAP||Bz===BE.ESRIMAP);if(Bz===BE.HEATMAP){B0=new BV.HeatMapVisualizationHelper();B0.setData(Bx.data.dz);}else{if(Bl){var B2=(Bz===BE.ESRIMAP)?BV.ESRIMapHelper:BV.GoogleMapHelper;B0=new B2({data:Bx.data});B0.setWidget(this.vis);}}if(this.isGraphMatrix(Bz)){if(Bk.xAxisObjects.length>0){Bt=BP(Bq,n.PROP_XAXIS);if(!Bt||BC(Bk.xAxisObjects[0],Bt.type,Bq)){for(By=0;By<Bk.xAxisObjects.length;By++){Bw=Bk.xAxisObjects[By];Bn.xAxisObjects.push(Bw);Bi.call(this,Bw);}}}if(Bk.yAxisObjects.length>0){Bt=BP(Bq,n.PROP_YAXIS);if(!Bt||BC(Bk.yAxisObjects[0],Bt.type,Bq)){for(By=0;By<Bk.yAxisObjects.length;By++){Bw=Bk.yAxisObjects[By];Bn.yAxisObjects.push(Bw);Bi.call(this,Bw);}}}if(Bk.breakByObjects.length>0){Bt=BP(Bq,n.PROP_BREAKBY);if(!Bt||BC(Bk.breakByObjects[0],Bt.type,Bq)){for(By=0;By<Bk.breakByObjects.length;By++){Bw=Bk.breakByObjects[By];Bn.breakByObjects.push(Bw);Bi.call(this,Bw);}}}}var B1=[];if(this.isGraphMatrix(Bz)){for(By=0;By<Bk.colorByObjects.length;By++){B1.push(Bk.colorByObjects[By]);}}else{if(Bz===BE.HEATMAP){B0.colorBy.forEach(function(B3){B1.push(B3);});}else{if(Bl&&B0.showColorByZone()){var Br=B0.getColorByUnit();if(Br){B1.push(Br);}}}}if(B1.length){Bt=BP(Bq,n.PROP_COLORBY);var Bo=(!Bt||BC(B1[0],Bt.type,Bq));if(Bo){for(By=0;By<B1.length;By++){Bw=B1[By];Bn.colorByObjects.push(Bw);this.markedObjects.push(Bw);}}}var Bp=[];if(this.isGraphMatrix(Bz)){for(By=0;By<Bk.sizeByObjects.length;By++){Bp.push(Bk.sizeByObjects[By]);}}else{if(Bz===BE.HEATMAP){if(B0.sizeByMetric){Bp.push(B0.sizeByMetric);}}else{if(Bl&&B0.showSizeByZone()){var Bs=B0.getSizeByUnit();if(Bs){Bp.push(Bs);}}}}if(Bp.length>0){Bt=BP(Bq,n.PROP_SIZEBY);var Bm=Bq.Properties[n.PROP_SHAPE],Bu;Bu=(Bm!=="Area")&&(!Bt||BC(Bp,Bt.type,Bq));if(Bu){for(By=0;By<Bp.length;By++){Bw=Bp[By];Bn.sizeByObjects.push(Bw);this.markedObjects.push(Bw);}}}}function A0(Bk){var Bm=this.templateInfo,Br=Bm.mx,Bl=this.definition,Bp=Br.pop(),Bo=Br.pop(),Bn=Br.pop()||Bo||Bp,Bq=function(Bt,Bu,Bs){if(Bt){var Bv=BP(Bl,Bu);if(Bv&&Bv.type===B&&!Bs.length){Bs.push(Bt);}}};Bq(Bp,n.PROP_XAXIS,Bk.xAxisObjects);Bq(Bo,n.PROP_YAXIS,Bk.yAxisObjects);Bq(Bn,n.PROP_SIZEBY,Bk.sizeByObjects);A6(Bk,Bm.cols,Bm.rows,"breakByObjects",BP(Bl,n.PROP_BREAKBY));Bj.call(this,Bk);}function Ax(Bk){var Bm=this.templateInfo,Bo=Bm.mx,Bl=this.definition,Bn=Bo.pop();A6(Bk,Bm.cols,Bm.rows,"sliceObjects",BP(Bl,n.PROP_SLICE));if(Bn){Bk.angleObjects.push(Bn);}if(Bk.sliceObjects.length){Bk.colorByObjects.push(Bk.sliceObjects[0]);}Bm.mx.forEach(function(Bp){Bk.tooltipMetrics.push(Bp);});}function BQ(Bk,Bl){return BU.find(Bk,"did",Bl.did);}function BR(Bl,Bm,Bn){var Bk=false;if(Bl.length&&(Bl[0].t===Bn||Bn===undefined)){Bl.forEach(function(Bo){if(BQ(Bm,Bo)===-1){Bm.push(Bo);Bk=true;}});}return Bk;}function Ag(Bl,Bk,Bm){Bl.forEach(function(Bn){BR(Bk[Bn],Bm[Bn]);});}function g(Bk,Bl){if(Bk.length){Bl.push(Bk.pop());}}function E(Bk,Bl){if(Bk.length&&Bk[0].t===4){Bl.push(Bk[0]);return true;}return false;}function AZ(Bm,Bo){var Bl,Bk,Bn;Bl=new BV.HeatMapVisualizationHelper();Bl.setData(Bo.data.dz);Bk=Bl.groupingObjects;if(Bk.length&&!Bm.isMetric(Bk[0])){Bm.xAxisObjects.push(Bk.pop());}Bk=Bl.tooltipMetrics;Bn=Bl.sizeByMetric||Bl.getFirstColorByUnit(true)||Bk.pop();if(Bn){Bm.yAxisObjects.push(Bn);}BR(Bl.groupingObjects,Bm.rowObjects,H.DssTypeAttribute);BR(Bl.colorBy,Bm.colorByObjects);BR(Bl.tooltipMetrics,Bm.tooltipMetrics,H.DssTypeMetric);}function k(Bm,Bo){var Bl,Bk,Bn;Bl=new BV.HeatMapVisualizationHelper();Bl.setData(Bo.data.dz);Bk=Bl.tooltipMetrics;Bn=Bl.sizeByMetric||Bl.getFirstColorByUnit(true)||Bk.pop();if(Bn){Bm.xAxisObjects.push(Bn);}Bn=Bl.getFirstColorByUnit(true);if(!Bn||Bm.xAxisObjects.length&&Bm.xAxisObjects[0].did===Bn.did){Bn=Bk.pop();}if(Bn){Bm.yAxisObjects.push(Bn);}Bn=Bk.pop()||Bl.getFirstColorByUnit(true)||Bl.sizeByMetric;if(Bn){Bm.sizeByObjects.push(Bn);}Bk=Bl.groupingObjects;if(Bk.length&&!Bm.isMetric(Bk[0])){Bm.breakByObjects.push(Bk.pop());}BR(Bl.colorBy,Bm.colorByObjects);BR(Bl.tooltipMetrics,Bm.tooltipMetrics,H.DssTypeMetric);}function AM(Bk,Bn){var Bm,Bl;Bm=new BV.NetworkVisualizationHelper();Bm.setData(Bn.data.dz);var Bo=Bm.getNetworkMetrics();Bl=Ae(Bo);if(Bl){Bk.xAxisObjects.push(Bl);}Bl=Bo[0];if(Bl){Bk.yAxisObjects.push(Bl);}Bl=Ae(Bo);if(Bl){Bk.sizeByObjects.push(Bl);}Bl=Bm.fromItemAttribute;if(Bl){Bk.breakByObjects.push(Bl);}Bl=Bm.toItemAttribute;if(Bl){Bk.rowObjects.push(Bl);}BR(Bo,Bk.tooltipMetrics,H.DssTypeMetric);}function AG(Bl,Bm){var Bk=Bl.xAxisObjects;Ag(["tooltipMetrics"],Bl,Bm);if(Bk.length&&Bk[0].t===4){Bk.forEach(function(Bn){Bm.tooltipMetrics.push(Bn);});}Bk=Bl.breakByObjects;if(Bk.length&&Bk[0].t===12){Bm.xAxisObjects.push(Bk[0]);Bk.splice(0,1);}else{Bk=Bl.columnObjects;if(Bk.length&&Bk[0].t===12){Bm.xAxisObjects.push(Bk.pop());}else{Bk=Bl.rowObjects;if(Bk.length){Bm.xAxisObjects.push(Bk.pop());}}}Bk=Bl.sizeByObjects;if(Bk.length){Bk.forEach(function(Bn){Bm.tooltipMetrics.push(Bn);});}Ag(["breakByObjects","yAxisObjects","colorByObjects","columnObjects","rowObjects"],Bl,Bm);}function d(Bt,Bn,Bm,Br,Bq,Bz){var Bu,Bs,Bl,Bw=-1,Bv=Bq?Bq.length:0,By,Bk,Bx=Bq.concat([]),Bp=false;By=(Br&&Bt.isMetric(Br))?Br:undefined;for(var Bo=0;Bo<Bv;Bo++){if(Bt.isMetric(Bq[Bo])){Bl=Bq[Bo];Bw=Bo;break;}}Bu=Bm||By;if(!Bu&&Bl){Bu=Bl;Bp=true;}if(Bu){Bt.xAxisObjects.push(Bu);}Bs=By||Bl;if(Bs&&Bs.did!==Bu.did){Bt.yAxisObjects.push(Bs);if(!By){Bp=true;}}if(Bz){Bk=Bu;}else{Bk=Bl||By||Bm;if(Bl){Bp=true;}}if(Bk){Bt.sizeByObjects.push(Bk);}if(Bn){Bt.breakByObjects.push(Bn);}if(Br){Bt.colorByObjects.push(Br);}if(Bp){Bx.splice(Bw,1);}BR(Bx,Bt.tooltipMetrics,H.DssTypeMetric);}function S(Bm,Bk){var Bl=(Bm===BE.ESRIMAP)?new BV.ESRIMapHelper():new BV.GoogleMapHelper();Bl.setWidget(this.vis);d(Bk,Bl.getGeoUnit(),Bl.getSizeByUnit(),Bl.getColorByUnit(),Bl.getTooltipUnits(),true);}function AD(Bk,Bm){var Bl=new BV.ImageLayoutHelper({node:Bm});Bl.setData(Bm.data.dz);d(Bk,Bl.geoAttribute,Bl.sizeByMetric,Bl.colorByMetric,Bl.tooltipMetrics);}function AA(Bl,Bm,Bn){var Bk=Bl.xAxisObjects,Bo=function(Bp){if(!E(Bl.sizeByObjects,Bm[Bp])){if(!E(Bl.colorByObjects,Bm[Bp])){g(Bl.tooltipMetrics,Bm[Bp]);}}};W(Bl,Bn);if(!BR(Bl.xAxisObjects,Bm.xAxisObjects,4)){Bk=Bl.yAxisObjects;if(Bk.length>1&&Bl.isMetric(Bk[0])){Bm.xAxisObjects.push(Bk.pop());}else{Bo("xAxisObjects");}}if(!BR(Bl.yAxisObjects,Bm.yAxisObjects,4)){Bo("yAxisObjects");}if(!BR(Bl.sizeByObjects,Bm.sizeByObjects,4)){Bk=Bm.yAxisObjects;if(Bk.length>1){Bm.sizeByObjects.push(Bk.pop());}else{if(!E(Bl.colorByObjects,Bm.sizeByObjects)){g(Bl.tooltipMetrics,Bm.sizeByObjects);}}}BR(Bl.breakByObjects,Bm.breakByObjects,12);Bk=Bl.yAxisObjects;if(Bk.length&&Bk[0].t===12){Bm.breakByObjects=Bk.concat(Bm.breakByObjects);}Bk=Bl.xAxisObjects;if(Bk.length&&Bk[0].t===12){Bm.breakByObjects=Bk.concat(Bm.breakByObjects);}Ag(["colorByObjects","columnObjects","rowObjects","tooltipMetrics"],Bl,Bm);}function c(Bk,Bl){Ag(["breakByObjects","colorByObjects","columnObjects","rowObjects","xAxisObjects"],Bk,Bl);BR(Bk.yAxisObjects,Bl.rowObjects,12);if(Bk.sizeByObjects.length){Bl.yAxisObjects.push(Bk.sizeByObjects[0]);}else{if(Bk.colorByObjects.length&&Bk.isMetric(Bk.colorByObjects[0])){Bl.yAxisObjects.push(Bk.colorByObjects[0]);}else{if(Bk.tooltipMetrics.length){Bl.yAxisObjects.push(Bk.tooltipMetrics.pop());}}}BR(Bk.tooltipMetrics,Bl.tooltipMetrics);}function A8(Bl,Bm){var Bk,Bn=[];Ag(["sizeByObjects","colorByObjects","columnObjects","rowObjects"],Bl,Bm);BR(Bl.xAxisObjects,Bm.breakByObjects,12);BR(Bl.yAxisObjects,Bm.breakByObjects,12);BR(Bl.breakByObjects,Bm.breakByObjects,12);["xAxisObjects","yAxisObjects"].forEach(function(Bo){BU.forEach(["sizeByObjects","colorByObjects"],function(Bp){Bk=Bl[Bp];if(Bk.length&&Bl.isMetric(Bk[0])&&BQ(Bn,Bk[0])===-1){Bm[Bo].push(Bk[0]);Bn.push(Bk[0]);return false;}});if(Bm[Bo].length===0&&Bl.tooltipMetrics.length){Bm[Bo].push(Bl.tooltipMetrics.pop());}});if(Bm.sizeByObjects.length===0){Bk=Bl.colorByObjects;if(Bk.length&&Bk[0].t===4){Bm.sizeByObjects.push(Bk[0]);}else{if(Bl.tooltipMetrics.length){Bm.sizeByObjects.push(Bl.tooltipMetrics.pop());}}}BR(Bl.tooltipMetrics,Bm.tooltipMetrics);}function BF(Bl,Bm){var Bk,Bn;BU.forEach(["xAxisObjects","yAxisObjects","breakByObjects","columnObjects","rowObjects"],function(Bo){Bk=Bl[Bo];if(Bk&&Bk.length&&Bk[0].t===H.DssTypeAttribute){Bn=Bk.pop();Bm.sliceObjects.push(Bn);Bm.colorByObjects.push(Bn);return false;}});["xAxisObjects","yAxisObjects"].forEach(function(Bo){BR(Bl[Bo],Bm.rowObjects,H.DssTypeAttribute);});BU.forEach(["xAxisObjects","yAxisObjects","sizeByObjects","tooltipMetrics"],function(Bo){Bk=Bl[Bo];if(Bk&&Bk.length&&Bl.isMetric(Bk[0])){Bm.angleObjects.push(Bk.pop());return false;}});["tooltipMetrics","xAxisObjects","yAxisObjects","sizeByObjects","colorByObjects"].forEach(function(Bo){BR(Bl[Bo],Bm.tooltipMetrics,H.DssTypeMetric);});Ag(["columnObjects","rowObjects"],Bl,Bm);}function Ap(Bm,Bo){var Bl,Bk,Bn;Bl=new BV.HeatMapVisualizationHelper();Bl.setData(Bo.data.dz);Bk=Bl.groupingObjects;if(Bk.length&&!Bm.isMetric(Bk[0])){Bm.sliceObjects.push(Bk.pop());}Bk=Bl.tooltipMetrics;Bn=Bl.sizeByMetric||Bl.getFirstColorByUnit(true)||Bk.pop();if(Bn){Bm.angleObjects.push(Bn);}Bk=Bm.sliceObjects;Bn=Bl.getFirstColorByUnit(true)||(Bk.length&&Bk[0]);if(Bn){Bm.colorByObjects.push(Bn);}BR(Bl.tooltipMetrics,Bm.tooltipMetrics,H.DssTypeMetric);}function BG(Bl,Bo){var Bn,Bk,Bm;Bn=new BV.NetworkVisualizationHelper();Bn.setData(Bo.data.dz);Bm=Bn.fromItemAttribute||Bn.toItemAttribute;if(Bm){Bl.sliceObjects.push(Bm);}Bm=Bn.nodeSizeMetric||Bn.edgeSizeMetric||Bn.edgeColorMetric;if(Bm){Bl.angleObjects.push(Bm);}Bk=Bl.sliceObjects;Bm=Bk.length&&Bk[0];if(Bm){Bl.colorByObjects.push(Bm);}}function z(Bl,Bn,Bp,Bo,Bq){var Bk,Bm;if(Bn){Bl.sliceObjects.push(Bn);}if(Bp){Bl.angleObjects.push(Bp);}Bk=Bl.sliceObjects;Bm=Bo||(Bk.length&&Bk[0]);if(Bm){Bl.colorByObjects.push(Bm);}BR(Bq,Bl.tooltipMetrics,H.DssTypeMetric);}function Ba(Bk,Bm){var Bl=new BV.ImageLayoutHelper({node:Bm});Bl.setData(Bm.data.dz);z(Bk,Bl.geoAttribute,(Bl.sizeByMetric||Bl.colorByMetric),Bl.colorByMetric,Bl.tooltipMetrics);}function u(Bm,Bk){var Bl=(Bm===BE.ESRIMAP)?new BV.ESRIMapHelper():new BV.GoogleMapHelper();Bl.setWidget(this.vis);var Bn=Bl.getColorByUnit();z(Bk,Bl.getGeoUnit(),(Bl.getSizeByUnit()||Bn),Bn,Bl.getTooltipUnits());}function v(Bn,Bk,Bl,Bm){if(Bk){BF.call(this,Bk,Bl);}else{switch(Bn){case BE.ESRIMAP:case BE.GOOGLEMAP:u.call(this,Bn,Bl,Bm);break;case BE.HEATMAP:Ap.call(this,Bl,Bm);break;case BE.NETWORK:BG.call(this,Bl,Bm);break;case BE.IMAGELAYOUT:Ba.call(this,Bl,Bm);break;case BE.GRID:Ax.call(this,Bl,Bm);break;}}}function BW(Bl,Bo){var Bm=[],Bn=(Bo.length/2),Bk=function(Bp,Bq){Bm.push("'"+Bp.did+"':"+Bq);};while(Bn>0){Bl.yAxisObjects.push(Bo[0]);Bk(Bo[0],K.BAR);Bo.splice(0,1);Bn-=1;}while(Bo.length){Bl.yAxisObjects.push(AW.copy({ax:D},Bo[0]));Bk(Bo[0],K.LINE);Bo.splice(0,1);}if(Bm.length){Bl.metricShapes="{"+Bm.join(",")+"}";}}function BY(Bl,Bm){var Bk,Bn=[];Ag(["breakByObjects","colorByObjects","columnObjects","rowObjects","sizeByObjects","tooltipMetrics"],Bl,Bm);["xAxisObjects","yAxisObjects"].forEach(function(Bo){BR(Bl[Bo],Bm.xAxisObjects,12);});["xAxisObjects","yAxisObjects"].forEach(function(Bo){Bk=Bl[Bo];if(Bk.length&&Bl.isMetric(Bk[0])){Bn=Bn.concat(Bk);}});if(Bn.length){BW.call(this,Bm,Bn);}}function BN(Bl,Bm){Ag(["breakByObjects","colorByObjects","columnObjects","rowObjects"],Bl,Bm);BR(Bl.tooltipMetrics,Bm.tooltipMetrics,H.DssTypeMetric);BR(Bl.xAxisObjects,Bm.tooltipMetrics,H.DssTypeMetric);var Bk,Bn;BU.forEach(["breakByObjects","columnObjects","rowObjects"],function(Bo){Bk=Bm[Bo];if(Bk&&Bk.length&&Bk[0].t===H.DssTypeAttribute){if(Bo==="breakByObjects"){Bn=Bk.splice(0,1)[0];}else{Bn=Bk.pop();}Bm.xAxisObjects.push(Bn);return false;}});BR(Bl.sizeByObjects,Bm.tooltipMetrics,H.DssTypeMetric);BW.call(this,Bm,Bl.yAxisObjects);}function BZ(Bm,Bn){var Bk,Bq,Bp,Bo=[],Bl=function(){var Br,Bs;BU.forEach(["sizeByObjects","colorByObjects"],function(Bt){Bk=Bm[Bt];if(Bk&&Bk.length){Bs=Bk[0];if(Bm.isMetric(Bs)&&Bs!==Bp){Br=Bs;return false;}}});if(!Br){Br=Bm.tooltipMetrics.pop();}return Br;};Ag(["breakByObjects","colorByObjects","columnObjects","rowObjects","sizeByObjects"],Bm,Bn);["xAxisObjects","yAxisObjects"].forEach(function(Br){BR(Bm[Br],Bn.xAxisObjects,H.DssTypeAttribute);});Bp=Bl();if(Bp){Bn.yAxisObjects.push(Bp);Bo.push("'"+Bp.did+"':"+K.BAR);}Bq=Bl();if(Bq){Bn.yAxisObjects.push(AW.copy({ax:D},Bq));Bo.push("'"+Bq.did+"':"+K.LINE);}BR(Bm.tooltipMetrics,Bn.tooltipMetrics,H.DssTypeMetric);if(Bo.length){Bn.metricShapes="{"+Bo.join(",")+"}";}}function a(Bo,Bk,Bl){var Bn=this.templateInfo,Bq=Bn.mx,Bm=this.definition,Bp=[];A6(Bl,Bn.cols,Bn.rows,"xAxisObjects",BP(Bm,n.PROP_XAXIS));if(Bq.length){Bl.yAxisObjects.push(Bq[0]);Bp.push("'"+Bq[0].did+"':"+K.BAR);Bq.splice(0,1);if(Bq.length){Bl.yAxisObjects.push(AW.copy({ax:D},Bq[0]));Bp.push("'"+Bq[0].did+"':"+K.LINE);Bq.splice(0,1);}}Bj.call(this,Bl);BD.call(this,this.definition,Bk,Bl);if(Bp.length){Bl.metricShapes="{"+Bp.join(",")+"}";}}function X(Bm,Bo){var Bl,Bk,Bn,Bq,Bp=[],Br;Bl=new BV.HeatMapVisualizationHelper();Bl.setData(Bo.data.dz);Br=Bl.getFirstColorByUnit(true);Bk=Bl.groupingObjects;if(Bk.length&&!Bm.isMetric(Bk[0])){Bm.xAxisObjects.push(Bk.pop());}BR(Bl.groupingObjects,Bm.rowObjects,H.DssTypeAttribute);Bk=Bl.tooltipMetrics;Bq=Bn=Bl.sizeByMetric||Br||Bk.pop();if(Bn){Bm.yAxisObjects.push(Bn);Bp.push("'"+Bn.did+"':"+K.BAR);if(Bn===Bl.sizeByMetric){delete Bl.sizeByMetric;}else{if(Bn===Bl.colorBy[0]){Bl.colorBy.splice(0,1);}}}Bn=(Br&&(Br.did!==Bq.did))?Br:Bk.pop();if(Bn){Bm.yAxisObjects.push(AW.copy({ax:D},Bn));Bp.push("'"+Bn.did+"':"+K.LINE);}BR(Bl.colorBy,Bm.colorByObjects);BR(Bl.tooltipMetrics,Bm.tooltipMetrics,H.DssTypeMetric);Bn=Bl.sizeByMetric;if(Bn){Bm.tooltipMetrics.push(Bn);}if(Bp.length){Bm.metricShapes="{"+Bp.join(",")+"}";}}function Ae(Bm,Bl){var Bk;BU.forEach(Bm,function(Bp,Bo,Bn){if(Bp&&Bp!==Bl){Bk=Bp;Bn.splice(Bo,1);return false;}});return Bk;}function A4(Bl,Bo){var Bn,Bm,Bq,Bk,Bp=[];Bn=new BV.NetworkVisualizationHelper();Bn.setData(Bo.data.dz);Bm=Bn.fromItemAttribute||Bn.toItemAttribute;if(Bm){Bl.xAxisObjects.push(Bm);Bk=Bm;}var Br=Bn.getNetworkMetrics();Bq=Bm=Ae(Br);if(Bm){Bl.yAxisObjects.push(Bm);Bp.push("'"+Br.did+"':"+K.BAR);}Bm=Ae(Br,Bq);if(Bm){Bl.yAxisObjects.push(AW.copy({ax:D},Bm));Bp.push("'"+Bm.did+"':"+K.LINE);}if(Bp.length){Bl.metricShapes="{"+Bp.join(",")+"}";}Bm=Bn.toItemAttribute;if(Bm&&(Bk!==Bm)){Bl.rowObjects.push(Bm);}}function Aj(Bl,Bk,Bq,Bn,Br){var Bm,Bp,Bo=[];if(Bk){Bl.xAxisObjects.push(Bk);}Bp=Bm=Ae(Bq);if(!Bm){Bp=Bm=Bn&&(Bn.length>0)&&(Bn[0].t===H.DssTypeMetric)&&Bn.pop();}if(Bm){Bl.yAxisObjects.push(Bm);Bo.push("'"+Bm.did+"':"+K.BAR);}Bm=Ae(Bq,Bp);if(!Bm){Bm=Bn&&(Bn.length>0)&&(Bn[0].t===H.DssTypeMetric)&&Bn.pop();}if(Bm){Bl.yAxisObjects.push(AW.copy({ax:D},Bm));Bo.push("'"+Bm.did+"':"+K.LINE);}if(Br){Bl.colorByObjects.push(Br);}if(Bn){BR(Bn,Bl.tooltipMetrics,H.DssTypeMetric);}if(Bo.length){Bl.metricShapes="{"+Bo.join(",")+"}";}}function AI(Bk,Bm){var Bl=new BV.ImageLayoutHelper({node:Bm});Bl.setData(Bm.data.dz);Aj(Bk,Bl.geoAttribute,[Bl.sizeByMetric,Bl.colorByMetric],Bl.tooltipMetrics,Bl.colorByMetric);}function f(Bm,Bk){var Bl=(Bm===BE.ESRIMAP)?new BV.ESRIMapHelper():new BV.GoogleMapHelper();Bl.setWidget(this.vis);var Bn=Bl.getColorByUnit();Aj(Bk,Bl.getGeoUnit(),[Bl.getSizeByUnit(),Bn],Bl.getTooltipUnits(),Bn);}function BJ(Bn,Bk,Bl,Bm){switch(Bn){case BE.ESRIMAP:case BE.GOOGLEMAP:f.call(this,Bn,Bl,Bm);break;case BE.HEATMAP:X.call(this,Bl,Bm);break;case BE.NETWORK:A4.call(this,Bl,Bm);break;case BE.IMAGELAYOUT:AI.call(this,Bl,Bm);break;case BE.GRID:a.call(this,Bn,Bk,Bl);break;}}function A5(Bl,Bm){var Bk=Bl[Bm];if(Bk&&Bk.length&&Bl.isMetric(Bk[0])){Bk.forEach(function(Bn){Bn.ax=Bb;});}}function W(Bk,Bl){if(AY(Bl)){A5(Bk,"xAxisObjects");}else{A5(Bk,"yAxisObjects");}}function A2(Bk,Bl,Bm){W(Bk,Bm);Bl.clone(Bk);}function Aq(Bl,Bo){var Bn,Bm,Bk;Bn=new BV.NetworkVisualizationHelper();Bn.setData(Bo.data.dz);Bm=Bn.fromItemAttribute||Bn.toItemAttribute;if(Bm){Bl.xAxisObjects.push(Bm);Bk=Bm;}var Bp=Bn.getNetworkMetrics();Bm=Ae(Bp);if(Bm){Bl.yAxisObjects.push(Bm);}BR(Bp,Bl.tooltipMetrics,H.DssTypeMetric);Bm=Bn.toItemAttribute;if(Bm&&(Bk!==Bm)){Bl.rowObjects.push(Bm);}}function e(Bq,Br,Bl,Bp,Bo){var Bk,Bt=-1,Bs=Bo?Bo.length:0,Bn,Bu=Bo.concat([]);if(Br){Bq.xAxisObjects.push(Br);}for(var Bm=0;Bm<Bs;Bm++){if(Bq.isMetric(Bo[Bm])){Bk=Bo[Bm];Bt=Bm;break;}}Bn=Bl||Bp;if(!Bn&&Bk){Bn=Bk;Bu.splice(Bt,1);}if(Bn){Bq.yAxisObjects.push(Bn);}if(Bp){Bq.colorByObjects.push(Bp);}BR(Bu,Bq.tooltipMetrics,H.DssTypeMetric);}function P(Bm,Bk){var Bl=(Bm===BE.ESRIMAP)?new BV.ESRIMapHelper():new BV.GoogleMapHelper();Bl.setWidget(this.vis);e(Bk,Bl.getGeoUnit(),Bl.getSizeByUnit(),Bl.getColorByUnit(),Bl.getTooltipUnits());}function BH(Bk,Bm){var Bl=new BV.ImageLayoutHelper({node:Bm});Bl.setData(Bm.data.dz);e(Bk,Bl.geoAttribute,Bl.sizeByMetric,Bl.colorByMetric,Bl.tooltipMetrics);}function O(Bk,Bl,Bm){W(Bk,Bm);AA.call(this,Bk,Bl,Bm);}function Ao(Bk,Bl){BR(Bk.sliceObjects,Bl.breakByObjects,H.DssTypeAttribute);BR(Bk.angleObjects,Bl.tooltipMetrics,H.DssTypeMetric);}function AP(Bo,Bl,Bp,Bn,Bm,Bk){BX.call(this,this.definition,Bk,Bm,Bo,Bp,Bn);AQ.call(this,Bo,Bl,Bk,Bm,Bn);A9.call(this,this.definition,Bm,Bl);BD.call(this,this.definition,Bk,Bm);BK.call(this,this.definition,Bm,Bl);Bj.call(this,Bm);}function BI(B5,Br,Bs,Bz){var Bn=new BV.GraphMatrixHelper({data:Bz.data,visType:Br}),Bl,B0=[],Bq=[],B6;if(this.isGraphMatrix(B5)){Bl=new BV.GraphMatrixHelper({data:Bz.data});Bl.setData(Bz.data.dz);Bl.setMetricsDropZone(Bz.data.dz);B6=this.chartInfo=this.vis.getChartInfo();Bn.metricsDropZone=Bl.metricsDropZone;Bn.secondaryMetricsDropZone=Bl.secondaryMetricsDropZone;}if(this.isGraphMatrix(B5)){if(B6.isPie||B6.isRing){AK.call(this,Bl,Bn);}}var By=B6&&B6.isGrid,B3=B6&&B6.isBubbleOrScatter,B1=B6&&B6.isABL,Bm=B6&&B6.isCombo,B4=B6&&(B6.isPie||B6.isRing),Bt=(B5===BE.HEATMAP),B7=(B5===BE.NETWORK),Bp=(B5===BE.GOOGLEMAP||B5===BE.ESRIMAP),Bo=(B5===BE.IMAGELAYOUT),Bk=Aw(Br),Bv=AF(Br),Bx=C(Br),Bw=(Br===Z||Br===Ar);if(Bv){if(By){c.call(this,Bl,Bn,Bz);}else{if(Bm){A2.call(this,Bl,Bn,Bz);}else{if(B3||B4){if(B1){Bn.clone(Bl);Bn.sliceObjects=[];Bn.angleObjects=[];}if(B4){Ao.call(this,Bl,Bn,Bz);}if(!B1){AG.call(this,Bl,Bn,Bz);}}else{if(B1){Bn.clone(Bl);if(AX(Br)&&Bn.sizeByObjects.length){var B8=this.vis.zonesModel.gmZones.hGetItemOccurrence(Bn.sizeByObjects[0],[AE,I,r,AS]);if(B8.length===0){BR(Bn.sizeByObjects,Bn.tooltipMetrics,H.DssTypeMetric);}Bn.sizeByObjects=[];}else{Bn.handled=true;var B2=this.vis;B2.setWidgetPropertyValue(BA.WidgetPropertyTag.METRIC_SHAPES,{});B2.setWidgetPropertyValue("visType",Bn.visType);B2.writeGlobalProperty("Shape",K[this.definition.Properties[n.PROP_SHAPE].toUpperCase()]);}}else{if(Bt){AZ.call(this,Bn,Bz);}else{if(B7){Aq.call(this,Bn,Bz);}else{if(Bp){P.call(this,B5,Bn,Bz);}else{if(Bo){BH.call(this,Bn,Bz);}else{AP.call(this,B5,Br,Bs,Bz,Bn,Bl);}}}}}}}}}else{if(Bx){if(Bm){Bn.clone(Bl);}else{if(B1||B4){if(B4){Ao.call(this,Bl,Bn,Bz);}BY.call(this,Bl,Bn);}else{if(B3){BN.call(this,Bl,Bn);}else{if(By){BZ.call(this,Bl,Bn);}else{BJ.call(this,B5,Bl,Bn,Bz);}}}}}else{if(Bk){if(By){A8.call(this,Bl,Bn,Bz);}else{if(Bm){O.call(this,Bl,Bn,Bz);}else{if(B5===BE.GRID){A0.call(this,Bn,Bz);}else{if(B1||B4){if(B4){Ao.call(this,Bl,Bn,Bz);}AA.call(this,Bl,Bn,Bz);}else{if(Bt){k.call(this,Bn,Bz);}else{if(B7){AM.call(this,Bn,Bz);}else{if(B3){Bn.clone(Bl);}else{if(Bp){S.call(this,B5,Bn,Bz);}else{if(Bo){AD.call(this,Bn,Bz);}else{AP.call(this,B5,Br,Bs,Bz,Bn,Bl);}}}}}}}}}}else{if(Bw){if(B4){Bn.clone(Bl);}else{v.call(this,B5,Bl,Bn,Bz);}}else{AP.call(this,B5,Br,Bs,Bz,Bn,Bl);}}}}Bh.call(this,this.definition,Bn);b.call(this,Bz,Bn,Bq);if(Bw){o.call(this,Bn,Bs,Bz);}Aa.call(this,Bz,Bq);var Bu=Bn.getAddDropZonesAction();Bu.actions=B0.concat(Bu.actions).concat(Bq);if(Bu.actions.length){Bs.push(Bu);}return Bn;}function F(Bm,Bk,Bo,Bl){this.templateInfo=BO.call(this,Bl);this.definition=Af.call(this,Bk);var Bn=BI.call(this,Bm,Bk,Bo,Bl);return{wp:Bn.getXml(),handled:Bn.handled};}mstrmojo.vi.viz.GMVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.GMVisualizationTransition",templateInfo:null,definition:null,markedObjects:null,chartInfo:null,init:function Bd(Bk){this._super(Bk);this.markedObjects=[];},transitionDropZones:function BB(Bp,Bo){var Bq,Bn=this.vis,Bm=Bn.node.data,Bk=Bm.visName||AN,Bl=function(Bs,Bu){var Bt=(typeof Bu==="object"),Br=Bt?Bu.v:Bu;if(AY(Bs.node)&&Bt){Br=Bu.h;}return Br;};Bo=Bl.call(this,Bn,Bo);switch(BL.getDefinition(Bk).id){case BL.GRAPHMATRIX:Bq=F.call(this,BE.UNKNOWN_GRAPHMATRIX_TYPE,Bo,Bp,Bn.node);break;case BL.ESRIMAP:Bq=F.call(this,BE.ESRIMAP,Bo,Bp,Bn.node);break;case BL.GOOGLEMAP:Bq=F.call(this,BE.GOOGLEMAP,Bo,Bp,Bn.node);break;case BL.HEATMAP:Bq=F.call(this,BE.HEATMAP,Bo,Bp,Bn.node);break;case BL.IMAGELAYOUT:Bq=F.call(this,BE.IMAGELAYOUT,Bo,Bp,Bn.node);break;case BL.NETWORK:Bq=F.call(this,BE.NETWORK,Bo,Bp,Bn.node);break;default:Bq=F.call(this,BE.GRID,Bo,Bp,Bn.node);break;}return Bq;}});}());(function(){mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSObjectType","EnumDSSAxisName");mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.requiresClsP("mstrmojo.vi.viz","KnownVisualizations","EnumVisualizationTemplates","VisualizationTransition","HeatMapVisualizationHelper","NetworkVisualizationHelper","ImageLayoutHelper","ESRIMapHelper","GoogleMapHelper","GraphMatrixHelper");var Y=mstrmojo,K=Y.hash,G=Y.array,X=Y.vi.viz,B=X.KnownVisualizations,D=X.EnumVisualizationTemplates,Q=Y.chart.model.enums,N=Q.EnumDSSObjectType,E=Q.EnumDSSAxisName,J="Grid",V=[0.1,0.3,0.5,0.7,0.9],F=["#CC2525","#E34B4B","#E97D7D","#79D479","#57BA57","#2CA02C"];function C(c){var f=K.copy(c.data.gsi),d=f.tma===1?"rows":"cols",b=f[d],e=f.mx;f[d]=b.filter(function(g){return g.t!==-1&&g.did!=="-1";});if(e){e.forEach(function(g){g.t=4;});}return f;}function A(b){return b.did==="-1"||b.t===4;}function T(e,d,g,b,f){var c=d.getAddDropZonesAction();if(d.colorByMetric){var h=d.colorByMetric;if(A(h)){this.addThresholds(e,h,f,F,V);}}c.actions=b.concat(c.actions).concat(f);if(c.actions.length){g.push(c);}return d.getXml();}function S(g,f){var d,c,e=g.mx;if(e.length>0){for(d=0,c=e.length;d<c;d++){var b=e[d];if(b.t!==4){continue;}if(!f.colorByMetric){f.colorByMetric=b;}else{if((!f.sizeByMetric||(b.did!==f.sizeByMetric.did))&&(b.did!==f.colorByMetric.did)&&b.t===N.DssTypeMetric){f.tooltipMetrics.push(b);}}}}}function Z(e,f,h,c){var b=f.data.gts,l=null,g=(e.toLowerCase()==="row")?b&&b.row:b&&b.col,d,m,k;G.forEach(g,function(n){if(n.otp===12){if(!!h){m=false;G.forEach(n.fs,function(o){d=o.n;d=d!==undefined?d:"";if(d.toLowerCase()===h){m=true;return false;}});if(m&&!c){l=n;return false;}if(!m&&c){l=n;return false;}}else{l=n;return false;}}});if(l){k={did:l.id,t:l.otp};}return k;}function W(c,b){return Z(c,b,"shapefile",true);}function I(c,b){return Z(c,b,"shapefile",false);}function P(c){var b=new X.ImageLayoutHelper({node:c});return b.getXml();}function O(h,d,f,k,g){var c=new X.ImageLayoutHelper({node:d}),b=[],e=[];c.geoAttribute=W("row",d)||W("col",d);g.forEach(function(l){l.t=4;});if(f){c.colorByMetric=f;}if(k){c.sizeByMetric=k;}S.call(this,{mx:g},c);return T.call(this,d,c,h,b,e);}function M(l,f,o){var d,k,g=(o===D.ESRIMAP)?X.ESRIMapHelper:X.GoogleMapHelper,n=new X.ImageLayoutHelper({node:f}),e=[],c=[];d=new g({data:f.data});d.setWidget(this.vis);k=d.getGeoUnit();if(k){n.geoAttribute=k;}else{var h=d.getTooltipUnits();G.forEach(h,function(q){if(q.t===12){n.geoAttribute=q;return false;}});if(!n.geoAttribute){n.geoAttribute=Z("row",f)||Z("col",f);}if(!n.geoAttribute){return P(f);}}var p=d.getColorByUnit(),b=d.getSizeByUnit(),m=d.getTooltipUnits();k=p;if(k){n.colorByMetric=k;}k=b;if(k){n.sizeByMetric=k;}S.call(this,{mx:m},n);return T.call(this,f,n,l,e,c);}function a(e,b){var d=b.data.gsi.mx||[],g=new X.GraphMatrixHelper({node:b}),c,f;d=this.filterGMTrainingMetric(b.data.dz,d);g.setData(b.data.dz);G.forEach(g.colorByObjects,function(h){if(g.isMetric(h)){c=h;return false;}});G.forEach(g.sizeByObjects,function(h){if(g.isMetric(h)){f=h;return false;}});return O.call(this,e,b,c,f,d);}function H(f,c){var e=c.data.gsi.mx||[],b=new X.HeatMapVisualizationHelper({node:c}),d,g;b.setData(c.data.dz);G.forEach(G.ensureArray(b.colorBy),function(h){if(b.isMetric(h)){d=h;return false;}});G.forEach(G.ensureArray(b.sizeByMetric),function(h){if(b.isMetric(h)){g=h;return false;}});return O.call(this,f,c,d,g,e);}function U(f,c){var e=c.data.gsi.mx||[],b=new X.NetworkVisualizationHelper({node:c}),d,g;b.setData(c.data.dz);G.forEach(G.ensureArray(b.edgeColorMetric),function(h){if(b.isMetric(h)){d=h;return false;}});G.forEach(G.ensureArray(b.nodeSizeMetric).concat(G.ensureArray(b.edgeSizeMetric)),function(h){if(b.isMetric(h)){g=h;return false;}});return O.call(this,f,c,d,g,e);}function L(d,b){var c=b.data.gsi.mx||[];return O.call(this,d,b,null,null,c);}mstrmojo.vi.viz.ImageLayoutVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.ImageLayoutVisualizationTransition",transitionDropZones:function R(h,g){var b="";var f=this.vis,e=f.node.data,d=e.visName?e.visName:J,c=B.getDefinition(d).id;switch(c){case B.GRAPHMATRIX:b=a.call(this,h,f.node);break;case B.GOOGLEMAP:b=M.call(this,h,f.node,c);break;case B.ESRIMAP:b=M.call(this,h,f.node,c);break;case B.HEATMAP:b=H.call(this,h,f.node);break;case B.NETWORK:b=U.call(this,h,f.node);break;case B.IMAGELAYOUT:break;default:b=L.call(this,h,f.node);break;}return{wp:b,handled:false};}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.vi.util.TemplateUtils");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumDSSDropZones","VisualizationTransition","GraphMatrixHelper","HeatMapVisualizationHelper","ImageLayoutHelper","NetworkVisualizationHelper");var R=mstrmojo,H=R.array,P=R.vi.util.TemplateUtils,Q=R.vi.viz,O=Q.EnumDSSDropZones,J=Q.MapHelper,A=Q.KnownVisualizations,E="-1";function D(X,W,U,Y,V,Z){if(X){Z.push(L([{act:"addDropZoneUnit",zoneId:U,unitId:X,unitType:W}],Y));}switch(U){case O.GeoAttribute:V.geoAttribute=X;break;case O.Latitude:V.latitude=X;break;case O.Longitude:V.longitude=X;break;case O.ColorBy:V.colorBy=X;break;case O.SizeBy:V.sizeBy=X;break;case O.AdditionalMetrics:V.tooltip.push(X);break;}}function T(X,W,U,Y,V,a,Z){if(X){a.push(L([{act:"removeDropZoneUnit",zoneId:U,unitId:X,unitType:W,is_disableonly:Z}],Y));}switch(U){case O.GeoAttribute:V.geoAttribute="";break;case O.Latitude:V.latitude="";break;case O.Longitude:V.longitude="";break;case O.ColorBy:V.colorBy="";break;case O.SizeBy:V.sizeBy="";break;case O.AdditionalMetrics:V.tooltip=H.filter(V.tooltip,function(b){return b!==X;},{max:V.tooltip.length});break;}}function L(U,V){return{act:"updateTemplate",actions:U,keyContext:V.k};}function F(U,V){return U.geoAttribute===V||U.latitude===V||U.longitude===V||U.colorBy===V||U.sizeBy===V;}function I(X,V){var W=null;if(X===4){var U=new Q.ImageLayoutHelper();U.setData(V.dz);W=U.geoAttribute&&U.geoAttribute.did;}return W;}function S(V,Y,e,W){var X=function(f){if((e.mapType===J.MTP_MARKER)&&f){e.setMapType(J.MTP_BUBBLE);}if(f&&e.showSizeByZone()){D(f,4,O.SizeBy,Y,e,W);}},c=function(f){if(f&&e.showColorByZone()){D(f,4,O.ColorBy,Y,e,W);}};switch(V){case 3:var Z=new Q.GraphMatrixHelper({data:Y});Z.setData(Y.dz);if(e.showColorByZone()){H.forEach(Z.colorByObjects,function(f){if(Z.isMetric(f)){c(f.did);return false;}});}H.forEach(Z.sizeByObjects,function(f){if(Z.isMetric(f)){X(f.did);return false;}});break;case 16:var b=new Q.HeatMapVisualizationHelper({data:Y});b.setData(Y.dz);var U=b.getFirstColorByUnit(true);c(U&&U.did);X(b.sizeByMetric&&b.sizeByMetric.did);break;case 18:var a=new Q.NetworkVisualizationHelper();a.setData(Y.dz);c(a.edgeColorMetric&&a.edgeColorMetric.did);X(a.nodeSizeMetric&&a.nodeSizeMetric.did);break;case 4:var d=new Q.ImageLayoutHelper();d.setData(Y.dz);c(d.colorByMetric&&d.colorByMetric.did);X(d.sizeByMetric&&d.sizeByMetric.did);break;default:break;}}function G(X,V,U,W){if(X.length){if(U.showColorByZone()&&!U.colorBy){H.forEach(X,function(Y){if(Y.did!==U.sizeBy){D(Y.did,4,O.ColorBy,V,U,W);return false;}});}if(U.showSizeByZone()&&!U.sizeBy){H.forEach(X,function(Y){if(Y.did!==U.colorBy){D(Y.did,4,O.SizeBy,V,U,W);return false;}});}}}function M(o,f,X,h,c){var U=o.gts,m=o.gsi,b=U.row,Z=U.col,Y=(b||[]).concat(Z||[]),q=null,a=null,p=null,W=0,V=false,e=function(){var w,r,v,u,t;H.forEach(Y,function(x){H.forEach(x.fs,function(z){if(J.isGeoRoleSupportArea(z.fgr)){r=z;w=x;}else{if(J.isLatitude(z.n,z.fgr)){v=z;}else{if(J.isLongitude(z.n,z.fgr)){u=z;}}}});if(!!w){return false;}});if(!!r&&!v&&!u){Object.keys(c).every(function(x){(c[x].att||[]).every(function(z){if(z.did===w.id){V=true;t=z;}return !V;});return !V;});}return t;},g=function(r){H.forEach(Y,function(u){var t;H.forEach(u.fs,function(v){return t=r(u,v);});return t;});},k=function(r){return J.isLatitude(r.n,r.fgr);},d=function(r){return J.isLongitude(r.n,r.fgr);},n=function(u,t,r){f.push(L([{act:"addForm",unitId:u,attFormId:t,unitPos:1}],r));};if(X.supportAreaMap){if(h){g(function(t,r){if(t.id===h&&J.isGeoRoleSupportArea(r.fgr)){q=t;return false;}});}if(!q){g(function(t,r){if(J.isGeoRoleSupportArea(r.fgr)){q=t;return false;}});}if(q){D(q.id,12,O.GeoAttribute,o,X,f);X.setMapType(J.MTP_AREA);return ;}}if(!q){H.forEach((m.rows||[]).concat(m.cols||[]),function(t){var r=t.did;g(function(v,u){if(v.id===r&&k(u)){a=u.id;W=v.card;}if(v.id===r&&d(u)&&u.id!==a){p=u.id;W=v.card;}});if(a&&p){q={id:t.did};return false;}a=null;p=null;});if(q){D(q.id,12,O.GeoAttribute,o,X,f);D(a,21,O.Latitude,o,X,f);D(p,21,O.Longitude,o,X,f);X.setMapType(J.getMapTypeByElementCount(W));X.setUseAttributeForm(true);return ;}}if(!q){g(function(t,r){if(k(r)||J.isLatitude(t.n)){a=t.id;W=t.card;}if((d(r)||J.isLongitude(t.n))&&(a!==t.id)){p=t.id;W=t.card;}});if(a&&p){D(a,12,O.Latitude,o,X,f);D(p,12,O.Longitude,o,X,f);X.setMapType(J.getMapTypeByElementCount(W));X.setUseAttributeForm(false);return ;}}if(!q&&!a&&!p){var l=e();if(!!l){H.forEach(l.fs,function(r){if(J.isLatitude(r.fnm,r.fgr)){a=r.fid;}else{if(J.isLongitude(r.fnm,r.fgr)){p=r.fid;}}if(a&&p){return false;}});if(a&&p){q={id:l.did};D(q.id,12,O.GeoAttribute,o,X,f);D(a,21,O.Latitude,o,X,f);D(p,21,O.Longitude,o,X,f);n(q.id,a,o);n(q.id,p,o);X.setMapType(J.getMapTypeByElementCount(l.card));X.setUseAttributeForm(true);return ;}}}X.setMapType(J.MTP_MARKER);}function K(W,a,Z,U){var Y=W.gsi,V=Y.rows||[],X=Y.cols||[];H.forEach(V.concat(X).concat(a),function(b){if(b.did!==E){if(!F(U,b.did)){D(b.did,b.t||4,O.AdditionalMetrics,W,U,Z);}}});}mstrmojo.vi.viz.MapVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.MapVisualizationTransition",transitionDropZones:function N(V,a){var W=this.vis.model.data,c=W.visName||"Grid",b=this.newMapHelper(),X=A.getDefinition(c).id,Y=W.gsi,Z=Y.mx,U=this.vis.model.docModel.datasets;M(W,V,b,I(X,W),U);S(X,W,b,V);if(W.visName==="GraphMatrixVisualizationStyle"){Z=this.filterGMTrainingMetric(W.dz,Z);}Z=Z||[];G(Z,W,b,V);K(W,Z,V,b);this.setDefaultView(b);if(b.colorBy){V.push(L(this.addThresholds({data:W},{did:b.colorBy,t:4},[]),W));}return b.getXml();},setDefaultView:function C(U){},transitionBetweenESRIAndGoogle:function B(Z,Y,b,d){var W=function(f){var e=P.findUnitsById(Z.gsi,f)[0];return(e&&e.t)||21;};b.setWidget(this.vis);D(b.geoAttribute,12,O.GeoAttribute,Z,d,Y);D(b.latitude,W(b.latitude),O.Latitude,Z,d,Y);D(b.longitude,W(b.longitude),O.Longitude,Z,d,Y);D(b.colorBy,4,O.ColorBy,Z,d,Y);D(b.sizeBy,4,O.SizeBy,Z,d,Y);b.tooltip.forEach(function(e){D(e,W(e),O.AdditionalMetrics,Z,d,Y);});d.useAttributeForm=b.useAttributeForm;d.setMapType(b.mapType);var V=d.geoAttribute;if(!d.supportAreaMap&&d.mapType===J.MTP_AREA){var U=Z.gts,a=null,c=null,X=0;if(V){H.forEach((U.row||[]).concat(U.col||[]),function(e){H.forEach(e.fs,function(g){if(e.id===V&&J.isLatitude(g.n,g.fgr)){a=g.id;X=e.card;}if(e.id===V&&J.isLongitude(g.n,g.fgr)){c=g.id;X=e.card;}});});d.setMapType(J.getMapTypeByElementCount(X));if(a||c){d.setUseAttributeForm(true);if(a&&c){D(a,21,O.Latitude,Z,d,Y);D(c,21,O.Longitude,Z,d,Y);}else{if(a&&!c){T(V,12,O.GeoAttribute,Z,d,Y,1);D(V,12,O.Latitude,Z,d,Y);}else{T(V,12,O.GeoAttribute,Z,d,Y,1);D(V,12,O.Longitude,Z,d,Y);}}}else{T(V,12,O.GeoAttribute,Z,d,Y,1);D(V,12,O.AdditionalMetrics,Z,d,Y);}}else{d.setMapType(J.MTP_MARKER);}}this.setDefaultView(d);return d.getXml();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupWidget","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.css");mstrmojo.ui.menus.MenuPopup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.ui.menus._IsMenuPopup],{scriptClass:"mstrmojo.ui.menus.MenuPopup",popupConfig:null,init:function B(D){this._super(D);var C=this.popupConfig;if(!C.contents){throw new Error("Cannot open popup without contents.");}this.cssClass=C.cssClass||"";this.addChildren(C.contents);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-MenuPopup");},shouldPropagateLockHover:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.dom");var B=mstrmojo.dom;var A="openXtabCellMenu";mstrmojo.XtabCellHoverPopup={cssClass:"mstrXtabCellHoverPopup",scriptClass:"mstrmojo.Popup",slot:"overlayNode",autoCloses:true,children:[{scriptClass:"mstrmojo.Button",alias:"btn",onmousedown:function(D){this.openPopup(true,D);B.stopPropogation(D.hWin,D.e);B.preventDefault(D.hWin,D.e);return false;},openPopup:function(F,D){var E=this.xtab[A]?this.xtab:mstrmojo.findAncestor(this.xtab,A);if(E){E.openXtabCellMenu({xtab:this.xtab,td:this.td,btn:this,cmPos:this.cmPos,lockIW:this.xtab,singleCellClick:F===true,evt:D});}this.domNode.oncontextmenu=function(G){B.stopPropogation(window,G);B.preventDefault(window,G);return false;};},closePopup:function(){var D=mstrmojo.findAncestor(this.xtab,A);if(D){D.closePopup();}}}],updatePopupConfig:function C(F){var G=F&&F.td,N=F&&F.xtab,D=this.btn;var H=this._lastTd;if(H!==G){D.closePopup();this._lastTd=G;}D.xtab=N;D.td=G;D.cmPos=F&&F.cmPos;if(!G||!N){return ;}var I=B.findAncestorByName(G.parentNode,"table",false,N.viewport),J=N.zones,M="",E;if(I){for(E in J){var K=J[E];if(K&&K.tableNode===I){M=K.slot;break;}}}var L=mstrmojo.boxmodel.offset(G,N.overlayNode);this.set("location",{left:0,top:L.top,width:Math.min(G.offsetWidth+L.left,N._pl),height:G.offsetHeight});},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onlocationChange:function(){var D=this.location;if(!D){return ;}var E=this.domNode.style;E.left=(D.left+Math.max(D.width-18,0))+"px";E.top=D.top+(D.height?Math.round(D.height/2)-7:0)+"px";}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.css");mstrmojo.ui.pathbar.PathPopup=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.ui.pathbar.PathPopup",autoCloses:true,locksHover:true,markupMethods:{onvisibleChange:function(){if(this.isOpen){mstrmojo.css.toggleClass(this.domNode,"open",this.visible);}},onleftChange:mstrmojo.Widget.leftMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod},cssClass:null,targetNode:null,offsetTop:0,offsetLeft:0,onOpen:function B(){var D=this,C=D.domNode,E=mstrmojo.dom.position(D.targetNode);C.style.top=(E.y+E.h+D.offsetTop)+"px";C.style.left=(E.x+D.offsetLeft)+"px";D.set("visible",false);D.isOpen=true;window.setTimeout(function(){D.set("visible",true);},100);mstrmojo.css.toggleClass(D.targetNode,"opened",true);},onClose:function A(){var C=this;window.setTimeout(function(){delete C.isOpen;mstrmojo.css.toggleClass(C.targetNode,"opened",false);},500);C.domNode.style.left="";},children:null});}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.css");var B=mstrmojo.Widget,A="14px";mstrmojo.vi.ui.rw.VizDropCue=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.vi.ui.rw.VizDropCue",markupString:'<div id="{@id}" class="mstrmojo-VizDropCue {@cssClass}"><div class="mstrmojo-VizDropCue-line"><div></div></div><div class="mstrmojo-VizDropCue-tooltip"><div class="mstrmojo-Tooltip vi-regular vi-tooltip-V V-center"><div class="mstrmojo-Tooltip-contentWrapper"><div class="mstrmojo-Tooltip-content"></div></div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},tooltipNode:function(){return this.domNode.lastChild;}},markupMethods:{ontopChange:B.topMarkupMethod,onleftChange:B.leftMarkupMethod,onheightChange:B.heightMarkupMethod,onwidthChange:B.widthMarkupMethod,onvisibleChange:B.visibleMarkupMethod,oncueConfigChange:function(){var C=this.cueConfig;this.set("visible",!!C);if(!C){return ;}var G=C.or==="v";mstrmojo.css.toggleClass(this.domNode,"v",G);this.set("top",C.top);this.set("left",C.left);var D=C.size;this.set("height",G?D:A);this.set("width",G?A:D);var F=C.tip,E=this.tooltipNode;E.firstChild.firstChild.firstChild.innerHTML=F||"";E.style.display=F?"block":"none";}},cueConfig:null});mstrmojo.vi.ui.rw.VizDropCue.CueConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._ListSelections","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var H=mstrmojo.dom,c=mstrmojo.css,R=mstrmojo.hash,I=mstrmojo.all,K="px";function C(g){if(this.dragging){return ;}this._moveCnt++;if(this._moveCnt>this.mousemoveBuffer){var f=document.body;H.detachEvent(f,"mousemove",this._mousemoveCallback);H.detachEvent(f,"mouseup",this._cancelCallback);this.initDrag(g);}}function N(h){var f=document.body;H.detachEvent(f,"mousemove",this._mousemoveCallback);H.detachEvent(f,"mouseup",this._cancelCallback);var g=this.afterDragCancel;if(g){g.call(this.target,h);}}function d(h){H.preventDefault(window,h);if(this.dragging){return true;}var f=this.target.id,g=document.body;if(!this._mousemoveCallback){this._mousemoveCallback=function(k){C.call(I[f].dnd,k);return true;};}this._moveCnt=0;this.startE=R.copy(h);H.attachEvent(g,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(k){N.call(I[f].dnd,k);return true;};}H.attachEvent(g,"mouseup",this._cancelCallback);return false;}function B(g){var f=this.duringDrag;if(f){f.call(this.target,g);}return true;}function A(h){this.dragging=false;var f=document.body;H.detachEvent(f,"mousemove",this._dragCallback);H.detachEvent(f,"mouseup",this._dragEndCallback);var g=this.afterDragEnd;if(g){g.call(this.target,h);}return true;}function M(){if(this._mousemoveCallback){H.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._cancelCallback){H.detachEvent(document.body,"mouseup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){H.detachEvent(document.body,"mousemove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){H.detachEvent(document.body,"mouseup",this._dragEndCallback);delete this._dragEndCallback;}}mstrmojo.DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DnDComponent",isDragging:false,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,init:function P(e){R.copy(e,this);},initDrag:function X(l){this.dragging=true;var g=this.target.id,k=document.body;var m=this._dragCallback;if(!m){m=this._dragCallback=function(n){return B.call(I[g].dnd,n);};}H.attachEvent(k,"mousemove",m);var f=this._dragEndCallback;if(!f){f=this._dragEndCallback=function(n){return A.call(I[g].dnd,n);};}H.attachEvent(k,"mouseup",f);var h=this.afterDragStart;if(h){h.call(this.target,l);}this._dragCallback(l);}});function F(e){this.getUnit=function f(){var g=e.items.length;return g>1?e._effLen/(g-1):1;};this.calcMinMax=function(h,g){var k=Math.round((h/e.unit+g/e.unit)/2);return{min:k,max:k};};this.preUpdateThumb=function(){e.start=Math.min(e.min*e.unit,e._effLen)+K;e.sdCssText=e.orCfg.posCssP+":"+e.start+";";};this.updateThumb=function(){e.containerNode.style[e.orCfg.posCssP]=e.start=Math.min(Math.round(e.min*e.unit),e._effLen)+K;};return this;}function T(e){this.getUnit=function(){return e._effLen/e.items.length;};this.calcMinMax=function(h,g){return{min:Math.floor(h/e.unit+0.5),max:Math.floor(g/e.unit-0.5)};};function f(){var g=e.min,k=e.unit;var l=e.start=(g*k)+K;var h=e.length=Math.max(Math.round((e.max-g+1)*k-e.gap),0)+K;return{st:l,len:h};}this.preUpdateThumb=function(){var h=e.orCfg,g=f();e.sdCssText=h.posCssP+":"+g.st+";"+h.lenCssP+":"+g.len+";";};this.updateThumb=function(){var h=e.orCfg,g=f(),k=e.containerNode.style;k[h.posCssP]=g.st;k[h.lenCssP]=g.len;};return this;}var b="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div id="{@id}" class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}" mstrAttach:mouseout><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:"TL",useRichTooltip:true,init:function W(e){this._super(e);if(e.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;this.titleHeight=(e.docSelector.fmts.ttl&&e.docSelector.fmts.ttl.height)?parseInt(e.docSelector.fmts.ttl.height,10):0;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(e.multiSelect){this.typeHelper=new T(this);}else{this.clsType="sc1";this.typeHelper=new F(this);}},markupSlots:{dndNode:function(){return this.domNode.firstChild;},bgNode:function(){return this.domNode.firstChild.firstChild;},sdcNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.lastChild.firstChild;},frontNode:function(){return this.domNode.firstChild.lastChild.firstChild.firstChild;},thumbNode:function(){return this.domNode.firstChild.lastChild.firstChild.childNodes[1];},endNode:function(){return this.domNode.firstChild.lastChild.firstChild.lastChild;},tooltipNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:function(){this.synchronizeSlider();}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,dndNode:null,synchronizeSlider:function O(){var m=this.orCfg,l=m.lenCssP,g=this[l],e=parseInt(g,10),q=this.hasRendered,o=this.titleHeight||0;var h=this._effLen=isNaN(e)?0:(e-this._exRoom-o);if(g){var p={};p[l]=Math.max(parseInt(g,10)-(2*this.cssBkBW),0)-o+K;var k={};k[l]=h+K;k[m.posCssP]=Math.round(this._exRoom/2)+K;k[m.opPosCssP]="0"+K;if(q){R.copy(p,this.bgNode.style);R.copy(k,this.sdcNode.style);}else{this.bkCssText=c.getCssTextFromObj(p);this.sdcCssText=c.getCssTextFromObj(k);}}var r=this.selectedIndices;if(!R.isEmpty(r)){this.min=this.items.length-1;this.max=0;var n;for(n in r){if(r[n]){this.min=Math.min(this.min,n);this.max=Math.max(this.max,n);}}}var f=this.typeHelper;this.unit=f.getUnit();if(q){f.updateThumb();}else{f.preUpdateThumb();}},preBuildRendering:function E(){this.synchronizeSlider();},postBuildRendering:function Z(){this._super();if(this.items.length>1){var e=this.dnd=new mstrmojo.DnDComponent({target:this});var f=this.id;this.__mouseDownEvt=function(g){H.stopPropogation(window,g);d.call(I[f].dnd,g);return true;};H.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);e.afterDragStart=this.initDrag;e.duringDrag=this.ondrag;e.afterDragEnd=this.ondrop;e.afterDragCancel=this.cancelDrag;}},initDrag:function X(m,f){f=f||window;var l=this.configureGhost(true),g=this.orCfg,k=this.dnd,h=k.startE;k.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:l.containerNode[g.lenP],offset:H.getMousePosition(h,f)[g.offsetP],td:H.eventTarget(f,h)};},configureGhost:function V(f){var h=this.ghost;if(!h){var l=this.containerNode.cloneNode(true),k=l.childNodes;c.addClass(l,"gh");l.style.display="none";h=this.ghost={containerNode:l,frontNode:k[0],thumbNode:k[1],endNode:k[2]};this.sdcNode.appendChild(l);}var g=this.ghost.containerNode.style,e=this.orCfg;R.copyProps([e.posCssP,e.lenCssP],this.containerNode.style,g);if(f){g.display="block";}return h;},ondrag:function J(p,o){o=o||window;var q=this.dnd.initD,l=this.ghost.containerNode,v,h,f,n=this.min,r=this.max,m=this.orCfg,g=m.lenCssP,u=m.posCssP;var t=H.getMousePosition(p,o)[m.offsetP]-q.offset;switch(q.td){case this.thumbNode:v=Math.max(Math.min(q.tP+t,q.sL-q.contL),0);h=v+q.contL;l.style[u]=v+K;var k=this.typeHelper.calcMinMax(v,h);n=k.min;r=k.max;break;case this.frontNode:v=Math.max(Math.min(q.tP+t,q.tP+q.contL),0);f=Math.max(Math.min(q.contL-t,q.tP+q.contL),0);l.style[u]=v+K;l.style[g]=f+K;n=Math.min(Math.floor(v/this.unit+0.5),this.max);break;case this.endNode:f=Math.max(Math.min(q.contL+t,q.sL-q.tP),0);h=q.tP+f;l.style[g]=f+K;r=Math.max(Math.floor(h/this.unit-0.5),this.min);break;default:return ;}if(n!==this.min||r!==this.max){this.min=n;this.max=r;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function a(){this.typeHelper.updateThumb();var k=this.ghost;if(k){k.containerNode.style.display="none";}this.hideTooltip();var l=this.dnd&&this.dnd.initD;if(this.makeSelection&&l){this.makeSelection({selItem:l.td});}var e=this.items;if(e&&e.length){var g=[],f;for(f=this.min;f<=this.max;f++){var h=e[f];if(h){g.push(f);}}this.select(g);}this.dnd.initD=null;},cancelDrag:function U(g,f){if(this.makeSelection){this.makeSelection({selItem:H.eventTarget(f||window,this.dnd.startE)});}},showTooltip:function G(g,f){this.configureGhost(false);this._updateTooltip(g,f);this._super(g,f);},hideTooltip:function L(g,f){if(this.dnd&&this.dnd.dragging){return ;}this._super(g,f);},_updateTooltip:function S(){var n=this.orCfg,o={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},f=(this.ghost)?this.ghost.containerNode:this.containerNode;o[n.opPosCssP]=0;o[n.posCssP]=f.style[n.posCssP];o.content="";var l=this.items,h=l.length;if(l&&h){var e=(l[this.min]||l[0]),g=this.getItemTooltip(e),k=g;if(this.min!==this.max){var m=(l[this.max]||l[h-1]);k=mstrmojo.desc(146,"From:")+" '"+g+"' "+mstrmojo.desc(147,"To:")+" '"+this.getItemTooltip(m)+"'";}o.content=b.replace(/\{@content\}/g,k);}this.set("richTooltip",o);},getItemTooltip:function D(e){var f=e?e.n:"";return"'"+(f.length>20?f.slice(0,20)+"...":f)+"'";},unrender:function Y(e){this.ghost=null;this.hideTooltip();this.min=0;this.max=(this.items&&this.items.length-1)||0;var f=this.dndNode,g=this.__mouseDownEvt;if(g&&f){H.detachEvent(f,"mousedown",g);}M.call(this);this._super(e);},onselectionChange:function Q(){var e=this.selectedIndices,f=R.isEmpty(e);if(e){this.set("max",f?this.items.length-1:R.max(e,false,true));this.set("min",f?0:R.min(e,false,true));if(this.typeHelper){this.typeHelper.updateThumb();}}if(this.onchange){this.onchange();}}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.tooltip");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.hash,H=mstrmojo.array,C=mstrmojo.tooltip;mstrmojo.ui._HasListTooltip=mstrmojo.provide("mstrmojo.ui._HasListTooltip",{_mixinName:"mstrmojo.ui._HasListTooltip",tooltipOrientation:"horizontal",tooltipOffset:8,tooltipMarkup:'<div class="content" style="{@style}">{@c}</div>',tooltipCss:{},tooltipContrast:false,getTooltipText:function A(I){return I&&(I.ttp||I.n);},showTooltip:function G(W,M){var O=this;if(!O.hasOpenTooltip&&!(O._lastOpened&&O._lastOpened.visible)){var b=E.eventTarget(M,W),X=O.getItemFromTarget(b),R=O.getItemNodeFromTarget(b),d=O.getTooltipText(X),N=O.tooltipCss;if(!d){return ;}var c=E.position(R),V,P,L,T="",U=O.tooltipOffset;if(this.tooltipOrientation==="vertical"){V=c.x+c.w/2;L=C.POS_TOPCENTER;P=c.y+c.h+U;O.tooltipCss=F.copy({cssClass:"vi-regular vi-tooltip-A A-center"},N);}else{var K=E.windowDim(),S=40,Y=c.x+c.w+U,J=c.x-U,a=J-S,I=K.w-(Y+S),Z="vi-regular vi-tooltip-",Q;P=c.y;if(I>=a){V=Y;Q=I;L=C.POS_TOPLEFT;N.cssClass=Z+"C  "+N.rightCssClass;}else{V=J;Q=a;L=C.POS_TOPRIGHT;N.cssClass=Z+"D  "+N.leftCssClass;}T="max-width: "+Q+"px;";}if(O.tooltipContrast){N.cssClass=N.cssClass+" contrast";}if(N&&N.getItemCssClass){N.cssClass=H.filter([N.cssClass,N.getItemCssClass(X)],function(e){return !!e;}).join(" ");}O.richTooltip=F.copy(O.tooltipCss,{content:D.apply(O.tooltipMarkup,{c:d,style:T}),top:P,left:V,posType:L});O.richTooltip.keepArrowXPos=!!O.keepArrowXPos;O.richTooltip.keepArrowYPos=!!O.keepArrowYPos;this._super(W,M);}},onclick:function B(I){var J=this;window.setTimeout(function(){if(J.hasOpenTooltip){J.hideTooltip();}window.clearTimeout(J._tooltipTimeOut);},0);this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash","mstrmojo.string");mstrmojo.requiresDescs(11038,11935,11936,11937,11856,11938,13138,13230,13260,14633,14636);var C=mstrmojo.hash.copy,P=mstrmojo.css,J=mstrmojo.dom,N=mstrmojo.array,E=mstrmojo.string,Q=function Q(V,T){if(!V){return ;}var S=T&&T.length||0,U;for(U=S;U>0;U--){V=V.replace(new Array(U+2).join("#"),T[U-1]);}return V;},L=function L(T){if(!T){return ;}var Z=this,V=J.position(T.refNode||Z.refNode),Y=J.position(Z.domNode),X=T.position||R.RIGHT,U=0,a=0,S=9+(T.margin!==undefined?T.margin:0),W=" ";switch(X){case R.TOP:a=-Y.h-S;W+="t";break;case R.BOTTOM:a=V.h+S;W+="b";break;case R.LEFT:U=-Y.w-S;W+="l";break;case R.RIGHT:U=V.w+S;W+="r";break;}mstrmojo.hash.forEach(C(T,{left:U,top:a,contentNodeCssClass:W,visible:false}),function(b,c){this[c]=b;},this);this.set("visible",T.invalid);},A=function A(S){var W=this,U,V=S.errorCode,X=S.errorMsg,T=S.args,Y=mstrmojo.vi.ui.rw.selectors.EnumWarningMessages;if(S.invalid){U={content:V!==null?(W.generateContentHTML(Q(Y[V],T))||Y["*"]):X};}return U;};mstrmojo.vi.ui.rw.selectors.EnumWarningMessages=C(mstrmojo.locales.validation,{"*":mstrmojo.desc(11038,"Invalid"),invalidValueVIWarning:mstrmojo.desc(11935,"Invalid characters"),emptyValueVIWarning:mstrmojo.desc(11936,"Please enter a number"),notIntegerVIWarning:mstrmojo.desc(11937,"Please enter an integer"),outOfRangeVIWarning:mstrmojo.desc(11856,"Please enter value between ## and ###."),noMultiSelectionVIWaring:mstrmojo.desc(11938,"This selector does not support multiple selections."),continuousSelectionVIWaring:mstrmojo.desc(13138,"This selector does not support non-continuous selections."),bigDecimalMetricSliderVIWaring:mstrmojo.desc(13230,"Cannot qualify on big decimal value. Please change qualification type to Rank"),unableDisplaySelectionVIWarning:mstrmojo.desc(13260,"Filter cannot display actual selections."),imageSizeExceedLimitVIWarning:mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead."),imageFileTypeNotSupportedVIWarning:mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."),imageOverSizeNoCompessionVIWarning:mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.")});mstrmojo.vi.ui.rw.selectors.EnumWarningPosition={TOP:1,BOTTOM:2,LEFT:3,RIGHT:4};var R=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition;mstrmojo.vi.ui.rw.selectors._HasWarningMessage=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasWarningMessage",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasWarningMessage",warningSlotName:"warning",showWarning:function G(U){var Y=this,a=Y.warningSlotName,c=Y[a],S=U&&U.lasting||6000,X=U.refNode||this.domNode,T=U.highlight!==false,b=U.closeOnClick===false?false:true,Z;if(!c){c=new mstrmojo.Tooltip({refNode:X,highlight:T,closeOnClick:b,updatePopupConfig:null,cssClass:"vi-warning vi-tooltip-V"});Y.addDisposable(c);Y[a]=c;Z=Y.closeOnClick=Y.getCloseOnClickListener();J.attachEvent(document.body,"click",Z);}var W=U.position||R.TOP,V="vi-warning vi-tooltip-";switch(W){case R.TOP:c.cssClass=V+"V";break;case R.BOTTOM:c.cssClass=V+"A";break;case R.LEFT:c.cssClass=V+"D";break;case R.RIGHT:c.cssClass=V+"C";break;}c.open(Y,A.call(Y,U));this.adjustPosition(U);if(T){P.toggleClass(c.refNode,"mstrmojo-Warning",true);}window.clearTimeout(Y._warningTimeOut);Y._warningTimeOut=window.setTimeout(function(){Y.hideWarning();},S);},hideWarning:function H(){var T=this,S=T[T.warningSlotName];if(S&&S.visible&&S.close){if(S.highlight){P.toggleClass(S.refNode,"mstrmojo-Warning",false);}S.close();window.clearTimeout(T._warningTimeOut);delete T._warningTimeOut;}},getCloseOnClickListener:function I(){var S=this;return function(){var T=S[S.warningSlotName];if(T.closeOnClick){S.hideWarning();}};},adjustPosition:function M(S){var T=this;L.call(T[T.warningSlotName],S);},generateContentHTML:function D(S){return E.encodeHtmlString(S,true);},bindWarningHandler:function F(){N.forEach(arguments,function S(U){if(!U||!U.attachEventListener){return ;}var V=U._validationEventListener,T;if(V){U.detachEventListener(V);delete U._validationEventListener;}T=this.getValidationEvtListener();if(T){U._validationEventListener=U.attachEventListener("validationChange",this.id,T);}},this);},getValidationEvtListener:function B(){var T=this;return function S(U){var V=U.value;T[(V&&V.invalid?"show":"hide")+"Warning"](V);};},unrender:function K(S){var T=this[this.warningSlotName];if(T){T.unrender();}this._super(S);},destroy:function O(S){J.detachEvent(document.body,"click",this.closeOnClick);return this._super(S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate","mstrmojo.css","mstrmojo.validation","mstrmojo.vi.ui.rw.selectors._HasWarningMessage");var H=mstrmojo.css,E=mstrmojo.validation,G=E.TRIGGER,J=E.STATUSCODE;function F(L){if((this.constraints.trigger&L)>0){this.validate();}}mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,getInvalidMsg:function K(L){return(L&&L.msg?L.msg:"");},postBuildRendering:function A(){this._super();this._original_tooltip=this.inputNode.title;},prekeyup:function I(L){this._super(L);var P=(this.constraints.trigger&G.ONKEYUP)>0;if(P){var M=this.validationDelay;if(M){this.clearValDelayTimer();var O=this._validateHandler;if(!O){var N=this;this._validateHandler=O=function(){N.validate();if(N._valDelayTimer){window.clearTimeout(N._valDelayTimer);delete N._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(O,M);}else{this.validate();}}},preinput:function D(L){this._super(L);F.call(this,G.ONKEYUP);},preblur:function B(L){this._super(L);F.call(this,G.ONBLUR);},clearValidation:function C(){this._super();var L=this.inputNode;H.removeClass(L,this.constraints.invalidCssClass||"mstrmojo-TextBox-ErrValidation");L.title=this._original_tooltip;},clearValDelayTimer:function(){var L=this._valDelayTimer;if(L){window.clearTimeout(L);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ValidationTextBox,{onvalidationStatusChange:function(){var P=this.validationStatus;if(!P){return ;}var N=this.inputNode,L=(P.code>J.VALID),M=this.constraints.invalidCssClass;H.toggleClass(N,M||"mstrmojo-TextBox-ErrValidation",L);var O=L?this.getInvalidMsg(P):this._original_tooltip;if(!this.useRichTooltip&&O!==undefined&&O!==null){N.setAttribute("title",O);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo.dom","mstrmojo.hash","mstrmojo.imageUtils");mstrmojo.requiresDescs(1212);var C=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition,F=mstrmojo.dom,H=mstrmojo.imageUtils,G=mstrmojo.hash,E=1<<20,A=3,D=10*E;var B={SUCCESS:0,OVER_SIZE:1,INVALID_FILE_TYPE:2,OVER_SIZE_NO_COMPRESSION:3};mstrmojo.vi.ui.rw._ValidInputLocalImage=mstrmojo.provide("mstrmojo.vi.ui.rw._ValidInputLocalImage",{_mixinName:"mstrmojo.vi.ui.rw._ValidInputLocalImage",imageBox:undefined,validationStatus:undefined,fileSizeAfterCompressedInMB:undefined,VALID_MIME_TYPES:["image/png","image/jpeg","image/bmp","image/gif"],validationFailed:function(){mstrApp.hideWait();},validationSuccess:function(I){mstrApp.hideWait();if(this.imageBox){this.imageBox.localImageAdded(I);}},getValidationObj:function(){var J=this.validationStatus,I={},K={refNode:this.domNode,invalid:true,position:C.BOTTOM,closeOnClick:true,lasting:12000,highlight:false};I[B.OVER_SIZE]={errorCode:"imageSizeExceedLimitVIWarning",args:[A,this.fileSizeAfterCompressedInMB||A]};I[B.OVER_SIZE_NO_COMPRESSION]={errorCode:"imageOverSizeNoCompessionVIWarning",args:[A]};I[B.INVALID_FILE_TYPE]={errorCode:"imageFileTypeNotSupportedVIWarning",args:[]};return I[J]?G.copy(K,I[J]):undefined;},fileSelected:function(K){var M=this;var N=new Image(),I=new FileReader();var L=(mstrApp.isSingleTier&&K.fileBlob)?K.fileBlob:K;N.mime_type=L.type;var J={file:L,imageName:K.name};if(this.VALID_MIME_TYPES.indexOf(N.mime_type)===-1){M.validationStatus=B.INVALID_FILE_TYPE;M.validationFailed();return ;}mstrApp.showWait({message:mstrmojo.desc(1212,"Processing...")});if(L.size>=D){M.validationStatus=B.OVER_SIZE_NO_COMPRESSION;M.validationFailed();return ;}I.onload=function(O){N.src=O.target.result;N.onload=function(){var P=A*E,R=J.file.size;if(R<P){J.base64Str=N.src;J.imageData=H.dataURLToBlob(N.src);J.imageSize=J.imageData.size;}else{if(N.mime_type==="image/gif"){M.validationStatus=B.OVER_SIZE_NO_COMPRESSION;M.validationFailed();return ;}else{var S=75;if(N.naturalWidth>=1920&&N.naturalHeight>=1080){S=45;}var U="jpg";if(N.mime_type==="image/png"){U="png";}var T=H.compress(N,S,U);J.base64Str=T.src;J.imageData=H.dataURLToBlob(T.src);J.imageSize=J.imageData.size;}}var Q=J.imageSize;M.fileSizeAfterCompressedInMB=Math.min(Q,J.file.size)/E;M.fileSizeAfterCompressedInMB=M.fileSizeAfterCompressedInMB.toFixed(1);if(Q>P){M.validationStatus=Q>=R?B.OVER_SIZE_NO_COMPRESSION:B.OVER_SIZE;M.validationFailed();return ;}M.validationSuccess(J);};N.onerror=function(){M.validationStatus=B.INVALID_FILE_TYPE;M.validationFailed();};};I.onerror=function(){M.validationStatus=B.INVALID_FILE_TYPE;M.validationFailed();};I.readAsDataURL(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui._HasListTooltip");mstrmojo.ui.PopupList=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo._IsPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.ui.PopupList",autoCloses:true,locksHover:true,closeOnClick:true,parentDomNode:undefined,markupString:'<div id="{@id}" class="mstrmojo-PopupList {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="mstrmojo-popupList-scrollBar"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function D(){return this.domNode.firstChild.firstChild;},scrollboxNode:function F(){return this.domNode.firstChild;}},setupScrollNodes:function E(){this.scrollNode=this.scrollboxNode;},onOpen:function B(){this._super();this.updateScrollbars();},postBuildRendering:function C(){var H=this._super();if(!this.parent){var G=this.parentDomNode=this.parentDomNode||document.body;G.appendChild(this.domNode);}return H;},closePopup:function A(){this.set("visible",false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui.menus._HasMenuPopup","mstrmojo._CanAutoClose","mstrmojo._IsPopup","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.ui.PopupConfig","mstrmojo.ui._HasScroller","mstrmojo.ui._HasUITheme","mstrmojo.dom","mstrmojo.css","mstrmojo.ui._HasListTooltip");var D=mstrmojo.dom,P=mstrmojo.css,I=mstrmojo.ui.PopupConfig.directionCfg;var Q={};var K=false;function F(V,W){if(V.pop){if(W&&V.ax){window.clearTimeout(this._popupAxTimeout);V.actionFn();this.closeAllMenus();}else{var T=V.fn.call(mstrmojo.all[V.scope],V.ctxt);var U=T.ENUM_CORNERS;T.setAlignment(U.TOP_RIGHT,U.TOP_LEFT);T.hostId=this.id;T.hostElement=this._getItemNode(V._renderIdx);this.openPopup(T.newInstance());}}else{if(V.dsbld!==true){if(V.fn(V,this)!==false){this.closeAllMenus();}}}}function G(T){var U=parseInt(T);return U===null||isNaN(U)?0:U;}mstrmojo.ui.menus.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._IsPopup,mstrmojo.ui.menus._IsMenuPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip,mstrmojo.ui._HasScroller,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.ui.menus.Menu",selectionPolicy:"reselect",locksHover:true,closeOnClick:true,themeClassName:"mojo-theme-dark",icnCss:"mstrmojo-ui-Menu-item-container",popupConfig:null,tooltipCss:{leftCssClass:"menuTooltip",rightCssClass:"menuTooltip"},setupScrollNodes:function(){if(this.popupConfig&&this.popupConfig.supportsScroll){this.scrollNode=this.itemsContainerNode;this.scrollbarHostNode=this.domNode;}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll&&this.hasCustomScrollbar){var V=this.scrollNode;if(!V){return ;}var T=(getComputedStyle&&getComputedStyle(V,null))||V.currentStyle,U=V.offsetWidth-G(T.borderLeftWidth)-G(T.borderRightWidth)-V.clientWidth;V.style.marginRight=-U+"px";V.style.paddingRight=0;}},onscroll:function(){this.closePopup();this._super();},init:function L(V){this._super(V);var T=this.popupConfig;this.items=T.getMenuItems();var U=["mstrmojo-ui-Menu","unselectable"],W=T.menuCssClass;if(W){U.push(W);}P.addWidgetCssClass(this,U);if(T&&T.supportsScroll&&T.maxHeight>0){this.icnCssText=(this.icnCssText||"")+";max-height:"+T.maxHeight+"px";}this.useRichTooltip=!!T.useTooltip;this.tstid=T.tstid;},markupMethods:{onvisibleChange:function J(){var T=this.visible;if(!K||T){P.toggleClass(this.domNode,"visible",T);}}},getItemMarkup:function C(X,T){if(X.getItemMarkup){return X.getItemMarkup.apply(this,[X,T]);}var V=!!X.pop,W=V?"submenu":"item",U=Q[W];if(!U){U=this._super(X,T).replace("{@en@n}",'<div class="micn"></div>{@en@n}');if(V){U=U.replace("{@en@n}",'{@en@n}<div class="arw"></div>');}Q[W]=U;}if(X.tstid){U=U.replace("{@tag}","{@tag} "+mstrmojo.tstid(X)+" ");}return U;},getItemProps:function R(V,T){var U=this._super(V,T);U.tag="a";U.addCls("mstrmojo-ui-Menu-item");U.addCls(V.cls);return U;},adjustCornersForPopupOverflow:function O(){var V=this._super(),Z=this.domNode,Y,X,T,U,W;if(V){Y=D.position(Z);T=Y.y;X=Z.style;U=this.popupConfig;W=U.position||D.position(U.hostElement);if(T<0||(T+Y.h>D.position(document.body).h)){X.top=(-W.y+5)+"px";X.bottom="auto";}}return V;},onmouseover:function E(T){var Y=T.getTarget(),X=this.getItemFromTarget(Y),W=this,V=W._lastOpened,a=V&&this.getItemFromTarget(V.popupConfig.hostElement)._renderIdx,Z=this.getItemNodeFromTarget(Y),U=(a!==undefined&&D.contains(this._getItemNode(a),Y,true,this.domNode));if(X){this._lastHoverIx=X._renderIdx;window.clearTimeout(this._popupTimeOut);window.clearTimeout(this._popupAxTimeout);if(this._lastHoverIx!==a&&!U){this._popupTimeOut=window.setTimeout(function(){if(W._lastOpened&&W._lastOpened.visible){W.closePopup();}if(W.visible&&X.pop){if(X.ax){W._popupAxTimeout=window.setTimeout(function(){P.removeClass(Z,"hlt-ax");F.call(W,X);},0);}else{F.call(W,X);}}},400);if(X.pop&&X.ax){P.addClass(Z,"hlt-ax");}}}},onclick:function S(T){this._evtTarget=T.getTarget();this._super(T);T.cancel();},postselectionChange:function H(T){var U=T.added;if(U){var V=this.items[U[0]];F.call(this,V,!(V.ax&&this._evtTarget.className==="arw"));delete this._evtTarget;}},oncontextmenu:function M(T){D.preventDefault(window,T.e);return false;},postBuildRendering:function N(T){this._super(T);if(this.popupConfig.supportsScroll){var U=this;window.setTimeout(function(){U.updateScrollbars();},10);}},showTooltip:function B(X,W){var V=D.eventTarget(W,X),U=this.getItemNodeFromTarget(V),T=this.getItemFromTarget(V);if(U&&((T&&T.ttp)||(U.scrollWidth>U.clientWidth))){this._super(X,W);}},onClose:function A(T){if(this._super){this._super(T);}this.closePopup();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.css","mstrmojo.hash");var D=mstrmojo.dom,C=mstrmojo.css,G=mstrmojo.hash,B=9,F="px";mstrmojo.AttributeSlider=mstrmojo.declare(mstrmojo.Slider,null,{scriptClass:"mstrmojo.AttributeSlider",thumbWidth:7,synchronizeSlider:function A(){if(this.isHoriz){var N=this.orCfg,M=N.lenCssP,J=this[M],H=parseInt(J,10),Q=this.hasRendered;var K=this._effLen=isNaN(H)?0:(H-this._exRoom-(2*B));if(J){var P={};P[M]=Math.max(parseInt(J,10)-(2*this.cssBkBW),0)-(2*B)+F;var L={};L[M]=K+F;L[N.posCssP]=Math.round(this._exRoom/2)+B+F;L[N.opPosCssP]="0"+F;if(Q){G.copy(P,this.bgNode.style);G.copy(L,this.sdcNode.style);}else{this.bkCssText=C.getCssTextFromObj(P);this.sdcCssText=C.getCssTextFromObj(L);}}var R=this.selectedIndices;if(!G.isEmpty(R)){this.min=this.items.length-1;this.max=0;var O;for(O in R){if(R[O]){this.min=Math.min(this.min,O);this.max=Math.max(this.max,O);}}}var I=this.typeHelper;this.unit=I.getUnit();if(Q){I.updateThumb();}else{I.preUpdateThumb();}}else{this._super();}},postBuildRendering:function E(){this._super();C.addClass(this.containerNode,["attslider"]);C.addClass(this.frontNode,["attslider"]);C.addClass(this.thumbNode,["attslider"]);C.addClass(this.endNode,["attslider"]);C.addClass(this.bgNode,["attslider"]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.vi.ui.rw.selectors.SliderHelper","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo.num");var F=mstrmojo.dom,G=mstrmojo.css,C=mstrmojo.hash,L=Math.max,H=Math.min;mstrmojo.vi.ui.rw.selectors.Slider=mstrmojo.declare(mstrmojo.Slider,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.Slider",markupString:'<div class="mstrmojo-VISlider mstrmojo-Slider {@cssClass} {@clsOrientation}" style="{@cssText}" ><div class="sl-title"></div><div class="sl-control"></div><div class="cont" style="position:relative"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}" mstrAttach:click><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseout></div><div class="bk middle" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseout></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label subscript left">{@lowText}</div><div class="mstrmojo-Label subscript right">{@highText}</div></div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},controlNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[2];},bgNode:function(){return this.domNode.childNodes[2].firstChild;},sdcNode:function(){return this.domNode.childNodes[2].childNodes[1];},containerNode:function(){return this.domNode.childNodes[2].childNodes[1].firstChild;},lowerRange:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.firstChild;},handle1Node:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[1];},thumbNode:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[2];},handle2Node:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3];},upperRange:function(){return this.domNode.childNodes[2].childNodes[1].firstChild.lastChild;},lowNode:function(){return this.domNode.childNodes[2].childNodes[2];},highNode:function(){return this.domNode.childNodes[2].childNodes[3];},tooltipNode:function(){return[this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[1],this.domNode.childNodes[2].childNodes[1].firstChild.childNodes[3]];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onwidthChange:function(){this.synchronizeSlider();},onmultiSelectChange:function(){G.toggleClass(this.domNode,"scm",this.multiSelect);G.toggleClass(this.domNode,"sc1",!this.multiSelect);}},thumbWidth:14,sliderDefaultWidth:95,multiSelect:true,init:function O(P){this._super(P);this.updateTypeHelper();},updateTypeHelper:function B(){var P=C.walk("vi.ui.rw.selectors.SliderHelper",mstrmojo);this.typeHelper=new P({slider:this});},synchronizeSlider:function E(){var R=this.orCfg,S=this.typeHelper,V=R.lenCssP,Q=this.thumbWidth,U=parseInt(this[V],10),P;U=(isNaN(U)||U<=0)?this.sliderDefaultWidth:U;P=L(U-Q,0);if(P>0){var X=L(U-(2*this.cssBkBW),0),W=P;this.bkCssText=V+":"+X+"px;";this.sdcCssText=R.posCssP+":0px;"+V+":"+W+"px;"+R.opPosCssP+":-1px;";if(this.hasRendered){this.bgNode.style[V]=X+"px";this.sdcNode.style[V]=W+"px";}}this._effectiveLength=P;S.initialSlider();S.updateThumb();S.updateSummary();},refresh:function(){this.updateTypeHelper();this._super();},configureGhost:function D(S){var T=this.ghost;if(!T){var W=this.containerNode.cloneNode(true),V=W.childNodes;G.addClass(W,["gh"]);W.style.display="none";T=this.ghost={containerNode:W,lowerRange:V[0],handle1Node:V[1],thumbNode:V[2],handle2Node:V[3],upperRange:V[4]};this.sdcNode.appendChild(W);}var Q=this.orCfg,P=Q.posCssP,R=Q.lenCssP,U=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(b,X){var a=mstrmojo.all[U],Z=a[b].style,Y=T[b].style;if(X){Y[P]=Z[P];}Y[R]=Z[R];});if(S){T.containerNode.style.display="block";}return T;},initDrag:function K(T,P){P=P||window;var U=F.eventTarget(P,this.dnd.startE);if(U===this.handle1Node||U===this.handle2Node){var S=this.configureGhost(true),Q=this.orCfg,R=this.dnd;R.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10),length:this._effectiveLength,contL:S.containerNode[Q.lenP],offset:F.getMousePosition(this.dnd.startE,P)[Q.offsetP]};R.initD.td=U;G.removeClass(this.domNode,["invalid"]);}},ondrag:function N(X,W){var U=this.typeHelper;W=W||window;var Z=this.dnd.initD;if(Z){var d=this.ghost,f=Z.handle1,S=Z.handle2,V=this.cs1Idx,R=this.cs2Idx,Q=Z.length;var b=F.getMousePosition(X,W)[this.orCfg.offsetP]-Z.offset;switch(Z.td){case this.handle1Node:f=L(H(L(Z.handle1+b,0),Q),-1);V=U.getIdxByPx(f);break;case this.handle2Node:S=L(H(L(Z.handle2+b,0),Q),-1);R=U.getIdxByPx(S);break;default:return ;}U.positionSliderElements(d,f,S);var Y=this.items,P=(Y&&Y.length)||0;if(P&&V>=0&&V<P&&R>=0&&R<P){var c=false,a;if(V!==this.cs1Idx){this.cs1Idx=V;a=this.items[V];this.cs1Vl=a.v;this.cs1Nm=a.n;c=true;}if(R!==this.cs2Idx){this.cs2Idx=R;a=this.items[R];this.cs2Vl=a.v;this.cs2Nm=a.n;c=true;}if(c){U.updateThumb();this._updateTooltip({target:Z.td});}}}},ondrop:function I(Q){this.typeHelper.updateThumb();var P=this.ghost;if(P){P.containerNode.style.display="none";}this.hideTooltip(Q,self);if(this.items&&this.items.length){this.onselectionChange();}this.dnd.initD=null;},onclick:function M(a){var S=a.getTarget();if(S===this.lowerRange||S===this.upperRange||S===this.thumbNode){var U=this.typeHelper,Q=this.orCfg.offsetP,b=F.getMousePosition(a.e)[Q],Y=b-F.position(this.handle1Node)[Q],W=b-F.position(this.handle2Node)[Q],X=this.items,V,R,P,Z,c=false;if(X.length<2){return ;}if(Math.abs(Y)<Math.abs(W)){P=L(H(L(parseFloat(this.handle1,10)+Y,0),this._effectiveLength),-1);V=U.getIdxByPx(P);if(this.cs1Idx!==V){this.cs1Idx=V;Z=X[V];this.cs1Vl=Z.v;this.cs1Nm=Z.n;c=true;}}else{P=L(H(L(parseFloat(this.handle2,10)+W,0),this._effectiveLength),-1);R=U.getIdxByPx(P);if(this.cs2Idx!==R){this.cs2Idx=R;Z=X[R];this.cs2Vl=Z.v;this.cs2Nm=Z.n;c=true;}}if(c){this.onselectionChange();U.updateThumb();}}},onselectionChange:function A(P){var Q=this.typeHelper;Q.updateSelection();Q.updateSummary();this._super(P);if(this.dnd&&this.dnd.initD){this.dnd.initD=null;}},_updateTooltip:function J(T,S){var U=F.eventTarget(S,T);if(U){var Q="<span {@ttpCssText}>{@content}</span>",P=String((U===this.handle1Node)?this.cs1Nm:this.cs2Nm).replace("$","$$$$"),R={cssClass:"mstrmojo-VISlider vi-regular vi-tooltip-V "+mstrApp.getThemeClassName(),content:Q.replace(/\{@content\}/g,P),contentNodeCssClass:"scm-tooltip",refNode:U,posType:this._tooltip_pos};this.set("richTooltip",R);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup","mstrmojo.dom","mstrmojo.css");function D(){var N=this,J=N.domNode,Q=mstrmojo.dom.position(N.targetNode),L=mstrmojo.dom.windowDim();J.style.top=(Q.y+Q.h+N.offsetTop)+"px";var P=Q.x+Q.w,M=L.w-P-J.offsetWidth;if(P+J.offsetWidth>L.w){M=L.w-Q.x;if(M+J.offsetWidth>L.w){M=0;}}if(N.id==="mstrToolbarList"){M=M-Q.w*0.75;}J.style.right=M+"px";N.set("visible",false);N.isOpen=true;N.set("visible",true);var O=parseInt(J.style.top,10);if(O+J.offsetHeight>L.h){var K=O-J.offsetHeight+Q.h;J.style.top=(K>0?K:0)+"px";}mstrmojo.css.toggleClass(N.targetNode,"opened",true);}function B(){var J=this.popup,M=J.containerNode.childNodes[0].childNodes[0].childNodes[J.zoomChildIndex].lastChild,L=M.textContent||M.innerText,K=J.dc.view.zoomValue;L=L.substr(0,L.indexOf("("));M.innerHTML=L+"("+K.n+")";}function C(N){var O=N.selectedItem;if(O===null){return ;}var S=N.containerNode.firstChild.firstChild,J=N.dc.view.zoomValue,Q=O.getAttribute("dssid");if(Q===J.dssid){return ;}mstrmojo.css.removeClass(O,"selected");var M=S.childNodes,R=M.length,P=0,K=-1,L;for(P=0;P<R;P++){L=M[P];if(L.getAttribute("dssid")===J.dssid){K=P;break;}}if(K===-1){var T=N.children[0];T.addItems([J]);L=S.childNodes[T.items.length-1];}mstrmojo.css.addClass(L,"selected");N.selectedItem=L;}function F(J,Q,M){var L;Q.addDisposable(L=new mstrmojo.ui.pathbar.PathPopup({id:"mstrZoomPopup",cssClass:"mstrShortcutsListPopup",targetNode:M,dc:Q.dc,slectedIndex:-1,selectedItem:null,onOpen:function K(){D.call(this);},onClose:function P(){delete this.isOpen;mstrmojo.css.toggleClass(this.targetNode,"opened",false);this.domNode.style.top="-10000px";},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function N(){this.parent.close();},items:J,getItemMarkup:function(){return'<a class="item {@cls}" dssid="{@dssid}"><span class="icon"></span><span>{@name}</span></a>';},getItemProps:function O(V,S){var T=V.dssid===this.parent.dc.view.zoomValue.dssid,U="";if(T){this.parent.selectedIndex=S;U="selected";}return{cls:U,dssid:V.dssid,name:V.n};},onclick:function R(a){var Z=this.parent,U=mstrmojo.dom.findAncestorByAttr(a.getTarget(),"dssid",true,Z.domNode),Y=U.node,W=Y.getAttribute("dssid"),T=Z.targetNode.getAttribute("cmdid"),b=Z.dc,S=b.view.zoomValue,V=S.dssid;if(W!==V){b[T](W);var X=Z.targetNode.lastChild.textContent||Z.targetNode.lastChild.innerText;Z.targetNode.lastChild.innerHTML=X.replace(S.n,Y.lastChild.textContent||Y.lastChild.innerText);if(Z.selectedItem===null){Z.selectedItem=this.domNode.firstChild.childNodes[Z.selectedIndex];}mstrmojo.css.removeClass(Z.selectedItem,"selected");mstrmojo.css.addClass(Y,"selected");Z.selectedItem=Y;}}}]}));return L;}function E(J,P,L){var Q;P.addDisposable(Q=new mstrmojo.ui.pathbar.PathPopup({id:"mstrExportPopup",cssClass:"mstrShortcutsListPopup",targetNode:L,dc:P.dc,onOpen:function K(){D.call(this);},onClose:function O(){delete this.isOpen;mstrmojo.css.toggleClass(this.targetNode,"opened",false);this.domNode.style.top="-10000px";},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function M(){this.parent.close();},items:J,getItemMarkup:function(){return'<a class="item" dssid="{@dssid}"><span class="icon" style="display:none;"></span><span>{@name}</span></a>';},getItemProps:function N(S){return{cls:S.cssClass,dssid:S.dssid,name:S.n};},onclick:function R(T){var V=mstrmojo.dom.findAncestorByAttr(T.getTarget(),"dssid",true,this.parent.domNode),W=V.node,U=W.getAttribute("dssid"),S=this.parent.dc;S.exportCmd(U);}}]}));return Q;}function G(){this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrToolbarList",cssClass:"mstrShortcutsListPopup",targetNode:this.domNode,offsetTop:0,zoomChildIndex:null,onOpen:function K(){D.call(this);},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",items:mstrApp.pathInfo.tbModelData.n.items,getItemMarkup:function(){return'<a class="item {@cls}" cmdId="{@cmdid}" idx="{@idx}"><span class="icon" style="display:none;"></span><span>{@name}</span></a>';},getItemProps:function M(R,O){var Q=!!R.selected,S=R.cmdid,P=R.tooltip||R.title||S;if(S==="zoom"){P+=" ("+this.parent.dc.view.zoomValue.n+")";this.parent.zoomChildIndex=O;}return{sel:Q,idx:O,cls:S,n:S,cmdid:S,name:P};},closePopup:function J(O){if(O){O.close();}},onmouseover:function N(S){var R=mstrmojo.dom.findAncestorByAttr(S.getTarget(),"cmdid",true,document.getElementById("mstrToolbarList")),T=R&&R.value,Q=this.parent,P=Q.exportPopup,O=Q.zoomPopup;if(T==="export"){this.onclick(S,R);this.closePopup(O);}else{if(T==="zoom"){this.onclick(S,R);this.closePopup(P);}else{if(T){this.closePopup(P);this.closePopup(O);}}}return false;},onclick:function L(P,T){P.cancel();var R=T||mstrmojo.dom.findAncestorByAttr(P.getTarget(),"cmdid",true,document.getElementById("mstrToolbarList")),V=R.node,Y=V.getAttribute("idx"),Q=R&&R.value,X=this.parent,Z=X.dc,O=[],W=null;if(Q==="export"){if(!X.exportPopup){O=this.items[Y].items;X.exportPopup=E(O,X,V);}var U=X.exportPopup;U.autoPosition=false;W=V.getBoundingClientRect();if(!U.isOpen){U.offsetTop=-(W.height||V.offsetHeight);U.open();}}else{if(Q==="zoom"){if(!X.zoomPopup){O=this.items[Y].items;X.zoomPopup=F(O,X,V);}var S=X.zoomPopup;S.autoPosition=false;W=V.getBoundingClientRect();if(!S.isOpen){S.offsetTop=-(W.height||V.offsetHeight);if(S.hasRendered){C.call(this,S);}S.open();}}else{if(Z[Q]){Z[Q]();X.close();}}}}}]}));}mstrmojo.ui.pathbar.PathHamburger=mstrmojo.declare(mstrmojo.Widget,null,{userName:null,init:function I(J){this._super(J);},scriptClass:"mstrmojo.ui.pathbar.PathHamburger",markupString:'<div id="mstrHamburger" mstrAttach:click class="mstrHamburgerButton" style="top:0"><div class="mstrHamburger path"></div></div>',popup:null,postBuildRendering:function A(){G.call(this);},onclick:function H(){var J=this.popup;if(!J.dc){J.dc=this.parent.dc;}if(!J.isOpen){if(J.hasRendered){B.call(this);}J.open();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.pathbar.PathPopup","mstrmojo.dom","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui.pathbar._PreAppExit");var D=mstrmojo.dom;function C(){this.addDisposable(this.pickerMenu=new mstrmojo.ui.pathbar.PathPopup({id:"mojoPathPickerMenu",cssClass:"mojoPathPicker",offsetLeft:-23,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function F(){this.parent.close();},items:null,getItemMarkup:function(){return'<a href="#" idx="{@idx}"><span>{@en@n}</span></a>';},getItemProps:function G(I,H){return{n:I.n,idx:H,href:I.href};}}]}));}mstrmojo.ui.pathbar.PathNavigation=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit],{scriptClass:"mstrmojo.ui.pathbar.PathNavigation",icnCss:"pathNavigationRight",pickerMenu:null,init:function E(F){this._super(F);C.call(this);},onclick:function A(G){var H=this.pickerMenu;if(!this._super(G)){return false;}var K=G.target||D.eventTarget(G.hWin,G.e),I=D.findAncestorByAttr(K,"idx",true,this.domNode),F=I&&parseInt(I.value,10),J=this.items[F];if(J&&J.en&&J.items){if(H.targetNode!==I.node){H.set("targetNode",I.node);H.menuItems.set("items",J.items);}if(!H.isOpen){H.open();}}},getItemMarkup:function(F){if(F.items){return'<span class="tb{@n} mstrComboDown" idx="{@idx}"><a class="tb{@n}0 mstrIcon-tb {@en}" title="{@desc}" href="#"></a><span class="tb{@n}1 mstrPullArrow {@en}" title="{@desc}" menu="true"></span></span>';}if(F.visible===false){return"";}return'<a href="#" idx="{@idx}"><span title="{@desc}" class="tb{@n} mstrIcon-tb {@en}"></span></a>';},getItemProps:function B(G,F){return{n:G.n,idx:F,href:G.href,desc:G.desc,en:G.en?"":"disabled"};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup");function D(F){return(F!=="myPage");}function A(){this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrAccountSCList",cssClass:"mstrShortcutsListPopup mstrAccountSCListPopup",targetNode:this.domNode,offsetTop:0,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",useRichTooltip:true,postclick:function H(){if(D(this.selectedItem.name)){this.parent.close();}},items:mstrApp.pathInfo.el,getTooltipText:function F(I){if(I&&I.name==="save"){return mstrmojo.desc("14684","Publish current layout as default layout for other users");}else{return null;}},getItemMarkup:function(){return'<a class="item {@name} {@cls} {@newGroup}" idx="{@idx}" onclick="{@onclick}" href="#" target="{@target}"><span class="icon"></span><span>{@n}</span></a>';},getItemProps:function G(K,I){var J=!!K.selected;return{sel:J,cls:J?"selected":"",newGroup:!!K.grp?"grp":"",n:K.n,idx:I,href:K.href,name:K.name,onclick:K.onclick||"return false;",target:K.target||"_self"};}}]}));}mstrmojo.ui.pathbar.PathExtraLinks=mstrmojo.declare(mstrmojo.Widget,null,{userName:null,init:function E(G){var H=this;this._super(G);var F=this.items;this.userName=F[0].user;mstrmojo.array.forEach(this.items,function(I){if(I.name==="save"){I.onclick="mstrmojo.all."+H.id+".raiseEvent({name:'saveDefaultCard'})";I.en=false;}if(I.name==="load"){I.onclick="mstrmojo.all."+H.id+".raiseEvent({name:'loadDefaultCard'})";I.en=false;}if(I.name==="myPage"){I.en=false;}});F.splice(0,1);},scriptClass:"mstrmojo.ui.pathbar.PathExtraLinks",markupString:'<div id="mstrPathAccount" mstrAttach:click class="mstrLink" style="cursor:pointer;"><span class="mstrAccountName" title="{@userName}">{@userName}</span><div id="mstrAccountMenu" class="mstrAccountMenu path"></div></div>',popup:null,postBuildRendering:function C(){A.call(this);},onclick:function B(){var F=this.popup;if(!F.isOpen){F.open();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.pathbar.PathPopup","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.pathbar._PreAppExit");function A(){this.addDisposable(this.breadCrumbs=new mstrmojo.ui.pathbar.PathPopup({id:"mojoPathBreadCrumbs",cssClass:"mojoPathPicker",offsetLeft:0,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"breadCrumbsItems",preclick:function I(){this.parent.close();},items:null,getItemMarkup:function(){return'<a href="#" idx="{@idx}"><span>{@en@n}</span></a>';},getItemProps:function J(L,K){return{n:mstrmojo.string.decodeHtmlString(L.n),idx:K,href:L.href};}}]}));}var D=mstrmojo.css,G=mstrmojo.dom;mstrmojo.ui.pathbar.PathAncestors=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit],{scriptClass:"mstrmojo.ui.pathbar.PathAncestors",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout><div class="pathText"><div class="pathBreadCrumbs"><span class="pathBreadCrumbsParent"><a href="{@pathParentLink}">{@pathParentName}</a></span><span class="pathBreadCrumbsPullArrow"></span><span class="pathDelim">{@delimiter}</span></div><div class="pathAncestor hidden">{@itemsHtml}</div><div class="pathCurrent"><span>{@pathCurrent}</span></div></div></div>',markupSlots:{breadCrumbsNode:function(){return this.domNode.firstChild.children[0];},breadCrumbsParentNode:function(){return this.domNode.firstChild.children[0].firstChild;},breadCrumbsArrowNode:function(){return this.domNode.firstChild.children[0].children[1];},ancestorNode:function(){return this.domNode.firstChild.children[1];},currentNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.firstChild.children[1];}},markupMethods:{onwidthChange:function(){var K=this,I=K.ancestorNode,J=K.breadCrumbsNode;if(K.getNeededWidth()>K.getAvailWidth()){D.toggleClass(J,"hidden",false);D.toggleClass(I,"hidden",true);K.resizeBreadCrumbs();}else{K.resizePathBar();}}},delimiter:">",pathCurrent:null,pathFirst:null,pathParent:null,breadCrumbs:null,reversedItems:null,init:function H(J){this._super(J);var I=this.items;this.pathCurrent=I[I.length-1].n;this.pathFirstLink=I[0].href;this.pathFirstName=I[0].n;if(I.length>1){this.pathParentLink=I[I.length-2].en!=true?"#":I[I.length-2].href;this.pathParentName=I[I.length-2].n;}I.splice(I.length-1,1);this.reversedItems=[].concat(I).reverse();A.call(this);},resizePathBar:function(){var P=this,M=P.ancestorNode,I=P.currentNode,K=P.breadCrumbsNode,R=M.style,J=I.style,Q=G.position(P.domNode).w-23-20,O,N,L;O=Math.min(Q/2,G.position(I).w);N=Q-O;L=N>M.scrollWidth?N-M.scrollWidth:0;N-=L;R.maxWidth=Math.max(0,N)+"px";J.maxWidth=Math.max(0,Q-N)+"px";},resizeBreadCrumbs:function(){var N=this,I=N.currentNode,O=N.breadCrumbsParentNode,J=I.style,L=O.style,P=G.position(N.domNode).w-60,M,Q,K;L.maxWidth=Math.max(0,P)+"px";J.maxWidth=Math.max(0,P)+"px";M=Math.min(P/2,G.position(I,true).w);Q=P-M;K=Q>O.scrollWidth?Q-O.scrollWidth:0;Q-=K;L.maxWidth=Math.max(0,Q)+"px";J.maxWidth=Math.max(0,P-Q)+"px";},onclick:function C(I){var J=this.breadCrumbs;if(!this._super(I)){return false;}var K=I.getTarget();if(K==this.breadCrumbsArrowNode){J.set("targetNode",this.breadCrumbsNode);J.breadCrumbsItems.set("items",this.reversedItems.slice(1));if(!J.isOpen){J.open();}}},getItemMarkup:function(){return'<span idx="{@idx}"><a href="#">{@n}</a></span><span class="pathDelim">{@dl}</span>';},getItemProps:function E(J,I){return{n:J.n,href:J.href,dl:this.delimiter,idx:I};},getNeededWidth:function B(){var L=this.breadCrumbsNode,I=this.ancestorNode,K=this.currentNode,J=this.breadCrumbs;D.toggleClass(L,"hidden",true);D.toggleClass(I,"hidden",false);if(J.isOpen){J.close();}return I.scrollWidth+K.scrollWidth+30;},getAvailWidth:function F(){var I=this;return G.position(I.domNode).w-23-20;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup","mstrmojo.mstr._RecentObjectsHelper");function D(H,I){var G=this.handleRecentObjects();var J;H.addDisposable(J=new mstrmojo.ui.pathbar.PathPopup({id:"mstrRecentsGenPopup",cssClass:"mstrShortcutsListPopup",targetNode:I,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function E(){this.parent.close();},items:G,getItemMarkup:function(M){var K="";if(mstrConfig.showPreviews){if(M.recoveryInfo!==undefined){var L=(M.recoveryInfo.imgData!==undefined)?"data:image/png;base64,"+M.recoveryInfo.imgData:"";if(L!==""){K='<img class = "img-preview" src = "'+L+'" height="200" width="250" style="z-index: 100; position: absolute;">';}}}return'<span class="item mstrMenuItem {@itemCls}" style="{@cssText}"><span class="{@iconCls}"></span><a class="mstrLink" href="{@href}">{@n}'+K+"</a></span>";},getItemProps:function F(M,K){var L=!!M.selected;return{sel:L,iconCls:M.iconClass,itemCls:M.itemClass,cssText:M.cssText||"",cls:L?"selected":"",newGroup:!!M.grp?"grp":"",n:M.recoveryName,idx:K,href:M.recoveryURL,name:M.recoveryName,target:M.target||"_self"};},onclick:function(K){var M=function(){mstrmojo.dom.preventDefault(K.hWin,K.e);mstrmojo.dom.stopPropogation(K.hWin,K.e);};var L=K.getTarget();if(L.getAttribute("href")){mstrmojo.form.sendLinkAsForm(L.href);}else{mstrmojo.form.sendLinkAsForm(L.parentElement.href);}M();return false;}}]}));return J;}function A(){var I=this;this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrSCList",cssClass:"mstrShortcutsListPopup",targetNode:this.domNode,offsetTop:2,recentsPopup:null,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function E(J){if(J.getTarget().getAttribute("name")!=="recentObjects"){this.parent.close();}},handleMouseOver:function H(J,K){if(J.getTarget().getAttribute("name")=="recentObjects"){this.handleClick(J,K);}else{if(this.parent.recentsPopup!=null){var L=this.parent.recentsPopup;L.close();}}return false;},handleClick:function F(K,L){if(K.getTarget().getAttribute("name")=="recentObjects"){var M=K.getTarget();if(M.nodeName==="SPAN"){M=M.parentNode;}if(this.parent.recentsPopup==null){this.parent.recentsPopup=D.call(I,this.parent,M);}var N=this.parent.recentsPopup;N.autoPosition=false;var J=M.getBoundingClientRect();if(!N.isOpen){N.offsetTop=J.top-J.bottom;N.offsetLeft=this.domNode.clientWidth-J.left;N.open();}return true;}return false;},items:mstrApp.pathInfo.sb,getItemMarkup:function(K){var J="{@cls}";if(K.name==="recentObjects"){J="";}return'<a name="{@name}" class="item {@name} '+J+' {@newGroup}" idx="{@idx}" onclick="{@onclick}" href="#" target="{@target}"><span name="{@name}" class="icon"></span><span name="{@name}">{@n}</span></a>';},getItemProps:function G(L,J){var K=!!L.selected;return{sel:K,cls:K?"selected":"",newGroup:!!L.grp?"grp":"",n:L.n,idx:J,href:L.href,name:L.name,onclick:L.onclick||"return true",target:L.target||"_self"};}}]}));}mstrmojo.ui.pathbar.PathStarBurst=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.mstr._RecentObjectsHelper],{scriptClass:"mstrmojo.ui.pathbar.PathStarBurst",markupString:'<a id="mstrStarburst {@id}" mstrAttach:click,mouseover,mouseout class="mstrLink" style="top:0"><div id="mstrLogo" class="mstrLogo path"></div><div id="mstrLogoMenu" class="mstrLogoMenu path mstrPullArrow"></div></a>',markupSlots:{logoNode:function(){return this.domNode.children[0];},logoMenuNode:function(){return this.domNode.children[1];}},popup:null,postBuildRendering:function C(){A.call(this);this.domNode.setAttribute("href",mstrApp.name+"?evt=3010&src="+mstrApp.name+".3010");},onclick:function B(E){var F=function(){mstrmojo.dom.preventDefault(E.hWin,E.e);mstrmojo.dom.stopPropogation(E.hWin,E.e);};if(E.getTarget()===this.logoMenuNode){var G=this.popup;if(!G.isOpen){G.open();}F();}else{mstrmojo.form.sendLinkAsForm(E.src.domNode.href);F();return false;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuPopup","mstrmojo.Button","mstrmojo.dom");mstrmojo.requiresDescs(1442,2140);var E=mstrmojo.dom,G=mstrmojo.array;function B(I,K){var H=2140,M="Cancel",L="this.parent.popupConfig."+(I?"ok":"cancel"),J=K&&K[(I?"ok":"cancel")+"BtnText"];if(I){H=1442;M="Ok";}return mstrmojo.Button.newWebButton(J||mstrmojo.desc(H,M),function(O){var P=this.parent,N=P.popupConfig;P.closeAllMenus();N["fn"+M](N.data,P);E.stopPropogation(O.hWin,O.e);},I,{slot:"btnNode",bindings:{enabled:L+"Enabled",visible:L+"Visible"},cssDisplay:"inline-block"});}mstrmojo.ui.menus.MenuEditor=mstrmojo.declare(mstrmojo.ui.menus.MenuPopup,null,{scriptClass:"mstrmojo.ui.menus.MenuEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-MenuEditor {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="me-content"></div><div class="me-buttons"></div><div class="me-bottom"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;},btnNode:function D(){return this.domNode.children[1];},bottomNode:function D(){return this.domNode.children[2];}},popupConfig:null,init:function F(J){this._super(J);var I=this.popupConfig,H=I.bottomNode;this.data=I.data||{};if(I.onOpen){this.onOpen=I.onOpen;}this.addChildren([B(true,I),B(false)]);if(H){H.slot="bottomNode";this.addChildren(H);}},onOpen:function C(){G.forEach(this.children,function(H){if(H.scriptClass==="mstrmojo.ui.ScrollableContainer"&&H.onOpen){H.onOpen();}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.MenuPopup");mstrmojo.ui.menus.PopupConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.PopupConfig",cssClass:"",contents:null,clear:function A(){this._super();this.contents=null;},close:function C(){([].concat(this.contents)[0]).parent.closeAllMenus();},newInstance:function B(){return new mstrmojo.ui.menus.MenuPopup({popupConfig:this});}});}());(function(){mstrmojo.requiresClsP("mstrmojo.vi.viz","MapVisualizationTransition","GoogleMapHelper");var C=mstrmojo.vi.viz,B=mstrmojo.vi.viz.KnownVisualizations;mstrmojo.vi.viz.GoogleMapVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.MapVisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.GoogleMapVisualizationTransition",newMapHelper:function(){return new C.GoogleMapHelper();},transitionDropZones:function A(J,I){var E="",H=this.vis,G=H.node.data,F=G.visName||"Grid",D=B.getDefinition(F).id;if(D===B.ESRIMAP){E=this.transitionBetweenESRIAndGoogle(G,J,new C.ESRIMapHelper({data:G}),this.newMapHelper());}else{E=this._super(J,I);}return{wp:E,handled:false};}});}());(function(){mstrmojo.requiresClsP("mstrmojo.vi.viz","MapVisualizationTransition","ESRIMapHelper");var E=mstrmojo.vi.viz,C=E.KnownVisualizations;mstrmojo.vi.viz.ESRIMapVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.MapVisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.ESRIMapVisualizationTransition",newMapHelper:function D(){return new E.ESRIMapHelper();},setDefaultView:function B(F){F.defaultView="Light Gray Map";},transitionDropZones:function A(K,J){var G="",I=this.vis.node.data,H=I.visName||"Grid",F=C.getDefinition(H).id;if(F===C.GOOGLEMAP){G=this.transitionBetweenESRIAndGoogle(I,K,new E.GoogleMapHelper({data:I}),this.newMapHelper());}else{G=this._super(K,J);}return{wp:G,handled:false};}});}());(function(){mstrmojo.requiresClsP("mstrmojo.vi.viz","BaseVisualizationTransition");var A=mstrmojo,E=A.vi.viz,C=E.KnownVisualizations,D="Grid";mstrmojo.vi.viz.GridVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.BaseVisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.GridVisualizationTransition",transitionDropZones:function B(J,I){var H=this.vis,G=H.node.data,F=G.visName||D;if(C.getDefinition(F).id!==C.GRID){return this._super(J,I);}return{wp:"",handled:false};}});}());(function(){mstrmojo.requiresClsP("mstrmojo.vi.viz","BaseVisualizationTransition","KnownVisualizations");mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.chart.model.enums.EnumDSSGraphMarkerShape");var F=mstrmojo.array,B=mstrmojo.hash,I=mstrmojo.vi.viz.KnownVisualizations,E=mstrmojo.chart.model.enums.EnumDSSObjectType,J=201,D=E.DssTypeMetric;function G(L,M,K){switch(L){case I.GRID:return[];case I.HEATMAP:if(K){return["ColorBy","SizeBy","AdditionalMetrics"];}else{return["Grp"];}case I.GRAPHMATRIX:switch(M){case J:if(K){return["AngleBy","XAxis","YAxis","ColorBy","SizeBy","AdditionalMetrics"];}else{return["SliceBy","Rows","YAxis","BreakBy","Columns","XAxis"];}default:if(K){return["XAxis","YAxis","ColorBy","SizeBy","AdditionalMetrics"];}else{return["Rows","YAxis","BreakBy","Columns","XAxis"];}}case I.ESRIMAP:case I.GOOGLEMAP:if(K){return["ColorBy","SizeBy","AdditionalMetrics"];}else{return["Geo","AdditionalMetrics","Lat","Long"];}case I.NETWORK:if(K){return["ColorBy","SizeBy","itemsz"];}else{return["from","to"];}default:return["XAxis","YAxis","BreakBy","SliceBy","ColorBy","SizeBy","AdditionalMetrics","AngleBy","Grp","Geo","layout","from","to","itemsz","Lat","Long"];}}function C(L,O,K){var N=[],M=O.concat();F.forEach(L,function(P){F.forEach(M,function(Q,R){if(P.id===Q.did||P.did===Q.did){Q.fromZone=P.fromZone;if(K){Q.t=D;}N.push(Q);M.splice(R,1);return false;}});});return N;}function A(K,Z){var L=K.node,O=L.data,a=O.dz,Y=O.gsi,S=(Y.rows||[]).concat(Y.cols||[]),N=O.gsi.mx||[],V=[],P=[];var R=I.getDefinition(O.visName||"Grid").id,X=(R===I.GRAPHMATRIX&&K.GMController.isPie)?J:null;var U=K.zonesModel.getCustomDropZones,Q=U&&U instanceof Function,M=Q?K.zonesModel.getCustomDropZones():null;var T=function T(b){F.forEach(G(R,X,b),function(d,e){var c=a[d]||{};F.forEach((b?c.TemplateMetric:c.TemplateUnit),function(f){f.fromZone=Q?M[e].name:d;if(b){P.push(f);}else{V.push(f);}});});};T(false);if(V.length>0){V=C(V,S,false);}else{V=F.filter(Y.rows,function(b){b.fromZone="Rows";return b.did!=="-1";}).concat(F.filter(Y.cols,function(b){b.fromZone="Columns";return b.did!=="-1";}));}T(true);if(P.length>0){P=C(P,N,true);}else{P=N.concat();F.forEach(P,function(b){b.t=D;b.fromZone="Metrics";});}var W=Z.transitionDropZones(V,P);return W.map(function(c){var b=c.obj;return{act:"addDropZoneUnit",zoneId:c.toZoneId,unitId:b.did,unitType:b.t};});}mstrmojo.vi.viz.CustomVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.BaseVisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.CustomVisualizationTransition",transitionDropZones:function H(Q,U){var K=this.newVizInfo,V=K.s,P=K.dz,S=this.vis,T=S.node,b=T.k,a=T.data;if(V===a.visName){return{wp:"",handled:true};}else{if(!P){return this._super(Q,U);}}mstrmojo.requiresCls("mstrmojo."+P);var Y=B.walk(P,mstrmojo),X=new Y({getDZFlatStruct:function M(){return{};}}),L=X.getCustomDropZones&&X.getCustomDropZones();if(!L||L.length===0){var Z=Q[Q.length-1],R=Z&&Z.actions,W=R&&R[0];if(W&&W.act==="createDefaultDropZones"){W.widgetType=0;}return this._super(Q,U);}var O=X.customDropZonesTransition;if(O&&O instanceof Function){var N=A(this.vis,X);if(N){Q.push({act:"updateTemplate",keyContext:b,partialRetrieval:{nodes:[b]},actions:N});}}return{wp:"<props><widgetProps /></props>",handled:false};}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo.Box","mstrmojo.List","mstrmojo.SearchBox2","mstrmojo.WaitIcon","mstrmojo.IncFetch");var A=mstrmojo.array,B=mstrmojo.hash;mstrmojo.ElementsBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ElementsBrowser",cssClass:"mstrmojo-ElementBrowser",rootCached:null,attributeID:null,onOK:null,onUpdateBrowseElementsParams:mstrmojo.emptyFn,init:function(C){this._super(C);this.rootCached={};},postBuildRendering:function(){if(this._super){this._super();}var E=this.ebIncFetch,C=this.ebSearchBox,D=this.ebList;E.attachEventListener("fetch",C.id,function(F){E.cp=F.v;E.children=null;E.refresh();this.fetchPage(F.v-1);});C.attachEventListener("ifsChange",E.id,function(F){var G=this.np;B.copy(F.value,this);if(this.np>1){this.children=null;this.refresh();}if(G<=1&&this.np>1||G>1&&this.np<=1||G===0&&this.np>0){this.set("visible",this.np>1);}});C.attachEventListener("itemsChange",D.id,function(F){this.set("items",F.value||[]);});},initBrowser:function(){var C=this.ebSearchBox,D=this.attributeID;C.set("rootID",D);C.clear();C.searchPattern="";if(D&&!this.rootCached[D]){C.set("items",[]);C.blockBegin=1;C.fetch();this.rootCached[D]=true;}else{if(D){C._notifyContentWidget(C.searchCache[D][D]);this.ebList.updateSelections();}}},children:[{alias:"ebSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-ElementsBrowser-SearchBox",taskId:"browseElements",quickSearch:true,getRootID:function(){this.rootID=this.parent.attributeID;},onUpdateSearchParams:function(C){this.parent.onUpdateBrowseElementsParams(C);}},{alias:"ebList",scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ELementsBrowser-List",itemIdField:"v",allowUnlistedValues:false,itemMarkup:'<div class="mstrmojo-bullet"><div class="mstrmojo-ebIcons ae"><div class="mstrmojo-text">{@n}</div></div></div>',updateSelections:function(){var C=this.parent,D=C.selectedItems;if(D){this.initializing=true;this.clearSelect(false);this.setSelectedItems(D,false);this.initializing=false;}},onitemsChange:function(){this.updateSelections();},onchange:function(N){if(this.initializing){return ;}var I=this.items,J=this.parent,D=J.selectedItems,G,M;for(var H=0,C=N.removed,L=C&&C.length;H<L;H++){G=I[C[H]];M=A.find(D,this.itemIdField,G[this.itemIdField]);if(M>-1){D.splice(M,1);}}for(var F=0,K=N.added,E=K&&K.length;F<E;F++){G=B.clone(I[K[F]]);D.push(G);}},multiSelect:true,selectionPolicy:"toggle"},{alias:"ebIncFetch",scriptClass:"mstrmojo.IncFetch",cssClass:"mstrmojo-ElementsBrowser-IncFetch",height:"20px",np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(C){this.domNode.style.display=C.value?"block":"none";}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.TabContainer");mstrmojo.TabListContainer=mstrmojo.declare(mstrmojo.TabContainer,null,{scriptClass:"mstrmojo.TabListContainer",markupString:'<table id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><tr><td class="mstrmojo-tabcontainer-tabs {@listCssClass}"></td><td class="mstrmojo-tabcontainer-stack {@containerCssClass}"></td><td class="{@bottomCssClass}"></td></tr></table>',markupSlots:{top:function(){return this.domNode.firstChild.childNodes[0].childNodes[0];},stack:function(){return this.domNode.firstChild.childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.firstChild.childNodes[0].childNodes[1];},bottom:function(){return this.domNode.firstChild.childNodes[0].childNodes[2];}}});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.ScrollableDocTextfield","mstrmojo._HasEditableText","mstrmojo.vi._MonitorsAppState","mstrmojo._HasDocLink","mstrmojo.string","mstrmojo.css","mstrmojo.dom");var A=mstrmojo.dom,S=mstrmojo.css;function C(T){return T.data.dl||T.defn.dl;}function O(T){this.getAnchor()[A.isFF?"textContent":"innerText"]=T;}function N(){S.toggleClass(this.domNode,"hasLink",this.hasActiveLink());}function P(){var V=this.defn.fmts,U,T,X=0,W=this.valueNode.className.indexOf(" hasVertical ")>-1;if(V&&(V.font||"").split(" ").indexOf("italic")>=0&&(V["text-align"]||"").toLocaleLowerCase()==="right"){U=(V.font||"").match(/([0-9]+)[,\.]?[0-9]*pt/);U=(U&&U[1])||8;T=this.valueNode&&this.valueNode.style;X=Math.round(U/3)+(W?30:0);T.paddingRight=X+"px";}return X;}mstrmojo.vi.ui.rw.DocTextfield=mstrmojo.declare(mstrmojo.vi.ui.ScrollableDocTextfield,[mstrmojo._HasEditableText,mstrmojo.vi._MonitorsAppState,mstrmojo._HasDocLink],{scriptClass:"mstrmojo.vi.ui.rw.DocTextfield",markupString:'<div id="{@id}" class="mstrmojo-DocTextfield {@cssClass}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click ><div class="vi-doc-tf-value-text">{@v}</div></div>{@buttonNodeMarkup}</div>',editableSlot:"valueTextNode",editOnClick:false,editOnDoubleClick:true,allowEmptyText:true,allowNewLine:true,formatHandlers:{domNode:["background-color"],valueNode:["F","fx","text-align","white-space"]},markupSlots:{valueNode:function F(){return this.domNode.firstChild;},valueTextNode:function F(){return this.domNode.firstChild.firstChild;}},update:function H(V){delete this.fmts;this._super(V);this.text=this.v;var T=C(V);if(T){this.tooltip=T.items[0].n;}var U=this.parent;if(U){U.updateOverlay();}N.call(this);},postBuildRendering:function R(){this._super();this.attachEventListener("renderComplete",this.id,function(){P.call(this);}.bind(this));N.call(this);if(this.getFormats().overflow==="auto"&&!this.hasCustomScrollbar){this.valueTextNode.style.overflow="auto";}},getAnchor:function B(){return this.valueTextNode;},getRawText:function I(){return this.node.data.rv||this.v;},ondblclick:function G(T){this.cancelDocLink=true;if(!this.isEditing){O.call(this,this.getRawText());}this._super(T);},onTextEditComplete:function L(U,T){if(U){this.parent.textEdited(this.text,U,T);this.updateScrollbars();}else{O.call(this,this.v);}if(!this.text){this.parent.updateOverlay();}},unrender:function Q(T){this.clearCache();this.isEditing=false;this._super(T);},setupScrollNodes:function J(){var T=this.getFormats();if(!T.overflow||T.overflow==="auto"){this.scrollNode=this.valueTextNode;}},handleRotatedText:function E(){if(this.isTextFieldRotated()){this.valueNode.style.cssText="";window.setTimeout(function(){if(this.hasRendered){this.valueNode.style.cssText=this.valueNodeCssText;var Y="px",U=this.getFormats(),T=this.valueNode,a=T.style,W=U.fx&&U.fx.rt,Z=T.offsetWidth,V=T.offsetHeight,X=P.call(this);switch(W){case 1:a.left=Z+Y;break;case 3:a.top=V-1+Y;break;}a.height=Z+Y;a.width=V-X+Y;}}.bind(this),0);}},onAppStateChange:function M(T){var U=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION===T.value;this.isEditing=!U;this.editOnClick=!U;},onisEditingChange:function D(T){this._super(T);this.parent.set("useRichTooltip",!T.value);},canShowContentTooltip:function K(V,U){var T=A.eventTarget(U,V);return T===this.valueNode||T===this.valueTextNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.array","mstrmojo._HasLayout","mstrmojo.ui.ColumnContainer");var E=mstrmojo.dom,G=mstrmojo.hash,C=mstrmojo.array;mstrmojo.ui.ColumnWalk=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.ColumnWalk",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnWalk cf {@cssClass}" mstrAttach:click></div>',layoutConfig:{h:{containerNode:"100%"},xt:true},currentColumn:-1,addNextColumn:function B(K){var J=this.children||[],L=J.length,I=J[L-1];var M=this.addChildren([G.copy(K,{scriptClass:"mstrmojo.ui.ColumnContainer",idx:L})])[0];if(I){I.set("next",M);}},onclick:function A(I){var K=I.getTarget();if(K){var J=this.children;C.forEach(J,function(M,L){if(E.contains(M.domNode,K,true,M.domNode)){this.set("currentColumn",L);}},this);}},oncurrentColumnChange:function D(I){var K=this.children,M=K[I.valueWas],J=K[this.currentColumn],L="active";if(M){M.set(L,false);}J.set(L,true);},removeTrailingContainer:function H(K){var J=this,I=this.children;if(!I||K>=I.length-1){return ;}C.forEach(I.slice(K+1),function(L){J.removeAndDestroyChild(L);});if(K>=0){I[K].set("next",null);}},insertAndRemoveTrailing:function F(J,I){this.removeTrailingContainer(J);this.addNextColumn(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.LayoutBox","mstrmojo._HasBuilder");mstrmojo.ui.BuilderBox=mstrmojo.declare(mstrmojo.ui.LayoutBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ui.BuilderBox"});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.PanelContents");mstrmojo.vi.ui.BoxPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.BoxPanel",markupString:'<div id="{@id}" class="mstrmojo-VIBoxPanel {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIBoxPanel-control"></div><div class="mstrmojo-VIBoxPanel-content"></div><div class="mstrmojo-VIBoxPanel-mask"></div></div>',markupSlots:{controlNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{controlNode:"auto",containerNode:"100%"},w:{controlNode:"100%",containerNode:"100%"},xt:true},controlNode:null,containerNode:null,maskNode:null,parent:null,slot:"containerNode",children:[{scriptClass:"mstrmojo.vi.ui.PanelContents",slot:"containerNode",alias:"contents"}],_set_children:function E(N,L,K){var M=this.children;if(L!==M&&M){L=L.concat(M.filter(function(O){return O.slot==="controlNode";}));}return this._super(N,L,K);},doLayout:function A(){if(!this.visible){return ;}this._super();},addPopupHandlers:function B(K,M,L){K.addPopupHandlers(this.id,M,L);},setOpenStatus:function I(L,K,N,M){if(!L){this.parent.removePanel(this,N,K,M);mstrApp.rootCtrl.generateToolbar();}},updateToolbar:function J(K){K.hostId=this.id;K.isHostedWithin=false;return K;},addRenameTargetMenuItem:function C(K){K.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.toolbar.lblTitle.set("isEditing",true);}.bind(this));},addHelpTopicMenuItem:function G(K,M,L){if(L){K.addMenuItem(M,"help",function(){mstrApp.showHelpTopic(L);});}},addCloseMenuItem:function F(K,L){K.addMenuItem(mstrmojo.desc(2177,"Close"),"",function(){var M=L.getDataService().newUpdateWithoutCmd();this.setOpenStatus(false,false,M);M.submit();}.bind(this));},getOpenStatus:function H(){return true;},setupScrollNodes:function D(){this.scrollNode=this.containerNode;}});mstrmojo.vi.ui.BoxPanel.PANEL_TYPES={DROP_ZONES:"vi_drz",PROPS:"vi_prp",FILTERS:"vi_flt"};}());(function(){mstrmojo.requiresCls("mstrmojo.TextArea","mstrmojo.ui._HasScroller");function E(){var L=this.inputNode,F=L.style,J=this.scrollNode,G=J.scrollTop,M=parseInt(F.height),N=L.scrollHeight,I=M<N,H=M>J.clientHeight;if(I){F.height=N+"px";}else{if(H){var K=M;while(K>0&&L.offsetHeight===L.scrollHeight){F.height=--K+"px";}F.height=K+1+"px";}}if(I||H){this.updateScrollbars();}if(I){J.scrollTop=G+(N-M);}}mstrmojo.ui.ScrollableTextArea=mstrmojo.declare(mstrmojo.TextArea,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableTextArea",markupSlots:{scrollNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;}},cssDisplay:"block",init:function D(F){this.markupString='<div class="mstrmojo-ui-TextArea {@cssClass}"><div class="ta-sc">'+this.markupString+"</div></div>";this._super(F);},postBuildRendering:function A(){this._super();var G=this.inputNode,F=G.style;F.height=G.scrollHeight+"px";},onRender:function C(){this._super();E.call(this);},prevalueChange:function B(){if(!this.hasRendered){return ;}E.call(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo.Label","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ui._HasUITheme","mstrmojo.Button","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.tooltip","mstrmojo.ui.editors.ErrorDialogContent");var h=mstrmojo.func.composite,M=mstrmojo.dom,Z=mstrmojo.Button.newWebButton,C=mstrmojo.css,Y=mstrmojo.all,N=mstrmojo.hash,W=mstrmojo.array;function V(p){if(!this.modal){return ;}var q=window.mstrApp;if(q&&q.modalEditorChange){q.modalEditorChange(this.id,p);}}mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,themeClassName:"mojo-theme-light",useRichTooltip:true,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mouseup,mousedown,click,contextmenu>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function X(){return this.domNode.firstChild;},titlebarNode:function l(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function R(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},helpNode:function m(){return this.showTitle?this.domNode.firstChild.firstChild.children[1]:null;},closeNode:function E(){return this.showTitle?this.domNode.firstChild.firstChild.lastChild:null;},containerNode:function S(){return this.domNode.firstChild.childNodes[2];},buttonNode:function I(){return this.domNode.firstChild.childNodes[3];},curtainNode:function n(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var p=this.zIndex;this.editorNode.style.zIndex=p;this.curtainNode.style.zIndex=p-1;},onvisibleChange:function(t){if(t){return ;}var r=this.visible,q="closeEffect",p="none";if(r){q="openEffect";p="block";}if(this[q]){this.playEffect(q);}else{this.editorNode.style.display=p;if(this.modal){this.curtainNode.style.display=p;}}},onhelpChange:function d(){if(this.showTitle){var q=this.help,p=this.helpNode;if(!q){p.style.display="none";}else{p.style.display="block";}}},onleftChange:function F(){this.editorNode.style.left=this.left||"";},ontopChange:function H(){this.editorNode.style.top=this.top||"";}},open:function Q(q,p){this._super(q,p);V.call(this,true);},close:function f(p){this._super(p);V.call(this,false);},unrender:function B(p){this._super(p);V.call(this,false);},destroy:function g(p){this._super(p);V.call(this,false);},preBuildRendering:function A(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;V.call(this,true);}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function k(){return this.titlebarNode;},getMovingTarget:function U(){return this.editorNode;},onPreClose:function G(){this.hideTooltip();return true;},premousedown:function P(p){var q=p.getTarget();if(q===this.closeNode||q===this.helpNode){C.toggleClass(q,"active",true);}},premouseup:function O(p){var q=p.getTarget();if(q===this.closeNode||q===this.helpNode){C.toggleClass(q,"active",false);}if(p.getTarget()===this.closeNode&&this.onPreClose()){this.close();}},onclick:function c(q){if(q.getTarget()===this.helpNode){if(mstrApp.showHelpTopic){mstrApp.showHelpTopic(this.help);}else{var p=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm#");window.open(p+(this.help||""),"_blank");return false;}}},_set_visible:function b(w,r){var q=(this[w]!==r);if(q){this[w]=r;var u=this._close_handler;if(r){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var t=this;u=this._close_handler=u||function(v){var x=M.eventTarget(self,v);if(x&&x.parentNode&&!M.contains(t.editorNode,x,true,document.body)){t.close();}};M.attachEvent(document.body,"mousedown",u);}}else{var p=this._curtain_handler;if(p){M.detachEvent(window,"resize",p);}if(u){M.detachEvent(document.body,"mousedown",u);}}}return q;},showTooltip:function o(w,v){var u=this,q=M.findAncestorByAttr(M.eventTarget(v,w),"tooltip",true,this.domNode),r=q&&q.value;if(!u.hasOpenTooltip&&r){var p=M.position(q.node);u.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:r,top:Math.max(p.y+40,0),left:Math.max(p.x+4,0),posType:mstrmojo.tooltip.POS_TOPCENTER};this._super(w,v);}}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(p){p=Math.round(p);return["rgb(",p,",",p,",",p,")"].join("");}}},preStart:function(){var q=this.target,p=this.widget;p.editorNode.style.display="block";if(!p.modal){return false;}q.style.display="block";C.setOpacity(q,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var p=this.widget;p.editorNode.style.display="none";return !!p.modal;}};function D(p){return function(){Y[p].destroy();};}function J(q,z,AA,AB){var p=z.id||"mojoAlertx9",v,x=z.buttons;W.forEach(x,function(AD){var AC=AD.onclick;AD.onclick=function(AE){var AF=Y[p];if(AC&&AC.call(AD,AE)===false){return ;}AF.destroy();AF=null;};});try{Y[p].destroy();}catch(w){}var r=z.cssClass,t=[];if(r){t.push(r);delete z.cssClass;}if(AB){t.push(AB);}t.push("mstrmojo-alert");v={scriptClass:"mstrmojo.Editor",id:p,width:"475px",zIndex:1000,title:AA||mstrmojo.desc(11812,"Notification"),cssClass:t.join(" "),children:[{scriptClass:"mstrmojo.Label",cssClass:"alert-content",text:q,allowHTML:z.allowHTML}],visible:true};var u=new mstrmojo.Editor(N.copy(z,v));u.render();return u;}if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.notify=function L(q,x,r){r=r||{};var z=r.forceClose,w=r.callback||mstrmojo.emptyFn,v=N.copy(x||{},{buttons:z?[mstrmojo.Button.newActionButton((r.buttonText||mstrmojo.desc(8607,"Dismiss")),w)]:null,showTitle:false,modal:false,top:"42px"}),t=r.duration||6000;var u=J(q,v,"",z?"ed-notify":"ed-toast"),p=u.id;if(!z){window.setTimeout(h([w,D(p)]),t);}else{window.setTimeout(function(){if(Y[p]){Y[p].editorNode.style.opacity=0.75;}},6000);}return u;};mstrmojo.confirm=function e(v,q,u){q=q||{};var p=q.confirmBtn||{},t=q.cancelBtn||{},r=[Z(p.t||mstrmojo.desc(219,"Yes"),p.fn,true),Z(t.t||mstrmojo.desc(218,"No"),t.fn)];return J(v,N.copy(u||{},{buttons:r,onPreClose:function(){if(t&&t.fn){t.fn();}return true;}}));};mstrmojo.warn=function K(r,p,q){q=q||{};q.cssClass=(q.cssClass||"")+" mstrmojo-warning";mstrmojo.confirm(r,p,q);};mstrmojo.alert=function a(v,r,u,w,p,t){var q={title:u,zIndex:w,cssClass:p,buttons:[Z(mstrmojo.desc(1442,"OK"),r,true)],onPreClose:function(){if(r){r();}return true;}};N.forEach(q,function(z,x){if(!z){delete q[x];}});return J(v,N.copy(t,q));};mstrmojo.error=function T(u,p,t){var q=u||{};var r=mstrmojo.desc(96,"Error");if(t){r=(t.title)?t.title:mstrmojo.desc(96,"Error");}J("",N.copy(t||{},{buttons:[Z(mstrmojo.desc(1442,"OK"),p,true)],children:[{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",shortDesc:q.shortDesc,longDesc:q.longDesc}]}),r);};}mstrmojo.Editor.ButtonConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.DocSection","mstrmojo._HasLayout","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui.rw._SavesChildPositions");mstrmojo.vi.ui.rw.DocSection=mstrmojo.declare(mstrmojo.DocSection,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocSection",layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true},alias:"docSection"});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.XtabZone","mstrmojo.css","mstrmojo.hash","mstrmojo.dom");var b=0,A=1,AA=2,J=3,l={1:"_BL",2:"_TR",3:"_TL"},AI=1,v=2,o={position:"absolute",overflow:"hidden",width:"auto"},r={position:"absolute",top:0,left:0},E=mstrmojo.css,d=mstrmojo.hash,h=mstrmojo.dom;function L(AM,AL,AJ,AK){if(AK){AM.replaceChild(AL,AM.tBodies[AJ]);}else{AM.appendChild(AL);}}function I(AJ){AJ.offsetCellNode=null;AJ.fstValueCellValidation=null;}function S(){var AN={x:0,y:0};if(this.lockHeadersCase&&!this.offsetCellNode&&!this.fstValueCellValidation){var AO=this.titlesCP.getSpanDimension(),AJ=AO.nRow,AM=AO.nCol,AV=this.scrollboxNode.firstChild.firstChild,AS=AV&&AV.rows[AJ];if(AJ===0||AM===0){this.lockHeadersCase=b;return null;}if(!AV.rows.length){return null;}if(!AS){this.fstValueCellValidation|=AI;this.lockHeadersCase&=AI;AS=AV.rows[0];}var AU=AS&&AS.cells,AR=(AU&&AU.length)||0,AL,AP,AQ;for(AP=AQ=0;AP<AR&&AQ<AM;AP++){AQ+=AU[AP].colSpan||1;}AL=AU&&AU[AP];if(!AL){this.fstValueCellValidation|=v;this.lockHeadersCase&=v;this.offsetCellNode=AU&&AU[0];}else{this.offsetCellNode=AL;}}if(this.lockHeadersCase){var AT=h.position(this.offsetCellNode),AK=h.position(this.scrollboxNode.firstChild);AN.x=AT.x-AK.x;AN.y=AT.y-AK.y;}return AN;}function O(AL,AJ,AK,AP){if(this.parent.isAutoTableLayout()&&this.isRendered()){if(!this.fragment){this.fragment=document.createDocumentFragment();}if(AP){var AM=AL.cloneNode(true);if(!this.renderedPages){q.call(this);}if(AK&&this.renderedPages[AJ]){var AO=this.renderedPages[AJ],AN=this.getTableNode();if(AO.parentNode===AN){AN.replaceChild(AM,AO);}else{this.fragment.replaceChild(AM,AO);}}else{this.fragment.appendChild(AM);}this.renderedPages[AJ]=AM;}}}function AD(AK,AJ){for(var AL in AK){if(AK[AL]!=AJ[AL]){return false;}}return true;}function t(){var AJ=this.fragment;if(AJ&&AJ.childNodes.length>0&&this.isRendered()){var AK=this.getTableNode();AK.appendChild(AJ);}}function p(){var AK=this.xtabClonedNodes,AO=this.cellHoverMgr,AM,AN,AJ,AL;if(!AO){return ;}for(AJ in AK){AM=AK[AJ];AL=AM.getID();AN=AM.isRendered();if(!this.zones[AL]&&AN){this.zones[AL]={tableNode:AM.getTableNode()};if(typeof (AO)!="string"){AO.addMgrElement(AL);}}}}function N(AK,AJ){var AL=this.parent,AM=AL&&AL.zone;if(AJ&&AM&&AM.addCoverTable){AM.addCoverTable(AK,AJ);}}function m(AK,AJ,AL){AK.width=((AL&&AL.width<AJ.right)?AL.width:AJ.right)+"px";AK.height=((AL&&AL.height<AJ.bottom)?AL.height:AJ.bottom)+"px";}function q(){this.renderedPages={};var AO=this.getTableNode(),AK=AO.tBodies,AL=this.fragment,AQ=AL&&AL.children,AN=this.renderedPages,AJ,AM,AP=function(AR){var AS=AR.getAttribute("n")||0;AN[AS]=AR;};for(AM=0,AJ=AK.length;AM<AJ;++AM){AP(AK[AM]);}for(AM=0,AJ=(AQ&&AQ.length)||0;AM<AJ;++AM){AP(AQ[AM]);}}function K(AN,AJ,AK){var AL=AJ&&AJ.rows[AN.row],AM=AL&&AL.cells[AN.cell];if(AM&&AK!==AM){AL.replaceChild(AK.cloneNode(true),AM);}}function R(AK,AJ){if(this.isRendered()){if(!this.renderedPages){q.call(this);}K(AK,this.renderedPages[AK.page||0],AJ);}}mstrmojo.XtabZoneWithClonedCover=mstrmojo.declare(mstrmojo.XtabZone,null,{scriptClass:"mstrmojo.XtabZoneWithClonedCover",isAutoTBLayout:null,addCoverTable:function M(AJ,AK){if(!this.coverTableNodes){this.coverTableNodes={};}this.coverTableNodes[l[AJ]]=AK;},getClonedNodesByPositions:function Q(AR){var AQ=this.coverTableNodes,AK=AQ&&AQ[l[J]],AT=AQ&&AQ[l[AA]],AN=AQ&&AQ[l[A]],AM=[AK,AT,AN],AJ,AU,AP=[],AL=function(AW,AY){var AV=AW&&AW.tBodies[AY.page||0],AX=AV&&AV.rows[AY.row];return AX&&AX.cells[AY.cell];};for(var AO in AR){AJ=AR[AO];if(AJ.page&&AN){AU=AL(AN,AJ);AU&&AP.push(AU);}else{for(var AS in AM){if(AM[AS]){AU=AL(AM[AS],AJ);AU&&AP.push(AU);}}}}return AP;},setHilites:function T(AT,AN){var AO=AN.getAttribute("ei"),AS=this.eiMap[AO]||(this.posMap[AO]&&[this.posMap[AO]])||[],AQ=this.hiliteCellsMap,AM=this.parent,AK=this.getNodesByPositions(AS),AJ=function(AU){E.addClass(AU,"sc_"+AM.k);};if(!AQ[AT]){AQ[AT]={pos:[],nodes:[]};}if(!AK.length){AJ(AN);AQ[AT].nodes.push(AN);}else{if(AS.length!==0){var AL=this.getClonedNodesByPositions(AS),AR=AQ[AT].pos;AK=AL.concat(AK);for(var AP in AK){AJ(AK[AP]);}AQ[AT].pos=AR.concat(AS);}}},clearHilites:function C(AK){var AN=this.hiliteCellsMap[AK],AL=AN&&AN.nodes,AO=(AL&&AL.length===0&&AN.pos)||[],AM=this.parent;if(AO.length!==0){AL=this.getNodesByPositions(AO);AL=AL.concat(this.getClonedNodesByPositions(AO));}for(var AJ in AL){E.removeClass(AL[AJ],"sc_"+AM.k);}this.hiliteCellsMap[AK]={nodes:[],pos:[]};},isAutoTableLayout:function AB(){if(this.isAutoTBLayout===null&&this.tableNode){this.isAutoTBLayout=(this.tableNode.style.tableLayout!=="fixed");}return this.isAutoTBLayout;},unrender:function B(AJ){this.coverTableNodes={};this.isAutoTBLayout=null;this._super(AJ);}});mstrmojo.XtabClonedNode=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabClonedNode",domNode:null,left:0,top:0,lockType:b,scrollDM:mstrmojo.emptyFn,refreshNode:mstrmojo.emptyFn,createDomNode:function a(){var AJ=this._getClonedFragment();this.containerNode.appendChild(AJ);N.call(this,this.lockType,this.getTableNode());},getID:function U(){return this.id;},getTableSize:function Y(){var AK=this.parent.zone.tableNode,AJ=this.parent.hasCustomScrollbar?"offset":"client";return{width:AK[AJ+"Width"],height:AK[AJ+"Height"]};},isRendered:function H(){return !!this.domNode;},getTableNode:function AG(){return this.isRendered()?this.domNode.firstChild.firstChild:null;},destroy:function w(AJ){if(this.isRendered()){this.unrender(true);}this._super(AJ);},unrender:function B(AJ){this.domNode=null;this.lastClipRect=null;this._super&&this._super(AJ);},insertPage:function AH(AL,AJ,AK,AM){if(this.isRendered()){L(this.getTableNode(),AL.cloneNode(true),AJ,AK);}},_getClipStr:function Z(AJ){this.lastClipRect=AJ;return"rect("+AJ.top+"px, "+AJ.right+"px, "+AJ.bottom+"px, "+AJ.left+"px)";},adjustClip:function c(AL){var AJ=this._getClipRect&&this._getClipRect(AL);if(this.isRendered()){if(this.getTableNode().offsetHeight>this.domNode.offsetHeight){this.domNode.style.height=this.getTableNode().offsetHeight+"px";}if(AJ&&!(this.lastClipRect&&AD(AJ,this.lastClipRect))){this.domNode.style.clip=this._getClipStr(AJ);var AK={};m(AK,AJ,this.getTableSize());d.copy(AK,this.curtainNode.style);}}this.offset=AL;}});mstrmojo.XtabClonedRowHeader=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedRowHeader",lockType:A,interactiveCellsArray:[],interactivePosArray:[],dicGroupKey:[],init:function AE(AJ){this._super(AJ);if((this.lockHeadersCase&A)&&this.left){this.createDomNode();}},_getClipRect:function D(AK){var AJ=this.parent.hasCustomScrollbar?"offset":"client";AK=AK||this.offset;return{top:0,right:AK.x||0,bottom:this.toCloneNode[AJ+"Height"],left:0};},_clearLocalData:function G(){this.interactiveCellsArray=[];this.interactivePosArray=[];this.dicGroupKey=[];},_getClonedFragment:function X(){var AJ=document.createDocumentFragment(),AN=this.toCloneNode.cloneNode(true),AM=document.createElement("div"),AL=d.clone(o),AO=d.clone(r),AK=this._getClipRect();AL.clip=this._getClipStr(AK);AL.zIndex=2;if(this.parent.zone&&this.parent.zone.autoFitWindow){AL.width="100%";}AN.id=this.getID();d.copy(AL,AN.style);d.copy({top:-this.top+"px"},AN.firstChild.style);this.domNode=AN;m(AO,AK,this.getTableSize());AO.zIndex=1;d.copy(AO,AM.style);this.curtainNode=AM;AJ.appendChild(AN);AJ.appendChild(AM);return AJ;},scrollDM:function f(AK,AP,AR){var AL=this.parent.shouldClipLockableXtab,AM;if(this.lockHeadersCase&A){if(this.left!==AK&&!this.isRendered()){this.top=AP;this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";var AO=this;setTimeout(function(){AO._updateDICGroup();},10);}else{if(this.isRendered()){var AQ=this.domNode.firstChild,AJ=AQ.style;AJ.top=-AP+"px";this.top=AP;if(AL){if(AJ.position!=="absolute"){AJ.position="absolute";AJ.width="100%";}if(this.lockHeadersCase&AA){AM={top:this.offset.y+AP,right:this.offset.x,bottom:AQ.offsetHeight,left:0};AJ.clip=this._getClipStr(AM);}}}}if(AL&&this.isRendered()){var AT=this.getTableNode();AM={top:0,right:Math.max(AT.offsetWidth,AR.offsetWidth),bottom:Math.max(AT.offsetHeight,AR.offsetHeight),left:this.offset.x+AK};var AN=AR.style,AS=AR.parentNode.style;if(AN.position!=="absolute"){if(isNaN(parseInt(AS.width,10))){AS.width=AR.parentNode.offsetWidth+"px";}if(isNaN(parseInt(AS.height,10))){AS.height=AR.parentNode.offsetHeight+"px";}AN.position="absolute";AN.width="100%";if(isNaN(parseInt(AS.width,10))){AS.width=AM.right+"px";}}AN.clip=this._getClipStr(AM);}}},_updateDICGroup:function k(){var AJ=this.parent;if(this.interactivePosArray.length&&this.interactiveCellsArray.length){AJ.destroyDICGroup(this.dicGroupKey);AJ.configureCellsAction(this.interactiveCellsArray,0,this.interactivePosArray,true);}this._clearLocalData();},addTempDICInfo:function AC(AJ,AK){if(!this.isRendered()){this.interactiveCellsArray.push(AJ);this.interactivePosArray.push(AK);}},addGroupKey:function AF(AJ){if(!this.isRendered()){this.dicGroupKey.push(AJ);}},onCellUpdated:function u(AO,AL){if(this.isRendered()){var AJ=this.getTableNode(),AK=AJ&&AJ.tBodies[AO.page||0],AM=AK&&AK.rows[AO.row],AN=AM&&AM.cells[AO.cell];if(AN&&AL!==AN){AM.replaceChild(AL.cloneNode(true),AN);}}},unrender:function B(AJ){this._clearLocalData();this._super&&this._super(AJ);}});mstrmojo.XtabClonedColHeader=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedColHeader",lockType:AA,init:function AE(AJ){this._super(AJ);if(this.lockHeadersCase&AA){this.createDomNode();}},_getClipRect:function D(AK){var AJ=this.parent.hasCustomScrollbar?"offset":"client";AK=AK||this.offset;return{top:0,right:this.toCloneNode[AJ+"Width"],bottom:AK.y||0,left:0};},_getClonedFragment:function X(){var AJ=document.createDocumentFragment(),AN=this.toCloneNode.cloneNode(true),AM=document.createElement("div"),AL=d.clone(o),AO=d.clone(r),AK=this._getClipRect();AL.clip=this._getClipStr(AK);AL.zIndex=4;if(this.parent.zone&&this.parent.zone.autoFitWindow){AL.width="100%";}AN.id=this.getID();d.copy(AL,AN.style);d.copy({left:-this.left+"px"},AN.firstChild.style);this.domNode=AN;m(AO,AK,this.getTableSize());AO.zIndex=3;d.copy(AO,AM.style);this.curtainNode=AM;AJ.appendChild(AN);AJ.appendChild(AM);return AJ;},scrollDM:function f(AK,AP,AR){var AL=this.parent.shouldClipLockableXtab,AM;if(this.lockHeadersCase&AA){var AO=!!this.parent.hasLeftScrollNode,AT=this.getTableNode();var AQ=this.domNode.firstChild,AJ=AQ.style;this.domNode.style.width="100%";this.domNode.style.height="100%";if(this.left!==AK||AO){AJ.left=-AK+"px";this.left=AK;if(AL){if(AJ.position!=="absolute"){AJ.position="absolute";AJ.width="100%";}if(this.lockHeadersCase&A){AM=this._getClipRect();AM.left=AK+this.offset.x;AM.right=Math.max(AQ.offsetWidth,AT.offsetWidth);AJ.clip=this._getClipStr(AM);}}}if(AL){AM={top:this.offset.y+AR.parentElement.scrollTop,right:Math.max(AT.offsetWidth,AR.offsetWidth),bottom:Math.max(AT.offsetHeight,AR.offsetHeight),left:0};if(this.lockHeadersCase&A&&AO){AM.left=this.offset.x+AK;}var AN=AR.style,AS=AR.parentNode.style;if(AN.position!=="absolute"){if(isNaN(parseInt(AS.width,10))){AS.width=AT.offsetWidth+"px";}if(isNaN(parseInt(AS.height,10))){AS.height=AR.parentNode.offsetHeight+"px";}AN.position="absolute";AN.width="100%";if(isNaN(parseInt(AS.width,10))){AS.width=AT.offsetWidth+"px";}}AN.clip=this._getClipStr(AM);}}},insertPage:O,refreshNode:t,onCellUpdated:R,unrender:function B(AJ){this._super(AJ);this.fragment=null;this.renderedPages=null;}});mstrmojo.XtabClonedTitle=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedTitle",_getClipRect:function D(AJ){AJ=AJ||this.offset;return{top:0,right:AJ.x||0,bottom:AJ.y||0,left:0};},init:function AE(AJ){this._super(AJ);if(this.lockHeadersCase===J&&this.left){this.createDomNode();}},_getClonedFragment:function X(){var AJ=document.createDocumentFragment(),AN=this.toCloneNode.cloneNode(true),AM=document.createElement("div"),AL=d.clone(o),AO=d.copy(r),AK=this._getClipRect();AL.clip=this._getClipStr(AK);AL.zIndex=6;if(this.parent.zone&&this.parent.zone.autoFitWindow){AL.width="100%";}d.copy(AL,AN.style);AN.firstChild.style.left=0;AN.id=this.getID();this.domNode=AN;m(AO,AK,this.getTableSize());AO.zIndex=5;d.copy(AO,AM.style);this.curtainNode=AM;AJ.appendChild(AN);AJ.appendChild(AM);return AJ;},scrollDM:function f(AM,AL,AK){if(this.lockHeadersCase===J&&AM&&!this.isRendered()){this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";this.parent.hasLeftScrollNode=true;}if(this.parent.shouldClipLockableXtab&&this.isRendered()){var AJ=this.domNode.firstChild.style;if(AJ.position!=="absolute"){AJ.position="absolute";AJ.width="100%";}AJ.clip=this._getClipStr(this._getClipRect());}},insertPage:O,refreshNode:t,onCellUpdated:R,unrender:function B(AJ){this._super(AJ);this.fragment=null;this.renderedPages=null;}});mstrmojo._IsLockableXtab={_mixinName:"mstrmojo._IsLockableXtab",initLock:function z(AR){var AN=S.call(this),AQ=this.scrollboxNode;if(this.lockHeadersCase&&AQ&&AN){var AP=document.createElement("div"),AJ=d.copy(AR,{containerNode:AP,toCloneNode:AQ,offset:AN,lockHeadersCase:this.lockHeadersCase,parent:this});if(!this.xtabClonedNodes){this.xtabClonedNodes=[];}if(this.lockHeadersCase&A){if(!this.clonedRowHeader){this.clonedRowHeader=this.addDisposable(new mstrmojo.XtabClonedRowHeader(AJ));this.xtabClonedNodes.push(this.clonedRowHeader);}}if(this.lockHeadersCase&AA){if(!this.clonedColHeader){this.clonedColHeader=this.addDisposable(new mstrmojo.XtabClonedColHeader(AJ));this.xtabClonedNodes.push(this.clonedColHeader);}}if(this.lockHeadersCase===J){if(!this.clonedTitle){var AL=this.clonedColHeader,AO=AL.domNode,AK=AL.fragment;AJ.toCloneNode=AO||AJ.toCloneNode;AJ.fragment=AK&&AK.cloneNode();this.clonedTitle=this.addDisposable(new mstrmojo.XtabClonedTitle(AJ));this.xtabClonedNodes.push(this.clonedTitle);}}var AM=this.hasCustomScrollbar?"offset":"client",AS={top:0,left:0,position:"absolute",overflow:"hidden",width:AQ[AM+"Width"]+"px",height:AQ[AM+"Height"]+"px"};d.copy(AS,AP.style);this.tableContainerNode.appendChild(AP);this.lockFragment=AP;p.call(this);}},getColClonedZone:function F(){return this.clonedColHeader&&this.clonedColHeader.domNode.firstChild;},createZone:function n(AJ){return new mstrmojo.XtabZoneWithClonedCover(AJ||{});},getStickedTableNodes:function W(){var AK=this.xtabClonedNodes,AL=[];if(AK instanceof Array){for(var AJ in AK){var AM=AK[AJ];if(AM.isRendered()){AL.push(AM.getTableNode());}}}return AL;},_adjustClipSize:function g(){if(this.lockHeadersCase){var AK=this.xtabClonedNodes;if(AK&&AK.length){var AL=S.call(this);this.lockFragment.style.width=this.scrollboxNode.clientWidth+"px";this.lockFragment.style.height=this.scrollboxNode.clientHeight+"px";for(var AJ in AK){AK[AJ].adjustClip(AL);}}}},_refreshClonedNodes:function V(){var AM=this.xtabClonedNodes,AS=this.scrollboxNode.firstChild.firstChild,AJ=this.titlesCP.getSpanDimension().nRow,AR=AS&&(AS.rows[AJ]||AS.rows[0]),AQ=AR&&AR.cells,AK=AQ&&AQ.length,AN=[],AP=!this.lastCellsRBOffsetLeft,AO;for(AO=0;AO<AK;++AO){var AL=AQ[AO].offsetWidth;AN.push(AL);if(!AP){AP=(this.lastCellsRBOffsetLeft[AO]!=AL);}}this.lastCellsRBOffsetLeft=AN;if(AP){for(AO in AM){AM[AO].refreshNode();}this._adjustClipSize();this.alignLockNodes(this.scrollboxLeft,this.scrollboxTop);}},alignLockNodes:function x(AM,AL){var AK=this.xtabClonedNodes;if(AK&&AK.length){for(var AJ in AK){AK[AJ].scrollDM(AM,AL,this.scrollboxNode.firstChild);}p.call(this);}},isAutoTableLayout:function AB(){return this.zone.isAutoTableLayout();},onPageRendered:function P(AM,AJ,AK,AO){this._super&&this._super(AM,AJ,AK,AO);if(AK&&AJ===0){I(this);}var AL=this.xtabClonedNodes;if(AL&&AL.length){for(var AN in AL){AL[AN].insertPage(AM,AJ,AK,AO);}}},gridPagesRendered:function e(){this._super&&this._super();if(!this.lockHeadersCase){return ;}if(!this.xtabClonedNodes){this.initLock();}else{if(this.isAutoTableLayout()){this._refreshClonedNodes();}}},onCellUpdated:function u(AJ,AM){var AN=this.zone,AO=AN.posMap[AJ._ei],AK=AN.tableNode.tBodies[AO.page||0],AL=this.xtabClonedNodes;K(AO,AK,AM);for(idx in AL){AL[idx].onCellUpdated(AO,AM);}if(this.isAutoTableLayout()){this._refreshClonedNodes();}},unrender:function B(AL){var AK=this.xtabClonedNodes,AJ;if(AK&&AK.length){for(AJ in AK){AK[AJ].unrender(true);}}this.zones=null;I(this);this.lockFragment=null;this.xtabClonedNodes=null;this.clonedColHeader=null;this.clonedRowHeader=null;this.clonedTitle=null;this.lastCellsRBOffsetLeft=null;this._super(AL);}};})();(function(){mstrmojo.requiresCls("mstrmojo.LegacySuggestionList","mstrmojo.ui._HasScroller");var C=mstrmojo.dom;mstrmojo.ui.ScrollableSuggestionList=mstrmojo.declare(mstrmojo.LegacySuggestionList,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-scrollable-suggestlist {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function B(){return this.domNode.firstChild.firstChild;},scrollboxNode:function E(){return this.domNode.firstChild;},scrollNode:function H(){return this.domNode.firstChild;}},onclick:function A(I){var J=this.getItemFromTarget(I.getTarget());if(J){this._super(I);}},onitemsChange:function D(){var I=this;window.setTimeout(function(){I.hideTooltip();I.updateScrollbars();},0);},updateScrollbars:function F(){this._super();var K=this,M=K.scrollNode,I=M.clientWidth,L=K.itemsContainerNode,J=L.clientWidth;L.style.width="auto";window.setTimeout(function(){if(I>J){L.style.width=J+(I-J)+"px";}},10);},useRichTooltip:true,getItemTooltip:function(L,M){var J=C.position(M),K=M.ttp;var I={areaId:L._renderIdx+"text",cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:K,top:J.y,left:J.x+J.w+6,enableHover:false};return I;},showTooltip:function G(I,L){var K=this.targetEl,J=this.targetItem;if(K&&K.ttp){this.richTooltip=this.getItemTooltip(J,K);if(this.richTooltip){this._super(I,L);}}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.requiresCls("mstrmojo.ui.CheckList");mstrmojo.requiresDescs(2121,2122,2125,2127,2123,2124,2126,2128,2129,2130);var D=mstrmojo.desc,C=mstrmojo.array;mstrmojo.express.ui.SubtotalsWidget=mstrmojo.declare(mstrmojo.ui.CheckList,null,{scriptClass:"mstrmojo.express.ui.SubtotalsWidget",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:true,init:function B(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-subtotals");},_set_selectedItems:function(H,F){var E=[],G=this.prevSelection={};C.forEach((F||[]),function(I){E.push(I.t);});C.forEach(E,function(I){G[I]=true;});this.setSelectedItems(C.filter(this.items,function(I){return C.indexOf(E,I.v)>-1;}));},getSubtotalTypes:function A(){var G=this.items,H=this.selectedIndices,J=this.prevSelection,F=G.filter(function(L,K){return H[K]&&!J[L.v];}),I=G.filter(function(L,K){return !H[K]&&J[L.v];}),E=function(K){return K.v;};return[F.map(E),I.map(E)];},items:[{n:D(2121,"Total"),v:-10},{n:D(2122,"Average"),v:-12},{n:D(2125,"Maximum"),v:-14},{n:D(2127,"Minimum"),v:-13},{n:D(2123,"Count"),v:-11},{n:D(2124,"Geometric Mean"),v:-20},{n:D(2126,"Median"),v:-16},{n:D(2128,"Mode"),v:-17},{n:D(2129,"Product"),v:-15},{n:D(2130,"Standard Deviation"),v:-18},{n:D(2132,"Variance"),v:-19}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.CheckList","mstrmojo.css");var A="only";var E;var C;mstrmojo.vi.ui.rw.selectors.CheckList=mstrmojo.declare(mstrmojo.ui.CheckList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.CheckList",isShowOnly:true,init:function G(H){this._super(H);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-sel-CheckList");},getItemMarkup:function F(I,H){if(!E){E=this._super(I).replace("<span>{@en@n}</span>",'<span class="icon"></span><span class="text">{@en@n}</span>');C=this._super(I).replace("<span>{@en@n}</span>",'<span class="icon"></span><span class="'+A+'">'+mstrmojo.desc(11573,"only")+'</span><span class="text">{@en@n}</span>');}if(this.isShowOnly&&(!this.multiSelect||(H!==this.allIdx&&H!==this.noneIdx))){return C;}return E;},getItemProps:function D(K,H){var J=this._super(K,H);if(((this.isHoriz&&(this.orientation!=="v"))||(!this.isHoriz&&this.orientation==="h"))&&this.itemWidthMode===0){var L=this.items.length,I=100/L;if(H===L-1){I=100-((L-1)*I);}J.addStyle("width:"+I+"%");}return J;},onclick:function B(H){var J=H.getTarget(),I=this.getItemFromTarget(J);if(J.className===A){if(I){this.docSelector.handleActionInSyncPhase(function(){this.clearSelect();},this);this.select([I._renderIdx]);}}else{if(I){this.doItemSelect(I,H||{});}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList");var A;mstrmojo.vi.ui.rw.selectors.PageByButtonBar=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.PageByButtonBar",init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,["mstrmojo-vi-sel-LinkList","buttons"]);},multiSelect:false,getItemMarkup:function B(D){if(!A){A=this._super(D).replace(">{@en@n}<","><div>{@en@n}</div><");}return A;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo.color","mstrmojo.css","mstrmojo.array");var L=mstrmojo.css,K=mstrmojo.color,R=mstrmojo.models.FormatModel,E=R.ENUM_PROPERTY_NAMES,Q="transparent",A="#000000",M="#2f9ad3",D="#ffffff",O;function I(){return this.docSelector.style===mstrmojo.DocSelector.STYLES.LINK;}function G(T,V){if(I.call(this)){var S=T.style,U=this.stateCssText[V];S.background=U.bg;S.color=U.text;}}function F(){if(this.itemWidthMode===1){var S=Array.prototype.slice.call(this.itemsContainerNode.childNodes);if(S.length>0&&S.length<100){var V=mstrmojo.emptyFn;if(this.isHoriz){var U=S.map(function(W){return W.offsetWidth;}),T=U.reduce(mstrmojo.array.fnReduceNumber);if(T>0){V=function(Y,W){var X=U[W];Y.minWidth=X+"px";Y.width=((X/T)*100)+"%";};}}else{V=function(W){W.minWidth=W.width="auto";};}S.forEach(function(X,W){V(X.style,W);});}}}mstrmojo.vi.ui.rw.selectors.LinkList=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.LinkList",renderOnScroll:true,init:function H(S){this._super(S);L.addWidgetCssClass(this,"mstrmojo-vi-sel-LinkList");},listHooks:{select:function(S){G.call(this,S,"selected");},unselect:function(S){G.call(this,S,"base");}},getItemMarkup:function C(T,S){if(mstrmojo.string.isEmpty(T.n)){return this._super(T,S).replace("{@en@n}","<div>&nbsp;</div>");}if(!O){O=this._super(T,S).replace("{@en@n}","<div>{@en@n}</div>");}return O;},getItemProps:function P(W,S){var U=this._super(W,S);if(I.call(this)){var Y=this.stateCssText,V=U.sel?Y.selected:Y.base;U.addStyle("background:"+V.bg+";color:"+V.text);}if(((this.isHoriz&&(this.orientation!=="v"))||(!this.isHoriz&&this.orientation==="h"))&&this.itemWidthMode===0){var X=this.items.length,T=100/X;if(S===X-1){T=100-((X-1)*T);}U.addStyle("width:"+T+"%");}return U;},preBuildRendering:function B(){if(I.call(this)){var T=this.docSelector,S=T.getFormats(),W=this.getPropertyDefaultValue(E.SELECTOR_SELECTION_COLOR)||M,V=this.getPropertyDefaultValue(E.COLOR)||D,U=T.defn.ssc!==undefined?R.decodeValue(E.SELECTOR_SELECTION_COLOR,T.defn.ssc):W;this.stateCssText={base:{bg:S["background-color"]||Q,text:S.color||A},selected:{bg:U,text:K.encodeColor(U)===K.encodeColor(W)?V:K.getContrastingColor(U,"#ffffff","#000000")}};}return this._super();},postBuildRendering:function J(){if(!I.call(this)){L.addClass(this.domNode,"buttons");}F.call(this);return this._super();},onclick:function(S){var T=this.getItemFromTarget(S.getTarget());if(T){this.doItemSelect(T,S||{});}},getPropertyDefaultValue:function(T){var U=mstrApp.getThemeClassName(),S=null;switch(T){case E.SELECTOR_SELECTION_COLOR:S=U==="mojo-theme-light"?"#34ABEB":"#34ABEB";break;case E.COLOR:S=U==="mojo-theme-light"?"#444649":"#ffffff";break;}return S;},updateScrollbars:function N(){if(this.hasRendered&&this.orientation==="v"){this.scrollboxNode.style.height=this.height;}this._super();}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.rw.selectors.LinkList,{onorientationChange:function(){F.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo.css");var P=mstrmojo.color,C=mstrmojo.models.FormatModel,E=C.ENUM_PROPERTY_NAMES,H="transparent",A="#000000",D="#2f9ad3",J="#ffffff";function B(){return this.docSelector.style===mstrmojo.DocSelector.STYLES.LIST&&!this.docSelector.isInFilterPanel();}function G(R,T){if(B.call(this)){var Q=R.style,S=this.stateCssText[T];Q.background=S.bg;Q.color=S.text;}}mstrmojo.vi.ui.rw.selectors.ListBoxSelector=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.ListBoxSelector",init:function O(Q){this._super(Q);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-sel-ListBox");},getItemMarkup:function L(R,Q){if(mstrmojo.string.isEmpty(R.n)){return this._super(R,Q).replace("{@en@n}","&nbsp;");}return this._super(R,Q);},listHooks:{select:function(Q){G.call(this,Q,"selected");},unselect:function(Q){G.call(this,Q,"base");}},getItemProps:function I(T,Q){var R=this._super(T,Q);if(B.call(this)){var U=this.stateCssText,S=R.sel?U.selected:U.base;R.addStyle("background:"+S.bg+";color:"+S.text);}return R;},preBuildRendering:function K(){if(B.call(this)){var R=this.docSelector,Q=R.getFormats(),U=this.getPropertyDefaultValue(E.SELECTOR_SELECTION_COLOR)||D,T=this.getPropertyDefaultValue(E.COLOR)||J,S=R.defn.ssc!==undefined?C.decodeValue(E.SELECTOR_SELECTION_COLOR,R.defn.ssc):U;this.stateCssText={base:{bg:Q["background-color"]||H,text:Q.color||A},selected:{bg:S,text:P.encodeColor(S)===P.encodeColor(U)?T:P.getContrastingColor(S,"#ffffff","#000000")}};}return this._super();},getPropertyDefaultValue:function(R){var S=mstrApp.getThemeClassName(),Q=null;switch(R){case E.SELECTOR_SELECTION_COLOR:Q=S==="mojo-theme-light"?"#34ABEB":"#34ABEB";break;case E.COLOR:Q=S==="mojo-theme-light"?"#444649":"#ffffff";break;}return Q;},premousedown:function M(Q){if(mstrmojo.dom.shiftKey(Q.hWin,Q.e)){mstrmojo.dom.preventDefault(Q.hWin,Q.e);}},onclick:function N(R){var T=R.getTarget();var S=this.getItemFromTarget(T);if(S){var Q=S._renderIdx;if(this.multiSelect&&R.metaKey){var U=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(Q);if(U&&Q<this.items.length&&this.selectedIndices[Q+1]){Q++;}this.selectedIndex=Q;this.rangeSelected=false;}else{if(this.multiSelect&&R.shiftKey){this.rangeSelected=true;this.rangeSelect(Q);}else{this.singleSelect(Q);this.rangeSelected=false;}}}},updateScrollbars:function F(){if(this.hasRendered&&this.orientation==="v"){this.scrollboxNode.style.height=this.height;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._HasOwnAvatar","mstrmojo.dom","mstrmojo.css","mstrmojo.vi.enums.EnumDerivedElementType");var G=mstrmojo.dom,U=mstrmojo.css,P=mstrmojo.vi.enums.EnumDerivedElementType,X="top",M="bottom",V;function O(Z,Y){return Math.min(Math.max(Math.floor((Z-Y.y0)/Y.h),0),this.items.length-1);}function B(c,a){var Z=X,b=(Math.floor(c-a.y0)%a.h)/a.h,Y=O.call(this,c,a);if(Y===this.items.length-1){if(b>0.5||Math.floor((c-a.y0)/a.h)>Y){Z=M;}}else{if(b>0.5){if(Y<this.items.length-1){Y+=1;}}}return{edge:Z,idx:Y};}function R(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}function A(Y){return !Y.src.data.isScrollBar&&!isNaN(Y.src.data.index);}mstrmojo.vi.ui.GroupDEList=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.vi.ui.GroupDEList",draggable:true,avatarCssClass:"group-DE-drag-avatar",editOnDoubleClick:true,clickCount:0,timer:null,useRichTooltip:true,init:function Q(Y){this._super(Y);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIGroupDEList");},getItemMarkup:function F(Y){if(!V){V=this._super(Y).replace(">{@en@n}",'><div><div class="group-column"><div class="draggable-icon"></div><div class="name" mstrAttach:click>{@en@n}</div></div><div class="mstrmojo-group-list">{@prev}</div><div class="mstrmojo-group-delete" mstrAttach:click></div><div style="clear:both;float:none;"></div></div>');}return V;},onscroll:function S(Y){this.parent.renameDE.set("visible",false);this._super(Y);},onclick:function I(a){var c=a.getTarget(),d=G.findAncestorByAttr(c,"idx",true,this.domNode),Y,b=this,Z=b.parent;Z.renameDE.set("visible",false);if(d&&c.className&&c.className.indexOf("group-delete")>0){Y=parseInt(d.node.getAttribute("idx"),10);this.parent.model.deleted.push(this.items[Y]);this.items.splice(Y,1);this.parent.initExcludeList();this.parent.enableOkBtn();this.refresh();}if(d&&c.className&&c.className.indexOf("name")>=0){Y=parseInt(d.node.getAttribute("idx"),10);this.clickCount++;if(this.clickCount===1){this.singleSelect(Y);this.timer=window.setTimeout(function(){b.clickCount=0;if(d.node.className.indexOf("list")>0){b.parent.toggleEdit(true,false,b.items[Y]);}},400);}else{if(this.clickCount===2){window.clearTimeout(this.timer);this.clickCount=0;if(Y===this.selectedIndex){Z=b.parent;Z.renameDE.set("visible",true);Z.renameDE.set("text",this.selectedItem.n);Z.renameDE.domNode.style.left=(G.position(c).x-G.position(this.domNode.parentNode).x)+"px";Z.renameDE.domNode.style.top=(G.position(c).y-G.position(this.domNode.parentNode).y)+"px";}}}}},getItemProps:function W(a,Y){var Z=this._super(a,Y);Z.cls="mstrmojo-VIGroupDERow "+((a.t===P.RESIDUE)?"others":(a.t===P.CALCULATION)?"calculation":"list");Z.prev=a.prev;return Z;},deleteItem:mstrmojo.emptyFn,setupScrollNodes:function K(){this.scrollNode=this.scrollboxNode;},getDragData:function D(a){if(this._super){var Z=this._super(a);if(Z&&Z.isScrollBar===true){return Z;}}var b=a.src.node,f=this.id,e=G.findAncestorByAttr(b,"idx",true,this.domNode),c,Y;c=a.src.node=e?e.node:b;Y=parseInt(c.getAttribute("idx"),10);return{item:this.items[Y],index:Y,node:c,setAvatarClass:function d(g){var l=mstrmojo.all[f],h=l.avatar;if(h){var k=[l.avatarCssClass,"hasOwnAvatar",g];h.className=k.join(" ");}}};},createAvatar:function N(a,Z){var Y=null;if(A(Z)){Y=a.cloneNode(true);}return Y;},positionAvatar:function J(Z,Y){if(!this.avatar){return ;}Z.x=Y.src.data.left+10;this._super(Z,Y);},isDragValid:function C(Y){return A(Y)||this._super(Y)||false;},ondragstart:function T(Y){if(A(Y)){var a=Y.src.data,Z=a.node;a.y0=G.position(this.domNode).y;a.h=G.position(Z).h;a.left=G.position(Z).x;a.th=this.scrollNode.offsetHeight;a.sh=this.scrollNode.scrollHeight;this.items.splice(a.index,1);this.itemsContainerNode.removeChild(Z);}this._super(Y);},ondragmove:function L(Y){if(A(Y)){var b=Y.src.data,g=Y.last.y,k=b.tgtIdx,l=b.tgtEdge,e=b.th,m=b.sh,h=(g-b.y0)<0,d=(g-b.y0)>e,c,a,Z,f=this;if(h||d){if(k||l){if(k!==undefined){U.removeClass(this.itemsContainerNode.children[k],l);}delete b.tgtIdx;delete b.tgtEdge;}if(d){if(this.scrollNode.scrollTop<m&&!this.tmr){this.tmr=window.setInterval(function(){if(f.scrollNode.scrollTop+5>m){f.scrollNode.scrollTop=m;R.apply(this);}else{f.scrollNode.scrollTop+=5;}},200);}else{if(this.scrollNode.scrollTop>=m){R.apply(this);}}}if(h){if(this.scrollNode.scrollTop>0&&!this.tmr){this.tmr=window.setInterval(function(){if(f.scrollNode.scrollTop-5<0){f.scrollNode.scrollTop=0;R.apply(this);}else{f.scrollNode.scrollTop-=5;}},200);}else{if(this.scrollNode.scrollTop<=0){R.apply(this);}}}}else{R.apply(this);c=B.call(this,g+this.scrollNode.scrollTop,b);a=c.idx;Z=c.edge;if(k!==a||l!==Z){if(k!==undefined){U.removeClass(this.itemsContainerNode.children[k],l);}U.addClass(this.itemsContainerNode.children[a],Z);b.tgtIdx=a;b.tgtEdge=Z;}}}return this._super(Y);},ondragend:function H(Z){if(A(Z)){var b=Z.src.data,a=b.node,Y=b.tgtIdx;R.apply(this);if(Y!==undefined){U.removeClass(this.itemsContainerNode.children[Y],b.tgtEdge);}if(b.tgtEdge===M){Y++;}if(Y===undefined){Y=b.index;}this.items.splice(Y,0,b.item);if(Y===b.index){a.setAttribute("idx",Y);this.itemsContainerNode.insertBefore(a,(Y<(this.items.length-2))?this.itemsContainerNode.children[Y]:null);}else{this.refresh();this.parent.enableOkBtn();}}return this._super(Z);},showTooltip:function E(Z,e){var d=Z.target||G.eventTarget(Z.hWin,Z.e),b=this.getItemFromTarget(d),f=null,Y=null,c=null,a=null;if(b&&b.n){f=this.getItemNodeFromTarget(d);Y=G.position(d);c=f.getElementsByClassName("name")[0];a=f.getElementsByClassName("mstrmojo-group-list")[0];if((c===d&&c.scrollWidth>c.clientWidth)||(a===d&&a.scrollWidth>a.clientWidth)){this.richTooltip={areaId:b._renderIdx,cssClass:"vi-regular vi-tooltip-V",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:d.textContent,top:Y.y,left:c===d?Y.x+130:Y.x+70};}else{this.richTooltip=null;}if(this.richTooltip){this._super(Z,e);}}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Box","HBox","VBox","css","dom","string","array","hash");mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.mstr.ElementsDataHelper","mstrmojo.ui._IsIncFetchList","mstrmojo.Label","mstrmojo.SearchWidget");mstrmojo.requiresDescs(513,514,1763,12200);var V=mstrmojo.array,B=mstrmojo.css,I=mstrmojo.desc,k=mstrmojo.string,P=mstrmojo.hash,g="dragIn",n="\u001E",L=200;function A(){var o=this._timerHandle;if(o){window.clearTimeout(o);delete this._timerHandle;}}mstrmojo.vi.ui.editors.DerivedElementPanel=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.editors.DerivedElementPanel",cssClass:"mstrmojo-DerivedElementPanel",isNew:true,excludeList:null,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"title-area",children:[{scriptClass:"mstrmojo.Label",text:I(513,"Available"),cssClass:"available-label"},{scriptClass:"mstrmojo.Box",cssClass:"search-box",children:[{scriptClass:"mstrmojo.SearchWidget",alias:"search",quickSearch:true,onsearch:function l(q){var o=this.parent.parent.parent.parent,p=this;if(this._timerHandle){A.call(this);}this._timerHandle=window.setTimeout(function(){o.availableElems().startBrowsing(o.parent.browseConfig,q);delete p._timerHandle;},L);},onclear:function Z(){var o=this.parent.parent.parent.parent;A.call(this);o.availableElems().startBrowsing(o.parent.browseConfig);}}]},{scriptClass:"mstrmojo.Label",cssClass:"selected-label",text:I(514,"Selected")},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton clear-btn",text:I(1763,"Clear All"),onclick:function(){var o=this.parent.parent.parent,p=o.selectedElems().items;if(p.length>0){o.updateExcludeList(p,false);o.selectedElems().set("items",[]);o.availableElems().refresh();o.enableSaveBtn();}}}]},{scriptClass:"mstrmojo.HBox",cssClass:"cart-table",children:[{scriptClass:"mstrmojo.vi.ui.editors.AvailableElements",alias:"availableElems"},{scriptClass:"mstrmojo.vi.ui.editors.SelectedElements",alias:"selectedElems",items:[]}]},{scriptClass:"mstrmojo.Widget",markupString:"<div class='separator'></div>"},{scriptClass:"mstrmojo.HBox",cssClass:"apply",children:[{scriptClass:"mstrmojo.Widget",markupString:'<div class="apply-text">'+I(12200,"Drag and drop elements to create group. Click # button to apply.").replace("#",'"&#10003;"')+"</div>"},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-Button okBtn",enabled:false,onclick:function(){var o=this.parent.parent.parent;if(o.parent.commitEdit(o.selectedElems().items,o.isNew)){this.set("enabled",false);o.set("visible",false);o.parent.toggleEdit(false);}}},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-Button cancelBtn",onclick:function(){var o=this.parent.parent.parent;o.set("visible",false);o.parent.initExcludeList();o.parent.toggleEdit(false);}}]}]}],_set_visible:function X(p,o){this[p]=o;if(o===true){if(this.hasRendered){this.searchField().reset();}this.availableElems().startBrowsing(this.parent.browseConfig);this.enableCancelBtn();}},updateExcludeList:function a(o,p){var q=this;if(p){V.forEach(o,function(r){q.excludeList[r.v]=true;});}else{V.forEach(o,function(r){delete q.excludeList[r.v];});}},enableSaveBtn:function(){this.children[0].children[3].children[1].set("enabled",this.selectedElems().items.length>0);},enableCancelBtn:function(){this.children[0].children[3].children[2].set("enabled",true);},availableElems:function N(){return this.children[0].children[1].availableElems;},selectedElems:function G(){return this.children[0].children[1].selectedElems;},searchField:function J(){return this.children[0].children[0].children[1].search;}});function R(o){return o.src.node&&o.src.node.className.indexOf("item")>=0;}function F(o){var p=o.getTarget();return p&&(p.className.indexOf("item")>=0||(p.parentNode&&p.parentNode.className.indexOf("item")>=0));}mstrmojo.vi.ui.editors.SelectedElements=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo.vi.ui._HasUnitListAvatar,mstrmojo.vi.ui._IsDropTarget],{scriptClass:"mstrmojo.vi.ui.editors.SelectedElements",cssClass:"mstrmojo-SelectedElements",restrictedToAxis:"",avatarCssClass:"element-DE-drag-avatar",multiSelect:true,useListModKeys:true,cachedItems:null,getSelectedItems:function O(){var t=this,o=this.items,q=null,p=[];P.forEach(this.selectedIndices,function(u,r){q=P.copy(o[r]);if(u&&q){q.itemNode=t._getItemNode(r);if(q.itemNode.style.display!=="none"){p.push(q);}}});return p;},init:function h(o){this._super(o);this.dePanel=this.parent.parent.parent;},getItemDisplayName:function T(o){return o.n||mstrmojo.desc(14561,"(null)");},getItemProps:function W(q,o){var p=this._super(q,o);p.cls="mstrmojo-VIGroupDEElement";return p;},selectDragNode:function m(o){this._super(o);var p=o.src.data;p.items=mstrmojo.all[p.srcId].getSelectedItems();},processDragStart:function b(p){if(R(p)){var o=p.src.data.items.map(function(r){return r._renderIdx;}).reverse(),q=this;this.cachedItems=this.items.slice(0)||[];V.forEach(o,function(r){q.items.splice(r,1);});this.clearSelect();this.refresh();}},isDragValid:function Q(o){return R(o)||this._super(o)||false;},ondragstart:function Y(o){this.selectDragNode(o);this._super(o);this.processDragStart(o);},ondragenter:function E(o){if(R(o)){B.addClass(this.domNode,g);}if(this._super){this._super(o);}},ondragleave:function K(o){if(R(o)){B.removeClass(this.domNode,g);}if(this._super){this._super(o);}},ondragend:function C(o){var p=o.src.data;this._super(o);if(!p.isDropSuccess&&p.srcId===this.id){if(this.cachedItems){this.items=this.cachedItems;}this.refresh();}},ondrop:function U(r){B.removeClass(this.domNode,g);var v=r.src.data,q=v.items,t=this,o=this.parent.parent.parent;if(v.srcId===this.id){this.items=this.cachedItems;}else{var p=this.dePanel,u=p.availableElems();if(u._scroll){u._scroll();}V.forEach(q,function(w){t.items.push({n:w.n,v:w.v});});p.updateExcludeList(q,true);}this.refresh();o.enableSaveBtn();v.isDropSuccess=true;},allowDrop:function D(o){var p=o.src.data;return p&&p.items&&p.items.length>0;},positionAvatar:function e(q,p){if(!this.avatar){return ;}var o=this.avatar;q.y=q.y-o.offsetHeight-13;this._super(q,p);},ondblclick:function M(o){var p=this.dePanel.availableElems();if(F(o)){this.items.splice(this.selectedIndex,1);this.dePanel.updateExcludeList([this.selectedItem],false);this.refresh();p.refresh();this.dePanel.enableSaveBtn();}}});mstrmojo.vi.ui.editors.AvailableElements=mstrmojo.declare(mstrmojo.vi.ui.editors.SelectedElements,[mstrmojo.ui._IsIncFetchList],{scriptClass:"mstrmojo.vi.ui.editors.AvailableElements",cssClass:"mstrmojo-AvailableElements",init:function h(o){this._super(o);this.ifDataHelper=new mstrmojo.mstr.ElementsDataHelper({browseConfig:{styleName:"MojoAttributeStyle",blockCount:mstrApp.elementsBlockCount||30,useBrowseForm:1}});},getItemProps:function W(q,o){var p=this._super(q,o),t=this.ifDataHelper&&this.ifDataHelper.browseConfig&&this.ifDataHelper.browseConfig.searchPattern,r;p.style="display:"+(this.dePanel.excludeList[q.v]?"none":"block");p.html=p.n;if(t){r=new RegExp(k.regEscape(t),"ig");if(r.test(p.html)){p.html=p.html.replace(r,function(u){return n+u+n;});}}p.html=k.encodeHtmlString(p.html);if(t){while(p.html.indexOf(n)!==-1){p.html=p.html.replace(n,"<em>").replace(n,"</em>");}}return p;},getItemMarkup:function H(p,o){return this._super(p,o).replace("@en@n","@html");},selectedElems:function G(){return this.parent.selectedElems.items;},processDragStart:function b(p){var o=p.src.data.items;V.forEach(o,function(q){if(!isNaN(q._renderIdx)){q.itemNode.style.display="none";}});this.clearSelect();},ondrop:function U(q){B.removeClass(this.domNode,g);var r=q.src.data,p=r.items,o=this.dePanel;if(r.srcId!==this.id){o.updateExcludeList(p,false);}this.refresh();o.enableSaveBtn();r.isDropSuccess=true;},startBrowsing:function c(o,r){if(this.ifDataHelper&&this.ifDataHelper.browseConfig){P.copy(o,this.ifDataHelper.browseConfig);if(r){this.ifDataHelper.browseConfig.searchPattern=r;}else{delete this.ifDataHelper.browseConfig.searchPattern;}this.ifDataHelper.set("blockBegin",1);this.ifDataHelper.set("items",null);}var q=this,p=function(u){q.inWaitPos=0;q.set("items",u.items);q.initScroll();if(!u.items||u.items.length===0){q.itemsContainerNode.innerHTML="<div class='mstrmojo-VIGroupDENoResults'>"+u.message+"</div>";}},t={success:function(u){if(!u.message){u.message=mstrmojo.desc(13779,"No elements match your search");}p(u);if(u.items&&q._scroll){q._scroll();}},failure:function(u){p(u);}};this.ifDataHelper.getItems(1,t);},preNext:function d(){if(!this.inWaitPos&&this.items&&this.items.length){this.itemsContainerNode.innerHTML+="<div class='item mstrmojo-VIGroupDEElement'>Wait...</div>";this.inWaitPos=this.items.length;}},onisFetchingChange:function f(o){if(!o.value&&this.supportsIncFetch&&this._scroll){this._scroll();}},postNext:function S(){if(this.inWaitPos>0){this.itemsContainerNode.removeChild(this.itemsContainerNode.childNodes[this.inWaitPos]);this.inWaitPos=0;this.updateScrollbars();}},ondblclick:function M(o){var p=this.dePanel.selectedElems(),q=this.selectedItem;if(F(o)&&q&&q.v){p.items.push({n:q.n,v:q.v});this.dePanel.updateExcludeList([q],true);p.refresh();this.itemsContainerNode.childNodes[q._renderIdx].style.display="none";if(this._scroll){this._scroll();}this.dePanel.enableSaveBtn();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz");var A={render:function(F,B,G){var H=(G.htmlName+B),D=G.selectedIndices[B]?"checked ":"",E=D?" selected":"",C=F.v!=="u;"?" nAll":"";return'<div class="'+G.itemCssClass+E+C+'"><input type="'+G.inputType+'" name="'+G.htmlName+'" id="'+H+'" value="'+B+'" '+D+'/><label for="'+H+'" title="'+(F[G.itemTitleField]||"")+'" style="'+G.labelCssText+'">'+F[G.itemDisplayField||"n"]+"</label></div>";},select:function(D,E,B,F){var C=D&&D.firstChild;if(C&&!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);},unselect:function(D,E,B,F){var C=D&&D.firstChild;if(C&&C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);},rowHeight:23};mstrmojo._RendersInputItems=mstrmojo.provide("mstrmojo._RendersInputItems",{inputType:null,htmlName:null,itemRenderer:A,init:function(B){this._super(B);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(E){var D=E.hWin,G=E.e,F=mstrmojo.dom.eventTarget(D,G);if(F&&F.nodeName.match(/input/i)){var C=parseInt(F.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(C);}else{var B=(F.checked)?"add":"remove";this[B+"Select"](C);}}}});mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxBase");mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(D,A,E){var B=D.v!=="u;"?" nAll":"",C=(E.enabled===false);return'<input mstridx="'+A+'" class="'+E.itemCssClass+(E.selectedIndices[A]?" "+E.itemSelectedCssClass:"")+" "+(D.css||"")+B+'" style="'+E.itemCssText+'" type="button"  value="'+D[E.itemDisplayField]+'" '+(C?"disabled ":"")+"/>";};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ListSelectorItemRenderer=A.clone(mstrmojo.DivItemRenderer);mstrmojo.ListSelectorItemRenderer.render=function(D,B,E){var C=D.v!="u;"?" nAll":"";return'<div mstridx="'+B+'" class="'+E.itemCssClass+(E.selectedIndices[B]?" "+E.itemSelectedCssClass:"")+C+'" style="'+E.itemCssText+'">'+(E.getItemName?E.getItemName(D,B):(E.itemDisplayField&&D[E.itemDisplayField]))+"</div>";};mstrmojo.ListBoxSelector=mstrmojo.declare(mstrmojo.ListBox,null,{itemRenderer:mstrmojo.ListSelectorItemRenderer});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.color");var C=[127,206,255];var D=[216,230,239];var B=function(H,K){if(!H||H==="transparent"){H="#FFFFFF";}var G=mstrmojo.color.hex2rgb(H),J,I,E;if(!K){J=Math.round((3/5)*parseInt(G[0])+110);I=Math.round((3/5)*parseInt(G[1])+110);E=Math.round((3/5)*parseInt(G[2])+110);}else{J=G[0]*K[0]/255;I=G[1]*K[1]/255;E=G[2]*K[2]/255;var F=G[0]*0.3+G[1]*0.59+G[2]*0.11;if(F<85){J=J+(63*((85-F)/85));if(J>255){J=255;}I=I+(63*((85-F)/85));if(I>255){I=255;}E=E+(96*((85-F)/85));if(E>255){E=255;}}}return"#"+mstrmojo.color.rgb2hex(J,I,E);};var A=function(F,G,E){if(F&&F.style){F.style.backgroundColor=G["bg"+E+"Color"]||"";F.style.color=G["text"+E+"Color"]||"";}};mstrmojo.LinkItemRenderer=mstrmojo.hash.copy({render:function(G,E,H){var F=G.v!=="u;"?" nAll":"";return'<input mstridx="'+E+'" class="'+H.itemCssClass+(H.selectedIndices[E]?" "+H.itemSelectedCssClass:"")+F+'" style="'+H.itemCssText+" color:"+(H.selectedIndices[E]?H.textSelectedColor:H.textNormalColor)+"; background-color:"+(H.selectedIndices[E]?H.bgSelectedColor:H.bgNormalColor)+';" type="button"  value="'+G[H.itemDisplayField]+'"  onmouseover="mstrmojo.all.'+H.id+".onmouseover(self, "+E+')" onmouseout="mstrmojo.all.'+H.id+".onmouseout(self, "+E+')"/>';},select:function(F,G,E,H){F.className+=" selected";A(F,H,"Selected");},unselect:function(F,G,E,H){F.className=F.className.replace(/selected/g,"");A(F,H,"Normal");},highlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Highlighted";A(G,I,F);},unhighlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Normal";A(G,I,F);}},mstrmojo.hash.copy(mstrmojo.DivItemRenderer));mstrmojo._RendersItemLinks=mstrmojo.hash.copy({onmouseover:function(G,E){if(isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.highlight(F,this.items[E],E,this);},onmouseout:function(G,E){if(isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.unhighlight(F,this.items[E],E,this);},preBuildRendering:function(){this.bgNormalColor=this["background-color"]||this.parent&&this.parent["background-color"];this.bgSelectedColor=this.parent&&this.parent.defn&&this.parent.defn.ssc;if(this.bgSelectedColor!=null){if(this.bgSelectedColor==="transparent"){this.bgHighlightedColor=mstrmojo.LinkList.dftTrptBgHltColor;}else{this.bgHighlightedColor=B(this.bgSelectedColor);}}else{this.bgSelectedColor=B(this.bgNormalColor,C);this.bgHighlightedColor=B(this.bgNormalColor,D);}this.textSelectedColor=(this.bgSelectedColor==="transparent")?mstrmojo.LinkList.dftTrptTxSelColor:mstrmojo.color.getContrastingColor(this.bgSelectedColor,"#ffffff","#000000");this.textHighlightedColor=(this.bgSelectedColor==="transparent")?mstrmojo.LinkList.dftTrptTxHltColor:mstrmojo.color.getContrastingColor(this.bgHighlightedColor,"#ffffff","#000000");this.textNormalColor=this.color;if(this._super){this._super();}}},mstrmojo.hash.copy(mstrmojo._RendersItemDivs));mstrmojo._RendersItemLinks.itemRenderer=mstrmojo.LinkItemRenderer;mstrmojo.requiresCls("mstrmojo.ListBox");mstrmojo.LinkList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkList",cssClass:"mstrmojo-LinkList",itemCssClass:"mstrmojo-LinkList-item",selectionPolicy:"toggle"});mstrmojo.LinkList.dftTrptBgHltColor="#FFFFFF";mstrmojo.LinkList.dftTrptTxSelColor="#FFFFFF";mstrmojo.LinkList.dftTrptTxHltColor="#000000";mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.LinkListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkListHoriz",cssClass:"mstrmojo-LinkListHoriz",itemCssClass:"mstrmojo-LinkListHoriz-item",selectionPolicy:"toggle"});})();(function(){mstrmojo.requiresCls("mstrmojo.OBList","mstrmojo.ui._IsIncFetchList","mstrmojo.ui._HasScroller");var F=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType;function D(G){return{browseConfig:null,parent:G,next:function(J){var I=this.browseConfig;if(!I){return ;}I.blockBegin+=I.blockCount;var H={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockBegin:I.blockBegin,blockCount:I.blockCount,includeAncestorInfo:true};if(I.folderLinksContextId){H.folderLinksContextId=I.folderLinksContextId;}if(I.includeObjectDesc){H.includeObjectDesc=I.includeObjectDesc;}if(I.rootFolderID){H.rootFolderID=I.rootFolderID;}else{if(I.rootFolderType){H.rootFolderType=I.rootFolderType;}}if(I.browsableTypes){H.objectType=I.browsableTypes;}if(I.searchPattern){H.searchPattern=I.searchPattern;if(I.recursive){H.recursive=I.recursive;}}this.parent.set("waiting",true);if(I.dataProvider){I.dataProvider.serverRequest(H,J);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,J,H);}},hasNext:function(){var H=this.browseConfig;return(H.blockBegin+H.blockCount-1)<H.totalSize;}};}mstrmojo.mstr.ui.IncFetchOBList=mstrmojo.declare(mstrmojo.OBList,[mstrmojo.ui._IsIncFetchList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.mstr.ui.IncFetchOBList",cssClass:"mstrmojo-OBList mstrmojo-IF-OBList",makeObservable:true,renderOnScroll:false,waiting:false,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keypress,mousedown,mouseup,dblclick><div class="scroll-box" style="{@scrollBoxCssText}"><div class="mstrmojo-ListBase2-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onwaitingChange:function(){this.onwaitingChange();}},init:function E(G){if(this._super){this._super(G);}this.ifDataHelper=D(this);if(G.browseConfig){this.ifDataHelper.browseConfig=G.browseConfig;}},onwaitingChange:mstrmojo.emptyFn,addItems:function B(G){var H=this.browseConfig.browsableViewMedias;if(G&&H){var I={};F.forEach(H.split(","),function(J){I[parseInt(J,10)]=true;});G=F.filter(G,function(J){return(J.t!==A.DssTypeDocumentDefinition)||I[J.dvm];});}this.add(G,-1);this.set("waiting",false);if(this._super){this._super(G);}if(this.scrollNode){this.updateScrollbars();}},setupScrollNodes:function C(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Pulldown");var C={ENTER:13,LEFT:37,UP:38,TAB:9,RIGHT:39,DOWN:40,ESC:27};function D(L,M){var G,J,F,H=[],I,N;try{I=new RegExp(L,"i");}catch(K){I=new RegExp(mstrmojo.string.regEscape(L));}for(G=0,J=M.length;G<J;G++){if(I.test(M[G][this.itemField])){H.push(M[G]);}}return H;}function B(F){return !(F<0||F===undefined||F===null);}mstrmojo.SearchablePulldown=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchablePulldown",popupCssClass:"mstrmojo-SearchablePulldown-Popup",searchEnabled:false,allowCustomInput:false,useItemCssOnInput:false,lastSearchPattern:"",isEditing:false,allItems:null,markupString:'<div id="{@id}" class="mstrmojo-SearchablePulldown mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-SearchablePulldown-boxNode mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><input class="mstrmojo-SearchablePulldown-inputNode" value="{@text}" mstrAttach:keyup,blur/><div class="mstrmojo-SearchablePulldown-iconNode mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mouseover,mouseout></div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;},iconNode:function(){return this.domNode.firstChild.children[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){if(this.inputNode.value!==this.text){this.inputNode.value=this.text;}},onheightChange:function(){this.domNode.style.height=this.height||"";this.boxNode.style.height=this.height||"";},onsearchEnabledChange:function(){this.inputNode.readOnly=this.searchEnabled?false:true;this.items=this.allItems||this.items;},onallowCustomInputChange:function(){if(this.allowCustomInput){this.set("searchEnabled",true);}},onvalueChange:function E(){if(this.useItemCssOnInput&&this.selectedItem){this.inputNode.className="mstrmojo-SearchablePulldown-inputNode "+(this.selectedItem[this.itemCSS]||"");}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),prevalueChange:function(){this.synchronize();},synchronize:function(){var G=this.value,H=this.items||[],I=H[this.selectedIndex],F=-1;if(I&&G===I[this.itemIdField]){this.selectedItem=I;this.set("text",I[this.itemField]);return ;}F=mstrmojo.array.find(this.items,this.itemIdField,G);if(!B(F)&&this.allowCustomInput){this.selectedItem=undefined;this.selectedIndex=undefined;return ;}this.selectedIndex=B(F)?F:this.defaultSelection;this.selectedItem=I=this.items[this.selectedIndex];this.value=I?I[this.itemIdField]:undefined;this.set("text",I?I[this.itemField]:(this.defaultText||""));},preBuildRendering:function A(){if(this._super){this._super();}this.allItems=this.allItems||this.items;this.synchronize();},premousedown:function(F){if(this.searchEnabled&&F.getTarget()===this.iconNode){this.set("items",this.allItems);}this._super(F);},onkeyup:function(M){var J=mstrmojo.string.trim(this.inputNode.value),I=M.e,N=I.keyCode||I.which,L=B(this.selectedIndex)?this.selectedIndex:-1,F=this.allowCustomInput,H=this.items.length;this.isEditing=true;switch(N){case C.ENTER:if(H>0&&!F){this.set("selectedIndex",L===-1?0:L);this.synchronize();}this.closePopup();break;case C.ESC:this.closePopup();this.synchronize();break;case C.UP:if(this.popupRef.visible&&H>0){this.set("selectedIndex",(L+H-1)%H);this.synchronize();}break;case C.DOWN:if(!this.popupRef.visible&&H>0){this.togglePopup();}this.set("selectedIndex",(L+1)%H);this.synchronize();break;default:if(J===this.lastSearchPattern){return ;}var K=[];if(J&&J.length>0&&J.indexOf(this.lastSearchPattern)>-1){K=D.apply(this,[J,this.items]);}else{K=D.apply(this,[J,this.allItems]);}this.set("items",K);if(K.length===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}this.set("selectedIndex",undefined);if(J&&J.length){var G=mstrmojo.array.find(K,this.itemField,J);if(G!==-1){this.set("selectedIndex",G);}}}if(F&&!B(this.selectedIndex)){this.set("value",this.inputNode.value);}this.lastSearchPattern=J;},onblur:function(F){this.isEditing=false;if(!this.searchEnabled){return ;}if(!this.allowCustomInput){this.items=this.allItems;this.synchronize();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasPopup","mstrmojo.string","mstrmojo.Pulldown","mstrmojo.Container");var C=mstrmojo.css;mstrmojo.CustomGroupEl=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.CustomGroupEl",markupString:'<div id="{@id}" class="mstrmojo-onhoverparent mstrmojo-CustomGroupEl {@cssClass}" style="{@cssText}" mstrAttach:mouseover><div class="mstrmojo-CustomGroupEl-title {@cssClass}" mstrAttach:click><img class="mstrmojo-CustomGroupEl-state {@cssClass}" src="../images/1ptrans.gif" align="absmiddle" onclick="var w = mstrmojo.all[\'{@id}\']; w.set(\'state\', !w.state)" /><span class="mstrmojo-text"></span></div><div class="mstrmojo-onhover mstrmojo-abs mstrmojo-topright mstrmojo-CustomGroupEl-tools {@cssClass}"><img class="mstrmojo-dup" src="../images/1ptrans.gif" title="'+mstrmojo.desc(3397,"Duplicate")+'" onclick="mstrmojo.all[\'{@id}\'].dup()" /><img class="mstrmojo-ops" src="../images/1ptrans.gif"onclick="var w = mstrmojo.all[\'{@id}\'].showOps();" title="'+mstrmojo.desc(7932,"Element display options")+'" /><img class="mstrmojo-del" src="../images/1ptrans.gif" onclick="mstrmojo.all[\'{@id}\'].del()" title="'+mstrmojo.desc(7933,"Delete element")+'"/></div><div class="mstrmojo-CustomGroupEl-details {@cssClass}"><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr-tools {@cssClass}"></div></div></div>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},titleNode:function(){return this.domNode.firstChild.lastChild;},detailsNode:function(){return this.domNode.lastChild;},exprNode:function(){return this.domNode.lastChild.firstChild;},exprToolsNode:function(){return this.domNode.lastChild.lastChild;},titlebarNode:function(){return this.domNode.firstChild;}},markupMethods:{ondataChange:function(){var G=this.data,F=G&&G.n;this.titleNode.innerHTML=(F!=null)?mstrmojo.string.encodeHtmlString(F):"";},onstateChange:function(){var F=this.stateNode;F.className="mstrmojo-CustomGroupEl-state "+(this.state?"opened":"closed");this.detailsNode.style.display=this.state?"block":"none";},onselectedChange:function(){C.toggleClass(this.domNode,["selected"],this.selected);},onshowaddChange:function(){this.exprToolsNode.style.display=this.showadd?"block":"none";}},_set_data:function A(H,F){var G=this.data;this.data=F;this.set("expr",F&&F.expr);return G!==F;},optionsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(7934,"Element Options"),contentNodeCssClass:"mstrmojo-balloon",cssClass:"mstrmojo-CGEOptionsEditor",help:"element_options_dialog_box.htm",ce:false,isp:false,onOpen:function(){var F=this.opener.data,G=this.ops.dsplb.dspl;G.set("value",F.ce?2:(F.isp?1:0));},save:function(){var F=this.ops.dsplb.dspl.value,G=this.opener.data;G.ce=(F==2);G.isp=(F==1);this.close();},children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ElementOptions",alias:"ops",children:[{scriptClass:"mstrmojo.HBox",alias:"dsplb",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(168,"Display:"),cssText:"margin: 0 5px;"},{alias:"dspl",scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:[{n:mstrmojo.desc(7935,"Display element name only (Default)"),v:0},{n:mstrmojo.desc(7936,"Display individual items only"),v:1},{n:mstrmojo.desc(7937,"Display element name and individual items"),v:2}]}]},{scriptClass:"mstrmojo.HBox",alias:"btns",cssText:"float:right;width:150px;margin:5px;",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(118,"Save"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;",onclick:function(){this.parent.parent.parent.save();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;margin: 5px;",onclick:function(){this.parent.parent.parent.close();}}]}]}]},showOps:function(){var G=this.titlebarNode,F=mstrmojo.dom.position(G,true);this.openPopup("optionsRef",{zIndex:30,left:Math.round(F.x+F.w-300)+"px",top:Math.round(F.y+F.h)+"px"});},init:function E(F){this._super(F);var G=this.data;if(G){delete this.data;this._set_data(null,G);}},del:function B(){var F=this.parent;if(F&&F.remove){F.remove(this.data);}},dup:function D(){var F=this.parent;if(F&&F.duplicate){var K=this.data,L=F.items,N=K.did,M=1,O=new RegExp(K.n+"_(\\d+)");for(var I=0,J=L.length;I<J;I++){var H=L[I],G=H.n&&H.n.match(O);if(G){M=Math.max(M,G[1]);}N=Math.max(N,parseInt(H.did,10));}F.duplicate(this.data,null,{n:mstrmojo.desc(3651,"Copy of ##").replace("##",K.n),did:F.getNextId(),state:1});}},onmouseover:function(F){this.set("showadd",this.state?true:false);}});})();(function(){var F=mstrmojo.string;function H(Q,R,K){var L,O,J,M=[],N,S;try{N=new RegExp(mstrmojo.string.regEscape(Q),"i");}catch(P){return M;}for(L=0,O=R.length;L<O;L++){J=R[L][K];N.lastIndex=0;if(N.test(J)){M.push(R[L]);}}return M;}function C(){if(this.searchEnabled){this.iconNode.style.display="none";this.inputBar.style.display="";if(this.autofocus){this.inputNode.focus();this.inputNode.select();}}else{this.hideInputNode();if(this.autofocus){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var J=this;window.setTimeout(function(){try{J.iconNode.focus();}catch(K){}},100);}else{this.iconNode.focus();}}}}var G={8:"BackSpace",9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchableDropDownList=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchableDropDownList",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" placeholder="{@placeholderText}" mstrAttach:keyup,blur,click/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupSlots,{inputBar:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.firstChild.lastChild.rows[0].cells[0].firstChild;}}),markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.iconNode.innerHTML=F.decodeHtmlString(this.text);this.inputNode.value=this.text;},onheightChange:function(){var J=parseInt(this.height,10);if(J>=0){this.domNode.style.height=J+"px";this.inputBar.style.height=J+"px";}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),popupToBody:true,searchEnabled:false,selectedIndex:-1,placeholderText:"",allItems:null,autofocus:true,focus:function(){C.call(this);},hideInputNode:function B(){this.inputBar.style.display="none";this.iconNode.style.display="block";},postBuildRendering:function A(){if(!this.allItems){this.allItems=this.items;}this._super();C.call(this);},clickInput2pop:false,onclick:function I(J){if(this.clickInput2pop){this.togglePopup();}},prekeyup:function E(R){var K=this.getSearchPattern(),P=[],M,Q=this.inputNode,O=R.e,J,L,N=this.items.length;if(G[O.keyCode]==="Enter"){if(this.items.length>0){this.set("selectedIndex",this.selectedIndex===-1?0:this.selectedIndex);}this.onEnter&&this.onEnter();this.closePopup();return ;}else{if(G[O.keyCode]==="Esc"){this.onEsc&&this.onEsc();if(this.popupRef.visible){this.popupRef.close();}return ;}else{if(G[O.keyCode]==="ArrowDown"){if(!this.popupRef.visible){this.togglePopup();}this.set("selectedIndex",(this.selectedIndex+1)%N);}else{if(G[O.keyCode]==="ArrowUp"){if(this.popupRef.visible&&N>0){this.set("selectedIndex",(this.selectedIndex+N-1)%N);}}else{if(this.searchEnabled){if(K&&K.length>0&&K.indexOf(this.lastSearchPattern)>-1){P=H(K,this.items,this.itemField);}else{P=H(K,this.allItems,this.itemField);}this.set("selectedIndex",-1);this.set("items",P);N=P.length;if(N===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}if(K&&K.length>0){this.set("selectedIndex",mstrmojo.array.find(P,this.itemField,Q.value));}}}}}}this.lastSearchPattern=K;},getSearchPattern:function D(){return F.trim(this.inputNode.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),({scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E==="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E==="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof G==="object")&&(typeof G.length==="number"));};if(B(F)&&B(E)){var C;for(C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo._IsDial");mstrmojo.WidgetDial=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._IsDial],{scriptClass:"mstrmojo.WidgetDial"});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var B=mstrmojo.dom,A={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseover><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(A[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=B.eventTarget(D.hWin,D.e);if(F===this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dnd","mstrmojo.ui._HasScroller");function Z(f){var h=document.createElement("div"),g=h.style,e=f.domNode;h.className="mstrmojo-DataGrid-avatar";g.height=e.clientHeight+"px";e.appendChild(h);f.avatar=h;return h;}function Q(e){var f=mstrmojo.dom.position(e.domNode,true);return f.x;}function O(e){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+e+'"></div>';}function b(g){var f=g.getAttribute("rh"),e=f&&parseInt(f,10);return e;}function Y(f,k,e){var h=e.src,l=h&&h.data,g=l&&l.resizingIdx;if(!(g&&g>0)){return k&&k.apply(f,[e]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function G(h,g){var e=h.colSizeArray;var f=[-e[g-1]+h.minColWidth,(g==e.length-1)?e[g]-h.resizeHandleWidth-h.minColWidth:e[g]-h.minColWidth];return f;},updateSize:function F(h,g,f){var e=h.colSizeArray;e[g-1]=e[g-1]+f;e[g]=e[g]-f;},updateColumnWidth:function T(h,f,k,g){var e=h.colSizeArray;f[g-1].style.width=e[g-1]+"px";k[g-1].style.width=e[g-1]+"px";f[g].style.width=e[g]+"px";k[g].style.width=e[g]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function G(l,k){var m=l.minColWidth+l.resizeHandleWidth,e=l.colSizeArray,g=0;for(var h=k;h<e.length;++h){g+=e[h]-m;}var f=[-e[k-1]+m,g];return f;},updateSize:function F(h,n,f){var m=h.minColWidth+h.resizeHandleWidth,k=h.colSizeArray;k[n-1]=k[n-1]+f;var e=[];for(var g=0;g<k.length-n;++g){e[g]=n+g;}e.sort(function(p,q){return k[p]-k[q];});for(var g=0;g<e.length;++g){var o=f/(e.length-g);var l=k[e[g]];f-=(l>=o+m)?o:l-m;k[e[g]]=(l>=o+m)?l-o:m;}},updateColumnWidth:function T(k,f,l,h){var e=k.colSizeArray;for(var g=h-1;g<e.length;++g){f[g].style.width=e[g]+"px";l[g].style.width=e[g]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,createColSizeArray:function c(){var f,l,h,g,k,e;l=this.headerContainerNode;h=l&&l.getElementsByTagName("table")[0];g=h.rows[0].cells;f=[];for(k=0,e=g.length;k<e;k++){f.push(g[k].offsetWidth);}return f;},postBuildRendering:function V(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function E(e){var g=e.src,h=g.node,f=b(h);if(f&&f>0){return{resizingIdx:f,startingX:g.pos.x,baseX:Q(this)};}if(this._super){return this.dropZone&&this._super(e);}return null;},allowDrop:function K(e){var g=e.src,h=g&&g.data,f=h&&h.resizingIdx;if(f&&f>0){return true;}return this.dropZone;},ondragenter:function R(e){Y(this,this._super,e);},ondragover:function S(e){Y(this,this._super,e);},ondragleave:function B(e){Y(this,this._super,e);},ondrop:function W(e){Y(this,this._super,e);},isDragValid:function C(e){var g=e.src,h=g&&g.data,f=h&&h.resizingIdx;if(f&&f>0){return true;}if(this._super){return this._super(e);}return false;},ondragstart:function X(e){var h=e.src,k=h&&h.data,g=k&&k.resizingIdx;if(g&&g>0){var f=this.avatar||Z(this);this.ownAvatar=true;f.style.left=(k.startingX-k.baseX)+"px";f.style.display="block";document.body.style.cursor="col-resize";if(!this.colSizeArray){this.colSizeArray=this.createColSizeArray();this._firstTimeResize=true;}k.resizingRange=this.resizeColumnBehavior.getRange(this,g);return ;}if(this._super){this._super(e);}},ondragmove:function P(f){var o=f.src,g=o&&o.data,m=g&&g.resizingIdx;if(m&&m>0){var n=f.tgt,h=this.avatar,l=g.resizingRange,k=n.pos.x-g.startingX,e=Math.min(l[1],Math.max(k,l[0]));g.deltaX=e;if(h){h.style.left=(g.startingX-g.baseX+e)+"px";}}else{if(this._super){this._super(f);}}},ondragend:function L(k){var r=k.src,l=r&&r.data,p=l&&l.resizingIdx;if(p&&p>0){var e=this.titleColGroup,q=e&&e.childNodes,n=this.dataColGroup,o=n&&n.childNodes,h=q.length,m=this.colSizeArray,f=l.deltaX;this.resizeColumnBehavior.updateSize(this,p,f);if(this._firstTimeResize){var g;for(g=0;g<h;g++){q[g].style.width=m[g]+"px";o[g].style.width=m[g]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,q,o,p);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(k);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function J(g){var l=document.createElement("colgroup"),e=g.length,f,k;for(k=0;k<e;k++){var h=document.createElement("col");f=g[k];if(f.colWidth){h.style.width=f.colWidth+"px";}h.className=f.colCss||("col"+k);l.appendChild(h);}return l;}function I(f){var g=f._headerWidgets_,e=g&&g.length;if(e>0){var h;for(h=0;h<e;h++){g[h].destroy(true);}}}function A(k,e,h,m,f){var g=[],l=k.headerWidget;h=h?(" "+h):"";m=m||this._headerWidgets;f=f?(" "+f):' w="1"';g.push("<td"+h+">");if(e>0&&this.resizableColumns){g.push(O(e));}g.push('<div class="mstrmojo-DataGrid-headerText');g.push(k.headerCss?" "+k.headerCss:"");if(l){m.push(mstrmojo.hash.copy(l));g.push('"'+f+">");}else{g.push('">');}g.push(k.headerText||"&nbsp");g.push("</div>");g.push("</td>");return g.join("");}function a(e,n){var g,l,m,f,o,k,h=[];e=e||"_headerWidgets";n=n||"1";g=this[e];l=g.length;if(l>0){m=this.headerContainerNode.getElementsByTagName("div");f=mstrmojo.array.filter(m,function(p){return p.getAttribute("w")==n;});for(k=0;k<l;k++){g[k].placeholder=f[k].firstChild;g[k].dataGrid=this;o=mstrmojo.registry.ref(g[k]);o.render();h.push(o);}}this[e+"_"]=h;}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,lockHeader:false,contentWidth:"",renderHook:{},markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},markupMethods:{oncontentWidthChange:function(){var f=this.contentWidth,g=this.headerContainerNode,e=this.itemsContainerNode;if(f&&g&&e){g.style.width=f;e.style.width=f;}},onlockHeaderChange:function(){mstrmojo.css.toggleClass(this.domNode,"lockHeader",this.lockHeader);},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},setupScrollNodes:function M(){this.scrollNode=this.scrollboxNode;},itemFunction:function(g,e,f){var h=new mstrmojo.DataRow({columns:f.columns,data:g,idx:e,dataGrid:f,parent:f});return h;},preBuildRendering:function D(){var l=this.renderHook;if(l&&l.pre){l.pre.apply(this,[A]);}else{var f=this.columns,e=f.length,g=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],k;this._headerWidgets=[];var h;for(h=0;h<e;h++){k=A.apply(this,[f[h],h]);g.push(k);}g.push("</tr></table>");this.headerHtml=g.join("");}if(this._super){this._super();}},postBuildRendering:function V(){if(this._super){this._super();}var g=this.renderHook;if(g&&g.post){g.post.apply(this,[J,a]);}else{a.apply(this);this.titleColGroup=J(this.columns);}var e=this.titleColGroup,n=e.cloneNode(true),k=this.headerContainerNode,m=k&&k.getElementsByTagName("table")[0],o=this.itemsContainerNode,l=this.scrollboxNode,h=this.domNode,f=o&&o.getElementsByTagName("table")[0];this.dataColGroup=n;if(m&&f){m.insertBefore(e,m.firstChild);f.insertBefore(n,f.firstChild);}if(this.lockHeader){l.style.height=h.offsetHeight-k.offsetHeight+"px";mstrmojo.dom.attachEvent(l,"scroll",function(p){k.style.left=-l.scrollLeft+"px";});}},refresh:function H(e){I(this);if(this._super){this._super(e);}},destroy:function d(e){I(this);this._super(e);},unrender:function U(k){var g=this._headerWidgets_,f=g&&g.length,e;if(f>0){var h;for(h=0;h<f;h++){e=g[h];if(e&&e.hasRendered){e.unrender(true);}}}this._super(k);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var l=document.createElement("tr"),p=this.data,t=this.idx,f=this.dataGrid,m=this.cssClass,v=this.columns,e=this.children,g,q=-1,u,r;l.setAttribute("id",this.id);if(f.banding){m+=(t%2==1)?" odd":" even";}l.className=m+(mstrmojo.string.isEmpty(p[f.itemDisplayField||"n"])?" empty-row":"")+(" "+p[f.itemCSSField||"itemCss"]||"");var k,o;for(k=0,o=v.length;k<o;k++){u=v[k];r=(u.dataWidgetBuilder&&u.dataWidgetBuilder(p))||u.dataWidget;g=document.createElement("td");if(u.applyStyle2Cell&&u.colCss){g.setAttribute("class",u.colCss);}l.appendChild(g);if(r){g.setAttribute("w","1");q++;e.push(mstrmojo.hash.copy(r,{slot:"slot"+q,data:p,idx:t,dataGrid:f}));}else{if(u.dataFunction){g.innerHTML=u.dataFunction(p,t,f);}else{var h=mstrmojo.string.htmlAngles(p[u.dataField||"n"])||"&nbsp",n=u.tooltip?' title="'+h+'"':"";g.innerHTML='<div class="mstrmojo-DataRow-text" '+n+">"+h+"</div>";}}}this.initChildren();l.mstrmojoId=this.id;return l;},buildRendering:function N(){this._super();var k=this.domNode.childNodes,e=k.length,h={},g=0,l,f;for(f=0;f<e;f++){l=k[f];if(l.getAttribute("w")=="1"){h["slot"+g]=l;g++;}}this.addSlots(h);}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList");mstrmojo.requiresDescs(7091);var C=mstrmojo.desc;mstrmojo.ME.RepeatPulldownList=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ME.RepeatPulldownList",cssClass:"mstrmojo-RepeatPulldownList",makeObservable:true,cValid:true,showDelete:true,pulldownItems:null,pulldowItemsFilter:function B(G){return true;},onpulldownItemsChange:function D(G){var H=G.value,J=[];mstrmojo.array.forEach(H,function I(L,K){if(this.pulldowItemsFilter(L)){J.push(L);}},this);this.pulldownItems=J;},popupCssClass:"",item2textCss:mstrmojo.emptyFn,validate:function F(G){return mstrmojo.string.isEmpty(G)||mstrmojo.num.isNumeric(G);},getNewItem:function E(){return{n:"",did:-1};},itemFunction:function A(M,G,H){return new mstrmojo.Box({cssClass:"mstrmjo-RepeatPulldownList-item",children:[{scriptClass:"mstrmojo.SearchableDropDownList",alias:"pulldown",cssClass:"combo mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",placeholderText:C(12179,"Search for an #").replace("#",C(518,"Attribute").toLowerCase()),itemIdField:"did",searchEnabled:true,autofocus:false,selectedIndex:-1,defaultSelection:-1,clickInput2pop:true,popupCssClass:H.popupCssClass,item2textCss:H.item2textCss,valid:true,useRichTooltip:true,items:H.pulldownItems,onvalidChange:function L(P){this.hideTooltip();H.set("cValid",this.valid);if(!this.valid){var Q=this.domNode,O=mstrmojo.dom.position(Q);this.richTooltip={contentNodeCssClass:"me-tooltip-content left me-err",content:'<div class="content"><span>'+C(11569,"Input contains invalid character")+"</span></div>",top:O.y-5,left:O.x+O.w+10};this.showTooltip();}else{this.richTooltip="";}mstrmojo.css.toggleClass(this.domNode,"err",!this.valid);},onkeyup:function L(O){if(this.selectedIndex<0){this.selectedItem=null;}var P=this.getSearchPattern(),Q=H.validate(P,this)||(this.selectedIndex>-1);this.set("valid",Q);this.createNextInputParamWidget();},prevalueChange:function N(){this.set("valid",true);var P=this.value,O=-1;if(P!==null){O=mstrmojo.array.find(this.items,this.itemIdField,P);}if(O>-1){this.selectedItem=this.items[O];this.selectedIndex=O;this.createNextInputParamWidget();}},postCreate:function I(){var O=M;if(O){if(O.did){this.value=O.did;}else{if(O.v!==undefined){this.defaultText=O.v;this.value=O.v;}}}},createNextInputParamWidget:function K(){if(H.itemIndex(M)!==H.items.length-1){return ;}H.items.add([H.getNewItem()]);this.parent.del.set("visible",true);},getTokens:function J(){var O=mstrmojo.ME.MetricToken.brackets,S=this.selectedItem,R=[],Q;if(S){if(S.did===this.value){Q={v:O(S.n)};if(S.t===21){Q.oi={did:S.attid,n:S.attn,t:12};Q.exv=S.fmdid;Q.extp=8;Q.v=O(S.attn)+"@"+O(S.fnm);}else{Q.oi=S;}R.push(Q);}}else{var P=this.getSearchPattern();if(P.length>0){Q={v:P};R.push(Q);}}return R;}},{scriptClass:"mstrmojo.Label",alias:"del",title:mstrmojo.desc(629,"Delete"),cssClass:"mstrmojo-RepeatPulldownList-del",cssDisplay:"inline-block",visible:(G<H.items.length-1),onclick:function(){H.items.remove(G,1);}}]});}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.fx","mstrmojo.TreeNode");var K=mstrmojo.dom,E={0:"closed",1:"opened",2:"leaf"},I=function(R,Q){var N=R.style,M,P,L,S,O;N.display="block";N.height="auto";M=R.offsetHeight;P=Q?M:0;L=Q?0:M;S=Q?"block":"none";N.overflow="hidden";O=new mstrmojo.fx.AnimateProp({target:R,props:{height:{start:L,stop:P,suffix:"px",fn:Math.round,ease:mstrmojo.ease.linear}},onEnd:function(){N.height="auto";N.display=S;},interval:30,duration:300});O.play();};mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<div id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><div class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</div></div>',markupSlots:mstrmojo.hash.copy({displayNode:function(){return this.domNode.firstChild;},checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),markupMethods:mstrmojo.hash.copy({onstateChange:function(L){this.stateNode.className="mstrmojo-TreeNode-state "+(E[this.state]||"closed");if(this.tree.anim&&this.contentRetrieved&&!L){I(this.itemsContainerNode,this.state===1);}else{this.itemsContainerNode.style.display=(this.state===1)?"block":"none";}}},mstrmojo.TreeNode.prototype.markupMethods),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,_set_items:function(N,M){var L=this._super(N,M);if(L&&this.tree.anim){I(this.itemsContainerNode,true);}return L;},onstateChange:function J(){var L=this.tree;if(!this.contentRetrieved&&(this.state==1)){this.set("items",[L.loadingItemCreaterFunc()]);L.getContent(this,this.blockBegin);}else{if((this.state==1)&&L.onNodeExpand){L.onNodeExpand(this);}if((this.state==0)&&L.onNodeCollapse){L.onNodeCollapse(this);}}},toggleState:function G(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function H(L){K.clearBrowserHighlights(L.hWin);return false;},predblclick:function D(L){K.clearBrowserHighlights(L.hWin);return false;},premousedown:function B(M){var R=mstrmojo.dom,O=mstrmojo.dom.eventTarget(M.hWin,M.e),L=this.tree,N=(this.state==2),Q=R.contains(this.itemsContainerNode,R.eventTarget(M.hWin,M.e),true,this.domNode),P=(L.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if((this.isSpecialNode()||!(O==this.checkBoxNode||((O==this.textNode||O==this.displayNode)&&(N||!P))))&&!this.draggable){R.stopPropogation(M.hWin,M.e);}if((O==this.stateNode)||((O==this.textNode||O==this.displayNode)&&!N&&P)){if(!N){this.toggleState();}}else{if(O==this.checkBoxNode||Q){if(this._super){this._super(M);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var L=this.data&&this.data.st;return(L<0);},handleNodeClicked:function F(){var L=this.tree,M=this.parent,N=this.data;switch(N&&N.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin-L.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin+L.blockCount);break;case"-1":case"-2":break;default:if(L.handleNodeClicked){L.handleNodeClicked(N);}}},init:function(L){this._super(L);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var L=function(M){K.preventDefault(window,M||window.event);return false;};K.attachEvent(this.domNode,"mousedown",L);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeNode","mstrmojo._IsExprNode","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.expr","mstrmojo._HasOwnAvatar");var F=mstrmojo.array,M=mstrmojo.expr,P=mstrmojo.dom,A=mstrmojo.css;function J(R,Q){var T=R.data,S=T&&T.nds;if(!S){return null;}if(Q){Q.sort(F.numSorter);}else{Q=R.sortSelectedIndices();}if(!Q.length){return null;}return{idxs:Q,nds:F.get(S,Q)};}function N(S){var R=S.ctxtBuilder,U=R&&R.itemWidgets,Q=U&&U[0],T=Q&&Q.data;if(T&&T.not&&(U.length>0)){delete T.not;Q.paint();}}mstrmojo.AndOrNode=mstrmojo.declare(mstrmojo.TreeNode,[mstrmojo._IsExprNode,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.AndOrNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},itemsContainerPrefix:function(){return this.domNode.childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[2].firstChild;},dropCueNode:function(){return this.domNode.childNodes[2].lastChild;},itemsContainerSuffix:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onitemCntChange:function(){A.toggleClass(this.itemsContainerNode,["multi"],this.itemCnt>2);},onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();},ondropCuePosChange:mstrmojo.TreeNode.prototype.markupMethods.ondropCuePosChange},multiSelect:true,itemIdField:null,init:function(Q){this._super(Q);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());var R=this.data;if(R){delete this.data;this._set_data(null,R);}},itemCnt:0,postBuildRendering:function(){var Q;this.set("itemCnt",this.items.length);if(this._super){Q=this._super();}N(this);return Q;},preadd:function L(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},preremove:function O(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},_set_data:function(T,Q){var R=this.data,S=(R!==Q);if(S){this.data=Q;if(Q&&!Q.nds){Q.nds=[];}this.set("items",Q&&Q.nds);}return S;},isDragValid:function K(){return true;},isSelectableArea:function(Q){return false;},getDragData:function(Q){var S=this._super(Q);if(S&&!S.html){var R=S.et&&M.ET2TGT[S.et];S.html=R?S[R]&&S[R].n||"":S.n||"";}return S;},remove:function I(R,S){var Q=this._super(R);if(Q>-1){var T=S||this.suppressConsolidation;if(!T){this.consolidate(false);}}return Q;},move:function(R,Q){this.suppressConsolidation=true;var S;if(this._super){S=this._super(R,Q);}this.suppressConsolidation=false;return S;},consolidate:function E(){var U=this.parent;if(!U||!U.remove){return ;}var S=this.items,R=S&&S.length;if(R<2){var T=R?S[0]:null,Q=this.childIndex();if(T){U.add([T],Q);}U.remove(this.data);}},indent:function G(S,Q){var R=J(this,S);if(!R){return ;}this.remove(R.idxs,true);var W=R.nds,V=Q&&Q.fn||this.data&&this.data.fn,U={et:M.ET.ANDOR,nds:W,fn:V};if(W.length===2&&W[0].not){if(W[1].not){delete W[0].not;delete W[1].not;U.not=true;U.fn=(V===M.FN.AND?M.FN.OR:M.FN.AND);}else{var T=W[0];W[0]=W[1];W[1]=T;}}this.add([U],R.idxs[0]);this.consolidate(false);},outdent:function C(R){var S=this.parent,Q=S&&S.data;if(!Q||Q.et!==M.ET.ANDOR){return ;}var T=J(this,R);if(!T){return ;}this.remove(T.idxs,true);if(this.data.not){T.nds[0].not=true;}S.add(T.nds,this.childIndex());this.consolidate(false);},edit:function D(Z,a,S){if(!Z){return ;}var Y=this.data,X=Y&&Y.fn,R=Z.data,f=R&&R.not;if(!R){R={};Z.data=R;}R.not=!!S;if(X!==a){var Q=Y.nds;if(Q&&Q.length>2){var e=Z.childIndex();if(e>0){this.indent([e-1,e],{fn:a});}}else{Y.fn=a;var V=this.ctxtBuilder,U=V&&V.itemWidgets;for(var T=0,W=(U&&U.length)||0;T<W;T++){var b=U[T];if(b){b.paint();}}}}else{Z.paint();}},preclick:function H(Q){var S=null,R=P.eventTarget(Q.hWin,Q.e);if(R===this.prefixNode){}else{if(P.contains(this.prefixNode,R,true)){S="andor";}}Q.part=S;},createAvatar:function B(S){var R=document.createElement("div"),T=P.findWidget(S),Q=T.getAvatarNode&&T.getAvatarNode();if(!Q){Q=T.condNode.cloneNode(true);Q.style.boxSizing="border-box";Q.style.width=T.condNode.offsetWidth+"px";}R.appendChild(Q);A.addClass(R,T.avatarCssCls||"mstrmojo-FE mstrmojo-ConditionNode");R.style.zIndex=20;return R;},_ndsToMove:J});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz","mstrmojo.hash");mstrmojo.CheckList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.CheckList",inputType:"checkbox",cssClass:"mstrmojo-CheckList",itemCssClass:"mstrmojo-CheckList-item"});mstrmojo.requiresCls("mstrmojo._InputListHoriz");mstrmojo.CheckListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.CheckListHoriz",inputType:"checkbox",cssClass:"mstrmojo-CheckListHoriz",itemCssClass:"mstrmojo-CheckListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors.CheckList","mstrmojo.ui.SearchBox","mstrmojo.string","mstrmojo.css","mstrmojo.dom");var B=mstrmojo.string,Q=mstrmojo.css,C=mstrmojo.dom,L="\u001E";function G(S,V){var U=S.n;if(!V){return U;}var T=new RegExp(B.regEscape(V),"ig");if(T.test(U)){return U.replace(T,function(W){return L+B.encodeHtmlString(W,true)+L;});}return undefined;}function N(T){var U=0,S=1;this.items.forEach(function(d,a){var W=this.getItemNode(a);var c=G(d,T),Y=!c||(T&&a===this.allIdx);if(!Y){var Z=JSON.parse(JSON.stringify(d)),b=document.createElement("div");Z.n=c;b.innerHTML=this.itemRenderer.render(Z,a,this);var V=b.firstChild;if(W){W=C.replace(W,V);S=a+1;}else{var X=this.getItemNode(S);W=C.replace(X,V);d._renderIdx=U;d._positionIdx=S;S++;}}Q.toggleClass(W,"excluded",Y);U++;},this);}function I(){return this.orientation==="v"?this.width:"135px";}function D(){return function(S){if(this._super){this._super(S);}var T=this.searchInput;if(T){T.set("width",I.call(this));}};}mstrmojo.vi.ui.rw.selectors.SearchableCheckList=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.CheckList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.SearchableCheckList",init:function M(S){this._super(S);Q.addWidgetCssClass(this,"searchable");},searchInput:null,_set_items:function J(T,U){this._super(T,U);var S=this.searchInput;if(S){S.set("visible",U>15);}},buildRendering:function E(){if(this.isHoriz&&this.itemWidthMode===0){this.renderOnScroll=false;}this._super();var U=document.createElement("div"),W=U.appendChild(document.createElement("div")),V=this.scrollboxNode,T=this.items,X=this.id;U.className="search";this.domNode.insertBefore(U,V);var S=this.searchInput;if(!S){S=this.searchInput=new mstrmojo.ui.SearchBox({width:I.call(this),searchTriggered:function(Z){var Y=mstrmojo.all[X];N.call(Y,Z);Y.updateScrollbars();}});this.addDisposable(S);}S.visible=T&&T.length>15;S.placeholder=W;S.render();},onorientationChange:D(),onwidthChange:D(),updateScrollbars:function R(){var S=this.scrollboxNode;if(this.hasRendered&&this.orientation==="v"){S.style.height=this.getScrollboxHeight()+"px";}this._super();},getScrollboxHeight:function H(){var S=this.searchInput,T=C.position(S.domNode);if(S.visible){return parseInt(this.height,10)-T.h;}return parseInt(this.height,10);},unrender:function O(T){var S=this.searchInput;if(S){S.unrender(T);}return this._super(T);},getItemProps:function P(T,S){var U=this._super(T,S);U.html=B.encodeHtmlString(U.n);while(U.html.indexOf(L)!==-1){U.html=U.html.replace(L,"<em>").replace(L,"</em>");}return U;},getItemMarkup:function F(T,S){return this._super(T,S).replace("@en@n","@html");},getItemNode:function K(S){return this._getItemNode(S);},onScrollEnd:function A(){var T={v:{dimension:"h",scroll:"scrollTop",scrollDimension:"scrollHeight"},h:{dimension:"w",scroll:"scrollLeft",scrollDimension:"scrollWidth"}},W=T[this.isHoriz?"h":"v"];if(this.renderOnScroll){var U=this.scrollNode,S=(this.renderIndex+1)*this.renderBlockSize;if(S>=this.items.length){return ;}if((C.position(U)[W.dimension]+U[W.scroll])>=U[W.scrollDimension]){this.renderIndex++;var V=this._buildItemsMarkup(this.renderIndex*this.renderBlockSize,((this.renderIndex+1)*this.renderBlockSize)-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");this.itemsContainerNode.innerHTML+=V;}}},renderOnScroll:true,renderIndex:0,renderBlockSize:150});}());(function(){mstrmojo.requiresCls("mstrmojo.express.ui.SubtotalsWidget");mstrmojo.vi.ui.SubtotalsWidget=mstrmojo.declare(mstrmojo.express.ui.SubtotalsWidget,null,{scriptClass:"mstrmojo.vi.ui.SubtotalsWidget"});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo._IsLockableXtab","mstrmojo._IsDocumentTemplate","mstrmojo.hash","mstrmojo.dom","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var Q=1,X=2,Y=0,C=1,AA=2,N=3;var M=1;var AC=2;var I=4;var g=8;var d=mstrmojo.dom,q;function AG(AI){var AJ=null;if(AI&&AI.length>1){AJ=new mstrmojo.XtabVACP();AJ.cps=AI;}return AJ;}function J(AJ){if(!AJ||this._onDemandCP){return null;}var AQ=AJ.bc,AO=AJ.tc,AK=AO-AQ,AP=Math.ceil(AK/AQ),AL=[],AN=[],AM;for(AM=0;AM<AP;++AM){var AI=Math.min(AK,AQ);AL.push(this.createOnDemandCP(AM+1,AI,I));AN.push(this.createOnDemandCP(AM+1,AI,g));AK-=AQ;}this._onDemandCP={rhs:AL,vls:AN};return this._onDemandCP;}mstrmojo.XtabTitlesCP.prototype.shouldClonedLastTitleCell=function(){return false;};mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsLockableXtab,mstrmojo._HasScrollbox,mstrmojo._ShowsStatus,mstrmojo._IsDocumentTemplate],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",shouldClipLockableXtab:true,alwaysShowFirstBlockData:false,handleClicks:function H(){return true;},markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div class="text"><div class="warning-icon"></div><div>&nbsp;</div></div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart><table cellspacing="0" cellpadding="0"><tr><td style="vertical-align:top;padding:0;"><div style="position: relative;"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.lastChild;},tableContainerNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild;},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.firstChild;},_TB_CELL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zone:null,lockHeadersCase:N,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function n(AI){return(AI.o!==undefined)?AI.o:AI._ei;},getCellTitleId:function e(AI){var AJ="";if(AI.axis&&AI.ui!==undefined){AJ=AI.axis+"A"+(AI.ui+1);}else{if(AI.mix!==undefined){AJ="0A"+AI.mix;}}return AJ;},update:function l(AJ){this.set("gridData",AJ.data[0]||AJ.data);var AI=this.defn||AJ.defn;this.sid=this.gridData.sid;this.treeType=(AI&&AI.tt)||1;this.interactiveCellsArray=[];if(this._super){return this._super(AJ);}return true;},initCP:function F(AK,AJ,AP,AM,AO,AL,AN){var AI={gridData:AK,type:AP,interactiveCellsArray:AJ,defn:this.defn};AI.base=AM||AI.base;AI.lookupBase=AO||AI.lookupBase;AI.axis=AL||AI.axis;if(!AN){if(AP===M){AN=new mstrmojo.XtabTitlesCP(AI);}else{AN=new mstrmojo.XtabCP(AI);}}else{mstrmojo.hash.copy(AI,AN);}return AN;},preBuildRendering:function D(){var AK=this.gridData,AI=this.height,AJ=this.width;this.lockHeadersCase=AK.lhv||Y;this.selections={};this.numRowFixed=!!(!AI&&AK.rw&&AK.rw.row&&(AK.rw.row.bc<AK.rw.row.tc));this.rw=AK.rw;this._onDemandCP=null;if(AJ){this.widthLimit=parseInt(AJ,10);}if(AI){this.heightLimit=parseInt(AI,10);}return this._super();},renderEmptyGrid:function r(){var AL=this.gridData,AJ=this.msgNode,AK=AJ.style,AI=this.viewport;AJ.firstChild.childNodes[1].innerHTML=AL.eg;if(AL.eg!==""){AK.display="block";AK.overflow="hidden";AJ.className="mstrmojo-message";AI.style.display="none";}return true;},postBuildRendering:function U(){var AN=this.gridData,AK=!!this.viewport&&AN,AJ=this.msgNode,AI=this.viewport,AM;if(AN.eg===undefined){if(AJ.style.display==="block"){AJ.style.display="none";AI.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AK){AN.ghs=AN.ghs||[];AN.gts=AN.gts||[];this._setupZone(AN);this._setupCP(AN);var AP=this.zone;if(AP.parent!==this){this.addChildren(AP);}if(this.scrollboxNode){var AL=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AL)&&(AL>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AL;}this.scrollboxLeft=this.scrollboxTop=0;this.connectScrollbox(this);}}this.renderChildren();if(this.controller&&this.controller.getScrollPosition){var AO=this.controller.getScrollPosition(this.gridData.datasetId+"."+this.gridData.k);if(AO){this.scrollTo(AO);}}AM=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zone.getPageHeight(0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if(((AK&&this.scrollboxNode&&AN.afc)||this.numRowFixed)||(!AN.afc&&this.scrollboxNodeCssText.indexOf("width")<0)&&this.scrollboxNode.scrollWidth>this.scrollboxNode.clientWidth){this.resizeScrollBox();}this.onGridWidthChanged(true);this._onContainerGrowShrink(this.widthLimit,this.heightLimit);if(d.isIE7&&!this.scrollboxHeightFixed&&this.scrollboxNode&&this.scrollboxNode.scrollWidth>this.scrollboxNode.offsetWidth){this.scrollboxNode.style.height=this.scrollboxNode.offsetHeight+17+"px";}if(this.lockHeadersCase&&this.initLock){this.initLock({top:this.scrollboxTop,left:this.scrollboxLeft});}if(this.configureActions){this.configureActions();}return AM;},onclick:function o(AJ){var AL=mstrmojo.dom,AN=AJ.getTarget(),AM=AN&&AL.findAncestorByName(AN,"td",true,this.viewport);if(AN.nodeName.toLowerCase()==="a"&&AM.getAttribute("ei")){try{var AK=this.interactiveCellsArray[parseInt(AM.getAttribute("ei"),10)];if(AK&&AK.ts===mstrmojo.chart.model.enums.EnumDSSBaseFormType.DssBaseFormHTMLTag){AN.href=mstrmojo.addCSRFTokenToURL(AN.href);}}catch(AO){}}if(AM){var AI=AL.findAncestorByName(AN,"span",true,AM);if(AI&&!AJ.shiftKey&&!AJ.ctrlKey){this.defaultAction(AM);}else{this.doSelection(AJ.e,AJ.hWin,AM);}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function h(AJ,AI){this.onclick(mstrmojo._HasMarkup.newDomEvent("click",AI,AJ));},onselectstart:function t(){return false;},onscroll:function u(){this._alignHeaders();if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}},resizeScrollBox:function K(){var AL=this.scrollboxNode,AK=AL&&AL.style,AJ=this._TB_CELL;if(!AK||!AJ){return ;}var AI=this.heightLimit;if(!AI){AK.height="auto";this.scrollboxHeightFixed=false;}else{if(AI>0){AK.height=AI+"px";this.scrollboxHeight=AI;this.scrollboxHeightFixed=true;}}this._resizeScrollBoxWidth();},_onContainerGrowShrink:function AH(AJ,AM){var AI=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AL=AJ||null,AK=AM||null;if(AL||AK){if(AI){AI.fixedSizeCanGrowShrink(this,AK,AL);}}else{if(AI){AI.performCanGrowCanShrink([this],true);}}},_resizeScrollBoxWidth:function V(){var AM=this.scrollboxNode,AJ=AM&&AM.style,AI=this._TB_CELL;if(this.useTouchScrolling||!AJ||!AI){return ;}var AK=this.widthLimit;if(!AK){AJ.width="auto";}var AL=function(){var AN=(mstrmojo.dom.isIE7?(AI.scrollWidth+1):(AI.scrollWidth+(AM.offsetWidth-AM.clientWidth)));if((AN&&(AN>0))&&(!AK||(AK&&(AN<AK)))&&(AM.firstChild.firstChild.offsetWidth>=AM.clientWidth)){AJ.width=AN+"px";}};if(mstrmojo.dom.isIE7){window.setTimeout(AL,1);}else{AL();}},onGridWidthChanged:function c(AJ){if(!AJ){this._resizeScrollBoxWidth();}var AI=this.widthLimit;if(!AI){this.width=q;}this._onContainerGrowShrink(AI,null);},getGridDimension:function R(AL){var AJ=1,AK=AL===AJ?"Height":"Width",AM=AK.toLowerCase(),AI=this[AM+"Limit"];if(!AI&&(this[AM]===q||this[AM]===0)){AI=this.viewport["offset"+AK];this[AM]=AI+"px";return AI;}return AI||parseInt(this[AM],10);},_alignHeaders:function B(AI){var AK=this.scrollboxLeft,AJ=this.scrollboxTop;if(this.lockHeadersCase&&this.alignLockNodes){this.alignLockNodes(AK,AJ);}},defaultAction:function S(AN,AJ){var AI=AJ||this.getCellForNode(AN),AM=AN&&AN.className.indexOf("sc_")>0;if(this.model&&this.model.data&&this.model.data.visName&&this.model.data.visName==="InteractiveGridAjaxVisualizationStyle"){AM=this.isReselectedTD(AI);if(AM&&this.hasSelectAll&&this.hasSelectAll(AI)){this.IGCurrentSelectedCell=null;}else{this.IGCurrentSelectedCell=AI;}}var AL=this.model.getAction(this.getActionCells(AI),AN,AM),AK=AL&&AL.h;this._currentSelectedTD=AN;if(AK&&this.controller[AK]){this.controller[AK](this,AL.a);return true;}return false;},createZone:function m(AJ){var AK=AJ||{},AI=this._super&&this._super(AK);if(!AI){AI=new mstrmojo.XtabZone(AK);}return AI;},_setupZone:function v(AM){this.zones={};if(!this.zone){this.zone=this.createZone({renderMode:this.dataRenderMode,cssText:"z-index: 1",slot:"scrollboxNode"});}var AI=this.zone;this.zones.origin=AI;AI.rh=AM.rh;AI.autoFitWindow=!!AM.afw;if(!this.isVIXtab){AI.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}AI.numColumnCanMerge=AM.gts&&AM.gts.cws?(AM.gts.cws.length-1):0;var AN=[],AK=undefined,AO=null,AL,AJ;mstrmojo.array.forEach(AM.gts&&AM.gts.row,function(AP){AL=AO&&AO.id===AP.id;if(AL){AN[AN.length-1]+=AP.fs&&AP.fs.length||1;}else{if(AP.otp===-1){AK=0;mstrmojo.array.forEach(AN,function(AQ){AK+=AQ;});}AN.push(AP.fs&&AP.fs.length||1);}AO=AP;});AI.acws=AN;AI.rowMerge=AM.gsi&&AM.gsi.prop&&AM.gsi.prop.rows&&AM.gsi.prop.rows.mg!=="0";AJ=AM.ghs&&AM.ghs.chs;AI.headerOffset=AJ&&(AJ.show?(AJ.items&&AJ.items.length||1):0)-1;AI.mxPos=AK;},getHACP:function AF(){return(this._super&&this._super())||new mstrmojo.XtabHACP();},_setupCP:function W(AO){var AL=this.titlesCP=this.getTitleCP(AO),AN=this.chsCP=this.getColumnHeadersCP(AO),AJ=this.rhsCP=this.getRowHeadersCP(AO),AK=this.valuesCP=this.getValuesCP(AO);AL.forceAutoRowHeight=AN.forceAutoRowHeight=AO.rh;var AR=new mstrmojo.XtabVACP();var AI=this.getHACP();AI.cps=[AL,AN];AR.cps=[AI];var AP=this.getHACP();AP.cps=[AJ,AK];AR.cps.push(AP);var AQ=AO.gmh&&AO.gmh.gmrh,AM=AO.rw&&AO.rw.row;if(AQ&&AM){AR.gsmh={};AR.gemh={};AR.gsmh[AM.bb]=AQ.gsmh;AR.gemh[AM.bb+AM.bc-1]=AQ.gemh;}this.zone.cp=AR;},ongridDataChange:function Z(){var AI=this.model;if(AI){AI.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:function b(){if(this._super){this._super();}},getTitleCP:function G(AI){return this.initCP(AI,this.interactiveCellsArray,M);},getColumnHeadersCP:function AB(AI){return this.initCP(AI,this.interactiveCellsArray,AC,AI.ghs&&AI.ghs.chs,AI.gts&&AI.gts.col,X);},getRowHeadersCP:function AD(AI){var AJ=this.initCP(AI,this.interactiveCellsArray,I,AI.ghs&&AI.ghs.rhs,AI.gts&&AI.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AJ].concat(this._onDemandCP.rhs);return AG(this.rhsCPList)||AJ;}return AJ;},getValuesCP:function a(AJ){var AI=this.initCP(AJ,this.interactiveCellsArray,g,AJ.gvs,AJ.gts&&AJ.gts.col);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AI].concat(this._onDemandCP.vls);return AG(this.valuesCPList)||AI;}return AI;},createOnDemandCP:function f(AJ,AK,AI){var AL=new mstrmojo.XtabOnDemandCP();AL.dataSource=this;AL.blockNum=AJ;AL.rc=AK;return AL;},dataDownloaded:function T(AJ,AP){var AR=AP.blockNum,AI=this.rhsCPList[AR],AK=this.valuesCPList[AR],AQ=AJ.data,AN=this.gridData;AQ._bidx=AR;this.dataBlocks[AR]=AQ;if(!AI||!AK){return ;}this.initCP(AQ,this.interactiveCellsArray,I,AQ.ghs&&AQ.ghs.rhs,AQ.gts&&AQ.gts.row,Q,AI);this.initCP(AQ,this.interactiveCellsArray,g,AQ.gvs,AN.gts&&AN.gts.col,null,AK);AI.initContent();AK.initContent();this.numRowsDownloaded+=parseInt(AI.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AM=this.zone;if(AM){var AO=AM.cp;if(AO){var AS=AQ.gmh&&AQ.gmh.gmrh,AL=AQ.rw&&AQ.rw.row;if(AS&&AL){AO.gsmh[AL.bb]=AS.gsmh;AO.gemh[AL.bb+AL.bc-1]=AS.gemh;}}AM.dataDownloaded();}},showDownloadStatus:function P(AI){if(!AI){return ;}if(this.showingStatus){this.numRowsToDownload+=AI;}else{this.numRowsToDownload=AI;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function k(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function L(AL,AI){var AN=this.gridData.rw,AK=AN.row,AM=AN.col,AJ=AK.bc;this.rhsCPList[AL].isDownloading=this.valuesCPList[AL].isDownloading=true;if(AJ){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AL*AJ+1,AJ,AM.bb,AM.bc,this.id,{blockNum:AL},AI));}},unrender:function E(AI){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AI);},getCellForNode:function z(AJ){var AI=AJ&&parseInt(AJ.getAttribute("ei"),10);if(isNaN(AI)){return null;}return this.interactiveCellsArray[parseInt(AI,10)];},getActionCells:function O(AI){var AJ=[],AL=this.selections;var AM=AI.axis+"A"+(AI.ui+1),AN=AL[AM],AK;if(AN&&AN[AI.o]){for(AK in AN){var AO=this.getCellForNode(AN[AK][0]);AJ.push(AO);}}else{AJ.push(AI);}return AJ;},setModel:function AE(AI){this.model=AI;if(AI.data){this.set("gridData",AI.data);}},delegateGridAction:function A(AI,AJ){if(this._shouldResponseToAction(AJ)){AI(this.zone);}},_shouldResponseToAction:function w(AI){return AI!=="refreshOnDataDownloaded";},getTargetZone:function p(){return this.zone;},destroy:function x(){var AI=this.model;if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}if(AI&&AI.destroy){AI.destroy();}this._super();}});mstrmojo.XtabBase.EnumLockedHeaders={OFF:Y,ROW:C,COL:AA,BOTH:N};}());(function(){mstrmojo.requiresCls("mstrmojo.Editor");mstrmojo.vi.ui.editors.ConfirmSaveEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ConfirmSaveEditor",cssClass:"mstrmojo-ConfirmSave-Editor",title:mstrmojo.desc(11812,"Notification"),help:null,children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Warning-Box",children:[{scriptClass:"mstrmojo.Box",cssClass:"icon"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12854,"Do you want to save your dashboard before continuing?"),cssClass:"message"}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton nosave",text:mstrmojo.desc(11814,"Don't Save"),onclick:function(){this.editor.onDonotSave();},bindings:{editor:"this.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(118,"Save"),onclick:function(){this.editor.onSave();},bindings:{editor:"this.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.onCancel();},bindings:{editor:"this.parent.parent"}}]}],onSave:mstrmojo.emptyFn,onDonotSave:mstrmojo.emptyFn,onCancel:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=Y?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=Y?0:U-1;}else{V+=Y?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,disableClick:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(h){var d=this.candidates,a=d&&d.items,X=d&&d.isComplete,g=this._last_hit;if(!this.noCache&&(d||g)){var f=this.filterCandidates(a,h,this.REQUEST_THRESHOLD),b=f.length,e=this.suggestCount,U=false;if(!X&&b<e){var V=g&&g.pattern;if(g&&V&&(h.indexOf(V)>-1)){U=true;var l=this.filterCandidates(g.items,h,this.REQUEST_THRESHOLD),Y=l&&l.length,W=mstrmojo.array,k=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(f,k,l[Z][k])===-1){f.push(l[Z]);}}b=f.length;}}if(!X&&((h.length>2&&b<this.REQUEST_THRESHOLD)||(b<e))){this.requestCandidates(h);return -1;}return(b<e)?f:f.slice(0,e);}this.requestCandidates(h);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(e){if(!e){return ;}var d=X.getSuggestionTarget();if(!d||(V!==d)){return ;}var k=d.getSearchPattern(),a=e.items;X._last_hit={items:a,pattern:U};X.sz=e.sz;if(!X.noCache&&a){var f=(X.candidates&&X.candidates.items)||[],g=[].concat(a),b=a.length,Z;for(Z=0;Z<b;Z++){var Y=g[Z];if(mstrmojo.array.indexOf(f,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=f.concat(a);}}if(k&&k.indexOf(U)>-1){var h=X.filterCandidates(a,k);X.updateSuggestion(h);}},failure:function(Y){if(Y.getResponseHeader){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:(V?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}if(this.autoSelect&&W){W.list.singleSelect(0);}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U,V){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var W=this.zIndex;this.openPopup("ob",{zIndex:(W&&(W+10))||110});this.ob.browser.browse(mstrmojo.hash.copy(V,{folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes}));this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopupCssClss:"",suggestionPopup:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-ObjectInputBox-suggest",autoClose:true,locksHover:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U){mstrmojo.css.addClass(this.domNode,U.suggestionPopupCssClss||"");if(U.autoSelect){this.list.singleSelect(0);}if(U.nudge){U.nudge(this);}}},onClose:function F(){this.list.clearSelect();var U=this.opener;if(U){U.suggestionShown=false;mstrmojo.css.removeClass(this.domNode,U.suggestionPopupCssClss||"");}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor");function C(E,F){var D=this;if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(E,F,{silent:true});}else{mstrmojo.xhr.request("POST",D.path,F,E,undefined,D.XServer,D.baseParams);}}function A(H,I,G,D){var E=this,F={taskId:"createFolder",taskContentType:"json",folderID:H,name:I,description:G};C.call(E,F,D);}function B(E,I,F){if(!E){mstrmojo.alert(mstrmojo.desc(3380));return false;}var G=this,H=G.fId,D={success:function(J){G.contPanel.name.set("value","");G.contPanel.desc.set("value","");if(G.okFn){G.okFn(J,F);}},failure:function(J){if(J.getResponseHeader){mstrmojo.alert(J.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};if(mstrApp.isSingleTier&&this.dp){this.dp.newFolder(H,E,I,D);}else{A.call(G,H,E,I,D);}}mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",navigateAfter:false,okFn:mstrmojo.emptyFn,path:mstrConfig.taskURL,fId:null,children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",alias:"ok",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(!B.call(E,D,F,E.navigateAfter)){E.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.ui.editors.controls.TwoColumnContainer");var C=mstrmojo.Button.newWebButton;function B(){if(this.onRename(this.renameBox.name.value)!==false){this.close();}}mstrmojo.ui.editors.RenameEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ui.editors.RenameEditor",cssClass:"mstrmojo-rename-editor",btnAlignment:"right",renameBox:undefined,renameText:"",helpText:undefined,title:mstrmojo.desc(5740,"Rename"),onRename:mstrmojo.emptyFn,init:function E(F){this._super(F);this.renameBox.name.value=this.renameText;this.helpStrNode.set("text",this.helpText);},postBuildRendering:function(){if(this._super){this._super();}this.renameBox.name.focus();},children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",width:"264px",col1Width:"35px",col2Width:"100%",alias:"renameBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2211,"Name:"),slot:"col1Node"},{scriptClass:"mstrmojo.TextBox",slot:"col2Node",alias:"name",onEnter:function A(){B.call(this.parent.parent);},getLayoutOffsets:function D(){return{h:0,w:2};}}]},{scriptClass:"mstrmojo.Label",autoHide:true,alias:"helpStrNode",cssClass:"helpString"}],buttons:[C(mstrmojo.desc(118,"Save"),function(){B.call(this.parent.parent);},true,{alias:"okBtn",bindings:{enabled:function(){return this.parent.parent.renameBox.name.value!=="";}}}),C(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.close();})]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Editor","mstrmojo.Box","mstrmojo.CheckBox","mstrmojo.Label","mstrmojo.Button");mstrmojo.requiresDescs(4531,8262,12437,12438,12439);var D=mstrmojo.hash;var E={Automatic:0,Manual:3};var I={Automatic:-1,False:0,True:1};var H={Automatic:-1,False:1,True:2};var F={mps:{afb:I.False,sfb:H.False,fbf:E.Automatic}};var B=["mps"],K=function(P,N){var O=this.parent.parent,L=O.cloneModel,M=L.mps||{};if(M[P]!==N){M[P]=N;O.set("dirty",true);}};mstrmojo.ME.DerivedMetricOptions=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.DerivedMetricOptions",cssClass:"mstrmojo-DerivedMetricOptions",dirty:false,init:function J(L){this._super(L);mstrmojo.css.addWidgetCssClass(this,"dme");},updateModel:function C(){var M=this.model,L=this.cloneModel,N=L.mps;if(N.fbf===E.Automatic){N.afb=I.Automatic;N.sfb=H.Automatic;}N.dirty=true;M.mps=L.mps;},onOpen:function A(){var N=this.cloneModel||{};D.make(N,mstrmojo.Obj);var M=mstrmojo.hash.copy(this.model,mstrmojo.hash.copy(F)),O,L;for(O=0,L=B.length;O<L;O++){N.set(B[O],D.clone(M[B[O]]));}this.cloneModel=null;this.set("cloneModel",N);},onClose:function G(){this.set("dirty",false);delete this.cloneModel;},children:[{scriptClass:"mstrmojo.HBox",alias:"fbFlagBox",cssClass:"mstrmojo-DerivedMetricOptions-aggBox",children:[{scriptClass:"mstrmojo.Label",cssText:"white-space: nowrap; margin-right: 8px; vertical-align: top;",text:mstrmojo.desc(12437,"Aggregation And Subtotal Behavior:")},{scriptClass:"mstrmojo.Pulldown",alias:"fbFlag",cssText:"min-width: 100px;",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",itemIdField:"v",items:[{n:mstrmojo.desc(4531,"Automatic"),v:E.Automatic},{n:mstrmojo.desc(8262,"Manual"),v:E.Manual}],bindings:{value:function(){return this.parent.parent.cloneModel.mps.fbf||E.Automatic;}},onvalueChange:function(L){if(L.value!==undefined&&L.valueWas!==undefined){K.call(this,"fbf",L.value);}}}]},{scriptClass:"mstrmojo.Box",cssText:"height: 30px",cssClass:"mstrmojo-DerivedMetricOptions-afbBox",children:[{scriptClass:"mstrmojo.CheckBox",alias:"afb",cssDisplay:"inline-block",label:mstrmojo.desc(12438,"Aggregate From Base"),bindings:{visible:function(){return this.parent.parent.fbFlagBox.fbFlag.value===E.Manual;},checked:function(){return this.parent.parent.cloneModel.mps.afb===I.True;}},onclick:function(L){var M=this.parent.parent.fbFlagBox.fbFlag.value;K.call(this,"afb",M===E.Automatic?I.Automatic:(this.checked?I.True:I.False));}},{scriptClass:"mstrmojo.CheckBox",alias:"sfb",cssDisplay:"inline-block",label:mstrmojo.desc(12439,"Subtotals From Base"),oncheckedChange:function(L){var M=this.parent.afb;if(L.value){M.checked=I.True;M.onclick();if(M.inputNode){M.inputNode.checked=true;M.inputNode.disabled=true;}}else{if(M.inputNode){M.inputNode.disabled=false;}}},bindings:{visible:function(){return this.parent.parent.fbFlagBox.fbFlag.value===E.Manual;},checked:function(){return this.parent.parent.cloneModel.mps.sfb===H.True;}},onclick:function(){var L=this.parent.parent.fbFlagBox.fbFlag.value;K.call(this,"sfb",L===E.Automatic?H.Automatic:(this.checked?H.True:H.False));}}]},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:mstrmojo.desc(2397,"OK"),bindings:{enabled:function(){return this.parent.parent.dirty;}},onclick:function(){var L=this.parent.parent;L.updateModel();if(L.onOK){L.onOK();}L.close();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancel"),onclick:function(){var L=this.parent.parent;L.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Editor","mstrmojo.TextBox","mstrmojo.Label","mstrmojo.Button");var D=mstrmojo.Button.newWebButton;function C(){this.close();this.destroy();}mstrmojo.onetier.vi.prefs.LoginEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.onetier.vi.prefs.LoginEditor",title:mstrmojo.desc(13696,"Login Required"),cssClass:"mstrmojo-ot-prefs-LoginEditor",userName:undefined,password:undefined,loginTitleLabel:undefined,loginTitle:undefined,zIndex:99999,authenticateCredentials:function B(H,G){this.throwAbstractMethodError("authenticateCredentials");},onLoginCancelled:mstrmojo.emptyFn,init:function E(G){this._super(G);if(this.loginTitle){var H=this.loginTitleLabel;H.text=this.loginTitle;H.visible=true;}},onPreClose:function A(){this.onLoginCancelled();return this._super();},children:[{scriptClass:"mstrmojo.Label",text:"",visible:false,cssClass:"login-title",alias:"loginTitleLabel",useRichTooltip:true,getItemTooltip:function(){var G=mstrmojo.dom.position(this.domNode),H="<div>"+mstrmojo.string.encodeHtmlString(this.text,true)+"</div>";return{cssClass:"vi-regular vi-tooltip-C loginEditorTooltip",content:H,top:G.y-10,left:G.x+G.w+9,enableHover:false};},showTooltip:function F(G,H){this.richTooltip=this.getItemTooltip();if(this.richTooltip&&this.text.length>50){this.constructor.prototype.showTooltip.call(this,G,H);}}},{scriptClass:"mstrmojo.TextBox",emptyText:mstrmojo.desc(5135,"User Name"),alias:"userName",cssDisplay:"block"},{scriptClass:"mstrmojo.TextBox",emptyText:mstrmojo.desc(18,"Password"),alias:"password",cssDisplay:"block",type:"password"}],buttons:[D(mstrmojo.desc(26,"Login"),function(){var G=this.parent.parent;G.authenticateCredentials(G.userName.value,G.password.value);C.call(G);},true),D(mstrmojo.desc(221,"Cancel"),function(){var G=this.parent.parent;G.onLoginCancelled();C.call(G);})]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.IconTabList","mstrmojo.vi.ui._HasMask","mstrmojo.vi._MonitorsAppState","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.css");var K=mstrmojo.dom,M=mstrmojo.hash,a=mstrmojo.array,D=mstrmojo.css,p="hidden",A="drop-shadow",u="highlightSelected",v="fadeout";function o(){return(this.children||[]).filter(function(w){return w.slot==="containerNode";});}function f(w){return w.src.data.tabInfo;}function k(w){return(this.children||[]).filter(function(x){return x.alias===w.item.id;})[0];}function l(x,w){D.toggleClass(x.src.data.avatar,p,!w);}function J(w){this.tabList.removeTab(w.alias);this.removeChildren(w);}function n(){K.detachEvent(document,"mousemove",this._checkAndExtractTab);delete this._checkAndExtractTab;}function T(x,z){var w=this.tabList;w.exitDragMode(x);J.call(this,x.panel);l(z,true);if(!x.extractedFromSrcBPC){x.extractedFromSrcBPC=true;n.call(this);}}function I(x,z){this.resetMask();l(z,false);this.addChildren([x.panel]);var w=this.tabList;M.copy(w.addTab(x.item,NaN,true),x);w.enterDragMode(x,z);}function R(w){return w.some(function(x){return x instanceof mstrmojo.vi.ui.VIBoxPropertyEditor;});}mstrmojo.vi.ui.BoxPanelContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.BoxPanelContainer",markupString:'<div id="{@id}" class="mstrmojo-VIBoxPanelContainer {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-VIBoxPanelContainer-header"><div class="mstrmojo-VIBoxPanelContainer-handle"><div mstrAttach:click></div></div><div class="mstrmojo-VIBoxPanelContainer-tabs"></div><div class="mstrmojo-VIBoxPanelContainer-closeBtn" tooltip="'+mstrmojo.desc(1995,"Hide")+'"></div></div><div class="mstrmojo-VIBoxPanelContainer-content"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{headerNode:function(){return this.domNode.firstChild;},handleNode:function(){return this.domNode.firstChild.firstChild;},tabsNode:function(){return this.domNode.firstChild.childNodes[1];},closeNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{handleNode:"11px",tabsNode:"18px",containerNode:"100%"},w:{handleNode:"100%",tabsNode:"100%",containerNode:"100%"},xt:true},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},draggable:true,dropZone:true,headerNode:null,tabsNode:null,tabList:null,model:null,parent:null,slot:"containerNode",children:[{scriptClass:"mstrmojo.vi.ui.IconTabList",slot:"tabsNode",alias:"tabList",selectedIndex:0,tabSelected:function(z){var x=this.parent,w=x.parent;o.call(x).forEach(function(AB){var AA=AB.alias===z.id;AB.set("visible",AA);if(AA){AB.doLayout();}});this.parent.ontabSelected();if(w){w.model.updateRootDefn({root:{layoutXML:w.getBoxLayoutConfig().box}});}}}],init:function q(w){this._super(w);this.tabList.attachEventListener("click",this.id,function(x){var AA=x.src.getItemFromTarget(x.getTarget());var z;this.parent.model.raiseEvent(M.copy({name:"viIconTabClicked",id:AA.id},z));});this.model.attachEventListener("viUnitSelected",this.id,function(x){var AB=mstrmojo.all[x.id],AC=mstrmojo.vi.ui.rw.DocLayoutViewer.getViPanelType,z=null;if(x.isAddAction){z=this[AC(AB.getPanelForAddAction())];}else{var AA=AB?AB.getExcludedPanels().map(function(AE){return AC(AE);}):[];if(AA.indexOf(this.tabList.getSelectedItems()[0].id)>-1){var AD=mstrmojo.vi.ui.BoxPanel.PANEL_TYPES;Object.keys(AD).some(function(AF){var AG=AD[AF],AE=this[AG];if(AE&&AA.indexOf(AG)<0){z=AE;return true;}return false;},this);}}if(z){this.selectPanel(z);}});},postBuildRendering:function Q(){if(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){this.draggable=false;}this._super();},onAppStateChange:function h(w){this._super(w);var x=mstrmojo.vi.VisualInsightApp.APP_STATES;this.set("isMasked",w.value===x.SELECTOR_TARGETING);this.draggable=w.value!==x.PRESENTATION;},getIdentifier:function t(){return this.tabList.getTabIds();},getDragData:function d(x){var AA={},z=x.src.node;if(K.contains(this.tabsNode,z,true,this.domNode)){var w=this.tabList.getDragTabInfo(z);if(w){w.panel=k.call(this,w);AA.tabInfo=w;w.extractedFromSrcBPC=false;}}return AA;},isDragValid:function S(w){return K.contains(this.headerNode,w.src.node,true,this.domNode);},ondragstart:function g(w){if(!f(w)){this.domNode.style.display="none";}this._super(w);},initializeDrag:function B(x){this._super(x);var w=f(x);if(w){if(w.isSingleTab){this.set("visible",false);T.call(this,w,x);}else{this.tabList.enterDragMode(w,x);}}var z=this;this._checkAndExtractTab=function AA(){var AB=f(x);if(AB&&!AB.extractedFromSrcBPC&&x.tgt&&z!==x.tgt.widget){T.call(z,AB,x);}};K.attachEvent(document,"mousemove",this._checkAndExtractTab);},createAvatar:function V(AC,AA){var AD=AA.src.data,w=AD.tabInfo,AB=mstrApp.rootCtrl.view.themeClassName;var z=document.createElement("div");z.className=this.domNode.className+" panelAvatar";z.style.width=this.width;var x=this.headerNode.cloneNode(true);if(w){var AE=Array.prototype.slice.call(x.getElementsByClassName("item"),0);if(w.isSingleTab){D.addClass(AE[0],"selected");}else{AE.forEach(function(AF){if(AF.className.indexOf("selected")===-1){AF.parentNode.removeChild(AF);}else{AF.style.left=0;}});}}z.appendChild(x);D.addClass(z,AB);AD.avatar=z;l(AA,!w||w.isSingleTab);return this.offsetAvatar(z);},cacheCtxtBoxPosition:function m(z){this._super(z);if(f(z)){var AA=z.boxCache[this.id],x=K.position(this.tabsNode),w=x.y;AA.tabTop=w;AA.tabBottom=w+x.h;}},getTargetDropZone:function Y(AA){var AC=this._super(AA),AB=AA.boxCache[this.id],z=AA.tgt.pos.y,x=this.parent.boxLayoutConfig.getBoxPath(this).indexOf("|")>-1,w=z-AB.y<AB.h/2;if(f(AA)){if(z<AB.tabTop){return"Top";}else{if(z<AB.tabBottom){return"Tab";}else{if(x){return w?"Tab":"Bottom";}else{if(AC==="Top"){return"Tab";}return AC;}}}}if(x){return w?"Top":"Bottom";}return AC;},highlightMask:function F(AA,x){var w=f(x);if(w){var z=w.active;if(AA==="Tab"){if(!z){I.call(this,w,x);}this.tabList.dragTab(w,x);return true;}if(z){T.call(this,w,x);}}return this._super(AA,x);},ondragleave:function N(x){this._super(x);var w=f(x);if(w&&w.active){T.call(this,w,x);}},wasDropped:function c(z){var x=f(z);if(x){if(!x.active){var w=new mstrmojo.vi.ui.BoxPanelContainer({model:this.model}),AA=z.box;delete AA.initState;AA.boxId=w.id;this.parent.addChildren([w]);w.addPanel(x.item,x.panel,x.idx,true);}}this._super(z);},ondrop:function Z(z){var x=f(z);if(x){if(x.active){var w=this.tabList;w.pivotTab(x);w.exitDragMode(x);this.doLayout();z.dropSuccessful=true;this.parent.saveBoxLayout();this.setMaskVisibility(false);return ;}z.box.parentPath+="x";}this._super(z);},ondragend:function E(x){if(!f(x)){this.domNode.style.display="block";}this._super(x);if(x.dropSuccessful){var w=o.call(this);if(!w.length){this.parent.removeChildren(this);this.destroy();}}n.call(this);},cancelBoxMove:function U(z){var x=f(z),w=this.tabList;if(!x){return false;}if(x.active){w.exitDragMode(x);return true;}this.addChildren([x.panel]);if(x.isSingleTab){this.set("visible",true);}w.addTab(x.item,x.homeIdx,true);return false;},addPanel:function W(AA,x,w,z){var AC=AA.id,AB=this[AC];if(AB){this.removeChildren(AB);}if(x){x.alias=AC;x.width=this.width;x.visible=!!z;this.addChildren([x]);this.tabList.addTab(AA,w,z);}},removeAllPanels:function H(){var w=o.call(this),z=this.model.getDataService().newUpdateWithoutCmd();z.addExtras(mstrmojo.DocDataService.SUPPRESS_DATA);a.forEach(w,function(AA){AA.setOpenStatus(false,false,z);});var x=z.actions;if(x&&x.length){z.submit();}},removePanel:function P(w,AB,z,AA){J.call(this,w);if(w.alias===mstrmojo.vi.ui.BoxPanel.PANEL_TYPES.FILTERS){w.unrender();}else{w.destroy();}var x=this.parent;if(!z){x.saveBoxLayout(undefined,undefined,undefined,AB);}if(!o.call(this).length){if(z){x.deleteBox(this,AA);}else{x.deleteBoxAndSubmitDeferred(AB,this,undefined,true);}this.destroy();}},highlightSelected:function C(){var w=this;D.addClass(w.domNode,u);w._highlightTimeout=window.setTimeout(function(){D.addClass(w.domNode,v);D.removeClass(w.domNode,u);window.setTimeout(function(){D.removeClass(w.domNode,v);},500);},1000);},removeHighlightSelected:function G(){if(this._highlightTimeout){window.clearTimeout(this._highlightTimeout);}D.removeClass(this.domNode,v);D.removeClass(this.domNode,u);},ontabSelected:function b(){this.removeHighlightSelected();},selectPanel:function L(x){var w=this.tabList;w.doItemSelect(w.items.filter(function(z){return z.id===x.alias;})[0],{});},onclick:function e(w){if(w.getTarget()===this.closeNode){this.removeAllPanels();}var z=this.tabList.selectedItem;var x;this.parent.model.raiseEvent(M.copy({name:"viIconTabClicked",id:z.id},x));},getPanelByType:function O(w){return(this.children||[]).filter(function(x){return x.viPanelType===w;})[0];},addChildren:function X(AA,w,x){var z=this._super(AA,w,x);this.doLayout();return z;},onremoveChild:function(w){if(R((w&&w.value)||[])){D.removeClass(this.domNode,A);}},onaddChild:function(w){if(R((w&&w.value)||[])){var x=this.hasRendered;D[x?"addClass":"addWidgetCssClass"](x?this.domNode:this,A);}},getBoxBorderWidth:function r(){return 2;}});mstrmojo.vi.ui.BoxPanelContainer.boxConfiguration={f:{h:185,v:150},o:"h"};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxPanel","mstrmojo.css");mstrmojo.mstr.VisPropsEditorPanel=mstrmojo.declare(mstrmojo.vi.ui.BoxPanel,[],{scriptClass:"mstrmojo.vi.ui.VIBoxPropertyEditor",layoutConfig:{h:{controlNode:"0px",containerNode:"100%"},w:{controlNode:"0px",containerNode:"all"},xt:true},init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,["mstrmojo-vi-PropEditor","mstrmojo-VisPropertyEditorPanel"]);this.onedtModelChanged();},onedtModelChanged:function A(){var D=this.edtModel,C=D&&D.getEditorContents();if(C){C.forEach(function(E){E.slot="containerNode";});this.contents.addChildren(C);this.contents.attachEventListener("childrenRendered",this.id,this.oneditorContentsRendered);this.doLayout();}},oneditorContentsRendered:function(){window.setTimeout(function(){this.updateScrollbars();}.bind(this),100);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.PopupConfig","mstrmojo.ui.menus.MenuEditor");mstrmojo.ui.menus.EditorConfig=mstrmojo.declare(mstrmojo.ui.menus.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.EditorConfig",data:null,fnOk:null,fnCancel:null,okEnabled:true,cancelEnabled:true,okVisible:true,cancelVisible:true,init:function D(E){this._super(E);if(this.data&&!mstrmojo.all[this.data.id]){mstrmojo.hash.make(this.data,mstrmojo.Obj);}this.initBindings();},clear:function A(){this._super();this.data=null;this.fnOk=this.fnCancel=mstrmojo.emptyFn;},newInstance:function C(){return new mstrmojo.ui.menus.MenuEditor({popupConfig:this});},destroy:function B(){if(this.data){this.data.destroy();}this.destroyBindings();this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors.Slider");mstrmojo.vi.ui.rw.selectors.PageBySlider=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.Slider,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.PageBySlider",slot:"containerNode",preBuildRendering:function A(){var C=this.parent;this.setDimensions(C.height,C.width);return this._super();},setDimensions:function B(D,C){this.height=D;this.width=C;this.synchronizeSlider();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.vi.ui.rw.selectors.Slider","mstrmojo.vi.ui.rw.selectors.SliderHelper","mstrmojo.vi.ui.rw.selectors.MetricValueSliderHelper","mstrmojo.vi.ui.rw.selectors.MetricRankSliderHelper","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.MetricSelectorUtility","mstrmojo.num","mstrmojo.boxmodel");var J=mstrmojo.css,I=mstrmojo.dom,D=mstrmojo.hash,G=mstrmojo.num,F=mstrmojo.MetricSelectorUtility,K=mstrmojo.boxmodel;mstrmojo.vi.ui.rw.selectors.MetricSlider=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.rw.selectors.MetricSlider",updateTypeHelper:function C(){var S=this.qua,R=F.typeHelperCls[S]||F.typeHelperCls.defaultCls,T=D.walk("vi.ui.rw.selectors."+R,mstrmojo);this.typeHelper=new T({slider:this});J[(S!==F.Q._G?"add":"remove")+"WidgetCssClass"](this,"rank");},configureGhost:function H(R){if(!this.staticStatus){return this._super(R);}},initDrag:function N(S,R){if(!this.staticStatus&&!this.da.nov){this._super(S,R);}},ondrag:function Q(S,R){if(!this.staticStatus){this._super(S,R);}},ondrop:function L(R){if(!this.staticStatus&&!this.da.nov){this._super(R);}},onclick:function P(R){var S=R.getTarget();if(S===this.handle1Node||S===this.handle2Node){window.clearTimeout(this._tooltipTimeOut);this.hideTooltip();this.openPopup("editValueRef",{tgt:S});}else{this._super(R);}},onincludeChange:function B(){if(!this.staticStatus){this.changeInclude=true;this.onselectionChange();}},onquaChange:function O(R){var U=R.valueWas,V=R.value,S=F.getFuncInfo(this.opId,U),T=F.getFuncInfo(this.opId,V);if(S.ft!==T.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();}}else{this.f=F.getFuncInfo(this.opId,R.value).f;}this.changeQual=true;this.onselectionChange();},updateData:function E(R,S){this.da=R;this.updateExpr(S);},updateExpr:function A(R){if(R){this.cs=R.cs;this.f=R.f;this.ft=R.ft;this.qua=R.qua;}this.refresh();},editValueRef:{cssClass:"edvl mstrmojo-Tooltip",contentNodeCssClass:"mstrmojo-Tooltip-content",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){var U=this.opener,S=this.edt,T=(this.tgt===U.handle1Node),R=K.offset(U.tooltipNode[T?0:1]);J.addClass(this.domNode,U.richTooltip.cssClass);this.set("left",R.left+"px");this.set("top",R.top-this.containerNode.offsetHeight+"px");S.set("value",G.toLocaleString(T?U.cs1Vl:U.cs2Vl));I.setInputSelection(S.inputNode);},onClose:function(){this.opener.set("validation",{invalid:false,position:1});},children:[{scriptClass:"mstrmojo.TextBox",alias:"edt",apply:function(){var U=this.parent,W=U.opener,S=W.typeHelper,V=(U.tgt===W.handle1Node),R=G.parseNumeric(this.value);if(String(R).length>0){R=R<W.low?W.low:(R>W.high?W.high:R);W[V?"cs1Vl":"cs2Vl"]=S.fixDigitByNumFormat(R,W.numFmts);W.onselectionChange();S.updateThumb();U.close();}},onEnter:function(){var S=this.parent.opener,R=F.doValidation(this.value,S,{refNode:this.parent.domNode,position:1});if(R.invalid){S.set("validation",R);}else{this.apply();}}}]},showTooltip:function M(S,R){if(!this.editValueRef.visible){this._super(S,R);}}});mstrmojo.vi.ui.rw.selectors.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.Menu","mstrmojo.hash","mstrmojo.array");mstrmojo.ui.menus.MenuItemType=null;var U="separator";mstrmojo.ui.menus.MenuConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.MenuConfig",menus:null,menuCssClass:"",supportsScroll:false,maxHeight:0,hasMenuItems:function Q(){return !!this.menus.length;},getMenuItems:function E(V){return mstrmojo.array.filter(this.menus.slice().reverse(),function(Z,Y,X){var W=X[Y+1];return V||Z.cls!==U||(Y&&W&&W.cls!==U);}).reverse();},getMenuItem:function C(Y){var X=this.menus,V;if(X!==null){for(V=0;V<X.length;V++){var W=X[V];if(W.cls===Y){return W;}}}return null;},absorbMenuItems:function S(V){this.menus=this.menus.concat(V.menus);},addMenuItem:function I(c,Y,a,W,Z){var b,X,V;if(!c||typeof c==="string"){b=c;}else{b=c.n;X=c.ttp;}V={n:b,ttp:X,cls:Y,fn:a,ctxt:W};if(isNaN(Z)||Z>=this.menus.length){this.menus.push(V);}else{this.menus.splice(Z,0,V);}return V;},addCustomMenuItem:function T(a,X,Z,W,V){var Y=this.addMenuItem(a,X,Z,V);Y.getItemMarkup=W;return Y;},addDisabledMenuItem:function O(W,V){this.addNonInteractiveMenuItem(W,V,true);},addNonInteractiveMenuItem:function M(Z,W,V){var X=["non-int"];if(W){X.push(W);}if(V){X.push("disabled");}var Y=this.addMenuItem(Z,X.join(" "),mstrmojo.emptyFn);Y.dsbld=true;},addSeparator:function D(){this.addMenuItem("",U,function(){return false;});},addPopupMenuItem:function R(c,X,b,Y,W,Z){var a=["pop "];if(Y){a.push(Y);}var V=this.addMenuItem(c,a.join(" "),b,W,Z);V.pop=true;V.scope=X;return V;},addActionPopupMenuItem:function L(c,W,a,b,X,V,Z){var Y=this.addPopupMenuItem(c,W,b,(X||"")+" ax",V,Z);Y.actionFn=a;Y.ax=true;},addSubMenuItem:function K(Z,X,W,Y,V){this.addPopupMenuItem(Z,W,Y,X,V);},addEditorMenuItem:function P(Z,W,Y,V,X){this.addPopupMenuItem(Z,W,Y,"",V,X);},getToggleItemStates:function F(d,f,V,b,X,a){var Y,Z,W,c;if(typeof d==="string"){Y=Z=d;W=c="";}else{Y=d.on||"";Z=d.off||"";W=d.ttpOn||"";c=d.ttpOff||"";}var e=[{n:Y,ttp:W,cls:f+" on",fn:b,ctxt:a},{n:Z,ttp:c,cls:f,fn:V,ctxt:a}];if(!X){e.reverse();}return e;},addToggleMenuItem:function J(c,Y,a,X,W,b,V){var Z=this.getToggleItemStates(c,Y,a,X,b,V);return this.addDualStateItem(W,Z[0],Z[1]);},addDualStateItem:function G(W,V,X){return this.addMenuItem({n:V.n,ttp:V.ttp},V.cls,this.getDualStateHandler(W,V,X),V.ctxt);},getDualStateHandler:function H(W,V,X){return function(Z,a){var Y=[V,X];if(Z.cls===V.cls){Y.reverse();}Y[1].fn.call(mstrmojo.all[W],Z,a);Z.n=Y[0].n;Z.ttp=Y[0].ttp;Z.cls=Y[0].cls;};},addRadioMenuGroup:function B(X,c,Y,W,V,b,a){var Z=[];Y.forEach(function(g,d){if(g.separator){this.addSeparator();return ;}var k=g.text,h=(W||"")+" "+(g.cls||"")+(b?"":" radio")+(g.value===X?" on":""),f=function(){if(c.call(this.ctxt,g.value,X,g)===false){return false;}X=g.value;Z.forEach(function(l){l.cls=l.cls.replace(/ on$/,"")+(l.radioValue===X?" on":"");});return true;},e=a?this.addCustomMenuItem(k,h,f,a(g,d),V):this.addMenuItem(k,h,f,V);e.radioValue=g.value;Z.push(e);},this);},clear:function N(){this._super();this.menus=[];},newInstance:function A(V){return new mstrmojo.ui.menus.Menu(mstrmojo.hash.copy({popupConfig:this},V));}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.ui.menus.Menu","mstrmojo._IsList","mstrmojo.vi.ui._HasMask","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui._HasListTooltip");var F=mstrmojo.dom;mstrmojo.vi.ui.toolbars.Toolbar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",tooltipOrientation:"vertical",init:function G(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIToolbar");},selectionPolicy:"reselect",toolbarCfg:null,toolbarClicked:mstrmojo.emptyFn,tooltipCss:null,_set_toolbarCfg:function(L,I){var J=this.toolbarCfg,K=(J!==I);if(K){if(J){J.destroy();}this.toolbarCfg=I;}return K;},getItemProps:function D(K,I){var J=this._super(K,I);J.addCls(K.cls);J.addStyle("display:inline-block");return J;},postBuildRendering:function C(){var I=document.createElement("div");I.className="mstrmojo-VIDND-mask";this.maskNode=this.domNode.appendChild(I);return this._super();},postselectionChange:function(I){var J=I.added;if(J){var K=this.items[J[0]];if(K.tp==="pb"&&K.isMenuClicked){K.menufn(K,this);}else{K.fn(K,this);}}},ontoolbarCfgChange:function H(I){var K=I.valueWas;if(K){K.destroy();}var J=I.value;if(!J){return ;}this.set("items",J.btns);if(this.hasRendered){this.raiseEvent({name:"renderComplete"});}},openMenu:function E(J,I){J.hostId=this.id;J.hostElement=this._getItemNode(I._renderIdx);this.openPopup(J.newInstance());},onclick:function A(I){var K=I.target||F.eventTarget(I.hWin,I.e),J=this.getItemFromTarget(K);if(J&&J.tp==="pb"){if(K&&K.className){J.isMenuClicked=K.className.indexOf("icn")===-1;}}this.toolbarClicked(I);this._super(I);},destroy:function B(J){var I=this.toolbarCfg;if(I){I.destroy();}delete this.items;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo.ui._IsPulldown","mstrmojo.ui.PopupList","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var I=mstrmojo.css,G=mstrmojo.array,F=mstrmojo.dom;mstrmojo.ui.Pulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown],{scriptClass:"mstrmojo.ui.Pulldown",onitemSelected:mstrmojo.emptyFn,allowHTML:true,init:function N(O){this._super(O);I.addWidgetCssClass(this.list,"ctrl-popup-list");},initChildren:function E(){this.children=this.getPopupListConfig();this._super();},getSelectedItem:function H(){var O=this.items;return O&&O[this.selectedIndex];},selectItemByField:function J(P,O){this.set("selectedIndex",G.find(this.items||[],P,O));},getPopupWidget:function D(){return this.list;},getPopupList:function K(){return this.list;},_set_items:function B(R,O){var Q=this.items;this.items=O;delete this.selectedIndex;if(Q!==O){var P=this.hasRendered;if(P){this.refresh();}return true;}return false;},onclick:function M(O){this._super(O);var Q=this,P=Q.getPopupWidget();Q.mw=Q.mw||function(R){if(!F.contains(P.domNode,F.eventTarget(self,R),true,document.body)){P.close();F.detachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Q.mw);}};F.attachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Q.mw);},_set_selectedIndex:function A(T,R){if((R!==0&&!R)||R<0){return false;}var P=this.selectedIndex=R,O=this.getPopupList(),Q=O.items,S=this.selectedNode;O.set("selectedIndex",P);if(S&&Q&&Q[P]){S.innerHTML=this.allowHTML?Q[P].n:mstrmojo.string.encodeHtmlString(Q[P].n);S.title=Q[P].title||"";}this.onitemSelected(Q[P],P);return true;},getPopupListConfig:function C(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,listHooks:{select:function O(R,S,Q){this.parent.set("selectedIndex",Q);this.close();}},getItemProps:function P(S,Q){var R=mstrmojo._IsList.getItemProps.call(this,S,Q);R.style=this.parent.itemCssText||"";return R;}};},children:[]});mstrmojo.ui.Pulldown.newPulldown=function L(P,T,O,S,R){S=S||{};S.items=P;var Q;if(R===true){Q=mstrmojo.hash.copy({scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:O||0},S);}else{Q=new mstrmojo.ui.Pulldown(S);if(O!==undefined){Q.set("selectedIndex",O);}}Q.postselectedIndexChange=function(U){var X=U.value,W=U.valueWas;if(X!==W){var V=this.items;T.call(this,V[X],V[W]);}};return Q;};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.PopupList","mstrmojo.array","mstrmojo.css");var F=mstrmojo.css,E=mstrmojo.array;mstrmojo.ui.editors.controls.ListPreviewButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ListPreviewButton",init:function G(L){this._super(L);var M=this.getListCfg(),K=this.itemValueField;M.alias="list";M.locksHover=true;M.slot="widgetHostNode";M.listHooks={select:function J(N,O){this.parent.set("selectedValue",O[K]);this.close();}};M.setDimensions=mstrmojo.emptyFn;this.addChildren([M]);F.addWidgetCssClass(this.list,"ctrl-popup-list");},getPopupWidget:function D(){return this.list;},items:null,onitemsChange:function H(){var J=this.items;if(J){this.list.set("items",J);}},selectedValue:"",itemValueField:"n",onselectedValueChange:function C(){var K=this.selectedValue,J=this.itemValueField,L=this.list;L.selectItems(E.filter(L.items||[],function(M){return M[J]===K;}),true);this.updatePreview();},updatePreview:function B(){throw new Error(this.scriptClass+" must implement updatePreview.");},getListCfg:function I(){return{scriptClass:"mstrmojo.ui.PopupList",selectionPolicy:"reselect"};},postBuildRendering:function A(){this.onitemsChange();this.onselectedValueChange();return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo.vi.ui.rw._ValidInputLocalImage","mstrmojo.imageUtils");var A;$IMGUTIL=mstrmojo.imageUtils;mstrmojo.vi.ui.ImageEditorPanelImagePicker=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi.ui.rw.selectors._HasWarningMessage,mstrmojo.vi.ui.rw._ValidInputLocalImage],{scriptClass:"mstrmojo.vi.ui.ImageEditorPanelImagePicker",cssClass:"",markupString:'<div class=\'mstrmojo-ImageEditorModel-ImagePicker {@cssClass}\'><label><input style="position: absolute; left: -10000px" type="file" accept=".png, .jpg, .jpeg, .gif, .bmp" onchange="mstrmojo.all.{@id}.syncFile();"/><div class="browseBtnLabel"></div></label></div>',markupSlots:{containerNode:function(){return this.domNode;},fileNode:function(){return this.domNode.children[0].firstChild;},browseBtnNode:function(){return this.domNode.children[0].lastChild;}},children:[mstrmojo.Button.newActionButton(mstrmojo.desc(1825,"Browse"),function(){if(mstrApp.isSingleTier){A=this.parent;var C=window.FormWrapper;C.openImageFileDialog("mstrmojo.vi.ui.ImageEditorPanelImagePicker.onOneTierFileSelected");}},{alias:"browseBtn",slot:"browseBtnNode",enabled:true})],init:function B(C){this._super(C);this.bindWarningHandler(this);},validationFailed:function(){this._super();this.set("validation",this.getValidationObj());},syncFile:function(){if(this.fileNode.files.length===1){var C=this.fileNode.files[0];this.fileSelected.call(this,C);}}});mstrmojo.vi.ui.ImageEditorPanelImagePicker.onOneTierFileSelected=function(E){if(E&&E.data&&E.filename){var D=";base64,";if(E.data.indexOf(D)===-1){E.data="data:image/jpeg;base64,"+E.data;}var C=$IMGUTIL.dataURLToBlob(E.data);var F={fileBlob:C,name:E.filename};A.fileSelected.call(A,F);}};}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.hash","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo.vi.ui.rw._ValidInputLocalImage","mstrmojo.Box","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo.Label","mstrmojo.Button","mstrmojo.TextBox","mstrmojo.dom","mstrmojo.imageUtils");mstrmojo.requiresDescs(1825,1442,14552);var G=mstrmojo.string,H=mstrmojo.imageUtils,D;mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo.vi.ui.rw.selectors._HasWarningMessage,mstrmojo.vi.ui.rw._ValidInputLocalImage,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded",markupString:'<div id="{@id}" class="mstrmojo-ImageBoxOverlayEmbeded {@cssClass}" style="{@domNodeCssText}" mstrAttach:dragover,dragleave,drop><div class="container-scroll-host"><div class="container"><div class="lbl"></div><div class="txt"></div><div class="buttons"><label><input class="mstrmojo-imageBoxOverlayEmbeded-file" type="file" accept=".png, .jpg, .jpeg, .gif, .bmp" onchange="mstrmojo.all.{@id}.syncFile();"/><div class="browseBtnLabel"></div></label><div class="okBtn"></div></div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.firstChild.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.firstChild.children[1];},fileNode:function(){return this.domNode.firstChild.firstChild.children[2].firstChild.firstChild;},browseBtnNode:function(){return this.domNode.firstChild.firstChild.children[2].firstChild.lastChild;},okButtonNode:function(){return this.domNode.firstChild.firstChild.children[2].lastChild;}},postBuildRendering:function A(){this._super();this.bindWarningHandler(this);},setupScrollNodes:function B(){this.scrollNode=this.containerNode;},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},formatHandlers:{domNode:["BG"]},imageBox:undefined,imgURL:undefined,origURLStr:undefined,droppable:true,ondragover:function C(J){if(!this.droppable){return ;}var L=J.e;L.stopPropagation();L.preventDefault();var K=L.dataTransfer.items;if(K){L.dataTransfer.dropEffect=this.VALID_MIME_TYPES.indexOf(K[0]&&K[0].type)!==-1?"copy":"none";}mstrmojo.css.addClass(this.dnDNode,"dragging");},ondragleave:function I(){if(!this.droppable){return ;}this.className="";mstrmojo.css.removeClass(this.dnDNode,"dragging");},ondrop:function E(J){if(!this.droppable){return ;}var M=J.e;M.preventDefault();var L=M.dataTransfer.files;mstrmojo.css.removeClass(this.dnDNode,"dragging");if(L&&L.length>0){var K=L[0];this.fileSelected.call(this,K);}},children:[{scriptClass:"mstrmojo.Label",slot:"labelNode",cssClass:"init-label"},mstrmojo.Button.newActionButton(mstrmojo.desc(1442,"OK"),function(){var J=this.parent;if(J.imgURL.value!==J.origURLStr){J.imageBox.urlEdited(J.imgURL.value);}else{J.imageBox.hideControlOverlay();}},{alias:"okBtn",slot:"okButtonNode",enabled:false}),{scriptClass:"mstrmojo.TextBox",cssClass:"init-input",alias:"imgURL",slot:"textNode",hint:mstrmojo.desc(14552,"Enter an image URL or choose a file."),draggable:true,ownAvatar:true,onkeydown:function(J){if(J.e.keyCode===13){var K=this.parent;if(K.imgURL.value!==K.origURLStr){K.imageBox.urlEdited(this.value);}else{K.imageBox.hideControlOverlay();}}},getLayoutOffsets:function F(){return{h:0,w:2};},_set_value:function(M,J){var K=this.value;if(K!==J){this.value=J;var L=this.parent.okBtn;L.set("enabled",!G.isEmpty(J));L.set("iconClass",!G.isEmpty(J)?"hot":"");}}},mstrmojo.Button.newActionButton(mstrmojo.desc(1825,"Browse"),function(){if(mstrApp.isSingleTier){D=this.parent;var J=window.FormWrapper;J.openImageFileDialog("mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded.onOneTierFileSelected");}},{alias:"browseBtn",slot:"browseBtnNode",enabled:true})],validationFailed:function(){this._super();var J=this.getValidationObj();if(J){J.refNode=this.textNode;}this.set("validation",J);this.okBtn.set("enabled",false);this.okBtn.set("iconClass","");},validationSuccess:function(J){this._super(J);this.okBtn.set("enabled",true);this.okBtn.set("iconClass","hot");},syncFile:function(){if(this.fileNode.files.length===1){var K=this.fileNode.files[0];var J=K.size/1024;this.imgURL.set("value",K.name+" - "+J.toFixed(2)+"KB");this.fileSelected.call(this,K);}}});mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded.onOneTierFileSelected=function(L){if(L&&L.data&&L.filename){var K=";base64,";if(L.data.indexOf(K)===-1){L.data="data:image/jpeg;base64,"+L.data;}var J=H.dataURLToBlob(L.data);D.imgURL.set("value",L.filename);var M={fileBlob:J,name:L.filename};D.fileSelected.call(D,M);}};}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricSelectorUtility","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo._FormatDefinition.NumberFormatCategory","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var U=mstrmojo.dom,N=mstrmojo.hash,S=mstrmojo.MetricSelectorUtility,k=mstrmojo._FormatDefinition.NumberFormatCategory,J=mstrmojo.desc,V=mstrmojo.css,X=mstrmojo.num,B=Math,b=B.max,H=B.min,d=B.floor,W=B.round,Z=9;function M(AC,AB,z,x){var AA="px",r=AC._length,p=AC.handleSize,o=AC.orCfg,AG=o.posCssP,t=o.lenCssP,u=false;z=b(z,-1);x=H(x+Z,r);if(z>x){u=true;}var AD=H(z,x),AE=b(z,x),AF=AE-AD-(u?0:p+Z),v=b(parseInt(AC[t],10)-(2*AC.cssBkBW)-(AE+p),0)-Z;if(AC.hasRendered){AB.handle1Node.style[AG]=z+AA;AB.handle2Node.style[AG]=(x-Z)+AA;var n=AB.lowerRange.style,w=AB.thumbNode.style,q=AB.upperRange.style;n[AG]=0;w[AG]=(AD+(u?0:p))+AA;q[AG]=(AE+p-Z)+AA;n[t]=b(AD,0)+AA;w[t]=AF+AA;q[t]=v+AA;}else{AA+=";";AG+=":";t+=":";AC.handle1CssText=AG+z+AA;AC.handel2CssText=AG+(x-Z)+AA;AC.lowerRangeCssText=t+b(AD,0)+AA;AC.thumbCssText=AG+(AD+p)+AA+t+AF+AA;AC.upperRangeCssText=AG+(AE+p-Z)+AA+t+v+AA;}return{handle1:z,handle2:x};}function O(n){this.getUnit=function(){return n._length/b((n.items.length-1),1);};this.calcMinMax=function(q,p){var r=n.unit;return{min:d(q/r+0.5),max:d(p/r+0.5)};};this.calcPxIdx=function(p){return d(p/n.unit+0.5);};this.getStep=function(){var q=n.high-n.low,p=parseInt(n.numFmts.cat,10),r=(p===4)?2:(p===5)?4:0;q=(q===0)?1:q;if(q>1){return(q>(n._length-2))?Number(Number(q/(n._length-2)).toFixed(n.numFmts.dp+r)):1;}return q/(n._length-2);};this.getIdx=function(p){return H(b(W((p-n.low)/n.step),0),n.items.length-1);};this.initialMetricSlider=function o(){var u=function(AI){return AI!==undefined&&AI!==null;},r=function(AI){return(u(AI.da)&&u(AI.da.low)&&u(AI.da.high)&&u(AI.da.cnt)&&u(AI.f)&&u(AI.ft)&&u(AI.qua));},q=function(AI){var AM=true,AL=true,AJ=parseInt(AI.ft,10),AK=parseInt(AI.f,10);if(AJ===S._GENERIC){AM=AK!==S.FN.ISNULL&&AK!==S.FN.ISNOTNULL&&AK!==S.FN.NOTIN&&AK!==S.FN.IN;}else{if(AJ===S._PERCENT||AJ===S._RANK){AL=AK!==S.MRPFN.INASCENDING&&AK!==S.MRPFN.INDESCENDING&&AK!==S.MRPFN.NOTINDESCENDING&&AK!==S.MRPFN.NOTINASCENDING;}}return !AM||!AL;},AF=0;n.include=n.parent.include;n.clsType="scm ";n.staticStatus=!(u(n.da)&&u(n.da.low)&&u(n.da.high)&&u(n.da.cnt)&&u(n.qua));if(n.staticStatus){n.da.low=1;n.da.high=7;n.ft=S._GENERIC;n.f=S.FN.BETWEEN;n.qua=S.Q._G;n.cs=[{n:"",v:1},{n:"",v:7}];n.numFmts={cat:9,dp:0,fm:""};}switch(n.qua){case 0:var AE=parseInt(n.numFmts.cat,10);AF=AE===4?2:AE===5?4:0;n.low=Number(Number(n.da.low).toFixed(n.numFmts.dp+AF));n.high=Number(Number(n.da.high).toFixed(n.numFmts.dp+AF));break;case 1:case 2:n.low=1;n.high=n.da.cnt;break;case 3:case 4:n.low=0;n.high=100;break;}var AH=!n.staticStatus&&!n.da.nov;n.set("lowText",AH?n.formatNumber(n.low):"");n.set("highText",AH?n.formatNumber(n.high):"");n.step=(n.qua===1||n.qua===2)?1:this.getStep();n.low-=n.step;n.high+=n.step;n.cs1Vl=n.low;n.cs2Vl=n.high;var t=n.low,AA=n.high,AG=[],AC=0;if(u(t)&&u(AA)){var w=t,z;for(z=0;w<=AA;z++,w+=n.step){AG[z]={n:S.formatNumber(n.qua,w,n.numFmts),v:Number(Number(w).toFixed(n.numFmts.dp+AF))};}AC=AG.length;if(AC>0&&AG[AC-1].v!==AA){AG[AC-1]={n:S.formatNumber(n.qua,AA,n.numFmts),v:AA};}}n.items=AG;var p=S.OP,AB=n.cs,x=(AB&&AB.length>0)?X.parseNumeric(String(AB[0].v).replace("%","")):t,v=(AB&&AB.length>1)?X.parseNumeric(String(AB[1].v).replace("%","")):AA;if(x<n.low){n.frtUst=true;}if(v>n.high){n.ndUst=true;}n.opId=(n.f!==null&&n.ft!==null)?S.getOpIdxByfunc(n.f,n.ft):p._BETWEEN;switch(n.opId){case p._EQUALS:case p._NOT_EQUALS:n.cs1Vl=n.cs2Vl=x;break;case p._LESS_EQUAL:case p._GREATER:n.cs1Vl=t;n.cs2Vl=x;break;case p._GREATER_EQUAL:case p._LESS:n.cs1Vl=x;n.cs2Vl=AA;break;case p._IN:case p._NOT_IN:case p._IS_NULL:case p._IS_NOT_NULL:break;default:n.cs1Vl=x;n.cs2Vl=v;break;}n.cs1Idx=this.getIdx(n.cs1Vl);n.cs2Idx=this.getIdx(n.cs2Vl);var AD=parseInt(n.dt,10);n.cs1Nm=u(n.cs1Vl)?S.formatNumber(n.qua,n.cs1Vl,n.numFmts):n.items[n.cs1Idx].n;n.cs2Nm=u(n.cs2Vl)?S.formatNumber(n.qua,n.cs2Vl,n.numFmts):n.items[n.cs2Idx].n;n.unit=this.getUnit();n.set("unSet",(!r(n)||q(n)||(!n.cs||n.cs.length===0))&&!n.staticStatus);};this.updateOpCs=function(){var t=(n.cs1Vl>n.cs2Vl)?n.cs2Vl:n.cs1Vl,z=(n.cs1Vl>n.cs2Vl)?n.cs1Vl:n.cs2Vl,r=n.low,v=n.high,x=n.include,p=S.OP,u=parseInt(n.qua,10),q=(u===S.Q._PT||u===S.Q._PB),AA,w=[];if((t>=r&&z<=v)||t<r||z>v){n.opId=x?p._BETWEEN:p._NOT_BETWEEN;}if(t===z){n.opId=x?p._EQUALS:p._NOT_EQUALS;}if(t===r&&z<v){n.opId=x?p._LESS_EQUAL:p._GREATER;}if(t>r&&z===v){n.opId=x?p._GREATER_EQUAL:p._LESS;}AA=r==t&&z==v;if(!AA){switch(n.opId){case p._BETWEEN:case p._NOT_BETWEEN:w.push({dtp:5,v:X.toLocaleString(t)+(q?"%":"")});case p._EQUALS:case p._NOT_EQUALS:w.push({dtp:5,v:X.toLocaleString(z)+(q?"%":"")});break;default:if(t>r){w.push({dtp:5,v:X.toLocaleString(t)+(q?"%":"")});}if(z<v){w.push({dtp:5,v:X.toLocaleString(z)+(q?"%":"")});}}}n.cs=w;n.parent.node.data.cs=w;n.set("unSet",AA);};this.updateThumb=function(){var p=n.cs1Idx,t=n.cs2Idx;if(p!==undefined&&t!==undefined){var q=n.unit,r=n.gap;N.copy(M(n,n,W(p*q-r),W(t*q-r)),n);}};this.joinConst=function(){var r=n.cs;if(r){var p=[],q;for(q in r){p.push(r[q].v);}return p.join(",");}};}var E="<span {@ttpCssText}>{@content}</span>";function D(){if(this.staticStatus){return null;}var q=this.ghost;if(!q){var u=this.containerNode.cloneNode(true),t=u.childNodes;V.addClass(u,["gh"]);q=this.ghost={containerNode:u,lowerRange:t[0],handle1Node:t[1],thumbNode:t[2],handle2Node:t[3],upperRange:t[4]};this.sdcNode.appendChild(u);}var o=this.orCfg,n=o.posCssP,p=o.lenCssP,r=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(AA,v){var z=mstrmojo.all[r],x=z[AA].style,w=q[AA].style;if(v){w[n]=x[n];}w[p]=x[p];});q.containerNode.style.display="block";return q;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style=""><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:9px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:9px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},sliderNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);}},init:function f(n){this._super(n);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new O(this);this.useRichTooltip=false;},typeHelper:null,unSet:false,preBuildRendering:function A(){var q=this.orCfg,p=this.isHoriz;q.cPosCssP=p?"right":"bottom";q.cLenCssP=p?"height":"width";var u=q.lenCssP,t=this[u],r=parseInt(t,10),o=this.handleSize;var n=this._length=(isNaN(r))?0:(r-o-Z);if(n<=0){n=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-o;}if(t){this.bkCssText=u+":"+b(r-(2*this.cssBkBW),0)+"px;";this.sdcCssText=q.posCssP+":"+Z+"px;"+u+":"+n+"px;"+q.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function R(){this._super();if(!this.staticStatus&&!this.da.nov){var o=this.lowNode,n=parseInt(o.style.fontSize,10);if(isNaN(n)){o.style.fontSize=8*this.parent.model.getZoomFactor()+"pt";}this.updateSummary();}this.lowNode.style.marginLeft=Z+"px";this.highNode.style.marginRight=Z+"px";this.sliderNode.style.height="0px";},onmouseover:function G(n){this.showTooltip(n.e,self);},onmouseout:function e(n){this.hideTooltip(n.e,self);},summaryLabels:{db:J(8153,"Between ## and ###"),dnb:J(8154,"Not between ## and ###"),din:J(587,"In"),dnin:J(2204,"Not in"),dnull:J(2202,"Is Null"),dnnull:J(2203,"Is not Null"),req:J(8155,"Rank ="),rneq:J(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:J(8157,"Rank exclude bottom"),rext:J(8158,"Rank exclude top"),rb:J(8159,"Rank bottom"),rt:J(8160,"Rank top"),rbt:J(8161,"Rank between ## and ###"),rnbt:J(8162,"Rank not between ## and ###"),rin:J(8163,"Rank in"),rnin:J(8164,"Rank not in"),peq:J(8165,"Percent ="),pneq:J(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:J(8167,"Exclude bottom"),pext:J(8168,"Exclude top"),pb:J(7576,"Bottom"),pt:J(7575,"Top"),pbt:J(8153,"Between ## and ###"),pnbt:J(8154,"Not between ## and ###"),pin:J(8169,"Percent in"),pnin:J(8170,"Percent not in")},formatNumber:function g(u){var p=this,AA=Math.abs(u),z=p.numFmts.cat,o=1000,AB=["K","M","B","T","P","E","Z","Y"],w=AB.length,t;if(AA>=o&&(z===k.Default||z===k.Fixed||z===k.General||z===k.Currency)){for(t=0;t<w;t++,o*=1000){if(AA<o*1000){var n=AA/o,r=(n*10).toFixed(0)%10>0?1:0,x=n.toFixed(r)+AB[t];return u<0?"("+x+")":x;}}}return S.formatNumber(p.qua,u,p.numFmts);},updateSummary:function L(){if(this.summaryNode&&!this.staticStatus){var AH=this.f,p=this.ft,AG=S,AB=S.FN,o=S.MRPFN,x="",AE=(this.cs1Vl<this.cs2Vl)?this.cs1Vl:this.cs2Vl,AC=(this.cs1Vl>this.cs2Vl)?this.cs1Vl:this.cs2Vl,v=this.formatNumber(AE),u=this.formatNumber(AC),t=this.typeHelper,w=this.summaryLabels,n=parseInt(p,10),q=parseInt(AH,10),AD=(n===AG._GENERIC&&(q===AB.ISNULL||q===AB.ISNOTNULL||q===AB.NOTIN||q===AB.IN))||((n===AG._PERCENT||n===AG._RANK)&&(q===o.INASCENDING||q===o.INDESCENDING||q===o.NOTINDESCENDING||q===o.NOTINASCENDING));if(this.unSet||AE<=this.low&&AC>=this.high&&this.include){x=mstrmojo.desc(2058,"All");}if(!this.unSet||AD){switch(p){case AG._GENERIC:switch(AH){case AB.EQUALS:x="= "+v;break;case AB.NOTEQUALS:x=String.fromCharCode(8800)+" "+v;break;case AB.GREATERTHAN:x="> "+u;break;case AB.GREATERTHANEQUALS:x=String.fromCharCode(8805)+" "+v;break;case AB.LESSTHAN:x="< "+v;break;case AB.LESSTHANEQUALS:x=String.fromCharCode(8804)+" "+u;break;case AB.BETWEEN:x=v+" - "+u;break;case AB.NOTBETWEEN:x=mstrmojo.desc(1099)+" "+v+" - "+u;break;case AB.ISNULL:x=w.dnull;break;case AB.ISNOTNULL:x=w.dnnull;break;case AB.IN:x=w.din+" "+t.joinConst();break;case AB.NOTIN:x=w.dnin+" "+t.joinConst();break;}break;case AG._PERCENT:case AG._RANK:var AF="r";if(parseInt(p,10)===AG._PERCENT){AF="p";}switch(AH){case o.EQUALSDESCENDING:case o.EQUALSASCENDING:x=w[AF+"eq"]+" "+v;break;case o.NOTEQUALSDESCENDING:case o.NOTEQUALSASCENDING:x=w[AF+"neq"]+" "+v;break;case o.GREATERTHANEQUALSASCENDING:x=w[AF+"exb"]+" "+v;break;case o.GREATERTHANASCENDING:x=w[AF+"exb"]+" "+u;break;case o.GREATERTHANEQUALSDESCENDING:x=w[AF+"ext"]+" "+v;break;case o.GREATERTHANDESCENDING:x=w[AF+"ext"]+" "+u;break;case o.LESSTHANASCENDING:x=w[AF+"b"]+" "+v;break;case o.LESSTHANEQUALSASCENDING:x=w[AF+"b"]+" "+u;break;case o.LESSTHANDESCENDING:x=w[AF+"t"]+" "+v;break;case o.LESSTHANEQUALSDESCENDING:x=w[AF+"t"]+" "+u;break;case o.BETWEENDESCENDING:case o.BETWEENASCENDING:x=w[AF+"bt"].replace("##",v).replace("###",u);break;case o.NOTBETWEENASCENDING:case o.NOTBETWEENDESCENDING:x=w[AF+"nbt"].replace("##",v).replace("###",u);break;case o.INASCENDING:case o.INDESCENDING:x=w[AF+"in"]+" "+t.joinConst();break;case o.NOTINDESCENDING:case o.NOTINASCENDING:x="";x=w[AF+"nin"]+" "+t.joinConst();break;}break;}}var z=this.summaryNode,AA=(x!=="")?"":0;z.innerHTML=x;z.style.margin=AA;}},getClientHeight:function T(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function l(r,n){if(!this.staticStatus&&!this.da.nov){n=n||window;var t=U.eventTarget(n,this.dnd.startE);if(t===this.handle1Node||t===this.handle2Node){var q=D.call(this),o=this.orCfg,p=this.dnd;p.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10)-Z,length:this._length,contL:q.containerNode[o.lenP],offset:U.getMousePosition(this.dnd.startE,n)[o.offsetP]};p.initD.td=t;V.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function K(u,t){if(!this.staticStatus){t=t||window;var w=this.dnd.initD;if(w){var AD=this.ghost,AE=w.handle1,q=w.handle2,r=this.cs1Idx,p=this.cs2Idx,AB=this.unit,z=this.gap,o=w.length;var AA=U.getMousePosition(u,t)[this.orCfg.offsetP]-w.offset;switch(w.td){case this.handle1Node:AE=b(H(b(w.handle1+AA,0),o)-z,-1);r=b(d(AE/AB+0.5),0);break;case this.handle2Node:q=b(H(b(w.handle2+AA,0),o)-z,-1);p=b(B.ceil(q/AB+0.5),0);break;default:return ;}M(this,AD,AE,q);var v=this.items,n=(v&&v.length)||0;if(n&&r>=0&&r<n&&p>=0&&p<n){var AC=false,x;if(r!==this.cs1Idx){this.cs1Idx=r;x=this.items[r];this.cs1Vl=x.v;this.cs1Nm=x.n;AC=true;}if(p!==this.cs2Idx){this.cs2Idx=p;x=this.items[p];this.cs2Vl=x.v;this.cs2Nm=x.n;AC=true;}if(AC){this.typeHelper.updateThumb();this._updateTooltip(w.td);}}}}},ondrop:function Y(o){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var n=this.ghost;if(n){n.containerNode.style.display="none";}this.hideTooltip(o,self);var p=this.dnd&&this.dnd.initD;if(this.makeSelection&&p){this.makeSelection({selItem:p.td});}if(this.items&&this.items.length&&this.ghost){this[(U.eventTarget(self,o)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function Q(){var n=this.typeHelper,p=this.cs1Vl,o=this.cs2Vl,u=this.qua,t=this.numFmts;this.cs1Idx=n.getIdx(p);this.cs2Idx=n.getIdx(o);var r=function(q,w){var v=w||[];q=parseInt(q,10);return q===0||q===v.length-1;};this.cs1Nm=S.formatNumber(u,p,t);this.cs2Nm=S.formatNumber(u,o,t);n.updateOpCs();this.onselectionChange();this.updateSummary();},onincludeChange:function C(){if(!this.staticStatus){this.changeInclude=true;this.selectRange();}},showTooltip:function m(o,n){var p=U.eventTarget(n,o);this._updateTooltip(p);mstrmojo.tooltip.open(this,o,n);},_updateTooltip:function P(r){var o=this.orCfg,q=o.posCssP,n,p={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};p[o.opPosCssP]=-parseInt(this.font,10)/2;p[q]=r.style[q];n=String((r===this.handle1Node)?this.cs1Nm:this.cs2Nm);p.content=E.replace(/\{@content\}/g,n);this.set("richTooltip",p);},onclick:function a(n){if(!this.staticStatus&&!this.da.nov){var o=U.eventTarget(n.hWin||window,n.e);this.hideTooltip(n.e,self);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((o===this.handle1Node)?this.handle1Node:((o===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(o===this.handle1Node),tgt:o});if(this._onThumb){this._onThumb(n);}}},onselectionChange:function I(n){this._super(n);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function c(n){var p=S.getFuncInfo(this.opId,n.valueWas),q=S.getFuncInfo(this.opId,n.value),o;if(p.ft!==q.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();o=true;}}else{this.f=S.getFuncInfo(this.opId,n.value).f;o=false;}this.unSet=o||this.unSet;this.changeQual=true;this.selectRange();},updateData:function F(n,o){this.da=n;this.updateExpr(o);},updateExpr:function h(n){if(n){this.cs=n.cs;this.f=n.f;this.ft=n.ft;this.qua=n.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",H(b(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var p=this.opener,o=this.children[0];if(p){var n=this.isfrt?p.cs1Vl:p.cs2Vl;o.edt.set("value",X.toLocaleString(n));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!==0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(o){if(this.parent.apply.enabled){var n=o.hWin,p=o.e||n.event;if(p.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var o=this.parent.parent,q=o.opener,n=this.parent.edt.value;if(o&&q&&String(n).length>0){q[o.isfrt?"cs1Nm":"cs2Nm"]=n;n=X.parseNumeric(n);q[o.isfrt?"cs1Vl":"cs2Vl"]=n;}q[o.isfrt?"frtUst":"ndUst"]=true;q.selectRange();q.typeHelper.updateThumb();o.close();}}]}]},openEditValue:function(n){this.openPopup("editValueRef",n);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ValidationTextBox","mstrmojo.hash","mstrmojo.css","mstrmojo.validation");var M=mstrmojo.hash,S=mstrmojo.css;var H=10,G=205,T=30,F=75;function E(Y){var X=Y<0;Y=Math.abs(Y);["B","M","K"].every(function(b){var Z={B:1000000000,M:1000000,K:1000}[b],a=Y>=Z;if(a){Y=Math.round(Y/Z)+b;}return !a;});if(Y<1){Y=Y.toPrecision(3);}if(X){Y="-"+Y;}return String(Y);}function L(){var a=this.minLabel,Z=this.maxAutoLabel,b=this.min,X=this.minCheck,Y=5;if(b.domNode&&Z){b.domNode.style.marginLeft=a.domNode.offsetWidth+Y+"px";Z.domNode.style.width=b.domNode.offsetWidth-X.domNode.offsetWidth+"px";}if(this.auto===undefined){this.autoNode.style.height="0px";}}function C(e,g){var h=this[e+"Node"],b=this[g+"Node"],a=parseInt(h.style.left.replace("px",""),10)-F,p=parseInt(b.style.right.replace("px",""),10),m=this[e+"NodeLabel"],f=this[g+"NodeLabel"];if(a===0&&p===0){m.style.left=0;f.style.right=0;return ;}var o=mstrmojo.dom.position(m).w,X=mstrmojo.dom.position(f).w,Z=G-a-p,k=0,c=0;if(a>0){k=a<o/2?a:o/2;}if(p>0){c=p<X/2?p:X/2;}var Y=Z+k+c-o-X,n=H-Y;if(n>0){if(k===a){c=c+n;}else{if(c===p){k=k+n;}else{var l=n*o/(o+X),d=n-l;if(k+l>a){c=c+n-(a-k);k=a;}else{if(c+d>p){k=k+n-(p-c);c=p;}else{k=k+l;c=c+d;}}}}}m.style.left=-Math.round(k)+"px";f.style.right=-Math.round(c)+"px";}function U(){var b=this.getRange(),h=this.getAuto();if(!b){return ;}if(!this.enabled){b=M.copyProps(["min","max"],b);}if(h){["Min","Max"].forEach(function(o){var m="auto"+o,n=o.toLowerCase()+"Check",l=h[m];this[n].set("checked",l);},this);}["Min","Max"].forEach(function(o){var m="custom"+o,n=o.toLowerCase(),l=b[m];if(!b.hasOwnProperty(m)){b[m]=b[n];}this[n].setValue(isNaN(l)||!this.enabled?"":l);},this);var k=M.keyarray(b).map(function(l){var m=l.indexOf("x")>-1;return{key:l,val:Number(b[l]),positionProp:m?"right":"left",positionValue:0};}).sort(function(m,l){return m.val-l.val;}),Z=false,d=false,Y=k[0].val,a=k[3].val,e=a-Y,c=G,g,f;if(k[1].val===Y){if(k[2].val!==a){g=f=k[2];}}else{g=k[1];f=(k[2].val!==a)?k[2]:k[1];}function X(l,n){var q=(l==="left")?Y:a,p=Math.abs(n.val-q),o=Math.round(p/e*c),m=o<T;o=m?T:o;n.unscaled=m;n.positionValue=(l===n.positionProp)?o:G-o;if(m){c-=T;e-=p;}return m;}if(g){Z=X("left",g);}if(f&&!f.unscaled){d=X("right",f);if(f.unscaled&&!g.unscaled){Z=X("left",g);}}S.toggleClass(this.bgNode,"unscaleleft",Z);S.toggleClass(this.bgNode,"unscaleright",d);k.forEach(function(m){var n=this[m.key+"Node"],p=this[m.key+"NodeLabel"],l=m.positionProp,o=(l==="left")?F:0;n.style[l]=m.positionValue+o+"px";p.innerHTML=this.getConvertValue(m.val);},this);C.call(this,"customMin","customMax");C.call(this,"min","max");L.call(this);}function N(){var a=this,Z=this.getRange(),Y=M.copy(Z),X=this;Y.customMin=X.min.value;Y.customMax=X.max.value;this.set("range",Y);window.setTimeout(function(){a.rangeChanged(Y,Z);},75);}function P(){var Y=this,a=this.getAuto(),Z=M.copy(a),X=this;Z.autoMin=X.minCheck.checked;Z.autoMax=X.maxCheck.checked;this.set("auto",Z);window.setTimeout(function(){Y.autoChanged();},75);}function A(Y,a){var d="ctrlNodeLeft",b=mstrmojo.desc(5416,"Min"),Z="min",c="max";if(Y){d="ctrlNodeRight";b=mstrmojo.desc(5417,"Max");Z="max";c="min";}var X={scriptClass:"mstrmojo.ValidationTextBox",slot:d,hint:b,alias:Z,valueChangeDelay:1000,dtp:5,required:true,useRichTooltip:true,constraints:{trigger:mstrmojo.validation.TRIGGER.NONE,min:null,max:null},setValue:function(f){var e=this._sync;this._sync=true;if(f===""&&this.hasRendered){this.clearValidation();}this.set("value",f);this._sync=e;},onvalueChange:function(){if(!this._sync){var f=this.parent,e=this.parent[c];e.resetConstraints(true);if(e.isValid()){this.updateConstraints();}else{this.resetConstraints(false);}this.validate();f.set("inputValid",e.isValid()&&this.isValid());if(f.inputValid){N.call(f);}}},resetConstraints:function(e){M.copyProps(["min","max"],this.parent.rangeConstraints[this.alias],this.constraints);if(e){this.validate();}},updateConstraints:function(){this.resetConstraints(false);var f=this.parent.rangeConstraints[this.alias][c],e=parseFloat(this.parent[c].value,10);if(!f){this.constraints[c]=e;}else{if(c==="min"){this.constraints[c]=f>e?f:e;}else{this.constraints[c]=f<e?f:e;}}},updateTooltipConfig:function(){if(!this.enabled){this.richTooltip=null;return ;}var h=this.validationStatus,f=(Z==="min"?mstrmojo.desc(12119,"Custom minimum value"):mstrmojo.desc(12120,"Custom maximum value")),g=this.isValid()?f:this.getInvalidMsg(h),e=(this.isValid()?"vi-regular":"vi-warning")+" vi-tooltip-V";this.richTooltip={content:g,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:e,left:0,top:this.domNode.offsetHeight-30,refNode:this.domNode};}};M.copy(a,X);return X;}function R(X,Y){return{scriptClass:"mstrmojo.Label",text:X?mstrmojo.desc(13731,"Max:"):mstrmojo.desc(13732,"Min:"),cssDisplay:"inline-block",alias:X?"maxLabel":"minLabel",slot:Y+(X?"NodeRight":"NodeLeft")};}function B(X){return{scriptClass:"mstrmojo.ui.Checkbox",cssDisplay:"inline-block",alias:X?"maxCheck":"minCheck",slot:X?"autoNodeRight":"autoNodeLeft",oncheckedChange:function Y(){var a=this.alias==="maxCheck",b=this.parent,d=b,Z=a?b.max:b.min,c=this.checked;Z.set("enabled",!c);if(d.auto){P.call(d);}}};}function W(X){return{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12143,"Automatic"),cssClass:"autoLabel",cssDisplay:"inline-block",alias:X?"maxAutoLabel":"minAutoLabel",slot:X?"autoNodeRight":"autoNodeLeft"};}mstrmojo.ui.editors.controls.CustomRange=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.CustomRange",range:null,rangeConstraints:{min:{min:null,max:null},max:{min:null,max:null}},inputValid:true,labelOfDataRange:mstrmojo.desc(13733,"Data Range"),labelOfCustomRange:"",markupString:'<div id="{@id}" class="mstrmojo-ui-CustomRange {@cssClass}"><div class="autoNode"><div class="autoNodeLeft"></div><div class="autoNodeRight"></div></div><div class="ctrlNode"><div class="ctrlNodeLeft"></div><div class="ctrlNodeRight"></div></div><div class="displayNode"><div class="bg"><div class="tip left"></div><div class="dot left"></div><div class="tip right"></div><div class="dot right"></div><div class="girder"></div></div><div class="custom min"><div class="tick-label"></div></div><div class="custom max"><div class="tick-label"></div></div><div class="actual min"><div class="tick-label"></div></div><div class="actual max"><div class="tick-label"></div></div><div class="lbl-cust-range" title="{@labelOfCustomRange}">{@labelOfCustomRange}</div><div class="lbl-data-range" title="{@labelOfDataRange}">{@labelOfDataRange}</div></div></div>',markupSlots:{autoNode:function(){return this.domNode.firstChild;},autoNodeLeft:function(){return this.domNode.firstChild.firstChild;},autoNodeRight:function(){return this.domNode.firstChild.lastChild;},ctrlNode:function(){return this.domNode.children[1];},ctrlNodeLeft:function(){return this.domNode.children[1].firstChild;},ctrlNodeRight:function(){return this.domNode.children[1].lastChild;},displayNode:function(){return this.domNode.lastChild;},bgNode:function(){return this.domNode.lastChild.firstChild;},customMinNode:function(){return this.domNode.lastChild.childNodes[1];},customMaxNode:function(){return this.domNode.lastChild.childNodes[2];},minNode:function(){return this.domNode.lastChild.childNodes[3];},maxNode:function(){return this.domNode.lastChild.childNodes[4];},customMinNodeLabel:function(){return this.domNode.lastChild.childNodes[1].firstChild;},customMaxNodeLabel:function(){return this.domNode.lastChild.childNodes[2].firstChild;},minNodeLabel:function(){return this.domNode.lastChild.childNodes[3].firstChild;},maxNodeLabel:function(){return this.domNode.lastChild.childNodes[4].firstChild;}},layoutConfig:{w:{ctrlNode:"100%",displayNode:"100%"},xt:true},init:function O(a){this.range={min:0,max:100000};M.copy(a,this);var X=a.auto,Y=X?"auto":"ctrl",Z=X?[R(false,Y),B(false),W(false),this.getTextBoxCfg(false),R(true,Y),B(true),W(true),this.getTextBoxCfg(true)]:[R(false,Y),this.getTextBoxCfg(false),R(true,Y),this.getTextBoxCfg(true)];this.addChildren(Z);},getTextBoxCfg:function J(X,Y){return A(X,Y);},getConvertValue:function D(X){return E(X);},afterLayout:function K(){this.min.resetConstraints();this.max.resetConstraints();U.call(this);},getRange:function V(){return M.copy(this.range);},getAuto:function Q(){return M.copy(this.auto);},rangeChanged:function I(X,Y){},onrangeChange:function(){U.call(this);},updateDisplay:U});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ui.editors.controls.CustomRange,{onenabledChange:function(){this.propagateChildProps("enabled");S.toggleClass(this.displayNode,"disabled",!this.enabled);U.call(this);this.set("inputValid",true);}});mstrmojo.ui.editors.controls.CustomRange.RangeType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ui.editors.controls.ValidationTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,null,{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",errRevert:true,dtp:null,validationDelay:3000,orignText:null,trigger:mstrmojo.validation.TRIGGER.ONKEYUP,init:function(B){B=B||{};B.constraints=B.constraints||{};B.constraints.trigger=this.trigger;this._super(B);},prekeyup:function(B){if(B.e.keyCode===13){this.blur();return ;}this._super(B);},onfocus:function(){this.orignText=this.value;},onblur:function(){if(this.value!==this.orignText){this.validate();}},validate:function(){this._super();this.orignText=this.value;this.clearValDelayTimer();},preinput:mstrmojo.emptyFn,postinput:function(){var B=this.doValidation(this.value);if(B.code<=mstrmojo.validation.STATUSCODE.VALID){this.clearValidation();if(!this.errRevert){this.hideTooltip();}}},updateTooltipConfig:function(){this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onInvalid:function(){if(!this.errRevert){this.hideTooltip();this.showTooltip();}else{this.clearValidation();this.set("value",this.orignText);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.List","mstrmojo.Button","mstrmojo.color","mstrmojo.Model","mstrmojo.Table","mstrmojo._CanValidate","mstrmojo.ValidationTextBox");var L=mstrmojo.color,C=mstrmojo.hash;function H(V,R,N,O,U,M,Q,T){var S={target:R,onEnd:function(){if(M){M();}},props:{}};S.props[N]={ease:Q,start:parseInt(O,10),stop:parseInt(U,10),suffix:"px"};S=C.copy(T,S);var P=new mstrmojo.fx.AnimateProp(S);P.play();}var D=function(Q){if(Q===null){return ;}var P=mstrmojo.locales.color.userPalette,M=P.length;if(M===8){P.remove(M-1,1);}P.add([{n:Q,v:Q}],0);var N="",O;for(O=0;O<8;O++){if(P[O]&&P[O].v){N+=P[O].v+",";}}N=N.replace(/,$/,"");mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(R){},failure:function(R){mstrmojo.alert(R.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"userPalette\u001E"+N});};var I=function(M,N,O){return{scriptClass:"mstrmojo.Label",text:M+":",cssClass:N,slot:O};};var K=function(M,P,O,N){return C.copy(N||{},{scriptClass:"mstrmojo.ValidationTextBox",cssDisplay:"block",cssText:"padding: "+(mstrmojo.dom.isIE7?"0":"1px"),bindings:{value:function(){return this.parent.parent.colorModel[O]||"0";}},onValid:function(){this.parent.parent.colorModel.set(O,this.value);},min:0,max:255,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,validator:function(R){var S=this.min,Q=this.max;R=parseInt(R,10);if(R>=S&&R<=Q){return{code:mstrmojo.validation.STATUSCODE.VALID};}return{code:mstrmojo.validation.STATUSCODE.INVALID,msg:mstrmojo.desc(7883,"Please enter an integer between ## and ###").replace("##",S).replace("###",Q)};}},slot:P});};var G=function(M){return C.copy({scriptClass:"mstrmojo.Slider",alias:M+"Slider",cssClass:"sc "+M,isHoriz:true,width:130,cssBkBW:0,items:[],getItemTooltip:function(){return this.items[this.min].n;},postCreate:function(){var N;for(N=0;N<{r:256,g:256,b:256,s:101,v:101,h:360}[M];N++){this.items.push({n:N,v:N});}},bindings:{selectedIndex:function(){return this.parent.parent.colorModel[M]||"0";}},onselectedIndexChange:function(){this.parent.parent.colorModel.set(M,this.selectedIndex);if(this.domNode){this.min=this.max=this.selectedIndex;this.typeHelper.updateThumb();}},select:function(N){this.set("selectedIndex",N);},slot:"1,3"});};var A=function(N,M,O){return'<div mstridx="'+M+'" class="mstrmojo-ColorPicker-item '+O.itemCssClas+'" style="background-color:'+N.v+';" type="button" title="'+N.n+'"></div>';};var F=C.copy({findIndex:function(M,O,N){return N.getAttribute("mstridx")||-1;}},C.copy(mstrmojo.ListMapper));var B=function(M,N){return C.copy(N,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ColorPicker-list",itemMarkupFunction:A,listMapper:F,onchange:null,_onchange:function(){this.set("selectedColor",this.selectedItem.v);M.set("selectedColor",this.selectedItem.v);if((M.isSimple||!M.expanded)&&M.onChange){M.onChange();}},onselectedColorChange:function(){M.colorModel.set("hex",this.selectedColor);}});};mstrmojo.ColorPicker=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ColorPicker",markupString:'<div id={@id} class="mstrmojo-ColorPicker {@cssClass} {@shadowCssClass}" style="height:{@height}; width:{@width};{@cssText}"><div class="mstrmojo-ColorPicker-box"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onexpandedChange:function(){this.domNode.className=this.domNode.className.replace(/ expanded/,"")+(this.expanded?" expanded":"");}},useAnimate:true,useShadow:true,isSimple:false,showNoColor:true,showMoreColors:true,showGradients:true,showUserPalette:true,height:"168px",fullHeight:"326px",width:"158px",fullWidth:"366x",expanded:false,onexpandedChange:function(N){var Q=this.domNode,M=parseInt(this.height,10),P=parseInt(this.width,10),O=parseInt(this.fullHeight,10),R=Math.max(parseInt(this.fullWidth,10),Q.scrollWidth);if(this.useAnimate!==false){if(N.value){H(true,Q,"width",P,R);H(true,Q,"height",M,O);}else{H(true,Q,"width",R,P);H(true,Q,"height",O,M);}}else{if(N.value){Q.style.width=R+"px";Q.style.height=O+"px";}else{Q.style.width=P+"px";Q.style.height=M+"px";}}},selectedColor:null,onChange:null,_updateSelection:function(N){var O=(this.isSimple)?this:this.layout.cp;if(N){var M=mstrmojo.array.find(O.basicColors.items,"v",N);if(M>-1){O.basicColors.set("selectedIndex",M);}else{M=mstrmojo.array.find(O.userPalette.items,"v",N);if(M>-1){O.userPalette.set("selectedIndex",M);}}}},visible:false,onvisibleChange:function(){if(this.visible){this.selectedColor=(this.selectedColor&&this.selectedColor.replace(/transparent/,"#FFFFFF"))||"#FFFFFF";this.colorModel.set("hex",this.selectedColor);this._updateSelection(this.selectedColor);}},onselectedColorChange:function(){this._updateSelection(this.selectedColor);},init:function(M){var N=this;this.colorModel=new mstrmojo.Model({h:0,s:0,v:100,_hsvChange:function(){this.hex="#"+L.hsv2hex(this.h,this.s,this.v);var O=L.hsv2rgb(this.h,this.s,this.v);this.r=O[0];this.g=O[1];this.b=O[2];N.set("colorModel",C.copy(this,{}));},_rgbChange:function(){this.hex="#"+L.rgb2hex(this.r,this.g,this.b);var O=L.rgb2hsv(this.r,this.g,this.b);this.h=O[0];this.s=O[1];this.v=O[2];N.set("colorModel",C.copy(this,{}));},onhChange:function(){this._hsvChange();},onsChange:function(){this._hsvChange();},onvChange:function(){this._hsvChange();},onrChange:function(){this._rgbChange();},ongChange:function(){this._rgbChange();},onbChange:function(){this._rgbChange();},onhexChange:function(){var P=L.hex2rgb(this.hex);this.r=P[0];this.g=P[1];this.b=P[2];var O=L.hex2hsv(this.hex);this.h=O[0];this.s=O[1];this.v=O[2];N.set("colorModel",C.copy(this,{}));}});this._super(M);},postBuildRendering:function(){if(this._super){this._super();}this.colorModel.set("hex",this.selectedColor||"#FFFFFF");this.colorModel.set("s",50);},preBuildRendering:function(){if(this._super){this._super();}var P=this.isSimple?100:124;if(this.showNoColor){P+=20;}if(this.showUserPalette){P+=25;}this.height=P+"px";if(this.isSimple){this.width="155px";}this.shadowCssClass=this.useShadow?"shadow":"";var Q=this,M={scriptClass:"mstrmojo.Button",cssClass:"nocolor",text:mstrmojo.desc(959,"Default"),visible:this.showNoColor,onclick:function(){Q.set("selectedColor","transparent");if(Q.onChange){Q.onChange();}}},O=B(this,{alias:"basicColors",items:mstrmojo.locales.color.colors,onchange:function(){if(this.selectedIndex>-1){this.parent.userPalette.set("selectedIndex",-1);this._onchange();}}}),R=B(this,{alias:"userPalette",cssClass:"mstrmojo-ColorPicker-list userPalette",makeObservable:true,visible:this.showUserPalette,bindings:{items:function(){return Q.showUserPalette!==false?mstrmojo.locales.color.userPalette:[];}},onchange:function(){if(Q.visible){if(this.selectedIndex>-1){this.parent.basicColors.set("selectedIndex",-1);this._onchange();}}},onadd:function(){this.refresh();if(Q.visible){this.parent.basicColors.set("selectedIndex",-1);this.set("selectedIndex",0);}}});if(this.isSimple){if(this.showNoColor){this.addChildren(M,0);}this.addChildren(O);this.addChildren(R);return ;}var N={scriptClass:"mstrmojo.Table",alias:"layout",rows:2,cols:5,layout:[{cells:[{colSpan:2},{colSpan:2},{}]},{cells:[{},{},{},{},{}]}],children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ColorPicker-palette shadow",alias:"cp",children:[M,O,R],slot:"0,0"},{scriptClass:"mstrmojo.Container",cssClass:"sbSlider",markupString:'<div class="{@cssClass}" style="position:relative; {@cssText}" mstrAttach:click,mouseover,mousemove,mousedown,mouseup,mouseout><div class="sbThumb"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},thumbNode:function(){return this.domNode.firstChild;}},markupMethods:{onbgColorChange:function(){this.domNode.style.backgroundColor=this.bgColor;}},hex:null,bindings:{hex:"this.parent.parent.colorModel.hex",bgColor:function(){return"#"+L.hsv2hex(this.parent.parent.colorModel.h,100,100);}},onhexChange:function(){if(this.domNode){this.thumbNode.style.left=this.parent.parent.colorModel.s/100*160-3+"px";this.thumbNode.style.top=(1-this.parent.parent.colorModel.v/100)*160-3+"px";}},onmousedown:function(){var T=this.domNode.getBoundingClientRect();this.mouseX0=T.left;this.mouseY0=T.top;this.onmousemove=this._update;var S=this;this.onmouseup=function(){S.onmousemove=null;mstrmojo.dom.detachEvent(document.body,"mouseup",S.onmouseup);};mstrmojo.dom.attachEvent(document.body,"mouseup",this.onmouseup);},onclick:function(S){this._update(S);},_update:function(S){var V={x:S.e.clientX,y:S.e.clientY},U=Math.min(Math.max(0,V.x-this.mouseX0),160),T=Math.min(Math.max(0,V.y-this.mouseY0),160);this.thumbNode.style.left=(U-3)+"px";this.thumbNode.style.top=(T-3)+"px";this.parent.parent.colorModel.s=Math.floor(100*U/160);this.parent.parent.colorModel.set("v",Math.floor(100*(1-T/160)));},slot:"0,1"},{scriptClass:"mstrmojo.Container",cssClass:"hueSlider",markupString:'<div class="{@cssClass}" style="position:relative; {@cssText}" mstrAttach:click,mouseover,mousedown,mouseup,mousemove,mouseout><div class="hThumb"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},thumbNode:function(){return this.domNode.firstChild;}},bindings:{hex:"this.parent.parent.colorModel.hex",h:"this.parent.parent.colorModel.h"},onhexChange:function(){this._moveThumb();},onhChange:function(){this._moveThumb();},_moveThumb:function(){if(this.thumbNode){this.thumbNode.style.top=(1-this.parent.parent.colorModel.h/360)*160-1+"px";}},onmousedown:function(){this.mouseY0=this.domNode.getBoundingClientRect().top;this.onmousemove=this._update;var S=this;this.onmouseup=function(){S.onmousemove=null;mstrmojo.dom.detachEvent(document.body,"mouseup",S.onmouseup);};mstrmojo.dom.attachEvent(document.body,"mouseup",S.onmouseup);},onclick:function(S){this._update(S);},_update:function(S){var U={x:S.e.clientX,y:S.e.clientY},T=Math.min(Math.max(0,U.y-this.mouseY0),160);this.thumbNode.style.top=(T-1)+"px";this.parent.parent.colorModel.set("h",Math.max(0,Math.floor(360*(1-T/160))));},slot:"0,2"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-ColorPicker-preview",markupMethods:{onbgColorChange:function(){this.domNode.style.backgroundColor=this.bgColor;}},bindings:{bgColor:"this.parent.parent.colorModel.hex"},onclick:function(){if(Q.showUserPalette){D(this.bgColor);}},slot:"1,0"},I(mstrmojo.desc(7848,"Hex"),"Hex","1,0"),K(mstrmojo.desc(7848,"Hex"),"1,0","hex",{cssClass:"hex",cssDisplay:"block",inputNodeCssClass:"hex",dtp:25,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,validator:function(S){if(/^#[0-9a-fA-F]{6}$/.test(S)){return{code:mstrmojo.validation.STATUSCODE.VALID};}return{code:mstrmojo.validation.STATUSCODE.INVALID,msg:mstrmojo.desc(7882,"Please enter a 6-digit HEX color value in format: #xxxxxx")};}}}),I(mstrmojo.desc(3604,"Red"),"Red","1,1"),I(mstrmojo.desc(3606,"Green"),"Green","1,1"),I(mstrmojo.desc(3608,"Blue"),"Blue","1,1"),I(mstrmojo.desc(3605,"Hue"),"Hue","1,1"),I(mstrmojo.desc(3607,"Saturation"),"Saturation","1,1"),I(mstrmojo.desc(3609,"Brightness"),"Brightness","1,1"),K(mstrmojo.desc(3604,"Red"),"1,2","r"),G("r"),K(mstrmojo.desc(3606,"Green"),"1,2","g"),G("g"),K(mstrmojo.desc(3608,"Blue"),"1,2","b"),G("b"),K(mstrmojo.desc(3695,"Hue"),"1,2","h",{cssClass:"h",max:360}),G("h"),K(mstrmojo.desc(3607,"Saturation"),"1,2","s",{max:100}),G("s"),K(mstrmojo.desc(3609,"Brightness"),"1,2","v",{max:100}),G("v")]};if(this.showMoreColors){N.children.push({scriptClass:"mstrmojo.Button",cssClass:"more",alias:"more",title:mstrmojo.desc(7833,"More >>>"),onclick:function(){var S=this.parent.parent;S.set("expanded",!S.expanded);this.domNode.setAttribute("title",S.expanded?mstrmojo.desc(7834,"Less Colors"):mstrmojo.desc(7833,"More Colors"));this.domNode.className=S.expanded?"less":"more";},slot:"0,0"});}if(this.showGradients){N.children.push({scriptClass:"mstrmojo.Button",alias:"showGradients",cssClass:"ge",text:mstrmojo.desc(4786,"Gradients..."),title:mstrmojo.desc(7970,"Open Graident Editor"),onclick:function(){var S=this.parent.parent;S.set("show",false);S.parent.ge.set("show",true);},slot:"0,0"});}this.addChildren(N);this.addChildren({scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-ColorPicker-buttonBar",children:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442,"Ok"),function(){var S=this.parent.parent;if(!S.useAnimate){S.set("visible",false);}var T=S.colorModel.hex;if(S.showUserPalette){D(T);}S.set("selectedColor",T);if(S.onOK){S.onOK();}},"#999",{alias:"ok",cssClass:"mstrmojo-Editor-button"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(221,"Cancel"),function(){var S=this.parent.parent;if(!S.useAnimate){S.set("visible",false);}if(S.onCancel){S.onCancel();}},"#999",{alias:"cancel",cssClass:"mstrmojo-Editor-button"})]});}});var J={scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"mstrmojo-ColorPicker-popup-content",autoCloses:false,locksHover:true,colorPicker:null,onOpen:function(){this.colorPicker.set("selectedColor",this.opener.fillColor);var N=this;var M=function(){N.lastOpener=N.lastOpener||N.opener;if(N.opener!==N.lastOpener){N.opener.popupNode.appendChild(N.lastOpener.popupRef.domNode);N.lastOpener=N.opener;}N.colorPicker.set("show",true);};window.setTimeout(function(){M();},100);},onClose:function(){this.colorPicker.set("show",false);if(this.ge){this.ge.set("show",false);}},postCreate:function(){this.markupMethods=C.copy(this.markupMethods);this.markupMethods.onvisibleChange=null;},preBuildRendering:function(){if(this.showGradients||this.colorPicker.showGradients){this.addChildren(this.gradientRef);}},gradientRef:{scriptClass:"mstrmojo.GradientEditor",alias:"ge",cssText:"height:0; display:none; position:absolute; z-index: 4;",left:"0px",top:"0px",visible:false,showTitle:false,height:245,_resizeHandler:function(){},onOK:function(){this.parent.opener.set("gradient",this.gradient);this.parent.opener.set("gradientCss",this.gradient.css);this.set("show",false);},onCancel:function(){this.set("show",false);},onshowChange:function(O){var N=O.value,M=parseInt(this.height,10);var R=this.domNode.firstChild;if(N){this.set("model",this.parent.opener.gradient);R.style.display="block";}if(this.useAnimate!==false){var S=N?0:M,P=M-S,Q=this;R.style.overflow="hidden";if(N){R.style.display="block";}H(N,R,"height",S,P,function(){if(!N){R.style.display="none";var T=Q.parent.opener;if(T){T.closePopup();}}else{R.style.overflow="visible";}});}else{R.style.height=N?M+"px":0;R.style.display=N?"block":"none";}},postCreate:function(){this.bindings={useAnimate:"this.parent.opener.useAnimate"};}},children:[{scriptClass:"mstrmojo.ColorPicker",alias:"colorPicker",onChange:function(){if(!this.parent.opener){return ;}this.parent.opener.set("fillColor",this.selectedColor);this.set("show",false);this.parent.opener.closePopup();},onOK:function(){this.onApply();this._closePopup();},onApply:function(){this.parent.opener.set("fillColor",this.selectedColor);},onCancel:function(){this._closePopup();},_closePopup:function(){this.set("show",false);if(!this.showGradients||!this.parent.ge||(this.parent.ge&&!this.parent.ge.show)){this.parent.opener.closePopup();}},show:false,onEnd:function(){this.set("visible",this.show);},onshowChange:function(){var M=parseInt(this.expanded?this.fullHeight:this.height,10);if(this.useAnimate!==false){var Q=this.show?0:M,O=M-Q,P=this,N=(!this.show?function(){P.onEnd();}:null);if(this.show){this.set("visible",true);}H(this.show,this.domNode,"height",Q,O,N);}else{this.set("visible",this.show);this.domNode.style.height=M+"px";}},postCreate:function(){this.showGradients=this.parent.showGradients;this.bindings={showUserPalette:function(){return this.parent.opener?this.parent.opener.showUserPalette:this.showUserPalette;},useAnimate:function(){return this.parent.opener?this.parent.opener.useAnimate:this.useAnimate;},isSimple:function(){return this.parent.opener?this.parent.opener.isSimple:this.isSimple;},showNoColor:function(){return this.parent.opener?this.parent.opener.showNoColor:this.showNoColor;}};}}]};mstrmojo.colorPickerPopupRef=mstrmojo.insert(J);mstrmojo.simpleColorPickerPopupRef=mstrmojo.insert(C.copy({isSimple:true},C.copy(J)));mstrmojo.gradientColorPickerPopupRef=mstrmojo.insert(C.copy({showGradients:true},C.copy(J)));mstrmojo.ColorPicker.createDropDown=function E(O,N){O=O||{};var M=mstrmojo.colorPickerPopupRef;if(N){if(N.isSimple){M=mstrmojo.simpleColorPickerPopupRef;O.isSimple=N.isSimple;}else{if(N.showGradients){M=mstrmojo.gradientColorPickerPopupRef;O.showGradients=N.showGradients;}}}else{if(O){if(O.isSimple){M=mstrmojo.simpleColorPickerPopupRef;}else{if(O.showGradients){M=mstrmojo.gradientColorPickerPopupRef;}}}}return C.copy(O,{scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-ColorPicker-DropDownButton",markupMethods:{onfillColorChange:function(){if(this.boxNode&&this.fillColor){this.boxNode.style.cssText="background-color: "+this.fillColor;this.gradient=null;this.gradientCss=null;}},ongradientCssChange:function(){if(this.boxNode&&this.gradientCss){this.boxNode.style.cssText=this.gradientCss;this.fillColor=null;}}},popupRef:M,showUserPalette:true,useAnimate:true,showGradients:false,isSimple:false,fillColor:undefined});};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Box","mstrmojo.Label","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.Dialog","mstrmojo.cookies");mstrmojo.requiresDescs(17,18,221,9772,11773,14028,14136,14137,14138,14139,14140,14149,14522,14523,14524,14525,14526,14527);var CSS=mstrmojo.css,DOM=mstrmojo.dom,HASH=mstrmojo.hash;var _VAL=mstrmojo.validation,_SC=_VAL.STATUSCODE,_TR=_VAL.TRIGGER,_VALIDATOR=_VAL.VALIDATOR,DTP=mstrmojo.expr.DTP;var usherProps={intervalCtr:0,qrLoaded:false,maxPollingAttempts:80,timeDelay:3000};var DEFAULT_BADGE={mini_badge:"#ddd",mini_badge_icon:"https://uvs-v2.usher.com/assets/images/img_badge_placeholder.png",t_color:"#797979",appName:"",name:""};var userInfo={firstName:"",badgeId:""};var notificationTimer={duration:undefined,elem:undefined,callback:undefined,timerInterval:null,init:function(duration,elem,callback){this.duration=duration;this.elem=elem;this.callback=callback;},startTimer:function(){this.stopTimer();var start=Date.now(),diff,minutes,seconds;var me=this;function timer(){diff=me.duration-(((Date.now()-start)/1000)|0);minutes=(diff/60)|0;seconds=(diff%60)|0;minutes=minutes<10?"0"+minutes:minutes;seconds=seconds<10?"0"+seconds:seconds;me.elem.set("text",minutes+":"+seconds);if(diff<=0){start=Date.now()+1000;me.callback();me.stopTimer();}}timer();this.timerInterval=setInterval(timer,1000);},stopTimer:function(){if(this.timerInterval){clearInterval(this.timerInterval);}}};function addExtraParams(params){params.sn=this.serverName||mstrConfig.serverName;params.sp=this.serverPort||mstrConfig.serverPort;params.connectionId=this.connectionId||"";return params;}function disableQRCode(){this.set("expired",true);this.usherProps.qrLoaded=false;}function checkForUsherScan(){try{var widgetUsherProps=this.usherProps;var me=this;if(widgetUsherProps.qrLoaded){if(widgetUsherProps.intervalCtr>widgetUsherProps.maxPollingAttempts){disableQRCode.call(me);}else{clearTimeout(this.pullTimeout);this.pullTimeout=setTimeout(function(){widgetUsherProps.intervalCtr+=1;if(!me.stopPolling){usherPollForScan.call(me);}},widgetUsherProps.timeDelay);}}}catch(e){}}function serverRequest(params,callbacks,config){if(mstrApp.serverRequest){mstrApp.serverRequest(params,callbacks,config);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,params);}}function usherPollForScan(){var me=this,widgetUsherProps=this.usherProps,params={taskId:"usherLoginWeb",pollOnly:"true",server:this.serverName||mstrConfig.serverName,port:this.serverPort||mstrConfig.serverPort,project:this.projectName||mstrConfig.projectName,connectionId:this.connectionId},callbacks={success:function(res){try{if(res.status=="invalid"){checkForUsherScan.call(me);}else{if(res.status=="success"){function doUsherLogin(res){me.onUsherLogin(res);widgetUsherProps.qrLoaded=false;}if(me.rememberMe===true){var callbacks={success:function(res){doUsherLogin(res);},failure:function(res){me.onUsherError(res);}};var params={taskId:"usherRememberMe"};params.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";serverRequest(params,callbacks,{doNotHold:true});}else{doUsherLogin(res);}}}}catch(e){mstrmojo.alert("usherPollForScan:\n "+e.messsage);}},failure:function(res){disableQRCode.call(me);me.onUsherError(res);}};serverRequest(params,callbacks,{doNotHold:true});}function updateUserDetails(msg){this.userDetails.set("text",msg||"");}function toggleLoginNotification(show){var me=this;me.loginButton.set("visible",show);me.loginNotificationBox.set("visible",!show);}function submitLogin(){var widgetUsherProps=this.usherProps;var notificationTimer=this.notificationTimer;var me=this,callbacks={success:function(res){try{if(res.status==1){function callback(){toggleLoginNotification.call(me,true);}function submitForPolling(){if(me.pullTimeout){clearTimeout(me.pullTimeout);}me.usherProps.intervalCtr=0;widgetUsherProps.qrLoaded=true;checkForUsherScan.call(me);}var fiveMinutes=60*5;notificationTimer.init(fiveMinutes,me.loginNotificationBox.timer,callback);notificationTimer.startTimer();toggleLoginNotification.call(me,false);submitForPolling();}else{me.onUsherError(res);}}catch(e){mstrmojo.alert("Error:\n"+e.message);}},failure:function(res){me.onUsherError(res);}},params={taskId:"usherNotifyMe"};params.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";serverRequest(addExtraParams.call(this,params),callbacks,{doNotHold:true});}function forgetMe(){var me=this,callbacks={success:function(res){try{me.set("notificationMode",false);me.reloadQR();}catch(e){mstrmojo.alert("Error:\n"+e.messsage);}},failure:function(res){me.onUsherError(res);}},params={taskId:"usherRememberMe",rememberMe:false};if(me.userInfo.badgeId!==""){params.badgeId=me.userInfo.badgeId;}params.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";serverRequest(addExtraParams.call(this,params),callbacks,{doNotHold:true});}function getQRCode(ignoreNotificationMode){if(this.notificationMode==true&&!ignoreNotificationMode){return ;}var widgetUsherProps=this.usherProps;this.showQRLoading(true);var me=this,callbacks={success:function(res){try{if(res.img){me.set("notificationMode",false);me.updateQRCode(res.img);me.set("badge",res.badgeInfo&&res.badgeInfo[0]);widgetUsherProps.intervalCtr=0;widgetUsherProps.qrLoaded=true;this.stopPolling=false;checkForUsherScan.call(me);}else{var data=JSON.parse(res.data);var pn=data.pnEnabled||data.isPNEnabled;me.set("isPnEnabled",pn);if(data.code||data.proximityBasedLogin){me.set("notificationMode",false);if(data.proximityBasedLogin&&!ignoreNotificationMode){me.updateQRCodeProximity();me.set("proximityMode",true);}else{me.updateQRCode(data.code);me.set("proximityMode",false);}me.set("badge",res.badgeInfo&&res.badgeInfo[0]);widgetUsherProps.intervalCtr=0;widgetUsherProps.qrLoaded=true;this.stopPolling=false;mstrmojo.cookies.updateCookieSetting("usher_sso_device",res.device_id);checkForUsherScan.call(me);}else{me.set("proximityMode",false);me.set("notificationMode",true);me.refresh.set("visible",false);if(me.userInfoNode){me.userInfoNode.src="data:image/png;base64,"+data.photoData;}me.userInfo.firstName=data.firstName;me.userInfo.badgeId=data.badgeId;toggleLoginNotification.call(me,true);me.set("badge",res.badgeInfo&&res.badgeInfo[0]);}}}catch(e){mstrmojo.alert("getQRCode:\n "+e.messsage);}},failure:function(res){me.handleQRCodeError(res);disableQRCode.call(me);me.onUsherError(res);},complete:function(){me.showQRLoading(false);}},params={taskId:"usherQRWeb"};params.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";serverRequest(addExtraParams.call(this,params),callbacks,{doNotHold:true});}function registerHandler(){var me=this,regBtn=this.registerButton,dotsNode=this.parent.badgeNode.childNodes[1];if(regBtn.enabled){regBtn.set("enabled",false);CSS.addClass(dotsNode,["anim"]);var regMsg={},callbacks={success:function(res){var successful=res&&res.name==me.user.value;regMsg={msg:successful?mstrmojo.desc(14139,"You've successfully registered. Please check your email to continue.")+" "+mstrmojo.desc(14177,"Or perform an Usher badge recovery."):res.getResponseHeader("X-MSTR-TaskFailureMsg"),successful:successful};},failure:function(res){regMsg={msg:res.getResponseHeader("X-MSTR-TaskFailureMsg"),successful:false};},complete:function(){regBtn.set("enabled",true);CSS.removeClass(dotsNode,["anim"]);me.set("regMsg",regMsg);}},params={taskId:"usherRegUsr",server:this.serverName||mstrConfig.serverName,project:mstrConfig.projectName,port:this.serverPort||mstrConfig.serverPort,email:this.email.value,userid:this.user.value,password:this.pwd.value};serverRequest(params,callbacks);}}function getTextBoxJson(props){return mstrmojo.hash.copy(props,{scriptClass:"mstrmojo.ValidationTextBox",cssDisplay:"block",postCreate:function(){if(DOM.isIE9||DOM.isIE8||DOM.isIE7){this.emptyText=this.hint;}},onEnter:function(){registerHandler.call(this.parent);}});}mstrmojo.UsherLogin=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.UsherLogin",markupString:'<div id="{@id}" class="mstrmojo-UsherLogin-Container {@cssClass}" style="{@cssText}" ><div class="mstrmojo-UsherLogin-badge"><div class="icn"><img src="../images/1ptrans.gif"/></div><div class="dots"><div class="dot1"></div><div class="dot2"></div><div class="dot3"></div></div><div class="app"><img src="../style/mstr/images/badge-app.png"/></div></div><div class="mstrmojo-UsherLogin-badgeLabel"><div class="app-name"></div><div class="badge-name"></div></div><div class="mstrmojo-UsherLogin"><div class="mstrmojo-UsherLogin-QR mode"><img class="QR" src="../images/1ptrans.gif" alt="" /></div><div class="mstrmojo-UsherLogin-register mode"></div></div><div class="mstrmojo-UsherLogin-userInfo mode"><img class="userInfo" src="../images/1ptrans.gif" alt="" /></div><div class="mstrmojo-UsherLogin-notification"></div><div class="mstrmojo-UsherLogin-remember-setting"><div class = "mstrmojo-UsherLogin-remember"></div><div class = "mstrmojo-UsherLogin-forget"></div></div><div class="mstrmojo-UsherLogin-link"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},badgeNode:function(){return this.domNode.firstChild;},badgeIconNode:function(){return this.domNode.firstChild.firstChild.firstChild;},badgeLabelNode:function(){return this.domNode.childNodes[1];},usherNode:function(){return this.domNode.childNodes[2];},qrNode:function(){return this.domNode.childNodes[2].firstChild;},qrCodeNode:function(){return this.domNode.childNodes[2].firstChild.firstChild;},refreshNode:function(){return this.domNode.childNodes[2].firstChild.lastChild;},registerNode:function(){return this.domNode.childNodes[2].lastChild;},userNode:function(){return this.domNode.childNodes[3];},userInfoNode:function(){return this.domNode.childNodes[3].firstChild;},notificationNode:function(){return this.domNode.childNodes[4];},rememberSettingsNode:function(){return this.domNode.childNodes[5];},rememberNode:function(){return this.domNode.childNodes[5].firstChild;},forgetNode:function(){return this.domNode.childNodes[5].lastChild;},linksNode:function(){return this.domNode.lastChild;}},markupMethods:{onqrCodeChange:function(){if(this.qrCodeNode){this.qrCodeNode.src=this.qrCode;}},onbadgeChange:function(){var badge=this.badge||DEFAULT_BADGE,badgeFormat=badge.badgeFormat,fmt=badgeFormat&&(window.JSON?JSON.parse(badgeFormat):eval("("+badgeFormat+")"))||{isnull:true},labelNode=this.badgeLabelNode,iconNode=this.badgeIconNode,domNode=this.domNode;if(this.showBadgeBackgroundImage){domNode.style.backgroundColor=fmt.mini_badge;if(fmt.bg_4){domNode.style.backgroundImage="url("+fmt.bg_4+")";}}iconNode.src=fmt.mini_badge_icon||DEFAULT_BADGE.mini_badge_icon;if(!fmt.isnull&&!fmt.mini_badge_icon){CSS.addClass(iconNode.parentNode,"default");}labelNode.firstChild.innerHTML=badge.appName||DEFAULT_BADGE.appName;labelNode.lastChild.innerHTML=badge.name||DEFAULT_BADGE.name;labelNode.lastChild.title=badge.name||DEFAULT_BADGE.name;labelNode.style.color=fmt.t_color||DEFAULT_BADGE.t_color;this.linksNode.style.color=fmt.t_color||DEFAULT_BADGE.t_color;},onexpiredChange:function(){CSS.toggleClass(this.usherNode,"expired",this.expired);},onloadingChange:function(){CSS.toggleClass(this.usherNode,"loading",this.loading);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible&&this.canRequestQR()&&!this._lastVisible){getQRCode.call(this);}this.stopPolling=!this.visible;this._lastVisible=this.visible;},onnotificationModeChange:function(evt){CSS.toggleClass(this.containerNode,"notificationMode",this.notificationMode);},onproximityModeChange:function(evt){CSS.toggleClass(this.containerNode,"proximityMode",this.proximityMode);},onisPnEnabledChange:function(){this.hideRememberMe(!this.isPnEnabled);}},qrCode:"../images/1ptrans.gif",badge:DEFAULT_BADGE,expired:false,onUsherLogin:mstrmojo.emptyFn,onUsherError:mstrmojo.emptyFn,showBadgeBackgroundImage:true,usherProps:null,serverName:null,serverPort:null,rememberMe:false,userInfo:null,notificationTimer:null,loadQR:false,notificationMode:false,isPnEnabled:false,init:function init(props){if(this._super){this._super(props);}CSS.addWidgetCssClass(this,"");this.usherProps=this.usherProps?HASH.copy(this.usherProps,HASH.clone(usherProps)):HASH.clone(usherProps);this.userInfo=this.userInfo?HASH.copy(this.userInfo,HASH.clone(userInfo)):HASH.clone(userInfo);this.notificationTimer=this.notificationTimer?HASH.copy(this.notificationTimer,HASH.clone(notificationTimer)):HASH.clone(notificationTimer);},destroy:function destroy(ignoreDOM){this.stopPolling=true;clearTimeout(this.pullTimeout);this._super(ignoreDOM);},canRequestQR:function(){return this.usherProps&&(this.loadQR||(this.serverName||mstrConfig.serverName));},showUserInfo:function(res){this.refresh.set("visible",false);this.refresh.set("visible",false);},updateQRCode:function(res){this.set("qrCode","data:image/png;base64,"+res);this.set("expired",false);this.refresh.set("visible",false);},updateQRCodeProximity:function(){this.set("qrCode","../images/WaitUsherRadar.gif");this.set("expired",false);this.refresh.set("visible",false);},handleQRCodeError:function(){this.set("qrCode","../style/mstr/images/msgError.gif");this.set("expired",true);this.refresh.set("visible",true);},showQRLoading:function showQRLoading(show){this.set("loading",show);if(show){this.refresh.set("visible",false);}},postBuildRendering:function(){this._super();this.registerForm.set("tabIndex",-1);},toggleRegister:function(force){this.registerVisible=(force!==undefined)?force:!this.registerVisible;CSS.toggleClass(this.usherNode,"show-register",this.registerVisible);this.registerLink.set("text",this.registerLink.texts[this.registerVisible?1:0]);if(this.isPnEnabled===true){this.hideRememberMe(this.registerVisible&&this.isPnEnabled);}},hideRememberMe:function(force){CSS.toggleClass(this.rememberSettingsNode,"hide-rememeber",force);},reloadQR:function(){if(this.canRequestQR()){if(this.pullTimeout){clearTimeout(this.pullTimeout);}this.usherProps.intervalCtr=0;this.usherProps.qrLoaded=false;if(this.visible){getQRCode.call(this);}}},children:[{scriptClass:"mstrmojo.Label",slot:"qrNode",alias:"refresh",cssClass:"refresh",text:mstrmojo.desc(14028,"Refresh QR Code"),visible:false,onclick:function(){getQRCode.call(this.parent);}},{scriptClass:"mstrmojo.Box",slot:"registerNode",alias:"registerForm",regMsg:null,children:[getTextBoxJson({alias:"user",cssClass:"login-username",cssDisplay:"block",hint:mstrmojo.desc(17,"User name")}),getTextBoxJson({alias:"pwd",cssClass:"login-pwd",hint:mstrmojo.desc(18,"Password"),type:"password"}),getTextBoxJson({alias:"email",cssClass:"login-email",dtp:DTP.VARCHAR,constraints:{validator:_VALIDATOR.VALIDATE_EMAIL,trigger:mstrmojo.validation.TRIGGER.ONKEYUP},bindings:{visible:"this.parent.parent.usherRegistrationOption > 2"},hint:mstrmojo.desc(9772,"Email")}),getTextBoxJson({alias:"confirmEmail",cssClass:"login-email",bindings:{visible:function(){return this.parent.parent.usherRegistrationOption>2;}},hint:mstrmojo.desc(14149,"Confirm Email"),onpaste:function(evt){DOM.preventDefault(evt.hWin,evt.e||evt.hWin.event);}}),{scriptClass:"mstrmojo.Box",alias:"regMsg",cssClass:"register-msg",bindings:{regMsg:function(){return this.parent.regMsg;},visible:function(){return this.parent.regMsg;}},onregMsgChange:function(){if(this.domNode){this.domNode.style.color=this.regMsg&&this.regMsg.successful?"#42C31E":"#f00";}},children:[{scriptClass:"mstrmojo.Label",alias:"msg",cssClass:"register-msg-txt",bindings:{text:function(){return this.parent.regMsg.msg;}}},{scriptClass:"mstrmojo.Label",alias:"icn",cssClass:"register-msg-icn",onclick:function(){this.parent.parent.parent.toggleRegister();this.parent.parent.set("regMsg",null);}}]},{scriptClass:"mstrmojo.Button",alias:"registerButton",cssClass:"register mstrmojo-WebButton hot",cssDisplay:"inline-block",text:mstrmojo.desc(11773,"Register"),bindings:{enabled:function(){var username=this.parent.user.value,email=this.parent.email.value,confirmEmail=this.parent.confirmEmail.value;var registerStatus=username.length>0;if(registerStatus){if(this.parent.parent.usherRegistrationOption>1){var emailStatus=email.length>=3&&confirmEmail.length>=3&&email.toUpperCase()===confirmEmail.toUpperCase()&&this.parent.email.validationStatus.code===_SC.VALID;if(emailStatus){if(this.parent.parent.usherRegistrationOption==7){var restrictedDomains=this.parent.parent.usherRegistrationDomain.toUpperCase();var emailDomain=email.substr(email.indexOf("@")+1).toUpperCase();return restrictedDomains.indexOf(emailDomain)>=0;}}return emailStatus;}}return registerStatus;}},onclick:function(){registerHandler.call(this.parent);}},{scriptClass:"mstrmojo.Button",alias:"registerCancelButton",cssClass:"register-cancel",cssDisplay:"inline-block",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var p=this.parent;p.parent.toggleRegister();p.set("regMsg",null);p.user.set("value","");p.pwd.set("value","");p.email.set("value","");p.confirmEmail.set("value","");p.user.domNode.focus();}}]},{scriptClass:"mstrmojo.CheckBox",slot:"rememberNode",alias:"remember-me",label:mstrmojo.desc(14522,"Remember me"),onclick:function onclick(){this.parent.set("rememberMe",this.checked);}},{scriptClass:"mstrmojo.Label",slot:"forgetNode",allowHTML:true,text:mstrmojo.desc(14527,"Forget me/Switch user"),onclick:function(){forgetMe.call(this.parent);}},{scriptClass:"mstrmojo.Label",slot:"linksNode",allowHTML:true,text:'<a id="proximityProblems" href="#">Login via Phone</a>',onclick:function(evt){getQRCode.call(this.parent,true);return false;},bindings:{visible:"this.parent.proximityMode"},},{scriptClass:"mstrmojo.Label",slot:"linksNode",allowHTML:true,text:mstrmojo.desc(14136,"Use your ###Usher## app to scan the QR Code.").replace("###",'<a href="https://itunes.apple.com/us/app/usher-identity/id776079205" target="_blank">').replace("##","</a>"),},{scriptClass:"mstrmojo.Label",slot:"linksNode",alias:"registerLink",cssClass:"register-label",allowHTML:true,bindings:{visible:"this.parent.usherRegistrationOption > 0"},text:"",texts:[mstrmojo.desc(14137,"Don't have an Usher Badge? Click ###here## to register."),mstrmojo.desc(14140,"Display your ###QR Code##.")],postCreate:function(){this.set("text",this.texts[0]);},ontextChange:function(){this.text=this.text.replace("###",'<a href="#" onclick="mstrmojo.all.'+this.parent.id+'.toggleRegister(); return false;">').replace("##","</a>");}},{scriptClass:"mstrmojo.Label",alias:"userDetails",cssClass:"user-details",slot:"userNode"},{scriptClass:"mstrmojo.Button",alias:"loginButton",cssClass:"mstrmojo-WebButton login-button .mstrButton",cssDisplay:"inline-block",text:mstrmojo.desc(14525,"Login with Usher"),slot:"notificationNode",visible:false,onclick:function(){submitLogin.call(this.parent);},onvisibleChange:function(){var node=this.parent,msg=mstrmojo.desc(14523,"Hi ")+" "+node.userInfo.firstName;this.visible?msg+="!":msg+=mstrmojo.desc(14524,", please approve on your device.");updateUserDetails.call(node,msg);}},{scriptClass:"mstrmojo.Box",alias:"loginNotificationBox",cssClass:"login-notification",slot:"notificationNode",visible:false,children:[{scriptClass:"mstrmojo.Label",alias:"timer",cssClass:"notification-timer"},{scriptClass:"mstrmojo.Label",alias:"notificationFailure",cssClass:"notification-failure",text:mstrmojo.desc(14526,"Did not get notification"),onclick:function(){toggleLoginNotification.call(this.parent.parent,true);}}]},]});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.HBox","mstrmojo.EnumAuthenticationModes","mstrmojo.UsherLogin","mstrmojo.string","mstrmojo.cookies");mstrmojo.requiresDescs(17,18,221,11804,11863);var E=mstrmojo.EnumAuthenticationModes,D={};D[E.LDAP]=mstrmojo.desc(1947,"LDAP Authentication");D[E.DATABASE]=mstrmojo.desc(1948,"Database Authentication");var K={LIVE_OR_HL:0,PERSISTED:1};function B(){return(JSON.parse(decodeURIComponent(mstrmojo.cookies.getCookieSetting("lastMsgID")||"{}")))[mstrConfig.lastMsgKey];}function C(){var P=this,Q=P.stdLoginInfo,N=Q.user.value,M=Q.tsvCode.value,R=Q.pwd.value,S={taskId:"login",server:mstrConfig.serverName,project:mstrmojo.string.decodeHtmlString(mstrConfig.projectName),port:mstrConfig.serverPort,authMode:mstrConfig.authMode,setAsActiveSession:true};var O=B();if(O){S.msgID=O;}if((this.authMode&(E.STANDARD|E.LDAP|E.DATABASE))>0){S.userid=N;S.password=R;S.tsvCode=M;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(V){if(V&&V.sessionState){mstrApp.updateSessionState(V.sessionState);if(mstrApp.sessionManager){mstrApp.sessionManager.restart();}var X=V;var U=V.resCode;if(U==K.LIVE_OR_HL&&(mstrApp.isVI||mstrApp.scriptClass==="mstrmojo.OIVMApp"||mstrApp.analysisID)){mstrmojo.xhr.request("post",mstrConfig.taskURL,{success:function(){var Y=P.config.callback,Z=Y.success;if(Z){Z(X);}},failure:function(){mstrmojo.form.send({evt:3010,src:mstrApp.name+".3010"},null,"POST");}},{taskId:"docXMLResults",sessionState:V.sessionState,msgID:V.msgID,resultFlags:33554432});}else{var T=P.config.callback,W=T.success;if(W){W(X);}}}P.destroy();},failure:function(T){mstrmojo.alert(T.getResponseHeader("X-MSTR-TaskFailureMsg"),null,null,P.zIndex);}},S);}function L(){if(mstrApp.sessionManager){mstrApp.sessionManager.gotoLogoutPage();}}mstrmojo.LoginEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.LoginEditor",cssClass:"mstrmojo-LoginEditor",title:mstrmojo.desc(11804,"Log in to"),btnAlignment:"right",help:"login_box",config:{callback:{},taskParams:{}},authMode:E.STANDARD,usherEnabled:false,init:function J(M){this._super(M);this.title+=" "+mstrApp.projectName;this.set("authMode",parseInt(mstrConfig.authMode,10));if(this.isUsherLogin()){mstrmojo.css.addWidgetCssClass(this,"usher");}},isUsherLogin:function(){return this.authMode===E.USHER;},onvisibleChange:function I(){if(this.visible&&(mstrmojo.dom.isFF||mstrmojo.dom.isWK)){var M=this.stdLoginInfo.user;window.setTimeout(function(){M.focus();},50);}},onClose:function F(){L();},destroy:function H(){mstrmojo.dom.detachEvent(document.body,"mousedown",this.stopPropagation,true);this._super();},postBuildRendering:function A(){if(this.authMode===mstrmojo.EnumAuthenticationModes.NTCREDENTIAL){C.call(this);return ;}else{var M=this._super();this.stopPropagation=function(N){N.stopPropagation();};mstrmojo.dom.attachEvent(document.body,"mousedown",this.stopPropagation,true);return M;}},preBuildRendering:function G(){if(this.isUsherLogin()){var N=this,M=mstrmojo.insert({scriptClass:"mstrmojo.UsherLogin",alias:"usherLogin",onUsherLogin:function(){mstrConfig.authMode=E.USHER;C.call(N);}});this.addChildren([M],1);}return this._super();},children:[{scriptClass:"mstrmojo.Label",cssText:"margin-bottom: 20px; line-height: 1.5em;",text:mstrmojo.desc(11863,"Your user session has timed out due to inactivity, and you have been automatically logged out. Please log in again.")},{scriptClass:"mstrmojo.Box",alias:"stdLoginInfo",cssClass:"std-login-container",bindings:{visible:function(){return this.parent.authMode!==E.USHER;}},children:[{scriptClass:"mstrmojo.TextBox",alias:"user",cssClass:"login-username",cssDisplay:"block",hint:mstrmojo.desc(17,"User name"),postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(17,"User name");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.TextBox",alias:"pwd",cssClass:"login-pwd",cssDisplay:"block",hint:mstrmojo.desc(18,"Password"),type:"password",postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(18,"Password");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.TextBox",alias:"tsvCode",cssClass:"login-tsvCode",cssDisplay:"block",hint:mstrmojo.desc(13825,"Usher code"),bindings:{visible:function(){return mstrConfig.features["is-two-step-verification-required"];}},postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(13825,"Usher code");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-LoginEditor-authMode",bindings:{visible:function(){return this.parent.parent.authMode===E.LDAP||this.parent.parent.authMode===E.DATABASE;},text:function(){return D[this.parent.parent.authMode]||"";}}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btns",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:mstrmojo.desc(26,"Login"),bindings:{enabled:"this.parent.parent.stdLoginInfo.user.value.length > 0",visible:function(){return this.parent.parent.authMode!==E.USHER;}},onclick:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){L();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.FieldSet","mstrmojo.Label","mstrmojo.ColorPicker");var A=mstrmojo.hash,B=mstrmojo.color;mstrmojo.FillFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.FillFormatter",cssClass:"mstrmojo-FillFormatter",isChart:false,markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){A.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"fill",cssClass:"mstrmojo-FormatEditor-fill",legend:mstrmojo.desc(2885,"Fill"),bindings:{legend:"this.parent.isChart ? mstrmojo.desc(3902, 'Series Colors') : mstrmojo.desc(2885, 'Fill')"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060,"Color"),cssClass:"label"},mstrmojo.ColorPicker.createDropDown({bindings:{m:"this.parent.parent.model",fillStyle:function(){var H=this.m,J=parseInt(H.FillStyle,10);if(J===2){var E=parseInt(H.GradientAngle,10),I=E===0?1:0,D=B.decodeColor(H.FillColor),K=B.decodeColor(H.GradientColor),C=parseInt(H["Gradient"+(E===0?"X":"Y")+"Offset"],10)===100?1:0,G=(C!==1)?mstrmojo.css.buildGradient(I,D,K):mstrmojo.css.buildGradient(I,K,D);this.set("gradientCss",G.n+":"+G.v);this._updateGradientInfo();}else{var F=this.m.FillColor;if(F!==undefined&&/^\d{1,8}$/.test(F)){F=B.decodeColor(F);}else{F="transparent";}this.set("fillColor",F);}return J||0;}},_updateGradientInfo:function(){var C=this.m;this.gradient=mstrmojo.hash.copy({FillColor:B.decodeColor(C.FillColor),GradientColor:B.decodeColor(C.GradientColor)},A.copy(C));},onfillColorChange:function(){this.m.FillColor=(this.fillColor==="transparent"?"pru":B.encodeColor(this.fillColor));this.m.FillStyle=0;},ongradientChange:function(C){var F=["FillStyle","FillColor","GradientColor","GradientXOffset","GradientYOffset","GradientAngle"],E;for(E=0;E<F.length;E++){var D=C.value[F[E]];this.m[F[E]]=/Color$/.test(F[E])?B.encodeColor(D):D;}this.m.FillStyle=2;}},{showGradients:true})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo._FormatDefinition","mstrmojo.Table","mstrmojo._HasLayout","mstrmojo.color","mstrmojo.ColorPicker");var D=mstrmojo.hash,C=mstrmojo.array,F=mstrmojo._FormatDefinition,B=mstrmojo.color;var A=function(G){var H={scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-fontFamily",itemCssClass:"mstrmojo-FormatEditor-bullet",selectedIndex:0,itemIdField:"v",itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>'};return D.copy(G,H);};var E=function(I){var H=I.alias,G=I.label,J=I.pr;return{alias:H,scriptClass:"mstrmojo.TristateCheckBox",text:G,checked:false,grayed:false,bindings:{m:I.modelBinding,checked:function(){return this.m[J]==-1;},grayed:function(){return(typeof this.m[J]=="undefined")||this.m[J]=="pru";}},oncheckedChange:function(K){if(this.m){this.m.set(J,this.checked?-1:0);}}};};mstrmojo.FontFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.FontFormatter",cssClass:"mstrmojo-FontFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{},{},{}]},{cells:[{},{colSpan:2}]}],children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2172),slot:"0,0"},A({items:F.Families,itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text" style="font-family:{@n}">{@n}</div></div>',pr:"Name",bindings:{selectedIndex:function(){var H=this.parent.parent.model;if(H){var I=H.Name,G=C.find(this.items,this.itemIdField,I);return G==-1?0:G;}}},onchange:function(){var G=this.parent.parent.model;if(G){G.set("Name",this.selectedItem.v);}},slot:"0,0"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3059),slot:"0,1"},A({items:F.Styles,cssClass:"mstrmojo-FormatEditor-fontStyle",bindings:{selectedIndex:function(){var K=this.parent.parent.model;if(K){var I=K.Bold||"",H=K.Italic||"",J=I==""&&H==""?"":I+","+H,G=mstrmojo.array.find(this.items,this.itemIdField,J);G=G==-1?mstrmojo.array.find(this.items,"v2",J):G;return(G==-1?0:G);}}},onchange:function(){var I=this.parent.parent.model;if(I&&this.selectedItem){var H=this.selectedItem.v.split(","),G=italic="pru";if(H[0]!="pru"){G=H[0]=="-1"?"-1":"0";italic=H[1]=="-1"?"-1":"0";}I.set("Bold",G);I.set("Italic",italic);}},slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2178),slot:"0,2"},A({items:F.Sizes,cssClass:"mstrmojo-FormatEditor-fontSize",bindings:{selectedIndex:function(){var H=this.parent.parent.model;if(H){var I=H.Size,G=C.find(this.items,this.itemIdField,I);return G==-1?0:G;}}},onchange:function(){var G=this.parent.parent.model;if(G){G.set("Size",this.selectedItem.v);}},slot:"0,2"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3060),slot:"1,0"},{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-FormatEditor-fontEffect",postCreate:function(){this.addChildren(E({alias:"Underline",label:mstrmojo.desc(3061),pr:"Underline",modelBinding:"this.parent.parent.parent.model"}));this.addChildren(E({alias:"Strikeout",label:mstrmojo.desc(3062),pr:"Strikeout",modelBinding:"this.parent.parent.parent.model"}));},slot:"1,0"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3063),slot:"1,1"},mstrmojo.ColorPicker.createDropDown({pr:"Color",bindings:{fillColor:function(){var G=this.parent.parent.model;if(G){var H=G[this.pr];if(typeof (H)!="undefined"&&/^\d{1,8}$/.test(H)){return B.decodeColor(H);}}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.model){this.parent.parent.model.set(this.pr,this.fillColor=="transparent"?"pru":B.encodeColor(this.fillColor));}},slot:"1,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2036),slot:"1,1"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FormatEditor-fontPreview",text:mstrmojo.desc(2037),bindings:{m:"this.parent.parent.model",cssText:function(){var H=this.m.Color,J=this.m.Size,K=this.m.Name,I=this.m.Bold,G=this.m.Italic,M=this.m.Underline,L=this.m.Strikeout;H=/^\d{1,8}$/.test(H)?B.decodeColor(H):B.decodeColor(F.DefaultFormat.FormattingFont.Color);J=J||F.DefaultFormat.FormattingFont.Size;K=K||F.DefaultFormat.FormattingFont.Name;I=I=="-1"?"bold":"normal";G=G=="-1"?"italic":"normal";M=parseInt(M)==-1;L=parseInt(L)==-1;return";font-family:"+K+";font-style:"+G+";font-weight:"+I+";font-size:"+J+"pt;color:"+H+";text-decoration:"+(M?" underline ":"")+(L?" line-through ":"");}},slot:"1,1"}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.FieldSet","mstrmojo._FormatDefinition","mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ColorPicker");var C=mstrmojo.hash,A=mstrmojo.color,D=mstrmojo._FormatDefinition;var B=function(F,I,E){var H=["Left","Right","Top","Bottom"];for(var G=0;G<3;G++){F[H[G]+I]=E;}F.set(H[3]+I,E);};mstrmojo.BorderFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.BorderFormatter",cssClass:"mstrmojo-BorderFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){C.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"borders",cssClass:"mstrmojo-FormatEditor-border",legend:mstrmojo.desc(2886),children:[{scriptClass:"mstrmojo.Table",alias:"borderTable",cssText:"width:100%;",rows:1,cols:2,children:[{scriptClass:"mstrmojo.List",alias:"borderTypes",selectedIndex:0,cssClass:"borderTypes",items:[{n:'<img border="0" align="absmiddle" src="../images/borders_none.gif" alt=""> '+mstrmojo.desc(2057),v:1},{n:'<img border="0" align="absmiddle" src="../images/borders_all.gif" alt=""> '+mstrmojo.desc(2058),v:2},{n:'<img border="0" align="absmiddle" src="../images/borders_custom.gif" alt=""> '+mstrmojo.desc(2056),v:3}],slot:"0,0",bindings:{m:"this.parent.parent.parent.model",selectedIndex:function(){var E=this.m;if(C.isEmpty(E)){return 0;}if(E.LeftStyle==0&&E.TopStyle==0&&E.RightStyle==0&&E.BottomStyle==0){return 0;}else{if(E.LeftStyle==E.TopStyle&&E.LeftStyle==E.RightStyle&&E.LeftStyle==E.BottomStyle){return 1;}}return 2;}},onchange:function(E){if(this.m){var G=this.parent.borderAndColor;if(!G){return ;}if(this.selectedIndex===0){var H=["Left","Right","Top","Bottom"];for(var F=0;F<4;F++){this.m.set(H[F]+"Style","0");this.m.set(H[F]+"Color","0");}}}}},{scriptClass:"mstrmojo.Container",alias:"borderAndColor",markupString:'<div class="borderStyles"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.Container",alias:"allBordersContainer",markupString:'<div class="mstrmojo-FormatEditor-ColorLine-borders"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:"this.parent.parent.borderTypes.selectedIndex==1"},children:[{scriptClass:"mstrmojo.Table",alias:"allBorders",rows:1,cols:3,onshowChange:function(){if(this.show){B(this.m,"Style",this.styles.value);B(this.m,"Color",A.encodeColor(this.colors.fillColor));}},bindings:{m:"this.parent.parent.parent.parent.parent.model"},postCreate:function(){var F=["Left","Right","Top","Bottom"];var E=[{scriptClass:"mstrmojo.Pulldown",alias:"styles",items:D.BorderStyles,itemIdField:"v",bindings:{m:"this.parent.m",value:function(){var I=this.m.LeftStyle,K=this.m.RightStyle,J=this.m.TopStyle,H=this.m.BottomStyle;var G=0;if(I==K&&K==H&&H==J){G=mstrmojo.array.find(D.BorderStyles,"v",I);}G=G==-1?0:G;return this.items[G][this.itemIdField];}},onvalueChange:function(){if(this.parent.parent.visible){B(this.m,"Style",this.value);}},slot:"0,1"},mstrmojo.ColorPicker.createDropDown({alias:"colors",bindings:{m:"this.parent.m",fillColor:function(){var H=this.m.LeftColor,K=this.m.RightColor,J=this.m.TopColor,G=this.m.BottomColor;if(H==K&&K==G&&G==J){var I=H;}if(typeof (I)!="undefined"&&/^\d{1,8}$/.test(I)){return A.decodeColor(I);}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.visible){B(this.m,"Color",this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));}},slot:"0,2"})];this.addChildren(E);}}]},{scriptClass:"mstrmojo.Container",alias:"customBordersContainer",markupString:'<div class="mstrmojo-FormatEditor-ColorLine-borders"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:"this.parent.parent.borderTypes.selectedIndex==2"},children:[{scriptClass:"mstrmojo.Table",alias:"customBorders",rows:1,cols:3,bindings:{m:"this.parent.parent.parent.parent.parent.model"},postCreate:function(){var H=["Left","Right","Top","Bottom"];var G=[];for(var F=0;F<H.length;F++){var E=H[F];G.push({scriptClass:"mstrmojo.Label",text:mstrmojo.desc({Left:3528,Right:3529,Top:3526,Bottom:3527}[E]),alias:E,slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",items:D.BorderStyles,itemIdField:"v",pr:E+"Style",bindings:{m:"this.parent.m",value:function(){var K=this.m.LeftStyle,M=this.m.RightStyle,L=this.m.TopStyle,J=this.m.BottomStyle;var I=mstrmojo.array.find(D.BorderStyles,"v",this.m[this.pr]);I=I==-1?0:I;return this.items[I][this.itemIdField];}},onvalueChange:function(){if(this.parent.parent.visible){this.m.set(this.pr,this.value);}},slot:"0,1"},mstrmojo.ColorPicker.createDropDown({cssClassx:"mstrmojo-FormatEditor-colorPicker",alias:E+"Color",pr:E+"Color",bindings:{m:"this.parent.m",fillColor:function(){var J=this.m.LeftColor,M=this.m.RightColor,L=this.m.TopColor,I=this.m.BottomColor;var K=this.m[this.pr];if(typeof (K)!="undefined"&&/^\d{1,8}$/.test(K)){return A.decodeColor(K);}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.visible){this.m.set(this.pr,this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));}},slot:"0,2"}));}this.addChildren(G);}}]}],slot:"0,1"}]},{scriptClass:"mstrmojo.Label",cssClass:"borderPreview",text:mstrmojo.desc(7941),bindings:{m:"this.parent.parent.model",cssText:function(){var G={0:"None",3:"Dashed",4:"Dotted",6:"Double",7:"Solid"},E={1:"Thin",5:"Thick",6:"medium"};var F=this.parent.borderTable.borderTypes.selectedIndex;return";border-left-style: "+(G[this.m.LeftStyle]||"solid")+";border-right-style: "+(G[this.m.RightStyle]||"solid")+";border-top-style: "+(G[this.m.TopStyle]||"solid")+";border-bottom-style: "+(G[this.m.BottomStyle]||"solid")+";border-left-color: "+A.decodeColor(this.m.LeftColor||"0")+";border-right-color: "+A.decodeColor(this.m.RightColor||"0")+";border-top-color: "+A.decodeColor(this.m.TopColor||"0")+";border-bottom-color: "+A.decodeColor(this.m.BottomColor||"0")+";border-left-width: "+(E[this.m.LeftStyle]||"thin")+";border-right-width: "+(E[this.m.RightStyle]||"thin")+";border-top-width: "+(E[this.m.TopStyle]||"thin")+";border-bottom-width: "+(E[this.m.BottomStyle]||"thin");}}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.EditableLabel");var A=mstrmojo.css,E=mstrmojo.validation.STATUSCODE;mstrmojo.ui.editors.controls.ComboBox=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",markupMethods:{onenabledChange:function D(){this.txtLabel.set("editOnClick",this.enabled);A.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ComboBox");},updatePreview:function C(){this.txtLabel.set("value",this.selectedValue||"");},updateSelection:function(){this.set("selectedValue",this.txtLabel.value);},validateTextInput:function(F){return true;},txtLabel:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"txtLabel",slot:"previewNode",constraints:{validator:function(){if(!this.parent.validateTextInput(this.value)){return{id:this.id,code:E.INVALID,msg:""};}}},onValid:function(){this.parent.updateSelection();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.num","mstrmojo.expr","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ValidationTextBox","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.models.template.DataInterface");var E="selColScenario",N="colTargetAndWidth",D="selRowScenario",G="rowHeightContainer",C=mstrmojo.num,I=mstrConfig,F=mstrmojo.expr,H=mstrmojo.models.template.DataInterface.ENUM_GRID_RESIZE,M=H.FIXED,A=mstrmojo.ui.Pulldown.newPulldown;function B(P,O,Q){O.slot="col1Node";return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:P,col1Width:"100%",col2Width:"56px",children:[O,{scriptClass:"mstrmojo.Box",slot:"col2Node",value:0,enabled:true,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",cssText:"text-align:right;width:36px",cssDisplay:"inline-block",bindings:{value:"this.parent.value",enabled:"this.parent.enabled"},dtp:F.DTP.NUMERIC,onValid:function(){var R,S;if(C.UNIT.PX!==I.units){R=parseFloat(this.value).toFixed(2);S=R!==parseFloat(this.orignText);}else{R=parseInt(this.value,10);S=R!==parseInt(this.orignText,10);}if(S){Q.call(this.parent.parent.parent,R);}}},{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",cssText:"width:16px;padding-left:2px;",text:C.UNIT_SYMBOL[I.units],title:I.unitsLabel}]}]};}function J(R,Q,P){var O=[{n:mstrmojo.desc(2987,"Fit to contents"),v:H.FIT_TO_CONTENTS},{n:mstrmojo.desc(2050,"Fixed"),v:M}];if(P){O.unshift({n:mstrmojo.desc(13580,"Fit to container"),v:H.FIT_TO_WINDOW});}return A(O,function(S){var T=this.parent;T[Q].set("enabled",S.v===M);if(!T._sync){T.targetXtab.changeResizeScenario(S.v,P);}},undefined,{alias:R,isHostedWithin:false});}mstrmojo.ui.editors.controls.XtabResizeGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.XtabResizeGroup",init:function K(O){this._super(O);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-XtabResize");var P=this;this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(159,"Columns:")},J(E,N,true),B(N,A([],function(V){var R=this.parent,U=V.width,Q=P.xtabInterface.getColResizeScenario()===M,T=P.xtabInterface.getColResizeInfo(P.targetXtab.model.docModel.datasets).widths||[{}];if(T.length){var S=T[0].width;if(Q&&V._renderIdx!==undefined){P.targetXtab.edtModel._lsfcw=V._renderIdx;}if(U===""){var W=T.every(function(X){return X.width===S;});if(W){U=S;}}R.parent.syncControls(function(){R.getControl(2).set("value",(Q&&U!=="")?((C.UNIT.PX===I.units)?U:parseFloat(C.convertUnits(C.UNIT.PX,I.units,U)).toFixed(2)):"");});}}),function(R){var Q=this[N].getControl(1).getSelectedItem();this.targetXtab.changeColumnWidth(Q.did,Q.t,Math.round(C.convertUnits(I.units,C.UNIT.PX,R)),Q.depth||1,false);}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(113,"Rows:")},J(D,G,false),B(G,{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13581,"Row height:")},function(Q){this.targetXtab.changeRowHeight(Math.round(C.convertUnits(I.units,C.UNIT.PX,Q)));})]);},targetXtab:null,xtabInterface:null,setFormatSource:function L(S){var R=this,Q=R.xtabInterface=this.addDisposable(new mstrmojo.models.template.DataInterface(S.model.data)),T=Q.isEmpty(),P=S.edtModel,O=P._lsfcw=P._lsfcw===undefined?1:P._lsfcw;R.targetXtab=S;R.set("enabled",!T);if(!T){this.syncControls(function(){var Z=Q.getColResizeInfo(S.model.docModel.datasets),U=Z.widths||[];R[E].selectItemByField("v",Z.v);var X=R[N],W=X.getControl(1);U.unshift({n:mstrmojo.desc(2429,"All Columns"),did:"all",width:""});W.set("items",U);W.set("selectedIndex",Z.v===M?Math.min(O,U.length-1):0);var a=Q.getRowResizeInfo(),Y=a.v,V=a.height;R[D].selectItemByField("v",Y);R[G].getControl(2).set("value",Y===M?((C.UNIT.PX===I.units)?V:parseFloat(C.convertUnits(C.UNIT.PX,I.units,V)).toFixed(2)):"");});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._HasLayout","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.expr","mstrmojo.css");var C=mstrmojo.expr.DTP,B=mstrmojo.css,A="mstrmojo-Stepper-ErrValidation";mstrmojo.ui.editors.controls.Stepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.Stepper",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,mouseup,mousemove,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text"></div><div class="prev">-</div></div>',layoutConfig:{w:{textNode:"100%"},xt:true},textInput:null,init:function E(F){var G=F.provider;this.children=[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"textInput",slot:"textNode",dtp:G.dtp||C.INTEGER,constraints:{validator:G.validator,max:G.max,min:G.min},onValid:function(){var H=this.parent;B.removeClass(H.domNode,A);G.setVal(parseInt(this.value,10)||0);H.updateDisplayText();}}];this._super(F);this.addDisposable(G);B.addWidgetCssClass(this,"mstrmojo-ui-ctrl-Stepper");},postBuildRendering:function(){this.updateDisplayText();this._super();},updateDisplayText:function D(){this.textInput.set("value",this.provider.getVal());}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.css");var C,D=mstrmojo.css;var J=mstrmojo.declare(mstrmojo.ui.PopupList,null,{getItemMarkup:function G(K){if(!C){C=this._super(K).replace(">{@en@n}<","><div>{@en@n}</div><");}return C;},getItemProps:function F(M,K){var L=this._super(M,K);L.addCls("bst"+K);if(K){L.title=M.n;L.n="";}else{L.tt="";}return L;}});mstrmojo.ui.editors.controls.LineStyleButton=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",itemValueField:"id",showThickOption:true,markupMethods:{onenabledChange:function E(){D.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function H(L){this._super(L);var K=["mstrmojo-ui-LineStyle"];if(!this.showThickOption){K.push("no-thick");}D.addWidgetCssClass(this,K);},getListCfg:function I(){return new J({selectionPolicy:"reselect",items:[{n:mstrmojo.desc(2258,"None"),id:"none"},{n:mstrmojo.desc(2259,"Dashed"),id:"1pt dashed"},{n:mstrmojo.desc(2260,"Dotted"),id:"1pt dotted"},{n:mstrmojo.desc(2262,"Thin"),id:"1pt solid"},{n:mstrmojo.desc(2264,"Thick"),id:"2pt solid"}]});},postBuildRendering:function A(){this.borderStyleNode=this.previewNode.appendChild(document.createElement("div"));return this._super();},updatePreview:function B(){var N=this.borderStyleNode,L=this.selectedValue.split(" "),K=this.selectedValue==="conflict";D.toggleClass(this.previewNode,"conflict",K);if(N&&!K){var M=N.style;if(L.length===1){M.borderTopStyle=L[0];}else{M.borderTopWidth=L[0];M.borderTopStyle=L[1];}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.hash","mstrmojo.Button","mstrmojo.Label","mstrmojo.ToolSeparator","mstrmojo.ui.ScrollableContainer","mstrmojo.ui.Pulldown");mstrmojo.requiresDescs(1442,8689,11952,11953,11954,11955,11956,11957,12136);var D=mstrmojo.hash,G=mstrmojo.Button.newWebButton,N=function(P){if(P){var O=P.t;return Math.round(O/10)==52||O==115;}return false;},L={},K,E,I,F,H,B=function(){var Q=this,T=Q.vis,V=[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-title-label",allowHTML:true,text:mstrmojo.desc(11952,"Use  <span>#</span> to filter the following targets:").replace("#",T.title),visible:true},{scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"VisContainer",cssClass:"mstrmojo-scrollable-container",children:[]},{scriptClass:"mstrmojo.ToolSeparator"},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-filter-type",cssDisplay:"table-cell",alias:"filterType",selectedIndex:(!!H&&H.length>0)&&!E&&!K?1:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(8689,"Filter"),v:true},{n:mstrmojo.desc(11953,"Highlight"),v:false}],onitemSelected:function(W){L.isFilter=W.v;this.isFilter=W.v;Q.csl.set("enabled",R>0&&this.isFilter);Q.forType.set("enabled",this.isFilter);},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-type-label",cssDisplay:"table-cell",text:mstrmojo.desc(11954,"data on selection"),visible:true},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-for-type",cssDisplay:"table-cell",alias:"forType",value:0,visible:false,selectedIndex:0,isHostedWithin:true,enabled:false,items:[{n:mstrmojo.desc(11955,"for #").replace("#",(I[0]||{}).n),v:false},{n:mstrmojo.desc(11956,"for All Data"),v:true}],onitemSelected:function(W){L.forAllData=W.v;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);}},{scriptClass:"mstrmojo.CheckBox",cssClass:"mstrmojo-clear-check",alias:"csl",checked:(K?K.showall:true),cssDisplay:"block",label:mstrmojo.desc(11957,"Allow users to clear all selections"),enabled:false,oncheckedChange:function(){L.clearAll=this.checked;}}],O=T.parent.children,P,S={},R=0,U=function(Y){var X=O[Y],Z,a,W;if(H){Z=mstrmojo.array.find(H,"k",X.k)!==-1;}else{if(I.length>0){if(I[0]&&I[0].sc&&I[0].sc.tks){Z=I[0].sc.tks.indexOf(X.k)>-1;}}}R+=Z?1:0;if(X!==T&&N(X.defn)){a=X.boxContent.getFilterType();W=X.boxContent.model.getSelectorControlMapInfo();S[X.k]={c:false,v:Z,ft:a,cgbs:W};V[1].children.unshift({scriptClass:"mstrmojo.CheckBox",cssDisplay:"block",label:X.title,checked:Z,oncheckedChange:function(){S[X.k]={c:true,v:this.checked,ft:a,cgbs:W};L.targetKeys=S;R+=this.checked?1:-1;Q.forType.set("enabled",R>0&&Q.filterType.isFilter);Q.filterType.set("enabled",R>0);Q.csl.set("enabled",R>0&&Q.filterType.isFilter);}});}};for(P=O.length-1;P>=0;P--){U(P);}this.addChildren(V);this.targetKeys=S;};mstrmojo.vi.ui.editors.VisAsFilterDialog=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.VisAsFilterDialog",title:mstrmojo.desc(12136,"Filtering options"),cssClass:"mstrmojo-vis-as-filter",btnAlignment:"right",vis:null,buttons:null,modal:true,visible:false,help:"filtering_options_dialog_box_html5.htm",onOpen:function C(){this.VisContainer.onOpen();},postBuildRendering:function A(){this._super();L={};},toggleFields:function J(){if(I.length!==0){this.forType.set("visible",true);this.filterType.set("enabled",true);}if(H&&H.length>0){this.filterType.set("enabled",true);}if(K){this.csl.set("enabled",true);}},preBuildRendering:function M(){var Q=this,O=Q.id,P=Q.vis.boxContent.model,R=Q.vis;I=(P.getSelectorControlMapInfo?P.getSelectorControlMapInfo():[]);if(I.length>0){K=I[0].sc;F=I[0].did;E=true;}else{H=R.defn.an;K=R.boxContent.selectorControl||(R.boxContent.findSelectorControl&&R.boxContent.findSelectorControl());E=false;}this.set("buttons",[G(mstrmojo.desc(1442,"OK"),function(){if(!D.isEmpty(L)){L.targetKeys=Q.targetKeys;L.singleUnit=E;if(E){L.unitId=F;}L.sc=K;R.model.setVisAsFilter(R,L);}mstrmojo.all[O].destroy();},true),G(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.all[O].destroy();})]);B.call(this);this.toggleFields();this._super();}});mstrmojo.vi.ui.editors.VisAsFilterDialog.open=function(P){var O=mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.editors.VisAsFilterDialog",vis:P});O.open();};}());(function(){mstrmojo.requiresClsP("mstrmojo","Editor","Container","TextBoxWithLabel","EditableLabel","Label","Container","hash","array");mstrmojo.requiresCls("mstrmojo.vi.ui.GroupDEList","mstrmojo.vi.ui.editors.DerivedElementPanel","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox");mstrmojo.requiresDescs(118,221,1911,5348,6199,12091,12409,12410,12411,12412,13248,13249,13253,13916);var F=mstrmojo.desc,I=mstrmojo.css,B=mstrmojo.hash,J=mstrmojo.array.forEach,D;function C(){I.addClass(this.list.domNode,"mstrmojo-others-rules");}function H(L){if(L.search(/\\|"|\[|\]|\./)!==-1){mstrmojo.alert(F(13916,'Group and calculation names cannot contain the following characters: \\"[].'));return false;}return true;}mstrmojo.vi.ui.editors.DerivedElementsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.DerivedElementsEditor",cssClass:"mstrmojo-DerivedElementsEditor",title:F(13248,"Group Editor"),help:"element_group_editor.htm",browseConfig:null,init:function K(L){this._super(L);D=this.id;},onOpen:function E(){this.deList.updateScrollbars();},_set_model:function(N,L){var M=L.attName+F(13253,"(Group)");this.model=L;this.deList.set("items",L.items);this.set("title",F(13248,"Group Editor")+" - "+(L.isNew===true?M:L.n));this.children[0].editDEName.set("label",(L.isNew||L.fromDS)?F(12199,"Attribute Name:"):F(13249,"Display Name:"));this.children[0].editDEName.set("value",(L.isNew===true)?M:(L.dispName?L.dispName:L.n));this.children[0].editDEName.set("emptyText",(L.isNew===true)?M:(L.dispName?L.dispName:L.n));this.initExcludeList();this.toggleEdit(false,false);this.othersProp.showChildren.set("selectedIndex",L.isNew?0:L.othersDE.showChildren?0:1);return true;},initExcludeList:function(){var L=this.elementPanel.excludeList={};J(this.model.items,function(M){if(M.t===1){J(M.es,function(N){L[N.v]=true;});}});},editItem:function(M){var L=this;if(M){J(this.model.items,function(O,N){if(O.id===M){L.deList.set("selectedIndex",N);L.toggleEdit(true,false,O);return false;}});}else{this.toggleEdit(true,true);}},commitEdit:function(M,L){var N=this.newGroupNode.editDEName.text,O=H(N);if(O){if(L){this.model.addDE(N,M);}else{this.model.updateDE(this.deList.selectedIndex,this.newGroupNode.editDEName.text,M);}this.deList.refresh();}return O;},toggleEdit:function(R,M,Q){var N=1,O=this.model.items,P=mstrmojo.desc(5187,"Group"),S=this.elementPanel.selectedElems(),L=function(T){return T.n===P+" "+N;};this.othersProp.showChildren.set("enabled",!R);if(R===true){this.elementPanel.set("isNew",M);this.elementPanel.set("visible",true);S.set("items",M?[]:B.clone(Q.es));}else{this.elementPanel.set("visible",false);}if(M&&O){while(true){if(O.some(L)){N++;}else{break;}}}this.newGroupNode.toggleEdit(R,M?P+" "+N:Q&&Q.n);if(R){this.okBtn.set("enabled",false);}else{this.enableOkBtn();}},enableOkBtn:function(){this.okBtn.set("enabled",this.model.isDirty()&&this.deList.items&&this.deList.items.length>1);},children:[{scriptClass:"mstrmojo.Container",markupString:'<div  class="{@cssClass}"><div></div><div style="clear:both;"></div></div>',cssClass:"attrNameEdit",markupSlots:{editNode:function(){return this.domNode.firstChild;}},children:[{scriptClass:"mstrmojo.TextBoxWithLabel",slot:"editNode",alias:"editDEName",label:F(13249,"Display Name:"),value:"Attribute(group)",onblur:function(){var L=mstrmojo.all[D].model;if(this.value&&this.value.length>0&&this.value!==L.n){L.isNameChanged=true;if(L.isNew||L.fromDS){L.n=this.value;}else{L.dispName=this.value;}}}}]},{scriptClass:"mstrmojo.Widget",markupString:"<div class='elementsTitles'><div>"+F(5207,"Group Name")+"</div><div>"+F(12091,"Selected Elements")+"</div></div>"},{scriptClass:"mstrmojo.Container",alias:"newGroupNode",markupString:"<div class='mstrmojo-VIGroupDERow new {@cssClass}'><div><div class='group-column'><div class='draggable-icon'></div><div class='name' mstrAttach:click>"+mstrmojo.desc(12412,"Add a Group")+"</div><div></div></div></div><div style='clear:both;float:none;'></div></div></div>",markupSlots:{editNode:function(){return this.domNode.firstChild.firstChild.children[2];},newNode:function(){return this.domNode.firstChild.firstChild.children[1];}},children:[{scriptClass:"mstrmojo.EditableLabel",cssClass:"mstrmojo-new-DEName",visible:false,slot:"editNode",alias:"editDEName",onkeyup:function(L){mstrmojo.EditableLabel.prototype.onkeyup.call(this,L);if(this.isEditing){var M=this[this.editableSlot];if(this.text!==(M.innerText||M.textContent||"")){this.parent.parent.elementPanel.enableSaveBtn();}}}}],onclick:function(){mstrmojo.all[D].toggleEdit(true,true);},toggleEdit:function(M,L){this.editDEName.set("visible",M);this.editDEName.set("text",L);this.editDEName.set("isEditing",M);if(this.hasRendered){I.toggleClass(this.domNode,"isEdit",M);}else{this.set("cssClass",M?"isEdit":"");}}},{scriptClass:"mstrmojo.vi.ui.GroupDEList",alias:"deList",items:[]},{scriptClass:"mstrmojo.EditableLabel",cssClass:"mstrmojo-edit-DEName",isEditing:true,visible:false,alias:"renameDE",allowEmptyText:false,onTextEditComplete:function(L){this.set("visible",false);if(L){this.parent.deList.selectedItem.isDirty=true;this.parent.deList.selectedItem.n=this.text;this.parent.enableOkBtn();this.parent.deList.refresh();}}},{scriptClass:"mstrmojo.HBox",alias:"othersProp",cssClass:"othersProp",children:[{scriptClass:"mstrmojo.Label",text:F(12409,"Display all other elements as")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-others-rule",alias:"showChildren",selectedIndex:0,isHostedWithin:false,onPopupWidgetOpened:function G(){C.call(this);},onitemSelected:function A(M){var L=this.parent.parent;if(this.hasRendered){L.model.editOthers({showChildren:M.v});L.enableOkBtn();}},items:[{n:F(12410,"individual items"),v:true},{n:F(12411,"a consolidated group"),v:false}]}]},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-WebButton Derived-Elements-Editor-Button",text:F(221,"Cancel"),onclick:function(){mstrmojo.all[D].close();}},{scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"okBtn",cssClass:"mstrmojo-WebButton Derived-Elements-Editor-Button saveBtn",iconClass:"hot",text:F(118,"Save"),onclick:function(){this.parent.model.save();mstrmojo.all[D].close();}},{scriptClass:"mstrmojo.vi.ui.editors.DerivedElementPanel",alias:"elementPanel",visible:false}]});mstrmojo.vi.ui.editors.DerivedElementsEditor.validateElementName=H;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.hash","mstrmojo.ui.Checkbox");var I={DISABLED:-1,URL:0,LINK_MSTR:1},A=function(N,Z,Q,V,a){var b=function(c,e,d){if(d){return"<"+c+e+">"+d+"</"+c+">";}return"<"+c+e+"/>";},Y=function(d,c){return(d!==undefined?" "+c+'="'+d+'"':"");},T=V?1:undefined,U=2,X=(N===I.URL?(Z||"").replace(/\&/g,"&amp;"):undefined),P=0,R=(N===I.LINK_MSTR?Q.did:undefined),M=(N===I.LINK_MSTR?Q.t:undefined),O=(N===I.LINK_MSTR?Q.st:undefined),W=a||"",S=1;return b("hls",Y(T,"onw"),b("hl",Y(S,"idf")+Y(U,"aopam")+Y(W,"dtxt")+Y(X,"url")+Y(N,"lt")+Y(M,"ttp")+Y(R,"tid")+Y(O,"tstp")+Y(P,"so")));},L=0,C={},H=function H(O){if(O.linkType!==undefined){return O.linkType+1;}var M=O.node.data.tid&&1,N=O.url||"";return M!==undefined?++M:!!N?1:0;},F=function F(M){return(M.defn.dl&&M.defn.dl.items&&M.defn.dl.items[0]&&M.defn.dl.items[0].n)||M.tooltip||"";},D=false,K=false,E=function E(P){D=true;var R=[this.rwSelector,this.linkText,this.tooltip,this.openNewWin],O=[this.linkText,this.tooltip],S=[this.rwSelector,this.tooltip,this.openNewWin],Q=function Q(T){if(T){T.set("visible",false);}},N=function N(T){if(T){T.set("visible",true);}},M=P===I.URL?O:P===I.LINK_MSTR?S:[];R.forEach(Q);M.forEach(N);if(this.hasRendered){this.tooltip.text.set("value","");}D=false;},B=function B(M){return !!M&&(M.toLowerCase().indexOf("javascript:")===-1);},G=function G(U){if(this.hasRendered&&!D){var Q=this,W=Q.docModel,X=mstrmojo.all[this.hostId],S=this.linkType.getSelectedItem().v,P=S===I.URL?true:this.openNewWin&&this.openNewWin.check.checked,b=this.tooltip.text.value,T=S!==I.URL?undefined:Q.linkText.value,O,a,M,Z,V=function(){if(X&&X.model.getSelectedViUnit().k===X.parent.k&&X.parent.id){X.model.selectVIUnit(X.parent.id,true);}},R=function(c){K=true;X.defn.dl=c.dl;X.target=c.target;X.url=c.url;X.tooltip=c.tooltip;X.linkType=c.linkTypeIndex-1;X.node.data.tnm=c.linkObjInfo.n;X.node.data.tid=c.linkObjInfo.did;X.node.data.ttp=c.linkObjInfo.t;X.node.data.tstp=c.linkObjInfo.st;Q.linkType.set("selectedIndex",c.linkTypeIndex);Q.rwSelector.text.set("value",c.linkObjInfo.n||"");Q.linkText.set("value",c.url||"");Q.tooltip.text.set("value",c.tooltip);if(Q.openNewWin){Q.openNewWin.check.set("checked",c.target==="_blank");}K=false;V();},N=function N(){if(!K){if(S===I.DISABLED){O="";Z=true;}else{if(T||C||P!==undefined){O=A(S,T,C,P,b);}}a={dl:mstrmojo.hash.clone(X.defn.dl),target:X.target,url:X.url,tooltip:X.tooltip,linkTypeIndex:H(X),linkObjInfo:{n:X.node.data.tnm,did:X.node.data.tid,t:X.node.data.ttp,st:X.node.data.tstp}};if(b!==undefined||Z!==undefined){X.tooltip=Z?"":b;if(X.defn.dl){X.parent.defn.dl.items[0].n=Z?"":b;}}W.editLink(X.parent,Q.hostType,O,{success:function(c){X.linkType=S;W.partialUpdate(c.data,W.getTargetDefn(X.k),c.defn);if(S===I.LINK_MSTR){Q.rwSelector.text.set("value",C.n);Q.linkText.set("value","");}if(S===I.URL){Q.linkText.set("value",T);Q.rwSelector.text.set("value","");}if(S===I.DISABLED){delete X.defn.dl;delete X.node.data.dl;delete X.target;delete X.url;Q.linkText.set("value","");Q.rwSelector.text.set("value","");}else{X.target=P?"_blank":"";Q.tooltip.text.set("value",b);if(Q.openNewWin&&Q.openNewWin.visible){Q.openNewWin.check.set("checked",P);}}M={dl:mstrmojo.hash.clone(X.defn.dl),target:X.target,url:X.url,tooltip:X.tooltip,linkTypeIndex:Q.linkType.selectedIndex,linkObjInfo:{n:X.node.data.tnm,did:X.node.data.tid,t:X.node.data.ttp,st:X.node.data.tstp}};V();},undo:function(){R(a);},redo:function(){R(M);}});}},Y=function(){return(S===I.URL&&(!mstrmojo.string.isEmpty(T)&&T!=="http://"))||(S===I.LINK_MSTR&&!mstrmojo.hash.isEmpty(C));};if((U!=="type"&&Y())||S===I.DISABLED){N();}}};mstrmojo.ui.editors.controls.LinkGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.LinkGroup",init:function J(Q){this._super(Q);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditContainer");var M=[],S=this,R=mstrmojo.all[this.hostId],O=R.url||"",P=function P(){return R.node.data.tnm;};L=H(R);if(L===2){C={n:R.node.data.tnm,did:R.node.data.tid,t:R.node.data.ttp,st:R.node.data.tstp};}M.push(new mstrmojo.Label({cssClass:"edt-title",text:mstrmojo.desc(12064,"Link")}),new mstrmojo.ui.Pulldown({alias:"linkType",items:[{n:mstrmojo.desc(12065,"Disabled"),v:I.DISABLED},{n:mstrmojo.desc(12066,"Navigate to URL"),v:I.URL}].concat(mstrApp.isSingleTier?[]:[{n:mstrmojo.desc(13638,"Run this report or dashboard"),v:I.LINK_MSTR}]),selectedIndex:L,onitemSelected:function(U){E.call(S,U.v);G.call(S,"type",U.v);L=this.items.indexOf(U);}}),new mstrmojo.ui.editors.controls.TwoColumnContainer({alias:"rwSelector",col1Width:"100%",col2Width:"30px",children:[new mstrmojo.TextBox({slot:"col1Node",alias:"text",readOnly:true,tooltip:P(),value:P()}),mstrmojo.Button.newWebButton("...",null,false,{slot:"col2Node",alias:"button",cssText:"height: 20px;min-width: 30px",onclick:function N(){mstrmojo.vi.ui.DatasetUnitMenuUtils.showObjectPicker(function U(V){S.rwSelector.text.set("value",V.n);C=V;G.call(S,"obj",V);},[55,3])();}})]}),new mstrmojo.TextBox({alias:"linkText",valueChangeDelay:3000,hint:"http://",value:O||"http://",onkeydown:function(U){if(U.e.keyCode===13){this.blur();}},onvalueChange:function T(){if(this.hasRendered){if(B(this.value)){this.cleanUp();G.call(S,"link",this.value);}else{this.setInvalidState(mstrmojo.desc(12068,"Invalid URL"));}}}}),new mstrmojo.ui.editors.controls.TwoColumnContainer({alias:"tooltip",col1Width:"30%",col2Width:"70%",children:[new mstrmojo.Label({alias:"label",slot:"col1Node",text:mstrmojo.desc(12069,"Tooltip:")}),new mstrmojo.TextBox({alias:"text",slot:"col2Node",valueChangeDelay:3000,value:F(R),hint:mstrmojo.desc(12070,"Hyperlink#").replace("#",""),onkeydown:function(U){if(U.e.keyCode===13){this.blur();}},onvalueChange:function T(){G.call(S,"tooltip",this.value);}})]}));if(!mstrApp.isSingleTier){M.push(new mstrmojo.ui.editors.controls.TwoColumnContainer({alias:"openNewWin",col1Width:"20px",col2Width:"100%",children:[new mstrmojo.ui.Checkbox({alias:"check",slot:"col1Node",checked:R.target==="_blank",oncheckedChange:function(){G.call(S,"newWin",this.checked);}}),new mstrmojo.Label({alias:"label",slot:"col2Node",text:mstrmojo.desc(3593,"Open in new window")})]}));}this.addChildren(M);E.call(this,R.linkType||this.linkType.items[this.linkType.selectedIndex].v);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Obj","mstrmojo.ui.ButtonBar","mstrmojo.ui.Checkbox","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ThreeColumnContainer");var D=mstrmojo.hash;mstrmojo.vi.models.editors.ControlsViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.editors.ControlsViewFactory",getEditorGroup:function B(H,I){return new mstrmojo.vi.ui.editors.EditorGroup(D.copy(I,{children:H}));},getLabelAndControl:function G(J,K,M,O,L,N){var P=new mstrmojo.Label({text:J,setDimensions:function(S,Q){var R=this.domNode;if(R){R.style.width=Q;}}}),I=P,H=K;if(L){I=K;H=P;}I.slot="col1Node";H.slot="col2Node";return new mstrmojo.ui.editors.controls.TwoColumnContainer(D.copy(N,{col1Width:M||"40%",col2Width:O||"60%",children:[I,H],getLabel:function(){return P;},getCtrl:function(){return this.children.filter(function(Q){return Q!==P;})[0];}}));},getLabelAndControlWithMsg:function C(L,M,P,O,S,H,N,Q){var R=new mstrmojo.Label({text:L,setDimensions:function(W,U){var V=this.domNode;if(V){V.style.width=U;}}}),T=new mstrmojo.Label({text:P?mstrmojo.desc(14548,"Changes will be applied after Desktop is restarted."):"",setDimensions:function(W,U){var V=this.domNode;if(V){V.style.width=U;}},setText:function(U){this.text=U;}}),K=R,J=M,I=T;if(N){K=M;J=R;}K.slot="col1Node";J.slot="col2Node";I.slot="col3Node";return new mstrmojo.ui.editors.controls.ThreeColumnContainer(D.copy(Q,{col1Width:O||"30%",col2Width:S||"30%",col3Width:H||"40%",children:[K,J,I],getLabel:function(){return R;},getCtrl:function(){return this.children.filter(function(U){return U!==R;})[0];},getMessage:function(){return T;}}));},getPulldown:function F(I,L,H,K,J){return mstrmojo.ui.Pulldown.newPulldown(I,function(M,N){L.call(this,M.v,N&&N.v);},H,K,J);},getCheckboxAndLabel:function A(N,L,K){var J=new mstrmojo.ui.Checkbox({checked:N,oncheckedChange:function(){var O=this.checked;K.call(this,O,!O);}});var M=this.getLabelAndControl(L,J,"14px","100%",true);M.cssClass="checkLabel";var I=M.getLabel();I.onclick=function H(){J.onclick();};I.cssDisplay="inline-block";return M;},getButtonBar:function E(J,H,L,K){K=K||{};K.items=J;var I=new mstrmojo.ui.ButtonBar(K);I.singleSelect(H);I.postselectionChange=function(M){var N=this.items,O=N[M.removed&&M.removed[0]];L.call(this,N[M.added[0]],O);};return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo._HasEditableText","mstrmojo.ui.Pulldown");var H=mstrmojo.array,C=mstrmojo.hash,B=19,J=13,D=27;mstrmojo.ui.SearchablePulldown=mstrmojo.declare(mstrmojo.ui.Pulldown,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.ui.SearchablePulldown",editableSlot:"selectedNode",allowCustomText:false,isSearching:false,editOnClick:false,init:function K(P){this._super(P);var M=this.getPopupList();M.renderOnScroll=this.renderOnScroll||M.renderOnScroll;M.renderBlockSize=this.renderBlockSize||M.renderBlockSize;mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-SearchablePulldown");var O=M.constructor.prototype,N=M.getItemProps?M.getItemProps:O.getItemProps,Q=M.getItemMarkup?M.getItemMarkup:O.getItemMarkup;M.getItemProps=function(V,R){var S=this._spft||"",W=V.n,T=W.toUpperCase().indexOf(S);if(T===-1){S="";}var U=N.call(this,V,R);U.before=W.slice(0,T);U.input=W.substring(T,T+S.length);U.after=W.slice(T+S.length,W.length);return U;};M.getItemMarkup=function(S,R){return Q.call(this,S,R).replace("{@en@n}","{@en@before}<span class='sp-highlight'>{@en@input}</span>{@en@after}");};},onclick:function L(M){var P=this.selectedNode,Q=M.getTarget(),R=M.e.offsetX>=(P.offsetWidth-B),O=this.getPopupWidget(),N=O.visible;if(Q===P&&(!N||(N&&R))){this.set("isEditing",!N);this._super(M);}},onPopupWidgetClosed:function F(){this.set("isEditing",false);var P=this.getPopupList(),Q=P._oldItems,N=this.text;delete P._oldItems;if(Q){var M=H.find(Q,"n",N);if(M===-1&&!this.allowCustomText){var O=P.items[0]||Q[0];M=H.find(Q,"n",O.n);}P.set("items",Q);this.set("selectedIndex",M);}},_set_selectedIndex:function E(O,M){if(this.allowCustomText&&M===-1){this.selectedIndex=-1;this.onitemSelected(null,M);}else{this.isSearching=false;this._super(O,M);if(this.hasRendered){var N=this.selectedNode;this.text=N.innerText?N.innerText:N.textContent;}}return true;},onkeydown:function G(N){this._super(N);var M=window.event||N.e;if(M.keyCode===J){this.getPopupList().close();}},onkeyup:function A(O){this._super(O);var M=window.event||O.e,P=M.keyCode,N=this.getPopupList();if(P===D||P===J){N.close();}else{this.processSearch();}},processSearch:function I(){this.isSearching=true;this.hideTooltip();var M=[],O=this.getPopupList(),P=this.selectedNode.innerHTML,Q=O._oldItems||O.items,N=P.toUpperCase();N=N.replace(/<BR>/,"");if(N.length>0){H.forEach(Q,function(R){if(R.n.toUpperCase().indexOf(N)>-1){M.push(C.clone(R));}},this);}else{M=Q;}O._spft=N;if(this.customizeSearchResult){this.customizeSearchResult(M);}O.set("items",M);O.adjustCornersForPopupOverflow();delete O._spft;O._oldItems=Q;O.set("visible",M.length!==0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ui.Pulldown");var B={DATA_SOURCES:0,CATALOGS:1,CUBES:2};function D(F,G){return mstrmojo.array.map(F,function(H){H.lv=G;return H;});}mstrmojo.mstr.MDXCubeBrowser=mstrmojo.declare(mstrmojo.Editor,null,{title:mstrmojo.desc(4380,"Select MDX Cube"),help:"Select_MDX_Cube_dialog_box.htm",items:null,selectedItem:null,loadMDXData:function(G){G=G||{};var F=G.item||{};mstrmojo.xhr.request("GET",mstrConfig.taskURL,{success:function(H){G.success(H);},failure:function(H){mstrmojo.alert(H);}},{taskId:"browseMDX",level:F.lv||B.DATA_SOURCES,unitId:F.did||"",roleId:F.roleId||""});},init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-MDXCubeBrowser");},children:[{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-MDXCubeBrowser-sources",alias:"mdxPulldown",selectedIndex:0,makeObservable:true,items:[{n:mstrmojo.desc(4381,"Data Sources"),did:"",lv:B.DATA_SOURCES}],getPopupListConfig:function(){var G=this;var F=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();F.postclick=function(){G.handleSelection();};return F;},handleSelection:function(){var H=this,F=H.parent;H.set("items",this.items.slice(0,this.selectedIndex+1));H.set("selectedIndex",this.items.length-1);var G=this.selectedItem||this.items[this.selectedIndex];F.set("items",G.items);F.set("selectedItem",null);},addItem:function(F){F.cls="lv-"+F.lv;this.set("items",this.items.concat(F));this.set("selectedIndex",this.items.length-1);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up mstrmojo-MDXCubeBrowser-sources-btn",bindings:{enabled:function(){return this.parent.mdxPulldown.selectedIndex>0;}},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);},onclick:function(){var F=this.parent.mdxPulldown;F.set("selectedIndex",F.selectedIndex-1);F.handleSelection();}},{scriptClass:"mstrmojo.ui.List",cssClass:"mstrmojo-MDXCubeBrowser-cubes",alias:"cubeList",bindings:{items:function(){return this.setCssClass(this.parent.items);}},setCssClass:function(F){var G=this;return mstrmojo.array.map(F,function(H){H.cls=G.getItemCssClass(H);return H;});},selectionAdded:function(F){if(!F.isReselect){var J=this,H=J.parent,I=J.items[F.added];if(I.lv===B.CUBES+1){H.set("selectedItem",I);return ;}var G=this.parent.mdxPulldown;H.loadMDXData({item:I,success:function(L){var K=L.items;if(I.lv==B.CATALOGS){mstrmojo.array.map(K,function(M){M.roleId=I.did;return M;});}H.set("items",D(K,I.lv+1));I.items=K;G.addItem(I);}});}},getItemMarkup:function C(G,F){return'<{@tag} class="item" idx="{@idx}" style="{@style}" title="{@title}"><span class="{@cls}"></span>{@en@n}</{@tag}>';},getItemCssClass:function(F){return"mstrIcon-lv mstrIcon-lv-"+{"1048583":"fDataSource","1048584":"fCatalog","1048585":"qc"}[F.dt];}},{scriptClass:"mstrmojo.Label",bindings:{text:function(){return mstrmojo.desc(2107,"## items found").replace("##",(this.parent.items&&this.parent.items.length)||0);}}},{scriptClass:"mstrmojo.HBox",alias:"btnHBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[mstrmojo.Button.newWebButton(mstrmojo.desc(547,"Select"),function A(){var F=this.parent.parent;F.close();F.onOK(F.selectedItem);},true,{bindings:{enabled:function(){return this.parent.parent.selectedItem.lv===3;}}}),mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function A(){this.parent.parent.close();})]}],postBuildRendering:function(){var G=this;this._super();var F=this.mdxPulldown;this.loadMDXData({success:function(H){G.set("items",D(H.items,B.CATALOGS));F.items[0].items=G.items;}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.array","mstrmojo.threshold.ThresholdModel");var G=mstrmojo.array;var I=[{n:mstrmojo.desc(5999,"Replace Text"),v:3},{n:mstrmojo.desc(6000,"Quick Symbol"),v:10},{n:mstrmojo.desc(11898,"Replace With Image"),v:4}];var F=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL;function B(N,O,M){this.parent.raiseFormatValueChange(N,O,M);}function E(O){var N=this.parent.model,M=N.threshold;this.replaceType.set("enabled",O);this.replaceText.set("enabled",O);this.replaceSymbol.set("enabled",O);if(!O){delete M[N.getReplaceTypeName()];delete M[N.getReplaceTextName()];}}mstrmojo.threshold.TextGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.threshold.TextGroup",nameRow:undefined,replaceRow:undefined,replaceType:undefined,replaceText:undefined,replaceSymbol:undefined,preBuildRendering:function K(){this._sync=true;if(this._super){this._super();}},postBuildRendering:function A(){if(this._super){this._super();}this._sync=false;},children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"replaceRow",col1Width:"10%",col2Width:"90%",replaceChk:undefined,children:[{scriptClass:"mstrmojo.ui.Checkbox",slot:"col1Node",alias:"replaceChk",oncheckedChange:function D(){E.call(this.parent.parent,this.checked);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:mstrmojo.desc(11888,"Enable Data Replace")}]},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceType",selectedIndex:0,enabled:false,items:I,onenabledChange:function H(){if(this.enabled){B.call(this,"rtp",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(O){var S=O.value,P=O.valueWas,N=this.parent,M=N.replaceText,R=N.replaceSymbol;if(S!==P){var Q=S===1;M.set("visible",!Q);M.set("hint",S===2?mstrmojo.desc(11889,"Image URL"):"");R.set("visible",Q);B.call(this,"rtp",this.items[S].v);}}},{scriptClass:"mstrmojo.TextBox",alias:"replaceText",enabled:false,onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.value);}},onvalueChange:function J(){B.call(this,"rtxt",this.value);var M=this.parent,N=M.replaceType;if(!M.parent.model.threshold.rtp){B.call(this,"rtp",N.items[N.selectedIndex]);}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceSymbol",selectedIndex:0,isHostedWithin:false,enabled:false,visible:false,items:F,getPopupListConfig:function C(){var M=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();M.getItemMarkup=function N(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@n}</{@tag}>';};return M;},onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(M){var O=M.value,N=M.valueWas;if(O!==N){B.call(this,"rtxt",this.items[O].v);}}}],setFormatSource:function L(M){var N=this,O=N.parent.model;this.syncControls(function(){var P=M[O.getReplaceTextName()],S=M[O.getReplaceTypeName()];N.replaceRow.replaceChk.set("checked",!!P);var Q=G.find(I,"v",S);N.replaceType.set("selectedIndex",Q===-1?0:Q);if(S!==10){N.replaceText.set("value",P||"");N.replaceSymbol.set("selectedIndex",0);}else{var R=Math.max(G.find(F,"v",P),0);N.replaceSymbol.set("selectedIndex",R);N.replaceText.set("value","");}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.util.ui.ColorPicker","mstrmojo.ui.editors.controls.ColorList","mstrmojo.ui.editors.controls.ColorWheel","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.TextBoxWithLabel","mstrmojo.ui.ButtonBar","mstrmojo.Button","mstrmojo.css");var G=1,Q=2,X=mstrmojo.css,L=mstrmojo.array,I=mstrmojo.util.ui.ColorPicker,B=G,V=0,E=1,K=2,H="txtColor",U="automatic";var D=[{n:mstrmojo.desc(12071,"Color fill"),id:V},{n:mstrmojo.desc(12072,"No fill"),id:E},{n:mstrmojo.desc(12073,"Gradient"),id:K}];function F(){return this.color!==U?this.color:this.autoPreviewColor;}function b(e,d,c){return mstrmojo.Button.newWebButton(e,c,d,{slot:"buttonNode",cssDisplay:"inline-block"});}function M(c){return{scriptClass:"mstrmojo.ui.editors.controls.ColorList",items:c,postselectionChange:function(d){var g=d.added;if(g){var f=this.parent,e=this.items[g[0]].id;f.set("color",e);f.colorChanged(e);}}};}function a(c){return"#"+c.replace("#","");}function N(){var c=this.txtColor1,f=this.txtColor2,d=this.color,e=false,g=this.colorStyle;switch(g.items[g.selectedIndex].id){case V:d=a(c.value);break;case E:d="transparent";break;case K:d={or:this.gradientOrientation.getSelectedItems()[0].id,c1:a(c.value),c2:a(f.value)};e=true;break;}X.toggleClass(this.containerNode,"grad",e);this.set("color",d);}function J(c){this.set("activeColor",c);var d=this[c];L.forEach([1,2],function(f){var e=this[H+f];X.toggleClass(e.domNode,"on",e===d);},this);this.colorWheel.set("color",a(d.value));}function O(c,d,e,f){if(typeof e==="string"){if(e==="transparent"){e="#ffffff";}}else{if(e.c1){e=e["c"+c];}}return{scriptClass:"mstrmojo.TextBoxWithLabel",alias:H+c,cssDisplay:"block",label:d,autoCorrect:false,maxLength:6,size:6,value:e.replace("#",""),bindings:f,onfocus:function(){J.call(this.parent,this.alias);},onvalueChange:function(g){if(!/^[0-9a-fA-F]{0,6}$/.test(g.value)){this.value=g.valueWas;}else{if(this.value.length===6){var h=this.parent;h.colorWheel.set("color",a(this.value));N.call(h);}}}};}function S(){var c=F.call(this),g="this.parent.colorStyle.items[ this.parent.colorStyle.selectedIndex ].id",k=g+" === "+K,f=g+" !== "+E,d=(this.showNoFill&&c==="transparent")?1:0,e=D.slice(0,this.showGradient?3:2),h=0;if(!this.showNoFill){e.splice(1,1);}if(c.c1){d=L.find(e,"id",K);h=c.or?0:1;}this.addChildren([{scriptClass:"mstrmojo.ui.Pulldown",alias:"colorStyle",selectedIndex:d,items:e,onitemSelected:function(){N.call(this.parent);}},{scriptClass:"mstrmojo.ui.ButtonBar",alias:"gradientOrientation",items:[{n:mstrmojo.desc(2066,"Horizontal"),id:1,css:"h"},{n:mstrmojo.desc(2069,"Vertical"),id:0,css:"v"}],selectedIndex:h,bindings:{visible:k},postselectionChange:function(l){if(l.added){N.call(this.parent);}}},{scriptClass:"mstrmojo.Button",cssClass:"simpleButton",text:mstrmojo.desc(11658,"Swap"),bindings:{visible:k},onclick:function(){var n=this.parent,m=n.txtColor1,o=n.txtColor2,l=m.value;m.set("value",o.value);o.set("value",l);N.call(n);}},O(1,mstrmojo.desc(12074,"Color HEX:"),c,{visible:f,label:g+" === "+K+' ? "'+mstrmojo.desc(12075,"Color 1 HEX:")+'" : "'+mstrmojo.desc(12074,"Color HEX:")+'";'}),O(2,mstrmojo.desc(12076,"Color 2 HEX:"),c,{visible:k}),{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",alias:"colorWheel",color:c.c1||c,onColorPicked:function(l){var m=this.parent;m[m.activeColor].set("value",l.replace("#",""));},bindings:{visible:f}},b(mstrmojo.desc(1442,"Ok"),true,function(){var m=this.parent,l=m.color;if(!l.c1){I.addCustomColor(l);}m.colorChanged(l);}),b(mstrmojo.desc(2140,"Cancel"),false,function(){this.parent.colorCanceled();})]);J.call(this,H+"1");}function T(){var d=F.call(this),c=this.sampleNode.style;if(d){if(d.c1){var e=X.buildGradient(d.or,d.c1,d.c2);c[X.convertCssToCamelCase(e.n)]=e.v;}else{c.background=d;}}}mstrmojo.ui.editors.controls.AdvancedColorPicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPicker",markupString:'<div id="{@id}" class="mstrmojo-ui-AdvColorPicker {@cssClass}" style="{@cssText}" mstrAttach:click><div class="acpToolbar"><div class="acpBtn acpSwatchBtn"></div><div class="acpBtn acpPaletteBtn"></div><div class="acpColor"></div></div><div class="acpContent" ></div><div class="acpButtons" ></div></div>',markupSlots:{swatchBtnNode:function(){return this.domNode.firstChild.firstChild;},paletteBtnNode:function(){return this.domNode.firstChild.childNodes[1];},sampleNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.nextSibling;},buttonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onpickerModeChange:function P(){B=this.pickerMode;this.renderContent();},oncolorChange:function A(){T.call(this);},onautoPreviewColorChange:function C(){T.call(this);}},color:"#000fff",showGradient:true,showNoFill:true,showAutomatic:false,autoPreviewColor:null,activeColor:H+"1",swatchBtnNode:null,paletteBtnNode:null,colorStyle:null,gradientOrientation:null,txtColor1:null,txtColor2:null,colorWheel:null,pickerMode:G,init:function R(c){this._super(c);this.pickerMode=B;},renderContent:function W(){this.showPickerForCurrentMode();},showPickerForCurrentMode:function Y(){var e=this;this.removeChildren();var f=B===G;if(f){var d=I.getBasicColors();if(!this.showNoFill){d.shift();}if(this.showAutomatic&&this.color!==U){this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4531,"Automatic"),cssClass:"AutomaticOption",onclick:function c(){e.set("color",U);e.colorChanged(U);}}]);}this.addChildren([mstrmojo.hash.copy({alias:"basicColors"},M(d)),M((mstrApp&&mstrApp.getPreferredColors)?L.map(mstrApp.getPreferredColors(),function(g){return{n:g,id:g};}):[]),M(I.getCustomColors())]);}else{S.call(this);}X.toggleClass(this.swatchBtnNode,"on",f);X.toggleClass(this.paletteBtnNode,"on",!f);this.buttonNode.style.display=f?"none":"block";},colorChanged:mstrmojo.emptyFn,colorCanceled:mstrmojo.emptyFn,onclick:function Z(c){var d=c.getTarget(),e=this.pickerMode;if(d===this.swatchBtnNode){e=G;this.set("pickerMode",e);}else{if(d===this.paletteBtnNode){e=Q;this.set("pickerMode",e);}}}});mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC=U;}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.num","mstrmojo.dom","mstrmojo.string","mstrmojo.expr","mstrmojo.ui.Pulldown","mstrmojo.MetricSelectorUtility","mstrmojo.hash");var U=mstrmojo.MetricSelectorUtility,R=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition,D=U.OP,A=U.EnumNumberCategory,b=mstrmojo.num,a=mstrmojo.dom,Q=mstrmojo.string,Y=mstrmojo.expr,c=Y.DTP,T=mstrmojo.hash,f=U.OP_NAMES.slice(0),S=U.RANK_OP_NAMES.slice(0),N=function(){var h=function(l){return l===undefined||l===null;},k;for(k=0;k<arguments.length;k++){if(h(arguments[k])){return false;}}return true;},Z=function(h){return h===U.Q._G;},B=function(h){return h===U.Q._PT||h===U.Q._PB;},I=function(k,h){return !(Z(k)&&(h===D._IS_NULL||h===D._IS_NOT_NULL));},E=function(k,h){return Z(k)&&(h===D._BETWEEN||h===D._NOT_BETWEEN);},W=function(h){return !h.visible||Q.isEmpty(h.value);},e=function(k,h){return((k===A.Date||k===A.Time)&&h===U.Q._G)?c.DATE:c.REAL;},K=function(k,h){return h+((k&&!Q.isEmpty(h)&&!String(h).match(/^\d+%$/))?"%":"");},O=function(h){return Z(h)?D._GREATER_EQUAL:D._LESS_EQUAL;},H=function(k,r,o,h,n){var q=[],p=e(k,r),t=B(r);if(o===D._IN||o===D._NOT_IN){var l=String(h).split(";"),m;for(m=0;m<l.length;m++){if(!mstrmojo.string.isEmpty(l[m])){q.push({dtp:p,v:K(t,l[m])});}}}else{if(h!==null){q.push({dtp:p,v:K(t,h)});}if(n!==null){q.push({dtp:p,v:K(t,n)});}}return q;},M=function(h){this.parent.submit(this,true);},d=function(h){var k=this.parent;if(k.valueChanged||this.value===""){k.submit(this);}},L=function(){this.set("value","");},g=function(){var h=this.parent;h.docSelector.hideWarning();h.valueChanged=true;};mstrmojo.vi.ui.rw.selectors.MetricQualification=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.vi.ui.rw.selectors.MetricQualification",markupString:'<div id="{@id}" class="mstrmojo-vi-metric-qual {@cssClass}" style="{@cssText}"><div class="pulldown"></div><div class="v1"></div><div class="v2"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},leftTextNode:function(){return this.domNode.childNodes[1];},rightTextNode:function(){return this.domNode.childNodes[2];}},children:[{scriptClass:"mstrmojo.ui.Pulldown",alias:"func",isHostedWithin:false,items:f,isSilentSelected:false,onitemSelected:function(){var o=this.parent,l=o.qua,h=o.opId,p=o.leftText,m=o.rightText,n=o.func.getSelectedItem().v,k=h;if(this.isSilentSelected){return ;}h=o.opId=Z(l)?n:D._LESS_EQUAL;p.set("visible",I(l,h));m.set("visible",E(l,h));if(p.hasRendered&&p.visible){a.setInputSelection(p.inputNode);}if(Z(l)){if(k!==h){o.opChanged=true;}this.parent.submit();}else{o.set("qua",n);}}},{scriptClass:"mstrmojo.TextBox",alias:"leftText",slot:"leftTextNode",onEnter:d,onblur:M,onfocus:d,onvisibleChange:L,onvalueChange:g},{scriptClass:"mstrmojo.TextBox",alias:"rightText",slot:"rightTextNode",onEnter:d,onblur:M,onfocus:d,onvisibleChange:L,onvalueChange:g}],parseModel:function G(){var u=this.qua,t=this.cs,z=this.da,r=this.f,q=this.ft,l=Z(u),v=l?f:S,w=N(r,q)?U.getOpIdxByfunc(r,q):O(u),m,n;this.opId=w;if(z){var h,p;switch(u){case U.Q._G:h=Number(z.low).toFixed(0);p=Number(z.high).toFixed(0);break;case U.Q._RB:case U.Q._RT:h=1;p=z.cnt;break;case U.Q._PB:case U.Q._PT:h=0;p=100;break;}this.set("low",h);this.set("high",p);}m=(t&&t.length>0)?b.toLocaleString(t[0].v):"";if(w===D._IN||w===D._NOT_IN){for(n=1;n<t.length;n++){m+=";"+b.toLocaleString(String(t[n].v));}}else{this.set("cs2",(t&&t.length>1)?b.toLocaleString(t[1].v):"");}if(t&&t.length>0&&B(u)&&!m.match("%")){m=b.toLocaleString(t[0].v*100);}this.set("cs1",m);var x=this.leftText,o=this.rightText,k=this.func;x.set("visible",I(u,w));x.set("value",this.cs1);o.set("visible",E(u,w));o.set("value",this.cs2);k.set("items",v);k.isSilentSelected=true;k.selectItemByField("v",l?w:u);k.isSilentSelected=false;this.valueChanged=false;},onquaChange:function X(k){var m=k.valueWas,n=k.value,o=U.getFuncInfo(this.opId,m).ft,l=U.getFuncInfo(this.opId,n).ft;this.opId=O(n);this.changeQual=true;if(l!==o){var h=U.getFuncInfo(this.opId,n);this.cs=[];this.f=h.f;this.ft=h.ft;this.parseModel();}else{this.submit();}},validateValues:function V(q){var r=this.leftText,m=this.rightText,o=this.qua,p=this.opId,l;if(p===D._IS_NULL||p===D._IS_NOT_NULL){this.docSelector.hideWarning();return null;}if(p===D._IN||p===D._NOT_IN){var k=String(r.value).split(";"),n;for(n=0;n<k.length;n++){l=U.doValidation(k[n],this,{refNode:r.inputNode,position:R.TOP,closeOnClick:false});if(l.invalid){return l;}}}else{q=q||r;l=U.doValidation(q.value,this,{refNode:q.inputNode,position:R.TOP,closeOnClick:false});if(!l.invalid&&E(o,p)){var h=(q===r)?m:r;l=U.doValidation(h.value,this,{refNode:h.inputNode,position:R.TOP,closeOnClick:false});}return l.invalid?l:null;}return null;},submit:function P(t,k){var u=this.validation&&this.validation.errorCode,h=this.validateValues(t),m=t?t.parent.parent.warning:null,l=m?m.visible:null,r=this.valueChanged||this.value==="";if(!h||!h.invalid){if(r||this.changeQual||!!this.opChanged){var q=this.qua,p=this.opId,o=this.cs1=I(q,p)?this.leftText.value:null,n=this.cs2=E(q,p)?this.rightText.value:null;this.cs=H(this.numFmts.cat,q,p,o,n);this.parent.node.data.cs=this.cs;this.changeQual=true;this.onchange();this.valueChanged=false;this.opChanged=false;this.changeQual=false;}}else{if(t){if(l&&k&&h.errorCode===u){this.set("validation",null);}else{this.set("validation",h);a.setInputSelection(h.refNode);}}}return !h;},updateData:function F(h,k){this.da=h;this.updateExpr(k);},updateExpr:function J(h){if(h){this.cs=h.cs;this.f=h.f;this.ft=h.ft;this.qua=h.qua;}this.parseModel();},doLayout:function C(){this.layoutConfig=this.layoutConfig?T.copy({xt:true},this.layoutConfig):{xt:true};if(this.parent.isInFilterPanel()){this.layoutConfig.w={containerNode:"65%",leftTextNode:"30%",rightTextNode:"30%"};}this._super();}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Box","Button","RadioList","Label","array");mstrmojo.requiresClsP("mstrmojo.ui","Pulldown");var G=mstrmojo.desc,Q=mstrmojo.css,J=mstrmojo.array;function O(){Q.addClass(this.list.domNode,"AdvancedSort-PopupList");this.parent.isActive(true);}mstrmojo.SortRow=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.SortRow",markupString:'<div id="{@id}" class="mstrmojo-SortRow {@cssClass}" style="{@cssText}" mstrAttach:click><div></div><div class="mstrmojo-sort-rule-delete"></div><div style="clear:both;"></div></div>',markupSlots:{containerNode:function N(){return this.domNode.firstChild;},deleteNode:function I(){return this.domNode.children[1];}},sortRule:undefined,sortOrder:undefined,rank:undefined,isActive:function K(T){this.parent.pulldownActive(T);},onclick:function R(T){if(T.getTarget()===this.deleteNode){this.parent.deleteSortRule(this);}},isAscending:function S(){return this.sortOrder.value===0;},getSortKey:function E(){return this.sortRule.value;},setPulldownOptions:function P(U){var T=this.sortRule;T.set("items",T.items.concat(U));},resetPulldownOptions:function D(){this.sortRule.set("selectedIndex",0);this.sortRule.set("items",[{v:"",n:" ",cls:"firstItem"}]);},setSelected:function L(W,U,V){var T=J.find(this.sortRule.items,"v",W);if(T===-1){if(!V){this.sortRule.set("selectedIndex",0);this.sortOrder.set("selectedIndex",0);return ;}else{this.sortRule.set("items",this.sortRule.items.concat([{v:W,n:V}]));T=J.find(this.sortRule.items,"v",W);}}this.sortRule.set("selectedIndex",T);this.sortOrder.set("selectedIndex",(U===0?1:0));},setRank:function B(T){this.rank.set("number",T);},getRank:function F(){return this.rank.number;},children:[{scriptClass:"mstrmojo.Widget",alias:"rank",number:0,markupString:'<div class="order-column"><div class="draggable-icon"></div><div class="order">{@number}</div></div>',markupMethods:{onnumberChange:function C(){this.domNode.children[1].innerText=this.number;this.refresh();}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"sortRule",cssClass:"mstrmojo-sort-rule-pulldown",selectedIndex:0,value:"",items:[{v:"",n:" ",cls:"firstItem"}],bindings:{enabled:"this.items && this.items.length > 1"},isHostedWithin:false,onPopupWidgetOpened:function M(){O.call(this);},onPopupWidgetClosed:function A(){this.parent.isActive(false);},onitemSelected:function H(T){this.value=T.v;this.parent.parent.itemSelected();}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"sortOrder",cssClass:"mstrmojo-sort-rule-order",value:0,selectedIndex:0,bindings:{enabled:"this.parent.sortRule.items && this.parent.sortRule.items.length > 1"},isHostedWithin:false,onPopupWidgetOpened:function M(){O.call(this);},onPopupWidgetClosed:function A(){this.parent.isActive(false);},onitemSelected:function H(T){this.value=T.v;},items:[{n:G(1885,"Ascending"),v:0},{n:G(1886,"Descending"),v:1}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Button","mstrmojo.ui.Pulldown","mstrmojo.ui.CheckList");var F=mstrmojo.hash,E=mstrmojo.Button.newWebButton;function C(G){var H=this.parent,I=this.list;if(G){H.set("selectedIndices",F.copy(I.selectedIndices));H.submitSelections();}else{I.selectedIndices=F.copy(H.selectedIndices);}this.close();}mstrmojo.ui.PulldownCheckList=mstrmojo.declare(mstrmojo.ui.PopupWidget,null,{scriptClass:"mstrmojo.ui.PulldownCheckList",visible:false,onOpen:function B(){var G=this.list;G.updateScrollbars();},onClose:function A(){this.list.refresh();},children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"list",postselectionChange:function D(G){var H=this.items,L=G.added||[],M=G.removed||[],K=this.selectedIndices,J=this.parent.parent.allIdx,I=false;if(J===L[0]){H.forEach(function(O,N){if(!K[N]){I=K[N]=true;}});}else{if(J===M[0]){K={};I=true;}else{if(K[J]){delete K[J];I=true;}}}if(I){this.set("selectedIndices",F.copy(K));this.refresh();}}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Buttons",children:[E(mstrmojo.desc(1442,"Ok"),function(){C.call(this.parent.parent,true);},true,{cssDisplay:"inline-block"}),E(mstrmojo.desc(2140,"Cancel"),function(){C.call(this.parent.parent,false);},false,{cssDisplay:"inline-block"})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.css");var D=mstrmojo.css;var B;mstrmojo.vi.ui.toolbars.TitleToolbar=mstrmojo.declare(mstrmojo.vi.ui.toolbars.Toolbar,null,{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",init:function F(H){this._super(H);D.addWidgetCssClass(this,"mstrmojo-VITitleToolbar");},markupMethods:{onvisibleChange:function A(){var H=this.visible,I=this.domNode;D.toggleClass(I,"visible",H);if(!H){D.onTransitionEnd(I,function(){D.addClass(I,"hidden");});}else{D.removeClass(I,"hidden");}}},getItemMarkup:function E(H){if(!B){B=this._super(H).replace("{@en@n}",'<div class="icn"></div>');}return B;},ontoolbarCfgChange:function G(H){var I=H.value;if(I){I.addMenuToolbarBtn("","mnu");if(I.hasCloseButton){I.addToolbarBtn(I.closeButtonText,"cls",function(K,J){J.parent.close();});}}this._super(H);},onItemContextMenu:function C(H){this.closePopup();if(H.fn){H.fn(H,this);return true;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.EditableLabel","mstrmojo.ui.menus.MenuConfig","mstrmojo.css");var b=mstrmojo.css,N=1,L=2,F=4,c=8,K=16;function E(e){return function(){b.toggleClass(this.menuBtnNode,"active",e);};}function H(f){var l=new mstrmojo.ui.menus.MenuConfig(),k=this.getMenuActions(),e=this.index,m=this.id,g=this.total;if((k&K)>0){this.addNewTabMenuItem(l);}if((k&F)>0){l.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){mstrmojo.all[m].tabDuplicated();});}if((k&L)>0){if(e){l.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){mstrmojo.all[m].tabMoved(true);});}if(e<g-1){l.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){mstrmojo.all[m].tabMoved(false);});}}l.addSeparator();if((k&N)>0){l.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){mstrmojo.all[m].lbl.set("isEditing",true);});}if((k&c)>0){if(g>1){l.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){mstrmojo.all[m].tabDeleted();});}}var h=this.getCustomMenu();if(h&&h.hasMenuItems()){l.addSeparator();l.absorbMenuItems(h);}l.addPopupHandlers(this.id,E(true),E(false));this.showTabMenu(this.updateMenuCfg(l),f);}mstrmojo.vi.ui.tabs.Tab=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.Tab",markupString:'<div id="{@id}" class="mstrmojo-VITab unselectable {@cssClass}" style="{@cssText}" unselectable="on" mstrAttach:click><div><div class="mstrmojo-VITab-tab"></div><div class="mstrmojo-VITab-menu"></div></div></div>',markupSlots:{containerNode:function W(){return this.domNode.firstChild.firstChild;},menuBtnNode:function a(){return this.domNode.firstChild.lastChild;}},markupMethods:{ontitleChange:function Z(){this.lbl.set("text",this.title);},onisSelectedChange:function V(){mstrmojo.css.toggleClass(this.domNode,"selected",this.isSelected);},onzIndexChange:function D(){this.domNode.style.zIndex=this.zIndex;}},zIndex:1,menuBtnNode:null,lbl:null,title:"",index:-1,total:-1,isSelected:false,children:[{scriptClass:"mstrmojo.EditableLabel",alias:"lbl",editOnClick:false,onTextEditComplete:function Q(f,e){if(f){this.parent.titleEdited(this.text,e);}}}],postBuildRendering:function X(){if(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){this.draggable=false;}this._super();},onclick:function d(e){var f=e.getTarget();if(f===this.menuBtnNode){H.call(this,f);}else{if(!this.isSelected){this.tabSelected();}}},getMenuActions:function I(){return 0;},getCustomMenu:function B(){return null;},isDragValid:function A(){return this.parent.children.length>1&&!this.lbl.isEditing;},createAvatar:function S(){var e=document.createElement("div");e.appendChild(this.domNode.cloneNode(true));e.style.margin="-5px 0 0 10px";return e;},allowDrop:function G(e){var f=e.src.widget;return f&&f.parent===this.parent;},ondrop:function Y(e){var f=e.src.data;this.parent.moveTab(f.idx,this.index,f.fromIdx);this._super(e);},ondragenter:function P(f){this._super(f);var g=f.src.data,e=this.index;this.parent.moveTab(g.idx,e);g.idx=e;},ondragover:function T(g){var e=g.tgt.node,f=g.tgtData,h=f&&f.node;if(!f||h!==e){g.tgtData={node:e};if(h){h.style.borderColor="";}}e.style.borderColor="#0fe88f";},getDragData:function C(){var g=this.id,e=this.index;return{setAvatarClass:function f(h){var m=mstrmojo.all[g],k=m.avatar;if(k){var l=[m.avatarCssClass,"hasOwnAvatar",h];k.className=l.join(" ");}},fromIdx:e,idx:e};},getDropAvatarIcon:function R(){return"pivot";},cleanUpAfterTarget:function J(f){var e=f.tgtData&&f.tgtData.node;if(e){e.style.borderColor="";}this._super(f);},onAppStateChange:function U(e){var f=this.lbl,g=e.value===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;f.set("isEditing",false);f.set("editOnDoubleClick",!g);this.draggable=!g;},addNewTabMenuItem:function O(e){this.throwAbstractMethodError("addNewTabMenuItem");},tabSelected:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,tabMoved:mstrmojo.emptyFn,tabDeleted:mstrmojo.emptyFn,tabDuplicated:mstrmojo.emptyFn,showTabMenu:mstrmojo.emptyFn,updateMenuCfg:function M(e){return e;}});mstrmojo.vi.ui.tabs.Tab.ACTIONS={NEW_TAB:K,RENAME:N,MOVE:L,DUPLICATE:F,DELETE:c};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.ui._HasMask","mstrmojo.vi._MonitorsAppState","mstrmojo.EditableLabel","mstrmojo.vi.ui.rw.PanelSelectorList","mstrmojo.ui.menus.MenuConfig");mstrmojo.vi.ui.rw.DockedPanelSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.rw.DockedPanelSelector",markupString:'<div id="{@id}" class="mstrmojo-DockedPanelSelector {@cssClass}" style="{@cssText}"><div class="panel-title"><div class="panel-name"></div><div class="panel-menu" mstrAttach:click>&nbsp;</div></div><div class="panel-list"></div><div class="panel-addBtn" mstrAttach:click></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{titleNode:function D(){return this.domNode.firstChild.firstChild;},menuNode:function E(){return this.domNode.firstChild.lastChild;},containerNode:function C(){return this.domNode.childNodes[1];},addBtnNode:function H(){return this.domNode.childNodes[2];},maskNode:function I(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},children:[{scriptClass:"mstrmojo.EditableLabel",alias:"title",slot:"titleNode",editOnClick:false,editOnDoubleClick:true,onTextEditComplete:function A(M){if(M){var L=this.parent;L.parent.renamePanel(L.panels[L.list.getSelectedItems()[0].idx],this.text);this.set("title",this.text);}}},{scriptClass:"mstrmojo.vi.ui.rw.PanelSelectorList",alias:"list",slot:"containerNode",postselectionChange:function G(L){var M=L.added;if(M){var N=this.items[M[0]],O=this.parent;O.parent.selectPanel(N.id);O.title.set("text",N.n);O.title.set("title",N.n);}}}],init:function K(L){this._super(L);this.title.set("editOnDoubleClick",!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign());},panels:null,onAppStateChange:function B(L){this._super(L);this.set("isMasked",L.value===mstrmojo.vi.VisualInsightApp.APP_STATES.SELECTOR_TARGETING);this.title.set("editOnDoubleClick",!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign());},setPanels:function F(L,N){this.panels=L;this.set("visible",L.length>1);var M=this.list;M.set("items",L.map(function(P,O){return{n:P.titleText,id:P.k,idx:O};}));M.singleSelect(N);},onclick:function J(U){var P=U.getTarget(),S=this.parent;if(P===this.addBtnNode){S.addPanel();}else{if(P===this.menuNode){var R=new mstrmojo.ui.menus.MenuConfig(),N=mstrmojo.ui.PopupConfig.ENUM_CORNERS;R.hostId=this.id;R.hostElement=this.menuNode;R.setAlignment(N.TOP_LEFT,N.BOTTOM_LEFT);var Q=this.list,O=Q.items.length,T=Q.getSelectedItems()[0].idx,L=this.panels[T],M=this.title;R.addMenuItem(mstrmojo.desc(4719,"Add Panel"),"",function(){S.addPanel();});R.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){S.duplicatePanel(L);});if(T){R.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){S.movePanel(T,T-1);});}if(T<O-1){R.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){S.movePanel(T,T+1);});}R.addSeparator();R.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){M.set("isEditing",true);});if(O>1){R.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){S.deletePanel(L);});}this.openPopup(R.newInstance());}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig");var D=mstrmojo.string,A=mstrmojo.dom,E=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(){var K=this,J=K.statusList,F=J&&J.length||0,G=K.statusConfig||new mstrmojo.ui.menus.MenuConfig(),L=function(M){return function(N){K.set("status",M);K.onStatusClick(M);};};if(!G.hasMenuItems()&&F){for(var H=0;H<F;H++){var I=J[H];G.addMenuItem(I.n,I.cls||"",L(I),K);}}else{}if(G.hasMenuItems()){G.alignment=K.alignment||{host:E.BOTTOM_LEFT,popup:E.TOP_LEFT};G.hostId=K.id;G.hostElement=K[K.hostElementName]||K.domNode;K.openPopup(G.newInstance());}}function C(){var F=this.statusConfig||this.statusList&&this.statusList.length>1;this.menuButtonNode.style.display=F?"":"none";}mstrmojo.ui.StatusButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.ui.StatusButton",markupString:'<div id="{@id}" class="mstrmojo-StatusButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}"><div class="mstrmojo-Button {@innerIconClass}"  mstrAttach:click><span class="mstrmojo-text"></span></div><div class="menuButton" mstrAttach:click></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},textSpanNode:function(){return this.domNode.firstChild.firstChild;},menuButtonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onstatusChange:function(){this.textSpanNode.innerHTML=D.encodeHtmlString(this.status&&this.status.n||"");},onstatusListChange:function(){C.call(this);},onstatusConfigChange:function(){C.call(this);}},status:null,statusList:null,statusConfig:null,onclick:function(F){var G=A.eventTarget(F.hWin,F.e);if(A.contains(this.menuButtonNode,G,true)){B.call(this);}else{if(A.contains(this.textNode,G,true)){this.onButtonClick(this.status,F);}}},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.ui.menus.EditorConfig","mstrmojo.express.ui.SubtotalsWidget","mstrmojo.dom","mstrmojo.mstr.EnumDSSXMLDrillType");var K=mstrmojo.hash,G=mstrmojo.array,E=mstrmojo.mstr.EnumDSSXMLDrillType,M={STATIC:0,DRILLING:1,SELECTOR_CONTROL:2,HYPERLINK:4,SORT:8,PIVOT:16,EDIT:32,GROUP:64,CALCULATION:128,GROUP_EDIT:256,KEEP_ONLY:512,TOTAL_HEADER:1024};function D(T){return mstrmojo.resolveFeature("web-sort")&&!!(T&&(T.mix!==undefined&&T._e&&T._e.otp===4));}function P(U){var Y=new mstrmojo.ui.menus.MenuConfig(),X=U.data,T=U.cfg,W=[{n:mstrmojo.desc(1893,"Left"),btp:"l"},{n:mstrmojo.desc(1894,"Right"),btp:"r"},{n:mstrmojo.desc(13834,"To Beginning"),btp:"b"}],V=this.delegateActionToXtab;if(!T.tabularGrid){W.push({n:mstrmojo.desc(152,"Up"),btp:"u"},{n:mstrmojo.desc(153,"Down"),btp:"d"},{n:mstrmojo.desc(1891,"To Columns"),btp:"2"},{n:mstrmojo.desc(1890,"To Rows"),btp:"1"});}G.forEach(W,function(Z){if(U.xtab.model.isPvtButtonVisible(X,Z.btp)){Y.addMenuItem(Z.n,"xt",function(){V(U,"pivot",[Z.btp]);});}});return Y;}function B(W){var V=W.onDemandDrillItems;var U=W.onDemandDrillDynamicItems;if(!W.onDemandDrillItems&&!W.loadingDCM){W.loadingDCM=true;var Y=new mstrmojo.SimpleXHR({async:false});Y.request("POST",mstrConfig.taskURL,{success:function X(a){var Z=a.dynamicMenus[0];U=Z.items;V=a.menuItems;W.onDemandDrillItems=V;W.onDemandDrillDynamicItems=U;delete W.loadingDCM;}},{taskId:"RWOnDemandDrill",styleName:"OndemandDrillContextMenusStyle",viewMode:1,usePartDisplay:1,docGridKey:W.k,rwb:mstrApp.docModel.bs});}var T=[];G.forEach(U,function(d){var Z=d.idx,a=V[Z],c=JSON.parse(a.subMenuIndices||"[]");if(c.length>0){var b=[];G.forEach(c,function(e){b.push(V[e]);});a.items=b;}T.push(a);});return T;}function Q(U){var T="";switch(U){case E.DssXmlDrillToChild:T="drillDown";break;case E.DssXmlDrillToParent:T="drillUp";break;case E.DssXmlDrillToTemplate:T="drillTemplate";break;}return T;}function S(U,T){var W=parseInt(U.dt,10),V=parseInt(T.dt,10);if(W>V){return 1;}if(V>W){return -1;}return(U.n<T.n?-1:1);}function I(U){var T=G.filter(U,function(V){return[E.DssXmlDrillToChild,E.DssXmlDrillToParent].indexOf(V.dt)>-1;});return T.length>0?"drill":"";}mstrmojo.rw.xtab.XtabMenuConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.rw.xtab.XtabMenuConfig",xtab:undefined,data:undefined,isActionAvailable:function H(U,T){return((((U&&U.at)||0)&T)>0);},delegateActionToXtab:function J(T,W,U){var V=T.xtab;V[W].apply(V,[T.data].concat(U||[]));},buildXtabMenuConfig:function A(Y){var d=this.xtab=Y.xtab,W=d.id,X=this.selectedData=Y.data=Y.data||(d&&Y.td&&d.getCellForNode(Y.td)),a=d.model.getCellTitleInfo(X),Z={xtab:d,data:X,cfg:Y},c=this.delegateActionToXtab;this.selectedNode=Y.td;if(Y.onClose){this.addPopupHandlers(W,mstrmojo.emptyFn,Y.onClose);}var e=d.model.getCellLinksInfo(X)||{},V=e.links||[],T=this.isActionAvailable(X,M.HYPERLINK)&&V.length>0,U=this.isActionAvailable(X,M.DRILLING)&&(X.sdm==undefined),b=(X&&X.mix===undefined&&a.isSrcTitle&&X.otp!==-1);if(U){U=this.addDrillMenuItem(Z)?true:false;}if(T){V.forEach(function(g,f){this.addMenuItem(g.n||g.url||(g.target&&(g.target.n||g.target.did)),"",function(){c(Z,"link",[f]);});},this);}if(U||T){this.addSeparator();}this.addPivotMenuItem(Z);this.addSortMenuItem(Z);if(b){this.addSeparator();this.addShowTotalMenuItem(Z);}this.addRemoveMenuItem(Z);},addPivotMenuItem:function F(T){if(this.isActionAvailable(T.data,M.PIVOT)){var U=P.call(this,T);if(U.menus.length){this.addSubMenuItem(mstrmojo.desc(1889,"Move"),"",this.id,function(){return U;},T);this.addSeparator();}}},addDrillMenuItem:function N(T,V){var a=T.xtab,Z=T.data,U=this.delegateActionToXtab,Y=function(b){b.onDemandDrillItems=null;b.onDemandDrillDynamicItems=null;};var X=V?[V]:a.model.getAllDrillPathsForCell(Z);var W=B(a);if(X.length<1&&W.length<1){return ;}this.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,function(){var b=new mstrmojo.ui.menus.MenuConfig({menuCssClass:I(X),isHostedWithin:false,supportsScroll:true,alignWithAnchor:true,maxHeight:mstrmojo.dom.windowDim().h-50});X=X.sort(S);G.forEach(X,function(c){if(c&&c.k){b.addMenuItem(c.n||"",Q(c.dt),function(){U(T,"drill",[c]);Y(a);});}});G.forEach(W,function(c){b.addPopupMenuItem(c.n,"",function(){var d=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350,isHostedWithin:false,alignWithAnchor:true,menuCssClass:I(c.items)});G.forEach(c.items,function(e){d.addMenuItem(e.n,Q(e.dt),function(){U(T,"drill",[e]);Y(a);});});return d;});});return b;});},addRemoveMenuItem:function L(T){if(T.data._e){if(T.data._e.otp!==4){return ;}}if(T.data.otp===-1){return ;}this.addSeparator();this.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",this.delegateActionToXtab.bind(this,T,"removeUnit"),T);},addSortMenuItem:function R(T){var V=T.data,U=this.delegateActionToXtab,W=this.isActionAvailable(V,M.SORT);if(W){this.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",function(){U(T,"sort",[true]);},T);this.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",function(){U(T,"sort",[false]);},T);}if(!T.cfg.hideAdvancedSort&&(W||D(V))){this.addMenuItem(mstrmojo.desc(11099,"Advanced Sort..."),"xt",function(){U(T,"advSort",[V.axis]);},T);}},addShowTotalMenuItem:function C(T){this.addEditorMenuItem(mstrmojo.desc(6193,"Show Totals"),this.id,this.getSubtotalEditorConfig,K.copy(T,{isTotals:true}));},getSubtotalEditorConfig:function O(U){var V=U.data,X=U.xtab,T=X.getBasicSubtotalEditorConfig(V.ast);T.fnOk=function W(){var Z=T.contents.getSubtotalTypes(),Y=X.model;X.controller.onShowTotals(X,Y.getShowTotalsUnitAction(V.id,V.otp,Z[0],Z[1]));};return T;}});mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES=M;mstrmojo.rw.xtab.XtabCellMenuItemContextType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui._HasScroller","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.gm.GMEnums");var Y=mstrmojo.Widget,a=mstrmojo.css,N=mstrmojo.array,X=mstrmojo.num,T=mstrmojo.hash,Z=mstrmojo.expr.DTP,c=mstrmojo.gm.EnumRefLineModelType,D=mstrmojo.gm.WidgetPropertyTag;var b;var K=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(4046,"First"),mstrmojo.desc(4049,"Last"),mstrmojo.desc(7194,"Constant")];function Q(o,p,g){var l=mstrmojo.dom.position(p),f=l.x,n=l.x+l.w,m=l.y,e=l.y+l.h,k=o.pageX,h=o.pageY;if(g){f+=1;n-=1;m+=1;e-=1;}return k>=f&&k<=n&&h>=m&&h<=e;}mstrmojo.ui.editors.controls.GMReferenceLineItemContainer=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.controls.GMReferenceLineItemContainer",cssClass:"GMReferenceLineItemContainer",icnCss:"GMReferenceLineItemContainer-container",setupScrollNodes:function L(){this.scrollNode=this.itemsContainerNode;},getItemMarkup:function C(e){if(!b){b=this._super(e).replace(">{@en@n}<",'><span class="txt" title="{@en@n}">{@en@n}</span><span class="rmv hidden" rmv></span><');}return b;},onclick:function d(e){try{var h=e.getTarget(),g=this.getItemFromTarget(h);if(g){e.cancel();if(h.hasAttribute("rmv")){this.doItemRemove(g);}else{this.doItemSelect(g,e||{});}}}catch(f){mstrApp.onerror(f);}},onmouseover:function F(e){try{var h=e.getTarget(),f=h.className;if(f==="txt"||f==="rmv"){h=h.parentNode;}if(Q(e.e,h,false)){a.removeClass(h.children[1],"hidden");}}catch(g){mstrApp.onerror(g);}},onmouseout:function E(e){try{var h=e.getTarget(),f=h.className;if(f==="txt"||f==="rmv"){h=h.parentNode;}if(!Q(e.e,h,true)){a.addClass(h.children[1],"hidden");}}catch(g){mstrApp.onerror(g);}},doItemRemove:function I(f){var e=this.items.slice();N.removeItem(e,f);this.set("items",e);this.onremoveItem(f);},onremoveItem:function A(e){}});function R(){return{scriptClass:"mstrmojo.ui.editors.controls.GMReferenceLineItemContainer",items:[],alias:"refLnList",getItemDisplayName:function(f){var e=K[f.refType]||"";if(f.refType===c.CONST){if(!!f.lin){e=f.lin;}else{if(f.c!==undefined){e+=(" "+X.toLocaleString(f.c));}}}return e;},postselectionChange:function(){this.parent.onselectRefLine(this.selectedItem);},ondblclick:function(e){var f=this,h=e.getTarget(),g=f.selectedItem;if(g.refType===c.CONST){h.contentEditable=true;h.onkeydown=function(k){if(k.keyCode===13){this.contentEditable=false;if(this.title!==this.textContent){this.title=this.textContent;g[D.REF_LINE_NAME]=this.title;f.parent.onrenameRefLine(g);}return false;}};h.onblur=function(k){if(this.contentEditable&&this.title!==this.textContent){this.contentEditable=false;this.title=this.textContent;g[D.REF_LINE_NAME]=this.title;f.parent.onrenameRefLine(g);}};}},onremoveItem:function(e){this.parent.onremoveRefLine(e);}};}function G(){function f(n){var o=this.refLnList.items;return(this.restrictedTypes||[]).indexOf(n)===-1&&(n===c.CONST||N.find(o,"refType",n)===-1);}function m(n,o){var p=this.generateNewRefLineItem(n,o);this.refLnList.addItems(p);this.onaddRefLine(p);}var e="propEditor-Menu",k=mstrApp.getThemeClassName(),g=this,l=new mstrmojo.ui.menus.MenuConfig({menuCssClass:e,hostId:g.id,hostElement:g.containerNode,isHostedWithin:false});var h=T.valarray(c);(h.slice(0,-1)).forEach(function(n){if(!f.call(g,n)){return ;}l.addMenuItem(K[n],"",function(){if(g.manager&&g.manager.host){g.manager.host.checkCustomScaleNotificationForReferenceLine(g.metricOpt.key);}m.call(g,n);});});l.addPopupMenuItem(K[7],g.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:e+" "+k,data:{constantValid:false},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",cssClass:"reference-line-constant",dtp:Z.FLOAT,required:true,valueChangeDelay:1000,constraints:{trigger:mstrmojo.validation.TRIGGER.NONE},onEnter:function(){this.blur();},onvalueChange:function(){this.validate();},onValid:function(){this.parent.data.set("constantValid",true);},onInvalid:function(){this.parent.data.set("constantValid",false);}}],bindings:{okEnabled:"this.data.constantValid"},fnOk:function(o,n){var p=n.constVal;if(p.isValid()){if(g.manager&&g.manager.host){g.manager.host.checkCustomScaleNotificationForReferenceLine(g.metricOpt.key);}m.call(g,c.CONST,p.value);}}});},"",g);g.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:l,themeClassName:k}));}function H(){return{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(531,"Add"),alias:"addBtn",cssClass:"link-btn",onclick:function(){G.call(this.parent);}};}mstrmojo.ui.editors.controls.GMReferenceLineList=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.ui.editors.controls.GMReferenceLineList",markupString:'<div id="{@id}" class="mstrmojo-ui-GMReferenceLineList {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:Y.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod,onheightChange:Y.heightMarkupMethod,onwidthChange:Y.widthMarkupMethod},restrictedTypes:undefined,items:undefined,shouldPropagateEnabled:true,children:[R(),H()],init:function V(e){this._super(T.copy(e,{items:[],restrictedTypes:[]}));this.onitemsChange();},onitemsChange:function U(){this.refLnList.set("items",this.items);},generateNewRefLineItem:function J(e,f){},getSelectedItem:function O(){return this.refLnList.selectedItem;},selectItemByField:function B(f,e){this.refLnList.singleSelect(N.find(this.refLnList.items,f,e));},onselectRefLine:function W(e){},onaddRefLine:function P(e){},onremoveRefLine:function M(e){},onrenameRefLine:function S(e){}});mstrmojo.ui.editors.controls.GMReferenceLineList.ItemType=null;}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","css","dom");var E=mstrmojo.css,F=mstrmojo.dom;mstrmojo.threshold.ColorMarker=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorMarker",markupString:'<div class = "marker {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:contextmenu,mousedown,mouseover,mouseout></div>',markupMethods:{onleftChange:mstrmojo.Widget.leftMarkupMethod},hovered:false,selected:false,index:undefined,select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onselectedChange:function B(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onMarkerSelected(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnselected(this.index);}this.parent.onMarkerUnhovered(this.index);},oncontextmenu:function H(J){F.preventDefault(window,J.e);var I=this,K=I.parent.parent;var L=new mstrmojo.ui.menus.MenuConfig({position:F.getMousePosition(J.e,J.hWin),isHostedWithin:false});L.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){K.bands.remove(I.index);K.update();});this.openPopup(L.newInstance());},onmousedown:function A(){this.set("selected",!this.selected);},onmouseover:function G(){this.set("hovered",true);},onmouseout:function D(){this.set("hovered",false);},onhoveredChange:function C(I){if(!this.selected){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onMarkerHovered(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnhovered(this.index);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ui.menus.MenuConfig");var A=mstrmojo.func,J=mstrmojo.desc(2177,"Close");function G(L){return function(N,M){M.openMenu(L,N);};}mstrmojo.ui.menus.ToolbarConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.ui.menus.ToolbarConfig",btns:null,hasCloseButton:false,closeButtonText:J,addCloseButton:function E(L){this.hasCloseButton=true;if(L){this.closeButtonText=L;}},addToolbarBtn:function I(Q,M,P,L,N){var O={n:Q,cls:M,fn:P,ctxt:L};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}return O;},addDisabledToolbarBtn:function I(N,L){var M=this.addToolbarBtn(N,(L||"")+" disabled",mstrmojo.emptyFn);M.dsbld=true;},addToolbarPickerBtn:function B(R,M,P,Q,L,N){var O={n:R,cls:M,fn:P,ctxt:L,tp:"pb",menufn:G(Q||this)};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}},addMenuToolbarBtn:function H(P,L,O,M,N){if(!O&&!this.hasMenuItems()){return ;}this.addToolbarBtn(P,L,A.composite([G(O||this),(N||mstrmojo.emptyFn)]),null,M);},addToggleToolbarButton:function D(S,O,Q,N,M,R,L){var P=this.getToggleItemStates(S,O,Q,N,R,L);this.addDualStateItem(M,P[0],P[1],true);},addDualStateItem:function K(M,L,N,O){this["add"+(O?"ToolbarBtn":"MenuItem")](L.n,L.cls,this.getDualStateHandler(M,L,N),L.ctxt);},getDualStateHandler:function C(M,L,N){var O=this._super(M,L,N);return function(P,Q){O.call(this,P,Q);Q.refresh();};},clear:function F(){this.btns=[];this.hasCloseButton=false;this.closeButtonText=J;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.selectors.CheckList","mstrmojo.vi.ui.rw.selectors.SearchableCheckList","mstrmojo.vi.ui.rw.selectors.CollapsibleCheckListHelper","mstrmojo.ui.SearchBox","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig","mstrmojo.string","mstrmojo.css","mstrmojo.hash","mstrmojo.dom");var B=mstrmojo.css,M=mstrmojo.hash,L=mstrmojo.dom,d="hidden",C="expanded",l="collapsed";function O(r,o){var n=r._renderIdx,t=r._positionIdx,p=this.helper.isBranchSelected(n)?"remove":"add",q=this.helper.getBranchIndices(n);this[p+"Select"](q,false,t);}function Z(p){var o=this.helper.getLevelIndices(p),n=this.helper.isLevelSelected(p,o)?"remove":"add";this[n+"Select"](o,false);}function k(){return Math.floor((parseInt(this.width.match(/\d*/))-16)/22);}function Q(){if(!this.isShowAllItems){return ;}var q,r,n=this.helper.getLevelCount(),p=k.call(this),o;q=document.createElement("div");q.className="btnsBar lv";r='<div class="btn all'+(this.helper.isAllItemsSelected()?" selected":"")+'">All</div>';if(n<=p){for(o=0;o<n;o++){r+='<div class="btn lv'+(this.helper.isLevelSelected(o)?" selected":"")+'" idx = "'+o+'">'+(o+1)+"</div>";}}else{for(o=0;o<p-1;o++){r+='<div class="btn lv'+(this.helper.isLevelSelected(o)?" selected":"")+'" idx = "'+o+'">'+(o+1)+"</div>";}r+='<div class="btn more" idx = "">...</div>';}q.innerHTML=r;if(this.levelButtonsContainerNode){this.domNode.replaceChild(q,this.levelButtonsContainerNode);}else{this.domNode.insertBefore(q,this.scrollboxNode);}this.levelButtonsContainerNode=q;}function R(o){if(!this.isShowAllItems){return ;}var p=b.call(this,o);if(p){var n=isNaN(o)?this.helper.isAllItemsSelected():this.helper.isLevelSelected(o);B.toggleClass(p,"selected",n);}}function U(){var p,o=this.helper.getLevelCount(),q=k.call(this),n;R.call(this);if(o<=q){n=o;}else{n=q-1;}for(p=0;p<n;p++){R.call(this,p);}}function b(n){if(!this.isShowAllItems){return ;}var o=this.levelButtonsContainerNode,p;if(isNaN(n)){p=o.childNodes[0];}else{p=o.childNodes[n+1];if(p&&parseInt(p.getAttribute("idx"),10)!==n){p=undefined;}}return p;}function X(n){var v=new mstrmojo.ui.menus.MenuConfig(),p=this.helper.getLevelCount(),t=k.call(this),r=p-t+1,q,o=this;if(r>0){for(q=0;q<r;q++){v.addMenuItem("Level "+(q+t),this.helper.isLevelSelected(q+t-1)?"on":"",function u(){Z.call(o,t-1+this._renderIdx);});}v.hostId=this.id;v.isHostedWithin=false;v.hostElement=n.getTarget();this.openPopup(v.newInstance());}}function I(n){var p=n.getTarget(),o,q;if(this.hasClass(p,"all")){o=this.items[0];this.doItemSelect(o,n||{});}else{if(this.hasClass(p,"lv")){q=p&&parseInt(p.getAttribute("idx"),10);Z.call(this,q);}else{if(this.hasClass(p,"more")){X.call(this,n);}}}}function m(){var p,t=this.items.length,n=[],q=this.helper;if(this.isCollapsibleDisplay()){for(p=0;p<t;p++){n[p]=this.items[p].nSelectedDescendants;}}q.updateCachedSelectedDescendantsCount();if(this.isCollapsibleDisplay()){var o;for(p=0;p<t;p++){o=this.items[p].nSelectedDescendants;if(o!==n[p]){var r=this._getItemNode(p).getElementsByClassName("statistic");if(r.length===1){r=r[0];r[r.innerText!==undefined?"innerText":"textContent"]="("+q.getAndCacheSelectedDescendantsCount(p,true)+"/"+q.getAndCacheDescendantsCount(p)+")";}}}}}mstrmojo.vi.ui.rw.selectors.CollapsibleCheckList=mstrmojo.declare(mstrmojo.vi.ui.rw.selectors.SearchableCheckList,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.rw.selectors.CollapsibleCheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><table class="btnBar"><tbody><tr><td class="btn availItems">{@availItemsText}</td><td class="btn selItems">{@selectedItemsText}</td></tr></tbody></table><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{availItemsBtnNode:function f(){return this.domNode.firstChild.firstChild.firstChild.firstChild;},selectedItemsBtnNode:function f(){return this.domNode.firstChild.firstChild.firstChild.children[1];},btnBarNode:function f(){return this.domNode.firstChild;},scrollboxNode:function P(){return this.domNode.children[1];},itemsContainerNode:function G(){return this.domNode.children[1].firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onisShowAllItemsChange:function(){var n=this.isShowAllItems;B.toggleClass(this.domNode,"showSelectedItems",!n);B.toggleClass(this.availItemsBtnNode,"selected",n);B.toggleClass(this.selectedItemsBtnNode,"selected",!n);this.refresh();}},isShowOnly:false,isShowAllItems:true,renderOnScroll:false,init:function e(n){this._super(n);B.addWidgetCssClass(this,"collapsible");},updateHelper:function D(){var n=M.walk("vi.ui.rw.selectors.CollapsibleCheckListHelper",mstrmojo);this.helper=new n({checkList:this});},preBuildRendering:function A(){this.updateHelper();this.availItemsText=mstrmojo.desc(14671,"Available Items");this.selectedItemsText=mstrmojo.desc(14672,"Selected Items");this._super();},buildRendering:function V(){this._super();this.levelButtonsContainerNode=undefined;Q.apply(this);},_buildItemsMarkup:function a(o,t,AC,p,AE,q){var AF=[],z=0;AF[z++]=AC||"";var v=this.itemRenderer,AB=v&&v.render;if(AB&&typeof AB==="function"){var AA=this.items,u=this.rootIndices,AD,x=u.length,n=this.mapOriToDisp=[],r=0;var w=function(AI){var AH=AA[AI],AJ=AH.childrenIndices.length,AG;n[AI]=r++;AF[z++]=AE||"";AF[z++]=AB(AH,AI,this);AF[z++]=q||"";for(AG=0;AG<AJ;AG++){w.call(this,AA[AI].childrenIndices[AG]);}};for(AD=0;AD<x;AD++){w.call(this,u[AD]);}}AF[z+1]=p||"";return AF;},getItemMarkup:function J(p,n){var o;if(this.isCollapsibleDisplay()){o='<{@tag} class="item-ra {@hidden} {@epd}" idx="{@idx}"><div class="lv" style="width: {@lv-width}px;"></div><div class="icn"></div><{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"title="{@tt}"><span class="icon"></span><span class="branch"></span><span class="text">{@html}<span class="statistic">{@stat}</span></span></{@tag}></{@tag}>';}else{o=this._super(p,n);}return o;},getItemProps:function g(q,o){var u=this._super(q,o),p=q.lv,r=q.hcd,t=q.epd,n=q.isCollapsedHidden;if(p!==undefined){u["lv-width"]=p*10;}if(!r){u.epd="";}else{if(t){u.epd=C;}else{u.epd=l;}}if(n){u.hidden=d;}if(r){u.stat="("+this.helper.getAndCacheSelectedDescendantsCount(o,true)+"/"+this.helper.getAndCacheDescendantsCount(o)+")";}return u;},getItemNode:function F(n){var p=this.mapOriToDisp,o,q;if(!p){return ;}o=p[n];q=this.itemsContainerNode;return(q&&q.childNodes[o])||null;},_getItemNode:function N(n){var r,q,p,o;r=this.getItemNode(n);if(r&&this.hasClass(r,"item-ra")){q=r.childNodes;p=q&&q.length;for(o=0;o<p;o++){if(this.hasClass(q[o],"item")){r=q[o];break;}}}return r;},onclick:function T(n){var p=n.getTarget(),o=this.getItemFromTarget(p);if(this.hasClass(p,"icn")&&(this.hasClass(p.parentNode,C)||this.hasClass(p.parentNode,l))){this.doCollapseExpand(o,n);this.updateScrollbars();}else{if(this.hasClass(p,"btn")){if(p.parentNode&&this.hasClass(p.parentNode,"btnsBar")&&this.hasClass(p.parentNode,"lv")){I.call(this,n);}else{this.set("isShowAllItems",this.hasClass(p,"availItems"));}}else{if(this.hasClass(p,"branch")){if(o){O.call(this,o,n);}}else{this._super(n);}}}},selectionAdded:function c(n){m.call(this);if(this.helper.isAllItemsSelected()){this.selectedIndices[0]=true;}else{delete this.selectedIndices[0];}U.call(this);},selectionRemoved:function h(n){m.call(this);if(this.helper.isAllItemsSelected()){this.selectedIndices[0]=true;}else{delete this.selectedIndices[0];}U.call(this);},doCollapseExpand:function S(p,n){var q=n.getTarget(),o=p.epd;this.collapseExpandDescends(p._renderIdx,o);p.epd=!p.epd;B.toggleClass(q.parentNode,l,o);B.toggleClass(q.parentNode,C,!o);},collapseExpandDescends:function H(v,p){var t=this.items,q=t[v].childrenIndices,r=q.length,o,n,u,w;for(o=0;o<r;o++){n=q[o];u=t[n];w=this.getItemNode(n);u.isCollapsedHidden=p;B.toggleClass(w,d,p);if(p||(!p&&u.epd)){this.collapseExpandDescends(n,p);}}},onwidthChange:function K(n){this._super(n);if(this.levelButtonsContainerNode){Q.call(this);}},getScrollboxHeight:function W(){var n=this._super();return n-L.position(this.btnBarNode).h-L.position(this.levelButtonsContainerNode).h;},isCollapsibleDisplay:function E(){var n=this.searchInput;return this.isShowAllItems&&(!n||n.isClear());},hasClass:function Y(p,o){var q=p.className.split(/\s+/),n;for(n=0;n<q.length;n++){if(q[n]===o){return true;}}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase","mstrmojo._Formattable","mstrmojo._IsSelectorTarget","mstrmojo._IsDocXtab","mstrmojo._XtabSelections","mstrmojo._XtabCellHoverMgr","mstrmojo.XtabCellHoverPopup","mstrmojo._HasPopup","mstrmojo.dom");var S=0,W="overflow:auto",V="overflow:hidden",K=mstrmojo.dom,g="mstrmojo.DocPanelStack",l="px",D=mstrmojo.DocDataService.SUPPRESS_DATA,c=mstrmojo.models.template.DataInterface,H=c.ENUM_GRID_RESIZE,f=H.FIXED,M=H.FIT_TO_WINDOW,G=H.FIT_TO_CONTENTS;var Y=function J(n,o){var p=n&&n.parent;while(p&&p.scriptClass!==g){if(p.scriptClass===o){return p;}p=p.parent;}return p;};mstrmojo.Xtab=mstrmojo.declare(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._IsDocXtab,mstrmojo._XtabSelections,mstrmojo._HasPopup],{scriptClass:"mstrmojo.Xtab",cellHoverMgr:"mstrmojo._XtabCellHoverMgr",cellHoverPopupRef:"mstrmojo.XtabCellHoverPopup",preBuildRendering:function A(){var p=this._super();var o=this.gridData;var n=this.lockHeadersCase===S&&o.co;this.scrollboxNodeOverflow=n&&!this.numRowFixed?V:W;var q=this.getFormats();if(mstrmojo.dom.isIE8&&!o.co&&this.lockHeadersCase===S&&(!o.rw||(o.rw&&(o.rw.row.bc>=o.rw.row.tc)))&&mstrmojo.string.isEmpty(q.height)&&mstrmojo.string.isEmpty(q.width)){this.scrollboxNodeOverflow="";}this._useFilter=this._useFilter||o.cssflt||false;return p;},postBuildRendering:function Z(){var q=this.gridData,o=this._super();if(this.supportsContextMenu()){var t=this;if(this.viewport){this.viewport.onmouseover=function(){t.addDisposable(t.requiresContrib("cellHoverMgr",true));t.viewport.onmouseover=null;};}}if(!this.getFormats().width&&this.model.docModel.addAutoWidthID&&(this.parent&&this.parent.scriptClass!=="mstrmojo.ExpressDocPanel")){this.model.docModel.addAutoWidthID(this.id);q=this.gridData;var n=q&&q.afc;if(n&&mstrmojo.dom.isIE7){var r=Y(this,g);if(r&&r.scriptClass===g){this.viewport.style.width=this.contentNode.offsetWidth+(this.scrollboxNode.offsetWidth-this.scrollboxNode.clientWidth)+"px";}}}if(K.isIE&&!K.isIE8&&this._useFilter){var u=this.scrollboxNode;window.setTimeout(function(){var p=document.createElement("img");u.appendChild(p);u.removeChild(p);},0);}return o;},supportsContextMenu:function L(){return !K.supportsTouches;},onCGBMapChange:function(n){if(this._resolveCGBToTKS(n.cgbMap)&&this._currentSelectedTD){this.defaultAction(this._currentSelectedTD);}},_resolveCGBToTKS:function e(w){if(!w){return false;}var u=this.model.scm,p="\u001E",r,o,t,q,n,v=false;for(o in u){t=u[o];q=t.cgb;for(r in q){n=w[q[r]];if(n){if(!t.tks){t.tks=n;v=true;}else{if(t.tks&&(t.tks.indexOf(n)<0)){t.tks+=p+n;v=true;}}}}}return v;},onGridWidthChanged:function U(n){if(this._super){this._super(n);}if(this.cellHoverMgr.onXtabWidthChanged){this.cellHoverMgr.onXtabWidthChanged();}},getDim:function(){var n=this.contentNode;return{w:n.scrollWidth,h:n.scrollHeight};},unrender:function B(n){var o=this.cellHoverMgr;if(o&&o.shutdown){o.shutdown();}this._super(n);},link:function E(o,n){this.controller.onLink(this,this.model.getLinkAction(o,n));},sort:function k(n,o){this.controller.onSort(this,this.model.getSortAction(n,o));},advSort:function O(n,o){this.controller.onGetAdvSortData(this,o,n._e&&n._e.otp);},pivot:function N(n,o){this.controller.onPivot(this,this.model.getPivotAction(n,o));},drill:function h(n,o){this.controller.onDrill(this,this.model.getDrillAction(this.getActionCells(n),o));},removeUnit:function Q(n){this.controller.onRemoveUnit(this,this.model.getRemoveTemplateUnitAction({id:n._e?n._e.oid:n.id,t:n._e?n._e.otp:n.otp}));},showTotal:function I(n,p,o){this.controller.onShowTotals(this,this.model.getTotalsAction(n,p,o));},derivedMetric:function d(n,t){var o,r=n._e.oid,p={did:r,alias:n._e.n,n:n._e.n,v:n.um?n.formula:n._e.v,idx:n.mix,host:this,nodeKey:this.k,dsid:this.controller.model.findDatasetIdFromUnit(r)||this.model.data.datasetId},u;if(t==="edit"){o={metricId:p.did,action:{cmd:"edit",n:p.n,alias:p.alias}};u=this.controller.model.getDataService().getEditDerivedMetricSubmitFunc(p);}else{o={metricId:"",action:{cmd:"editNew",refOi:{did:p.did,n:p.n}}};u=this.controller.model.getDataService().getAddNewDerivedMetricToXtabSubmitFunc(p);}var q=this.controller.model;if(q.isFromSolrCube&&q.isFromSolrCube(p.did)||q.isFromMDXCube(p.did)){o.disableAFB=true;}this.controller.openDME(this,o,u);},findSelectorControl:function C(){var n=this.gridData.sc;if(n&&parseInt(n.ct,10)===6){this.selectorControl=n;}else{delete this.selectorControl;}return this.selectorControl;},handlesMultiSelection:function b(o){var n=this.getCellForNode(K.findAncestorByName(o.getTarget(),"td",true,this.viewport)),q=n&&this.model.data.gts[n.axis===1?"row":"col"][n.tui||n.ui],p=q&&q.id&&q.sc;return !!(this.findSelectorControl()||p);},getBasicSubtotalEditorConfig:function X(p){var n=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.express.ui.SubtotalsWidget({onchange:function o(){var q=this.getSubtotalTypes(),r=q[0].length>0||q[1].length>0;n.set("okEnabled",r);}}),data:{},okEnabled:false});if(!this.model.data.gsi.hidesb){n.contents.set("selectedItems",p||[]);}return n;},updateRelatedColWidths:function P(o){var r=(new mstrmojo.models.template.DataInterface(this.gridData)).getColumnHeaderData(),q=this.gridData.twm||{},p=q.bottom,n=q.top;(o||[]).forEach(function(u){var v=r[u.colIndex],t=v._ridx||[];if(t.length>1){t.forEach(function(w){n[w].w=p[w].w=u.value;});}else{n[u.colIndex].w=p[u.colIndex].w=u.value;}});this.refresh();},updateScenario:function F(o){var n=this.gridData;n.afc=o===G;n.afw=o===M;if(o!==f){this.setAllXtabWidths("");}this.refresh();},setAllXtabWidths:function m(n){},changeResizeScenario:function a(w,AC,AD,x){var AF=new mstrmojo.models.template.DataInterface(this.gridData),p=this.gridData.twm||{},q=p.bottom,n=AF.getColumnHeaderData(),z=this,u=this.model,o=this.id,AE=this.k,r=[],t=[],v=1,AB=[];if(AC){r.push({act:"changeXtabColWidthScenario",value:w});n.forEach(function(AH,AG){var AK=AH.oid||AH.id,AJ=function(AL){return AL.unitId===AK&&AL.depth===v;};if(!(AH.fs&&AH.fs.length>0)){v=1;}var AI=AK===(AD&&AD.did)&&v===AD.depth;if(!AB.some(AJ)){AB.push({unitId:AK,depth:v});t.push({colIndex:AG,value:AI?AD.width+l:q[AG].w});if(w===f){r.push(u.getColumnResizeAction(AK,AH.otp,AI?AD.width:parseInt((q[AG].w)||0,10),v,AI?AD.isExtra:false));}}v++;});var AA=function AA(AG,AI){var AH=mstrmojo.all[o];if(AG===f){z.updateRelatedColWidths(AI);}z.updateScenario(AG);};AA(w,t);z.submitColumnWidthChange(r,x);}return x?r:undefined;},submitColumnWidthChange:function T(p,n){if(!n){this.model.getDataService().submitTemplateUpdates(this.k,p,{success:function o(){}},D);}},changeColumnWidth:function R(r,AA,o,AB,p,w){var AD=new mstrmojo.models.template.DataInterface(this.gridData),n=AD.getColumnHeaderData(),u=this.model,q=[],z=this,t=[],v=1,x=-1,AC=[];if(AD.getColResizeScenario()!==f){q=this.changeResizeScenario(f,true,{did:r,t:AA,width:o,depth:AB,isExtra:p},w);return w?q:undefined;}if(r==="all"){n.forEach(function(AF,AE){var AI=AF.oid||AF.id,AH=function(AJ){return AJ.unitId===AI&&AJ.depth===v;},AG=n[AE-1];if(!(AF.fs&&AF.fs.length>0)||(AG&&AI!==(AG.oid||AG.id))){v=1;}if(!AC.some(AH)){AC.push({unitId:AI,depth:v});t.push({colIndex:AE,value:o+l});q.push(u.getColumnResizeAction(AI,AF.otp,o,v,false));}v++;});}else{n.every(function(AF,AE){var AG=(AF.oid===r||AF.id===r);if(AG){x=AE+AB-1;}return !AG;});if(x>=0){t.push({colIndex:x,value:o+l});q.push(u.getColumnResizeAction(r,AA,o,AB,p));}}z.updateRelatedColWidths(t);z.submitColumnWidthChange(q,w);return w?q:undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.ME.DerivedMetricOptions");mstrmojo.requiresDescs(2140);var B=mstrmojo.array;mstrmojo.ME._DerivedMetricEditorHelper=mstrmojo.provide("mstrmojo.ME._DerivedMetricEditorHelper",{isDME:true,noCache:false,closeLabel:mstrmojo.desc(2140,"Cancel"),saveAsEnabled:false,tbBrowsable:false,init:function C(D){this._super(D);},onApplyMetricCallback:mstrmojo.emptyFn,optionPopupRef:{scriptClass:"mstrmojo.ME.DerivedMetricOptions",title:mstrmojo.desc(13035,"Metric Options"),help:"Metric_Options_dialog_box.htm",width:300},replaceAttributeWithForms:function A(E){var D=[];B.forEach(E,function(F){if(F.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Attribute&&F.fs){B.forEach(F.fs,function(G){if(G.obf||F.da){D.push({n:F.n+"@"+G.fnm,did:F.did+"@"+G.fid,fmdid:G.fid,fnm:G.fnm,t:G.t,frm:G,oi:F,path:F.path});}});}else{D.push(F);}});return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.RenameEditor","mstrmojo.func");var C=mstrmojo.func;mstrmojo.vi.ui.editors.RenameDEEditor=mstrmojo.declare(mstrmojo.ui.editors.RenameEditor,null,{scriptClass:"mstrmojo.vi.ui.editors.RenameDEEditor",onRename:function B(G){var H=mstrmojo.vi.ui.editors.DerivedElementsEditor.validateElementName(G);if(H){var F=this.view,E=F.model.docModel,I=this.action,D=this.controller;I.deName=(G)||((I.funcVal===-1)?mstrmojo.desc(5187,"Group"):mstrmojo.desc(5188,"Calculation"));E.addUpdateObjects(I,{id:I.oId,type:I.oTp,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});D.submitUndoRedoTemplateUpdates(F,I,C.wrapMethods(E.getDatasetsUpdateCallback(),E.getUpdateHiddenPanelsCallback(),E.getUpdateHiddenLayoutsCallback(),E.getHighLightNDECallback()));}return H;},destroy:function A(D){delete this.view;delete this.action;delete this.controller;this._super(D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.ui.ScrollableSuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var M=mstrmojo.dom,O=mstrmojo.css,AA=mstrmojo.Enum_Keys,D=mstrmojo.range,c=D.EDGE,r=mstrmojo.ME.MetricToken.isDelimiter,L=mstrmojo.expr,h=mstrmojo.array,H=mstrmojo.hash;function AH(E){return E.ctrlKey||M.isMetaKey(window,E);}mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function N(E){var AI=E.ownerDocument,AJ=AI.createElement("span");return AJ;},_iw2idx:function P(AI,AL,AK){var AJ=this.wrapperNodes(AL),E=mstrmojo.array.indexOf(AJ,AK);return E===-1?AJ.length:E;},itemOffsetLeft:function a(AI,AM,E,AK){if(!AK){var AJ=this.wrapperNodes(AM);AK=AJ&&AJ[E];if(!AK){return 0;}}var AL=AM.firstChild;if(!AL||(AL===AK)){return 0;}return AK.offsetLeft-AL.offsetLeft;},whereDrop:function AG(AQ,E,AK,AP,AI){var AM=this._nd2iw(AQ,E,AK),AR,AO,AL,AN,AJ;if(AM){AO=this._iw2idx(AQ,E,AM);AR=AO;AL=this.itemOffsetLeft(AQ,E,null,AM);AN=AM.offsetTop;AJ=AM.offsetWidth;if(AP.x>AI.left+AL+AJ/2){AR++;AL+=AJ;}}else{return AQ.dropCuePos;}return{left:AL,top:AN,idx:AR,idxActual:AO};}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",containerResizable:false,dropZone:true,suggestionPopupCssClss:"mstrmojo-ME-TokenInputBox-suggest",allowDrop:function C(E){var AI=E.src.data;return !!AI;},ondrop:function(E){E.src.data={v:mstrmojo.ME.MetricToken.brackets(E.src.data.item.n),oi:H.copyProps(["did","n","t"],E.src.data.item),isNew:true};if(this.prepareDropItem){this.prepareDropItem(E);}this.insertTokens([E.src.data]);this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondragenter:function F(E){this.dragdata=E.src.data;this._super(E);this.set("dropCuePos",{left:0,top:0});mstrmojo.css.addClass(this.domNode,"unselectable");},ondragleave:function Q(){this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondropCuePosChange:function S(AI){var AJ=AI.value,E=this.dragdata;if(E&&E.setAvatarClass){if(AJ){E.setAvatarClass("add");}else{E.setInvalidAvatarClass();}}},makeObservable:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"ondragstart = "return false;" oncontextmenu = "document.oncontextmenu =  mstrmojo.all.{@id}.fnContextMenu;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" onpaste = "return mstrmojo.all.{@id}.handlepasteDirect(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.childNodes[1];},scrollboxNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",items:null,itemFunction:function G(AJ,E,AI){return new mstrmojo.ME.MetricToken({data:AJ,parent:AI});},listMapper:mstrmojo.ME.SpanListMapper,_set_items:function R(AI,E){if(this._super){this._super(AI,E);}if(!this.tokensCacheInitilized){this.pretokensModify();this.tokensCacheInitilized=true;}},tokensCache:[],tokensCachePointer:0,isDelimiter:r,postBuildRendering:function X(){if(this._super){this._super();}this._eros=false;if(M.isFF){document.body.spellCheck=false;}},fnContextMenu:function I(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},handlekeydown:function V(AN){AN=AN||window.event;var AL=AN.keyCode||AN.charCode,AJ=false,AO=D.getRangeInfo();if((AH(AN)||AL===AA.LEFT_ARROW||AL===AA.RIGHT_ARROW)&&this.doubleByte){this.doubleByte=false;var AM=this.prev_rInfo,AI=AO,AP=AI.startContainer.data.slice(AM.startOffset,AO.startOffset);this.widgetHandleImeInput(AM,AP);return ;}switch(AL){case AA.DELETE:if(!this.doubleByte){try{this.widgetHandleDelete(AO);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(AK){}AJ=true;}break;case AA.BACKSPACE:if(!this.doubleByte){try{this.widgetHandleBackspace(AO);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(E){}AJ=true;}break;case AA.ENTER:if(this.breakOnEnterKeyDown&&this.breakOnEnterKeyDown()){break;}case AA.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}AJ=true;break;case AA.ESCAPE:this.endTokenSuggestion();AJ=true;break;case 86:if(AH(AN)){this._saveRangeInfo=D.getRangeInfo();if(!this._saveRangeInfo.collapsed){this.widgetHandleDelete(this._saveRangeInfo);this._saveRangeInfo=D.getRangeInfo();}this.clipboardNode.focus();AJ=false;}break;case 89:if(AH(AN)){this.widgetHandleUndoRedo("redo");AJ=true;}break;case 90:if(AH(AN)){this.widgetHandleUndoRedo("undo");AJ=true;}break;case 229:if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=AO;this.prev_items=this.items;}break;default:}if(AJ){M.stopPropogation(window,AN);M.preventDefault(window,AN);return false;}return true;},getCharacter:function AC(AI){var E=(M.isIE&&!M.isIE9)?AI.keyCode:AI.charCode;return(E>0)?String.fromCharCode(E):null;},handlekeypress:function A(AK){AK=AK||window.event;var AL=this.getCharacter(AK),AI=false;if(AL&&!((AL==="c"||AL==="a")&&AH(AK))){try{this.widgetHandleInput(D.getRangeInfo(),AL);this.raiseChangeEvent({type:"input",character:AL});if(!this.isDelimiter(AL)){if(this.useKeyDelay){var AJ=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){AJ.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion(true);}}catch(E){}AI=true;}if(AI){M.stopPropogation(window,AK);M.preventDefault(window,AK);return false;}return true;},handlekeyup:function Y(AJ){var E=AJ.keyCode||AJ.charCode,AI;if(E===AA.LEFT_ARROW||E===AA.RIGHT_ARROW){AI=this.findObjectToken();if(AI&&AI===this._saveActiveToken){this.startTokenSuggestion(AI);}else{this.endTokenSuggestion();}}else{if(E===AA.UP_ARROW){this.preHighlight();}else{if(E===AA.DOWN_ARROW){this.nextHighlight();}}}this._saveRangeInfo=D.getRangeInfo();},handlemouseup:function g(AN){if(this.dropCuePos){return false;}var AJ=this.findObjectToken();if(AJ&&AJ===this._saveActiveToken){this.startTokenSuggestion(AJ);}else{this.endTokenSuggestion();}var AL=D.getRangeInfo();if(this.doubleByte){this.doubleByte=false;var AM=this.prev_rInfo,AK=this._saveRangeInfo,AI=AK.startContainer.data.slice(AM.startOffset,AK.startOffset+1);if(AI!==""){var E=this.widgetHandleImeInput(AM,AI);this.prev_items=this.items;AJ=M.findWidget(AL.startContainer);if(AJ){this._delaySetTextCaretPos(AJ.domNode,AL.startOffset);}else{this._delaySetTextCaretPos(E.domNode,AL.startOffset-1);}}this.prev_rInfo=AL;}this._saveRangeInfo=AL;},handlepasteDirect:function w(E){this.clipboardNode.value=E.clipboardData.getData("Text");this.handlepaste(E);M.stopPropogation(window,E);M.preventDefault(window,E);return false;},handlepaste:function e(AM){var AI=this.clipboardNode.value;this.clipboardNode.value="";var AL=[],E=AI&&AI.length,AK,AJ="",AN;if(E>0){for(AK=0;AK<E;AK++){AN=AI.charAt(AK);if(this.isDelimiter(AN)){if(!mstrmojo.string.isEmpty(AJ)){AL.push({v:AJ,isNew:true});AJ="";}AL.push({v:AN,isDelimiter:true,isNew:true});}else{AJ=AJ+AN;}}if(!mstrmojo.string.isEmpty(AJ)){AL.push({v:AJ,isNew:true});AJ="";}this.insertTokens(AL);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function AF(){var AI=[],AK=this.items,AJ,E;for(AJ=0,E=AK.length;AJ<E;AJ++){AI[AJ]=AK[AJ].v;}return AI.join("| ");},replaceErrorToken:function k(AK){var AJ=this.items||[],AL=mstrmojo.array.find(AJ,"sta",-1),AI,AM=function(AS,AQ,AT){var AP=(AS&&AS.items)||[],AO=h.find(AP,"did",AQ),AN,AR;if(AO>-1){AN=AP[AO].fs;AR=h.filterOne(AN,function(AU){return AU.fnm&&AU.fnm.toUpperCase()===AT.toUpperCase();});}return AR;},E=function(AS,AQ,AR){var AN={v:AQ.n,oi:AQ,isNew:true},AP=AS.v&&AS.v.split("@"),AO;if(AP&&AP.length>1){AO=AM(AR,AQ.did,AP[1]);if(AO){AN.exv=AO.fmdid||AO.fid;AN.extp=8;AN.v=mstrmojo.ME.MetricToken.brackets(AQ.n)+"@"+AO.fnm;}}return AN;};if(AL>-1){AI=E(AJ[AL],AK,this.candidates);this.remove(AL);this.add([AI],AL);}},widgetHandleDelete:function Z(AL){if(AL.collapsed){var AK,AJ,E,AM=AL.startOffset,AI=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AL.startContainer,false,document.body)){D.collapseOnNode(this.editNode,false);return ;}AK=D.getEdgeInfo(AL.startContainer,AL.startOffset);AJ=M.findWidget(AL.startContainer);E=this.itemIndex(AJ.data);if(AK===c.EDGE_END){E++;AJ=AI[E];AM=0;}if(!AJ){D.collapseOnNode(this.editNode,false);return ;}if(AJ.length()===1){this.remove(E);AJ=AI[E];if(AJ){D.collapseOnNode(AJ.domNode,true);}else{D.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{AJ.spliceContent(AM,1);D.collapseOnTextNode(AJ.domNode,AM);}}else{this.widgetDeleteTokens(AL);}},widgetHandleBackspace:function q(AL){if(AL.collapsed){var AK,AJ,E,AM=AL.startOffset,AI=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AL.startContainer,false,document.body)){if(AL.startOffset>0&&M.isFF){AJ=AI[this.items.length-1];D.collapseOnNode(AJ.domNode,false);AL=D.getRangeInfo();AK=D.getEdgeInfo(AL.startContainer,AL.startOffset);}else{D.collapseOnNode(this.editNode,true);return ;}}AK=D.getEdgeInfo(AL.startContainer,AL.startOffset);AJ=M.findWidget(AL.startContainer);E=this.itemIndex(AJ.data);if(AK===c.EDGE_BEGIN){E--;AJ=AI[E];AM=AJ.length();}if(!AJ){D.collapseOnNode(this.editNode,true);return ;}if(AJ.length()===1){this.remove(E);AJ=AI[E-1];if(AJ){D.collapseOnNode(AJ.domNode,false);this.checkMergeTwoTokens(E-1,E);AJ=AI[E-1];}else{D.collapseOnNode(this.editNode,true);}}else{AJ.spliceContent(AM-1,1);D.collapseOnTextNode(AJ.domNode,AM-1);}}else{this.widgetDeleteTokens(AL);}},widgetHandleInput:function t(AM,AN){if(!AM.collapsed){this.widgetDeleteTokens(AM);AM=D.getRangeInfo();}var AJ,AO,AP,AQ,E,AI,AK=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AM.startContainer,false,document.body)){this.add([{v:AN,isDelimiter:this.isDelimiter(AN),isNew:true}],0);AO=AK[0];D.collapseOnTextNode(AO.domNode,1);return ;}AJ=D.getEdgeInfo(AM.startContainer,AM.startOffset);AO=M.findWidget(AM.startContainer);AP=this.itemIndex(AO.data);if(this.isDelimiter(AN)){AQ={v:AN,isDelimiter:true,isNew:true};if(AJ===c.EDGE_MIDDLE){var AL=AO.split2Tokens(AM.startOffset);this.remove(AP);this.add([AL[0],AQ,AL[1]],AP);AP=AP+1;}else{AP=(AJ===c.EDGE_BEGIN)?AP:AP+1;this.add([AQ],AP);}AO=AK[AP];D.collapseOnNode(AO.domNode,false);}else{AI=AM.startOffset;if(AO.isDelimiter()){E=AK[(AJ===c.EDGE_BEGIN)?AP-1:AP+1];if(E&&!E.isDelimiter()){AO=E;AI=(AJ===c.EDGE_BEGIN)?AO.length():0;}}if(!AO.isDelimiter()){AO.spliceContent(AI,0,AN);D.collapseOnTextNode(AO.domNode,AI+1);}else{this.add([{v:AN,isNew:true}],(AJ===c.EDGE_BEGIN)?AP:AP+1);AO=AK[(AJ===c.EDGE_BEGIN)?AP:AP+1];D.collapseOnNode(AO.domNode,false);}}},widgetHandleImeInput:function t(AL,AM){if(!AL.collapsed){this.widgetDeleteTokens(AL);AL=D.getRangeInfo();}var AJ,AN,AO,AP,E,AI,AK=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AL.startContainer,false,document.body)){this.clearTokens();this.add([{v:AM,isDelimiter:this.isDelimiter(AM),isNew:true}],0);AK=this.ctxtBuilder.itemWidgets;AN=AK[0];D.collapseOnTextNode(AN.domNode,1);this._delaySetCaretPos(AN.domNode,false);return ;}AJ=D.getEdgeInfo(AL.startContainer,AL.startOffset);AN=M.findWidget(AL.startContainer);AO=this.itemIndex(AN.data);AI=AL.startOffset;if(AN.isDelimiter()){this.clearTokens();this.set("items",this.prev_items);AK=this.ctxtBuilder.itemWidgets;E=AK[(AJ===c.EDGE_BEGIN)?AO-1:AO+1];if(E&&!E.isDelimiter()){AN=E;AI=(AJ===c.EDGE_BEGIN)?AN.length():0;}}if(!AN.isDelimiter()){AN.spliceContent(AI,0,AM);this._delaySetTextCaretPos(AN.domNode,AI+AM.length);}else{this.add([{v:AM,isNew:true}],(AJ===c.EDGE_BEGIN)?AO:AO+1);AN=AK[(AJ===c.EDGE_BEGIN)?AO:AO+1];this._delaySetCaretPos(AN.domNode,false);}this.startTokenSuggestion();return AN;},findObjectToken:function B(){var AL=D.getRangeInfo(),AJ=M.findWidget(AL.startContainer);if(!M.contains(this.editNode,AL.startContainer,false,document.body)){return null;}if(!AJ||AJ===this||!AJ.isDelimiter){return null;}if(AJ&&!AJ.isDelimiter()){return AJ;}var AK=D.getEdgeInfo(AL.startContainer,AL.startOffset),AI=this.ctxtBuilder.itemWidgets,E=this.itemIndex(AJ.data);AJ=AI[(AK===c.EDGE_BEGIN)?E-1:E+1];if(AJ&&!AJ.isDelimiter()){return AJ;}return null;},checkMergeTwoTokens:function o(AL,AJ){var AK=this.ctxtBuilder.itemWidgets,AI=AK[AL],E=AK[AJ];if((AI&&!AI.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([AL,AJ]);this.add([AI.mergeTo(E)],AL);D.collapseOnTextNode(AK[AL].domNode,AI.length());}},insertTokens:function v(AO){var E=0,AI=this.editNode;var AN=this._saveRangeInfo||D.getRangeInfo();if(!AN||!M.contains(AI,AN.startContainer,false,document.body)){this.add(AO);E=this.items.length-1;this._delaySetTextCaretPos(AI,(AI.innerText||AI.textContent).length);}else{var AM=D.getEdgeInfo(AN.startContainer,AN.startOffset),AJ=M.findWidget(AN.startContainer);E=this.itemIndex(AJ.data);if(AM===c.EDGE_MIDDLE){var AL=AJ.split2Tokens(AN.startOffset);this.remove(E);AO.unshift(AL[0]);AO.push(AL[1]);this.add(AO,E);}else{E=(AM===c.EDGE_BEGIN?E:E+1);this.add(AO,E);}E=E+AO.length-1;AJ=this.ctxtBuilder.itemWidgets[E];this._delaySetCaretPos(AJ.domNode,false);}this.raiseChangeEvent({type:"insert"});var AK=this;window.setTimeout(function(){AK._saveRangeInfo=D.getRangeInfo();},50);return E;},insertParenthesisTokens:function z(AI){var E=this;window.setTimeout(function(){var AJ=E.insertTokens([{v:"(",isDelimiter:true,isNew:true},{v:")",isDelimiter:true,isNew:true}]);E._delaySetTextCaretPos(E.itemsContainerNode.childNodes[AJ]);},AI||50);},clearTokens:function n(E){this.set("items",E||[]);this._saveRangeInfo=null;this._delaySetCaretPos(this.editNode,false);},focus:function u(){var AI=this.ctxtBuilder.itemWidgets,E=AI.length;this._delaySetCaretPos(E>0?AI[E-1].domNode:this.editNode,false);},startTokenSuggestion:function AB(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length===0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[L.TP.FOLDER,L.TP.FACT,L.TP.ATTR,L.TP.FUNCTION,L.TP.FILTER,L.STP.PROMPT_OBJECTS,L.TP.ATTR,L.TP.DIM,L.TP.METRIC,L.TP.ROLE].join(","),getSearchPattern:function U(){var AI=this._saveActiveToken,AK=AI&&AI.data.v,E=AK&&AK.length;if(E>2){if(AK.charAt(0)==="["){AK=AK.substring(1);}if(AK.charAt(AK.length-1)==="]"){AK=AK.substring(0,AK.length-1);}}if(AI&&AI.data.ift){var AJ=AI.data.v,AL=AJ&&AJ.indexOf("@");if(AL>=0){AK=AJ.substring(AL);}}return AK||"";},getSuggestionPos:function b(){var E=this._saveActiveToken,AI=null,AK,AJ;if(E){AK=E.data&&E.data.ift;AJ=mstrmojo.dom.position(E.domNode,true);AI={left:Math.round(AJ.x+(AK?AJ.w:0))+"px",top:Math.round(AJ.y+AJ.h)+"px",zIndex:100};}return AI;},item2textCss:function J(AI){var E=(this._super&&this._super(AI))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr",21:"afm","-99":"br"}[AI.t]||"";E+=AI.da?" da":"";E+=(AI.dm||AI.um)?" dm":"";E+=AI.de?" de":"";E+=AI.fs&&AI.fs.length&&AI.fs.some(function(AJ){return AJ.fgr>0;})?" g":"";return E;},onBrowserOpen:function p(){this.editNode.blur();},onSuggestionItemSelect:function x(AI){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){if(E.data.ift&&AI.t===21){E.setFormInfo(AI);}else{E.setItemInfo(AI);if(AI.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){this.insertParenthesisTokens();}}this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function AD(E,AJ){var AI=this.editNode,AK=this,AL=function(){AI.focus();AI.focus();D.collapseOnNode(E,AJ);AK._saveRangeInfo=D.getRangeInfo();};window.setTimeout(AL,0);},_delaySetTextCaretPos:function AD(E,AL){var AI=this.editNode,AJ=this,AK=function(){AI.focus();AI.focus();D.collapseOnTextNode(E,AL);AJ._saveRangeInfo=D.getRangeInfo();};window.setTimeout(AK,0);},getCandidatesThroughTaskCall:function W(AI,E){AI.objectType="11,12,13,43,4";AI.rootFolderType=39;AI.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AI,E);},filterCandidates:function m(AL,AK,E){var AI=this._saveActiveToken,AM=AI&&(AI.data.oi||AI.data.at),AJ;if(AM&&AI.data.ift){E=E||this.suggestCount;AK=mstrmojo.string.regEscape(AK);AJ=h.filter(AL,function(AN){return AN.t===21&&AN.attid===AM.did&&(new RegExp("^"+AK,"i")).test("@"+AN.n);},{max:E});}else{AJ=h.filter(AL,function(AN){return AN.t!==21;});AJ=this._super(AJ,AK,E);}return AJ;},endTokenSuggestion:function AE(AI){var E=this._saveActiveToken;if(E){if(AI){this.hideSuggestion();}E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function f(AQ){var AI=AQ.startOffset,E=AQ.endOffset,AT=M.findWidget(AQ.startContainer),AR=M.findWidget(AQ.endContainer),AM=this.itemIndex(AT.data),AK=this.itemIndex(AR.data),AN=[],AO=D.getEdgeInfo(AQ.startContainer,AI),AS=D.getEdgeInfo(AQ.endContainer,E),AP=(AO===c.EDGE_BEGIN?AM:AM+1),AJ=(AS===c.EDGE_END?AK:AK-1),AL;if(AT===AR){if((AO===c.EDGE_BEGIN)&&(AS===c.EDGE_END)){this.remove(AM);AR=this.ctxtBuilder.itemWidgets[AM===0?AM:AM-1];if(AR){D.collapseOnNode(AR.domNode,AM===0);}else{D.collapseOnNode(this.editNode,true);}}else{AT.spliceContent(AI,E-AI);D.collapseOnTextNode(AR.domNode,AI);}}else{for(AL=AP;AL<=AJ;AL++){AN.push(AL);}this.remove(AN);if(AO===c.EDGE_MIDDLE){AT.spliceContent(AI);}if(AS===c.EDGE_MIDDLE){AR.spliceContent(0,E);}if(AO===c.EDGE_BEGIN){AT=this.ctxtBuilder.itemWidgets[AM===0?AM:AM-1];}if(AT){D.collapseOnNode(AT.domNode,AM===0);}else{D.collapseOnNode(this.editNode,false);}AM=(AO===c.EDGE_BEGIN)?AM-1:AM;this.checkMergeTwoTokens(AM,AM+1);}this.editNode.focus();},oncandidatesChange:function l(){var AI=this.candidates,E=(AI&&AI.items)||[];if(!this.noCache&&AI&&AI.isComplete){this.suggestCount=this.REQUEST_THRESHOLD=E.length;}else{this.suggestCount=mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=20;}},nudge:function(E){var AI=this.getSuggestionPos();if(AI){E.set("left",AI.left);E.set("top",AI.top);}},pretokensModify:function K(){this.tokensCache=this.tokensCache.slice(0,this.tokensCachePointer);var E=this.findObjectToken();this.tokensCache.push({items:H.clone(this.items),rInfo:D.getRangeInfo(),idx:E!==null?this.itemIndex(E.data):-1});this.tokensCachePointer=this.tokensCache.length;},widgetHandleUndoRedo:function d(AJ){var AK,E,AI=function(AM){if(!AM){return ;}AM=AM||{};this.set("items",H.clone(AM.items));var AP=this.ctxtBuilder.itemWidgets,AL=AP[AM.idx],AO=AL&&AL.domNode||this.editNode,AN=AM.rInfo;this._delaySetTextCaretPos(AO,AN&&AN.startOffset||0);};switch(AJ){case"undo":AK=--this.tokensCachePointer;if(AK>-1){E=this.tokensCache[AK-1];AI.call(this,E);}else{this.tokensCachePointer=1;}break;case"redo":AK=this.tokensCachePointer++;if(AK>-1&&AK<this.tokensCache.length){E=this.tokensCache[AK];AI.call(this,E);}else{this.tokensCachePointer=Math.min(Math.max(this.tokensCachePointer,1),this.tokensCache.length);}break;}},resetTokensCache:function T(){this.tokensCache=[];this.tokensCachePointer=-1;this.tokensCacheInitilized=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:G.noCache?-1:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});}}));mstrmojo._ValidateSuggestions.ENUM_STATES={UNDETERMINED:F,VALID:E,INVALID:D};}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.Enum_Keys","mstrmojo.hash","mstrmojo.dom");var F=mstrmojo.dom,B=mstrmojo.Enum_Keys,I=200,P;var O={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var Q="mstrmojo-SimpleObjectInputBox-del";function K(){var Y=this.inputBox,Z=Y.value;if(Z!==this._lastPattern&&Z!==""){this.showSuggestion(Z);}this._lastPattern=Z;delete this._timerHandle;}function X(){var Y=this._timerHandle;if(Y){window.clearTimeout(Y);delete this._timerHandle;}}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur style="display: none;" /></div><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@emptyText}</div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},emptyTextNode:function(){return this.domNode.childNodes[1];},inputBox:function(){return this.domNode.firstChild.lastChild;},scrollboxNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function T(){var Y=this.maxItemWidth;if(!isNaN(Y)&&Y>0){this.emptyTextNode.style.maxWidth=Y+"px";}}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,maxObjectCount:null,useRichTooltip:true,showTooltip:function D(Z,c){var b=Z.target||F.eventTarget(Z.hWin,Z.e),a=this.getItemFromTarget(b);if(a&&a.n){var d=this.getItemNodeFromTarget(b).firstChild,Y=F.position(d);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPCENTER,cssClass:"vi-regular vi-tooltip-A A-center",refNode:d,content:mstrmojo.string.encodeHtmlString(a.n),top:Y.h+11,left:Y.w/2};this._super(Z,c);}},getItemMarkup:function(Y){if(!P){var Z=this.itemField;P=this._super(Y).replace(">{@en@n}<",'"><div class="elem">{@'+Z+'}<div class="'+Q+'"></div></div><');}return P;},getItemProps:function U(b,Y){var Z=this._super(b,Y),c=this.itemField;Z[c]=b[c];var a=this.maxItemWidth;if(!isNaN(a)&&a>0){a=(a-24)+"px";}Z.addStyle("max-width:"+a);return Z;},getSuggestionPos:function N(){var Y=this._inputPos;return{target:this.inputBox,left:Y.x+"px",top:Y.y+Y.h+"px",zIndex:100};},getSearchPattern:function W(){return this.inputBox.value;},onSuggestionItemSelect:function G(Y){X.call(this);this.set("items",this.items.concat(Y));this._super();var Z=this.id;window.setTimeout(function(){var a=mstrmojo.all[Z];if(parseInt(a.state,10)!==O.FULL){a.set("state",O.ADDING);}},0);},onstateChange:function A(Z){var a=Z.value;this.emptyTextNode.style.display=(a===O.EMPTY)?"block":"none";this.itemsContainerNode.style.display=(a===O.EMPTY)?"none":"block";var Y=this.inputBox,b=Y.style;if(a===O.ADDING){b.display="";this.updateScrollbars();Y.focus();this._inputPos=F.position(Y,true);}else{X.call(this);b.display="none";Y.value="";this._lastPattern="";this.updateScrollbars();}},postBuildRendering:function R(){I=mstrApp.getSearchAutoCompleteDelay&&mstrApp.getSearchAutoCompleteDelay()||I;this.state=0;this.setDefaultState();return this._super();},preitemsChange:function M(){this.setDefaultState();},onclick:function V(Z){var c=F.eventTarget(Z.hWin,Z.e);if(c&&c.className===Q){var b=F.findAncestorByAttr(c,"idx",true,this.domNode),Y=b&&parseInt(b.value,10);this.hideTooltip();if(Y!==null&&!isNaN(Y)){var a=this.items.concat();a.splice(Y,1);this.set("items",a);}return ;}if(parseInt(this.state,10)!==O.FULL){this.set("state",O.ADDING);}},onblur:function E(){X.call(this);if(!this.suggestionShown){this.setDefaultState();}},prekeydown:function C(Y){var b=Y.e;switch(parseInt(b.keyCode||b.charCode,10)){case B.DOWN_ARROW:this.nextHighlight();break;case B.UP_ARROW:this.preHighlight();break;case B.TAB:case B.ENTER:F.preventDefault(Y.hWin,b);var a=this.getSelected();if(a){this.handleSuggestionItemSelect(a);}else{this.hideSuggestion();this.setDefaultState();}break;case B.ESCAPE:X.call(this);this.hideSuggestion();this.setDefaultState();break;case B.BACKSPACE:if(!this.getSearchPattern()){F.preventDefault(Y.hWin,b);var Z=this.items&&this.items.concat();if(Z&&Z.length){Z.splice(Z.length-1,1);mstrApp.ignoreBackSpace=true;this.set("items",Z);var c=this.id;window.setTimeout(function(){mstrmojo.all[c].set("state",O.ADDING);mstrApp.ignoreBackSpace=false;},0);}}break;}},prekeyup:function H(Y){if(!this.getSearchPattern()){F.preventDefault(Y.hWin,Y.e);this.hideSuggestion();}if(this.useKeyDelay){var Z=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){K.call(mstrmojo.all[Z]);},I);}}else{K.call(this);}},widgetResized:function L(){if(this.hasRendered){var Z=parseInt(this.width,10),a=this.items.length,b=this.itemsContainerNode.childNodes;if(a<=b&&b.length){for(var Y=0;Y<a;Y++){b[Y].style.maxWidth=Z-24+"px";}}if(this.emptyTextNode){this.emptyTextNode.style.maxWidth=Z+"px";}this.updateScrollbars();}},setupScrollNodes:function J(){this.scrollNode=this.scrollboxNode;},setDefaultState:function S(){var a=this.maxObjectCount,Y=(this.items&&this.items.length)||0,Z=(a!==null&&a!==undefined&&Y>=a);this.set("state",!Y?O.EMPTY:(Z?O.FULL:O.DEFAULT));}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.num","mstrmojo._HasOwnAvatar","mstrmojo.XtabBase","mstrmojo.models.template.DataInterface");var V=mstrmojo.array,E=mstrmojo.dom,P=mstrmojo.num,T=mstrConfig,H="px",B="xrsz",L=3,Q=mstrmojo.XtabBase.EnumLockedHeaders,S=Q.ROW,X=Q.BOTH;function I(){var Y=this.gridData.gts;return Y.row.concat(Y.col);}function M(){var r=this.gridData,d=this.lockHeadersCase,b=r.gts,k=r.ghs,Y=k.rhs||[],o=k.chs||[],n=Y.cws||[],t=(b.cws||[]).concat(o.cws||[]),m=r.gvs||[],l=n.concat(m.cws||[]),q=this.zone.domNode.getElementsByTagName("tr"),p=q&&q[q.length-1],e=false;if(p){var Z=p.getElementsByTagName("td")[0];r.xrh=(Z&&Z.offsetHeight)||0;}e=V.some(n,function(u){return u.w==="";});if(r.afw||r.afc||e){var h=this.rszmap;if(h.length){var c={left:0};V.forEach(h,function(v,u){if(t[u]){t[u].w=l[u].w=(v.left-c.left)+H;}c=v;});}else{var a=Math.max(t.length,l.length);V.forEach(q,function(u){var v=u.childNodes;if(v.length===a){V.forEach(u.getElementsByTagName("td"),function(x,w){if(t[w]){t[w].w=E.position(x).w+H;}if(l[w]){l[w].w=E.position(x).w+H;}});return false;}});}}else{if(d===S||d===X){var g=n.length;l[g].clr=t[g].clr=true;}}if(l.length!==t.length){var f=I.call(this);V.forEach(f,function(z,u){var v=z.fs,AA=(v&&v.length)||0;if(AA>1){var w=t[u],x;for(x=0;x<AA-1;x++){t.splice(u+x+1,0,w);}}});if(l.length>t.length){t.push(l[l.length-1]);}}return{top:t,bottom:l};}function R(){var d=this.rszmap=[],a=0,c=0,b=this.gridData.twm=M.call(this),Z=b.bottom,Y=new mstrmojo.models.template.DataInterface(this.gridData),e=Y.getColumnHeaderData().length;V.forEach(Z,function(h,f){if(f>=e){return false;}var g=parseInt(h.w,10);c=h.clr?0:c;a+=g;c+=g;if((E.isChrome||E.isSafari)&&f===e-1){a=a-1;c=c-1;}d.push({left:a,offsetLeft:c});});V.forEach(d,function(o,f){var k=d[f+1],h=(k&&k.left),g=(h-o.left),n=[this.zone.domNode],l=this.getColClonedZone&&this.getColClonedZone();if(l){n.push(l);}if(!k||(g>(L*2))){V.forEach(n,function m(q){var t=document.createElement("div"),p=t.style,r=this;t.setAttribute("idx",String(f));t.className=B+((f>0&&d[f-1].skipped)?" zero":"");p.left=isNaN(o.offsetLeft)?"":((o.offsetLeft-L)+H);q.appendChild(t);t.ondblclick=function(u){r.onHandleDblClick(u);};},this);}else{o.skipped=true;}},this);}mstrmojo.rw.xtab._XtabColResize=mstrmojo.provide("mstrmojo.rw.xtab._XtabColResize",{_mixinName:"mstrmojo.rw.xtab._XtabColResize",rszmap:undefined,preWidth:0,onRender:function G(){if(this._super){this._super();}if(this.gridData.eg!==undefined){return ;}var Y=this;window.setTimeout(function(){if(!Y.hasRendered){return ;}R.call(Y);Y.raiseEvent({name:"xtabColsMeasured"});},0);E.attachMarkupEvent(this.id,this.domNode,"mousedown");},unrender:function U(Z){E.detachEvent(this.domNode,"mousedown",mstrmojo.emptyFn);if(this.scrollboxNode&&this.scrollboxNode.style&&this.scrollboxNode.style.width){var Y=this.scrollboxNode.style.width;this.preWidth=Y.indexOf("px")>0?parseInt(Y,10):0;}this._super(Z);},gridPagesRendered:function A(){if(this._super){this._super();}},isColResizeNode:function O(Y){return(Y.className||"").indexOf(B)>=0;},isDragValid:function C(Y){return this.isColResizeNode(Y.src.node)||(this._super&&this._super(Y))||false;},ondragstart:function W(b){if(this.isColResizeNode(b.src.node)){var a=E.position(this.domNode),d=E.findAncestorByAttr(b.src.node,"idx",true,this.domNode),Z=d&&parseInt(d.value,10),e=this.rszmap,f=e[Z].left-(Z>0?e[Z-1].left:0),c=Math.max(a.x,(b.src.pos.x-f)),Y=new mstrmojo.models.template.DataInterface(this.gridData);this.rszData={idx:Z,originalWidth:f,min:c,max:a.x+a.w,colName:Y.getColumnHeaderData()[Z].n};}if(this._super){this._super(b);}this.ignoreHover=true;},ondragmove:function K(a){if(this.rszData){var Z=this.rszData,Y=a.src.pos,b=Math.max((Z.originalWidth+(a.tgt.pos.x-Y.x)),0);this.avatar.firstChild.innerHTML=Z.colName+" "+((P.UNIT.PX==T.units)?b:parseFloat(P.convertUnits(P.UNIT.PX,T.units,b)).toFixed(2))+" "+T.unitsLabel;}this._super(a);},ondragend:function F(c){if(this.rszData){var b=this.gridData,a=this.rszData.idx,e=(new mstrmojo.models.template.DataInterface(b)).getColumnHeaderData(),f=e[a],Z=f.fs,Y=f.fix||1;if(Z&&Z.length>0){Y=a-V.find(e,"id",f.id)+1;}var d=f.oid||f.id;this.changeColumnWidth(d,f.otp,Math.max((parseInt(M.call(this).bottom[a].w,10)+(c.tgt.pos.x-c.src.pos.x)),0),Y,(d===""&&f.axis===2));delete this.rszData;}this._super(c);this.ignoreHover=false;},createAvatar:function N(c){var e=document.createElement("div"),Z=e.style,Y=E.position(c),b=E.position(this.domNode);if(this.isColResizeNode(c)){this.avatarCssClass=B;Z.top=b.y+H;Z.left=Y.x+H;Z.height=b.h+H;var d=document.createElement("div");d.className=B+"-ttp";var a=document.createElement("div");a.className=B+"-anchr";e.appendChild(d);e.appendChild(a);}else{delete this.avatarCssClass;}return e;},positionAvatar:function J(c,a){if(this.rszData){var Z=this.avatar,b=Z.style,Y=this.rszData;if(!this.avatar||!this.rszData){return ;}b.left=Math.min(Math.max(c.x,Y.min),Y.max)+"px";}else{this._super(c,a);}},preBuildRendering:function D(){if(!this.widthLimit&&this.preWidth){this.widthLimit=this.preWidth;}this._super();if(this.scrollboxNodeCssText.indexOf("width")===-1&&this.preWidth>0){this.scrollboxNodeCssText+="width:"+this.preWidth+"px;";}},onHandleDblClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode");mstrmojo.threshold.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,null,{scriptClass:"mstrmojo.threshold.AndOrNode",cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);},consolidate:function A(){if(this.parent!==this.tree||this.itemCnt===0){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetTree","mstrmojo.expr","mstrmojo.AndOrNode","mstrmojo.ConditionNode");var F=mstrmojo.expr,B=F.ET;function A(G){var I=G&&G.src,J=I&&I.data,H=J&&J.et;return(H in F.ETs);}mstrmojo.FilterExpr=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.FilterExpr",allowDrop:A,renderOnScroll:false,itemIdField:null,nodeClassMap:{14:mstrmojo.AndOrNode,"*":mstrmojo.ConditionNode},onBlankClick:function(G){this.clearTreeSelect();},onnodemousedown:function(H){var I=mstrmojo.dom.eventTarget(H.hWin,H.e),J=H.src,G=J.listMapper.findIndex(J,J.itemsContainerNode,I),K=G>=0?J.ctxtBuilder.itemWidgets[G]:null;if(!K||(K.isSelectableArea&&!K.isSelectableArea(I))){this.onBlankClick(H);}},getItemIdentityProp:function(G){return G.et;},itemFunction:function(L,I,M){var H=M.tree,J=H.getItemConfig(L,I,M),K=H.nodeClassMap,G=K[H.getItemIdentityProp(L)]||K["*"];return G&&(new G(J));},getItemConfig:function(J,G,K){var H=(J.et===B.ANDOR),I=K.tree||K;return{data:J,tree:I,parent:K,bindings:{prefixedAndOrEditable:"this.parent.editable"},itemFunction:(H)?K.itemFunction:null,draggable:H?I.draggable:false,dropZone:H?I.dropZone:false,allowDrop:H&&I.dropZone?I.allowDrop:null,allowCopy:H?I.allowCopy:false,editable:I.isEditable?I.isEditable(J):I.editable,makeObservable:H&&K.makeObservable,onclick:I.onnodeclick,onadd:I.onnodeadd,onremove:I.onnoderemove};},getDragData:function(G){var I=this._super(G);if(I&&!I.html){var H=I.et&&F.ET2TGT[I.et];I.html=H?I[H]&&I[H].n||"":I.n||"";}return I;},newCondition:function E(K){K=K||{et:B.AQ};var J=this.selectionParentNode,G;J=(J&&J.hasRendered)?J:this;if(J!==this){G=J.add([K]);}else{var I=this.addCondition([K],null,true);G=I.index;J=I.widget;}var H={widget:J,index:G,data:K};if(this.onNew){this.onNew(H);}return H;},addCondition:function D(I,K){var L=this.items,H=L&&L.length,N=I&&I.length;if(!N){return null;}var J,G;if(H&&L[0].et===B.ANDOR){J=this.ctxtBuilder.itemWidgets[0];G=J.add(I,null);}else{if(!H&&(N===1)){J=this;G=0;this.add(I,0);}else{if(H){var M=L[0];this.remove(M);I.unshift(M);}this.add([{et:B.ANDOR,fn:F.FN.AND,nds:I}],0);J=this.ctxtBuilder.itemWidgets[0];G=H?1:0;}}return{widget:J,index:G};},addSingleCondition:function C(H,G){var I=this.addCondition([H],G);return I.widget.ctxtBuilder.itemWidgets[I.index];},ondrop:function(J){if(this._super){this._super(J);}var H=this.items,G=H&&H.length,I=H.concat();if(G>1){if(H.remove){H.remove(0,H.length);}else{this.set("items",null);}this.add([{et:B.ANDOR,fn:F.FN.AND,nds:I}],0);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.expr","mstrmojo.dom","mstrmojo.array","mstrmojo.css");var L=mstrmojo.expr,N=mstrmojo.dom,C=mstrmojo.array,A=mstrmojo.css,F=mstrmojo.fe._IsRelationTreeNode.createSetHtml;var M=function(){var T="noRelationOperator",P=this[T],R=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],S=mstrmojo.array.filter(R,function(U){return U&&U[T]!==P&&U.data.et!==L.ET.RLS;}),O=S.length;for(var Q=0;Q<O;Q++){S[Q].set(T,P);}};mstrmojo.fe.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.AndOrNode",markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',getPrefixAndOrToolsMarkup:function(){return(F+this._super());},markupSlots:mstrmojo.hash.copy({createSetNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupSlots)),markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){A.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupMethods)),removeSet:function G(P){var O=P.childIndex(),Q=P.data,R=[Q];if(O>=0){this.remove(O,true);if(Q.nds&&Q.nds.length>0){R=Q.nds;if(Q.not){R[0].not=true;}}else{delete Q.dmy;delete Q.relation;delete Q.applySubExpr;delete Q.relation;delete Q.useSchema;delete Q.dmt;}this.add(R,O);this.consolidate(false);}},createSet:function E(Q,O){var P=this._ndsToMove(this,Q);if(!P){return ;}this.remove(P.idxs,true);var U=P.nds,T;if(U){if(U.length>1){var S={et:L.ET.ANDOR,nds:U};S.fn=this.data.fn;U=[S];T=S.nds[0].not;}else{var V=U[0];if(V&&V.not&&V.et===L.ET.ANDOR){T=V.not;delete V.not;}}}if(O&&O.rq){var R;if(O.isMetric){R=O.cq;mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],O.rq,R);}else{R=O.rq;R.nds=U;if(T){R.not=T;}}this.add([R],P.idxs[0]);}this.consolidate(false);},preclick:function H(O){var R=null,Q=N.eventTarget(O.hWin,O.e),P=this._super(O);if(N.contains(this.createSetNode,Q,true)&&!this.noRelationOperator){R="createSetOpt";}O.part=R||O.part;return P;},preadd:function I(O){if(this._super){this._super(O);}this.updateRelationOperator();},preremove:function K(O){if(this._super){this._super(O);}this.updateRelationOperator();},consolidate:function B(){this._super();this.updateRelationOperator();},postBuildRendering:function J(){var O=this._super();this.updateRelationOperator();return O;},updateRelationOperator:function D(){var O=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],P=!!C.filterOne(O,function(R){return R&&(R.data.et===L.ET.RLS||(R.data.et===L.ET.ANDOR&&R.noRelationOperator));}),Q=this.parent;this.set("noRelationOperator",P);M.call(this);if(Q&&Q.hasRendered&&Q.updateRelationOperator){Q.updateRelationOperator();}},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",browserNodeClass:mstrmojo.TreeBrowserNode,blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st]||"";},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(J){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",J?Math.min(J,this.blockCount):this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField]||[],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<N){L.push(J.nextItemCreaterFunc(N-P-O+1));}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;if(J.onNodeExpand){J.onNodeExpand(K);}},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.contentRetrieved=true;K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){var J=this;setTimeout(function(){J.getContent(J);},0);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new J.browserNodeClass({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(T){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(T);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=T.added,P=T.removed,Q=[],L=[],K=T.src,N,M,O,U;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,U=S&&S.length;M<U;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}var J=this.selectionParentNode;return J&&J.getSelectedItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.hash","mstrmojo.func","mstrmojo.css","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.mstr.ui.IncFetchOBList");var O=mstrmojo.hash,W=mstrmojo.func,L=mstrmojo.meta.TP,F="5CECE58CC1D549F890EB61C4DB2156A3",T="E0CCB9CF22104A489CBE78D974AFD19E",Q=mstrmojo.chart.model.enums.EnumDSSObjectType,K=mstrmojo.array,D=mstrmojo.dom,X=function(f,g,a){var d=f.scrollableIncFetch,c=d?"mstrmojo.mstr.ui.IncFetchOBList":"mstrmojo.OBList",e={scriptClass:c,items:g.items,multiSelect:a};if(d){e.browseConfig={blockBegin:g.bb,blockCount:g.bc,totalSize:g.sz,folderLinksContextId:f.folderLinksContextId,rootFolderID:g.did,browsableTypes:f.browsableTypes,browsableViewMedias:f.browsableViewMedias,dataProvider:f.dataProvider};e.onwaitingChange=function(){if(f.booklet){f.booklet.set("waiting",this.waiting);}};}var b=mstrmojo.insert(e);b.render();return b;},A=function(c,d,a){var b=mstrmojo.ObjectBrowser.widgetHandler||X;return b(c,d,a);},N={success:function(c){var d=this.ob,b=c.items,e=d.pageCache[d.currentPage],a=e._w;e.items=b;a.set("items",b);this.ob=null;this.item=null;window.clearTimeout(d._btm);d.booklet.set("waiting",false);if(d.scrollableIncFetch&&a.scrollNode){a.initScroll();a.updateScrollbars();}},failure:function(a){window.alert(a.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},S=function(f,e,c){var d=c?-1:1,b=f.pageCache.length,g;for(g=f.currentPage+d;g<b&&g>=0;g+=d){var a=f.pageCache[g];if(a._k===e.k){return{steps:g-f.currentPage,cache:a};}}return null;},C=function(e,d,c,f){var g=e.currentPage+1,b=e.pageCache.length,a;for(a=g;a<b;a++){e.pageCache[a]._w.destroy();delete e.pageCache[a].items;}e.pageCache=e.pageCache.slice(0,g);f._w=c;f._k=d.k;e.pageCache[g]=f;e.cacheChange();},H=function(b){var a=mstrmojo.hash.walk("anc.items.0.items",b);this.set("canGoUp",!(!b.pf||!a));},I=function(e,d,f,c,b){delete e._btm;var a;if(!c){a=A(e,f,e.multiSelect);a.attachEventListener("change",e.id,"navigate");if(e.useDblSelect||e.useBothSglDblSelect){a.attachEventListener("dblclick",e.id,"dblselect");}}else{a=f._w;}e.obList=a;e.booklet.turn(a,b>0);window.setTimeout(function(){e.onBrowsing=false;},300);if(!c){C(e,d,a,f);}e.set("currentFolder",f);e.set("currentPage",e.currentPage+b);e.updateUpButton(f);if(e.scrollableIncFetch&&a.scrollNode){a.initScroll();a.updateScrollbars();}},P=function(c,b,a){var d=S(c,b,false);d=d||S(c,b,true);if(!d){window.clearTimeout(c._btm);c._btm=window.setTimeout(function(){c.booklet.set("waiting",true);},300);a.ob=c;a.item=b;c.getDataProvider().fetchFolderContents(c,b,a);}else{I(c,b,d.cache,true,d.steps);}},B=function(b,c,d,a){P(b,{fid:b.pageCache[b.currentPage].did,blockBegin:c,searchPattern:d,recursive:a},N);},J={success:function(b){var c=this.ob;if(c){window.clearTimeout(c._btm);if(!b.items){b.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var a=function e(f){var k=f.length,g;for(g=0;g<k;g++){var h=f[g];if(h.did===F||h.did===T){h.n=(h.did===F)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(h.items){a(h.items);}}};if(b.did===F||b.did===T){b.n=(b.did===F)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(b.anc&&b.anc.items){a(b.anc.items);}}if(b&&b.items&&c.browsableViewMedias){var d={};K.forEach(c.browsableViewMedias.split(","),function(f){d[parseInt(f,10)]=true;});b.items=K.filter(b.items,function(f){return(f.t!==Q.DssTypeDocumentDefinition)||d[f.dvm];});}if(b&&b.items&&mstrApp&&mstrApp.isSingleTier){b.items=K.filter(b.items,function(f){return(f.st!==772);});}if(b.did&&this.item.k!==b.did){this.item.k=b.did;}I(c,this.item,b,false,1);this.ob=null;this.item=null;}},failure:function(a){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(a);}else{if(a.getResponseHeader){mstrmojo.alert(a.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{mstrmojo.alert(a.message);}}},complete:function(){if(this.ob){this.ob.onBrowsing=false;}}},Z=function(c){var b=c.pageCache.length,a;for(a=0;a<b;a++){c.pageCache[a]._w.destroy();}c.pageCache=[];c.currentPage=-1;c.cacheChange();},M=function(d,c,e){var a=d.onBrowseFolder;if(a){a[0][a[1]](c);}if(c&&parseInt(c.acg,10)===33){return ;}var b={};if(c){b.k=c.did;b.fid=c.did;}else{if(d.rootFolderID){b.k=d.rootFolderID;b.fid=d.rootFolderID;}else{if(d.rootFolderType){b.k=d.rootFolderType;b.fty=d.rootFolderType;}else{if(d.folderLinksContextId){b.k=d.folderLinksContextId;}}}}P(d,b,W.wrapMethods(e,O.copy(J)));},V=function(f,a,c){if(!c){return a;}var d=f.showCompletePath,h=a[0],e,b;while(h){var g;for(g=c.length-1;g>=0;g--){if(h.did===c[g].did){c.splice(g,1);h._isSc=true;}}b=h;h._open=true;h=h.items;h=h&&h[0];if(!h){b.lastLeaf=true;}}if(!d){h=a[0];while(h){if(h._isSc){a[0]=h;break;}h=h.items;h=h&&h[0];}}return a.concat(c);},U=function(b,a,c){b._naviInfo=V(b,a,c);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,browsableViewMedias:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,upButtonVisible:false,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,minSearchLength:2,showCompletePath:true,multiSelect:false,onCloseCB:null,onSelectCB:null,onBrowseFolder:null,scrollableIncFetch:false,useBothSglDblSelect:false,displaySaveLabel:false,useOldSearch:false,getDataProvider:function(){if(!this.dataProvider){this.dataProvider=mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"});}return this.dataProvider;},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"saveLabel",scriptClass:"mstrmojo.Label",cssClass:"msrmojo-save-label",text:mstrmojo.desc(3178,"Save in:"),bindings:{visible:"this.parent.parent.displaySaveLabel"}},{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var a=this.opener.parent.parent,d=this.tree,c=a._naviInfo,b=this.parent.parent.parent.extraDDItems;if(d.items!==c){d._pup=this;this.ob=a;if(b){K.forEach(b,function(e){e.isExtra=true;});c=c.concat(b);}d.set("items",c);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(e,a,b){var d=mstrmojo.WidgetTree.prototype.itemFunction(e,a,b);if(e.isExtra){if(e.cssClass){d.cssClass=e.cssClass;}d.onmousedown=e.onmousedown||mstrmojo.emptyFn;return d;}if(e._open){d.state=1;}d._ll=!!e.lastLeaf;d._pup=b._pup;d.onmousedown=function(f){var g=mstrmojo.dom.eventTarget(f.hWin,f.e),h=this._pup;if(g===this.domNode||g===this.textNode){if(!this._ll){M(h.ob,this.data);}h.close();}};d.markupMethods=O.copy(d.markupMethods);d.markupMethods.onstateChange=function(){var f=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[f]||"closed");this.itemsContainerNode.style.display=(f===1)?"block":"none";};d.useRichTooltip=true;var c=d.postBuildRendering;d.postBuildRendering=function(){if(c){c.call(d);}if(d.textNode.parentNode.clientWidth){d.textNode.style.width=(d.textNode.parentNode.clientWidth-20)+"px";}};d.premouseover=function(h){if(this.useRichTooltip){var g=this.textNode;if(g.clientWidth<g.scrollWidth){var f=D.position(g);this.richTooltip={areaId:this.id,cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.data[this.itemDisplayField],top:f.y-2,left:f.x+f.w+6};}else{this.richTooltip=null;}mstrmojo.dom.stopPropogation(h.hWin,h.e);}return true;};return d;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up One Level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp",visible:"this.parent.parent.upButtonVisible"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",cssClass:"searchBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 3px 0; ",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,forceResetCache:true,bindings:{minSearchLength:"this.parent.parent.minSearchLength",quickSearch:"this.parent.parent.quickSearch"},serverRequest:function(a,b){this.parent.parent.getDataProvider().serverRequest(a,b);},preFetch:function(){this.objectTypes=this.parent.parent.browsableTypes||this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);},onUpdateSearchParams:function G(c){var b=this.parent.parent,a=b.sId;if(a){c.sessionState=a;}if(b.useOldSearch){c.quickSearch=0;c.nameWildcards=1;c.sortKey=6;}}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssClass:"mstrmojo-OB-booklet",alias:"booklet",hasAnimation:false,bindings:{scrollableIncFetch:"this.parent.scrollableIncFetch"}},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(b){var d=parseInt(this.height,10),a=this.np>1,c={target:this.domNode,props:{height:{start:(a?0:d),stop:(a?d:0),suffix:"px"}},onEnd:function(){if(a){this.target.style.overflow="visible";}}},e=new mstrmojo.fx.AnimateProp(c);this.domNode.style.overflow="hidden";mstrmojo.css.toggleClass(this.parent.domNode,"show-inc-fetch",this.visible);e.play();},onifsChange:function(a){var b=this.np;mstrmojo.hash.copy(a.value,this);if(this.np>1){this.children=null;this.refresh();}if((b<=1&&this.np>1)||(b>1&&this.np<=1)||(b===0&&this.np>0)){this.set("visible",this.np>1);}this.cssText="";}}],destroy:function Y(){Z(this);if(this._super){this._super();}},postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var c=this.searchUpBar;if(c&&c.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var a=this.obSearchBox.contentWidget||this.obSearchBox;if(!this.scrollableIncFetch){a.attachEventListener("ifsChange",this.id,function(d){if(!this.scrollableIncFetch){this.obIncFetch.set("ifs",d.value);}});}}if(!this.scrollableIncFetch&&this.obIncFetch){var b=this.obIncFetch;b.attachEventListener("fetch",this.id,function(d){b.cp=d.v;b.children=null;b.refresh();B(this,(d.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}mstrmojo.css.addClass(this.domNode,"mstrmojo-ObjectBrowser");},onSearchItemsChange:function(b){var c=b.value,a=this.pageCache[this.currentPage]._w;if(!c||c.length===0){c=[{did:"empty",n:"("+mstrmojo.desc(2210,"")+")",t:"e"}];}else{if(this.browsableViewMedias){var d={};K.forEach(this.browsableViewMedias.split(","),function(e){d[parseInt(e,10)]=true;});c=K.filter(c,function(e){return(e.t!==Q.DssTypeDocumentDefinition)||d[e.dvm];});}}a.set("items",c);},navigate:function(h){var a=h.src,k=a.selectedItem,c=this.multiSelect,f=c&&a.getSelectedItems(),g=this,b=h.added&&h.added.length,e=h.removed&&h.removed.length,d=c?f.length===1&&(!e||b):!!k;if(d&&k.did==="empty"){return ;}if(d&&parseInt(k[L],10)===8){if(!this.onBrowsing){this.onBrowsing=true;M(this,k);}}else{if((k&&(!this.useDblSelect||this.useBothSglDblSelect))||f){this.select(c?f:k);}}},browseFolder:function(a,b){M(this,{did:a,n:b});},onFishEyeChange:function(a){this.goToPage(a.value);},goToPage:function(a){if(a<this.pageCache.length&&a!==this.currentPage){var c=a>this.currentPage,b=this.pageCache[a];this.set("currentPage",a);this.booklet.turn(b._w,c);this.set("currentFolder",b);H.call(this,b);}},oncurrentPageChange:function(a){if(this.fishEye){this.fishEye.setSelectedIndex(a.value);}var b=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(b.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",b.items||[]);this.obSearchBox.set("totalSize",b.sz);this.obSearchBox.set("rootID",b.did);this.obSearchBox.clearSearch();}if(!this.scrollableIncFetch&&this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(b.sz/b.bc)+((b.sz%b.bc>0)?1:0),cp:Math.floor(b.bb/b.bc)+((b.bb%b.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(b,a){O.copy(b,this);if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}Z(this);M(this,undefined,a);},close:function(){var b=this.ctx||this,a=b.onCloseCB;if(a){a[0][a[1]]();}b.set("visible",false);},select:function(b){var a=this.onSelectCB;if(a){a[0][a[1]](b);}if(this.closeOnSelect){this.close();}},dblselect:function R(b){var c=b&&b.src.selectedItem;if(!c||(c&&c.did==="empty")||c[L]===8){return ;}if(this.useBothSglDblSelect){var a=this.onDblSelectCB;if(a){a[0][a[1]](c);}if(this.closeOnSelect){this.close();}}else{this.select(c);}},goUp:function(){if(this.canGoUp){M(this,{did:this.currentFolder.pf});}},updateUpButton:function E(a){H.call(this,a);},oncurrentFolderChange:function(a){var b=a.value;U(this,b.anc.items,b.sc);},refreshContent:function(a){B(this,a);},onError:null,onheightChange:function(){var a=["titleBar","fishEye","searchUpBar","obIncFetch"],c=0,b;for(b in a){c+=parseInt(this[a[b]].domNode.offsetHeight,10);}this.booklet.set("height",parseInt(this.height,10)-c+"px");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.NewFolderEditor");function B(){var E={alias:"newFolder",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var G=this.parent.parent,F={zIndex:G.zIndex+10,navigateAfter:false,fId:G.ob.currentFolder.did,okFn:function(H,I){G.ob.refreshContent();if(I){G.ob.browseFolder(H.fid,G.newFolder);}}};if(G.ob.dataProvider){F.dp=G.ob.dataProvider;}G.openPopup("newFolder",F);},postCreate:function(){this.set("visible",mstrmojo.resolveFeature("create-folder"));}},D=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);D.push(E);return D;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B()});var A={success:function(D){var E=this.parent;if(E.onObjectSaved){E.onObjectSaved({name:E.name,did:D.did,desc:E.desc});}mstrmojo.alert(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",E.typeDesc||"Object").replace("###",E.name),null,mstrmojo.desc(7984,"Object Saved"));E.ob.refreshContent();E.close();},failure:function(E){var D=parseInt(E.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,F=this.parent;if(D==2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",F&&F.typeDesc||"Object").replace("'###'",F&&F.name?'"'+F.name+'"':""),{confirmBtn:{fn:function(){F.saveAs(true);}}},{title:mstrmojo.desc(3179),zIndex:F&&F.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+E.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",help:"Save_As_dialog_box.htm",displaySaveLabel:true,searchVisible:true,upButtonVisible:true,children:[{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",displaySaveLabel:"this.parent.displaySaveLabel",searchVisible:"this.parent.searchVisible",upButtonVisible:"this.parent.upButtonVisible",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];this.onBrowseFolder=[this.parent,"onOBBrowseFolder"];}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"buttonBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot okButton",alias:"ok",text:mstrmojo.desc(2400,"Save"),onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBBrowseFolder:mstrmojo.emptyFn,onOBSelect:function(D){this.set("name",D.n);},saveAsCallback:function C(){return A;},saveAs:function(F){var E=this.contPanel;this.name=E.name.value;this.desc=E.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var G=this.saveParams||{};G.folderID=this.ob.currentFolder.did;G.description=this.desc||"";G.name=this.name||"";G.saveAsOverwrite=!!F;var D=this.saveAsCallback();D.parent=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,D,G);}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;})();(function(){mstrmojo.requiresCls("mstrmojo.VBox","mstrmojo.ObjectBrowser","mstrmojo.HTMLButton");mstrmojo.requiresDescs(1059,1441,3413,3414,4996,7972,9893);var A={768:true,769:true,774:true,776:true,779:true};mstrmojo.IVEDatasetPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.IVEDatasetPicker",cssClass:"mstrmojo-vi-dataset-picker",title:mstrmojo.desc(11940,"Select Existing Dataset"),help:"select_dataset_from_scratch_dialog_box.htm",startingFolder:null,item:null,multiSelect:false,selectedItems:null,children:[{alias:"newLabel",scriptClass:"mstrmojo.FieldSet",legend:mstrmojo.desc(4996,"New"),cssClass:"mstrmojo-ive-fs"},{alias:"btnImport",scriptClass:"mstrmojo.Button",text:mstrmojo.desc(13550,"Access External Data"),cssClass:"mstrmojo-ive-import",onclick:function(){this.parent.close({action:"import"});}},{alias:"useExistingLabel",scriptClass:"mstrmojo.FieldSet",legend:mstrmojo.desc(9893,"Use Existing"),cssClass:"mstrmojo-ive-fs"},{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",cssText:"border-width:1px;border-color:#DDDDDD;",closeable:false,browsableTypes:"8,768,769,774,776,779",closeOnSelect:false,showCompletePath:false,searchVisible:true,upButtonVisible:true,folderLinksContextId:1,bindings:{rootFolderID:function(){return this.parent.startingFolder;},multiSelect:"this.parent.multiSelect"}},{scriptClass:"mstrmojo.HBox",alias:"btnHBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1059,"Next"),onclick:function(){this.parent.parent.close({item:this.parent.parent.item});},bindings:{enabled:function(){return !!(this.parent.parent.multiSelect?this.parent.parent.selectedItem.length:this.parent.parent.item);}}}]}],preBuildRendering:function(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];this.ob.onBrowseFolder=[this,"onOBBrowseFolder"];this.ob.booklet.set("animates",false);this.ob.rootFolderID=this.startingFolder;},postBuildRendering:function(){if(this._super){this._super();}this.ob.browse();},onOBSelect:function(B){if(this.multiSelect){this.set("selectedItems",mstrmojo.array.filter(B,function(C){return A[C.st];}));}else{this.set("item",(A[B.st]?B:null));}},onOBBrowseFolder:function(B){if(this.multiSelect){this.set("selectedItems",null);}else{this.set("item",null);}},onstartingFolderChange:function(){this.ob.rootFolderID=this.startingFolder;this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ObjectBrowser");var H=mstrmojo.array;var E=[257,1024,3072,12032];mstrmojo.vi.ui.editors.ObjectPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ObjectPicker",cssClass:"mstrmojo-vi-ObjectPicker",zIndex:9,title:mstrmojo.desc(11496,"Select Object"),help:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:4,supportedTypes:H.hash(E),item:null,OKFn:null,children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",closeable:false,browsableTypes:"8,"+E.join(","),closeOnSelect:false,showCompletePath:false,searchVisible:false,scrollableIncFetch:true,bindings:{rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId"}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btnHBox",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function C(){var J=this.parent.parent;this.parent.parent.close({item:J.item});var I=J.OKFn;if(I){I(J.item);}J.set("item",null);},bindings:{enabled:function B(){return !!this.parent.parent.item;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancle"),onclick:function C(){var I=this.parent.parent;this.parent.parent.close();I.set("item",null);}}]}],preBuildRendering:function A(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];},postBuildRendering:function D(){if(this._super){this._super();}this.browse();},onOBSelect:function F(I){this.set("item",((this.supportedTypes[I.t]||this.supportedTypes[I.st])?I:null));},browse:function G(){this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserTreeBrowser=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.ACL.UserTreeBrowser",itemIdField:"did",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,getACLUserDataService:function D(){return mstrmojo.ACL.UserDataService;},getContentThroughTaskCall:function C(G,E){var F=this.getACLUserDataService();E.failure=mstrmojo.func.composite([function(H){if(H.getResponseHeader){mstrmojo.alert(H.getResponseHeader("X-MSTR-TaskFailureMsg"));}},E.failure]);if(G.isRoot){F.getTopLevelGroups(G,E);}else{F.getMembers(G,E);}},isBranch:function B(E){return E.isGroup;},item2textCss:function A(E){return(this._super&&this._super(E))||"mstrmojo-ACLInputBox-user "+{8704:"u",8705:"ug"}[E.st];}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasPopup","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.ConditionNode","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr");var D=mstrmojo.css,A=mstrmojo.dom,G=mstrmojo.hash,C=function(L){var M=L.data,K=M.dmy&&M.dmy.uts||[],I=K.length,H=[],J;for(J=0;J<I;J++){H.push(K[J].n);}return'<span class="mstrmojo-text">'+H.join(", ")+"</span>";};mstrmojo.fe.RelationNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><span class="mstrmojo-relationNode-inf"><span class="mstrmojo-relation-prefix-text">'+mstrmojo.desc(2790,"Set of").replace(/##/g,"")+'</span><span class="mstrmojo-textset"  mstrAttach:click></span><span class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(2793,"Where").replace(/##/g,"")+'</span><span class="mstrmojo-relation-convert-text"  mstrAttach:click >'+mstrmojo.desc(null,"Convert to Condition")+'</span><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></span><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},convertNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[3];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){D.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){D.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=C(this);}},noRelationOperator:true,children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(H){this.parent.tree.onNew(H);},getItemConfig:function(K,H,L){var I=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,K,H,L),J=L.tree||L;return G.copy({tree:J,rootTree:this.parent.tree,noRelation:true,inRelation:true},I);},prenodeclick:function(H){if(!H||!H.part){return ;}var I=this.rootTree;if(I&&I.onnodeclick&&this.editable){H.editor=I.editor;I.onnodeclick.call(this,H);}}}],premousedown:function(H){if(this._super){this._super(H);}var I=A.eventTarget(H.hWin,H.e);if(!A.contains(this.childTree.domNode,I,true)){this.childTree.clearTreeSelect();}},preselectedChange:function(H){if(!H.value){this.childTree.clearTreeSelect();}},init:function(H){this._super(H);var I=this.data;if(I){delete this.data;this._set_data(null,I);}},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;if(H){this.childTree.set("items",H.nds||[H]);}}return J;},isSelectableArea:function(H){return mstrmojo.dom.contains(this.relationNode,H,true);},preclick:function E(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.textNode,I,true)){J="createSet";}else{if(A.contains(this.convertNode,I,true)){this.parent.removeSet(this);return false;}}}H.part=J;},del:function B(){var H=this.parent;if(H&&H.remove&&this.data){H.remove(this.data);}},newCondition:function F(H){this.childTree.newCondition(H);},avatarCssCls:"mstrmojo-FE mstrmojo-relationNode",getAvatarNode:function(){return this.relationNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.Label","mstrmojo.Obj","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.warehouse.EnumObjectTypes");var G=mstrmojo.expr,C=G.ET,B=mstrmojo.array,E=mstrmojo.string,F=mstrmojo.warehouse.EnumObjectTypes,D=mstrmojo.mstr.EnumNodeDimty;mstrmojo.fe.CreateSetEditor=mstrmojo.declare(mstrmojo.Editor,null,{onOpen:function(){var M=this.model,P=this.condition.data,N=!P.m,J=this.attrsBox.attrsList,H=this.relBox.relPd,Q=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(M.metrics),I=this.appQual;J.set("items",M.attrs);mstrmojo.array.forEach(["relBox","appQual"],function(R){this[R].set("visible",N);},this);if(P.dmt===4&&P.dmy.uts){var K={};B.forEach(P.dmy.uts,function(S){var R=B.find(M.attrs,"did",S.utgt.did);if(R>=0){K[R]=true;}});J.set("selectedIndices",K);}if(N){H.set("items",Q);if(P.relation&&P.relation.guide){var L=P.relation.guide,O=B.find(Q,"did",L.did);H.set("selectedIndex",O>=0?O:0);}else{H.set("selectedIndex",0);}I.set("checked",!!P.applySubExpr);}},onOK:function(){var O=this.model,R=this.condition,T=this.condition.data,L=this.attrsBox.attrsList,H=this.relBox.relPd,J=this.appQual;var V=L.getSelectedItems(),I=[];B.forEach(V,function(X){I.push({utgt:{n:X.n,did:X.did},utp:G.DMY_TP.ATTR,agg:1,flt:2,gb:true,rps:0,n:X.n});});var U;if(H.selectedIndex>0){var M=H.items[H.selectedIndex];U={n:M.n,did:M.did,t:F.METRIC,st:1024};}var K;if(T.et===15){T.dmt=D.NodeDimtyOutputLevel;T.dmy=T.dmy||{};T.dmy.uts=I;K=T.relation=T.relation||{};if(U){K.guide=U;T.useSchema=false;}else{delete K.guide;delete K.rsTp;delete K.joTp;delete K.paTp;delete K.erTp;T.useSchema=true;}T.applySubExpr=J.checked;R.set("data",T);}else{var S={et:15};S.dmt=D.NodeDimtyOutputLevel;S.dmy={};S.dmy.uts=I;K=S.relation={};if(U){K.guide=U;}else{S.useSchema=true;}S.applySubExpr=J.checked;var N=R,P={rq:S,cq:T},Q=[R.childIndex()];if(T.et===C.ANDOR){if(T.nds&&T.nds.length>2){var W=O.childIdx;Q=[W,W-1];}else{N=R.parent;}}else{N=R.parent;P.isMetric=!!T.m;}N.createSet(Q,P);}},children:[{scriptClass:"mstrmojo.Box",alias:"attrsBox",cssClass:"Attributes-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14613,"Select attributes to create the set"),cssClass:"Label"},{scriptClass:"mstrmojo.ui.CheckList",alias:"attrsList",cssClass:"CheckList"}]},{scriptClass:"mstrmojo.Box",alias:"relBox",cssClass:"RelatedBy-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",onitemSelected:function A(H){}}]},{scriptClass:"mstrmojo.ui.Checkbox",alias:"appQual",cssClass:"AppQual-CheckBox",postBuildRendering:function(){this.domNode.innerHTML=E.encodeHtmlString(mstrmojo.desc(12038,"Apply this qualification independently of the relationship filter"));}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float: right; border-collapse: separate; display: table;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(2397,"OK"),onclick:function(){var H=this.editor;H.onOK();H.close();},bindings:{enabled:function(){var I=this.parent.parent.attrsBox.attrsList,H=this.parent.parent.attrsBox.attrsList.selectedIndices;return I.getSelectedItems().length>0;},editor:"this.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent"}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.FilterExpr","mstrmojo.threshold.AndOrNode","mstrmojo.threshold.ConditionNode","mstrmojo.expr");var G=mstrmojo.expr,F=G.ET;mstrmojo.threshold.ThresholdExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.threshold.ThresholdExprTree",cssClass:"mstrmojo-ThresholdExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,supportRelation:true,nodeClassMap:{14:mstrmojo.threshold.AndOrNode,"*":mstrmojo.threshold.ConditionNode},onConditionEdit:mstrmojo.emptyFn,editor:undefined,isEditable:function C(H){if(!this.editable){return false;}if(H&&H.et===F.XML){return !H.xml;}return true;},onNew:function E(H){H.data.isNew=true;this.editor.openConditionWalk(H.data,H.widget.ctxtBuilder.itemWidgets[H.index]);},onnodeclick:function D(H){var I=H.part;if(!H||!I){return ;}var K=I==="andor",J=this.tree.editor;if(!((K&&this.prefixedAndOrEditable)||(!K&&this.editable))){return ;}if(!this.editable){return ;}if(K){J.openAndORPopup(this,H.getTarget());return ;}else{if(I==="addCondition"){this.tree.newCondition(null);return ;}}J.openConditionWalk(this.data,this);},allowDrop:function B(H){var M=H&&H.src,L=M&&M.data,J=L&&L.et,K=this.tree,I=M&&M.widget&&M.widget.tree;return J&&(this===K?(I!==K):true);},remove:function A(I){var H=this._super(I);if(this.items.length===0&&I.et===F.ANDOR&&I.nds.length===0&&this.parent.removeFromModel){this.parent.removeFromModel();}return H;}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.FilterExpr");var D=mstrmojo.hash,B=mstrmojo.expr.ET;mstrmojo.fe.FilterExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.fe.FilterExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,onConditionEdit:mstrmojo.emptyFn,modifyConditionNode:function(G,F){var H=G.data,E=H.isNew;D.copy(D.clone(F),D.clear(H));delete H.isNew;G.paint();if(H.et===B.MQ||H.et===B.MC){G.set("noCreateSet",true);}if(G.tree.onConditionEdit){G.tree.onConditionEdit(G,E);}},getItemConfig:function(H,E,I){var F=this._super(H,E,I),G=I.tree;return D.copy({onclick:G.prenodeclick,containerResizable:G.containerResizable,ondragend:G.ondragend,ondrop:G.ondrop},F);},ondragenter:function A(E){this.dropCuePos={left:0,top:0,idx:0,idxActual:0};this._super(E);},ondragend:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondragend.call(this,E);}},ondrop:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondrop.call(this,E);}},isEditable:function C(F){if(!this.editable){return false;}var E=false;switch(F&&F.et){case B.R:case B.F:E=false;break;case B.ANDOR:case B.MQ:case B.AQ:case B.AL:case B.AC:case B.MC:case B.AE:E=true;break;case B.XML:E=!F.xml||!!F.ph;}return E;},prenodeclick:function(E){if(!E||!E.part){return ;}if(E.part!=="createSet"&&E.part!=="createSetOpt"&&!(E.part==="andor"?this.prefixedAndOrEditable:this.editable)){return ;}var F=this.tree;if(F.onnodeclick){F.onnodeclick.call(this,E);}},getSelectedItemWidget:function(){var E=function(K){var I=K&&K.ctxtBuilder&&K.ctxtBuilder.itemWidgets,G=K.selectedIndex,F=I&&I.length||0;if(!I){return ;}if(G===-1){for(var H=0;H<F;H++){var J=E(I[H]);if(J){return J;}}}else{return I[G];}};return E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.Enum_Keys","mstrmojo.SimpleObjectInputBox");var D=mstrmojo.array,B=mstrmojo.dom,E=mstrmojo.Enum_Keys,A=mstrConfig.thousandsSep;var H={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};if(A===undefined){A=",";}var I;mstrmojo.TextBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-TextBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",preBuildRendering:function G(){this.set("maxItemWidth",parseInt(this.parent.contentNode.style.width,10));this._super();},prekeydown:function C(J){var L=J.e;switch(parseInt(L.keyCode||L.charCode,10)){case E.TAB:case E.ENTER:B.preventDefault(J.hWin,L);var M=this.inputBox.value;if(M){if(D.find(this.items,"v",M)===-1){this.onSuggestionItemSelect({n:M,v:M});}else{this.setDefaultState();}}break;case E.ESCAPE:this.setDefaultState();break;case E.BACKSPACE:if(!this.getSearchPattern()){B.preventDefault(J.hWin,L);var K=this.items&&this.items.concat();if(K&&K.length){K.splice(K.length-1,1);this.set("items",K);var N=this.id;window.setTimeout(function(){mstrmojo.all[N].set("state",H.ADDING);},0);}}break;}},prekeyup:function F(J){}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox");var M=mstrmojo.array,G=mstrmojo.dom,B=mstrmojo.Enum_Keys,N=mstrConfig.thousandsSep;if(N===undefined){N=",";}var J=2147762227,T=2147762262,H=2147762269,K=140,I=-100,S=-101;var Q;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{getItemMarkup:function(X,W){if(!Q){Q=this._super(X,W).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return Q;},getItemProps:function V(Y,W){var X=this._super(Y,W),Z=Y.wt;X.weight=Z?"<em>("+mstrmojo.num.addSeparators(Z,N)+" "+this.parent.opener.wtStr+")</em>":"";return X;},onclick:function(X){var a=this.parent.opener.suggestionItems,W=a.length;this._super(X);if(W<=1){return ;}var Y=M.find(a,"t",I),Z=this.getItemFromTarget(X.getTarget());if(Z&&Z.t&&Z.t===I){M.forEach(a,function(b,c){if(!this.selectedIndices[c]){this.doItemSelect(b,{});}},this);}else{if(this.selectedIndices[Y]){this.doItemSelect(a[Y],{});}}}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{scriptClass:"mstrmojo.SearchBoxSelector",cssClass:"mstrmojo-SearchBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",wtStr:"likes",suggestionListClass:"mstrmojo.SearchBoxSelectorList",useRichTooltip:false,postCreate:function A(){var W=this.suggestionPopup;W.cssClass="mstrmojo-SearchBoxSelector-suggest";W.nudge=function(){var d=this.domNode;if(!d){return ;}var X=Math.min(d.offsetHeight,(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||K),Z=d.offsetWidth,c=G.windowDim(),b=parseInt(this.left,10),a=parseInt(this.top,10);if(a+X>=c.h){a=Math.max(a-X,0);}if(b+Z>=c.w){b=Math.max(b-Z,0);}var Y=d.style;Y.top=a+"px";Y.left=b+"px";};},preBuildRendering:function C(){var W=this.parent.contentNode.offsetWidth||this.parent.width;this.set("maxItemWidth",parseInt(W,10));this._super();},postBuildRendering:function R(){var W=this.parent.defn.fmts;if(!W.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function U(X,a,W){var b=X,Y=this.suggestCount;if(!this.noCache){W=W||Y;if(a==="*"){a="";}else{a=mstrmojo.string.regEscape(a);}var c=this.itemField,Z=new RegExp(a,"i");b=M.filter(X,function(d){return Z.test(d[c]);},{max:W});}if(b.length){M.forEach(this.items,function(e){var d=M.find(b,"v",e.v);if(d>-1){b.splice(d,1);}});}if(b.length>=Y){b=b.slice(0,Y);}return b;},getCandidatesThroughTaskCall:function F(n,q){var h=this.id,b=this.getSuggestionTarget(),f=n.pattern||"",e=f,c=this.parent,l=this.srcid;var d=f;f=d;if(d===""){return ;}if(l){var p={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:l,dataSourcesXML:this.dsrc||"",blockCount:this.REQUEST_THRESHOLD,searchPattern:f,rawInput:e,browseFlags:1},g=null;var Y=c.defn;if(Y.dsid){g={};g.datasetID=Y.dsid;g.messageID=c.model.mid;g.ctlKey=c.ckey;}if(Y.sfs){var m="",Z="";M.forEach(Y.sfs,function(r){m+=Z+r.did;Z=";";});p.searchForms=m;if(c.model.isnew){var o="",W="",a=c.model,k=M.filterOne(a.getDatasetUnits(["att"]),function(r){return r.did===l;}),X=k.fs||[];M.forEach(Y.sfs,function(r){var t=M.filterOne(X,function(u){return u.fid===r.did;});o+=W+r.did+":"+(t&&t.bftp)||0;W=";";});p.clientFormPatterns=o;}}q.success=function(v){var x=mstrmojo.all[h];if(v&&v.es){var z=x.getSuggestionTarget(),r=v.es.length;if(!v||!z||(b!==z)){return ;}var u=z.getSearchPattern(),t=v.es;if(l){t=mstrmojo.elementHelper.buildElemsTerseID(t,l,true);}var w=n.pattern;x._last_hit={items:t,pattern:w};if(u&&u.indexOf(w)>-1){x.updateSuggestion(x.filterCandidates(t,u));}}else{x.updateSuggestion([]);}};q.failure=function(t){var r=parseInt(t.code,10)+4294967296;if(r!==J&&r!==T&&r!==H){mstrmojo.alert(t.message);}};mstrmojo.elementHelper.browseElements(q,p,g);}},onsuggestionItemsChange:function E(){var b=this.suggestionItems,Y=this.suggestionPopup,X=Y.editorNode,Z=b&&(b.length>8),W="",a="";if(Z){W=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||K;a="px";}if(X){X.style.maxHeight=W+a;}else{if(Z){a+=";";Y.cssText=(Y.cssText||"")+"max-height:"+W+a;}}},getSuggestionPos:function O(){var W=this._super();if(W){W.lockIW=this;}return W;},updateSuggestion:function P(X){var W=X&&X.length;this.autoSelect=true;this.set("disableClick",false);if(this.parent.defn.multi&&W&&W>1){X=M.filter(X,function(Y){return Y.v!=="u;"&&Y.t!==14;});X.unshift({n:mstrmojo.desc(13976,"(All search results)"),t:I});this.autoSelect=false;}if(!W){X=[{n:mstrmojo.desc(13779,"No elements match your search"),t:S,cls:"nomatch"}];this.autoSelect=false;this.set("disableClick",true);}this._super(X);},handleSuggestionItemSelect:function L(X,Y){if(M.isArray(X)||X.t===I){X=M.ensureArray(X);var W=M.filter(X,function(Z){return Z.t!==I;});if(W.length<X.length){W=M.filter(this.suggestionItems,function(Z){return Z.t!==I;});}this.onSuggestionItemSelect(W);}else{this._super(X,Y);}},prekeydown:function D(f){this._super(f);var b=f.e,g=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||K,Z=8,X=g/Z;var Y=this.getSelected();if(Y){var a=Y._renderIdx,W=(a-Z+1)*X,d=(a-1)*X,c=this.suggestionPopup.domNode.scrollTop;switch(parseInt(b.keyCode||b.charCode,10)){case B.DOWN_ARROW:if(c<=W){this.suggestionPopup.domNode.scrollTop=W;}else{if(c>d){this.suggestionPopup.domNode.scrollTop=d;}}break;case B.UP_ARROW:if(c<=W||c>d){this.suggestionPopup.domNode.scrollTop=d;}break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AE=mstrmojo.Enum_OIB_States,AD={},AF;for(AF in AE){if(AE.hasOwnProperty(AF)){AD[String(AE[AF])]=AF;}}return AD;}());var Q=mstrmojo.dom,S=mstrmojo.hash,Z=mstrmojo.Enum_OIB_States,I=0,b="_did_",z=mstrmojo.Enum_Keys,AB=80,U=200;function P(){return I++;}function g(AD){return(AD&&AD.state===Z.ADDING);}function q(AD){var AE={n:AD||"",state:Z.EMPTY};AE[b]=-2;return AE;}function O(AD){return(AD&&AD.state===Z.EMPTY);}function v(AE){var AF=AE.items,AD=AF&&AF.length;if(!AD){return true;}return(AD===1&&g(AF[0]))||(AD===2&&O(AF[0])&&g(AF[1]));}function m(){var AE=this.ctxtBuilder.itemWidgets,AD=AE[AE.length-1];if(AD&&AD.isAdding){var AF=this;Q.attachEvent(AD.domNode,"click",function(){AF.editingIdx=null;});return AD;}return null;}function L(){var AD=this.editingIdx;if(AD!==null){return this.ctxtBuilder.itemWidgets[AD];}return m.call(this);}function D(){this.isActive=false;var AE=this.emptyText||"",AF=this.items;if(v(this)&&!O(AF[0])&&(AE.length>0)){this.add([q(AE)],0);var AG=this.ctxtBuilder.itemWidgets[0];AG.set("shouldEllipsize",true);AG.doEllipsize();}var AD=L.call(this);if(AD){if(g(AD)&&this.showEmptyItem){AD.domNode.style.display="none";}this.scrollTo(this.items[0]);AD.blur();}Q.detachEvent(document.body,"mousedown",this._mousedownHandler);if(this.tabNavigable){Q.detachEvent(AD.inputNode,"keydown",this._tabKeyHander);}}function N(){if(!this.enabled){return ;}this.isActive=true;if(O(this.items[0])){this.remove(0);}var AD=L.call(this);if(AD){if(g(AD)&&!this.isFull){AD.domNode.style.display="block";}this.scrollTo(AD.data);AD.focus();}Q.attachEvent(document.body,"mousedown",this._mousedownHandler);if(this.tabNavigable){Q.attachEvent(AD.inputNode,"keydown",this._tabKeyHander);}}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",showEmptyItem:true,items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,showSuggestionOnEdit:true,tabNavigable:false,getSearchPattern:function(){var AD=L.call(this);if(AD){return AD.getSearchPattern();}return"";},getSuggestionTarget:function n(){return this.suggestTarget;},onsuggestTargetChanged:function p(AD){this._request_pattern=null;},getSuggestionPos:function c(){return this._pop_cfg;},onSuggestionItemSelect:function w(AD){if(this.suggestTarget){this.suggestTarget.setItem(AD[this.itemField],AD,false);}this.hideSuggestion();this.closePopup();},hideEditButton:function(AD){return !!this.noEditButton;},_set_items:function l(AI,AF){AF=mstrmojo.hash.clone(AF)||[];var AH=this.maxObjectCount;this.set("isFull",(AH&&AF.length>=AH));if(AF.length===0){var AE=this.emptyText||"";if(AE.length>0){AF.push(q(AE));}}var AG={n:"",state:Z.ADDING};AG[b]=-1;AF.push(AG);var AD=AF[AF.length-1];if(AD&&g(AD)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=b;return this._super(AI,AF);},add:function E(AE,AD){var AF=m.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AE,AD);}if(!v(this)&&O(this.items[0])){this.remove(0);}if(AF){AF.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);AF.domNode.style.display="none";}else{AF.domNode.style.display=this.showEmptyItem?"none":"";}}},remove:function a(AD){this._super(AD);var AE=m.call(this);if(AE){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AE.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function Y(){this._super();var AE=this,AD=m.call(AE);if(AD&&(this.showEmptyItem||this.isFull)){AD.domNode.style.display="none";}this._clickHandler=function(){N.call(AE);};this._mousedownHandler=function(AF){if(!AE.isActive||AE.browserShown){return ;}var AG=Q.eventTarget(self,AF);if(AG&&AG.parentNode&&!Q.contains(L.call(AE).domNode,AG,false,document.body)&&!Q.contains(AE.suggestionPopup.domNode,AG,false,document.body)){D.call(AE);}};if(this.tabNavigable){this._tabKeyHander=function(AF){var AG=parseInt(AF.keyCode||AF.charCode,10);if(AG===z.TAB){if(!AE.isActive||AE.browserShown){return ;}D.call(AE);}};}Q.attachEvent(this.domNode,"click",this._clickHandler);},nextId:P,item2textCss:function M(AD){return AD.cssClass||"";},itemFunction:function G(AF,AD,AE){AF[AE.itemIdField]=P();var AG=new mstrmojo.ObjectItem({parent:AE,itemField:AE.itemField,cssClass:AE.item2textCss(AF),data:AF,showSuggestionOnEdit:this.showSuggestionOnEdit,enabled:AE.enabled});AE.attachEventListener4ItemWidget(AG,AE);return AG;},attachEventListener4ItemWidget:function h(AH,AF){var AE=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],AD=AE.length,AG;for(AG=0;AG<AD;AG++){AH.attachEventListener(AE[AG],AF.id,"_itemChangeHandler");}return AH;},getSelectedObjects:function k(){if(v(this)){return[];}var AD=this.items,AE=AD.length-1;if((AE>-1)&&g(AD[AE])){return AD.slice(0,AE);}return AD.concat();},isValid:function C(){var AE=this.ctxtBuilder.itemWidgets,AD=AE&&AE.length,AF;for(AF=0;AF<AD;AF++){if(!AE[AF].isValid()){return false;}}return true;},isEmpty:function V(){return v(this);},_itemChangeHandler:function(AG){var AI=AG.name,AJ=AG.d,AE,AD=this.items.length,AF;switch(AI){case"ItemEditBegin":if(this.editingIdx!==null){AF=L.call(this);if(AF){AF.blur();}}AE=this.itemIndex(AJ);this.editingIdx=AE;N.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AG.deactivate){D.call(this);}else{N.call(this);}AF=m.call(this);if(AF){AF.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AF=L.call(this);if(AF){AF.blur();}this.editingIdx=null;}AE=this.itemIndex(AJ);this.remove(AE);if(!AG.deactivate){this.editingIdx=null;N.call(this);}else{if(!this.isActive){D.call(this);}else{N.call(this);}}break;case"ItemDeletePrev":if(AD>1){this.remove(AD-2);}break;case"ItemAdd":var AH=S.copy(AG.d);this.add([AH],AD-1);if(AG.deactivate){D.call(this);}else{N.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AG.target);this._pop_cfg={target:AG.target,left:AG.l,top:AG.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AG.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AI==="ItemEditEnd"||AI==="ItemAdd"||AI==="ItemDelete"||AI==="ItemDeletePrev"||AI==="ItemEditing")){this.onitemchange();}},unrender:function B(AE){var AD=this.suggestionPopup;if(AD.hasRendered){AD.unrender(false);}if(this._super){this._super(AE);}},destroy:function u(AE){var AD=this.suggestionPopup;if(AD&&AD.hasRendered){AD.destroy(false);}if(this._super){this._super(AE);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ObjectInputBox,{onenabledChange:mstrmojo.Widget.enabledMarkupMethod});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var r="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span title=" {@title}" class="'+r+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=r+" "+this.cssClass;},onstateChange:function(){var AG=this.state,AF=mstrmojo.Enum_OIB_States_CSS[AG],AE=this.domNode;if(AG===Z.EMPTY){AE.innerHTML=this.enabled?'<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>":"";}else{if(AG===Z.EDITING){var AD=Math.round(this.displayNode.clientWidth);this.editNode.style.width=AD-4+"px";this.inputNode.style.width=AD-9+"px";}}AE.className="mstrmojo-ObjectItem "+AF;this.updateButtonsVisibility(this.data);},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},updateButtonsVisibility:function AC(){if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},state:Z.VALID,onstateChange:function e(AD){this.data.state=this.state;},ontextChange:function H(AD){this.data[this.itemField]=this.text;},updateData:function F(AD){S.copy(AD,this.data);this.set("state",Z.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function x(AE){this._super(AE);var AG=this.data,AD=AG.state,AF=this.parent;AD=this.initState();this.cssClass=AF.item2textCss(AG);this.text=AG[this.itemField];this.state=AD;this.isAdding=g(AG);this.useRichTooltip=true;this.title=this.text;},initState:function K(){var AE=this.parent,AF=this.data,AD=AF.state;if(AF&&AF.did){AF.state=Z.VALID;return AF.state;}if(typeof AD==="undefined"){AD=AE.dynamicVerify?AE.verifyObject(AF[this.itemField],this):Z.UNDETERMINED;AF.state=AD;}return AD;},isValid:function C(){var AD=parseInt(this.state,10);return(AD!==Z.INVALID&&AD!==Z.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AG=this.inputNode.style;AG.width=AB+"px";var AF=this.domNode.parentNode,AD=AF.parentNode.offsetWidth,AE=Math.max(AD-AF.offsetLeft-20,AB);if(!isNaN(AE)){AG.width=AE+"px";}}},blur:function T(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AF=this.inputNode,AD=AF.value,AE=this.parent;window.setTimeout(function(){try{AF.blur();}catch(AG){}},0);if(!AD){return ;}if(AE.acptSugItemOnly&&this._tWas_){this.set("text",AD);this.set("text","");this._tWas_=null;return ;}this.setItem(AD,null,true);},focus:function t(){var AE=this.inputNode,AD=this.isActive;window.setTimeout(function(){try{AE.focus();if(AE.createTextRange&&!AD){var AG=AE.createTextRange(),AF=AE.value.length;AG.move("character",AF);AG.select();}else{if(AE.setSelectionRange&&!AD){var AF=AE.value.length;AE.setSelectionRange(AF,AF);}}}catch(AH){}},0);this.isActive=true;},prekeydown:function J(AD){var AF=this.inputNode.value,AE=parseInt(AD.e.keyCode||AD.e.charCode,10),AH=this.parent;if(!AF){return ;}if(AE===z.TAB||AE===z.ENTER){if(AE===z.ENTER){Q.preventDefault(AD.hWin,AD.e);}var AG=AH.getSelected();if(AG&&AG.did){AH.handleSuggestionItemSelect(AG);}else{this.hideSuggestion();if(!AH.acptSugItemOnly){this.setItem(AF,null,false);}else{this.set("text",AF);this.set("text","");}}}else{if(AE===z.DOWN_ARROW){if(!AH.noCache&&!AH.suggestionShown){this.showSuggestion(AF);AH.preHighlight();}AH.nextHighlight();}else{if(AE===z.UP_ARROW){AH.preHighlight();}}}},prekeyup:function AA(AD){var AF=this.inputNode.value,AE=parseInt(AD.e.keyCode||AD.e.charCode,10),AI=this.isAdding,AH=this.parent;if(!AF){if(AI){if(AE===z.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});Q.preventDefault(AD.hWin,AD.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AE===z.ESCAPE||AE===z.TAB){this.hideSuggestion();if(AH.acptSugItemOnly){this.set("text",AF);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AF){this.textChanged=true;this.raiseEvent({name:"ItemEditing",d:this.data});if(AH.useKeyDelay){window.clearTimeout(this._timerID);var AG=this;this._timerID=window.setTimeout(function(){var AJ=AG.inputNode.value;if(AJ){AG.showSuggestion(AJ);}AG._timerID=null;},U);}else{this.showSuggestion(AF);}}}this._tWas_=AF;},setItem:function(AD,AF,AE){var AG=this.isAdding;AE=AE||false;this.set("text",AD);if(AG){this.setItem_Adding(AD,AF,AE);}else{this.setItem_Editing(AD,AF,AE);}this._tWas_=null;},setItem_Adding:function(AD,AF,AE){this.set("text","");if(!AF){AF={};AF[this.itemField]=AD;}else{AF.state=Z.VALID;}this.raiseEvent({name:"ItemAdd",d:AF,deactivate:AE});},setItem_Editing:function(AD,AF,AE){var AG=this.parent;this.set("text",AD);if(AF){this.updateData(AF);}else{if(this.textChanged){var AH={};AH[b]=this.data[b];delete this.data.did;this.data=AH;this.textChanged=false;}this.set("state",AG.verifyObject(AD,this));this.set("cssClass",AG.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AF,deactivate:AE});},getSearchPattern:function W(){return this.inputNode.value;},showSuggestion:function o(AD){var AE=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AE.x)+"px",t:Math.round(AE.y+AE.h)+"px",pattern:AD,target:this});},hideSuggestion:function f(){this.raiseEvent({name:"SuggestionOff"});},del:function R(AD){AD=AD||self.event;Q.stopPropogation(self,AD);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function X(){this.set("state",Z.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});if(this.showSuggestionOnEdit){this.showSuggestion(this.text);}},doEllipsize:function d(){if(!this.shouldEllipsize){return ;}var AE=this.maxItemWidth,AD;if(AE){this.domNode.style.maxWidth=AE;switch(parseInt(this.state,10)){case Z.VALID:case Z.UNDETERMINED:case Z.INVALID:AD=this.textNode;break;case Z.EMPTY:AD=this.domNode.firstChild;break;}if(AD){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(AD,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ME.TokenInputBox");mstrmojo.requiresDescs(13542,13543);var B=mstrmojo.array;var L={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},G={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},H={0:mstrmojo.desc(9565,"Valid Metric Formula."),1:mstrmojo.desc(9106,"Require Validation?"),2:mstrmojo.desc(9566,"Validation in Progress..."),3:mstrmojo.desc(9567,"Validation Failed with Syntax Error!"),4:mstrmojo.desc(9568,"Validation Failed with Object Ambiguity!")};function D(O){if(!O){return L.VALID;}return{"-2147214845":L.ERROR,"-2147214846":L.AMBIGUITY}[O]||L.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricEditBox",vStatus:L.VALID,iStatus:"",showStatus:true,browseItemVisible:true,absorbAmbiguity:true,isObjectVisible:function(O){return true;},markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;}},markupMethods:{onvStatusChange:function(){var P=this.vStatus,O=this.vStatusNode;O.className="mstrmojo-MEBox-vStatus "+G[P];O.innerHTML=(this.getStatusDesc&&this.getStatusDesc(P))||H[P]||"";},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;this.iStatusNode.title=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:0,bindings:{browseItemVisible:"this.parent.browseItemVisible",candidates:"this.parent.candidates"}}],init:function N(O){if(this._super){this._super(O);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function M(){return this.inputBox.getSearchPattern();},getHighlightedText:function I(P,O){return this.inputBox.getHighlightedText(P,O);},item2textCss:function F(O){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[O.t]||"";},handleSuggestionItemSelect:function E(O){var P=this.abiguityDialog;if(O){P.onItemSelect(O);}P.close();},showDesc:true,showPath:true,abiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title",mstrmojo.desc(13542,"Object Ambiguity - ##").replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.list.singleSelect(0);this.label.set("text",mstrmojo.desc(13543,"More than one object with the name '##' were found.").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"},onclick:function(O){mstrmojo._IsList.onclick.call(this,O);}}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:mstrmojo.desc(547,"Select"),onclick:function(){var O=this.parent.parent;O.opener.handleSuggestionItemSelect(O.list.selectedItem);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]},defaultOnTokensModify:function(){this.set("vStatus",L.UNKNOWN);this.set("iStatus","");},postBuildRendering:function A(){this._super();this.inputBox.attachEventListener("tokensModify",this.id,"defaultOnTokensModify");this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function K(O){this.inputBox.set("items",O.items);},replaceErrorToken:function C(O){this.inputBox.replaceErrorToken(O);},handleValidation:function J(O){if(!O){this.set("vStatus",L.ERROR);return ;}O.vs=D(O.rjec);this.set("vStatus",O.vs);this.set("iStatus",O.rjed||"");this.updateInputBoxItems(O);this.inputBox.focus();if(O.vs===L.AMBIGUITY){var W=this,T=O.items,S=B.find(T,"sta",-1),P=T[S].v,U=function(X){W.replaceErrorToken(X);W.set("iStatus","");W.set("vStatus",L.UNKNOWN);if(W.continueValidataion){W.continueValidataion();}};var Q=B.filter(O.srfd.items,this.isObjectVisible);var V=this.parent.candidates,R=V&&V.items;if(R){B.forEach(Q,function(Y){var X=B.find(R,"did",Y.did);if(X===-1){if(this.absorbAmbiguity){R.push(Y);}}else{Y.path=R[X].path;}});}if(Q.length===1){U(Q[0]);return ;}this.openPopup("abiguityDialog",{zIndex:100,items:Q,ambiguousName:P,onItemSelect:U});}else{if(this.postHandleValidation){this.postHandleValidation();}}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=L;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.ToolbarConfig");mstrmojo.vi.ui.toolbars._HasToolbar=mstrmojo.provide("mstrmojo.vi.ui.toolbars._HasToolbar",{_mixinName:"mstrmojo.vi.ui.toolbars._HasToolbar",preBuildRendering:function A(){this.generateToolbar();return this._super();},generateToolbar:function B(){this.passToolbarCfg(this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));},updateToolbar:function D(E){if(this._super){E=this._super(E);}return E;},passToolbarCfg:function C(E){var F=this.toolbar.toolbarCfg;if(F){F.destroy();}this.toolbar.set("toolbarCfg",E);}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.rw.xtab.XtabMenuConfig","mstrmojo.dom","mstrmojo.hash");var F=mstrmojo.dom;function B(H,G){if(G){G.opener=this;}this.openPopup(H,G);}mstrmojo.express.ui._IsDocumentView=mstrmojo.provide("mstrmojo.express.ui._IsDocumentView",mstrmojo.hash.copy(mstrmojo._HasPopup,{_mixinName:"mstrmojo.express.ui._IsDocumentView",openXtabCellMenu:function A(G){var H=this.getXtabCellMenuConfig({isHostedWithin:false,position:G.cmPos||F.position(G.btn.domNode),hostId:this.id});H.buildXtabMenuConfig(G);if(H.hasMenuItems()){B.call(this,H.newInstance(),G);}},getXtabCellMenuConfig:function(G){return new mstrmojo.rw.xtab.XtabMenuConfig(G);},drillLinkMenuRef:"mstrmojo.DrillLinkMenu",openDrillLinkMenu:function D(G){B.call(this,"drillLinkMenuRef",G);},goToLink:function C(G){if(G){window.open(G.url,(G.target||"_self"));}},openPopupMenu:function E(H,G){B.call(this,H,G);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasBuilder","mstrmojo._IsPanelStack","mstrmojo.string","mstrmojo.vi.ui.rw._IsPanelStack","mstrmojo._IsSelectorTarget","mstrmojo.vi.ui.rw.DockedPanelSelector","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.array");mstrmojo.requiresDescs(4780);var I=mstrmojo.array,D=mstrmojo.string,S="#d6d6d6",L="#323335";function F(){this.selector.setPanels(this.panels,this.selectedIdx);this.doLayout();}function K(U){var V=this.panels,Y=V.indexOf(U),X=V[Y],W;V.splice(Y,1);W=this.removeChildren(X);return W;}function R(X,a,Z,U,Y){var W=this.children,V=this.panels;V.splice(a,1);W.splice(U,1);V.splice(Z,0,X);W.splice(U+Z-a,0,X);this.selectedIdx=Y;F.call(this);}mstrmojo.vi.ui.rw.DocVIVisualizationsPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasBuilder,mstrmojo._IsPanelStack,mstrmojo.vi.ui.rw._IsPanelStack,mstrmojo._IsSelectorTarget,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocVIVisualizationsPanelStack",markupString:'<div id="{@id}" class="mstrmojo-VIVizPanel {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIVizPanel-content"></div><div class="mstrmojo-VIVizPanel-selector"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},selectorNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{containerNode:"100%",selectorNode:"auto"},w:{containerNode:"100%",selectorNode:"100%"},xt:true},getLayoutOffsets:function Q(){return{h:2,w:2};},panels:null,model:null,selector:null,children:[{scriptClass:"mstrmojo.vi.ui.rw.DockedPanelSelector",alias:"selector",slot:"selectorNode"}],postBuildRendering:function O(){this._super();var U=this.parent,V=U&&U.defn&&U.defn.fmts&&U.defn.fmts["background-color"];if(V&&!(V===S||V===L)){this.domNode.style.backgroundColor=V;}},addChildren:function H(W,U,V,Y){var X=W[0];if(X&&X.hasOwnProperty("k")){this.panels=(this.panels||[]).concat(W);if(!Y){F.call(this);}}return this._super(W,U,V);},removeChildren:function M(W,V){if(W){var U=[].concat(W).map(function(X){return X.k;});this.panels=(this.panels||[]).filter(function(X){return U.indexOf(X.k)===-1;});}this._super(W,V);},_set_children:function N(X,W,V){if(W!==this.children){var U=this.selector;if(U){W.push(U);}}return this._super(X,W,V);},selectPanelDeferred:function(X,V,W,U){if(V!==this.selectedKey){this._super(X,V,W,U);}},onpanelSelected:function E(){F.call(this);this.getSelectedPanel().buildBoxLayout();},deletePanel:function B(V){var c=this,b=this.panels,g,U=b.indexOf(V),Y=this.selectedIdx,W,Z=this.model,e=Z.id,f=function(l){var k=mstrmojo.all[e],h=k.getCurrentLayoutDef().units||{},m=[V.k];V.children.forEach(function(o){var n=o.k;if(n){m.push(n);}});m.forEach(function(n){if(h[n]){if(l){h[n]._isDeleted=true;}else{delete h[n]._isDeleted;}}});},a=function(k){if(c.selectedIdx===c.panels.length-1){c.selectedIdx--;}W=V;K.call(c,V);if(g){var h=g.k;if(!g.defn.l&&k){var l=c.model.getDataService().newUpdateWithoutCmd();c.selectPanelDeferred(l,h,false,true);l.cmd=k.getInterimCmd();l.submit();}else{c.selectPanel(h,false,true);if(k){k.getInterimCmd().completeSubmit();}}}f(true);};if(U===Y){g=b[Y+(Y===b.length-1?-1:1)];}var d=Z.cmdMgr(),X=[Z.getRemoveUnitAction(V)];if(g){X.push(Z.getSetCurrentPanelAction(g));}Z.execute({execute:function(){this.submitInterim(X,{success:function(){a(d);}},{params:{suppressData:true}});},urInfo:{silent:true,undo:function(){c.addChildren([V]);c.selectPanel(V.k,null,true);b=c.panels;R.call(c,V,b.length-1,Y,c.children.indexOf(V),Y);W=null;f(false);},redo:a},discard:function(){if(W){W.destroy();}}});},movePanel:function P(W,X){var U=this.panels,V=U[W],Y=this.selectedIdx,Z=this.id;this.model.movePanel(V,X,W,function(c,b){if(Y===c){Y=b;}else{if(c>Y&&b<=Y){Y++;}else{if(c<Y&&b>=Y){Y--;}}}var a=mstrmojo.all[Z];V=a.children[I.find(a.children,"id",V.id)];R.call(a,V,c,b,I.find(a.children,"k",V.k),Y);});},renamePanel:function C(U,V){var W=this.id;this.model.renameRWUnitTitle(V,U.title,U.k,{success:function(X){if(U.destroyed===true){mstrmojo.all[W].panels.forEach(function(Y){if(Y.k===U.k){U=Y;}});}U.titleText=X;U.title=D.encodeHtmlString(X);F.call(mstrmojo.all[W]);}});},addPanel:function G(){var X=this,W=this.model,Y=W.getDataService(),V,U;this.controller.cmdMgr.execute({execute:function(){var Z=Y.newUpdate(this,null);V=W.addPanel(Z,X);W.addVisualizationDeferred(Z,V.k);W.selectNewPanel(Z,V.k);Z.submit();},urInfo:{disablePU:true,treesToRender:3},discard:function(){if(U){U.destroy();}}});},duplicatePanel:function A(V){var Y=this.id,X,W,U;this.model.duplicatePanel(V,this,this.builder,{undo:function(){var Z=mstrmojo.all[Y];X=Z.panels;W=X[X.length-1];K.call(Z,W);U=W;Z.selectPanel(V.k,false,true);},redo:function(){var Z=mstrmojo.all[Y];Z.addChildren([W]);Z.selectPanel(W.k,null,true);U=null;},discard:function(){if(U){U.destroy();}}});},getUIState:function T(){var V={},U=this.getSelectedPanel();V.pk=U.k;V.boxState=U.getBoxState();V.viUnitKey=this.model.getSelectedViUnit()&&this.model.getSelectedViUnit().k;return V;},restoreUIState:function J(Y){var U=this.getSelectedPanel(),X=Y.pk;if(X&&U.k!==X){this.selectPanel(X,null,true);U=this.getSelectedPanel();}var V=Y.viUnitKey;if(V){var W=U.getUnitByKey(V);if(W){this.model.selectVIUnit(W.id,true);}}var Z=Y.boxState;if(Z!==U.getBoxState()){U.restoreBoxState(Z);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.tabs.Tab","mstrmojo.dom","mstrmojo.css");var G=mstrmojo.dom,R=mstrmojo.array,d=mstrmojo.css,c="animate",W="31px";function X(){var k=window.Modernizr,h="transition";if(k.testProp(h)){return G.transEndEvtNames[k.prefixed(h)];}return null;}function D(h){return function(){this.menuNode.style.display=h?"block":"none";};}function I(h){return Math.min(h.offsetWidth-h.firstChild.offsetWidth,0);}function S(h){return h.isAlignRight?"right":"left";}function e(h,k){return parseInt(h.style[S(k)],10)||0;}function O(){var k=this.tabContainerNode,l=false,h=false;if(I(k)<0){var n=G.position(k),m=G.position(k.firstChild);l=(m.x<n.x);h=(m.x+m.w>n.x+n.w+0.1);}this.downBtnNode.style.display=l?"block":"none";this.upBtnNode.style.display=h?"block":"none";}function T(h,k){h=(h||[]);if(!h.filter){return R.filter(h,k);}return h.filter(k);}function Q(h,k){h=(h||[]);if(!h.map){return R.map(h,k);}return h.map(k);}function J(AA,l){if(this.isStatic){return ;}var x=this.tabContainerNode,w=T(this.children,function(AB){return AB.isSelected;})[0],t=w&&w.domNode;if(!x||!t){return ;}var m=G.position(x),q=x.firstChild,z=I(x),n=e(q,this),k=Math.max(n,z);if(AA){if(z<0){var p=G.position(t),r=p.x-m.x,v=p.x+p.w-(m.x+m.w),u=this.isAlignRight,h=function(AB){k=u?k+AB:k-AB;};if(r<0){h(r);}else{if(v>0){h(v);}}}}if(k!==n){var o=X();if(l&&o){d.addClass(q,c);G.attachOneTimeEvent(q,o,function(){d.removeClass(q,c);});}q.style[S(this)]=Math.max(z,Math.min(k,0))+"px";}O.call(this);}function K(h){return h.hasOwnProperty("index");}function H(){var h=this.children,k=0;(h||[]).every(function(m,l){if(!K(m)){return false;}k++;m.index=l;return true;});(h||[]).every(function(l){if(!K(l)){return false;}l.total=k;return true;});}function B(n,k){var r=n.ENUM_CORNERS,o=[r.TOP_RIGHT,r.BOTTOM_RIGHT],p=this.parent;if(p.position!=="bottom"){o.reverse();}n.setAlignment(o[0],o[1]);var m=G.position(p.domNode),h=G.position(k),l=p.menuNode;var q=l.style;q.top=(h.y-m.y)+"px";q.left=(h.x-m.x)+"px";n.addPopupHandlers(p.id,D(true),D(false));n.hostId=p.id;n.hostElement=l;n.isHostedWithin=false;p.openPopup(n.newInstance());}function Y(h){h.raiseEvent({name:"TabsChange"});}mstrmojo.vi.ui.tabs.TabStrip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-VITabStrip {@cssClass}" style="{@cssText}" ><div class="mstrmojo-VITabStrip-tabs"><div style="display:table"><div style="display:table-row"></div></div></div><div class="mstrmojo-VITabStrip-addBtn" mstrAttach:click><div></div></div><div class="mstrmojo-VITabStrip-downBtn" mstrAttach:click,mousedown><div></div></div><div class="mstrmojo-VITabStrip-upBtn" mstrAttach:click,mousedown><div></div></div><div class="mstrmojo-VITabStrip-menuHost"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{tabContainerNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild.firstChild.firstChild;},addBtnNode:function(){return this.domNode.childNodes[1];},addBtnImgNode:function(){return this.domNode.childNodes[1].firstChild;},downBtnNode:function(){return this.domNode.childNodes[2];},upBtnNode:function(){return this.domNode.childNodes[3];},menuNode:function(){return this.domNode.childNodes[4];},maskNode:function(){return this.domNode.lastChild;}},isStatic:false,isAlignRight:true,tabContainerNode:null,downBtnNode:null,upBtnNode:null,menuNode:null,position:"bottom",layoutConfig:{w:{tabContainerNode:"100%",addBtnNode:W},xt:true},onAppStateChange:function V(k){var h=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;if(k.value===h||k.valueWas===h){this.layoutConfig.w.addBtnNode=mstrApp.appState===h?"0px":W;this.doLayout();}},setStatic:function U(h,k){this.isStatic=h;if(!h){J.call(this,true,k);}},setTabs:function C(l,h){this.removeChildren();var m=this,k=l.length;this.addChildren(Q(l,function(p,n){var o=p.k;return m.getTabCfg(l,p,{scriptClass:"mstrmojo.vi.ui.tabs.Tab",index:n,total:k,draggable:!!k,dropZone:!!k,k:o,isSelected:o===h,showTabMenu:B,tabMoved:function(r){var q=this.index;this.parent.moveTab(q,q+(r?-1:1),q);}});}));J.call(this,true);Y(this);},getTabs:function N(){return T(this.children,K);},getTabCfg:function F(k,l,h){return h;},deleteTab:function P(h){var p=this.id,o=this.children[h],n=X(),m=function(){var q=mstrmojo.all[p];q.removeChildren(o);o.destroy();H.call(q);O.call(q);Y(q);};if(n){var l=o.domNode.firstChild,k=l.style;k.width=l.offsetWidth+"px";window.setTimeout(function(){d.addClass(l,c);G.attachOneTimeEvent(l,n,m);k.width=0;},0);}else{m();}},buildRendering:function E(){this._super();d.toggleClass(this.domNode,"alignLeft",!this.isAlignRight);},postBuildRendering:function Z(){var h=this._super();J.call(this,true);return h;},doLayout:function A(){this._super();J.call(this);},setSelectedTab:function b(h){(this.children||[]).forEach(function(k){k.set("isSelected",k.k===h);});Y(this);},getSelectedTab:function M(){var l=null,k=this.children||[],h;for(h=0;h<k.length;h++){if(k[h].isSelected){l=k[h];break;}}return l;},onclick:function g(h){if(h.getTarget()===this.addBtnImgNode){this.addTab();}},addTab:mstrmojo.emptyFn,onmousedown:function f(v){var q=v.getTarget().parentNode,w=(q===this.downBtnNode);if(w||q===this.upBtnNode){var u=this.tabContainerNode,p=u.firstChild,k=I(u),m=e(p,this),o=this.isAlignRight?(w?-10:10):(w?10:-10),l=this.id,r=this,n;if(mstrApp.setInteractive){mstrApp.setInteractive(false);}d.addClass(q,"active");var t=function(){window.clearInterval(n);d.removeClass(q,"active");O.call(mstrmojo.all[l]);if(mstrApp.setInteractive){mstrApp.setInteractive(true);}};G.attachOneTimeEvent(document.body,"mouseup",t);n=window.setInterval(function(){m=Math.min(Math.max(k,m+o),0);p.style[S(r)]=m+"px";if(m===k||m===0){t();}},33);}},moveTab:function L(h,r,p,o){var k=this.children,t=k.splice(h,1)[0];k.splice(r,0,t);H.call(this);var l=this.containerNode,m=l.childNodes,q=l.removeChild(m[h]),n=m[r];if(n){l.insertBefore(q,n);}else{l.appendChild(q);}if(t.isSelected){J.call(this,true,true);}if(!o&&p!==undefined&&p!==r){this.commitTabMove(p,r);Y(this);}},commitTabMove:function a(h,k){throw new Error(this.scriptClass+" must implement commitTabMove.");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi._MonitorsAppState","mstrmojo.EditableLabel","mstrmojo.vi.ui.toolbars.TitleToolbar");var I=mstrmojo.dom;mstrmojo.vi.ui.TitleBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.TitleBar",markupString:'<div id="{@id}" class="mstrmojo-VITitleBar {@cssClass}" style="{@cssText}" mstrAttach:contextmenu,click><div class="left-toolbar"></div><div class="title-text"></div><div class="right-toolbar"></div></div>',markupSlots:{leftToolNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.childNodes[1];},rightToolNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode;}},markupMethods:{ontitleChange:function(){this.lblTitle.set("text",this.title||" ");},ontoolbarCfgChange:function(){var O=this.toolbarCfg;if(!O){return ;}this.tbToolbar.set("toolbarCfg",O);this.doLayout();},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},h:{leftToolNode:"100%",textNode:"100%",rightToolNode:"100%"},xt:true},lblTitle:null,tbToolbar:null,editTitleOnClick:false,editTitleOnDoubleClick:true,title:"",close:mstrmojo.emptyFn,toolbarCfg:null,titleEdited:mstrmojo.emptyFn,useRichTooltip:true,init:function N(O){this._super(O);this.addChildren([].concat(this.getLeftToolbarChildren()).concat(this.getTitleChildren()).concat(this.getRightToolbarChildren()));},shouldShowTooltip:function J(O,Q){var P=O.target||I.eventTarget(O.hWin,O.e);return P===this.textNode.firstChild&&(P.scrollWidth>P.clientWidth);},getTooltipContent:function K(O){var Q=O.target||I.eventTarget(O.hWin,O.e),P=Q.innerHTML;return P;},showTooltip:function L(O,P){if(this.shouldShowTooltip(O,P)){this._super(O,P);}},updateTooltipConfig:function H(P){var Q=P.target||I.eventTarget(P.hWin,P.e),O=I.position(Q);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.getTooltipContent(P),top:O.y+O.h+3,left:O.x+4,cssClass:"vi-regular vi-tooltip-A"};},getLabelNode:function C(){return this.lblTitle.domNode;},getMenuConfig:function B(){var O=this.toolbarCfg;if(O){if(O.hasMenuItems()){return O;}}return null;},setToolbarVisibility:function D(O){this.tbToolbar.set("visible",O);},editTitle:function M(){this.lblTitle.set("isEditing",true);},onAppStateChange:function F(O){var P=this.lblTitle,Q=O.value===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION,R=O.valueWas===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;if(Q&&this._confgTitleEditable===undefined){this._confgTitleEditable=this.editTitleOnClick||this.editTitleOnDoubleClick;}P.set("isEditing",false);if(Q||R){P.set("editOnDoubleClick",!Q&&this._confgTitleEditable);}},getLeftToolbarChildren:function A(){},getTitleChildren:function G(){return[{scriptClass:"mstrmojo.EditableLabel",slot:"textNode",alias:"lblTitle",bindings:{editOnClick:"this.parent.editTitleOnClick",editOnDoubleClick:"this.parent.editTitleOnDoubleClick",selectable:"this.isEditing"},onTextEditComplete:function(Q,P){this.parent.titleEdited(this.text,Q,P);},getLayoutOffsets:function O(){return{h:2,w:2};}}];},getRightToolbarChildren:function E(){return[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:"rightToolNode",alias:"tbToolbar",visible:true,useRichTooltip:true}];}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.ui.PopupButton","mstrmojo.ui.PulldownCheckList");var G=mstrmojo.css,D=mstrmojo.hash,E={0:true};function B(){var O=this.selectedIndices=D.copy(this.getPopupList().selectedIndices),K=this.items,N=[],M=this.allIdx,L=this.noneIdx;if(K){if(O[M]){N.push(K[M].n);}else{if(O[L]){N.push(K[L].n);}else{mstrmojo.array.forEach(K,function(Q,P){if(O[P]){N.push(Q.n);}});}}}this.set("value",N.join(", "));}mstrmojo.ui.MultiSelectPulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown],{scriptClass:"mstrmojo.ui.MultiSelectPulldown",isHostedWithin:false,popupWidget:undefined,init:function J(K){this._super(K);G.addWidgetCssClass(this,"multi");this.hostedCSSClass=this.hostedCSSClass+" multi";},submitSelections:function A(){B.call(this);this.onchange();},_set_selectedIndices:function F(M,K){var L=this.selectedIndices=D.copy(K||this.selectedIndices||E);this.getPopupList().set("selectedIndices",L);B.call(this);return true;},select:function H(K){this.getPopupList().select(K);},getPopupWidget:function C(){return this.popupWidget;},getPopupList:function I(){return this.popupWidget.list;},children:[{scriptClass:"mstrmojo.ui.PulldownCheckList",alias:"popupWidget"}]});}());(function(){mstrmojo.requiresClsP("mstrmojo","Editor","HBox","HTMLButton","Label","SortRow","ButtonSwitch","CheckBox","_HasOwnAvatar");mstrmojo.requiresCls("mstrmojo.ui._HasScroller","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(11591,3095,11592,2968,122,221,1442,13153);var I=mstrmojo.desc,Q=mstrmojo.array,E=mstrmojo.dom,a=mstrmojo.css,K=0,c="top",R="bottom",b;mstrmojo.AdvancedSortData=null;function A(f,e){var g=new mstrmojo.SortRow(),d=mstrmojo.all[b];g.setPulldownOptions(e===K?d.sortData.rows:d.sortData.cols);g.setRank(f.children.length+1);f.addChildren([g]);}function O(n,e,k){var g,f,l,d=n.children,h=mstrmojo.all[b],m=function(){var u,t,r,q,v,p=(k===K?h.sortData.rows:h.sortData.cols),o=[];for(u=0,t=e.length;u<t;u++){v=e[u];for(r=0,q=p.length;r<q;r++){if(v.value===p[r].v){o.push(v);break;}}}return o;};if(!h.isDesignMode){e=m();}for(g=0,f=0;g<d.length&&f<e.length;g++,f++){l=e[f];d[g].setSelected(l.value,l.isAsc,l.n);}for(;g<d.length;g++){d[g].setSelected("",1);}for(;f<e.length;f++){l=e[f];A(n,k);d[f].setSelected(l.value,l.isAsc,l.n);}}function J(){var d=this.children;if(d[d.length-1].getSortKey()===""){return ;}A(this,this.type);}function F(){var d,e=this.children;for(d=0;d<e.length;d++){var f=e[d];if(f.getRank()!==d+1){f.setRank(d+1);}}}function N(){var g,f,e,k=[],l=mstrmojo.all[b],n=["appliedRows","appliedCols"],d=[];d.push(l.tabContainer.children[0].children);d.push(l.tabContainer.children[1].children);for(f=0;f<2;f++){var p=[];for(g=0;g<d[f].length;g++){e=d[f][g].getSortKey();if(e&&e!==" "){p.push({key:e,isAsc:d[f][g].isAscending()});}}if(p.length===0){if(l.sortData[n[f]].length===0){p=null;}}k.push(p);}var o=l.sortData.hierarchicalSort,m=l.hrlSortBox.checked?o.stt:null,h=l.resHrlBox.checked?"1":"0";l.controller.onAdvancedSort(l.xtab,k,null,m,h);}mstrmojo.AdvancedSortEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.AdvancedSortEditor",help:"advanced_sort_editor.htm",cssClass:"mstrmojo-AdvancedSortEditor",title:I(11591,"Advanced Sort"),tabSwitcher:undefined,tabContainer:undefined,hrlSortBox:undefined,sortData:undefined,sourceAxis:1,init:function W(d){this._super(d);b=this.id;},onOpen:function H(){var d=this.sortData,f,g=["appliedRows","appliedCols"],e=this.sourceAxis-1;Q.forEach(this.tabContainer.children,function(h,k){f=d[g[k]];Q.forEach(h.children,function(l){l.setPulldownOptions(d[k===K?"rows":"cols"]);});O(h,f,k);J.call(h);F.call(h);});if(this.sourceType===mstrmojo.mstr.EnumDSSXMLObjectTypes.Metric){e^=1;}this.tabSwitcher.set("selected",e);this.tabContainer.updateScrollbars();this.updateUseHierarchicalSort(e);},onClose:function(){Q.forEach(this.tabContainer.children,function(d){Q.forEach(d.children,function(e){e.resetPulldownOptions();});});},onTabChange:function(e){var d=this.tabContainer;d.children[e].set("visible",true);d.children[1-e].set("visible",false);d.set("selected",e);d.updateScrollbars();this.updateUseHierarchicalSort(e);},updateUseHierarchicalSort:function S(k){var h=(k===K)?"rows":"cols",p=(k===K)?"appliedRows":"appliedCols",e=this.sortData,n=e.hierarchicalSort,l=n.pref,q=n.rp,g=n.isOutlineMode,m=n.isRA,o=e[p],f=this.hrlSortBox,d=this.resHrlBox;f.set("visible",l==="1");f.set("checked",g||(l==="1"&&(o.length===0||m)));d.set("visible",false);d.set("checked",q);},updateTooltipConfig:function X(){if(E.isIE8){this.richTooltip.cssClass+=" ie8";X.repaint=!!!X.repaint;this.richTooltip.cssClass+=(X.repaint?" repaint":"");}},postBuildRendering:function Y(){this._super();this.tabContainer.domNode.onselectstart=function(){return false;};},children:[{scriptClass:"mstrmojo.ButtonSwitch",alias:"tabSwitcher",label1:I(2968,"Rows"),label2:I(122,"Columns"),switchFn:function V(){this.parent.onTabChange(this.selected);}},{scriptClass:"mstrmojo.Widget",markupString:"<div class='rulesTitles'><div>"+I(3095,"Order")+"</div><div>"+I(11592,"Sort by")+"</div></div>"},{scriptClass:"mstrmojo.SortRulesPanelContainer",alias:"tabContainer",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanelContainer"},{scriptClass:"mstrmojo.CheckBox",alias:"hrlSortBox",cssClass:"hrlSortBox",oncheckedChange:function(){if(E.isIE8){a[this.checked?"addClass":"removeClass"](this.labelNode,"checked");}},postBuildRendering:function Y(){if(E.isIE8){var e=this,d=this.labelNode;E.attachEvent(d,"click",function(){e.set("checked",!e.checked);});}},label:I(13153,"Sort metrics hierarchically")},{scriptClass:"mstrmojo.CheckBox",alias:"resHrlBox",cssClass:"resHrlBox",oncheckedChange:function(){if(E.isIE8){a[this.checked?"addClass":"removeClass"](this.labelNode,"checked");}},postBuildRendering:function Y(){if(E.isIE8){var e=this,d=this.labelNode;E.attachEvent(d,"click",function(){e.set("checked",!e.checked);});}},label:I(12420,"Respect Hierarchy")},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-WebButton Advanced-Sort-Editor-Button",text:I(221,"Cancel"),onclick:function(){mstrmojo.all[b].close();}},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-WebButton Advanced-Sort-Editor-Button",iconClass:"hot",text:I(1442,"OK"),onclick:function(){N();mstrmojo.all[b].close();}}]});function U(f,e){var d=Math.floor((f-e.y0-E.getVerticalScroll())/e.h);if(d<0){d=0;}else{if(d>=this.children.length){d=this.children.length-1;}}return d;}function B(h,f){var e=c,g=(Math.floor(h-f.y0)%f.h)/f.h,d=U.call(this,h,f);if(d===this.children.length-1){if(g>0.5||Math.floor((h-f.y0)/f.h)>d){e=R;}}else{if(g>0.5){if(d<this.children.length-1){d+=1;}}}return{edge:e,idx:d};}mstrmojo.SortRulesPanelContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.SortRulesPanelContainer",selected:undefined,setupScrollNodes:function M(){var d=this.children[this.selected||0];this.scrollNode=d.domNode;if(!d.hasEventListener){a.addClass(this.scrollNode,"mstrmojo-scrollNode");E.attachMarkupEvent(this.id,this.scrollNode,"scroll");d.set("hasEventListener",true);}},onscroll:function Z(){if(this._super){this._super();}var d;Q.forEach(this.children,function(e){if(!d){Q.forEach(e.children,function(h){if(!d){var g=h.sortRule.list,f=h.sortOrder.list;if(g.visible){d=g;}else{if(f.visible){d=f;}}}});}});if(d){d.set("visible",false);}},children:[{scriptClass:"mstrmojo.SortRulesPanel",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanel",type:0},{scriptClass:"mstrmojo.SortRulesPanel",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanel",type:1}]});mstrmojo.SortRulesPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.SortRulesPanel",dropZone:true,draggable:true,avatarCssClass:"sort-rule-drag-avatar",type:undefined,hasEventListener:undefined,getDragData:function D(){return{};},createAvatar:function T(g,f){var h=f.src.data;h.y0=E.position(this.domNode).y;h.h=E.position(this.children[0].domNode).h;h.left=E.position(this.children[0].domNode).x;var e=U.call(this,f.src.pos.y,h),d=this.children[e].domNode.cloneNode(true);h.index=e;h.node=this.children[e];return d;},positionAvatar:function L(e,d){e.x=d.src.data.left+10;this._super(e,d);},isDragValid:function C(d){if(this.children.length===1){return false;}var e=this.domNode,g=this.children[Math.floor((d.src.pos.y-E.position(e).y-E.getVerticalScroll())/E.position(this.children[0].domNode).h)],f=d.src.e.target;return !(E.contains(g.sortRule.domNode,f,true,e)||E.contains(g.sortOrder.domNode,f,true,e));},ondragstart:function(d){this._super(d);var e=d.src.data;this.removeChildren(this.children[e.index]);e.y0=E.position(this.domNode).y;},ondragmove:function P(d){var l=d.src.data,m=d.last.y,k=l.tgtIdx,g=l.tgtEdge,h=B.call(this,m,l),f=h.idx,e=h.edge;if(k!==f||g!==e){if(k!==undefined){a.removeClass(this.children[k].domNode,g);}a.addClass(this.children[f].domNode,e);l.tgtIdx=f;l.tgtEdge=e;}this._super(d);},ondragend:function G(e){var f=e.src.data,d=f.tgtIdx;if(d!==undefined){a.removeClass(this.children[d].domNode,f.tgtEdge);}if(f.tgtEdge===R){d++;}this.addChildren([f.node],d);this.updatePanel();this._super(e);},pulldownActive:function(d){mstrmojo.css.toggleClass(mstrmojo.all[b].tabContainer.domNode,"disableScroller",d);},updatePanel:function(){F.call(this);J.call(this);mstrmojo.all[b].tabContainer.updateScrollbars();},deleteSortRule:function(d){this.removeChildren(d);this.updatePanel();},itemSelected:function(){this.updatePanel();},children:[{scriptClass:"mstrmojo.SortRow"},{scriptClass:"mstrmojo.SortRow"},{scriptClass:"mstrmojo.SortRow"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.hash","mstrmojo.css");var A=mstrmojo.hash.copy;mstrmojo.ui.editors.controls.AdvancedColorPickerPopup=mstrmojo.declare(mstrmojo.ui.editors.controls.AdvancedColorPicker,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",locksHover:true,init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-AdvColorPickerPopup");},showPickerForCurrentMode:function D(){this._super();var G=this,F=function F(){if(G.visible){G.adjustCornersForPopupOverflow();}};if(this.pickerMode===2){this.colorStyle.markupMethods=A({onselectedIndexChange:F},A(this.colorStyle.markupMethods));}F();},onOpen:function C(){var F=this.parent;this.set("color",F?F.selectedValue:this.color);this.renderContent();this._super();},colorCanceled:function B(){this.close();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.array","mstrmojo.Button","mstrmojo.css","mstrmojo.hash","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.func");mstrmojo.requiresDescs(221,1442,2751,2891,11949,11950,11951,11942,13397,13398,14640,14648);var R=mstrmojo.array,U=mstrmojo.css,N=mstrmojo.hash,O=mstrmojo.func,M=mstrmojo.Button.newWebButton,P=mstrmojo.dom,T="mstrmojo-link-validation",Q="mstrmojo-link-vt",F=function F(V){if(V.old){this.removedLinks.push(V);}this.links.removeChildren(V);},S=function S(){var t=this.dsMap,p=this.docModel,Y=p.datasets,v=function v(k,x,a){var w={n:a||"",did:x||null,parent:k||null,lv:(k?k.lv+1:-1),children:[]};if(k){k.children.push(w);}return w;},e=v(),X,W,V,g,Z,q,l,u,r,o,n,m,c,b,d,h,f;N.forEach(Y,function(a){if(p.isMDXDataset(a)){Z=a.tables;for(o=0,b=Z.length;o<b;o++){q=Z[o];X=v(e,q.did,q.n);X.isMDX=true;for(n=0,d=q.dimensions.length;n<d;n++){l=q.dimensions[n];W=v(X,l.did,l.n);for(m=0,h=l.hierarchies.length;m<h;m++){u=l.hierarchies[m];V=v(W,u.did,u.n);for(c=0,f=u.att.length;c<f;c++){r=u.att[c];g=v(V,r.did,r.n);g.att=r;t[q.did+":"+r.did]=g;}}}}}else{X=v(e,a.did,a.name);X.isMDX=false;R.forEach(a.att,function(k){g=v(X,k.did,k.n);g.att=k;t[a.did+":"+k.did]=g;});}});return e;},B=function B(b,c){b=R.ensureArray(b);var a=this,Z=this.attribute.did,d=this.docModel,X=d.findDatasetIdFromUnit(Z),W="\u001F",V={success:function(f){var h=f.als,e=(d.als&&d.als.links)||{},g=a.dsTree;R.forEach(b,function(r,m){var t={},k={},l=[],n={},q=Z+" "+r,o=R.filter(h[m].ats,function(u){return !d.isInDataset(X,u.at,["att"]);}),p=function p(u,v){if(!n[u]){n[u]={};}if(!n[u][v]){n[u][v]=true;}};R.forEach(o,function(w){var u=w.at,v=w.fms;t[u]=true;if(v){R.forEach(v,function(x){p(u,x.fm);});}});N.keyarray(e).forEach(function(u){if(u===q){R.forEach(e[u],function(v){v=v.split(" ");t[v[0]]=true;p(v[0],v[1]);});}});if(N.keyarray(t).length>0){R.forEach(g.children,function(v){var u=function(w){var x;if(!w.att){return ;}w=w.att;if(t[w.did]){if(!k[w.n]){k[w.n]={};}if(!k[w.n][w.did]){k[w.n][w.did]=[];}k[w.n][w.did].push(v.n);x=N.copy(w,x);x.dsId=v.did;l.push(x);}};if(v.isMDX){R.forEach(v.children,function(w){R.forEach(w.children,function(x){R.forEach(x.children,u);});});}else{R.forEach(v.children,u);}});}a.tgtAttrs[r]=l;a.tgtForms[r]=n;a.namesHash[r]=k;});}},Y={taskId:"validateDocumentLinks",msgID:d.mid,action:1,attributeList:Z,attributeFormList:b.join(W)};mstrApp.serverRequest(Y,O.wrapMethods(V,c));},E=function(Y,a,W,Z){Y.richTooltip=null;if(!Y.isSearching){var X=a&&a.scrollWidth>a.clientWidth;W=X?mstrmojo.desc(14648,"## from ###").replace("##",W):"";if(Z){if(!X){W=mstrmojo.desc(14640,"From ###");}W=W.replace("###",Z);}var V=mstrmojo.dom.position(a);Y.richTooltip={cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:W,top:V.y-6,left:V.x};}},D=function D(c){var d=this,f=function(o){var m=o.fs,p=o.de,n=[];(m||[]).forEach(function(q){if(q.obf&&(!p||q.idf)){n.push({n:q.fnm,v:q.fid,idf:q.idf});}});return n;},g=f(this.attribute),Z=function(p,n){var m=f(p);var q=(d.tgtForms[n]&&d.tgtForms[n][p.did])||{};var o=[];R.forEach(m,function(r){if(q[r.v]){o.push(r);}});return o;},b=function b(n){var m=[];R.forEach(d.tgtAttrs[n],function(o){if(Z(o,n||d.idFormId).length>0){var q=d.namesHash[n],p=o.n;if(q[o.n]&&N.keyarray(q[o.n]).length>1){p=p+" ("+q[o.n][o.did].join(",")+")";}m.push({n:o.n,v:o,tt:p});}});if(m.length===0){m.push({n:mstrmojo.desc(13398,"No valid object"),v:{did:null},cls:"nvo",t:1});}return m;},h=b((c&&c.srcFormId)||this.idFormId),k=function(m,n){return R.find(m.fs,n?"fid":"idf",n||true);},l=function(n){var m=-1;h.forEach(function(p,o){if(p.v.did===n){m=o;}});return m;},W=function(n){var m=h[n];if(!m){return mstrmojo.desc(13397,"Select an attribute");}else{return m.n;}},X=function(n){var o=n.items,m=n.selectedIndex;if(m>=0){if(o[m].idf){return ;}}o.forEach(function(q,p){if(q.idf){n.set("selectedIndex",p);}});};this.links.addChildren({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linkRow",slot:"containerNode",old:!!c,oldMeta:c,getMeta:function(){var m=this.linkFromForm,o=this.linkToAtt,n=this.linkToForm;return{srcAttrId:d.attribute.did,srcFormId:m.items[m.selectedIndex].v,tgtAttrId:o.items[o.selectedIndex]&&o.items[o.selectedIndex].v.did,tgtFormId:n.items[n.selectedIndex]&&n.items[n.selectedIndex].v};},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-attName",text:d.attribute.n,useRichTooltip:true,updateTooltipConfig:function(q){var p=q.target,m=this.text,n=d.datasetId,o=n?d.docModel.datasets[n].name:"";E(this,p,m,o);}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormFromPD",alias:"linkFromForm",value:"ID",isHostedWithin:true,items:g,selectedIndex:k(d.attribute,c&&c.srcFormId),onitemSelected:function(n){var m=this,o=function(){var q=m.parent.linkToAtt;h=b(n.v);q.set("items",h);q.set("selectedIndex",-1);q.set("text",mstrmojo.desc(13397,"Select an attribute"));U.addClass(q.selectedNode,"nvo");},p={success:o};if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!n.idf){X(this.parent.linkToForm);if(!d.tgtForms[n.v]){B.call(d,n.v,p);return ;}}o();}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-linksToLabel",text:mstrmojo.desc(11949,"links to")},{scriptClass:"mstrmojo.ui.SearchablePulldown",cssClass:"mstrmojo-linkToAtt",alias:"linkToAtt",useRichTooltip:true,isHostedWithin:false,items:h,text:W(l(c&&c.tgtAttrId)),selectedIndex:l(c&&c.tgtAttrId),allowCustomText:true,allowEmptyText:true,updateTooltipConfig:function(r){var q=r.target,m=q.getAttribute("tt"),o=this.getSelectedItem(),n=o?o.v.dsId:null,p=n?d.docModel.datasets[n].name:"";if(this.selectedNode===q&&o){m=o.tt;}E(this,q,m,p);},onitemSelected:function(q){if(!q||q.v.did===null){return ;}var p=this.parent.linkToForm,o=this.parent.linkFromForm,n=Z(q.v,o.items[o.selectedIndex].v),r=function r(t,v){var u=R.find(t,v?"v":"idf",v||true);if(u===-1&&t.length>0){u=0;}return u;},m;R.forEach(n,function(t){if(t.idf){m=false;return false;}});if(m){K.call(d,true);}p.set("items",n);p.set("selectedIndex",r(n,!this.hasRendered&&c&&c.tgtFormId));if(this.hasRendered&&this.parent.old){this.parent.oldUpdated=true;}J.call(d);},onPopupWidgetOpened:function a(){if(this.selectedIndex===-1){this.set("text","");}U.removeClass(this.selectedNode,"nvo");},onPopupWidgetClosed:function e(){mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this);if(this.selectedIndex===-1&&this.text===""){this.set("text",mstrmojo.desc(13397,"Select an attribute"));U.addClass(this.selectedNode,"nvo");}else{U.removeClass(this.selectedNode,"nvo");}this.hideTooltip();R.forEach(d.collapseTargets,function(m){m.className="arrow-b";U.removeClass(m.parentNode.parentNode,"collapse");});R.forEach(d.collapseTreeNodes,function(m){delete m.collapse;});R.forEach(this.list.itemsContainerNode.childNodes,function(m){m.style.display="";});},postBuildRendering:function V(){mstrmojo.ui.SearchablePulldown.prototype.postBuildRendering.call(this);if(this.selectedIndex===-1){U.addClass(this.selectedNode,"nvo");}this.list.popupConfig.clear();},getPopupListConfig:function Y(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",width:"170px",tooltipOrientation:"vertical",selectionPolicy:"reselect",useRichTooltip:true,locksHover:true,listHooks:{select:function m(t,u,r){this.parent.set("selectedIndex",r);this.close();}},onclick:function n(AB){try{var t=AB.getTarget(),AC=this.getItemFromTarget(t),x=P.findAncestorByAttr(t,"idx",true,this.domNode);if(AC){AB.cancel();if(t.className==="arrow-b"||t.className==="arrow-r"){var w=this.items,r=this.itemsContainerNode.childNodes,v=function v(AE){var AD;while(AE){AD=AE.className||"";if(AD.indexOf("lv")===0){return window.parseInt(AD.substring(2),10);}AE=AE.firstChild;}return null;},AA=function AA(AD,AG){var AF=d.dsMap,AE=AF[AD.dsId+":"+AD.did];while(AE){if(AE.lv===AG){return AE;}AE=AE.parent;}return null;},z=function z(){var AM=(t.className==="arrow-b"),AG=t.parentNode.parentNode,AD=v(AG),AH=AC._renderIdx,AE=AA(AC.v,AD),AK=w.length,AJ,AF,AI,AL,AO,AN;t.className=AM?"arrow-r":"arrow-b";if(!d.collapseTargets){d.collapseTargets=[];}d.collapseTargets.push(t);U.toggleClass(AG,"collapse",AM);AE.collapse=AM;if(!d.collapseTreeNodes){d.collapseTreeNodes=[];}d.collapseTreeNodes.push(AE);for(AJ=AH+1;AJ<AK;AJ++){AF=r[AJ];AI=v(AF);if(AI<=AD){break;}AL=AA(w[AJ].v,AI);AO=AL.parent;AN=true;while(AO){if(AO.collapse){AN=false;break;}AO=AO.parent;}AF.style.display=(AN?"":"none");}};z();}else{if(x&&x.node.className.indexOf("item")!==-1){this.doItemSelect(AC,AB||{});}}}}catch(u){mstrApp.onerror(u);}},getItemProps:function o(u,r){var t=mstrmojo._IsList.getItemProps.call(this,u,r);var v=u.cls;if(v){t.addCls(v);}return t;},getItemMarkup:function q(AD,AC){if(AD.v.did===null){return'<{@tag} class="item {@cls}" did="'+AD.v.did+'" idx="{@idx}" style="{@style}">{@n}</{@tag}>';}var AE=[],AA=AD.v.did,u=AD.v.dsId,v=u?d.docModel.datasets[u]:null,t=v?v.name:"",AB=AC>0&&this.items[AC-1].v,x=d.dsMap,w=x[AD.v.dsId+":"+AA],r=x[(AB&&(AB.dsId+":"+AB.did))];AE.push("</div>");while(w){if(w.lv===-1){break;}if(w.att){var z=w.att.da?"derived-attr":"attr";AE.push('<div class="lv'+w.lv+' dim item {@cls}" tt="'+AD.tt+'" did="'+AA+'" dsName="'+t+'" idx="{@idx}" style="{@style}"><div><div class="'+z+'"></div></div>{@n}</div>');}else{if(w!==r){AE.push('<div class="lv'+w.lv+' dim" dtt="'+w.n+'" idx="{@idx}"><div><div class="arrow-b"></div></div>'+w.n+"</div>");}else{break;}}w=w.parent;r=(r&&r.parent)||null;}AE.push("<div>");return AE.reverse().join("");},updateTooltipConfig:function p(x){var w=x.target,u=w.getAttribute("tt"),t=w.getAttribute("dtt"),v=w.getAttribute("dsName"),r=u||t;if(r){E(this,w,r,v);}}};}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormToPD",alias:"linkToForm",value:"ID",isHostedWithin:true,items:[],onitemSelected:function(m){if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!m.idf){X(this.parent.linkFromForm);}}}},M("",function(){F.call(d,this.parent);},false,{cssClass:"mstrmojo-removeLink"})]});this.links.renderChildren();},K=function(V){U.toggleClass(this.editorNode,"mstrmojo-advanced",V);},L=function(Y){var W=this,Z=T,V;try{mstrmojo.all[Z].destroy();}catch(X){}V={scriptClass:"mstrmojo.Editor",id:Z,title:mstrmojo.desc(2751,"Message"),cssClass:"mstrmojo-alert",buttons:[M(mstrmojo.desc(1442,"Ok"),function(){mstrmojo.all[Z].destroy();H.call(W);},true)],children:[{scriptClass:"mstrmojo.Label",text:Y}],visible:true,zIndex:1000};mstrmojo.insert(V).render();},H=function(){var X=this,W=this.illLinks,V=this.links.children,Y=Q;R.forEach(W,function(Z){Z=Z.al;R.forEach(V||[],function(b){var d=b.getMeta(),e=b.linkToAtt,a,c;if(d.srcAttrId===Z.alaid1&&d.tgtAttrId===Z.alaid2){if(!mstrmojo.all[Y]){c=new mstrmojo.Tooltip({id:Y,cssClass:X.themeClassName+" vi-warning vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,updatePopupConfig:null});P.attachEvent(X.editorNode,"click",function(){c.close();U.toggleClass(e.selectedNode,"mstrmojo-Warning",false);});}else{c=mstrmojo.all[Y];}c.close();a=mstrmojo.dom.position(e.selectedNode);c.set("top",a.y-6);c.set("left",a.x);c.set("content",Z.alstmsg);U.toggleClass(e.selectedNode,"mstrmojo-Warning",true);c.open();return false;}});});},A=function(){var V=mstrmojo.all[Q];if(V){V.close();}},J=function J(){this.buttons[0].enabled=true;if(this.btnHbox){this.btnHbox.children[0].set("enabled",true);}},G=function G(){var V=this,W=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-addLink",text:mstrmojo.desc(11950,"Add A Link"),title:mstrmojo.desc(11950,"Add A Link"),onclick:function(){D.call(V);A.call(V);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-showForms",text:mstrmojo.desc(2891,"Show Attribute Forms"),title:mstrmojo.desc(2891,"Show Attribute Forms"),onclick:function(){K.call(V,true);A.call(V);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-hideForms",text:mstrmojo.desc(11951,"Hide Attribute Forms"),title:mstrmojo.desc(11951,"Hide Attribute Forms"),onclick:function(){K.call(V,false);A.call(V);}}],slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linksBox mstrmojo-advanced",alias:"links",slot:"containerNode"}];this.addChildren(W);};mstrmojo.vi.ui.editors.AttributeLinkEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",title:mstrmojo.desc(11942,"Link Attributes"),cssClass:"mstrmojo-att-link",btnAlignment:"right",buttons:null,modal:true,visible:false,help:"link_attributes_editor.htm",attribute:null,tgtAttrs:null,tgtForms:null,docModel:null,datasetId:null,namesHash:null,removedLinks:null,preBuildRendering:function C(){var Y=this,W=this.docModel,X=function(){var Z=(W.als&&W.als.links)||{},a=[];N.keyarray(Z).forEach(function(b){if(b.indexOf(Y.attribute.did+" ")===0){Z[b].forEach(function(c){a.push({srcAttrId:b.split(" ")[0],srcFormId:b.split(" ")[1],tgtAttrId:c.split(" ")[0],tgtFormId:c.split(" ")[1]});});}});return a;},V;this.set("buttons",[M(mstrmojo.desc(1442,"OK"),function(){var g=[],a=Y.links.children,Z=function(){var h=W.controller,k=W.controller.getRefreshCallback();if(g.length>0){h.cmdMgr.execute({execute:function(){this.submit(g,k);},urInfo:{callback:k}});}Y.close();},f=false,c,d;Y.removedLinks.forEach(function(h){c=N.copy(h.oldMeta,{act:"applyAttributeLinking",unlink:true});g.push(c);});(a||[]).forEach(function(h){if(h.old&&h.oldUpdated){c=N.copy(h.oldMeta,{act:"applyAttributeLinking",unlink:true});g.push(c);}if(!h.old||(h.old&&h.oldUpdated)){d=h.getMeta();if(!d.tgtAttrId){return ;}c=N.copy(d,{act:"applyAttributeLinking",unlink:false});g.push(c);}});R.forEach(g,function(h){if(!h.unlink){f=true;return false;}});if(!f){Z();return ;}var e={taskId:"validateDocumentLinks",msgID:W.mid,action:2,manipulationList:'{"ml":'+JSON.stringify(g)+"}"},b={success:function(h){if(h.als&&h.als.length>0){var k="";R.forEach(h.als,function(l){k+=l.al.alstmsg+"\n";});Y.illLinks=h.als;L.call(Y,k);return ;}Z();}};mstrApp.serverRequest(e,b);},true,{enabled:false}),M(mstrmojo.desc(221,"Cancel"),function(){Y.close();})]);G.call(this);V=X(this.attribute.did);if(V.length>0){V.forEach(function(Z){D.call(Y,Z);});J.call(this);}else{D.call(this);}this._super();},close:function I(){A.call(this);this.destroy();}});mstrmojo.vi.ui.editors.AttributeLinkEditor.open=function(b){var W=mstrmojo.insert(N.copy(b,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",tgtAttrs:{},tgtForms:{},namesHash:{},removedLinks:[]})),Z=W.attribute,c=Z.did,V=W.docModel,Y=(V.als&&V.als.links)||{},X=[],a={success:function(){W.set("visible",true);W.render();}};R.forEach(Z.fs,function(d){if(d.idf){W.idFormId=d.fid;return false;}});N.keyarray(Y).forEach(function(e){var d=e.split(" ");if(d[0]===c){X.push(d[1]);}});if(R.indexOf(X,W.idFormId)===-1){X.push(W.idFormId);}W.dsMap={};W.dsTree=S.call(W);B.call(W,X,a);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.onetier.vi.prefs.LoginEditor","mstrmojo.vi.models.editors.ControlsViewFactory","mstrmojo.Editor","mstrmojo.hash");var U=mstrmojo.hash;function I(l){var m=mstrmojo.desc(14575,"Login failure."),o={"-50":mstrmojo.desc(14015,"Desktop cannot download dashboards with prompts that require an answer but do not have a default answer set."),"-51":mstrmojo.desc(14062,"You are not allowed to download dashboards from the server. Please check with the administrator of the project."),"-52":mstrmojo.desc(14063,"You are not allowed to upload dashboads to the server. Please check with the administrator of the project."),"-2147202292":m,"-2147216959":m};var n=o[l.taskErrorCode]||l.errorMessage||l.message||(l.taskErrorCode&&"TaskErrorCode:"+l.taskErrorCode+" (No error message).")||(l.getResponseHeader&&l.getResponseHeader("X-MSTR-TaskFailureMsg"));if(l.taskErrorCode!==-2147028992&&n!==undefined){mstrmojo.error({longDesc:n},undefined,{zIndex:100000});}return !n;}mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase",showPreferencesEditor:function B(){this.throwAbstractMethodError("savePreferences");},savePreferences:function c(l){this.throwAbstractMethodError("savePreferences");},getSavedPreferences:function g(l){this.throwAbstractMethodError("getSavedPreferences");},deleteServerConnections:function F(l){this.throwAbstractMethodError("deleteServerConnections");},testServerConnection:function J(l,m){this.throwAbstractMethodError("testServerConnection");},loginToWebserver:function C(m,o,l,n){this.throwAbstractMethodError("loginToWebserver");},loginToProxy:function D(p,o,l,m,n){this.throwAbstractMethodError("loginToProxy");},httpStatusCodeHandler:function k(p,l,n){var m=this,o;if(p===401||p===407){o=new mstrmojo.onetier.vi.prefs.LoginEditor(U.copy(n,{onLoginCancelled:function q(){m.authenticationCancelled();}}));}switch(p){case 200:l();break;case 401:case 407:o.open();break;case 404:case 500:mstrmojo.alert(mstrmojo.desc(13690,"Unable to connect to the server now. Please check your connection."));break;}},authenticationCancelled:function R(){this.throwAbstractMethodError("authenticationCancelled");},resumeDashboardExecution:function M(){this.throwAbstractMethodError("authenticationCancelled");},checkForDesktopUpdates:function Z(){this.throwAbstractMethodError("checkForDesktopUpdates");},showProxyEditor:function O(){this.throwAbstractMethodError("showProxyEditor");},getProjects:function L(l,m){this.throwAbstractMethodError("getProjects");},getSessionState:function Y(n,m,l,o,p){this.throwAbstractMethodError("getSessionState");},getLoginFirstSessionState:function d(l,m){this.throwAbstractMethodError("getLoginFirstSessionState");},login:function S(l,m){this.throwAbstractMethodError("login");},loginFirst:function S(l,m){this.throwAbstractMethodError("loginFirst");},sendWebServerRequest:function X(m,n,l){this.throwAbstractMethodError("sendWebServerRequest");},saveToServer:function E(l,m){this.throwAbstractMethodError("saveToServer");},openFromServer:function A(l,m){this.throwAbstractMethodError("openFromServer");},loadCube:function a(l,m){this.throwAbstractMethodError("loadCube");},getCubeInfo:function G(l,m){this.throwAbstractMethodError("getCubeInfo");},getPublicCloudSession:function N(l,m){this.throwAbstractMethodError("getPublicCloudSession");},saveToPublicCloud:function T(l,m){this.throwAbstractMethodError("saveToPublicCloud");},logout:function b(l,m){this.throwAbstractMethodError("saveToPublicCloud");},getWebServersProjects:function K(r){var l={},q=0,o=false,p=function(u){if(u&&!u.wsservlet){var w=this.parseServerURL(u.url);u.wsservlet=w.wsservlet;u.wsfolderpath=w.wsfolderpath;}return{success:function x(z){l[u.id]={};l[u.id].connection=u;l[u.id].loginInfo=z.loginInfo;if(z.loginRequired){l[u.id].loginFirst=true;}else{l[u.id].clusters=z.clusters;}},failure:function v(z){if(z.code===403){o=true;}else{if(!I(z)){if(z.status===401){l[u.id]={};l[u.id].connection=u;l[u.id].loginFirst=true;}}}},complete:function t(){q--;if(q===0){r.success(l,o);}}};}.bind(this),n=function n(t){this.getSavedPreferences({success:function v(w){t.success((w&&w.server&&w.server.conn)||[]);},failure:function u(w){t.failure(w);}});},m=function m(u,t){this.getProjects(u,t);};n.call(this,{success:function(t){t.forEach(function(u){if(u.url){q++;var w={connectionId:u.id},v=function(){m.call(this,w,p(u));}.bind(this);this.getLoginFirstSessionState(u.id,{success:function(x){w.sessionState=x.sessionState;v();},failure:function(){v();}});}}.bind(this));if(q===0){r.success(l);}}.bind(this),failure:function(t){r.failure(t);}});},getObjectInfo:function Q(l,m){this.throwAbstractMethodError("getObjectInfo");},getUserServices:function H(l,m){this.throwAbstractMethodError("getUserServices");},saveObjectACL:function P(l,m){this.throwAbstractMethodError("saveObjectACL");},getUserEntityInfo:function W(l,m){this.throwAbstractMethodError("getUserEntityInfo");},isCurrentProject:function h(m,l){this.throwAbstractMethodError("isCurrentProject");},getCleanDocModel:function f(l){this.throwAbstractMethodError("getCleanModel");},getDefaultPort:function V(l){return l==="https:"?443:80;},parseServerURL:function e(n){var t=document.createElement("a"),m="j2ee",o="asp";t.href=n;var q={};if(t.protocol!=="http:"&&t.protocol!=="https:"){t.href="http://"+n;}t.search.substr(1).split("&").forEach(function(v){var u=v.split("=");if(u.length===2){q[u[0].toLowerCase()]=u[1];}});var l=t.pathname.split("/"),r=l.pop(),p=l.splice(1,1)[0];return{url:n,conntp:t.protocol,wsn:t.hostname,wsport:t.port||this.getDefaultPort(t.protocol),wsfolderpath:l.join("/"),wsservlet:r,wspath:p,wstp:r.indexOf(".aspx")===-1?m:o,search:q};}});mstrmojo.onetier.vi.prefs.handleErrorMessage=I;}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.Button","mstrmojo.date","mstrmojo.ui.editors.controls.Stepper","mstrmojo.css");var AE=function(){return mstrmojo.locales.datetime;},k=mstrmojo.dom,h=mstrmojo.expr,AB=h.DTP,Z=mstrmojo.date,J=mstrmojo.publisher,e=mstrmojo.hash,m=mstrmojo.array,N=m.removeIndices,l=mstrmojo.css;var AD=0,C=3,M=4,p=5,Q=6;var AF="month",c="day",V="year",X="hour",AI="minute",x="second";var G='<table border="0" cellpadding="0" cellspacing="0">',w="</table>";function O(AJ){return'<table border="0" cellpadding="0" cellspacing="0" style="'+AJ+'">';}function H(AM,AJ,AK){var AL=Z.getFirstDateOfMonth(AM,AJ);return(AL.getDay()-AK+8)%7;}function n(AM){var AL=Z.parseDateAndOrTime(AM),AN,AJ,AK;if(AL){AK={};AN=AL.date;AJ=AL.time;if(AN){e.copy(AN,AK);}if(AJ){e.copy(AJ,AK);}}return AK;}function F(AK,AN,AM,AL,AJ){var AO=Z.formatDateInfo({day:AK,month:AN,year:AM},AE().DATEOUTPUTFORMAT);return Z.inDateTimeRange(AO,AL,AJ)===0;}function T(AN,AM,AL){var AK=AN.decreaseButton,AJ=AN.increaseButton,AO="mstrmojo-Calendar";AK.className=(AO+"-decrease");AJ.className=(AO+"-increase");}function W(AN,AK,AP,AM){var AL=0,AJ=AN.length,AO;for(AL=0;AL<AJ;AL++){AO=AN[AL];if(AO&&AO.day===AK&&AO.month===AP&&AO.year===AM){return AL;}}return -1;}function q(AJ,AL,AK){var AM=new Date();return(AM.getFullYear()===AK)&&((AM.getMonth()+1)===AL)&&(AM.getDate()===AJ);}function v(AQ,AR){var AV=AQ.dayView.getElementsByTagName("div"),AT=AQ.selectedDates,AL=AT[AR],AU=AQ.browseYear,AK=AQ.browseMonth,AN=Z.getDaysOfMonth(AU,AK),AM=Z.getPreMonth(AU,AK),AP=Z.getDaysOfMonth(AM.y,AM.m),AJ=H(AU,AK,AQ.firstDayOfWeek),AO=((AL.month===AK)?AL.day+AJ-1:(AL.month>AK?AL.day+AJ+AN-1:AJ-AP+AL.day-1)),AS=AV[AO];if(AS){b(AS,AQ,false);}N(AT,AR,1);}function B(AJ){var AK=AJ.selectedDates;while(AK.length){v(AJ,0);}}function AH(AL,AJ){var AK=K(AL,AJ),AM=AL.selectedDates;AM.push({day:AK.d,month:AK.m,year:AK.y});b(AJ,AL,true);}function o(AL,AM){if(!AM||!AM.length){return null;}var AO=AL.selectedDates;for(var AK=0,AJ=AM.length;AK<AJ;AK++){var AN=AM[AK],AP=r(AL,AN);AO.push({day:AN.d,month:AN.m,year:AN.y});if(AP){b(AP,AL,true);}}}function r(AR,AT){var AV=AR.dayView.getElementsByTagName("div"),AM=AV.length,AU=AR.browseYear,AK=AR.browseMonth,AN=Z.getPreMonth(AU,AK),AO=Z.getDaysOfMonth(AN.y,AN.m),AZ=Z.getNextMonth(AU,AK),AL=Z.getDaysOfMonth(AU,AK),AJ=H(AU,AK,AR.firstDayOfWeek);var AP=AJ>0?{y:AN.y,m:AN.m,d:AV[0].innerHTML}:{y:AU,m:AK,d:AV[0].innerHTML},AX=(AV.length-AL-AJ)>0?{y:AZ.y,m:AZ.m,d:AV[AM-1].innerHTML}:{y:AU,m:AK,d:AV[AM-1].innerHTML},AY=S(AP,AT),AQ=S(AT,AX),AS=null;if(AY>=0&&AQ>=0){var AW=0;if(AY<AJ){AW=-1;}if(AQ<(AV.length-AJ-AL)){AW=1;}AS=((AW===0)?AT.d+AJ-1:(AW===1?AT.d+AJ+AL-1:AJ-AO+AT.d-1));return AV[AS];}else{return null;}}function f(AR,AJ){var AT=AR.selectedDates,AL=AT.length;if(!AL){return null;}var AK=AT[AL-1],AM=K(AR,AJ),AW=S({y:AK.year,m:AK.month,d:AK.day},AM),AX=[],AO=AW>0,AU=Math.abs(AW);for(var AQ=0;AQ<=AU;AQ++){var AP=new Date(AM.y,AM.m-1,AM.d);AP.setDate(AP.getDate()+(AO?-AQ:AQ));var AV=AP.getFullYear(),AN=AP.getMonth()+1,AS=AP.getDate();if(AR.isDateDisabled(AS,AN,AV,AR.min,AR.max)&&!AR.canSelectDisabledDate){continue;}AX.push({y:AV,m:AN,d:AS});}return AX;}function S(AM,AL){var AJ=new Date(AM.y,AM.m-1,AM.d),AK=new Date(AL.y,AL.m-1,AL.d);return(AK-AJ)/1000/3600/24;}function K(AL,AJ){var AM=AL.browseYear,AO=AL.browseMonth,AN=parseInt(AJ.innerHTML,10),AP=parseInt(AJ.getAttribute("m"),10),AK=null;AK=(AP===0)?{y:AM,m:AO}:(AP===1?Z.getNextMonth(AM,AO):Z.getPreMonth(AM,AO));AK.d=AN;return AK;}function g(AJ){var AL=AJ.selectedDates,AK=AL.length;return(AK===0)?null:AL[AK-1];}function b(AK,AL,AJ){var AM=AL.selectedColor;l.toggleClass(AK,["selected",AL.selectedCssStyle],AJ);AK.parentNode.style.backgroundColor=AJ?AM:"";AK.style.backgroundColor=AJ?AM:"";}function AA(AJ){return AJ.selectedColor?('style="background-color:'+AJ.selectedColor+';"'):"";}function P(AJ){return(AJ.tagName.toLowerCase()==="td")?AJ.firstChild:AJ;}function R(AK,AL){var AM=Z.getDateJson(AK),AJ=Z.formatDateInfo(AM,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);if(AL===AB.TIMESTAMP){AJ+=" "+Z.formatTimeInfo(this.timeVal,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return AJ;}function t(AO,AL){var AJ=this.advancedValues,AK=null;AJ.set(AO,AL);switch(AJ.baseDate){case C:AK=new Date();break;case M:break;case p:break;case Q:break;default:return ;}var AM=AJ.monthsToAdjust;if(AM>0){AK.setMonth(AK.getMonth()+(AJ.toAddMonths?AM:-AM));}var AN=AJ.daysToAdjust;if(AN>0){AK.setDate(AK.getDate()+(AJ.toAddDays?AN:-AN));}this.set("value",R.call(this,AK,this.dtp));}function U(){var AJ=this.advancedValues,AK=["isDyn"];if(AJ.baseDate===AD){return null;}AK.push(AJ.baseDate);AK.push(AJ.toAddDays?AJ.daysToAdjust:-AJ.daysToAdjust);AK.push(AJ.toAddMonths?AJ.monthsToAdjust:-AJ.monthsToAdjust);AK.push(0);AK.push(0);AK.push(0);AK.push(0);AK.push(this.value);AK.push(this.timeVal.hour);AK.push(this.timeVal.min);AK.push(this.timeVal.sec);return AK.join("::");}function AG(AJ){if(AJ.value!==undefined&&this.hasRendered){this.updateSelectedDate();}}function I(AL,AK){var AM=this,AJ=function(AN){return AN[0].toUpperCase()+AN.substring(1);};return{scriptClass:"mstrmojo.HBox",cssClass:"dateAdjustBox",alias:AL+"AdjustBox",children:[{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:AK>=0?0:1,onitemSelected:function(AO,AN){t.call(AM,"toAdd"+AJ(AL),AN===0);},items:[{did:0,n:mstrmojo.desc(9424,"plus")},{did:1,n:mstrmojo.desc(9425,"minus")}]},{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:null,height:null,provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,min:0,value:Math.abs(AK)},onTraverse:function(){t.call(AM,AL+"ToAdjust",this.curVal);}})},{scriptClass:"mstrmojo.Label",text:AL==="days"?mstrmojo.desc(707,"Days"):mstrmojo.desc(710,"Months")}]};}function Y(){this.buttonsNode.style.display=(this.wasAdvanced||this.changeValueOnOK||(this.showAdvanced&&this.isAdvanced)?"block":"none");this.advancedNode.style.display=this.showAdvanced?"block":"none";}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Calendar",cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:c,duration:600,timeDelimiter:":",dtp:AB.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,wasAdvanced:false,showAdvanced:false,isAdvanced:false,dynDateValue:null,canSelectDisabledDate:false,monthNames:function(AJ){return AE().MONTHNAME_SHORT[AJ];},dayNames:function(AJ){return AE().dayShortNames[AJ];},min:null,max:null,supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,mouseover,mouseout><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease"></div><div class="mstrmojo-Calendar-increase"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}">{@browseMonth}</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel">00</span><span class="mstrmojo-Calendar-AMPMLabel">AM</span></div><div class="mstrmojo-Calendar-advanced"></div><div class="mstrmojo-Calendar-buttons cf"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){this.monthLabel.innerHTML=this.monthNames(this.browseMonth-1);},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;},ondtpChange:function(){this.timePart.style.display=(this.dtp===AB.TIMESTAMP||this.dtp===AB.TIME)?"block":"none";this.advancedNode.style.display=this.showAdvanced?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:Y,onisAdvancedChange:Y},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].firstChild;},yearView:function(){return this.domNode.childNodes[1].firstChild;},hourView:function(){return this.domNode.childNodes[1].firstChild;},minuteView:function(){return this.domNode.childNodes[1].firstChild;},secondView:function(){return this.domNode.childNodes[1].firstChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},AMPMLabel:function(){return this.domNode.childNodes[2].childNodes[5];},advancedNode:function(){return this.domNode.childNodes[3];},buttonsNode:function(){return this.domNode.childNodes[4];}},init:function AC(AJ){if(this._super){this._super(AJ);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};},ondynDateValueChange:function u(AJ){if(AJ.value!==undefined&&this.hasRendered){this.updateSelectedDate();this.buildChildren();}},onminChange:AG,onmaxChange:AG,buildChildren:function a(){var AP=this;if(this.showAdvanced){var AM=this.dynDateValue,AL=this.advancedValues||this.addDisposable(new mstrmojo.Model({})),AS=AM&&AM.split("::")||[],AO=AS[1]||AD,AK=AS[2]||0,AT=AS[3]||0,AQ=function AQ(){if(AP.isAdvanced){AP.wasAdvanced=true;AP.changeValueOnOK=true;}AP.set("isAdvanced",!AP.isAdvanced);mstrmojo.css.toggleClass(AP.markupSlots.dayView.call(AP),["ddSelected"],AP.isAdvanced);t.call(AP,"baseDate",AP.isAdvanced?3:0);if(AP.parent&&AP.parent.nudge&&AP.isAdvanced){AP.parent.nudge();}};this.advancedValues=AL;AL.baseDate=parseInt(AO);AL.toAddDays=AK>=0;AL.daysToAdjust=Math.abs(AK);AL.toAddMonths=AT>=0;AL.monthsToAdjust=Math.abs(AT);this.isAdvanced=!!this.dynDateValue;if(this.domNode){mstrmojo.css.toggleClass(this.markupSlots.dayView.call(this),["ddSelected"],this.isAdvanced);}if(this.isAdvanced&&this.value){var AJ=n(this.value),AN=this.timeVal;if(AJ&&AJ.hour!==undefined){AN.hour=AJ.hour;AN.min=AJ.min;AN.sec=AJ.sec;}}t.call(AP,"baseDate",this.isAdvanced?3:0);this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.HBox",alias:"checkLabel",slot:"advancedNode",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"checkbox",checked:!!AP.isAdvanced,oncheckedChange:AQ},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13844,"Dynamic Date"),onclick:function AR(){this.parent.checkbox.onclick();}}]},{scriptClass:"mstrmojo.Box",alias:"advancedPanel",slot:"advancedNode",bindings:{visible:"this.parent.isAdvanced"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9423,"Today"),cssClass:"tdLabel"},I.call(this,"days",AK),I.call(this,"months",AT)]},]);}else{this.destroyChildren(false);}this.addChildren([mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(){AP.parent.close();},false,{slot:"buttonsNode"}),mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){if(AP.changeValueOnOK||AP.isAdvanced||AP.wasAdvanced){AP.updateValue(true);}},true,{slot:"buttonsNode"})]);},preBuildRendering:function A(){this.buildChildren();return this._super();},getSelectedDatesAsString:function E(AK){var AJ=[];m.forEach(this.selectedDates,function(AL){AJ.push(Z.formatDateInfo(AL,AK||AE().DATEOUTPUTFORMAT));});return AJ;},updateSelectedDate:function L(AN){var AJ=this.value,AK=this.timeVal,AM=this.selectedDates,AL,AO=function(AQ,AP){AQ.set("browseYear",AP.year);AQ.set("browseMonth",AP.month);AQ.updateTimePart();AQ.updateView(AQ.currentView);if(!AQ.changeValueOnOK&&AQ.hasRendered&&AQ.closeOnValueChange!=true){AQ.updateValue();}};if(this.wasAdvanced){this.wasAdvanced=false;this.changeValueOnOK=false;}if(AJ){AL=n(AJ);if(AL&&AL.hour!==undefined){AK.hour=AL.hour;AK.min=AL.min;AK.sec=AL.sec;}}if((AL&&!this.isMultiSelect)||AN){B(this);}if(AM.length===0){if(!AL){if(this.parent.opener&&this.parent.opener.defaultDate){AL=n(this.parent.opener.defaultDate);}else{AL=Z.getDateJson(new Date());}}if(!this.canSelectDisabledDate&&this.isDateDisabled(AL.day,AL.month,AL.year,this.min,this.max)){if(this.min&&Z.compareDate(AL,this.min)<0){AL=n(this.min);}else{if(this.max&&Z.compareDate(AL,this.max)>0){AL=n(this.max);}}}AM.push(AL);AO(this,AL);}else{AL=AM[0];if(!this.value){AO(this,AL);}}},updateValue:function d(AJ){var AL=g(this),AK="";if(AL){AK=Z.formatDateInfo(AL,AE().DATEOUTPUTFORMAT);if(this.dtp!==AB.DATE){AK+=" "+Z.formatTimeInfo(this.timeVal,AE().TIMEOUTPUTFORMAT);}}this.lastValue=AK;this.set("value",AK);if(this.showAdvanced){this.set("dynDateValue",AJ?U.call(this):null);}if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function z(){var AK=this.timeVal,AJ=AK.hour||0,AL=(AJ%12===0)?12:(AJ%12);this.hourLabel.innerHTML=AL;this.minuteLabel.innerHTML=Z.formatInteger(AK.min||0,2);this.secondLabel.innerHTML=Z.formatInteger(AK.sec||0,2);this.AMPMLabel.innerHTML=AJ<12?" "+AE().AM_NAME:" "+AE().PM_NAME;},premousedown:function(AJ){var AL=AJ.e,AK=k.eventTarget(AJ.hWin,AL);if(AK===this.decreaseButton||AK===this.increaseButton){if(k.isFF){k.stopPropogation(window,AL);}return true;}else{return this.processEvent(AK,AL);}},premouseup:function(AJ){var AL=AJ.e;if(AL.ctrlKey||AL.shiftKey){k.clearBrowserHighlights();}var AK=k.eventTarget(AJ.hWin,AL);if(AK===this.decreaseButton&&!AK.disabled){this.decrease();return true;}if(AK===this.increaseButton&&!AK.disabled){this.increase();return true;}},processEvent:function(AU,Ab){var AM=this.currentView,AN=this.selectedDates,AR,AW,Ac,AJ,AT;if(AU===this.monthLabel){if(AM!==AF){this.switchViewTo(AF);}return true;}if(AU===this.yearLabel){if(AM!==V){this.adjustYearStart();this.switchViewTo(V);return true;}}if(AU===this.hourLabel){if(AM!==X){this.switchViewTo(X);}return true;}if(AU===this.minuteLabel){if(AM!==AI){this.switchViewTo(AI);}return true;}if(AU===this.secondLabel){if(AM!==x){this.switchViewTo(x);}return true;}if(AU===this.AMPMLabel){if(AM!==X){this.switchViewTo(X);}return true;}if(AM===X){var AP=AU.getAttribute("h");AT=parseInt(AU.innerHTML,10);if(!isNaN(AP)&&!isNaN(AT)){AP=parseInt(AP,10);this.timeVal.hour=AT%12+AP*12;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AM===AI){AT=parseInt(AU.innerHTML,10);if(!isNaN(AT)){this.timeVal.min=AT;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AM===x){AT=parseInt(AU.innerHTML,10);if(!isNaN(AT)){this.timeVal.sec=AT;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AM===c){var Aa=this.browseYear,AK=this.browseMonth,AL;AU=P(AU);Ac=parseInt(AU.innerHTML,10);AJ=parseInt(AU.getAttribute("m"),10);if(!isNaN(Ac)&&!isNaN(AJ)){AL=(AJ===0)?{y:Aa,m:AK}:(AJ===1?Z.getNextMonth(Aa,AK):Z.getPreMonth(Aa,AK));if((!this.canSelectDisabledDate&&this.isDateDisabled(Ac,AL.m,AL.y,this.min,this.max))||Ab.button===2){return true;}if(this.isAdvanced){return true;}var AX=W(AN,Ac,AK,Aa),AV=AN.length>1,AS=this.forceNonEmptySelection,AY=this.isMultiSelect,AQ=AY&&Ab.ctrlKey,AZ=AY&&Ab.shiftKey,AO=null;if(AZ){AO=f(this,AU);B(this);o(this,AO);}else{if(AQ){if(AX===-1){AH(this,AU);}else{if(!AS||AV){v(this,AX);}}}else{B(this);if(AV||AX===-1||AS){AH(this,AU);}}}if(this.onselect||J.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(AJ===1){this.increase();}else{if(AJ===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}else{if(this.showAdvanced){this.checkLabel.checkbox.set("checked",false);t.call(this,"baseDate",0);}}}return true;}if(AM===AF){AU=P(AU);AW=parseInt(AU.getAttribute("m"),10);if(!isNaN(AW)){this.set("browseMonth",AW+1);this.switchViewTo(c);}return true;}if(AM===V){AU=P(AU);AR=parseInt(AU.innerHTML,10);if(!isNaN(AR)){this.set("browseYear",AR);this.switchViewTo(c);}return true;}return true;},decrease:function(){var AL=this.currentView,AO=AL,AN=this.browseYear,AJ=this.browseMonth,AK=this.yearRangStart,AM;switch(AL){case c:AM=Z.getPreMonth(AN,AJ);this.set("browseMonth",AM.m);this.set("browseYear",AM.y);break;case AF:this.set("browseYear",AN-1);break;case V:this.yearRangStart=AK-this.yearViewSize*this.yearViewSize;break;case X:AO=x;break;case AI:AO=X;break;case x:AO=AI;break;}this.switchViewTo(AO,"right");},increase:function(){var AL=this.currentView,AO=AL,AN=this.browseYear,AJ=this.browseMonth,AK=this.yearRangStart,AM;switch(AL){case c:AM=Z.getNextMonth(AN,AJ);this.set("browseMonth",AM.m);this.set("browseYear",AM.y);break;case AF:this.set("browseYear",AN+1);break;case V:this.yearRangStart=AK+this.yearViewSize*this.yearViewSize;break;case X:AO=AI;break;case AI:AO=x;break;case x:AO=X;break;}this.switchViewTo(AO,"left");},updateView:function(AJ){var AK=this[AJ+"ViewHTML"]();this[AJ+"View"].innerHTML=AK;},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(AK,AM){var AQ="mstrmojo-Calendar-"+AK+"View",AP=document.createElement("div"),AJ=this[this.currentView+"View"],AN=AK+"ViewHTML",AO=this[this.currentView+"Label"],AL=this[AK+"Label"];if(!this.supportedViews[AK]){return ;}if(!AM){AM=this.sDirMatrix[this.currentView][AK];}AP.className=AQ;AP.innerHTML=this[AN]();this.currentView=AK;this[AK+"View"]=AP;mstrmojo.css.toggleClass(AP,["ddSelected"],this.isAdvanced);this._slideIntoView(AJ,AP,AM);},_slideIntoView:function(AN,AR,AL){var AJ=this.bodyContainer,AP=(AL==="left"||AL==="right")?AN.offsetWidth:AN.offsetHeight,AK=(AL==="left"||AL==="right")?"left":"top",AQ=(AL==="left"||AL==="up")?AP:-AP,AO=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AN,onEnd:function(){AJ.removeChild(AN);}}),AM=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AR});AR.style[AK]=AQ+"px";AJ.appendChild(AR);AO.props[AK]={start:0,stop:-AQ,suffix:"px"};AM.props[AK]={start:AQ,stop:0,suffix:"px"};AO.play();AM.play();},dayViewHTML:function(){var AO=this.browseYear,AR=this.browseMonth,AW=Z.getDaysOfMonth(AO,AR),Aa=Z.getPreMonth(AO,AR),AL=Z.getDaysOfMonth(Aa.y,Aa.m),AK=Z.getNextMonth(AO,AR),AS=H(AO,AR,this.firstDayOfWeek),AP=[],AM=AA(this),Ac=0,AJ=this.selectedDates,AU=this.min,AY=this.max,Ad,AV,AZ,AX,Ab=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"";T(this,{d:AL,m:Aa.m,y:Aa.y},{d:1,m:AK.m,y:AK.y});AP.push(O(this.cssTextDay));AP.push(this._dayViewTHead());AP.push("<tr>");for(AZ=0;AZ<AS;AZ++){Ad=AL-AS+AZ+1;AV=this.isDateDisabled(Ad,Aa.m,Aa.y,AU,AY)?"disabled":"";AP.push("<td "+Ab+'><div class="mstrmojo-Calendar-day-pre '+AV+'" m="-1">');AP.push(Ad);AP.push("</div></td>");Ac++;}for(AZ=0;AZ<AW;AZ++){Ad=AZ+1;AV=this.isDateDisabled(Ad,AR,AO,AU,AY)?" disabled":"";var AN=q(Ad,AR,AO),AQ=AN?" today":"",AT=W(AJ,Ad,AR,AO)!==-1;AQ=(this.hilightToday&&AN)?" hilightToday":AQ;AP.push("<td "+(AN?('class="'+AQ+'" '):" ")+(AT?AM:"")+'><div class="mstrmojo-Calendar-day-cur'+(AT?(" selected "):"")+AV+'" m="0"'+(AT?AM:"")+">");AP.push(AZ+1);AP.push("</div></td>");if((++Ac)%7===0){AP.push("</tr><tr>");}}for(AX=Ac;AX<42;AX++){Ad=Ac-AW-AS+1;AV=this.isDateDisabled(Ad,AK.m,AK.y,AU,AY)?"disabled":"";AP.push("<td "+Ab+'><div class="mstrmojo-Calendar-day-next '+AV+'" m="1">');AP.push(Ad);AP.push("</div></td>");if((++Ac)%7===0&&Ac!==42){AP.push("</tr><tr>");}}AP.push("</tr>");AP.push(w);return AP.join("");},_dayViewTHead:function(){var AM=[],AN='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',AL="</tr></thead>",AK=this.firstDayOfWeek-1,AO=this.dayNames,AJ;AM.push(AN);for(AJ=AK;AJ<AK+7;AJ++){AM.push("<td>");AM.push(AO(AJ%7));AM.push("</td>");}AM.push(AL);return AM.join("");},monthViewHTML:function(){var AK=[],AM=this.browseMonth-1,AL=this.browseYear,AJ;T(this,{d:31,m:12,y:AL-1},{d:1,m:1,y:AL+1});AK.push(O(this.cssTextMonth));AK.push("<tr>");for(AJ=0;AJ<12;AJ++){AK.push("<td "+((AJ===AM)?AA(this):"")+'><div class="mstrmojo-Calendar-month'+((AJ===AM)?" selected":"")+'" m="');AK.push(String(AJ));AK.push('">');AK.push(this.monthNames(AJ));AK.push("</div></td>");if(AJ%3===2){AK.push("</tr><tr>");}}AK.pop();AK.push("</tr>");AK.push(w);return AK.join("");},yearViewHTML:function(){var AO=this.yearRangStart,AK=[],AM=this.browseYear,AN,AJ,AL=this.yearViewSize;T(this,{d:31,m:12,y:AO-1},{d:1,m:1,y:AO+AL*AL});AK.push(O(this.cssTextYear));AK.push("<tr>");for(AJ=0;AJ<AL*AL;AJ++){AN=AO+AJ;AK.push("<td "+((AM===AN)?AA(this):"")+'><div class="mstrmojo-Calendar-year'+((AM===AN)?" selected":"")+'">');AK.push(AN);AK.push("</div></td>");if(AJ%AL===(AL-1)){AK.push("</tr><tr>");}}AK.pop();AK.push("</tr>");AK.push(w);return AK.join("");},hourViewHTML:function(){var AL=[],AK=this.timeVal.hour,AJ;AL.push(G);AL.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AL.push(AE().AM_NAME);AL.push("</div></td></tr>");for(AJ=0;AJ<12;AJ++){AL.push('<td><div class="mstrmojo-Calendar-hour'+((AJ===AK)?" selected":"")+'" h="0">');AL.push((AJ===0)?12:AJ);AL.push("</div></td>");if(AJ===5){AL.push("</tr><tr>");}}AL.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AL.push(AE().PM_NAME);AL.push("</div></td></tr>");for(AJ=0;AJ<12;AJ++){AL.push('<td><div class="mstrmojo-Calendar-hour'+(((12+AJ)===AK)?" selected":"")+'" h="1">');AL.push((AJ===0)?12:AJ);AL.push("</div></td>");if(AJ===5){AL.push("</tr><tr>");}}AL.push("</tr>");AL.push(w);return AL.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(AL,AM){var AK=[],AJ;AK.push(G);AK.push("<tr>");for(AJ=0;AJ<60;AJ++){AK.push('<td><div class="');AK.push(AM);AK.push((AJ===AL)?' selected">':'">');AK.push(AJ);AK.push("</div></td>");if(AJ%10===9){AK.push("</tr><tr>");}}AK.pop();AK.push("</tr>");AK.push(w);return AK.join("");},isDateDisabled:function(AJ,AL,AK){return !F(AJ,AL,AK,this.min,this.max);},unrender:function D(AJ){delete this.lastValue;this._super(AJ);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.num","mstrmojo.date","mstrmojo.Container","mstrmojo.VBox","mstrmojo.Button","mstrmojo.locales","mstrmojo._FormatDefinition","mstrmojo.mstr.EnumFunction","mstrmojo.ui.editors.controls.ComboBox");var K=mstrmojo.hash,Z=mstrmojo.array,F=mstrmojo.num,H=mstrmojo._FormatDefinition,A=mstrmojo.css,X=mstrmojo.mstr.EnumFunction,J=mstrmojo.locales,G=mstrmojo.Button.newIconButton,M=mstrmojo.date,D=H.NumberFormatCategory,n=H.FixedNegative,E=H.CurrencyNegative,c=H.PercentNegative,I=H.DefaultFormat.FormattingNumber,W,R,b=function b(q,p){return{cls:this.value===q.v?"selected":"",v:q.v||"",n:q.n||"",style:q.r?"color:red;":"color:#fff;",sel:parseInt(this.idx,10)===p?"selected":""};},m={RIGHT:1,LEFT_WITH_SPACE:2,RIGHT_WITH_SPACE:3};var Q=[{n:mstrmojo.desc(4531,"Automatic"),v:-3}].concat(H.Category.slice(2)),a=[{n:"$"},{n:""},{n:""},{n:""},{n:"fr."}];function C(r,q){var p=Z.find(r,"v",q);return p===-1?"":r[p].f;}function L(p){var r=this.parent.parent.parent.myData,q=p.v;r.set("format",C(this.items,q));r.set("negativeNumbers",q);A.toggleClass(this.selectedNode,"red",p.r);}function V(r,t,p){return{scriptClass:"mstrmojo.ui.Pulldown",items:r,onitemSelected:function q(u){var v=this.parent;while(v&&(!v.data||typeof v.data[t]==="undefined")){v=v.parent;}if(v){v.data.set(t,u.v);if(p){v.children[0].preview.preview_label.set("text",u.n);}}}};}function f(AA,u,t,AC,z){var AB=K.clone(AA),p=u>0?".":"",q=p,r=H.DefaultFormat.FormattingNumber,w;for(w=0;w<u;w++){p+=w%9;q+="0";}for(w=0;w<AB.length;w++){var x=AB[w];if(t){x.n=x.n.replace(/,/g,"");x.f=x.f.replace(/,/g,"");}if(AC&&AC!==r.CurrencyPosition){switch(AC){case m.RIGHT:x.n=x.n.replace(/\$/g,"").replace(/\.\d{2}/g,".12$");x.f=x.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00"$"');break;case m.LEFT_WITH_SPACE:x.n=x.n.replace(/\$/g,"$ ");x.f=x.f.replace(/\$/g,"$ ");break;case m.RIGHT_WITH_SPACE:x.n=x.n.replace(/\$/g,"").replace(/\.\d{2}/g,".12 $");x.f=x.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00" $"');break;default:}}x.n=x.n.replace(/\.\d{2}/g,p);x.f=x.f.replace(/\.\d{2}/g,q);if(z&&z!==r.CurrencySymbol){var v=z.replace(/\$/g,"$$$$");x.n=x.n.replace(/\$/g,v);x.f=x.f.replace(/\$/g,v);}x.cls=x.r?"red":null;}return AB;}function T(r){var p="1"+(r>0?".":"").toString(),t="0"+(r>0?".":"").toString(),q;for(q=0;q<r;q++){p+=q%10;t+="0";}return[p+"E+03",t+"E+0#"];}function P(AE,AG){var x="\u00A4",AC=/"[^"]*"/g,r=AE.match(AC),AH="\u0091",AD=/\[[^\]]*\]/g,p=AE.match(AD),AB,AF;AB=AE.replace(AC,x);AB=AB.replace(AD,AH);var u=AE.indexOf("."),AA=F.getDecimalLength(AE),w=Math.max(0,AA+AG),t=AE.match(/\d(?!((\d)|(,\d)))/g),q=u!==-1?AE.charAt(u-1):t&&t[0],z=(q||"0")+(w>0?".":"").toString();for(var v=0;v<w;v++){z+="0";}AB=AB.replace(AA===0?/\d(?!((\d)|(,\d)))/g:/\d\.\d+/g,z);AB=AB.split(x);AF=AB[0];Z.forEach(r,function(AJ,AI){AF+=AJ+AB[AI+1];});AB=AF.split(AH);AF=AB[0];Z.forEach(p,function(AJ,AI){AF+=AJ+AB[AI+1];});return AF;}function N(x,p,w,v,r,q){var u=x.parent.parent.parent,t=f(p,w.decimalPlaces,v,r,q);w.set("format",C(t,w.negativeNumbers.toString()));x.set("items",t);x.set("selectedIndex",Z.find(t,"v",w.negativeNumbers.toString()));u.preview.preview_label.set("text",S(u.myData.format));}function h(){var z=this.parent.parent,AD=z.myData,t=z.formatterContainer,q=Q[z.categoryPicker.selectedIndex].v,AG=this.funcType===X.FunctionLeftStr?1:-1,v=null,x=null,u=false,AF=0,AA=null,r=false,AC;switch(q){case D.Fixed:v=t.fixed_hBox.negativeDDL;x=n;u=!AD.thousandSeparator;break;case D.Currency:v=t.currency_hBox2.negativeDDL;x=E;AF=AD.currencyPosition;AA=AD.currencySymbol;break;case D.Percentage:v=t.percentage_hBox.negativeDDL;x=c;break;case D.Scientific:r=true;break;case D.Custom:AC=true;break;default:return ;}if(AC){var AE=P(AD.format,AG);z.preview.preview_label.set("text",S(AE));z.formatterContainer.custom_text.set("value",AE);return ;}var w=AD.decimalPlaces,p=w+AG;p=Math.max(0,p);p=Math.min(H.MaxNegativeDidigts,p);AD.set("decimalPlaces",p);if(r){var AB=T(p);AD.set("format",AB[1]);z.preview.preview_label.set("text",AB[0]);}else{N(v,x,AD,u,AF,AA);}}function S(AB){var r="\u00A4",w=/"[^"]*"/g,q=AB.match(w),v=AB.replace(w,r),AA=["m","y","d","h","s"],z=false,p=new Date(),x=p.getFullYear(),u=p.getMonth(),t=p.getDay(),AD=J.datetime,AC;Z.forEach(AA,function(AE){z=z||v.indexOf(AE,0)!==-1;});if(z){v=v.replace(/y{3,}/g,x).replace(/y{1,2}/g,x.toString().slice(2,4));v=v.replace(/m{4,}/g,AD.MONTHNAME_FULL[u-1]).replace(/m{3}/g,AD.MONTHNAME_SHORT[u-1]).replace(/mm/g,"07").replace(/m/g,"7").replace(/7ber/g,"mber");v=v.replace(/d{4,}/g,AD.dayNames[t-1]).replace(/d{3}/g,"Mon").replace(/dd/g,"10").replace(/d/g,"1").replace(/1ay/g,"day");v=v.replace(/hh/g,"08").replace(/h/g,"8");v=v.replace(/ss/g,"04").replace(/s/g,"4");v=v.split(r);AC=v[0];Z.forEach(q,function(AF,AE){AC+=AF+v[AE+1];});return AC;}return F.formatByMask(AB,1234.12);}function o(p,q){return Math.max(Z.find(p,"v",q),0);}function B(r){var q=this.parent.parent.categoryPicker,p=Q.map(function(t){return t.v;}).indexOf(r);q.set("selectedIndex",p);}function l(p,q,t,r){return G(undefined,p,q,undefined,K.copy(r,{useRichTooltip:true,updateTooltipConfig:function(){this.richTooltip={cssClass:"vi-regular vi-tooltip-A A-center",content:t,refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPCENTER,left:15,top:33};}}));}function Y(){if(mstrApp.isSingleTier){var v=this.formatterContainer,u=J.datetime,p={day:7,month:4,year:1998},r={hour:15,min:41,sec:46},t=u&&u.DATEINPUTFORMATS,q=u&&u.TIMEINPUTFORMATS;W=[];R=[];t.forEach(function(w){W.push({v:w,n:M.formatDateInfo(p,w)});});q.forEach(function(w){R.push({v:w,n:M.formatTimeInfo(r,w)});});v.date_ddl.set("items",W);v.time_ddl.set("items",R);}else{W=H.Date;R=H.Time;}}mstrmojo.vi.ui.NumberFormatter=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatter",cssClass:"NumberFormatter-content",formatValue:null,myData:null,oldData:null,categoryPicker:null,formatterContainer:null,preview:null,shortcutRow:null,adjustAfterCategoryChange:mstrmojo.emptyFn,preBuildRendering:function(){if(this._super){this._super();}Y.call(this);var p=this.formatterContainer;if(this.formatValue){p.currency_hBox1.currency_symbol.selectedValue=this.formatValue.currencySymbol;p.fixed_btn.checked=!!this.formatValue.thousandSeparator;A.addWidgetCssClass(p.fraction_ddl,c[Z.find(c,"v",this.formatValue.negativeNumbers)].r?" red":"");}},postBuildRendering:function O(){if(this._super){this._super();}if(this.formatValue){this.categoryPicker.set("selectedIndex",o(this.categoryPicker.items,this.formatValue.category.toString()));}},children:[K.copy({alias:"categoryPicker",cssClass:"nf-category",onitemSelected:function k(AD){if(!this.hasRendered){return ;}var x=this,AB=x.parent,r=AB.formatterContainer,p=AB.shortcutRow,AC=AB.preview.preview_label,AA=AD.v,u=AA===D.Automatic,q=[],w=AB.myData;Z.forEach(r.children,function(AE){AE.set("visible",false);});AB.border.set("visible",!u);AB.preview.set("visible",!u);["border","moveLeftBtn","moveRightBtn"].forEach(function(AE){p[AE].set("visible",!u);});w.set("category",AA);w.set("thousandSeparator",AA?I.ThousandSeparator:AB.formatValue.thousandSeparator);switch(AA){case D.Currency:N(r.currency_hBox2.negativeDDL,E,w,false,w.currencyPosition,w.currencySymbol);r.currency_hBox1.currency_position.set("selectedIndex",o(H.CurrencyPosition,w.currencyPosition.toString()));q=["currency_hBox1","currency_hBox2"];break;case D.Date:r.date_ddl.set("selectedIndex",o(W,w.format));q=["date_ddl"];break;case D.Time:r.time_ddl.set("selectedIndex",o(R,w.format));q=["time_ddl"];break;case D.Percentage:N(r.percentage_hBox.negativeDDL,c,w,false,0,null);q=["percentage_hBox"];break;case D.Fraction:r.fraction_ddl.set("selectedIndex",o(H.Fraction,w.format));q=["fraction_ddl"];break;case D.Scientific:var v=T(w.decimalPlaces||0);w.set("format",v[1]);AC.set("text",v[0]);break;case D.Custom:var t=w.customText||w.format,z=r.custom_text;w.set("format",t);z.value=t;z.refresh();AC.set("text",S(t));q=["custom_condense","custom_text"];break;case D.Fixed:N(r.fixed_hBox.negativeDDL,n,w,!w.thousandSeparator,0,null);q=["fixed_hBox","fixed_btn"];break;}Z.forEach(q,function(AE){r[AE].set("visible",true);});AB.adjustAfterCategoryChange();}},V(Q,"category")),{scriptClass:"mstrmojo.Box",cssClass:"nf-MiddleRow nf-shortcut",alias:"shortcutRow",border:null,moveLeftBtn:null,moveRightBtn:null,children:[l("nf-shortcut-currency",function e(){B.call(this,D.Currency);},mstrmojo.desc(2051,"Currency"),undefined),l("nf-shortcut-percentage",function e(){B.call(this,D.Percentage);},mstrmojo.desc(2053,"Percentage"),undefined),l("nf-shortcut-fixed",function e(){B.call(this,D.Fixed);this.parent.parent.formatterContainer.fixed_btn.set("checked",true);},mstrmojo.desc(2050,"Fixed"),undefined),{scriptClass:"mstrmojo.Label",cssClass:"shortcut-border",alias:"border"},l("nf-MoveDecimalPoint left",function e(){h.call(this);},mstrmojo.desc(2189,"Increase Decimal"),{funcType:X.FunctionLeftStr,alias:"moveLeftBtn"}),l("nf-MoveDecimalPoint right",function e(){h.call(this);},mstrmojo.desc(2188,"Decrease Decimal"),{funcType:X.FunctionRightStr,alias:"moveRightBtn"})]},{scriptClass:"mstrmojo.Label",alias:"border",cssClass:"nf-border"},{scriptClass:"mstrmojo.Container",alias:"formatterContainer",cssClass:"nf-buttons",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',fixed_hBox:null,fixed_btn:null,currency_hBox1:null,currency_hBox2:null,date_ddl:null,time_ddl:null,percentage_hBox:null,fraction_ddl:null,custom_condense:null,custom_text:null,markupSlots:{containerNode:function U(){return this.domNode;}},children:[{scriptClass:"mstrmojo.HBox",alias:"fixed_hBox",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function k(p){L.call(this,p);}},V([],"format"))]},{scriptClass:"mstrmojo.CheckBox",alias:"fixed_btn",cssClass:"nf-MiddleRow",label:mstrmojo.desc(13898,"Use 1000 Separator(#)").replace("#",J.number.THOUSANDSEPARATOR),onclick:function e(){var q=this.parent.parent;q.myData.set("thousandSeparator",this.checked?-1:0);N(this.parent.fixed_hBox.negativeDDL,n,q.myData,!this.checked,0,null);}},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox1",cssClass:"nf-MiddleRow",visible:true,currency_symbol:null,currency_position:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",alias:"currency_symbol",cssClass:"nf-CurrencySymbol",selectedValue:"$",items:a,postselectedValueChange:function g(q){var v=this,u=v.parent.parent.parent,t=q.value,r=u.myData;r.set("currencySymbol",t);N(this.parent.parent.currency_hBox2.negativeDDL,E,r,false,parseInt(r.currencyPosition,10),t);}},K.copy({cssClass:"nf-CurrencyPosition align-right",alias:"currency_position",onitemSelected:function k(q){var u=this,t=u.parent.parent.parent,r=q.v;t.myData.set("currencyPosition",parseInt(r,10));N(this.parent.parent.currency_hBox2.negativeDDL,E,t.myData,false,parseInt(r,10),t.myData.currencySymbol);}},V(H.CurrencyPosition,"currencyPosition"))]},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox2",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function k(p){L.call(this,p);}},V([],"format"))]},K.copy({alias:"date_ddl",cssClass:"nf-MiddleRow"},V(H.Date,"format",true)),K.copy({alias:"time_ddl",cssClass:"nf-MiddleRow"},V(H.Time,"format",true)),{scriptClass:"mstrmojo.HBox",alias:"percentage_hBox",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function k(p){L.call(this,p);}},V([],"format"))]},K.copy({alias:"fraction_ddl",cssClass:"nf-MiddleRow"},V(H.Fraction,"format",true)),mstrmojo.Button.newWebButton(mstrmojo.desc(13893,"Condense (e.g.10M)"),function(){this.parent.custom_text.set("value",'[>=1000000]#,##0,,"M";[>=1000]#,##0,"K";0');},false,{cssClass:"nf-condense",alias:"custom_condense"}),{scriptClass:"mstrmojo.TextBox",alias:"custom_text",cssClass:"nf-custom",onvalueChange:function d(){var t=this,r=t.parent.parent,q=t.value;r.myData.set("format",q);r.myData.set("customText",q);t.parent.parent.preview.preview_label.set("text",S(q).replace(/\s/g,"&nbsp;"));}}]},{scriptClass:"mstrmojo.HBox",alias:"preview",cssClass:"nf-MiddleRow",preview_label:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"preview_lable",text:mstrmojo.desc(13892,"Preview:")},{scriptClass:"mstrmojo.Label",cssClass:"align-right",alias:"preview_label"}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.fx","mstrmojo.Box","mstrmojo.Editor","mstrmojo.Button","mstrmojo._FormatDefinition","mstrmojo.TabListContainer","mstrmojo.TabNameList","mstrmojo.StackContainer","mstrmojo.FontFormatter","mstrmojo.NumberFormatter","mstrmojo.AlignmentFormatter","mstrmojo.PaddingFormatter","mstrmojo.FillFormatter","mstrmojo.BorderFormatter");var C=mstrmojo.array,M=mstrmojo.hash,F=mstrmojo._FormatDefinition,B=mstrmojo.Button,L=F.MetricFormatTarget;var G="#999",E="mstrmojo-Editor-button mstrButton",H=M.clone(F.DefaultFormat);H.FormattingPatternsChart={FillColor:"16777215",FillStyle:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0"};H.FormattingPatterns=M.clone(H.FormattingPatternsChart);var I={n:mstrmojo.desc(3434,"Number"),scriptClass:"mstrmojo.NumberFormatter",visible:false,pr:"FormattingNumber"},K={n:mstrmojo.desc(3435),scriptClass:"mstrmojo.Box",visible:false,pr:["FormattingAlignment","FormattingPadding"],cssClass:"alignmentPanel",children:[{scriptClass:"mstrmojo.AlignmentFormatter",bindings:{model:"this.parent.FormattingAlignment"}},{scriptClass:"mstrmojo.PaddingFormatter",bindings:{model:"this.parent.FormattingPadding"}}]},N={n:mstrmojo.desc(3433,"Font"),scriptClass:"mstrmojo.FontFormatter",visible:false,pr:"FormattingFont",cssClass:"mstrmojo-FormatEditor-fontTable",cellPadding:5},D={n:mstrmojo.desc(2886,"Borders"),scriptClass:"mstrmojo.BorderFormatter",visible:false,pr:"FormattingBorder"},A={n:mstrmojo.desc(3905,"Background"),scriptClass:"mstrmojo.FillFormatter",visible:false,pr:"FormattingPatterns"},J={n:mstrmojo.desc(3479,"Graph"),scriptClass:"mstrmojo.FillFormatter",visible:false,isChart:true,pr:"FormattingPatternsChart"};mstrmojo.ME.MetricFormatEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.MetricFormatEditor",cssClass:"mstrmojo-FormatEditor",title:mstrmojo.desc(2116,"Format"),model:null,obModel:null,_initModel:function(){if(!this.model){this.model={};for(var O=0;O<L.length;O++){this.model[L[O].p]={};}}if(!this.obModel){this.obModel=new mstrmojo.Model({onlevelNameChange:function(P){var Q=P.valueWas;if(Q){this._updateModel(Q);}this._setCurrentFormat();},onmodelChange:function(){return this.model?this._setCurrentFormat():false;},_updateModel:function(Q){var R=M.copy(this.currentFormat),Q=Q||this.levelName,P=this.model[Q];if(!P){P=this.model[Q]={};}F.extractModel(R,P,H);this.model.set(Q,P);},_setCurrentFormat:function(){var P=this.model?M.copy(this.model[this.levelName||L[0].p]):{};P=F.getStandardFormat(P,H);this.set("currentFormat",P);}});}},init:function(O){this._initModel();this._super(O);},onmodelChange:function(){this._initModel();var Q=this.obModel,O=M.clone(this.model)||{};if(O){var P={};if(O&&O[L[0].p]){var R=O[L[0].p].FormattingPatterns;if(R){for(pr in R){if(pr.match(/^Series\w+/gi)){P[pr.substring(6,pr.length)]=R[pr];}}}O[L[0].p].FormattingPatternsChart=P;}}if(O&&!O.attachEventListener){M.make(O,mstrmojo.Obj);}Q.set("model",O);Q.set("levelName",Q.levelName||L[0].p);},promptOnClearFormatRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:"",showTitle:false,children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",bindings:{text:function(){return mstrmojo.desc(9564,"Clear all formatting?");}}},{scriptClass:"mstrmojo.HBox",cssText:"float:right; margin-bottom:5px;",alias:"buttonBar",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"Ok"),onclick:function(){var O=this.parent.parent;O.opener.onClearFormat();O.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var O=this.parent.parent;O.close();}}]}]},prompt2ClearFormat:function(){this.openPopup("promptOnClearFormatRef",{zIndex:this.zIndex+1});},onClearFormat:function(){var P=this.obModel;for(var O=0;O<L.length;O++){delete P.model[L[O].p];}P._setCurrentFormat();},onOK:function(){var Q=this.obModel;Q._updateModel();var R=Q.model[L[0].p];if(R){var P=R.FormattingPatterns,O=R.FormattingPatternsChart;if(O){for(pr in H.FormattingPatternsChart){if(O[pr]!=null){P["Series"+pr]=O[pr];}}delete O;}}var S=mstrmojo.hash.clone(this.model);F.saveFormatModel(Q.model,this.model,[L[0].p,L[1].p],F.DefaultFormat);this.model.dirty=!mstrmojo.hash.equals(S,this.model);},children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.HBox",alias:"btns",children:[{scriptClass:"mstrmojo.Pulldown",alias:"which",items:L,itemIdField:"v",bindings:{value:function(){var O=C.find(this.items,"p",this.parent.parent.parent.obModel.levelName);return this.items[O!=-1?O:0][this.itemIdField];}},cssClass:" mstrmojo-FormatEditor-DropDownButton",popupZIndex:100,value:L[0].v,onvalueChange:function(){var R=this.parent.parent.parent,P=this.parent.parent.formatPanels,S=P&&P.stck,Q=this.selectedItem;if(R&&R.obModel&&S){R.obModel.set("levelName",Q?Q.p:L[0].p);var O=C.find(S.children,"pr",J.pr);if(Q==null||Q.p==L[0].p){if(O==-1){S.addChildren(J);S.onchildRenderingChange(J);}}else{S.removeChildren(S.children[O]||[]);}}}},new B.newInteractiveButton(mstrmojo.desc(5976),function(O){var P=this.parent.parent.parent;P.prompt2ClearFormat();},G,{alias:"btnClear",cssClass:E+" clear"})]},{scriptClass:"mstrmojo.TabListContainer",alias:"formatPanels",listCssClass:"mstrmojo-FormatEditor-leftPanel",bindings:{currentModel:"this.parent.parent.obModel.currentFormat"},oncurrentModelChange:function(){this.parent.btns.which.onvalueChange();var O=this.lst;if(O.selectedIndex==0){O.onchange();}else{O.set("selectedIndex",0);}},children:[{scriptClass:"mstrmojo.TabNameList",alias:"lst",slot:"top",cssClass:"mstrmojo-FormatEditor-formatList",itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>',onchange:function(){var R=this.parent,S=this.selectedIndex;if(R.stck&&S!=null&&S!=-1){var Q=this.items[S],O=Q&&Q.target;var T=O&&O.pr;if(T){if(T.constructor===Array){for(var P=0;P<T.length;P++){O.set(T[P],R.currentModel[T[P]]);}}else{O.set("model",R.currentModel[T]);}}}}},{scriptClass:"mstrmojo.StackContainer",cssClass:"mstrmojo-FormatEditor-rightPanel-container mstrmojo-FormatEditor-rightPanel",alias:"stck",slot:"stack",children:[I,K,N,D,A,J]}]}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",children:[new B.newInteractiveButton(mstrmojo.desc(2397),function(){var O=this.parent.parent;O.close();O.onOK&&O.onOK();},G,{alias:"btnOk",cssClass:E}),new B.newInteractiveButton(mstrmojo.desc(2399),function(){var O=this.parent.parent;O.close();},G,{alias:"btnCancel",cssClass:E})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Editor","mstrmojo._FormatDefinition","mstrmojo.FontFormatter","mstrmojo.NumberFormatter","mstrmojo.AlignmentFormatter","mstrmojo.PaddingFormatter","mstrmojo.FillFormatter","mstrmojo.BorderFormatter");var B=mstrmojo.hash,C=mstrmojo._FormatDefinition;var A=["header_format","grid_format","child_header_format","child_grid_format"];mstrmojo.CGFormatEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.CGFormatEditor",cssClass:"mstrmojo-FormatEditor",title:mstrmojo.desc(2116),model:null,obModel:null,_initModel:function(){if(!this.obModel){var D=this;this.obModel=new mstrmojo.Model({level1Index:A[0],onlevel0IndexChange:function(E){if(E.valueWas>-1){this._updateModel(E.valueWas,this.level1Index);}this._setCurrentFormat();},onlevel1IndexChange:function(E){if(E.valueWas!=undefined){this._updateModel(this.level0Index,E.valueWas);}this._setCurrentFormat();},onmodelChange:function(){return this.model.items.length>0?this._setCurrentFormat():false;},_updateModel:function(H,F){H=(typeof H!="undefined")?H:this.level0Index;F=F||this.level1Index;var G=mstrmojo.hash.copy(this.currentFormat);var E=this.model.items[H][F]||{};C.extractModel(G,E);this.model.items[H].set(F,E);},_setCurrentFormat:function(){var E=mstrmojo.hash.copy(this.model.items[this.level0Index||0][this.level1Index]);E=C.getStandardFormat(E);this.set("currentFormat",E);}});}},init:function(D){this._initModel();this._super(D);},onmodelChange:function(){this._initModel();var E=this.obModel;E.level0Index=E.level0Index||0;E.set("model",mstrmojo.hash.clone(this.model));var D=E.model.selectedIndex;E.set("level0Index",(D==-1?0:D));},onClearFormat:function(){var D=this.obModel.currentFormat;for(var G in D){delete D[G];}for(var F=0;F<A.length;F++){var E=this.obModel;delete E.model.items[E.level0Index][A[F]];}this.obModel._setCurrentFormat();},onOK:function(){this.obModel._updateModel();var D=this.obModel.model;for(var E=0;E<D.items.length;E++){C.saveFormatModel(D.items[E],this.model.items[E],A);}},postBuildRendering:function(){if(this._super){this._super();}var D=this.obModel.model.selectedIndex;this.obModel.set("level0Index",(D==-1?0:D));},children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.HBox",alias:"btns",children:[{scriptClass:"mstrmojo.Pulldown",itemIdField:"did",bindings:{items:function(){return this.parent.parent.parent.obModel.model.items||[];},value:function(){var D=this.parent.parent.parent.obModel.level0Index;D=(D==-1?0:D);return this.items[D][this.itemIdField];}},cssClass:" mstrmojo-FormatEditor-DropDownButton",popupZIndex:100,value:1,onvalueChange:function(){var D=this.parent.parent.parent;if(D&&D.obModel){D.obModel.set("level0Index",this.selectedIndex);}}},{scriptClass:"mstrmojo.Pulldown",alias:"targetSelector",itemIdField:"v",cssClass:" mstrmojo-FormatEditor-DropDownButton",popupZIndex:100,value:1,items:C.FormatTarget,onvalueChange:function(){var D=this.parent.parent.parent;if(D&&D.obModel){D.obModel.set("level1Index",this.selectedItem.p);}}},new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(5976),function(D){var E=this.parent.parent.parent;if(E.onClearFormat){E.onClearFormat();}},"#999",{alias:"btnClear",cssClass:"mstrmojo-Editor-button mstrButton clear"})]},{scriptClass:"mstrmojo.HBox",alias:"formatPanels",cssClass:"mstrmojo-FormatEditor-box",bindings:{currentModel:"this.parent.parent.obModel.currentFormat"},children:[{scriptClass:"mstrmojo.VBox",alias:"formatList",cssClass:"mstrmojo-FormatEditor-leftPanel",children:[{scriptClass:"mstrmojo.List",alias:"feFMTList",cssClass:"mstrmojo-FormatEditor-formatList",items:C.Formats,selectedIndex:0,itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>',height:"200px"}]},{scriptClass:"mstrmojo.Container",alias:"rightPanelContainer",cssClass:"mstrmojo-FormatEditor-rightPanel-container mstrmojo-FormatEditor-rightPanel",markupString:'<div id={@id} class="{@cssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},children:[{scriptClass:"mstrmojo.FontFormatter",cssClass:"mstrmojo-FormatEditor-fontTable",cellPadding:5,bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==0",model:"this.parent.parent.currentModel.FormattingFont"}},{scriptClass:"mstrmojo.NumberFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==1",model:"this.parent.parent.currentModel.FormattingNumber"}},{scriptClass:"mstrmojo.AlignmentFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==2",model:"this.parent.parent.currentModel.FormattingAlignment"}},{scriptClass:"mstrmojo.PaddingFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==2",model:"this.parent.parent.currentModel.FormattingPadding"}},{scriptClass:"mstrmojo.FillFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==3",model:"this.parent.parent.currentModel.FormattingPatterns"}},{scriptClass:"mstrmojo.BorderFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==3",model:"this.parent.parent.currentModel.FormattingBorder"}}]}]}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(2397),function(){var D=this.parent.parent;D.close();if(D.onOK){D.onOK();}},"#999",{alias:"btnOk",cssClass:"mstrmojo-Editor-button mstrButton"}),new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(2399),function(){var D=this.parent.parent;D.close();},"#999",{alias:"btnCancel",cssClass:"mstrmojo-Editor-button mstrButton"})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Dialog","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.form","mstrmojo.LoginEditor");mstrmojo.requiresDescs(2699,7773,11812,11865,13380,13381,13382);var D=mstrmojo.desc(13382,"Your user session will time out due to inactivity in # ##."),S=60,M=false,G=null,A=null,H=null;function N(){return mstrApp.sessionState||microstrategy.sessionState;}function K(V,U){if(mstrApp.is508){for(var T in U){V.setAttribute(T,U[T]);}}}mstrmojo.SessionManager=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SessionManager",cssClass:"mstrmojo-SessionManager",width:"370px",title:mstrmojo.desc(11812,"Notification"),msgInterval:1,checkSessionInterval:20,zIndex:10000,maxSessionIdleTime:600,timeBeforeSessionTimeoutWarning:60,remainingTime:60,sessionTimedout:false,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(13381,"Stay logged in"),function(){var T=this.parent.parent;if(A){T.keepSessionAlive();}T.hideMessage();},true,{onRender:function(){K(this.domNode,{tabindex:0,role:"button","aria-label":mstrmojo.desc(13381,"Stay logged in")});}}),mstrmojo.Button.newWebButton(mstrmojo.desc(13380,"Log out"),function(){this.parent.parent.hideMessage();mstrmojo.form.send({evt:3019,src:mstrApp.name+".3019"});},null,{onRender:function(){K(this.domNode,{tabindex:0,role:"button","aria-label":mstrmojo.desc(13380,"Log out")});}})],children:[{scriptClass:"mstrmojo.Label",alias:"message",cssClass:"mstrmojo-SessionManager-msg",text:"",allowHTML:true,ontextChange:function(){if(mstrApp.is508){this.refresh();var T=this.domNode;K(T,{tabindex:-1,role:"alert"});window.setTimeout(function(){T.focus();},0);}}}],postBuildRendering:function(){this._super();if(mstrApp.is508){this.msgInterval=10;K(this.editorNode,{role:"alertdialog",tabindex:-1});}},updateMsg:function B(U){var T;if(U>60){T=D.replace("##",mstrmojo.desc(2699,"minutes")).replace("#","<b>"+Math.ceil(U/S)+"</b>");}else{if(U>-1){T=D.replace("##",mstrmojo.desc(7773,"seconds")).replace("#","<b>"+U+"</b>");}else{T=mstrmojo.desc(11865,"Your session is expired.");}}this.message.text="";this.message.set("text",T);this.remainingTime=U;},showMessage:function F(T){this.updateMsg(T);this.set("visible",true);M=true;},hideMessage:function I(){if(A){window.clearInterval(A);A=null;window.clearInterval(H);H=null;}this.set("visible",false);M=false;},popupTimeoutWarning:function L(X){if(M){return ;}var V=this,W=(typeof X==="number")?X:V.timeBeforeSessionTimeoutWarning,T=W,U=mstrmojo.now();if(mstrApp.enableWarningSessionTimeout){if(!this.hasRendered){this.render();}this.showMessage(T);}window.clearInterval(A);A=window.setInterval(function(){if(T<1){window.clearInterval(A);A=null;window.setTimeout(function(){if(mstrApp.enableWarningSessionTimeout){V.gotoLogoutPage();}else{V.sessionTimedout=true;V.closeSession();}},200);}var Y=Math.round((mstrmojo.now()-U)/1000);T=W-Y;V.updateMsg(T);},this.msgInterval*1000);window.clearInterval(H);H=window.setInterval(function(){V.isSessionAlive();},this.checkSessionInterval*1000);},warningTimeoutTimer:function Q(T){var U=this;window.clearTimeout(G);G=window.setTimeout(function(){G=null;U.isSessionAlive();},(T-this.timeBeforeSessionTimeoutWarning)*1000);},isSessionAlive:function E(){var T=this,V={success:function(W){var X=parseInt(W,10);if(X!==-1){if(X>T.remainingTime){T.hideMessage();}if(X>T.timeBeforeSessionTimeoutWarning){T.warningTimeoutTimer(X);}else{T.popupTimeoutWarning(X);}}else{window.clearInterval(H);T.popupTimeoutWarning(0);}},failure:function(){mstrmojo.alert("Problems encountered during checking for whether session is alive. Connection is down or session already time out.");}},U={taskId:"isSessionAlive",notRestartSessionManager:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,U);},keepSessionAlive:function R(){var T=this,V={success:function(W){if(W){T.warningTimeoutTimer(T.maxSessionIdleTime);}else{T.sessionTimedout=true;mstrmojo.alert("Your session is expired.");}},failure:function(){mstrmojo.alert("Problems encountered during activating session. Connection is down or session already time out.");}},U={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,U);},closeSession:function J(){var T=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){T.sessionTimedout=true;}},{taskId:"closeSessions",sessionStates:N(),notRestartSessionManager:true});},restart:function(){this.sessionTimedout=false;this.hideMessage();if(this.maxSessionIdleTime>this.timeBeforeSessionTimeoutWarning){this.warningTimeoutTimer(this.maxSessionIdleTime);}},start:function C(){var V=mstrConfig.lastMsgKey;if(this.maxSessionIdleTime>this.timeBeforeSessionTimeoutWarning){this.warningTimeoutTimer(this.maxSessionIdleTime);}var U=function(){window.localStorage.setItem("msg_recovery_notify"+V,1);};if(window.addEventListener){window.addEventListener("beforeunload",U);}else{window.attachEvent("onbeforeunload",U);}var T=window.sessionStorage;if(T){T.setItem("msg_browser_not_closed"+V,1);T.setItem("msg_user_login",0);}},openLoginEditor:function P(V){var U="LoginEditor",T=mstrmojo.all[U];if(!T){T=mstrmojo.insert({id:U,scriptClass:"mstrmojo.LoginEditor",config:{callback:{}},zIndex:10000});}T.config.callback=V;T.open();},gotoLogoutPage:function O(){mstrmojo.form.send({evt:3008,src:mstrApp.name+".3008",autoLoggedout:true,Server:mstrConfig.serverName,Port:mstrConfig.serverPort,Project:mstrConfig.projectName,loginReq:true},null,"POST");}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.dom","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.LoginEditor","mstrmojo.SessionManager");function O(b,Z){var a=(Z?"add":"remove")+"LoadingGraph";this.serverProxy[a](b);}var K=true,N="waitBox";mstrmojo._IsWebApp=mstrmojo.provide("mstrmojo._IsWebApp",{_mixinName:"mstrmojo._IsWebApp",serverProxy:null,init:function T(Z){this._super(Z);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}},start:mstrmojo.emptyFn,styleName:"RWDocumentMojoStyle",modelFactory:null,enableWaitBox:false,onMobileDevice:function D(){return false;},isTouchApp:function G(){return false;},getContentDimensions:function X(Z){return null;},getConfiguration:mstrmojo.emptyFn,setInteractive:function J(Z){if(K!==Z){K=Z;mstrmojo.dom.toggleSelection(window.document.body,Z);return true;}return false;},isInteractive:function W(){return K;},addLoadingGraph:function E(Z){O.call(this,Z,true);},removeLoadingGraph:function U(Z){O.call(this,Z);},serverRequest:function R(f,g,a){try{g=g||{};a=a||{};var c=a.src||(arguments.callee&&arguments.callee.caller.name),Z=!this.enableWaitBox||a.silent,e=a.hideFailureErr,d=this;f.styleName=f.styleName||this.styleName;g=mstrmojo.func.wrapMethods(g,{submission:function(h){if(!Z){mstrmojo.all[N].requestId=h;}},failure:function(h){if(!Z){h.method=c;if(!(mstrApp.isSingleTier&&h.code===403)&&!e){mstrmojo.err(typeof h.mstrerr==="object"?h.mstrerr:h);}}},complete:function(){if(!Z){if(mstrmojo.all[N]){delete mstrmojo.all[N].requestId;}d.hideWait();}}});if(!Z){this.showWait(a&&a.waitBoxCfg);}window.setTimeout(function(){d.serverProxy.request(g,f,!!a.override,a);},0);}catch(b){mstrmojo.err(b);}},hasRequests:function Q(){return this.serverProxy.hasRequests();},getWaitBoxPosition:function(){return null;},isWaiting:function B(){var Z=mstrmojo.all[N];return !!(Z&&Z.visible);},showWait:function F(a){var c=this,d=mstrmojo.all[N]||mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:N,cssClass:"mstrWaitBox",draggable:false,showTitle:false,zIndex:99999,counter:0,displayMsg:null,position:null,ondisplayMsgChange:function b(){this.msgfield.set("text",this.displayMsg);},oncounterChange:function Z(){var f=this.counter,k=this.visible;if(f===0&&k){this.close();}else{if(f>0&&!k){this.open();mstrmojo.dom.center(this.editorNode);var e=this.position||c.getWaitBoxPosition();if(e){var h=e.top,g=e.left;if(h!==undefined){this.set("top",h+"px");}if(g!==undefined){this.set("left",g+"px");}}}}},children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrIcon-wait",alias:"icon"},{scriptClass:"mstrmojo.Label",cssClass:"mstrWaitMsg",alias:"msgfield"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton mstrWaitCancel",alias:"cancelBtn",text:mstrmojo.desc(2140,"Cancel")}]});d.cancelBtn.set("visible",!!(a&&a.showCancel));d.cancelBtn.onclick=function(){c.serverProxy.cancelRequests();};if(a&&a.position){d.position=a.position;}else{d.position=null;}d.set("displayMsg",(a&&a.message)||mstrmojo.desc(11960,"Loading Data..."));if(!this._waitUserLogin){d.set("counter",d.counter+1);}else{this._waitCounter=this._waitCounter+1;}return d;},hideWait:function L(Z){var a=mstrmojo.all[N];if(a){a.set("counter",Z?0:Math.max(0,a.counter-1));}},startSessionManager:function S(a){var b=mstrApp,Z=b.enableAutomaticSessionRecovery&&b.maxSessionIdleTime;b.sessionManager=b.addDisposable(new mstrmojo.SessionManager(mstrmojo.hash.copy(a,Z?{timeBeforeSessionTimeoutWarning:mstrApp.timeBeforeSessionTimeoutWarning,maxSessionIdleTime:b.maxSessionIdleTime}:{})));if(Z){b.sessionManager.start();}},isSessionExpiredError:function Y(e){var d=2147760371,b=2147760372,a=2147758245,Z=2147759877;e=(e<0)?(4294967296+parseInt(e,10)):e;switch(e){case d:case b:case a:case Z:return true;}return false;},onSessionExpired:function V(b){if(mstrApp.authMode==mstrmojo.EnumAuthenticationModes.INTEGRATED){var e={evt:5005,src:mstrApp.name+"."+mstrApp.pageName+".5005"},a=(mstrApp.docModel&&mstrApp.docModel.bs)||(mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model&&mstrApp.rootCtrl.docCtrl.model.bs)||(mstrApp.docModelData&&mstrApp.docModelData.bs);if(a){e.rwb=a;}mstrmojo.form.send(e);return ;}if(mstrApp.sessionManager){var d=mstrmojo.all[N],Z=d&&d.counter>0,c=this;this._waitCounter=-1;if(Z){this._waitCounter=d.counter-1;c.hideWait(true);}this._waitUserLogin=true;mstrApp.sessionManager.openLoginEditor({success:function(f){c._waitUserLogin=false;if(f&&f.sessionState){if(b){if(b.params.sessionState){b.params.sessionState=f.sessionState;}if(Z){d.counter=c._waitCounter;c.showWait();}mstrmojo.xhr.request(b.method,b.baseUrl,b.callback,b.params);}}},cancelRequests:function(){mstrApp.serverProxy.cancelRequests();}});}},updateSessionState:function M(Z){this.sessionState=Z;},onNavigateOut:mstrmojo.emptyFn,showHelpTopic:function A(a){var Z=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm#");if(a&&typeof a==="string"){Z+=a;}if(mstrApp.isSingleTier){window.FormWrapper.openPage(Z);}else{mstrApp.openPage(Z);}return false;},getSearchAutoCompleteDelay:function P(){return parseInt(mstrConfig&&mstrConfig.searchAutoCompleteDelay,10)||200;},getThemeClassName:function C(){return"mojo-theme-light";},openPage:function I(Z,a){window.open(Z,a);},modalEditorChange:function H(a,Z){}});window.$MAPF=function(){return false;};}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.desc","mstrmojo.vi.ui.NumberFormatter");var B=mstrmojo.desc;mstrmojo.vi.ui.NumberFormatterEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatterEditor",onSubmenuOpen:function A(){},myData:null,oldData:null,formatValue:null,onOK:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",bindings:{myData:"this.parent.myData",oldData:"this.parent.oldData",formatValue:"this.parent.formatValue"}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-subtotals-button",children:[{scriptClass:"mstrmojo.Button",text:B(221,"Cancel"),onclick:function(){this.parent.parent.onSubmenuClosed();}},{scriptClass:"mstrmojo.Button",text:B(1442,"OK"),onclick:function(){var C=this.parent.parent,D=C.xtab;C.onSubmenuClosed();this.parent.parent.onOk();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.date","mstrmojo.string");var B=mstrmojo.ValidationTextBox.prototype.markupMethods,D=mstrmojo.string,A=function(){return mstrmojo.locales.datetime;},C=mstrmojo.date;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,dynDateValue:null,showAdvanced:false,canSelectDisabledDate:false,isList:false,dtp:14,defaultDate:null,autoFormat:true,enabled:true,min:"",max:"",markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:B.onvalueChange,onenabledChange:B.onenabledChange,onvalidationStatusChange:B.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var H=this.opener,G=H&&H.calendarZIndex,I=this.cal,E=H&&H.calConfig;if(G){this.domNode.style.zIndex=G;}for(var F in E){I.set(F,E[F]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{showAdvanced:"this.parent.opener.showAdvanced",dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",dynDateValue:"this.parent.opener.dynDateValue",enabled:"this.parent.opener.enabled",min:"this.parent.opener.min",max:"this.parent.opener.max",canSelectDisabledDate:"this.parent.opener.canSelectDisabledDate",changeValueOnOK:function(){var F=this.parent.opener.dtp,E=this.parent.opener.changeValueOnOK;return F===15||F===16||E;}},closeOnValueChange:true,onValueUpdate:function(F){var I=this.parent&&this.parent.opener;if(I){var G=I.value,E=window.mstrConfig&&window.mstrConfig.listSep||";",H=I.dtp===15?C.formatTimeInfo(this.timeVal,A().TIMEOUTPUTFORMAT):this.value;if(I.isList&&!D.isEmpty(G)){I.set("value",I.value+E+H);}else{I.set("dynDateValue",this.dynDateValue);I.set("value",H);}I.closePopup();}}}]},onclick:function(E){var F=this._lastOpened,G=this._calendarConfig;if(!G){G={};if(this.calendarToBody){delete this.calendar.slot;G.placeholder=document.body.appendChild(document.createElement("div"));G.nudge=function(){var M=this.opener;if(M){var H=mstrmojo.dom.position(M.popupNode,true),L=this.domNode,P=L.offsetHeight,I=L.offsetWidth,J=mstrmojo.dom.windowDim(),K=H.x,N=H.y;if(N+P>=J.h){N=Math.max(N-P,0);}if(K+I>=J.w){K=Math.max(K-I,0);}var O=L.style;O.top=N+"px";O.left=K+"px";}};}this._calendarConfig=G;}G.lockIW=this;if(F&&F.visible){this.closePopup();}else{this.openPopup("calendar",G);this.calendar.cal.updateSelectedDate(true);}},unrender:function(){this._super();if(this.calendarToBody&&this._calendarConfig){delete this._calendarConfig;}if(this.calendar.hasRendered){this.calendar.unrender();}},_set_value:function(H,F){var G=this.value,E=(G!==F);if(E){this.value=F;this.validate(F);}if(this.showAdvanced&&this.dynDateChanged){this.dynDateChanged=false;E=true;}return E;},_set_dynDateValue:function(H,F){var G=this.dynDateValue,E=(G!==F);if(E){this.dynDateValue=F;this.dynDateChanged=true;}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase","mstrmojo.array","mstrmojo.hash","mstrmojo.func");var S=mstrmojo.array,W=mstrmojo.hash,d=mstrmojo.func,K="mstrTestOneTierPreferences",E={};function X(k){return k&&[k.conntp,"//",k.wsn,k.wsport?(":"+k.wsport):"","/",k.wspath,k.wstp==="j2ee"?"/servlet/taskProc":"/asp/taskProc.aspx"].join("");}function R(l){var k=E[l];if(!k){k=E[l]={};}return k;}mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy=mstrmojo.declare(mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase,null,{scriptClass:"mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy",showPreferencesEditor:function B(){mstrApp.executeCommand("showPrefsEditor");},savePreferences:function f(k){this.getSavedPreferences({success:function l(m){sessionStorage.setItem(K,JSON.stringify(W.mergeHashes(m,k)));}});},getSavedPreferences:function h(m){var k={};try{k=JSON.parse(sessionStorage.getItem(K));}catch(l){console.error("Error retrieving the saved preferences (Error: ##).".replace("##",l));}m.success(k);},deleteServerConnections:function G(k){this.getSavedPreferences({success:function l(o){var m=o.server,n=m.conn;k.forEach(function(p){n.splice(n.map(function(q){return q.id;}).indexOf(p),1);});sessionStorage.setItem(K,JSON.stringify(o));}.bind(this)});},testServerConnection:function J(k,l){window.setTimeout(function(){l.success({code:200});},2000);},loginToWebserver:function C(l,n,k,m){window.setTimeout(function(){m.success({code:401,wsn:"localhost"});},500);},loginToProxy:function D(o,n,k,l,m){window.setTimeout(function(){m.success({code:407,proxyUrl:"localhost"});},500);},authenticationCancelled:function T(){console.log("authenticationCancelled");},resumeDashboardExecution:function M(){console.log("resumeDashboardExecution");},checkForDesktopUpdates:function b(){window.alert("Checking for updates: Native code.");},showProxyEditor:function O(){window.alert("Show proxy editor: Native code.");},getSessionState:function a(p,o,l,r,t){var k=R(p),n=k[o]&&k[o][l],q=n&&n[r],m=function m(u,w){var v={taskId:"isSessionAlive",notRestartSessionManager:true,sessionState:u,connectionId:p};this.sendWebServerRequest(v,w);}.bind(this);if(q){m(q.sessionState,{success:function(u){if(u.data===-1){t.failure({statusCode:401});}else{t.success(q);}}});}else{t.failure({statusCode:401});}},getLoginFirstSessionState:function g(m,n){var l=R(m),k=l.loginFirst;if(k){n.success(k);}else{n.failure({statusCode:401});}},getProjects:function L(k,l){this.sendWebServerRequest(W.copy(k,{taskId:"getProjectsInfo",dataFlag:2}),l);},login:function U(k,l){this.sendWebServerRequest(W.copy(k,{taskId:"login"}),d.wrapMethods({success:function(o){var m=R(k.connectionId),n=m[k.server],p;if(!n){n=m[k.server]={};}p=n[k.port];if(!p){p=n[k.port]={};}p[k.project]=o;}.bind(this)},l));},loginFirst:function U(k,l){this.sendWebServerRequest(W.copy(k,{taskId:"loginFirst"}),{success:function(n){var m=R(k.connectionId);if(!m){m={};m.loginFirst={};}m.loginFirst={sessionState:n.sessionState,Uid:k.Uid,Pwd:k.Pwd};l.success(m.loginFirst);}.bind(this),failure:function(m){if(l&&l.failure){l.failure(m);}}});},saveToServer:function F(k,l){l.success({did:"250BFCDB4CA5AF712A36C68E92451AB7",n:"New Dashboard",fdid:"0C77FD3642136F4728D87283759C3CE8",servletPath:"http://was-gespinola:8080/Connectivity/servlet/"});},loadCube:function c(k,l){if(!k.addDatasetToDocument){l.success({did:"D28CB3AB48BCAB8E7D9A2BA4A7C9C2A0"});}else{l.success();}},getCubeInfo:function H(k,l){window.setTimeout(function(){l.success({hsf:false,acld:false,dda:true,cs:111,mmf:2});},100);},openFromServer:function A(k,l){l.success({cubeDLInfo:{maxcs:10,cubes:[{n:"cube1",id:"1234134...1234",dda:1},{n:"cube3",id:"1234134...1234",acld:1},{n:"cube2",id:"234...1234",cs:1500}]}});},getPublicCloudSession:function N(k,l){window.setTimeout(function(){l.success({status:true,message:"",code:0,session:"sessionstate",public_url:"http://was-gespinola:8080/MstrMain/servlet/mstrWeb"});},100);},saveToPublicCloud:function V(k,l){l.success({url:"http://google.com"});},logout:function e(k,l){window.setTimeout(function(){var m=R(k.connectionId),n=m[k.server],o;if(n){n=m[k.server];o=n[k.port];if(o){o=n[k.port];delete m.loginFirst;delete o[k.project];}}l.success();}.bind(this),0);},sendWebServerRequest:function Z(l,m){this.getSavedPreferences({success:function k(o){var n="http://localhost:8080/main/servlet/taskProc";if(o){var p=o.server.conn;n=X(p[S.find(p,"id",l.connectionId)]);delete l.connectionId;}mstrmojo.xhr.request("POST","taskProc",m,l,undefined,n);}});},getObjectInfo:function Q(k,l){this.sendWebServerRequest(W.copy(k,{taskId:"getObjectInfo"}),l);},getUserServices:function I(k,l){this.sendWebServerRequest(W.copy(k,{taskId:"getUserServices"}),l);},saveObjectACL:function P(k,l){this.sendWebServerRequest(W.copy(k,{taskId:"saveObjectACL"}),l);},getUserEntityInfo:function Y(k,l){this.sendWebServerRequest(W.copy(k,{taskId:"getUserEntityInfo"}),l);}});}());(function(){mstrmojo.requiresCls("mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase","mstrmojo.hash");var V=mstrmojo.hash;mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy=mstrmojo.declare(mstrmojo.onetier.vi.prefs.DesktopConnectivityProxyBase,null,{scriptClass:"mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy",showPreferencesEditor:function B(l){window.FormWrapper.showPreferencesEditor(JSON.stringify(l));},savePreferences:function d(l){mstrApp.serverRequest({taskId:"updatePreference",value:l});},getSavedPreferences:function g(l){mstrApp.serverRequest({taskId:"getPreferences"},l);},deleteServerConnections:function G(l){mstrApp.serverRequest({taskId:"deleteServerConnections",value:l});},testServerConnection:function K(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"testServerConnection"}),m);},cancelRequest:function E(m,l){mstrApp.serverRequest({taskId:"cancelRequest",id:m},l,{});},loginToWebserver:function C(m,o,l,n){mstrApp.serverRequest({taskId:"loginToWebserver",wsn:m,username:o,password:l},n,{doNotHold:true});},loginToProxy:function D(p,o,l,m,n){mstrApp.serverRequest({taskId:"loginToProxy",proxyUrl:p,username:o,password:l,saveToPrefs:m},n,{doNotHold:true});},authenticationCancelled:function S(){var l={taskId:"authenticationCancelled"};if(mstrApp.recoveryIndex){l.recoveryIndex=mstrApp.recoveryIndex;}mstrApp.serverRequest(l,null,{doNotHold:true});if(mstrApp.recoveryIndex){mstrApp.recoveryIndex=undefined;}},resumeDashboardExecution:function N(){var m={taskId:"resumeDashboardExecution"};if(mstrApp.recoveryIndex){m.recoveryIndex=mstrApp.recoveryIndex;}mstrApp.serverRequest(m,{success:function l(n){if(n&&n.statusOnly!==true){mstrApp.start(n);}}},{doNotHold:true});if(mstrApp.recoveryIndex){mstrApp.recoveryIndex=undefined;}},checkForDesktopUpdates:function Z(){window.FormWrapper.runCheckUpdate();},showProxyEditor:function P(){window.FormWrapper.showProxyEditor();},getProjects:function M(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"getProjectsInfo",dataFlag:2}),m,{silent:true});},getSessionState:function Y(n,m,l,o,p){mstrApp.serverRequest({taskId:"getSessionState",connectionId:n,isLoginFirst:false,project:o,server:m,port:l},p);},getLoginFirstSessionState:function e(l,n){var m={taskId:"getSessionState",connectionId:l,isLoginFirst:true};mstrApp.serverRequest(m,n);},login:function T(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"login"}),m,{silent:true,doNotHold:true});},usherLoginWeb:function L(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"usherLoginWeb"}),m,{silent:true,doNotHold:true});},loginFirst:function T(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"loginFirst"}),m,{silent:true,doNotHold:true});},saveToServer:function F(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"desktopImportSaveDashboard"}),m,{silent:true});},loadCube:function a(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"loadCube",keepPolling:"true",maxWait:500}),m,{silent:true});},getCubeInfo:function I(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"checkCube"}),m,{silent:true});},openFromServer:function A(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"exportDocument",executionMode:18,keepPolling:"true",executeDefaultPromptOrFail:"true"}),m,{silent:true});},getPollingStatus:function H(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"getPollingStatus"}),m,{silent:true});},shutDownDesktop:function k(m,l){mstrApp.serverRequest({taskId:"shutDownDesktop",force:!!l},m,{silent:true,doNotHold:true});},refreshNativeDialogMenu:function b(){mstrApp.serverRequest({taskId:"refreshNativeDlgMenu"},{},{silent:true});},sendWebServerRequest:function X(m,n,l){mstrApp.serverRequest(m,n,l);},saveToPublicCloud:function U(l,m){mstrApp.serverRequest({taskId:"desktopPublishPublicDashboard",sessionState:l},m);},logout:function c(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"logout"}),m);},getPublicCloudSession:function O(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"publicCloudLogin"}),m,{silent:true});},getObjectInfo:function R(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"getObjectInfo"}),m,{silent:true});},getUserServices:function J(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"getUserServices"}),m,{silent:true});},saveObjectACL:function Q(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"saveObjectACL"}),m,{silent:true});},getUserEntityInfo:function W(l,m){mstrApp.serverRequest(V.copy(l,{taskId:"getUserEntityInfo"}),m,{silent:true});},isCurrentProject:function h(m,l){mstrApp.serverRequest({taskId:"IsCurrentProj",pn:m.project.name,sn:m.iServer.name,isp:m.iServer.port},{success:function(n){l.success(!!n.ic);},failure:function(n){mstrmojo.error({longDesc:"Failure on IsCurrentProj task "+JSON.stringify(n||{})},undefined,{zIndex:100000});}},{silent:true});},getCleanDocModel:function f(l){mstrApp.serverRequest({taskId:"createDocInstance"},V.copy({failure:function(m){mstrmojo.error({longDesc:"Failure on createDocInstance task "+JSON.stringify(m||{})},undefined,{zIndex:100000});}},l),{silent:true});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.AdvancedColorPickerPopup","mstrmojo.css");var F=mstrmojo.css,E=Math.round;function I(N){var O=this.previewNode,M=O.offsetWidth,P=O.offsetHeight,Q=Math.sqrt(M*M+P*P),L=Math.atan2(P,M)*(-180)/Math.PI;O.style.backgroundColor="#FFFFFF";N.display="block";N.top=E(P/2)+"px";N.left=E((M-Q)/2)+"px";N.width=E(Q)+"px";N[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+E(L)+"deg)";}mstrmojo.ui.editors.controls.ColorPickerButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onselectedValueChange:function(){this.updatePreview();this.colorPicker.set("color",this.selectedValue);},onautoPreviewColorChange:function C(){this.getPopupWidget().set("autoPreviewColor",this.autoPreviewColor);this.updatePreview();},onenabledChange:function G(){F.toggleClass(this.domNode,"disabled",!this.enabled);}},isHostedWithin:false,showGradient:true,showNoFill:true,showAutomatic:false,autoPreviewColor:null,selectedValue:null,init:function K(M){this._super(M);var L=this.colorPicker;L.showGradient=this.showGradient;if(this.showNoFill!==undefined){L.showNoFill=this.showNoFill;L.showAutomatic=this.showAutomatic;}L.showAutomatic=this.showAutomatic;F.addWidgetCssClass(this,"mstrmojo-ColorPickerBtn");},preBuildRendering:function J(){this.colorPicker.showNoFill=this.showNoFill;return this._super();},setDimensions:function H(M,L){this._super(M,L);window.setTimeout(function(){this.updatePreview();}.bind(this),0);},postBuildRendering:function A(){var L=this.noFillNode=document.createElement("div");L.style.display="none";L.className="slash";this.domNode.firstChild.appendChild(L);this._super();},updatePreview:function B(){var P=this.previewNode;if(P){var N=this.selectedValue===mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC?this.autoPreviewColor:this.selectedValue;if(N){var Q=P.style;if(N.c1){var R=F.buildGradient(N.or,N.c1,N.c2);if(R&&R.n){Q[F.convertCssToCamelCase(R.n)]=R.v;}}else{var L=F.buildGradient(0,"0","0");if(L&&L.n){Q[F.convertCssToCamelCase(L.n)]=null;}var O="conflict"===N||("transparent"===N&&!this.showNoFill);F.toggleClass(P,"conflict",O);Q.backgroundColor=!O?N:null;}if(this.showNoFill&&this.noFillNode&&this.enabled){var M=this.noFillNode.style;if("transparent"===N){I.call(this,M);}else{M.display="none";}}}}},getPopupWidget:function D(){return this.colorPicker;},children:[{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",alias:"colorPicker",slot:"widgetHostNode",color:this.selectedValue,isHostedWithin:true,colorChanged:function(L){this.parent.set("selectedValue",L);this.close();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.ui.menus._HasMenuPopup");function E(H,F){var G=this.domPopupPH;G.style.top=H.y+"px";G.style.left=H.x+"px";G.innerHTML="";document.body.appendChild(G);F.hostId=this.id;F.hostElement=G;mstrmojo.css.toggleClass(G,mstrApp.getThemeClassName(),true);this.openPopup(F.newInstance());}function B(){var G=this.domPopupPH,H=G.firstChild,F=G.parentNode;if(H){G.removeChild(H);}if(F){F.removeChild(G);}}function A(G){var F;if(typeof this.parent.boxContent.getTitleRMCPopup==="function"){F=this.parent.boxContent.getTitleRMCPopup.call(this);}if(F){E.call(this,G,F);}}mstrmojo.vi.ui.TitleBarWithRMCPopup=mstrmojo.declare(mstrmojo.vi.ui.TitleBar,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.TitleBarWithRMCPopup",markupString:'<div id="{@id}" class="mstrmojo-VITitleBar {@cssClass}" style="{@cssText}" mstrAttach:contextmenu, click><div class="left-toolbar"></div><div class="title-text"></div><div class="right-toolbar"></div></div>',init:function D(F){this._super(F);var G=document.createElement("div");G.setAttribute("class","gm-menu-placeholder");this.domPopupPH=G;},oncontextmenu:function C(F){A.call(this,{x:F.e.pageX+2,y:F.e.pageY+2});},unrender:function(){this._super();B.call(this);},onclick:function(){B.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.vi.ui.PanelContents");function D(G,H,F){if(H){this.targetUnit.updateDisplayName(G,F);}}function A(F){this.set("title",F.value);}function B(F){if(this.layoutKey!==this.model.currlaykey){return ;}if(this._vizTitleSub){this._vizTitleSub.clear();delete this._vizTitleSub;}this.set("title","");var H=this.contents,G=(H.children||[]).slice();H.removeChildren();G.forEach(function(J){J.destroy();});var I=mstrmojo.all[F.id];if(I){this.targetUnit=I;this.set("title",I.getDisplayName());this._vizTitleSub=I.attachEventListener("titleChange",this.id,A);this.onVIUnitSelected(I);}}mstrmojo.vi.ui._IsUnitDependentPanel=mstrmojo.provide("mstrmojo.vi.ui._IsUnitDependentPanel",{_mixinName:"mstrmojo.vi.ui._IsUnitDependentPanel",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontitleChange:function(){var F=this.toolbar;if(F){F.set("title",this.title||"");}}},targetUnit:null,init:function E(F){this._super(F);this.model.attachEventListener("viUnitSelected",this.id,B);this.toolbar.set("editTitleOnDoubleClick",mstrApp.allowWebDashboardDesign());},children:[{scriptClass:"mstrmojo.vi.ui.TitleBar",slot:"controlNode",alias:"toolbar",useRichTooltip:true,titleEdited:function(G,H,F){D.call(this.parent,G,H,F);},layoutConfig:{w:{textNode:"100%",rightToolNode:"23px"},h:{textNode:"all",rightToolNode:"all"},xt:true}},{scriptClass:"mstrmojo.vi.ui.PanelContents",slot:"containerNode",alias:"contents"}],onRender:function C(){var F=this.model.getSelectedViUnit();if(F){B.call(this,{id:F.id});}if(this._super){this._super();}},onVIUnitSelected:function(F){}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.Image","mstrmojo.css");mstrmojo.vi.ui.CollapsibleTitleBar=mstrmojo.declare(mstrmojo.vi.ui.TitleBar,null,{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",btnCollapse:null,canCollapse:false,isCollapsed:false,collapse:mstrmojo.emptyFn,onToggleCollapseByUI:mstrmojo.emptyFn,setToolbarVisibility:function C(D){if(!D||!this.isCollapsed){this._super(D);}},onisCollapsedChange:function B(){if(this.canCollapse){var D=this.isCollapsed;this.parent.set("isCollapsed",D);}},getLeftToolbarChildren:function A(){var D=this;return[{scriptClass:"mstrmojo.Image",slot:"leftToolNode",alias:"btnCollapse",onclick:function(){var E=this.parent;if(E.canCollapse){E.set("isCollapsed",!E.isCollapsed);D.onToggleCollapseByUI();}}}];}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.CollapsibleTitleBar,{oncanCollapseChange:function(){this.btnCollapse.set("visible",this.canCollapse);},onisCollapsedChange:function(){mstrmojo.css.toggleClass(this.domNode,"collapsed",this.isCollapsed);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui.tabs.Tab","mstrmojo.ME.MetricEditBox","mstrmojo.array","mstrmojo.hash");var Z=mstrmojo.array,M=mstrmojo.hash,K=mstrmojo.ME.MetricToken.brackets,L=mstrmojo.dom,B=mstrmojo.css,Q=mstrmojo.vi.ui.tabs.Tab.ACTIONS,g=Q.DELETE+Q.RENAME,k=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,D=mstrmojo.string,m="This@ID",T="45C11FA478E745FEA08D781CEA190FE5";function G(q){return{n:q,k:q,ftk:[],vs:1,is:""};}function O(w,x,q,u){var t=w.forms[x]||{},v=w.forms[q],r=w.inputBox;if(x!==q){t.vs=w.vStatus;t.is=w.iStatus;t.ftk=r.items;w.set("vStatus",k.UNKNOWN);}w.set("vStatus",v.vs);w.set("iStatus",v.is);w.updateInputBoxItems({items:v.ftk});if(w.curFormIdx!==q){w.curFormIdx=q;w.tabstrip.setSelectedTab(v.k);}w.raiseEvent({name:"tabSwitch",tks:v.ftk,vs:v.vs,is:v.is,oidx:x,nidx:q,toNewTab:u});}function N(r){var q=r.forms[r.curFormIdx];if(q){q.ftk=r.inputBox.items;q.vs=r.vStatus;q.is=r.iStatus;}}var e=0;function W(q){e=Math.max(q.length-1,e);}function V(){e=0;}function n(q){var r="DESC"+(e?" "+e:"");e++;if(Z.find(q,"n",r)>=0){return n(q);}return r;}function I(v){var u={v:K(v.n),oi:v,isNew:true},r,q;if(v.t===12){r=Z.filter(v.fs,function(t){return t.obf||v.da;}).length;if(r===1){q=v.fs[0];u=M.copy({v:K(v.n)+"@"+K(q.fnm),ift:true,exv:q.fid,extp:8},u);}else{u=M.copy({v:K(v.n)+"@",ift:true},u);}}return u;}function E(r,q){r.set("enabled",!q);var t="mstrmojo-InlineWaitIcon";if(r.iconClass){r.set("iconClass",r.iconClass.replace(new RegExp(t),"")+" "+(q?t:""));}else{mstrmojo.css.toggleClass(r.domNode,t,q);}}var U=function(AA){var u=AA.items,v=u.length,w=u[u.length-1],t,r,z=[],q="",x;if(u[0]&&u[0].tp!==33){z.push({v:"!",tp:33,lv:4,sta:2});}for(t=0;t<v;t++){r=u[t];if(r.isNew&&!r.oi){q+=r.v;}else{if(!D.isEmpty(q)){z.push({v:q,tp:2,lv:1});q="";}if(r.v&&r.v.indexOf(m)>=0){r.v=r.v.replace("["+m+"]",m);r.exv=T;r.extp=8;delete r.oi;}z.push(r);}}if(!D.isEmpty(q)){z.push({v:q,tp:2,lv:1});q="";}if(w&&w.tp!==-1){z.push({v:"",tp:-1,lv:4,sta:2});}return{items:z};},a=function(t){var q=t.items||[],r=q[q.length-1];if(r&&r.tp===-1){q.pop();}if(q[0]&&(q[0].tp===33||q[0].tp===37)){q.splice(0,1);}Z.forEach(q,function(u){if(u.v&&u.v.indexOf(m)>=0){M.copy({extp:8,exv:T,oi:{n:"This",did:"This",t:12}},u);}});},Y=function(q){if(!q){return k.VALID;}return{"-2147214845":k.ERROR,"-2147214846":k.AMBIGUITY}[q]||k.ERROR;},R=function(t){t=U(t);var r={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true,vtp:true},q={getArrItemName:function(){return"tkn";},isSerializable:function(u){return(r[u])?true:false;}};return D.json2xml("tknstrm",t,q);},F=function(t,w,v,r){var u=R(w),x=function(z){if(z&&z.tks){var AA=z.tks;a(AA);AA.vs=Y(AA.rjec);AA.tokenXML=u;if(r){r(AA);}}},q=function(z){mstrmojo.alert(z.message||z.getResponseHeader&&z.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:u,localSymbolFolderXML:"",metricXML:"",metricId:t||"",isNew:true,objectType:12,isIDForm:v,msgID:mstrApp.getMsgID()},{success:x,failure:q});};mstrmojo.ME.DerivedAttributeFormTab=mstrmojo.declare(mstrmojo.vi.ui.tabs.Tab,null,{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",valid:true,editable:true,postBuildRendering:function S(){if(this._super){this._super();}var q=this,r=q.lbl;r.editOnDoubleClick=this.editable;r.onTextEditComplete=function(u,t){if(q.validate(r.text)){q.titleEdited(r.text,t);}};},onclick:function d(q){var r=mstrmojo.dom.eventTarget(q.hWin,q.e);if(r===this.menuBtnNode){this.tabDeleted();}else{if(!this.isSelected){this.tabSelected();}}},validate:function(q){var r=!/[\[\]\"\\]/g.test(q);if(!r){this.lbl.set("isEditing",true);}this.set("valid",r);return r;},showErrTooltip:function p(v,t){var q=mstrmojo.dom.position(this.domNode),r=this,u=r.errTooltip;if(!u){r.errTooltip=u=new mstrmojo.Tooltip({contentNodeCssClass:"me-tooltip-content up me-err",updatePopupConfig:null});this.addDisposable(u);}u.set("top",q.y+q.h+2);u.set("left",q.x+q.w/2-t);u.set("content",'<div class="content"><span>'+v+"</span></div>");u.open();window.setTimeout(function(){u.close();},2500);},onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.showErrTooltip(mstrmojo.desc(11569,"Input contains invalid character"),95);}}});function f(u,v,w){var t=Z.find(v,"k",w.k);return{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",title:w.n,draggable:false,editable:t!==0,cssClass:"mstrmojo-AEB-Tab "+(t===0?"mstrmojo-AEB-IDTab":""),getMenuActions:function(){return g;},tabSelected:function(){O(u,u.curFormIdx,t);},titleEdited:function r(z,x){if(z!==x){if(Z.find(u.forms,"n",z)>=0){this.showErrTooltip(mstrmojo.desc(7209,"Name already exists"),69);}var AA=u.forms[t];AA.n=z;}},tabDeleted:function q(){var x=u.forms.length,AB=(u.curFormIdx===x-1)?0:u.curFormIdx,z=u.forms.slice(0),AA=z[t];if(AA&&AA.did){u.delForms.push({n:AA.n,did:AA.did});}z.splice(t,1);u.curFormIdx=AB;u.set("forms",z);O(u,-1,AB);u.set("dirty",true);}};}mstrmojo.ME.AttributeEditBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,null,{scriptClass:"mstrmojo.ME.AttributeEditBox",markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-AEB-TabStrip"></div><div class="mstrmojo-MEBox-edit mstrmojo-AEB-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{tabstripNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},statusNode:function(){return this.domNode.lastChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;}},forms:null,delForms:[],curFormIdx:0,attrid:null,absorbAmbiguity:false,init:function l(t){var u=this;u.children=[{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",alias:"tabstrip",position:"top",slot:"tabstripNode",isAlignRight:false,getTabCfg:function r(x,z,w){return M.copy(f(u,x,z),w);},addTab:function v(){var z=u.forms,w=z.length,AA=n(z),x=z.slice(0);x.push(G(AA));u.set("forms",x);O(u,u.curFormIdx,w,true);u.set("dirty",true);},clear:function q(){Z.forEach(this.children,function(w){w.hideTooltip();});}},{scriptClass:"mstrmojo.Button",alias:"clearBtn",slot:"tabstripNode",text:mstrmojo.desc(1763,"Clear All"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-clearAll",onclick:function(){u.inputBox.clearTokens([]);}},{scriptClass:"mstrmojo.Button",alias:"validateBtn",slot:"tabstripNode",text:mstrmojo.desc(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-validate",onclick:function(){u.validateCurrentForm();}}].concat(this.children);this._super(t);},item2textCss:function J(q){return this._super(q)||{21:"afm"}[q.t]||"";},onformsChange:function X(){var q=this.forms,r=q[this.curFormIdx].k;Z.forEach(q,function(t){a({items:t.ftk});});this.tabstrip.setTabs(q,r);W(q);},selectFormTab:function A(q){O(this,this.curFormIdx,q);},postBuildRendering:function S(){if(this._super){this._super();}this.clear();var q=this;this.inputBox.ondrop=function(AA){if(!AA.src.data||!AA.src.data.item){return ;}var z=q.inputBox,v=z.ctxtBuilder.itemWidgets,w=M.copyProps(["did","n","t","fs"],AA.src.data.item),u=I(w),x,r,t;AA.src.data=u;mstrmojo.ListBase2.prototype.ondrop.call(this,AA);if(q.ontokensModify){q.ontokensModify();}x=this.selectedIndices;if(w.t===12&&u.ift&&!u.exv){for(r in x){t=v[r];if(t){z.startTokenSuggestion(t);}}}z.clearSelect(true);B.removeClass(z.domNode,"unselectable");};},clear:function c(){this.curFormIdx=0;this.delForms=[];this.attrid=null;V();this.set("forms",[G("ID")]);this.inputBox.set("items",[]);this.inputBox.resetTokensCache();this.set("vStatus",k.UNKNOWN);this.set("iStatus","");this.tabstrip.clear();},validateCurrentForm:function C(r){var t=this,u=this.validateBtn,q=function(v){E(u,false);t.set("vStatus",v.vs);t.set("iStatus",v.rjed||"");t.updateInputBoxItems({items:v.items});t.statusNode.style.display="block";t.handleValidation(v);if(r){r(v.items,v.vs===k.VALID);}};t.set("vStatus",k.VALIDATING);E(u,true);F(this.attrid,{items:this.inputBox.items},t.curFormIdx===0,q);},validateAllForms:function o(t){var u=this,r=u.forms,q=0,v=function(z){var x=(q===0);if(z){var w=r[q-1];w.ftk=z.items;w.vs=z.vs;w.is=z.rjed||"";w.tokenXML=R({items:z.items});if(z.vs!==k.VALID){u.selectFormTab(q-1);u.handleValidation(z);if(t){t(null,false);}return ;}}if(q===r.length){if(t){t(r,true);}return ;}F(u.attrid,{items:r[q++].ftk},x,v);};N(u);v();},continueValidataion:function P(){this.validateCurrentForm();},getStatusDesc:function b(q){return{0:mstrmojo.desc(11655,"Valid Formula.")}[q];},onvStatusChange:function h(){this.statusNode.style.display=this.vStatus>=k.VALIDATING?"block":"none";},onObjectInsert:function H(u){var v=this.inputBox,t=I(u),q=v.insertTokens([t]),r;if(u.t===12&&t.ift&&!t.exv){r=v.ctxtBuilder.itemWidgets[q];if(r){v.startTokenSuggestion(r);}}}});mstrmojo.ME.AttributeEditBox.preprocessTokenStream=a;mstrmojo.ME.AttributeEditBox.postprocessTokenStream=U;mstrmojo.ME.AttributeEditBox.mapErrorCode=Y;mstrmojo.ME.AttributeEditBox.getTokenStreamXML=R;mstrmojo.ME.AttributeEditBox.validateSyntax=F;mstrmojo.ME.AttributeEditBox.prepareInsertToken=I;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui._HasMask","mstrmojo.vi.ui.tabs.Tab","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.models.FormatModel","mstrmojo.vi.models.VIComponentMap");var A=mstrmojo.hash,F=mstrmojo.dom,H=mstrmojo.array,K=mstrmojo.vi.ui.tabs.Tab.ACTIONS,L=K.DELETE+K.DUPLICATE+K.MOVE+K.RENAME+K.NEW_TAB,O=mstrmojo.vi.models.VIComponentMap.TYPES,E=mstrmojo.models.FormatModel,N=40;mstrmojo.vi.ui.tabs.LayoutTabStrip=mstrmojo.declare(mstrmojo.vi.ui.tabs.TabStrip,[mstrmojo.vi.ui._HasMask],{scriptClass:"mstrmojo.vi.ui.tabs.LayoutTabStrip",docModel:null,isAlignRight:false,isAlignBottom:true,cssClass:"mstrmojo-LayoutTabStrip",markupMethods:{onisAlignBottomChange:function(){mstrmojo.css.toggleClass(this.domNode,"alignTop",!this.isAlignBottom);},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{w:{addBtnNode:N+"px"},xt:true},onAppStateChange:function D(P){this._super(P);this.set("isMasked",P.value===mstrmojo.vi.VisualInsightApp.APP_STATES.SELECTOR_TARGETING);},widgetResized:function J(){var P=function(){this.tabContainerNode.style.maxWidth=(F.position(this.domNode).w-N)+"px";};if(this.hasRendered){P.call(this);return ;}this.attachEventListener("renderComplete",this.id,P);},buildRendering:function M(){this._super();var P=this.borderNode=document.createElement("div");P.className="mstrmojo-VILayoutTabs-divider";P.style.zIndex=this._borderZIndex;this.domNode.appendChild(P);},getTabCfg:function I(Z,R,V){var S=V.k,P=this.id;A.copy({title:R.n,getMenuActions:function U(){return L;},addNewTabMenuItem:function X(c){c.addMenuItem(mstrmojo.desc(13768,"Insert Panel"),"",function(){var d=(Z||[]).filter(function(e){return e.k===S;})[0];d.builder.getLayoutVIMap(d.model.getCurrentLayoutKey()).getComponent(O.VIZ_CONTENT).addPanel();});c.addSeparator();c.addMenuItem(mstrmojo.desc(13769,"Insert Sheet"),"",function(){mstrmojo.all[P].addTab();});},tabSelected:function Q(){var e=this.parent.parent,c=e.model;c.execute({execute:function d(){e.showLayout((Z||[]).filter(function(f){return f.k===S;})[0]);},urInfo:{treesToRender:3}});},tabDeleted:function a(){var e=this.parent.parent,c=e.model;c.execute({execute:function d(){var f=c.getDataService().newUpdate(this);e.deleteLayout(S,f);this.submitUpdate(f);},urInfo:{treesToRender:3}});},tabDuplicated:function Y(){var e=this.parent.parent,c=e.model;c.execute({execute:function d(){var f=c.getDataService().newUpdate(this);e.duplicateLayout(f,S);this.submitUpdate(f,c.cmdMgr().CMD_PHASE.FIRST);},urInfo:{disablePU:true,treesToRender:3}});},titleEdited:function b(d,c){var g=this.k,h=this.parent.parent,l=function(){return H.filterOne(mstrmojo.all[P].getTabs(),function(m){return m.k===g;});},e=function(){return H.filterOne(h.getLayouts(),function(m){return m.k===g;});};this.parent.docModel.renameLayout(S,d,c,{failure:function f(m){mstrApp.onerror(m);l().set("title",c);},success:function k(o){var n=e();n.defn.title=o;n.set("n",o);var m=n.builder.getLayoutVIMap(n.model.getCurrentLayoutKey()).getComponent(O.FILTER_STACK);if(m){m.set("title",o);}l().set("title",o);}});},postCreateChildren:function W(){A.copy({autoApplyDelay:3000,editOnDoubleClick:mstrApp.allowWebDashboardDesign()},this.lbl);},useRichTooltip:true,updateTooltipConfig:function T(d){var e=d.target;if(e===this.lbl.domNode&&e.scrollWidth>e.clientWidth){var c=F.position(e);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMCENTER,cssClass:"vi-regular vi-tooltip-V V-center",content:this.title,top:c.y,left:c.x+c.w/2};}else{this.richTooltip=null;}},getCustomMenu:function(){var h=new mstrmojo.ui.menus.MenuConfig(),d=this.parent,c=d.parent.model,e=d.isAlignBottom,f=E.ENUM_PROPERTY_NAMES.LAYOUT_TAB_POSITION,g=e?mstrmojo.desc(13770,"Move Sheet Tabs to Top"):mstrmojo.desc(13771,"Move Sheet Tabs to Bottom");h.addMenuItem(g,"",function(){var k=function(l){c.set(f,l?0:1);};k(e);c.saveDocProps(E.getFormatUpdate(f,!e),{extras:{params:{suppressData:true}},undo:function(){k(!e);},redo:function(){k(e);}});});return h;}},V);this.docModel=R.model;return V;},addTab:function C(){var Q=this.parent,P=Q.model;P.execute({execute:function R(){var S=P.getDataService().newUpdate(this);Q.addNewLayout(S,-1,null);this.submitUpdate(S,P.cmdMgr().CMD_PHASE.FIRST);},urInfo:{disablePU:true,treesToRender:3}});},commitTabMove:function B(P,Q){this.parent.moveLayout(P,Q);},onTabsChange:function G(){(this.children||[]).slice(0).reverse().forEach(function(R,Q,P){var T=Q+2;if(R.isSelected){T=P.length+3;var S=this.borderNode;if(this.borderNode){S.style.zIndex=T-1;}else{this._borderZIndex=T-1;}}R.set("zIndex",T);},this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.string","mstrmojo.form","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricEditBox","mstrmojo.mstr.EnumDataType","mstrmojo.ME.Enum");mstrmojo.requiresDescs(218,219,221,531,628,1442,1918,2102,2116,2154,2213,2919,5298,5424,5728,5891,7558,7984,7987,11566,13249);var F=mstrmojo.string,o=mstrmojo.mstr.EnumDataType,A=mstrmojo.ME.MetricDataService;function R(u){var q=u.items,S=q.length,t="",r;for(r=0;r<S;r++){t+=q[r].v;}return t;}var J=mstrmojo.dom,E=mstrmojo.string,P=mstrmojo._FormatDefinition,l=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,C=mstrmojo.ME.Enum.METRIC_EDIT_TYPES;var U=function(S){if(!S){return l.VALID;}return{"-2147214845":l.ERROR,"-2147214846":l.AMBIGUITY}[S]||l.ERROR;},T=function(x){var u=x.items,q=u.length,w=u[u.length-1],t,v,r=[],S="";if(u[0]&&u[0].tp!==38){r.push({v:"&",tp:38,lv:4,sta:2});}for(t=0,q=u.length;t<q;t++){v=u[t];if(v.isNew&&!v.oi){S+=v.v;}else{if(!E.isEmpty(S)){r.push({v:S,tp:2,lv:1});S="";}r.push(v);}}if(!E.isEmpty(S)){r.push({v:S,tp:2,lv:1});S="";}if(w&&w.tp!==-1){r.push({v:"",tp:-1,lv:4,sta:2});}return{items:r};},N=function(r){var t=T(r.tks);var q={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true},S={getArrItemName:function(x,u,w){return"tkn";},isSerializable:function(w,v,u){return(q[w])?true:false;}};return E.json2xml("tknstrm",t,S);},k=function(t){var q=t.items,S=q.length,r=q[q.length-1];if(r&&r.tp===-1){q.pop();}if(q[0]&&q[0].tp===38){q.splice(0,1);}},m=function(S){return"";},g=function(S,r){var q=[];S.oi.tks.items=q;r.clearTokens(q);},K=function(v,u){var t=[];t.push("<mt>");if(v.fmt&&!u){var S={getArrItemName:function(z,w,x){return z.substr(0,z.length-1);},isSerializable:function(AE,AC,AB){if(mstrmojo.array.indexOf(["header_format","grid_format"],AE)>-1){var AF=AC[AB][AE];if(!AF){return{};}var z="<"+AE+">",AD;for(AD in AF){z+="<prs n='"+AD+"'>";var x=AF[AD],w;for(w in x){var AA=x[w];z+="<pr n='"+w+"' v='"+(AA==="pru"?"":AA)+"'";z+=AA==="pru"?' pru="1"':"";z+="/>";}z+="</prs>";}z+="</"+AE+">";return{child:z};}return true;},skipNull:true};t.push(E.json2xml("fmt",v.fmt,S));}if(v.prss&&!u){var r={getArrItemName:function(z,w,x){return z.substr(0,z.length-1);},isSerializable:function(AE,AB,z){if(mstrmojo.array.indexOf(["AnalyticalEngineProperties","DatamartProperties","VLDBSelect","VLDBFunction","VLDBReport"],AE)>-1){var AA=AB[z][AE];if(!AA){return{};}var x=[],AC=[],AD;x.push("<prs n='"+AE+"' ");for(AD in AA){var w=AA[AD];if(w!=null){if(typeof w==="object"){AC.push(E.json2xml("pr",w,{skipNull:true,convertBoolean:true,isSerializable:function(AH,AG,AF){return true;}}));}else{x.push(AD+"='"+w+"' ");}}}x.push(">");x.push(AC.join(""));x.push("</prs>");return{child:x.join("")};}return true;},skipNull:true};t.push(E.json2xml("prss",v.prss,r));}if(v.mps){t.push(E.json2xml("mps",v.mps,{skipNull:true,convertBoolean:true,isSerializable:function(z,x,w){return true;}}));}if(v.datp&&!u){t.push(E.json2xml("datp",v.datp,{skipNull:true,convertBoolean:true,isSerializable:function(z,x,w){return true;}}));}if(v.sbs&&!u){var q={getArrItemName:function(z,w,x){return(z==="avs")?"sb":z.substr(0,z.length-1);},isSerializable:function(z,x,w){return true;},skipNull:true};t.push(E.json2xml("sbs",v.sbs,q));}t.push("</mt>");return t.join("");},G=function(q,S){q.set("enabled",!S);var r="mstrmojo-InlineWaitIcon";if(q.iconClass){q.set("iconClass",q.iconClass.replace(new RegExp(r),"")+" "+(S?r:""));}else{mstrmojo.css.toggleClass(q.domNode,r,S);}},H=function(q,S){var r={taskId:"saveMetricDefinition",tokenStreamXML:N(q),localSymbolFolderXML:m(q),metricXML:K(q),metricId:q.did||"",outputFlags:327695,description:q.desc||"",name:q.n||"",saveAs:S};if(E.isEmpty(q.metricId)){r.isNew=true;}return r;},M=function(r){var q=function(t){var v=this.parent;var u=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##","Object").replace("'###'","");if(v){v.ob.refreshContent();v.onObjectSaved({name:v.name,did:t.did,desc:v.desc});u=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",v.typeDesc||"Object").replace("###",v.name);}mstrmojo.alert(u,r.onSaved,mstrmojo.desc(7984,"Object Saved"));if(v){v.close();}r.dirty=false;},S={success:q,failure:mstrmojo.SaveAsEditor.SAVEAS_CALLBACK.failure};return S;},L=function(x,u){var r=this;G(r,true);var z=mstrmojo.ME._MetricEditorHelper.oi=x.oi,t=N(z),v=m(z),w=K(z,true),AA=function(AB){if(AB&&AB.tks){var AC=AB.tks;k(AC);z.tks=AC;x.checkEditorFallback(x.ide.candidates.items,z);AC.vs=U(AC.rjec);x.set("vStatus",AC.vs);x.set("iStatus",AC.rjed||"");if(x.handleValidation){x.handleValidation(AC);}if(u&&(AC.vs===l.VALID)){switch(u){case"save":case"saveAs":if(x.isDME){x.handleDerivedMetricAction(u,z);}else{x.handleMetricAction(u,z);}break;case"switch":if(x.cbSwtichEditor){x.cbSwtichEditor(x);}break;}}else{if(u&&AC.vs===l.ERROR){mstrmojo.alert(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),null,mstrmojo.desc(9571,"Syntax Error!"));}}}},q=function(AB){mstrmojo.alert(AB.message||AB.getResponseHeader("X-MSTR-TaskFailureMsg"));},S=function(AB){G(r,false);};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:t,localSymbolFolderXML:v,metricXML:w,metricId:z.did,isNew:E.isEmpty(z.did),msgID:x.ide.isDME?mstrApp.getMsgID():null},{success:AA,failure:q,complete:S});},D=function(q,t){var u=t,S=u.oi.fmt,r=P.MetricFormatTarget;G(q,true);window.setTimeout(function(){if(!S){S=u.oi.fmt={};var v;for(v=0;v<r.length;v++){S[r[v].p]={};}}var w=J.position(q.domNode,true);u.openPopup("formatPopupRef",{zIndex:u.zIndex+10,model:S,left:Math.max(0,(w.x-(u.formatPopupRef.width||565)))+"px",top:w.y+"px"});G(q,false);},50);},e=function(r,t){var u=t,S=u.oi,q=function(){var v=J.position(r.domNode,true);u.openPopup(mstrmojo.all.mstrMEOptionsDialog||"optionPopupRef",{zIndex:u.zIndex+10,model:S,funcs:u.funcs,left:Math.max(0,(v.x-(u.optionPopupRef.width||565)))+"px",top:v.y+"px"});};if(!u.isDME&&!u.funcs){G(r,true);mstrmojo.ME.MetricDataService.getSubtotalFunctions(null,{success:function(v){if(v.items){u.funcs=v.items;q();G(r,false);}},failure:function(v){mstrmojo.alert(v.message||v.getResponseHeader("X-MSTR-TaskFailureMsg"));G(r,false);}});}else{q();}};mstrmojo.ME._MetricEditorHelper=mstrmojo.provide("mstrmojo.ME._MetricEditorHelper",{noCache:true,useKeyDelay:true,tbBrowsable:true,functionNameRef:{scriptClass:"mstrmojo.Label",alias:"fnLabel",cssClass:"mstrmojo-ME-fct-name",bindings:{visible:function(){return !this.parent.insertMode;},text:function(){return mstrmojo.desc(5424,"Function:")+" "+this.parent.fctName;}}},nameEditBoxRef:{scriptClass:"mstrmojo.Box",alias:"nameEditBox",cssClass:"mstrmojo-ME-nameEditBox",cssDisplay:"inline-block",visible:false,bindings:{visible:function(){return !this.parent.insertMode&&this.parent.visible;}},onvisibleChange:function(S){if(S.value==false){return ;}var q=this;if(!q.tmr){q.tmr=window.setInterval(function(){if(q.domNode){window.clearInterval(q.tmr);delete q.tmr;q.nameInput.inputNode.select();}},50);}},children:[{alias:"nameInput",scriptClass:"mstrmojo.TextBoxWithLabel",inputNodeCssClass:"mstrmojo-ME-nameInput",value:mstrmojo.desc(2213,"New metric"),size:20,useRichTooltip:true,showErrTooltip:function p(){var q=J.position(this.domNode),S=E.isEmpty(this.value)?mstrmojo.desc(9122,"Name cannot be empty"):mstrmojo.desc(11569,"Input contains invalid character");this.richTooltip={contentNodeCssClass:"me-tooltip-content left me-err",content:'<div class="content"><span>'+S+"</span></div>",top:q.y-5,left:q.x+q.w+10};this.hasOpenTooltip=false;this.showTooltip();},bindings:{value:function(){var S=this.parent.visible;return this.parent.parent.oi.alias||this.parent.parent.oi.n;},label:function(){var q=this.parent.parent.ide||{},S=q.nameLabel||mstrmojo.desc(11566,"Metric Name:");return this.parent.parent.oi.alias?mstrmojo.desc(13249,"Display Name:"):S;}},onvalueChange:function(r){var S=this.parent.parent.ide.action.alias,w=function(x){return !E.isEmpty(x)&&(S?true:!/[\[\]\"\\]/g.test(x));},v=w(this.value);if(v){this.hideTooltip();}else{this.showErrTooltip();}mstrmojo.css.toggleClass(this.parent.domNode,"err",!v);var t=this.parent.parent;t.set("cValid",v);var u=t.oi;if(u){var q={n:u.n,alias:u.alias};u.n=this.value;u.alias=this.value;if(u.n!==q.n&&u.alias!==q.alias){t.dirty=true;}}}}]},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:"Metric",browsableTypes:"4,8",onObjectSaved:function(r){var q=this.opener,S=q&&q.oi;if(q&&S){S.did=r.did;S.n=r.name;S.desc=r.desc;q.set("title",mstrmojo.desc(2154,"Metric:")+" "+r.name);}}},optionPopupRef:{id:"mstrMEOptionsDialog",scriptClass:"mstrmojo.ME.OptionDialog",title:mstrmojo.desc(9572,"Advanced Metric Options"),help:"Advanced_Metric_Options_dialog_box.htm",height:340},formatPopupRef:{scriptClass:"mstrmojo.ME.MetricFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116,"Format"),left:"100px",top:"100px",useAnimate:false,height:360,width:565,help:"Format_Metric_dialog_box.htm",locksHover:true},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},switchRef:{scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"switchToMetricEdtior",cssClass:"mstrmojo-ME-switch mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(9563,"Switch to Formula Editor"),closeAfterSwitch:true,bindings:{visible:function(){return !this.parent.insertMode;}},getEditor:function(){return this.parent;},getFormulaEditorId:function(){var S=this.getEditor();return(S.ide&&S.ide.formulaEditorId)||"mstrME";},onclick:function(){var r=this.getEditor(),q=this.getFormulaEditorId();r.oi.tks.items=r.getMetricDefAsTokens();var S={vStatus:mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN,oi:r.oi,did:r.oi.did};if(r.dirty){S.dirty=r.dirty;}r.switch2Editor(q,S);if(r.ide){r.ide.set("showLeftPanel",true);r.set("simple",false);}}},formatAndOptionsBarRef:{scriptClass:"mstrmojo.HBox",alias:"formatbar",cssClass:"mstrmojo-ME-formatbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link format",alias:"formatButton",text:mstrmojo.desc(1918,"Format"),bindings:{visible:function(){return this.parent.parent.tbFormatable&&!this.parent.parent.insertMode;}},onclick:function(){D(this,this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link property",alias:"optButton",text:mstrmojo.desc(13035,"Metric Options"),bindings:{visible:function(){var S=this.parent.parent;return !S.insertMode&&!S.ide.disableAFB;}},onclick:function(){e(this,this.parent.parent);}}]},saveLabel:mstrmojo.desc(5891,"Save"),saveAsLabel:mstrmojo.desc(628,"Save As"),closeLabel:mstrmojo.desc(221,"Cancel"),saveAsEnabled:true,cValid:true,buttonBarRef:{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:"",bindings:{enabled:function(){return this.parent.parent.cValid;},text:function(){return this.parent.parent.insertMode?mstrmojo.desc(531,"Add"):this.parent.parent.saveLabel;}},onclick:function(){var q=this.parent.parent;if(!q.insertMode&&q.isDirty&&!q.isDirty()){q.close();q.onCancel();return ;}if(!q.cValid){return ;}if(q.insertMode){q.insertOnFinish(q.getMetricDefAsTokens());q.close();}else{if(q.getMetricDefAsTokens){q.oi.tks.items=q.getMetricDefAsTokens();}var S=this;if(q.validateAndSave){G(S,true);q.validateAndSave(q.oi,function(){G(S,false);});}else{if(q.ide&&q.ide.validateAndSave){G(S,true);q.ide.validateAndSave(q.oi,function(){G(S,false);});}else{q.tbValidate=this;L.call(this,q,"save");}}}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",alias:"btnSaveAs",text:mstrmojo.desc(628,"Save As"),bindings:{visible:function(){return !this.parent.parent.insertMode&&!this.parent.parent.isDME;},text:function(){return this.parent.parent.saveAsLabel;}},onclick:function(){var S=this.parent.parent;if(S.getMetricDefAsTokens){S.oi.tks.items=S.getMetricDefAsTokens();}S.tbValidate=this;L.call(this,this.parent.parent,"saveAs");}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",bindings:{text:function(){return this.parent.parent.closeLabel;}},onclick:function(){var S=this.parent.parent;if(S.onPreClose()){S.close();if(!S.insertMode){S.onCancel();}}}}]},validateSyntax:function B(S){L.call(S,this);},validateSyntaxAndSwitch:function Y(S){L.call(S,this,"switch");},preprocessTokenStram:function Q(S){k(S);},isDirty:function f(){if(this.insertMode){return false;}return this.dirty||this.oi.dirty||(this.oi.fmt||{}).dirty||(this.oi.mps||{}).dirty;},onmetricModify:function d(){this.dirty=true;},save:function O(){this.buttonBar.btnSaveAs.onclick();},prompt2saveRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:mstrmojo.desc(5728,"Confirm save"),children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",allowHTML:true,bindings:{text:function(){return mstrmojo.desc(9573,"Do you want to save changes made to #?").replace("#","<b>"+this.parent.opener.oi.n+"</b>");}}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"width:10px;"},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(219,"Yes"),onclick:function(){var S=this.parent.parent;S.opener.save();S.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(218,"No"),onclick:function(){var S=this.parent.parent;S.opener.close();if(S.opener.onCancel){S.opener.onCancel();}S.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var S=this.parent.parent;S.close();}}]}]},prompt2save:function(){if(this.getMetricDefAsTokens){this.oi.tks.items=this.getMetricDefAsTokens();}this.openPopup("prompt2saveRef",{zIndex:this.zIndex+1});},handleMetricAction:function b(r,q){var S=this;var t=H(q,false);if((r==="save")&&q.did){mstrmojo.xhr.request("POST",mstrConfig.taskURL,M(S),t);}else{if(((r==="save")&&E.isEmpty(q.did))||r==="saveAs"){t.saveAs=true;S.openPopup("saveasRef",{zIndex:S.zIndex+10,folderLinksContextId:17,name:q.n||q.name||(S.name&&S.name.value)||mstrmojo.desc(2213,"New Metric"),saveParams:t,saveAsCallback:function(){var u=M(S);if(u.success){var v=u.success;u.success=function(w){v.call(this,w);if(S.ide.noRefresh!==true){var x=mstrApp;mstrmojo.form.send({evt:5005,src:x.name+"."+x.pageName+".5005"});}};}return u;}});}}},handleDerivedMetricAction:function c(u,t){t=t||this.oi;if(u==="save"){var S={tokenStreamXML:N(t),alias:t.n};var q=t.mps||{};if(q.dirty){if(q.fbf===0){q.afb=q.sfb=-1;}S.afb=q.afb;S.sfb=q.sfb;}var v=mstrmojo.all.mstrMetricIDE,r=v.disableAFB;if(r){S.afb=0;S.sfb=1;}v.onApplyMetricCallback(S);v.close();}},onPreClose:function(){var S=this;if(S.isDirty&&S.isDirty()&&!this.isDME){S.prompt2save();return false;}return true;},onClose:function W(){this.dirty=false;if(this.onPostClose){this.onPostClose();}},init:function n(r){if(this._super){this._super(r);}var t=mstrApp,S=t&&t.useQuickSearch&&t.useQuickSearch(),q=S?((t&&t.searchAutoCompleteDelay&&t.searchAutoCompleteDelay())||0):0;this.suggestDelay=q||200;this.noCache=this.noCache&&S&&!this.isDME;this.ob.children[0].quickSearch=S;mstrmojo.ME.MetricDataService.suggestDelay=this.suggestDelay;mstrmojo.ME.MetricDataService.noCache=this.noCache;},_setupCandidatesCache:function h(S){if(this.candidates&&S){S.candidates=null;S.set("candidates",this.candidates);}},item2textCss:function I(S){return"mstrmojo-ME-icon t"+S.t+(S.st?" st"+S.st:(S.um||S.da?"d":""));},getSpecialFunctionEditorId:function a(S,t){var r=S&&S.did,q;if(r){if(mstrmojo.ME.MetricDataService.isBasicAggMap(r)){q="mstrSME";}else{if(mstrmojo.ME.MetricDataService.isRank(r)){q="mstrRFE";}else{if(A.isOLAPAgg(r)){q="mstrOFE";}else{q="mstrFE";}}}if(q){q+=t?"_1":"";}}return q;},isDimty:function(q,S){return(/^@[a-z]{1,}(\s*[+-]\s*\d{1,})?$/i).test(F.trim(q));},validateByDataType:function Z(q,S){var r=false;switch(q){case o.DataTypeInteger:r=/^(-)?\d+$/.test(S);break;case o.DataTypeNumeric:case o.DataTypeReal:case o.DataTypeDouble:r=mstrmojo.num.isNumeric(S);break;case o.DataTypeChar:case o.DataTypeVarChar:r=true;break;case o.DataTypeDate:case o.DataTypeTimeStamp:r=true;break;default:r=true;}return r;},getRootFunction:function X(r){var q,S=r&&r.tks&&r.tks.met;if(S!==C.ADVANCED){var t=r.tks.items[0];q=t&&t.oi;}return q;},checkEditorFallback:function V(S,t){var q=this.getRootFunction(t),r=mstrmojo.array.find(S,"did",q&&q.did)===-1;if(r&&t&&t.tks&&t.tks.items&&t.tks.items.length>0){t.tks.met=C.ADVANCED;}return r;}});mstrmojo.ME._MetricEditorHelper.getTokenStreamXML=N;}());(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{suggestionPopupCssClss:"mstrmojo-ACLInputBox-suggest",getACLUserDataService:function C(){return mstrmojo.ACL.UserDataService;},item2textCss:function A(D){return(this._super&&this._super(D))||"mstrmojo-ACLInputBox-user "+{8704:"u",8705:"ug"}[D.st]||"";},getCandidatesThroughTaskCall:function B(E,D){this.getACLUserDataService().searchUserCandidates(E.pattern,!E.isVerify,E.blockCount,D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.TextBoxSelector","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.mstr.EnumDataType","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper","mstrmojo.MetricSelectorUtility","mstrmojo.mstr.EnumDSSXMLBaseFormType");mstrmojo.requiresDescs(4729,4730,4732,4733,4734,4735,5225,5443,6738,8967,12297);var L=mstrmojo.array,P=mstrmojo.hash,n=mstrmojo.dom,AO=mstrmojo.expr,x=AO.BFTP,AP=0,AK=1,AS=2,AD=3,l=4,p=5,AF=6,e=7,AA=8,AH=9,S=10,A=11,Y=mstrmojo.mstr.EnumDataType,Aa=mstrmojo.elementHelper,b=Aa.ELEM_ALL_ID,Ab=mstrmojo.func.wrapMethods,D=mstrmojo.mstr.EnumDSSXMLBaseFormType.DssXmlBaseFormHTMLTag,v=1,N=4,AC=12,AZ=47,AI=3076,d=3077,C=257;mstrmojo.DocSelectorEvtType=null;var T={};T[e]="MetricSlider";T[AA]="MetricQualification";T[AH]="SearchBoxSelector";T[S]="TextBoxSelector";var Af=2;var r=function r(){var Ag={type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,isUConDS:!!this.defn.dsTks};if(this.style===AA||this.style===e){mstrmojo.hash.copy(Ag,{srcid:this.srcid,srct:this.type,f:this.f,ft:this.ft,qt:this.qt,unset:!!this.unset,cs:this.cs});}return Ag;},AG=function AG(){var Ag=this.node.defn,Aj=this.node.data;var Ak={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:Ag.srcid||"",dataSourcesXML:Ag.dsrc||"",browseFlags:1};var Ai=this,Ah={success:function(Al){Ai.bGetElems=true;Ai.set("wait",false);if(Al&&Al.es){Aj.elms=(Ag.srcid)?Aa.buildElemsTerseID(Al.es,Ag.srcid,true):Al.es;var Am=Ai.parent,An=Am&&Am.parent;if(Ag.sec&&Aj.ces&&Aj.elms&&Aj.elms.length>0&&Am){Am.set("count",Aa.buildElemsCountStr(Aj.ces,Aj.elms));}if(Ai.hasRendered){Ai.refresh();if(Ai.isInFilterPanel()){if(Am&&Am.defn.ttl){Am.updateContentHeight();}if(An&&An.refreshFP){An.refreshFP();}}}}},failure:function(Al){mstrmojo.alert(Al.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.set("wait",true);mstrmojo.xhr.request("POST",mstrConfig.taskURL,Ah,Ak,false,null,true);},U={getWidgetClass:function B(Aj,Ai,Ah){var Ag=T[Ai];if(Ag&&Ag.constructor===Array){Ag=Ag[Ah?0:1];}return Ag;},getWidgetConfig:function K(Am,Ai,Ak,Ag){var An=Ai===2?false:Ak.horiz,Al=Am.getFormats(),Ao=Al&&Al.height,Aj={scriptClass:this.getWidgetClass(Am,Ai,An),docSelector:Am,enabled:this.enabled,multiSelect:Ak.multi,isHoriz:An,include:Ak.include,itemWidthMode:Ak.iwm,allIdx:L.find(Ag,"v",mstrmojo.elementHelper.ELEM_ALL_ID),noneIdx:Ak.include?-1:L.find(Ag,"v",mstrmojo.elementHelper.ELEM_ALL_ID),renderAllItems:!Ao,onchange:function Ah(){if(!Am._inSyncPhase){Am.selectorControlChange(this);}}};if(Aj.noneIdx!==-1){Aj.allIdx=-1;}if(Al&&Ai===mstrmojo.DocSelector.STYLES.PULLDOWN){if(Al.color){Aj.itemCssText="color: "+Al.color+";";}if(Al.font){Aj.itemCssText=(Aj.itemCssText||" ")+"font:"+Al.font;}if(mstrApp.isExpress){Aj.cssTextClass="express";}}return Aj;},newSelectorWidget:function AV(Ap){var Am=Ap.style,Ai=Ap.node,Ao=Ai.defn,Al=Ai.data,Ag=Al.elms||[],Ah,An=this.getWidgetConfig(Ap,Am,Ao,Ag),Ak=An.scriptClass;if(!Ak){Ah=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{delete An.scriptClass;var Aj=P.walk(Ak,mstrmojo);Ah=new Aj(An);}return Ah;},getCekEvtListener:function AT(Ah,Ag){return function(Ai){var Ak=[],Aj=this.node.data.elms;L.forEach(Ai.value,function(Am){var Al=L.find(Aj,"v",Am);if(Al>-1){Ak.push(Al);}});this.handleActionInSyncPhase(function(){if(Ag&&Ag.select){Ag.select(Ak);}});};},newAndInitWidget:function m(Ak){var Am,Ai=Ak._cekEvtListener,Ah=Ak.node,Ag=Ah.defn,Aj=Ak.id,Al;if(Ai){Ag.detachEventListener(Ai);delete Ak._cekEvtListener;}Am=this.newSelectorWidget(Ak);if(Am){Al=this.getCekEvtListener(Ak,Am);}Aj=Al.cekContextId||Aj;Al=Al.cekEvtListener||Al;if(Al){Ak._cekEvtListener=Ag.attachEventListener("cekChange",Aj,Al);}Ak.addChildren(Am);return Am;},updateWidget:function AQ(Ah){var Ag=Ah.children,Ai=Ag&&Ag[0];if(!Ai){Ai=this.newAndInitWidget(Ah);}else{Ai.set("enabled",this.enabled);}return Ai;}};function AM(Ag){return Ag.some(function(Ah){return this.style===Ah;},this);}function R(){var Ag=this;return Ag.model.getDatasetUnits(["mx"],function(Ah){return Ah.did===Ag.defn.srcid;})[0]||{};}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,U],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSelector {@cssClass} {@extCls}" nm="{@n}" title="{@tooltip}" style="{@domNodeCssText}"><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100;position:absolute;top:0;left:0;width:100%;height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenableChange:mstrmojo.Widget.enabledMarkupMethod,onincludeChange:function(){mstrmojo.css.toggleClass(this.domNode,"strikeout",!this.include);},onwaitChange:function(){mstrmojo.css.toggleClass(this.domNode,"wait",!!this.wait);this.wIconNode.style.display=((this.wait)?"block":"none");}},_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",min:-1,max:-1,bGetElems:false,n:"",_inSyncPhase:false,init:function u(Ag){this._super(Ag);if(mstrmojo.dom.isIE){this.formatHandlers=this._ieformatHandlers;}this.n=Ag.node.defn.n;},_fetchOnInit4UCOnDS:function AE(Ag){if(!this.bGetElems&&parseInt(this.node.defn.subTp,10)===Af){AG.apply(this);Ag=this.node.data.elms;}return Ag;},initControlInfo:function F(){var Ai=this.node,Aj=Ai.data,Am=Ai.defn,Ag=Aj.elms,Ak=Aj.ces;var An=["include","ckey","ck","tks","style","multi","showall"];Ag=this._fetchOnInit4UCOnDS(Ag,Aj);this.type=Am.ct;var Ao=Am.fmts;if(Ao){var Ap=Ao.width;if(!Ap||parseInt(Ap,10)<=0){Ao.width="95px";}}P.copyProps(An,Am,this);var Ah=this.selIdx={},Al=Am.multi;if((this.include||Am.style===AK)&&Al&&L.find(Ak,"v",mstrmojo.elementHelper.ELEM_ALL_ID)>-1){Ak=Ag;}if(Ak){var Aq={};L.forEach(Ak,function(Ar){Aq[Ar.v]=true;});L.forEach(Ag,function(As,Ar){if(Aq[As.v]){Ah[Ar]=true;}});}if(Am.min>=0){this.min=Am.min;}if(Am.max>=0){this.max=Am.max;}},resetFormatHandlers:function I(){this.formatHandlers={contentNode:["RW"]};},_getSelectionCount:function Z(Ag){return P.keyarray(Ag.selectedIndices).length;},canApply:function G(Ak){var Aj=this.defn,Al=Aj.multi,Ai=this.min,Ag=Al?this.max:1,Ah=this._getSelectionCount(Ak||this.content);return(Ai>=0&&Ag>=0&&Ai>Ag)||((Ai<0||Ai<=Ah)&&(Ag<0||Ag>=Ah));},_buildEvent:mstrmojo.emptyFn,selectorControlChange:function M(Aj){var Ai=r.call(this),Ah=this.isInFilterPanel()&&this.getFilterPanel(),Ag=(Ah&&Ah.defn.cas);this._buildEvent(Ai,Aj);if(!this.canApply(Aj)){var Ak=this.getPanelContainer();if(this.isInSearchBoxPanel(Ak)){Ak.set("canApplySbp",false);}if(Ag){this.set("err",true);mstrmojo.alert(mstrmojo.desc(12297,"One or more selectors are incorrectly set. Please review the selector(s) and try again."));}if(Ah){Ah.set("applyEnabled",false);}return ;}if(Ag){this.set("err",false);}if(mstrApp.isExpress&&this.node.defn.style===AP){this.handleExpressPulldown();}if(Ai.requireToggle){this.deferredEvt=Ai;this.set("include",false);this.deferredEvt=undefined;}else{this.slice(Ai);}},showInfoWin:function X(Al){var Ao=this.node&&this.node.defn,Ai=Ao&&Ao.ifw,Ah=this.model,Aj=[].concat(Ah.getTargetInfoWin(Ai)).concat(Ah.getTargetInfoWin(this.tks));if(Aj&&Aj.length){var Aq=this.defn.horiz,Ag=Al||this.contentNode,An=n.position(Ag),Ap=n.position(this.contentNode),Am=(Aq||parseInt(this.defn.style,10)===AK)?null:{x:Ap.x,y:An.y,w:Ap.w,h:An.h},Ak;for(Ak=0;Ak<Aj.length;Ak++){Ah.showInfoWin(Aj[Ak],Ag,Aq?"v":"h",false,P.copy(Am));}}},unrender:function h(Ag){delete this.formatHandlers;this._super(Ag);},postBuildRendering:function Ae(){var Ai=this.node.defn.style,Ak=this.filterNode.style,Ag=this.contentNode,Ah=this.node.defn;if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(Ah.ds,10)===0);}this.handleActionInSyncPhase(this._super,this);if(mstrApp.isExpress&&Ai===AP){this.handleExpressPulldown();}if(this.isInFilterPanel()&&this.parent.adjustFP){this.parent.adjustFP();}if(this.formatHandlers.filterNode){var Aj=this.getFormats();if(!Aj.width){Ak.width=Ag.clientWidth+"px";}if(!Aj.height){Ak.height=Ag.clientHeight+"px";}}else{Ak.display="none";}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");if(n.isAndroid&&Ai===AK){Ag.style.overflow="visible";}return true;},updateHeight:function AU(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var Ag=this.parent;if(Ag&&(Ag.defn.ttl!==undefined)&&Ag.updateContentHeight){Ag.updateContentHeight();}},handleExpressPulldown:function E(){var Ai=this.model.getZoomFactor();if(Ai!==1){var Aj=this.contentNode.firstChild.firstChild;var Ak=parseInt(window.getComputedStyle(Aj).height);var Ag=Ak*Ai+"px";Aj.style.height=Ag;Aj.style.lineHeight=Ag;}var Ah=document.createElement("DIV");Ah.setAttribute("class","mstrmojo-ui-Pulldown-arrow");Ah.setAttribute("src","#");this.contentNode.firstChild.appendChild(Ah);},handleActionInSyncPhase:function AR(Ai,Ah){var Ag=this._inSyncPhase;this._inSyncPhase=true;try{if(Ah){Ai.call(Ah);}else{Ai();}}catch(Aj){throw ("There was an error handling the selector action in sync phase.");}this._inSyncPhase=Ag;},onCGBMapChange:function AW(Ah){var Ag=Ah.cgbMap;if(!Ag){return ;}var Ai=this.tks;P.forEach(this.defn.cgb,function(Ak){var Aj=Ag[Ak];if(Aj&&Ai.indexOf(Aj)<0){Ai+="\u001E"+Aj;}});this.tks=Ai;},update:function V(Ak){this._super(Ak);this.node=Ak;var Ar=this.node.defn,Ai=Ar.style,Ag=this.node.data.elms,Au=this.parent,Aj=(Ai===AK),Av=(Ai===AH),At,An;if(Ar.srct===AC&&Ar.srcid&&this.model.getBrowseFormTypes&&this.model.getBrowseFormTypes(Ar.srcid).indexOf(D)>-1){At=window.document.createElement("span");L.forEach(Ag,function(Aw){At.innerHTML=Aw.n;An=At.firstChild;Aw.n=An&&(An.text||An.alt)||Aw.n||"";});An=null;At=null;}if(Aj&&Ar.multi){var Ah=L.find(Ag,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(Ah>-1){this.node.data.del={idx:Ah,elem:Ag[Ah]};L.removeIndices(Ag,Ah,1);}}if(Ar.sec){var Am=[].concat(Ak.data.ces||[]);if(Au&&(Au.count!==null&&Au.count!==undefined)){if(Aj){Au.set("count","");}else{if((Am&&Ag&&Ag.length)||Ar.sos){if(!Ar.include){var Aq=L.find(Am,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(Aq>=0){L.removeIndices(Am,Aq,1);}}var Ao={};L.forEach(Ag,function(Aw){Ao[Aw.v]=true;});Am=L.filter(Am,function(Aw){return Ao[Aw.v];});var Al=Am,As;if(!Av){if(!Ar.multi){Al=Ag;}As=Ag;}Au.set("count",Aa.buildElemsCountStr(Al,As));}}}}if(this.content){this.content.allIdx=L.find(this.node.data.elms,"v",b);}this.initControlInfo();var Ap=this.content=this.updateWidget(this);if(!Ap){this.set("visible",false);}this.clearCache();},refresh:function AJ(){var Ah=this.parent,Ag=this.node&&this.node.defn;if(Ah&&Ah.generateToolbar){Ah.set((this.isInFilterPanel()?"baseTitle":"title"),Ag.ttl);Ah.generateToolbar();}this._super();},onincludeChange:function a(As){var Aq=this.node.defn,Ai=As.value,Al=this.parent.parent.parent,Ap=Al.model.getDataService().newUpdate(Al);Aq.include=this.include=Ai;if(Al._bufferedSlices){Al.applyBufferedSlices(true,Ap);}if(this.style!==e&&this.style!==A){var Aj=r.call(this);Aj.ckey=this.ckey;Aj.changeInclude=true;if(Aq.srct===AC){var Ar=this,Am=this.model,An=this.node.k,Ak=Am.getDataService(),Ah=Am.getSliceCallback(Aj),Ao=[Ak.getSelectorShowAllAction({ck:Aq.ck,ckey:Aq.ckey,type:Aq.type,showAll:Ai}),Ak.getSelectorIncludeAction({ck:Aq.ck,ckey:Aq.ckey,type:Aq.type,include:Ai})],At=Ab(Ah,{success:function(Au){Ar.set("wait",false);Am.partialUpdate(Au.data,Am.getTargetDefn(An));if(!Ar.isInFilterPanel()){Ar.parent.selectVIUnit(Ar,true);}}});this.showall=this.defn.showall=As.value;var Ag=this.deferredEvt;if(!!Ag){Am.sliceDeferred(Ap,Ag);}Ao=!!Ag?Ao.concat(Ap.actions):(Ap.actions||[]).concat(Ao);this.set("wait",true);Am.controller.cmdMgr.execute({execute:function(){this.submit(Ao,At);},urInfo:{extraPuKeys:Aq.ck.split("\u001E").slice(1),treesToRender:3}});}else{this.slice(Aj);}}},getSelectorStyleList:function o(){var Ah=[],Ak=this.defn.srct,Ag=this.defn.srcst;if(Ak===v||Ak===AC||Ak===AZ){var Al=!this.isInFilterPanel();if(Ag===AI){return[];}Ah=[{n:mstrmojo.desc(4733,"Check Boxes"),v:l},{n:mstrmojo.desc(4730,"Slider"),v:AK}];if(Ak===AC){Ah.push({n:mstrmojo.desc(8967,"Search Box"),v:AH});}if(Al){Ah=Ah.concat([{n:mstrmojo.desc(4735,"Link Bar"),v:AF},{n:mstrmojo.desc(4734,"Button Bar"),v:p}]);}Ah=Ah.concat([{n:mstrmojo.desc(4732,"Radio Buttons"),v:AD},{n:mstrmojo.desc(4729,"Drop-down"),v:AP}]);if(Al){Ah=Ah.concat([{n:mstrmojo.desc(6738,"List Box"),v:AS}]);}var Aj=mstrmojo.vi.ui.DatasetUnitMenuUtils.getUnitFromDataset(this.model.datasets,this.defn.srcid,12),Ai=Aj&&L.filterOne(Aj.fs,function(Am){return Am.idf;});if(Ai&&(Ai.bftp===x.DATE||Ai.bftp===x.DATETIME)&&(Aj&&!Aj.de)){Ah.push({n:mstrmojo.desc(5443,"Calendar"),v:A});}}else{if(Ak===N){Ah=[{n:mstrmojo.desc(4730,"Slider"),v:e},{n:mstrmojo.desc(5225,"Qualification"),v:AA}];}}return Ah;},supportsInclude:function t(){var Ag=this.defn;return((Ag.srct===AC&&!this.hasDE)||(Ag.srct===N&&Ag.style===e))&&!this.isSolrSelector();},isSolrSelector:function AX(){return this.model.isFromSolrCube(this.defn.srcid);},isMetricSelector:function AX(){return this.defn.srct===N;},isRankMetricSelector:function w(){var Ag=R.call(this).f;return Ag&&typeof Ag==="string"&&Ag.search(/rank/i)===0;},isNumericMetricSelector:function AN(){var Ag=R.call(this).dt;return !Ag||Ag===Y.DataTypeDouble||Ag===Y.DataTypeInteger||Ag===Y.DataTypeCellFormatData;},isAttributeSelector:function z(){return this.defn.srct===AC;},isDerivedAttributeSelector:function AL(){return this.defn.srct===AC&&this.defn.srcst===d;},isAttrQualSelector:function f(){return this.defn.srct===AC&&this.defn.style===A;},isRecursiveAttributeSelector:function c(){return this.defn&&this.defn.srct===12&&this.defn.srcst===3076;},allowsOrientationChange:function AB(){return !this.isAttrQualSelector()&&!AM.call(this,[AH,AS,AP,AK,e,AA]);},isSearchBox:function H(){return AM.call(this,[AH]);},isAttrElemListSelector:function AY(){return this.defn.srct===AC&&this.defn.style!==A;},slice:function Q(Ai){var Ag=this.model;if(Ag.closeSelWarnFlag){Ag.closeSelWarnFlag(this.k);}if(this.isInFilterPanel()){var Ah=this.getFilterPanel();if(Ah&&!Ah.defn.cas){Ah.bufferSlice(Ai);return ;}}var Aj=this.getPanelContainer();if(this.isInSearchBoxPanel(Aj)){Aj.parent.bufferSlice(Ai);Aj.set("canApplySbp",Aj.canApplySearchBoxPanel());return ;}Ag.slice(Ai);},isInFilterPanel:function g(){var Ag=this.parent;return(Ag&&Ag.isInFilterPanel&&Ag.isInFilterPanel())||false;},isHorizFP:function Ac(){var Ag=this.parent;return(Ag&&Ag.isHorizFP&&Ag.isHorizFP())||false;},getFilterPanel:function Ad(){var Ag=this.parent;return(Ag&&Ag.getFilterPanel&&Ag.getFilterPanel())||null;},isInSearchBoxPanel:function(Ag){var Ah=Ag||this.getPanelContainer();return Ah&&(Ah.isSbp||(Ah._isSearchBoxPanel&&Ah._isSearchBoxPanel()));},getPanelContainer:function(){var Ag=mstrmojo.EnumRWUnitType,Ah;for(Ah=this.parent;Ah&&Ah.defn;Ah=Ah.parent){if(parseInt(Ah.defn.t,10)===Ag.PANEL){return Ah;}}return null;},clearSelector:function O(Ao){var An=r.call(this),Am=[b],Ag=this.node.data.elms||[],Al="\u001E",Ah=this.style,Ai=this.defn.include,Aj=this.isSelectAll&&this.isSelectAll();if(Ah===AH){An.eid=Am.join(Al);this.defn.set("cek",[]);}else{if(Ah===e||Ah===AA){An.cs="";An.ckey=this.ckey;An.unset=true;this.node.defn.set("cek",{cs:null,qua:this.qua,include:Ai,f:null,ft:null});}else{if(Ah===A){An.unset=true;An.ckey=this.ckey;var Ak=[{v:""},{v:""}];this.node.defn.set("cek",{cs:Ak});}else{An.eid=Am.join(Al);if((Ai||Ah===AK)&&this.multi){L.forEach(Ag,function(Aq){var Ap=Aq.v;if(Am[0]!==Ap){Am.push(Ap);}});}this.node.defn.set("cek",(Ai||Ah===AK)?Am:[]);}}}if(this.defn.sec&&Ah!==AK){this.parent.set("count",Ah===AH?"":Aa.buildElemsCountStr(Am,Ag));}An[Ao?"forceApply":"forceBuffer"]=true;if(Aj){An.ignoreTargetData=true;}this.slice(An);},allowsTogglingMultiSelect:function k(){return AM.call(this,[AP,p,AF,AH,AK,AS]);},allowsSameSizeItems:function J(){return AM.call(this,[l,AD,p,AF]);},supportsSetTarget:function q(){var Ag=this.defn;return this.isAttrElemListSelector()||(Ag.srct===AZ||Ag.srcst===C);},supportSelectionColor:function W(){return AM.call(this,[AS,AF]);}});mstrmojo.DocSelector.UC_ON_DS=Af;mstrmojo.DocSelector.STYLES={PULLDOWN:AP,SCROLLER:AK,LIST:AS,RADIO:AD,CHECKBOX:l,BUTTON:p,LINK:AF,METRIC_SLIDER:e,METRIC_QUAL:AA,SEARCH_BOX:AH,TEXT_BOX:S,ATTR_QUAL:A};}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.fe.FilterExprTree","mstrmojo.fe.AndOrNode","mstrmojo.fe.RelationNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode");var K=mstrmojo.expr.ET;mstrmojo.fe.RelationFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RelationFilterExprTree",nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},getItemIdentityProp:function(L){if(L.ph){return"ph";}if((L.et===10||L.et===12)&&L.dmt===4){return K.RLS;}return L.et;},isEditable:function J(M){var L=false;switch(M&&M.et){case K.RLS:L=true;break;}return L||this._super(M);},getItemConfig:function(O,L,P){var M=this._super(O,L,P),N=(O.et===K.RLS||!!O.relation);if(N){M.itemFunction=P.itemFunction;}return M;},newCondition:function E(M){var L=this.getSelectedItemWidget();if(M&&M.ph&&!M.ph.idx&&microstrategy.bones.rwb_viewer){M.ph.idx=microstrategy.bones.rwb_viewer.nextPhIndex++;}if(L&&L.selected&&L.newCondition){return L.newCondition(M);}else{return this._super(M);}},createSet:function D(M,L){var N=L.rq,O=L.cq;if(N&&O){this.remove(O);if(L.isMetric){mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],N,O);N=O;}else{N.nds=[O];}this.add([N],M[0]);}},removeSet:function G(L){var M=L.data,N=[M];this.remove(M);if(M.nds&&M.nds.length>0){N=M.nds;}else{delete M.dmy;delete M.relation;delete M.applySubExpr;delete M.relation;delete M.useSchema;delete M.dmt;}this.add(N,0);},nameFactory:{counter:1,names:{},clear:function(){this.resetCounter();this.names={};},resetCounter:function C(){this.counter=1;},isNameExist:function I(L){return !!this.names[L];},setName:function H(L,M){this.names[L]=M;},changeName:function B(M,L,N){this.removeName(M);this.setName(L,N);},getNewName:function F(O,N,Q){var P=N||"",M=Q||"",L;while(this.isNameExist(P+this.counter+M)){this.counter++;}L=P+this.counter+++M;this.names[L]=O;return L;},removeName:function A(L){delete this.names[L];this.resetCounter();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.ui.Checkbox","mstrmojo.css","mstrmojo.threshold.ThresholdExprTree","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.models.FormatModel.getFormatUpdate","mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL");mstrmojo.requiresDescs(2869,3397,5893,7978,7979,13788,13789,13790,13894,14599,14600,14601,14611);var E=mstrmojo.hash,N=mstrmojo.array,O=mstrmojo.css,I=mstrmojo.models.FormatModel.decodeValue,M=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL,C=12;function G(R){this.threshold.scope=R;}function J(V,S,R){var T=this.previewNode;switch(V){case 10:var U=N.filterOne(M,function(W){return W.v===S;});if(U){T.innerHTML=U.n;}break;case 4:O.addClass(T,"hasImage");T.innerHTML='<img class="replaceImg" src="'+S+'" />';break;default:T.innerHTML=S||(R===C?mstrmojo.desc(14611,"Sample"):"1234.567");}}function P(S,R){R.fontFamily=S.ff;R.fontSize=parseInt(S.fsz,10)+"pt";R.fontWeight=S.fw?"bold":"normal";R.textDecoration=(S.fun?"underline":"")+" "+(S.fst?"line-through":"");R.fontStyle=S.fit?"italic":"";R.color=S.fc;R.backgroundColor=S.bc;R.textAlign=S.alh;R.verticalAlign=S.alv;R.wordWrap=S.atw;R.direction=S.atd;var T=S.bts;R.border=S.borderStyle||(T?I("bts",T):"1px dotted");R.borderColor=S.borderColor||S.btc||"#e1e1e1";}mstrmojo.threshold.ThresholdRow=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ThresholdRow",markupString:'<div id="{@id}" class="mstrmojo-thresholdRow cf {@cssClass}" style="{@cssText}" mstrAttach:click><div class="draggable-icon"></div><div class="container"></div><div class="previewWrap"><div class="preview"></div></div><div class="menu"></div><div class="delete"></div></div>',markupSlots:{containerNode:function F(){return this.domNode.children[1];},draggableNode:function H(){return this.domNode.firstChild;},previewNode:function F(){return this.domNode.children[2].firstChild;},menuNode:function F(){return this.domNode.children[3];},deleteNode:function L(){return this.domNode.children[4];}},threshold:undefined,idx:undefined,editor:undefined,model:undefined,lblIndex:undefined,chkBox:undefined,exprTree:undefined,postBuildRendering:function A(){this.destroyChildren(false);var R=this.threshold,S=this.model,T=this.previewNode.style,V=E.copy(R.fmt,E.clone(S.getGridValueFormat())),U=R.expr;J.call(this,R.rtp,R.rtxt,S.objectType);if(V){P(V,T);}this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.Label",alias:"lblIndex",text:this.idx+1},{scriptClass:"mstrmojo.threshold.ThresholdExprTree",alias:"exprTree",editor:this.editor,model:this.model,items:[U]}]);S.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");return this._super();},onselectedThresholdsChange:function D(){},onclick:function Q(U){var S=this.editor,W=U.getTarget(),T=this,R=this.model,V=S.objectType===C;if(W===this.deleteNode){this.removeFromModel();}else{if(W===this.menuNode){var X=new mstrmojo.ui.menus.MenuConfig();X.hostId=this.id;X.hostElement=this.menuNode;X.isHostedWithin=false;X.addSubMenuItem(mstrmojo.desc(13788,"Apply to"),"",S.id,function(){var Y=new mstrmojo.ui.menus.MenuConfig();Y.addRadioMenuGroup(T.threshold.scope||1,G,[{value:1,text:V?mstrmojo.desc(14599,"Element Rows Only"):mstrmojo.desc(13789,"Metric Only")},{value:2,text:V?mstrmojo.desc(14600,"Subtotal Rows Only"):mstrmojo.desc(13790,"Subtotals Only")},{value:3,text:V?mstrmojo.desc(14601,"Elements and Subtotals"):mstrmojo.desc(13894,"Metric and Subtotals")}],"",T,true);return Y;});X.addMenuItem(mstrmojo.desc(2869,"Formatting"),"",function(){S.openPropertyPanel(T);});X.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"",function(){R.duplicateThreshold(T.idx);});if(this.idx!==0){X.addMenuItem(mstrmojo.desc(7978,"Move Up"),"",function(){R.moveThreshold(T.idx,T.idx-1);});}else{X.addNonInteractiveMenuItem(mstrmojo.desc(7978,"Move Up"),"",true);}if(this.idx!==R.thresholds[R.metricId].length-1){X.addMenuItem(mstrmojo.desc(7979,"Move Down"),"",function(){R.moveThreshold(T.idx,T.idx+1);});}else{X.addNonInteractiveMenuItem(mstrmojo.desc(7979,"Move Down"),"",true);}X.addMenuItem(mstrmojo.desc(5893,"New Condition"),"",function(){T.exprTree.newCondition(null);});this.openPopup(X.newInstance());}else{if(W===this.previewNode||W===this.previewNode.firstChild){S.openPropertyPanel(this);}}}},removeFromModel:function K(){this.model.deleteThreshold(this.threshold);},onpropertyModelChange:function B(R){E.copy(R.threshold,E.clear(this.threshold));this.refresh();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor");var B=null;function A(D){if(!B){B=new mstrmojo.IVEDatasetPicker({onRender:function C(){var F=false;this.btnImport.set("visible",F);this.newLabel.set("visible",F);this.useExistingLabel.set("visible",F);this.btnHBox.destroyChildren();var E=mstrmojo.Button.newWebButton(mstrmojo.desc(8708,"OK"),function(){B.close(B.item);},true);E.cssText="margin-right: 10px";E.bindings={enabled:function(){return !!this.parent.parent.item;}};var G=mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function(){B.close();},false);this.btnHBox.addChildren([E,G]);}});B.render();}B.onClose=function(E){if(E){D(E);}};B.open();}mstrmojo.vi.ui.SelectDatasetWizardEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.SelectDatasetWizardEditor",title:mstrmojo.desc(11677,"Select a Dataset"),cssClass:"mstrmojo-SelectDatasetWizardEditor",callback:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11678,"Selecting Existing Dataset"),cssClass:"SelectDatasetWizardEditor-h1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11679,"Browse Dataset..."),cssClass:"SelectDatasetWizardEditor-entry",onclick:function(){var C=this.parent;A(function(D){C.callback(D);});}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11680,"Import New Data"),cssClass:"SelectDatasetWizardEditor-h2"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3250,"File..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11681,"URL..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11480,"Database..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3190,"Freeform SQL"),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11682,"Salesforce..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11683,"More Data Sources..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11684,"Create New Dataset"),cssClass:"SelectDatasetWizardEditor-h2"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11685,"Enter Data Manually..."),cssClass:"SelectDatasetWizardEditor-entry"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11686,"Browse All Objects..."),cssClass:"SelectDatasetWizardEditor-entry last"},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Close",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.close();}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.elementHelper","mstrmojo.DocSelector","mstrmojo.ui.MultiSelectPulldown");var L=mstrmojo.hash,N=mstrmojo.elementHelper,I=mstrmojo.array,P=mstrmojo.DocSelector.STYLES;var K=0,B=1,C=2,F=4,G=1000;function J(Y){var X=null,T=null,W=0,V,U;for(V in Y){U=Number(V);W++;X=(X===null||X>U)?U:X;T=(T===null||T<U)?U:T;}return W===0||T-X===W-1;}mstrmojo.ListDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.ListDocSelector",formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P","height"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_buildEvent:function H(q,X){var l=this.node,W=this.defn,g=l.data.elms,Y=[],r=X.multiSelect,Z=X.selectedIndices,e=X.allIdx,b=!!Z[e],n,k,o=[],d=this.include;if(!r){var T=g[X.selectedIndex],f=T.v;Y=[f];o=[f+";"+T.n];}else{if(b){k=g[e].v;Y=[k];o=[k];}else{if(Z[e]){Z[e]=false;}var p=L.keyarray(Z,true).sort(I.numSorter),h={};for(n in p){h[p[n]]=Z[p[n]];}Z=h;L.forEach(Z,function(u,t){if(u){Y.push(g[t].v);o.push(g[t].v+";"+g[t].n);}});}}this.defn.set("cek",Y);if(Y.length>0||!W.nsb||W.nsb===K){if(d&&parseInt(this.style,10)===F&&g&&g.length>G&&Y.length>g.length/2&&!this.isRecursiveAttributeSelector()){q.include=false;q.forceBuffer=true;q.requireToggle=true;var m=[],V=[];I.forEach(g,function(u,t){if(t!==e&&!Z[t]){m.push(u.v);V.push(u.v+";"+u.n);}});q.eid=((parseInt(q.type,10)===1)?V:m).join(N.ELEM_SEPARATOR);}else{q.eid=((parseInt(q.type,10)===1)?o:Y).join(N.ELEM_SEPARATOR);}}else{if(W.nsb===B||!W.showall){q.unset=true;}else{if(W.nsb===C){q.eid=N.ELEM_ALL_ID;}}}var a=mstrmojo.dom.position(X.domNode,true);if(a){q.left=a.x;q.top=a.y;}if(b&&this.multi&&d){I.forEach(g,function(u){var t=u.v;if(Y[0]!==t){Y.push(t);}});}if(W.sec){k=k||N.ELEM_ALL_ID;var c=I.filter(g,function(t){return t.v!==k;}).length,U=I.indexOf(Y,k)>=0||!W.multi?c:Y.length;if(W.style!==mstrmojo.DocSelector.STYLES.SCROLLER){this.parent.set("count",N.buildElemsCountStrByNum(U,c));}}},getCekEvtListener:function S(V,U){var T=V.defn.style;if(T===P.PULLDOWN||T===P.SCROLLER){return function(W){var a=U.items,b={};if(!U.multiSelect){var X=U.selectedIndex=I.find(a,"v",W.value[0]);if(X>-1){b[X]=true;}}else{var Z=U.allIdx;if(Z>-1&&I.indexOf(W.value,a[Z].v)>-1){for(var Y=0;Y<a.length;Y++){b[Y]=true;}}else{I.forEach(W.value,function(d){var c=I.find(a,"v",d);if(c>-1){b[c]=true;}});}}V.selIdx=U.selectedIndices=b;V.handleActionInSyncPhase(function(){U.refresh();});};}return this._super(V,U);},preBuildRendering:function A(){var V=this.node.defn.style,U=L.clone(this.formatHandlers),T=U.contentNode;if(T){if((V===P.RADIO||V===P.CHECKBOX)&&U.filterNode){T.push("fx");T.push("background-color");delete U.filterNode;}if(V===P.LIST){delete T.height;}}this.formatHandlers=U;return this._super();},getWidgetClass:function Q(V,U,T){if(U===P.PULLDOWN){return V.multi?"ui.MultiSelectPulldown":"ui.Pulldown";}return this._super(V,U,T);},getWidgetConfig:function D(Y,W,V,X){var U=Y.getFormats(),T=this._super(Y,W,V,X);if(W===P.SCROLLER){Y.extCls="extSlider";if(mstrApp&&mstrApp.isVI){T.isHoriz=true;}L.copyProps(["height","width"],U,T);}if(W===P.PULLDOWN&&!V.multi){T.isHostedWithin=false;T.onitemSelected=T.onchange;T.allowHTML=false;}return T;},updateWidget:function M(W){var X=this._super(W),T=W.selIdx;var U=X.items=W.node.data.elms;X.selectedIndices=T;if(!X.multiSelect&&U&&U.length){var V=L.keyarray(T);if(V.length===1){X.selectedIndex=Number(V[0]);}else{X.selectedIndices={};X.selectedIndex=-1;}}return X;},isSelectAll:function E(){var W=this.node.data.elms,V=this.children&&this.children[0],X=V.selectedIndices,U=V.allIdx,T=!!X[U],Y=(W[U]&&W[U].v)||N.ELEM_ALL_ID;if(this.include){return T||I.filter(W,function(Z){return Z.v!==Y;}).length===L.keyarray(X).length;}else{return L.isEmpty(X);}},destroy:function R(){var T=this.node.data;this._super();if(T.del){I.insert(T.elms,T.del.idx,T.del.elem);delete T.del;}},isValidSelection:function O(){var V=this.node,W=V.data,U=V.defn,X=W.ces,T=this.model;if(!U.multi&&X&&X.length>1&&!this.allowsTogglingMultiSelect()){return false;}if(U.style===mstrmojo.DocSelector.STYLES.SCROLLER&&!J(this.selIdx)){return false;}if(T.isSelWarnFlagOn(this.k)&&X&&X.length===0&&W.elms.length>0){return this.children[0].noneIdx&&this.children[0].noneIdx>-1;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.Button","mstrmojo.form");var T=8,O=16,U=4,R=1,J=2,D=4,Q=8,B=16,M=268435456,I=536870912,A=1073741824,H=window.mstrConfig&&!window.mstrConfig.simpleDialog,L=2147755235,K=2147755236;var C="mstrmojo-oivmSprite ";function E(Y,X,W){if(H){mstrmojo.confirm(Y,{confirmBtn:{fn:X},cancelBtn:{fn:W}});}else{if(mstrmojo.confirm(Y)){if(X){X();}}else{if(W){W();}}}}function V(X,W){if(H){mstrmojo.alert(X,W,null,null,null,{allowHTML:true});}else{mstrmojo.alert(X);W();}}function N(W){var X=mstrmojo.findAncestor(this,"scriptClass","mstrmojo.DocInfoWindow");if(!!X){X[W?"registerLock":"releaseLock"](this);}}mstrmojo._DocActionSelector=mstrmojo.provide("mstrmojo._DocActionSelector",{_mixinName:"mstrmojo._DocActionSelector",extCls:"mstrmojo-ActionSelector",type:T,targets:null,initControlInfo:function G(){var W=this.node.defn;this.aa=parseInt(W.aa,10);this.dpTxt=W.dpTxt||{8:mstrmojo.desc(5369),4:mstrmojo.desc(8233),16:mstrmojo.desc(8232)}[this.aa]||"";this.dpCfm=W.dpCfm;this.sac=parseInt(W.sac,10);this.msg=W.msg;this.rsid=W.rsid;this.rst=W.rst;this.node.data.elms=[{n:this.dpTxt,v:this.dpTxt}];if(this._super){this._super();}},selectorControlChange:function(W){if(W.selectedIndex!==0){return ;}this.executeAction();W.select([]);},executeAction:function(){var X=this.aa,W=this,Y=function(){N.call(W,false);};N.call(W,true);if(X===T){if(this.dpCfm){E(mstrmojo.desc(8313),function(){W.onCommit();},Y);}else{W.onCommit();}}else{if(X===U){if(this.dpCfm){E(mstrmojo.desc(8322),function(){W.onDiscard();},Y);}else{W.onDiscard();}}else{this.onRecalculate();}}},postBuildRendering:function(){this._super();this.domNode.ontouchstart=function(W){mstrmojo.css.addClass(W.target,"glow");};this.domNode.ontouchend=function(W){mstrmojo.css.removeClass(W.target,"glow");};},onCommit:function(){var Z=this,a=this.model,X=Z.controller,W=mstrApp.useBinaryFormat;N.call(this,false);if(!W&&!this.validateRequiredObjects()){V(mstrmojo.desc(9200));return ;}var Y=function(b){if((Z.sac&I)>0){X.invalidClientCache();}if((Z.sac&B)>0){var c={did:Z.rsid,objType:Z.rst,forceExec:(Z.sac&M)>0};if((Z.sac&A)>0){c.linkAnswers='<hl mid="'+a.mid+'" srct="2" aopam="1"><prms></prms></hl>';}X.onExecuteNewObject(Z,c);}else{if((Z.sac&Q)>0){X.onReExecute(Z);}else{if(mstrApp.isMobile){X.generateActionToolbar();}a.transactionUpdate(b);}}};mstrmojo.mask.show("Running");a.sendTransactionActions(this.ck,T,a.newCallback({success:function(b){mstrmojo.mask.hide();if(a.txrcd||b.offln){X.offlineTransactionsSubmitted(Z.ck);}if(b.offln){if(W&&!Z.networkToastShowed){Z.networkToastShowed=true;mstrmojo.toast(mstrmojo.desc(9258,"No Network Connectivity")+". "+mstrmojo.desc(9259,"Transaction will be submitted when connectivity is resumed."));}a.transactionUpdate(b);}else{if((Z.sac&R)>0&&Z.msg){if(W){mstrmojo.toast(Z.msg);window.setTimeout(function(){Y(b);},100);}else{V(Z.msg,function(){Y(b);});}}else{Y(b);}}},failure:function(d){var b=mstrmojo.all.mojoAlertx9;if(b){b.destroy();}mstrmojo.mask.hide();if(a.txrcd){X.offlineTransactionsSubmitted(Z.ck);}var c=4294967296+parseInt(d.code,10);if(c===L){if(W){Z.validateRequiredObjects();}V(mstrmojo.desc(9200,"You have some required inputs that are not modified."));}else{if(c===K){var e=mstrmojo.desc(9201,"You haven't made any changes to submit.");if(W){mstrmojo.toast(e);}else{V(e);}}else{V(mstrmojo.base64.decodeHttpHeader(d.message),function(){if(!W){Z.controller.onReExecute(Z,true);}});}}}}));},onDiscard:function F(){var X=this,Y=this.model,W=X.controller;N.call(this,false);Y.txDiscardTargets=this.getTxTargets();Y.sendTransactionActions(this.ck,U,{success:function(Z){Y.transactionUpdate(Z);W.transactionDiscarded(X.ck);},complete:function(){delete Y.txDiscardTargets;if(mstrApp.isMobile){W.generateActionToolbar();}}});},onRecalculate:function(){N.call(this,false);this.model.sendTransactionActions(this.ck,O);},getTxTargets:function S(){var c=this.tks.split("\u001E"),b,W,a,d,X,Y,Z={};for(b=0,W=c.length;b<W;b++){a=c[b];d=1;do{X=this.model.getUnitInstance(a,d++);if(X&&X.checkRequiredObjects){if(X.isPanelStack){for(Y in X.txWidgets){Z[X.txWidgets[Y].id]=1;}}else{Z[X.id]=1;}}else{break;}}while(true);}return Z;},validateRequiredObjects:function P(){var W=true,X;for(X in this.getTxTargets()){W=mstrmojo.all[X].checkRequiredObjects()&&W;}return W;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.MetricSelectorUtility","mstrmojo.hash","mstrmojo.array");var E=mstrmojo.hash,J=mstrmojo.array;mstrmojo.MetricQualDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.MetricQualDocSelector",_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P","height"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},init:function N(O){this._super(O);this.spm=true;},initControlInfo:function M(){this._super();var P=mstrmojo.MetricSelectorUtility,R=this.node,S=R.data,Q=R.defn;E.copyProps(["srcid","srct"],Q,this);this.qua=S.qt;this.dt=S.dt;var O=P.getOpIdxByfunc(S.f,S.ft);if(O!==-1){this.include=P.getIncludeByOp(O);}},canApply:function D(O){return true;},onquaChange:function H(O){this.node.data.qt=O.value;},_buildEvent:function F(R,Q){var P=[];J.forEach(Q.cs,function(S){P.push(S.v);if(R.dtp===undefined){R.dtp=S.dtp;}});if(P.length){R.cs=P.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}var O=mstrmojo.MetricSelectorUtility.getFuncInfo(Q.opId,Q.qua);R.f=Q.f=O.f;R.ft=Q.ft=O.ft;R.include=this.defn.include=this.include=Q.include;R.ckey=this.ckey;R.srcid=this.srcid;R.srct=this.srct;R.unset=Q.unSet;R.onlyInclude=Q.onlyInclude;if(Q.changeInclude){R.changeInclude=Q.changeInclude;R.forceApply=true;Q.changeInclude=false;}if(Q.changeQual){R.changeQual=Q.changeQual;Q.changeQual=false;}R.qt=Q.qua;this.node.defn.set("cek",{id:this.id,f:Q.f,ft:Q.ft,cs:Q.cs,qua:Q.qua,include:Q.include});},preBuildRendering:function K(){var O=this._super();if(this.isInFilterPanel()&&!this.isHorizFP()){this.children[0].width=this.parent.parent.contentWidth;}return O;},postBuildRendering:function B(){this._super();if(this.formatHandlers.filterNode){var O=this.getFormats();if(!O.height){this.updateHeight();}}},getCekEvtListener:function C(P,O){return function(Q){P.handleActionInSyncPhase(function(){P.set("qua",Q.value.qua);if(P.id!==Q.value.id){O.updateExpr(Q.value);if(P.style===mstrmojo.DocSelector.STYLES.METRIC_SLIDER){P.set("include",Q.value.include);}}});};},updateWidget:function L(S){var T=this._super(S),P=S.node,O=S.selIdx,R=P.data,Q=R.elms;if(T.updateData){T.numFmts=S.defn.numFmts;S.handleActionInSyncPhase(function(){T.updateData({low:R.min,high:R.max,cnt:R.cnt,nov:R.nov},{cs:R.cs,f:R.f,ft:R.ft,qua:R.qt});});}T.items=Q;T.selectedIndices=O;return T;},newAndInitWidget:function I(O){var P=this._super(O);O.attachEventListener("quaChange",P.id,function(Q){this.set("qua",Q.value);});return P;},getWidgetConfig:function G(T,R,Q,S){var P=T.getFormats(),O=this._super(T,R,Q,S);E.copyProps(["height","width","font"],P,O);E.copyProps(["cs","ft"],Q,O);O.fmts=Q.f;O.dt=T.dt;O.qua=T.qua;O.numFmts=Q.numFmts;return O;},isSelectAll:function A(){var Q=mstrmojo.MetricSelectorUtility.OP,P=this.children&&this.children[0],O=P&&(Q._IS_NULL===P.opId||Q._IS_NOT_NULL===P.opId);return P===undefined?true:(!P.cs||P.cs.length===0)&&!O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.array","mstrmojo.elementHelper");var I=mstrmojo.array,F=mstrmojo.DocSelector.ELEM_ALL_ID,H=mstrmojo.elementHelper;var C=0,K=1,J=2;var B=1,M=3;function A(O){I.forEach(O,function(P){P.n=P.v;});return O;}mstrmojo.TextBoxDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.TextBoxDocSelector",_ieformatHandlers:{domNode:["font","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["font","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_fetchOnInit4UCOnDS:function G(){},_getSelectionCount:function L(P){var O=P.items;return O?O.length:0;},_buildEvent:function D(R,Q){var O=[],P=this.defn;I.forEach(Q.items,function(S){O.push(S.v);});if(O.length>0||P.nsb===C){R.eid=O.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}else{R.eid="";}if(P.sec){this.parent.set("count",H.buildElemsCountStrByNum(O.length,0));}},updateWidget:function N(Q){var R=this._super(Q),O=Q.node,P=O.data;R.items=P.vs?A(P.vs.concat()):[];return R;},getWidgetConfig:function E(U,R,Q,T){var P=U.getFormats(),S=U.node.data,O=this._super(U,R,Q,T);O={scriptClass:O.scriptClass,cssText:P.height?"height: "+P.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(Q.ttl||""),items:S.vs?A(S.vs.concat()):[],srcid:Q.srcid||"",dsrc:Q.dsrc||"",onitemsChange:function(){if(!U._inSyncPhase){U.selectorControlChange(this);}}};if(!Q.multi){O.maxObjectCount=1;}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.vi.ui.rw.selectors.SearchableCheckList","mstrmojo.vi.ui.rw.selectors.CollapsibleCheckList","mstrmojo.vi.ui.rw.selectors.PageBySlider","mstrmojo.vi.ui.rw.selectors.PageByButtonBar","mstrmojo.vi.ui.rw.selectors.MetricQualification","mstrmojo.vi.ui.rw.selectors.MetricSlider","mstrmojo.vi.ui.rw.selectors.Slider","mstrmojo.vi.ui.rw.selectors.LinkList","mstrmojo.vi.ui.rw.selectors.ListBoxSelector","mstrmojo.css","mstrmojo.hash");var B=mstrmojo.hash,E="vi.ui.rw.selectors.",F=mstrmojo.DocSelector.STYLES;var G={};G[F.CHECKBOX]=G[F.RADIO]=E+"SearchableCheckList";G[F.LIST]=["ListBoxHoriz",E+"ListBoxSelector"];G[F.SCROLLER]=E+"Slider";G[F.METRIC_SLIDER]=E+"MetricSlider";G[F.METRIC_QUAL]=E+"MetricQualification";G[F.LINK]=G[F.BUTTON]=E+"LinkList";function M(R){var Q=Object.keys(R),P=Q.length,O=Math.min.apply(null,Q),N=Math.max.apply(null,Q);return P===0||N-O===P-1;}mstrmojo.vi.ui.rw.selectors._IsDocSelector=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsDocSelector",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsDocSelector",model:null,multi:false,k:"",init:function L(N){this._super(N);mstrmojo.css.addWidgetCssClass(this,"vi-DocSelector");},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"},xt:true},getLayoutOffsets:function I(){if(this.isInFilterPanel()){return null;}return{h:18,w:18};},update:function D(P){var N=P.defn.fmts,Q=this.isViPageBy,O=P.defn;if(Q||this.isInFilterPanel()){O.fmts=B.copyProps(["height","z-index"],N);}else{O.fmts=B.copy(N);}if(Q){O.multi=false;}this._super(P);},preBuildRendering:function J(){if(!this.isViPageBy&&!this.isInFilterPanel()){this.formatHandlers={domNode:["F","text-align","vertical-align","line-height"],contentNode:["fx"],item:["F","text-align","line-height"]};}var P=this.style,O=P===F.RADIO,N=P===F.CHECKBOX;if(N||O||P===F.LINK||P===F.BUTTON){var Q=this.children[0];Q.orientation=this.node.defn.horiz?"h":"v";if(N||O){Q.multiSelect=!O;}}this.content.hostedCSSClass="selector";this._super();},postBuildRendering:function A(N){if(this.bindWarningHandler){this.bindWarningHandler(this,this.content);this.validate();}return this._super(N);},getWidgetClass:function C(Q,P,O){if(Q.isViPageBy){if(P===F.SCROLLER){return E+"PageBySlider";}if(P===F.BUTTON){return E+"PageByButtonBar";}}if(this.isRecursiveAttributeSelector()&&this.isInFilterPanel()){return E+"CollapsibleCheckList";}var N=G[P];if(N){if(N.constructor===Array){N=N[O?0:1];}return N;}return this._super(Q,P,O);},updateWidget:function K(O){var N=this._super(O);if(O.style===mstrmojo.DocSelector.STYLES.SCROLLER&&!M(O.selIdx)){N.selectedIndices={};}return N;},validate:function H(){if(this.isValidSelection&&!this.isValidSelection()){this.set("validation",{refNode:this.parent.domNode,position:1,invalid:true,errorCode:"unableDisplaySelectionVIWarning"});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.ui._IsViPanel","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui._HasMask","mstrmojo.vi._MonitorsAppState","mstrmojo.DocSelector","mstrmojo.vi.ui.toolbars.TitleToolbar");var B=mstrmojo.DocSelector.STYLES;function F(){var M=this.unit;if(M){var L=mstrmojo.all[M.id];this.removeChildren(L);L.destroy();this.set("unit",null);}}mstrmojo.vi.ui.PageByPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo.vi.ui._IsViPanel,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.PageByPanel",markupString:'<div id="{@id}" class="mstrmojo-VIPageByStack" style="{@cssText}"><div class="mstrmojo-VIPageByStack-Values horizontal"></div><div class="mstrmojo-VIPageByStack-Toolbar"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},toolbarNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onunitChange:function(){if(this.hasRendered){this.generateToolbar();this.doLayout();this.pageByStack.doLayout();}}},layoutConfig:{h:{toolbarNode:"100%",containerNode:"100%",maskNode:"100%"},w:{toolbarNode:"auto",containerNode:"all",maskNode:"all"},xt:true},unit:null,parent:null,pageByStack:null,useRichTooltip:true,isDynamicTooltip:true,getLayoutOffsets:function E(){return{h:2,w:2};},children:[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",alias:"toolbar",slot:"toolbarNode"}],onAppStateChange:function C(L){this._super(L);var M=mstrmojo.vi.VisualInsightApp.APP_STATES,O=L.value,N=this.toolbarNode;this.set("isMasked",O===M.SELECTOR_TARGETING);if(N){N.style.display=(O===M.PRESENTATION)?"none":"";}},preBuildRendering:function G(){var L=this.parent;this.model=L.model;this.builder=L.builder;return this._super();},moveTooltip:function D(L,N){this.richTooltip=null;var M=this.unit;if(M){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:M.n,top:L.clientY+15,left:L.clientX-15};}this._super(L,N);},updateToolbar:function K(M){var N=M.ENUM_CORNERS;M.setAlignment(N.BOTTOM_RIGHT,N.TOP_RIGHT);M.isHostedWithin=false;var Q=this.unit,O=this.parent.model;if(Q){var L=Q.style,P=function(T,S){var R=S===L?"on":"";M.addMenuItem(T,R,function(V){var U=V.ctxt.style;if(U===L){return false;}O.changePageByStyle(mstrmojo.all[Q.id],U);return true;},{style:S});};P(mstrmojo.desc(4734,"Button Bar"),B.BUTTON);P(mstrmojo.desc(4730,"Slider"),B.SCROLLER);P(mstrmojo.desc(4729,"Drop-down"),B.PULLDOWN);M.addSeparator();M.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){mstrmojo.warn(mstrmojo.desc(13245,"This action will permanently delete the page-by panel. A new one can be created by inserting a new filter. Do you want to proceed?"),{confirmBtn:{t:mstrmojo.desc(1442,"OK"),fn:function(){F.call(this);this.model.removePageByUnit(this,Q);}.bind(this),isHot:true},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}});}.bind(this));}return this._super(M);},close:function I(){this.setOpenStatus(false);},setOpenStatus:function J(M,L){var O=this._super,N=this.id;if(M&&!this.pageByStack){this.model.loadHiddenPageByStack(this.builder,function(){O.call(mstrmojo.all[N],M,true);});}else{O.call(this,M,L);}},getPanelSaver:function(){return mstrmojo.vi.models.PanelFormatSaver.getPanelSaver(this.model,{visible:{set:"FormattingAppearance",name:"Visible"}},this.pageByStack);},setPageByStack:function A(M){var L=this.pageByStack;if(L){this.removeChildren(L);L.destroy();}if(M){M.slot="containerNode";M.alias="pageByStack";this.addChildren([M]);}},resetLayout:function H(){this.parent.viPanelChangedVisibility(this);}});mstrmojo.vi.ui.PageByPanel.boxConfiguration={f:{h:32,v:45},o:"v",r:true};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.List","mstrmojo.Label","mstrmojo.ListMapperHoriz","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo.TristateCheckBox","mstrmojo.Pulldown","mstrmojo.ACL.UserTreeBrowser","mstrmojo.DataGrid","mstrmojo.DropDownButton","mstrmojo.ListBox","mstrmojo.DivItemRenderer","mstrmojo.VBox","mstrmojo.Box","mstrmojo.ACL.UserInputBox","mstrmojo.Editor","mstrmojo.ACL.UserDataService","mstrmojo.StackContainer","mstrmojo.CheckList","mstrmojo.TextBox","mstrmojo.TextBoxWithLabel","mstrmojo.CheckBox");mstrmojo.requiresDescs(1825,8078,8079,629,8080,8081,8082,3336,9048,8083,8084,955,8085,531,8086,8087,8088,8089,8090,767,2056,8091,8093,1442,221,8092,13621,9772,9773,9774,272,271,8145,2509,8146,8147,9775,9776,9777,9771,12299,9151,2156,9892,9890,9891,9099,2140,2102);var Q=mstrmojo.dom,C=mstrmojo.css,h=mstrmojo.array,a=[],S="sharingEditor",l=199,R="294DEDC011D2F1D56000D98E67019608",F="C82C6B1011D2894CC0009D9F29718E4F",E=[1,4,8,16,32,64,128],A=[mstrmojo.desc(1825,"Browse"),mstrmojo.desc(8078,"Read"),mstrmojo.desc(8079,"Write"),mstrmojo.desc(629,"Delete"),mstrmojo.desc(8080,"Control"),mstrmojo.desc(8081,"Use"),mstrmojo.desc(8082,"Execute")],Y=["B","R","W","D","C","U","E"],Z=false,n=true,T=257,m=1024,U=772,W=776,J=777,c=mstrmojo.Button.newWebButton,k=mstrmojo.Button.newActionButton;function P(p){return(p&&p.t===8);}function o(p){return p&&p.st!=T&&p.st!=m&&p.st!=U&&p.st!=W&&p.st!=J;}function I(p){return{"253000":255000,"253":255,"221":223,"197":199,"69":71}[p]||p;}function H(p){return{"253000":255000,"253":255,"32221":223,"56197":199}[p]||p;}function V(w){var v=[].concat(w.acls),p=w.inhs,u=w.acls,z,r,x,q,t;u.splice(0,u.length);if(P(w)){v=v.concat(mstrmojo.hash.valarray(p));}for(q=0,t=v.length;q<t;q++){z=v[q];x=z.rgt;if(x>1000){r=mstrmojo.hash.copy(z);r.den=true;r.rgt=Math.floor(x/1000);u.push(r);}if((x%1000)>0){r=mstrmojo.hash.copy(z);r.den=false;r.rgt=x%1000;u.push(r);}}return w;}function O(q){var p={isSerializable:function(u,t,r){switch(u){case"did":case"rgt":case"n":case"acls":case"t":case"st":case"inh":case"den":return true;}return false;},getArrItemName:function(u,r,t){if(u==="acls"){return"acl";}},convertBoolean:true};return mstrmojo.string.json2xml("oi",q,p);}function f(v,u){var r=v&&v.oi,q,p,w,t=v.oneTierConnectivity;if(r){r=V(r);q=O(r);w={taskId:"saveObjectACL",objectXML:q,objectType:r.t,objectID:r.did,propagateToChildren:v.childrenAccessPulldown.value};p={success:function(x){if(u){v.close();}else{mstrmojo.alert(mstrmojo.desc(3336,"## has been saved successfully.").replace("##",x.n));v.set("hasChanged",false);}},failure:function(x){if(x.getReponseHeader){mstrmojo.alert(x.getResponseHeader("X-MSTR-TaskFailureMsg"));}if(u){v.close();}}};if(t){delete w.taskId;w.connectionId=t.connectionId;w.sessionState=t.sessionState;t.connectivityProxy.saveObjectACL(w,mstrmojo.func.wrapMethods(p,{failure:function(x){mstrmojo.onetier.vi.prefs.handleErrorMessage(x);}}));}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,p,w);}}}function g(z){var AE=z.aclList,AF=z.objectInputer,AA=z.rightPulldown,t=AF.getSelectedObjects(),v=t.length,AB=[],r,AD=AA.value,q,AC,p;if(!AF.isValid()){mstrmojo.alert(mstrmojo.desc(9048,"Some users/groups do not exist. Please remove them in order to proceed."),null,z.alertTitle);return false;}for(q=0;q<v;q++){r=t[q];if(r.did===R||r.did===F){var u=mstrmojo.all[S];if(AD===u.currentPublicRight){if(n){C.removeClass(u.userMessage.domNode,"hideMsg");}}}AC=h.find(AE.items,"did",r.did);if(AC!==-1){p=AE.items[AC];if(z.uneditableRights[p.rgt]){continue;}}AB.push(new mstrmojo.Obj({n:r.n,did:r.did,st:r.st,rgt:AD,newItem:true}));}if(AB.length>0){var x=h.findMulti(AE.items,"did",AB);if(x.count){var w=x.indices.concat().sort(h.numSorter).slice(0,x.count);for(q=w.length-1;q>-1;q--){AE.remove(w[q]);}}AE.add(AB);z.set("hasChanged",true);}AF.set("items",[]);return true;}function K(p){var t=[],w=Math.floor(p/1000),u=p%1000,x=E,z=A,v=x.length,AA,q;for(q=0;q<v;q++){t.push(z[q]);t.push(" ");if((u&x[q])>0){t.push(mstrmojo.desc(8083,"Granted"));}else{if((w&x[q])>0){t.push(mstrmojo.desc(8084,"Denied"));}else{t.push(mstrmojo.desc(959,"Default"));}}t.push(",");}AA=t.join("");return AA.substring(AA,AA.length-1);}function b(z){var v=[],x=z%1000,t=E,w=Y,p=t.length,u,q;for(q=0;q<p;q++){if((x&t[q])>0){v.push(w[q]);v.push(",");}}u=v.join("");return u.substring(u,u.length-1);}function M(r,t){var u=r.items,q=h.find(u,r.itemIdField,t),z=r.customItem,p=u.length-2;if(q===-1){var x={n:b(t),rgt:t};if(z){u.splice(p,1);}p=u.length-1;u.splice(p,0,x);r.customItem=x;}else{if(z&&q!==p){u.splice(p,1);r.customItem=null;}}if(mstrmojo.all[S].showACLHint!==false){r.set("title",K(t));}r.value=t;}function B(p){return{"776":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}],"779":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}]}[p]||[{n:mstrmojo.desc(8090,"View"),rgt:199},{n:mstrmojo.desc(767,"Modify"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}];}function N(w,v){var u="";if(v){var q=this.widthInput.value,x=this.heightInput.value,p=' src="'+w,z="",r=this.checkBoxList.items,t;for(t=0;t<r.length;t++){if(!this.checkBoxList.selectedIndices.hasOwnProperty(t)){if(z==""){z="&hiddensections="+r[t].alias;}else{z+=","+r[t].alias;}}}u='<iframe width="'+q+'" ';u+='height="'+x+'" ';u+=p;u+=z;u+='"></iframe>';}else{u='<iframe width="640" height="480" src="';u+=w;u+='&hiddensections=header,path,dockTop,dockLeft,footer"></iframe>';}return u;}function e(r){var u=mstrmojo.string.parseUri(r).queryKey,v=r.indexOf("?"),q=v>0?r.substring(0,v):r;var p=q.indexOf(";jsessionid");q=p>0?q.substring(0,p):q;if(u.hasOwnProperty("iframe")){delete u.iframe;}if(u.hasOwnProperty("validateRandNum")){delete u.validateRandNum;}if(!u.hasOwnProperty("server")){u.Server=encodeURIComponent(mstrApp.serverName);}if(!u.hasOwnProperty("Project")){u.Project=encodeURIComponent(mstrmojo.string.decodeHtmlString(mstrApp.projectName));}if(!u.hasOwnProperty("port")){u.Port=mstrApp.serverPort;}if(Z){u.connmode=8;u.ru=1;}if(u.evt!=="3185"){u.share=1;}q+="?";for(var t in u){q+=t+"="+u[t]+"&";}q=q.substring(0,q.length-1);return q;}function G(t){var p=new Date(),r=this.objectName+" "+p.toLocaleDateString()+" "+p.toLocaleTimeString(),q=this,u={success:function(x){var w=e(x.url);q.linkBox.set("value",w);q.url=w;q.htmlPanel.htmlBox.set("value",N(w));var v=q.tabDock.emailLink;v.set("url",window.escape(w));v.set("name",q.objectName);},failure:function(v){mstrmojo.alert(v.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){q.hideWait();if(t){var v="mailto:?body="+window.escape(q.url)+"&subject="+encodeURI(q.objectName);mstrApp.openPage(v,"mailtoIframe");}}};this.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,u,{taskId:"savePersonalView",messageID:this.mid,objectType:this.oi.t,subName:r,objectSubType:0,viewMode:this.viewMode||0,isPVPublic:true});}function D(p){return p>999?Math.floor(p/1000)*1000:p;}function X(t){var q=this.getAvailableRightsForSelection(),p=q.length,r;for(r=0;r<p;r++){if(q[r].rgt===t){return q[r].n;}}return mstrmojo.desc(2056,"Custom");}function L(p){return(p.acg&32)>0;}mstrmojo.SharingEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SharingEditor",cssClass:"mstrmojo-SharingEditor",showSharingOptions:true,showButtonBar:true,showPublisAccess:true,hasChanged:false,help:"sharing_dialog_box.htm",zIndex:199,defaultRight:223,showButtonText:true,uneditableRights:{},currentPublicRight:199,userSelectorTitle:mstrmojo.desc(8091,"User/User Group Browser"),showLinkOnOpen:false,closeEditorAfterSave:true,init:function(p){S=p.id||S;this._super(p);},onShowLink:function(q){var p={htmlCode:"showLink",showLink:"htmlCode"};this.tabDock[p[q]].set("selected",false);},showWait:mstrmojo.emptyFn,hideWait:mstrmojo.emptyFn,checkPublicAccess:function(){var x=this.oi.acls,r,AB=h.find(x,"did",F),v=this.aclList.itemsContainerNode,w=this.publicAccessSection.publicLabel,u,AA=false,p=h.find(x,"did",R),z;if(AB!==-1&&Z&&p!==-1){var q=x[AB].rgt,t=x[p].rgt;if(q===t){AA=true;z=t;}}if(AB!==-1&&!Z){AA=true;z=x[AB].rgt;}u=v.children[0].tBodies;if(Z&&u[p]){C.toggleClass(u[p].rows[0],"hide",AA);}if(u[AB]){C.toggleClass(u[AB].rows[0],"hide",AA);}w.set("checked",AA);if(z){this.set("currentPublicRight",z);}},oncurrentPublicRightChange:function(){var p=this.publicAccessSection.publicMouseOver;p.publicRight.set("value",this.currentPublicRight);p.publicRightLabel.set("text",X.call(this,this.currentPublicRight));},onOpen:function(){var q=this.oi.n,x=this.oi.acls;this.objectName=q;this.set("showACL",!!x);Z=this.guestModeEnabled;if(this.href&&!this.isLinkDirty){var r=!this.urlReady?e(this.href):this.href,v=this.tabDock.emailLink;this.url=r;v.set("url",window.escape(r));v.set("name",q);this.htmlPanel.htmlBox.set("value",N(r));this.linkBox.set("value",r);}this.set("title",mstrmojo.desc(8093,"share").replace("##",mstrmojo.string.encodeHtmlString(q)));var u=this.tabDock;u.showLink.set("selected",this.showLinkOnOpen);u.htmlCode.set("selected",false);if(x){this.checkPublicAccess();var w=this.rightPulldown;w.set("items",this.getAvailableRightsForSelection());w.set("value",l);var z=this.objectInputer,t=this.userSelector,p=t&&t.userBrowser;z.zIndex=this.zIndex;if(p&&p.hasRendered){t.opener=this;p.set("items",[]);p.getContent(p);}this.set("hasChanged",false);}this.aclList.updateScrollbars();},_set_hasChanged:function(r,p){var q=(p!==this.hasChanged);this.hasChanged=p;if(p===true){this.checkPublicAccess();return p;}return q;},_set_oi:function(q,p){this.oi=this.preProcessACLs(p);return true;},postCreate:function(){this.oi=this.preProcessACLs(this.oi);},getAvailableRightsForSelection:function(){return B(this.oi.st);},preProcessACLs:function(z){if(z&&z.acls){var w=z.acls,v=w&&w.length,x=P(z),q={},AA,p,t,u;if(x){t={};z.inhs=t;}for(u=0;u<v;u++){AA=new mstrmojo.Obj(w[u]);if(x&&AA.inh){t[AA.n]=mstrmojo.hash.copy(AA);continue;}p=q[AA.n];if(!p){p=mstrmojo.hash.copy(AA);p.rgt=0;delete p.den;q[AA.n]=p;}p.rgt+=AA.den?AA.rgt*1000:AA.rgt;}w=mstrmojo.hash.valarray(q);z.acls=w;}return z;},getACLItems:function(){var t=this.aclList&&this.aclList.items,q=[];for(var r=0,p=t.length;r<p;r++){q.push(t[r]);}return q;},onClose:function(){var p=this.objectInputer;p.set("items",[]);this.aclList.clearSelect();},getACLUserDataService:function d(){return mstrmojo.ACL.UserDataService;},userSelector:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-UserEditor",help:"user_group_browser.htm",onClose:function(){this.userBrowser.clearTreeSelect();},children:[{scriptClass:"mstrmojo.ACL.UserTreeBrowser",alias:"userBrowser",getACLUserDataService:function d(){return this.parent.opener.getACLUserDataService();},updateTreeContent:function(q,t){q.contentRetrieved=true;var r=t[q.itemChildrenField],p=q.tree||q,v=t.bc,u=t.sz,x=t.bb;if(v!==-1){if(x+v<=u){r.push(p.nextItemCreaterFunc());}if((x-v)>-1){r.unshift(p.prevItemCreaterFunc());}}q.blockBegin=x;p.initializing=true;q.clearSelect(false);q.set("items",r);q.setSelectedItems(p.getTotalSelections(),true);p.initializing=false;},selectionAcrossBranch:true,multiSelect:true},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(q){var p=this.parent.parent,v=p.opener,u=v.objectInputer,t=p.userBrowser,r=t.getTotalSelections();if(r&&r.length>0){u.add(r,u.items.length-1);}p.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(p){this.parent.parent.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}}]}],onOpen:function(){this.set("title",this.opener.userSelectorTitle);}},customACL:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8092,"Custom Permission Level"),cssClass:"mstrmojo-CustomACLEditor",help:"Custom_Permission_Level_dialog_box.htm",onOpen:function(){var x=this.rgt,z=Math.floor(x/1000),w=x%1000,t=this.children,u,v,q,p;for(q=0,p=t.length;q<p;q++){u=t[q];v=u.right;if(this.twoStates){u.set("grayed",false);u.set("checked",false);}else{u.set("grayed",true);u.set("checked",true);}if((z&v)>0){u.set("checked",false);u.set("grayed",false);}if((w&v)>0){u.set("checked",true);u.set("grayed",false);}}},getACLValue:function(){var u=0,v=0,r=this.children,t,q,p;for(q=0,p=r.length;q<p;q++){t=r[q];if(t.grayed||!t.right){continue;}if(t.checked){u+=t.right;}else{v+=t.right;}}return v*1000+u;},children:[{scriptClass:"mstrmojo.TristateCheckBox",alias:"browse",right:1,text:mstrmojo.desc(1825,"Browse")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"read",right:4,text:mstrmojo.desc(8078,"Read")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"write",right:8,text:mstrmojo.desc(8079,"Write")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"delete",right:16,text:mstrmojo.desc(629,"Delete")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"control",right:32,text:mstrmojo.desc(8080,"Control")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"use",right:64,text:mstrmojo.desc(8081,"Use")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"execute",right:128,text:mstrmojo.desc(8082,"Execute")},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(p){var q=this.parent.parent;if(q.onOK){q.onOK();}q.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(p){var q=this.parent.parent;if(q.onCancel){q.onCancel();}q.close();}}]}]},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13621,"Share By"),bindings:{visible:function(){return o(this.parent.oi)&&this.parent.showSharingOptions;}},cssClass:"SharingEditor-title"},{scriptClass:"mstrmojo.HBox",alias:"tabDock",cssClass:"sharingEditor-tabDock",bindings:{visible:function(){return o(this.parent.oi)&&this.parent.showSharingOptions;}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink style="{@cssText} mstrAttach:click>'+mstrmojo.desc(9772,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"emailLink",onclick:function(){var q=this.parent.parent;if(!this.url||q.isLinkDirty){G.call(q,true);q.set("isLinkDirty",false);}else{var r=window.location.protocol,p="mailto:?body="+window.escape(q.url)+"&subject="+encodeURI(q.objectName);if(mstrApp.isSingleTier){window.FormWrapper.openPage(p);}else{if(!!Q.isChrome&&r==="https:"){window.open(p,"_self");window.setTimeout("iframe.hideWaitPage()",2000);}else{window.open(p,"mailtoIframe");}}}}},{scriptClass:"mstrmojo.Label",alias:"showLink",text:mstrmojo.desc(9773,"Show Link"),cssClass:"SharingEditor-ShowLink",selected:false,onclick:function(p){var q=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!q.url||q.isLinkDirty){G.call(q);q.set("isLinkDirty",false);}q.onShowLink(this.alias);this.set("selected",true);}}},{scriptClass:"mstrmojo.Label",cssClass:"SharingEditor-ShowHtml",alias:"htmlCode",text:mstrmojo.desc(9774,"Show HTML"),selected:false,onclick:function(p){var q=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!q.url||q.isLinkDirty){G.call(q);q.set("isLinkDirty",false);}q.onShowLink(this.alias);this.set("selected",true);}}}]},{scriptClass:"mstrmojo.Box",alias:"htmlPanel",cssClass:"mstrmojo-SharingEditor-html-panel",children:[{scriptClass:"mstrmojo.TextBox",alias:"htmlBox",cssClass:"SharingEditor-Html"},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"widthInput",label:mstrmojo.desc(272,"Width:"),value:640,onvalueChange:function(p){var q=this.parent,r=mstrmojo.all[S];q.htmlBox.set("value",N.call(q,r.url,true));}},{scriptClass:"mstrmojo.TextBoxWithLabel",label:mstrmojo.desc(271,"Height:"),alias:"heightInput",value:480,onvalueChange:function(){var p=this.parent,q=mstrmojo.all[S];p.htmlBox.set("value",N.call(p,q.url,true));}},{scriptClass:"mstrmojo.CheckListHoriz",alias:"checkBoxList",items:[{n:mstrmojo.desc(8145,"Navigation bar"),alias:"path"},{n:mstrmojo.desc(2509,"Toolbar"),alias:"dockTop"},{n:mstrmojo.desc(8146,"Tools panel"),alias:"dockLeft"},{n:mstrmojo.desc(8147,"Footer"),alias:"footer"}],multiSelect:true,onselectionChange:function(p){var q=this.parent,r=mstrmojo.all[S];q.htmlBox.set("value",N.call(q,r.url,true));}}],bindings:{visible:"this.parent.tabDock.htmlCode.selected"}},{scriptClass:"mstrmojo.TextBox",alias:"linkBox",cssClass:"SharingEditor-Link",bindings:{visible:"this.parent.tabDock.showLink.selected"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9775,"Who Has Access"),cssClass:"SharingEditor-title",bindings:{visible:"this.parent.showACL"}},{scriptClass:"mstrmojo.HBox",alias:"publicAccessSection",cssClass:"sharingEditor-publicAccessSection",bindings:{visible:"this.parent.showACL && this.parent.showPublisAccess"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"publicLabel",cssClass:"SharingEditor-Public",bindings:{label:function(){if(this.parent.parent.guestModeEnabled){return mstrmojo.desc(9776,"Public (Login not required)");}return mstrmojo.desc(9777,"Everyone (Login not required)");},enabled:function(){return L(this.parent.parent.oi);}},oncheckedChange:function(){C.toggleClass(this.domNode.children[1],"label-disabled",!this.checked);},getUserGroupsInfo:function(){if(Z){this.getUserGroupFromTaskCall(R);}this.getUserGroupFromTaskCall(F);},getUserGroupFromTaskCall:function(w){var r=mstrmojo.all[S],t=r.aclList,u=r.getACLUserDataService(),v=function(z){var x=new mstrmojo.Obj({n:z.n,did:z.did,st:z.st,rgt:l,newItem:true});a.push(x);},q=function(x){},p=function(){if(!Z||(Z&&a.length==2)){t.add(a);r.set("hasChanged",true);}};u.getMembers({blockBegin:0,blockCount:1,outputElements:1,data:{did:w}},{success:v,failure:q,complete:p});},onclick:function(){var q=mstrmojo.all[S];var r=q.aclList.items;var t=h.find(r,"did",F);if(t!==-1){r.remove(t);}var p=h.find(r,"did",R);if(Z&&p!==-1){r.remove(p);}if(this.checked===true){if(a.length<1){this.getUserGroupsInfo();}else{mstrmojo.array.forEach(a,function(u){u.rgt=l;});r.add(a);q.set("hasChanged",true);}}else{q.set("currentPublicRight",l);q.set("hasChanged",true);}}},{scriptClass:"mstrmojo.MouseOverContainer",alias:"publicMouseOver",bindings:{visible:"this.parent.publicLabel.checked",enabled:function(){return L(this.parent.parent.oi);}},children:[{scriptClass:"mstrmojo.Label",alias:"publicRightLabel",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){var p=this.parent.parent.parent;return X.call(p,p.currentPublicRight);},enabled:function(){return L(this.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-pulldown",itemIdField:"rgt",alias:"publicRight",visible:false,postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},bindings:{value:"this.parent.parent.parent.currentPublicRight",enabled:function(){return L(this.parent.parent.parent.oi);}},selectionPolicy:"reselect",onvalueChange:function(){var p=this.parent;var q=p.parent.parent;p.publicRightLabel.set("text",X.call(q,this.value));},_set_value:function(w,q){var r=this.value,p=(r!==q);if(p){if(q===-1){var u=this.parent.parent.parent,t=this;u.openPopup("customACL",{zIndex:u.zIndex+10,rgt:r,twoStates:true,onOK:function(){t.set("value",this.getACLValue());},onCancel:function(){t.set("value",r);}});return false;}q=D(q);q=H(q);M(this,q);this.updatePublicRight(q);return true;}return true;},updatePublicRight:function(q){var r=this.parent.parent.parent;if(r.aclList){var t=r.aclList.items;var p=h.find(t,"did",R);var u=h.find(t,"did",F);if(Z&&p!==-1){t[p].rgt=q;}if(u!==-1){t[u].rgt=q;}r.set("hasChanged",true);r.set("currentPublicRight",q);}}}]}]},{scriptClass:"mstrmojo.Label",alias:"userMessage",text:mstrmojo.desc(9771,"The permission you added is already granted"),cssClass:"sharingEditorUserMessage hideMsg",bindings:{visible:"this.parent.showACL"},onclick:function(){C.addClass(this.domNode,"hideMsg");n=false;}},{scriptClass:"mstrmojo.DataGrid",alias:"aclList",cssClass:"aclList",renderOnScroll:false,makeObservable:true,itemDisplayField:"n",itemIdField:"did",dropZone:true,bindings:{items:function(){return this.parent.oi.acls||[];},visible:"this.parent.showACL"},onremove:function(q){var v=this.parent.oi;var u=this;window.setTimeout(function(){u.updateScrollbars();},10);if(!P(v)){return ;}var w=v.inhs,t=q.value,p=t&&t.length,x,r;for(r=0;r<p;r++){x=t[r].n;delete w[x];}},onadd:function(q){var v=this.parent.oi;var u=this;window.setTimeout(function(){u.updateScrollbars();},10);if(!P(v)){return ;}var w=v.inhs,t=q.value,p=t&&t.length,x,r;for(r=0;r<p;r++){x=t[r].n;w[x]=mstrmojo.hash.copy(t[r]);w[x].inh=true;}},onACLChanged:function(q){var p=this.parent.oi;this.parent.set("hasChanged",true);if(!P(p)){return ;}p.inhs[q.n]=mstrmojo.hash.copy(q);p.inhs[q.n].inh=true;},columns:[{dataFunction:function(r,p,q){return'<div class="mstrmojo-ACLEditor-user '+(r.st===8705?"ug":"u")+'">'+mstrmojo.string.encodeHtmlString(r.n)+"</div>";}},{dataWidget:{scriptClass:"mstrmojo.MouseOverContainer",alias:"mouseOverContainer",bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}},children:[{scriptClass:"mstrmojo.Label",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){return X.call(mstrmojo.all[S],D(this.parent.parent.data.rgt));},enabled:function(){return L(this.parent.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-datagridContainer",visible:false,children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-datagridPulldown",itemIdField:"rgt",popupToBody:true,selectionPolicy:"reselect",popupZIndex:1001,postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var p=this.parent.parent.data;this.set("value",p[this.itemIdField]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(!this.visible&&this.popupRef){this.popupRef.set("visible",false);}}},mstrmojo.hash.copy(this.markupMethods));this.items=this.parent.parent.dataGrid.parent.getAvailableRightsForSelection();},_set_value:function(w,q){var r=this.value,p=(r!==q);if(p){if(q===-1){var u=this.parent.parent.dataGrid.parent,t=this;u.openPopup("customACL",{zIndex:u.zIndex+10,rgt:r,twoStates:!!this.parent.parent.data.newItem,onOK:function(){t.set("value",this.getACLValue());},onCancel:function(){t.set("value",r);}});return false;}q=D(q);q=I(q);M(this,q);this.parent.parent.data.set(this.itemIdField,q);if(r!==null){this.parent.parent.dataGrid.onACLChanged(this.parent.parent.data);}return true;}return true;},bindings:{enabled:function(){return L(this.parent.parent.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(p){var q=this,r=function(){var t=q.parent.parent.dataGrid;t.remove(q.parent.parent.data);t.parent.set("hasChanged",true);};mstrmojo.confirm(mstrmojo.desc(12299,"Are you sure you want to delete the user/user group #?").replace("#",this.parent.parent.data.n),{confirmBtn:{fn:r}},{zIndex:2000});},bindings:{enabled:function(){return L(this.parent.parent.parent.parent.parent.oi);}}}]}]}}]},{scriptClass:"mstrmojo.Box",cssClass:"sharingEditor-ACLUserPanel",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-CPSection",children:[{scriptClass:"mstrmojo.ACL.UserInputBox",emptyText:mstrmojo.desc(9151,"Type users or groups here."),getACLUserDataService:function d(){return this.parent.parent.parent.getACLUserDataService();},noCache:true,postCreate:function(){var p=this.parent.parent.parent;if(p){this.zIndex=p.zIndex+1;}},onRender:function(){var p=this.parent.parent.parent;if(p){p.objectInputer=this;}},bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",itemIdField:"rgt",value:199,defaultSelection:0,selectionPolicy:"reselect",onRender:function(){var p=this.parent.parent.parent;if(p){p.rightPulldown=this;}},postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},_set_value:function(w,q){var r=this.value,p=(r!==q);if(p){if(q===-1){var u=this.parent.parent.parent,t=this;u.openPopup("customACL",{zIndex:u.zIndex+10,rgt:r,twoStates:true,onOK:function(){t.set("value",this.getACLValue());},onCancel:function(){t.set("value",r);}});return false;}q=H(q);M(this,q);return true;}return true;},bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}}},k(mstrmojo.desc(2156,"Add"),function(p){var q=this.parent.parent.parent;g(q);},{bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}}}),k(mstrmojo.desc(1825,"Browse"),function(p){var q=this.parent.parent.parent;q.openPopup("userSelector",{zIndex:q.zIndex+10});},{bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}}})]}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9892,"Children Access"),cssClass:"SharingEditor-title",bindings:{visible:function(){return this.parent.showACL&&P(this.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",alias:"childrenAccessPulldown",value:0,items:[{n:mstrmojo.desc(9890,"Preserve children's access control lists"),idx:0},{n:mstrmojo.desc(9891,"Overwrite children's access control lists"),idx:1}],itemIdField:"idx",bindings:{visible:function(){return this.parent.showACL&&P(this.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"Editor-buttonBox",slot:"buttonNode",bindings:{visible:"this.parent.showButtonBar"},children:[c(mstrmojo.desc(9099,"Share"),function(p){var q=this.parent.parent;if(g(q)){f(q,q.closeEditorAfterSave);}},true,{iconClass:"mstrmojo-Editor-button-OK",bindings:{visible:"this.parent.parent.showACL",enabled:function(){return L(this.parent.parent.oi)&&this.parent.parent.hasChanged;},text:function(){return this.parent.parent.saveButtonText||mstrmojo.desc(9099,"Share");}},preBuildRendering:function(){if(!this.parent.parent.showButtonText){this.set("text","");}}}),c("",function(p){var q=this.parent.parent;q.close();q.set("hasChanged",false);},false,{iconClass:"mstrmojo-Editor-button-Close",bindings:{iconClass:function(){var p=this.parent.parent;if(p.hasChanged){return"mstrmojo-Editor-button-Cancel";}return"mstrmojo-Editor-button-Close";},text:function(){var p=this.parent.parent;if(!p.showButtonText){return"";}if(p.hasChanged){return mstrmojo.desc(2140,"Cancel");}return mstrmojo.desc(2102,"Close");}}})]}]});mstrmojo.MouseOverContainer=mstrmojo.declare(mstrmojo.StackContainer,null,{scriptClass:"mstrmojo.MouseOverContainer",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',doSwitch:true,markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onmouseover:function(){if(this.doSwitch&&this.enabled){this.set("selected",this.children[1]);}},onmouseout:function(){if(this.doSwitch){this.set("selected",this.children[0]);}},preBuildRendering:function(){this.set("selected",this.children[0]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Button","mstrmojo.Editor","mstrmojo.ME.MetricDataService","mstrmojo.ME._MetricEditorHelper");mstrmojo.requiresDescs(12852);var J=mstrmojo.expr,A=mstrmojo.array,G=mstrmojo.hash,M=mstrmojo.ME._MetricEditorHelper,B=mstrmojo.ME.Enum.DYNAMIC_DIMTY,L=mstrmojo.ME.Enum.UI_DATA_TYPE,I=mstrmojo.ME.Enum.UI_OBJECT_TYPE,F=mstrmojo.ME.MetricToken.brackets;var K;function Q(){var E=mstrmojo.all[K];if(E&&E.onmetricModify){E.onmetricModify();}}function C(){var E=mstrmojo.all[K];if(E&&E.updateScrollbars){E.updateScrollbars();}}mstrmojo.ME.SortByInputList=mstrmojo.declare(mstrmojo.WidgetList,null,{makeObservable:true,isNewDef:true,isDME:false,init:function R(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ME-sortby");},preBuildRendering:function(){var E=this.items||[];if(this.isNewDef&&this.isDME){E.push(B.getAutomaticDimtyObject());}E.push({n:""});this.items=E;if(this._super){this._super();}},getTokens:function(){var W=this.items,E=W.length-1,V,a=[];if(E>0){a.push({v:"SortBy"});a.push({v:"=",isDelimiter:true});a.push({v:"(",isDelimiter:true});for(V=0;V<E;V++){var Y=W[V],Z=Y.selFrm,U,X=false;if(M.isDimty(Y.n)){U={v:Y.n};X=true;}else{if(/^@/.test(Y.did)){U={v:Y.did};X=true;}else{U={v:F(Y.n),oi:Y};}}if(Z&&(Y.t===J.TP.ATTR||(Y.t===J.TP.CONS&&Y.st===J.STP.NDE))){G.copy({v:F(Y.n)+"@"+F(Z.n),exv:Z.dssid,extp:8},U);}a.push(U);if(!X){if(!!Y.asc){a.push({v:"Desc",tp:259});}}if(V!==(E-1)){a.push({v:",",isDelimiter:true});}}a.push({v:")",isDelimiter:true});}return a;},itemFunction:function(X,E,U){return new mstrmojo.Box({cssClass:"mstrmojo-ME-sortby-item",alias:"sortByItem",parent:U,children:[{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"sortByInput",cssClass:"mstrmojo-ME-ObjectInputBox-sortby",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),isDME:U.isDME,dtp:L.Sortby,maxObjectCount:1,folderLinksContextId:16,browsableTypes:[J.TP.ATTR,J.TP.METRIC,J.TP.FOLDER].join(","),getCandidatesThroughTaskCall:function Z(c,b){c.objectType=J.TP.ATTR+","+J.TP.METRIC;c.rootFolderType=39;c.blockCount=c.blockCount||this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(c,b);},obCfg:{folderLinksContextId:16,browsableTypes:[J.TP.ATTR,J.TP.METRIC,J.TP.FOLDER].join(",")},bindings:{candidates:"this.parent.parent.candidates"},postCreate:function(b){if(!b){this.set("items",X.did||X.dimty?[X]:null);}},onitemchange:function(){var d=this.getSelectedObjects()[0];if(!d||!d.did&&!d.n){return ;}X.selFrm=null;mstrmojo.hash.copy(d,X);var c=this.parent.formsPulldown;if(c){c.updateForms(d);}var b=this.parent.ascPulldown;if(b){b.set("visible",X.t===4||X.st===J.STP.NDE);}Q();},onadd:function V(){if(this.getSelectedObjects().length===0){return ;}if(this.parent===U.ctxtBuilder.itemWidgets[U.items.length-1]){U.add([{n:""}]);this.parent.del.set("visible",true);}},hidePulldownButton:function(){return !U.isDME;},hideDelButton:function(){return true;},hideItemWidgetBrowseButton:function(){return U.isDME;},getItemsToFilterOut:function(){return U.items;}},{scriptClass:"mstrmojo.Pulldown",alias:"formsPulldown",cssClass:"mstrmojo-ME-sortby-forms mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",defaultSelection:-1,bindings:{visible:function(){return this.items&&this.items.length>0;}},popupToBody:true,popupZIndex:100,postCreate:function(){this.retrieveDssForms(X);},retrieveDssForms:function W(d){var c=this,b=function(){var m=function(n){d.dssforms=n;c.set("items",d.dssforms);c.selectedIndex=-1;c.selectedItem=null;c.value=null;c.set("value",d.selFrm);};var k=c.parent.sortByInput.candidates,e=k&&k.items;if(d.did&&e){var h=A.find(e,"did",d.did);if(h>-1){var g=mstrmojo.hash.clone(e[h].fs);if(g){A.forEach(g,function(n){n[c.itemIdField]=n.fid;n[c.itemField]=n.fnm;});m(g);return ;}}}var l=function(n){if(n){var o=n.container;if(o&&o.dssforms){d.dssforms=o.dssforms;m(d.dssforms);}}},f=function(n){mstrmojo.alert(n.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getAttributeForms({attributeID:d.did,displayedForms:0},{success:l,failure:f});};switch(d.t){case J.TP.ATTR:b();break;case J.TP.CONS:if(d.st===J.STP.NDE){c.set("visible",false);}break;case J.TP.METRIC:c.set("visible",false);break;case I.Dimty:c.set("visible",false);break;}},updateForms:function Y(b){this.retrieveDssForms(b);},onvalueChange:function a(){if(this.selectedItem){X.selFrm=this.selectedItem;}if(this.hasRendered){Q();}}},{scriptClass:"mstrmojo.Pulldown",alias:"ascPulldown",cssClass:"mstrmojo-ME-sortby-asc mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:[{n:"Ascending",v:0},{n:"Descending",v:1}],itemIdField:"v",popupToBody:true,popupZIndex:100,visible:false,bindings:{value:function(){return this.parent.parent.items[E].asc;},visible:function(){var b=this.parent.sortByInput.getSelectedObjects()[0];return this.parent.formsPulldown.visible&&this.parent.formsPulldown.value||b.t===J.TP.METRIC||b.st===J.STP.NDE;}},onvalueChange:function(b){X.asc=this.value;if(this.hasRendered){Q();}}},{scriptClass:"mstrmojo.Button",alias:"del",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),bindings:{visible:function(){var b=U.itemIndex(X);return this.parent.parent.items[b].did;}},onclick:function(){U.remove(U.items[U.itemIndex(X)]);Q();}}]});},onadd:function H(){C();},onremove:function S(){C();}});mstrmojo.ME._HasSortBy=mstrmojo.provide("mstrmojo.ME._HasSortBy",{_mixinName:"mstrmojo.ME._HasSortBy",ios:false,oniosChange:function P(E){this.sortByContainer.set("visible",E.value);},onOpen:function(){if(this._super){this._super();}K=this.id;var U=this.oi.tks,V=!U.met;var E=this.sortByContainer&&this.sortByContainer.sortByWidgetList;if(E){E.set("isNewDef",V);E.set("isDME",this.isDME);E.set("candidates",this.getCandidates4Sortby());E.set("items",this.getSortByDefFromTokens().items||[]);}},getCandidates4Sortby:function T(){var U=this.candidates,E;if(U&&!this.noCache){E=A.filter(U.items,function(V){return V.t===J.TP.ATTR||V.t===J.TP.METRIC||V.st===J.STP.NDE;});if(this.isDME){E=B.getItems("sortby").concat(E);}}return{items:E||[],isComplete:U&&U.isComplete};},getSortByWidget:function D(E){var W=this,V=[{scriptClass:"mstrmojo.ME.SortByInputList",alias:"sortByWidgetList",cssClass:"sortBy mstrmojo-ME-sortby",cssDisplay:"table-cell"}],U={scriptClass:"mstrmojo.Label",alias:"sortByLabel",cssClass:"mstrmojo-ME-SortBy-label",cssDisplay:"table-cell",text:mstrmojo.desc(12852,"Sort By")};if(E){V.unshift(U);}return{scriptClass:"mstrmojo.Box",alias:"sortByContainer",cssClass:"mstrmojo-ME-SortBy-Container",cssDisplay:"table-row",visible:W.ios,postCreate:function(){W.sortByContainer=this;this.editor=W;},getTokens:function(){return this.sortByWidgetList.getTokens();},children:V};},getSortByDefFromTokens:function N(){var a=this.oi.tks.items,W=a.length,b,Y,U,V,X={};for(V=0;V<W;V++){b=a[V];Y=b.tp;U=b.sctt;if(mstrmojo.ME.MetricToken.isDelimiter(b.v)&&(b.v!=="("&&b.v!==")")||b.v==="&gt;"||b.v==="&lt;"){continue;}switch(U){case 131072:if(Y===302){b=a[++V];while(b){if(b.tp!==282){if(b.oi){b.oi.selFrm=b.exv;var Z=a[V+1];if(Z.v==="Desc"&&Z.tp===259){b.oi.asc=1;V++;}X.items=X.items||[];X.items.push(b.oi);}else{if(b.tp===64){X.items=X.items||[];var E=b.v+a[++V].v;b=a[V+1];if(b.tp===43||b.tp===45){E+=a[++V].v;E+=a[++V].v;}X.items.push(B.getDimtyObject(E,this.isDME));}}}if((b=a[++V])["v"]===")"){break;}}}}}return X;},getSortByDefAsTokens:function O(){return this.sortByContainer.getTokens();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ObjectInputBox","mstrmojo.ME.MetricDataService","mstrmojo.ME._MetricEditorHelper","mstrmojo.ui.ScrollableSuggestionList");var H=mstrmojo.expr,O=mstrmojo.Enum_OIB_States,J=mstrmojo.ME._MetricEditorHelper,R=mstrmojo.dom;mstrmojo.ME.ObjectInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{cssClass:"",autoSelect:false,suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",suggestionPopupCssClss:"mstrmojo-ME-ObjectInputBox-suggest",blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,useKeyDelay:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,emptyText:"Search for an object",showEmptyItem:false,noEditButton:true,browseItemVisible:true,click2edit:true,showSuggestionOnEdit:false,tabNavigable:true,obCfg:{},dynamicVerify:true,init:function P(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ME-ObjectInputBox");if(this.isDME){this.browseItemVisible=!this.isDME;this.suggestCount=this.isDME?1000:mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=1000;this.dynamicVerify=false;}},item2textCss:function D(W){if(this.isDME){return mstrmojo.ME._MetricEditorHelper.item2textCss(W);}var E=this._super(W)||{1:"f",4:"m",12:"a",13:"fc",43:"tr","-1":"rl","-99":"br"}[W.t]||"";return E?" icn "+E:"";},itemFunction:function B(X,E,W,Y){X[W.itemIdField]=W.nextId();var Z=Y||mstrmojo.ME.ObjectItem,a=new Z({parent:W,itemField:W.itemField,cssClass:W.item2textCss(X),data:X,bindings:{isFull:"this.parent.isFull"},onisFullChange:function(){if(this.hasRendered){this.updateButtonsVisibility();}}});W.attachEventListener4ItemWidget(a,W);return a;},getActiveItem:function M(){var E=this.editingIdx,X,W;if(E>-1){X=this.ctxtBuilder.itemWidgets[E];W=X&&X.data;}return W;},showObjectBrowser:function(E){this.set("suggestTarget",E);this.handleSuggestionItemSelect({t:-99},this.obCfg);},hideItemWidgetBrowseButton:function S(){return false;},hidePulldownButton:function G(){return true;},hideDelButton:function A(){return false;},dtp:0,verifyObject:function C(W,E){if(!this.dynamicVerify){return O.VALID;}var Y=E.data;var X=parseInt(this.dtp,10);switch(X){case -1:case -2:case -4:case -5:case -6:if(Y.t===-1||J.isDimty(W,X===-1)){return O.VALID;}if(this.dynamicVerify){return this._super(W,E);}return Y.did?O.VALID:O.INVALID;case 1:case 2:case 3:case 4:case 5:case 6:case 7:if(Y.t<0){return O.VALID;}if(/^\d{1,}$/.test(mstrmojo.string.trim(W))||Y.did){return O.VALID;}if(this.dynamicVerify){return this._super(W,E);}return O.INVALID;default:return O.VALID;}},getItemsToFilterOut:function N(){return this.items;},updateSuggestion:function Q(E){var X=this.getActiveItem();var W=this.getItemsToFilterOut();E=mstrmojo.array.filter(E,function(a){var Z=a.did,Y=false,c;var b=function(d){mstrmojo.array.forEach(W,function(e){if(e!==X&&e.did===d){Y=true;return false;}});};b(Z);if(!Y){c=a;}return c;});if(this._super){this._super(E);}},nudge:function I(W){W.domNode.style.minWidth=this.suggestTarget.domNode.offsetWidth+(this.isDME?13:0)+"px";var X=R.position(W.domNode),Y=R.position(this.suggestTarget.domNode),E=R.windowDim();if(X.y+X.h>E.h){W.domNode.style.top=(Y.y-X.h-5)+"px";}}});mstrmojo.ME.ObjectItem=mstrmojo.declare(mstrmojo.ObjectItem,[mstrmojo._HasPopup],{markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode" tabindex="0" mstrAttach:click,focus><span class="mstrmojo-ObjectItem-text {@cssClass}"></span></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" placeholder="{@placeholderText}" mstrAttach:keyup,keydown/></div><div class="mstrmojo-ObjectItem-icons"><div class="mstrmojo-ObjectItem-down" onclick="mstrmojo.all[\'{@id}\'].showSuggestion(\'\')"></div><img class="mstrmojo-ObjectItem-browse" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1825,"Browse")+'" onclick="mstrmojo.all[\'{@id}\'].browse()"/><div class="mstrmojo-ObjectItem-opts" title="'+mstrmojo.desc(9598,"Level options")+'" onclick="mstrmojo.all[\'{@id}\'].options(arguments[0])" style="display:none;"></div><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])" style="display:none;"/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},pulldownButtonNode:function(){return this.domNode.lastChild.childNodes[0];},browseButtonNode:function(){return this.domNode.lastChild.childNodes[1];},optionButtonNode:function(){return this.domNode.lastChild.childNodes[2];},editButtonNode:function(){return this.domNode.lastChild.childNodes[3];},delButtonNode:function(){return this.domNode.lastChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},init:function P(E){this._super(E);this.placeholderText=this.parent.emptyText;},initState:function T(){var W=this.parent,X=this.data,E=X.state;if(W.dynamicVerify){return this._super();}if(typeof E==="undefined"){E=W.verifyObject(X[this.itemField],this);X.state=E;}return E;},updateButtonsVisibility:function F(){if(this._super){this._super();}if(this.parent.hidePulldownButton()){this.pulldownButtonNode.style.display="none";}if(this.parent.hideItemWidgetBrowseButton()){this.browseButtonNode.style.display="none";}this.optionButtonNode.style.display=this.data.state!==O.ADDING&&this.optionButtonVisible?"":"none";this.delButtonNode.style.display=this.data.state!==O.ADDING&&!this.parent.hideDelButton()&&!this.isFull?"":"none";},browse:function L(){this.set("state",this.data.state===O.ADDING?O.ADDING:O.EDITING);this.parent.showObjectBrowser(this);},click2edit:function K(){if(this.parent.click2edit){this.edit();}},onclick:function V(){this.click2edit();},onfocus:function U(){this.click2edit();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.TokenInputBox","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.range","mstrmojo.ME.MetricToken","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.AttributeEditBox");var L=mstrmojo.dom,E=mstrmojo.range,B=E.EDGE,F=mstrmojo.hash,O=mstrmojo.css,H=mstrmojo.mstr.EnumDSSXMLObjectTypes,K=mstrmojo.ME.AttributeEditBox.prepareInsertToken;var N=["{","}"],J=null;function D(S){if(!J){J={};var R,Q;for(R=0,Q=N.length;R<Q;R++){J[N[R]]=true;}}return J.hasOwnProperty(S);}mstrmojo.ME.DynamicLinkTokenInputBox=mstrmojo.declare(mstrmojo.ME.TokenInputBox,[],{isDelimiter:D,itemFunction:function I(S,Q,R){return new mstrmojo.ME.MetricToken({data:S,parent:R,isDelimiter:function(){return this.data.isDelimiter||(this.length()===1&&D(this.data.v));}});},ondrop:function(U){var T=U.src.data,Q=T&&T.item;if(!Q){return ;}var X=F.copyProps(["did","n","t","fs"],Q);var S=K(X);var V=[S];if(X.t===H.Attribute&&S.ift&&S.exv){V=[{v:"{",isDelimiter:true,isNew:true}].concat(V).concat([{v:"}",isDelimiter:true,isNew:true}]);}var Y=this.insertTokens(V);if(this.parent.ontokensModify){this.parent.ontokensModify();}this.set("dropCuePos",null);if(X.t===H.Attribute&&S.ift&&!S.exv){var W=this.ctxtBuilder.itemWidgets||[],R=W[Y];if(R){this.startTokenSuggestion(R);}}this.clearSelect(true);O.removeClass(this.domNode,"unselectable");},insertLeftCurlyBraces:function P(R){var Q=this;window.setTimeout(function(){var S=Q.insertTokens([{v:"{",isDelimiter:true,isNew:true}]);Q._delaySetCaretPos(Q.itemsContainerNode.childNodes[S+1],false);},R||50);},insertRightCurlyBraces:function C(R){var Q=this;window.setTimeout(function(){var S=Q.insertTokens([{v:"}",isDelimiter:true,isNew:true}]);Q._delaySetCaretPos(Q.itemsContainerNode.childNodes[S],false);Q._delaySetTextCaretPos(Q.itemsContainerNode.childNodes[S],1);},R||50);},onSuggestionItemSelect:function A(T){var R=this._saveActiveToken;var S=true;this.endTokenSuggestion();if(R){if(R.data.ift&&T.t===H.AttributeForm){var Q=this.itemIndex(R.data);if(this.items[Q-1]&&this.items[Q-1].v==="{"&&this.items[Q+1]&&this.items[Q+1].v==="}"){S=false;}R.setFormInfo(T);if(S){this.insertLeftCurlyBraces();this._delaySetCaretPos(R.domNode,true);var U=this;window.setTimeout(function(){U._delaySetCaretPos(R.domNode,false);U.insertRightCurlyBraces();},50);}else{this._delaySetCaretPos(R.domNode,false);}}else{R.setItemInfo(T);this._delaySetCaretPos(R.domNode,false);}}this.closePopup();},handlemouseup:function G(Q){this.raiseEvent({name:"tokenInputBoxSelected"});this._super(Q);},widgetHandleInput:function M(V,W){if(!V.collapsed){this.widgetDeleteTokens(V);V=E.getRangeInfo();}var S,X,Y,Z,Q,R,T=this.ctxtBuilder.itemWidgets;if(!L.contains(this.editNode,V.startContainer,false,document.body)){this.add([{v:W,isDelimiter:this.isDelimiter(W),isNew:true}],0);X=T[0];E.collapseOnTextNode(X.domNode,1);return ;}S=E.getEdgeInfo(V.startContainer,V.startOffset);X=L.findWidget(V.startContainer);Y=this.itemIndex(X.data);if(this.isDelimiter(W)){Z={v:W,isDelimiter:true,isNew:true};if(S===B.EDGE_MIDDLE){var U=X.split2Tokens(V.startOffset);this.remove(Y);if(W==="{"){this.add([U[0],Z,{v:"}",isDelimiter:true,isNew:true},U[1]],Y);}else{this.add([U[0],Z,U[1]],Y);}Y=Y+1;}else{Y=(S===B.EDGE_BEGIN)?Y:Y+1;if(W==="{"){this.add([Z,{v:"}",isDelimiter:true,isNew:true}],Y);}else{this.add([Z],Y);}}X=T[Y];E.collapseOnNode(X.domNode,false);}else{R=V.startOffset;if(X.isDelimiter()){Q=T[(S===B.EDGE_BEGIN)?Y-1:Y+1];if(Q&&!Q.isDelimiter()){X=Q;R=(S===B.EDGE_BEGIN)?X.length():0;}}if(!X.isDelimiter()){X.spliceContent(R,0,W);E.collapseOnTextNode(X.domNode,R+1);}else{this.add([{v:W,isNew:true}],(S===B.EDGE_BEGIN)?Y:Y+1);X=T[(S===B.EDGE_BEGIN)?Y:Y+1];E.collapseOnNode(X.domNode,false);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.ValidationTextBox","mstrmojo.ME.AttributeEditBox");mstrmojo.requiresDescs(2399,2400,11569,11617);var E=mstrmojo.desc,F=mstrmojo.Button.newWebButton;function B(R,Q){R.set("enabled",!Q);R.set("iconClass",R.iconClass.replace(/mstrmojo-InlineWaitIcon/,"")+" "+(Q?"mstrmojo-InlineWaitIcon":""));}function A(Q){var R={isComplete:true,items:[].concat(Q.candidates.items)};R.items.push({n:"This",did:"This",t:12});R.items.push({n:"ID",did:"ID",attid:"This",attn:"This",fmdid:"ID",t:21});Q.descCandidates=R;}function P(Q,R){if(Q&&R){R.candidates=null;R.set("candidates",Q);}}function K(Q){if(Q.oi&&Q.oi.alias){return ;}Q.tmr=window.setInterval(function(){if(Q.visible&&Q.domNode){window.clearInterval(Q.tmr);delete Q.tmr;Q.nameEditBox.nameInput.inputNode.select();}},50);}mstrmojo.ME.DerivedAttributeEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.DerivedAttributeEditor",cssClass:"mstrmojo-DAEditor",zIndex:10,help:"derived_attribute_editor.htm",useKeyDelay:true,noCache:false,name:"New Attribute",init:function O(Q){if(this._super){this._super(Q);}A(this);},getAttributeEditBox:function C(){return this.attrEditBox;},getTokenInputBox:function G(){return this.attrEditBox.inputBox;},onObjectInsert:function I(Q){this.getAttributeEditBox().onObjectInsert(Q);},onOpen:function D(){var S=this,R=this.oi,U=R.alias||R.n||"New Attribute",Q=this.attrEditBox,T=Q.inputBox;P(S.candidates,T);T.noCache=this.noCache;T.useKeyDelay=this.useKeyDelay;this.set("title",E(9559,"Formula Editor:")+" "+R.n);this.set("name",U);this.set("nameLabel",R&&R.alias?E(2326,"Display Name"):E(11617,"Attribute Name"));if(R&&R.forms){Q.set("attrid",R.did);Q.set("forms",R.forms);Q.selectFormTab(0);}Q.set("cValid",R&&R.forms);K(this);},onClose:function M(){if(this._super){this._super();}this.clear();},handleValidation:function L(Q){this.attrEditBox.handleValidation(Q);},save:function J(){var U=this.parent.id,a=this.oi,T=this.buttonBar.saveBtn,Y=this.attrEditBox,Q=a.dsid,S=a.did,V,X=this.oncreate,R=this.onupdate,d=this.nameEditBox.nameInput.value,c={success:function b(){B(T,false);Y.clear();var e=mstrmojo.all[U];if(e){e.close();}}},Z=function(f){if(f&&X){var e=[],g;for(g=0;g<f.length;g++){e.push({n:f[g].n,formula:f[g].tokenXML});}V={act:"addDAToDataset",dsid:Q,name:d,isTokenStream:true,forms:e};X(V,c);}else{B(T,false);}},W=function(e){if(e&&R){var h=[],l=[],g=[],m,k,f;for(f=0;f<e.length;f++){m=e[f];k={n:m.n,formula:m.tokenXML};if(m.did){k.did=m.did;g.push(k);}else{h.push(k);}}for(f=0;Y.delForms&&f<Y.delForms.length;f++){m=Y.delForms[f];l.push({n:m.n,did:m.did});}V={act:"updateDA",name:d,dsid:Q,attrId:S,isTokenStream:true,add:h,del:l,update:g};R(V,c);}else{B(T,false);}};if(Y.dirty||d!==(a.alias||a.n)){B(T,true);Y.validateAllForms(!S?Z:W);}else{c.success();}},clear:function H(){var Q=this.attrEditBox;this.name=null;Q.clear();},children:[{scriptClass:"mstrmojo.Box",alias:"nameEditBox",cssClass:"mstrmojo-ME-nameEditBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-DA-nameLabel",bindings:{text:"this.parent.parent.nameLabel"}},{scriptClass:"mstrmojo.ValidationTextBox",alias:"nameInput",cssClass:"mstrmojo-ME-nameInput",size:20,tooltipOpenDelay:0,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,invalidCssClass:"mstrmojo-ME-invalidName"},prefocus:function(){if(this._super){this._super();}this.validate();},validate:function(Q){Q=Q||this.value;var R=Q&&!/[\[\]\"\\]/g.test(Q);this.valid=null;this.set("valid",R);this.set("validationStatus",{code:R?0:1});return R;},showErrTooltip:function N(){var Q=mstrmojo.dom.position(this.domNode),S=mstrmojo.string.isEmpty(this.value)?mstrmojo.desc(9122,"Name cannot be empty"):mstrmojo.desc(11569,"Input contains invalid character");this.useRichTooltip=true;this.richTooltip={contentNodeCssClass:"me-tooltip-content left me-err",content:'<div class="content"><span>'+S+"</span></div>",top:Q.y-5,left:Q.x+Q.w+10};this.showTooltip();var R=this;window.setTimeout(function(){R.hideTooltip();},1500);},valid:true,onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.set("validationStatus",1);this.showErrTooltip();}mstrmojo.css.toggleClass(this.parent.domNode,"err",!this.valid);},bindings:{value:"this.parent.parent.name"}}]},{scriptClass:"mstrmojo.ME.AttributeEditBox",alias:"attrEditBox",browseItemVisible:false,cValid:false,ontabSwitch:function(R){var Q=this.parent;P(R.nidx>0?Q.descCandidates:Q.candidates,this.inputBox);if(Q.parent&&Q.parent.onformsTabSwitch){Q.parent.onformsTabSwitch(R);}},ontokensModify:function(){this.set("cValid",this.inputBox.items.length>0);this.set("dirty",true);},isObjectVisible:function(R){var T=mstrmojo.all.mstrDerivedAttrIDE;var S=T.candidates.all;var Q=mstrmojo.array.find(S,"did",R.did);if(Q>-1){return T.isObjectVisible(S[Q]);}return true;}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[F(E(2400,"Save"),function(){var Q=this.parent.parent;Q.save();},true,{alias:"saveBtn",bindings:{enabled:"!!(this.parent.parent.nameEditBox.nameInput.valid && this.parent.parent.attrEditBox.cValid)"}}),F(E(2399,"Cancel"),function(){var Q=this.parent.parent,R=Q.parent;Q.clear();R.close();})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.ui.menus.ToolbarConfig","mstrmojo.ui.menus.Menu","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.css,C="visible",G="containerNode";function E(Q){Q.btn.style.display=!!Q.menuCfg?"block":"none";}mstrmojo.vi.ui._IsPanel=mstrmojo.provide("mstrmojo.vi.ui._IsPanel",{_mixinName:"mstrmojo.vi.ui._IsPanel",markupString:'<div id="{@id}" class="mstrmojo-VIPanel {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="mstrmojo-VIPanel-titlebar"></div><div class="mstrmojo-VIPanel-content"></div><div class="mstrmojo-VIDND-mask"></div><div class="mstrmojo-VIPanel-handle splitter v"></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.childNodes[2];},handleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onisCollapsedChange:function L(){if(this.canCollapse){this.containerNode.style.display=this.isCollapsed?"none":"block";if(!this.isCollapsed){this.doLayout();}}}},title:"",titleBar:null,titlebarNode:null,containerNode:null,maskNode:null,handleNode:null,bubbleMouseOver:true,canCollapse:false,isCollapsed:false,autoHideToolbar:false,init:function K(Q){this._super(Q);this.addChildren([this.getTitleBarCfg()]);this.menuBtnInfo={};},skipsSlotLayout:function(Q){return Q===G&&this.isCollapsed;},getTitleBarCfg:function P(){return{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",slot:"titlebarNode",alias:"titleBar",isCollapsed:this.isCollapsed,title:this.title,close:function(){this.parent.setOpenStatus(false);mstrApp.rootCtrl.generateToolbar();},collapse:function(Q){this.parent.set("isCollapsed",Q);}};},ontitleChange:function H(){this.titleBar.set("title",this.title);},_set_children:function A(T,R,Q){if(R!==this.children){var S=this.titleBar;if(S){R.push(S);}}return this._super(T,R,Q);},preBuildRendering:function I(){this.generateToolbar();this.titleBar.setToolbarVisibility(!this.autoHideToolbar);return this._super();},generateToolbar:function B(){var Q=this.titleBar;Q.set("toolbarCfg",this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));if(!Q.visible){this.menuBtnInfo.menuCfg=Q.getMenuConfig();}},updateToolbar:function O(Q){return Q;},setOpenStatus:function N(Q){if(this.visible!==Q){this.set("visible",Q);this.parent.doLayout();}},setTitleBarVisibility:function D(Q){var S=this.titleBar;S.set("visible",Q);this.generateToolbar();var T=this.menuBtnInfo,R=T.btn;if(!R){R=T.btn=document.createElement("div");R.className="hover-menu-btn";var U=this.id;mstrmojo.dom.attachEvent(R,"click",function(){var W=mstrmojo.all[U],V=T.menuCfg;V.hostId=U;V.hostElement=R;W.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:V}));});this.domNode.appendChild(R);}T.menuCfg=Q?null:S.getMenuConfig();E(T);this.doLayout();},onmouseover:function M(Q){if(!mstrApp.isInteractive()){return ;}if(!this.bubbleMouseOver){Q.cancel();}var S=this._panelTimeout;if(S){window.clearTimeout(S);delete this._panelTimeout;}if(this.autoHideToolbar){this.titleBar.setToolbarVisibility(true);}var R=this.menuBtnInfo;if(!!R.menuCfg){F.addClass(R.btn,C);}},onmouseout:function J(){var Q=this.id;this._panelTimeout=window.setTimeout(function(){var R=mstrmojo.all[Q];if(R){if(R.autoHideToolbar){R.titleBar.setToolbarVisibility(false);}var S=R.menuBtnInfo;if(!!S.menuCfg){F.removeClass(S.btn,C);}}},200);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui._IsUnitDependentPanel","mstrmojo.css");mstrmojo.vi.ui.VIBoxPropertyEditor=mstrmojo.declare(mstrmojo.vi.ui.BoxPanel,[mstrmojo.vi.ui._IsUnitDependentPanel,mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.VIBoxPropertyEditor",layoutConfig:{h:{controlNode:"25px",containerNode:"100%"},w:{controlNode:"all",containerNode:"all"},xt:true},init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-PropEditor");},onVIUnitSelected:function A(F){var E=F&&F.getEditorModel(),D=E&&E.getEditorContents();if(D){D.forEach(function(G){G.slot="containerNode";});this.contents.addChildren(D);this.generateToolbar();this.doLayout();}else{if(E&&E.getDelayedEditorContents){E.getDelayedEditorContents(this,F);}}},updateToolbar:function B(D){var F=this.targetUnit,E=F&&F.getEditorModel();this.addRenameTargetMenuItem(D);this.addHelpTopicMenuItem(D,mstrmojo.desc(1143,"Help"),E&&E.help);return this._super(D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBarWithRMCPopup","mstrmojo.vi.ui._IsUnitContainerTitleBar","mstrmojo.vi.ui.toolbars.TitleToolbar");function C(F,D,E){return[{scriptClass:"mstrmojo.vi.ui.toolbars.TitleToolbar",slot:F+"ToolNode",alias:D,visible:true,useRichTooltip:E}];}mstrmojo.vi.ui.VizBoxTitleBar=mstrmojo.declare(mstrmojo.vi.ui.TitleBarWithRMCPopup,[mstrmojo.vi.ui._IsUnitContainerTitleBar],{scriptClass:"mstrmojo.vi.ui.VizBoxTitleBar",leftToolbar:undefined,getLeftToolbarChildren:function A(){return C("left","leftToolbar",false);},getRightToolbarChildren:function B(){return C("right","tbToolbar",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton");var L=mstrmojo.emptyFn,I=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.gm.EnumCombinedLineStyle;var J={LINE_COLOR:"Clr",LINE_STYLE:"Style"},A={"1pt solid":E.THIN,"2pt solid":E.THICK,"1pt dashed":E.DASHED,"1pt dotted":E.DOTTED,none:E.NONE};function D(P,O){return C.copy(O,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"lineColor",slot:P,selectedValue:"#000000",postselectedValueChange:function(Q){if(this.propName){this.parent.parent.raiseFormatValueChange(this.propName,Q.value,Q.valueWas);}},postclick:function(Q){this.parent.parent.postclick(Q);}});}function K(P){return{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:true,showNoneOption:true,defaultSelectedIndex:3,propName:undefined,alias:"lineStyle",slot:P,postInit:function O(){var Q=["mstrmojo-ui-LineStyle"];if(!this.showNoneOption){Q.push("no-none");}mstrmojo.css.addWidgetCssClass(this,Q);(this.list.items||[]).forEach(function(R){R.v=(A[R.id]!==undefined?A[R.id]:A["not defined"]);});},onshowNoneOptionChange:function(Q){var R=["no-none"];if(!Q.value){mstrmojo.css.addWidgetCssClass(this,R);}else{mstrmojo.css.removeWidgetCssClass(this,R);}var S=this.hasRendered;if(S){this.refresh();}},postselectedValueChange:function(R){this._super();var Q=I.find(this.list.items,"id",R.value);if(Q===-1){Q=this.defaultSelectedIndex;}var S=this.list.items[Q].v;if(this.propName){this.parent.parent.setChildEnable(J.LINE_COLOR,S!==A.none);this.parent.parent.raiseFormatValueChange(this.propName,S,A[R.valueWas]);}},postclick:function(Q){this.parent.parent.postclick(Q);}};}mstrmojo.ui.editors.controls.LineConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.LineConfigGroup",propNames:undefined,postclick:L,hideColorControl:false,showGradient:false,showNoFillInColor:true,showAutomaticInColor:false,showNoneOption:true,lineColorAndStyle:undefined,lineTitle:undefined,init:function N(Q){this._super(Q);var O=[],R;O.push(K("col1Node"));if(!this.hideColorControl){O.push(D("col2Node",{showGradient:this.showGradient,showNoFill:this.showNoFillInColor,showAutomatic:this.showAutomaticInColor}));}else{R={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}var P=[];if(this.lineTitle&&this.lineTitle!==""){P.push(new mstrmojo.Label({text:this.lineTitle}));}P.push(C.copy(R,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"lineColorAndStyle",children:O}));this.addChildren(P);},getChildComp:function M(O){if(O.indexOf(J.LINE_COLOR)!==-1){return this.lineColorAndStyle.lineColor;}if(O.indexOf(J.LINE_STYLE)!==-1){return this.lineColorAndStyle.lineStyle;}return null;},iniChildrenComp:function G(P){I.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);var O=this.lineColorAndStyle.lineStyle;O.showNoneOption=this.showNoneOption;O.postInit();},onshowNoneOptionChange:function(O){this.lineColorAndStyle.lineStyle.set("showNoneOption",O.value);},setChildValue:function F(Q,R){var O=this.getChildComp(Q);if(O===undefined){return false;}var P;switch(O.alias){case"lineColor":if(R!==O.selectedValue){O.set("selectedValue",typeof R==="undefined"?"conflict":R);}break;case"lineStyle":if(typeof R==="undefined"){O.list.clearSelect();this.syncControls(function(){O.set("selectedValue","conflict");});}else{P=I.find(O.list.items,"v",R);if(P===-1){P=O.defaultSelectedIndex;}var S=O.list.items[P].id;if(S!==O.selectedValue){O.set("selectedValue",S);}}break;}},setChildEnable:function H(Q,P){var O=this.getChildComp(Q);if(O!==undefined){O.set("enabled",P);}},setChildrenValue:function B(O){O.forEach(function(P){this.setChildValue(P[0],P[1]);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.dom","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.css");var E=mstrmojo.css,F=mstrmojo.dom;mstrmojo.threshold.ColorBand=mstrmojo.declare(mstrmojo.ui.editors.controls.ColorPickerButton,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorBand",hovered:false,selected:false,index:undefined,showGradient:false,showNoFill:false,markupString:'<div class = "color-band mstrmojo-ui-PreviewButton {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:click,keyup,contextmenu,mouseover,mouseout><div class="host mstrmojo-ui-PreviewButton"></div></div>',markupSlots:{previewNode:function(){return this.domNode;},btnNode:function(){return this.domNode;},clickableNode:function(){return this.domNode;},widgetHostNode:function(){return this.domNode.lastChild;}},select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onhoveredChange:function C(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandHovered(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnhovered(this.index);}},onselectedChange:function B(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandSelected(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnselected(this.index);}this.parent.onBandUnhovered(this.index);},onmouseover:function H(){this.set("hovered",true);},onmouseout:function D(){this.set("hovered",false);},oncontextmenu:function G(I){F.preventDefault(window,I.e);var K=this,J=K.parent.parent;var L=new mstrmojo.ui.menus.MenuConfig({position:F.getMousePosition(I.e,I.hWin),isHostedWithin:false});L.addMenuItem(mstrmojo.desc(7604,"Change Color"),"",function(){K.onclick(I);});L.addMenuItem(mstrmojo.desc(13386,"Add Color Band"),"",function(){var N=J.markers;var O=F.position(N.containerNode),M=I.e.clientX-O.x;N.addMarker(M);});L.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){K.unselect();J.bands.remove(K.index);J.update();});this.openPopup(L.newInstance());},postselectedValueChange:function(J){var K=this.parent.parent,I=K.parent,M=K.getPalette().concat();if(J){var L=J.value;if(K.getReversedValue()){M.reverse();}this.backgroundColor=M[this.index]=L;I.switchToCustomScheme(undefined,M);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ColorBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onbackgroundColorChange:function A(){this.selectedValue=this.backgroundColor;this.updatePreview();this.colorPicker.set("color",this.selectedValue);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.hash","mstrmojo.array","mstrmojo.ValidationTextBox","mstrmojo.expr");var K=mstrmojo.emptyFn,B=mstrmojo.hash,H=mstrmojo.array,I=mstrmojo.expr.DTP,F={FILL_COLOR:"Clr",FILL_TRANSPARENT:"FillTrans"},C=1,J=2;function N(T,Q,P,S,R){return{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"fillColor",slot:T,showNoFill:S!==false,showAutomatic:!!R,showGradient:P!==false,selectedValue:"#000000",isHostedWithin:Q||false,postselectedValueChange:function(U){if(this.propName&&this.parent&&this.parent.parent){this.parent.parent.raiseFormatValueChange(this.propName,U.value,U.valueWas);}},postclick:function(U){this.parent.parent.postclick(U);}};}function O(Q){return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillAlpha",slot:Q,col1Width:"100%",col2Width:"10px",children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"fillAlphaText",slot:"col1Node",value:"100",cssText:"text-align:right",dtp:I.INTEGER,required:true,constraints:{min:0,max:100},onvalueChange:function(R){this.valueWas=R.valueWas;},onValid:function P(){if(this.propName&&this.value!==this.valueWas){this.parent.parent.parent.raiseFormatValueChange(this.propName,this.value,this.valueWas);}},postclick:function(R){this.parent.parent.parent.postclick(R);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:"%"}]};}mstrmojo.ui.editors.controls.FillConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.FillConfigGroup",propNames:undefined,postclick:K,visibleControls:C+J,fillColorAndTrans:undefined,init:function M(T){this._super(T);var Q=[],W="col1Node",R=T&&T.colorPickerHostWithin,P=T&&T.showGradient,V=T&&T.showNoFill,S=T&&T.showAutomaticInColor,U;if((this.visibleControls&C)>0){Q.push(N(W,R,P,V,S));W="col2Node";}if((this.visibleControls&J)>0){Q.push(O(W));}if(Q.length===1){U={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}this.addChildren([B.copy(U,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillColorAndTrans",children:Q})]);},getChildComp:function L(P){if(P.indexOf(F.FILL_COLOR)!==-1){return this.fillColorAndTrans.fillColor;}if(P.indexOf(F.FILL_TRANSPARENT)!==-1){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},iniChildrenComp:function E(P){this.propNames=P;H.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);},setChildValue:function D(Q,R){var P=this.getChildComp(Q);if(P===undefined){return false;}switch(P.alias){case"fillColor":if(R!==P.selectedValue){P.set("selectedValue",R==="undefined"?"conflict":R);}break;case"fillAlphaText":if(R!==P.value){P.set("value",R==="undefined"?"":R);}break;}},setChildEnable:function G(R,Q){var P=this.getChildComp(R);if(P!==undefined){P.set("enabled",Q);}},setChildrenValue:function A(P){P.forEach(function(Q){this.setChildValue(Q[0],Q[1]);});}});mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS={FILL_COLOR:C,FILL_TRANSPARENCY:J};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Pulldown","mstrmojo.ui.ButtonBar","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.NumGroupStepperContentProvider","mstrmojo._FormatDefinition","mstrmojo.models.FormatModel");var F=mstrmojo._FormatDefinition,R=mstrmojo.models.FormatModel,J=R.ENUM_PROPERTY_NAMES,I=1,E=2,N=4,C=8,H=16;var P;var K;var G={bold:J.FONT_WEIGHT,italic:J.FONT_STYLE,underline:J.UNDERLINE,strikeout:J.LINE_THROUGH};function B(S){return(S&H)>0;}function Q(T){var W=J.FONT_FAMILY,S=T[W]||R.getFormatBlockValue(T,W),U=this.hcgControls.fontFamily;if(S===-1){var V=U&&U.list;if(!V){return ;}V.clearSelect();delete U.selectedIndex;if(U.hasRendered){U.refresh();}}else{U.set("selectedIndex",Math.max(K.map(function(X){return X.n;}).indexOf(S)));}}function O(S){var T=[],U=function(X,Y,V){var W=S[X];if(W===undefined){W=R.getFormatBlockValue(S,X);}if(W){T.push(V);}};U(J.FONT_WEIGHT,"bold",0);U(J.FONT_STYLE,"italic",1);U(J.UNDERLINE,"underline",2);U(J.LINE_THROUGH,"line-through",3);this.hcgControls.fontStyle.select(T);}function L(S){var Y=this.hcgControls,V=J.FONT_SIZE,T=J.COLOR,X=S[V]||R.getFormatBlockValue(S,V),U=Y.fontSize;var W=S[T];if(typeof W==="undefined"||W===null){W=R.getFormatBlockValue(S,T);}if(typeof W==="undefined"||W===null){W="";}if(B(this.visibleControls)){if(X.length){U.provider.set("curValGroup",X);}}else{if(X===-1){U.list.clearSelect();U.selectedValue="";U.updatePreview();}else{U.set("selectedValue",X?(parseInt(X,10)).toString():U.items[0].n);}}Y.fontColor.set("selectedValue",W===""?"conflict":R.decodeValue(J.COLOR,W));}function M(){if(P&&K){return ;}P=F.SizesInVI.map(function(S){return{idx:parseInt(S.n,10),n:S.n};});K=mstrmojo._FormatDefinition.Families.slice(1).map(function(S){return{n:S.n,id:S.n};});}mstrmojo.ui.editors.controls._HasCharacterGroup=mstrmojo.provide("mstrmojo.ui.editors.controls._HasCharacterGroup",{_mixinName:"mstrmojo.ui.editors.controls._HasCharacterGroup",visibleControls:I+E+N,showNoFillInColor:true,hcgControls:null,getHCGControls:function D(U){M();var T=this.hcgControls={},S=this.visibleControls;if((S&I)>0){T.fontFamily=mstrmojo.ui.Pulldown.newPulldown(K,function(W,X){U(J.FONT_FAMILY,W.id,X&&X.id);},0,{isHostedWithin:false});}if((S&E)>0||(S&C)>0){var V=T.fontStyle=new mstrmojo.ui.ButtonBar({multiSelect:true,items:[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}],postselectionChange:function(W){var Y=W.added,Z=this.items[Y?Y[0]:W.removed[0]],X=!!Y;if(Z){U(G[Z.css],X,!X);}}});if((S&C)>0){V.items.pop();}}if((S&N)>0){T.fontSize=B(S)?new mstrmojo.ui.editors.controls.Stepper({provider:new mstrmojo.NumGroupStepperContentProvider({item:{interval:1},curValGroup:[],min:Math.min.apply(Math,P.map(function(W){return W.idx;})),max:Math.max.apply(Math,P.map(function(W){return W.idx;})),container:this,onTraverse:function(){var W=this.container.fontSize;if(W._sync){return ;}this.container.raiseFormatValueChange(J.FONT_SIZE,W.provider.getValGroup());},oncurValGroupChange:function(){var W=this.container.fontSize;if(W.textNode){W.updateDisplayText();}}})}):new mstrmojo.ui.editors.controls.ComboBox({selectedValue:"10",items:P,isHostedWithin:false,validateTextInput:function(W){return(/^[0-9]+(pt)?$/.test(W));},updateSelection:function(){this.set("selectedValue",parseInt(this.txtLabel.value,10).toString());},postselectedValueChange:function(W){U(J.FONT_SIZE,parseInt(W.value,10)+"pt",parseInt(W.valueWas,10)+"pt");}});T.fontColor=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:this.showNoFillInColor,selectedValue:"#000000",postselectedValueChange:function(W){U(J.COLOR,W.value,W.valueWas);}});}return T;},setFormatSource:function A(S){var T=this;this.syncControls(function(){var U=this.visibleControls;if((U&I)>0){Q.call(T,S);}if((U&E)>0||(U&C)>0){O.call(T,S);}if((U&N)>0){L.call(T,S);}});}});mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS={FONT_FAMILY:I,FONT_STYLE:E,FONT_SIZE_AND_COLOR:N,FONT_STYLE_NO_STRIKEOUT:C,FONT_SIZE_USE_STEPPER:H};mstrmojo.ui.editors.controls._HasCharacterGroup.ControlsType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton","mstrmojo.color","mstrmojo.hash","mstrmojo.models.FormatModel");var N=mstrmojo.color,K="fillColor",C="border",B=1,I=2,D=mstrmojo.models.FormatModel,H=D.ENUM_PROPERTY_NAMES,E=H.BACKGROUND_COLOR,A={all:{c:H.BORDER_COLOR,s:H.BORDER_STYLE},top:{c:H.BORDER_TOP_COLOR,s:H.BORDER_TOP_STYLE},right:{c:H.BORDER_RIGHT_COLOR,s:H.BORDER_RIGHT_STYLE},bottom:{c:H.BORDER_BOTTOM_COLOR,s:H.BORDER_BOTTOM_STYLE},left:{c:H.BORDER_LEFT_COLOR,s:H.BORDER_LEFT_STYLE}};function G(Q,O){O.forEach(function(S,R){S.slot="col"+(R+1)+"Node";});var P=this.secondColumnWidth;return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:Q,col1Width:(100-P)+"%",col2Width:P+"%",children:O};}function J(Q,O,P){return mstrmojo.hash.copy(P,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",showGradient:!!O,postselectedValueChange:function(R){this.parent.parent.raiseFormatValueChange(Q,R.value,R.valueWas);}});}function F(R){var Q="transparent",O="none",P;if(R){P=R.indexOf("#");if(P===-1){P=R.indexOf(Q);}}if(!isNaN(P)&&P>-1){O=R.substr(0,P-1);Q=N.fixFullHexValue(R.substr(P));}else{O=R;}if(O.indexOf("none")>-1){O="none";}return{s:O,c:Q};}mstrmojo.ui.editors.controls.ContainerGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",borderTitle:mstrmojo.desc(13631,"Outer border:"),showThickBorderStyle:true,showBackgroundNoFill:true,showBorderNoFill:true,visibleControls:B+I,targetBorder:"all",secondColumnWidth:60,init:function L(R){this._super(R);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditContainer");var Q=[],P=this.visibleControls,O=A[this.targetBorder];if((P&B)>0){Q.push(G.call(this,K,[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7993,"Fill color:")},J(E,true,{showNoFill:this.showBackgroundNoFill})]));}if((P&I)>0){Q.push(new mstrmojo.Label({text:this.borderTitle}));Q.push(G.call(this,C,[{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:this.showThickBorderStyle,postselectedValueChange:function(S){var T=this.parent.parent;T.raiseFormatValueChange(O.s,S.value,S.valueWas);T[C].getControl(2).set("enabled",S.value!=="none");}},J(O.c,false,{showNoFill:this.showBorderNoFill})]));}this.addChildren(Q);},setFormatSource:function M(P){var O=this[K],S=this[C],R=this.targetBorder,Q=A[R];if(R==="all"){Q=A.top;}this.syncControls(function(){if(O){var V=D.getGradientValues(P),Y;if(!V){if(P[H.FILL_STYLE]===1){Y="transparent";}else{var U=P[E];if(typeof U==="undefined"||U===null){U=P["background-color"];}if(typeof U==="undefined"||U===null){U=-1;}Y=D.decodeValue(E,U);}}O.getControl(2).set("selectedValue",V||Y);}if(S){var W=P.border;if(!W){if(typeof (P.borderStyle)!=="undefined"&&P.borderStyle!==null){W=typeof (P.borderStyle)==="string"?P.borderStyle:D.decodeValue("borderStyle",P.borderStyle);}else{W=D.decodeValue(Q.s,P[Q.s]);}if(typeof P.borderColor!=="undefined"&&P.borderColor!==null){W+=" "+D.decodeValue("borderColor",P.borderColor);}else{if(typeof P[Q.c]!=="undefined"&&P[Q.c]!==null){W+=" "+D.decodeValue(Q.c,P[Q.c]);}else{W+=" "+D.decodeValue(Q.c,-1);}}}var X=F(W),T=S.getControl(2);S.getControl(1).set("selectedValue",X.s);T.set("enabled",X.s!=="none");T.set("selectedValue",X.c);}});}});mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS={FILL_COLOR:B,BORDER:I};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.css","mstrmojo.Arr","mstrmojo.expr","mstrmojo.Label","mstrmojo.AjaxCall","mstrmojo.HTMLButton","mstrmojo.Container","mstrmojo._HasPopup","mstrmojo.HBox","mstrmojo.Dial","mstrmojo.WidgetDial","mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.DateTextBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.ElementsBrowser","mstrmojo.ConditionModel","mstrmojo.mstr.EnumNodeDimty");var D=mstrmojo.css,A=mstrmojo.registry,U=mstrmojo.hash,w=mstrmojo.array,F=w.find,H=mstrmojo.Arr,S=mstrmojo.expr,T=mstrmojo.dom,M=S.ET,AD=S.DTP,n=S.DTP2FN_DTP,W=S.ET2TGT,l=S.ET2TP,C=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AB=mstrmojo.string.encodeXMLAttribute,I=mstrmojo.mstr.EnumNodeDimty;var AK=w.hash([I.NodeDimtyOutputLevel]);var O={};O[M.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};O[M.AL]={target:1,fm:1,fn:1,c0:1};O[M.AE]={target:1,fm:1,es:1};O[M.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};O[M.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};O[M.MC]=O[M.MQ];O["*"]={target:1};var z={};z[M.MQ]={key:"metricFns",def:S.METRIC_FNS};z[M.MC]={key:"metricFns",def:S.METRIC_FNS};z[M.AQ]={key:"formFns",def:S.FORM_FNS};z[M.AL]={key:"formFns",def:S.FORM_FNS};z[M.AC]={key:"formFns",def:S.FORM_FNS};z[M.AE]={key:"elemFns",def:S.ELEM_FNS};var AF={};AF[M.AQ]=mstrmojo.desc(7925,"Select Attribute...");AF[M.AL]=mstrmojo.desc(7926,"Browse...");AF[M.MQ]=mstrmojo.desc(7927,"Select Metric...");AF[M.MC]=mstrmojo.desc(7927,"Select Metric...");AF[M.AC]=mstrmojo.desc(7925,"Select Attribute...");function AH(AP,AR,AO){var AQ=AP[AR].style;if(mstrmojo.dom.isFF){AQ.overflow="hidden";AQ.width=AO?"auto":"0px";AQ.visibility=AO?"inherit":"hidden";}else{AQ.display=AO?"block":"none";}}function v(AS){var AR=true,AO=AS.model,AP,AQ=AO&&S.fnCstCount(AO.fn,AO.fnt);if(!AO){return ;}switch(AO.et){case M.AQ:case M.AL:case M.MQ:for(AP=0;AP<AQ;AP++){AR=AR&&!AS["invalid"+AP];}break;}AS.okBtn.set("enabled",AR&&!!AO.completed);}function AI(AU){var AP=AU.model,AX=AP&&AP.et,AV=O[AX]||O["*"],AO=AU.children,AQ,AR=AO.length;for(AQ=0;AQ<AR;++AQ){var AT=AO[AQ];if(!AT.isStep){continue;}var AW=AT.alias,AS=AV[AW];AH(AU,AT.slot,AS);if(AS&&AT&&AT.update){AT.update();}}if(!AV.c1){AH(AU,"btwnNode",false);}if(!AV.dmy){AH(AU,"atNode",false);}v(AU);}function x(){var AP=this.parent,AO=((AP&&AP.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=AO&&AO[0];}var c="dummy",B={did:"idBrowse",v:"idBrowse",n:mstrmojo.desc(6571,"Browse..."),t:c,css:"unselectable link"},J={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:c,css:"unselectable"},r={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:c,css:"unselectable"};function Z(AQ){if(this.updating){return ;}var AR=this.multiSelect,AT=this.selectedItem;if(AT&&AT[C]===c){this.updating=true;if(AR){this.removeSelect([this.selectedIndex]);}else{var AP=AQ&&AQ.removed&&Number(AQ.removed[0]);AP=(AP==null)?-1:AP;this.set("selectedIndex",AP);}this.updating=false;if(AT===B){this.parent.browse(this);}}else{var AO=this.parent.model;if(AR){var AS=this.items;AO.edit(this.alias,{added:AQ.added&&w.get(AS,AQ.added),removed:AQ.removed&&w.get(AS,AQ.removed),itemIdField:this.itemIdField});}else{AO.edit(this.alias,AT);}}}function E(AQ,AS,AP){var AR=AQ.items,AO=w.indexOf(AR,AS);if((AO===0)&&(AR.length===1)){AP=mstrmojo.Arr.makeObservable((AP&&AP.length)?AP.concat():[]);AQ.set("items",AP);}else{if(AO>-1){AR.remove(AO,1);}if(AP&&AP.length){AR.add(AP,(AO>-1)?AO:null);}}}function L(AO){return U.copy(AO,{scriptClass:"mstrmojo.Dial",slot:AO.alias+"Node",isStep:true,cssClass:"mstrmojo-walkstep mstrmojo-"+AO.alias,itemIdField:"did",itemMarkupFunction:function(AQ,AP,AR){var AS=AB(AQ.n);return'<div class="dial-item '+AQ.css+'" title="'+AS+'">'+AS+"</div>";},allowUnlistedValues:true,insertUnlistedValuesAt:0,onchange:Z,postCreate:x});}function o(AQ,AO,AR){var AP=AQ.cfg;if(AP){AP.data=AQ;AP.parent=AR;return A.ref(AP);}AP=new mstrmojo.Label({text:AQ.n,cssClass:"dial-item"});AP.markupMethods.onselectedChange=function(){mstrmojo.css.toggleClass(this.domNode,["selected"],this.selected);};AP.data=AQ;AP.parent=AR;return AP;}function AM(AP,AO){var AQ=AO+S.FN_SEP+AP;return(AP!=null)?{did:AQ,n:AQ}:null;}function N(){var AO=this.model;if(AO){if(!AO.attachEventListener){mstrmojo.hash.make(AO,mstrmojo.ConditionModel,{});}AO.attachEventListener("edit",this.id,"onmodeledit");}}function h(AO){return AO.targets?w.filter(AO.targets,function(AP){return AP[C]===S.TP.ATTR;}):[];}function Y(AP,AO){if(AO&&AO.detachEventListener){AO.detachEventListener("edit",AP.id,"onmodeledit");}}function q(AP,AO,AQ,AT){AP.updating=true;AH(AP.parent,AP.slot,AO);if(AO){if(AQ!=null){AP.clearSelect();AP.set("items",AQ);}var AS=AP.itemIdField,AR=AP.selectedItem;if((AR&&AR[AS])!=(AT&&AT[AS])){AP.set("selectedItem",AT);}else{AP.center();}}AP.updating=false;}function m(AO,AP,AR,AQ){AO.updating=true;if(AP!=null){}AO.clearSelect();if(AP){AO.set("items",AP);}if(AR&&AR.length){AO.setSelectedItems(AR);}else{if(AQ&&AQ.length){AO.select(AQ);}else{AO.center();}}AO.updating=false;}function b(AP,AO,AQ,AS,AR){AH(AP.parent,AP.slot,AO);if(AO){m(AP,AQ,AS,AR);}}function G(AQ,AP){var AO=AQ.model||{},AR=AO.fn;return(AR!=null)&&((AO.et===M.MQ)||(AO.et===M.MC)||(AO.et===M.AQ)||(AO.et===M.AL)||(AO.et===M.AC))&&(S.fnCstCount(AR,AO.fnt)>AP);}var AL={};AL[AD.DATE]=1;AL[AD.TIME]=1;AL[AD.TIMESTAMP]=1;function k(AR,AQ,AT){var AP=[],AO=AR.length,AS;for(AS=0;AS<AO;AS++){if(F(AQ,AT,AR[AS][AT])<0){AP.push(AR[AS]);}}return AP;}function AJ(AO,AQ){var AP;if(AQ){switch(W[AO.et]){case"a":AP=AQ[M.AC];break;case"m":AP=AQ[M.MC];break;default:AP=false;break;}}else{AP=true;}return AP&&S.fn_AC_MC(AO&&AO.fn);}function p(AP){var AS=AP&&l[AP.et],AR=AP&&AP.fm&&AP.fm.dtp,AO=AR&&S.DTP2PROMPT_STP[AR],AQ={};AQ[AS]=true;if(AO){AQ[AO]=true;}return AQ;}function g(AU){var AO=this.targetsLastMod,Af=AU.targetsLastMod,AR=AU.model,Ae=this._lastTargetId,AP=AR&&AR[W[AR.et]]&&AR[W[AR.et]][AU.target.itemIdField],AY=AR&&AR.fm,Aa=AY&&AY.dtp,Ab=AJ(AR,AU.ets),AV=false;if(!AO||!Af||(AO!=Af)||Ae!==AP){this.targetsLastMod=AU.targetsLastMod;AV=true;}else{if(this.lastFmDtp!==Aa){this.lastFmDtp=Aa;AV=true;}else{if(this.lastFnTp!==Ab){this.lastFnTp=Ab;AV=true;}}}if(AV){if(!Ab){this.clearSelect();this.set("items",this.items.slice(0,this.preLen));}else{var AW=p(AR),AS=AU.targets?w.filter(AU.targets,function(Ag){return AW[Ag[C]]||AW[Ag[P]];}):[],AZ=this.items.slice(this.preLen),AX=this.itemIdField,Ad=k(AZ,AS,AX)||[],AT=k(AS,AZ,AX)||[],Ac,AQ;for(Ac=0,AQ=Ad.length||0;Ac<AQ;Ac++){this.remove(Ad[Ac]);}if(AT.length>0){this.add(AT,-1);}}this._lastTargetId=AP;}}function K(Ah,AW){Ah.updating=true;var AS=Ah.parent,Af=G(AS,AW);AH(Ah.parent,Ah.slot,Af);if(Af){var AZ=AS.model||{},AR=AZ.cs,Ae=AR&&AR[AW],AV=Ae&&Ae.v,AT;g.call(Ah,AS);switch(AZ.et){case M.MQ:case M.MC:AT=S.METRIC_DTP;break;case M.AQ:case M.AC:case M.AE:AT=AZ.fm&&AZ.fm.dtp;break;case M.AL:AT=AZ.fm&&AZ.fm.dtp;AV=[];for(var Aa=0,Ac=AR&&AR.length;Aa<Ac;Aa++){AV.push(AR[Aa].v);}AV=AV.join(mstrConfig.listSep);break;}AT=AT||AD.CHAR;var AX=S.fn_List(AZ.fn,AZ.fnt),Ab=AL[AT],Ad=Ab&&!AX;var AP=Ah.ctxtBuilder,AO=AP&&AP.itemWidgets,Ag=Ab?(Ad?Ah.calIndex:Ah.dtxtIndex):Ah.txtIndex,AY=AO&&AO[Ah.bwIndex],AQ;for(var Aa=0,Ac=Ah.preLen-1;Aa<Ac;Aa++){AQ=AO[Aa];if(Aa==Ag){AQ.set("dtp",AT);AQ.set("isList",AX);AQ.set("value",AV);AQ.set("visible",true);try{AQ.focus&&AQ.focus();}catch(AU){}if(AQ.clearValidation){AQ.clearValidation();}}else{AQ.set("visible",false);}if(AX){AQ.set("tooltip",mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep));}else{AQ.set("tooltip","");}}if(AY){AY.set("text",AF[AZ.et]);AY.set("visible",AS.objectBrowsingEnabled&&AJ(AZ,AS.ets));}switch(AZ.et){case M.AQ:case M.AL:case M.MQ:if(Ae&&Ae.p){Ah.set("selectedItem",Ae.p);}else{Ah.set("selectedIndex",Ag);}break;case M.MC:case M.AC:Ah.set("selectedItem",AZ[W[AZ.et]+(2+AW)]);break;}}AH(AS,"btwnNode",Af);Ah.refreshScroll();Ah.updating=false;}function AG(){var AR=this.parent,AP=AR.parent,AQ=(this.isValid&&this.isValid())||(!this.isValid&&!mstrmojo.string.isEmpty(this.value)),AO=AP.model;AP["invalid"+AR.cstIndex]=!AQ;if(!this.updating&&AQ){this.updating=true;if(AO){AO.edit(AR.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}v(AP);}function X(){var AP=this.parent,AO=AP.parent;AO["invalid"+AP.cstIndex]=false;}function f(AO){return L(U.copy(AO,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:o,selectionPolicy:"reselect",items:[{did:0,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AG,onInvalid:AG,onClearValidation:X,size:6,cssText:"text-align:right",visible:false}},{did:1,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:AG,visible:false}},{did:2,cfg:{scriptClass:"mstrmojo.DateTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AG,onInvalid:AG,onClearValidation:X,calendarToBody:true,calConfig:{onmousedown:function(AP){mstrmojo.dom.stopPropogation(AP.hWin,AP.e);}},visible:false}},{did:3,t:c,cfg:{scriptClass:"mstrmojo.Label",cssClass:"dial-item link",text:"Browse...",onclick:function(){this.parent.parent.browse(this.parent);},visible:false}}],txtIndex:0,calIndex:1,dtxtIndex:2,bwIndex:3,preLen:4,insertUnlistedValuesAt:-1,update:function(){K(this,this.cstIndex);}}));}function d(AO){return L(U.copy(AO,{insertUnlistedValuesAt:-1,postCreate:function(){x.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var AW=this.parent,AR=AW&&AW.parent&&AW.parent.model,AT=this.response;if((AT&&AT.did)!==AW.lastAttrId){return ;}var AS=AT.fms||[],AV=AW.selectedItem;AS=w.filter(AS,function(AX){return(!AX.icf);});if(AV){var AQ=w.find(AS,AW.itemIdField,AV[AW.itemIdField]);if(AQ>-1){AS=AS.concat();AS.splice(AQ,1);}}E(AW,r,AS);var AU=AW.items,AP=AU.length;if(AP===1){AW.singleSelect(0);}},onerr:function(){E(this.parent,r,[J]);}});},update:function(){var AZ=this.fmPost,AP=this.parent,AR=AP.model,AX=AR&&AR["a"+AZ],AV=!!AX,AQ,AU,Aa=AR&&AR.tfm,AT=Aa&&Aa.dtp,AY;if(AV){switch(AR.et){case M.AQ:case M.AL:AU=AR.fm;break;case M.AC:AU=AR["fm"+AZ];break;case M.AE:AU=AM(AR.fn,1);break;}if(this.lastAttrId!==AX.did){this.lastAttrId=AX.did;AQ=[];if(AR.et!==M.AC){if(!AX.ilk&&(!AP.ets||AP.ets[M.AE])){var AS=z[M.AE],AW=AS&&AS.key;AQ=AQ.concat((AW&&AP[AW])||AS.def||[]);}}if(AU&&(AR.et!==M.AE)){AQ.push(AU);}AY=this.ajx;AY.params.attributeId=AX.did;AQ.push(r);H.makeObservable(AQ);}}q(this,AV,AQ,AU);if(AV&&AY){if(AY._delayId){window.clearTimeout(AY._delayId);delete AY._delayId;}AY._delayId=window.setTimeout(function(){delete AY._delayId;AY.send();},500);}}}));}var Q=[S.STP.PROMPT,S.STP.PROMPT_OBJECTS,S.STP.PROMPT_ELEMENTS,S.STP.PROMPT_EXPRESSION,S.STP.PROMPT_EXPRESSION_DRAFT];function AN(AO){if(AO&&!U.isEmpty(AO)){var AP=w.hash(Q);U.forEach(AO,function(AR,AQ){if(AR){AP[l[AQ]]=true;}});return AP;}return null;}function a(AR,AQ,AT){AR.openPopup("eb",{zIndex:AR.parent.zIndex+10,left:Math.round(AT.x)+"px",top:Math.round(AT.y)+"px"});var AP=AR.eb.browser,AO=AR.model,AS=AO&&AO.a&&AO.a.did;if(!AS){return ;}AP.set("attributeID",AS);AP.set("selectedItems",AO.es?U.clone(AO.es):[]);AP.initBrowser();}function AE(AV,AO,AP){AV.openPopup("ob",{zIndex:AV.parent.zIndex+10,left:Math.round(AP.x)+"px",top:Math.round(AP.y)+"px"});var AQ=AV.ob.browser;AQ.target=AO;var AR;switch(AO.alias){case"dmy":AR=[S.TP.ATTR,S.TP.DIM];break;case"c0":case"c1":var AT=AV.model,AS=AT&&AT.et,AW=AT&&AT.fm,AU=AW&&AW.dtp||(AT.m?S.DTP.DECIMAL:S.DTP.UNKNOWN);AR=(AS===M.MQ||AS===M.MC)?[S.TP.METRIC,S.DTP2PROMPT_STP[AU]]:[S.TP.ATTR,S.DTP2PROMPT_STP[AU]];break;default:if(AV.browsableTypes){AR=AV.browsableTypes;}else{AR=AN(AV.ets);AR=AR?U.keyarray(AR,true):[S.TP.ATTR,S.TP.METRIC,S.STP.REPORT_GRID,S.STP.REPORT_GRAPH,S.STP.REPORT_ENGINE,S.STP.REPORT_TEXT,S.STP.REPORT_DATAMART,S.STP.REPORT_BASE,S.STP.REPORT_GRIDGRAPH,S.STP.REPORT_NONINTERACTIVE,S.STP.FILTER].concat(Q);}}AR[AR.length]=S.TP.FOLDER;AQ.browse({folderLinksContextId:AT&&(AT.et===M.MQ||AT.et===M.MC)?27:23,onSelectCB:[AV,"onOBSelect"],browsableTypes:AR.join(",")});}mstrmojo.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionWalk",markupString:'<table id="{@id}" class="mstrmojo-walk mstrmojo-ConditionWalk {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0" mstrAttach:click><tr><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-notNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-targetNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7926,"Browse...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fmNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-esNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7928,"Browse elements...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fnNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-c0Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fm2Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-btwnNode"><div class="mstrmojo-walkstep-wrapper">{@betweenText}</div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-c1Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fm3Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-atNode"><div class="mstrmojo-walkstep-wrapper">{@atText}</div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-dmyNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7925,"Select Attribute...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-okNode"><div class="mstrmojo-walkstep-wrapper"><div></div></td></tr></table>',markupSlots:{notNode:function(){return this.domNode.rows[0].cells[0].firstChild;},targetNode:function(){return this.domNode.rows[0].cells[1].firstChild;},fmNode:function(){return this.domNode.rows[0].cells[2].firstChild;},esNode:function(){return this.domNode.rows[0].cells[3].firstChild;},fnNode:function(){return this.domNode.rows[0].cells[4].firstChild;},c0Node:function(){return this.domNode.rows[0].cells[5].firstChild;},fm2Node:function(){return this.domNode.rows[0].cells[6].firstChild;},btwnNode:function(){return this.domNode.rows[0].cells[7].firstChild;},c1Node:function(){return this.domNode.rows[0].cells[8].firstChild;},fm3Node:function(){return this.domNode.rows[0].cells[9].firstChild;},atNode:function(){return this.domNode.rows[0].cells[10].firstChild;},dmyNode:function(){return this.domNode.rows[0].cells[11].firstChild;},okNode:function(){return this.domNode.rows[0].cells[12].firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?D.DISPLAY_TABLE:"none";},onobjectBrowsingEnabledChange:function(){this.targetNode.firstChild.style.display=this.objectBrowsingEnabled?"":"none";}},okBtn:undefined,updateBrowseElementsParams:function(AP,AO){AP.attributeID=AO.did;},children:[L({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,update:function(){var AS=this.parent,AP=AS.model;if(this.lastModel!==AP){this.lastModel=AP;var AO=AS.targets,AU=AS.ets;if(AU&&AO&&AO.length){var AR=AN(AS.ets);AO=w.filter(AO,function(AV){return AR[AV[C]];});}else{AO=AO?AO.concat():[];}var AT=AP&&AP.et,AQ=AP&&AP[W[AT]];q(this,true,AO,AQ);}}}),d({alias:"fm",fmPost:"",filter:false}),L({alias:"es",itemIdField:"v",insertUnlistedValuesAt:0,makeObservable:true,itemMarkupFunction:function(AP,AO,AQ){var AR=AB(AP.n);return'<div class="dial-checkitem '+AP.css+'" title="'+AR+'">'+AR+"</div>";},multiSelect:true,selectionPolicy:"toggle",postCreate:function V(){x.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var AQ=this.parent,AO=this.response;if((AO&&AO.did)!==AQ.lastAttrId){return ;}var AP=(AO&&AO.es)?AO.es.concat():[];m(AQ,AP,AQ.parent.model&&AQ.parent.model.es,null);},onerr:function(){E(this.parent,r,[J]);}});},update:function R(){var AU=this.parent,AQ=AU.model,AT=AQ&&AQ.a,AV=!!AT&&!AT.ilk,AW,AO,AS,AX;if(AV){if(this.lastAttrId!==AT.did){this.lastAttrId=AT.did;AW=AQ.es;var AR=AW&&AW.length;AW=AR?AW.concat():[];AW.push(r);if(AR){AS=[];for(var AP=1;AP<=AR;AP++){AS[AP]=AP;}}AX=this.ajx;AU.updateBrowseElementsParams(AX.params,AT);}else{AO=AQ.es;}}b(this,AV,AW,AO,AS);if(AV&&AX){AX.send();}}}),L({alias:"fn",allowUnlistedValues:false,update:function(){var AO=this.parent,AQ=AO.model||{},AU=AQ.et,AT,AV=false,AW,AP;switch(AU){case M.AE:AV=!!AQ.a;break;case M.AQ:case M.AC:case M.AL:AV=!!(AQ.fm&&AQ.fm.did);AT=AV?AQ.fm.dtp:null;break;case M.MQ:case M.MC:AV=!!AQ.m;AT=AV?S.METRIC_DTP:null;break;}if(AV){var AX=n[AT];if((this.lastEt!==AU)||(this.lastFnDtp!==AX)){this.lastEt=AU;this.lastFnDtp=AX;var AS=AU?z[AU]:null,AR=AS&&AS.key;AW=(AR&&AO[AR])||AS.def||[];if(typeof (AW)==="object"){AW=AW[AX]||AW["*"];}}AP=AM(AQ.fn,AQ.fnt||1);}q(this,AV,AW,AP);}}),f({alias:"c0",cstIndex:0}),d({alias:"fm2",fmPost:"2"}),f({alias:"c1",cstIndex:1}),d({alias:"fm3",fmPost:"3"}),L({alias:"dmy",itemIdField:"did",hideIfEmpty:true,itemMarkupFunction:function(AP,AO,AQ){var AR=AB(AP.n);return'<div class="dial-checkitem '+AP.css+'" title="'+AR+'">'+AR+"</div>";},multiSelect:true,selectionPolicy:"toggle",insertUnlistedValuesAt:0,makeObservable:true,postCreate:function(){x.apply(this,[]);this.set("items",h(this.parent));},update:function u(){var AQ=this.parent,AU=AQ.model,AW=AU.et,AZ=AU&&AU.m,AX=!!AZ&&(AU.fn!==null)&&((AW===M.MQ)||(AW===M.MC))&&AU.dimtyTypes[I.NodeDimtyOutputLevel],AV,AR;if(AX){var AS=this.targetsLastMod,Aa=AQ.targetsLastMod;if(!AS||!Aa||(AS!=Aa)){this.targetsLastMod=AQ.targetsLastMod;AV=h(AQ);}AR=[];var AP=AU.dmy&&AU.dmy.uts;for(var AY=0,AO=(AP&&AP.length)||0;AY<AO;AY++){var AT=AP[AY];AR.push(AT.utgt?AT.utgt:AT);}}b(this,AX,AV,AR);AH(AQ,"atNode",AX);}}),{alias:"okBtn",slot:"okNode",scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),cssText:"width:66px;min-width:58px;",onclick:function(){var AO=this.parent;if(AO.onOK){AO.onOK();}}},{alias:"cancelBtn",slot:"okNode",scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:66px;min-width:58px;",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var AO=this.parent.parent;if(AO&&AO.close){AO.close();}}}],eb:{scriptClass:"mstrmojo.Editor",cssClass:T.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(AP){var AO=this.parent.opener;AO.updateBrowseElementsParams(AP,AO.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;margin-right:2px;",onclick:function(){var AO=this.parent.parent,AP=AO&&AO.opener;if(AP){AP.onEBSelect();AP.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:302px;",fishEyeVisible:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true}]},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),model:null,targets:null,ets:null,defaultEt:null,defaultAttrEt:null,metricFns:null,formFns:null,elemFns:null,metricLevels:null,defaultMetricLevel:null,browsableTypes:null,postBuildRendering:function AC(){N.call(this);AI(this);return this._super();},_set_model:function e(AR,AO){var AP=this.model,AQ=(AO!==AP);if(AQ){Y(this,AP);AO.dimtyTypes=this.dimtyTypes||AK;this.model=AO;N.call(this);if(this.hasRendered){AI(this);}}return AQ;},onmodeledit:function(AO){switch(AO&&AO.prop){case"es":case"dmy":v(this);return ;}AI(this);},browse:function t(AO){var AQ=this.parent.editorNode,AP=function(AS,AU){var AR=mstrmojo.dom.position(AS,true),AT=mstrmojo.dom.position(AU,true);return{x:AR.x+AR.w,y:AT.y};};switch(AO&&AO.alias){case"target":case"dmy":AE(this,AO,AP(AO.alias=="target"?this.targetNode:this.dmyNode,AQ));break;case"c0":case"c1":AE(this,AO,AP(AO.alias=="c0"?this.c0Node:this.c1Node,AQ));break;case"es":a(this,AO,AP(this.esNode,AQ));break;}},onOBSelect:function(AR){var AP=this.ob.browser,AT=AP.target;this.closePopup();var AS=AT.itemIdField,AQ=this.targets||[],AO=w.find(this.targets,AS,AR[AS]);if(AO===-1){AQ.push(AR);this.targets=AQ;this.targetsLastMod=new Date();}AT.setSelectedItems([AR],AT.multiSelect);AT.refreshScroll();},onEBSelect:function(){var AO=this.eb.browser;var AP=this.es;AP.set("selectedIndices",{});AP.setSelectedItems(AO.selectedItems,false);},onclick:function AA(AO){var AP=mstrmojo.dom.eventTarget(AO.hWin,AO.e);if(AP==this.targetNode.firstChild){this.browse(this.target);}else{if(AP==this.esNode.firstChild){this.browse(this.es);}else{if(AP==this.dmyNode.firstChild){this.browse(this.dmy);}}}},objectBrowsingEnabled:true});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Model","mstrmojo.Container","mstrmojo.Button","mstrmojo.Label","mstrmojo.DateTextBox","mstrmojo.TextArea","mstrmojo.ui.CheckList","mstrmojo.ui.Pulldown","mstrmojo.ui.MultiSelectPulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo._HasPopup");mstrmojo.requiresDescs(2,3,520,686,687,688,698,699,1050,5688,6013,8956,9163);var H=mstrmojo.desc,I=mstrmojo.array,C=mstrmojo.hash,K=mstrmojo.validation,F=mstrmojo.Button.newWebButton;var J;var E=function(P,N,O){if(!this.hasRendered){return ;}mstrmojo.all[J].model.settings[P]=N;if(O!==false){mstrmojo.all[J].onmodelChange();}};var G=function(O,N){N=N||{};return C.copy(N,{scriptClass:"mstrmojo.ui.CheckList",orientation:N.isVertical===false?"h":"v",multiSelect:!N.isRadio,items:O});};var L=function(P,O,N){return new mstrmojo.Box({alias:N,cssClass:"mstrmojo-SearchSettings-panel "+N,cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",text:P}].concat(O)});};var B=function(N){var O=this;return{scriptClass:"mstrmojo.DateTextBox",alias:N,cssDisplay:"block",cssClass:N,width:120,required:false,calendarToBody:true,calendarZIndex:112,constraints:{trigger:K.TRIGGER.ALL},autoFormat:false,bindings:{value:function(){return O.model.settings[N];}},onfocus:function(){this.parent.parent.dateSubType.set("selectedIndex",1);},getSetting:function(){return{p:this.alias,v:this.value};}};};mstrmojo.mstr.search.SearchSettings=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.mstr.search.SearchSettings",visible:false,markupString:'<div class="mstrmojo-SearchSettings {@cssClass}" style="{@cssText}"><div class="mstrmojo-SearchSettings-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},onmodelChange:mstrmojo.emptyFn,init:function M(N){if(this._super){this._super(N);}J=this.id;},postBuildRendering:function A(){var O=this;this.prepareObjectTypes();var N=[];this.addChildren([L(H(8956,"Object type"),{scriptClass:"mstrmojo.ui.MultiSelectPulldown",alias:"objectType",isHostedWithin:true,orientation:"v",multiSelect:true,items:I.map(this.allowedObjectTypesData,function(R,Q){if(I.indexOf(O.model.settings.objectType,R.t)>-1){N[Q]=true;}return{n:R.d,t:R.t};}),selectedIndices:N,allIdx:-1,onselectionChanged:function(){var Q=this.items;E.call(this,this.alias,I.map(C.keyarray(this.selectedIndices),function(R){return Q[R].t;}));},onchange:function(){var Q=this.items;E.call(this,this.alias,I.map(C.keyarray(this.selectedIndices),function(R){return Q[R].t;}));},getPopupWidget:function P(){var Q=this;this.popupWidget.onClose=function(){this.list.selectedIndices=mstrmojo.hash.copy(Q.selectedIndices);this.list.refresh();};return this.popupWidget;}},"objectTypePanel"),L(H(60,"Owner"),mstrmojo.ui.Pulldown.newPulldown([{n:H(698,"Created by any user"),v:1},{n:H(699,"Created only by me"),v:2}],function(Q,R){if(Q.v!==R.v){E.call(this,this.alias,Q.v);}},0,{alias:"ownerType"}),"ownerPanel"),L(H(2052,"Date"),[mstrmojo.ui.Pulldown.newPulldown([{n:mstrmojo.desc(2058,"All"),v:0},{n:mstrmojo.desc(694,"Created"),v:1},{n:mstrmojo.desc(61,"Modified"),v:2}],function(Q,R){if(Q.v!==R.v){E.call(this,"dateType",Q.v===0?1:2,false);E.call(this,this.alias,Q.v,Q.v===0);}},0,{alias:"created",cssClass:"mstrmojo-SearchSettings-date-pulldown"}),mstrmojo.Button.newIconButton(H(5688,"Show dates"),"mstrmjo-SearchSettings-calendar",function(){this.parent.datePopup.open();},{visible:function(){var Q=this.parent.created.selectedIndex!==0;if(Q){this.parent.datePopup.open();}return Q;}},{alias:"calIcon"}),{scriptClass:"mstrmojo.ui.PopupWidget",cssClass:"mstrmojo-SearchSettings-dates-popupWidget",alias:"datePopup",visible:false,children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"dateContainer",cssClass:"mstrmojo-SearchSettings-dates",width:"238px",col1Width:"80px",col2Width:"130px",children:[G([{n:mstrmojo.desc(4049,"Last"),v:1},{n:mstrmojo.desc(294,"Between"),v:2}],{alias:"dateSubType",isRadio:true,bindings:{selectedIndex:function(){return I.find(this.items,"v",O.model.settings.dateSubType);}},postselectionChange:function(){if(this.hasRendered){if(this.selectedIndex===0){this.parent.intervalBox.intervalValue.inputNode.focus();}else{this.parent.intervalBox.startDate.inputNode.focus();}}},getSetting:function(){return{p:this.alias,v:this.items[this.selectedIndex].v};},slot:"col1Node"}),{scriptClass:"mstrmojo.Box",cssDisplay:"inline-block",alias:"intervalBox",children:[{scriptClass:"mstrmojo.TextBox",alias:"intervalValue",cssClass:"intervalValue",cssDisplay:"inline-block",size:1,maxLength:4,bindings:{value:function(){return mstrmojo.all.searchSettings.model.settings.intervalValue;}},onvalueChange:function(){},onfocus:function(){this.parent.parent.dateSubType.set("selectedIndex",0);},getSetting:function(){return{p:this.alias,v:this.value||""};}},mstrmojo.ui.Pulldown.newPulldown([{n:mstrmojo.desc(708,"Hours"),v:1},{n:mstrmojo.desc(707,"Days"),v:2},{n:mstrmojo.desc(714,"Weeks"),v:3},{n:mstrmojo.desc(710,"Months"),v:4},{n:mstrmojo.desc(709,"Years"),v:5}],function(Q,R){if(Q.v!==R.v){}},0,{alias:"intervalUnit",cssClass:"intervalUnit",cssDisplay:"inline-block",getSetting:function(){return{p:this.alias,v:this.items[this.selectedIndex].v};}}),B.call(this,"startDate"),B.call(this,"endDate")],slot:"col2Node"}]},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Buttons",children:[F(mstrmojo.desc(1442,"Ok"),function(){var R=this.parent.parent.dateContainer,Q=R.intervalBox;var S=[R.dateSubType,Q.intervalValue,Q.intervalUnit,Q.startDate,Q.endDate];I.forEach(S,function(T){var U=T.getSetting();mstrmojo.all[J].model.settings[U.p]=U.v;mstrmojo.all[J].onmodelChange();});this.parent.parent.close();},true,{cssDisplay:"inline-block"}),F(mstrmojo.desc(2140,"Cancel"),function(){this.parent.parent.close();},false,{cssDisplay:"inline-block"})]}]}],"datepanel"),L(H(6013,"Description (contains)"),{scriptClass:"mstrmojo.TextArea",alias:"description",rows:1,bindings:{value:function(){return mstrmojo.all.searchSettings.model.settings.description;}},onvalueChange:function(){E.call(this,this.alias,this.value);}},"descriptionPanel")]);if(this._super){this._super();}},prepareObjectTypes:function D(){var P=[],Q=[];this.allowedObjectTypes=this.allowedObjectTypesData.concat([]);I.forEach(this.allowedObjectTypes,function(S,R){P[R]=parseInt(S.t,10);Q[P[R]]=S.d;});if(this.allowedObjectTypes.length===0){this.model.settings.objectType=[];return ;}var N=this.allowedObjectTypes,O=this.model.settings.objectType;I.forEach([].concat(O),function(R){I.removeItems(O,"t",I.find(N,"t",parseInt(R,10))===-1?[R]:null);});if(O.length===0&&!(this.isMiniSearchBox||this.isDesktopSearchBox)){O=I.map(this.allowedObjectTypes,function(R){return R.t;});}this.model.settings.objectType=O;}});mstrmojo.mstr.search.SearchSettings.getLocationPulldown=function(N){var P=[{n:mstrApp.projectAlias||mstrConfig.projectName,v:39},{n:H(2,"Shared Reports"),v:7},{n:H(3,"My Reports"),v:20}],Q=0;if(N.rootFolderType===0){P.push({n:N.rootFolderName||"",v:0});Q=3;}else{Q=I.find(P,"v",N.rootFolderType);}return mstrmojo.ui.Pulldown.newPulldown(P,function O(R,S){if(R.v!==S.v){E.call(this,"rootFolderType",R.v);}},Q,mstrmojo.hash.copy(N,{cssDisplay:"inline-block"}));};mstrmojo.mstr.search.SearchSettings.getSearchTypePulldown=function(N){return mstrmojo.ui.Pulldown.newPulldown([{n:H(686,"Contains"),v:N.qse?16:1},{n:H(520,"Exactly"),v:2},{n:H(687,"Begins With"),v:4},{n:H(688,"Ends with"),v:8}],function O(P,Q){if(P.v!==Q.v){E.call(this,"nameWildcards",P.v);}},0,mstrmojo.hash.copy(N,{cssDisplay:"inline-block",cssClass:"searchType"}));};}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.array","mstrmojo.string","mstrmojo.expr","mstrmojo.date","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox");var T=mstrmojo.array,Q=mstrmojo.css,I=mstrmojo.string,P=mstrmojo.date,O=mstrmojo.expr,S=O.DTP,B=O.FN,E=mstrmojo.validation;var A={};A[B.BETWEEN]=B.NOT_BETWEEN;A[B.NOT_BETWEEN]=B.BETWEEN;A[B.GREATER_EQUAL]=B.LESS;A[B.LESS]=B.GREATER_EQUAL;A[B.LESS_EQUAL]=B.GREATER;A[B.GREATER]=B.LESS_EQUAL;A[B.SEARCH]=B.SEARCH;function H(U){if(this.value!==this._lastInput){R.call(this,U,true);}}function M(U){mstrmojo.DateTextBox.prototype.onclick.call(this,U);Q.addClass(this.calendar&&this.calendar.domNode,mstrApp.getThemeClassName());}function R(U,Z){var Y=this.parent.parent;if(!Y._inSyncPhase){var W=this.calendar&&this.calendar.cal,X=this,V=Y.submitTimer;if(V){window.clearTimeout(V);}if(!mstrApp.isWaiting()){if(Z||W&&W.value===this.value){this._lastInput=this.value;Y.submit(X);}else{Y.submitTimer=window.setTimeout(function(){X._lastInput=X.value;Y.submit(X);},3000);this.set("dynDateValue",null);if(W){W.set("value",this.value);}}}else{if(this._lastInput){this.set("value",this._lastInput);}}}}function K(X){if(!X.isDyn){return null;}var W=["isDyn"];W.push(X.dyt||0);W.push(X.ddo||0);W.push(X.dmo||0);W.push(X.dm||0);W.push(X.dd||0);W.push(X.dw||0);W.push(X.dow||0);W.push(X.v||"");if(X.dtp===O.DTP.TIMESTAMP){var V=P.parseDateAndOrTime(X.v||""),U=V&&V.time;if(U){X.dh=U.hour;X.dmi=U.min;X.ds=U.sec;}}W.push(X.dh||0);W.push(X.dmi||0);W.push(X.ds||0);return W.join("::");}function C(W,X,Z){return{parent:W,dt:X,f:Z,setDataType:function Y(c){this.dt=c;},setFunction:function b(c){this.f=c;},hasSecTextBox:function a(){var c=this.f;return c!==B.SEARCH;},adjustVisibleFields:function U(){var c=this.parent;if(!this.hasSecTextBox()){c.toBox.set("visible",false);c.fromBox.fromLabel.set("visible",false);}if(X===O.DTP.DATE||X===O.DTP.TIMESTAMP){c.fromBox.fromInput.set("visible",false);c.toBox.toInput.set("visible",false);}else{c.fromBox.fromPicker.set("visible",false);c.toBox.toPicker.set("visible",false);}},passValueToInputs:function V(d){var f=this.parent,h,g,e=this,c=function(k,l){if(e.f===B.SEARCH||k.v!=="*"){l.set("value",k.v);l._lastInput=k.v;if(X===O.DTP.DATE||X===O.DTP.TIMESTAMP){l.set("dynDateValue",K(k));}}};if(X===O.DTP.DATE||X===O.DTP.TIMESTAMP){h=f.fromBox.fromPicker;g=f.toBox.toPicker;}else{h=f.fromBox.fromInput;g=f.toBox.toInput;}if(Z===B.BETWEEN||Z===B.NOT_BETWEEN){if(d&&d[0]){c(d[0],h);}else{h.set("value",h.min||"");h._lastInput=h.min||"";}if(this.hasSecTextBox()&&d&&d[1]){c(d[1],g);}else{g.set("value",g.max||"");g._lastInput=g.max||"";}}else{if(Z===B.GREATER_EQUAL||Z===B.LESS){if(d&&d[0]){c(d[0],h);g.set("value",g.max||"");g._lastInput=g.max||"";}}else{if(Z===B.LESS_EQUAL||Z===B.GREATER){if(d&&d[0]){c(d[0],g);h.set("value",h.min||"");h._lastInput=h.min||"";}}}}}};}mstrmojo.vi.ui.rw.selectors.AttrQualInputBox=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.AttrQualInputBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},cssClass:"Attr-Qual-InputBox",children:[{scriptClass:"mstrmojo.Box",alias:"fromBox",cssClass:"from-box",children:[{scriptClass:"mstrmojo.Label",alias:"fromLabel",cssDisplay:"inline-block",cssClass:"input-label",text:mstrmojo.desc(146,"From:")},{scriptClass:"mstrmojo.ValidationTextBox",alias:"fromInput",cssDisplay:"inline-block",required:false,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onEnter:H,onblur:H,_lastInput:null,bindings:{dtp:"this.parent.parent.dt"}},{scriptClass:"mstrmojo.DateTextBox",alias:"fromPicker",cssDisplay:"inline-block",required:false,calendarToBody:true,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onvalueChange:R,onEnter:H,onblur:H,_lastInput:null,bindings:{dtp:"this.parent.parent.dt",min:"this.parent.parent.min",max:"this.parent.parent.max",defaultDate:"this.parent.parent.min",showAdvanced:"this.parent.parent.showAdvanced",canSelectDisabledDate:"this.parent.parent.canSelectDisabledDate"},onclick:M}]},{scriptClass:"mstrmojo.Box",alias:"toBox",cssClass:"to-box",children:[{scriptClass:"mstrmojo.Label",alias:"toLabel",cssDisplay:"inline-block",cssClass:"input-label",text:mstrmojo.desc(147,"To:")},{scriptClass:"mstrmojo.ValidationTextBox",alias:"toInput",cssDisplay:"inline-block",required:false,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onEnter:H,onblur:H,_lastInput:null,bindings:{dtp:"this.parent.parent.dt"}},{scriptClass:"mstrmojo.DateTextBox",alias:"toPicker",cssDisplay:"inline-block",required:false,calendarToBody:true,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onvalueChange:R,onEnter:H,onblur:H,_lastInput:null,bindings:{dtp:"this.parent.parent.dt",min:"this.parent.parent.min",max:"this.parent.parent.max",defaultDate:"this.parent.parent.max",showAdvanced:"this.parent.parent.showAdvanced",canSelectDisabledDate:"this.parent.parent.canSelectDisabledDate"},onclick:M}]}],widgetResized:function(){var X=this,U=parseInt(this.width,10),V=["fromBox","toBox"],Y,W;if(!this.widgetHelper.hasSecTextBox()){V=["fromBox"];}if(U>368){W=true;}else{W=false;}if(X.parent.isInFilterPanel()||!this.widgetHelper.hasSecTextBox()){W=false;return ;}window.setTimeout(function(){Y=X.hasRendered;T.forEach(V,function(Z){if(Y){Q.toggleClass(X[Z].domNode,"onerow",W);X[Z].domNode.style.display=W?"inline-block":"block";}else{if(W){Q.addWidgetCssClass(X[Z],"onerow");X[Z].cssDisplay="inline-block";}else{Q.removeWidgetCssClass(X[Z],"onerow");X[Z].cssDisplay="block";}}});},0);},init:function N(U){if(this._super){this._super(U);}this.widgetHelper=C(this,this.dt,this.f);this.updateWidgetByData();},update:function D(U){if(U){this.cs=U.cs;if(U.f){this.f=U.f;}if(U.ft){this.ft=U.ft;}if(U.fid){this.fid=U.fid;}if(U.min){this.set("min",U.min);}if(U.max){this.set("max",U.max);}}this.updateWidgetByData();},updateWidgetByData:function L(){var U=this.widgetHelper,V=this.cs;this._inSyncPhase=true;U.adjustVisibleFields();U.passValueToInputs(V);this._inSyncPhase=false;},onincludeChange:function F(){this.f=A[this.f];if(!this._inSyncPhase){this.onchange();}},submit:function G(b){var Z=this.cs=[],X=this.parent.include,W=this.widgetHelper,V=(b.validationStatus.code===E.STATUSCODE.VALID),e=this.parent.model,Y;if(W.hasSecTextBox()){if(b.alias==="toInput"){Y=this.fromBox.fromInput;}else{if(b.alias==="toPicker"){Y=this.fromBox.fromPicker;}else{if(b.alias==="fromInput"){Y=this.toBox.toInput;}else{if(b.alias==="fromPicker"){Y=this.toBox.toPicker;}}}}Y.validate();if(Y.validationStatus.code!==E.STATUSCODE.VALID){V=false;}}if(V){if(W.hasSecTextBox()){var d=(b.alias.indexOf("from")===0)?b:Y,c=(b.alias.indexOf("to")===0)?b:Y,U=d.dynDateValue||d.value,a=c.dynDateValue||c.value;this.unset=I.isEmpty(U)&&I.isEmpty(a);if(!I.isEmpty(U)&&!I.isEmpty(a)){Z[0]={v:U};Z[1]={v:a};this.f=X?B.BETWEEN:B.NOT_BETWEEN;}else{if(!I.isEmpty(U)){if(e.isFromSolrCube&&e.isFromSolrCube(this.srcid)){Z[0]={v:U};Z[1]={v:"*"};this.f=X?B.BETWEEN:B.NOT_BETWEEN;}else{Z[0]={v:U};this.f=X?B.GREATER_EQUAL:B.LESS;}}else{if(!I.isEmpty(a)){if(e.isFromSolrCube&&e.isFromSolrCube(this.srcid)){Z[0]={v:"*"};Z[1]={v:a};this.f=X?B.BETWEEN:B.NOT_BETWEEN;}else{Z[0]={v:a};this.f=X?B.LESS_EQUAL:B.GREATER;}}}}}else{Z[0]={v:b.value};this.unset=I.isEmpty(Z[0].v);this.f=B.SEARCH;}this.onchange();if(this.makeSelection){this.makeSelection({selItem:this.domNode});}}},getSummaryText:function J(){var W=this.cs||[],X=this.f;if(this.unset||!W.length||I.isEmpty(W[0].v)&&(W.length<=1||I.isEmpty(W[1].v))){return"";}var V="",U=this.parent.include;switch(X){case B.BETWEEN:case B.NOT_BETWEEN:V=mstrmojo.desc(4804).replace("##",W[0].v).replace("###",W[1].v);break;}if(!U){V=mstrmojo.desc(1099,"Not")+" "+V;}return V;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.css","mstrmojo.registry","mstrmojo.AjaxCall","mstrmojo.hash","mstrmojo.array","mstrmojo.Arr","mstrmojo.expr","mstrmojo.dom","mstrmojo.mstr.EnumDataType","mstrmojo.Label","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.WidgetDial","mstrmojo.Calendar","mstrmojo.DateTextBox","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ValidationTextBox","mstrmojo.ui.CheckList","mstrmojo.ui._HasScroller","mstrmojo.ui.ColumnContainer","mstrmojo.elementHelper");var AU=mstrmojo.css,AN=mstrmojo.registry,M=mstrmojo.hash,c=mstrmojo.mstr.EnumDataType,K=mstrmojo.array,t=K.map,L=mstrmojo.Arr,AQ=mstrmojo.expr,b=AQ.ET,o=AQ.ET2TP,AG=AQ.ET2TGT,O=AQ.FN,z=AQ.FN_MRP,AO=AQ.DTP,l=AQ.DTP2FN_DTP,AJ=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AV=AQ.TP,W=AQ.STP,U=mstrmojo.elementHelper;var Ab={};Ab[b.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};Ab[b.AL]={target:1,fm:1,fn:1,c0:1};Ab[b.AE]={target:1,fm:1,es:1};Ab[b.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};Ab[b.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};Ab[b.MC]=Ab[b.MQ];Ab["*"]={target:1};var B={};B[b.MQ]={key:"metricFns",def:AQ.METRIC_FNS};B[b.MC]={key:"metricFns",def:AQ.METRIC_FNS};B[b.AQ]={key:"formFns",def:AQ.FORM_FNS};B[b.AL]={key:"formFns",def:AQ.FORM_FNS};B[b.AC]={key:"formFns",def:AQ.FORM_FNS};B[b.AE]={key:"elemFns",def:AQ.ELEM_FNS};var AB=mstrmojo.desc(14084,"Select a filter option or a qualification."),AA=mstrmojo.desc(14085,"Select one or more elements."),x=mstrmojo.desc(14086,"Select an operator."),w=mstrmojo.desc(14087,"Enter a value or select an attribute from the list."),v=mstrmojo.desc(14088,"Select an attribute form. When done, click ## button.").replace("##",'""'),u=mstrmojo.desc(14089,"Select a condition."),r=mstrmojo.desc(14090,"Enter a value or select a metric from the list.");var AM=0,AZ=1;var H=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;function F(Ag){var Af=true,Ac=Ag.model,Ad,Ae=Ac&&AQ.fnCstCount(Ac.fn,Ac.fnt);if(!Ac){return ;}switch(Ac.et){case b.AQ:case b.AL:case b.MQ:for(Ad=0;Ad<Ae;Ad++){Af=Af&&!Ag["invalid"+Ad];}break;}Ag.okBtn.set("visible",Af&&!!Ac.completed);}function J(){var Ad=this.parent,Ac=((Ad&&Ad.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=Ac&&Ac[0];}var Y="dummy",q={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:Y,css:"unselectable"},A={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:Y,css:"unselectable"},AX={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:Y,css:"unselectable"},AK={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:Y,css:"unselectable"},a={did:"idAttribute",v:"idAttribute",n:mstrmojo.desc(518,"Attribute"),t:Y,css:"unselectable"},AF={did:"idMetric",v:"idMetric",n:mstrmojo.desc(517,"Metric"),t:Y,css:"unselectable"};function m(Ae){if(this.updating){return ;}var Af=this.multiSelect,Ai=this.selectedItem,Ah=Ae&&Ae.added,Aj=Ae&&Ae.removed;if(!Af&&Ah&&Aj&&Ah[0]===Aj[0]){return ;}if(Ai&&Ai[AJ]===Y){this.updating=true;if(Af){this.removeSelect([this.selectedIndex]);}else{var Ad=Aj&&Number(Aj[0]);Ad=(Ad==null)?-1:Ad;this.set("selectedIndex",Ad);}this.updating=false;}else{var Ac=this.parent.parent.parent.model;if(Af){var Ag=this.items;Ac.edit(this.alias,{added:Ah&&K.get(Ag,Ah),removed:Aj&&K.get(Ag,Aj),itemIdField:this.itemIdField});}else{Ac.edit(this.alias,Ai);}}}mstrmojo.rw.ConditionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.rw.ConditionList",allowUnlistedValues:true,itemIdField:"did",getItemProps:function AS(Ag,Ac){var Af=!!this.selectedIndices[Ac],Ah=Ag.n,Ae=false;if(Ag.t===12){var Ad=K.filter(Ag.fs,function(Ai){return Ai.fgr>0;});if(Ad.length>0){Ae=true;}}return M.copy({cls:(Af?mstrmojo._IsList.SELECTED_CLS:"")+" "+(Ag.css||"")+" "+(Ag.t?("t"+Ag.t+((Ag.da||Ag.um)?"d":"")+(Ae?"g":"")+(Ag.st?(" st"+Ag.st):"")):""),n:Ah||"&nbsp;"},this._super(Ag,Ac));},onselectionChange:function p(Ac){this._super(Ac);m.call(this,Ac);}});function AE(Ae,Ag,Ad){var Af=Ae.items,Ac=K.indexOf(Af,Ag);if((Ac===0)&&(Af.length===1)){Ad=mstrmojo.Arr.makeObservable((Ad&&Ad.length)?Ad.concat():[]);Ae.set("items",Ad);}else{if(Ac>-1){Af.splice(Ac,1);}if(Ad&&Ad.length){K.insert(Af,(Ac>-1)?Ac:Af.length,Ad);}Ae.refresh();}}function N(Ac){return mstrmojo.mixin(Ac,{scriptClass:"mstrmojo.rw.ConditionList",cssClass:"mstrmojo-"+Ac.alias,postCreate:J});}function V(Ae,Ac,Af){var Ad=Ae.cfg;if(Ad){Ad.data=Ae;Ad.parent=Af;return AN.ref(Ad);}Ad=new mstrmojo.Label({text:Ae.n||"&nbsp;",cssClass:"dial-item "+(Ae.t?("t"+Ae.t):"")});Ad.markupMethods.onselectedChange=function(){AU.toggleClass(this.domNode,["selected"],this.selected);};Ad.data=Ae;Ad.parent=Af;return Ad;}function f(Ad,Ac){var Ae=Ac+AQ.FN_SEP+Ad;return(Ad!=null)?{did:Ae,n:Ae}:null;}function AY(Ac){return Ac.targets?K.filter(Ac.targets,function(Ad){return Ad[AJ]===AQ.TP.ATTR;}):[];}function Q(Ae,Ad,Af,Ai){Ae.updating=true;if(Ad){if(Af!=null){Ae.clearSelect();Ae.set("items",Af);}var Ah=Ae.itemIdField,Ag=Ae.selectedItem;if((Ag&&Ag[Ah])!=(Ai&&Ai[Ah])){var Ac=Math.max(K.indexOf(t((Af||[]),function(Aj){return Aj[Ah];}),Ai&&Ai[Ah]),0);Ae.set("selectedIndex",Ac);}}Ae.updating=false;}function AR(Ac,Ad,Af,Ae){Ac.updating=true;Ac.clearSelect();K.forEach(Ad,function(Ag){Ag.title=Ag.title||Ag.n||"";});if(Ad){Ac.set("items",Ad);}if(Af&&Af.length){Ac.setSelectedItems(Af);}else{if(Ae&&Ae.length){Ac.select(Ae);}}Ac.updating=false;}function AI(Ad,Ac,Ae,Ag,Af){if(Ac){AR(Ad,Ae,Ag,Af);}}function AH(Ae,Ad){var Ac=Ae.model||{},Af=Ac.fn;return(Af!=null)&&((Ac.et===b.MQ)||(Ac.et===b.MC)||(Ac.et===b.AQ)||(Ac.et===b.AL)||(Ac.et===b.AC))&&(AQ.fnCstCount(Af,Ac.fnt)>Ad);}var e={};e[AO.DATE]=1;e[AO.TIME]=1;e[AO.TIMESTAMP]=1;function n(Ac,Ae){var Ad;if(Ae){switch(AG[Ac.et]){case"a":Ad=Ae[b.AC];break;case"m":Ad=Ae[b.MC];break;default:Ad=false;break;}}else{Ad=true;}return Ad&&AQ.fn_AC_MC(Ac&&Ac.fn);}function k(Ad){var Ag=Ad&&o[Ad.et],Af=Ad&&Ad.fm&&Ad.fm.dtp,Ac=Af&&AQ.DTP2PROMPT_STP[Af],Ae={};Ae[Ag]=true;if(Ac){Ae[Ac]=true;}return Ae;}function d(Ac){switch(Ac){case c.DataTypeInteger:case c.DataTypeUnsigned:case c.DataTypeDecimal:case c.DataTypeReal:case c.DataTypeDouble:case c.DataTypeFloat:return c.DataTypeNumeric;default:return Ac;}}function C(Ad){var Af=Ad.model,Ak=Af&&Af[AG[Af.et]]&&Af[AG[Af.et]][Ad.columnWalk.target.itemIdField],Ae=Af&&Af.fm,Ac=Ae&&Ae.dtp,Ah=n(Af,Ad.ets);if(this.targetsLastMod&&this.targetsLastMod===Ad.targetsLastMod&&Ak&&Ak===this._lastTargetId&&this.lastFmDtp===Ac&&this.lastFnTp===Ah){return ;}if(!Ah){this.clearSelect();this.set("items",this.items.slice(0,this.preLen));}else{var Ai=k(Af),Al=Af[AG[Af.et]],Ag=Af.a?[a]:Af.m?[AF]:[],Am=Ag.concat(AQ.getSortedObjectsByTypeGroup(K.filter(Ad.targets,function(An){return(An.t!==4||An.did!==Al.did)&&(Ai[An[AJ]]||Ai[An[P]]);}))),Aj=this.items.slice(this.preLen);K.forEach(Aj.reverse(),function(An){this.remove(An);},this);this.add(Am,-1);}this._lastTargetId=Ak;this.lastFnTp=Ah;this.lastFmDtp=Ac;this.targetsLastMod=Ad.targetsLastMod;}function AL(Av,Am){Av.updating=true;var Ai=Av.parent.parent.parent,Au=AH(Ai,Am),Ao,Aq;if(Au){var Ae=Ai.model||{},Ag=Ae.cs,As=Ag&&Ag[Am],Al=As&&As.v,Aj;C.call(Av,Ai);switch(Ae.et){case b.MQ:case b.MC:Aj=(As&&As.dtp)||d(Ae.m.dt)||AQ.METRIC_DTP;break;case b.AQ:case b.AC:case b.AE:Aj=Ae.fm&&Ae.fm.dtp;break;case b.AL:Aj=Ae.fm&&Ae.fm.dtp;Al=[];for(Ao=0,Aq=Ag&&Ag.length;Ao<Aq;Ao++){Al.push(Ag[Ao].v);}Al=Al.join(mstrConfig.listSep);break;}Aj=Aj||AO.CHAR;var Ah=Ae.fn,An=AQ.fn_List(Ah,Ae.fnt),Ap=e[Aj],Ar=Ap&&!An;var Ad=Av.ctxtBuilder,Ac=Ad&&Ad.itemWidgets,At=Ap?(Ar?Av.calIndex:Av.dtxtIndex):Av.txtIndex,Af;for(Ao=0,Aq=Av.preLen;Ao<Aq;Ao++){Af=Ac[Ao];if(Ao==At){Af.set("dtp",Aj);Af.set("isList",An);Af.set("value",Al);Af.set("visible",true);try{if(Av.alias!=="c1"){Af.focus&&Af.focus();}}catch(Ak){}if(Ah===1||Ah===2){Af.constraints.min=0;}if(Af.clearValidation){Af.clearValidation();}}else{Af.set("visible",false);}if(An){Af.set("hint",mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"));}else{Af.set("hint","");}}if(Ai.hasPrompt&&Av.selectedItem&&Av.selectedItem.st===AQ.STP.PROMPT_STRING){Ai.invalid0=false;}switch(Ae.et){case b.AQ:case b.AL:case b.MQ:if(As&&As.p){Av.set("selectedItem",As.p);}else{Av.set("selectedIndex",At);}break;case b.MC:case b.AC:Av.set("selectedItem",Ae[AG[Ae.et]+(2+Am)]);break;}}Av.updating=false;}function h(){var Af=this.parent,Ad=Af.parent.parent.parent,Ae=(this.isValid&&this.isValid())||(!this.isValid&&!mstrmojo.string.isEmpty(this.value)),Ac=Ad.model;Ad["invalid"+Af.cstIndex]=!Ae;if(!this.updating&&Ae){this.updating=true;if(Ac){Ac.edit(Af.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}F(Ad);}function AT(){var Ad=this.parent,Ac=Ad.parent;Ac["invalid"+Ad.cstIndex]=false;}function AD(Ac){this.tip.set("text",Ac);}function D(Ae){var Ag=this.selectedItem;Ae=K.filter(Ae,function(Ah){return(!Ah.icf);});if(Ag){var Ad=K.find(Ae,this.itemIdField,Ag[this.itemIdField]);if(Ad>-1){Ae=Ae.concat();Ae.splice(Ad,1);}}AE(this,A,Ae);var Af=this.items,Ac=Af.length;if(Ac===1){this.singleSelect(0);}this.parent.updateScrollbars();}function I(Ad){var Ac=[{did:660,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP|mstrmojo.validation.TRIGGER.VALUESET},onValid:h,onInvalid:h,onClearValidation:AT,size:6,visible:false}},{did:154,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:h,visible:false}},{did:23,cfg:{scriptClass:"mstrmojo.DateTextBox",cssText:"margin-left:9px;",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:h,onInvalid:h,onClearValidation:AT,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(Ae){mstrmojo.dom.stopPropogation(Ae.hWin,Ae.e);}},visible:false}}];return N(M.copy(Ad,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:V,selectionPolicy:"reselect",items:Ac.concat(),txtIndex:0,calIndex:2,dtxtIndex:2,preLen:Ac.length,insertUnlistedValuesAt:-1,itemIdField:"did",update:function(){AL(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},itemsEffect:undefined,onchange:m}));}function G(Ac){return N(M.copy(Ac,{insertUnlistedValuesAt:-1,postCreate:function(){J.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var Ae=this.parent,Ad=this.response;if((Ad&&Ad.did)!==Ae.lastAttrId){return ;}D.call(this.parent,Ad.fms||[]);},onerr:function(){AE(this.parent,A,[q]);}});},update:function(){var An=this.fmPost,Af=this.parent.parent.parent,Ah=Af.model,Am=Ah&&Ah["a"+An],Ak=!!Am,Ag,Aj,Ao,Ae=Af.disableElementsBrowsing,Ad=Am&&Ae&&Ae(Am);if(Ak){switch(Ah.et){case b.AQ:case b.AL:Aj=Ah.fm;break;case b.AC:Aj=Ah["fm"+An];break;case b.AE:Aj=f(Ah.fn,1);break;}if(this.lastAttrId!==Am.did){this.lastAttrId=Am.did;Ag=[];if(this.isFirstFm){if(!Ad&&(!Am.ilk&&(!Af.ets||Af.ets[b.AE]))){Ag.push(AX);var Ai=B[b.AE],Al=Ai&&Ai.key;Ag=Ag.concat((Al&&Af[Al])||Ai.def||[]);}Ag.push(AK);}if(Aj&&(Ah.et!==b.AE)){Ag.push(Aj);}Ao=this.ajx;Ao.params.attributeId=Am.did;Ao.params.otp=Am.t||12;Ag.push(A);L.makeObservable(Ag);}}if(Ad&&Ah.et===b.AE){Aj=null;}Q(this,Ak,Ag,Aj);if(Ak&&Ao){if(Af.getAttributeForms){D.call(this,Af.getAttributeForms(Am.did)||[]);}else{if(Am.fms){D.call(this,Am.fms);}else{if(Ao){if(Ao._delayId){window.clearTimeout(Ao._delayId);delete Ao._delayId;}Ao._delayId=window.setTimeout(function(){delete Ao._delayId;Ao.send();},500);}}}}}}));}var AC=[AQ.STP.PROMPT,AQ.STP.PROMPT_OBJECTS,AQ.STP.PROMPT_ELEMENTS,AQ.STP.PROMPT_EXPRESSION,AQ.STP.PROMPT_EXPRESSION_DRAFT];function Z(Ac){if(Ac&&!M.isEmpty(Ac)){var Ad=K.hash(AC);M.forEach(Ac,function(Af,Ae){if(Af){Ad[o[Ae]]=true;}});return Ad;}return null;}mstrmojo.rw.ConditionWalkProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.rw.ConditionWalkProvider",browseEs:function S(Af,Ae,Ah){Af.openPopup("eb",{zIndex:Af.parent.zIndex+10,left:Math.round(Ah.x)+"px",top:Math.round(Ah.y)+"px"});var Ad=Af.eb.browser,Ac=Af.model,Ag=Ac&&Ac.a&&Ac.a.did;if(!Ag){return ;}Ad.set("attributeID",Ag);Ad.set("selectedItems",Ac.es?M.clone(Ac.es):[]);Ad.initBrowser();},browseObjs:function AW(Aj,Ac,Ad){Aj.openPopup("ob",{zIndex:Aj.parent.zIndex+10,left:Math.round(Ad.x)+"px",top:Math.round(Ad.y)+"px"});var Ae=Aj.ob.browser;Ae.target=Ac;var Af;switch(Ac.alias){case"dmy":Af=[AQ.TP.ATTR,AQ.TP.DIM];break;case"c0":case"c1":var Ah=Aj.model,Ag=Ah&&Ah.et,Ak=Ah&&Ah.fm,Ai=Ak&&Ak.dtp||(Ah.m?AQ.DTP.DECIMAL:AQ.DTP.UNKNOWN);Af=(Ag===b.MQ||Ag===b.MC)?[AQ.TP.METRIC,AQ.DTP2PROMPT_STP[Ai]]:[AQ.TP.ATTR,AQ.DTP2PROMPT_STP[Ai]];break;default:Af=Z(Aj.ets);Af=Af?M.keyarray(Af,true):[AQ.TP.ATTR,AQ.TP.METRIC,AQ.STP.REPORT_GRID,AQ.STP.REPORT_GRAPH,AQ.STP.REPORT_ENGINE,AQ.STP.REPORT_TEXT,AQ.STP.REPORT_DATAMART,AQ.STP.REPORT_BASE,AQ.STP.REPORT_GRIDGRAPH,AQ.STP.REPORT_NONINTERACTIVE,AQ.STP.FILTER].concat(AC);}Af[Af.length]=AQ.TP.FOLDER;Ae.browse({rootFolderType:Ah&&(Ah.et===b.MQ||Ah.et===b.MC)?5:26,folderLinksContextId:33,onSelectCB:[Aj,"onOBSelect"],browsableTypes:Af.join(",")});},getFm2NodeProps:function AP(){return{alias:"fm2",children:[G({alias:"fm2",fmPost:2})],updateColumnContainer:function Ac(){var Ad=this.parent.parent;this.fm2.update();AD.call(Ad,v);H.call(this);}};},getC0NodeProps:function E(){var Ac=this;return{alias:"c0",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},I({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},I({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false}],updateColumnContainer:function Ad(){this.c0.update();var Ag=this.parent,Ai=Ag.parent,Aj=Ag.parent.model,Al=Aj&&Aj.fn,Ah=Al===O.BETWEEN||Al===O.NOT_BETWEEN||Al===z.BETWEEN||Al===z.BETWEEN_DESCENDING,Af=Al===O.EQUAL||Al===O.NOT_EQUAL||Al===O.GREATER||Al===O.GREATER_EQUAL||Al===O.LESS||Al===O.LESS_EQUAL,Ae=this.idx,Ak=this.next;this.browseLink.set("visible",Ai.objectBrowsingEnabled&&n(Aj,Ai.ets));this.btwn.set("visible",Ah);this.c1.set("visible",Ah);if(Ah){this.c1.update();}else{Aj.edit("c1",{v:null,dtp:null,skipET:true});}if(Aj.a2&&Af){if(!(Ak&&Ak.fm2)){Ag.insertAndRemoveTrailing(Ae,Ac.getFm2NodeProps());}}else{Ag.removeTrailingContainer(Ae);}AD.call(Ai,Aj.a?w:Aj.m?r:"");H.call(this);}};},getFnNodeProps:function Aa(){var Ac=this;return{alias:"fn",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(9579,"Condition")},G({alias:"fn",allowUnlistedValues:false,update:function(){var Aj=this.parent.parent.parent,Af=Aj.model||{},Ak=Af.et,Ai,Al=false,Am,Ae;switch(Ak){case b.AE:Al=!!Af.a;break;case b.AQ:case b.AC:case b.AL:Al=!!(Af.fm&&Af.fm.did);Ai=Al?Af.fm.dtp:null;break;case b.MQ:case b.MC:Al=!!Af.m;Ai=Al?AQ.METRIC_DTP:null;break;}if(Al){var An=l[Ai];if((this.lastEt!==Ak)||(this.lastFnDtp!==An)){this.lastEt=Ak;this.lastFnDtp=An;var Ah=Ak?B[Ak]:null,Ag=Ah&&Ah.key;Am=(Ag&&Aj[Ag])||Ah.def||[];if(typeof (Am)==="object"){Am=Am[An]||Am["*"];}}Ae=f(Af.fn,Af.fnt||1);}Q(this,Al,Am,Ae);this.parent.updateScrollbars();}})],updateColumnContainer:function Ad(){this.fn.update();var Ae=this.parent,Af=Ae.parent,Ag=Af.model,Ai=Ag&&Ag.fn,Ah=this.next,Aj=Ai===O.IS_NULL||Ai===O.IS_NOT_NULL;if(Ai&&Aj){Ae.removeTrailingContainer(this.idx);}else{if(Ai&&!(Ah&&Ah.c0)){Ae.insertAndRemoveTrailing(this.idx,Ac.getC0NodeProps());}}AD.call(Af,Ag.a?x:Ag.m?u:"");Ah=this.next;if(Ah){Ah.updateColumnContainer();}}};},getEsNodeProps:function T(){var Ae=[{scriptClass:"mstrmojo.ui.CheckList",alias:"es",itemIdField:"v",allowUnlistedValues:true,insertUnlistedValuesAt:0,selectionPolicy:"toggle",postCreate:function Ad(){J.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var Ap=this.parent,Aj=this.response;if((Aj&&Aj.did)!==Ap.lastAttrId){return ;}var Al=(Aj&&Aj.es)?K.filter(Aj.es,function(Aq){return !U.isNullElem(Aq.v);}):[],Ao=Ap.parent.parent.parent.model&&Ap.parent.parent.parent.model.es,Am=function(Aw,Ar){var Av=Aw&&Aw.length||0,Au=Ar&&Ar.length||0,Aq=[],At,As;for(At=0;At<Au;At++){for(As=0;As<Av;As++){if(Ar[At].n===Aw[As].n){break;}}if(As===Av){Aq.push(Ar[At]);}}return Aq;},An=function(Aq,Ar,Au){var At=[],As;K.forEach(Aq,function(Av){As=K.filterOne(Ar,function(Aw){return Av[Au]&&Aw[Au]&&Av[Au]===Aw[Au];});if(As){At.push(As);}});return At.length===Aq.length?At:Aq;};Ao=Ao&&An(Ao,Al,"v");if(Ap.allowUnlistedValues){var Ak=Am(Al,Ao);Al=(Ap.insertUnlistedValuesAt===0)?Ak.concat(Al):Al.concat(Ak);}AR(Ap,Al,Ao,null);Ap.parent.updateScrollbars();},onerr:function(){AE(this.parent,A,[q]);}});},onselectionChange:function Ah(Aj){mstrmojo.ListBase.prototype.onselectionChange.call(this,Aj);m.call(this,Aj);},update:function Ag(){var Am=this.parent.parent.parent,Al=Am.model,Aq=Al&&Al.a,Ar=!!Aq&&!Aq.ilk,As,Aj,Ap,An,Ak,At;if(Ar){if(this.lastAttrId!==Aq.did){this.lastAttrId=Aq.did;As=Al.es;An=As&&As.length;As=An?As.concat():[];As.push(A);if(An){Ap=[];for(Ak=1;Ak<=An;Ak++){Ap[Ak]=Ak;}}At=this.ajx;Am.updateBrowseElementsParams(At.params,Aq);}else{Aj=Al.es;}}AI(this,Ar,As,Aj,Ap);if(Ar&&At){if(Am.getElements){var Ao=this;Am.getElements(Aq,{success:function(Au){AR(Ao,Au.es||[],Am.model&&Am.model.es,null);Ao.parent.updateScrollbars();},failure:function(){AE(Ao,A,[q]);}});}else{At.send();}}},setupScrollNodes:function Af(){this.scrollNode=null;}}];if(!mstrApp.isSingleTier){Ae.splice(0,0,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7928,"Browse elements..."),onclick:function Ac(){this.parent.parent.parent.browse(this.parent.es);}});}return{alias:"es",children:Ae,updateList:function(Aj){AI(this.es,true,Aj,this.parent.parent.model.es,null);this.updateScrollbars();},updateColumnContainer:function Ai(){var Aj=this.parent.parent;this.es.update();AD.call(Aj,AA);}};},getFmNodeProps:function g(){var Ac=this;return{alias:"fm",children:[G({alias:"fm",fmPost:"",filter:false,isFirstFm:true})],updateColumnContainer:function Ad(){this.fm.update();var An=this.parent,Ai=An.parent,Ah=Ai.model,Ak=Ah&&Ah.fm,Am=this.idx,Al=Ah&&Ah.a,Af=Ai.disableElementsBrowsing,Ae=Al&&Af&&Af(Al);var Aj=(Ah.etWas&&Ah.etWas===b.AE)?AZ:AM,Ag=AM;if(Ah.et===b.AE&&!Ae){Ag=AZ;}if(Aj!==Ag||Ag===AM){An.removeTrailingContainer(Am);if(Ag===AM&&Ak){An.addNextColumn(Ac.getFnNodeProps());}else{if(Ag===AZ){An.addNextColumn(Ac.getEsNodeProps());}}}AD.call(Ai,AB);H.call(this);}};},getTargetNodeProps:function R(){var Ac=this;return{alias:"target",target:null,browseLink:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(11859,"Based On")},N({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},onObjBrowsed:function(Af){if(Af.st===W.FILTER||Af.t===AV.REPORT||Af.t===AV.PROMPT){this.parent.parent.parent.onOK();}},update:function Ae(){var Ag=this.parent.parent.parent,Ah=Ag.model,Ak=Ag.targetsLastMod,Al=Ah&&Ah.et;if(this.lastModel!==Ah||this.targetsLastMod!==Ak){this.lastModel=Ah;this.targetsLastMod=Ak;var Af=Ag.targets,Am=Ag.ets;if(Am&&Af&&Af.length){var Aj=Z(Ag.ets);Af=K.filter(Af,function(An){return Aj[An[AJ]];});}var Ai=Ah&&Ah[AG[Al]];Q(this,true,AQ.getSortedObjectsByTypeGroup(Af),Ai);this.parent.updateScrollbars();}}}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.target);}}],updateColumnContainer:function Ad(){this.target.update();var Ag=this.parent,Ah=Ag.parent,Ai=Ah.model,Ak=Ai&&Ai.et,Af=this.idx,Aj=this.next;this.browseLink.set("visible",Ah.objectBrowsingEnabled);if(Ak){switch(Ak){case b.AQ:case b.AL:case b.AC:case b.AE:if(Ai.a&&!(Aj&&Aj.fm)){this.parent.insertAndRemoveTrailing(Af,Ac.getFmNodeProps());}break;case b.MQ:case b.MC:if(Ai.m&&!(Aj&&Aj.fn)){this.parent.insertAndRemoveTrailing(Af,Ac.getFnNodeProps());}break;case b.R:case b.F:case b.XML:this.parent.removeTrailingContainer(Af);break;}}Aj=this.next;if(Aj){Aj.updateColumnContainer();}}};}});var X=mstrmojo.rw.ConditionWalkProvider;X.updateOkBtn=F;X.setTip=AD;X.getChildJSON=N;X.updateList=Q;X.fmJson=G;X.cstJson=I;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo.ui.ColumnWalk","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ConditionModel","mstrmojo.rw.ConditionWalkProvider");var P=mstrmojo.Widget,H=mstrmojo.array,E=mstrmojo.dom,M=mstrmojo.hash,A=mstrmojo.mstr.EnumNodeDimty,S=mstrmojo.rw.ConditionWalkProvider.updateOkBtn,I=mstrmojo.rw.ConditionWalkProvider.setTip;var C=mstrmojo.desc(11899,"Select a dataset object.");var K=H.hash([A.NodeDimtyOutputLevel]);function D(){var T=this.model;if(T){if(!T.attachEventListener){mstrmojo.hash.make(T,mstrmojo.ConditionModel,{});}T.attachEventListener("edit",this.id,"onmodeledit");}}function L(U,T){if(T&&T.detachEventListener){T.detachEventListener("edit",U.id,"onmodeledit");}}function N(Y,T){var W=T,X=[],V=[],U=[],Z=false;M.forEach(W,function(a){X=X.concat(a.att.filter(function(b){return b.did===Y;}));});Z=X[0]&&X[0].da;X.forEach(function(a){V=V.concat(a.fs||[]);});V.forEach(function(a){if((a.obf||Z)&&U.filter(function(b){return b.did===a.fid;}).length===0){U.push({did:a.fid,dtp:mstrmojo.expr.mapBaseFormTypeToDataType(a.bftp),n:a.fnm,t:a.t});}});return U;}mstrmojo.rw.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.rw.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},walkNode:function(){return this.domNode.children[1];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function J(){P.visibleMarkupMethod.call(this);if(this.visible){this.initWalk();}},onheightChange:P.heightMarkupMethod,onwidthChange:P.widthMarkupMethod},layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",applyNode:"auto"},xt:true},editor:undefined,columnWalk:undefined,tip:undefined,walkProvider:null,objectBrowsingEnabled:true,postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=mstrmojo.insert(mstrmojo.rw.ConditionWalkProvider);}},initWalk:function O(){var T=this.columnWalk,U=this.walkProvider;I.call(this,C);T.removeTrailingContainer(-1);T.addNextColumn(U.getTargetNodeProps());T.target.updateColumnContainer();S(this);},updateBrowseElementsParams:function(W,V){W.attributeID=V.did;W.otp=V.t||12;var U=this.editor,T=U&&U.onUpdateBrowseElementsParams;if(T){T.call(U,W,V);}},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"750px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var T=this.parent;if(T.close){T.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var T=this.parent;if(T.onOK){T.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:C,ignoreLayout:true}],eb:{scriptClass:"mstrmojo.Editor",cssClass:E.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(U){var T=this.parent.opener;T.updateBrowseElementsParams(U,T.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-WebButton hot",cssText:"width: 66px;",onclick:function(){var T=this.parent.parent,U=T&&T.opener;if(U){U.onEBSelect();U.closePopup();}}},{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-WebButton",cssText:"min-width: 66px; margin-left: 11px;",onclick:function(){var T=this.parent.parent,U=T&&T.opener;if(U){U.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,upButtonVisible:true,scrollableIncFetch:true,showCompletePath:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true,minSearchLength:1}]},_set_model:function R(W,T){var U=this.model,V=(T!==U);if(V){L.call(this,U);T.dimtyTypes=this.dimtyTypes||K;this.model=T;D.call(this,T);if(this.hasRendered&&this.visible){this.columnWalk.target.updateColumnContainer();}}return V;},onmodeledit:function G(T){this.columnWalk[T.prop==="c1"?"c0":T.prop].updateColumnContainer();S(this);},browse:function F(V){var X=this.parent.editorNode,W=function(Z,b){var Y=mstrmojo.dom.position(Z,true),a=mstrmojo.dom.position(b,true);return{x:Y.x+Y.w,y:a.y};},T=this.columnWalk,U=this.walkProvider;switch(V&&V.alias){case"target":case"dmy":U.browseObjs(this,V,W(V.alias==="target"?T.target.domNode:this.dmyNode,X));break;case"c0":case"c1":U.browseObjs(this,V,W(T.c0.domNode,X));break;case"es":U.browseEs(this,V,W(T.es.domNode,X));break;}},onOBSelect:function(X){var V=this.ob.browser,Z=V.target;this.closePopup();var U=this.targets,Y=Z.itemIdField,W=U||[],T=H.find(U,Y,X[Y]);if(T===-1){W.push(X);this.targets=W;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}Z.setSelectedItems([X],Z.multiSelect);if(Z.onObjBrowsed){Z.onObjBrowsed(X);}},onEBSelect:function(){var U=this.eb.browser,W=this.columnWalk.es.es;W.set("selectedIndices",{});var T=W.items,V=[];H.forEach(U.selectedItems||[],function(Y){if(H.find(W.items,"v",Y.v)<0){V.push(Y);}});var X=W.insertUnlistedValuesAt||0;if(X<0){X=T.length;}W.set("items",T.slice(0,X).concat(V).concat(T.slice(X)));W.setSelectedItems(U.selectedItems,false);},destroy:function Q(U){var T=this.walkProvider;if(T&&T.destroy){this.walkProvider.destroy();}this._super(U);}});mstrmojo.rw.ConditionWalk.getAttForms=N;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.expr","mstrmojo.dom","mstrmojo.form","mstrmojo.boxmodel","mstrmojo.Obj","mstrmojo.Arr","mstrmojo.string","mstrmojo.Box","mstrmojo.TBox","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.TextBox","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.Dial","mstrmojo.WidgetList","mstrmojo.FilterExpr","mstrmojo.CGEOptions","mstrmojo.ConditionWalk","mstrmojo.SaveAsEditor","mstrmojo.CGFormatEditor");var V=mstrmojo.expr,E=V.ET,K=V.BRANCH_FNS,R=mstrmojo.hash,Y=mstrmojo.boxmodel,G=mstrmojo.Arr,S=mstrmojo.Obj,L=mstrmojo.string,W=mstrmojo.dom,T=mstrmojo.expr.TP,B=mstrmojo.expr.STP;function F(a){var f={};if(a){var d=a.items;for(var c=0,Z=(d&&d.length)||0;c<Z;c++){var e=d[c],b=e&&e.expr;if(b){V.findTargets(b,"did",f);}}}return R.valarray(f);}function P(b){var a=b.model;b.targets=F(a);b.targetsLastMod=new Date();if(!a){a=new S({});b.model=a;}var d=a.items;if(!d){d=mstrmojo.Arr.makeObservable([]);a.items=d;}else{if(!d.attachEventListener){d=R.make(d,G);}}for(var c=0,Z=d.length;c<Z;c++){var e=d[c];if(!e.attachEventListener){e=R.make(e,S);}}}var M=mstrmojo.desc(4778,"Element"),U=new RegExp(M+"\\s*(\\d+)","i"),C=10000;function N(e){var d=1;for(var b=0,a=(e&&e.length)||0;b<a;b++){var f=e[b].n,Z=f&&f.match(U);if(Z){var c=parseInt(Z[1],10);d=Math.max(c+1,d);}}return M+" "+d;}var H=200;function D(d,c,b){var a=mstrmojo.all.mstrCGE,e=W.delta(c.domNode,a.editorNode);e.y+=(b=="andor"?16:parseInt(c.domNode.offsetHeight,10));var Z={condition:c,zIndex:a.zIndex+10,left:e.x+"px",top:e.y+"px"},f;switch(b){case"andor":f="andOrPopupRef";break;case"condition":f="conditionPopupRef";Z.model=R.clone(d);Z.targets=a.targets;Z.targetsLastMod=a.targetsLastMod;break;}a.openPopup(f,Z);}function X(a){var b=a.parent.data;if(b){var Z=a.items;b.expr=Z&&Z[0];}}function J(c){if(c.constructor!==Array){c=[c];}var g,f={b:0,c:0},h,e,a;for(var d=0,Z=c.length;d<Z;d++){g=c[d];if(!(g&&g.et)){continue;}h=g.nds;if(h){e=J(h);f.b+=e.b;f.c+=e.c;}else{a=(g.et===E.B);f[a?"b":"c"]++;}}return f;}function O(Z){var b=J(Z.value),a=this.tree;a.set("bandingCount",a.bandingCount+b.b);a.set("conditionCount",a.conditionCount+b.c);}function A(Z){var b=J(Z.value),a=this.tree;a.set("bandingCount",a.bandingCount-b.b);a.set("conditionCount",a.conditionCount-b.c);}function I(a){var d=mstrmojo.all.mstrCGE,Z=d.model,e=Z.did,c=Z.cgp,b=d.getXML();return{taskId:"saveCustomGroup",xml:b,objectID:e||"",description:Z.desc||"",name:Z.n||"",saveAs:a,aggregation:c.agg,flatten:c.flat,parentFirst:c.pf,reportFilterInteraction:c.rfi};}mstrmojo.CustomGroupEditor={id:"mstrCGE",title:mstrmojo.desc(7919,"Custom Group Editor"),scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-charcoalboxe",cssText:"width:750px;",zIndex:10,model:null,readOnly:false,help:"custom_group_editor.htm",formatPopupRef:{scriptClass:"mstrmojo.CGFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116),left:"100px",top:"100px",useAnimate:false,height:350,slot:"containerNode",help:"formatting_a_custom_group.htm",locksHover:true,model:null,_set_model:function(a,Z){P(mstrmojo.all.mstrCGE);this.model=Z;this.model.selectedIndex=mstrmojo.all.mstrCGEls.selectedIndex;return true;},bindings:{model:function(){return mstrmojo.all.mstrCGE.model;}},onOpen:function(){this.set("model",mstrmojo.all.mstrCGE.model);}},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:mstrmojo.desc(2105,"Custom Group"),browsableTypes:"8,257",onObjectSaved:function(b){var a=mstrmojo.all.mstrCGE,Z=a&&a.model;if(Z){Z.set("did",b.did);Z.set("n",b.name);Z.set("desc",b.desc);}if(a.noRefresh!==true){a.needRefreshPage=true;}}},optionsRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-CGEOptions",contentNodeCssClass:"mstrmojo-balloon",left:"100px",top:"230px",slot:"containerNode",help:"Custom_Group_Options_dialog_box.htm",showTitle:true,title:mstrmojo.desc(7969,"Custom Group Options"),onOpen:function(){var Z=mstrmojo.all.mstrCGE,a=this.optionsEditor;a.open(Z.model,{closeCB:[this,"close"]});},children:[{scriptClass:"mstrmojo.CGEOptions",alias:"optionsEditor"}]},postCreate:function(){P(this);},_set_model:function(d,Z){var b=this.model,c=b!==Z,a=mstrmojo.all.mstrCGEls;if(c){this.model=Z;P(this);if(a){a.clearSelect();}}return c;},children:[{scriptClass:"mstrmojo.TBox",alias:"header",cssText:"width: 100%",children:[{scriptClass:"mstrmojo.Label",alias:"name",cssClass:"mstrmojo-charcoalbox subtle mstrmojo-cge-name",emptyText:mstrmojo.desc(7920,"Enter Custom Group name here."),bindings:{text:function(){var Z=mstrmojo.all.mstrCGE.model.n||this.emptyText;return Z;}},onclick:function(){var Z=mstrmojo.all.mstrCGE,a=W.delta(this.domNode,Z.containerNode);Z.openPopup("inlineTextRef",{left:a.x+"px",top:a.y-(W.isIE7?1:0)+"px",txtConfig:{cssClass:"mstrmojo-cge-name-edit",value:Z.model.n||"",onEnter:function(){var b=L.trim(this.value);if(b){Z.model.set("n",b);}this.parent.close({enter:true});},onCancel:function(){this.set("value",Z.model.n);},prevTab:null,nextTab:Z.header.desc}});}},{scriptClass:"mstrmojo.Label",alias:"desc",cssClass:"mstrmojo-charcoalbox subtle mstrmojo-cge-desc",emptyText:mstrmojo.desc(7921,"Enter Custom Group description here."),rows:1,bindings:{text:function(){var Z=mstrmojo.all.mstrCGE.model.desc||this.emptyText;return Z;}},onclick:function(){var Z=mstrmojo.all.mstrCGE,a=W.delta(this.domNode,Z.containerNode);Z.openPopup("inlineTextRef",{left:a.x+"px",top:a.y-(W.isIE7?1:0)+"px",txtConfig:{cssClass:"mstrmojo-cge-desc-edit",value:Z.model.desc||"",onEnter:function(){Z.model.set("desc",L.trim(this.value));this.parent.close({enter:true});},onCancel:function(){this.set("value",Z.model.desc);},prevTab:Z.header.name,nextTab:null}});}}]},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-CGE-content",alias:"content",children:[{id:"mstrCGEls",scriptClass:"mstrmojo.WidgetList",cssClass:"mstrmojo-CustomGroupEls",bindings:{items:"mstrmojo.all.mstrCGE.model.items"},multiSelect:false,renderOnScroll:false,draggable:true,dropZone:true,allowCopy:false,allowDrop:function(b){var a=b&&b.src,Z=a&&a.widget;return(Z===this);},itemIdField:null,itemDisplayField:"n",onchange:function(d){var a=this.selectedIndex,c=this.ctxtBuilder.itemWidgets,b;for(var e=0,Z=c.length;e<Z;e++){b=c[e];if(b&&e!=a){b.filterExpr.clearTreeSelect();}}},getNextId:function(){return ++C;},itemFunction:function(b,Z,a){return new mstrmojo.CustomGroupEl({cssClass:"mstrmojo-charcoalbox",data:b,parent:a,state:b.isNew?1:0,onRender:b.isNew?function(){this.filterExpr.newCondition();delete this.data.isNew;}:mstrmojo.emptyFn,onclick:function(c){var d=W.eventTarget(c.hWin,c.e);if(d===this.titleNode){var e=mstrmojo.all.mstrCGE,g=W.delta(this.titleNode,e.containerNode),f=this;e.openPopup("inlineTextRef",{left:g.x+(W.isIE?1:0)+"px",top:g.y+(W.isIE7?-1:1)+"px",txtConfig:{cssClass:"mstrmojo-cge-elname-edit",value:this.data.n||"",onEnter:function(){var h=L.trim(this.value);if(h){f.data.n=h;f.paint();}this.parent.close({enter:true});},onCancel:function(){this.set("value",f.data.n);},prevTab:null,nextTab:null}});}},postCreate:function(){this.children=[{scriptClass:"mstrmojo.FilterExpr",slot:"exprNode",alias:"filterExpr",bindings:{items:"var ex = this.parent.data.expr; return ex ? [ex] : []"},draggable:true,dropZone:true,allowCopy:false,makeObservable:true,bandingCount:0,conditionCount:0,getItemConfig:function g(m,h,n){var l=this.constructor.prototype.getItemConfig.call(this,m,h,n);l.getPrefixAndOrToolsMarkup=function k(){return('<img class="mstrmojo-outdent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'" /><img class="mstrmojo-outdent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'" onclick="mstrmojo.all[\'{@id}\'].out()" /><img class="mstrmojo-indent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'" /><img class="mstrmojo-indent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'" onclick="mstrmojo.all[\'{@id}\'].ind()" />');};return l;},onadd:function(h){X(this);O.apply(this,[h]);},onremove:function(h){X(this);A.apply(this,[h]);},editable:true,onRender:function(){var k=J(this.items),h=this.tree;h.set("bandingCount",k.b);h.set("conditionCount",k.c);},isEditable:function f(k){if(!this.editable){return false;}var h=false;switch(k&&k.et){case E.ANDOR:case E.MQ:case E.AQ:case E.AL:case E.AC:case E.MC:case E.AE:case E.R:case E.F:h=true;break;case E.XML:h=!k.xml;}if(!h){mstrmojo.all.mstrCGE.set("readOnly",true);}return h;},onnodeclick:function e(h){if(!this.editable){return ;}D(this.data,this,h&&h.part);},onnodeadd:O,onnoderemove:A,allowDrop:function c(h){var l=h&&h.src,o=l&&l.data,n=o&&o.et,m=(n===E.B),k=this.tree;return n&&((m&&(k.conditionCount===0))||(!m&&(k.bandingCount===0)));},onNew:function d(h){D(h.data,h.widget.ctxtBuilder.itemWidgets[h.index],"condition");}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-addCondition",text:mstrmojo.desc(1994,"Add Condition"),slot:"exprToolsNode",onclick:function(){this.parent.filterExpr.newCondition(null,true);},bindings:{enabled:function(){return this.parent.filterExpr.bandingCount===0;}}}];}});}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-newElement",text:mstrmojo.desc(7922,"New Custom Group Element"),alias:"addBtn",title:mstrmojo.desc(7923,"Add new Custom Group Element"),onclick:function(){var Z=mstrmojo.all.mstrCGEls;var a=Z.add([{n:N(Z.items),did:++C,isNew:true}]);Z.scrollTo(a);}}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",cssText:"width: 100%",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(4596,"Format..."),onclick:function(){var Z=mstrmojo.all.mstrCGE;Z.openPopup("formatPopupRef",{zIndex:Z.zIndex+10});},bindings:{enabled:function(){return mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(7924,"Options..."),onclick:function(){var Z=mstrmojo.all.mstrCGE;Z.openPopup("optionsRef",{zIndex:Z.zIndex+10});}}]},{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(5891,"Save"),onclick:function(){var a=mstrmojo.all.mstrCGE,Z=a.model,f=Z.did,d=a.isValid(true),c=mstrmojo.desc(8113,"New Custom Group");if(d){if(!f){a.openPopup("saveasRef",{name:Z.n||c,desc:Z.desc||"",folderLinksContextId:22,rootFolderID:Z.pf,saveParams:I(true),zIndex:a.zIndex+10});return ;}var b=this,e=I(false);this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){b.set("enabled",true);b.set("iconClass","");},failure:function(g){b.set("enabled",true);b.set("iconClass","");mstrmojo.alert(g.getResponseHeader("X-MSTR-TaskFailureMsg"));}},e);}},bindings:{enabled:function(){return !mstrmojo.all.mstrCGE.readOnly&&mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(628,"Save As"),onclick:function(){var a=mstrmojo.all.mstrCGE,Z=a&&a.model,c=a.isValid(true),b=mstrmojo.desc(8113,"New Custom Group");if(c){a.openPopup("saveasRef",{name:Z.n||b,desc:Z.desc||"",folderLinksContextId:22,rootFolderID:Z.pf,saveParams:I(true),zIndex:a.zIndex+10});}},bindings:{enabled:function(){return !mstrmojo.all.mstrCGE.readOnly&&mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){mstrmojo.all.mstrCGE.close();}}]}]}],onOpen:function(){if(this.readOnly){mstrmojo.all.mstrCGE.set("title",mstrmojo.desc(8031,"Custom Group Editor (Read Only)"));mstrmojo.alert(mstrmojo.desc(8022));}},onClose:function(){this.readOnly=false;if(this.needRefreshPage){var Z=mstrApp;mstrmojo.form.send({evt:5005,src:Z.name+"."+Z.pageName+".5005"});this.needRefreshPage=false;}},getXML:function Q(){var a=this.model;var g='<exp> <nd et="14" n="OR" fn="20" ce="'+(a.cgp.ce?-1:0)+'" isp="'+(a.cgp.isp?-1:0)+'" ><nds>',b="</nds></nd></exp>",f={a:true,a2:true,a3:true,agg:true,cc:true,ce:true,cgp:true,cs:true,desc:true,did:true,dmt:true,dmy:true,dtp:true,es:true,et:true,expr:true,f:true,flat:true,flt:true,fm:true,fm2:true,fm3:true,fn:true,fnt:true,fres:true,gb:true,isp:true,items:true,m:true,m2:true,m3:true,n:true,nds:true,not:true,pf:true,p:true,r:true,rps:true,st:true,t:true,utgt:true,utp:true,uts:true,v:true,xml:true},Z={getArrItemName:function(p,m,o){return p.substr(0,p.length-1);},isSerializable:function(v,t,r){if(v=="xml"){var n=t[r].xml;return{att:'hasXML = "-1"',child:n};}else{if(mstrmojo.array.indexOf(["header_format","grid_format","child_header_format","child_grid_format"],v)>-1){var w=t[r][v];if(!w){return{};}var p="<"+v+">";for(var u in w){p+="<prs n='"+u+"'>";var o=w[u];for(var m in o){var q=o[m];p+="<pr n='"+m+"' v='"+(q=="pru"?"":q)+"'";p+=q=="pru"?' pru="1"':"";p+="/>";}p+="</prs>";}p+="</"+v+">";return{child:p};}}return(f[v])?true:false;},skipNull:true},e=a.items,l=[];for(var c=0,d=e.length;c<d;c++){var k=e[c],h=k.expr;h.n=k.n;if(h.fnt&&h.fnt==V.FNT.PER&&h.cs&&h.cs[0]){h.cs[0].v+="%";}l[c]=L.json2xml("nd",[{ce:k.ce||false,isp:k.isp||false,header_format:k.header_format,grid_format:k.grid_format,child_header_format:k.child_header_format,child_grid_format:k.child_grid_format},k.expr],Z);}return g+l.join("")+b;},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,slot:"containerNode",children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onTab:function(a){if(this.onEnter){this.onEnter();}var Z=W.shiftKey(a.hWin,a.e)?this.prevTab:this.nextTab;if(Z&&Z.onclick){Z.onclick();}},onblur:function(){if(this.onEnter){this.onEnter();}},onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var a=this.txt,b=this.txtConfig;if(b){for(var Z in b){a.set(Z,b[Z]);}}a.focus();},onClose:function(Z){if(!Z||(!Z.cancel&&!Z.enter)){this.txt.onEnter();}}},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",cssText:"width: auto;",contentNodeCssClass:"mstrmojo-balloon",left:"250px",top:"15px",slot:"containerNode",autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var Z=this.condition,c=Z&&Z.data&&Z.data.not,d=Z&&Z.parent,a=d&&d.data,b=(a&&a.fn)+(c?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(b)?null:{did:b});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",items:[{did:19,n:K[19]},{did:20,n:K[20]},{did:19+21,n:K["19_21"]},{did:20+21,n:K["20_21"]}],onchange:function(){if(this.opening){return ;}var a=this.parent,Z=a.condition,g=this.selectedItem,f=g&&g.did,e=f>21?true:null,c=f-(e?21:0);a.close();var b=Z&&Z.parent;if(b&&b.data&&b.data.et===V.ET.ANDOR){b.edit(Z,c,e);}else{var h=Z&&Z.data;if(h&&(h.not!==e)){h.not=e;Z.paint();}}}}]},conditionPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-Editor-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",title:mstrmojo.desc(7953,"Condition Editor"),help:"condition_editor.htm",slot:"containerNode",onOpen:function(){this.walk.set("targets",this.targets);this.walk.set("targetsLastMod",this.targetsLastMod);this.walk.set("model",this.model);var Z=[T.ATTR,T.METRIC,B.REPORT_GRID,B.REPORT_GRAPH,B.REPORT_ENGINE,B.REPORT_TEXT,B.REPORT_DATAMART,B.REPORT_BASE,B.REPORT_GRIDGRAPH,B.REPORT_NONINTERACTIVE,B.FILTER,B.PROMPT,B.PROMPT_ELEMENTS,B.PROMPT_EXPRESSION,B.PROMPT_EXPRESSION_DRAFT];this.walk.set("browsableTypes",Z);},onClose:function(){var Z=this.condition;if(Z.isEmpty()){Z.del();}},children:[{scriptClass:"mstrmojo.ConditionWalk",alias:"walk",cssText:"height:"+H+"px",targets:null,ets:null,onOK:function(){var Z=this.parent,a=Z.condition;R.copy(this.model.get(),R.clear(a.data));a.paint();Z.close();}}]},isValid:function(c){var b=mstrmojo.all.mstrCGE.model.items,Z=b.length,a,d="";if(Z>0){for(a=0;a<Z;a++){if(!b[a].expr){d+=b[a].n+",";}}if(d){d=d.replace(/,$/,"");mstrmojo.alert(mstrmojo.desc(7947).replace("#",d));return false;}}else{mstrmojo.alert("Custom Group does not have any element defined. Please fix it before saving.");return false;}return true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.ToolbarPopup","mstrmojo.ui.editors._HostsControls","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.models.FormatModel","mstrmojo.css");var B=mstrmojo.models.FormatModel;mstrmojo.ui.editors.CharacterToolbarPopup=mstrmojo.declare(mstrmojo.ui.editors.ToolbarPopup,[mstrmojo.ui.editors._HostsControls,mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.CharacterToolbarPopup",textAlignJustify:true,textAlignValueMap:null,textAlignFmtName:mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES.TEXT_ALIGN,btnTextAlign:null,init:function D(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var K=this.textAlignJustify,H=this,F=function(P,Q,O){H.raiseFormatValueChange(P,Q,O);},L=this.getHCGControls(F),J=L.fontFamily,N=L.fontSize,G=L.fontColor,M={alias:"btnTextAlign",includeJustify:K,onValueChange:function(P,O){F(H.textAlignFmtName,P,O);}};J.width="125px";N.width="50px";G.width="50px";this.width=K?"485px":"456px";var E=this.textAlignValueMap;if(E){M.itemsValueMap=E;}this.addChildren([J,L.fontStyle,N,G,new mstrmojo.vi.ui.TextAlignButtonBar(M)]);},shouldPropagateLockHover:function C(){return false;},setFormatSource:function A(E){this._super(E);this.syncControls(function(){if(this.textAlignFmtName in E){this.btnTextAlign.singleSelectByField(E[this.textAlignFmtName],"v");}else{this.btnTextAlign.singleSelectByField(B.getFormatBlockValue(E,B.ENUM_PROPERTY_NAMES.TEXT_ALIGN),"id");}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.css");mstrmojo.ui.editors.controls.CharacterGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,[mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",init:function A(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var H=this,C=this.getHCGControls(function(K,L,J){if(!H._sync){H.raiseFormatValueChange(K,L,J);}}),D=[];Object.keys(C).forEach(function(J){this[J]=C[J];}.bind(this));var B=this.fontFamily,I=this.fontStyle,G=this.fontSize,F=this.fontColor;if(B){D.push(B);}if(I){D.push(I);}if(G){G.slot="col1Node";F.slot="col2Node";D.push({scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[G,F]});}if(D.length){this.addChildren(D);}}});mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS=mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS;}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","num","css","Container","Box","Label","EditableLabel","Image");mstrmojo.requiresClsP("mstrmojo.threshold","ColorBand","ImageBand","MarkersNode","ColorMarker","ThresholdModel");var E=mstrmojo.dom,c=mstrmojo.num,g=mstrmojo.css,C=["bands","markers"];var Z=0,D=1;var d=mstrmojo.threshold.ThresholdModel.SLIDER_MODE;function F(h){var k;if(h===C[Z]){k=this.sliderMode===d.IMAGE_BASED?new mstrmojo.threshold.ImageBand():new mstrmojo.threshold.ColorBand();}else{k=new mstrmojo.threshold.ColorMarker();}this[h].addChildren([k]);}function J(w){var v=this[C[w]],l=v.children,m=l?l.length:0,u=this.getComp(),n=this.getPalette(),q=this.width,r=w?u.length-1:u.length,x=this.sliderMode===d.IMAGE_BASED,t,k,h;if(m>r){for(t=m-r-1;t>=0;t--){v.removeChildren(l[t]);}}else{if(r>m){for(t=0;t<r-m;t++){F.call(this,C[w]);}}}if(w===0&&this.getReversedValue()){n=n.concat().reverse();}l=v.children;var p,o;for(t=0;t<r;t++){k=l[t];p=parseInt(t===0?0:q*u[t-1],10);o=parseInt(q*u[t],10);if(w===0){k.set("left",(this.containerNode.offsetLeft+p+1)+"px");h=o-p;g.toggleClass(k.domNode,"no-border",!h);k.set("width",h+"px");if(x){k.set("src",n[t]);k.domNode.firstChild.style.left=k.domNode.clientWidth/2-12+"px";}else{k.set("backgroundColor",n[t]);}}else{k.set("left",o-(x?0:1)+"px");}k.set("index",t);}}function A(k,h,l){h.forEach(function(o){var n=k[o.id]={palette:[],comp:[],reversed:false};o.bands.forEach(function(m){n.palette.push(m[l?"url":"bc"]);n.comp.push(m.end/100);});});}function H(){var h=this.parent.model,k={};A(k,h.getDefaultColors(),false);A(k,h.getDefaultImages(),true);return k;}mstrmojo.threshold.TextBubble=mstrmojo.declare(mstrmojo.EditableLabel,null,{scriptClass:"mstrmojo.EditableLabel",visible:false,cssClass:"editable-bubble",text:"",isPercentage:true,maxValue:1,showBubble:function(h){this.updatePosition(h);this.updateText(h);this.set("visible",true);},hideBubble:function(){this.set("visible",false);},updatePosition:function B(h){this.domNode.style.left=this.parent.width*h+"px";},updateText:function(m){var l=this.parent,h=l.parent.model,k=h.getRealValue(m,l.selectedOption);if(l.selectedOption===7){k=c.formatByMask(h.getFormatString(),k);}if(this.isPercentage){k+="%";}this.set("text",String(k));}});mstrmojo.threshold.ColorSlider=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.threshold.ColorSlider",markupString:'<div class = "mstrmojo-color-slider {@cssClass}"  style="{@cssText}" mstrAttach:click,keyup><div class="labels"></div><input type="text" class="hidden-field"></div>',markupSlots:{containerNode:function a(){return this.domNode;},labelsNode:function f(){return this.domNode.firstChild;},hiddenField:function I(){return this.domNode.lastChild;}},sliderMode:d.COLOR_BASED,baseColor:undefined,editableBubble:undefined,hoverBubble:undefined,bands:undefined,markers:undefined,colorMap:undefined,selectedOption:undefined,getComp:function Q(){return this.colorMap[this.baseColor].comp;},getPalette:function S(){return this.colorMap[this.baseColor].palette;},getReversedValue:function b(){var h=this.colorMap;return h&&h[this.baseColor].reversed||false;},postBuildRendering:function e(){this.width=E.position(this.containerNode).w;this.resetColorMap();if(this._super){this._super();}this.update();},resetColorMap:function R(){this.colorMap=H.call(this);},onkeyup:function(m){var k=window.event||m.e,n=k.keyCode;if(this.sliderMode===d.COLOR_BASED&&(n===mstrmojo.Enum_Keys.DELETE||n===mstrmojo.Enum_Keys.BACKSPACE)){if(this.editableBubble.isEditing){return ;}var l,h;if(this.bands.isSelected){l=this.bands;}else{if(this.markers.isSelected){l=this.markers;}else{return ;}}h=l.selectedIndex;l.children[h].unselect();l.remove(h);this.update();}},update:function M(){if(this.baseColor){J.call(this,Z);J.call(this,D);}},onsliderModeChange:function U(){g.toggleClass(this.domNode,"image-mode",this.sliderMode===d.IMAGE_BASED);this.unselectAll();this.bands.removeChildren();},onbaseColorChange:function P(){this.unselectAll();this.update();},onselectedOptionChange:function O(h){var k=this.parent.model,l=this.editableBubble,m=l.text;this.updateLabels(h.value);if(l.visible){if(h.valueWas===1||h.valueWas===2){m=m.slice(0,m.length-1);}l.updateText(k.getNormalizedValue(m,h.valueWas));}},updateLabels:function Y(k){var n=this.parent.model,o=this.editableBubble,m=this.hoverBubble,p,l;k=k||this.selectedOption;if(k===1||k===2){p="0%";l="100%";o.set("isPercentage",true);m.set("isPercentage",true);}else{if(k===4||k===5){p="0";l=n.getMetricsCount();o.set("isPercentage",false);m.set("isPercentage",false);}else{var h=n.getFormatString();p=c.formatByMask(h,n.getMetricsMinValue());l=c.formatByMask(h,n.getMetricsMaxValue());o.set("isPercentage",false);m.set("isPercentage",false);}}this.startLabel.set("text",p);this.endLabel.set("text",l);},setColorComp:function L(k,h){var l=this.colorMap;if(l){l[k].comp=h;this.unselectAll();this.update();}},addCustomScheme:function(k,h){this.colorMap.custom={comp:k,palette:h,reversed:false};this.set("baseColor","custom");},addMarkerToMap:function W(k){var l=this.getComp(),h=l.length,m;if(l[0]>k){m=0;}else{for(m=1;m<h;m++){if(l[m-1]<=k&&l[m]>=k){break;}}}l.splice(m,0,k);this.unselectAll();return m;},unselectAll:function X(){var k=this.bands;if(k.isSelected){k.children[k.selectedIndex].unselect();}var l=this.markers,h=l.selectedIndex;if(l.isSelected&&l.children[h]){l.children[h].unselect();}},reverseMapColor:function T(){if(this.colorMap&&this.baseColor){var h=this.colorMap[this.baseColor];h.reversed=!h.reversed;this.unselectAll();this.update();}},children:[{scriptClass:"mstrmojo.Label",cssClass:"start-label",alias:"startLabel",slot:"labelsNode",text:"0%"},{scriptClass:"mstrmojo.Label",cssClass:"end-label",alias:"endLabel",slot:"labelsNode",text:"100%"},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"editableBubble",slot:"labelsNode",allowEmptyText:true,onTextEditComplete:function(m,t){if(m){var r=this.text;if(this.isPercentage){r=r.replace(/%$/,"");}var o=t.charAt(0);if(o.match(/\W/)!==null){r=r.replace(new RegExp("^\\"+o),"");}r=c.parseNumeric(r);if(isNaN(r)){this.set("text",t);return ;}var h=this.parent,n=h.parent.model,q=n.getNormalizedValue(r,h.selectedOption),p=h.getComp();this.updatePosition(q);var k=h.markers.selectedIndex;p.splice(k,1);var l=h.addMarkerToMap(q);h.markers.children[l].select();h.update();}}},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"hoverBubble",slot:"labelsNode",allowEmptyText:false},{scriptClass:"mstrmojo.Box",cssClass:"color-bands",alias:"bands",isSelected:false,selectedIndex:0,remove:function G(l){if(this.children.length===1){return ;}var m=this.parent;var k=m.getComp(),h=m.getPalette();if(l===this.children.length-1){k.splice(l-1,1);}else{k.splice(l,1);}h.splice(l,1);},onBandHovered:function(h){this.isSelected=true;},onBandUnhovered:function(h){this.isSelected=false;},onBandSelected:function(h){var k,m=this.children,l=this.parent,n=l.markers;for(k=0;k<m.length;k++){if(k!==h&&m[k].selected){m[k].unselect();}}if(n.isSelected===true){n.children[n.selectedIndex].unselect();}l.hiddenField.focus();this.isSelected=true;this.selectedIndex=h;},onBandUnselected:function(h){var k,l=this.children;for(k=0;k<l.length;k++){if(k!==h&&l[k].selected){return ;}}this.isSelected=false;}},{scriptClass:"mstrmojo.threshold.MarkersNode",alias:"markers",isSelected:false,selectedIndex:0,onMarkerSelected:function V(k){var h=this.parent;h.editableBubble.showBubble(h.getComp()[k]);var l,o=this.children;for(l=0;l<o.length;l++){if(l!==k&&o[l].selected){o[l].unselect();}}var n=h.bands;if(n.isSelected===true){n.children[n.selectedIndex].unselect();}this.parent.hiddenField.focus();this.isSelected=true;this.selectedIndex=k;},onMarkerUnselected:function(h){var k,l=this.children;for(k=0;k<l.length;k++){if(k!==h&&l[k].selected){return ;}}this.parent.editableBubble.hideBubble();this.isSelected=false;},onMarkerHovered:function K(k){var h=this.parent;h.hoverBubble.showBubble(h.getComp()[k]);this.isSelected=true;},onMarkerUnhovered:function N(h){this.parent.hoverBubble.hideBubble();this.isSelected=false;}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.array","mstrmojo._HasLayout","mstrmojo.vi.ui._IsPanel","mstrmojo._HasPopup","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi._MonitorsAppState","mstrmojo._Formattable","mstrmojo.vi.ui._IsUnitContainerTitleBar","mstrmojo.DynamicClassFactory","mstrmojo.Box","mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.vi.ui.TitleBar","mstrmojo.vi.models.EnumDragSources","mstrmojo.EnumRWUnitType");mstrmojo.requiresDescs(629,1388,11477,11478);var Q=mstrmojo.array,Al=mstrmojo.css,AE=mstrmojo.dom,Aq=mstrmojo.vi.models.EnumDragSources,b=mstrmojo.models.FormatModel,Y=b.ENUM_PROPERTY_NAMES,W=mstrmojo.DocDataService.SUPPRESS_DATA,AW=1,AB="visible",AK="ctrlOverlay",d="or-v",E="or-h";mstrmojo.vi.ui.rw.UnitContainerTitleBar=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.vi.ui.TitleBar,[mstrmojo.vi.ui._IsUnitContainerTitleBar],{scriptClass:"mstrmojo.vi.ui.rw.UnitContainerTitleBar"});var Aa={n:mstrmojo.desc(11477,"Hide Titlebar"),cls:"htb",fn:function(){this.toggleTitleBar(false);},dsbld:false};var An={n:mstrmojo.desc(11478,"Show Titlebar"),cls:"stb",fn:function(){this.toggleTitleBar(true);},dsbld:false};function AM(Au){var Av=mstrApp.isAppStatePresentation(),At=mstrApp.isAppStatePrintPreview(),Aw=this.domNode;Al.toggleClass(Aw,"selected",Au&&!Av&&!At);}function N(Av,Au,Aw){var Az=mstrmojo.vi.VisualInsightApp.APP_STATES,At=Az.PRESENTATION,Ax=mstrApp.appState===At;var Ay=this.domNode;Al.toggleClass(this.domNode,"pulse",Av&&!Ax&&!Aw);if(Au){setTimeout(function(){Al.toggleClass(Ay,"pulse",false);},500);}}function Ai(Au,At){return mstrmojo.all[Au].getPanel().getUnitByKey(At);}function g(At){At.btn.style.display=!!At.menuCfg?"block":"none";}function Ao(At,Av){var Au=this.getContextDragData(At);return !!(Au&&(Au.src===Av));}function l(At){return Ao.call(this,At,Aq.FILTERS);}function AG(At){return Ao.call(this,At,Aq.DATASETS);}function w(At){return Ao.call(this,At,Aq.ALL_OBJECT_LIST);}function Aj(At){var Au=At.children;if(Au&&Au.length){At.removeChildren();Au.forEach(function(Av){Av.destroy();});}}function K(){var At=this.boxContent;if(At&&At.getFormats){return At.getFormats();}return null;}function Ac(At){if(At.visible){if(At.controls){this.showControlOverlay(At.controls);}else{throw new Error('mstrmojo.vi.ui.rw.UnitContainer: "controls" should be provided when showing the control overlay');}}else{this.hideControlOverlay();}}function AV(Ax,Au){var Av=this.model.controller,Aw="propertiesPanel",At=function(){var Az=this.getFormatMenuItemTarget(Ax);var A1=this.getEditorModel();if(A1.selectTargetByValue){A1.selectTargetByValue(Az);}if(Au){Au(Az);}var Ay=Av.getViPanel(Aw),A0=Ay&&Ay.parent;if(A0&&A0.highlightSelected){A0.highlightSelected();}}.bind(this);if(Av.getViPanel(Aw)){Av.selectViPanel(Aw);At();}else{Av.openViPanel(Aw,{success:At});}}function H(Av,At){var Au=Av?"titlebarNode":"domNode";this.clearCache();this.clearSlotBackgroundCSS(Au);this.applyCSSFormatToNode(Au,At);}mstrmojo.vi.ui.rw.UnitContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._HasPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.rw.UnitContainer",markupString:'<div id="{@id}" class="mstrmojo-UnitContainer {@cssClass}" style="{@cssText} {@domNodeCssText}" mstrAttach:mouseover,mouseout,click,contextmenu><div class="mstrmojo-UnitContainer-titlebar" style="{@titlebarNodeCssText}"></div><div class="mstrmojo-UnitContainer-content"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{titlebarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},maskNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onzIndexChange:function(){this.domNode.style.zIndex=this.zIndex||AW;},onenabledChange:function(){Al.toggleClass(this.domNode,"inactive",!this.enabled);},onorientationChange:function(){var Au=this.ctrlOverlay.domNode,At=this.orientation;Al.toggleClass(Au,d,At==="v");Al.toggleClass(Au,E,At==="h");this.orientationHasChanged();}},layoutConfig:{h:{titlebarNode:"auto",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},formatHandlers:{domNode:["B","BG"],titlebarNode:{src:"ttl",props:["F","BG","text-align"]}},updateOverlay:mstrmojo.emptyFn,getCacheKey:function AA(){return this._super()+"-vi-uc";},getPanelForAddAction:function AZ(){return"propertiesPanel";},getExcludedPanels:function Am(){return["editPanel"];},titleBarCss:"",orientation:"h",k:"",boxContent:null,parent:null,enabled:true,draggable:true,ctrlOverlay:null,model:null,title:"",titleBar:null,showTitleBar:false,bubbleMouseOver:true,dimensionsSet:false,getEditOverlayControls:mstrmojo.emptyFn,isNewUnitContainer:true,shouldShowCustomizeContextMenu:function(At){var Au=At.getTarget(),Av=Au&&Au.nodeName.toLowerCase();return Av&&!(Av==="textarea"||(Av==="input"&&Au.type.toLowerCase()==="text"));},switchToEditMode:function Af(){this.showControlOverlay(this.getEditOverlayControls());},init:function AJ(Av){this._super(Av);var Aw=this.id,Au=this.model,At;Au.attachEventListener("viUnitSelected",Aw,function(Ax){AM.call(this,Aw===Ax.id);});Au.attachEventListener("viIconTabClicked",Aw,function(Ay){var Ax=Au.hgl;if(Au.getSelectedViUnit()&&Ay.id!="vi_flt"&&!!Ax==0){N.call(this,Aw===Au.getSelectedViUnit().id,true,false);}});Au.attachEventListener("viVizEditorDrag",Aw,function(Ay){var Ax=Au.hgl;if(Au.getSelectedViUnit()&&Ay.id!="vi_flt"&&!!Ax==0){N.call(this,Aw===Au.getSelectedViUnit().id,false,!Ay.isIn);}});this.addChildren([this.getTitleBarCfg(),{scriptClass:"mstrmojo.Box",cssClass:AK,alias:"ctrlOverlay",slot:"containerNode",visible:false}],0);At=this.titleBar;if(At&&At.tbToolbar){At.tbToolbar.toolbarClicked=function(){Au.selectVIUnit(Aw);};}this.menuBtnInfo={};this.showTitleBar=!!this.defn.httl;this.draggable=mstrApp.allowWebDashboardDesign();this.boxContent.attachEventListener("toggleCtrlOverlay",this.id,Ac);},getDocModel:function F(){return this.model;},getBoxBorderWidth:function AY(){var At=K.call(this),Au=At&&At.border;if(Au){var Av=[2,4];if(mstrApp.isSingleTier&&AE.getOSInfo().name.toLowerCase().indexOf("mac")>=0){Av=[2.66,5.34];}return Au.indexOf("2pt")>-1?Av[1]:Av[0];}return 0;},onFormat:function m(){var At=this.boxContent;if(At.execFormatHandler){At.execFormatHandler();return ;}AV.call(this);},showControlOverlay:function D(Av,Au){var Aw=this.ctrlOverlay,Ax=Aw.domNode;if(Ax){var At=[AK];At.push((this.orientation==="v")?d:E);if(Au){At.push(Au);}Ax.className=At.join(" ");}Aw.set("visible",true);Aj(Aw);Aw.addChildren(Av);},hideControlOverlay:function Ad(){var At=this.ctrlOverlay;At.set("visible",false);Aj(At);},getTitleBarCfg:function AC(){return{scriptClass:"mstrmojo.vi.ui.rw.UnitContainerTitleBar",slot:"titlebarNode",alias:"titleBar",title:this.title,editTitleOnDoubleClick:mstrApp.allowWebDashboardDesign(),close:function(){this.parent.deleteSelf();},getLayoutOffsets:function At(){return{h:1,w:0};}};},getDisplayName:function AO(){return this.title;},updateDisplayName:function x(Aw,Ax,At){var Au=this.model,Av=this.k;if(At){Au.renameRWUnitTitle(Aw,Ax,Av,{success:function(Ay){this.set("title",Ay);}.bind(this),failure:function(Ay){mstrmojo.err(Ay);this.set("title",Ax);}.bind(this)});}else{Au.renameRWUnit(Aw,Ax,Av,{success:function(){this.synchronizeEditors();}.bind(this)});}},ontitleChange:function As(){this.titleBar.set("title",this.title);},oncontextmenu:function AU(At){if(this.shouldShowCustomizeContextMenu(At)){var Au=this.addContextMenuItems(new mstrmojo.ui.menus.MenuConfig({position:AE.getMousePosition(At.e,At.hWin),isHostedWithin:false}),At);if(Au.hasMenuItems()){AE.preventDefault(window,At.e);this.openPopup(Au.newInstance());}}At.cancel();},addContextMenuItems:function V(Aw,At){var Av=this.getEditorModel(),Au;if(Av.getFormattingToolbar){Au=function(Ax){var Ay=Av.getFormattingToolbar(Ax,At.getTarget());if(Ay){this.openPopup(Ay);}}.bind(this);}this.addFormatMenuItem(Aw,At,Au);return Aw;},addFormatMenuItem:function I(Av,Au,At){if(!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign()){Av.addMenuItem(mstrmojo.desc(1918,"Format"),"",function(){this.selectVIUnit();AV.call(this,Au,At);}.bind(this));}return Av;},getFormatMenuItemTarget:function h(At){return mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE;},applyBoxSize:function Z(At,Av,Ax,Aw){this._super(At,Av,Ax,Aw);this.dimensionsSet=true;var Au=parseInt(Av,10)>parseInt(At,10)?"h":"v";if(Au!==this.orientation){this.set("orientation",Au);}},childRenderCheck:function AN(Au){var At=this._super(Au);if(Au===this.boxContent){At=At&&this.dimensionsSet;}return At;},postUpdateLayout:function o(){var Av=this.boxContent;if(!this.domNode){return ;}if(!Av.hasRendered){Av.render();var At=this.model.getLatestSelectedViUnitKey(),Au=At&&this.parent.getUnitByKey(At);if(Au){this.model.selectVIUnit(Au.id);}else{this.parent.selectFirstBox();}}else{Av.refresh();}this.isNewUnitContainer=false;},orientationHasChanged:mstrmojo.emptyFn,onRender:function AS(){this._super();var At=this.model.getSelectedViUnit();AM.call(this,(At&&At.k===this.k));},onAppStateChange:function AQ(Au){var At=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION,Aw=Au.value===At;if(Aw||Au.valueWas===At){this.draggable=!Aw;this.generateToolbar();}var Av=this.model.getSelectedViUnit();AM.call(this,(Av&&Av.k===this.k));},selectVIUnit:function R(At){if(this.enabled){AM.call(this,this.parent.selectVIUnit(this,At));}},synchronizeEditors:function r(){if(this.model.getLatestSelectedViUnitKey()===this.k){this.selectVIUnit(true);}},addToggleTitleMenuItem:function L(At){var Au=[Aa,An];if(!this.titleBar.visible){Au.reverse();}At.addDualStateItem(this.id,Au[0],Au[1]);},canShowDesignMenuItems:function e(){return mstrApp.allowWebDashboardDesign();},updateToolbar:function c(At){var Au=At.ENUM_CORNERS;At.setAlignment(Au.BOTTOM_RIGHT,Au.TOP_RIGHT);At.isHostedWithin=false;if(this.canShowDesignMenuItems()&&mstrApp.appState!==mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION){At.addSeparator();this.addFormatMenuItem(At);if(this.showTitleBar){At.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.draggable=false;this.titleBar.editTitle();}.bind(this));}if(undefined!==this.getEditOverlayControls()){At.addMenuItem(mstrmojo.desc(3272,"Edit"),"cls",this.switchToEditMode.bind(this));}var Av=this.k,Aw=this.model.id;At.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){Ai(Aw,Av).deleteSelf();});}return At;},deleteSelf:function AI(A4){var Ax=this.k,Au=this.model,A3=Au.id,A6=Au.data,A1=Ai(A3,Ax).parent,A2=A1.k,A5=[A2],At=[],Az=function(A7){return A7.sections||A7.subsections||A7.objects||A7.panels||A7.layouts||A7.children;},Av=function(BA,A9){var A8=Az(BA);for(var A7=0;A8&&(A7<A8.length);A7++){if((A8[A7]&&A8[A7].k)===A9){Q.removeIndices(A8,A7,1);return ;}else{Av(A8[A7],A9);}}},Aw=Au.getRebuildCallback();At=At.concat(Au.getSourceFilterKeys(Ax,true));this.model.execute({execute:function(){var A8=Ai(A3,Ax);if(A8){var A7=A8.parent,A9=mstrmojo.all[A3],BC=A9.getDataService().newUpdate();var BA=A7.hasMultipleChildren();BC.addUpdate(A8.createDeleteUpdate());BC.addCallbacks({success:function BB(BD){A9.partialUpdate(BD.data,A9.getTargetDefn(At),BD.defn,At);Av(A6,Ax);A9.deleteDataCache(A8.boxContent&&A8.boxContent.id);A8.defn._isDeleted=true;A8.destroy();}});A7.deleteBoxAndSubmitDeferred(BC,A8,null,true);if(!BA){A9.addVisualizationDeferred(BC,A7.k);}A7.selectFirstBox();BC.addCallbacks(A4);BC.addExtras({style:{params:{treesToRender:0}}});this.submitUpdate(BC);}},urInfo:{undo:function A0(){var A7=Ai(A3,Ax);if(A7){delete A7.defn._isDeleted;}},redo:function Ay(){var A7=Ai(A3,Ax);if(A7){A7.defn._isDeleted=true;}},puKeys:A5,extras:mstrmojo.DocDataService.REQUEST_DEFN_DATA,callback:Aw}});},undoInsert:function AT(){var At=this.parent,Au=mstrmojo.all[this.model.id];At.deleteBoxAndSubmitDeferred(Au.getDataService().newUpdate(),this,null,true);At.selectFirstBox();this.destroy();},createDeleteUpdate:function k(){},getTitleBarVisibility:function P(){return this.titleBar&&this.titleBar.visible;},setTitleBarVisibility:function f(At){var Av=this.titleBar;Av.set("visible",At);var Aw=this.menuBtnInfo,Au=Aw.btn;if(!Au){Au=Aw.btn=document.createElement("div");Au.className="hover-menu-btn";var Ax=this.id;AE.attachEvent(Au,"click",function(){var Az=mstrmojo.all[Ax],Ay=Aw.menuCfg;Ay.hostId=Ax;Ay.hostElement=Au;Az.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:Ay}));});}this.domNode.appendChild(Au);Aw.menuCfg=At?null:Av.getMenuConfig();g(Aw);this.doLayout();},refresh:function Ab(){delete this._currentLayout;if(!this.parent.boxLayoutConfig.dirty){this._super();}else{H.call(this,false,this.getFormats());if(this.showTitleBar){H.call(this,true,this.getFormats());}}},addFormatProps:function T(Au,At){return Au;},onclick:function AD(At){this.selectVIUnit();if(!At.e.ptvSelected&&this.switchPropertyOnClick()){this.boxContent.edtModel.selectTargetByValue(mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE);}},switchPropertyOnClick:function AL(){var At=this.boxContent.edtModel;return !!(At&&At.selectTargetByValue);},getZonesModel:function AX(){return null;},getEditorModel:function Ar(){return this.boxContent.edtModel;},onmouseover:function G(At){if(!mstrApp.isInteractive()){return ;}if(!this.bubbleMouseOver){At.cancel();}var Av=this._panelTimeout;if(Av){window.clearTimeout(Av);delete this._panelTimeout;}if(this.titleBar.visible){this.titleBar.setToolbarVisibility(true);}var Au=this.menuBtnInfo;if(!!Au.menuCfg){Al.addClass(Au.btn,AB);}},onmouseout:function p(){var At=this.id;this._panelTimeout=window.setTimeout(function(){var Au=mstrmojo.all[At];if(Au){var Av=Au.menuBtnInfo;if(!!Av.menuCfg){Al.removeClass(Av.btn,AB);}Au.titleBar.setToolbarVisibility(false);}},200);},isDragValid:function z(Au){var At=Au.src.node.tagName;At=(At&&At.toLowerCase())||"";if(At==="input"||At==="textarea"){return false;}return this.parent.hasMultipleChildren();},initializeDrag:function u(){this.selectVIUnit();},getTargetDropZone:function t(At){if(AG.call(this,At)||w.call(this,At)){return"";}return this._super(At);},allowDrop:function B(At){var Av=At.src,Au=Av&&Av.widget;if(Au&&Au===this){return false;}if(l.call(this,At)&&this.allowDropFromFilter(At)){return true;}if(AG.call(this,At)&&this.allowDropFromDataset(At)){return true;}if(w.call(this,At)&&this.allowDropFromAllObjectsBrowser(At)){return true;}return this._super(At);},allowDropFromFilter:function Ah(){return mstrApp.allowWebDashboardDesign();},allowDropFromDataset:function AR(At){return false;},allowDropFromAllObjectsBrowser:function M(At){return this.allowDropFromDataset(At);},close:function(){this.parent.deleteBoxAndSubmit(this);this.parent.removeChildren(this);mstrApp.rootCtrl.generateToolbar();this.destroy();},createAvatar:function O(){this.domNode.style.zIndex="-1";var At=document.createElement("div");At.className=this.getAvatarCls().join(" ");At.textContent=this.getDisplayName();return this.offsetAvatar(At);},ondragend:function S(At){this.domNode.style.zIndex=AW;this._super(At);},wasDropped:function a(At){this.domNode.style.zIndex=AW;this._super(At);},ondrop:function A(Av){var Az=l.call(this,Av),Ax=this.maskNode.zone,Au,Aw=this;if(Az){Au=Av.src.widget.selector.node;}this._super(Av);if(AG.call(this,Av)){this.dropFromDataset(Av);}if(w.call(this,Av)){var Ay=Av.src.widget,A0=Ay&&Ay.dataProvider;if(A0){A0.loadObjects(Av.getCtxtDragData().items,{success:function(){Aw.dropFromAllObjects(Av);}});}}if(Az){var At=this;if(!Ax){Ax=this.parent.getPanelTargetEdge(Av);if(Ax){At=null;}}this.model.insertExistingFilter(Au,At,Ax);}},postDropBox:function Ag(){this.domNode.style.zIndex=AW;},rebuildBoxContent:function v(Av){var Au=this.boxContent,At=this.parent;this.removeChildren(Au);Au.destroy();Au=this.model.rebuildUnitFromDataCache(Au.id,At.k,At.builder).boxContent;if(Av){Av(Au);}this.addChildren([Au]);},dropFromDataset:mstrmojo.emptyFn,dropFromAllObjects:mstrmojo.emptyFn,generateToolbar:function C(){var At=this.titleBar,Au=At.toolbarCfg;if(Au){Au.destroy();}At.set("toolbarCfg",this.updateToolbar(new mstrmojo.ui.menus.ToolbarConfig()));if(!At.visible){this.menuBtnInfo.menuCfg=At.getMenuConfig();}},getTitleVisibilityFmts:function U(At){return{FormattingView:{ShowTitleBar:At}};},toggleTitleBar:function AF(At){var Ay=this.boxContent.id,Aw=this.model,Ax=function Ax(Az){var A1=mstrmojo.all[Ay],A0=A1.parent;A0.setTitleBarVisibility(Az);A0.parent.selectVIUnit(A0,true);A0.applyBoxSize(A0.height,A0.width,A0.top,A0.left);A1.refresh();};Aw.controller.cmdMgr.execute({execute:function(){var Az=mstrmojo.all[Ay].parent;this.submit([Aw.getUnitFormatAction(Az,Az.defn.t===mstrmojo.EnumRWUnitType.SELECTOR?5:1,Az.getTitleVisibilityFmts(At?1:0),true)],{failure:function A0(){Ax(!At);}},W);Ax(At);},urInfo:{silent:true,undo:function Au(){Ax(!At);},redo:function Av(){Ax(At);}}});},getFormats:function AH(){var At=this.boxContent;if(At){return At.getFormats();}return null;},clearFormats:function J(){var At=this.boxContent;if(At&&At.clearFormats){At.clearFormats();}},preBuildRendering:function X(){var At=this.boxContent;if(At){At.attachEventListener("regenerateToolbar",this.id,"generateToolbar");}this.generateToolbar();return this._super();},postBuildRendering:function Ap(){var At=this.showTitleBar;this.setTitleBarVisibility(At);this.titleBar.setToolbarVisibility(false);if(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){this.draggable=false;}this._super();this.applyBoxSize(this.height,this.width,this.top,this.left);return true;},changeUnitFormats:function Ak(Av,Ay,A1,A0,Au,At,Aw,Az){var Ax=function(A3){if(Aw){A3=Aw(A3);}b.updateFormatBlock(Av?A1.ttl:A1,A0,A3);var A2=this.parent?this:this.model.getSelectedViUnit();H.call(A2,Av,A1);if(Az){Az(A3);}A2.synchronizeEditors();if(Av&&A0===Y.FONT_SIZE){A2.doLayout();}};this.model.saveUnitFormatProperty(this,[{formatType:Ay,propertyName:A0,newValue:Au,oldValue:At}],{success:Ax.bind(this,Au)},mstrmojo.DocDataService.SUPPRESS_DATA,{silent:true,undo:Ax.bind(this,At),redo:Ax.bind(this,Au)});},redraw:function q(){if(this.boxContent.redraw()===true){return true;}return this._super();},getAvatarCls:function AP(){return["mstrmojo-VIUnit-avatar","icn-avi",mstrApp.getThemeClassName()];},addDragHandle:function n(){var At=document.createElement("div");At.className="uc-drag-handle";this.domNode.appendChild(At);},toggleDragHandleVisibility:function Ae(At){Al.toggleClass(this.domNode,"no-handler",!At);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi.ui._IsPanel","mstrmojo.dom","mstrmojo.css");var D=mstrmojo.dom,E=13,C=9;mstrmojo.vi.ui.PanelPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsPanel],{scriptClass:"mstrmojo.vi.ui.PanelPortlet",init:function F(J){this._super(J);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIPanelPortlet");this.markupMethods=mstrmojo.hash.copy(this.markupMethods,{onenabledChange:mstrmojo.Widget.enabledMarkupMethod});},layoutConfig:{h:{titlebarNode:"20px",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},showTitleBarContextMenu:false,canCollapse:true,level:null,onCollapsedChange:mstrmojo.emptyFn,panelId:"",ignoreLayout:true,togglePortlet:function B(J){if(this.canCollapse){this.titleBar.set("isCollapsed",J);}},getTitleBarCfg:function H(){var J=this._super(),K=this;J.canCollapse=this.canCollapse;J.cssClass="small";J.editTitleOnDoubleClick=false;if(this.showTitleBarContextMenu){J.oncontextmenu=function(L){D.preventDefault(window,L.e);var M=L.getTarget();if(D.contains(this.textNode,M,true,this.domNode)){L.cancel();this.tbToolbar.closePopup();var N=this.getMenuConfig();N.hostId=this.tbToolbar.id;N.hostElement=this.tbToolbar.domNode;N.position=D.getMousePosition(L.e,L.hWin);this.tbToolbar.openPopup(N.newInstance());N.position=null;}};}J.onToggleCollapseByUI=function(){K.onCollapsedChange();};return J;},onRender:function G(){this._super();if(this.level!==null){this.titleBar.leftToolNode.style.paddingLeft=C+this.level*E+"px";this.titleBar.doLayout();}},updateToolbar:function I(J){this.addMenuItems(J);var K=this.panelId;if(K){mstrmojo.all[K].addPopupHandlers(J);}return this._super(J);},addMenuItems:function A(J){},getLayoutOffsets:function(){return{h:0,w:18};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.vi.ui._IsPanel","mstrmojo._HasBuilder","mstrmojo._IsPanelStack","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.vi.ui.rw._IsPanelStack");mstrmojo.vi.ui.rw.DocVIPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsPanel,mstrmojo._HasBuilder,mstrmojo._IsPanelStack,mstrmojo.vi.ui.rw._IsPanelStack,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocVIPanelStack",layoutConfig:{h:{titlebarNode:"0px",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricEditBox","mstrmojo.ME.DynamicLinkTokenInputBox","mstrmojo.ME.AttributeEditBox","mstrmojo.mstr.EnumDSSXMLTokenTypes","mstrmojo.mstr.EnumDSSXMLTokenStates");var G=mstrmojo.array,J=mstrmojo.hash,I=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,E=mstrmojo.ME.AttributeEditBox.prepareInsertToken,F=mstrmojo.ME.AttributeEditBox.validateSyntax,U=mstrmojo.mstr.EnumDSSXMLTokenTypes,O=mstrmojo.mstr.EnumDSSXMLTokenStates,M=mstrmojo.ME.MetricToken.argDelimiter,C=function C(V){V=V||"";return'"'+V+'"';},L=function L(V){if(!V){return V;}return V.replace(/^"(.*)"$/,"$1");},Q=function Q(V){return G.filter(V,function(W){return !((W.tp===U.SimpPrefixFun&&W.v==="Concat")||(W.tp===U.LeftParen&&W.v==="(")||(W.tp===U.Comma&&W.v===",")||(W.tp===U.Semicolon&&W.v===";")||(W.tp===U.RightParen&&W.v===")"));});},S=function S(V){var W=[];G.forEach(V,function(X){if(X.tp===U.AttrFormRef||X.sta===O.Error){W.push({v:"{",isDelimiter:true});W.push(X);W.push({v:"}",isDelimiter:true});}else{X.v=L(X.v);X.isRawStr=true;W.push(X);}});return W;},A=function A(V){if(V.isRawStr){V.v=V.v.replace(/"/g,"'");V.v=C(V.v);V.isRawStr=false;}return V;},D=function D(W){if(W.length===1){A(W[0]);return W;}var V,X=[{v:"Concat(",isRawStr:false,isNew:true}];for(V=0;V<W.length;V++){X.push(A(W[V]));X.push({v:M,isRawStr:false,isNew:true,isDelimiter:true});}X[X.length-1].v=")";return X;},R=function R(a){if(!G.isArray(a)){return undefined;}var c=[],W=false,b=false,Y,V,X="{",Z="}";for(V=0;V<a.length;V++){Y=a[V];if(Y.v===X){if(b){return undefined;}b=true;W=false;}else{if(Y.v===Z){if(!b){return undefined;}W=false;b=false;}else{if(W&&b){return undefined;}Y.isRawStr=!b;Y.isNew=true;c.push(Y);W=true;}}}return !b?c:undefined;},T=function T(W){if(!W||W.length===0){return[];}var V=W[0];V.isNew=true;V=D(W);return[].concat(V);};mstrmojo.ME.DynamicLinkEditBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,[],{children:[{scriptClass:"mstrmojo.ME.DynamicLinkTokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:0,bindings:{browseItemVisible:"this.parent.browseItemVisible",candidates:"this.parent.candidates"}}],ontokensModify:function(){this.set("cValid",this.inputBox.items.length>0);this.set("dirty",true);this.localValidate();},defaultOnTokensModify:mstrmojo.emptyFn,clear:function K(){this.inputBox.set("items",[]);this.inputBox.resetTokensCache();this.set("vStatus",I.UNKNOWN);this.set("iStatus","");},postBuildRendering:function P(){if(this._super){this._super();}this.clear();},onObjectInsert:function N(Y){var b=this.inputBox;var W=E(Y);var Z=[W];if(Y.t===12&&W.ift&&W.exv){Z=[{v:"{",isDelimiter:true,isNew:true}].concat(Z).concat([{v:"}",isDelimiter:true,isNew:true}]);}var a=b.insertTokens(Z);if(this.ontokensModify){this.ontokensModify();}if(Y.t===12&&W.ift&&!W.exv){var X=b.ctxtBuilder.itemWidgets,V=X[a];if(V){b.startTokenSuggestion(V);}}},backendValidate:function H(W){var X=this,V=function(Z){X.set("vStatus",Z.vs);X.set("iStatus",Z.rjed||"");var Y={};J.copy(Z,Y);Y.items=S(Q(Z.items));X.updateInputBoxItems(Y);X.handleValidation(Y);if(W){W(Z.items,Z.vs===I.VALID);}};X.set("vStatus",I.VALIDATING);F(null,{items:T(R(this.inputBox.items)||[])},false,V);},localValidate:function B(){var V=this.inputBox.items;if(V.length>0){if(!R(V)){this.set("vStatus",I.ERROR);this.set("iStatus","");return ;}}this.set("vStatus",I.UNKNOWN);this.set("iStatus","");}});mstrmojo.ME.DynamicLinkEditBox.preProcessBackendTks=Q;mstrmojo.ME.DynamicLinkEditBox.convertBackendTksToDisplayTks=S;mstrmojo.ME.DynamicLinkEditBox.addDoubleQuotationMark=C;mstrmojo.ME.DynamicLinkEditBox.removeDoubleQuotationMark=L;mstrmojo.ME.DynamicLinkEditBox.preprocessDisplayTokens=R;mstrmojo.ME.DynamicLinkEditBox.constructBackendToken=T;}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ME.ObjectInputBox","mstrmojo.ME.MetricDataService","mstrmojo.ME.Enum");mstrmojo.requiresDescs(1107,12178);var J=mstrmojo.expr,D=mstrmojo.ME.Enum.DYNAMIC_DIMTY;mstrmojo.ME.LevelInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-level",oncandidatesChange:function F(E){this.candidates.items=D.getItems("level").concat(this.candidates.items);},hidePulldownButton:function(){return !this.isDME;},hideItemWidgetBrowseButton:function(){return this.isDME;},folderLinksContextId:16,browsableTypes:[J.TP.FOLDER,J.TP.ATTR,J.TP.DIM].join(","),getCandidatesThroughTaskCall:function K(L,E){L.rootFolderType=39;L.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getAttributes(L,E);},itemFunction:function B(M,E,L){M.filtering=M.filtering||1;M.grouping=M.grouping||1;var N=this._super(M,E,L,mstrmojo.ME.LevelObjectItem);N.optionButtonVisible=true;return N;},updateSuggestion:function C(E){E=[{n:this.isDME?mstrmojo.desc(12178,"Visualization level"):mstrmojo.desc(1107,"Report Level"),did:-1,t:-1,state:0}].concat(E);if(this._super){this._super(E);}},add:function H(L,E){var N=true,M=this.items;mstrmojo.array.forEach(L,function(O){mstrmojo.array.forEach(M,function(P){if(P.did&&P.did===O.did){N=false;return false;}});});if(N){this._super(L,E);}}});mstrmojo.ME.LevelObjectItem=mstrmojo.declare(mstrmojo.ME.ObjectItem,[mstrmojo._HasPopup],{optsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9598,"Level Options"),cssText:"width: 450px;",onOpen:function A(){var E=this.opener.data;this.filterOption.set("value",E.filtering);this.groupOption.set("value",E.grouping);},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9599,"Relationship with Report Filter:")},{scriptClass:"mstrmojo.Pulldown",alias:"filterOption",itemField:"n",itemIdField:"did",items:[{n:mstrmojo.desc(9600,"Standard - Metric calculates only for elements found in the filter"),did:1},{n:mstrmojo.desc(9601,"Absolute - Raises the calculation to the selected level, if possible"),did:2},{n:mstrmojo.desc(9602,"Ignore - Omit filtering criteria based on selected level and its related attributes"),did:3},{n:mstrmojo.desc(9603,"None - Unspecified - the selected level and group components define the filter"),did:4}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9604,"Metric Aggregations:")},{scriptClass:"mstrmojo.Pulldown",alias:"groupOption",itemField:"n",itemIdField:"did",items:[{n:mstrmojo.desc(9605,"Standard - Metric calculates at the selected level, if possible"),did:1},{n:mstrmojo.desc(9606,"None - Exclude the selected level and children from the GROUP BY clause in the SQL"),did:2},{n:mstrmojo.desc(9607,"Beginning lookup - Use the first value of the lookup table"),did:3},{n:mstrmojo.desc(9608,"Ending lookup - Use the last value of the lookup table"),did:4},{n:mstrmojo.desc(9609,"Beginning fact - Use the first value of the fact table"),did:5},{n:mstrmojo.desc(9610,"Ending fact - Use the last value of the fact table"),did:6}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,L=E.opener;if(L.saveOnClose){L.saveOnClose(E.filterOption.value,E.groupOption.value);}E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},saveOnClose:function G(E,M){var L=this.data;L.filtering=E;L.grouping=M;if(this.parent.onSaveOnClose){this.parent.onSaveOnClose();}},options:function I(){this.openPopup("optsRef",{title:'"'+this.data[this.itemField]+'" '+mstrmojo.desc(9598,"Level Options"),zIndex:40});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.ObjectInputBox");var B=mstrmojo.expr;mstrmojo.ME.TransformInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-transform",items:[],noEditButton:true,folderLinksContextId:26,browsableTypes:[B.TP.FOLDER,B.TP.ROLE].join(","),getCandidatesThroughTaskCall:function A(E,D){mstrmojo.ME.MetricDataService.getTransformations(E,D);},hideItemWidgetBrowseButton:function C(){return this.isDME;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.ObjectInputBox");var B=mstrmojo.expr;mstrmojo.ME.ConditionInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-condition",folderLinksContextId:10,browsableTypes:[B.TP.FOLDER,B.TP.FILTER,B.STP.PROMPT_OBJECTS].join(","),noEditButton:true,maxObjectCount:1,getCandidatesThroughTaskCall:function A(D,C){D.rootFolderType=39;D.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getFilters(D,C);},hideItemWidgetBrowseButton:function(){return this.isDME;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo.vi.ui._HasBoxLayout","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.PageByPanel","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.vi.models.VIComponentMap");var F=mstrmojo.vi.models.VIComponentMap.TYPES,G="45",C="pageByPanel",I="containerNode";mstrmojo.vi.ui.rw.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo.vi.ui._HasBoxLayout,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi._MonitorsAppState,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocLayout",markupString:'<div id="{@id}" class="mstrmojo-VIDocLayout"><div class="mstrmojo-VIDocLayout-content {@cssClass}" style="{@cssText}"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.lastChild;}},init:function L(M){this._super(M);var N=this.id;this.builder.getLayoutVIMap(this.k).attachEventListener("viCompBuilt",N,function(O){if(O.type===F.PAGEBY_STACK){this.pageByPanel.setPageByStack(O.widget);}});},applyBoxSize:function D(N,P,R,Q){this._super(N,P,R,Q);if(!this.boxLayoutConfig){var S=this.boxLayoutConfig=new mstrmojo.vi.ui.BoxLayoutConfig({hostId:this.id,identifier:"id"});var O=S.box=S.getNewRootBox(true),M=this[C],T=M.pageByStack;if(T&&T.visible){S.addNewChild(O,G,M.id,true);}else{M.visible=false;}S.addNewChild(O,100,this.docSection.id);}this.buildBoxLayout();},alias:"docLayout",pageByPanel:null,docSection:null,dropZone:true,resizeOrReposition:mstrmojo.emptyFn,getIdentifier:function B(){return"layout";},getSplitterHost:function E(){return this.containerNode;},children:[{scriptClass:"mstrmojo.vi.ui.PageByPanel",alias:C,slot:I,height:"30px",zIndex:2}],_set_children:function A(P,N,M){if(N!==this.children){var O=this[C];if(O){N.push(O);}}return this._super(P,N,M);},getTargetDropZone:function J(M){var N=M.boxCache[this.id];return M.tgt.pos.x-N.x<N.w/2?"Left":"Right";},getViPanel:function K(M){return(M==="pageByPanel")?this[C]:null;},viPanelChangedVisibility:function H(M){var N=this.boxLayoutConfig;if(M.visible){N.addDropBox(this.docSection,"Top",{box:{boxId:String(M.id),cfg:M.getBoxConfiguration()}});}else{N.deleteBox(M);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.TextBoxDocSelector","mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper");var J=mstrmojo.array,O=mstrmojo.string,I=mstrmojo.elementHelper,H=I.ELEM_ALL_ID;var E=0,L=1,K=2;var D=1,N=3;mstrmojo.SearchBoxDocSelector=mstrmojo.declare(mstrmojo.TextBoxDocSelector,null,{scriptClass:"mstrmojo.SearchBoxDocSelector",filterElemALL:false,_buildEvent:function F(T,S){var Q=[],U,R=this.defn;J.forEach(S.items,function(V){Q.push(V.v+";"+O.decodeHtmlString(V.n));});U=Q.length;if(!U){Q.push(H);}if(Q.length>0||!R.nsb||R.nsb===E){T.eid=Q.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}else{if(R.nsb===L||!R.showall){T.unset=true;}else{if(R.nsb===K){T.eid=H;}}}if(R.sec){if(R.multi){this.parent.set("count",I.buildElemsCountStrByNum(U,0));}else{this.parent.set("count",I.buildElemsCountStrByNum(0,0));}}},updateWidget:function P(Y){var R=this._super(Y),S=Y.node,X=S.defn,V=S.data,Q=V.elms;if(Q&&!X.sos){R.candidates=this.setupCandidates(X,Q);}if(X.srcid){var T=[],W,U=J.filter(V.ces,function(a){return a.v!=="u;";});if(U&&U.constructor===Array){if(X.dfm==D){for(W=0;W<U.length;W++){if(U[W]["t"]!=N){T.push(U[W]);}}}else{T=U.concat();}}if(!X.sos){var Z=[];J.forEach(T,function(a){if(J.find(R.candidates.items,"v",a.v)>-1){Z.push(a);}});T=Z;}R.items=T;}return R;},getCekEvtListener:function C(R,Q){return function(S){R.handleActionInSyncPhase(function(){Q.set("items",S.value);});};},getWidgetConfig:function G(W,T,S,V){var R=W.getFormats(),U=W.node.data,Q=this._super(W,T,S,V);Q={scriptClass:Q.scriptClass,cssText:R.height?"height: "+R.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(S.ttl||""),items:S.srcid?(U.ces?U.ces.concat():[]):[],REQUEST_THRESHOLD:(mstrApp&&mstrApp.SEARCH_REQUEST_THRESHOLD)||55,suggestCount:(mstrApp&&mstrApp.SEARCH_SUGGESTION_LENGTH)||50,srcid:S.srcid||"",dsrc:S.dsrc||"",onitemsChange:function(){if(!W._inSyncPhase){W.showInfoWin();W.selectorControlChange(this);}}};if(V&&!S.sos){Q.candidates=this.setupCandidates(S,V);}else{Q.useKeyDelay=true;Q.noCache=true;}if(!S.multi){Q.maxObjectCount=1;}return Q;},isSelectAll:function A(){var Q=this.children&&this.children[0];return Q===undefined?true:(!Q.items||Q.items.length==0);},setupCandidates:function M(R,S){var Q=R.srcid?S:[];if(this.filterElemALL){Q=J.filter(Q,function(T){return T.v!=="u;";});}return{isComplete:true,items:Q};},isValidSelection:function B(){var R=this.node.data,Q=this.model;if(Q.isSelWarnFlagOn(this.k)&&R.ces&&R.ces.length===0){return R.elms.length!==0;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.MetricQualDocSelector");mstrmojo.MetricSliderDocSelector=mstrmojo.declare(mstrmojo.MetricQualDocSelector,null,{scriptClass:"mstrmojo.MetricSliderDocSelector",_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},newAndInitWidget:function A(D){var E=this._super(D);D.attachEventListener("includeChange",E.id,function(F){this.set("include",F.value);});return E;},getWidgetConfig:function C(H,F,E,G){var D=this._super(H,F,E,G);H.extCls="extSlider";D.isHoriz=true;D.include=E.include;return D;},isSelectAll:function B(){var D=this.children&&this.children[0];return D===undefined?true:D.unSet;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Table","mstrmojo.CheckBox","mstrmojo.ME.LevelInputBox","mstrmojo.ME.ConditionInputBox","mstrmojo.ME.TransformInputBox","mstrmojo.ME.MetricDataService","mstrmojo.Button","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper","mstrmojo.mstr.EnumFunction");mstrmojo.requiresDescs(1107,1281,2148,2397,2399,3324,3377,4788,6223,9577,9579,9581,9582,9583,9584,11564,11565,12178,12179,12853);var Q=mstrmojo.expr,G=mstrmojo.array,B=mstrmojo.mstr.EnumFunction,R=mstrmojo.ME._MetricEditorHelper,A=mstrmojo.ME.MetricToken.brackets;var N,M;var C=function(){var E=this.isDME?mstrmojo.desc(12178,"Visualization level"):mstrmojo.desc(1107,"Report Level");return mstrmojo.hash.copy({n:E,did:-1,t:-1,state:0});};var X={level:-4,condition:-5,transformation:-6,simple:-7},O=function(E){return !(E===-4||E===-5||E===-6);},L=function(Y,E){return O(Y)||parseInt(Y,10)===X[E];},U=function(E){return E===-4||E===-5||E===-6||E===-7;};var W={n:"",did:"-1",desc:""},D={1:"+",2:"*",3:"%",4:""},F={1:"",2:"!",3:"<",4:">",5:"<|",6:">|"},H=function(a,Z){var c,E,b;switch(Z){case"level":c=[Q.TP.ATTR,Q.TP.DIM];E="onLevelAdded";b=16;break;case"transform":c=[Q.TP.ROLE];E="onTransformAdded";b=26;break;case"condition":c=[Q.TP.FILTER,Q.STP.PROMPT_OBJECTS];E="onConditionAdded";b=10;break;case"expression":c=[Q.TP.FACT,Q.TP.ATTR,Q.TP.FUNCTION,Q.TP.METRIC];E="onExpressionAdded";b=25;break;default:}c[c.length]=Q.TP.FOLDER;a.openPopup("ob",{zIndex:a.zIndex+10});var Y=a.ob.browser;Y.browse({folderLinksContextId:b,onSelectCB:[a,E],browsableTypes:c.join(","),includeObjectDesc:true});};mstrmojo.ME._HasLevel=mstrmojo.provide("mstrmojo.ME._HasLevel",{_mixinName:"mstrmojo.ME._HasLevel",isAggFunction:false,init:function V(E){if(this._super){this._super(E);}N=this.id;M=this;},onOpen:function K(){if(this._super){this._super();}if(!this.isAggFunction){return ;}M=this;var Y=this.getLCTDefFromTokens();this.updateToggleBarStatus(Y);var E=this.metricLCT.levelInput;E.set("candidates",this.getCandidates4LCT([Q.TP.ATTR,Q.STP.NDE]));E.set("items",Y.level);var Z=this.metricLCT.conditionInput;if(!this.noCache&&!Z.candidates&&!this.isDME){mstrmojo.ME.MetricDataService.getFilters({pattern:"*",blockBegin:1,blockCount:-1},{success:function(b){if(b){Z.set("candidates",{items:b.items,isComplete:(b.bc===-1||(b.bb+b.bc>b.sz))});}},failure:function(b){mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}else{Z.candidates=this.getCandidates4LCT([Q.TP.FILTER,Q.STP.PROMPT_OBJECTS]);this.metricLCT.lblCondition.set("visible",Y.filter.length>0);}Z.set("items",Y.filter);var a=this.metricLCT.transformInput;if(!this.noCache&&!a.candidates&&!this.isDME){mstrmojo.ME.MetricDataService.getTransformations({pattern:"*",blockBegin:1,blockCount:-1},{success:function(b){if(b){a.set("candidates",{items:b.items,isComplete:(b.bc===-1||(b.bb+b.bc>b.sz))});}},failure:function(b){mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}else{a.candidates=this.getCandidates4LCT(Q.TP.ROLE);this.metricLCT.lblTransform.set("visible",Y.tranformation.length>0);}a.set("items",Y.tranformation);},getLCTDefAsTokens:function P(){if(!this.isAggFunction){return[];}var h=this.metricLCT.levelInput.getSelectedObjects(),b=this.metricLCT.conditionInput.getSelectedObjects(),Z=this.metricLCT.transformInput.getSelectedObjects(),e=[],Y,a,c,E=function(l,k){return l.filtering===1?"("+k+")":k;};e.push({v:"{",isDelimiter:true});var f=null;for(a=0,c=h.length;a<c;a++){f=h[a];e.push({v:F[f.grouping],isDelimiter:true});if(R.isDimty(f.n)){e.push({v:E(f,f.n)});}else{if(/^@/.test(f.did)){e.push({v:E(f,f.did)});}else{if(f.did===-1){e.push({v:"~",isDelimiter:true});}else{e.push({v:A(f.n),oi:f});}}}e.push({v:D[f.filtering],isDelimiter:true});if(a<(c-1)){e.push({v:", ",isDelimiter:true});}}if(!this.levelFilterRest){e.push({v:";",isDelimiter:true});e.push({v:"-",isDelimiter:true});}if(!this.levelCanContinue){e.push({v:";",isDelimiter:true});e.push({v:"/",isDelimiter:true});}e.push({v:"}",isDelimiter:true});if(b.length>0){e.push({v:"<",isDelimiter:true});Y={v:A(b[0].n)};if(b[0].did){Y.oi=b[0];}e.push(Y);e.push({v:";",isDelimiter:true});e.push({v:"@",isDelimiter:true});e.push({v:this.conditionEmbedMethod});e.push({v:";",isDelimiter:true});e.push({v:this.conditionIgnoreFilterElem?"-":"+",isDelimiter:true});e.push({v:">",isDelimiter:true});}var g=G.indexOf(Z,W);c=g<0?Z.length:g;if(c>0){e.push({v:"|",isDelimiter:true});var d=null;for(a=0;a<c;a++){d=Z[a];Y={v:A(d.n)};if(d.did){Y.oi=d;}e.push(Y);if(a<(c-1)){e.push({v:", ",isDelimiter:true});}}e.push({v:"|",isDelimiter:true});}for(a=0,c=e.length;a<c;a++){e[a].isNew=true;}return e;},getLCTDefFromTokens:function S(){var Y=[],a=false,f=[],d=[],h=this.oi.tks.items,g=h.length,e;if(this.insertMode||g===0){Y.push(C.call(this));}else{for(e=0;e<g;e++){var b=h[e],k=b.tp,Z=b.sctt;switch(Z){case 262144:a=true;switch(k){case 64:case 126:case 264:case 265:case 310:var c=e,l;if(k===64){var E=b.v+h[++e].v;b=h[e+1];if(b.tp===43||b.tp===45){E+=h[++e].v;E+=h[++e].v;}else{if(b.tp===41){e++;}}l=mstrmojo.ME.Enum.DYNAMIC_DIMTY.getDimtyObject(E,this.isDME);}else{l=k===126?C.call(this):b.oi;}l.grouping=1;l.filtering=4;switch(h[c-1].tp){case 33:l.grouping=2;break;case 60:l.grouping=3;break;case 62:l.grouping=4;break;case 297:l.grouping=5;break;case 298:l.grouping=6;break;}switch(h[e+1].tp){case 37:l.filtering=3;break;case 42:l.filtering=2;break;case 43:l.filtering=1;break;}Y.push(l);break;case 45:this.levelFilterRest=false;break;case 47:this.levelCanContinue=false;break;}break;case 327680:switch(k){case 270:case 273:f.push(b.oi);break;case 262:this.conditionEmbedMethod=b.v;break;case 43:this.conditionIgnoreFilterElem=false;break;case 45:this.conditionIgnoreFilterElem=true;break;}break;case 393216:switch(k){case 271:d.push(b.oi);break;}break;}}if(Y.length===0&&!a){Y.push(C.call(this));}}return{level:Y,filter:f,tranformation:d};},levelCanContinue:true,levelFilterRest:true,conditionEmbedMethod:2,conditionIgnoreFilterElem:true,_set_candidates:function(b,Y){this.candidates=Y;if(this.hasRendered){var E=this.metricLCT.levelInput,Z=this.metricLCT.conditionInput,a=this.metricLCT.transformInput;E.candidates=this.getCandidates4LCT([Q.TP.ATTR,Q.STP.NDE]);Z.candidates=this.getCandidates4LCT([Q.TP.FILTER]);a.candidates=this.getCandidates4LCT([Q.TP.ROLE]);}return true;},getCandidates4LCT:function J(a,E){var Z=this.candidates,Y;if(Z){a=G.ensureArray(a);Y=G.filter(Z.items,function(b){return G.indexOf(a,b.t)>-1||G.indexOf(a,b.st)>-1;});if(G.indexOf(a,12)>-1&&E){if(this.replaceAttributeWithForms){Y=this.replaceAttributeWithForms(Y);}}return{items:Y,isComplete:Z.isComplete};}return null;},updateToggleBarStatus:function I(E){var Y=false;if(E.level){Y=E.level.length>1||E.level.length==1&&E.level[0].did!==-1;}if(E.filter){Y=Y||E.filter.length>0;}if(E.transformation){Y=Y||E.transformation.length>0;}if(U(this.did)){Y=true;}this.metricLCT.toggle.set("selected",Y);},levelAdvRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9577,"Level Advanced Options"),help:"Level_Advanced_Options_dialog_box.htm",cssClass:"mstrmojo-ME-level-options",onOpen:function(){var E=this.opener;this.contentTable.ccCheckBox.set("checked",E.levelCanContinue);this.contentTable.frCheckBox.set("checked",E.levelFilterRest);},children:[{scriptClass:"mstrmojo.Table",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.CheckBox",alias:"ccCheckBox",slot:"0,0",label:mstrmojo.desc(9583,"Allow other users to add extra units to this definition")},{scriptClass:"mstrmojo.CheckBox",alias:"frCheckBox",slot:"1,0",label:mstrmojo.desc(9584,"Include filter attributes which are not in report or level in metric calculation")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.saveLevelOptions(E.contentTable.ccCheckBox.checked,E.contentTable.frCheckBox.checked);E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},conditionAdvRef:{scriptClass:"mstrmojo.Editor",title:"Condition Advanced Options",help:"Condition_Advanced_Options_dialog_box.htm",cssText:"width: 286px;",onOpen:function(){var E=this.opener;this.contentTable.emPulldown.set("value",E.conditionEmbedMethod);this.contentTable.irfeCheckBox.set("checked",E.conditionIgnoreFilterElem);},children:[{scriptClass:"mstrmojo.Table",cssText:"margin-top:5px;",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(9585,"Interaction between metric filter and report filter: ")},{scriptClass:"mstrmojo.Pulldown",alias:"emPulldown",itemField:"n",itemIdField:"did",slot:"1,0",value:2,items:[{n:mstrmojo.desc(9586,"Merge into new"),did:1},{n:mstrmojo.desc(9587,"Merge report filter into metric"),did:2},{n:mstrmojo.desc(9588,"Merge metric condition into report"),did:3}]},{scriptClass:"mstrmojo.CheckBox",alias:"irfeCheckBox",slot:"2,0",label:mstrmojo.desc(9589,"Ignore related report filter elements")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.saveConditionOptions(E.contentTable.emPulldown.value,E.contentTable.irfeCheckBox.checked);E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},getLCTComponent:function T(){return{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-ME-LCT",alias:"metricLCT",layout:[{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{cssText:"width:252px;padding-right:6px;"}]}],bindings:{visible:function(){return this.parent.isAggFunction;}},labelWidth:"auto",children:[{scriptClass:"mstrmojo.Button",cssClass:"toggle",alias:"toggle",text:mstrmojo.desc(6223,"Show All"),selected:false,bindings:{visible:function(){return !this.parent.parent.isDME;}},onclick:function(E){var Y=!this.selected;this.set("selected",Y);},slot:"0,0"},{scriptClass:"mstrmojo.Label",alias:"lblLevel",text:mstrmojo.desc(4788,"Level"),bindings:{visible:function(){return this.parent.parent.isDME||!this.parent.parent.isDME&&this.parent.toggle.selected;},width:"this.parent.labelWidth"},onwidthChange:function(){if(this.hasRendered){this.domNode.style.width=this.width;}},slot:"1,0"},{scriptClass:"mstrmojo.ME.LevelInputBox",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(2148,"Attribute").toLowerCase()),alias:"levelInput",dtp:-4,xacptSugItemOnly:true,bindings:{noCache:function(){return this.parent.parent.noCache;},isDME:function(){return this.parent.parent.isDME;},visible:function(){return this.parent.lblLevel.visible;}},reportLevelAdded:true,onadd:function(E){var Y=this.getSelectedObjects();this.set("reportLevelAdded",G.find(Y,"did",-1)>-1);},onremove:function(E){var Y=this.getSelectedObjects();this.set("reportLevelAdded",G.find(Y,"did",-1)>-1);},onitemchange:function(){this.parent.parent.onmetricModify();if(M.updateScrollbars){M.updateScrollbars();}},onSaveOnClose:function(){this.parent.parent.onmetricModify();},slot:"1,1"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link-text right bold",text:mstrmojo.desc(9577,"Level Advanced Options"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},onclick:function(){var E=this.parent.parent;E.openPopup("levelAdvRef",{saveLevelOptions:function(Z,Y){E.levelCanContinue=Z;E.levelFilterRest=Y;},zIndex:E.zIndex+10});},slot:"1,1"},{scriptClass:"mstrmojo.Label",alias:"lblCondition",text:mstrmojo.desc(9579,"Condition"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},slot:"2,0"},{scriptClass:"mstrmojo.ME.ConditionInputBox",cssClass:"mstrmojo-ME-ObjectInputBox-condition singleObject",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(1281,"Filter").toLowerCase()),alias:"conditionInput",dtp:-4,xacptSugItemOnly:true,bindings:{visible:function(){return this.parent.lblCondition.visible;},isDME:function(){return this.parent.parent.isDME;},noCache:function(){return this.parent.parent.noCache;}},onitemchange:function(){this.parent.parent.onmetricModify();},slot:"2,1"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link-text right bold condition",text:mstrmojo.desc(9581,"Condition Advanced Options"),bindings:{visible:function(){return this.parent.lblCondition.visible&&!this.parent.parent.isDME;}},onclick:function(){var E=this.parent.parent;E.openPopup("conditionAdvRef",{saveConditionOptions:function(Z,Y){E.conditionEmbedMethod=Z;E.conditionIgnoreFilterElem=Y;},zIndex:E.zIndex+10});},slot:"2,1"},{scriptClass:"mstrmojo.Label",alias:"lblTransform",text:mstrmojo.desc(3324,"Transformation"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},slot:"3,0"},{scriptClass:"mstrmojo.ME.TransformInputBox",cssClass:"mstrmojo-ME-ObjectInputBox-transform",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),alias:"transformInput",dtp:-4,xacptSugItemOnly:true,bindings:{visible:function(){return this.parent.lblTransform.visible;},isDME:function(){return this.parent.parent.isDME;},noCache:function(){return this.parent.parent.noCache;}},onitemchange:function(){this.parent.parent.onmetricModify();if(M.updateScrollbars){M.updateScrollbars();}},slot:"3,1"}]};}});mstrmojo.ME._HasLevel.EnumEditorComponents=X;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.Box","mstrmojo.ValidationTextBox","mstrmojo.ME.AttributeEditBox","mstrmojo.ME.MetricEditBox","mstrmojo.ME.MetricToken","mstrmojo.ME.DynamicLinkEditBox","mstrmojo.mstr.EnumDSSXMLTokenStates");mstrmojo.requiresDescs(2399,2400,3993,4547,11569,11617,14720,14722);var H=mstrmojo.desc,X=mstrmojo.Button.newWebButton,L=mstrmojo.array,Q=mstrmojo.hash,I=mstrmojo.ME.MetricToken.brackets,V=mstrmojo.ME.AttributeEditBox.preprocessTokenStream,M=mstrmojo.ME.AttributeEditBox.getTokenStreamXML,K=mstrmojo.ME.AttributeEditBox.validateSyntax,O=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,Z=mstrmojo.ME.DynamicLinkEditBox.preProcessBackendTks,b=mstrmojo.ME.DynamicLinkEditBox.convertBackendTksToDisplayTks,B=mstrmojo.ME.DynamicLinkEditBox.addDoubleQuotationMark,a=mstrmojo.ME.DynamicLinkEditBox.preprocessDisplayTokens,e=mstrmojo.ME.DynamicLinkEditBox.constructBackendToken,U=mstrmojo.mstr.EnumDSSXMLTokenStates;function G(g,f){g.set("enabled",!f);g.set("iconClass",g.iconClass.replace(/mstrmojo-InlineWaitIcon/,"")+" "+(f?"mstrmojo-InlineWaitIcon":""));}function N(f,g){if(f&&g){g.candidates=null;g.set("candidates",f);}}function d(f){if(f.oi&&f.oi.alias){return ;}f.tmr=window.setInterval(function(){if(f.visible&&f.domNode){window.clearInterval(f.tmr);delete f.tmr;f.nameEditBox.nameInput.inputNode.select();}},50);}function c(f){return{n:f,k:f,ftk:[],vs:1,is:""};}mstrmojo.ME.DynamicLinkEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.DynamicLinkEditor",cssClass:"mstrmojo-DAEditor mstrmojo-DLEditor",zIndex:10,help:"creating_a_grid_visualization_html5.htm#dynamic-link",useKeyDelay:true,noCache:false,name:"New Link",attrid:null,forms:null,defaultIDToken:undefined,editingNode:undefined,init:function T(f){if(this._super){this._super(f);}},postBuildRendering:function Y(){this._super();this.hrefInput.inputBox.attachEventListener("tokenInputBoxSelected",this.id,"ontokenInputBoxSelected");this.linkTextInput.inputBox.attachEventListener("tokenInputBoxSelected",this.id,"ontokenInputBoxSelected");},onObjectInsert:function S(f){this.editingNode=this.editingNode||this.hrefInput;this.editingNode.onObjectInsert(f);},onOpen:function F(){var m=this;var l=this.oi;var p=l.alias||l.n||"New Link";N(m.attrCandidates,m.linkTextInput.inputBox);N(m.attrCandidates,m.hrefInput.inputBox);this.linkTextInput.inputBox.noCache=this.hrefInput.inputBox.noCache=this.noCache;this.linkTextInput.inputBox.useKeyDelay=this.hrefInput.inputBox.useKeyDelay=this.useKeyDelay;this.set("name",p);this.set("nameLabel",mstrmojo.desc(14722,"Link Name"));if(l&&l.forms){this.set("attrid",l.did);this.forms=l.forms;L.forEach(this.forms,function(n){V({items:n.ftk});});this.updateInputBoxesItems();}else{var h=this.parent.action.refOi;var o=h&&h.fs&&h.fs[0];this.defaultIDToken=o?{extp:8,exv:o.fid,ift:true,isNew:true,oi:h,v:I(h.n)+"@"+I(o.fnm),isRawStr:false}:null;var g=Q.clone(this.defaultIDToken);var f=[{isDelimiter:true,isNew:true,v:"{"},g,{isDelimiter:true,isNew:true,v:"}"}],k=[{v:"http://",isDelimiter:false,isNew:true,sta:1,ift:undefined}];this.linkTextInput.updateInputBoxItems({items:f});this.hrefInput.updateInputBoxItems({items:k});this.set("forms",[c("ID"),c("DYNAMICLINK")]);}this.linkTextInput.set("cValid",true);this.hrefInput.set("cValid",true);d(this);},onClose:function C(){if(this._super){this._super();}this.clear();},onformsChange:function(){var f=this.forms;L.forEach(f,function(g){V({items:g.ftk});});},ontokenInputBoxSelected:function(h){var f=h&&h.src&&h.src.parent,g=f&&f.alias;this.editingNode=this[g]||this.hrefInput;},updateInputBoxesItems:function(){var f=this.forms;if(!f){return ;}var k=f[0].ftk,g=f[1].ftk,n=this.translateBackendTokensToDisplayTokens(g),h=n[0],m=n[1];this.linkTextInput.updateInputBoxItems({items:h});this.hrefInput.updateInputBoxItems({items:m});var l=Z(k);this.defaultIDToken=l[0];this.defaultIDToken.isRawStr=false;},save:function W(){var m=this.parent.id,u=this.oi,k=this.buttonBar.saveBtn,l=this,n=this.hrefInput,r=this.linkTextInput,f=u.dsid,h=u.did,o,q=this.oncreate,g=this.onupdate,x=this.nameEditBox.nameInput.value;var w={success:function v(){G(k,false);l.clear();var z=mstrmojo.all[m];if(z){z.close();}}};var t=function(AA){if(AA&&q){var z=[],AB;for(AB=0;AB<AA.length;AB++){z.push({n:AA[AB].n,formula:AA[AB].tokenXML});}if(z[1]){z[1].bft=7;}o={act:"addDAToDataset",dsid:f,name:x,isTokenStream:true,forms:z};q(o,w);}else{G(k,false);}};var p=function(z){if(z&&g){var AC=[],AB=[],AE,AD,AA;for(AA=0;AA<z.length;AA++){AE=z[AA];AD={n:AE.n,formula:AE.tokenXML};if(AE.did){AD.did=AE.did;AB.push(AD);}else{AC.push(AD);}}o={act:"updateDA",name:x,dsid:f,attrId:h,isTokenStream:true,add:AC,del:[],update:AB};g(o,w);}else{G(k,false);}};if(n.dirty||r.dirty||x!==(u.alias||u.n)){G(k,true);this.linkTextInput.set("vStatus",O.VALIDATING);this.hrefInput.set("vStatus",O.VALIDATING);this.validateForms(!h?t:p);}else{w.success();}},generateTksToBeSent:function A(h,m,k){var g=function(v,u){var t=[],r={};if(k){t.push(k);r[k.v]=[k.oi&&k.oi.did];}var q=function q(x,AA){var w=AA[x.v];if(w){var z=x.oi&&x.oi.did;if(z&&w.indexOf(z)===-1){w.push(z);return false;}return true;}AA[x.v]=[x];return false;};L.forEach([].concat(v,u),function(w){if(!w.isRawStr&&!q(w,r)){t.push(w);}});return e(t);};var o={v:"<a href='",isRawStr:true,isNew:true},p={v:"' target='_blank'>",isRawStr:true,isNew:true},n={v:"</a>",isRawStr:true,isNew:true},f=a(h)||[],l=a(m)||[];return[g(f,l),e([o].concat(f,p,l,n))];},translateBackendTokensToDisplayTokens:function J(l){var k=Z(l),f=L.find(k,"v",B("' target='_blank'>"));if(f===-1||k[0].v!==B("<a href='")||k[k.length-1].v!==B("</a>")){return[[],[]];}var h=k.slice(1,f),g=k.slice(f+1,k.length-1);return[b(g),b(h)];},validateForms:function E(p){var o=this,g=this.hrefInput,m=this.linkTextInput,n=this.generateTksToBeSent(g.inputBox.items,m.inputBox.items,this.defaultIDToken);this.forms[0].ftk=n[0];this.forms[1].ftk=n[1];var h=this.forms;var l=function f(r){var q=h[0];q.ftk=r.items;q.vs=r.vs;q.is=r.rjed||"";q.tokenXML=M({items:r.items});if(r.vs!==O.VALID){if(p){p(null,false);}}else{if(p){p(h,true);}}};var k=function k(v){var u=h[1];u.ftk=v.items;u.vs=v.vs;u.is=v.rjed||"";u.tokenXML=M({items:v.items});if(v.vs!==O.VALID){var r=o.translateBackendTokensToDisplayTokens(v.items);var q={};var t={};Q.copy(v,q);Q.copy(v,t);q.items=r[0];t.items=r[1];if(L.find(q.items,"sta",U.Error)===-1){q.vs=O.UNKNOWN;q.rjed=undefined;q.rjec=undefined;}if(L.find(t.items,"sta",U.Error)===-1){t.vs=O.UNKNOWN;t.rjed=undefined;t.rjec=undefined;}m.handleValidation(q);g.handleValidation(t);if(p){p(null,false);return ;}}K(o.attrid,{items:h[0].ftk},true,l);};K(this.attrid,{items:h[1].ftk},false,k);},clear:function R(){this.name=null;this.linkTextInput.clear();this.hrefInput.clear();},children:[{scriptClass:"mstrmojo.Box",alias:"nameEditBox",cssClass:"mstrmojo-ME-nameEditBox",cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-DA-nameLabel",bindings:{text:"this.parent.parent.nameLabel"}},{scriptClass:"mstrmojo.ValidationTextBox",alias:"nameInput",cssClass:"mstrmojo-ME-nameInput",size:20,tooltipOpenDelay:0,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,invalidCssClass:"mstrmojo-ME-invalidName"},prefocus:function(){if(this._super){this._super();}this.validate();},validate:function(f){f=f||this.value;var g=f&&!/[\[\]\"\\]/g.test(f);this.valid=null;this.set("valid",g);this.set("validationStatus",{code:g?0:1});return g;},showErrTooltip:function D(){var f=mstrmojo.dom.position(this.domNode),h=mstrmojo.string.isEmpty(this.value)?mstrmojo.desc(9122,"Name cannot be empty"):mstrmojo.desc(11569,"Input contains invalid character");this.useRichTooltip=true;this.richTooltip={contentNodeCssClass:"me-tooltip-content left me-err",content:'<div class="content"><span>'+h+"</span></div>",top:f.y-5,left:f.x+f.w+10};this.showTooltip();var g=this;window.setTimeout(function(){g.hideTooltip();},1500);},valid:true,onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.set("validationStatus",1);this.showErrTooltip();}mstrmojo.css.toggleClass(this.parent.domNode,"err",!this.valid);},bindings:{value:"this.parent.parent.name"}}]},{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-DL-Label",text:mstrmojo.desc(14720,"URL Display Text")},{scriptClass:"mstrmojo.Button",alias:"validateBtn",text:mstrmojo.desc(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-validate",onclick:function(){this.parent.parent.linkTextInput.backendValidate();}}]},{scriptClass:"mstrmojo.ME.DynamicLinkEditBox",alias:"linkTextInput",renderOnScroll:false,renderBlockSize:0,browseItemVisible:false,cValid:false,bindings:{candidates:"this.parent.parent.attrCandidates"},getStatusDesc:function P(f){return{0:mstrmojo.desc(11655,"Valid Formula."),1:mstrmojo.desc(3993,"Example:")+" Link for {City@ID}'s images"}[f];}},{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-DL-Label",text:mstrmojo.desc(4547,"Navigate to this URL")},{scriptClass:"mstrmojo.Button",alias:"validateBtn",text:mstrmojo.desc(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-validate",onclick:function(){this.parent.parent.hrefInput.backendValidate();}}]},{scriptClass:"mstrmojo.ME.DynamicLinkEditBox",alias:"hrefInput",renderOnScroll:false,renderBlockSize:0,browseItemVisible:false,cValid:false,bindings:{candidates:"this.parent.parent.attrCandidates"},getStatusDesc:function P(f){return{0:mstrmojo.desc(11655,"Valid Formula."),1:mstrmojo.desc(3993,"Example:")+" http://www.google.com/search?tbm=isch&q={City@ID}"}[f];}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[X(H(2400,"Save"),function(){var f=this.parent.parent;f.save();},true,{alias:"saveBtn",bindings:{enabled:"!!(this.parent.parent.nameEditBox.nameInput.valid && this.parent.parent.hrefInput.cValid && this.parent.parent.linkTextInput.cValid)"}}),X(H(2399,"Cancel"),function(){var f=this.parent.parent,g=f.parent;f.clear();g.close();})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.PanelPortlet","mstrmojo.css");var A=mstrmojo.css;function C(){A.toggleClass(this.titleBar.leftToolNode,"hidden",this.hideCollapse);}mstrmojo.vi.ui.DatasetPortlet=mstrmojo.declare(mstrmojo.vi.ui.PanelPortlet,null,{scriptClass:"mstrmojo.vi.ui.DatasetPortlet",cssClass:"docdataset-unitlist-portlet",suffix:"",showTitleBarContextMenu:true,init:function D(E){this._super(E);this.addChildren([this.getDatasetTypeCfg(E.dataset)]);},getDatasetTypeCfg:function(E){var F=(E.dsm===1)?mstrmojo.desc(14453,"In Memory"):mstrmojo.desc(14452,"Live");if(E.connInfo&&E.dsm===2){F+="("+E.connInfo.isn+")";}return{scriptClass:"mstrmojo.Label",slot:"titlebarNode",alias:"typeBar",text:F,cssClass:"dataset-type"};},postBuildRendering:function(){this._super();C.call(this);},getTitleBarCfg:function B(){var E=this._super(),F=this;if(this.suffix&&this.suffix.length>0){E.getTitleChildren=function(){return[{scriptClass:"mstrmojo.Label",slot:"textNode",alias:"suffixNode",cssClass:"suffix",text:F.suffix}].concat(this.constructor.prototype.getTitleChildren.call(this));};}E.layoutConfig={w:{leftToolNode:"auto",textNode:"100%",rightToolNode:"auto"},h:{leftToolNode:"22px",textNode:"22px",rightToolNode:"22px",containerNode:"22px"},xt:true};return E;}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.DatasetPortlet,{onhideCollapseChange:function(){C.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.string","mstrmojo.Label","mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.ScrollableDocTextfield","mstrmojo.DocHTMLContainer","mstrmojo.ui.ScrollableTextArea");var Z=mstrmojo.css,J=mstrmojo.dom,C=mstrmojo.string;var R=0,A=1;var T="url",N="htmlText";var K="http://",b=null,O=[{n:mstrmojo.desc(4555,"iFrame"),v:R,id:0},{n:mstrmojo.desc(4554,"Html Text"),v:A,id:1}];function c(d,e,f){this.model.editHtmlContainer(this,d,e,f);}function Q(d,e){var g=this.ctrlOverlay,f=parseInt(e.match(/\d+/),10);if(g&&g.visible){Z.toggleClass(g.domNode,"v",f<310||parseInt(d.match(/\d+/),10)>f);}}function L(d,e,f){return function(){var p=d?N:T,n=mstrmojo.all[f],m=n.parent,l=n.node,k=m.defn,h=m.htmlType!==d;if(h){m.htmlType=d;var g={scriptClass:d===R?"mstrmojo.DocHTMLContainer":"mstrmojo.vi.ui.ScrollableDocTextfield",id:l.id,node:l,slot:"containerNode",alias:"boxContent",controller:n.controller,model:n.model,k:l.k,defn:l.defn,builder:n.builder,tooltip:n.tooltip,formatHandlers:{domNode:["D"]},edtModel:n.edtModel};m.removeAndDestroyChild(n);m.addChildren(g);m.boxContent.render();n=m.boxContent;}if(h||k[p]!==e){k[p]=e;l.data.v=l.data.rv=e;if(m.htmlType===A){n.updateScrollbars();}}n.update(l);n.refresh();m.selectVIUnit(true);var o=m.ctrlOverlay;if(o&&o.visible&&!mstrmojo.string.isEmpty(e)){m.hideControlOverlay();}};}function D(){return mstrApp.isSingleTier||this.model.controller.rootCtrl.resolveFeature("create-html-container");}mstrmojo.vi.ui.rw.HtmlBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,null,{scriptClass:"mstrmojo.vi.ui.rw.HtmlBox",htmlType:R,textArea:undefined,typeBtn:undefined,init:function V(e){this._super(e);var d=this.defn,f=this.boxContent.node.data;this.htmlType=d.ht?A:R;d[this.htmlType?N:T]=C.decodeHtmlString(f.rv||f.v);Z.addWidgetCssClass(this,"mstrmojo-HtmlBox");},postBuildRendering:function W(){this._super();this.addDragHandle();if(!this.boxContent.node.data.v&&mstrApp.allowWebDashboardDesign()&&D.call(this)){this.showControlOverlay(this.getEditOverlayControls());}},applyBoxSize:function U(d,f,k,h){this._super(d,f,k,h);var g=this.boxContent,e=g&&g.getFormats();if(e){g.clearCache();e.height=d;e.width=f;g.refresh();}Q.call(this,d,f);},getAvatarCls:function S(){return this._super().concat(["htmlAvatar"]);},getDisplayName:function M(){return this.defn.n||mstrmojo.desc(4538,"HTML Container");},createDeleteUpdate:function G(){return this.model.getRemoveFieldUpdate(this);},updateHtmlBox:function Y(f,g){var d=this.htmlType,e=this.defn[d?N:T],h=this.boxContent.node.id;if(d!==f||e!==g){c.call(this,f,g,{success:L(f,g,h),undo:L(d,e,h),redo:L(f,g,h)});}},setDefaultTextCaretPosition:function F(e,d){if(e.value===d){window.setTimeout(function(){var f=d===b?(d.indexOf("</body>")-1):(d.indexOf("//")+2);J.setCaret(e,f);},0);}},getHintText:function a(){return[K,b];},isDragValid:function B(d){if(!this._super(d)){return false;}var g=d.src,f=this.ctrlOverlay,e=f&&f.textArea;return !(e&&J.contains(e.domNode,J.eventTarget(g.hWin,g.e)));},getEditOverlayControls:function I(){var g=this,e=this.htmlType,f=this.boxContent.edtModel;return[{scriptClass:"mstrmojo.Label",cssClass:"icn"},{scriptClass:"mstrmojo.Label",cssClass:"title",text:mstrmojo.desc(13623,"HTML container:")},f.getButtonBar(O,e,function(l){var k=l.v,m=this.parent.textArea;m.set("emptyText",g.getHintText()[k]);m.set("value","");m.refresh();},{alias:"typeBtn",showIcon:false,cssClass:"htmlTypeBtn"}),{scriptClass:"mstrmojo.ui.ScrollableTextArea",emptyText:this.getHintText()[e],maxLength:undefined,alias:"textArea",cssClass:"htmlText",keepEmpty:true,onfocus:function h(){g.setDefaultTextCaretPosition(this.inputNode,this.emptyText);if(this.inputNode.value===this.emptyText){this.scrollNode.scrollTop=35;}},postvalueChange:function d(){this.parent.ctrlOkBtn.set("enabled",!!this.value);}},mstrmojo.Button.newWebButton(mstrmojo.desc(8708,"OK"),function(){var k=this.parent;g.updateHtmlBox(k.typeBtn.selectedItem.v,k.textArea.value);g.hideControlOverlay();},true,{alias:"ctrlOkBtn",enabled:false})];},showControlOverlay:function E(d){this.toggleDragHandleVisibility(false);this._super(d);this.boxContent.set("visible",false);},hideControlOverlay:function X(){this._super();this.toggleDragHandleVisibility(true);this.boxContent.set("visible",true);},switchToEditMode:function P(){var h=this.boxContent.node.data,e=h.rv||h.v,g=this.ctrlOverlay,f=g.textArea;if(g.visible){f.focus();return ;}this._super();Z.toggleClass(g.domNode,"v",parseInt(this.height.match(/\d+/),10)>parseInt(this.width.match(/\d+/),10));f=g.textArea;f.set("value",e);f.refresh();f.focus();},canShowDesignMenuItems:function H(){return this._super()&&D.call(this);}});mstrmojo.vi.ui.rw.HtmlBox.boxConfiguration={f:{h:150,v:140},minSize:{h:150,v:40},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.tooltip","mstrmojo.dom");var A=mstrmojo.dom;mstrmojo.vi.ui.rw.RichTooltipBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,null,{scriptClass:"mstrmojo.vi.ui.rw.RichTooltipBox",tooltipOpenDelay:300,tooltipTopOffset:8,tooltipLeftOffset:16,useRichTooltip:true,showTooltip:function C(H,G){var F=this,E=this.boxContent;if(E.canShowContentTooltip&&!E.canShowContentTooltip(H,G)){return ;}if(!F.hasOpenTooltip&&E){var D=A.getMousePosition(H,G);F.richTooltip={cssClass:"vi-regular vi-tooltip-A",content:E.tooltip,top:Math.max(D.y+this.tooltipTopOffset,0),left:Math.max(D.x-this.tooltipLeftOffset,0),posType:mstrmojo.tooltip.POS_TOPLEFT};this._super(H,G);}},moveTooltip:function B(D,F){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;if(this.hideTooltip){this.hideTooltip();}else{mstrmojo.tooltip.close();}}var H=this,E=D,G=F;this._tooltipTimeOut=setTimeout(function(){H.showTooltip(E,G);},this.tooltipOpenDelay);}});}());(function(){mstrmojo.requiresClsP("mstrmojo","array","css","hash","color","Editor","Button","Box","Label","num");mstrmojo.requiresClsP("mstrmojo.ui","Pulldown","Checkbox","CheckList");mstrmojo.requiresClsP("mstrmojo.threshold","ColorSlider","ThresholdModel");mstrmojo.requiresClsP("mstrmojo.models","FormatModel");mstrmojo.requiresDescs(2268,2281,2491,2519,3606,5585,7665,7666,7905,7907,7908,7909,7910,12110,12111,13613,13614,13615);var M=mstrmojo.array,X=mstrmojo.css,P=mstrmojo.hash,Q=mstrmojo.Button.newWebButton,U=mstrmojo.num,E=mstrmojo.models.FormatModel.getFormatUpdate,A=4;var V=mstrmojo.threshold.ThresholdModel.SLIDER_MODE,F=mstrmojo.threshold.ThresholdModel.FEATURES;var K=null,B=null,W=[{n:mstrmojo.desc(527,"Value"),v:7},{n:mstrmojo.desc(4405,"Lowest"),v:4},{n:mstrmojo.desc(529,"Highest"),v:5},{n:mstrmojo.desc(4406,"Lowest %"),v:1},{n:mstrmojo.desc(4407,"Highest %"),v:2}];function S(n){var o=[],l=this.colorSlider,k=l.getComp(),d=l.getPalette(),m=this.basedOn.value,f=this.model,g=this.controller,p=f.orgThresholds,a=this.metricId,c=p&&p[a],Z=this.breakBy.breakByList,h=Z.items[Z.selectedIndex],b=k.length,e,q;if(l.getReversedValue()){d=d.concat().reverse();}for(e=0;e<b;e++){q={};if(this.colorSlider.sliderMode===V.IMAGE_BASED){q.rtp=4;q.rtxt=d[e];}else{q.fmt=E("bc",d[e]);}if(e>0){q.flr=U.toLocaleString(f.getRealValue(k[e-1],m));}if(e<b-1||b===1){q.ceil=U.toLocaleString(f.getRealValue(k[e],m));}if(h&&h.did!==-1){q.dmy={did:h.did,t:h.t};}o.push(q);}g.onSubmitActions(o,c,a,g.supportsFeature(F.SHOW_BASED_ON)?this.basedOn.selectedMetric:a,this.basedOn.value,n,A);}function J(l){var f=this.model,b=f.thresholds&&f.thresholds[l],x=f.data.gsi,o=this.colorSlider,h=[],AC=[],g=[],n,AB,Z,q=this.colorPalettes,m=this.imageSelector,v=q.colorPulldown,AA=this.typeSelector.typeCheckList,a=m.imagePulldown,k=this.basedOn,d=k.options,u=k.metricsList,t=this.breakBy.breakByList,r=this.controller.supportsFeature(F.SHOW_BASED_ON);if(b&&b.length>0){n=f.getSimpleThresholdType(l);if(n!==-2){Z=f.isImageBasedType(l);b.forEach(function(e){var AE=P.copy(e),AD=AE.ceil;if(AD!==Infinity){AE.comp=f.getNormalizedValue(AD,e.ttp);}else{AE.comp=1;}h.push(AE);});h.sort(function(AD,e){return AD.comp-e.comp;});h.forEach(function(e){AC.push(e.comp);if(Z){g.push(e.rtxt);}else{g.push(e.fmt.bc);}});AA.set("selectedIndex",Z?V.IMAGE_BASED:V.COLOR_BASED);if(Z){AB=f.getImageSetName(g);a.set("selectedIndex",M.find(B,"v",AB));}else{AB=f.getColorScheme(g);if(AB==="custom"){this.switchToCustomScheme(AC,g);o.unselectAll();o.update();}else{v.set("items",K);v.set("selectedIndex",M.find(K,"v",AB));}}o.set("baseColor",AB);o.setColorComp(AB,AC);if(f.isMapReversed(AB,g,Z)){o.reverseMapColor();}if(r){var c=b[0].expr,p=c.m||c.nds[0].m;u.set("selectedIndex",M.find(x.mx,"did",(p&&p.did)||f.metricId));}d.set("selectedIndex",M.find(d.items,"v",n));var z;try{z=b[0].expr.nds[0].dmy.uts[0].utgt.did;}catch(w){}t.set("selectedIndex",Math.max(0,M.find(t.items,"did",z)));}}else{AA.set("selectedIndex",V.COLOR_BASED);v.set("items",K);v.set("selectedIndex",0);o.update();if(r){u.set("selectedIndex",0);}t.set("selectedIndex",0);}}function N(Z){this.parent.colorSlider.set("baseColor",Z);this.selectedColor=Z;}function O(){return mstrmojo.Button.newWebButton(mstrmojo.desc(12282,"Reversed"),function(){this.parent.parent.colorSlider.reverseMapColor(this.checked);},false,{cssClass:"reverse"});}function L(){var Z=this.model,b=this.basedOn.options,d=b.items,e=isNaN(Z.getMetricsMaxValue())||isNaN(Z.getMetricsMinValue()),a=(e||!this.controller.supportsFeature(F.SHOW_VALUE_ITEM))?W.slice(1):W,c=d[b.selectedIndex];if(a.length!==d.length){b.set("items",a);b.set("selectedIndex",Math.max(a.indexOf(c),0));}}mstrmojo.threshold.SimpleThresholdEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.threshold.SimpleThresholdEditor",cssClass:"mstrmojo-SimpleThresholdEditor",title:mstrmojo.desc(3647,"Thresholds"),help:"thresholds_editor.htm",model:undefined,controller:undefined,metricId:undefined,metricName:undefined,typeSelector:undefined,basedOn:undefined,breakBy:undefined,colorSlider:undefined,colorPalettes:undefined,imageSelector:undefined,showAdvancedEditorLink:undefined,init:function R(b){this._super(b);var a=mstrApp.customization.getCustomThresholds(),Z=function(c){return{n:mstrmojo.desc(c.title,"N/A"),v:c.id,cls:c.id};};if(!K){K=a.color.map(function(c){return Z(c);});}this.colorPalettes.colorPulldown.set("items",K);if(!B){B=a.image.map(function(d){var c=Z(d);c.bc=d.combinedImageUrl;return c;});this.imageSelector.imagePulldown.set("items",B);}},onOpen:function D(){var Z=this.controller,a=this.model,e=this.basedOn,c=e.options,f=e.metricsList,b=this.metricId,d=a.data.gsi;this.colorSlider.resetColorMap();X.toggleClass(this.containerNode,"hideImage",!Z.supportsFeature(F.SHOW_IMAGE));if(Z.supportsFeature(F.SHOW_BASED_ON)){X.addClass(c.domNode,"short");f.set("items",d.mx);f.set("visible",true);}else{f.set("visible",false);X.removeClass(c.domNode,"short");}this.breakBy.breakByList.set("items",[{n:mstrmojo.desc(2057,"None"),did:-1}].concat(this.targets.filter(function(g){return g.t===12;})));this.showAdvancedEditorLink.set("visible",Z.supportsFeature(F.SHOW_ADVANCED_EDITOR));J.call(this,b);this.colorSlider.updateLabels();this.domNode.oncontextmenu=function(){if(mstrApp.isSingleTier){return false;}};},onClose:function C(){this.model.cleanUp();},switchToCustomScheme:function H(b,g){var f="custom",c=this.colorSlider,d=this.colorPalettes.colorPulldown,e=d.items,a=e.map(function(h){return h.v;}).indexOf(f)!==-1;b=b||c.getComp().concat();if(!g){var Z=c.getPalette().concat();g=c.getReversedValue()?Z.reverse():Z;}c.addCustomScheme(b,g);if(!a){d.set("items",e.concat({n:mstrmojo.desc(2056,"Custom"),v:f}));}d.set("selectedIndex",M.find(d.items,"v",f));},children:[{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"typeSelector",typeCheckList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12112,"Thresholds Type:")},{scriptClass:"mstrmojo.ui.CheckList",alias:"typeCheckList",multiSelect:false,orientation:"h",postselectionChange:function I(m){var f=this.parent.parent,d=f.model,g=f.colorSlider,b=f.colorPalettes,k=f.imageSelector,c=k.imagePulldown,a=K[b.colorPulldown.selectedIndex],Z=B[c.selectedIndex],l=m.added[0],e=l?Z:a,h=l?d.getDefaultImages()[0].id:d.getDefaultColors()[0].id;b.set("visible",!l);k.set("visible",!!l);g.set("sliderMode",l);g.set("baseColor",(e&&e.v)||h);g.editableBubble.set("visible",false);if(l===V.IMAGE_BASED&&!c.selectedIndex){c.set("selectedIndex",0);}},selectedIndex:0,items:[{n:mstrmojo.desc(12113,"Color-based"),v:"color",cls:"color"},{n:mstrmojo.desc(12114,"Image-based"),v:"image",cls:"image"}]}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"colorPalettes",selectedColor:undefined,colorPulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060,"color:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"short",alias:"colorPulldown",onitemSelected:function G(Z){N.call(this.parent,Z.v);},selectedIndex:0,items:K},O()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"imageSelector",visible:false,selectedColor:undefined,imagePulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(6369,"Images:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"image-pulldown short",alias:"imagePulldown",onitemSelected:function G(Z){N.call(this.parent,Z.v);},getPopupListConfig:function T(){var Z=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);Z.getItemMarkup=function b(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><div class="text">{@n}</div><div class="bc" style="{@bc}"></div></{@tag}>';};Z.getItemProps=function a(e,c){var d=mstrmojo._IsList.getItemProps.call(this,e,c);d.bc="background:url("+e.bc+")";return d;};return Z;},items:B},O()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"basedOn",value:"",metricsList:undefined,options:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4402,"Based on:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"short",alias:"metricsList",onitemSelected:function G(c){var b=this.parent,Z=b.parent,a=c.did;b.selectedMetric=Z.model.basedOnId=a;Z.colorSlider.updateLabels();L.call(Z);}},{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:3,cssClass:"short option",alias:"options",onitemSelected:function G(b){var e=this.parent,a=e.parent,d=a.breakBy,c=b.v,Z=c===7;e.value=c;a.colorSlider.set("selectedOption",b.v);d.set("visible",!Z);if(Z){d.breakByList.set("selectedIndex",0);}},items:W}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"breakBy",breakByList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4564,"Break By:")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"breakByList"}]},{scriptClass:"mstrmojo.threshold.ColorSlider",alias:"colorSlider"},{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"showAdvancedEditorLink",slot:"buttonNode",text:mstrmojo.desc(4569,"Advanced Thresholds Editor..."),onclick:function Y(){var b=this.parent,a=b.breakBy.breakByList,Z=a.items[a.selectedIndex].did!==-1,c=function(){b.colorSlider.unselectAll();b.close();b.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;};mstrmojo.warn(Z?mstrmojo.desc(14160,"Save thresholds definition before proceeding to the Advanced Thresholds Editor? The Break By attribute will be lost."):mstrmojo.desc(14159,"Save thresholds definition before proceeding to the Advanced Thresholds Editor?"),undefined,{cssClass:"save-threshold-warning",buttons:[Q(mstrmojo.desc(2827,"Clear"),function(){c();b.controller.openEditor();},false,{cssClass:"nosave"}),Q(mstrmojo.desc(2031,"Apply"),function(){c();a.set("selectedIndex",0);S.call(b,true);},true),Q(mstrmojo.desc(2223,"Cancel"))]});}},{scriptClass:"mstrmojo.Box",cssClass:"editor-buttons",slot:"buttonNode",children:[Q(mstrmojo.desc(221,"Cancel"),function Y(){var Z=this.parent.parent;Z.colorSlider.unselectAll();Z.close();}),Q(mstrmojo.desc(1442,"OK"),function Y(){var Z=this.parent.parent;S.call(Z);Z.colorSlider.unselectAll();Z.close();},true),Q(mstrmojo.desc(2031,"Apply"),function Y(){var Z=this.parent.parent;S.call(Z,true);Z.colorSlider.unselectAll();},true)]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.Container","mstrmojo.threshold.TextGroup","mstrmojo.threshold.ThresholdRow","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.ui.editors.controls.CharacterGroup");var G=mstrmojo.Widget,F=mstrmojo.hash,D="180px";mstrmojo.threshold.PropertyPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo.threshold.PropertyPanel],{markupString:'<div class="mstrmojo-threshold-PropertyPanel"><div class="condition"></div><div class="format mstrmojo-vi-PropEditor"><div class="text"><div class="title">'+mstrmojo.desc(5998,"Replace Data")+'</div></div><div class="font mstrmojo-vi-EditorGroup"><div class="title">'+mstrmojo.desc(3433,"Font")+'</div></div><div class="border"><div class="title">'+mstrmojo.desc(5616,"Color And Borders")+'</div></div></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.children[1].firstChild;},fontNode:function(){return this.domNode.children[1].children[1];},borderNode:function(){return this.domNode.children[1].children[2];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:G.visibleMarkupMethod,onheightChange:G.heightMarkupMethod,onwidthChange:G.widthMarkupMethod},model:undefined,editor:undefined,textGroup:undefined,charGroup:undefined,containerGroup:undefined,onvisibleChange:function A(){if(this.visible){var J=this.model;J.updateControl(this);var H=F.clone(J.threshold),I=this.thresholdRow;if(I){this.removeChildren(I);}this.addChildren({scriptClass:"mstrmojo.threshold.ThresholdRow",alias:"thresholdRow",slot:"conditionNode",idx:J.thresholdRow.idx,model:this.editor.model,threshold:H,onclick:mstrmojo.emptyFn});this.refresh();}},onOK:function B(){this.model.submitChange();this.close();},close:function E(){var H=this.thresholdRow;if(H){this.removeChildren(H);}this.set("visible",false);this.editor.toggleButtonStatus(true);this.editor.setRowPanelVisibility(true);},children:[{scriptClass:"mstrmojo.threshold.TextGroup",slot:"textNode",alias:"textGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("threshold",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",slot:"fontNode",alias:"charGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",slot:"borderNode",alias:"containerGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",onclick:function(){var H=this.parent;if(H.close){H.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",onclick:function(){var H=this.parent;if(H.onOK){H.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:mstrmojo.desc(14000,"Press ## after finishing formatting.").replace("##",'""')}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.rw.ConditionWalk","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.expr","mstrmojo.css");var F=mstrmojo.expr.ET.MQ,H=mstrmojo.expr.ET.MC,C=mstrmojo.css,B=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var G=function(K,M){var J=K.et,L=((J===F||J===H)&&!this.inRelation)?"block":"none",I=((M===1)||J!==F)?1:0;C.toggleClass(this.toolNode,"unselectable",J===H);this.toolNode.style.display=L;this.level.set("selectedIndex",I);this.includeExist.set("visible",I===1&&(J===H||J===F));this.includeExist.set("checked",K.idcsi===undefined?false:K.idcsi);};mstrmojo.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,null,{scriptClass:"mstrmojo.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},postCreate:function E(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function I(J){var K=this.parent;if(K&&K.condition&&K.visible){K.includeExist.set("visible",J.v===1);K.condition.level=J.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=B;},oncheckedChange:function(){var J=this.parent;if(J){J.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function A(I){var J=this.condition;if(J&&this.toolNode&&this.visible){G.call(this,J.data,J.tree.level);}if(this._super){this._super(I);}},onmodeledit:function D(I){if(this._super){this._super(I);}if(this.toolNode){G.call(this,this.model.get(),this.model.level);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.ConditionWalk","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty","mstrmojo.mstr.DocElementDataHelper","mstrmojo.ui._IsIncFetchList");var E=mstrmojo.array,G=mstrmojo.css,C=mstrmojo.mstr.EnumNodeDimty,K=E.hash([C.NodeDimtyUnspecified,C.NodeDimtyNone]);function H(){var L=this.thresholdRow,M=this.editor;if(L){this.removeChildren(L);}G.toggleClass(M.content.domNode,"no-overflow",false);this.set("visible",false);M.setRowPanelVisibility(true);}mstrmojo.threshold.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{objectBrowsingEnabled:false,dimtyTypes:K,targets:null,targetsLastMod:null,ets:null,condition:null,onOK:function B(){var L=this.editor;L.model.setConditionData(this.condition,this.model.get());H.call(this);L.toggleButtonStatus(true);},close:function I(){var O=this.editor;var Q=this.condition,M=Q.tree.parent,L=M.exprTree;if(Q.isEmpty()){Q.del();}var N=L&&L.items,P=N&&N.length;if(!P||P===0){O.model.deleteThreshold(M.threshold);}H.call(this);O.toggleButtonStatus(true);},browse:function F(L){this._super(L);if(L.alias==="es"){G.toggleClass(this.eb.domNode,"adv-threshold",true);}},getAttributeForms:function J(L){return mstrmojo.rw.ConditionWalk.getAttForms(L,this.editor.controller.datasets);},getElements:function D(N,P){var O={},L=P.complete,M=this;this.scrollNode=this.columnWalk.es.scrollNode;if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.controller.dataService});}else{this.ifDataHelper.set("items",null);}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(O,N);this.ifDataHelper.browseConfig=O;P=mstrmojo.func.wrapMethods(P,{complete:function(Q){M.initScroll();}});this.ifDataHelper.getItems(1,P);},postNext:function A(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Widget","mstrmojo.Label","mstrmojo.Box","mstrmojo.desc","mstrmojo.css","mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.models.FormatModel","mstrmojo.ui._HasScroller","mstrmojo.threshold.ThresholdRow","mstrmojo.threshold.ConditionWalk","mstrmojo.threshold.PropertyPanel","mstrmojo.threshold.PropertyModel","mstrmojo.threshold.ThresholdRowPanel");var f=mstrmojo.css,U=mstrmojo.hash,e=mstrmojo.expr,J=e.ET,T=e.BRANCH_FNS,Y=mstrmojo.Button.newWebButton,L=mstrmojo.models.FormatModel.getFormatUpdate,g="";var D=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,G=[D.BORDER_TOP_STYLE,D.BORDER_RIGHT_STYLE,D.BORDER_BOTTOM_STYLE,D.BORDER_LEFT_STYLE],Q={0:"none",1:"1pt solid",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid"};function H(k,m){var l=[];if(m){m.forEach(function(o){var p=o.fmt,n={};U.forEach(p,function(q,r){var t=false;if(G.indexOf(r)===-1){L(r,q,n);}else{if(!p.borderStyle&&!t){L(D.BORDER_STYLE,Q[q],n);}}});k.setAttIdToNDE(o.expr);l.push({n:o.n,scope:o.scope,rtp:o.rtp,rtxt:o.rtxt,expr:mstrmojo.fe.FilterUtils.getExprXml(o.expr),fmt:n});});}return l;}function a(o){var l=this.controller,m=this.model,n=m.thresholds,p=this.metricId,r=n&&n[p],q=m.orgThresholds,k=q&&q[p];l.onSubmitActions(H(m,r),k,p,undefined,-1,o,this.objectType);}function X(k){(k||[]).forEach(function(l){delete l.dmy;var m=l.nds;if(m){X(m);}});}function R(){var n=this.content,k=this.model,r=k.thresholds,m=this,o=[],q=n.rowPanel,p=r&&r[k.metricId],l=0;if(p){p.forEach(function(t){X(t.expr.nds);o.push({scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:t,editor:m,model:k,idx:l++});});}q.destroyChildren(false);q.addChildren(o);this.updateScrollbars();}function d(){var p=this.content.rowPanel,n=p.children,l=(n&&n.length)||0,m=this.model,q=m.thresholds,o=q&&q[m.metricId],k={expr:{et:14,fn:19}};if(!q){q=m.thresholds={};}if(!o){o=q[m.metricId]=[];}o.push(k);p.addChildren([{scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:k,editor:this,model:m,idx:l}]);p.children[l].exprTree.newCondition(null);this.updateScrollbars();}function V(l){var k=this.model,n=k.thresholds,m=n&&n[k.metricId];if(m){m.forEach(function(o){k.toggleThresholdSelected(o,l);});}}function N(o,p){var k=this.controller,l=this.model,m=this.metricId,n=l.selectedThresholds;if(n.length>0){k.onSaveThresholds(H(l,n),m,-1,o,p);}}function K(l){var n="mstrIVE_THRESHOLD_SAVER",k=l.controller.dataService.model,m=mstrmojo.all[n];if(!m){m=new mstrmojo.SaveAsEditor({id:n,zIndex:l.zIndex+1,folderLinksContextId:32,rootFolderID:k.isnew?null:k.pfid,showCompletePath:false,saveParams:{},typeDesc:mstrmojo.desc(null,"Thresholds"),saveAs:function(q){var o=this.contPanel;this.name=o.name.value;this.desc=o.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var r=this.saveParams||{};r.folderId=this.ob.currentFolder.did;r.name=this.name||"New Thresholds";r.saveAsOverwrite=!!q;var p=this.saveAsCallback();p.failure=function(u){var t=u.code,v=this.parent;if(t==="-2147217373"||t==="-2147216857"){mstrmojo.warn(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",v.typeDesc||"Object").replace("###",v.name),{confirmBtn:{fn:function(){v.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite"),zIndex:v&&v.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+u.message);}};p.parent=this;N.call(l,r,p);}});m.render();}m.open();}function E(m){var r="mstrIVE_THRESHOLD_LOADER",p=mstrmojo.all[r],l=m.controller.dataService.model,q=[72];if(!p){p=new mstrmojo.vi.ui.editors.ObjectPicker({id:r,supportedTypes:mstrmojo.array.hash(q),zIndex:m.zIndex+1,rootFolderID:l.isnew?null:l.pfid,onOpen:function k(){this.browse();},postBuildRendering:function o(){mstrmojo.Editor.prototype.postBuildRendering.apply(this);},OKFn:function(t){if(t){m.controller.onLoadThresholds(m.metricId,t.did);}}});var n=p.ob;n.set("folderLinksContextId",32);n.set("multiSelect",false);n.set("searchVisible",true);n.set("upButtonVisible",true);n.set("browsableTypes","8,"+q.join(","));p.render();}p.open();}mstrmojo.threshold.AdvancedThresholdEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.threshold.AdvancedThresholdEditor",cssClass:"adv-threshold",title:"Advanced Threshold Editor",help:"advanced_thresholds_editor_for_html5_dashboards.htm",model:undefined,targets:undefined,content:undefined,buttonBar:undefined,init:function Z(k){this._super(k);g=this.id;},postBuildRendering:function c(){this._super();var k=this.content;R.call(this);k.conditionWalk.set("editor",this);k.property.set("editor",this);},onOpen:function I(){R.call(this);this.setRowPanelVisibility(true);var k=this.content;k.conditionWalk.set("visible",false);k.property.set("visible",false);var l=this.buttonBar&&this.buttonBar.quickLink;if(!!l){l.set("visible",this.objectType!==12);}},setupScrollNodes:function P(){this.scrollNode=this.content.containerNode;},onClose:function F(){this.model.cleanUp();},onmodelChange:function O(){var k=this.model;if(k){k.attachEventListener("modelEdit",this.id,"onmodelEdit");k.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");R.call(this);}},onselectedThresholdsChange:function b(){},openConditionWalk:function C(k,m){var p=this,q=p.content,r=q.conditionWalk,l=m.tree.parent,n=U.clone(l.threshold),o=r.thresholdRow;n.expr=k;if(o){r.removeChildren(o);}var t=new mstrmojo.threshold.ThresholdRow({alias:"thresholdRow",slot:"conditionNode",idx:l.idx,model:this.model,threshold:n,onclick:mstrmojo.emptyFn});r.addChildren(t);t.render();r.set("objectBrowsingEnabled",p.objectBrowsingEnabled);r.set("targets",p.targets);r.set("targetsLastMod",new Date());r.set("ets",m.tree.validExprTypes);r.set("condition",m);r.set("model",U.clone(k));p.setRowPanelVisibility(false);f.toggleClass(p.content.domNode,"no-overflow",true);r.set("visible",true);r.doLayout();p.toggleButtonStatus(false);this.updateScrollbars();},onmodelEdit:function S(){R.call(this);},openPropertyPanel:function M(k){this.setRowPanelVisibility(false);var m=this.content.property,l=m.model=new mstrmojo.threshold.PropertyModel({thresholdRow:k,threshold:U.clone(k.threshold),gridValueFormat:U.clone(this.model.getGridValueFormat())});this.disposables.push(l);l.attachEventListener("propertyModelChange",k.id,"onpropertyModelChange");m.set("visible",true);this.toggleButtonStatus(false);this.updateScrollbars();},openAndORPopup:function W(n,k){var l=new mstrmojo.ui.menus.MenuConfig();l.hostId=this.id;l.hostElement=k;l.isHostedWithin=false;l.menuCssClass="andor-PopupList";var m=function m(u){var o=n,t=u.ctxt.did,r=t>21?true:null,q=t-(r?21:0);var p=o&&o.parent;if(p&&p.data&&p.data.et===J.ANDOR){p.edit(o,q,r);}else{var v=o&&o.data;if(v&&(v.not!==r)){v.not=r;o.paint();}}};l.addMenuItem(T[19],"",m,{did:19});l.addMenuItem(T[20],"",m,{did:20});l.addMenuItem(T["19_21"],"",m,{did:19+21});l.addMenuItem(T["20_21"],"",m,{did:20+21});this.openPopup(l.newInstance());},toggleButtonStatus:function A(k){this.buttonBar.children.forEach(function(l){l.set("enabled",k);});},setRowPanelVisibility:function B(l){var k=this.content;k.rowPanel.set("visible",l);k.newCondition.set("visible",l);this.updateScrollbars();},children:[{scriptClass:"mstrmojo.Widget",alias:"rulesTitles",markupString:"<div class='rulesTitles'><div class='container'></div><div class='order'>"+mstrmojo.desc(3095,"Order")+"</div><div class='condition'>"+mstrmojo.desc(11890,"Threshold Conditions")+"</div><div class='format'>"+mstrmojo.desc(11891,"Format Preview")+"</div></div>"},{scriptClass:"mstrmojo.Box",cssClass:"content",alias:"content",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="scroll-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},rowPanel:undefined,newCondition:undefined,conditionWalk:undefined,property:undefined,children:[{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",alias:"rowPanel",children:[]},{scriptClass:"mstrmojo.Label",alias:"newCondition",cssClass:"link",text:mstrmojo.desc(4585,"New Threshold"),onclick:function h(){d.call(mstrmojo.all[g]);}},{scriptClass:"mstrmojo.threshold.ConditionWalk",alias:"conditionWalk",height:"300px",width:"750px",visible:false},{scriptClass:"mstrmojo.threshold.PropertyPanel",alias:"property",visible:false}]},{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[Y(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.all[g].close();}),Y(mstrmojo.desc(1442,"OK"),function(){a.call(mstrmojo.all[g],false);mstrmojo.all[g].close();},true),Y(mstrmojo.desc(2031,"Apply"),function(){a.call(mstrmojo.all[g],true);},true),{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"quickLink",text:mstrmojo.desc(14004,"Quick Thresholds Editor..."),onclick:function h(){var m=mstrmojo.all[g],l=m.model,k=m.controller,o=l.isAdvanced(l.metricId),p=function(){m.close();l.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.SIMPLE_EDITOR;},n=[Y(o?mstrmojo.desc(1442,"OK"):mstrmojo.desc(2827,"Clear"),function(){p();k.openEditor();},o,o?undefined:{cssClass:"nosave"})];if(!o){n.push(Y(mstrmojo.desc(2031,"Apply"),function(){p();a.call(m,true);},true));}n.push(Y(mstrmojo.desc(2223,"Cancel")));mstrmojo.warn(o?mstrmojo.desc(13998,"This action will clear the thresholds definition. Do you want to proceed?"):mstrmojo.desc(13999,"Do you want to apply your thresholds before using the Quick Thresholds Editor?"),undefined,{cssClass:o?undefined:"save-threshold-warning",buttons:n});}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Dial","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Obj","mstrmojo.CheckBox","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.fe.FilterExprTree","mstrmojo.fe.RelationFilterExprTree","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.StatusButton");var Z=mstrmojo.expr,I=Z.ET,P=Z.BRANCH_FNS,X=mstrmojo.Obj,W=mstrmojo.dom,a=mstrmojo.array,T=mstrmojo.hash,d=mstrmojo.css,C=mstrmojo.warehouse.EnumObjectTypes,K={TEMPLATE:0,DATASET:1},E=mstrmojo.mstr.EnumNodeDimty,R=a.hash([E.NodeDimtyUnspecified,E.NodeDimtyNone]),N=200,H=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(g){a.forEach(this.buttonBar.children[0].children,function(h){h.set("enabled",g);});}function Y(){var g=this.avatar;if(g){g.parentNode.removeChild(g);delete this.avatar;d.removeClass(g,[this.avatarCssClass]);}}mstrmojo.fe.FilterEditorBase=mstrmojo.declare(mstrmojo.Editor,null,{onSave:null,title:mstrmojo.desc(12032,"View Filter Editor"),help:"view_filter_editor_for_report_services_documents.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE",showLimits:true,objectBrowsingEnabled:false,children:null,init:function U(g){this.children=[{alias:"feContent",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-content",postCreate:function(){this.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-exprTool",children:[{scriptClass:"mstrmojo.ui.StatusButton",cssClass:"mstrmojo-FE-addCondition",postCreate:function h(){this.editor=this.parent.parent.parent;this.statusList=this.editor.getAddConditionList();this.status=this.statusList[0];},onButtonClick:function(k){if(k){k.handler.apply(this.editor);}}}]},this.parent.getExpressionContainerCfg()];}},this.getConditionWalkConfig(),{alias:"buttonBar",scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(118,"Save"),onclick:function(){var h=this.editor;M(h);h.close();},bindings:{enabled:function(){return !this.editor.readOnly;},editor:"this.parent.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent.parent"}}]}]}];this._super(g);this.model=this.model||new X();},getExpressionContainerCfg:function(){var g=this;return{alias:"feExpr",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-expr-list",postCreate:function(){this.children=g.getExpressionContentsConfig();},onRender:function(){W.attachMarkupEvent(this.id,this.domNode,"mousedown");},onmousedown:function(h){var k=W.eventTarget(h.hWin,h.e);if(this.isBlankArea(k)){this.clearSelect();}},isBlankArea:function(h){return h===this.domNode;},clearSelect:function(){}};},getExpressionContentsConfig:function(){return[];},getConditionWalkConfig:function(){var h=this;return{scriptClass:"mstrmojo.rw.ConditionWalk",width:"750px",objectBrowsingEnabled:false,dimtyTypes:R,alias:"walk",visible:false,onOK:function g(){var l=this.condition;h.feContent.set("visible",true);this.set("visible",false);h.onConditionEdit(l,this.model.get());B.call(h,true);},close:function k(){h.feContent.set("visible",true);this.set("visible",false);var l=this.condition;if(l.isEmpty()){l.del();}B.call(h,true);},targets:null,targetsLastMod:null,ets:null,condition:null,bindings:{disableElementsBrowsing:"this.parent.disableElementsBrowsing"}};},onConditionEdit:function(h,g){h.tree.modifyConditionNode(h,g);},getAddConditionList:function c(){return[{n:mstrmojo.desc(1994,"Add Condition"),handler:function(){this.mainExpr.newCondition(null,true);}}];},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var g=this.condition,l=g&&g.data&&g.data.not,m=g&&g.parent,h=m&&m.data,k=(h&&h.fn)+(l?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(k)?null:{did:k});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",items:[{did:19,n:P[19]},{did:20,n:P[20]},{did:19+21,n:P["19_21"]},{did:20+21,n:P["20_21"]}],onchange:function(){if(this.opening){return ;}var h=this.parent,g=h.condition,o=this.selectedItem,n=o&&o.did,m=n>21?true:null,l=n-(m?21:0);h.close();var k=g&&g.parent;if(k&&k.data&&k.data.et===I.ANDOR){k.edit(g,l,m);}else{var p=g&&g.data;if(p&&(p.not!==m)){p.not=m;g.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"CreateSet-Editor",title:mstrmojo.desc(12034,"Create a Set"),slot:"containerNode"},_set_busy:function(h,g){if(g){this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");}else{this.set("enabled",true);this.set("iconClass","");}},_set_model:function(m,h){var k=this.model,l=k!==h;if(l){this.model=h;this.modelLastSet=new Date();var g=function(n){return Q(J(n));};h.exprForest=g(h.expr);h.limitExprForest=g(h.limitExpr);if(this.feContent&&this.feContent.feExpr.ve){this.feContent.feExpr.ve.nameFactory.clear();}}return l;},onUpdateBrowseElementsParams:mstrmojo.emptyFn});mstrmojo.fe.ReportFilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var g=this._super();return mstrmojo.mixin({clearSelect:function(){this.re.clearTreeSelect();}},g);},getExpressionContentsConfig:function(){return[{alias:"re",scriptClass:"mstrmojo.fe.ReportFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}}];}});mstrmojo.fe.ReportFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.ReportFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(g){g.data.isNew=true;F(this.editor,g.data,g.widget.ctxtBuilder.itemWidgets[g.index],"condition");},onnodeclick:function A(g){F(g.editor||this.tree.editor,this.data,this,g&&g.part);},allowDrop:function G(g){var k=g&&g.src,m=k&&k.data,l=m&&m.et,h=k&&k.widget&&k.widget.tree;return l&&this!==h;}});mstrmojo.fe.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var g=this._super();return mstrmojo.mixin({isBlankArea:function(h){if(this._super(h)){return true;}return !a.filterOne([this.ve,this.vle],function(k){if(W.contains(k.domNode,h,true)){return true;}});},clearSelect:function(){this.ve.clearTreeSelect();this.vle.clearTreeSelect();}},g);},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11746,"Dataset Level Conditions"),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"true || this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.fe.RWViewFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(g){this.parent.clearSelect(g);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11747,"Template Level Conditions"),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.fe.RWViewLimitExprTree",level:K.TEMPLATE,bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(g){this.parent.clearSelect(g);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);}}];},getConditionWalkConfig:function(){var g=this._super();T.copy({scriptClass:"mstrmojo.fe.ConditionWalk"},g);return g;},getAddConditionList:function c(){var g=this._super();g.push({n:mstrmojo.desc(12055,"Add Dynamic Condition"),handler:function(){this.mainExpr.newCondition({et:I.XML,idc:1,ph:{}},true);}});return g;},onConditionEdit:function(k,h){if(k.tree.level===k.level||k.tree.level===undefined){this._super(k,h);}else{k.parent.remove(k.data);var g=K.TEMPLATE===k.level?this.limitExpr:this.mainExpr;g.addSingleCondition(h);}}});mstrmojo.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RelationFilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(g){g.data.isNew=true;if(!g.data.ph){F(this.editor,g.data,g.widget.ctxtBuilder.itemWidgets[g.index],"condition");}},onnodeclick:function A(g){F(g.editor||this.tree.editor,this.data,this,g&&g.part);},ondragend:function O(k){var h=k&&k.tgt,g=h&&h.widget;if(this.tree&&g&&g.tree&&g.tree!==this.tree){Y.call(this);return ;}this._super(k);},getItemConfig:function(k,g,l){var h=this._super(k,g,l);return T.copy({getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewLimit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(4978,"Move to view limit")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewLimit(w); return false;\" />";}},h);},moveMQNodeToViewLimit:function(k){if(k.data.et!==I.MQ){return ;}var h=T.copy(k.data);k.parent.remove(k.data);var g=this.editor.limitExpr;g.addSingleCondition(h);},allowDrop:function G(g){var k=g&&g.src,n=k&&k.data,m=n&&n.et,l=this.tree,h=k&&k.widget&&k.widget.tree;return m&&(this===l?(h!==l):true);}});mstrmojo.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewLimitExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-limitExpr",validExprTypes:a.hash([I.MQ]),onnodeclick:function A(g){F(this.tree.editor,this.data,this,g&&g.part);},onConditionEdit:function(h,g){this._super(h,g);h.data.mdxUnitId=h.data.m.did;V(h);},addSingleCondition:function(h){var g=this._super(h);V(g);},allowDrop:function(g){var l=g&&g.src,n=l&&l.data,m=n&&n.et,k=this.tree,h=l&&l.widget&&l.widget.tree;if(k===h){return this!==h&&this.data&&(this===l.parent||this.data.mdxUnitId===n.mdxUnitId);}return m===I.MQ;},ondrop:function L(h){var m=h&&h.src,g=m&&m.widget;if(g&&g.tree!==this.tree){var l=m&&m.data;if(l&&l.index!==null){var k=g.ctxtBuilder.itemWidgets[l.index];k.tree.moveMQNodeToViewLimit(k);}m.data=null;}this._super(h);},isEditable:function(g){return g.mdxUnitId&&this._super(g);},ondragend:function S(g){var l=g&&g.tgt,h=l&&l.widget;if(h&&h.tree!==this.tree){var k=g.src&&g.src.data;if(k&&(k.indices||(k.index!==null))){this.remove(k.indices||k.index);}Y.call(this);}else{this._super(g);}},moveMQNodeToViewFilter:function(h){var g=this.editor.mainExpr;h.parent.remove(h.data);g.addSingleCondition(h.data);},getItemConfig:function(k,g,l){k.mdxUnitId=D(k);var h=this._super(k,g,l);return T.copy({cssClass:f(k,g,l)?"per-metric-limit":"",forbidRelation:true,getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewFilter" src="../images/1ptrans.gif" title="'+mstrmojo.desc(9746,"Move to view filter")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewFilter(w); return false;\" />";}},h);}});function F(q,o,p,u){var h=W.delta(p.domNode,q.containerNode);h.y+=(u==="andor"?16:parseInt(p.domNode.offsetHeight,10));var r={condition:p,zIndex:q.zIndex+10,left:h.x+"px",top:h.y+"px"},g;switch(u){case"andor":if(q.skipAndOrPopup){return ;}g="andOrPopupRef";break;case"createSet":case"createSetOpt":var t=q.model.targets;g="createSetPopupRef";r.type=u;r.model={attrs:a.filter(t,function(n){return n.t===C.ATTRIBUTE;}),metrics:a.filter(t,function(n){return n.t===C.METRIC;})};if(u==="createSetOpt"){r.condition=p.parent;r.model.childIdx=p.childIndex();}break;case"condition":var m=q.walk,k=p.textNode.cloneNode(true),l=m.conditionNode.firstChild;d.removeClass(k,"editable");d.addClass(m.conditionNode,"mstrmojo-ConditionNode");if(l.firstChild){l.removeChild(l.firstChild);}l.appendChild(k);m.set("objectBrowsingEnabled",q.objectBrowsingEnabled);m.set("targets",q.model.targets);m.set("targetsLastMod",q.modelLastSet);m.set("ets",p.tree.validExprTypes||q.validExprTypes);m.set("condition",p);m.set("model",T.clone(o));m.set("hasPrompt",q.model.hasPrompt);m.set("disableElementsBrowsing",q.disableElementsBrowsing||m.disableElementsBrowsing);m.set("editor",q);m.set("inRelation",p.inRelation);q.feContent.set("visible",false);m.set("visible",true);m.columnWalk.target.updateScrollbars();B.call(q,false);return ;}q.openPopup(g,r);}function M(h){var g=h.model;g.expr=e(g.exprForest);g.limitExpr=e(b(g.limitExprForest));h.onSave(g);}function Q(h){var g=[];a.forEach(h,function(k){if(!k){return ;}if(k.et===I.ANDOR){k.nds=Q(k.nds);if(k.nds.length===0){return ;}else{if(k.nds.length===1){var l=k.nds[0];if(k.not){l.not=!l.not;}g.push(l);return ;}}}g.push(k);});return g;}function J(g){return g?[g]:[];}function e(g){return g&&g.length===1?g[0]:null;}function b(k){var h=Q(k),g;if(!h[0]||h[0].mdxUnitId){g={et:I.ANDOR,fn:Z.FN.AND,nds:h};}else{g=h[0];}return[g];}function f(h,g,k){return(k===k.tree||k.parent===k.tree)&&!!h.mdxUnitId;}function D(h){if(!("mdxUnitId" in h)){var g;switch(h.et){case I.MQ:g=h.m.did||null;break;case I.ANDOR:a.forEach(h.nds,function(l){var k=D(l);if(g===undefined){g=k;}else{if(g!==k){g=null;return false;}}return true;});break;default:g=undefined;break;}h.mdxUnitId=g;}return h.mdxUnitId;}function V(n){var p=n.tree,o=p.ctxtBuilder.itemWidgets[0],t=n.parent,q=a.indexOf(t.items,n.data),l=t.items[q],h=l.mdxUnitId;if(t===p){return ;}if(t.data.mdxUnitId===h){return ;}if(o.data.mdxUnitId){var k={et:I.ANDOR,fn:Z.FN.AND,nds:[o.data,l]};p.remove(0);p.add([k]);p.ctxtBuilder.itemWidgets[0].ctxtBuilder.itemWidgets[0].remove(l);}else{var m=o,g;a.forEach(o.data.nds,function(v,u){if(v.mdxUnitId===l.mdxUnitId&&o.items[u]!==l){m=o.ctxtBuilder.itemWidgets[u];g=u;return false;}});if(m===t){return ;}if(m.data.et!==I.ANDOR){var r={et:I.ANDOR,fn:Z.FN.AND,nds:[m.data,l]};o.add([r],g+1);o.remove(m.data);}else{m.add([l]);}t.remove(l);}}}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.boxmodel","mstrmojo.vi.ui.rw.RichTooltipBox","mstrmojo.vi.ui.rw.ImageBoxOverlay","mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded");mstrmojo.requiresDescs(3415,10493,12277,12963,14634);var W=mstrmojo.css,B=mstrmojo.string,O=mstrmojo.hash,U=mstrmojo.boxmodel.px2Inches,G=mstrmojo.dom,H=mstrmojo.desc(14634,"Embedded_Image");function V(){if(this.boxContent&&B.isEmpty(this.boxContent.origV)){this.showControlOverlay(this.getEditOverlayControls());K.call(this,this.height,this.width);}else{this.hideControlOverlay();}}function K(X,Z){var a=this.ctrlOverlay;if(a&&a.imageBoxOverlay){var Y=a.imageBoxOverlay;Y.set("height",X);Y.set("width",Z);Y.doLayout();}}mstrmojo.vi.ui.rw.ImageBox=mstrmojo.declare(mstrmojo.vi.ui.rw.RichTooltipBox,null,{scriptClass:"mstrmojo.vi.ui.rw.ImageBox",ctrlOverlay:null,mode:"o",fw:100,fh:100,lock:true,isDynamicTooltip:true,tooltipTopOffset:35,isEmbedded:false,isEmbeddedImageFeatureEnabled:true,embeddedImageName:undefined,init:function Q(a){this._super(a);var Z=this.defn,X=Z&&Z.fmts,Y=X&&X["img-name"];this.isEmbeddedImageFeatureEnabled=!!mstrApp.enableEmbeddedImages&&!G.isIE9;this.isEmbedded=!!Z&&Z.oid;this.embeddedImageName=(Y)?decodeURIComponent(Y):H;W.addWidgetCssClass(this,"mstrmojo-ImageBox");},getDisplayName:function I(){return this.defn.n||mstrmojo.desc(2922,"Image");},applyBoxSize:function P(X,Z,c,b){this._super(X,Z,c,b);var Y=parseInt(Z,10)>=302?"h":"v";if(Y!==this.orientation){this.set("orientation",Y);}var a=this.boxContent;a.fw=this.fw;a.fh=this.fh;a.mode=this.mode;a.lock=this.lock;if(a.hasRendered){a.refresh();}K.call(this,X,Z);},getBoxDimension:function C(X){return(X==="h")?{f:false,l:null}:{f:true,l:40};},getAvatarCls:function L(){return this._super().concat(["imageAvatar"]);},createDeleteUpdate:function E(){return this.model.getRemoveFieldUpdate(this);},postBuildRendering:function S(){this._super();V.call(this);this.addDragHandle();var X=this.boxContent;this.toggleDragHandleVisibility(X.hasActiveLink()&&X.v);},updateOverlay:function N(){V.call(this);var X=this.boxContent;this.toggleDragHandleVisibility(X.hasActiveLink()&&X.v);},showControlOverlay:function D(X){this._super(X);this.boxContent.set("visible",false);},hideControlOverlay:function T(){this._super();this.boxContent.set("visible",true);},urlEdited:function R(X){this.boxContent.v=X;this.isEmbedded=false;this.refresh();this.boxContent._isNewUrl=true;},localImageAdded:function M(X){var Y=this.boxContent;X.fieldKey=Y.k;X.fieldName=Y.defn&&Y.defn.n||Y.k;X.nodeKey=Y.defn.pnk;X.sectionKey=Y.defn.pnk;X.fieldGroupKey=Y.defn.fgk;var Z=this;var a={success:function(b){Z.boxContent.v=X.base64Str;Z.isEmbedded=true;Z.refresh();Z.boxContent._isNewEmbeddedImg=true;},complete:function(){mstrApp.hideWait();}};mstrApp.showWait({message:mstrmojo.desc(12963,"Uploading File...")});this.model.controller.uploadImageToServer(X,a);},addFormatProps:function A(b,a){var Z=this.boxContent,X=this.model;b=this._super(b,a)||this.model.getUnitFormatAction(this,NaN,null,a);if(Z&&!B.isEmpty(Z.origV)){var Y=b.format=O.copy(b.format,{FormattingSize:{}});Y.FormattingSize.ImageWidth=U(X.getZoomProps(),parseFloat(Z.getImageWidth()));Y.FormattingSize.ImageHeight=U(X.getZoomProps(),parseFloat(Z.getImageHeight()));}return b;},getEditOverlayControls:function F(){return[{scriptClass:this.isEmbeddedImageFeatureEnabled?"mstrmojo.vi.ui.rw.ImageBoxOverlayEmbeded":"mstrmojo.vi.ui.rw.ImageBoxOverlay",alias:"imageBoxOverlay",imageBox:this,defn:this.defn}];},switchToEditMode:function J(){var Z=this.ctrlOverlay;if(Z.visible){Z.imageBoxOverlay.imgURL.focus();return ;}this._super();K.call(this,this.height,this.width);var Y=this.boxContent.origV,X=Z.imageBoxOverlay.imgURL;if(this.isEmbedded){X.set("value",this.embeddedImageName);Z.imageBoxOverlay.origURLStr=this.embeddedImageName;}else{if(Y){X.set("value",Y);Z.imageBoxOverlay.origURLStr=Y;}}X.focus();}});mstrmojo.vi.ui.rw.ImageBox.boxConfiguration={f:{h:166,v:76},minSize:{h:38,v:40},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo._HasPopup","mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.ObjectBrowser","mstrmojo.DataGrid","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.ObjectInputBox","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.ME._HasLevel","mstrmojo.ME._HasSortBy","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(629,2148,3377,9582,12173,12179,12852);var J=mstrmojo.hash,m=mstrmojo.array,M=mstrmojo.expr,h=mstrmojo.ME._MetricEditorHelper,A=mstrmojo.ME.MetricDataService,c=mstrmojo.mstr.EnumDSSXMLObjectTypes,p=mstrmojo.ME.Enum.DYNAMIC_DIMTY,O=mstrmojo.ME.Enum.UI_OBJECT_TYPE;var U,X;var e=function(E){if(E.onmetricModify){E.onmetricModify();}},b=function(){if(X.updateScrollbars){X.updateScrollbars();}};var Y=mstrmojo.ME.MetricToken.brackets,L=mstrmojo.ME.MetricToken.quotes,Z=mstrmojo.ME.MetricToken.unquotes;var d=function(){var E={"9C374236DD9F11D3B98100C04F2233EA":"Forecast","9C374233DD9F11D3B98100C04F2233EA":"Growth","9C374233DD9F11D3B98100C04F2233EA":"Trend","677E93B2786B11D4B82F00C04F356781":"Case",C41C34F0786B11D4B82F00C04F356781:"CaseV",B2C0FA4420C711D6AD1400C04F0423DE:"IF","8107C324DD9911D3B98100C04F2233EA":"Not"};return E.hasOwnProperty(this.fctOi.did);};var g=function(u){var t=u.split(",")[0],r=t.replace(/\d$/,""),E=t.replace(r,"");return{prefix:r,startAt:parseInt(E,10)};};var G=function(AA){var z=function(){if(AA.isRepeated){var w=this.parent.dataGrid.ctxtBuilder.itemWidgets[this.parent.idx].labelWidget;if(w){w.set("count",this.getSelectedObjects().length);}}};var r=X.getParamObjectTypes();var E={scriptClass:"mstrmojo.Table",cssClass:"funcParam",layout:[{cells:[{cssText:"width: 338px"},{}]}],children:[{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"paramInput",slot:"0,0",cssClass:"mstrmojo-ME-param",dtp:AA.dtp,isDME:X.isDME,hideEditButton:function(w){return true;},hideDelButton:function(w){return this.isFull;},hidePulldownButton:function(){return this.parent.dataGrid.parent.tbBrowsable;},hideItemWidgetBrowseButton:function(){return !this.parent.dataGrid.parent.tbBrowsable;},browsableTypes:r.concat([M.TP.FOLDER]).join(","),folderLinksContextId:17,emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),getCandidatesThroughTaskCall:function x(AB,w){AB.objectType=r.join(",");AB.rootFolderType=39;AB.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AB,w);},postCreate:function(AE){var AD=this.parent.dataGrid,AG=AD&&AD.parent;this.noCache=AG.noCache;if(!this.noCache){this.candidates=AG.getCandidates(function(AH){return mstrmojo.array.indexOf(r,AH.t)>-1;});var w=this.candidates.items||[];if(X.isDME){w=X.replaceAttributeWithForms(m.filter(w,function(AH){return m.indexOf(r,AH.t)>-1&&AH.st!==M.STP.NDE;}));}for(var AC=0,AB=(AA.items||[]).length;AC<AB;AC++){var AF=AA.items[AC];if(AF&&AF.t===mstrmojo.ME.Enum.UI_OBJECT_TYPE.Sub_Expression){w.push(AF);}}this.candidates.items=w;if(!AE){AD.candidatesListener.push(this.id);}}if(!AE){this.set("items",AA.items);}},onitemchange:function(){e(this.parent.dataGrid.parent);},onadd:function t(){z.call(this);},onremove:function v(){z.call(this);},obCfg:{folderLinksContextId:17,browsableTypes:r.concat([M.TP.FOLDER]).join(",")}}],getTokens:function(){var AD=this.paramInput.getSelectedObjects(),AE,w=AD.length,AC,AF=[],AB;if(w>0){for(AC=0;AC<w;AC++){AE=AD[AC];if(AE.state===mstrmojo.Enum_OIB_States.VALID&&AE.did){if(AE.t===O.Sub_Expression){AF=AF.concat(AE.tks);}else{AB={v:Y(AE.n)};if(AE.t===21){AB.oi=AE.oi;AB.exv=AE.fmdid||AE.exv;AB.extp=8;AB.v=AE.fnm?Y(AE.oi.n)+"@"+Y(AE.fnm):AB.v;}else{AB.oi=AE;}AF.push(AB);}}else{AB={v:L(AA.dtp,AE.n)};AF.push(AB);}AF.push({v:mstrmojo.ME.MetricToken.argDelimiter,isDelimiter:true});}AF.pop();}return AF;}};var u=E.children&&E.children[0];if(!AA.isRepeated){u.cssClass="mstrmojo-ME-ObjectInputBox-param singleObject noVerify";u.maxObjectCount=1;}else{u.cssClass="mstrmojo-ME-ObjectInputBox-param noVerify";}return E;};var C=function(t){var r=mstrmojo.all[U];var E=null;if(t.isParam){E=r.getParamWidget(t);}else{switch(t&&t.dtp){case 11:E={scriptClass:"mstrmojo.Pulldown",cssClass:"bool mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:[{n:"False",did:"0"},{n:"True",did:"-1"}],popupToBody:true,itemIdField:"did",postCreate:function(u){var v=this.data;this.value=!!v.v?(v.v==="False"?0:-1):(v.dfv||0);},getTokens:function(){var u=this.data;if(this.value!==u.dfv){return[{v:u.n},{v:"=",isDelimiter:true},{v:this.value=="-1"?"True":"False"}];}return[];},onvalueChange:function(){e(this.parent.dataGrid.parent);}};break;case -2:E=r.getBreakByWidget(t);break;case -1:E=r.getSortByWidget(t);break;default:E=r.getTextWidget(t);break;}}E.alias="inputWidget";return E;};var W=function(u,E,r){var t={scriptClass:"mstrmojo.ui.List",alias:"labelWidget",cssClass:"mstrmojo-FunctionWidzard-labels",count:u.items&&u.items.length||0,buildItems:function(){var v=[],x=this.count,AA=(u.isParam?"*":"")+":",z=u.np;if(z){for(var w=0;w<=x;w++){v.push({n:z.n+(z.startAt+w)+AA,title:u.desc||""});}}else{v.push({n:(u.dn||u.n)+AA,title:u.desc||""});}this.set("items",v);},postCreate:function(){this.buildItems();},oncountChange:function(){this.buildItems();}};return t;};var P=function(v){var r=mstrmojo.all[U];return{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"breakByInput",cssClass:"mstrmojo-ME-breakby",isDME:r.isDME,dtp:v.dtp,emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(2148,"Attribute").toLowerCase()),folderLinksContextId:16,browsableTypes:[M.TP.FOLDER,M.TP.ATTR].join(","),getCandidatesThroughTaskCall:function u(x,w){x.rootFolderType=39;x.blockCount=x.blockCount||this.blockCount;mstrmojo.ME.MetricDataService.getAttributes(x,w);},obCfg:{folderLinksContextId:16,browsableTypes:[M.TP.ATTR,M.TP.FOLDER].join(",")},postCreate:function(z){var w=this.parent.dataGrid,AA=w&&w.parent;this.noCache=AA.noCache;if(!this.noCache){this.candidates=AA.getCandidates(function(AD){return AD.t===c.Attribute||AD.t===c.Consolidation;});if(this.isDME){this.candidates.items=p.getItems("breakby").concat(this.candidates.items);}if(!z){w.candidatesListener.push(this.id);}}if(!z){var x=v.items||[],AB=r.oi.tks,AC=!AB.met||AB.items&&(AB.items.length===0);if(AC&&this.isDME){x.push(p.getAutomaticDimtyObject());}this.set("items",x);}},onitemchange:function(){e(this.parent.dataGrid.parent);},onadd:function E(){b();},onremove:function t(){b();},hidePulldownButton:function(){return this.parent.dataGrid.parent.tbBrowsable;},hideItemWidgetBrowseButton:function(){return !this.parent.dataGrid.parent.tbBrowsable;},getTokens:function(){var AA=this.getSelectedObjects(),w=AA.length,z,AC=[];if(w>0){AC.push({v:"BreakBy"});AC.push({v:"=",isDelimiter:true});AC.push({v:"{",isDelimiter:true});for(z=0;z<w;z++){var AB=AA[z],x;if(h.isDimty(AB.n)){x={v:AB.n};}else{if(/^@/.test(AB.did)){x={v:AB.did};}else{x={v:Y(AB.n),oi:AB};}}AC.push(x);if(z!==(w-1)){AC.push({v:",",isDelimiter:true});}}AC.push({v:"}",isDelimiter:true});}return AC;}};};var F=function(u,v){var r=u.length,E;for(E=0;E<r;E++){var t=mstrmojo.array.find(u[E].fns,"n",v);if(t>-1){return J.clone(u[E].fns[t]);}}return null;};var S=function(t,u){var r,E=u.length,v=t&&t.length;if(v>0){for(r=0;r<v-1;r++){t[r].items=[u[r]];t[r].dynamicVerify=true;}t[v-1].items=[];for(r=v-1;r<E;r++){t[v-1].items.push(u[r]);t[v-1].dynamicVerify=true;}}return t;};var N=function(r,t,w){var v={items:[]},u={301:"}",302:")"}[w],E=t[++r];while(E){if(E.oi){if(w==302){E.oi.selFrm=E.exv;E.oi.asc=E.asc;}v.items.push(E.oi);}if((E=t[++r]).v===u){break;}}return v;};mstrmojo.ME.FunctionWizard=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper,mstrmojo.ME._HasLevel,mstrmojo.ME._HasSortBy],{scriptClass:"mstrmojo.ME.FunctionWizard",cssClass:"mstrmojo-Editor-me mstrmojo-FunctionWidzard",title:mstrmojo.desc(9582,"Function Editor: "),help:"Function_Arguments_dialog_box.htm",fctOi:null,fctArgs:null,fctArgsDataGridCssClass:"functionArgs",fctSyntax:"",fctDesc:"",hiddenPs:[],bindings:{candidates:"this.opener.candidates"},getParamObjectTypes:function f(){var E=[M.TP.METRIC,M.TP.FACT];if(this.isAgg(this.fctOi)){E.push(M.TP.ATTR);}return E;},getCandidates:function R(t){var r=this.candidates,E;if(r){E=mstrmojo.array.filter(r.items,t);return{items:E,isComplete:r.isComplete};}return{};},_set_candidates:function(x,r){this.candidates=r;if(this.hasRendered&&this.visible){var u=this.argsGrid,w=u.candidatesListener,E=w.length,t;for(t=0;t<E;t++){if(mstrmojo.all[w[t]]){mstrmojo.all[w[t]].postCreate(true);}}}if(this._super){this._super(x,r);}return true;},postProcessParamsFromToken:function(u){if(this.refOi&&this.candidates){var v=this.refOi.did;this.refOi=mstrmojo.array.filterOne(this.candidates.items,function(AA){return AA.did===v;});}var z=[],w,t,r=u.pars,E=(r&&r.length)||0;for(t=0;t<E;t++){w=J.copy(r[t]);w.isParam=true;if(t===0&&this.refOi){w.items=[this.refOi];this.refOi=null;}z.push(w);}if(u.rpc>0&&!d.call(this)){w.isRepeated=true;var x=g(w.n);w.np={n:x.prefix,startAt:x.startAt||1};}return z;},postProcessProsFromToken:function(u){var v=[],t,E=(u.pros&&u.pros.length)||0,r=function(w){if(m.indexOf(mstrmojo.ME.Enum.NonExposableParams,w.n)>-1){w.itemCss="hidden";}return w;};for(t=0;t<E;t++){v.push(r(J.copy(u.pros[t])));}return v;},buildSyntax:function(t){var r=[],u,E;r.push(t.n);r.push("(");E=(t.pars&&t.pars.length)||0;for(u=0;u<E;u++){r.push(t.pars[u].n);if(u!==(E-1)){r.push(", ");}}r.push(")");return r;},onOpen:function(){U=this.id;this._setupCandidatesCache();var t=this.getArgsFromTokens();var v=this,u=t||this.fctOi;var E=this.buildSyntax(u),w=this.postProcessParamsFromToken(u);w=w.concat(this.postProcessProsFromToken(u));if(u.sqt===5){w.push({n:"BreakBy",dn:mstrmojo.desc(12173,"Break By"),dtp:-2,desc:"Break By is a parameter representing the break by levels for this function.",items:u.bb&&u.bb.items});}if(u.ios){w.push({n:"SortBy",dn:mstrmojo.desc(12852,"Sort By"),dtp:-1,desc:"Sort By is a parameter representing the sort by levels for this function.",items:u.sb&&u.sb.items});}w=w.concat(this.hiddenPs||[]);v.set("fctArgs",w);v.set("fctSyntax",E.join(""));v.set("fctDesc",mstrmojo.ME.FunctionInfo.getDescAndExample(this.fctOi).desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(u.h));v.set("title",this.insertMode?u.n:mstrmojo.desc(9582,"Function Editor: ")+" "+this.oi.n);v.set("fctName",u.n);this.raiseEvent({name:"fctDidChange",did:this.fctOi.did});this.set("isAggFunction",this.isAgg());this.set("ios",u.ios);if(this._super){this._super();}if(this.isAggFunction){var r=this.argsGrid.ctxtBuilder.itemWidgets;if(r&&r.length>0){this.metricLCT.set("labelWidth",r[0].labelWidget&&r[0].labelWidget.domNode.clientWidth+"px");}}},getArgsFromTokens:function Q(){if(!this.oi||this.oi.tks.items.length===0){return null;}var u={},w=this.oi.tks.items,AL=w.length,AG=[],r=[],AF=0,E=[],AK;for(AK=0;AK<AL;AK++){var z=w[AK],t=z.tp,AN=z.sctt;if(mstrmojo.ME.MetricToken.isDelimiter(z.v)&&(z.v!=="("&&z.v!==")")||z.v==="&gt;"||z.v==="&lt;"){continue;}switch(AN){case 65536:u.n=z.oi?z.oi.n:z.v;var AA=this.fctOi=F(this.functions,u.n);AG=AA.pars||[];r=AA.pros||[];u.rpc=AA.rpc;u.sqt=AA.sqt;u.ios=AA.ios;break;case 196608:var AJ=[],AE=[],AC,AI,AH;z=w[++AK];while(z&&(z.sctt===196608||z.sctt===196609)){if(z.sctt===196608){AE.push(z);}else{AJ.push(AE);AE=[];}z=w[++AK];}AJ.push(AE);AJ[AJ.length-1].pop();for(AH=0;AH<AJ.length;AH++){AE=AJ[AH];var v={n:""};AC=AE.length;if(AC===1){z=AE[0];if(z.extp){v={n:z.v,did:z.oi.did+"@"+z.exv,exv:z.exv,extp:z.extp,oi:z.oi,t:21,tk:z};}else{var AD=Math.min(AG.length-1,E.length),AM=Z(z,z.v,AG[AD].dtp);v=z.oi||{n:AM,v:AM};}}else{for(AI=0;AI<AC;AI++){v.n+=AE[AI].v;}v.v=v.n;v.did=v.n;v.t=O.Sub_Expression;v.tks=AE;}E.push(v);}break;case 131072:if(t==301){var AB={};z=w[++AK];while(z){if(z.tp!=282){if(z.oi){AB.items=AB.items||[];AB.items.push(z.oi);}else{if(z.tp===64){AB.items=AB.items||[];var x=z.v+w[++AK].v;z=w[AK+1];if(z.tp===43||z.tp===45){x+=w[++AK].v;x+=w[++AK].v;}AB.items.push(p.getDimtyObject(x,this.isDME));}}}if((z=w[++AK])["v"]==="}"){break;}}u.bb=AB;}else{if(t==302){u.sb={};}else{if(t==259){mstrmojo.array.forEach(r,function(AQ){if(AQ.n===w[AK].v){AK=AK+2;var AP=w[AK],AO=[];do{AO.push(w[AK++].v);if(w[AK].sctt===131072&&w[AK].tp===62||w[AK].sctt===131073){break;}}while(true);AO=AO.join("");AO=Z(AP,AO,AQ.dtp);AQ.v=AO;return false;}});}}}break;}}u.pars=S(AG,E);u.pros=r;return u;},getTokens:function H(){var u=this.argsGrid.ctxtBuilder.itemWidgets,z=u.length,x,AD,AA=[],t=[],AE=[],AB,v,r,E,AC=this.fctOi;for(x=0;x<z;x++){AD=u[x].inputWidget;if(AD.data.isParam){t.push(AD.getTokens());}else{AA.push(AD.getTokens());}}AE.push({v:AC.n,oi:AC});z=AA.length;if(z>0){E=false;AE.push({v:"<",isDelimiter:true});for(x=0;x<z;x++){AB=AA[x];r=AB.length;if(r===0){continue;}E=true;for(v=0;v<r;v++){AE.push(AB[v]);}AE.push({v:",",isDelimiter:true});}AE.pop();if(E){AE.push({v:">",isDelimiter:true});}}z=t.length;AE.push({v:"(",isDelimiter:true});E=false;for(x=0;x<z;x++){AB=t[x];r=AB.length;if(r===0){continue;}E=true;for(v=0;v<r;v++){AE.push(AB[v]);}AE.push({v:mstrmojo.ME.MetricToken.argDelimiter,isDelimiter:true});}if(E){AE.pop();}AE.push({v:")",isDelimiter:true});for(x=0,z=AE.length;x<z;x++){AE[x].isNew=true;}return AE;},getMetricDefAsTokens:function q(){var E=this.getTokens();if(this.getLCTDefAsTokens){E=E.concat(this.getLCTDefAsTokens());}return E;},handleValidation:function o(v){if(v&&!v.rjec){return ;}var u=v&&v.rjec==="-2147214846";if(u){var t=v.items,w=mstrmojo.array.find(t,"sta",-1),E=t[w].v;mstrmojo.alert('More than one object with the name "#" found. Browse to select the object or retype to select it from the search autocomplete list.'.replace("#",E));}else{mstrmojo.alert(v&&v.rjed);}},getPROPBuilder:function a(){return W;},getDTPBuilder:function k(){return C;},getParamWidget:function B(E){return G(E);},getBreakByWidget:function T(E){return P(E);},getSortByWidget:function l(E){return this._super();},getTextWidget:function V(E){return{scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-functionArgs-textInput",postCreate:function(r){var t=this.data;this.value=t.v||((t.dfv||t.dfv===0)?t.dfv:"");},getTokens:function(){var r=this.data;if(!mstrmojo.string.isEmpty(this.value)&&this.value!==r.dfv){return[{v:r.n},{v:"=",isDelimiter:true},{v:L(r.dtp,this.value)}];}return[];},onvalueChange:function(){e(this.parent.dataGrid.parent);}};},getDataGridRef:function D(){return{scriptClass:"mstrmojo.DataGrid",alias:"argsGrid",cssClass:this.fctArgsDataGridCssClass,makeObservable:true,banding:false,columns:[{headerText:"Property Name",dataWidgetBuilder:this.getPROPBuilder(),colCss:"name"},{headerText:"Property Type",dataWidgetBuilder:this.getDTPBuilder(),colCss:"dtp"}],postCreate:function(){this.candidatesListener=[];},bindings:{items:"this.parent.fctArgs"},onadd:function(){b();}};},init:function n(E){this.children=this.getChildren();this._super(E);U=this.id;X=this;},isAgg:function K(E){return(E||this.fctOi||{}).sqt===1;},getChildren:function I(){return[mstrmojo.ME._MetricEditorHelper.formatAndOptionsBarRef,mstrmojo.ME._MetricEditorHelper.nameEditBoxRef,mstrmojo.ME._MetricEditorHelper.functionNameRef,this.getDataGridRef(),this.getLCTComponent(),{scriptClass:"mstrmojo.Label",slot:"buttonNode",cssClass:"mstrmojo-FE-functionSyntax",bindings:{visible:"this.parent.insertMode",text:function(){return this.parent.fctSyntax;}}},{scriptClass:"mstrmojo.Label",slot:"buttonNode",cssClass:"mstrmojo-FE-functionDesc",allowHTML:true,bindings:{visible:"this.parent.insertMode || this.parent.simplex",text:function(){return this.parent.fctDesc;}}},mstrmojo.ME._MetricEditorHelper.switchRef,mstrmojo.ME._MetricEditorHelper.buttonBarRef];}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.ME.TokenInputBox","mstrmojo.ME.MetricDataService","mstrmojo.DataGrid","mstrmojo.Button","mstrmojo.ToolBar","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper","mstrmojo.mstr.EnumFunction","mstrmojo.ME._HasLevel","mstrmojo.ME._HasSortBy","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(1107,1281,2148,2397,2399,3324,3377,3693,4531,4788,6223,6397,6398,9577,9579,9581,9582,9583,9584,11564,11565,12178,12179,12853,13806,13807,13808,14173,14334);var P=mstrmojo.expr,A=mstrmojo.array,K=mstrmojo.mstr.EnumFunction,G=mstrmojo.ME.MetricToken.brackets;var I,D;var H=function(E){return(E||D.metricContent1.fctPulldown.selectedItem).fnt===K.FunctionCount;};var B=function(S,E){var T=E.fnt===K.FunctionCount,U=D.useGUIDefault;var R=[{n:"Distinct",dtp:11,dfv:"0",v:(T&&U?"-1":"0"),desc:"",dn:mstrmojo.desc(13806,"Include Distinct Elements:")},{n:"Null",dtp:11,dfv:"0",desc:"",dn:mstrmojo.desc(13807,"Include Null:")},{n:"UseLookupForAttributes",dtp:11,dfv:"-1",v:U?"0":"-1",desc:"",dn:mstrmojo.desc(13808,"Use Lookup For Attributes:")},{n:"FactID",dtp:-1,desc:"",dn:"",items:[]}];if(D.isDME){R[3]={n:"MetricID",dtp:-3,desc:"",dn:mstrmojo.desc(14173,"Metric Guide:"),items:[]};}mstrmojo.array.forEach(S,function Q(W){var V=mstrmojo.array.find(R,"n",W.n);if(V>-1){mstrmojo.hash.copy(W,R[V]);}});return R;};mstrmojo.ME.SimpleMetricEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper,mstrmojo.ME._HasLevel,mstrmojo.ME._HasSortBy],{scriptClass:"mstrmojo.ME.SimpleMetricEditor",cssClass:"mstrmojo-Editor-me mstrmojo-SimpleMetricEditor",title:"",help:"Simple_metric_editor.htm",fctSyntax:"",fctDesc:"",did:mstrmojo.ME._HasLevel.EnumEditorComponents.simple,isAggFunction:true,bindings:{candidates:"this.opener.candidates"},init:function M(E){if(this._super){this._super(E);}I=this.id;D=this;},getMetricDefAsTokens:function J(){var W=this.metricContent1.fctPulldown.selectedItem,Y=this.metricContent1.paramInput,U=[],S,T;U.push({v:W.n,oi:W});var V=this.functionPropsRef.getTokens();if(this.ios&&this.getSortByDefAsTokens){var R=this.getSortByDefAsTokens();if(R.length>0){V.push(R);}}T=V.length;if(T>0){var E,X,Q,Z=[];E=false;Z.push({v:"<",isDelimiter:true});for(S=0;S<T;S++){X=V[S];Q=X.length;if(Q===0){continue;}E=true;for(j=0;j<Q;j++){Z.push(X[j]);}Z.push({v:", ",isDelimiter:true});}Z.pop();if(E){Z.push({v:">",isDelimiter:true});}U=U.concat(Z);}U.push({v:"(",isDelimiter:true});U=U.concat(Y.getTokens());U.push({v:")",isDelimiter:true});for(S=0,T=U.length;S<T;S++){U[S].isNew=true;}if(this.getLCTDefAsTokens){U=U.concat(this.getLCTDefAsTokens());}return U;},getMetricDefFromTokens:function C(){var V=[],S=[],X=[],U=this.oi.tks.items,T=U.length,R;for(R=0;R<T;R++){var Q=U[R],W=Q.tp,E=Q.sctt;switch(E){case 65536:switch(W){case 280:V=Q.oi;this.ios=V.ios;break;}break;case 131072:if(W==259||W==303||W==311){S.push({n:U[R].v,v:U[R+2].v,oi:U[R+2].oi});}break;case -1:case 196608:switch(W){case 40:case 41:default:X.push(Q);break;}break;}}if(X.length>2){if(X[0].v==="("){X.shift();}if(X[X.length-1].v===")"){X.pop();}}return{fct:V,fctProps:S,expr:X};},insertMode:false,_set_candidates:function(R,E){this.candidates=E;if(this.hasRendered){var Q=this.metricContent1.paramInput;Q.candidates=this.getCandidates([P.TP.METRIC,P.TP.ATTR,P.STP.NDE],true);if(this._super){this._super(R,E);}}return true;},getCandidates:function O(S,E){var R=this.candidates,Q;if(R){S=A.ensureArray(S);Q=A.filter(R.items,function(T){return A.indexOf(S,T.t)>-1||A.indexOf(S,T.st)>-1;});if(A.indexOf(S,12)>-1&&E){if(this.replaceAttributeWithForms){Q=this.replaceAttributeWithForms(Q);}}return{items:Q,isComplete:R.isComplete};}return null;},getParamInputCandidates:function(){return this.getCandidates([P.TP.METRIC,P.TP.ATTR].concat(H()?[P.STP.NDE]:[]),true);},onOpen:function F(){D=this;var R=this.getMetricDefFromTokens();var V=mstrmojo.ME.MetricDataService.getAggFunctions(),W=this.metricContent1.fctPulldown,X=R.fct&&R.fct.did||this.did;if(V&&W){W.set("items",V);if(X&&mstrmojo.ME.MetricDataService.isBasicAggMap(X)){W.set("value",X);}else{W.set("value","8107C31BDD9911D3B98100C04F2233EA");}}this.set("fctProps",R.fctProps);if(this.functionPropsRef){this.functionPropsRef.propsCache=null;this.functionPropsRef.originFctProps=B(this.fctProps,this.metricContent1.fctPulldown.selectedItem);}var T=this.metricContent1.paramInput;T.candidates=this.getParamInputCandidates();var U,Q=R.expr.length;if(this.isDME&&this.refOi&&this.candidates){var E=this.refOi.did;U=mstrmojo.array.filterOne(this.candidates.items,function(Z){return Z.did===E;});}if(Q>0){U={n:""};if(Q===1){var Y=R.expr[0];if(Y.extp){U={n:Y.v,did:Y.exv,exv:Y.exv,extp:Y.extp,oi:Y.oi,tk:Y};}else{U=Y.oi||{n:Y.v,t:Y.tp};}}else{for(var S=0;S<Q;S++){U.n+=R.expr[S].v;}U.t=-2;U.tks=R.expr;}}T.set("items",null);T.set("items",U?[U]:null);this.set("title",this.insertMode?this.metricContent1.fctPulldown.selectedItem.n:mstrmojo.desc(9582,"Function Editor: ")+" "+this.oi.n);this.raiseEvent({name:"fctDidChange",did:X});if(this._super){this._super();}this.set("ios",W.selectedItem.ios);},useGUIDefault:false,functionPropsRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-functionParameters",useRichTooltip:false,setupFunctionProps:function L(){var Q=this.opener;this.fctPropsGrid.items=null;var E=Q.metricContent1.fctPulldown.selectedItem;this.propsCache=this.propsCache||{};this.propsCache[E.did]=this.propsCache[E.did]||B(Q.fctProps,E);this.cleanCopy={did:E.did,props:mstrmojo.hash.clone(this.propsCache[E.did])};this.set("fctProps",this.propsCache[E.did]);},onOpen:function(){this.setupFunctionProps();var E=this.opener;this.set("title",E.metricContent1.fctPulldown.selectedItem.n+" "+mstrmojo.desc(11565,"Parameters"));},children:[{scriptClass:"mstrmojo.DataGrid",alias:"fctPropsGrid",cssClass:"functionPropsGrid",cssText:"margin: 5px auto; 0",makeObservable:true,banding:false,columns:[{headerText:"",dataFunction:function(R,E,Q){return'<div class="mstrmojo-DataRow-text"title="'+(R.desc||"")+'">'+(R.dn||R.n)+"</div>";},colCss:"name"},{headerText:"",dataWidgetBuilder:function(S,E,R){var Q;switch(S.dtp){case 11:Q={scriptClass:"mstrmojo.ListHoriz",cssClass:"radio",itemIdField:"did",items:[{n:mstrmojo.desc(6397,"True"),did:"-1"},{n:mstrmojo.desc(6398,"False"),did:"0"}],popupToBody:true,popupZIndex:100,postCreate:function(U){var V=this.data;var T=!!V.v?(V.v=="False"||V.v=="0"?0:-1):(V.dfv||0);this.set("selectedIndex",mstrmojo.array.find(this.items,"did",T));},onchange:function(T){if(T.removed.length===1){this.data.v=this.selectedItem.did;if(this.data.n==="UseLookupForAttributes"){this.dataGrid.factID.set("enabled",this.data.v=="0"||this.data.v=="False");}this.dataGrid.parent.set("dirty",true);}},getTokens:function(){var U=this.data,T=this.selectedItem.did;if(T!==U.dfv){return[{v:U.n},{v:"=",isDelimiter:true},{v:T=="-1"?"True":"False"}];}else{return[];}}};break;default:Q={scriptClass:"mstrmojo.Pulldown",alias:"factID",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",itemIdField:"did",items:S.items,popupToBody:true,popupZIndex:100,getTokens:function(){var T=this.data;return this.enabled&&this.selectedIndex>0?[{v:T.n},{v:"=",isDelimiter:true},{v:mstrmojo.ME.MetricToken.brackets(this.selectedItem.n),oi:this.selectedItem,isNew:true}]:[];},postCreate:function(){this.dataGrid.factID=this;var X=this.dataGrid.parent.fctProps[2],T=!!X.v?(X.v=="False"||X.v=="0"?0:-1):(X.dfv||0);this.enabled=T==0;var W=this;switch(S.dtp){case -1:var Y=function(Z){if(Z){W.set("items",[{n:mstrmojo.desc(3693,"(None)"),did:-1}].concat(Z.items));W.set("value",S.oi&&S.oi.did||-1);}},U=function(Z){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getFacts({pattern:"*",blockBegin:1,blockCount:-1,rootFolderType:39},{success:Y,failure:U});break;case -2:break;case -3:var V=[{n:mstrmojo.desc(4531,"Automatic"),did:-1}];mstrmojo.array.forEach(D.dsUnits.items,function(a,Z){if(a.t===4){V.push(a);}});this.set("items",V);this.set("value",(S.oi&&S.oi.did)||-1);break;}},onvalueChange:function(T){if(T.valueWas!=null){this.data.oi=this.selectedItem;this.dataGrid.parent.set("dirty",true);}}};break;}Q.alias="inputWidget";return Q;},colCss:"dtp"}],bindings:{items:function(){return this.parent.fctProps;}}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:mstrmojo.desc(2397,"OK"),bindings:{enabled:"this.parent.parent.dirty"},onclick:function(){var E=this.parent.parent;E.opener.onmetricModify();E.originFctProps=null;E.close();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancel"),onclick:function(){var E=this.parent.parent;var Q=E.cleanCopy;E.propsCache[Q.did]=Q.props;E.set("dirty",false);E.close();}}]}],getTokens:function(){var a=[],Y=[],T,S,X;var W=this.fctPropsGrid;var V=this.originFctProps;if(V){var E,U,Q,Z;X=V.length;for(T=0;T<X;T++){E=V[T];U=E.dtp;Q=E.v||E.dfv;if(U===11){Z=(Q!=E.dfv)?[{v:E.n},{v:"=",isDelimiter:true},{v:Q=="-1"||Q=="True"?"True":"False"}]:[];Y.push(Z);}else{if(E.oi){Z=[{v:E.n},{v:"=",isDelimiter:true},{v:G(E.oi.n),oi:E.oi}];Y.push(Z);}}}}else{if(W){var R=W&&W.ctxtBuilder.itemWidgets;for(T=0,X=R.length;T<X;T++){Y.push(R[T].inputWidget.getTokens());}}else{return[];}}return Y;}},handleValidation:function(E){},postBuildRendering:function(){if(this._super){this._super();}this.addSlots({scrollBoxNode:this.metricLCT.domNode});},children:[mstrmojo.ME._MetricEditorHelper.formatAndOptionsBarRef,mstrmojo.ME._MetricEditorHelper.nameEditBoxRef,mstrmojo.ME._MetricEditorHelper.functionNameRef,{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SME-content1",alias:"metricContent1",children:[{scriptClass:"mstrmojo.Pulldown",alias:"fctPulldown",cssClass:"mstrmojo-SME-funcs-pulldown mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",popupToBody:true,itemIdField:"did",itemField:"n",onvalueChange:function(W){var Q="",T="",X=this.selectedItem;if(X){T=mstrmojo.ME.FunctionInfo.getDescAndExample(X).desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(X.h);var E=X.pars,V=[],R,U;V.push(X.n);V.push("(");for(R=0,U=E.length;R<U;R++){V.push(E[R].n);if(R!==(U-1)){V.push(", ");}}V.push(")");Q=V.join("");}var S=this.parent.parent;S.set("fctSyntax",Q);S.set("fctDesc",T);S.set("fctName",X&&X.n);S.set("ios",X&&X.ios);S.raiseEvent({name:"fctDidChange",did:X&&X.did});if(W.valueWas){S.onmetricModify();}D.functionPropsRef.originFctProps=B(D.fctProps,X);D.metricContent1.paramInput.candidates=D.getParamInputCandidates();}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-SME-agg-label",text:mstrmojo.desc(12853,"of")},{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"paramInput",cssClass:"mstrmojo-SME-ObjectInputBox-param",maxObjectCount:1,browsableTypes:[11,12,13,43,4,8].join(","),folderLinksContextId:25,emptyText:mstrmojo.desc(14334,"Search for a fact, metric or attribute ..."),getCandidatesThroughTaskCall:function N(Q,E){Q.objectType="12,13,43,4";Q.rootFolderType=39;Q.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(Q,E);},bindings:{isDME:function(){return this.parent.parent.isDME;},dtp:function(){var E=this.parent.fctPulldown.selectedItem;return E.pars[0].dtp;}},hidePulldownButton:function(){return this.parent.parent.tbBrowsable;},hideItemWidgetBrowseButton:function(){return !this.parent.parent.tbBrowsable;},onitemchange:function(){this.parent.parent.onmetricModify();},getTokens:function(){var S=this.getSelectedObjects(),U,E=S.length,R,V=[],Q,T;if(E>0){for(R=0;R<E;R++){U=S[R];if(U.state===mstrmojo.Enum_OIB_States.VALID&&U.did){T=U.n.split("@");if(U.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.AttributeForm||T.length===2){Q={v:G(T[0])+"@"+G(T[1]),tp:2,lv:1};if(U.fmdid){Q.tp=275;Q.exv=U.fmdid;Q.extp=8;Q.lv=3;Q.oi=U.oi;}}else{Q={v:G(U.n),oi:U};}}else{Q={v:U.n};}V.push(Q);V.push({v:",",isDelimiter:true});}V.pop();}return V;}}]},{scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-ME-link mstrmojo-SME-fpLink",text:mstrmojo.desc(11564,"Function Parameters"),onclick:function(){var E=this.parent;E.openPopup("functionPropsRef",{selectedFunction:E.metricContent1.fctPulldown.selectedItem,zIndex:E.zIndex+1});}},mstrmojo.ME._HasLevel.getLCTComponent(),mstrmojo.ME._HasSortBy.getSortByWidget(true),{scriptClass:"mstrmojo.Label",slot:"buttonNode",cssClass:"mstrmojo-FE-functionSyntax",bindings:{visible:"this.parent.insertMode",text:"this.parent.fctSyntax"}},{scriptClass:"mstrmojo.Label",slot:"buttonNode",cssClass:"mstrmojo-FE-functionDesc",allowHTML:true,bindings:{visible:"this.parent.insertMode",text:"this.parent.fctDesc"}},mstrmojo.ME._MetricEditorHelper.switchRef,mstrmojo.ME._MetricEditorHelper.buttonBarRef]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui._HasScroller","mstrmojo.ME.SimpleMetricEditor","mstrmojo.ME._DerivedMetricEditorHelper");mstrmojo.ME.DerivedSimpleMetricEditor=mstrmojo.declare(mstrmojo.ME.SimpleMetricEditor,[mstrmojo.ME._DerivedMetricEditorHelper,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.DerivedSimpleMetricEditor",init:function C(D){mstrmojo.css.addWidgetCssClass(this,"dme");this._super(D);},setupScrollNodes:function B(){this.scrollNode=this.containerNode;},onOpen:function A(){this._super();if(this.updateScrollbars){this.updateScrollbars();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.FunctionWizard","mstrmojo.ME._MetricEditorHelper","mstrmojo.ui._HasScroller");mstrmojo.requiresDescs(1058,1059,4046,4049,12853,13357,13358,13359,13360,13361);var K=mstrmojo.hash;var J,C;var G={First:"0",Last:"1",Current:"2",Previous:"3",Next:"4"},I=[{n:mstrmojo.desc(4046,"First"),did:G.First},{n:mstrmojo.desc(1058,"Previous"),did:G.Previous},{n:mstrmojo.desc(13361,"Current"),did:G.Current},{n:mstrmojo.desc(1059,"Next"),did:G.Next},{n:mstrmojo.desc(4049,"Last"),did:G.Last}],L={StartAt:-3,StopAt:-4};var A=function(O){var N=mstrmojo.all[J];var H=null;if(O.isParam){H=N.getParamWidget(O);}else{switch(O&&O.dtp){case L.StartAt:case L.StopAt:H={scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-olap-type-box",children:[{scriptClass:"mstrmojo.Pulldown",alias:"winType",cssClass:"mstrmojo-olapArgs-pulldown mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:{"-3":I.slice(0,4),"-4":I.slice(1)}[O.dtp],itemIdField:"did",postCreate:function(){var P=this.parent.data.type;this.value=P.v||P.dfv;},getTokens:function(){var P=this.parent.data.type;if(this.value!==P.dfv){return[{v:P.n},{v:"=",isDelimiter:true},{v:this.value}];}return[];},onvalueChange:function(){C.onmetricModify();}},{scriptClass:"mstrmojo.ValidationTextBox",alias:"winOffset",cssClass:"mstrmojo-olap-offset",bindings:{visible:function(){return this.parent.winType.value===G.Previous||this.parent.winType.value===G.Next;}},postCreate:function(){var P=this.parent.data.offset;this.value=P.v||P.dfv;},dtp:mstrmojo.expr.DTP.INTEGER,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:1},getTokens:function(){var P=this.parent.data.offset;if(!mstrmojo.string.isEmpty(this.value)&&this.value!==P.dfv){return[{v:P.n},{v:"=",isDelimiter:true},{v:this.value}];}return[];}},{scriptClass:"mstrmojo.Label",bindings:{visible:function(){return this.parent.winType.value===G.Previous||this.parent.winType.value===G.Next;},text:function(){return this.parent.winType.value===G.Previous?mstrmojo.desc(13357,"row(s) before current"):mstrmojo.desc(13358,"row(s) after current");}}}],getTokens:function(){var R=[],S=this.winType.getTokens(),Q=this.winOffset.getTokens(),P;P=S.length;if(P>0){R=R.concat(S);}P=Q.length;if(P>0){R.push({v:",",isDelimiter:true});R=R.concat(Q);}return R;}};break;case -2:H=N.getBreakByWidget(O);break;case -1:H=N.getSortByWidget(O);break;default:H=N.getTextWidget(O);}}if(H){H.alias="inputWidget";}return H;};mstrmojo.ME.OLAPEditor=mstrmojo.declare(mstrmojo.ME.FunctionWizard,[mstrmojo.ME._MetricEditorHelper,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.OLAPEditor",init:function M(H){this._super(H);mstrmojo.css.addWidgetCssClass(this,"olap");J=this.id;C=this;},onOpen:function D(){J=this.id;C=this;this._super();var H=this.argsGrid.ctxtBuilder.itemWidgets[0].fctBox.fctPulldown;H.set("value",this.fctOi.did);if(this.updateScrollbars){this.updateScrollbars();}},setupScrollNodes:function E(){if(!mstrmojo.dom.ISIE8){this.scrollNode=this.containerNode;}},getPROPBuilder:function B(){return function(P){var N=null;if(P.isParam){var O=function(){return mstrmojo.array.map(mstrmojo.ME.MetricDataService.getOLAPAggFunctions(),function(Q){Q.dn=Q.n.substring(4);return Q;});};N={scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-olap-fctBox",alias:"fctBox",children:[{scriptClass:"mstrmojo.Pulldown",alias:"fctPulldown",cssClass:"mstrmojo-SME-funcs-pulldown mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",itemIdField:"did",itemField:"dn",items:O(),onvalueChange:function(S){var T="",X="",W=this.selectedItem;if(W){X=W.desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(W.h);var V=W.pars,R=[],U,Q;R.push(W.n);R.push("(");for(U=0,Q=V.length;U<Q;U++){R.push(V[U].n);if(U!==(Q-1)){R.push(", ");}}R.push(")");T=R.join("");}C.set("fctSyntax",T);C.set("fctDesc",X);C.set("fctName",W&&W.n);C.fctOi=W;if(S.valueWas){C.onmetricModify();}C.raiseEvent({name:"fctDidChange",did:W.did});}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-SME-agg-label",text:mstrmojo.desc(12853,"of")}]};}else{var H=(P.dtp===-1?" sortBy":"");N={scriptClass:"mstrmojo.Label",markupString:'<div id="{@id}" class="mstrmojo-DataRow-text '+H+'"title="'+(P.desc||"")+'"></div>',alias:"labelWidget",text:(P.dn||P.n)+(P.isParam?"*":"")+":"};}return N;};},getDTPBuilder:function F(){return A;},postProcessProsFromToken:function(O){var S=[],R,N,Q=O.pros,H=(Q&&Q.length)||0,P=[];for(N=0;N<H;N++){R=K.copy(Q[N]);switch(R.n){case"OLAPWinStType":S.push({n:mstrmojo.desc(13359,"Start At"),dtp:L.StartAt,type:K.copy(Q[N]),offset:K.copy(Q[++N])});break;case"OLAPWinEndType":S.push({n:mstrmojo.desc(13360,"Stop At"),dtp:L.StopAt,type:K.copy(Q[N]),offset:K.copy(Q[++N])});break;default:if(R.v!=null){P.push(R);}}}this.hiddenPs=P;return S;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.ui._HasScroller","mstrmojo.SearchableDropDownList","mstrmojo.ME.FunctionWizard","mstrmojo.ME._DerivedMetricEditorHelper");mstrmojo.requiresDescs(3377,11569,12179);var A,C;mstrmojo.ME.DerivedFunctionWizard=mstrmojo.declare(mstrmojo.ME.FunctionWizard,[mstrmojo.ME._DerivedMetricEditorHelper,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.DerivedFunctionWizard",init:function F(G){mstrmojo.css.addWidgetCssClass(this,"dme");this._super(G);A=this.id;C=this;},setupScrollNodes:function E(){this.scrollNode=this.containerNode;},onOpen:function B(){this._super();if(this.updateScrollbars){this.updateScrollbars();}},getParamObjectTypes:function D(){var G=this.opener||{};return G.getValidFuncParamTypes?G.getValidFuncParamTypes(this.fctOi):this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.HBox","mstrmojo.ui.menus.EditorConfig","mstrmojo.mstr.EnumFunction","mstrmojo.DropDownList","mstrmojo.ui.Pulldown","mstrmojo.SearchablePulldown","mstrmojo.ButtonList","mstrmojo.Box","mstrmojo.Label","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.EditableLabel","mstrmojo.CheckBox","mstrmojo.fe.FilterEditor","mstrmojo._FormatDefinition","mstrmojo.num","mstrmojo.locales","mstrmojo.vi.models.VIComponentMap","mstrmojo.func","mstrmojo.dom","mstrmojo.ME.AttributeEditBox","mstrmojo.string","mstrmojo.dom","mstrmojo.models.datasets.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.editors.ObjectPicker","mstrmojo.vi.ui.editors.AttributeLinkEditor","mstrmojo.vi.ui.NumberFormatter");mstrmojo.requiresDescs(1442,1885,1886,2022,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,3993,4564,11494,11495,11496,11497,14612);var n=mstrmojo.mstr.EnumFunction,X=mstrmojo.hash,q=mstrmojo.array,AF=mstrmojo.expr.ET,D=mstrmojo.css,V=mstrmojo.dom,u=mstrmojo.Button.newWebButton,S=mstrmojo.ME.MetricToken.brackets,T=mstrmojo._FormatDefinition,o=mstrmojo.models.datasets.DataInterface,K=mstrmojo.vi.models.VIComponentMap.TYPES,U=mstrmojo.chart.model.enums.EnumDSSObjectType;var Y={SUM:mstrmojo.desc(2131,"Sum"),ADD:mstrmojo.desc(6017,"Add"),AVG:mstrmojo.desc(2122,"Average"),MAX:mstrmojo.desc(2125,"Maximum"),GST:mstrmojo.desc(5869,"Greatest"),MIN:mstrmojo.desc(2127,"Minimum"),LST:mstrmojo.desc(5868,"Least"),CNT:mstrmojo.desc(2123,"Count"),MTP:mstrmojo.desc(5418,"Multiply"),STD:mstrmojo.desc(2130,"Standard Deviation"),PTD:mstrmojo.desc(11494,"Population Standard Deviation")},c={SUM:{n:Y.SUM,t:n.FunctionSum},ADD:{n:Y.ADD,t:n.FunctionPlus},AVG:{n:Y.AVG,t:n.FunctionAvg},MAX:{n:Y.MAX,t:n.FunctionMax},GST:{n:Y.GST,t:n.FunctionGreatest},MIN:{n:Y.MIN,t:n.FunctionMin},LST:{n:Y.LST,t:n.FunctionLeast},TMS:{n:Y.MTP,t:n.FunctionTimes},CNT:{n:Y.CNT,t:n.FunctionCount},GEM:{n:mstrmojo.desc(2124,"Geometric Mean"),t:n.FunctionGeomean},MED:{n:mstrmojo.desc(2126,"Median"),t:n.FunctionMedian},MOD:{n:mstrmojo.desc(2128,"Mode"),t:n.FunctionMode},PDT:{n:mstrmojo.desc(2129,"Product"),t:n.FunctionProduct},STD:{n:mstrmojo.desc(2130,"Standard Deviation"),t:n.FunctionStdev},VAR:{n:mstrmojo.desc(2132,"Variance"),t:n.FunctionVar}},Z=[{n:Y.SUM,t:n.FunctionOLAPSum},{n:Y.AVG,t:n.FunctionOLAPAvg},{n:Y.MIN,t:n.FunctionOLAPMin},{n:Y.MAX,t:n.FunctionOLAPMax},{n:Y.CNT,t:n.FunctionOLAPCount}],AG=[{n:Y.SUM,t:n.FunctionOLAPSum},{n:Y.AVG,t:n.FunctionOLAPAvg},{n:Y.MIN,t:n.FunctionOLAPMin},{n:Y.MAX,t:n.FunctionOLAPMax},{n:Y.CNT,t:n.FunctionOLAPCount}],M=[{n:mstrmojo.desc(1058,"Previous"),t:n.FunctionLag},{n:mstrmojo.desc(1059,"Next"),t:n.FunctionLead},{n:mstrmojo.desc(4046,"First"),t:n.FunctionFirst},{n:mstrmojo.desc(4049,"Last"),t:n.FunctionLast}];function e(AK,AM,AL,AI){return{scriptClass:"mstrmojo.ui.Pulldown",items:AK,selectedIndex:AM,onitemSelected:function AJ(AN){var AO=this.parent;while(!AO.data||!AO.data[AL]){AO=AO.parent;}AO.data.set(AL,AI?AI(AN):AN.v);}};}function v(AJ,AI){return{scriptClass:"mstrmojo.Box",cssClass:"breakByBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13903,"Break by:")},e(AJ,AI,"breakBy",function(AK){return{id:AK.did,type:AK.t,dmy:AK.dmy};})]};}function AD(AL){var AM=AL.metrics,AN=AL.propName,AK=AL.optionValueField||"id",AI=q.find(AM,AK,AL.value),AO=function AO(AQ){var AP=this.parent;while(!AP.data||!AP.data.hasOwnProperty(AN)){AP=AP.parent;}AP.data.set(AN,AQ?{id:AQ[AK],type:4}:{cst:this.text});};return{scriptClass:"mstrmojo.ui.SearchablePulldown",items:AM,selectedIndex:AI,useRichTooltip:true,bindings:AL.bindings,valid:true,allowCustomText:true,allowEmptyText:true,onvalidChange:function AJ(){mstrmojo.css.toggleClass(this.domNode,"invalid",!this.valid);if(this.hasRendered){this.hideTooltip();this.showTooltip();}},updateTooltipConfig:function(){if(this.valid){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onitemSelected:AO,onTextEditComplete:function(){AO.call(this,this.items[this.selectedIndex]);},onPopupWidgetOpened:function(){this.set("valid",true);},postkeyup:AL.postkeyup};}function R(AL,AK,AJ){if(AL&&AL.datap){var AI=q.filterOne(AL.datap,function(AN){return AN.tbid===AK;}),AM=AI&&AI.maps.amps;return q.filterOne(AM,function(AN){return AJ===AN.aimp.atid;});}return null;}function h(AI,AM){var AK=q.filterOne(AI&&AI.afmps,function(AN){return AN.fmid===AM;}),AL=AK&&(AK.sqc?AK:AK.col.oi),AJ;if(AL&&AL.sqc){AJ={did:AL.sqc.id,n:mstrmojo.string.decodeHtmlString(AL.cln),coldtp:AL.sqc.dt.tp,georole:AL.geo,timerole:AL.tim,der:AL.sqc.der};}else{if(AL){AJ={did:AL.did,n:mstrmojo.string.decodeHtmlString(AL.def.cln),coldtp:AL.def.dt.tp,georole:AK.geo,timerole:AL.def.dicl.time,der:AL.def.dicl.der};}}return AJ;}function C(AJ,AI,AL){var AK={success:function(AM){if(AM&&AM.msgid){mstrApp.serverRequest({taskId:"qBuilder.GetReportXDADefinition",msgid:AM.msgid,bindingflag:2,previewflag:261,browsetype:5},AL);}},failure:function(AM){mstrApp.onerror(AM);}};mstrApp.serverRequest({taskId:"duplicateReportInstance",datasetID:AI,messageID:AJ},AK);}function I(AN,AO,AL){var AJ=AN.srcTableId,AQ=AN.tgtTableId,AI,AM,AK=function(AU,AT){var AW="<mpcs><mpc ",AS,AV;for(AS in AT){AV=AT[AS];AW+='$ACT="$VAL" '.replace("$ACT",AS).replace("$VAL",AV);}AW+="/></mpcs>";return{act:"changeEMMAMapping",tbid:AU,dsid:AN.dsid,mapping:AW};},AR=function(AU){var AV={success:function(){AP();}},AT,AS;AI=R(AU,AJ,AN.srcId);AM=R(AU,AQ,AN.tgtId);AT=h(AI,AI.afmps[0].fmid);AS=[AK(AJ,{did:AT.did,oid:AM.aimp.atid,fg:1})];AO.getDataService().submitUpdates(AS,AV);},AP=function(){var AS=[],AV={},AT,AU;if(!AI||!AM){return ;}AV[AJ]={};AV[AQ]={};q.forEach(AI.afmps,function(AZ){var AX=q.find(AM.afmps,"fmid",AZ.fmid),Aa,AY,AW;if(AX>=0){AT=h(AI,AZ.fmid);AU=h(AM,AZ.fmid);if(AT.georole!==AU.georole){AW=(AT.georole===0)?AJ:AQ;Aa=(AT.georole===0)?AT.did:AU.did;AY=AT.georole||AU.georole;AV[AW][Aa]=X.copy({did:Aa,georole:AY},AV[AW][Aa]);}if(AT.timerole!==AU.timerole){AW=(AT.timerole===0)?AJ:AQ;Aa=(AT.timerole===0)?AT.did:AU.did;AY=AT.timerole||AU.timerole;AV[AW][Aa]=X.copy({did:Aa,timerole:AY},AV[AW][Aa]);}if(AT.der!==AU.der){AY=AT.der|AU.der;AV[AJ][AT.did]=X.copy({did:AT.did,drvflg:AY},AV[AJ][AT.did]);AV[AQ][AU.did]=X.copy({did:AU.did,drvflg:AY},AV[AQ][AU.did]);}}});X.forEach(AV,function(AW,AX){X.forEach(AW,function(AY){AS.push(AK(AX,AY));});});AT=h(AI,AI.afmps[0].fmid);AS.push(AK(AJ,{did:AT.did,oid:AM.aimp.atid}));if(AL){AL(AS);}};C(AO.mid,AN.dsid,{success:AR});}function W(AN,AK,AJ,AO){var AI=0,AM=[],AL=function(AP){var AQ=AJ[AI-1];if(AP&&AP.tks&&AQ){AM.push({fid:AQ.fid,fnm:AQ.fnm,ftk:AP.tks.items});}if(AI===AJ.length){AO(AM);return ;}AQ=AJ[AI++];mstrmojo.ME.MetricDataService.validateMetric({metricId:AK,formID:AQ.fid,objectType:12,tokenStreamXML:"",metricXML:"",msgID:AN},{success:AL});};AL();}function z(AI,AJ){return{v:S(AI.n)+"@"+S(AJ.fnm),tp:275,lv:1,exv:AJ.fid,extp:8,oi:{did:AI.did,t:AI.t,n:AI.n}};}mstrmojo.vi.ui.DatasetUnitMenuUtils=mstrmojo.provide("mstrmojo.vi.ui.DatasetUnitMenuUtils",{getAvailableShortcutMetricFunctionsGroup:function AC(AI){return{"12":[[c.AVG,c.CNT,c.MAX,c.MIN,c.STD,c.SUM,c.VAR]],"4":[[c.SUM,c.AVG,c.MIN,c.MAX,c.CNT],[c.GEM,c.MED,c.MOD,c.PDT,c.STD,c.VAR]]}[AI.t];},isAmongFunctions:function A(AJ,AI){return AI.some(function(AK){return AK.some(function(AL){return AL.t===AJ;});});},getMultiSelectionShortcutMetricFunctions:function J(AI){var AJ=true;q.forEach(AI,function(AK){if(4!==AK.t){AJ=false;return false;}return true;});return AJ?[c.ADD,c.AVG,c.GST,c.LST,c.TMS]:[];},getRelativeReferenceMenu:function b(AM,AK,AP,AI){var AL=0,AJ=M[AL],AO=0,AN=AP&&AP[AO];return new mstrmojo.ui.menus.EditorConfig({data:{item:AM,relativeRef:AJ,breakBy:AN},cssClass:"RelativeReference-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",cssClass:"funcBox",children:[{scriptClass:"mstrmojo.Label",visible:AK&&AK.length,text:AK},e(M,AL,"relativeRef",function(AQ){return AQ.t;})]},v(AP,AO)],fnOk:function(AQ){return AI(AQ.item,AQ.relativeRef,[AQ.breakBy]);}});},getMovingTotalMenu:function B(AS,AM,AO){var AT=1,AL=AG[AT].t,AN=1,AJ=mstrmojo.desc(13289,"Starting previous##rows").split("##"),AR=0,AK=AM&&AM[AR];return new mstrmojo.ui.menus.EditorConfig({cssClass:"MovingTotal-MenuEditor",data:{item:AS,funcType:AL,windowSize:AN,breakBy:AK},contents:[e(AG,AT,"funcType",function(AU){return AU.t;}),{alias:"winSzBox",scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"WinSzPrefix",text:AJ[0]},{alias:"winSz",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:mstrmojo.expr.DTP.INTEGER,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:1},postCreate:function AQ(){this.set("value",AN);},_ontooltipover:function(){var AU=mstrmojo.all[this.id];AU._hovered=true;AU.showTooltip();},_ontooltipout:function(){var AU=mstrmojo.all[this.id];AU._hovered=false;AU.hideTooltip();},useRichTooltip:true,tooltipOpenDelay:0,onInvalid:function(){var AU=this.validationStatus.msg,AV=!(this.richTooltip&&AU===this.richTooltip.content);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-V",top:-5,refNode:this.domNode,content:AU};if(this._hovered&&AV){this.hideTooltip();this.showTooltip();}},onValid:function(){this.richTooltip=null;this.hideTooltip();},postvalueChange:function AP(){var AU=this.isValid();this.parent.parent.popupConfig.data.set("windowSize",AU?parseInt(this.value,10):0);}},{scriptClass:"mstrmojo.Label",cssClass:"WinSzSuffix",text:AJ[1]}]},v(AM,AR)],bindings:{okEnabled:function(){return !!this.data.windowSize;}},fnOk:function AI(AU){if(AO){AO(AS,AU.funcType,AU.windowSize,[AU.breakBy]);}}});},getRunningTotalMenu:function AB(AL,AO,AJ){var AK=0,AI=Z[AK].t,AN=0,AM=AO&&AO[AN];return new mstrmojo.ui.menus.EditorConfig({data:{item:AL,func:AI,breakBy:AM},cssClass:"RunningTotal-MenuEditor",contents:[e(Z,AK,"func",function(AP){return AP.t;}),v(AO,AN)],fnOk:function(AP){return AJ(AP.item,AP.func,[AP.breakBy]);}});},getRankMetricEditor:function w(AM,AP,AK){var AI=[{n:mstrmojo.desc(1886,"Descending"),v:"0"},{n:mstrmojo.desc(1885,"Ascending"),v:"-1"}],AJ=0,AL=AI[AJ].v,AO=0,AN=AP&&AP[AO];return new mstrmojo.ui.menus.EditorConfig({data:{item:AM,order:AL,breakBy:AN},cssClass:"NewRankMetric-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14612,"Sort:")},e(AI,AJ,"order")]},v(AP,AO)],fnOk:function(AQ){return AK(AQ.item,AQ.order,[AQ.breakBy]);}});},insertAddUnitToFilterMenu:function H(AN,AJ,AI){var AL=this,AK=mstrmojo.desc(2022,"Add to Filter"),AM=q.ensureArray(AI).filter(function(AO){return AL.isValidAddToFP(AJ,AO);});if(AM.length>0){AN.addMenuItem(AK,"",function(){AJ.addFilterStackSelectors(AM);});}else{AN.addDisabledMenuItem(AK,"");}},isValidAddToFP:function N(AL,AN){var AJ=AL.controller.view.builder,AK=AJ.getLayoutVIMap(AL.getCurrentLayoutKey()).getComponent(K.FILTER_STACK),AO;AO=(!AK||q.find(AK.getFilterDefinitions(),"srcid",AN.did)===-1);if(AO&&AN.lock){var AI=AN.fs||[],AM;AO=false;for(AM=0;AM<AI.length;AM++){if(AI[AM].iidx){AO=true;break;}}}return AO;},renameItem:function p(AN,AQ,AJ,AL){var AM=AN.mstrmojoId,AP=mstrmojo.dom.findWidget(AN);AL=AL||{};if(!AM){var AO=mstrmojo.insert({scriptClass:"mstrmojo.EditableLabel",editOnClick:false,text:AQ.n,title:AQ.dsc||"",allowEmptyText:AL.allowEmptyText,cssClass:AL.cssClass||"",placeholder:AN,onTextEditComplete:function AI(AR){if(AR){return AJ(this);}},onmousedown:function AK(AR){if(this.isEditing){AR.cancel();}}});if(AP&&AP.draggable){AO.parent=AP;}AO.render();AM=AO.id;}mstrmojo.all[AM].set("isEditing",true);return mstrmojo.all[AM];},getMultipleMetricsCalculationMenus:function g(AP,AI,AS){var AO=new mstrmojo.ui.menus.MenuConfig(),AU=mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(AP),AM=function(AW,AX,AV){return{dsid:AI,funcType:AX,funcType2:AV,items:AW};};AO.useTooltip=true;AU.forEach(function(AV){AO.addMenuItem(AV.n,"",function(){AS(AM(AP,AV.t));});});if(AP.length===2){var AN=mstrmojo.mstr.EnumFunction,AL=AN.FunctionDivide,AJ=AN.FunctionMinus,AR=AP[0],AQ=AP[1],AT=function(AZ,AX,AV,AY,AW){AO.addMenuItem(AZ,"",function(){AS(AM([AX,AV],AY,AW));});},AK=[{n:function(AW,AV){return AW.n+"/"+AV.n;},fn:AL},{n:function(AW,AV){return AW.n+"-"+AV.n;},fn:AJ},{n:function(AW,AV){return"("+AW.n+"-"+AV.n+")/"+AV.n;},fn:AJ,fn2:AL}];AK.forEach(function(AV){AO.addSeparator();AT(AV.n(AR,AQ),AR,AQ,AV.fn,AV.fn2);AT(AV.n(AQ,AR),AQ,AR,AV.fn,AV.fn2);});}return AO;},getCalculationMetricEditor:function L(AQ,AR,AP){var AK=[{n:"",css:"operator-plus",funcType:n.FunctionPlus},{n:"",css:"operator-minus",funcType:n.FunctionMinus},{n:"",css:"operator-multiply",funcType:n.FunctionTimes},{n:"",css:"operator-divide",funcType:n.FunctionDivide},{n:"%",css:"operator-percent-diff",funcType:n.FunctionMinus,funcType2:n.FunctionDivide}],AL={m1:AR.did,m2:AQ[0].did,operator:n.FunctionPlus,u1:{id:AR.did,type:4},u2:null},AJ=function(AS){return{}.hasOwnProperty.call(AS,"cst");},AO=function(AS){return typeof AS==="string"&&!!AS.length&&!isNaN(Number(AS));};var AI="this.parent.popupConfig.valid || this.selectedIndex !== -1 || (!!this.selectedNode && this.selectedNode.innerHTML.length === 0)",AN=function AN(){var AS=this.parent.popupConfig;if(AS){AS.set("okEnabled",this[this.editableSlot].innerHTML.length!==0);}};return new mstrmojo.ui.menus.EditorConfig({cssClass:"Calculation-MenuEditor",contents:[AD({metrics:AQ,value:AL.m1,propName:"u1",optionValueField:"did",bindings:{valid:AI},postkeyup:AN}),{scriptClass:"mstrmojo.ButtonListHoriz",items:AK,selectedIndex:0,postselectionChange:function AM(){this.parent.data.set("operator",this.selectedItem.funcType);this.parent.data.set("operator2",this.selectedItem.funcType2);}},AD({metrics:AQ,value:null,propName:"u2",optionValueField:"did",bindings:{valid:AI},postkeyup:AN})],data:AL,okEnabled:false,bindings:{valid:function(){var AU=this.data.u1,AT=this.data.u2,AV=this.data.operator;if(!AU||!AT||!AV){return false;}var AS=!(AJ(AU)&&AJ(AT))&&(!AJ(AU)||AO(AU.cst))&&(!AJ(AT)||AO(AT.cst));this.set("okEnabled",AS);return AS;}},fnOk:function(AS){return AP(AS.u1,AS.u2,AS.operator,AS.operator2);}});},getFilterEditor:function F(AJ){var AO="dfe",AN,AK={},AM=AJ.datasetFilter;function AL(AP){if(!AP.et){return false;}if(AP.et===AF.RLS){return false;}if(AP.p){return false;}if(AP.cs&&AP.cs.some(function(AQ){return !!AQ.p;})){return false;}return !AP.nds||AP.nds.every(AL);}function AI(){q.forEach(AJ.att,function(AQ){if(AQ.t!==12||AQ.da){return ;}AK[AQ.did]={did:AQ.did,n:AQ.n,t:AQ.t,fs:AQ.fs};});q.forEach(AJ.mx,function(AQ){if(AQ.um){return ;}AK[AQ.did]={did:AQ.did,n:AQ.n,t:AQ.t};});if(AM){mstrmojo.expr.findTargets(AM,"did",AK);}var AP={expr:X.clone(AM),targets:X.valarray(AK)};AN=AO&&window.mstrmojo&&mstrmojo.all[AO];if(!AN){AN=mstrmojo.insert({id:AO,scriptClass:"mstrmojo.fe.ReportFilterEditor",showLimits:false,objectBrowsingEnabled:true});}if(AJ.zIndex){AN.set("zIndex",AJ.zIndex);}AN.set("title",mstrmojo.desc(12138,"Dataset Filter #").replace("#",AJ.datasetName));AN.set("onSave",AJ.fnOk);AN.set("model",AP);AN.onUpdateBrowseElementsParams=AJ.browseParam;AN.open();}if(AM&&!AL(AM)){mstrmojo.warn(mstrmojo.desc(13527,"The filter contains an advanced condition that cannot be edited."),{confirmBtn:{t:mstrmojo.desc(13528,"Clear existing filter"),fn:function(){AM=null;AI();}}},{title:mstrmojo.desc(11812,"Notification")});}else{AI();}},getCfgForAddUnitFromAllObject:function(AI,AJ){var AK=null,AL=null,AM=[],AN=function(AO,AP){if(!AP){return false;}return q.find((AP.att||[]).concat(AP.mx||[]),"did",AO.did)>-1;};X.forEach(AJ,function(AP,AO){if(AP.idd){AK=AO;AL=AP;return false;}return true;});if(!AK){AK="$GUID_141";AM.push({act:"createDataset",mgo:true,prm:true,name:mstrApp.projectName,idd:true,newObjectIds:[AK]});}q.forEach(AI,function(AO){if(!AN(AO,AL)){AM.push({act:"addUnitToDataset",dsid:AK,unitId:AO.did,unitType:AO.t});}});return{actions:AM,dsid:AK};},getAggregateByMenu:function m(AN,AL){var AJ=new mstrmojo.ui.menus.MenuConfig(),AK=function(AR,AQ){var AT,AS;if(AQ){var AP=AR.mexp.args[0];AT=AP.did;AS=AP.t;}else{AT=AR.did;AS=AR.t;}return{did:AT,t:AS};},AI=this.getAvailableShortcutMetricFunctionsGroup(AN),AO=AN.mexp?AN.mexp.ft:null,AM=AN.mexp&&this.isAmongFunctions(AO,AI);AI.forEach(function(AP,AQ){if(AQ!==0){AJ.addSeparator();}AP.forEach(function(AR){AJ.addMenuItem(AR.n,"",function(){AL(AK(AN,AM),AR.t);});});});return AJ;},showObjectPicker:function l(AJ,AI){var AK="object_picker";return function(){var AL=mstrmojo.all[AK];if(!AL){AL=new mstrmojo.vi.ui.editors.ObjectPicker({id:AK});if(AI){AL.supportedTypes=q.hash(AI);AL.ob.browsableTypes="8,"+AI.join(",");}AL.render();}else{if(AI){AL.supportedTypes=q.hash(AI);AL.ob.browsableTypes="8,"+AI.join(",");}AL.browse();}AL.OKFn=AJ||mstrmojo.emptyFn;AL.open();};},generateNumberFormat:function t(AN){var AI=T.DefaultFormat.FormattingNumber,AJ=T.NumberFormatCategory,AL=AN||{},AK=AL.nct,AM=AK===AJ.General&&AL.nfs==="General";return{category:(AK===undefined||AM)?AJ.Automatic:AK,decimalPlaces:AL.ndp===undefined?2:AL.ndp,thousandSeparator:AL.nth?-1:0,currencySymbol:AL.ncs||AI.CurrencySymbol,currencyPosition:AL.ncp||AI.CurrencyPosition,format:AL.nfs||"",negativeNumbers:AL.nnn||AI.NegativeNumbers};},getNumberFormatEditor:function x(AL,AK,AJ){var AI=this.generateNumberFormat(AK),AM=X.clone(AI),AO=X.clone(AI);return new mstrmojo.ui.menus.EditorConfig({data:AM,bindings:{okEnabled:function(){return !(this.data.category===AO.category&&this.data.format===AO.format);}},cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:AI,myData:AM,oldData:AO,adjustAfterCategoryChange:function(){this.parent.adjustCornersForPopupOverflow();}}],fnOk:function AN(AP){if(!(AP.category===AO.category&&AP.format===AO.format)){return AJ(AP,AO);}}});},getHighlightElementHandler:function(AK,AJ,AI){return function(){D.toggleClass(AJ,AI||"open",AK);};},getConfDataTypeMenuCfg:function AA(AI,Ad,AV,Aq){var Al="ToString",Ac="ToNumber",Aa="ToDateTime",AU="keepOriginal",AL="Default",Am={ToString:3,ToNumber:2,ToDateTime:8},AQ={ToString:"D1ED29645DEC4DBF99E8E09ED939074B",ToNumber:"399C3EC1041643F1ACE8F2A92B1C1F2F",ToDateTime:"0A558C7295DE42DAA8C5594F1724563F"},AO="_pattern",Ao="_func",AY="_bft",At="_state",Ar={UNCHANGED:0,TO_CREATE:1,TO_UPDATE:2},AN={n:"Default",v:"Default"},Aj=[{n:"MM-DD-Year",v:"MM-DD-Year"},{n:"MM/DD/Year",v:"MM/DD/Year"},{n:"DD-MM-Year",v:"DD-MM-Year"},{n:"DD/mm/Year",v:"DD/mm/Year"},AN],AK=[{n:mstrmojo.desc(13772,"Keep Original"),v:AU},{n:mstrmojo.desc(12276,"String"),v:Al},{n:mstrmojo.desc(2052,"Date"),v:Aa},{n:mstrmojo.desc(3434,"Number"),v:Ac}],AT=X.clone(AK).slice(1),Ab=Ad.fs.filter(function(Av){return Ad.da||Av.obf;}),Au=Ab.length>1,AW=Ab.length>5,AP=false,Ak=false,Ae=[],Ai=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13773,"Select Data Type for New Attribute:")}],As={okEnabled:false},An=function(){var Av=false;Ab.forEach(function(Aw){Av=Av||(As[Aw.fnm+Ao+At]!==Ar.UNCHANGED)||(As[Aw.fnm+AO+At]!==Ar.UNCHANGED);});return Av;},Af=function(Ax,Aw){var Av=0;if(Ax.da){q.forEach([Al,Aa,Ac],function(A0,Ay){var Az=new RegExp("^\\s*"+A0+"\\s*(<.*>)?\\s*\\((.+)\\)\\s*$","i").exec(Aw.f);if(Az&&Az[2]){Av=Ay+1;return false;}});}return Av;},Ah=function(Ax,Aw){var Ay=AL;if(Ad.da){var Av=new RegExp("^\\s*"+Aw+'\\s*<\\s*Pattern\\s*=\\s*"(.+)"\\s*>.*$',"i").exec(Ax.f);if(!mstrmojo.string.isEmpty(Av&&Av[1])){Ay=Av[1];}}return Ay;},Ag=function(){return AW?this.parent.parent.parent:(Au?this.parent.parent:this.parent);},AZ=function(Av){if(AW){Av.formList.updateScrollbars();}},AM=function(A2,A3,A1){var Av=A3.fnm,Ay=AW?A2.formList[A3.fnm+AO]:A2[A3.fnm+AO],Az=Au?Ay.children[1]:Ay,A0=As[Av+Ao],Ax=AP&&(A0===Aa||A0===Al),Aw=Ay.visible!==Ax;if(Aw){Ay.set("visible",Ax);if(Ax){AZ(A2);}else{Az.hideTooltip();}}if(A1){Az.set("text",Ah(A3,A0));Az.set("items",A0===Aa?Aj:[AN]);}},AX=function(Av){var Aw=false;Ab.forEach(function(Ax){if(As[Ax.fnm+Ao]===Aa||As[Ax.fnm+Ao]===Al){Aw=true;return false;}});Av.advancedLabel.set("visible",Aw);},AJ=function(Ay,Aw,Az,Av){return{scriptClass:"mstrmojo.ui.Pulldown",items:Ay,alias:Az.fnm+Ao,selectedIndex:Aw,onPopupWidgetOpened:function(){AZ(Ag.call(this));},onitemSelected:function Ax(A4,A2){var A3=Ag.call(this),A5=A3.data,A6=Az.fnm,A1=A4.v,A0=function(A7){if(A7){return(Ay.length===3?Ar.TO_UPDATE:Ar.TO_CREATE);}return Ar.UNCHANGED;};A5.set(A6+Ao,A1);A5.set(A6+AO,Ah(Az,A1));A5.set(A6+AY,A1===AU?Az.bftp:Am[A1]);A5.set(A6+Ao+At,A0(A2!==Aw));A5.set("okEnabled",An());AM(A3,Az,true);AX(A3);}};},AS=function(Ax,Ay,Av){return{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:Ax.fnm+AO,useRichTooltip:true,visible:Av,allowCustomText:true,allowEmptyText:true,onPopupWidgetOpened:function(){AZ(Ag.call(this));},customizeSearchResult:function(Az){if(q.find(Az,"v","Default")===-1&&this.items.length>0){Az.push(AN);}},onclick:function(Az){mstrmojo.ui.SearchablePulldown.prototype.onclick.call(this,Az);this.set("isEditing",true);},updateData:function(A1){var Az=Ag.call(this),A0=Az.data,A2=Ax.fnm;A0.set(A2+AO,A1);A0.set(A2+AO+At,Ay!==A1?Ar.TO_UPDATE:Ar.UNCHANGED);A0.set("okEnabled",An());},onitemSelected:function Aw(A0,Az){if(A0){this.updateData(A0.v);}},onkeyup:function(Az){mstrmojo.ui.SearchablePulldown.prototype.onkeyup.call(this,Az);var A0=this[this.editableSlot],A1=A0.innerText||A0.textContent;this.updateData(A1);},updateTooltipConfig:function(A0){this.tooltipOpenDelay=A0?500:0;var Az=V.position(this.domNode);this.richTooltip={content:mstrmojo.desc(14114,'Pattern determines the formatting for the resulting string of characters. You can use the custom numeric, date, and time formatting symbols. <br/> Example: if pattern is defined as "0,000.00" for "1001", it returns the string "1,001.00"'),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:Az.y-2,left:Az.x+Az.w+10};}};},Ap=function(A3,A2,Av,Aw,A1){var Ay=Af(A3,A2),A0=Ah(A2,AK[Ay].v),Ax=A2.fnm,Az=AK;if(Ay>0){Az=AT;Ay--;}Aw[Ax+AO]="";Aw[Ax+Ao]="";Aw[Ax+AY]="";Aw[Ax+Ao+At]=Aw[Ax+AO+At]=Ar.UNCHANGED;if(A1){Av.push({scriptClass:"mstrmojo.HBox",cssClass:"func-input",alias:Ax+Ao,children:[{scriptClass:"mstrmojo.Label",text:Ax,useRichTooltip:true,updateTooltipConfig:function(A6){this.tooltipOpenDelay=A6?500:0;var A5=this.domNode;var A4=V.position(A5);if(A5.scrollWidth>A5.offsetWidth){this.richTooltip={content:A5.innerText,posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-V",top:A4.y-A4.h-10,left:A4.x-10};}}},AJ(Az,Ay,A2,true)]});Av.push({scriptClass:"mstrmojo.HBox",cssClass:"pattern-input",alias:Ax+AO,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12078,"Pattern")},AS(A2,A0,true)]});}else{Av.push(AJ(Az,Ay,A2,false));Av.push(AS(A2,A0,false));}};q.forEach(Ad.fs,function(Av){if(AI.als&&AI.als.links[Ad.did+" "+Av.fid]){Ak=true;return false;}});if(Au){Ab.forEach(function(Av){Ap(Ad,Av,AW?Ae:Ai,As,true);});}else{Ap(Ad,Ab[0],Ai,As,false);}if(AW){Ai.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"formList",cssClass:"formList",children:Ae});}Ai.push({scriptClass:"mstrmojo.Label",cssClass:"advancedLabel",alias:"advancedLabel",allowHTML:true,text:"<span>"+mstrmojo.desc(702,"Advanced")+"</span>",onclick:function(){var Aw=this.parent,Ax,Av,Ay=true;AP=!AP;D.toggleClass(this.domNode,"expanded",AP);Ab.forEach(function(Az){AM(Aw,Az,false);Ax=AW?Aw.formList[Az.fnm+AO]:Aw[Az.fnm+AO];Av=Au?Ax.children[1]:Ax;if(Ax.visible&&Ay&&!AW){Ay=false;Av.showTooltip();}});}});return new mstrmojo.ui.menus.EditorConfig({data:As,cssClass:"ConfDataType-MenuEditor",contents:Ai,onOpen:function(){AZ(this);},bindings:{okEnabled:"this.data.okEnabled"},fnOk:function AR(Ax){var Av=[],Az=[],Aw=false,Ay=function(A2,A3,A1){var A5=[],A4=function(A6){var A7=A6.ftk&&A6.ftk.slice(2,-2);if(!A7){return null;}while((A7.shift()).v!=="("){}return A7;},A0=A4(A1)||[z(Ad,A1)];A5.push({v:"!",tp:33,lv:4});if(A2!==AU){A5.push({v:A2,oi:{did:AQ[A2],t:11,st:2816,n:A2}});if(!mstrmojo.string.isEmpty(A3)&&A3!==AL&&(A2===Aa||A2===Al)){A5.push({v:'<Pattern="'+A3+'">(',tp:"2",lv:1});}else{A5.push({v:"(",tp:"2",lv:1});}A5=A5.concat(A0);A5.push({v:")",tp:"2",lv:1});}else{A5=A5.concat(A0);}A5.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:A5});};if(Ak){Aw=true;}else{Ab.forEach(function(A0){if(Ax[A0.fnm+Ao+At]===Ar.TO_CREATE){Aw=true;return false;}else{if(Ax[A0.fnm+Ao+At]===Ar.TO_UPDATE||(Ax[A0.fnm+AO+At]===Ar.TO_UPDATE&&(Ax[A0.fnm+Ao]===Aa||Ax[A0.fnm+Ao]===Al))){Az.push(A0);}}});}if(Aw){Ab.forEach(function(A0){Av.push({n:A0.fnm,formula:Ay(Ax[A0.fnm+Ao],Ax[A0.fnm+AO],A0),bft:Ax[A0.fnm+AY]});});Aq(Aw,Av);}else{if(Ad.da){W(AI.mid,Ad.did,Az,function(A0){A0.forEach(function(A1){Av.push({did:A1.fid,formula:Ay(Ax[A1.fnm+Ao],Ax[A1.fnm+AO],A1),bft:Ax[A1.fnm+AY]});});Aq(Aw,Av);});}}}});},getCreateTimeDAEditorCfg:function O(AM,AL){var AK=function(AQ){var AR=8,AS=1,AP=q.filter(AQ.fs,function(AT){return(AQ.da||AT.obf)&&(AT.bftp===AR||AT.bftp===AS);}),AO=q.find(AP,"idf",true);return AP[AO>=0?AO:0];},AI=AK(AM);if(!AI){return null;}return new mstrmojo.ui.menus.EditorConfig({data:{okEnabled:false},cssClass:"CreateTimeAttribute-MenuEditor",contents:[{scriptClass:"mstrmojo.ui.CheckList",alias:"time_type",items:[{n:mstrmojo.desc(873,"Year"),v:"Year"},{n:mstrmojo.desc(10051,"Quarter of Year"),v:"QuarterOfYear"},{n:mstrmojo.desc(10050,"Quarter"),v:"Quarter"},{n:mstrmojo.desc(10049,"Month of Year"),v:"MonthOfYear"},{n:mstrmojo.desc(871,"Month"),v:"Month"},{n:mstrmojo.desc(10047,"Week of Year"),v:"WeekOfYear"},{n:mstrmojo.desc(10048,"Week"),v:"Week"},{n:mstrmojo.desc(11608,"Day of Year"),v:"DayOfYear"},{n:mstrmojo.desc(10046,"Day of Month"),v:"DayOfMonth"},{n:mstrmojo.desc(10045,"Day of Week"),v:"DayOfWeek"}],onchange:function AJ(){var AO=false;X.forEach(this.selectedIndices,function(AP){if(AP){AO=true;return false;}});this.parent.data.set("okEnabled",AO);}}],bindings:{okEnabled:function(){return this.data.okEnabled;}},fnOk:function AN(AT,AU){var AY=AU.time_type,AX=AY.selectedIndices,AV=AY.items,AS=[],AO=[],AP="@form",AR={Year:"6F7DF5F8449111D5BEA300B0D01A55EF",Quarter:"6F7DF5F7449111D5BEA300B0D01A55EF",Concat:"6F7DF5FF449111D5BEA300B0D01A55EF",QuarterStartDate:"59E10CE2ADDD4A6DAC2416A72999A9ED",Month:"6F7DF5F6449111D5BEA300B0D01A55EF",ToString:"D1ED29645DEC4DBF99E8E09ED939074B",MonthStartDate:"7C63D4E70B2741C3A5B54A2EFD40961B",Week:"6F7DF5F5449111D5BEA300B0D01A55EF",WeekStartDate:"44681336D0DB4E43AC333FFB3CC4400D",DayOfMonth:"6F7DF5F2449111D5BEA300B0D01A55EF",DayOfWeek:"6F7DF5F3449111D5BEA300B0D01A55EF",DayOfYear:"6F7DF5F4449111D5BEA300B0D01A55EF"},AW=function(AZ){switch(AZ){case"Year":return{ID:["Year","(",AP,")"]};case"Quarter":return{ID:["Year","(",AP,") * 10 + ","Quarter","(",AP,")"],DESC:["Concat",'("Q", ',"Quarter","(",AP,")",', ", ", ',"Year","(",AP,"))"],DATE:["QuarterStartDate","(",AP,")"]};case"QuarterOfYear":return{ID:["Quarter","(",AP,")"],DESC:["Concat",'("Q", This@ID)']};case"Month":return{ID:["Year","(",AP,") * 100 + ","Month","(",AP,")"],DESC:["ToString",'<Pattern="mmm yyyy">(',AP,")"],DATE:["MonthStartDate","(",AP,")"]};case"MonthOfYear":return{ID:["Month","(",AP,")"],DESC:["ToString",'<Pattern="mmmm">(',AP,")"]};case"Week":return{ID:["Year","(",AP,") * 100 + ","Week","(",AP,")"],DESC:["Concat",'("W", ',"Week","(",AP,'), ", ", ',"Year","(",AP,"))"],DATE:["WeekStartDate","(",AP,")"]};case"WeekOfYear":return{ID:["Week","(",AP,")"]};case"DayOfMonth":return{ID:["DayOfMonth","(",AP,")"]};case"DayOfWeek":return{ID:["DayOfWeek","(",AP,")"],DESC:["ToString",'<Pattern="ddd">(',AP,")"]};case"DayOfYear":return{ID:["DayOfYear","(",AP,")"]};}},AQ=function(AZ,Ab,Ad){var Ac=[{v:"!",tp:33,lv:4}],Aa;Ad.forEach(function(Af,Ae){if(Af===AP){Ac.push(z(AZ,Ab));}else{Aa=AR[Af];if(Aa){Ac.push({v:Aa,oi:{did:Aa,t:11,st:2816,n:Aa}});}else{Ac.push({v:Af,tp:"2",lv:1});}}});Ac.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Ac});};X.forEach(AX,function(AZ,Aa){if(AZ){AO=[];X.forEach(AW(AV[Aa].v),function(Ab,Ac){AO.push({n:Ac,formula:AQ(AM,AI,Ab),bft:(Ac==="DATE"?8:0)});});AS.push({isTokenStream:true,forms:AO,name:AM.n+" ("+AV[Aa].n+")"});}});return AL(AS);}});},RefreshAndCloseAllObjectBrowserCallback:function(AJ,AI){return mstrmojo.func.wrapMethods(AI.getDatasetsUpdateCallback(),{success:function(){if(q.find(AJ,"act","createDataset")!==-1){AI.controller.datasetsPanel.set("allObjectBrowserOpened",false);}}});},getUnitFromDataset:function a(AJ,AL,AI){var AK=null;X.forEach(AJ,function(AN){var AM=AN.att||[];if(AI===4){AM=AN.mx||[];}q.forEach(AM,function(AO){if(AO.did===AL){AK=AO;return false;}});if(AK){return false;}});return AK;},getDatasetFromId:function P(AI,AJ){var AK=null;X.forEach(AI,function(AL){if(AL.did===AJ){AK=AL;return false;}});return AK;},getDatasetFromAttributeId:function P(AI,AJ){var AK=null;X.forEach(AI,function(AL){if(q.find(AL.att,"did",AJ)>=0){AK=AL;return false;}});return AK;},getSortedDatasetUnits:function E(AI){var AJ=function AJ(AK){return AK.t===U.DssTypeMetric?2:1;};AI=AI.concat();AI.sort(function(AN,AL){var AO=AJ(AN)-AJ(AL),AM=AN.n.toUpperCase(),AK=AL.n.toUpperCase();return AO!==0?AO:(AM!==AK?AM.localeCompare(AK):AN.n.localeCompare(AL.n));});return AI;},getUnitCssClass:function(AJ){var AI=AJ.t;if(AJ.fs&&AJ.fs.length&&AJ.fs.some(function(AK){return AK.fgr>0;})){AI+="g";}else{if((AJ.dm||AJ.um)||AJ.da){AI+="d";}else{if(AJ.de){AI+="de";}}}if((AJ.t===47&&AJ.st===12033)||(AJ.t===12&&AJ.st&&AJ.st===3076)){AI+=(" st"+AJ.st);}return"ic"+AI;},hasMultiForms:function k(AJ,AI){return o.getFormsByAttrId(AJ,AI).length>1;},getDisplayFormsMenu:function G(AU,AS,AM,AR){var AQ=[],AT=[],AL=[],AO=[{n:mstrmojo.desc(2411,"Off"),v:0},{n:mstrmojo.desc(2410,"On"),v:1},{n:mstrmojo.desc(8504,"Form Name Only"),v:2},{n:mstrmojo.desc(8505,"Show Attribute Name Once"),v:3},{n:mstrmojo.desc(4531,"Automatic"),v:4}];var AN=AS.model.data,AI=AN.gts,AP;q.forEach((AI.row||[]).concat(AI.col||[]),function(AV){if(AV.id===AU.did){AT=AT.concat(AV.fs);}});AP=o.getFormsByAttrId(AU.did,AM);q.forEach(AP||[],function(AW){var AX=AW.fid;if(q.find(AQ,"id",AX)<0){AQ.push({id:AX,n:AW.fnm});var AV=q.find(AT,"id",AX);if(AV>-1){AL[AQ.length-1]=true;}}});return new mstrmojo.ui.menus.EditorConfig({data:{item:AU,oldSelected:X.copy(AL,{})},contents:[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:AQ,selectedIndices:AL},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11918,"Display attribute form names:")},{alias:"longNames",scriptClass:"mstrmojo.ui.Pulldown",items:AO,selectedIndex:q.find(AO,"v",AN.lnm||0),onitemSelected:function AJ(AV){this.v=String(AV.v);}}],okBtnText:mstrmojo.desc(1442,"Ok"),fnOk:function AK(Aa,Ae){var AZ=Ae.fs,AX=AZ.selectedIndices,Ac=AZ.items,Ai=[],Ab=[],Af=[];if(!AZ.getSelectedItems().length){mstrmojo.alert("Please select at least one form!");return ;}var AW=Aa.oldSelected,Ah=AX,AY,Ad={},Ag={};for(AY=0;AY<Ac.length;AY++){if(AW[AY]&&!Ah[AY]){Ad[AY]=true;}else{if(!AW[AY]&&Ah[AY]){Ag[AY]=true;}}}X.forEach(Ad,function(Aj,Ak){if(Aj){Ab.push({act:"removeForm",unitId:AU.did,attFormId:Ac[Ak].id});}});var AV=AS.model.data.gts;(AV.row||[]).concat(AV.col||[]).forEach(function(Aj){if(Aj.id===AU.did){(Aj.fs||[]).forEach(function(Ak){if(q.find(AQ,"id",Ak.id)<0){Ab.push({act:"removeForm",unitId:AU.did,attFormId:Ak.id});}});}});X.forEach(Ag,function(Aj,Ak){if(Aj){Ai.push({act:"addForm",unitId:AU.did,attFormId:Ac[Ak].id,unitPos:0});}});Af.push({act:"putProperties",prs:"Template Formatting",pr:"LongNames",v:Ae.longNames.v});if(AR){AR([{act:"updateTemplate",keyContext:AS.k,partialRetrieval:{nodes:[AS.k]},actions:Ab.concat(Ai).concat(Af)}]);}}});},getAttributeLinkMenu:function d(AU,AX,AS,AW,AN){var AY=-2147483648,AP=AW.datasets,AQ=AP[AS],AV=AQ.tables||[],AI={},AR=[],AL=(AX.fs&&AX.fs[0])||{},AT=[],AO=779,AK=AX.art>1,AJ=!AK&&X.keyarray(AP).length>1,AM=function(){mstrmojo.vi.ui.editors.AttributeLinkEditor.open({attribute:AX,docModel:AW,datasetId:AS});};if((AQ.st!==AO)||AV.length<=1||AX.da){if(AJ){AU.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AM);}return ;}q.forEach(AQ.att,function(Ab){var Ac=true,Aa=null,AZ=(Ab.fs&&Ab.fs[0])||{};if(Ab.da){return ;}if(AL.der===AY||AZ.der===AY||AL.fgr===-1||AZ.fgr===-1||AL.ftr===-1||AZ.ftr===-1){return ;}if(AL.fgr&&AZ.fgr&&AL.fgr!==AZ.fgr){return ;}if(AL.ftr&&AZ.ftr&&AL.ftr!==AZ.ftr){return ;}q.forEach(AV,function(Ad){var Ae=q.find(Ad.attRefs,"did",AX.did),Af=q.find(Ad.attRefs,"did",Ab.did);if(Ae>=0&&q.indexOf(AR,Ad.did)<0){AR.push(Ad.did);}if(Af>=0){Aa=Ad.did;}if(Ae>=0&&Af>=0){Ac=false;}});if(Ac&&!Ab.hide){AI[Ab.did]=Aa;AT.push(Ab);}});if(AT.length>0&&AQ.hcs!==true){AU.addEditorMenuItem(mstrmojo.desc(13172,"Map Attributes"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mapAttribute",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:AT,listHooks:{select:function AZ(Aa,Ab){AW.warnForEditStandaloneDS(AQ,function(){q.forEach(AR,function(Ac){I({dsid:AS,srcId:AX.did,srcTableId:Ac,tgtId:Ab.did,tgtTableId:AI[Ab.did]},AW,AN);});});}}}]}]});});}if(AJ){AU.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AM);}},isDocumentLevelItem:function r(AI){return AI&&(AI.um||AI.da||(AI.t===47&&AI.st===12033));},isLegalObjectName:function Q(AI){var AJ=/["\[\]\\]/g;if(AI.match(AJ)){return false;}return true;},validateName:function f(AJ,AK,AI){if(this.isLegalObjectName(AJ)){AK();}else{mstrmojo.alert(mstrmojo.desc(8622,"The # cannot contain the reserved characters ##.").replace("##","'[', ']', '\"' and '\\'").replace("#",mstrmojo.desc(945,"Name")),AI,mstrmojo.desc(1388,"Rename"));}},hasCGorCon:function AH(AI){return AI.att.some(function(AK){var AM=(AK.t===1||AK.t===47),AL=(AK.t===12&&AK.de),AJ=(AK.t===47&&AK.st===12033);return(AM&&!AJ||AL);});},hasOldDEOverDatasets:function(AL,AK){var AJ=false,AI;X.forEach(AK,function(AM){AI=q.find((AM.att||[]),"did",AL);if(AI!==-1&&AM.att[AI].de){AJ=true;return false;}});return AJ;},getMarkGeoRoleEditorCfg:function AE(AI,Au,Ac,AZ,A3,A5){var AY=268435456,A0=536870912,AN=1073741824,Am=268435456,Ax=805306368,As=805306368,Ag=1879048192,A4=-2147483648,Av=0,Aw=1,AP=2,AX=3,Ab=4,AV=5,A2=6,AS=7,Ae=8,Ad=9,Ao=10,AL=2,Al=3,At={v:Av,n:mstrmojo.desc(2057,"None")},A6={v:AX,n:mstrmojo.desc(7674,"Country"),der:AY},Ar={v:AP,n:mstrmojo.desc(7676,"State"),parents:[A6],der:A0},AT={v:Ad,n:mstrmojo.desc(12919,"County"),parents:[A6,Ar]},Ay={v:Aw,n:mstrmojo.desc(7675,"City"),parents:[A6,Ar],der:AN},Ah={v:Ae,n:mstrmojo.desc(7677,"Zip Code"),parents:[A6,Ar,Ay]},Aa={v:AV,n:mstrmojo.desc(7696,"Latitude")},Ap={v:A2,n:mstrmojo.desc(7697,"Longitude")},AW={v:Ab,n:mstrmojo.desc(7675,"City")+", "+mstrmojo.desc(7676,"State")},Ak={v:Ao,n:mstrmojo.desc(12973,"Area Code")},An={v:AS,n:mstrmojo.desc(2056,"Custom")},AU={ID:[At,A6,Ar,AT,Ay,Ah,Aa,Ap,AW,Ak,An],ID_NUMERIC:[At,Ah,Ak,Aa,Ap],NON_ID:[At,A6,Ar,AT,Ay,Ah,AW,Ak,An],NON_ID_NUMERIC:[At,Ah,Ak]},Ai=q.filter(Au.fs,function(A7){return(A7.bftp===AL||A7.bftp===Al)&&A7.der!==A4;});var Aq=(Ai.length>1),AK=q.find(Ai,"idf",true),AM=(AK===-1?0:AK),Aj=Ai[AM],AR,AJ,Af,AO=[],AQ=function(A7){var A8=(A7.idf?"ID":"NON_ID")+(A7.bftp===AL?"_NUMERIC":"");return AU[A8];},A1=function(A8,A7){return q.find(AQ(A7),"v",A8);};if(Ai.length===0||q.find(Au.fs,"fgr",-1)!==-1||Aj.der===A4){return null;}q.forEach(Ai,function(A9,A7){var A8=X.clone(A9);A8.n=A8.fnm;AO.push(A8);if(A9.fgr){Aj=A8;AM=A7;}});AR=Aj.fid;Af=Aj.fgr||0;AJ=A1(Af,Aj);return new mstrmojo.ui.menus.EditorConfig({data:{item:Au,geoForm:Aj,geoRole:Af},cssClass:"MarkGeoRole-MenuEditor",contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13522,"Select Attribute Form:"),visible:Aq},{scriptClass:"mstrmojo.ui.Pulldown",items:AO,selectedIndex:AM,alias:"formList",visible:Aq,onitemSelected:function Az(A9){var A7=this.parent.data,A8=this.parent.geoRoleList;if(A7.geoForm.fid!==A9.fid){A7.set("geoForm",A9);A7.set("geoRole",A9.fgr);A8.set("items",AQ(A9));A8.set("selectedIndex",A1(A9.fgr,A9));}}},{scriptClass:"mstrmojo.ToolSeparator",visible:Aq,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13523,"Select Geographic Type:")},{scriptClass:"mstrmojo.ui.Pulldown",items:AQ(Aj),selectedIndex:AJ,alias:"geoRoleList",onitemSelected:function Az(BD){var BC=this.parent,A7=BC.data,BE=BC.geoDrvList;var A9=[],BB=[],A8=Aj.der,BA;A7.set("geoRole",BD.v);q.forEach(BD.parents,function(BF,BG){BA=BF;A9.push({n:BA.n,der:BA.der});if((A8&BA.der)!==0){BB[BG]=true;}});BE.set("items",A9);BE.set("selectedIndices",BB);q.forEach(["geoDrvSeparator","geoDrvLabel","geoDrvList"],function(BF){BC[BF].set("visible",A9.length>0);});}},{scriptClass:"mstrmojo.ToolSeparator",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},alias:"geoDrvSeparator"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13524,"(Optional) Create Additional Attributes:"),alias:"geoDrvLabel"},{scriptClass:"mstrmojo.ui.CheckList",alias:"geoDrvList"}],fnOk:function(BA,A9){var A7=function(BG){var BF=function(BK){var BL="<mpcs>";q.forEach(BK,function(BM){BL+='<mpc did="'+BM.did+'" n="'+BM.n+'" georole="'+BM.georole+'" drvflg="'+BM.drvflg+'" />';});BL+="</mpcs>";return BL;},BB=function(BK,BM,BO,BL){var BN=function(BS,BP,BR){var BQ=R(BG,BS,BP),BT=h(BQ,BR);return BT&&BT.did;};A3.forEach(function(BP,BQ){var BR=BN(BP.did,Au.did,BM.fid);if(BR){BK[BQ]=BK[BQ]||[];BK[BQ].push({did:BR,n:BM.fnm,georole:BO,drvflg:BL});}});},BD=[],BJ=[],BH=A9.geoDrvList,BC=0,BE=false,BI={2:Am,1:Ax,9:As,8:Ag}[BA.geoRole]||0;X.forEach(BH.selectedIndices,function(BL,BK){if(BL){BC|=BH.items[BK].der;}});BC&=BI;if(Aj.fgr!==BA.geoRole||Aj.fid!==BA.geoForm.fid||Aj.der!==BC){if(Aq&&Aj.fid!==BA.geoForm.fid){if(Aj.fgr!==Av){BB(BJ,Aj,Av,0);if(Aj.der>0){BE=true;}}}if(BA.geoForm.fgr!==BA.geoRole||BA.geoForm.der!==BC){BB(BJ,BA.geoForm,BA.geoRole,BC);if((BC&BA.geoForm.der)!==BA.geoForm.der){BE=true;}}if(BJ.length>0){BJ.forEach(function(BL,BK){BD.push({act:"changeEMMAMapping",dsid:Ac,tbid:A3[BK].did,mapping:BF(BL)});});A5(BD,BE);}}},A8=function(){C(AI.mid,Ac,{success:A7});};if(!AZ){mstrmojo.warn(mstrmojo.desc(13525,"Modifications to this dataset will affect other reports, documents, and dashboards that share the dataset. Do you want to continue?"),{},{buttons:[u(mstrmojo.desc(219,"Yes"),function(){A8();},true,{width:"60px"}),u(mstrmojo.desc(221,"Cancel"),function(){})]});}else{A8();}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.threshold.ThresholdModel","mstrmojo.threshold.SimpleThresholdEditor","mstrmojo.threshold.AdvancedThresholdEditor");var E=mstrmojo.hash,A="mstrmojo-simple-threshold-editor",C="mstrmojo-advanced-threshold-editor",G=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES;mstrmojo.threshold.ThresholdController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdController",metricId:undefined,data:undefined,model:undefined,targets:undefined,editor:undefined,messageId:undefined,datasets:undefined,dataService:undefined,onSubmitActions:mstrmojo.emptyFn(),onSaveThresholds:mstrmojo.emptyFn(),onLoadThresholds:mstrmojo.emptyFn(),supportsFeature:function F(H){return true;},init:function D(H){this._super(H);this.model=new mstrmojo.threshold.ThresholdModel({controller:this});},openEditor:function B(){var L=this.data;if(!L){throw new Error("Visualization data not provided.");}var I=this.metricId,H=this.objectType,M=this.model,P=this.messageId,N;M.set("data",E.clone(L));M.metricId=I;M.objectType=H;var O=M.isAdvanced(I),J=M.editorMode,K=J===G.SIMPLE_EDITOR;if(J===G.ADVANCED_EDITOR||(!K&&O)){N=mstrmojo.all[C]||new mstrmojo.threshold.AdvancedThresholdEditor({id:C,onUpdateBrowseElementsParams:function Q(T){var S,R=this.controller.datasets,U=function(V){return V.did===T.attributeID;};for(S in R){if(R[S].att.filter(U).length>0){T.datasetID=S;break;}}T.messageID=P;T.templateNodeKey=L.k;}});}else{if(O){M.clearData();}N=mstrmojo.all[A]||new mstrmojo.threshold.SimpleThresholdEditor({id:A});}this.editor=N;N.set("model",M);N.set("controller",this);N.set("metricId",I);N.set("objectType",H);N.set("title",this.title);N.set("targets",this.targets);N.open();this.addDisposable([M,N]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.models.template.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.Button","mstrmojo.Label","mstrmojo.ui.CheckList","mstrmojo.ui.Pulldown","mstrmojo.models.datasets.DataInterface","mstrmojo.vi.models.VIComponentMap","mstrmojo.threshold.ThresholdController","mstrmojo.threshold.ThresholdModel","mstrmojo.chart.model.enums.EnumDSSAxisName","mstrmojo.chart.model.enums.EnumDSSDynamicShortcut","mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.mstr.EnumDSSXMLObjectTypes");var Z=mstrmojo,L=Z.array,Q=Z.hash,AL=mstrmojo.chart.model.enums.EnumDSSObjectType,c=Z.vi.ui.DatasetUnitMenuUtils,U=mstrmojo.models.datasets.DataInterface,AH=Z.vi.models.VIComponentMap,G=1,AG=2,F=3,AN=4,N=5,AB=6,f=7,M=8,t=9,AQ=10,A=11,x=12,D="00000000000000000000000000000000",AE=-1,a=mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap,AA=mstrmojo.chart.model.enums.EnumDSSAxisName,AV=mstrmojo.chart.model.enums.EnumDSSDynamicShortcut,P=mstrmojo.mstr.EnumDSSXMLBaseFormType,S=mstrmojo.mstr.EnumDSSXMLObjectTypes;function T(Aa){var Ab=this.getHost(),Ac=Ab.model.data.gsi;return Ac.cols.concat(Ac.rows).filter(function(Ad){return Ad.t===Aa;});}function w(Aa,Ac,Ab){return{act:"updateTemplate",keyContext:Aa.k,partialRetrieval:{nodes:Ab?null:[Aa.k]},actions:Ac};}function AM(Ae,Ac,Ab){var Ag=[];if(Ac.useDropzone){Ae.useDropzone=true;Ae.dropzoneId=Ac.zone.id;if(Ac.item.ax!==undefined){Ae.ax=Ac.item.ax;}}Ae.position=Ac.idx+1+(Ab.offset||0);if(Ab.replaceSourceId){Ae.replaceSourceId=Ab.replaceSourceId;}Ae.partialRetrieval={nodes:[Ae.nodeKey]};Ag.push(Ae);var Af="$GUID_115",Ad=[],Aa=this.checkAndAddThresholdAction(Ac.zone.id,{did:Af,t:4},Ad);if(Aa){Ae.newObjectIds=[Af];Ag.push(this.getUpdateTemplateAction(Ad));}return Ag;}function AZ(Ad){var Aa=this.getHost().model.data.datasetId,Ac=L.ensureArray(Ad),Ab=L.hash(Ac);if(!Aa){Q.forEach(this.docModel.datasets,function(Ag,Ah){var Ae=(Ag.att||[]).concat(Ag.mx||[]),Af=Ae.some(function(Ai){return Ab[Ai.did];});if(Af){Aa=Ah;return false;}});}return Aa;}function AR(Aa,Ae,Ab){var Ah=this,Al=this.docModel,Ag=Aa.item,Aj=c.getUnitFromDataset(Ah.docModel.datasets,Ag.did,Ag.t)||Ag,Am=this.getHost(),Ai=Ah.docModel.getDataService(),Af=Ae==="edit",Ac,Ad={dsid:Af?Al.findDatasetIdFromUnit(Aj.did):AZ.call(Ah,Aj.did),alias:Aj.alias||Aj.n},Ak=null;if(Aj.t===4){if(Af){Ac={metricId:Aj.did,action:{cmd:Ae,n:Aj.n,alias:Ag.n}};Ad.did=Aj.did;Ad.nodeKey=Am.k;Ak=Ai.getEditDerivedMetricSubmitFunc(Ad);}else{Ac={metricId:"",action:{cmd:Ae,refOi:{did:Aj.did,n:Aj.n}}};Ad.nodeKey=Am.k;Ad.idx=Aa.idx;Ad.host=Am;Ad.zoneid=Aa.zone.id;if(Ab){Ad.replace={did:Aj.did,t:Aj.t};}if(Aa.useDropzone){Ak=Ai.getAddNewDerivedMetricToDropzoneSubmitFunc(Ad);}else{Ak=Ai.getAddNewDerivedMetricToXtabSubmitFunc(Ad);}}if(Ah.docModel.isFromSolrCube(Aj.did)||Ah.docModel.isFromMDXCube(Aj.did)){Ac.disableAFB=true;}Ah.docModel.controller.openDME(Am,Ac,Ak);}}mstrmojo.vi.models._DropZoneCommon=mstrmojo.provide("mstrmojo.vi.models._DropZoneCommon",{_mixinName:"mstrmojo.vi.models._DropZoneCommon",isMetric:function e(Aa){return Aa&&Aa.t===S.Metric&&Aa.id!==D;},isAttribute:function AC(Aa){return Aa&&Aa.t===S.Attribute;},isRecursiveAttribute:function Y(Aa){return Aa&&Aa.t===S.Attribute&&Aa.st===3076;},isNewDerivedElement:function AI(Aa){return Aa.t===S.Consolidation&&Aa.st===12033;},isConsolidation:function AT(Aa){return Aa.t===S.Consolidation&&Aa.st===12032;},isCustomGroup:function C(Aa){return Aa.t===S.Filter;},isAttrCategory:function V(Aa){return Aa&&(Aa.t===S.Attribute||Aa.t===S.Filter||Aa.t===S.Consolidation);},isMetricName:function AP(Aa){return Aa&&(Aa.id===D||Aa.did===D);},differInType:function R(Ab,Aa){return(this.isMetric(Ab)&&this.isAttrCategory(Aa))||(this.isAttrCategory(Ab)&&this.isMetric(Aa));},isDynamicLink:function H(Ab){if(this.isAttribute(Ab)){var Aa=Ab.fs||U.getFormsByAttrId(Ab.did,this.docModel.datasets);return Aa.length===2&&Aa[1].bftp===P.DssXmlBaseFormHTMLTag&&Aa[1].fnm==="DYNAMICLINK";}return false;},getZoneModelByZoneId:function(Aa){var Ab=this.dropZones,Ac;L.forEach(Ab,function(Ad){if(Ad.id===Aa){Ac=Ad;return false;}});return Ac;},hGetItemOccurrence:function(Ae,Ag){Ag=Ag||[];if(Ag.length===0){Ag=[G,AG,F,AN,f,N,M,t,AB,AQ];}var Ac,Aa,Ab,Af=Ag.length,Ad=[];for(Ac=0;Ac<Af;Ac++){Ab=this.getZoneModelByZoneId(Ag[Ac]);if(!Ab){continue;}Aa=this.getUnitIndexInZone(Ab,Ae);if(Aa!==-1){Ad.push({zoneId:Ag[Ac],itemIndex:Aa});}}return Ad;},removeColorByItemFromBreakByIfExists:function z(Ad,Af){var Ae,Ac,Aa,Ab;Ae=this.hGetItemOccurrence(Ad,[G,AG,F,AN,N,M,AB]);if((Ae.length===1)&&(Ae[0].zoneId===N||Ae[0].zoneId===AB)){Ac=Ae[0];Aa=this.getZoneModelByZoneId(Ac.zoneId);Ab=Aa.items[Ac.itemIndex];if(Ab.hidden){Af.push(this.getRemoveDropZoneUnitAction(Aa,Ab));}}},updateBreakByAndSliceUnits:function h(){var Aa=this,Ac=[G,AG,F,AN,f,M,A,x],Ab=this.getZoneModelByZoneId(AB)||this.getZoneModelByZoneId(N),Ad;Ab.items.forEach(function(Ae){if(Aa.isAttrCategory(Ae)||Aa.isMetricName(Ae)){Ad=Aa.hGetItemOccurrence(Ae,Ac);if((Ad.length===1)&&(Ad[0].zoneId===f)){Ae.hidden=true;}}});},getAxisSummary:function AJ(){var Aa={};Aa[F]=this.getItemCountInZone(F);Aa[AN]=this.getItemCountInZone(AN);Aa[AQ]=this.getItemCountInZone(AQ);return Aa;},getItemCountInZone:function(Aa){var Ab=this.getZoneModelByZoneId(Aa);if(Ab){return Ab.items.length;}return 0;},isOnlyMetricZone:function d(Aa){var Ac,Ae,Ad,Ab=this.getZoneModelByZoneId(Aa);if(!Ab){return false;}Ad=Ab.items;Ae=Ad.length;if(Ae===0){return false;}for(Ac=0;Ac<Ae;Ac++){if(!this.isMetric(Ad[Ac])){return false;}}return true;},isMetricZone:function v(Aa){var Ac,Ae,Ad,Ab=this.getZoneModelByZoneId(Aa);if(!Ab){return false;}Ad=Ab.items;Ae=Ad.length;if(Ae===0){return false;}for(Ac=0;Ac<Ae;Ac++){if(!this.isMetric(Ad[Ac])){if(this.isMetricName(Ad[Ac])){continue;}else{return false;}}}return true;},getMetricCntInZone:function(Aa){var Ac=this,Ab=this.getZoneModelByZoneId(Aa),Ae=Ab.items,Ad=0;L.forEach(Ae,function(Af){if(Ac.isMetric(Af)){Ad++;}});return Ad;},isAttrCategoryZone:function(Aa){var Ac,Ae,Ad,Ab=this.getZoneModelByZoneId(Aa);if(!Ab){return false;}Ad=Ab.items;Ae=Ad.length;if(Ae===0){return false;}for(Ac=0;Ac<Ae;Ac++){if(!this.isAttrCategory(Ad[Ac])&&!this.isMetricName(Ad[Ac])){return false;}}return true;},showNumberFormat:function(Aa){return mstrmojo.all[this.hostId].model.showNumberFormat(Aa);},renameItem:function(Ab,Aa){var Ac=this.id;c.renameItem(Ab,Aa,function(Ag){var Ai=mstrmojo.all[Ac],Al=Ai.getHost(),Af=Ai.getHostModel().gsi,Ah=Ag.text.trim(),Am=Aa.t===4,Ae=Am?Af.mx:Af.rows.concat(Af.cols),Ak=function(){Ai.submitDropZoneUpdates(w(Al,[{act:"renameUnit",id:Aa.did,type:Aa.t,name:Ah,isDynamicAlias:Aa.t===4}]));},Ad=function(){Ag.set("text",Aa.n);},Aj=Ae.some(function(An){return An.did!==Aa.did&&(Am||An.t===Aa.t)&&An.n===Ah;});if(Aj){mstrmojo.warn(mstrmojo.desc(11664,'"##" already exists in the visualization. Do you want to proceed?').replace("##",Ah),{confirmBtn:{fn:Ak},cancelBtn:{fn:Ad}});}else{Ak();}},{allowEmptyText:true,cssClass:Ab.className});},getPageByUnit:function AW(){var Ab=this.getHost(),Aa=Ab.builder.getLayoutVIMap(Ab.defn._lkz).getComponent(AH.TYPES.PAGEBY_PANEL);return Aa&&Aa.unit;},shouldShowDisplayFormsMenu:function E(Ad){if(!this.isAttribute(Ad)||this.isDynamicLink(Ad)){return false;}var Aa=U.getFormsByAttrId(Ad.did,this.docModel.datasets),Ae=this.getHost().model.data,Ab=Ae.gts,Ac=Aa.length>1;if(Aa.length===1){var Af=false;L.forEach((Ab.row||[]).concat(Ab.col||[]),function(Ag){if(Ag.id===Ad.did&&L.find(Ag.fs||[],"id",Aa[0].fid)>-1){Af=true;return false;}});if(!Af){Ac=true;}}return Ac;},getDisplayFormsMenu:function(Ab){var Aa=this;return c.getDisplayFormsMenu(Ab,Aa.getHost(),Aa.docModel.datasets,function(Ac){Aa.submitDropZoneUpdates(Ac);});},editDerivedMetric:function(Aa){AR.call(this,Aa,"edit");},newDerivedMetric:function(Ab){var Aa=mstrmojo.all[this.hostId].zonesModel.allowInsertNewMetric(Ab.zone);if(Ab.zone.id===f){Aa=false;}AR.call(this,Ab,"editNew",!Aa);},newDerivedAttribute:function b(Af,Ab){var Ag=Af.item,Ae=c.getUnitFromDataset(this.docModel.datasets,Ag.did,Ag.t)||Ag,Ad=this.getHost(),Ac=this,Aa={forceRefresh:true,alias:"New Attribute",precreate:function(Ai){if(Ac.getAddItemActions){var Ah=Ac.getAddItemActions(Af.zone,[{did:"$GUID_1",t:12}]);Ai.newObjectIds=["$GUID_1"];if(Ab){Ah=[Ac.getRemoveDropZoneUnitAction(Af.zone,Ae)].concat(Ah);}Ai=[Ai,{act:"updateTemplate",keyContext:Ad.k,actions:Ah}];}else{Ai=Q.copy({act:"addDAToTemplate",nodeKey:Ad.k,treeType:Ad.defn.tt},Ai);if(Af.useDropzone){Ai.useDropzone=true;Ai.dropzoneId=Af.zone.id;if(Af.item.ax!==undefined){Ai.ax=Af.item.ax;}if(Ab){Ai.replaceSourceId=Ae.did;}}else{Ai.axis=Af.axis;}}return Ai;}};this.docModel.controller.openDAE(this,Aa,mstrmojo.emptyFn,Ae);},newDynamicLinkAttr:function u(Af,Ab){var Ag=Af.item,Ae=c.getUnitFromDataset(this.docModel.datasets,Ag.did,Ag.t)||Ag,Ad=this.getHost(),Ac=this,Aa={forceRefresh:true,alias:"New Link",precreate:function(Ai){if(Ac.getAddItemActions){var Ah=Ac.getAddItemActions(Af.zone,[{did:"$GUID_1",t:12}]);Ai.newObjectIds=["$GUID_1"];if(Ab){Ah=[Ac.getRemoveDropZoneUnitAction(Af.zone,Ae)].concat(Ah);}Ai=[Ai,{act:"updateTemplate",keyContext:Ad.k,actions:Ah}];}else{Ai=Q.copy({act:"addDAToTemplate",nodeKey:Ad.k,treeType:Ad.defn.tt},Ai);if(Af.useDropzone){Ai.useDropzone=true;Ai.dropzoneId=Af.zone.id;if(Af.item.ax!==undefined){Ai.ax=Af.item.ax;}if(Ab){Ai.replaceSourceId=Ae.did;}}else{Ai.axis=Af.axis;Ai.pos=Af.idx+2;}}return Ai;}};this.docModel.controller.openDynamicLinkEditor(this,Aa,mstrmojo.emptyFn,Ae);},editDerivedAttribute:function(Ad){var Ai=this.getHost(),Af=Ad.item,Ah=c.getUnitFromDataset(this.docModel.datasets,Af.did,Af.t)||Af,Ab=this.docModel.findDatasetIdFromUnit(Ah.did),Ae={dsid:Ab,did:Ah.did,n:Ah.n,alias:Af.n,forms:Ah.fs,preupdate:function(Ak){var Aj=Ak.name;Ak.name=Ah.n;Ak=[Ak,w(Ai,[{act:"renameUnit",id:Ah.did,type:12,name:Aj}],true)];return Ak;}};var Ac=window&&window.event,Ag=!!(Ac.ctrlKey&&Ac.altKey),Aa=Ae.forms||[];if(this.isDynamicLink(Af)&&!Ag){this.docModel.controller.openDynamicLinkEditor(this,Ae,mstrmojo.emptyFn);}else{this.docModel.controller.openDAE(this,Ae,mstrmojo.emptyFn);}},getTemplateAttributes:function g(){return T.call(this,12);},getTemplateHierarchies:function W(){return T.call(this,14);},getTemplateDEs:function AS(){var Aa=this.getHost(),Ab=Aa.model.data.gsi;return Ab.cols.concat(Ab.rows).filter(function(Ac){return Ac.st===12033;});},getUnitInfoInTemplate:function l(Ab){var Ac={},Aa=this.getHost().model.data.gts;[{axis:G,name:"row"},{axis:AG,name:"col"}].forEach(function(Ad){L.forEach(Aa[Ad.name],function(Af,Ae){if(Af.id===Ab){Ac.axis=Ad.axis;Ac.axisName=Ad.name;Ac.tplIdx=Ae;Ac.unit=Af;return false;}});});return Ac;},sortGrid:function p(Ag,Ae){var Ah=this.getHost(),Ad=Ag.t,Af=Ag.did,Aa=null,Ac=null;if(Ad===AL.DssTypeMetric){Ac=["","","",1];}else{Aa=this.getUnitInfoInTemplate(Ag.did);Ac=[Aa.unit.fid||(Aa.unit.fs&&Aa.unit.fs[0].id),"21","",Aa.axis];}var Ai=Aa?Aa.axis:G,Ab=Ah.model.data.gts[(Ai===G?"row":"col")+"SubPos"];Ah.controller.onSort(Ah,Ah.model.getSortGridAction(Ab,[Ad,Af].concat(Ac).join("!"),Ai,Ae));},addSortMenu:function X(Aa,Ad,Ah){var Af=this,Ai=this.getHost(),Aj=Aa.item,Ab=Ai.model.data,Ag=Ab.gsi.tma,Ae=Q.copy(Aj);if(Aj.t===AL.DssTypeFilter){return ;}if(Aj.t===AL.DssTypeDimension){L.forEach((Ab.gts.row||[]).concat(Ab.gts.col||[]),function(Al){if(Al.hid===Ae.did){Ae.did=Al.id;Ae.t=Al.otp;return false;}});}if(Aa.axis!==AE||Ag!==G){Ad.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",function(){Af.sortGrid(Ae,true);});Ad.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",function(){Af.sortGrid(Ae,false);});}if(Ah){Ad.addMenuItem(mstrmojo.desc(11099,"Advanced Sort..."),"xt",function(){var Al=Aa.axis;if(Al===AE){Al=Ag;}Ai.controller.onGetAdvSortData(Ai,Al,Ae.t);});}else{var Ac=Ab.gsi.sorts.some(function(Al){return !!Al.length;}),Ak=mstrmojo.desc(11699,"Clear Sort");if(Ac){Ad.addMenuItem(Ak,"",function(){Af.submitDropZoneTemplateUpdates([{act:"clearSort"}]);});}}},convertToMetric:function m(Ag){var Af=this.getHost(),Aa=Af.model&&Af.model.data&&Af.model.data.datasetId,Ac=Af.k,Ae=Af.defn.tt,Ad=Ag.item;if(!Aa){mstrmojo.hash.forEach(this.docModel.datasets,function(Ai,Aj){if(mstrmojo.array.find((Ai.att||[]),"did",Ad.did)!==-1){Aa=Aj;return false;}});}var Ab=mstrmojo.mstr.EnumFunction,Ah=AM.call(this,{act:"addShortcutMetric",nodeKey:Ac,treeType:Ae,funcType:Ad.formType===2?Ab.FunctionSum:Ab.FunctionCount,units:[{id:Ad.did,type:Ad.t}],dsid:Aa,replaceSourceId:Ad.did},Ag);this.submitActionForDatasetUpdate(Ah);},getAddMetricNameAction:function(Aj,Af){if(!this.gmZones){return null;}var Ah=this,Ab=0,Ag=false,Ae,Aa=Ah.gmZones.getZoneModelByZoneId((Af===G)?AN:F),Ai={n:"Metric Names",did:D,t:0},Ad=Q.clone(Ai),Ac=Ah.gmZones.hGetItemOccurrence(Ad,[G,AG,F,AN,f]);L.forEach(Aa.items,function(Ak){if(Ah.isMetric(Ak)){Ab++;}});if(Ac.length===0&&Ab<=1){Ag=true;}if(Ag){Ae={act:"updateTemplate",keyContext:Aj.k,actions:Ah.gmZones.getUpdateMetricNameUnitActions(Ag,Af)};}return Ae;},getAggregateByMetricSubMenu:function(Ab){var Af=this,Ae=Ab.item,Ah=c.getUnitFromDataset(this.docModel.datasets,Ae.did,Ae.t)||Ae,Aa=this.id,Ai=this.getHost(),Ad=Ai.k,Ac=Ai.defn.tt,Ag=this.submitActionForDatasetUpdate;return c.getAggregateByMenu(Ah,function(Am,Ak){var Aj=Af.allowInsertNewMetric(Ab.zone),Ao=[];if(Ab.zone.id===f){Aj=false;}if(Aj&&Ab.useDropzone&&Af.gmZones){var An=Af.gmZones.getZoneModelByZoneId((Ab.zone.id===AN)?G:AG);var Al=Af.getAddMetricNameAction(Ai,An.id);if(Al){Ao.push(Al);}Al=Af.gmZones.getUpdateGroupInfoActionForNewMetric(Ab.zone.id,Ab.idx+1,Ae.ax===0);if(Al){Ao.push(Al);}}Ag.call(mstrmojo.all[Aa],Ao.concat(AM.call(Af,{act:"addShortcutMetric",dsid:AZ.call(Af,Ah.did),nodeKey:Ad,treeType:Ac,funcType:Ak,units:[{id:Am.did,type:Am.t}]},Ab,{offset:Aj?1:0,replaceSourceId:Aj?null:Ah.did})));});},getCalculationEditorCfg:function AO(Aa){var Af=this,Ah=this.getHost(),Ae=this.submitActionForDatasetUpdate.bind(this),Ad=Ah.k,Ag=Ah.model.data.gsi,Ab=Ah.defn.tt,Ai=Af.allowInsertNewMetric(Aa.zone),Ac=[];if(Aa.zone.id===f){Ai=false;}return c.getCalculationMetricEditor(Ag.mx,Aa.item,function(Ak,Aj,Ao,Al){if(Ai&&Aa.useDropzone&&Af.gmZones){var An=Af.gmZones.getZoneModelByZoneId((Aa.zone.id===AN)?G:AG);var Am=Af.getAddMetricNameAction(Ah,An.id);if(Am){Ac.push(Am);}Am=Af.gmZones.getUpdateGroupInfoActionForNewMetric(Aa.zone.id,Aa.idx+1,Aa.item.ax===0);if(Am){Ac.push(Am);}}Ae(Ac.concat(AM.call(Af,{act:"addShortcutMetric",dsid:AZ.call(Af,Aa.item.did),nodeKey:Ad,treeType:Ab,funcType:Ao,funcType2:Al,units:[Ak,Aj]},Aa,{offset:Ai?1:0,replaceSourceId:Ai?null:Aa.item.did})));});},submitAddShortcutMetric:function(Ag,Ar){var At=this,Am=At.id,Ak=this.getHost(),Ab=Ak.k,Ad=Ak.defn.tt,Au=At.submitActionForDatasetUpdate,Ap=At.allowInsertNewMetric(Ag.zone),Ah=[];if(Ag.zone.id===f){Ap=false;}if(Ap&&Ag.useDropzone&&At.gmZones){var Af=At.gmZones.getZoneModelByZoneId((Ag.zone.id===AN)?G:AG);var Ao=At.getAddMetricNameAction(Ak,Af.id);if(Ao){Ah.push(Ao);}Ao=At.gmZones.getUpdateGroupInfoActionForNewMetric(Ag.zone.id,Ag.idx+1,Ag.item.ax===0);if(Ao){Ah.push(Ao);}}var Aq=Ar.item,Aj=Ar.extraItem,As=Ar.funcType,Ac=Ar.funcType2,Ai=Ar.breakBys,Aa=Ar.sortBys,Ae=Ar.prs,An=[{id:Aq.did,type:Aq.t}],Al;if(Aj){An.push(Aj);}Al={act:"addShortcutMetric",dsid:AZ.call(At,Aq.did),nodeKey:Ab,treeType:Ad,funcType:As,units:An,breakBys:Ai,sortBys:Aa};if(Ac){Al.funcType2=Ac;}if(Ae){Al.prs=Ae;}Ah=Ah.concat(AM.call(At,Al,Ag,{offset:Ap?1:0,replaceSourceId:Ap?null:Aq.did}));Au.call(mstrmojo.all[Am],Ah);},getDynamicBreakByAxisOptions:function(Ac){var Ae=this,Ad=Ae.getHost(),Af=Ad.model.data.gsi,Aa=[],Ab=function Ab(Ag){return Ag.some(function(Ah){return Ae.isAttribute(Ah)||Ae.isNewDerivedElement(Ah)||Ae.isCustomGroup(Ah)||Ae.isConsolidation(Ah);});};if(Ab(Af.rows)){Aa.push({n:Ac?mstrmojo.desc(3326,"By Columns"):mstrmojo.desc(122,"Columns"),axes_bitmap:a.DssXmlAxisRowsBit,dmy:"@cols"});}if(Ab(Af.cols)){Aa.push({n:Ac?mstrmojo.desc(3327,"By Rows"):mstrmojo.desc(2968,"Rows"),axes_bitmap:a.DssXmlAxisColumnsBit,dmy:"@rows"});}return Aa;},getBreakByAxisOptions:function(Ab){var Aa=[{n:mstrmojo.desc(4531,"Automatic"),axes_bitmap:AA.DssAxisDynamicShortcutRoot+AV.DssDynamicShortcutAuto,dmy:"@auto"},{n:Ab?mstrmojo.desc(13408,"By None"):mstrmojo.desc(2057,"None"),axes_bitmap:a.DssXmlAxisPagesBit,dmy:"@p"}];if(Ab){Aa.splice(1,0,{isSeparator:true});}return Aa.concat(this.getDynamicBreakByAxisOptions(Ab));},getBreakByAttributeOptions:function(){var Aa=this,Ab=[],Ad=Aa.getTemplateAttributes().concat(Aa.getTemplateDEs()),Ac=Aa.getPageByUnit();Ab=Ab.concat(Ad);if(Ac&&Ac.srcid){if(L.find(Ab,"did",Ac.srcid)===-1){Ab.push({n:Ac.n,did:Ac.srcid,t:Ac.srct});}}return Ab;},getDynamicBreakByOptions:function(Aa){var Ab=this,Ac=Ab.getBreakByAttributeOptions();if(Aa&&Ac.length){Ac.unshift({isSeparator:true});}return Ab.getBreakByAxisOptions(Aa).concat(Ac);},getDynamicLevelOptions:function(){var Aa=this,Ac=Aa.getBreakByAxisOptions(true),Ab=Aa.getBreakByAttributeOptions();Ac.some(function(Ad){if(Ad.axes_bitmap===a.DssXmlAxisPagesBit){Ad.n=mstrmojo.desc(3329,"Grand Total");return true;}});if(Ab.length){Ab.unshift({isSeparator:true});}return Ac.concat(Ab);},getShortcutMetricSubMenu:function(Ae){var Ad=this,Aa=new mstrmojo.ui.menus.MenuConfig(),Af=Ae.item,Ac=c.getUnitFromDataset(this.docModel.datasets,Af.did,Af.t)||Af,Ab=Ad.allowInsertNewMetric(Ae.zone);if(Ac.t===4){Ad.addRankShortcutMenu(Ae,Aa);Ad.addPercentileShortcutMenu(Ae,Aa);Ad.addPercentToTotalShortcutMenu(Ae,Aa);Aa.addSeparator();Ad.addPercentOfShortcutMenu(Ae,Aa);Ad.addPercentChangeShortcutMenu(Ae,Aa);Ad.addDifferenceShortcutMenu(Ae,Aa);Aa.addSeparator();Ad.addMovingTotalShortcutMenu(Ae,Aa);Ad.addRunningTotalShortcutMenu(Ae,Aa);Ad.addPercentRunningTotalShortcutMenu(Ae,Aa);}Aa.addSeparator();Aa.addMenuItem(mstrmojo.desc(11491,"More Functions..."),"",function(){AR.call(Ad,Ae,"add",!Ab);},Ac);return Aa;},hasReplaceCandidates:function(Aa){var Ab=this.getReplaceCandidates(Aa.zone,Aa.item);return Ab&&Ab.length>0;},getReplaceSubMenu:function(Ab,Ad){var Ah,Ai=Ab.item,Ae=Ab.zone,Ac=this.getReplaceCandidates(Ae,Ai),Af=this;Ah=Ad?[Ad]:[];Ah.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"scrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:Ac,listHooks:{select:function Ag(Aj,Ak){Af.unitsDropped(Ae,{src:{data:{item:Ak,items:[Ak],dsid:Ak.dsId}},getCtxtDragData:function(){var Al=this.src;return(Al&&Al.data)||{};}},{allowedItems:[Ak],idx:L.find(Ae.items,"did",Ai.did)===-1?Ai._renderIdx:L.find(Ae.items,"did",Ai.did),edge:mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION.ON,removeReplaced:true});if(this.parent&&this.parent.parent&&this.parent.parent.closeAllMenus){this.parent.parent.closeAllMenus();}}}}]});return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:Ah,onOpen:function Aa(){this.scrollableContainer.updateScrollbars();}});},addRankShortcutMenu:function o(Ad,Ab){var Ac=this,Af=this.id;function Aa(Ai,Ah,Ag){Ac.submitAddShortcutMetric(Ad,{item:Ai,funcType:mstrmojo.mstr.EnumFunction.FunctionRank,prs:[{n:"ASC",v:Ah}],breakBys:Ag});}function Ae(Ag){return c.getRankMetricEditor(Ag.item,Ac.getDynamicBreakByOptions(),Aa);}Ab.addActionPopupMenuItem(mstrmojo.desc(2789,"Rank"),Af,function(){Aa(Ad.item,"0",[{dmy:"@auto"}]);},Ae,"",Ad);},addPercentileShortcutMenu:function n(Ac,Aa){var Ab=this,Af=this.id;function Ad(Ag){var Ah;if(Ag.dmy){Ah={dmy:Ag.dmy};}else{Ah={id:Ag.did,type:Ag.t};}Ab.submitAddShortcutMetric(Ac,{item:Ac.item,funcType:mstrmojo.mstr.EnumFunction.FunctionPercentRank,breakBys:[Ah],prs:[{n:"inclusive",v:"False"}]});}function Ae(){var Ah=new mstrmojo.ui.menus.MenuConfig(),Ag=Ab.getDynamicBreakByOptions(true);Ag.forEach(function(Ai){if(Ai.isSeparator){Ah.addSeparator();return ;}Ah.addMenuItem(Ai.n,"",function(){Ad(Ai);});});return Ah;}Aa.addActionPopupMenuItem(mstrmojo.desc(13409,"Percentile Rank"),Af,function(){Ad({dmy:"@auto"});},Ae,"",Ac);},addPercentToTotalShortcutMenu:function AD(Ab,Ah){var Aj=this,Aa=this.id,Am=Ab.item,An=Aj.getHost(),Ai=Aj.submitActionForDatasetUpdate.bind(Aj),Ag=Aj.getDynamicLevelOptions(),Af=An.k,Ac=An.defn.tt,Al=Aj.allowInsertNewMetric(Ab.zone),Ae=[];if(Ab.zone.id===f){Al=false;}function Ak(Ao){if(Al&&Ab.useDropzone&&Aj.gmZones){var Aq=Aj.gmZones.getZoneModelByZoneId((Ab.zone.id===AN)?G:AG);var Ap=Aj.getAddMetricNameAction(An,Aq.id);if(Ap){Ae.push(Ap);}Ap=Aj.gmZones.getUpdateGroupInfoActionForNewMetric(Ab.zone.id,Ab.idx+1,Ab.item.ax===0);if(Ap){Ae.push(Ap);}}Ai(Ae.concat(AM.call(Aj,{act:"addPercentToTotalMetric",nodeKey:Af,treeType:Ac,metric_id:Am.did,axes_bitmap:Ao.axes_bitmap||0,units:Ao.did&&[{id:Ao.did,type:Ao.t}]},Ab,{offset:Al?1:0,replaceSourceId:Al?null:Ab.item.did})));}function Ad(){var Ao=new mstrmojo.ui.menus.MenuConfig();Ag.forEach(function(Ap){if(Ap.isSeparator){Ao.addSeparator();return ;}Ao.addMenuItem(Ap.n,"",function(){Ak(Ap);});});return Ao;}Ah.addActionPopupMenuItem(mstrmojo.desc(3323,"Percent to Total"),Aa,function(){Ak({axes_bitmap:AA.DssAxisDynamicShortcutRoot+AV.DssDynamicShortcutAuto});},Ad,"",Ab);},addPercentOfShortcutMenu:function J(Ae,Aa){var Ad=this,Af=this.id;function Ac(Ah,Ai,Ag){Ad.submitAddShortcutMetric(Ae,{item:Ah,funcType:Ai,funcType2:mstrmojo.mstr.EnumFunction.FunctionDivide,breakBys:Ag,sortBys:[{dmy:"@auto"}]});}function Ab(Ag){return c.getRelativeReferenceMenu(Ag.item,mstrmojo.desc(13394,"Percent of:"),Ad.getDynamicBreakByOptions(),Ac);}Aa.addActionPopupMenuItem(mstrmojo.desc(13390,"Percent Of"),Af,function(){Ac(Ae.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Ab,"",Ae);},addPercentChangeShortcutMenu:function k(Ad,Ab){var Ac=this,Af=this.id;function Ae(Ah,Ai,Ag){Ac.submitAddShortcutMetric(Ad,{item:Ah,funcType:Ai,funcType2:mstrmojo.mstr.EnumFunction.FunctionVar,breakBys:Ag,sortBys:[{dmy:"@auto"}]});}function Aa(Ag){return c.getRelativeReferenceMenu(Ag.item,mstrmojo.desc(146,"From:"),Ac.getDynamicBreakByOptions(),Ae);}Ab.addActionPopupMenuItem(mstrmojo.desc(13391,"Percent Change"),Af,function(){Ae(Ad.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Aa,"",Ad);},addDifferenceShortcutMenu:function I(Ad,Aa){var Ac=this,Af=this.id;function Ab(Ah,Ai,Ag){Ac.submitAddShortcutMetric(Ad,{item:Ah,funcType:Ai,funcType2:mstrmojo.mstr.EnumFunction.FunctionMinus,breakBys:Ag,sortBys:[{dmy:"@auto"}]});}function Ae(Ag){return c.getRelativeReferenceMenu(Ag.item,mstrmojo.desc(146,"From:"),Ac.getDynamicBreakByOptions(),Ab);}Aa.addActionPopupMenuItem(mstrmojo.desc(11495,"Difference"),Af,function(){Ab(Ad.item,mstrmojo.mstr.EnumFunction.FunctionLag,[{dmy:"@auto"}]);},Ae,"",Ad);},addMovingTotalShortcutMenu:function AF(Ac,Aa){var Ab=this,Af=this.id;function Ae(Aj,Ai,Ah,Ag){Ab.submitAddShortcutMetric(Ac,{item:Aj,funcType:Ai,breakBys:Ag,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"3"},{n:"OLAPWinStOffset",v:Ah.toString()},{n:"OLAPWinEndType",v:"2"}]});}function Ad(Ag){return c.getMovingTotalMenu(Ag.item,Ab.getDynamicBreakByOptions(),Ae);}Aa.addActionPopupMenuItem(mstrmojo.desc(13392,"Moving Average"),Af,function(){Ae(Ac.item,mstrmojo.mstr.EnumFunction.FunctionOLAPAvg,1,[{dmy:"@auto"}]);},Ad,"",Ac);},addRunningTotalShortcutMenu:function AU(Ae,Aa){var Ad=this,Af=this.id;function Ac(Ai,Ah,Ag){Ad.submitAddShortcutMetric(Ae,{item:Ai,funcType:Ah,breakBys:Ag,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"0"},{n:"OLAPWinEndType",v:"2"}]});}function Ab(Ag){return c.getRunningTotalMenu(Ag.item,Ad.getDynamicBreakByOptions(),Ac);}Aa.addActionPopupMenuItem(mstrmojo.desc(11906,"Running Total"),Af,function(){Ac(Ae.item,mstrmojo.mstr.EnumFunction.FunctionOLAPSum,[{dmy:"@auto"}]);},Ab,"",Ae);},addPercentRunningTotalShortcutMenu:function B(Ad,Ab){var Ac=this,Af=this.id;function Aa(Ai,Ag){var Ah=[];Ag.forEach(function(Aj){if(Aj.dmy){Ah.push({dmy:Aj.dmy});}else{Ah.push({id:Aj.did,type:Aj.t});}});Ac.submitAddShortcutMetric(Ad,{item:Ai,funcType:mstrmojo.mstr.EnumFunction.FunctionOLAPSum,funcType2:mstrmojo.mstr.EnumFunction.FunctionDivide,breakBys:Ah,sortBys:[{dmy:"@auto"}],prs:[{n:"OLAPWinStType",v:"0"},{n:"OLAPWinEndType",v:"2"}]});}function Ae(Ai){var Ah=new mstrmojo.ui.menus.MenuConfig(),Ag=Ac.getDynamicLevelOptions();Ag.forEach(function(Aj){if(Aj.isSeparator){Ah.addSeparator();return ;}Ah.addMenuItem(Aj.n,"",function(){Aa(Ai.item,[Aj]);});});return Ah;}Ab.addActionPopupMenuItem(mstrmojo.desc(13393,"Percent Running Total"),Af,function(){Aa(Ad.item,[{dmy:"@auto"}]);},Ae,"",Ad);},getMultipleMetricsCalcMenus:function r(Ah,Ag,Aj){var Ai=this,Ak=this.getHost(),Af=this.submitActionForDatasetUpdate.bind(this),Ad=Ak.k,Ab=Ak.defn.tt,Ac=Ag.map(function(Al){return Al.did;}),Aa=Ah.items.map(function(Al){return Al.did;}),Ae=-1;Ac.forEach(function(Al){var Am=L.indexOf(Aa,Al);if(Am>Ae){Ae=Am;}});return c.getMultipleMetricsCalculationMenus(Ag,Ak.model.data.datasetId,function(An){var Am={act:"addShortcutMetric",dsid:AZ.call(Ai,Ac),nodeKey:Ad,treeType:Ab,funcType:An.funcType,funcType2:An.funcType2,units:An.items.map(function(Ap){return{id:Ap.did,type:Ap.t};}),position:Ae+2,partialRetrieval:{nodes:[Ad]}},Ao=[],Al;if(Aj){Am.useDropzone=Aj;Am.dropzoneId=Ah.id;}Ao.push(Am);if(Ai.gmZones){Al=Ai.gmZones.getUpdateGroupInfoActionForNewMetric(Ah.id,Ae+1,true);}if(Al){Ao.push(Al);}Af(Ao);});},getCreateOrEditElementGroupFunc:function AY(Ab){var Aa=this;return function(){var Af=Aa.getHost(),Ag=Af.model,Ae=Ab.item,Ad=Ae.did,Ac=Aa.getUnitInfoInTemplate(Ad),Ai="$GUID_1",Ah=Ac.unit.ost===12033&&Ag.docModel.getDEObject(Ad);Af.controller.openDEEditor(Af,Ah?{deObj:Ah}:{dsId:Ag.data.datasetId,attId:Ad,attName:Ae.n,deId:Ai,getExtraSaveActions:function(){var Aj=Ab.zone;return Aa.getUpdateTemplateAction([Aa.getRemoveDropZoneUnitAction(Aj,Ae),Aa.getAddDropZoneUnitAction(Aj,{did:Ai,t:AL.DssTypeConsolidation},Ab.idx)]);}});};},buildThresholdMenuOptions:function q(Ab,Ac,Aa){mstrmojo.all[this.hostId].model.buildThresholdMenuOptions(Ab,Ac,Aa,this.canSupportImageThreshold());},canSupportImageThreshold:function K(){return false;},getNumberFormatEditorCfg:function O(Aa){return mstrmojo.all[this.hostId].model.getNumberFormatEditorCfg(Aa);},submitUpdatesAndPersistWidgetXMLIfNecessary:function AX(Ad,Ac,Ab){var Aa=Ad.model.docModel,Ae=Aa.getDataService(),Ag,Af;if(!Ad.isXMLDirty()){Ad.controller.onSubmitTemplateUpdates(Ad,Ac,Ab);}else{Af={act:"updateTemplate",keyContext:Ad.k,actions:Ac};Ag=Ad.getPersistAction();Ae.submitUpdates([Af,Ag],mstrmojo.func.wrapMethods(Ad.controller._getXtabCallback(Ad),Ab));Ad.resetXMLDirtyFlag();}},submitActionForDatasetUpdate:function AK(Ab){var Aa=this.docModel;this.submitDropZoneUpdates(Ab,mstrmojo.func.wrapMethods(Aa.getDatasetsUpdateCallback(),Aa.controller._getXtabCallback(this.getHost())));}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.DataGrid","mstrmojo.hash","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.func","mstrmojo.array");var S=mstrmojo.hash,M=mstrmojo.array,V=mstrmojo.Button.newWebButton,J=mstrmojo.ui.Pulldown.newPulldown,K=mstrmojo.models.FormatModel.getFormatUpdate,O=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,H=mstrmojo.vi.ui.DatasetUnitMenuUtils,a;var U=1,T=2,b=3,E="410px";var Y=[{n:mstrmojo.desc(6031,"Off"),v:"0"},{n:mstrmojo.desc(6030,"On"),v:"1"},{n:mstrmojo.desc(8504,"Form name only"),v:"2"},{n:mstrmojo.desc(8505,"Show attribute name once"),v:"3"},{n:mstrmojo.desc(4531,"Automatic"),v:"4"}],Z=[{n:mstrmojo.desc(13786,"Show both nulls and zeros"),v:"-1"},{n:mstrmojo.desc(13787," Hide both nulls and zeros"),v:"2"},{n:mstrmojo.desc(9845,"Hide nulls only"),v:"0"},{n:mstrmojo.desc(9846,"Hide zeros only"),v:"1"}],A=[{n:mstrmojo.desc(13544,"Last selection only"),v:0},{n:mstrmojo.desc(13545,"Intersection of all selections"),v:1}],I=[{n:mstrmojo.desc(959,"Default"),v:"-1",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(9640,"Inner Join"),v:"0",title:mstrmojo.desc(9640,"Inner Join")},{n:mstrmojo.desc(9641,"Outer Join"),v:"1",title:mstrmojo.desc(9641,"Outer Join")}],P=[{n:mstrmojo.desc(959,"Default"),v:"-1",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13179,"Outer Join - Ignore Filter"),v:"2",title:mstrmojo.desc(13180,"Outer join to attribute's look up table without considering the filter on template")},{n:mstrmojo.desc(13181,"Outer Join - Preserve Filter"),v:"3",title:mstrmojo.desc(13182,"Outer join to attribute's look up table after considering the filter on template")}];var R={"-1":mstrmojo.desc(959,"Default"),"0":mstrmojo.desc(9640,"Inner Join"),"2":mstrmojo.desc(13179,"Outer Join - Ignore Filter"),"3":mstrmojo.desc(13181,"Outer Join - Preserve Filter")},D={"-1":mstrmojo.desc(959,"Default"),"0":mstrmojo.desc(9640,"Inner Join"),"1":mstrmojo.desc(9641,"Outer Join")};function Q(h,e,d,g){var f={scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",col1Width:h,col2Width:e,children:d};return S.copy(g,f);}function X(e,f,d){return S.copy(d,{scriptClass:"mstrmojo.Label",slot:f,text:e});}function B(g,d){return[X(g,"col1Node",{cssClass:"subTitle"}),{scriptClass:"mstrmojo.ui.CheckList",orientation:"h",slot:"col2Node",preBuildRendering:function e(){var l=mstrmojo.all[a].data[d],h=this.items,k=this.selectedIndices;if(l){M.forEach(h,function(n,m){k[m]=l[n.id]==="-1";});}},postselectionChange:function f(h){var l=this.items,k=[h.added,h.removed];k.forEach(function(n,m){if(n&&n.length>0){K(d+l[n[0]].id,m===0?"-1":"0",mstrmojo.all[a].newData);}});},items:[{n:mstrmojo.desc(2969,"Show"),id:O.SHOW_HEADER},{n:mstrmojo.desc(1095,"Merge"),id:O.MERGE_HEADER},{n:mstrmojo.desc(2970,"Lock"),id:O.LOCK_HEADER}]}];}function G(e){var d=mstrmojo.all[a];if(e){d.update=d.update.actions?d.update:{actions:[]};d.update.actions=d.update.actions.concat(mstrmojo.hash.valarray(d.joinActions));d.update.callback=mstrmojo.func.wrapMethods(d.update.callback,d.host.parent.model.getRebuildCallback());d.submitAction(d.newData,d.update.actions,d.update.callback,d.update.extras);}d.newData=d.update={};d.joinActions={};d.close();}function N(e){var h=e.parent.data,f=mstrmojo.all[a],d=f.host.k,g=f.host.controller,k=new mstrmojo.ui.menus.MenuConfig();f.joinActions=f.joinActions||{};if(h.did==="AllAttr"){P.forEach(function(l){k.addMenuItem(l.n,"",function(){e.parent.jtValue.set("text",l.n);h.v=l.v;h.dv=l.n;f.joinActions.AllAttr=g.dataService().getSetAttributesJoinTypeAction(d,l.v);});});}else{I.forEach(function(l){k.addMenuItem(l.n,"",function(){e.parent.jtValue.set("text",l.n);h.v=l.v;h.dv=l.n;f.joinActions[h.did]=g.dataService().getSetMetricJoinTypeAction(d,h.did,h.dt,h.t,l.v);});});}k.hostId=a;k.isHostedWithin=false;k.hostElement=e.domNode;k.menuCssClass="joinbehavior";k.setAlignment(3,2);f.openPopup(k.newInstance());}mstrmojo.vi.ui.editors.MoreOptionsEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.editors.MoreOptionsEditor",host:undefined,showHeadersSection:false,data:undefined,lockHeadersCase:undefined,update:undefined,newData:undefined,joinActions:undefined,cssClass:"mstrmojo-MoreOptions-Editor",title:mstrmojo.desc(9126,"More options"),help:"more_options_dialog_box.htm",submitAction:mstrmojo.emptyFn,init:function W(d){this._super(d);a=this.id;this.newData=this.update={};this.joinActions={};this.onshowHeadersSectionChange(this.showHeadersSection);},onOpen:function F(){this.refresh();},_set_lockHeadersCase:function c(g,d){this.lockHeadersCase=d;var e=this.data,f=this.lockHeadersCase;if(!e){e=this.data={rows:{},cols:{}};}else{e.rows=e.rows||{};e.cols=e.cols||{};}e.rows.lhv=(f===b||f===U)?"-1":"0";e.cols.lhv=(f===b||f===T)?"-1":"0";},onshowHeadersSectionChange:function L(e){var f=e.value,d=this.headersSection;if(!f&&d){this._headersSecOrphan=d;this.removeChildren(d);}else{if(f&&!d){this.addChildren(this._headersSecOrphan,0);}}},children:[Q("26%","74%",[X(mstrmojo.desc(2967,"Headers"),"col1Node",{cssClass:"title"}),Q("20%","80%",B(mstrmojo.desc(2968,"Rows"),"rows"),{slot:"col2Node"}),Q("20%","80%",B(mstrmojo.desc(122,"Columns"),"cols"),{slot:"col2Node"})],{alias:"headersSection",cssClass:"headers",width:E}),Q("26%","74%",[X(mstrmojo.desc(4083,"Display"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[X(mstrmojo.desc(8503,"Show attribute form names:"),"containerNode",null),J(Y,function(d){K(O.LONG_NAME,d.v,mstrmojo.all[a].newData);},0,{width:"151px",preBuildRendering:function C(){var d=this.items.map(function(e){return e.v;}).indexOf(mstrmojo.all[a].data[O.LONG_NAME]);this.selectedIndex=Math.max(d,0);}},true)]},{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row2",children:[X(mstrmojo.desc(13200,"Hide Null/Zero"),"containerNode",null),J(Z,function(e){var d=e.v,f=d==="-1"?"-1":"0";if(d!=="-1"){K(O.HIDE_NULL,d,mstrmojo.all[a].newData);}K(O.SHOW_ALL_ROWS,f,mstrmojo.all[a].newData);},0,{width:"181px",preBuildRendering:function C(){var e=mstrmojo.all[a].data,d=e[O.SHOW_ALL_ROWS]==="-1"?0:this.items.map(function(f){return f.v;}).indexOf(e[O.HIDE_NULL]);this.selectedIndex=Math.max(d,0);}},true)]}],{alias:"viewSection",cssClass:"view",width:E}),Q("26%","74%",[X(mstrmojo.desc(13546,"Filtering"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.Box",slot:"col2Node",cssClass:"row1",children:[X(mstrmojo.desc(13547,"When this visualization is filtered by multiple other visualizations, filter by:"),"containerNode",{cssClass:"dropdownLabel"}),J(A,function(d){var e=mstrmojo.all[a],f=e.host;if(f.switchFilterType){e.update=f.switchFilterType(d.v);}},0,{width:"181px",preBuildRendering:function C(){var d=mstrmojo.all[a].host;if(d.getFilterType){this.selectedIndex=d.getFilterType();}}},true)]}],{alias:"filteringSection",cssClass:"filtering",width:E}),Q("26%","74%",[X(mstrmojo.desc(4571,"Join Behavior"),"col1Node",{cssClass:"title"}),{scriptClass:"mstrmojo.DataGrid",slot:"col2Node",cssClass:"jointype",banding:false,columns:[{headerText:mstrmojo.desc(5467,"Objects"),dataField:"n",headerCss:"objects-hd",tooltip:true,itemTooltipField:"tf",itemCSSField:"itemCss",colWidth:140,colHeight:24},{headerText:mstrmojo.desc(13176,"Join Type"),headerCss:"jointype-hd",dataWidget:{scriptClass:"mstrmojo.Box",cssClass:"jt-col",children:[{scriptClass:"mstrmojo.Label",cssClass:"jt-value",alias:"jtValue",bindings:{text:"this.parent.data.dv"}},{scriptClass:"mstrmojo.Button",cssClass:"jt-menu",alias:"jtBtn",onclick:function(){var d=mstrmojo.all[a];N.call(d,this);}}]}}],items:[],itemFunction:function(){var d=mstrmojo.DataGrid.prototype.itemFunction.apply(this,arguments);d.themeClassName="mojo-theme-dark";return d;},preBuildRendering:function C(){var p=mstrmojo.all[a].host,o=p.model&&p.model.docModel,g=p.gridInfo||{},q=g.rows||[],m=g.cols||[],n=g.mx||[],h=g.dmx||[],l=p.tmsProps,e=l.tpltProp&&l.tpltProp["VLDB Select"]&&l.tpltProp["VLDB Select"][0].v,k=[];e=(e&&e.length)?e:"-1";(q.concat(m)).some(function(r){if(r.t===12){k.push({did:"AllAttr",n:mstrmojo.desc(13185,"All Attributes"),v:e,dv:R[e],itemCss:"jt-allattr"});return true;}return false;});var d=n.concat(h);d=M.filter(d,function(t){var u=H.getUnitFromDataset(o.datasets,t.did,4),r=t.isSmart&&t.decomposable===2;return u&&(!u.um||t.afb||!t.isSmart||r);});var f=[].concat(l.mxProp);h.forEach(function(t){var r={};r[t.did]=t.prop;f.push(r);});(d||[]).forEach(function(t){var r={v:"-1"};(f||[]).forEach(function(u){if(u[t.did]){(u[t.did]["VLDB Select"]||[]).forEach(function(v){if(v.n==="Metric Join Type"){r=v;}});}});k.push({did:t.did,n:t.n,dt:r.dt,t:4,v:r.v,dv:D[r.v],itemCss:"jt-metric"});});this.items=k;mstrmojo.DataGrid.prototype.preBuildRendering.apply(this,arguments);}}],{alias:"JoinBehaviorSection",cssClass:"joinbehavior",width:E}),{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[V(mstrmojo.desc(221,"Cancel"),function(){G(false);}),V(mstrmojo.desc(118,"Save"),function(){G(true);},true)]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxPanel","mstrmojo._HasBuilder","mstrmojo._IsPanelStack","mstrmojo.vi.ui.rw._IsPanelStack","mstrmojo.vi.ui.rw._HasBufferSlice","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig","mstrmojo.Label","mstrmojo.Button","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.PanelFormatSaver","mstrmojo.ui.CheckList","mstrmojo.array","mstrmojo.dom","mstrmojo.css");mstrmojo.requiresDescs(134,1143,3581,3582,11473,11474,11815,11816,11817,11818,14594);var H=mstrmojo.array,D=mstrmojo.dom,N=mstrmojo.Button.newWebButton,L={att:12,mx:4},J={CLEAR_TARGET:1,TARGET_ALL_BELOW:2},R=mstrmojo.func,Y=R.wrapMethods,E=mstrmojo.vi.ui.DatasetUnitMenuUtils;function V(Z){return(Z||[]).map(function(a){return a.ckey;});}function O(){var c=this.model,d=this.getFilterDefinitions(),b=[],a={},e=this.id;function Z(n,m){var l=c.getDatasetUnits([m],function(u){var r=u.t;if(!a[u.did]&&(r===12||r===4||r===1||r===47)){if(H.find(d,"srcid",u.did)<0&&u.hide){return false;}a[u.did]=true;return true;}return false;});l=E.getSortedDatasetUnits(l);if(!l.length){return ;}var k=(c.datasetsSettings&&c.datasetsSettings.units)||{};l=l.filter(function(v){var u=true;if(k[v.n]&&k[v.n].completeHide){u=false;}else{if(v.lock){var r=v.fs||[],t;u=false;for(t=0;t<r.length;t++){if(r[t].iidx){u=true;break;}}}}return u;});var g={};(l||[]).forEach(function(t,r){if(H.find(d,"srcid",t.did)>-1){g[r]=true;}});var f=c.datasets,p,q=0;for(p in f){if(f.hasOwnProperty(p)&&f[p].did){++q;}}var h=new mstrmojo.ui.CheckList({cssClass:"units",items:l.map(function(r){r.tt=r.n+" ("+r.ds+")";r.css=E.getUnitCssClass(r);return r;}),selectedIndices:g,useRichTooltip:true,showTooltip:function o(r,v){var u=r.target||D.eventTarget(r.hWin,r.e),t=this.getItemFromTarget(u),x=u.firstChild,w;u.setAttribute("title","");if(u.offsetWidth<x.offsetWidth||q>0){w=D.position(this.getItemNodeFromTarget(u));this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",content:t.tt,top:w.y,left:w.x+w.w+18};mstrmojo.ui.CheckList.prototype.showTooltip.apply(this,r,v);}}});b.push({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:n,children:[h],t:L[m],getSelectedItems:function(){return(h.getSelectedItems()||[]).filter(function(r){return H.find(d,"srcid",r.did)===-1;});},getUnselectedFiltersDefns:function(){var r=this;return d.filter(function(t){return !(k[t.ttl]&&k[t.ttl].completeHide)&&(H.find(h.getSelectedItems()||[],"did",t.srcid)===-1)&&(t.srct===r.t);}).sort(function(u,t){var v=function(w){return(w.fmts&&w.fmts["z-index"])||0;};return(v(u)>v(t))?1:-1;});},updateListScrollbars:function(){h.updateScrollbars();}});}Z(mstrmojo.desc(3581,"Attributes"),"att");Z(mstrmojo.desc(3582,"Metrics"),"mx");return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"showFilters",contents:b,onOpen:function(){b.forEach(function(f){f.updateListScrollbars();});},fnOk:function(){var g=[],f=[];b.forEach(function(h){g=g.concat(h.getSelectedItems());f=f.concat(h.getUnselectedFiltersDefns());});mstrmojo.all[e].model.changeFilterStackSelectors(g,f);}});}function Q(b){var c=this,a=c.model,d=a.getDataService(),e=Y({success:function(){b=!b;c.set("autoApply",b);c.defn.set("cas",b);c.widgetResized();}},a.getRebuildCallback()),Z=[];a.execute({execute:function(){var f=d.newUpdate(this);if(b){c.applyBufferedSlices(true,f,Z);}c.set("autoApply",b);c.defn.set("cas",b);f.addActions(a.getUnitFormatAction(c,1,{FormattingLayout:{CtlAutoSubmit:(b?1:0)}}));f.addCallbacks({success:mstrmojo.emptyFn});f.submit();c.widgetResized();},urInfo:{extraPuKeys:Z,callback:e}});}function C(){var g=this,e=new mstrmojo.ui.menus.MenuConfig(),h=!!this.getFilters().length,Z=mstrApp.appState===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION,f=0,k=1,d=function d(l){return !!g.getFilterDefinitions().filter(function(m){return m.ds===l;}).length;};if(!Z){if(this.model.getDatasetUnits(["mx","att"]).length){e.addEditorMenuItem(mstrmojo.desc(11815,"Add Filters"),g.id,O);}else{e.addDisabledMenuItem(mstrmojo.desc(11815,"Add Filters"));}}if(h){e.addMenuItem(mstrmojo.desc(14594,"Unset All Filters"),"cf",function(){g.clearBuffSlices();g.contents.clearAllFilter();g.applyBufferedSlices();});}e.addSeparator();if(!Z){e.addToggleMenuItem(mstrmojo.desc(11818,"Auto-apply Filters"),"atc",function(){Q.call(this,true);},function(){Q.call(this,false);},g.id,g.autoApply);e.addSeparator();var c=function(o){var p=this.ctxt,m=p.k,l=p.model,q=l.getDataService().getChangeFilteringAction(p.k,o,true,[m]),r={success:function(t){l.partialUpdate(t.data,l.getTargetDefn(m),t.defn,V(p.getFilterDefinitions()));}},n={style:{params:{treesToRender:3}}};l.execute({execute:function(){this.submit(q,r,n);},urInfo:{treesToRender:3}});};e.addMenuItem(mstrmojo.desc(11474,"Target All Filters Below"),"",function(){c.call(this,J.TARGET_ALL_BELOW);},this);e.addMenuItem(mstrmojo.desc(11473,"Clear All Targeting"),"",function(){c.call(this,J.CLEAR_TARGET);},this);e.addSeparator();}if(h){var b=d(k),a=d(f);e[b?"addMenuItem":"addDisabledMenuItem"](mstrmojo.desc(11816,"Expand All"),"fea",b?function(){g.contents.toggleFilters(false);}:null,null);e[a?"addMenuItem":"addDisabledMenuItem"](mstrmojo.desc(11817,"Collapse All"),"fca",a?function(){g.contents.toggleFilters(true);}:null,null);}if(!Z){e.addSeparator();this.addHelpTopicMenuItem(e,mstrmojo.desc(1143,"Help"),"dashboard_editor_html5_filters_panel.htm");}e.hostId=g.id;e.isHostedWithin=false;e.hostElement=g.fpsTitleBar.menuBtn.domNode;g.openPopup(e.newInstance());}mstrmojo.vi.ui.rw.FilterPanelStack=mstrmojo.declare(mstrmojo.vi.ui.BoxPanel,[mstrmojo._HasBuilder,mstrmojo._IsPanelStack,mstrmojo.vi.ui.rw._IsPanelStack,mstrmojo.vi.ui.rw._HasBufferSlice,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.rw.FilterPanelStack",markupMethods:{onvisibleChange:function(){if(this.visible){this.domNode.style.display=this.cssDisplay;this.getFilters().forEach(function(Z){Z.refresh();});}else{this.domNode.style.display="none";}}},title:"",k:"",contents:null,applyEnabled:false,editTitleOnDoubleClick:true,setOpenStatus:function K(b,Z,e,c){if(!Z){if(e){var a=this.model,d=e.actions;d.push(a.getUnitFormatAction(this,1,{FormattingAppearance:{Visible:true}}));}else{mstrmojo.vi.models.PanelFormatSaver.getPanelSaver(this.model,{visible:{set:"FormattingAppearance",name:"Visible"}},this).saveProperty("visible",true);}}this._super(b,Z,e,c);},getOpenStatus:function G(){return this.parent;},children:[{scriptClass:"mstrmojo.Box",slot:"controlNode",alias:"fpsTitleBar",cssClass:"fp-titlebar",ignoreLayout:true,children:[{scriptClass:"mstrmojo.EditableLabel",cssClass:"fp-title",alias:"fpsTitle",editOnClick:false,useRichTooltip:true,bindings:{text:function(){return this.parent.parent.title;},editOnDoubleClick:function(){return this.parent.parent.editTitleOnDoubleClick;}},updateTooltipConfig:function S(a){var b=a.target,Z=D.position(b);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:this.parent.parent.title,top:Z.y+Z.h+3,left:Z.x+4};},onTextEditComplete:function(b,Z){if(b){var a=this.parent.parent;a.titleEdited(this.text,Z);}},getLayoutOffsets:function W(){return{h:2,w:2};}},{scriptClass:"mstrmojo.Button",alias:"menuBtn",cssClass:"fp-menu",onclick:function(){C.call(this.parent.parent);}}]},{scriptClass:"mstrmojo.Box",slot:"controlNode",alias:"fpsBtnBar",cssClass:"fp-btnbar",ignoreLayout:true,bindings:{visible:"!this.parent.autoApply"},children:[N(mstrmojo.desc(134,"Apply"),function(){this.parent.parent.applyBufferedSlices();},true,{alias:"applyBtn",bindings:{enabled:"this.parent.parent.applyEnabled"}})]}],layoutConfig:{h:{controlNode:"auto",containerNode:"100%"},w:{controlNode:"100%",containerNode:"100%"},xt:true},init:function P(Z){this._super(Z);this.controller.view.attachEventListener("destroyLayout",this.id,function(b){var a=mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK;if(this.builder.getLayoutVIMap(b.key).getComponentKey(a)===this.k){this.destroy();}});this.set("title",this.model.getCurrentLayoutDef().title||"");this.set("editTitleOnDoubleClick",mstrApp.allowWebDashboardDesign());},postBuildRendering:function T(){this._super();if(this.contents){this.contents.attachEventListener("filterPanelUpdated",this.id,this.updateScrollbars);}},updateScrollbars:function X(){this._super();},getFilterDefinitions:function M(){return this.getFilters().map(function(Z){return Z.defn;});},getFilters:function B(){var Z=this.contents;return Z?(Z.children||[]).map(function(a){return a.selector;}):[];},isEmpty:function I(){var Z;try{Z=this.node.data.panels[0].objects[0];}catch(a){}return !!Z;},getFilterBySrcId:function A(Z){return this.getFilters().filter(function(a){return a.defn.srcid===Z;})[0];},widgetResized:function F(){if(this.hasRendered){this.containerNode.style.height=parseInt(this.height,10)-this.controlNode.offsetHeight+"px";}this._super();},titleEdited:function U(b,Z){var a=this.model;a.changeCurrLytTabTtl(b,Z);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.Box","mstrmojo.Label","mstrmojo.ui.CheckList","mstrmojo.vi.ui.DatasetUnitMenuUtils");mstrmojo.requiresDescs(2031,3945,3946,11505,11571,13629,13630,13860,14595);var A=mstrmojo.vi.ui.DatasetUnitMenuUtils;function D(P){var O,L=P.selector,N=P.fn(),R=N.keys,M=N.items,Q=new mstrmojo.ui.CheckList({cssClass:"units",items:M.map(function(S){S.css=A.getUnitCssClass(S);return S;}),onchange:function(){if(O){O.set("okEnabled",true);}}});Q.setSelectedItems(M.filter(function(S){return R.indexOf(S.id)>-1;}));O=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.Box({children:[{scriptClass:"mstrmojo.Label",text:P.title},Q]}),okEnabled:false,data:{},onOpen:function(){Q.updateScrollbars();},cssClass:"mstrmojo-vi-FilterBox-targets",okBtnText:mstrmojo.desc(2031,"Apply"),fnOk:function(){L.model.changeFilterTargets(L,R,Q.getSelectedItems().map(function(S){return S.id;}),L.isInFilterPanel());}});return O;}function E(){return mstrApp.appState===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;}function G(L,M){return function(N,O){var P=N!==O;if(P){L.set(M,N);}return P;};}mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu",addModeMenuItems:function F(M,L,N){if(!L.supportsInclude()){return false;}var O=function(R,P){var Q=L.include===P;M.addMenuItem(R,Q?"on":"",function(){if(!Q){L.set("include",P);this.generateToolbar();if(N){N();}}return !Q;}.bind(this));}.bind(this);O(mstrmojo.desc(3945,"Include"),true);O(mstrmojo.desc(3946,"Exclude"),false);M.addSeparator();return true;},addClearFilterMenuItem:function J(M,L,N){M.addMenuItem(mstrmojo.desc(14595,"Unset Filter"),"",function(){L.clearSelector(true);if(N){N();}});return true;},addMenuItemIfSelectTargetsValid:function I(M,L,N){if(!E()){var O=this.getTargetInfo();if(O.items.length){M.addEditorMenuItem(mstrmojo.desc(13629,"Select Targets"),this.id,D,{selector:L,fn:this.getTargetInfo.bind(this),title:N});}}},addFilterStyleMenuItem:function H(M,L){if(E()||L.isSolrSelector()){return false;}var N=L.getSelectorStyleList();if(!N.length){return false;}M.addSubMenuItem(mstrmojo.desc(11505,"Display Style"),"",this.id,function(){var P=L.defn.style,O=function(R){return function(){if(R!==P){var S=mstrmojo.DocSelector.STYLES.ATTR_QUAL;if(R===S||P===S){L.model.openSelWarnFlag(L.k);}L.model.changeFilterStyle(L,R);}};};var Q=new mstrmojo.ui.menus.MenuConfig();N.forEach(function(R){var S=R.v;Q.addMenuItem(R.n,P===S?"on":"",O(S));},this);return Q;});return true;},addMultiSelectMenuItem:function C(M,L){if(!L.allowsTogglingMultiSelect()||E()){return false;}M.addMenuItem(mstrmojo.desc(13860,"Allow Multiple Selections"),L.multi?"on":"",function(){L.model.changeFilterStyle(L,L.style,!L.multi);});return true;},addQualMenuItems:function K(M,L){if(L.isSolrSelector()||!L.isMetricSelector()||L.isRankMetricSelector()||!L.isNumericMetricSelector()){return false;}M.addRadioMenuGroup(L.qua>0?1:0,G(L,"qua"),[{value:0,text:mstrmojo.desc(11571,"Qualify on Value")},{value:1,text:mstrmojo.desc(13630,"Qualify on Rank")}],"",undefined,true);M.addSeparator();return true;},getTargetInfo:function B(){this.throwAbstractMethodError("getTargetInfo");}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.vi.ui.DatasetUnitMenuUtils");var B=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui.UnitList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.vi.ui.UnitList",init:function C(D){this._super(D);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIUnitList");},getItemProps:function A(F,D){var E=this._super(F,D);E.addCls("unit "+B.getUnitCssClass(F));return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.vi.ui.rw.selectors.AttrQualInputBox","mstrmojo.array","mstrmojo.expr","mstrmojo.date","mstrmojo.VisChartUtils","mstrmojo.locales","mstrmojo.elementHelper","mstrmojo.vi.ui.DatasetUnitMenuUtils");var M=mstrmojo.expr,F=M.BFTP,B=mstrmojo.date,G=mstrmojo.VisChartUtils,N=mstrmojo.array,K=mstrmojo.vi.ui.DatasetUnitMenuUtils,C=mstrmojo.locales;function P(R,S){if(!R){return ;}var T=B.getDateJson(new Date(G.convertRawValueToMilliseconds(R))),Q=B.formatDateInfo(T,C.datetime.DATEOUTPUTFORMAT);if(S===M.DTP.TIMESTAMP){Q+=" "+B.formatTimeInfo(T,C.datetime.TIMEOUTPUTFORMAT);}return Q;}mstrmojo.AttrQualDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.AttrQualDocSelector",getWidgetClass:function I(S,R,Q){return"vi.ui.rw.selectors.AttrQualInputBox";},newAndInitWidget:function L(Q){var R=this._super(Q);Q.attachEventListener("includeChange",R.id,function(S){this.set("include",S.value);});return R;},_buildEvent:function H(T,S){T.f=S.f;T.ft=S.ft;T.fid=S.fid;T.ckey=this.ckey;T.srcid=S.srcid;T.srct=S.srct;var R=S.dt,Q=[];N.forEach(S.cs,function(U){if(!mstrmojo.string.isEmpty(U.v)){Q.push(U.v);}});if(Q.length){T.cs=Q.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}T.dtp=R;T.unset=S.unset;if(T.unset||mstrmojo.string.isEmpty(T.cs)){delete T.fid;}},getCekEvtListener:function E(R,Q){return function(S){R.handleActionInSyncPhase(function(){Q.update(S.value);});};},updateWidget:function O(T){var U=this._super(T),R=T.node,S=R.data;if(U.update){var Q={cs:S.cs,f:S.f,ft:S.ft,fid:S.fid,min:P(S.min,S.dt),max:P(S.max,S.dt)};U.update(Q);}return U;},getWidgetConfig:function J(c,W,a,Q){var X=c.model,b=c.getFormats(),V=c.node.data,Z=this._super(c,W,a,Q);Z={scriptClass:Z.scriptClass,cssText:b.height?"height: "+b.height:"",srcid:a.srcid||"",srct:a.srct||"",cs:V.cs,min:P(V.min,V.dt),max:P(V.max,V.dt),showAdvanced:true,canSelectDisabledDate:true,f:V.f,ft:V.ft||1,fid:V.fid,dt:V.dt,onchange:function(){if(!c._inSyncPhase){c.selectorControlChange(this);}}};if(!Z.fid||!Z.dt){var U=K.getUnitFromDataset(X.datasets,a.srcid,12),Y=(U&&U.fs)||[],T,S=function(d){if(!Z.fid){Z.fid=d.fid;}if(!Z.dt){switch(d.bftp){case F.TEXT:Z.dt=M.DTP.CHAR;break;case F.DATE:Z.dt=M.DTP.DATE;break;case F.DATETIME:Z.dt=M.DTP.TIMESTAMP;break;default:Z.dt=M.DTP.CHAR;}}};if(Y[0]){S(Y[0]);}for(T=0;T<Y.length;T++){if(Y[T].iidx){S(Y[T]);break;}}}var R=Z.dt;if(Z.f===undefined){if(R===M.DTP.CHAR){Z.f=M.FN.SEARCH;}else{if(R===M.DTP.DATE||R===M.DTP.TIMESTAMP){Z.f=a.include?M.FN.BETWEEN:M.FN.NOT_BETWEEN;}}}return Z;},isValidSelection:function D(){var R=this.node.data,Q=this.model;return !Q.isSelWarnFlagOn(this.k)||R.cs&&R.cs.length;},isSelectAll:function A(){var W=this.children&&this.children[0];if(W===undefined){return true;}var R=C.datetime.DATEOUTPUTFORMAT,T=C.datetime.TIMEOUTPUTFORMAT,U=B.parseDateAndOrTime;var Q=U.call(B,W.min,R,T),X=U.call(B,W.fromBox.fromPicker.value),Y=B.compareDate(X&&X.date,Q&&Q.date);if(Y>0){return false;}if(Y===0){if(B.compareTime(X&&X.time,Q&&Q.time)>0){return false;}}var Z=U.call(B,W.max,R,T),V=U.call(B,W.toBox.toPicker.value),S=B.compareDate(V&&V.date,Z&&Z.date);if(S<0){return false;}if(S===0){if(B.compareTime(V&&V.time,Z&&Z.time)<0){return false;}}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ui.SearchablePulldown","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo.DataGrid");var B=" ReplaceObjectEditor-item ",L={REMOVE:1,KEEP:2,NO_REPLACE:3},F=mstrmojo.hash,H=mstrmojo.array,M=mstrmojo.string,A=mstrmojo.vi.ui.DatasetUnitMenuUtils,I="did";function E(O){return O.t===47&&O.st===12033;}function K(R,Q){var O=[],P=function(S){return H.find(R.cubes,"did",S)>-1;};if(R.da||R.um||R.de||E(R)){O.push({n:mstrmojo.desc(11832,"Keep existing definition"),did:L.KEEP,cls:B});}if(!Q.source.all&&R.cubes.length>1&&!(R.cubes.length===2&&P(Q.source.did)&&P(Q.target.did))){O.push({n:mstrmojo.desc(11834,"Do not replace"),did:L.NO_REPLACE,cls:B});}O.push({n:(typeof (mstrApp)!=="undefined"&&mstrApp.pageName==="rwd")?mstrmojo.desc(14556,"Remove from document"):mstrmojo.desc(11833,"Remove from dashboard"),did:L.REMOVE,cls:B});return O;}function C(T,P){var O={id:null,n:null,k:null,nr:null,r:null},S,R,Q;for(Q=0;Q<P.length;Q++){S=P[Q];R=S.did;if(S.did===T.did){O.id=S;break;}else{if(!O.n&&S.n===T.n){O.n=S;}else{switch(S.did){case L.KEEP:O.k=S;break;case L.NO_REPLACE:O.nr=S;break;case L.REMOVE:O.r=S;break;}}}}return O.id||O.n||O.k||O.nr||O.r;}function N(O){return" RepalceObjectUnit-icon ReplaceObjectUnit-"+A.getUnitCssClass(O)+" ";}function D(R,Q,P){var O=R.map(function(S){return S[Q];});return O.join(P);}mstrmojo.vi.ui.ReplaceObjectEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.ReplaceObjectEditor",source:null,target:null,conciliation:{},clearaf:false,showUnitTooltip:false,onOk:mstrmojo.emptyFn,onCancel:mstrmojo.emptyFn,onBack:mstrmojo.emptyFn,title:mstrmojo.desc(11674,"Replace Objects"),help:"replace_objects_dialog_box.htm",cssClass:"mstrmojo-ReplaceObject",getResizeHandler:function J(){var P=this,O=this._super();return mstrmojo.func.composite([O,function(){(P.dataGrid.ctxtBuilder.itemWidgets||[]).forEach(function(R){var Q=R.newObjSelector.selector.getPopupWidget();if(Q.visible){Q.adjustCornersForPopupOverflow();}});}]);},setUnits:function(Q){var P=this;["source","target"].forEach(function(R){if(Q[R]){P[R]=Q[R];}});this.conciliation={};var O=F.cloneArray(this.target.units);H.forEach(O,function(R){R.cls=(R.cls||"")+N(R)+B;});this.dataGrid.set("tgtitems",O);this.dataGrid.set("items",F.cloneArray(this.source.units));this.dataGrid.updateScrollbars();},onPreClose:function(){this.onCancel();return true;},onClose:function(){this.unrender();},children:[{scriptClass:"mstrmojo.Label",cssClass:"ReplaceObject-ExplainText",text:(typeof (mstrApp)!=="undefined"&&mstrApp.pageName==="rwd")?mstrmojo.desc(14554,"Replace or remove objects currently used in the document."):mstrmojo.desc(13288,"Replace or remove objects currently used in the dashboard.")},{scriptClass:"mstrmojo.DataGrid",alias:"dataGrid",cssClass:"ReplaceObject-DataGrid",columns:[{headerText:mstrmojo.desc(11675,"Current Objects"),headerCss:"left-unit",dataWidget:{scriptClass:"mstrmojo.Label",bindings:{text:"this.data.n",cssClass:function(){return N(this.data)+" left-unit ReplaceObject-Unit ";},useRichTooltip:"!!this.parent.dataGrid.parent.showUnitTooltip"},updateTooltipConfig:function(){var P=this.parent.dataGrid.parent.source.units,O=this.data;if(P.some(function(Q){return(Q.n===O.n)&&(Q.did!==O.did);})){this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",top:28,refNode:this.domNode,content:this.data.n+" ("+D(this.data.cubes,"name",", ")+")"};}else{this.richTooltip=null;}}}},{headerText:mstrmojo.desc(11676,"New Objects"),dataWidget:{scriptClass:"mstrmojo.HBox",alias:"newObjSelector",children:[{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:"selector",hostedCSSClass:"ReplaceObject-Pulldown-Popup",isHostedWithin:false,getPopupConfig:function(){var O=this.constructor.prototype.getPopupConfig.call(this);O.popupHandlers[this.list.id]={open:function(){var P=this.domNode;if(P.parentNode){P.parentNode.removeChild(P);}}};return O;},onitemSelected:function(O){this.selectedNode.className="mstrmojo-ui-Pulldown-text "+(O.cls||"");},postCreate:function(){var T=this.parent.data;var P=[];var R=this.parent.dataGrid.parent;var O=this.parent.dataGrid;P=mstrmojo.array.filter(O.tgtitems,function(U){return U.t===T.t&&!(E(T)&&T.did===U.did);});if(P.length){P[P.length-1]=F.clone(P[P.length-1]);P[P.length-1].cls+=" ReplaceObjectEditor-item-delimeter-above ";}var Q=K(T,R);if(Q.length){Q[0].cls+=" ReplaceObjectEditor-item-delimeter-below ";}P=P.concat(Q);var S=C(T,P);this.set("items",P);this.selectedIndex=H.find(P,I,S[I]);},postselectedIndexChange:function G(){var P=this.parent.data,Q=this.items[this.selectedIndex];var O=this.parent.dataGrid.parent;O.conciliation[P[I]]={source:P,target:Q};}}]}}]},{scriptClass:"mstrmojo.Box",cssClass:"ReplaceObject-overwrite",children:[{scriptClass:"mstrmojo.CheckBox",label:(typeof (mstrApp)!=="undefined"&&mstrApp.pageName==="rwd")?mstrmojo.desc(14555,"Clear object alias and number format on document"):mstrmojo.desc(11835,"Clear object alias and number format on dashboard"),bindings:{checked:"this.parent.parent.clearaf"},oncheckedChange:function(){var O=this.isChecked();this.parent.parent.set("clearaf",O);}}]}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function(){var S=this.parent.parent,R=[],Z={},V=[],O={},Q={};F.forEach(S.conciliation,function(c){var b=c.target,a=c.source;Z[a[I]]={source:a,target:b};if(b[I]===L.REMOVE){var d=a.dependentObjects;if(d){d.forEach(function(e){V.push({dependOn:a,dependent:e});});}}});V.forEach(function(b){var d=b.dependOn,c=b.dependent,e=Z[c.did],a=e.target;if(a[I]!==L.REMOVE){e.target={ID:L.REMOVE};Q[c.did]=c;O[d.did]=d;}});F.forEach(Z,function(d){var c=d.target,b=d.source;function a(f,e){if(b.cont_did){f.srcContDid=b.cont_did;f.srcContType=b.cont_tp;}if(e&&e.cont_did){f.tgtContDid=e.cont_did;f.tgtContType=e.cont_tp;}return f;}switch(c[I]){case L.REMOVE:R.push(a({srcid:b[I],srct:b.t}));break;case L.KEEP:case L.NO_REPLACE:break;default:R.push(a({tgtid:c[I],tgtt:c.t,srcid:b[I],srct:b.t},c));}});var P=F.valarray(O),W=F.valarray(Q),U=function U(){S.onOk(R,S.clearaf);S.close();};if(W.length){var X=P.length,T=X>=2?mstrmojo.desc(13367,"### and ##").replace("###",P.slice(0,X-1).map(function(a){return M.encodeHtmlString(a.n);}).join(", ")).replace("##",M.encodeHtmlString(P[X-1].n)):M.encodeHtmlString(P[0].n),Y=mstrmojo.desc(13368,"Deleting ## will result in removal of the following dependent objects:").replace("##",T)+"</br>"+W.map(function(a){return M.encodeHtmlString(a.n)+"</br>";}).join("")+mstrmojo.desc(13369,"Do you wish to continue?");mstrmojo.warn(Y,{confirmBtn:{t:mstrmojo.desc(1442,"OK"),fn:function(){U();}},cancelBtn:{t:mstrmojo.desc(221,"Cancel"),fn:function(){S.open();}}},{cssClass:"removeDependentConfirm",onPreClose:function(){S.open();return true;}});}else{U();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.onCancel();this.parent.parent.close();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.func","mstrmojo.VisEnum","mstrmojo.num","mstrmojo.array","mstrmojo.VisMenuList","mstrmojo.mstr.EnumFunction","mstrmojo._HasMarkup","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel","mstrmojo.css","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.ui.DatasetUnitMenuUtils");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","EditorConfig");var o=document.getElementById("vis-measure-canvas"),A=document.getElementById("vis-measure-span"),AE={},Y={},t={},S=mstrmojo.dom,d=mstrmojo.elementHelper,r=mstrmojo.vi.ui.DatasetUnitMenuUtils,AC=mstrmojo.VisEnum.EnumColorRankMode,AD=mstrmojo.chart.model.enums.EnumDSSObjectType,c=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,J=mstrmojo.chart.enums.EnumFontStyle,T=mstrmojo.hash,R=mstrmojo.func.wrapMethods,x=mstrmojo.VisEnum,e=x.SERVER_JSON_ERROR_TYPE;var q=64,f=128,O=4,m=5,w=6,z=7,k=mstrmojo,l=k.array,v=mstrmojo.array,P=k.desc,AB=k.mstr.EnumFunction,a=mstrmojo.vi.enums.EnumDerivedElementType,Z=k._HasMarkup,F=k.css;mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869);function AG(AM,AL){var AN=p.pluck(AL,"tid"),AO=p.pluck(AL,"eid"),AK=(AM.getDocModel&&AM.getDocModel())||p.getPropertyByPath(AM,"model.docModel");if(p.getPropertyByPath(AK,"getColorBy") instanceof Function){return AK.getColorBy(AN,AO);}}function AF(AK,AM,AO){var AN=AM.id,AL=AM.getHost();if(AL&&AL.observableModel){AK.forEach(function(AQ){var AP=AL.observableModel[AQ];if(AP){AP.attachEventListener("valueChanged",AN,AO);}});}}function U(AL){var AK={SINGLE:[{text:P(358,"Absolute"),value:AB.FunctionAbs,n:P(358,"Absolute"),v:AB.FunctionAbs}],PAIR:[{text:P(6017,"Add"),value:AB.FunctionAdd,n:P(6017,"Add"),v:AB.FunctionAdd},{text:P(2122,"Average"),value:AB.FunctionAverage,n:P(2122,"Average"),v:AB.FunctionAverage},{text:P(5868,"Least"),value:AB.FunctionLeast,n:P(5868,"Least"),v:AB.FunctionLeast},{text:P(5869,"Greatest"),value:AB.FunctionGreatest,n:P(5869,"Greatest"),v:AB.FunctionGreatest},{text:"A-B",value:AB.FunctionMinus+";0",n:"A-B",v:AB.FunctionMinus+";0"},{text:"B-A",value:AB.FunctionMinus+";1",n:"B-A",v:AB.FunctionMinus+";1"},{text:"A/B",value:AB.FunctionDivide+";0",n:"A/B",v:AB.FunctionDivide+";0"},{text:"B/A",value:AB.FunctionDivide+";1",n:"B/A",v:AB.FunctionDivide+";1"}],MORE:[{text:P(6017,"Add"),value:AB.FunctionAdd,n:P(6017,"Add"),v:AB.FunctionAdd},{text:P(2122,"Average"),value:AB.FunctionAverage,n:P(2122,"Average"),v:AB.FunctionAverage},{text:P(5868,"Least"),value:AB.FunctionLeast,n:P(5868,"Least"),v:AB.FunctionLeast},{text:P(5869,"Greatest"),value:AB.FunctionGreatest,n:P(5869,"Greatest"),v:AB.FunctionGreatest}]};return AK[AL];}function B(AL,AK){return !!(((AL&&AL.at)||0)&AK);}function N(AK){return !AK.selCells.some(function(AL){var AM=AK.getCellForNode(AL);return d.isNonGroupNull(AM)||!B(AM,q)||AM.dei!==undefined||AK.model.isRecursiveAttribute(AM.tid);});}function I(AL){var AK;return !AL.selCells.some(function(AM){AK=AL.getCellForNode(AM);return(d.isNonGroupNull(AK)||!B(AK,f))||AL.model.isRecursiveAttribute(AK.tid);});}function E(AN,AM,AP,AO,AL){var AK=AP&&AP.func;if((AK===AO)||(typeof AO==="string"&&AO.indexOf(AK)===0&&AO.indexOf(";0")>0)){return ;}if(AL){AN.editDECalculation(AM,AO);}else{AN.derivedElementCalculation(AM,AO);}}function M(AW,AU,AS){var AV=AU&&AU.es,AK=(AV&&AV.length)||AW.selCells.length,AN=(AK===1)?"SINGLE":((AK===2)?"PAIR":"MORE"),AT=U(AN),AM=(AU&&AU.func),AO,AX=AW.selCells,AL,AR,AQ,AP;if(AN==="PAIR"){if(AU){AP=AV[0].v>AV[1].v;if(AP){AQ=AV[0].n;AR=AV[1].n;AT[4]={value:AB.FunctionMinus+";1",v:AB.FunctionMinus+";1"};AT[5]={value:AB.FunctionMinus+";0",v:AB.FunctionMinus+";0"};AT[6]={value:AB.FunctionDivide+";1",v:AB.FunctionDivide+";1"};AT[7]={value:AB.FunctionDivide+";0",v:AB.FunctionDivide+";0"};}else{AR=AV[0].n;AQ=AV[1].n;}}else{AR=AS(AX[0]);AQ=AS(AX[1]);}AT[O].text=AR+" - "+AQ;AT[m].text=AQ+" - "+AR;AT[w].text=AR+" / "+AQ;AT[z].text=AQ+" / "+AR;AT[O].n=AR+" - "+AQ;AT[m].n=AQ+" - "+AR;AT[w].n=AR+" / "+AQ;AT[z].n=AQ+" / "+AR;}for(AO in AT){if(typeof AT[AO].value==="string"&&AT[AO].value.indexOf(AM)===0&&AT[AO].value.indexOf(";0")>0){AL=AT[AO];break;}if(AT[AO].value===AM){AL=AT[AO];break;}}return{items:AT,selectedItem:AL};}function V(AK,AN){if(!AK){return AK;}if(AN.length===1){return AK[AN[0]];}var AM=(AN&&AN.length)||0,AL;for(AL=0;AL<AM;AL++){AK=AK[AN[AL]];if(!AK){break;}}return AK;}function AA(AM,AL,AK){return AM.every(function(AN){return AN.ttp===AL||AN.ttp===AK;});}function AJ(AL,AO,AP){var AN=(AO&&AO.length)||0,AM,AK,AQ=AL;for(AM=0;AM<AN-1;AM++){AK=AO[AM];if(!AQ[AK]){AQ[AK]={};}AQ=AQ[AK];}AQ[AO[AN-1]]=AP;}function X(AS){var AT,AR,AN,AP,AK,AQ=this.model.docModel.datasets,AL=false,AO=false,AM={isDM:false};for(AT in AQ){if(AQ.hasOwnProperty(AT)){AR=AQ[AT].mx;l.forEach((AR||[]),function(AU){if(AU.did===AS){if(AU.um||AU.rdm){AO=true;}AL=true;return false;}});if(AL){break;}}}if(AO){AK=this.model.data.gts.col;AN=(AK&&AK[AK.length-1]);if(AN&&AN.otp===-1){AP=AN.es;}l.forEach((AP||[]),function(AU){if(AU.oid===AS){AM={isDM:true,id:AU.id};return false;}});}return AM;}function H(AK,AN){var AQ=[],AM={act:"updateElementsPropertiesMap",epm:AQ},AO=[],AL={},AS=[AL],AR=this;AQ.push({epmk:AO,epmv:AS});AK.forEach(function(AU){var AV=AU.tid,AT=AV===-1,AW={ob:{did:AT?"":AV}};AO.push(AW);});if(AN&&AN.indexOf("default")<0){AL.v={vv:AN};}var AP=[];AL.k={chn:AP};AK.forEach(function(AV){var AW=AV.tid,AT=AW===-1,AU;if(AT){AU=X.call(AR,AV.eid);if(AU.isDM){AP.push({emt:2,ei:AU.id});}else{AP.push({emt:2,mt:{did:AV.eid,tp:4,ql:0}});}}else{AP.push({emt:1,ei:AV.eid,at:{did:AW,tp:AV.tp,ql:0}});}});return AM;}function C(AO,AM){var AN="00000000000000000000000000000000",AL=AO&&AO.dropZones,AK=l.find(AL,"id",AM);return AK===-1?[]:l.filter(AL[AK].items,function(AP){return AP.t===4&&AP.id!==AN;});}function b(AL,AK){return function(){var AM=new k.ui.menus.MenuConfig();AM.addNonInteractiveMenuItem(mstrmojo.desc(11859,"Based on"),"xt",true);AM.addRadioMenuGroup(null,AL,AK,"checkMark",undefined,true);return AM;};}mstrmojo.VisUtility=mstrmojo.provide("mstrmojo.VisUtility",{getCache:function(){return JSON.stringify(t);},getUpdateColorMapAction:function(AL,AK){return H.call(this,AL,AK);},measureTextSize:function(AL,AK,AM){return{width:this.measureTextWidth(AL,AK,AM),height:this.measureTextHeight(AL,AK,AM)};},measureTextWidth:function(AN,AM,AO,AL,AK){if(S.isIE||S.isIEW3C){return this.measureTextWidthWithSpan(AN,AM,AO,AL,AK);}return this.measureTextWidthWithCanvas(AN,AM,AO);},measureTextWidthWithCanvas:function(AN,AO,AR,AP){AP=AP||false;if(AN===""){return 0;}if(AN===" "){AN="\u00A0";}var AQ=AO.fontFamily,AT=AO.fontSize,AM=AO.fontStyle,AS=AO.fontWeight;if(typeof AT==="number"){AT+="pt";}AM=AM||"normal";AS=AS||"normal";AR=AR||0;var AL=AP?undefined:V(AE,[AQ,AT,AM,AS,AN]);if(!AL){if(!o){o=document.createElement("canvas");o.width=0;o.height=0;o.id="vis-measure-canvas";o.style.position="absolute";o.style.top="0";o.style.fontSize="medium";document.body.appendChild(o);}var AK=o.getContext("2d");AK.font=AM+" "+AS+" "+AT+" "+AQ;AL=Math.ceil(AK.measureText(AN).width);AJ(AE,[AQ,AT,AM,AS,AN],AL);}return AL+AR;},measureTextWidthWithSpan:function(AM,AN,AR,AT,AO){if(AM===""){return 0;}if(AM===" "){AM="\u00A0";}var AP=AN.fontFamily,AU=AN.fontSize,AL=AN.fontStyle,AQ=AN.fontWeight;if(typeof AU==="number"){AU+="px";}AL=AL||"normal";AQ=AQ||"normal";AT=AT||"auto";AR=AR||0;AO=!!AO;if(typeof AT==="number"){AT+="px";}var AK=V(Y,[AP,AU,AL,AQ,AT,AM]);if(!AK){var AS;if(!A){A=document.createElement("span");AS=A.style;A.id="vis-measure-span";AS.position="absolute";AS.top="0";AS.visibility="hidden";AS.width="auto";AS.height="auto";if(AO){AS.whiteSpace="nowrap";}else{AS.whiteSpace="normal";}document.body.appendChild(A);}AS=A.style;if(AO){AS.whiteSpace="nowrap";}else{AS.whiteSpace="normal";}AS.width="auto";AS.height=AT;AS.fontFamily=AP;AS.fontSize=AU;AS.fontStyle=AL;AS.fontWeight=AQ;A.innerHTML=AM;AK=Math.ceil(A.clientWidth);AJ(Y,[AP,AU,AL,AQ,AT,AM],AK);}return AK+AR;},measureTextHeight:function(AM,AN,AS,AU,AK,AP,AO){if(AM===""){return 0;}if(AM===" "){AM="\u00A0";}var AQ=AN.fontFamily,AW=AN.fontSize,AL=AN.fontStyle,AR=AN.fontWeight;AK=AK||"normal";AO=!!AO;if(typeof AW==="number"){AW+="px";}AL=AL||"normal";AR=AR||"normal";AU=AU||"auto";AS=AS||0;if(typeof AU==="number"){AU+="px";}var AV=AP?undefined:V(t,[AQ,AW,AL,AR,AU,AM]);if(!AV){var AT;if(!A){A=document.createElement("span");AT=A.style;A.id="vis-measure-span";AT.position="absolute";AT.top="0";AT.visibility="hidden";AT.width="auto";AT.height="auto";if(AO){AT.whiteSpace="nowrap";}else{AT.whiteSpace="normal";}document.body.appendChild(A);}AT=A.style;if(AO){AT.whiteSpace="nowrap";}else{AT.whiteSpace="normal";}AT.heigth="auto";AT.width=AU;AT.fontFamily=AQ;AT.fontSize=AW;AT.fontStyle=AL;AT.fontWeight=AR;AT.wordBreak=AK;A.innerHTML=AM;AV=A.clientHeight;if(!AP){AJ(t,[AQ,AW,AL,AR,AU,AM],AV);}}return AV+AS;},getVisEmptyMsg:function(AK){var AL="";switch(AK){case"AE_ERROR":AL='<div class="gm-vis-msg-container"><div class="gm-vis-msg-vcenter"><div class="gm-vis-msg-hcenter"><div style="padding:25px"><div class="gm-warning-icon" style="padding-bottom:18px"></div><div style="padding-bottom:8px">'+mstrmojo.desc(14436,"Unable to load visualization.")+"</div><div>"+mstrmojo.desc(14437,"Use a filter to reduce the data and try again.")+"</div></div></div></div></div>";break;case"NODATA_OTHERERROR":AL='<div class="gm-vis-msg-container"><div class="gm-vis-msg-vcenter"><div class="gm-vis-msg-hcenter"><div>'+(this.errorMsg||mstrmojo.desc(12093,"Filter excludes all data"))+"</div></div></div></div>";break;default:AL='<div class="mstrmojo-Label dropMsg" style="display: block;" >'+mstrmojo.desc(11668,"Drag objects here.")+"</div>";}return AL;},applyStyles2DomNode:function(AP,AS){var AK,AQ=AP.style;if(Object.prototype.hasOwnProperty.call(AS,"backgroundColor")&&AS.backgroundColor!==""&&AS.backgroundColor!=="transparent"){var AO=1;if(Object.prototype.hasOwnProperty.call(AS,"opacity")&&AS.opacity!==""){AO=AS.opacity;}var AL=AS.backgroundColor,AR=function AR(AT){if(isNaN(AT)){AT=0;}AT%=16777216;return{b:AT%256,g:(AT>>8)%256,r:(AT>>16)%256};},AN="";if(AL){var AM=function AM(AU,AV){if(AU==="transparent"){return"rgba(0,0,0,0)";}AU=this.parseCSSColor(AU,false);var AT=AR(AU);return"rgba("+AT.r+" ,"+AT.g+" ,"+AT.b+" ,"+AV+" )";}.bind(this);if(AL.c1!==undefined&&AL.c2!==undefined&&AL.or!==undefined){AN=(F.buildGradient(AL.or,AM(AL.c1,AO),AM(AL.c2,AO))).v;}else{AN=AM(AL,AO);}AQ.background=AN;}}else{AQ.backgroundColor="rgba(0,0,0,0)";}for(AK in AS){if(AK!=="backgroundColor"&&AK!=="opacity"&&Object.prototype.hasOwnProperty.call(AS,AK)&&AS[AK]&&AS[AK]!==""){AQ[AK]=AS[AK];}}},parseCSSColor:function(AO,AL){var AK,AM;if(AO.length===7){if(AL===true){AK=AO[5]+AO[6]+AO[3]+AO[4]+AO[1]+AO[2];}else{AK=AO.slice(1);}}else{AK=[];var AN=AO.slice(1);if(AL===true){for(AM=2;AM>=0;AM--){AK.push(AN[AM]);AK.push(AN[AM]);}}else{for(AM=0;AM<3;AM++){AK.push(AN[AM]);AK.push(AN[AM]);}}AK=AK.join("");}return parseInt(AK,16);},positionDomNode:function(AM,AO){var AL,AR,AP,AN=["width","height","top","left","right","bottom"],AQ=AN.length,AK=AM.style;for(AL=0;AL<AQ;AL++){AR=AN[AL];AP=AO[AR];if(AP!==undefined){if((typeof AP)==="number"){AP+="px";}AK[AR]=AP;}}},getComputedFontStyle:function G(AM){var AK=mstrmojo.css.getComputedStyle(AM);var AN={};AN.fontFamily=AK.fontFamily;AN.fontSize=AK.fontSize;AN.fontStyle=AK.fontStyle;AN.fontWeight=AK.fontWeight;AN.fontVariant=AK.fontVariant;var AL=parseInt(AK.paddingLeft)||0,AO=parseInt(AK.paddingLeft)||0;AN.bonus=AL+AO;return AN;},splitWordIfTooLong:function(AU,AS,AN){var AQ=[];var AR=AU.length;var AO;for(AO=0;AO<AR;AO++){var AL=AU[AO];while(true){var AV=this.measureTextWidth(AL,AN);if(AV>AS){var AT=(AS/AV)*AL.length;var AK=Math.max(Math.round(AT),1);while(AK>0){var AP=AL.substr(0,AK);var AM=Math.round(this.measureTextWidth(AP,AN));if(AM<=AS||AK===1){AQ.push(AP);break;}else{AK--;}}AL=AL.substr(AK,AL.length-AK);}else{AQ.push(AL);break;}}}return AQ;},truncateTextToLineWithWordWrap:function Q(Ak,Ad,Ab,AQ,Ac,AU){var AY=Ak.split(" "),Ae=AY.length;if(!AU){AY=this.splitWordIfTooLong(AY,Ab,Ad);}var Ar,AW=[],Am=[],AK=0,AO=AY.length,At=this.measureTextWidth(" ",Ad),AN=0,AT=false,Aa=(Ae===AY.length);Am.push(0);for(Ar=0;Ar<AO;Ar++){var Ai=this.measureTextWidth(AY[Ar],Ad);if(!AU&&Ai>Ab){var AL=AY[Ar];var Ap=(Ab/Ai)*AL.length;AY[Ar]=AL.substr(0,parseInt(Ap,10));Ai=Ab;}AW.push(Ai);AK+=Ai;Am.push(AK);if(Ar!==AO-1){AK+=At;}}var Ao,Aq,Ag=AQ;for(Ao=0,Aq=0;Aq<Am.length;){var AS=Am[Aq]-Am[Ao];if(Ao>0&&Aq!==Ao){AS-=At;}var AR=Am[Aq+1]-Am[Ao];if(Ao>0&&Aq+1!==Ao){AR-=At;}if(AS<=Ab&&((Aq+1===Am.length)||(AR>Ab))){AN=Math.max(AN,AS);Ag--;if(Ag===0||Aq===AO){break;}else{Ao=Aq;Aq++;}}else{Aq++;}}if(Aq>AO){Aq=AO;}var AV=Am[Aq]-Am[Ao];if(Ao>0&&Aq!==Ao){AV-=At;}var Aj;if(Aq>=AO&&AV<Ab){Aj=AY.join(" ");}else{AT=true;AN=Ab;Aj=AY.slice(0,Aq).join(" ");var AX=this.measureTextWidth("...",Ad);if(AV+AX<=Ab){if(AV+At+AX>Ab){Aj+="...";}else{var As=AY[Aq],AZ;for(var Af=1;Af<As.length;Af++){AZ=this.measureTextWidth(As.substr(0,Af),Ad);if(AV+At+AZ+AX>Ab){break;}}Aj+=" "+As.substr(0,Af-1)+"...";}}else{if(Aj.charAt(Aj.length-1)===" "){Aj=Aj.substr(0,Aj.length-1);}var Ah=Aj.lastIndexOf(" ");var AM=Aj.length-1-Ah;if(AM===3){Aj=Aj.substr(0,Aj.length-3)+" ...";}else{var Al=0,AP="",An=0;while(Al<AX&&Aj.length>An){An++;AP=Aj.substr(Aj.length-An,Aj.length);Al=this.measureTextWidth(AP,Ad);}Aj=Aj.substr(0,Aj.length-An)+"...";}}}if(Ac){return{text:Aj,truncated:AT,maxLineLen:AN,canWordWrap:Aa};}return Aj;},measureSuperTextWidth:function AI(AL,AM,AK,AN){return AL?this.measureTextWidth("<sup>"+AM+"</sup>",AK,AN):this.measureTextWidth(AM,AK,AN);},splitTokenIfTooLong:function h(AV,AT,AN){var AR=[];var AS=AV.length;var AO,AL,AW,AQ,AX;for(AO=0;AO<AS;AO++){AL=AV[AO];AQ=AL.isSuper;while(true){AW=AL.v;if(AL.textWidth!==undefined){AX=AL.textWidth;}else{AX=AL.textWidth=this.measureSuperTextWidth(AQ,AW,AN);}if(AX>AT){var AU=(AT/AX)*AW.length;var AK=Math.max(Math.round(AU),1);while(AK>0){var AP=AW.substr(0,AK);var AM=Math.round(this.measureSuperTextWidth(AQ,AP,AN));if(AM<=AT||AK===1){AR.push({v:AP,isSuper:AQ,textWidth:AM});break;}else{AK--;}}AL={v:AW.substr(AK,AW.length-AK),isSuper:AQ};}else{AR.push(AL);break;}}}return AR;},truncateTextToLineWithWordWrapForTokens:function W(AU,AO,An,Af,Ao,Aa){var Ai=AU.length;AU=this.splitTokenIfTooLong(AU,An,AO);var Am,AZ=[],AK=0,Ad=AU.length,AL=0,Ae=false,AQ=(Ai===AU.length),AS,AX,Ag,AM,Ak,AT,AY;if(Aa&&!AQ){return{canWordWrap:AQ};}AZ.push(0);for(Am=0;Am<Ad;Am++){AS=AU[Am];Ag=AS.v;AX=AS.isSuper;if(AS.textWidth!==undefined){AM=AS.textWidth;}else{AM=AS.textWidth=this.measureSuperTextWidth(AX,Ag,AO);}if(AM>An){var Al=(An/AM)*Ag.length;AS.v=Ag.substr(0,parseInt(Al,10));AM=AS.textWidth=An;}AK+=AM;AZ.push(AK);}var AW,Ah,AV=Af;for(AW=0,Ah=0;Ah<AZ.length;){var AR=AZ[Ah]-AZ[AW];var AP=AZ[Ah+1]-AZ[AW];if(AR<=An&&((Ah+1===AZ.length)||(AP>An))){AL=Math.max(AL,AR);AV--;if(AV===0||Ah===Ad){break;}else{AW=Ah;Ah++;}}else{Ah++;}}if(Ah>Ad){Ah=Ad;}var Ac=AZ[Ah]-AZ[AW];var Ap;if(Ah>=Ad&&Ac<An){Ap=AU;}else{Ae=true;AL=An;Ap=AU.slice(0,Ah);var AN=this.measureTextWidth("...",AO);if(Ac+AN<=An){AT=AU[Ah];Ag=AT.v;AX=AT.isSuper;for(Ak=1;Ak<Ag.length;Ak++){AY=this.measureSuperTextWidth(AX,Ag.substr(0,Ak),AO);if(Ac+AN+AY>An){break;}}if(Ak>1){AS={v:Ag.substr(0,Ak-1),isSuper:AX};AS.textWidth=this.measureSuperTextWidth(AX,AS.v,AO);Ap.push(AS);Ap.push({v:"...",textWidth:AN});}}else{var Ab=0,Aj;for(Am=Ap.length-1;Am>=0;Am--){AS=Ap[Am];Ag=AS.v;AX=AS.isSuper;Aj=0;for(Ak=Ag.length-1;Ak>=0;Ak--){Aj=this.measureSuperTextWidth(AX,Ag.substr(Ak),AO);if(Ab+Aj>=AN){break;}}if(Ak>=0){break;}else{Ab+=Aj;}}if(Am>=0){if(Ak>0){AS.v=Ag.substr(0,Ak);AS.textWidth=this.measureSuperTextWidth(AX,AS.v,AO);Ap=Ap.slice(0,Am+1);}else{if(Ak===0){Ap=Ap.slice(0,Am);}}Ap.push({v:"...",textWidth:AN});}else{Ap=[{v:"...",textWidth:AN}];}}}if(Ao){return{text:Ap,truncated:Ae,maxLineLen:AL,canWordWrap:AQ};}return Ap;},getRankMode:function g(AQ){var AS=1,AR=2,AP=3,AL=4,AN=5,AK=6,AO=7,AM=AC.INVALID;if(AQ){if(AA(AQ,AP,AR)){AM=AC.TOP_PERCENT;}else{if(AA(AQ,AP,AS)){AM=AC.BOTTOM_PERCENT;}else{if(AA(AQ,AK,AL)){AM=AC.BOTTOM;}else{if(AA(AQ,AK,AN)){AM=AC.TOP;}else{if(AA(AQ,AO)){AM=AC.VALUE;}}}}}}return AM;},getColorByTitle:function L(AL,AK){if(AK===AC.BOTTOM_PERCENT||AK===AC.TOP_PERCENT){AL=mstrmojo.desc(2787,"Percentage of ##").replace("'##'",AL);}else{if(AK===AC.BOTTOM||AK===AC.TOP){AL=mstrmojo.desc(2788,"Rank of ##").replace("'##'",AL);}}return AL;},getColorByFormatStr:function u(AL,AK){if(AK===AC.BOTTOM_PERCENT||AK===AC.TOP_PERCENT){AL="0%;(0%)";}else{if(AK===AC.BOTTOM||AK===AC.TOP){AL="";}}return AL;},getColorByItems:function AH(AK,AU,Ab,AX,AS,AQ,AY){var AW=[],Ac,AM,AR=mstrmojo.num,AP,AT;if(AK===undefined||AK.length===0){return AW;}var Ae=true;if(AK.length>1){if(AK[0].ceil===AK[1].flr){Ae=false;}else{Ae=true;}}for(Ac=0;Ac<AK.length;Ac++){var Ad=AK[Ac],AO={},AL=Ad.ceil,Aa=Ad.flr;if((Ac===0&&Ae)||(Ac===AK.length-1&&!Ae)){if(AU===AC.BOTTOM_PERCENT||AU===AC.TOP_PERCENT){AO.flr=Aa/100;AO.ceil=1;}else{if(AU===AC.TOP||AU===AC.BOTTOM){Aa+=1;AO.flr=Math.floor(Aa);AO.ceil=AS;}else{AO.flr=Aa;AO.ceil=Ab;}}AT=AO.ceil;}else{if((Ac===0&&!Ae)||(Ac===AK.length-1&&Ae)){if(AU===AC.BOTTOM_PERCENT||AU===AC.TOP_PERCENT){AO.flr=0;AO.ceil=AL/100;}else{if(AU===AC.TOP||AU===AC.BOTTOM){AO.flr=0;AO.ceil=Math.floor(AL);}else{AO.flr=AX;AO.ceil=AL;}}AP=AO.flr;}else{if(AU===AC.BOTTOM_PERCENT||AU===AC.TOP_PERCENT){Aa=Aa/100;AL=AL/100;}else{if(AU===AC.TOP||AU===AC.BOTTOM){Aa+=1;Aa=Math.floor(Aa);AL=Math.floor(AL);}}AO.flr=Aa;AO.ceil=AL;}}if(AU===AC.TOP||AU===AC.BOTTOM){AO.ceil=AO.ceil>AS?AS:AO.ceil;}if(AQ){AO.label=AR.formatByMask(AQ,AO.flr)+" - "+AR.formatByMask(AQ,AO.ceil);}else{AO.label=AO.flr+" - "+AO.ceil;}if(Ad.fmt&&Ad.fmt.bc){AO.color=Ad.fmt.bc;}else{AO.color=AY;}AW.push(AO);}AW=AW.filter(function(Af){return Af.flr<=Af.ceil&&!(Af.flr>AT||Af.ceil<AP);});if(AU===AC.TOP||AU===AC.BOTTOM){AM=AS;}else{if(AW.length>0){if(Ae){AM=AW[0].ceil-AW[(AW.length-1)].flr;}else{AM=AW[(AW.length-1)].ceil-AW[0].flr;}}}var AZ=0,AV,AN;for(Ac=0;Ac<AW.length;Ac++){if(Ac===AW.length-1){AW[Ac].scopePercent=1-AZ;}else{if(AU===AC.TOP||AU===AC.BOTTOM){AN=AW[Ac].ceil-AW[Ac].flr+1;}else{AN=AW[Ac].ceil-AW[Ac].flr;}AV=AN/AM;AW[Ac].scopePercent=AV;AZ+=AV;}}return AW;},getDefaultColorByItems:function(AN,AL,AM){var AK={};AK.label=AM+" - "+AL;AK.flr=AM;AK.ceil=AL;AK.color=AN;AK.scopePercent=1;return[AK];},getNumberFormat:function(AN,AL){var AO=AN.nf,AM=AN.gvs;function AK(){var AR=(AM&&AM.items&&AM.items[0]&&AM.items[0].items)||[],AQ=AR[AL]||{},AP=AQ.nfs;return typeof AP==="string"?AP:"";}if(typeof AO[AL].nfs!=="string"){AO[AL].nfs=AK();}return AO[AL].nfs;},hasOnlyMetricsOnColumn:function(AL){var AK=(AL&&AL.gts&&AL.gts.col)||[];return AK.every(function(AM){return AM.otp===AD.DssTypeUnknown&&(AM.es||[]).every(function(AN){return AN.otp===AD.DssTypeMetric;});});},hasNoMetricOnRow:function(AL){var AM=(AL&&AL.gts&&AL.gts.row)||[],AK=function(AN){return AN.otp!==AD.DssTypeMetric;};return AM.every(AK);},isOnExpressMode:function(){return mstrApp.isExpress;},modifyScExp:function(AS,AK,AW,AQ){if(!AS||!AK){return ;}var AN=AS.nds,AR,AL,AT,AV,AU,AP,AO,AM;v.forEach(AN||[],function(AX){AR=AX.nds;v.forEach(AR||[],function(AY){AL=AY.es;v.forEach(AL||[],function(AZ){AV=AZ.v;AP=AQ[AV];if(!AP){AP=AW.getNormalizedFormElementId(AV);AQ[AV]=AP;}v.forEach(AK||[],function(Aa){AT=Aa.es;v.forEach(AT||[],function(Ab){AM=false;AU=Ab.id;if(AU===AV){AM=true;}else{AO=AQ[AU];if(!AO){AO=AW.getNormalizedFormElementId(AU);AQ[AU]=AO;}if(AP===AO){AM=true;}}if(AM){AZ.v=Ab.id;AZ.n=Ab.n;return false;}});if(AM){return false;}});});});});},modifyScExpDeprecated:function(AQ,AR,AO,AM){if(!AQ||!AR){return ;}var AN=AQ.nds,AL,AK,AP;v.forEach(AN||[],function(AS){AL=AS.nds;v.forEach(AL||[],function(AT){AK=AT.es;v.forEach(AK||[],function(AU){v.forEach(AR||[],function(AV){v.forEach(AV||[],function(AW){AP=AW.es;v.forEach(AP||[],function(AX){if(AO.call(AM,AX.id,AU.v)){AU.v=AX.id;AU.n=AX.n;}});});});});});});},getMouseOffset:function(AL){var AK=(AL.offsetX!==undefined)?AL.offsetX:(AL.layerX),AM=(AL.offsetY!==undefined)?AL.offsetY:(AL.layerY);return{x:AK,y:AM};},translateLineStyle:function(AK){var AM=["none","solid","solid","dashed","dotted"],AL=["1px","1px","2px","1px","1px"];return{width:AL[AK]||"0px",style:AM[AK]||"none"};},getGroupAndCalculationContextMenuForDataPoints:function(AT,Ah){var AV,AX=[],AM=[],Ae=[],AR=Ah.fnCellName,AZ=Ah.fnUnique,AQ=Ah.fnMakeNode,Ac=AT.getCellForNode.bind(AT),Aj=Ah.selection;var AP=new k.ui.menus.MenuConfig(),AL=new k.ui.menus.MenuConfig(),Ab=new k.ui.menus.MenuConfig(),Ag=new k.ui.menus.MenuConfig();function Ai(Ak){AT.selCells=AX[Ak].selCells;AT.derivedElementGroup(Ac(AT.selCells[0]));}function AS(Am){AT.selCells=AM[Am].selCells;var Al=Ac(AM[Am].selCells[0]),Ak=AT.getDEInfo(Al);AT.derivedElementsEdit(Ac(AT.selCells[0]),Ak);}function AY(Al){AT.selCells=AM[Al].selCells;var Ak=Ac(AM[Al].selCells[0]);AT.removeQuickDE(Ak);}function AW(Al){AT.selCells=AM[Al].selCells;var Ak=Ac(AM[Al].selCells[0]);AT.renameDEList(Ak);}function Aa(Ak){E(AT,Ac(AT.selCells[0]),null,Ak,false);}function AK(Ak){E(AT,Ac(AT.selCells[0]),null,Ak,true);}function AO(Al){var Ak=Ac(AM[Al].selCells[0]);AT.removeQuickDE(Ak);}function Af(Al){var Ak=Ac(AM[Al].selCells[0]);AT.editDECalculation(Ak);}function AU(Ak){Ak=Ak||[];function Al(Ap){var Am=Ap.extra||{},Aq=Ap.setup||mstrmojo.emptyFn,An=Ap.action||mstrmojo.emptyFn,Ao=[];Aq(Ao,Am);An(Ao,Am);}Ak.forEach(Al);}var AN=[{name:"group",setup:function(Ak){AX.forEach(function(Al){AT.selCells=AX[Al.v].selCells;if(!Object.prototype.hasOwnProperty.call(AM,Al.v)&&N(AT)){Ak.push(Al);}});},action:function(Al){var Ak;if(Al.length===1){Ak=Al[0].v;AP.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){AT.selCells=AX[Ak].selCells;AT.derivedElementGroup(Ac(AT.selCells[0]));});}if(Al.length>1){AP.addPopupMenuItem(mstrmojo.desc(1911,"Group"),AT.id,b(Ai,Al),"xt");}}},{name:"edit-group",setup:function(Ak){AM.forEach(function(Ao){var An=Ac(AM[Ao.v].selCells[0]),Am=AT.getDEInfo(An),Al=Am&&Am.de;if(Al&&Al.t===a.LIST){Ak.push(Ao);}});},action:function(Al){var Ak,An,Am;if(Al.length===1){Ak=AM[Al[0].v].selCells;An=Ac(Ak[0]);Am=AT.getDEInfo(An);AL.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){AT.selCells=Ak;AT.derivedElementsEdit(Ac(AT.selCells[0]),Am);});AL.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){AT.selCells=Ak;AT.removeQuickDE(An);});Ag.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){AT.selCells=Ak;AT.renameDEList(An);});}if(Al.length>1){AL.addPopupMenuItem(mstrmojo.desc(13395,"Edit Group..."),AT.id,b(AS,Al),"xt");AL.addPopupMenuItem(mstrmojo.desc(12195,"Ungroup"),AT.id,b(AY,Al),"xt");Ag.addPopupMenuItem(mstrmojo.desc(13968,"Rename Group..."),AT.id,b(AW,Al),"xt");}}},{name:"calculation",setup:function(Ak){Ae.forEach(function(An,Am,Al){AT.selCells=Al[An.v].selCells;var Ap=Ac(AT.selCells[0]),Ao=AT.getDEInfo(Ap),Aq=Ao&&Ao.de;if(!(Aq&&Aq.t===a.RESIDUE)&&I(AT)){Ak.push(An);}});},action:function(Ak){if(Ak.length===1){AP.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),AT.id,function(){var Al=Ak[0].v,Am=new k.ui.menus.MenuConfig();AT.selCells=Ae[Al].selCells;Am.addRadioMenuGroup(null,Aa,M(AT,null,AR).items,"checkMark",undefined,true);return Am;},"xt");}if(Ak.length>1){AP.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),AT.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:Ak,selectedIndex:0,onitemSelected:function(Al){var Am=Al.v;AT.selCells=Ae[Am].selCells;this.parent.checkList.set("items",[]);this.parent.checkList.set("items",M(AT,null,AR).items);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(Am,Al){E(AT,Ac(AT.selCells[0]),null,Al.checkList.selectedItem.v,false);}});});}}},{name:"edit-calculation",setup:function(Ak){AM.forEach(function(Ao){var An=Ac(AM[Ao.v].selCells[0]),Am=AT.getDEInfo(An),Al=Am&&Am.de;if(Al&&Al.t===a.CALCULATION){Ak.push(Ao);}});},action:function(Ak){function Al(){var Am=Ak[0].v;AT.selCells=AM[Am].selCells;var Aq=Ac(AT.selCells[0]),Ap=AT.getDEInfo(Aq),Ar=Ap&&Ap.de,Ao=M(AT,Ar,AR),An=new k.ui.menus.MenuConfig();An.addRadioMenuGroup(Ao.selectedItem.value,AK,Ao.items,"checkMark",undefined,true);return An;}if(Ak.length===1){Ab.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),AT.id,Al,"xt");Ab.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){var Am=Ak[0].v;AT.selCells=AM[Am].selCells;var An=Ac(AT.selCells[0]);AT.removeQuickDE(An);});Ag.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){var Am=Ak[0].v;AT.selCells=AM[Am].selCells;var An=Ac(AT.selCells[0]);AT.editDECalculation(An);});}if(Ak.length>1){Ab.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),AT.id,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:Ak,selectedIndex:0,onitemSelected:function(Ap){var Aq=Ap.v;AT.selCells=AM[Aq].selCells;var Ao=Ac(AT.selCells[0]),An=AT.getDEInfo(Ao),Ar=An&&An.de;var Am=M(AT,Ar,AR);this.parent.checkList.set("items",[]);this.parent.checkList.set("items",Am.items);this.parent.checkList.set("selectedItem",Am.selectedItem);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(An,Am){E(AT,Ac(AT.selCells[0]),null,Am.checkList.selectedItem.v,true);}});});Ab.addPopupMenuItem(mstrmojo.desc(12197,"Delete Calculation"),AT.id,b(AO,Ak),"xt");Ag.addPopupMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),AT.id,b(Af,Ak),"xt");}}}];AV=AZ(Aj);AV.forEach(function(Al){var An=AQ(Al),Ak=Ac(An),Am,Ao,Ap;if(!AT.model.supportsViewFilterActions(Ak.tid)){return ;}Am=Ak.dei===undefined?AX:AM;Ao=Ak.tid;Ap=AT.model.getObjectInfo(Ao).n;if(Am[Ao]===undefined){Am[Ao]={};Am[Ao].selCells=[];Am.push({n:Ap,v:Ao,text:Ap,value:Ao});}Am[Ao].selCells.push(An);if(Ae[Ao]===undefined){Ae[Ao]={};Ae[Ao].selCells=[];Ae.push({n:Ap,v:Ao,text:Ap,value:Ao});}Ae[Ao].selCells.push(An);});var Ad=this.getPropertyByPath(AT,"model.data.visName")||this.getPropertyByPath(AT,"model.data.vis.vn");if(Ad==="VIHeatMapVisualizationStyle"){AN.splice(2,2);}AU(AN);return{createDe:AP,editGroup:AL,editCalculation:Ab,renameDe:Ag};},getGroupAndCalculationContextMenu:function(AS,Ag,Ad){var Af=AS,AZ=Ad.skipSingleAttrCheck||Af.isSingleAttrSelection(),AN=false,AP=Af.isSingleSelection(),AT=Af.getDEInfo(Ag),AO=AT&&AT.deObject,Ac=AT&&AT.de,AX=AO&&Af.getOthersDEInfo(AO),AV=Af.getSelections(),Ab=true,AR=Ad.fnCellName,Ae=this.getPropertyByPath(Af,"model.data.visName")||this.getPropertyByPath(Af,"model.data.vis.vn");var AQ=new k.ui.menus.MenuConfig(),AL=new k.ui.menus.MenuConfig(),AW=new k.ui.menus.MenuConfig(),Aa=new k.ui.menus.MenuConfig();Af.selCells=Ad.selection;if(AS.model.supportsViewFilterActions(Ag.tid)){if((AN||AZ)&&B(Ag,q)&&N(Af)){AQ.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){AS.derivedElementGroup(Ag);});}if(AP&&Ac&&Ac.t===a.LIST){AL.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){AS.derivedElementsEdit(Ag,AT);});AL.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){AS.removeQuickDE(Ag);});Aa.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){AS.renameDEList(Ag);});}var AU=function(Ah){E(Af,Ag,Ac,Ah,false);},AY=function(Ah){E(Af,Ag,Ac,Ah,true);};if(AX&&!AP&&AZ){l.forEach(AV,function(Ah){if(Ah[0]&&Ah[0].eid.indexOf(AX.id)>-1){Ab=false;return false;}});}if(Ae!=="VIHeatMapVisualizationStyle"&&!(AP&&Ac&&Ac.t===a.RESIDUE)&&(AN||AZ)&&B(Ag,f)&&I(Af)){var AK=function(){var Ah=new k.ui.menus.MenuConfig(),Ai=M(Af,null,AR);Ah.addRadioMenuGroup(null,AU,Ai.items,"checkMark",undefined,true);return Ah;};AQ.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),this.id,AK,"xt");}if(AP&&Ac&&Ac.t===a.CALCULATION){var AM=function(){var Ah=new k.ui.menus.MenuConfig(),Ai=M(Af,Ac,AR);Ah.addRadioMenuGroup(Ai.selectedItem.value,AY,Ai.items,"checkMark",undefined,true);return Ah;};AW.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),this.id,AM,"xt");AW.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){AS.removeQuickDE(Ag);});Aa.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){AS.editDECalculation(Ag);});}}return{createDe:AQ,editGroup:AL,editCalculation:AW,renameDe:Aa};},isHostedPopupNode:function(AO,AM,AL,AK){var AP=AL?AO:AO&&AO.parentNode;while(AP&&(AP!==AK)){var AN=AP.getAttribute&&AP.getAttribute(AM);if(AN!==null&&AN.indexOf("mstrmojo-popup-widget-hosted")>=0){return true;}AP=AP.parentNode;}return false;},applyStyle2Legend:function(AN,AM,AL){var AK,AP={},AO={};for(AK in AN){if(AK.indexOf("font")>=0||AK.indexOf("color")>=0||AK.indexOf("textDecoration")>=0){AP[AK]=AN[AK];}else{AO[AK]=AN[AK];}}if(AM){AM.style.background="";this.applyStyles2DomNode(AM,AO);}if(AL){this.applyStyles2DomNode(AL,AP);}},mergeMenuConfigs:function K(AL,AK){function AM(AO,AP,AN){if(!AP){return ;}if(!AN&&AO.hasMenuItems()&&AP.hasMenuItems()){AO.addSeparator();}if(AP.hasMenuItems()){AO.absorbMenuItems(AP);}}return AK.reduce(function(AN,AO){AM(AN,AL[AO.name],AO.noSeparator);return AN;},new mstrmojo.ui.menus.MenuConfig());},absorbMenuItems:function(AL,AK,AM){AL.addDisposable(AK);AL.absorbMenuItems(AK);if(AM&&AK.menus.length>0){AL.addSeparator();}},addWheelListener:(function(){var AN=mstrmojo.dom,AM=AN.attachEvent,AL=AN.preventDefault,AO;function AK(AS,AR,AT,AQ){var AP=(AO==="wheel")?AT:function(AU){if(!AU){AU=window.event;}var AW={originalEvent:AU,target:AU.target||AU.srcElement,type:"wheel",deltaMode:(AU.deltaMode!==undefined?AU.deltaMode:1),deltaX:0,deltaZ:0,preventDefault:function(){AL(window,AU);}},AV=this;if(AO==="mousewheel"){AW.deltaY=-AU.wheelDelta;if(AU.wheelDeltaX!==undefined){AW.deltaX=-AU.wheelDeltaX;}}else{AW.deltaY=AU.detail;}return AT.call(AV,AW);};return AM(AS,AR,AP,AQ);}if(Object.prototype.hasOwnProperty.call(document.createElement("div"),"onwheel")){AO="wheel";}else{AO=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";}return function(AQ,AR,AP){return AK(AQ,AO,AR,AP);};}()),isNearZero:function(AL,AK){AK=AK||5;var AM=1/Math.pow(10,AK);return(Math.abs(AL)<AM);},hasMergedRowCells:function(AK){return false;},getMockUpThresholds:function(AM,AN){var AK=[{tid:1,n:"threshold 0",scope:1,rtp:2,rtxt:"",fmt:{bc:"#cc2525",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,flr:0,ceil:10},{tid:2,n:"threshold 1",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e34b4b",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5},{v:"30%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:10,ceil:30},{tid:3,n:"threshold 2",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e97d7d",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"30%",dtp:5},{v:"50%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:30,ceil:50},{tid:4,n:"threshold 3",scope:1,rtp:2,rtxt:"",fmt:{bc:"#79d479",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"50%",dtp:5},{v:"70%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:50,ceil:70},{tid:5,n:"threshold 4",scope:1,rtp:2,rtxt:"",fmt:{bc:"#57ba57",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"70%",dtp:5},{v:"90%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:70,ceil:90},{tid:6,n:"threshold 5",scope:1,rtp:2,rtxt:"",fmt:{bc:"#2ca02c",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"90%",dtp:5}],fn:5,fnt:3}],fn:19},ttp:1,flr:90,ceil:100}];l.forEach(AK,function(AP){var AO=AP.expr.nds[0].m;AO.did=AM;AO.n=AN;});var AL={};AL[AM]=AK;return AL;},generateThresholdsInfo:function(AM,AR,AK,AO){var AQ=AK.length,AL=[],AU,AN,AV=0,AT=0;for(var AP=0;AP<AQ;AP++){AN=Math.round(AO[AP]*100);AT=AV;AV=AN||100;AU={tid:AP+1,n:"threshold "+AP,scope:1,rtp:2,rtxt:"",fmt:{bc:AK[AP],bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:AM,n:AR},cs:[{v:AN+"%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,ceil:AV,flr:AT};AL.push(AU);}var AS={};AS[AM]=AL;return AS;},psPt2CssPt:function(AM,AL){var AK=parseInt(AM,10)*0.75;if(AL instanceof Function){AK=AL(AK);}return AK+"pt";},captureEventOnce:function(AP,AO,AK,AN,AM){function AL(AQ){AO.call(AK,Z.newDomEvent(AP,window,AQ||window.event),AM);S.detachEvent(AN,AP,AL);}AM=AM||{};AN=AN||document;S.attachEvent(AN,AP,AL);},getPropertyByPath:function(AO,AN,AK){var AL,AM;if(typeof AN!=="string"){return AK;}AL=AN.split(".");AM=AL.every(function(AQ){var AP=AO[AQ];if(AP!==undefined){AO=AP;return true;}return false;});return AM?AO:AK;},mergeHashes:function(){return Array.prototype.slice.apply(arguments).reduce(function(AK,AL){if(AL){Object.keys(AL).forEach(function(AM){AK[AM]=AL[AM];});}return AK;},{});},toggleControlEnabled:function(AK,AL){[].concat(AK).forEach(function(AM){AM.set("enabled",!!AL);});},findInArray:function(AN,AM,AL){var AP=-1,AO,AK;if(!Array.isArray(AN)){return AP;}for(AO=AL===undefined?0:AL,AK=AN.length;AO<AK;AO+=1){if(AM(AN[AO])){return AO;}}return AP;},arrayUnique:function(AK,AL){if(!Array.isArray(AK)){return AK;}return AK.filter(function(AM,AN){return p.findInArray(AK,function(AO){return AL(AM,AO);},AN+1)===-1;});},range:function(AK,AO,AN){AN=AN||1;var AM,AL=[];for(AM=AK;AM!==AO;AM+=AN){AL.push(AM);}return AL;},drawDashLine:function D(AS,AM,AQ,AL,AO,AK,AR){var AP=(AM===AL),AN;AS.beginPath();AS.moveTo(AM,AQ);if(AP){AN=0;AQ+=AK;while(AQ<=AO){if(AN%2===0){AS.lineTo(AM,AQ);AQ+=AR;}else{AS.moveTo(AM,AQ);AQ+=AK;}AN++;}if(AN%2===0){AS.lineTo(AL,AO);}}else{AN=0;AM+=AK;while(AM<=AL){if(AN%2===0){AS.lineTo(AM,AQ);AM+=AR;}else{AS.moveTo(AM,AQ);AM+=AK;}AN++;}if(AN%2===0){AS.lineTo(AL,AO);}}AS.stroke();},repeat:function(AM,AN){var AK=[],AL;AN=Math.max(0,AN);for(AL=0;AL<AN;AL+=1){AK[AL]=AM;}return AK;},isHierarchyObject:function(AK){return(AK&&AK.t)===AD.DssTypeDimension;},selectPropertyPanel:function(AL,AM){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AL.getDocModel().selectVIUnit(AL.parent.id,true);var AK=AL.edtModel;if(AK){AK.selectTargetByValue(AM);}},pluck:function(AL,AK){if(!l.isArray(AL)){return AL;}return AL.map(function(AM){return AM&&AM[AK];});},pick:function(AL,AK){return AK.reduce(function(AN,AM){AN[AM]=AL[AM];return AN;},{});},isColorManuallySet:function(AM,AL){var AK=AG(AM,AL);if(AK){return AK.isManual;}},getCombColor:function(AM,AL){var AK=AG(AM,AL);if(AK){return AK.color;}},setColorPickerShowAutomatic:function(AL,AK){AL.children[0].fillColor.colorPicker.showAutomatic=AK;},getCharGroupValueChangeCb:function(AK){var AL=(function(){var AM={};AM[c.FONT_WEIGHT]=J.FS_BOLD;AM[c.FONT_STYLE]=J.FS_ITALIC;AM[c.UNDERLINE]=J.FS_UNDERLINE;AM[c.LINE_THROUGH]=J.FS_STRIKETHROUGH;return function(AN,AO){return AN^AM[AO];};}());return function(AN,AM){if(AK instanceof Function){AK=AK();}if(!AK){return ;}switch(AN){case c.COLOR:AK.fontColor.fill.value.setValue(AM);break;case c.FONT_SIZE:AK.fontSize.setValue(AM);break;case c.FONT_FAMILY:AK.fontFamily.setValue(AM);break;case c.FONT_WEIGHT:case c.FONT_STYLE:case c.UNDERLINE:case c.LINE_THROUGH:AK.fontStyle.setValue(AL(AK.fontStyle.getValue(),AN));break;}};},getMetricsInDropZone:C,addLegendFontChangeListeners:function(AL,AM){var AK=["lgdFntClr","lgdFntSz","lgdFntFml","lgdFntStyle"];AF(AK,AL,AM);},addLegendBackgroundChangeListeners:function(AL,AM){var AK=["lgdBgFillClr","lgdBgFillTrans"];AF(AK,AL,AM);},isValidDropZone:function(AK){if(AK===undefined){return false;}var AM=Object.keys(AK).filter(function(AN){return AN!=="visProp";});var AL=T.copyProps(AM,AK);return AK&&!T.equals(AL,{});},getDrillCandidates:function(AP){var AM=AP.modelData,AN=AP.model,AL=AN.docModel.datasets,AK=AM.gts,AO=AM.datasetId,AQ=AL[AO],AR=AQ.att||[];return AR.filter(function(AU){var AT=AU.did,AV=AK.row||[],AS=AK.col||[];return AV.concat(AS).every(function(AW){return AW.id!==AT&&AU.hide!==true;});});},getDrillMenuItemsCallback:function(AL,AM,AK){return function(){var AO=p.getDrillCandidates(AL),AN=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350});AO.forEach(function(AP){AN.addMenuItem(AP.n,"xt",AM,T.copy(AK,{drillUnit:AP}));});return AN;};},doDrill:function(AM,Aa,AV,Ab){var Ac=AM;function AS(Ae){return Ae.model.controller.cmdMgr;}function AY(){return{success:function Ae(){p.visPrint("reaise");this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}var AL=Ac.model,AZ=(Ac.getDocModel&&Ac.getDocModel())||Ac.model.docModel,AX=AZ.getDataService(),AP=AX.newUpdate();var AR=true;if(AZ.prefs&&AZ.prefs.rtprnt){AR=parseInt(AZ.prefs.rtprnt,10)===1;}else{if(AL.xtab.defn.tkp!==undefined){AR=parseInt(AL.xtab.defn.tkp,10)===-1;}}Ab=Ab||{};Ab.keepParent=AR;var AQ=AV.call(AM,Aa,Ab);var AT=Ac.zonesModel,Ad=AT.getUpdateCallback(),AU=Ac.model.controller||AZ.controller,AN=AU._getXtabCallback(Ac);AP.add(AQ,R(Ad,AN));var AK=AL.getSelectorDataFromViewFilter(Ac.model.data.vfexpr).concat({keepOnly:true,data:Ac.getSelections()}),AW=AZ.getKeepOnlyOrExcludeAction(Ac.k,AK);AP.add(AW,AY.call(Ac));AS(Ac).execute({execute:function AO(){this.submitUpdate(AP);},urInfo:{callback:AP.callback}});},strStartsWith:function(AM,AL,AK){AK=AK||0;return AM.lastIndexOf(AL,AK)===AK;},changeWidgetBackground:function(AM,AN,AL){var AK=AM.parent;if(AK&&AN!==AL){AK.changeUnitFormats(false,1,AM.getFormats(),c.BACKGROUND_COLOR,AN,AL);AK.raiseEvent({name:"BEMFormatChange",propertyName:c.BACKGROUND_COLOR,value:AN,isTitle:false});}},translateGridError:function(AL,AK){if(AK===undefined){AK=e.AE_ERROR;}if(AK===e.EMPTY_DATA){AL=mstrmojo.desc(12093,"Filter excludes all data");}if(AK===e.NO_DATASET||AK===e.NO_TEMPLATE_UNIT){AL=mstrmojo.desc(11668,"Drag objects here.");}if(!AL){AL=mstrmojo.desc(13687,"Unknown error");}return{msg:AL,type:AK};},hasValidValueInMetric:function(AM,AK){var AL=p.getPropertyByPath(AM,"model.data.gsi.mx");if(AL===undefined||AL.length<=AK||AK<0){return false;}var AN=AL[AK];return["min","max"].every(function(AO){var AP=AN[AO];return AP!==undefined&&AP!==null&&AP!=="";});},renderWidgetErrorRSD:function(AN,AP,AL){var AR=document.createElement("div");var AQ='<div style="display: table; height: 100%; width: 100%; background-color:#F5F5F2; border: solid 1px #A7A7A7; box-sizing: border-box;"><div style="display: table-cell; vertical-align: middle; text-align: center; color: #000000; font-size: 14pt;">'+AP+"</div></div>";AR.innerHTML=AQ;AR=AR.firstChild;var AK=AN.width,AM=AN.height;if(AK!==undefined){AR.style.width=AK+"px";}if(AM!==undefined){AR.style.height=AM+"px";}var AO=AN.domNode;if(AO){AL.forEach(function(AS){AO["on"+AS]=undefined;});while(AO.firstChild){AO.removeChild(AO.firstChild);}AO.appendChild(AR);}else{AN.parent.domNode.appendChild(AR);}},visPrint:function(){var AK=mstrmojo.VisUtility.enableInVis;if(AK&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},hasCGorCon:function(AN,AK){var AM=AK&&AK.did,AL=AN.model.data.datasetId||"",AO=null;if(AM){AO=r.getDatasetFromAttributeId(AN.model.docModel.datasets,AM);}else{if(AL){AO=r.getDatasetFromId(AN.model.docModel.datasets,AL);}}return AO&&r.hasCGorCon(AO);},findElementsByAttribute:function n(AM,AO,AN,AK){AK=!!AK;var AP=[];if(AN.constructor!==Array){AN=[AN];}var AQ=function(AR){if(AK){return AR.identity&&AR.identity.tlOpt&&AR.identity.tlOpt[AO];}else{return AR.getAttribute(AO);}};function AL(AT){var AR=AQ(AT),AS;if(AT.hasChildNodes()){AS=AT.firstChild;while(AS){if(AS.nodeType===1){AR=AQ(AS);if(AN.indexOf(AR)!==-1){AP.push(AS);}else{AL(AS);}}AS=AS.nextSibling;}}}AL(AM);return AP;}});mstrmojo.VisUtility.enableInVis=true;var p=mstrmojo.VisUtility;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.DatasetUnitMenuUtils");var A=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui._CanDropFromSchema=mstrmojo.provide("mstrmojo.vi.ui._CanDropFromSchema",{_mixinName:"mstrmojo.vi.ui._CanDropFromSchema",augmentDropContextForSchema:function B(E,C){var F=E.getCtxtDragData();if(F.src===mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST){var D=A.getCfgForAddUnitFromAllObject(F.items,C.datasets||{});F.dsid=D.dsid;if(D.actions.length){E.actions=D.actions;E.callback=C.getDatasetsUpdateCallback();}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.elementHelper","mstrmojo.mstr.EnumFunction","mstrmojo.rw.xtab.XtabMenuConfig","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.NumberFormatterEditor","mstrmojo.vi.ui.CalculationMenuEditor","mstrmojo.vi.enums.EnumDerivedElementType","mstrmojo.array");mstrmojo.requiresDescs(14388,14717);var R=mstrmojo.hash,N=mstrmojo.array,d=mstrmojo.elementHelper,W=mstrmojo.vi.enums.EnumDerivedElementType,G=mstrmojo.vi.ui.DatasetUnitMenuUtils,b=mstrmojo.mstr.EnumFunction;var U=mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES,O=U.GROUP,f=U.CALCULATION,c=2,T=3,h=1;function I(){return(mstrApp.appState===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION);}function E(k){if(!k||!k.items||!k.data||!k.xtab){return{};}var p=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,isHostedWithin:false,alignWithAnchor:true,maxHeight:350}),l=k.items,n=k.data,o=k.xtab,m=[];if(mstrApp.rootCtrl.resolveFeature("sort-drill-paths")){l.sort(function(r,q){if(r.n>q.n){return 1;}if(r.n<q.n){return -1;}return 0;});}l.forEach(function(r,q){if(m.indexOf(r.id)===-1){m.push(r.id);if(r.att){p.addPopupMenuItem(r.n,this.id,E,"xt",{items:l[q].att,data:n,xtab:o});}else{p.addMenuItem(r.n,"xt",function(){o.drill(n,l[q]);});}}});return p;}function V(r){var z=r.xtab,n=r.data,o=z.model,q=o.getAllDrillWithinPathsForCell(n,undefined,true),t=q.length,p=o.docModel,l=p.datasets[o.data.datasetId],AA,u=[],w=-1,v,x,m,k;if(l&&p.isMDXDataset(l)){q.sort(function(AC,AB){AC.did=AC.id;AB.did=AB.id;if(AC.id<AB.id){return -1;}if(AC.id>AB.id){return 1;}return 0;});AA=l.tables[0];AA.dimensions.forEach(function(AB){m=true;v=-1;AB.hierarchies.forEach(function(AC){k=true;AC.att.forEach(function(AD){x=N.findBin(q,AD,"did",t);if(x!==-1){if(m){u.push({id:AB.did,n:AB.n,att:[]});w++;m=false;}if(k){u[w].att.push({id:AC.did,n:AC.n,att:[]});v++;k=false;}u[w].att[v].att.push(q[x]);}});});});}else{u=q;}return E({items:u,data:n,xtab:z});}function Z(l){var o=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:250});var n=l.xtab,m=l.deObject,k=l.groups;k.forEach(function(q,p){if(q.t===W.LIST&&!q.ido){o.addMenuItem(q.n,"",function(){n.addElementsToGroup(m,k[p],p,n.getSelections());});}});return o;}function B(l){var k=l&&l.des;return !!k&&k.some(function(m){return(m.t===W.LIST&&!m.ido);});}function D(k,p,m){var l=false,o=undefined;if(p){l=!d.isNonGroupNull(k.data)&&this.isActionAvailable(k.data,O)&&k.de===undefined;}else{if(m){var n=Q.call(this,k);l=n.isActionAvailable;o=n.group;}}return{isAddToGroupSupported:l,group:o};}function Q(l,n){var o,q=undefined,p=l.xtab,r=0,m=p.selCells;var k=m.filter(function(t,u){return m.indexOf(t)===u;});o=!k.some(function(t){var u=p.getCellForNode(t);if(!d.isNonGroupNull(u)&&this.isActionAvailable(u,O)){if(u.dei!==undefined){q=p.getDEInfo(u).de;if(q.t!==W.LIST||++r>1){return true;}}return false;}else{return true;}},this);if(n){o=(o)?!!q:o;}return{isActionAvailable:o,group:(o)?q:undefined};}function F(k){var l=k.xtab;return !l.selCells.some(function(m){var n=l.getCellForNode(m);return d.isNonGroupNull(n)||!this.isActionAvailable(n,O)||n.dei!==undefined;},this);}function L(l){var k;return !l.selCells.some(function(m){k=l.getCellForNode(m);return(d.isNonGroupNull(k)||!this.isActionAvailable(k,f));},this);}function M(n){var k=G.generateNumberFormat(n&&n.de&&n.de.nf),o=R.clone(k),q=R.clone(k),l=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.vi.ui.NumberFormatter({myData:o,oldData:q,formatValue:k}),data:o}),m=this.delegateActionToXtab;R.make(o,mstrmojo.Obj);R.make(q,mstrmojo.Obj);l.fnOk=function p(){m(n,"editQuickDECalculationNumberFormat",R.copy(this.data,{de:n.de}));};return l;}function X(p){var AB=new mstrmojo.ui.menus.MenuConfig(),t=4,AE=5,z=6,l=7,AC=" - ",r=" / ",v={SINGLE:[{n:mstrmojo.desc(358,"Absolute"),v:b.FunctionAbs}],PAIR:[{n:mstrmojo.desc(6017,"Add"),v:b.FunctionAdd},{n:mstrmojo.desc(2122,"Average"),v:b.FunctionAverage},{n:mstrmojo.desc(5868,"Least"),v:b.FunctionLeast},{n:mstrmojo.desc(5869,"Greatest"),v:b.FunctionGreatest},{n:"A-B",v:b.FunctionMinus+";0"},{n:"B-A",v:b.FunctionMinus+";1"},{n:"A/B",v:b.FunctionDivide+";0"},{n:"B/A",v:b.FunctionDivide+";1"}],MORE:[{n:mstrmojo.desc(6017,"Add"),v:b.FunctionAdd},{n:mstrmojo.desc(2122,"Average"),v:b.FunctionAverage},{n:mstrmojo.desc(5868,"Least"),v:b.FunctionLeast},{n:mstrmojo.desc(5869,"Greatest"),v:b.FunctionGreatest}]},AA=p.isEdit,AD=AA&&p.de,AH=p.data,AF=AD&&AD.es,AG=p.xtab,x=AA?(AF&&AF.length):AG.getSelectionSize(),k=(x===1)?"SINGLE":((x===2)?"PAIR":"MORE"),w=v[k],q=(AD&&AD.func),o;if(k==="PAIR"){if(AA&&AD){w[t].n=AF[0].n+AC+AF[1].n;w[AE].n=AF[1].n+AC+AF[0].n;w[z].n=AF[0].n+r+AF[1].n;w[l].n=AF[1].n+r+AF[0].n;}else{o=this.xtab.selCells;var m=o[0].innerText||o[0].textContent,u=o[1].innerText||o[1].textContent;w[t].n=m+AC+u;w[AE].n=u+AC+m;w[z].n=m+r+u;w[l].n=u+r+m;}}w.forEach(function(n){var AJ=n.v,AI=AA&&((typeof AJ==="string"&&AJ.indexOf(q)===0&&AJ.indexOf(";0")>0)||AJ===q);AB.addMenuItem(n.n,"xt "+(AI?"checked":""),function(){var AL=p.xtab,AK=AD&&AD.func;if((AD&&AK===AJ)||(typeof AJ==="string"&&AJ.indexOf(AK)===0&&AJ.indexOf(";0")>0)){return ;}if(p.isEdit===true){AL.editDECalculation(AH,AJ);}else{AL.derivedElementCalculation(AH,AJ);}});},this);return AB;}function K(m){var z=m.xtab,p=m.data,r=z.getDEInfo(p),o=r&&r.deObject,x=r&&r.de,t=x&&x.t,v=o&&z.getOthersDEInfo(o),l=m.singleCellClick,q=z.isSingleAttrSelection(),u=true,n=z.getSelections(),k=z.isSingleSelection(),w={de:x,xtab:z,data:p,td:m.td,singleClick:l};if(v&&!k&&q){n.forEach(function(AA){if(AA[0]&&AA[0].eid.indexOf(v.id)>-1){u=false;return false;}});}if(!(k&&t===W.RESIDUE)&&(l||q)&&this.isActionAvailable(p,f)&&L.call(this,z)&&u){this.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,X,R.copy(w,{isEdit:false}));}}function a(){var o=this.xtab,k=o.model,m=this.selectedData,l=o.getSelections(),n=!m.olap;if(l.length>0){l.forEach(function(p){p.forEach(function(q){n=n&&k.supportsViewFilterActions(q.tid);});});}else{n=n&&k.supportsViewFilterActions(k.getCellTitleInfo(m).title.id);}if(m.mix!==undefined){n=n&&k.getCellDataUnion(m).every(function(p){return k.supportsViewFilterActions(p.tid);});}return n;}function g(k){return k&&k.mix!==undefined&&!!k._e;}function H(k){return k&&k.otp===12;}function J(k){var p=k.data,q=this.xtab,m=q.model,r=g(p),o=r?p._e:m.getCellTitleInfo(p).title,l=!r&&o.otp===-1,n;if(l){N.forEach([p._lp,p._tp],function(u){var v=u;while(v&&v!==v._p&&!n){if(v.stt){continue;}var t=m.getCellTitleInfo(v),z=t.title,x=z&&z.id;if(x&&z.ost===12033){var w=q.getDEInfo(v),AA=w&&w.de;if(AA&&AA.t===W.CALCULATION&&AA.nf&&Object.keys(AA.nf).length>0){n={de:AA,xtab:q,data:v,td:k.td,singleClick:k.singleClick};break;}}v=v._p;}return !n;});}if(!n){if(l){o={oid:m.data.gsi.mx[p.mix].did,otp:4};}n={did:o.oid||o.id,t:o.otp,stp:o.ost,fs:o.fs};}return n;}function C(m,k){var l=m&&k.td&&m.getCellForNode(k.td);if(g(l)){l.id=l._e.oid;l.otp=l._e.otp;}return l;}function P(m){var n=m.de?m:J.call(this,m),o=n.de,p=m.xtab,l=p.model,t,k,r,q=l.id;if(o){if(p.isSingleSelection()&&o.t===W.CALCULATION){t=true;r=n;k=M;q=this.id;}}else{t=l.showNumberFormat(n);r={item:n};k=l.getNumberFormatEditorCfg;}if(t){this.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),q,k,r);}}mstrmojo.vi.ui.rw.xtab.XtabMenuConfig=mstrmojo.declare(mstrmojo.rw.xtab.XtabMenuConfig,null,{scriptClass:"mstrmojo.vi.ui.rw.xtab.XtabMenuConfig",buildXtabMenuConfig:function A(v){var u=this.xtab=v.xtab,AU=I(),o=u.model,Ac=this.selectedData=v.data=v.data||C(u,v),Ab=G.getDatasetFromAttributeId(o.docModel.datasets,Ac.id),AJ=!!Ac.stt,AM=Ac.otp,AW=Ac.ost,AY=o.getCellTitleInfo(Ac),AR=u.zonesModel,AQ=AR.id,l=AR.docModel,AO={did:Ac.id,t:AM},AZ=this.delegateActionToXtab,Aa=u.isSingleAttrSelection(),q=v.singleCellClick,AI=a.call(this),AV=u.getDEInfo(Ac),AG=AV&&AV.deObject,t=AV&&AV.de,w=t&&t.t,AT=o.isRecursiveAttribute(Ac.id||AY.title.id),m=u.isSingleSelection(),AN={de:t,xtab:u,data:Ac,cfg:v,td:v.td,singleClick:q},r=mstrmojo.desc(190,"Remove"),AC,z,x=!Ab||!l.isMDXDataset(Ab);this.selectedNode=v.td;if(v.onClose){this.addPopupHandlers(u.id,mstrmojo.emptyFn,v.onClose);}var AB=u.model.getAttributeFormsInTemplate(Ac.id||AY.title.id).length,n=Ac.fix;if(AB>1&&!AV){var p="pivot";if(!H(Ac)){n=AY.title.fix||(AN.data.fi||0)+1;p+="Form";}if(n){if(n>1){this.addMenuItem(mstrmojo.desc(5362,"Move Left"),"",function(){AZ(AN,p,["l"]);});}if(n<AB){this.addMenuItem(mstrmojo.desc(5363,"Move Right"),"",function(){AZ(AN,p,["r"]);});}this.addSeparator();}}if(AT&&!AJ){if(H(Ac)){this.addMenuItem(mstrmojo.desc(14655,"Expand All Levels"),"",function(){AZ(AN,"raExpandAll",[true]);});this.addMenuItem(mstrmojo.desc(14656,"Collapse All Levels"),"",function(){AZ(AN,"raExpandAll",[false]);});}else{this.addMenuItem(mstrmojo.desc(14669,"Expand All Lower Levels"),"",function(){AZ(AN,"raExpandDescendants");});}}if(!AU){if(g(Ac)&&Ac.um){this.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){AZ(AN,"derivedMetric",["edit"]);});}if(H(Ac)){if(u.getDerivedAttribute(Ac.id)&&x){this.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){AR.editDerivedAttribute({item:{did:AO.did,t:AO.t,n:Ac.n}});});}}if(this.isActionAvailable(Ac,U.GROUP_EDIT)&&AG){this.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"",function(){AZ(AN,"derivedElementsEdit",[AV]);});}if(m&&w===W.CALCULATION){this.addSubMenuItem(mstrmojo.desc(12196,"Edit Calculation"),"",this.id,X,R.copy(AN,{isEdit:true}));}}this.addSeparator();this.addSortMenuItem(AN);if(u.model.getAllDrillPathsForCell(Ac).length>1){this.addSeparator();}if(!AU){if(m&&w===W.LIST){this.addSeparator();this.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"",function(){AZ(AN,"derivedElementsEdit",AV);});}if((m&&w===W.LIST)||(Aa&&!m&&Q.call(this,AN,true).isActionAvailable)){this.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"",function(){AZ(AN,"removeQuickDE",AV);});}if(m&&w===W.RESIDUE){this.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"",function(){AZ(AN,"separateOthers",[t]);});}if(H(Ac)&&!AR.isDynamicLink(AO)){this.addSeparator();if((!Ab||!G.hasCGorCon(Ab))&&x){this.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){AZ(AN,"newDerivedAttribute");});this.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){AZ(AN,"newDynamicLinkAttr");});}if(this.isActionAvailable(Ac,U.GROUP_EDIT)&&!AG&&!AT){this.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"",function(){AZ(AN,"derivedElementsEdit",[AV]);});}this.addSeparator();}}if(!AJ&&this.isActionAvailable(Ac,U.KEEP_ONLY)&&AI){this.addSeparator();var AE=function(Ae){return function(){AZ(AN,"keepOnlyOrExclude",[Ae]);};};this.addMenuItem(mstrmojo.desc(11701,"Keep Only"),"",AE(true));this.addMenuItem(mstrmojo.desc(3946,"Exclude"),"",AE(false));}if(!AJ){this.addDrillMenuItem(AN);}if(Ac&&Ac.mix===undefined&&AY.isSrcTitle&&AM!==-1&&AM!==1&&!(AM===47&&AW===12032)){this.addShowTotalMenuItem(AN);}var AK=Ac.axis;if(!AU){if(AR.shouldShowDisplayFormsMenu(AO)){this.addPopupMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return G.getDisplayFormsMenu(AO,u,u.model.docModel.datasets,function(Ae){AR.submitDropZoneUpdates(Ae);});});}this.addSeparator();if((q||Aa)&&this.isActionAvailable(Ac,O)&&F.call(this,AN)&&!AT){this.addMenuItem(mstrmojo.desc(1911,"Group"),"",function(){AZ(AN,"derivedElementGroup");});}var AP=B(AG)&&D.call(this,AN,m,Aa);if(!!AP.isAddToGroupSupported){this.addAddToGroupMenuItem(AN.xtab,AG,AP.group);}if(g(Ac)){var AF=u&&v.td&&u.getCellForNode(v.td)._e,AX={did:AF.oid,t:AF.otp},AH={zone:{id:-1,items:u.model.data.gsi.mx},axis:AK,idx:Ac.idx,item:AX};this.addSeparator();if(l.findDatasetIdFromUnit(AX.did)&&!l.isFromSolrCube(AX.did)&&!l.isFromMDXCube(AX.did)){this.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",AQ,AR.getAggregateByMetricSubMenu,AH);this.addSeparator();}this.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",AQ,AR.getCalculationEditorCfg,AH);this.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",AQ,AR.getShortcutMetricSubMenu,AH);this.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){AZ(AN,"derivedMetric",["editNew"]);});}if(!g(Ac)&&!AM&&!AT){K.call(this,v);}this.addSeparator();if(!AJ){P.call(this,AN);}if(g(Ac)||H(Ac)){this.addThresholdMenuOptions(AN);}}if(g(Ac)){this.addToggleMenuItem(mstrmojo.desc(6193,"Show Totals"),"",function(){AR.showQuickSubtotals();},function(){AR.hideDefinedSubtotals();},null,AR.hasVisibleSubtotals());}if(!AJ&&this.isActionAvailable(Ac,U.KEEP_ONLY)&&AI){this.addSeparator();this.addMenuItem(mstrmojo.desc(13537,"Show Data..."),"",function(){mstrmojo.vi.ui.ViewDataDialog.open(u.parent,true);});}var k=u.gridData.gts,AS,AD=[k.rowSubPos,k.colSubPos],AL,Ad;if(AJ){Ad=AK===h;AL=AD[AK-1];if(AL===c){AS=Ad?mstrmojo.desc(12206,"Move to Bottom"):mstrmojo.desc(13900,"Move to Right");AD[AK-1]=T;}else{AS=Ad?mstrmojo.desc(12205,"Move to Top"):mstrmojo.desc(13901,"Move to Left");AD[AK-1]=c;}this.addMenuItem(AS,"",function(){o.moveSubTotals(AN,AD);});}if(this.isActionAvailable(Ac,U.TOTAL_HEADER)&&Ac.mix===undefined){AC=function(){AZ(AN,"removeTotal");};}if(!AU&&m&&w===W.LIST){z=function(){AZ(AN,"renameDEList",AV);};}if(m&&w===W.CALCULATION){z=function(){this.delegateActionToXtab(AN,"editDECalculation");}.bind(this);AC=function(){this.delegateActionToXtab(AN,"removeQuickDE",AV);}.bind(this);r=mstrmojo.desc(12197,"Delete Calculation");}this.addSeparator();if(!AU&&!AJ){var AA=u.parent;if(AA.addFormatMenuItem){AA.addFormatMenuItem(this,{info:AY,isMetricHeader:g(Ac)},function(Ae){var Af=u.highlightFormatTarget(Ae);u.openPopup(u.edtModel.getFormattingToolbar(Ae,v.td,{onClose:function(){u.restoreHighlights(Af);}}));});}}if((AY&&AY.isSrcTitle)||g(Ac)){this.addPopupMenuItem(mstrmojo.desc(14003,"Replace with"),AQ,AR.getReplaceSubMenu,"",{zone:AR.getZoneForObject(AY.title.id||Ac.id),item:AO});}if(z){this.addMenuItem(mstrmojo.desc(2453,"Rename..."),"",z);}if(AC){this.addMenuItem(r,"",AC);}if(!AU){if((AY&&AY.isSrcTitle)||g(Ac)){if(!z){this.addMenuItem(mstrmojo.desc(2453,"Rename..."),"",function(){AZ(AN,"renameUnit");});}if(!AC){this.addMenuItem(r,"",function(){AZ(AN,"removeUnit");});}}}if(u.isCopySupported&&!AJ&&!H(Ac)&&!g(Ac)){this.addSeparator();this.addMenuItem(mstrmojo.desc(14388,"Copy Rows"),"",function(){AZ(AN,"copyRowsFromXtab",[u.selCells]);});}},addAddToGroupMenuItem:function(n,l,m){var k=(l&&l.des)||[];this.addPopupMenuItem(mstrmojo.desc(14553,"Add to Group"),this.id,Z,"",{xtab:n,deObject:l,groups:m?[m]:k});},addDrillMenuItem:function Y(k){var o=k.xtab,n=k.data,l=o.model.getUnHiddenDrillPathsForCell(n),m=l.length;if(!(g(n)||n.mix!==undefined)){if(m>1){this.addSubMenuItem(mstrmojo.desc(145,"Drill"),"",this.id,V,k);}else{if(m===1){this._super(k,l[0]);}else{this.addNonInteractiveMenuItem(mstrmojo.desc(145,"Drill"),"",true);}}}},getSubtotalEditorConfig:function e(l){var k=this._super(l),m=l.data,n=l.xtab;k.fnOk=n.getOnSubtotalsChangeFn(k,m);return k;},addThresholdMenuOptions:function S(l){var k=l.data._e||l.data,m={did:k.oid||k.id,t:k.otp,n:k.n};this.xtab.model.buildThresholdMenuOptions(this,{item:m},false,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.models.DatasetDoubleClick","mstrmojo.vi.models._CheckDataCards","mstrmojo.vi.util.TemplateUtils");var Q=mstrmojo.hash,d=mstrmojo.array,u=mstrmojo.func,V=mstrmojo.vi.util.TemplateUtils,o=mstrmojo.vi.ui.DatasetUnitMenuUtils,T="00000000000000000000000000000000",e=mstrmojo.vi.models.EnumDragSources,S=mstrmojo.chart.model.enums.EnumDSSObjectType;var U={ABOVE:0,ON:1,BELOW:2};mstrmojo.vi.models.DropZoneItemType=null;mstrmojo.vi.models.DropZoneType=null;mstrmojo.vi.models.DropZonesEditorConfigType=null;function G(AE,AA,AC,AF,AI,AD,AG,AH){var AB={act:AE,zoneId:AA,unitId:AC,unitType:AF};if(AI!==undefined){AB.unitPos=AI+1;}if(AH!==undefined){AB.is_disableonly=AH;}if(AD){AB.datasetId=String(AD);AB.datasetType=String(AG);}return AB;}function L(AA){return function(AB){var AC=[{t:AA,did:NaN}];return !!this.getAllowDropInfo(AB,AC,AB.items.length-1,U.BELOW,{src:{data:{src:e.DATASETS}}}).allowedItems.length;};}mstrmojo.vi.models.DropZonesModel=mstrmojo.declare(mstrmojo.Obj,[mstrmojo.vi.models._CheckDataCards],{scriptClass:"mstrmojo.vi.models.DropZonesModel",hostId:"",docModel:null,getDropZones:mstrmojo.emptyFn,getDZFlatStruct:function I(){var AD=this.getHost().model.data,AE=AD.gsi||{},AA=(AE.rows||[]).concat(AE.cols||[]),AC={},AB={};AA.forEach(function(AF){if(AF.hasOwnProperty("st")&&AF.hasOwnProperty("did")){AC[AF.did]=AF.st;}});if(AD.dz){Object.keys(AD.dz).forEach(function(AH){var AF=AD.dz[AH],AG=(AF.TemplateUnit||[]).concat(AF.TemplateMetric||[]);AG.forEach(function(AI){var AJ=AI.id;if(AI.st===undefined&&AC.hasOwnProperty(AJ)){AI.st=AC[AJ];}});AB[AH]=AG;});}return AB;},getAvatarIconClass:function Y(){throw new Error(this.scriptClass+" must implement getAvatarIconClass method.");},canSwapAxis:function n(){return false;},swapAxis:function A(){if(this.canSwapAxis()){throw new Error(this.scriptClass+" must implement swapAxis method if this.canSwapAxis returns true.");}},canDefineSubtotals:function(){return false;},getZoneMenuItems:function q(AB,AA){},getUnitMenuItems:function f(AB,AA,AD,AC){},getMultiUnitsMenuItems:function c(AB,AA,AC){var AD=this.id;if(o.getMultiSelectionShortcutMetricFunctions(AC).length){AB.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[AD].getMultipleMetricsCalcMenus(AA,AC,true);});}AB.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[AD].deleteItems(AA,AC);});},deleteItem:function H(AB,AA){this.throwAbstractMethodError("deleteItem");},deleteItems:function H(AA,AB){this.throwAbstractMethodError("deleteItems");},addZoneItem:function b(AC,AD){AC.t=AC.t||4;if(AC.did===undefined){AC.did=AC.id;}var AA=V.findUnitsById(this.getHost().model.data.gsi,AC.did)[0];if(AA){Q.copyProps(["n","um"],AA,AC);}if(AC.t===12||AC.t===47||AC.t===4){var AB=this.docModel.datasets,AF=false,AE=AC.t===4?"mx":"att";Object.keys(AB).every(function(AG){(AB[AG][AE]||[]).every(function(AH){if(AH.did===AC.did){AF=true;var AI;for(AI in AH){if(!AC.hasOwnProperty(AI)){AC[AI]=AH[AI];}}}return !AF;});return !AF;});}AD.push(AC);},getZone:function p(AF,AE,AD,AA,AB){var AC=[];(AD||[]).forEach(function(AG){this.addZoneItem(Q.copy(AG),AC,AB);},this);return{n:AF,id:AE,enabled:!AA,cssClass:(AB&&AB.allowSingle)?"singleUnitZone":"",getDropIconCls:function(){return"pivot";},title:(AB&&AB.title)||"",items:AC};},getZoneForObject:function O(AB){var AA=null;this.getDropZones().zones.every(function(AC){if(d.find(AC.items,"did",AB)>-1){AA=AC;return false;}return true;});return AA;},getUnitIndexInZone:function l(AA,AB){return d.find(AA.items,"did",AB.did);},isZoneDropAllowed:function R(AA){if(!AA.enabled){return false;}return true;},getAllowDropInfo:function C(AB,AC,AA,AD){return{allowedItems:AC.concat(),removeReplaced:AD===U.ON&&d.find(AC,"did",AB.items[AA].did)===-1};},getTargetEdgePortion:function M(AA){return 0.33;},allowInsertNewMetric:L(4),allowInsertNewAttribute:L(12),unitsDropped:function v(AA,AB,AC,AE,AD){if(this.unitDropped!==mstrmojo.vi.models.DropZonesModel.prototype.unitDropped){return this.unitDropped(AA,AB,AC.idx,AC.edge,AE,AD);}this.throwAbstractMethodError("unitsDropped");},getHost:function Z(){return mstrmojo.all[this.hostId];},getHostModel:function B(){this.throwAbstractMethodError("getHostModel");},shouldMetricNameShowIcon:function z(){return true;},addUnitsFromDataSource:function F(AH,AF,AC,AB){var AE=this.docModel.controller,AA;AC=AC||[];var AD=false,AJ=this.getHost(),AG=[],AK;[].concat(AH).forEach(function(AL){AK=this.isMetric(AL);AD=AK||AD;AA=mstrmojo.vi.models.DatasetDoubleClick.addObject(AL,AF,this);AC=AC.concat(AA);if(AK){AG.push(AL);}},this);if(AC&&AC.length){if(AD&&AA&&AA[0].actions){AA[0].actions.push(AJ.model.getValuesDefaultFormatGridZoneAction(AG));}var AI=AE._getXtabCallback(this.getHost());if(AB){AI=u.wrapMethods(AB,AI);}if(this.existLargeOrManyItems()){this.warnAndExecCallBackForAddUnits(function(){AE.submitUndoRedoUpdates(AC,{},AI);});return ;}AE.submitUndoRedoUpdates(AC,{},AI);}},changeZoneUnits:function m(AB,AA,AC){},getZoneAddCandidates:function X(AA){return[];},getRequiredItemsInfo:function g(AB){if(!AB){return 0;}var AA=[];this.getDropZones().zones.forEach(function(AC){AA=AA.concat(AC.items);});return Number(AA.reduce(function(AC,AD){if(parseInt(AD.did,10)!==-1&&AD.t===AB){return AC+1;}return AC;},0));},getUpdateCallback:function P(){var AB=this.getHost().parent.k,AA=this.docModel;return{success:function(){AA.getPanel().getUnitByKey(AB).selectVIUnit(true);}};},getUpdateTemplateAction:function K(AA){return this.docModel.getDataService().getUpdateTemplateAction(this.getHost().k,AA);},getReplaceCandidates:function J(AA,AC){var AB=[],AF=AC.t,AE=AC.did,AD=this.getHostModel().datasetId;this.getDropZones().zones.forEach(function(AG){((AG&&AG.items)||[]).forEach(function(AI){var AJ=AI.t,AH=AI.did;if(AJ!==21&&AH!=="-1"&&AH!==T&&((AJ===4&&AF===4)||(AJ!==4&&AF!==4))&&AH!==AE&&d.find(AB,"did",AH)===-1){AB.push(AI);}});});if(AD){this.docModel.getDatasetUnits(AF===4?["mx"]:["att"],null,AD).forEach(function(AG){if(d.find(AB,"did",AG.did)===-1&&AG.did!==AE&&!AG.hide){AB.push(AG);}});}return o.getSortedDatasetUnits(AB);},getDropTargetIndex:function D(AB,AD){var AA=AD.idx,AC=(AD.edge===U.ON&&!AD.removeReplaced)?U.BELOW:AD.edge,AF=AA,AE=this,AG={};AD.allowedItems.forEach(function(AI){var AH=AE.getUnitIndexInZone(AB,AI);if(AH!==-1){AG[AH]=AI;}});Q.forEach(AG,function(AI,AJ){var AH=parseInt(AJ,10);if(AH<AA){AF--;}else{if(AH===AA){AC=U.ON;}}});return AC===U.BELOW?(AF+1):AF;},getAddDropZoneUnitAction:function k(AB,AD,AA,AC){return G("addDropZoneUnit",AB.id,AD.did,AD.t,AA,AC&&AC.datasetId,(AC&&AC.datasetType)||S.DssTypeReportDefinition);},getAddDropZoneUnitsActions:function x(AB,AC,AA,AD){return AC.reverse().map(function(AE){return G("addDropZoneUnit",AB.id,AE.did,AE.t,AA,AD&&AD.datasetId,(AD&&AD.datasetType)||S.DssTypeReportDefinition);});},getRemoveDropZoneUnitAction:function W(AA,AB,AC){return G("removeDropZoneUnit",AA.id,AB.did,AB.t,undefined,undefined,undefined,AC);},checkAndAddThresholdAction:function t(AC,AA,AB){return false;},getAllZones:function(){return this.getDropZones().zones||[];},getClearAllUnitsActions:function N(){var AA=[];(this.getAllZones()).forEach(function(AB){((AB&&AB.items)||[]).forEach(function(AC){AA.push(this.getRemoveDropZoneUnitAction(AB,AC));},this);},this);return AA;},getClearAllUnitsUnTemplateActions:function a(){return[];},clearAllDropZones:function r(AJ){var AC=this.getClearAllUnitsActions(),AE=this.getClearAllUnitsUnTemplateActions(),AL=this.getHost(),AH=AL.id,AD=AL.gridData||AL.model.data||AL.node.data,AG=AD.vlexpr,AM=this.docModel,AB=AL.model,AF=AM.controller,AI=u.wrapMethods({success:function(){var AN=mstrmojo.all[AH];if(AN._viSelections){AN.clearSelections();AN.endSelections();}}},AF._getXtabCallback(AL),{success:function AK(){mstrmojo.all[AH].raiseEvent({name:"regenerateToolbar"});}}),AA=AB.getKeepOnlyActionsForAssociatedNodes([],AI);if(AG){AA.actions.push(AF.dataService().getUpdateTemplateAction(AL.k,AB.getRemoveMetricLimitsAction(AG)));}if(AJ){AJ.actions=[].concat(AJ.actions).concat(AA.actions);AJ.callback=u.wrapMethods(AJ.callback,AA.callback);}else{AJ=AA;}if(AE&&AE.length>0){AJ.actions=AJ.actions.concat(AE);}this.submitDropZoneTemplateUpdates(AC,AJ);},submitDropZoneUpdates:function h(AG,AH,AC){var AE=this.getHost(),AB=this.docModel,AA=AB.controller,AD=[].concat(AG||[]);if(AD&&AD.length){var AF=AH||AA._getXtabCallback(AE);AA.cmdMgr.execute({execute:function(){this.submit(AD,AF,AC);},urInfo:{callback:AF}});}},submitDropZoneTemplateUpdates:function E(AA,AC){var AB=(AA&&AA.length)?[this.getUpdateTemplateAction(AA)]:[];if(AC&&AC.actions){AB=AB.concat(AC.actions);}this.submitDropZoneUpdates(AB,AC&&AC.callback,AC&&AC.extras);},getHighlightTargets:function w(AB,AA){return[AA];}});mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION=U;mstrmojo.vi.models.DropZonesModel.ENUM_REQUIREMENT_TYPE={ATTRIBUTE:12,METRIC:4,LONGITUDE:"long",LATITUDE:"lat"};}());(function(){mstrmojo.requiresCls("mstrmojo.ME.DerivedFunctionWizard","mstrmojo.ME.MetricDataService","mstrmojo.ME.AttributeEditBox","mstrmojo.expr","mstrmojo.array","mstrmojo.hash");var G;var e=mstrmojo.ME.MetricDataService,U=mstrmojo.hash,N=mstrmojo.array,W=mstrmojo.ME.AttributeEditBox.getTokenStreamXML,a=mstrmojo.expr.DTP,Q={SHOW_BAND_NAMES:-4,BANDON_UNITS:-6},B={START_END:'BandNames<ResidueName="All Others">(this@ID, "#s - #e")',BAND_NUM:'BandNames<ResidueName="All Others">(this@ID, "Band #b")',BAND_NUM_START_END:'BandNames<ResidueName="All Others">(this@ID, "Band #b: #s - #e")',NO:"No"},R=[{n:mstrmojo.desc(14145,"Start - End"),v:B.START_END},{n:mstrmojo.desc(14146,"Band #"),v:B.BAND_NUM},{n:mstrmojo.desc(14147,"Band #: Start - End"),v:B.BAND_NUM_START_END},{n:mstrmojo.desc(218,"No"),v:B.NO}],K={"8107C337DD9911D3B98100C04F2233EA":"BAND_SIZE","8107C338DD9911D3B98100C04F2233EA":"BAND_COUNT","8107C339DD9911D3B98100C04F2233EA":"BAND_POINTS"},D=function(){return[];};function Y(f){return f.replace(/\s/g,"").toLowerCase();}function O(f){var g=[{v:"BandNames",tp:279,lv:1,oi:{did:"ACA96B1F9F99412B867045747DD88575",n:"BandNames",st:2816,t:11}},{v:"<",tp:60,lv:1},{v:"ResidueName",tp:259,lv:1},{v:"=",tp:282,lv:1},{v:'"All Others"',tp:261,lv:1},{v:">",tp:62,lv:1},{v:"(",tp:40,lv:1},{lv:1,tp:275,v:"this@ID"},{v:",",tp:44,lv:1}];switch(f){case B.BAND_NUM:g.push({v:'"Band #b"',tp:261,lv:1});break;case B.BAND_NUM_START_END:g.push({v:'"Band #b: #s - #e"',tp:261,lv:1});break;case B.START_END:g.push({v:'"#s - #e"',tp:261,lv:1});break;}g.push({v:")",tp:41,lv:1});return g;}function d(f){var g="";N.forEach(f.slice(1,-1),function(h){g+=h.v;});return g;}function J(f){if(f.t===4){return"BandOn";}return f.n;}function E(f){if(f.t===4){return Q.BANDON_UNITS;}return f.dtp;}var C=function(f,g){return{did:"",n:"New Attribute",forms:[{n:"ID",tks:{items:[]}}]};};function T(g,f){return g.dtp===8&&g.n==="Delimiter"?'"'+f+'"':f;}function P(k){var h=k.split(",")[0],g=h.replace(/\d$/,""),f=h.replace(g,"");return{prefix:g,startAt:parseInt(f,10)};}function L(f,g){return{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:f,popupToBody:true,itemIdField:"v",postCreate:function(){var h=this.data;this.value=h.v||h.dfv;},getTokens:g||D,onvalueChange:function(){G.set("dirty",true);}};}function I(g,k){var f=function(l){return l.inputWidget&&l.inputWidget.widgetName===k;},h=mstrmojo.array.filterOne(g.argsGrid.ctxtBuilder.itemWidgets,f);return h&&h.inputWidget;}var H=function(g){var f=null;switch(g&&g.dtp){case Q.SHOW_BAND_NAMES:f=L(R);f.widgetName="bandNames";f.getDescTokens=function(){var h=this.selectedItem&&this.selectedItem.v;return h===B.NO?null:O(h);};break;case Q.BANDON_UNITS:f=G.getParamWidget(g);f.widgetName="bandOn";break;case a.DOUBLE:case a.INTEGER:case a.VARCHAR:f=G.getTextWidget(g);break;default:f=G.getParamWidget(g);f.onitemsChange=mstrmojo.emptyFn;break;}if(f){f.alias="inputWidget";}return f;};var M=function(o,p,l,q){var m=o.did,h=o.n,f=o.dsid,g=o.forms,n={items:p},k=function(r){if(r.vs!==0){mstrmojo.alert(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),null,mstrmojo.desc(9571,"Syntax Error!"));return ;}var u,t={n:"ID",formula:r.tokenXML};if(m){t.did=g[0].did;u={act:"updateDA",name:h,dsid:f,attrId:m,isTokenStream:true,update:[t]};if(l){if(l.did&&!l.del){u.update.push(l);}else{if(l.did&&l.del){u.del=[{did:l.did}];}else{u.add=[l];}}}}else{u={act:"addDAToDataset",dsid:f,name:h,evFlags:1,isTokenStream:true,forms:[t].concat(l?[l]:[])};}q(u);};mstrmojo.ME.AttributeEditBox.validateSyntax(m,n,true,k);};var Z=function(m){var l=m.forms,g=l&&l.length,k=g&&l[0],h=g&&l[1],o=N.some(k&&k.ftk,function(p){return p.oi&&K[p.oi.did];});if(!o){return false;}if(g===1){return true;}if(h&&h.ftk&&g===2){var f=false,n=Y(d(h.ftk));U.forEach(B,function(p){if(Y(p)===n){f=true;return false;}});return f;}return false;};mstrmojo.ME.BandingDAEditor=mstrmojo.declare(mstrmojo.ME.DerivedFunctionWizard,null,{scriptClass:"mstrmojo.ME.BandingDAEditor",ide:null,insertMode:false,init:function V(f){this._super(f);G=this;},getDTPBuilder:function X(){return H;},getParamObjectTypes:function S(){return[mstrmojo.expr.TP.METRIC];},getTextWidget:function b(g){var h=P(g.n).prefix;return{scriptClass:"mstrmojo.ValidationTextBox",emptyText:(g.dtp===a.DOUBLE||g.dtp===a.INTEGER)?mstrmojo.desc(14143,"Type a number"):"",postCreate:function(){this.value=(g.items&&g.items[0].v)||g.dfv;},oninput:function k(l){G.set("dirty",true);this.createNextInputParamWidget();},constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:1},dtp:g.dtp,getTokens:function(){var l=this.data;if(!mstrmojo.string.isEmpty(this.value)&&this.value!==l.dfv){return[{v:T(l,this.value)}];}return[];},createNextInputParamWidget:function f(){var p=this.data,o=this.dataGrid,q=G._lastRpIdx;if(!(p.isRepeated&&p.rpIdx===q)){return ;}var m=q+1,n=h+m,l=mstrmojo.hash.copy({desc:n,n:n,items:null,dn:n,rpIdx:m},mstrmojo.hash.copy(p));o.items.add([l],mstrmojo.array.indexOf(o.items,p)+1);G._lastRpIdx=l.rpIdx;if(G.updateScrollbars){G.updateScrollbars();}}};},onOpen:function F(){G=this;this.oi.tks=this.oi.forms[0].tks||{items:this.oi.forms[0].ftk};this._super();if(this.updateScrollbars){this.updateScrollbars();}},insertOnFinish:function(){var l=mstrmojo.all.mstrDAE.attrEditBox,f=l.inputBox,k=I(this,"bandNames"),g=this.getTokens(),h=k.getDescTokens();f.insertTokens(g);if(h){l.tabstrip.addTab();f.insertTokens(h);}},validateAndSave:function A(n,m){var l=this,k=l.ide.action,f=n.forms,g=I(this,"bandNames"),p=g.getDescTokens(),h=U.copy(p?{n:"DESC",formula:W({items:p})}:null,f[1]?{did:f[1].did}:null),o=function(r){m();l.ide.close();var q=n.did?k.onupdate:k.oncreate;if(q){q(r);}};if(p===null&&h){h.del=true;}M.call(l,l.oi,this.getTokens(),h,o);},postProcessParamsFromToken:function(k){var m=[],l,h,g=k.pars,f=(g&&g.length)||0;for(h=0;h<f;h++){l=U.copy(g[h]);l.dtp=E(l);l.n=J(l);l.isParam=true;m.push(l);}l=m[m.length-1];if(k.rpc>0){m=m.concat(this.postProcessRepeatParam(l));}return m;},postProcessRepeatParam:function c(o){var n=P(o.n),m=n.prefix,h=n.startAt||1,f=[],l,g;o.isRepeated=true;o.rpIdx=this._lastRpIdx=h;o.n=m+(h++);var k=o.items||[];if(k.length>0){o.items=[k[0]];for(g=1;g<=k.length;g++){l=U.copy(o);l.rpIdx=h;l.n=m+(h++);l.items=(g===k.length?null:[k[g]]);f.push(l);}this._lastRpIdx=l.rpIdx;}return f;},postProcessProsFromToken:function(f){var h=[],g={dfv:B.START_END,n:"ShowBandNames",desc:mstrmojo.desc(14144,"Show band names"),dtp:Q.SHOW_BAND_NAMES};if(this.oi.forms.length>1){var k=Y(d(this.oi.forms[1].ftk));U.forEach(B,function(l){if(Y(l)===k){g.v=l;return false;}});}else{if(this.oi.did!==""){g.v=B.NO;}}h.push(g);return h;}});mstrmojo.ME.BandingDAEditor.getNewDefinition=C;mstrmojo.ME.BandingDAEditor.showAsBandingEditor=Z;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.ME.RepeatPulldownList","mstrmojo.ME.DerivedFunctionWizard","mstrmojo.ME._DerivedMetricEditorHelper","mstrmojo.RadioList");mstrmojo.requiresDescs(518,959,1885,1886,2789,11569,12170,12171,12172,12173,12176,12177,12179);var A=mstrmojo.desc;var B=function(E){if(E.onmetricModify){E.onmetricModify();}};var D=function(E){var F={ValueList:A(2789,"Rank"),ASC:A(12170,"Rank Order"),ByValue:A(12171,"Display As"),NullInclude:A(12172,"Treat Null Value As"),BreakBy:A(12173,"Break By")}[E.n];return{scriptClass:"mstrmojo.Label",markupString:'<div id="{@id}" class="mstrmojo-DataRow-text"title="'+(E.desc||"")+'"></div>',alias:"labelWidget",text:F+(E.isParam?"*":"")+":"};};mstrmojo.ME._IsRankEditor=mstrmojo.provide("mstrmojo.ME._IsRankEditor",{fctArgsDataGridCssClass:"functionArgs rank",getPROPBuilder:function C(){return D;},getDTPBuilder:function C(){var E=this;return function(G){var F=null;if(G.isParam){F=E.getParamWidget(G);}else{switch(G&&G.dtp){case 11:case 3:switch(G.n){case"ASC":F={scriptClass:"mstrmojo.Pulldown",cssClass:"asc mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:[{n:A(1885,"Ascending"),did:-1},{n:A(1886,"Descending"),did:0}],popupToBody:true,itemIdField:"did",postCreate:function(){var H=this.data;this.value=!!H.v?(H.v==="False"?0:-1):(H.dfv||0);},getTokens:function(){var H=this.data;if(this.value!==H.dfv){return[{v:H.n},{v:"=",isDelimiter:true},{v:this.value===-1?"True":"False"}];}return[];},onvalueChange:function(){B(this.parent.dataGrid.parent);}};break;case"ByValue":F={scriptClass:"mstrmojo.RadioListHoriz",itemIdField:"did",items:[{n:A(13536,"Number (1,2,3)"),did:-1},{n:A(12175,"Percentage (10%,50%,100%)"),did:0}],postCreate:function(){var I=this.data;var H=!!I.v?(I.v==="False"||parseInt(I.v,10)===0?0:-1):(I.dfv||0);this.set("selectedIndex",mstrmojo.array.find(this.items,this.itemIdField,H));},onselectionChange:function(H){if(H.removed.length===1){B(this.parent.dataGrid.parent);}},getTokens:function(){var I=this.data,H=this.selectedItem[this.itemIdField];if(H!==I.dfv){return[{v:I.n},{v:"=",isDelimiter:true},{v:H===-1?"True":"False"}];}return[];}};break;case"NullInclude":F={scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:[{n:A(959,"Default"),did:0},{n:A(12176,"First in rank"),did:-1},{n:A(12177,"Last in rank"),did:1}],itemIdField:"did",postCreate:function(){var H=this.data;this.value=H.v||H.dfv;},getTokens:function(){var H=this.data;if(this.value!==H.dfv){return[{v:H.n},{v:"=",isDelimiter:true},{v:this.value}];}return[];},onvalueChange:function(){B(this.parent.dataGrid.parent);}};break;}break;case -2:F=E.getBreakByWidget(G);break;}}F.alias="inputWidget";return F;};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.OLAPEditor","mstrmojo.ME._DerivedMetricEditorHelper");mstrmojo.requiresDescs();mstrmojo.ME.DerivedOLAPEditor=mstrmojo.declare(mstrmojo.ME.OLAPEditor,[mstrmojo.ME._DerivedMetricEditorHelper],{scriptClass:"mstrmojo.ME.DerivedOLAPEditor"});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.RepeatPulldownList","mstrmojo.ME.DerivedFunctionWizard","mstrmojo.ME._DerivedMetricEditorHelper","mstrmojo.ME._IsRankEditor","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs();var B=mstrmojo.mstr.EnumDSSXMLObjectTypes;mstrmojo.ME.DerivedRankEditor=mstrmojo.declare(mstrmojo.ME.DerivedFunctionWizard,[mstrmojo.ME._DerivedMetricEditorHelper,mstrmojo.ME._IsRankEditor],{scriptClass:"mstrmojo.ME.DerivedRankEditor",init:function A(C){mstrmojo.css.addWidgetCssClass(this,"dme");this._super(C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Editor","mstrmojo.tooltip","mstrmojo.SearchWidget","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.BandingDAEditor","mstrmojo.ME.Enum","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(13141);var R=mstrmojo.hash,W=mstrmojo.dom,M=mstrmojo.css,Y=mstrmojo.ME.Enum.SHORTCUT_FUNCTIONS;var D={n:mstrmojo.desc(9590,"Search Result"),did:-1,fns:[]},E={n:mstrmojo.desc(4561,"All Functions"),did:-2,fns:[]},Q={n:mstrmojo.desc(9591,"Metric Templates"),did:-3,fns:[{n:mstrmojo.desc(3273,"Level"),did:Y.Level,desc:mstrmojo.desc(9592,"Create a level metric."),h:"standard_functions_Level"},{n:mstrmojo.desc(9579,"Condition"),did:Y.Condition,desc:mstrmojo.desc(9593,"Create a conditional metric."),h:"standard_functions_condition"},{n:mstrmojo.desc(3324,"Transformation"),did:Y.Transformation,desc:mstrmojo.desc(9594,"Create a transformation metric."),h:"standard_functions_transformation"},{n:mstrmojo.desc(11656,"Row Count"),desc:mstrmojo.desc(11657,"Row Count calculates the total number of rows in the dataset."),did:Y.Row_Count,tks:{items:[{v:"Count",tp:280,oi:{n:"Count",did:"8107C31CDD9911D3B98100C04F2233EA",t:11,st:2816}},{v:"<",tp:60},{v:"Null",tp:259},{v:"=",tp:282},{v:"True",tp:299},{v:",",tp:44},{v:"UseLookupForAttributes",tp:259},{v:"=",tp:282},{v:"False",tp:300},{v:">",tp:62},{v:"(",tp:40},{v:'"*"',tp:261},{v:")",tp:41},{v:"{",tp:123},{v:"~",tp:126},{v:"}",tp:125}]}}]},G={n:mstrmojo.desc(4565,"Select a category:"),did:-4,fns:[]},F=function(Z,a){var b=Z.functionList;Z.openWizard(b.items[b.selectedIndex],a);},H=function(){return mstrmojo.hash.copy(mstrmojo.ME.ENUM.NEW_METRIC_DEFINITION);};var X=function(a){var Z="mstrmojo-ME-fct-tip",b=this.tooltip&&this.tooltip.domNode;if(b){M.toggleClass(b,Z,a);}};mstrmojo.ME.FunctionSelector=mstrmojo.declare(mstrmojo.Editor,[],{scriptClass:"mstrmojo.ME.FunctionSelector",title:mstrmojo.desc(9595,"Select a function or template"),help:"Select_a_Function_dialog_box.htm",isDME:false,functions:null,includeFakeFuncs:true,functionItems:null,selectedCategory:1,selectedIndex:-1,init:function T(Z){this._super(Z);M.addWidgetCssClass(this,"mstrmojo-FunctionSelector");},getFunctionSyntax:function L(g,b){var d=this.functionItems;if(!d){return"";}var e=d[g].fns[b];if(e.did<0){return e.n;}var Z=e.pars,k=e.pros,h=[],a,c;h.push(e.n);k=mstrmojo.hash.clone(k)||[];if(e.ios){k.push({n:"SortBy"});}if(e.sqt===5){k.push({n:"BreakBy"});}if(this.showFullSyntax){if(k.length>0){h.push("<");for(a=0,c=k.length;a<c;a++){h.push(k[a].n);h.push(", ");}h.pop();h.push(">");}}h.push("(");for(a=0,c=Z.length;a<c;a++){h.push(Z[a].n);if(a!==(c-1)){h.push(", ");}}h.push(")");return h.join("");},getFunctionDesc:function P(c,Z){var b=this.functionItems;if(!b){return"";}var a=b[c].fns[Z];return mstrmojo.ME.FunctionInfo.getDescAndExample(a).desc;},getFunctionHelpTopic:function O(c,Z){var b=this.functionItems;if(!b){return"";}var a=b[c].fns[Z];if(a.did===Y.Row_Count){return"";}return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(a.h);},getMetricDefAsTokens:function S(){return this.getTokens();},getTokens:function K(){var a=this.functionList,Z=a.items[a.selectedIndex],b=[];if(Z){if(Z.did<-1){switch(Z.did){case -7:b=Z.tks.items;break;case -4:case -5:case -6:break;}}else{b.push({v:Z.n,oi:Z,isNew:true});}}return b;},onfunctionsChange:function V(){if(!this.functions){return ;}this.selectedCategory=0;this.set("selectedCategory",1);this.set("selectedIndex",-1);var b=mstrmojo.hash.clone(this.functions),Z=b.length;if(!b.add){b=R.make(b,mstrmojo.Arr);}if(Z>=1&&this.includeFakeFuncs){var a=b[mstrmojo.ME.MetricDataService.getBasicCategoryIndex(b)];a.fns.push(Q.fns[0]);if(!this.isDME){a.fns.push(Q.fns[1]);a.fns.push(Q.fns[2]);}else{a.fns.push(Q.fns[3]);}}this.set("functionItems",b);},onPreClose:function N(){this.cleanup();return true;},cleanup:function I(){this.searchWidget.clearSearch();this.set("selectedIndex",-1);},handleCloseAction:function C(){this.close();},clearSearchResult:function U(a){var b=this.fcHBox.fcPulldown,c=this.functionItems,Z=c.length-1;if(Z>-1&&c[Z]===D){if(this.selectedCategory===Z){if(a!==false){this.set("selectedCategory",1);this.set("selectedIndex",-1);}}c.remove(Z);b.refresh();}},clearSearchPattern:function A(){var Z=this.searchWidget;if(Z&&Z.hasRendered){Z.reset();this.clearSearchResult(false);}},openWizard:function J(c,b){var a=this,Z;if(mstrmojo.ME.MetricDataService.isBasicAggMap(c.did)||c.did<-1){Z={zIndex:a.zIndex+10,did:c.did,oi:H};Z.insertMode=false;Z.id="mstrSME";}else{Z={functions:mstrmojo.ME.MetricDataService.getFunctionCatList(),fctOi:c,zIndex:a.zIndex+10,oi:H};Z.id="mstrFE";}Z.insertMode=this.insertMode;if(Z.insertMode){Z.insertOnFinish=this.insertOnFinish;}a.switch2Editor(Z.id,Z);},handleSelectedFunction:function(Z){F(this);},onshowFullSyntaxChange:function B(){this.functionList.onchange();},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FunctionSelector-label",text:mstrmojo.desc(9925,"Functions")},{scriptClass:"mstrmojo.SearchWidget",alias:"searchWidget",cssClass:"mstrmojo-FunctionSelector-search",width:"65px",quickSearch:true,placeholderText:"",onsearch:function(g){var Z=this.parent,f=Z.fcHBox.fcPulldown,d=Z.functionItems,h=Z.functionList.itemDisplayField,e=[],a=function(l){var k=mstrmojo.hash.copy(l),n=k.n,m;try{m=new RegExp(g,"ig");}catch(o){m=new RegExp(mstrmojo.string.regEscape(g),"ig");}if(m.test(n)){k[h]=n.replace(m,function(p){return"<em>"+mstrmojo.string.encodeHtmlString(p)+"</em>";});e.push(k);}},b,c;for(b=0,c=d.length;b<c;b++){if(d[b]===D||d[b].did===E.did){continue;}if(g){mstrmojo.array.forEach(d[b].fns,a);}}D.fns=e;if(d[d.length-1]!==D){d.add([D]);}f.refresh();Z.selectedCategory=0;Z.set("selectedCategory",d.length-1);Z.set("selectedIndex",-1);},onclear:function(Z){if(Z){this.parent.clearSearchResult();}}},{scriptClass:"mstrmojo.HBox",alias:"fcHBox",cssClass:"mstrmojo-FunctionSelector-fctBox",children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",alias:"fcPulldown",itemIdField:"did",itemField:"n",items:[],bindings:{items:function(){var a=this.parent.parent.functionItems,b=[];if(!a){return a;}b=mstrmojo.ME.MetricDataService.sortFunctions(a);if(a[0].did!==E.did){var Z=E;Z.fns=b;a.unshift(Z);}return a;},selectedIndex:"this.parent.parent.selectedCategory",value:function(){var Z=this.parent.parent.selectedCategory;return this.items[Z][this.itemIdField];}},onvalueChange:function(Z){var a=this.parent.parent;a.set("selectedCategory",this.selectedIndex);a.set("selectedIndex",-1);if(Z.valueWas===D.did&&this.selectedItem.did!==D.did){this.parent.parent.clearSearchPattern();}}}]},{scriptClass:"mstrmojo.ME.FunctionList",alias:"functionList",itemIdField:"dssid",itemField:"n",itemDisplayField:"dn",items:[{n:"",cls:"wait"}],cssClass:"mstrmojo-FE-functionList mstrmojo-suggest-list",renderOnScroll:false,itemMarkupFunction:function(b,Z,a){return'<div class="mstrmojo-suggest-text '+(b.cls||"fn")+'" idx="'+Z+'"'+(b.did<0?'did="'+b.did+'"':"")+" onmouseover=\"mstrmojo.all['"+a.id+"'].onmouseover(this, event)\" onmouseout=\"mstrmojo.all['"+a.id+"'].onmouseout(this, event)\">"+((a.itemDisplayField&&b[a.itemDisplayField])||b[a.itemField])+'<div class="mstrmojo-Button mstrmojo-Editor-button mstrmojo-WebButton hot tbFunction" t="edt"><div class="mstrmojo-Button-text" t="edt">'+mstrmojo.desc(1088,"Edit")+"</div></div></div>";},bindings:{items:function(){var Z=this.parent.functionItems,a=this.parent.selectedCategory;return(Z&&Z[a].fns)||this.items;},selectedIndex:"this.parent.selectedIndex"},buffer:"",onkeypress:function(m){var l=this,g=m.e,c=g.keyCode||g.charCode,n=mstrmojo.Enum_Keys,Z=function(p){var o=(W.isIE&&!W.isIE9)?p.keyCode:p.charCode;return(o>0)?String.fromCharCode(o):"";},h=this.items,f=h.length,a=this.selectedIndex,b=function(e){l.scrollTo(e);};switch(c){case n.UP_ARROW:this.set("selectedIndex",(a+f-1)%f);break;case n.DOWN_ARROW:this.set("selectedIndex",(a+1)%f);break;default:var d=(this.buffer+=Z(g));if(f>0&&d.length>0){mstrmojo.array.forEach(h,function(p,k,e){var o=new RegExp("^"+d,"i");if(o.test(p[l.itemField])){if(k>-1){this.selectedIndex=-1;this.set("selectedIndex",k);}return false;}},this);}}if(this.selectedIndex>-1){b(this.selectedIndex);}window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){l.buffer="";},300);mstrmojo.dom.stopPropogation(m.hWin,g);return false;},onkeyup:function(Z){this.onkeypress(Z);},onchange:function(Z){var b=this.parent;if(this.selectedIndex!==b.selectedIndex){b.set("selectedIndex",this.selectedIndex);}var d=b.selectedCategory,a=b.selectedIndex,c=d>-1&&a>-1;b.set("funcSyntax",c?b.getFunctionSyntax(d,a):"");b.set("funcDesc",c?b.getFunctionDesc(d,a)+"  "+b.getFunctionHelpTopic(d,a):"");if(this.changeByMouse){if(b.selectedCategory>-1&&b.selectedIndex>-1){b.handleSelectedFunction(false);}this.changeByMouse=false;}},onmouseup:function(Z){var b=Z.getTarget(),a=b.getAttribute("t");if(a==="edt"){mstrmojo.dom.stopPropogation(Z.hWin,Z.e);mstrmojo.dom.preventDefault(Z.hWin,Z.e);this.openFunctionEditor();return false;}},openFunctionEditor:function(){var b=this.parent.parent.parent,c=b.getTokenInputBox(),Z={zIndex:b.zIndex+1,insertMode:true,oi:mstrmojo.ME.ENUM.getNewDefinition(),insertOnFinish:function(d){c.insertTokens(d);}},a=this.parent.functionList.selectedItem;if(b.isBanding&&b.isBanding(a.did)){Z={zIndex:b.zIndex+1,insertMode:true,fctOi:a,id:"mstrBDAE_1",oi:mstrmojo.ME.BandingDAEditor.getNewDefinition(),ide:b};}else{if(mstrmojo.ME.MetricDataService.isBasicAggMap(a.did)||a.did<-1){Z.candidates=c.candidates;Z.did=a.did;Z.id="mstrSME_1";Z.useGUIDefault=true;}else{Z.fctOi=a;Z.id="mstrFE_1";Z.paramItemsPath=b.feParamItemsPath;}}Z.modal=true;b.getModalEditor(Z).open(b);},ondblclick:function(Z){var b=this.getItemNodeFromTarget(Z.getTarget());if(b){var a=this.parent;if(a.selectedCategory>-1&&a.selectedIndex>-1){a.handleSelectedFunction(true);}}},useRichTooltip:false,onmouseover:function(b,k){var m=this,a=this.parent,l=a.selectedCategory,d=b.getAttribute("idx"),c=W.eventTarget(window,k),Z=c.getAttribute("t")==="edt";if((!isNaN(d)&&d>-1)||Z){window.clearTimeout(m.hideTmr);var h='<dl class="fct-info"><dt class="fct-syntax">'+a.getFunctionSyntax(l,d)+'</dt><dd class="fct-desc">'+(a.getFunctionDesc(l,d)+"  "+a.getFunctionHelpTopic(l,d))+"</dd></dl>";var n=mstrmojo.dom.position(b,true),o=function(){var p=(m.tooltip&&m.tooltip.domNode.offsetWidth+15)||200,e=n.x,u=n.y-b.offsetHeight/2,t=e<p?"left":"right",r=e<p?mstrmojo.tooltip.POS_TOPLEFT:mstrmojo.tooltip.POS_TOPRIGHT;e=e<p?n.x+n.w+8:e-10;return{arrow_css:t,contentNodeCssClass:"me-tooltip-content "+t,posType:r,left:e,top:u};},g=o(),f="hidden";m.richTooltip=Z?m.getEditBtnTooltip(c,d):{cssClass:f,contentNodeCssClass:"me-tooltip-content "+g.arrow_css,posType:g.posType,left:g.left,top:g.top,content:h,areaId:d};m.useRichTooltip=true;m.hasOpenTooltip=false;m.showTooltip();window.clearInterval(m.posTmr);var q=0;if(!m.posTmr){m.posTmr=window.setInterval(function(){if(m.tooltip){var r=m.tooltip.domNode,p=r.childNodes[1].firstChild,e=g.posType;g=o();if(g.posType!==e){r.style.left=g.left+"px";M.addClass(p,[g.arrow_css]);}window.setTimeout(function(){M.removeClass(r,f);},10);window.clearInterval(m.posTmr);delete m.posTmr;}else{if(q++>10){window.clearInterval(m.posTmr);}}},200);}X.call(this,!Z);}},getEditBtnTooltip:function(Z,a){return{posType:mstrmojo.tooltip.POS_TOPRIGHT,contentNodeCssClass:"me-tooltip-content regular up tbFunction",top:28,left:67,refNode:Z,content:mstrmojo.desc(13141,"Edit function parameters"),areaId:a};},onmouseout:function(){var Z=this;this.hideTmr=window.setTimeout(function(){X.call(Z);Z.hideTooltip();Z.useRichTooltip=false;},500);}},R.copy({slot:"buttonNode",cssText:"text-align: center; float:left;",text:mstrmojo.desc(9563,"Switch to Formula Editor"),title:mstrmojo.desc(9597,"Build a metric formula using metrics, facts, attributes and functions."),closeAfterSwitch:false,getEditor:function(){return this.parent;},postclick:function(){this.getEditor().buttonNode.style.visibility="hidden";},bindings:{visible:function(){return !this.parent.insertMode;}}},R.copy(mstrmojo.ME._MetricEditorHelper.switchRef)),{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.handleCloseAction();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo.ui._HasScroller");var D=mstrmojo.dom;mstrmojo.ME.FunctionList=mstrmojo.declare(mstrmojo.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.FunctionList",setupScrollNodes:function C(){this.scrollNode=this.itemsContainerNode;this.scrollNode.style.height=this.scrollboxNode.offsetHeight+"px";this.scrollboxNode=this.itemsContainerNode;},getItemNodeFromTarget:function B(G){var F=mstrmojo.dom.findAncestorByAttr(G,"idx",true,this.domNode);return(F&&F.node)||null;},premousedown:function A(G){this.changeByMouse=false;if(D.isPrimaryMouseBtn(G.e)){var H=this.getItemNodeFromTarget(G.getTarget()),F=H&&parseInt(H.getAttribute("idx"));if(F!==null&&!isNaN(F)&&F!==this.selectedIndex){this.domNode.tabIndex=0;this.domNode.focus();this.changeByMouse=true;}this._super(G);}},premouseup:function E(F){if(D.getButton(F.hWin,F.e)===D.MOUSE_BUTTON.LEFT){this._super(F);return true;}mstrmojo.dom.stopPropogation(F.hWin,F.e);mstrmojo.dom.preventDefault(F.hWin,F.e);return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.chart.model.enums.EnumDSSObjectType");mstrmojo.requiresClsP("mstrmojo.vi.models","EnumDragSources","_DropZoneCommon");mstrmojo.requiresClsP("mstrmojo.vi.util","TemplateUtils","ThresholdUtils");var J=mstrmojo.array,O=mstrmojo.hash,U=mstrmojo.func,T=mstrmojo.vi.viz.EnumDSSDropZones,P=mstrmojo.chart.model.enums.EnumDSSObjectType,F=mstrmojo.vi.ui.DatasetUnitMenuUtils,C=mstrmojo.vi.util,A=C.ThresholdUtils,X=C.TemplateUtils,N=mstrmojo.vi.viz.MapHelper,E=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,a=mstrmojo.vi.models.EnumDragSources;function b(c,d,e){J.forEach(this.zonesCfg,function(f){if(f.id===d.zone.id){f[e](c,d);return false;}});this.dirtyVP=true;}mstrmojo.vi.models.MapDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{zonesCfg:[],dirtyVP:false,getDropZones:function R(e){var f=[],d=this,c=function(g){switch(g){case T.GeoAttribute:return mstrmojo.desc(13830);case T.Latitude:return mstrmojo.desc(13831);case T.Longitude:return mstrmojo.desc(13832);case T.Angle:case T.ColorBy:case T.SizeBy:return mstrmojo.desc(13829);case T.AdditionalMetrics:return mstrmojo.desc(11668);}return"";};O.forEach(this.zonesCfg,function(g){if(e||g.show(d.getHostModel().vp)){f.push(d.getZone(g.n,g.id,d.getHost().getDropZoneItems(g.id),false,{allowSingle:g.id!==T.AdditionalMetrics,title:c(g.id)}));}});this.dropZones=f;return{n:this.getHost().node.defn.ttl,zones:f};},getAllZones:function(){return this.getDropZones(true).zones||[];},getZone:function I(l,k,h,e,f){if((k===T.Latitude||k===T.Longitude)&&h[0]&&(h[0].t===21)){var d=this.getHost().getDropZoneItems(T.GeoAttribute),c=d.length>0?d[0].id:null,g=X.findUnitsById(this.getHostModel().gsi,c)[0];if(g){return this._super(l,k,[{did:h[0].id,t:21,n:g.n+"@"+((k===T.Latitude)?mstrmojo.desc(7696,"Latitude"):mstrmojo.desc(7697,"Longitude"))}],e,f);}}return this._super(l,k,h,e,f);},getUnitMenuItems:function W(h,m,t,r){if(!t){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var l=m.items,e=l.length,k=m.id,d={zone:m,idx:J.indexOf(l,t),cnt:e,item:t,useDropzone:true},o=this,c=this.id,f=F.getDatasetFromAttributeId(this.docModel.datasets,t.did);if(t.t!==21){var q=false;if(t.t===4){if(t.um){h.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){o.editDerivedMetric(d,"edit");},d);h.addSeparator();}if(this.docModel.findDatasetIdFromUnit(t.did)&&!this.docModel.isFromSolrCube(t.did)&&!this.docModel.isFromMDXCube(t.did)){h.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",c,o.getAggregateByMetricSubMenu,d);h.addSeparator();}h.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),c,o.getCalculationEditorCfg,d);h.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){o.newDerivedMetric(d);},d);}else{if(!f||!this.docModel.isMDXDataset(f)){if(t.da){h.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){o.editDerivedAttribute(d);},d);h.addSeparator();}if(t.t===12){if(this.allowInsertNewAttribute(m)&&!this.isDynamicLink(t)){h.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){o.newDerivedAttribute(d);},d);}}}if(m.id===T.AdditionalMetrics&&this.shouldShowDisplayFormsMenu(t)){var g=this.getZoneModelByZoneId(T.GeoAttribute)||{},n=this.getZoneModelByZoneId(T.Latitude)||{},p=this.getZoneModelByZoneId(T.Longitude)||{};if(J.find((g.items||[]).concat(n.items||[]).concat(p.items),"did",t.did)<0){h.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),c,function(){return o.getDisplayFormsMenu(t);});}}}h.addSeparator();if(this.showNumberFormat(t)){h.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),c,this.getNumberFormatEditorCfg,d);q=true;}if(t.t===4&&k===T.ColorBy){this.buildThresholdMenuOptions(h,d,true);q=true;}if(q){h.addSeparator();}if(o.hasReplaceCandidates(d)){h.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",c,o.getReplaceSubMenu,d);}h.addMenuItem(mstrmojo.desc(1388,"Rename"),c,function(){mstrmojo.all[c].renameItem(r,t);});h.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[c].deleteItem(m,d.idx);});}},getAllowDropInfo:function K(k,f,m,e,c){var d=this._super(k,f,m,e,c),g=d.allowedItems,n=e===E.ON,l=true,h=function(o,p){return J.filter(g,function(q){return p?(q.t!==o):(q.t===o);},l?{max:1}:null);};switch(k.id){case T.GeoAttribute:case T.Latitude:case T.Longitude:g=h(P.DssTypeAttribute);break;case T.Angle:case T.SizeBy:case T.ColorBy:g=h(P.DssTypeMetric);break;case T.AdditionalMetrics:l=false;g=h(P.DssTypeAttributeForm,true);break;}return O.copy({allowedItems:(l&&!(k.items.length===0||n))?[]:g,removeReplaced:n&&(J.find(l?g:f,"did",k.items[m].did)===-1)},d);},getDropActions:function H(q,k,e){var n=k.allowedItems,m=k.idx,r=n[0],c=q.id,l=[],t=function(z){var AA=null;J.forEach(z.fs||[],function(AB){if(N.isLatitude(AB.fnm,AB.fgr)&&AB.obf){AA=AB;return false;}});return AA;},d=function(z){var AA=null;J.forEach(z.fs||[],function(AB){if(N.isLongitude(AB.fnm,AB.fgr)&&AB.obf){AA=AB;return false;}});return AA;};if(c===T.Angle&&(this.getHost().getData().dz.AngleBy===undefined)){l=l.concat(this.getCreateDropZoneAction(T.Angle,3,4,1));}if(c===T.GeoAttribute){var g=t(r),x=d(r);if(!g||!x){if(g&&N.isLatitude(r.n)){c=T.Latitude;q=this.getZoneModelByZoneId(c);}else{if(x&&N.isLongitude(r.n)){c=T.Longitude;q=this.getZoneModelByZoneId(c);}}}}if(k.edge===E.ON&&k.removeReplaced){var h=this.getRemoveDropZoneUnitAction(q,q.items[m]);if(h){l.push(h);if((c===T.Latitude||c===T.Longitude)&&q.items[0].t===21){l.push(this.getRemoveDropZoneUnitAction({id:T.GeoAttribute},this.getZoneModelByZoneId(T.GeoAttribute).items[0]));var f=this.getZoneModelByZoneId(q.id===T.Latitude?T.Longitude:T.Latitude);if(f&&f.items[0].t===21){l.push(this.getRemoveDropZoneUnitAction(f,f.items[0]));}}}}var v=this.getDropTargetIndex(q,k);J.insert(l,null,this.getAddDropZoneUnitsActions(q,n,v,{datasetId:e}));this.checkTooltipAngleColorBySizeByMetric(c,n,l);this.checkAndAddThresholdAction(c,r,l);var p=function(z,AC){var AB=AC.getZoneModelByZoneId(z);if(AB&&AB.items.length){var AA=AC.getRemoveDropZoneUnitAction(AB,AB.items[0]);if(AA){l.push(AA);}}},w=function(z){l.push({act:"addForm",unitId:r.did,attFormId:z.fid,unitPos:1});};if(c===T.GeoAttribute){p(T.Latitude,this);p(T.Longitude,this);var o=t(r),u=d(r);if(o){w(o);l=l.concat(this.getAddDropZoneUnitsActions({id:T.Latitude},[{did:o.fid,t:21}],0,{datasetId:e}));}if(u){w(u);l=l.concat(this.getAddDropZoneUnitsActions({id:T.Longitude},[{did:u.fid,t:21}],0,{datasetId:e}));}}return l.length?this.getUpdateTemplateAction(l):[];},unitsDropped:function V(c,d,e,k,g){var f=d.src.data,h=d.actions||[];this.submitDropZoneUpdates(h.concat(this.getDropActions(c,e,f.dsid)),U.wrapMethods(d.callback,this.getHost().model.docModel.controller._getXtabCallback(this.getHost())));},checkAndAddThresholdAction:function S(f,d,e){var c=this.getHost();if(this.isMetric(d)&&f===T.ColorBy){A.addThresholds(c.model,c,c.node,d,e);return true;}return false;},checkTooltipAngleColorBySizeByMetric:function Q(m,n,g){var u=this.getHost(),v=this.getZoneModelByZoneId(T.Angle),d=this.getZoneModelByZoneId(T.ColorBy),l=this.getZoneModelByZoneId(T.SizeBy),f=this.getZoneModelByZoneId(T.AdditionalMetrics),p=v&&v.items.length&&v.items[0],r=d&&d.items.length&&d.items[0],e=l&&l.items.length&&l.items[0],o=f&&f.items.length&&f.items,q=function(x,w){if(!w){return false;}return x.did===w.did&&x.n===w.n;},k,h,t,c;if(m===T.AdditionalMetrics){for(h=0;h<n.length;h++){t=n[h];if(this.isMetric(t)){if(r&&q(t,r)){k=this.getRemoveDropZoneUnitAction(d,r);if(k){g.push(k);}}if(e&&q(t,e)){k=this.getRemoveDropZoneUnitAction(l,e);if(k){g.push(k);}}if(p&&q(t,p)){k=this.getRemoveDropZoneUnitAction(v,p);if(k){g.push(k);}}}}}else{if(m===T.ColorBy||m===T.SizeBy||m===T.Angle){t=n[0];if(this.isMetric(t)&&o){for(h=0;h<o.length;h++){c=o[h];if(q(t,c)){k=this.getRemoveDropZoneUnitAction(f,c);if(k){g.push(k);}}}}}}},getAvatarIconClass:function G(){return"";},deleteItem:function M(f,d){var k=[this.getRemoveDropZoneUnitAction(f,f.items[d])];if(f.id===T.GeoAttribute){var e=this.getZoneModelByZoneId(T.Latitude),h=e&&e.items&&e.items[0],c=this.getZoneModelByZoneId(T.Longitude),g=c&&c.items&&c.items[0];if(h){k.push(this.getRemoveDropZoneUnitAction({id:T.Latitude},h));}if(g){k.push(this.getRemoveDropZoneUnitAction({id:T.Longitude},g));}}this.submitDropZoneTemplateUpdates(k);},deleteItems:function M(c,d){var e=[],f=this.id;d.forEach(function(h){var g=mstrmojo.all[f].getRemoveDropZoneUnitAction(c,h);if(g){e.push(g);}});this.submitDropZoneTemplateUpdates(e||[]);},getWidgetPropsAction:function(){var c=this.getHost(),d=this.docModel;return d.getUnitFormatAction(c,1,{FormattingWidget:{WidgetProps:N.getXmlFromJson(this.getHostModel().vp)}});},getHostModel:function(){return this.getHost().model.data;},getAddDropZoneUnitsActions:function D(d,e,c,f){var h=[],g=this;e.reverse().forEach(function(k){b.call(g,g.getHostModel().vp,{item:k,idx:c,zone:d},"onAdd");h.push(g.getAddDropZoneUnitAction(d,k,c,f));});return h;},getRemoveDropZoneUnitAction:function L(d,e){var f=this._super(d,e),c=J.find(d.items,"did",e.did);b.call(this,this.getHostModel().vp,{item:e,idx:c,zone:d},"onDel");return f;},submitDropZoneUpdates:function B(c,d){c=c||[];if(this.dirtyVP){c.push(this.getWidgetPropsAction());this.dirtyVP=false;}this._super(c,d);},canSupportImageThreshold:function Z(){var c=this.getHostModel().vp;return N.supportImageThreshold(c&&c.mtp);},getCreateDropZoneAction:function Y(d,c,e,k){var h=this.getHost(),f=h.getData().k,g=h.defn.tt;return{act:"createDefaultDropZone",treeType:g,nodeKey:f,zoneId:d,dropzone_index:c,dropzone_types:e,dropzone_sizelimit:k};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.array","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.models.DropZonesModel");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");mstrmojo.requiresDescs(11819,11825,11827);var U=mstrmojo,L=U.array,T=U.vi.viz,J=mstrmojo.vi.models.DropZonesModel.ENUM_REQUIREMENT_TYPE,K=J.ATTRIBUTE,Q=J.METRIC,C=T.EnumVisualizationTemplates,O=T.EnumVizStyles,I=O.GRAPH_MATRIX,W=T.EnumWidgetTypes.GRAPH_MATRIX,B={},M="custom",P="plugins.";B[O.GOOGLE_MAP]=C.GOOGLEMAP;B[O.HEAT_MAP]=C.HEATMAP;B[O.ESRI_MAP]=C.ESRIMAP;B[O.NETWORK]=C.NETWORK;B[O.IMAGE_LAYOUT]=C.IMAGELAYOUT;function F(Z,Y){var a=[],b=function(c,d){a.push({t:c,r:d});};if(Z){b(Q,Z);}if(Y){b(K,Y);}return a;}var N=[{n:mstrmojo.desc(11820,"Bar Chart"),id:"BarChart",mr:F(1,0),vt:{v:C.GRAPHMATRIXVERTICALBARAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALBARAUTOMATIC}},{n:mstrmojo.desc(8121,"Line Chart"),id:"LineChart",mr:F(1,1),vt:{v:C.GRAPHMATRIXVERTICALLINEAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALLINEAUTOMATIC}},{n:mstrmojo.desc(11821,"Area Chart"),id:"AreaChart",mr:F(1,1),vt:{v:C.GRAPHMATRIXVERTICALAREAAUTOMATIC,h:C.GRAPHMATRIXHORIZONTALAREAAUTOMATIC}},{n:mstrmojo.desc(11822,"Bubble Chart"),id:"BubbleChart",mr:F(1,1),vt:C.GRAPHMATRIXBUBBLECIRCLEMM},{n:mstrmojo.desc(11823,"Pie Chart"),id:"PieChart",mr:F(0,1),vt:C.GRAPHMATRIXPIE},{n:mstrmojo.desc(11824,"Combo Chart"),id:"ComboChart",mr:F(2,1),vt:C.GRAPHCOMBINATIONBARAREADUALAXIS}];N.forEach(function(Y){Y.s=I;Y.wtp=W;});var E={BUILT_IN_LIST:1,CUSTOM_LIST:2};function G(a){var b=[],Y=mstrConfig.pluginsVisList||{},Z=function(c,e,d){d=d||[];e=isNaN(e)?0:parseInt(e,10);if(e>0){d.push({t:c,r:e});}return d;};Object.keys(Y).forEach(function(h){var d=Y[h],c=d.s,g=d.d,f=d.c.indexOf(P)!==-1?E.CUSTOM_LIST:E.BUILT_IN_LIST;if(!(a&f)){return ;}if(c===I){d.st.forEach(function(l){var k=L.find(N,"id",l);if(k>=0){b.push(N[k]);}});return ;}var e=d.desc;if(e){g=mstrmojo.desc(e,"");}b.push({n:g,s:c,mr:Z(K,d.ma,Z(Q,d.mm)),id:c,dz:d.dz,vt:B[c],wtp:d.wtp,pn:d.pn||null});});return b;}function H(Y){return G(E.BUILT_IN_LIST+E.CUSTOM_LIST).filter(function(Z){return Z.s===Y;}).map(function(Z){return{s:Z.s,vt:Z.vt||-1};})[0];}function A(Y,Z){window.FormWrapper.doVisRemove(Y,Z);}var V;mstrmojo.vi.ui.VizGalleryList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.VizGalleryList",init:function R(Y){this._super(Y);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIGalleryList");this.items=(this.items||[]).concat(G(this.type));},items:null,type:E.BUILT_IN_LIST,getItemMarkup:function D(Y){if(!V){V=this._super(Y).replace(">{@en@n}<","><div><div></div></div><");}return V;},getItemProps:function X(a,Y){var Z=this._super(a,Y);Z.addCls("ic-"+a.id);if(this.type===E.CUSTOM_LIST){Z.addCls(M);}return Z;},select:function(a,Y){if(!a){return ;}a=L.ensureArray(a);var c=this._removeAll(),e=this._addSelections(a),b;if(this.selectionPolicy!=="reselect"){for(b=c.length-1;b>=0;b--){var d=L.indexOf(e,c[b]);if(d>-1){c.splice(b,1);e.splice(d,1);}}}var Z={name:"selectionChange",added:e,removed:c};if(Y){if(this.onselectionChange){this.onselectionChange(Z);}}else{this.raiseEvent(Z);}},onItemContextMenu:function S(Z,Y){var a;if(Z.pn){this.hideTooltip();a=new mstrmojo.ui.menus.MenuConfig({position:mstrmojo.dom.getMousePosition(Y.e,Y.hWin),isHostedWithin:false});a.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){A(Z.id,Z.pn);});this.openPopup(a.newInstance());}}});mstrmojo.vi.ui.VizGalleryList.getVizList=G;mstrmojo.vi.ui.VizGalleryList.getVisType=H;mstrmojo.vi.ui.VizGalleryList.VIZ_LIST_TYPE=E;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.func","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models._DropZoneCommon");var N=mstrmojo.array,W=mstrmojo.func,H=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,b=mstrmojo.vi.models.EnumDragSources,I=mstrmojo.vi.ui.DatasetUnitMenuUtils,D=mstrmojo.vi.viz.EnumDSSDropZones,B=D.GeoAttribute,K=D.SizeBy,S=D.ColorBy,J=D.Layout,Z=D.AdditionalMetrics,A=mstrmojo.vi.util.ThresholdUtils,E=["#65D22B","#FFC561","#FF9547","#FF5824","#CC1D1D"],Q=[0.2,0.4,0.6,0.8],C=mstrmojo.VisEnum.IMAGELAYOUT_PROPERTIES;var O="0",a="1",G="2";mstrmojo.vi.models.ImageLayoutDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{getHostModel:function L(){return this.getHost().model.data;},getDisplayMode:function P(){var c=this.getHost().propertyManager;return c.getFormatPropertyValue(C.DISPLAY_MODE);},isZoneAvalaible:function V(c){if(c===K){return this.getDisplayMode()!==a;}return true;},getDropZones:function T(){var e=this.getDZFlatStruct(),d={allowSingle:true},c=[this.getZone(mstrmojo.desc(11661,"Geo Attribute"),B,e.GeoAttribute||e.Geo,false,d),this.getZone(mstrmojo.desc(11662,"Color By"),S,e.ColorBy,false,d),this.getZone(mstrmojo.desc(11663,"Size By"),K,e.SizeBy,this.getDisplayMode()===a,d),this.getZone(mstrmojo.desc(2962,"Tooltip"),Z,e.AdditionalMetrics),this.getZone(mstrmojo.desc(14473,"Path To Map"),J,e.Layout||e.layout,false,d)];this.dropZones=c;return{n:this.getHost().defn.ttl,zones:c};},getUnitMenuItems:function Y(g,k,n,m){var l=this,f=this.id,o=this.isMetric(n),h=k.items,d=h.length,c={zone:k,idx:N.find(h,"id",n.id),cnt:d,item:n,useDropzone:true},e=I.getDatasetFromAttributeId(this.docModel.datasets,n.did);if(o){if(n.um){g.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){l.editDerivedMetric(c,"edit");},c);g.addSeparator();}if(this.docModel.findDatasetIdFromUnit(n.did)&&!this.docModel.isFromSolrCube(n.did)&&!this.docModel.isFromMDXCube(n.did)){g.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",f,l.getAggregateByMetricSubMenu,c);g.addSeparator();}g.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),f,l.getCalculationEditorCfg,c);g.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){l.newDerivedMetric(c);},c);}else{if(!e||!this.docModel.isMDXDataset(e)){if(n.da){g.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){l.editDerivedAttribute(c);},c);g.addSeparator();}if(!this.isDynamicLink(n)){g.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){l.newDerivedAttribute(c,!l.allowInsertNewAttribute(k));},c);}}}g.addSeparator();if(this.shouldShowDisplayFormsMenu(n)){g.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return l.getDisplayFormsMenu(n);});}if(this.showNumberFormat(n)){g.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),f,this.getNumberFormatEditorCfg,c);}if(o){if(k.id===S){this.buildThresholdMenuOptions(g,c,true);}}g.addSeparator();g.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){l.renameItem(m,n);});g.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){l.deleteItem(k,l.getUnitIndexInZone(k,n));});},getAllowDropInfo:function M(n,h,r,f,d){var p=this,e=this._super(n,h,r,f,d),m=e.allowedItems,k=d.src.data,c=k.src===b.VIZ_EDITOR?k.srcZoneId:null,t=f===H.ON,l=true,o=true,g=this.getZoneModelByZoneId(S).items,q=this.getZoneModelByZoneId(K).items;switch(n.id){case B:case J:l=false;break;case Z:o=false;break;}return mstrmojo.hash.copy({allowedItems:(o&&!(n.items.length===0||t))?[]:N.filter(m,function(v){var u=p.isMetric(v);return l?u:!u;},o?{max:1}:null),removeReplaced:t&&(o||N.find(h,"did",n.items[r].did)===-1)},e);},getAddDropZoneUnitsActions:function F(d,e,c,f){var h=d.id,g;g=this._super(d,e,c,f);if(h===S){this.checkAndAddThresholdAction(S,e[0],g);}return g;},unitsDropped:function X(l,c,n){var h=c.src.data,e=c.actions||[],f=[],p=n.idx,d=n.edge,g=n.allowedItems,k=l.id,m=this,o=function(r){var t=m.getZoneModelByZoneId(r),q=N.intersection(t.items,g,"did");q.forEach(function(u){f.push(m.getRemoveDropZoneUnitAction(t,u,1));});};switch(k){case K:o(Z);break;case S:o(Z);break;case Z:o(K);o(S);break;}if(d===H.ON&&n.removeReplaced){f.push(this.getRemoveDropZoneUnitAction(l,l.items[p]));}N.insert(f,null,this.getAddDropZoneUnitsActions(l,g,this.getDropTargetIndex(l,n),{datasetId:h.dsid}));this.submitDropZoneUpdates(e.concat(this.getUpdateTemplateAction(f)),W.wrapMethods(c.callback,this.getHost().model.docModel.controller._getXtabCallback(this.getHost())));},checkAndAddThresholdAction:function U(f,d,e){var c=this.getHost();if(f===S&&this.isMetric(d)){A.addThresholds(c.model,c,c.node,d,e,E,Q,false);return true;}return false;},deleteItem:function R(d,c){this.submitDropZoneTemplateUpdates([this.getRemoveDropZoneUnitAction(d,d.items[c])]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.VisUtility","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.util.ThresholdUtils");var O=mstrmojo.hash,L=mstrmojo.array,S=mstrmojo.func,T=mstrmojo.VisUtility,C=mstrmojo.chart.model.enums.EnumDSSObjectType,R=mstrmojo.vi.viz.EnumDSSDropZones,B=mstrmojo.vi.util.ThresholdUtils,E=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,F=mstrmojo.vi.ui.DatasetUnitMenuUtils,A=R.FromItem,X=R.ToItem,G=R.ColorBy,W=R.SizeBy,I=R.ItemSize,D=["#CC2525","#E34B4B","#E97D7D","#79D479","#57BA57","#2CA02C"],M=[0.1,0.3,0.5,0.7,0.9];mstrmojo.vi.models.NetworkDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.NetworkDropZones",getHostModel:function J(){return this.getHost().model.data;},getDropZones:function P(){var a=this.getDZFlatStruct(),Z=function(b){return{allowSingle:true,title:b};},Y=[this.getZone(mstrmojo.desc(11910,"From Item"),A,a.from,false,Z(mstrmojo.desc(13833))),this.getZone(mstrmojo.desc(11911,"To Item"),X,a.to,false,Z(mstrmojo.desc(13833))),this.getZone(mstrmojo.desc(11912,"Edge Color"),G,a.ColorBy,false,Z(mstrmojo.desc(13829))),this.getZone(mstrmojo.desc(11913,"Edge Size"),W,a.SizeBy,false,Z(mstrmojo.desc(13829))),this.getZone(mstrmojo.desc(4781,"Item Size"),I,a.itemsz,false,Z(mstrmojo.desc(13829)))];this.dropZones=Y;return{n:this.getHost().defn.ttl,zones:Y};},getUnitMenuItems:function V(f,h,l,a){var k=this,e=this.id,m=this.isMetric(l),b=this.isAttribute(l),g=h.items,c=g.length,Z={zone:h,idx:L.find(g,"id",l.id),cnt:c,item:l,useDropzone:true},Y=(l.t===47&&l.st===12033),d=F.getDatasetFromAttributeId(this.docModel.datasets,l.did);if(Y){f.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",this.getCreateOrEditElementGroupFunc(Z));}if(m){if(l.um){f.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){k.editDerivedMetric(Z,"edit");},Z);f.addSeparator();}if(this.docModel.findDatasetIdFromUnit(l.did)&&!this.docModel.isFromSolrCube(l.did)&&!this.docModel.isFromMDXCube(l.did)){f.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",e,k.getAggregateByMetricSubMenu,Z);f.addSeparator();}f.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),e,k.getCalculationEditorCfg,Z);f.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){k.newDerivedMetric(Z);},Z);}else{if(b){if(!d||!this.docModel.isMDXDataset(d)){if(l.da){f.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){k.editDerivedAttribute(Z);},Z);f.addSeparator();}if(!T.hasCGorCon(this.getHost(),l)&&!this.isDynamicLink(l)){f.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){k.newDerivedAttribute(Z,!k.allowInsertNewAttribute(h));},Z);}}if(!F.hasOldDEOverDatasets(l.did,this.docModel.datasets)&&!this.isRecursiveAttribute(l)){f.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",this.getCreateOrEditElementGroupFunc(Z));}}}f.addSeparator();if(this.showNumberFormat(l)){f.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),e,this.getNumberFormatEditorCfg,Z);}if(m){if(h.id===G){this.buildThresholdMenuOptions(f,Z,true);}}if(this.shouldShowDisplayFormsMenu(l)){f.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return k.getDisplayFormsMenu(l);});}f.addSeparator();if(k.hasReplaceCandidates(Z)){f.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",e,k.getReplaceSubMenu,Z);}f.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){k.renameItem(a,l);});f.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){k.deleteItem(h,k.getUnitIndexInZone(h,l));});},getAvatarIconClass:function H(){return"viNetwork";},getAllowDropInfo:function K(e,c,g,a,Y){var f=this,Z=this._super(e,c,g,a,Y),h=e.items.length!==0&&a!==E.ON,d=[G,W,I].indexOf(e.id)!==-1,b=h?null:L.filterOne(Z.allowedItems,function(l){var k=f.isMetric(l);return d?k:(!k&&l.t!==C.DssTypeDimension);});return O.copy({allowedItems:b?[b]:[]},Z);},getAddItemActions:function(a,b,Y,c){var Z=this.getAddDropZoneUnitsActions(a,b,Y,{datasetId:c});this.checkAndAddThresholdAction(a.id,b[0],Z);return Z;},checkAndAddThresholdAction:function Q(b,Z,a){var Y=this.getHost();if(this.isMetric(Z)&&b===G){B.addThresholds(Y.model,Y,Y.node,Z,a,D,M,false);return true;}return false;},unitsDropped:function U(f,Z,h,k,Y){var c=Z.actions||[],b=[],e=Z.src.data,l=h.idx,a=h.edge,d=h.allowedItems,g=this;if(a===E.ON&&h.removeReplaced){b.push(this.getRemoveDropZoneUnitAction(f,f.items[l]));}b=b.concat(this.getAddItemActions(f,d,this.getDropTargetIndex(f,h),e.dsid));this.checkAndWarnLargeItemsForAddUnits(d,function(){g.submitDropZoneUpdates(c.concat(g.getUpdateTemplateAction(b)),S.wrapMethods(Z.callback,g.getHost().model.docModel.controller._getXtabCallback(g.getHost())));});},deleteItem:function N(Z,Y){this.submitDropZoneTemplateUpdates([this.getRemoveDropZoneUnitAction(Z,Z.items[Y])]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.VisUtility","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.util.ThresholdUtils");var M=mstrmojo.array,Q=mstrmojo.hash,W=mstrmojo.func,C=mstrmojo.chart.model.enums.EnumDSSObjectType,E=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,A=mstrmojo.vi.util.ThresholdUtils,V=mstrmojo.vi.ui.DatasetUnitMenuUtils,D=mstrmojo.vi.viz.EnumDSSDropZones,b=mstrmojo.vi.models.EnumDragSources,F=mstrmojo.vi.ui.DatasetUnitMenuUtils,X=mstrmojo.VisUtility,N=D.Grouping,G=D.SizeBy,P=D.ColorBy,a=D.AdditionalMetrics,B=["#CC2525","#E34B4B","#E97D7D","#79D479","#57BA57","#2CA02C"],R=[0.1,0.3,0.5,0.7,0.9];mstrmojo.vi.models.HeatMapDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.HeatMapDropZones",getHostModel:function J(){return this.getHost().model.data;},getDropZones:function S(){var d=this.getDZFlatStruct(),c=[this.getZone(mstrmojo.desc(2941,"Grouping"),N,d.Grp,false,{title:mstrmojo.desc(13828)}),this.getZone(mstrmojo.desc(11663,"Size By"),G,d.SizeBy,false,{allowSingle:true,title:mstrmojo.desc(13829)}),this.getZone(mstrmojo.desc(11662,"Color By"),P,d.ColorBy,false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(2962,"Tooltip"),a,d.AdditionalMetrics,false,{title:mstrmojo.desc(13827)})];this.dropZones=c;return{n:this.getHost().defn.ttl,zones:c};},getUnitMenuItems:function Z(l,n,q,e){var o=this,k=this.id,r=this.isMetric(q),f=this.isAttribute(q),m=n.items,g=m.length,d={zone:n,idx:M.find(m,"id",q.id),cnt:g,item:q,useDropzone:true},c=(q.t===47&&q.st===12033),h=F.getDatasetFromAttributeId(this.docModel.datasets,q.did);if(c){l.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",this.getCreateOrEditElementGroupFunc(d));l.addSeparator();}this.addSortMenu(d,l,false);l.addSeparator();if(r){if(q.um){l.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){o.editDerivedMetric(d,"edit");},d);l.addSeparator();}if(this.docModel.findDatasetIdFromUnit(q.did)&&!this.docModel.isFromSolrCube(q.did)&&!this.docModel.isFromMDXCube(q.did)){l.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",k,o.getAggregateByMetricSubMenu,d);l.addSeparator();}l.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),k,o.getCalculationEditorCfg,d);l.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){o.newDerivedMetric(d);},d);}else{if(f){var p=this.isDynamicLink(q);if(!h||!this.docModel.isMDXDataset(h)){if(q.da){l.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){o.editDerivedAttribute(d);},d);l.addSeparator();}if(f&&(q.de!==true)&&this.allowInsertNewAttribute(n)&&!X.hasCGorCon(this.getHost(),q)&&!p){l.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){o.newDerivedAttribute(d);},d);}}if(!F.hasOldDEOverDatasets(q.did,this.docModel.datasets)&&!this.isRecursiveAttribute(q)&&!p){l.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",this.getCreateOrEditElementGroupFunc(d));}}}l.addSeparator();if(this.showNumberFormat(q)){l.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),k,this.getNumberFormatEditorCfg,d);}if(r){if(n.id===P){this.buildThresholdMenuOptions(l,d,true);}}if(this.shouldShowDisplayFormsMenu(q)){l.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return o.getDisplayFormsMenu(q);});}l.addSeparator();if(o.hasReplaceCandidates(d)){l.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",k,o.getReplaceSubMenu,d);}l.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){o.renameItem(e,q);});l.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){o.deleteItem(n,o.getUnitIndexInZone(n,q));});},getAvatarIconClass:function H(){return"viHeatMap";},getAllowDropInfo:function L(o,g,t,f,c){var e=this._super(o,g,t,f,c),m=e.allowedItems,q=this,u=f===E.ON,l,p=false,k=false,n=function(v,w){return M.filter(m,function(z){var x=q.isMetric(z);return v?x:!x;},w?{max:1}:null);};switch(o.id){case N:l=false;break;case P:var d=!!n(false,true).length,h=!!n(true,true).length,r=this.isMetricZone(o.id);if(r){l=h;}else{l=!d;}p=l;k=r||l;break;case G:l=true;p=true;k=true;break;case a:l=true;m=m.filter(function(w){var v=[G,P],x=c.src.data;if(x.src===b.VIZ_EDITOR){M.removeItem(v,x.srcZoneId);}return v.every(function(z){return q.getUnitIndexInZone(q.getZoneModelByZoneId(z),w)===-1;});});break;}return Q.copy({allowedItems:(k&&!(o.items.length===0||u))?[]:n(l,p),removeReplaced:u&&(k||M.find(g,"did",o.items[t].did)===-1)},e);},unitsDropped:function Y(m,d,o,p,c){var k=d.src.data,g=d.actions||[],q=o.idx,e=o.edge,h=o.allowedItems,f=(e===E.ON&&o.removeReplaced)?m.items[q]:null,n=this,l=function(){var r=n.getAddItemActions(m,h,n.getDropTargetIndex(m,o),true,f,k.dsid);n.submitDropZoneUpdates(g.concat(n.getUpdateTemplateAction(r)),W.wrapMethods(d.callback,n.getHost().model.docModel.controller._getXtabCallback(n.getHost())));};if(m.id===N||(!this.isMetric(h[0])&&m.id===P)){this.checkAndWarnLargeItemsForAddUnits(h,l);return ;}l();},getAddItemActions:function U(m,l,q,h,d,g){var k=m.id,r=this.isMetric(l[0]),n=this,e={datasetId:g},f=[],p=false,c=function(u){var w=n.getZoneModelByZoneId(u),t=w.items.length,v=l.filter(function(x){return r?(h&&t===0):(n.getUnitIndexInZone(w,x)===-1);});if(v.length){M.insert(f,null,n.getAddDropZoneUnitsActions(w,v,r?0:t,e));return true;}},o=function(t){var u=n.getZoneModelByZoneId(t);l.forEach(function(v){if(n.getUnitIndexInZone(u,v)!==-1){f.push(n.getRemoveDropZoneUnitAction(u,v,1));}});};switch(k){case G:p=c(P);o(a);break;case P:if(r||this.isMetricZone(k)){m.items.forEach(function(t){f.push(n.getRemoveDropZoneUnitAction(m,t));});q=0;d=null;}c(r?G:N);if(r){o(a);p=true;}break;case a:o(G);o(P);break;}if(d){f.push(this.getRemoveDropZoneUnitAction(m,d));}M.insert(f,null,this.getAddDropZoneUnitsActions(m,l,q,e));if(p){this.checkAndAddThresholdAction(P,l[0],f);}return f;},checkAndAddThresholdAction:function T(f,d,e){var c=this.getHost();if(f===P&&this.isMetric(d)){A.addThresholds(c.model,c,c.node,d,e,B,R,false);return true;}return false;},deleteItem:function O(d,c){this.submitDropZoneTemplateUpdates([this.getRemoveDropZoneUnitAction(d,d.items[c])]);},deleteItems:function O(c,d){var e=this;this.submitDropZoneTemplateUpdates(d.map(function(f){return e.getRemoveDropZoneUnitAction(c,f);}));},getHighlightTargets:function K(e,d){if(e.id===P&&e.items.length&&d.item.t!==e.items[d.idx].t){var c=[];e.items.forEach(function(g,f){c.push({idx:f,edge:d.edge});},this);return c;}return this._super(e,d);},getReplaceCandidates:function I(d,e){var f=this._super(d,e);if(d.id===P){var c=this._super(d,{t:e.t===4?12:4});f=f.concat(c);}return V.getSortedDatasetUnits(f);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.DropZonesModel","mstrmojo.array","mstrmojo.vi.models._DropZoneCommon","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.mstr.EnumDSSXMLBaseFormType");mstrmojo.requiresDescs(190,1388,3224,5188,11806,12287,13295,13296,13624,13625,14003,14655,14656,14717);var H=mstrmojo.array,E=mstrmojo.vi.ui.DatasetUnitMenuUtils,C="-1",G=mstrmojo.mstr.EnumDSSXMLBaseFormType,D=mstrmojo.mstr.EnumDSSXMLObjectTypes;mstrmojo.vi.models.TemplateBasedDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{getClearAllUnitsActions:function B(){var J=[],I=this.getHost().model;this.getDropZones().zones.forEach(function(K){K.items.forEach(function(L){if(L.did!==C){J.push(I.getRemoveTemplateUnitAction(L));}});});return J;},getMultiUnitsMenuItems:function F(J,I,K){var L=this.id;if(E.getMultiSelectionShortcutMetricFunctions(K).length){J.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[L].getMultipleMetricsCalcMenus(I,K,false);});J.addSeparator();}J.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[L].deleteItems(I,K);});},getExtraUnitMenuItems:function A(J,I,L,K){},getUnitMenuItems:function A(P,S,X,U){if(!X){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var R=S.items,W=this.getHost(),L=R.length,M=S.id,K={zone:S,axis:M,idx:H.indexOf(R,X),cnt:L,item:X,metricsAxis:(this.getHost().gridInfo||{}).tma,useDropzone:false},T=this,J=this.id,Q=X.did===C,I=(X.t===D.Consolidation&&X.st===12033);if(I){P.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",function(){var Y={otp:X.t,id:X.did,n:X.n,axis:S.id,ui:K.idx};W.derivedElementsEdit(Y);});P.addSeparator();}if(!Q){if(X.t===D.Attribute&&X.st===3076){P.addMenuItem(mstrmojo.desc(14655,"Expand All Levels"),"",function(){var Y={id:X.did};W.raExpandAll(Y,true);});P.addMenuItem(mstrmojo.desc(14656,"Collapse All Levels"),"",function(){var Y={id:X.did};W.raExpandAll(Y,false);});P.addSeparator();}this.addSortMenu(K,P,true);P.addSeparator();if(X.t===D.Metric){if(X.um){P.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){T.editDerivedMetric(K);},K);P.addSeparator();}if(this.docModel.findDatasetIdFromUnit(X.did)&&!this.docModel.isFromSolrCube(X.did)&&!this.docModel.isFromMDXCube(X.did)){P.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",J,T.getAggregateByMetricSubMenu,K);P.addSeparator();}P.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),J,T.getCalculationEditorCfg,K);P.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",J,T.getShortcutMetricSubMenu,K);P.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){T.newDerivedMetric(K);},K);}if(X.t===D.Attribute){var O=X.did||"",N=O?E.getDatasetFromAttributeId(this.docModel.datasets,O):null,V=this.isDynamicLink(X);if(!N||!this.docModel.isMDXDataset(N)){if(X.da){P.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){T.editDerivedAttribute(K);},K);P.addSeparator();}if(((!N)||!E.hasCGorCon(N))&&!V){P.addMenuItem(mstrmojo.desc(13625,"New Attribute..."),"",function(){T.newDerivedAttribute(K);},K);P.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){T.newDynamicLinkAttr(K);},K);}}if(!E.hasOldDEOverDatasets(X.did,this.docModel.datasets)&&X.st!==3076&&!V){P.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",function(){var Y={otp:X.t,id:X.did,n:X.n,axis:S.id,ui:K.idx};W.derivedElementsEdit(Y);});}}this.getExtraUnitMenuItems(P,S,X,K);P.addSeparator();if(T.hasReplaceCandidates(K)){P.addSubMenuItem(mstrmojo.desc(14003,"Replace With"),"",J,T.getReplaceSubMenu,K);}P.addMenuItem(mstrmojo.desc(1388,"Rename"),J,function(){mstrmojo.all[J].renameItem(U,X);});P.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[J].deleteItem(S,K.idx);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.xtab.XtabMenuConfig");var A=mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES;mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig=mstrmojo.declare(mstrmojo.vi.ui.rw.xtab.XtabMenuConfig,null,{scriptClass:"mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig",buildXtabMenuConfig:function B(C){this._super(C);this.menus=this.menus.filter(function(D){return D.ctxt&&!D.ctxt.isTotals&&(this.isActionAvailable(D.ctxt.data,A.SORT)||this.isActionAvailable(D.ctxt.data,A.PIVOT));},this);},addDrillMenuItem:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.TreeBrowserSelector","mstrmojo.DynamicClassFactory","mstrmojo._HasLayout","mstrmojo.ObjectBrowserDataProvider","mstrmojo.ui._HasScroller","mstrmojo.ui.SearchBox","mstrmojo.ui._HasUITheme","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.ui._IsViPanel","mstrmojo.vi.ui._HasMask","mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui.CollapsibleTitleBar","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.css","mstrmojo.vi.ui.theme");var K=mstrmojo.DynamicClassFactory,S=mstrmojo.array,W=mstrmojo.hash,G=mstrmojo.dom,f=mstrmojo.css,A=mstrmojo.vi.ui.theme,I=mstrmojo.vi.ui.DatasetUnitMenuUtils,T=[4,12,1,47];function P(k){var h=[],g=[],o=this._shiftStartIndex,n=this.selectedIndices,m=Math.min(o,k),l=Math.max(o,k);S.forEach(this.items,function(p,q){if(m<=q&&q<=l){if(!n[q]){h.push(q);}}else{if(n[q]){g.push(q);}}});this.addSelect(h);this.removeSelect(g);}function R(g){var h=parseInt(g);return h===null||isNaN(h)?0:h;}function Q(){return !mstrApp.rootCtrl.resolveFeature("hide-objects-description");}function J(h){var g=mstrmojo.vi.enums.EnumDSSAccessRightFlags;return h.acg&&(h.acg&g.DssAccessRightUseFlag)&&(h.acg&g.DssAccessRightExecuteFlag);}function N(h,m){var l=h.itemsContainerNode,k=G.isMetaKey(m.src.hWin,m.src.e),o=G.eventTarget(m.src.hWin,m.src.e),g=-1;if(l&&o){S.forEach(l.childNodes,function(p,q){if(G.contains(p,o,true,p)){g=q;return false;}});}if(g!==-1){var n=h.items[g];if(!k&&!h.selectedIndices[g]){h.tree.clearTreeSelect();}if(S.indexOf(T,n.t)>=0){h.addSelect(g);}return true;}return false;}function X(k,g){var h=this.listSelector;if(h){h[k](this,this.itemsContainerNode,g);}}function C(h,k){var g=false;if(h.itemsContainerNode){S.forEach(h.ctxtBuilder.itemWidgets,function(l){if(G.contains(l.itemsContainerNode,k,l.domNode)){g=true;}});}return g;}mstrmojo.vi.ui.BrowserNodesAvatarContent=K.newComponent(mstrmojo.vi.ui.UnitList,null,{getItemProps:function(k,g){var h=this._super(k,g);h.addCls("isAvatar");return h;}});mstrmojo.vi.ui.TreeBrowserSelector=W.copy({premousedown:function(h,k,g){h.tree._selectNode=G.eventTarget(g.hWin,g.e);},premouseup:function V(r,g,u){if(G.isPrimaryMouseBtn(u.e)){var l=u.hWin,n=u.e,o=G.eventTarget(l,n),k=G.shiftKey(u.hWin,u.e),t=r._shiftStartIndex,m=C(r,o),q=r.listMapper.findIndex(r,g,o);if(q>-1&&!m&&r.tree._selectNode===o){var h=S.indexOf(T,r.items[q].t)!==-1;if(k&&t>-1&&h){r.rangeSelect(q);}else{r.toggleSelect(q);if(r.selectedIndices[q]&&h){r._shiftStartIndex=q;}}}}}},mstrmojo.TreeBrowserSelector);mstrmojo.vi.ui.TreeBrowser=K.newComponent(mstrmojo.TreeBrowser,[mstrmojo.vi.ui._HasUnitListAvatar],{containerResizable:false,draggable:true,avatarCssClass:"mstrmojo-VIUnitList",rangeSelect:P,_selectNode:null,_shiftStartIndex:-1,blockBegin:1,blockCount:50,getContent:function(h,n){var k=(h===this),g=this,o=function(p){if(k){mstrmojo.css.removeClass(g.domNode,["loading"]);}g.updateTreeContent(h,p);},l=function(p){h.contentRetrieved=true;h.set("items",[g.failItemCreaterFunc()]);},m={success:o,failure:l};if(k){mstrmojo.css.addClass(g.domNode,["loading"]);}if(mstrApp.objectsBlockCount){this.blockCount=parseInt(mstrApp.objectsBlockCount,10);}this.getContentThroughTaskCall({isRoot:k,data:h.data,blockBegin:n||h.blockBegin,blockCount:parseInt(mstrApp.objectsBlockCount,10)||g.blockCount},m);},getDragData:function E(h){h.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit();var m=this,n=function(r){S.forEach(r.ctxtBuilder.itemWidgets,function(t){var u=G.eventTarget(h.src.hWin,h.src.e);if(u&&G.contains(t.itemsContainerNode,u,true,t.itemsContainerNode)){m=t;n(t);return false;}});};n(this);var k=N(m,h);var o=k?this.getSelectedItems().filter(function(r){return S.indexOf(T,r.t)!==-1;}):null;var g=this.id,l=function l(r){var v=mstrmojo.all[g],t=v.avatar;if(t){var u=[v.avatarCssClass,"hasOwnAvatar",r];t.className=u.join(" ");}};return{items:o,item:o&&o[0],src:mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST,setAvatarClass:function p(r){l(r);},setInvalidAvatarClass:function q(){l("icn clsx_sub");}};},getSelectedItems:function(){var g=this.ctxtBuilder,h=[];if(g){S.forEach(g.itemWidgets,function(k){if(k.state===1){h=h.concat(k.getSelectedItems());}});}h=(this._super()||[]).concat(h);return h;},createAvatar:function(k,h){var g=document.createElement("div");this.avatarContent=new mstrmojo.vi.ui.BrowserNodesAvatarContent({items:h.src.data.items});this.avatarContent.render();f.addClass(this.avatarContent.domNode,[A.getThemeClass.call(this)]);g.appendChild(this.avatarContent.domNode);return g;},ondragend:function(g){this._super(g);if(this.avatarContent&&this.avatarContent.destroy){this.avatarContent.destroy();}delete this.avatarContent;},isDragValid:function B(h){var g=h.src.data.items;return(g&&g.length)||this._super(h)||false;},contentRetrieved:false,onvisibleChange:function(){if(!this.contentRetrieved){this.getContent(this);}}});mstrmojo.vi.ui.TreeBrowserNode=K.newComponent(mstrmojo.TreeBrowserNode,[{_mixinName:"newClass"}],{containerResizable:false,draggable:false,_shiftStartIndex:-1,rangeSelect:P,premousedown:function(g){this.tree._selectNode=G.eventTarget(g.hWin,g.e);},premouseup:function(h){if(G.isPrimaryMouseBtn(h.e)){var n=G.isMetaKey(h.hWin,h.e),m=G.shiftKey(h.hWin,h.e),o=G.eventTarget(h.hWin,h.e),p=G.contains(this.itemsContainerNode,o,true,this.domNode),l=p&&C(this,o),k=(this.state===2),g=!k&&(o!==this.stateNode&&o!==this.textNode)&&!p;if(l||this.tree._selectNode!==o){return ;}if((!n&&!m)||this.tree.isSelectedFolder||g){this.tree.clearTreeSelect();}if(g){this.tree.isSelectedFolder=true;}else{if(!p){this.tree.isSelectedFolder=false;}}if(!k&&(o===this.stateNode||o===this.textNode)){this.toggleState();this.tree.updateScroller();G.stopPropogation(h.hWin,h.e);}else{if(p){X.call(this,"premouseup",h);}else{this.handleNodeClicked();}}}},getSelectedItems:function(){var g=this.ctxtBuilder,h=[];if(g){S.forEach(g.itemWidgets,function(k){if(k.state===1){h=h.concat(k.getSelectedItems());}});}h=(this._super()||[]).concat(h);return h;}});function c(k){var h=this;return W.copy(k,{scriptClass:"mstrmojo.vi.ui.TreeBrowser",alias:"contents",slot:"containerNode",isSelectedFolder:false,browserNodeClass:mstrmojo.vi.ui.TreeBrowserNode,noCheckBox:true,itemIdField:"did",useRichTooltip:true,dataProvider:this.dataProvider,listSelector:mstrmojo.vi.ui.TreeBrowserSelector,showTooltip:function m(o,u){var t=o.target||G.eventTarget(o.hWin,o.e),r=G.findWidget(t);if(r.data){var p=r.domNode.firstChild,q="<div>"+r.data.n+"</div>"+(r.data.desc?"<div>"+r.data.desc+"</div>":"");if(p.scrollWidth>p.offsetWidth){var n=G.position(p);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",content:q,top:n.y-4,left:n.x+n.w+6};this.constructor.prototype.showTooltip.call(this,o,u);}}},updateScroller:function(){h.updateScrollbars();},isBranch:function(n){return n.t===8;},items:null,bindings:{data:"this.parent.rootFolder"},setDimensions:mstrmojo.emptyFn,item2textCss:function g(n){var o={8:"folder",3:"report",12:"attribute",4:"metric",47:"consolidation",1:"custom-group"};return mstrmojo.TreeBrowser.prototype.item2textCss(n)||o[n.t];},getTotalSelections:function(){return[];},getContentThroughTaskCall:function l(u,q){var p=u.data||{did:""},o=u.isRoot,n=this.parent.folderList,r=u.blockBegin,t=u.blockCount;this.dataProvider.fetchFolderContents({sId:mstrApp.sessionState,browsableTypes:this.parent.getObjectSubTypes().join(","),includeObjectDesc:Q(),folderLinksContextId:29,blockCount:t||50},{fid:p.did,blockBegin:r||1},{success:function(v){q.success({items:v.items&&v.items.filter(function(x){return x.t===8||J(x);}),sz:v.sz,bb:v.bb,bc:v.bc});if(o&&!n.initialized){n.set("items",v.sc);var w=S.find(v.sc,"did",v.did);if(w!==-1){n.set("selectedIndex",w);}}n.initialized=true;h.updateScrollbars();}});}});}mstrmojo.vi.ui.AllObjectsBrowser=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._IsViPanel,mstrmojo.ui._HasScroller,mstrmojo.vi.ui._HasMask,mstrmojo.vi.ui.toolbars._HasToolbar,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",markupString:'<div id="{@id}" class="mstrmojo-VIPanel mstrmojo-VIAllObjectsBrowser {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIPanel-titlebar"></div><div class="filter"></div><div class="search-box"></div><div class="horizontal-line"></div><div style="overflow:hidden;"><div class="mstrmojo-VIPanel-content"></div></div></div>',markupSlots:{titlebarNode:function D(){return this.domNode.firstChild;},filterNode:function a(){return this.domNode.childNodes[1];},searchBox:function M(){return this.domNode.childNodes[2];},contentNode:function L(){return this.domNode.childNodes[4];},containerNode:function b(){return this.domNode.childNodes[4].firstChild;}},title:mstrmojo.desc(5679,"All Objects"),model:null,rootFolder:null,getObjectSubTypes:function(){var g=[2048,3072,1024];if(!mstrApp.isSingleTier){g.push(12032);g.push(257);g.push(2560);}return g;},layoutConfig:{h:{titlebarNode:"30px",filterNode:"30px",searchBox:"33px",containerNode:"100%"},w:{titlebarNode:"100%",searchBox:"100%",containerNode:"100%"},xt:true},opened:false,dataProvider:null,onopenedChange:function(){if(!this.searchList&&this.opened){this.addChildren([c.call(this,{ondataChange:function(){if(this.data){this.getContent(this);}},ondblclick:this.dblClickOnNodes.bind(this)}),c.call(this,{alias:"searchList",visible:false,contentRetrieved:true,ondblclick:this.dblClickOnNodes.bind(this)})]);}},reset:function(){if(this.contents){this.removeChildren(this.contents);}if(this.searchList){this.removeChildren(this.searchList);}},dblClickOnNodes:function e(h){var m=h.getTarget(),l=G.findWidget(m).data,k=this.model,g=k.getSelectedViUnit();if(g&&l&&S.indexOf(T,l.t)!==-1){this.dataProvider.loadObjects([l],{success:function(){var n=I.getCfgForAddUnitFromAllObject([l],k.datasets);if(g){g.getZonesModel().addUnitsFromDataSource([l],n.dsid,n.actions,k.getDatasetsUpdateCallback());}}},true);}},getLayoutOffsets:function(){return{w:18,h:0};},children:[{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",cssClass:"vi-allObjects-tb",slot:"titlebarNode",alias:"titleBar",editTitleOnDoubleClick:false,getLayoutOffsets:function(){return{w:0,h:5};},onclick:function Y(){this.close();},close:function(){this.parent.close();},bindings:{title:"this.parent.title"}},{scriptClass:"mstrmojo.ui.Pulldown",slot:"filterNode",alias:"folderList",initialized:false,getLayoutOffsets:function(){return{w:0,h:9};},onitemSelected:function(g){if(this.initialized){this.parent.set("rootFolder",g);this.parent.obSearchBox.set("text","");}}},{scriptClass:"mstrmojo.ui.SearchBox",slot:"searchBox",alias:"obSearchBox",getLayoutOffsets:function(){return{w:0,h:13};},searchTriggered:function d(n){this.text=n;if(!n){this.clearSearch(true);return ;}var g=this.parent,l=g.contents.visible?g.contents:g.searchList,p=l.getSelectedItems(),h=g.folderList,k=this.parent.dataProvider,o=h.items[h.selectedIndex].did,m=this;p.forEach(function(q){if(q.t===8){o=q.did;return false;}});f.addClass(l.domNode,["loading"]);k.fetchFolderContents({browsableTypes:g.getObjectSubTypes().join(","),includeObjectDesc:Q(),folderLinksContextId:29,blockCount:50,enableQuickSearch:!!(mstrApp.useQuickSearch&&mstrApp.useQuickSearch())},{fid:o,searchPattern:n,recursive:1},{success:function(q){f.removeClass(l.domNode,["loading"]);if(m.inputNode.value){g.contents.set("visible",false);g.searchList.set("visible",true);(g.searchList||this).set("items",q.items);g.updateScrollbars();}}});},onkeyup:function Z(h){var g=h.hWin,k=h.e||g.event;if((mstrApp.useQuickSearch&&mstrApp.useQuickSearch())||((k.keyCode===13||k.keyCode===27||!this.inputNode.value))){this.constructor.prototype.onkeyup.call(this,h);}},postClearSearch:function(){this.parent.contents.set("visible",true);this.parent.searchList.set("visible",false);}}],getDropAvatarIcon:function U(g){return" ";},passToolbarCfg:function F(g){this.titleBar.set("toolbarCfg",g);},updateToolbar:function H(g){g.hasCloseButton=true;g.closeButtonText="";return g;},setupScrollNodes:function O(){this.scrollNode=this.containerNode;},updateScrollbars:function(){this._super();if(this.scrollNode&&this.hasCustomScrollbar){var k=this.scrollNode,g=(getComputedStyle&&getComputedStyle(k,null))||k.currentStyle,h=k.offsetWidth-R(g.borderLeftWidth)-R(g.borderRightWidth)-k.clientWidth;k.style.marginRight=-h+"px";k.style.paddingRight=h+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.models.template.DataInterface","mstrmojo.vi.models.EnumDragSources","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.vi.ui.DatasetUnitMenuUtils");var I=mstrmojo.expr,K=I.FN,L=I.ET,N=mstrmojo.hash,b=mstrmojo.vi.models.EnumDragSources,f=mstrmojo.vi.ui.DatasetUnitMenuUtils,W=mstrmojo.array,P=mstrmojo.string;var H=4,U=12,c="-1";var B=3;function G(p){return p.docModel.controller.cmdMgr;}function a(p,q){var r=p.xtab.k;return[r].concat(p.docModel.getSourceFilterKeys(r,true));}function T(t,q,r,u,p){q.reverse().forEach(function(v){u.push(t.model.getClearThresholdAction(r,p,v.tid));});}mstrmojo.vi.models.DocXtabModel=mstrmojo.declare(mstrmojo.DocXtabModel,[mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.models.DocXtabModel",getUnHiddenDrillPathsForCell:function h(p,u){var r=this.getAllDrillPathsForCell(p,u),t=this.docModel.datasets,q=function(v,z){var w=W.find(v,"did",z.id),x=v[w];if(x&&!x.hide){z.n=x.n;return true;}return false;};return W.filter(r,function(x){var v;for(v in t){var w=t[v];if(q(w.att,x)){return true;}}return false;});},getAllDrillWithinPathsForCell:function X(p,t,r){var q=r?this.getUnHiddenDrillPathsForCell(p,t):this.getAllDrillPathsForCell(p,t);return q.filter(function(u){return !!u.within;});},sort:function m(r,t){var p=this;G(this).execute({execute:function q(){var u=p.xtab.k;this.submit(p.docModel.getDataService().getUpdateTemplateAction(u,{act:"sort",sorts:r.sorts,nodeKey:u,subTotalsPos:r.stp||p.getSubTotalsPos(),stt:r.stt||-1}),t);}});},drillGrid:function Y(r,t){var p=this;G(this).execute({execute:function q(){this.submit(p.docModel.getDataService().getDrillGridAction(r),t);}});},getClearThresholdAction:function D(r,p,q){return{act:"clearThreshold",unitId:r,unitType:p,tid:q};},getCreateSimpleThresholdAction:function M(v,t,p,u,r,q){return{act:"threshold",nodeKey:t,thresholds:v,thresholdType:u,basedOnId:r||p,did:p,objType:q};},getZoneFormatAction:function J(x,AA,v){var w=[],r=[],u="h",p="g",z="sh",t="sg",q=function(AB,AC){r.push({axis:AB,regions:AC});};if(x==="ch"){q(1,[u]);q(2,[u,p,z]);}else{if(x==="rh"){q(1,[p,z]);}else{if(x==="va"){this.data.gsi.mx.forEach(function(AB){w.push({unitId:AB.did,unitType:4,regions:[p]});});q(1,[t]);q(2,[t]);}}}return{act:"formatGridZone",nodeKey:v,props:AA,units:w,axis:r};},getSelectorDataFromViewFilter:function e(r){var p=[],t="The expression is not supported by the View Filter Exception Parser.",v=function v(z){var w=null;if([L.AE,L.ANDOR].indexOf(z.et)>-1||(z.et===L.AQ&&z.fn===K.IS_NULL)){if(!z){return true;}var x=z.nds;w=!(z.not||z.fn===K.NOT||z.fn===K.NOT_IN_LIST);if(x){x.every(function(AA){w=w&&v(AA);});}}else{throw t;}return w;},q=function q(w,AA){var AD=w&&w.nds,AC=w.fn===K.OR;if(AD&&AD.length){var x=AA;AD.forEach(function(AE){if(AC){x=[];}q(AE,x);if(AC){AA.push(x);}});}else{if(w.fn===K.IS_NULL){var AB=w.a=w.a||{n:"Null Attribute",did:""};AA.push({tn:AB.n,tid:AB.did,eid:null,v:""});}else{if(w.et===L.AE){var z=w.es;z.forEach(function(AE){if(P.isEmpty(AE.n)){throw t;}AA.push({tn:w.a.n,tid:w.a.did,eid:AE.v,v:AE.n});});}}}return AA;};try{if(r){(r.nds||[]).forEach(function(w){p.push({keepOnly:v(w),data:q(w,[])});});}}catch(u){if(u!==t){console.error("vi.models.DocXtabModel: Encountered a problem parsing the view filter expression ("+u+")");}else{return[];}}return p;},getRemoveMetricLimitsAction:function k(p){var r=[],t=[],q=function q(v,w){if(!v){return ;}var u=v.nds;if(u){u.forEach(function(z){var x=z.m;if(x!==undefined){w.push(x.did);}else{q(z,w);}});}};if(p){q(p,r);r.forEach(function(u){t.push({act:"removeMetricLimits",unitId:u});});}return t;},getAddTemplateUnitAction:function C(u,v,r,p){var t=this._super(u,v,r,p),q=a(this,t);if(q.length>0){t.partialRetrieval={nodes:q};}return t;},getRemoveTemplateUnitAction:function l(r){var q=this._super(r),p=a(this,q);if(p.length>0){q.partialRetrieval={nodes:p};}return q;},getAdvancedPropertiesAction:function M(p){return{act:"advancedProperties",props:p};},canShowCellMenu:function d(p){var q,r=this.getCellDataUnion(p);q=!p.stt&&r.some(function(t){return !!t.isSubtotal;});return !q;},getKeepOnlyActionsForAssociatedNodes:function g(q,x,t){var p=this.docModel,w=[p.getKeepOnlyOrExcludeAction(this.xtab.k,q)],r=!!t?t:this.xtab,v=(r.getAssociatedNodes&&r.getAssociatedNodes())||[];x=mstrmojo.func.wrapMethods(x,{success:function u(){W.forEach(v,function(z){p.getPanel().getUnitByKey(z.k).boxContent.raiseEvent({name:"regenerateToolbar"});});}});W.forEach(v,function(z){w.push(p.getKeepOnlyOrExcludeAction(z.k,q));});return{actions:w,callback:x};},getObjectInfo:function E(p){var r=this.xtab.zonesModel,q=null;if(r){(r.getDropZones().zones||[]).some(function(t){return !!t.items.some(function(u){if(u.did===p){q=u;return true;}});});}else{q=this._super(p);}return q;},getObjectInfoFromDataset:function E(p){var q;N.forEach(this.docModel.datasets,function(r){if(!q){q=(r.mx.concat(r.att)).filter(function(t){return t.did===p;})[0];}});return q;},hasDerivedElements:function A(p){var q=this.getObjectInfo(p);return !!(q&&q.de);},isRecursiveAttribute:function Z(p){var q=this.getObjectInfoFromDataset(p);return q&&q.t===12&&q.st===3076;},supportsViewFilterActions:function Q(p){var q=this.getObjectInfo(p);return q&&!q.de&&(q.t!==1)&&(q.t!==47||q.st===12033);},addEditNodeForDatasetAction:function R(q,p){this.augmentDropContextForSchema(q,this.docModel);var u=q.getCtxtDragData(),t=u.src;if(t===b.DATASETS||t===b.ALL_OBJECT_LIST){var r=q.getCtxtDragData().dsid,v=q.actions||[];if(r){v.push({act:"editNode",nodeKey:p,datasetId:r});}q.actions=v;}},getCurrentUnitAxisAndPosition:function n(p){return new mstrmojo.models.template.DataInterface(this.data).getUnitById(p)||null;},getNumberFormatEditorCfg:function V(q){var v=this,p=v.xtab,t=v.data,r=(t.gnf||[]).concat(t.gnfu),AA=q.item,z=W.find(r,"id",AA.did),w=z===-1?{}:r[z],u=p&&(!p.defn.vis||!p.defn.vis.ve);var x=f.getNumberFormatEditor(q.item,w,function(AF){var AD=v.docModel.getNumberFormatAction(AA.did,AA.t,AF),AC=!!AD.partialRetrieval,AE,AB;if(AC){AE=mstrmojo.DocDataService.REQUEST_DEFN_DATA;AB={treesToRender:3};}p.controller.submitUndoRedoTemplateUpdates(p,AD,v.docModel.controller._getXtabCallback(p,undefined,AC),AE,AB);});return x;},showNumberFormat:function(u){var t=[1,2,8,9,11],r;if(u.t===12){var p=new mstrmojo.models.template.DataInterface(this.xtab.node.data),w=p.getRowTitles().titles.concat(p.getColTitles().titles),q=W.filterOne(w,function(x){return u.did===x.id;}),v=((q&&q.fs)||[]).map(function(x){return x.id;});r=(u.fs||[]).some(function(x){return t.indexOf(x.bftp)!==-1&&v.indexOf(x.fid||x.id)!==-1;});}return(u.t===4&&u.did!==c)||r;},openThresholdEditor:function(AF,u,AB){var t=this,q=t.xtab,AD=t.docModel,AA=t.data,AC=AA.gsi,z=AF.did,p=mstrmojo.desc(3647,"Thresholds");if(AF.t===H||AF.t===U){var x=N.clone(AC.mx),w;x.forEach(function(AG){AG.t=4;});w=AC.rows.concat(AC.cols,x).filter(function(AI){var AG=AI.t,AJ=AI.st,AH=AI.did;return !((AG===1&&AJ===257)||(AG===47&&AJ===12032)||(t.hasDerivedElements(AH))||(AH==="-1")||(AG===14));});w.forEach(function(AI){if(AI.t===12){var AH=this.getObjectInfo(AI.did);AI.da=AH?AH.da:undefined;}else{if(AI.t===4){var AG=this.getObjectInfoFromDataset(AI.did);AI.dt=AG&&AG.dt;}}},this);if(z!==c){p+=" - "+AF.n;}var v=mstrmojo.threshold.ThresholdModel.FEATURES,AE=new mstrmojo.threshold.ThresholdController({metricId:z,objectType:AF.t,title:p,data:AA,targets:w,messageId:AD.mid,datasets:AD.datasets,dataService:AD.getDataService(),supportsFeature:function r(AI){switch(AI){case v.SHOW_ADVANCED_EDITOR:return !u;case v.SHOW_BASED_ON:return !u;case v.SHOW_IMAGE:return AB;case v.SHOW_VALUE_ITEM:var AH=t.getObjectInfoFromDataset(this.model.basedOnId),AJ=AH&&AH.dt,AG=[8,9,10,14,15,16,30];return !AJ||AG.indexOf(AJ)===-1;}},onSubmitActions:function(AO,AI,AH,AJ,AM,AN,AG){var AL=this,AK=[];if(AI){T(q,AI,AH,AK,AG);}AK.push(t.getCreateSimpleThresholdAction(AO,q.k,AH,AM,AJ,AG));q.controller.submitUndoRedoTemplateUpdates(q,AK,{success:function(){if(AN){AL.set("data",t.data);AL.openEditor();AN=false;}}});},onSaveThresholds:function(AI,AG,AH,AK,AJ){this.dataService.saveThresholds(N.copy(AK,{thresholds:JSON.stringify(AI),basedOnId:AG,thresholdType:AH}),AJ,{hideFailureErr:true});},onLoadThresholds:function(AH,AI){var AG=this.model;this.dataService.getThresholds({thresholdsID:AI},{success:function(AO){var AN=AO.thresholds,AK=[],AJ,AP,AM={};W.forEach(AN||[],function(AQ){AJ=I.findTargets(AQ.expr,"did");AP=true;N.forEach(AJ,function(AR,AS){if(!t.getObjectInfo(AS)){AM[AS]=AR.n;AP=false;}});if(AP){AK.push(AQ);}});if(!N.isEmpty(AM)){var AL=N.valarray(AM);mstrmojo.alert(mstrmojo.desc(null,"The following objects: '#' are not on the template, so some thresholds will not be loaded...").replace("#",AL.join(",")));}AG.addThresholds(AK);}});}});if(AF.t===U){AE.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;}AE.openEditor();}},buildThresholdMenuOptions:function S(v,q,u,AB){var t=this,p=t.xtab,AA=t.data,AC=AA.gsi,r=AC.thresholds,AD=q.item,z=AD.did,x=r&&r[z],w=mstrmojo.desc(13261,"Clear Thresholds");if(AD.t===H||AD.t===U&&!t.docModel.isOldDEObject(z)){v.addMenuItem(mstrmojo.desc(6050,"Thresholds..."),"",function(){t.openThresholdEditor(AD,u,AB);},this);if(z!==c){if(x){v.addMenuItem(w,"",function(){var AE=[];T(p,x,z,AE,AD.t);p.controller.submitUndoRedoTemplateUpdates(p,AE);},this);}}}},moveSubTotals:function O(p,q){var v=this,u=this.xtab.gridInfo.sorts,t=p.data.axis,x=u[t-1],r=!!(x.length&&x[0].key!==("0!00000000000000000000000000000000!!!!"+t));G(this).execute({execute:function w(){var AA=v.xtab,z=AA.k;this.submit(v.docModel.getDataService().getUpdateTemplateAction(z,{act:"moveSubTotal",nodeKey:z,sorts:r?u:[],subTotalsPos:q,stt:-1,axis:t}),AA.controller._getXtabCallback(AA));}});},getAttributeFormsInTemplate:function(r){var p=this.data.gts,q=[];(p.row||[]).concat(p.col||[]).forEach(function(t){if(t.id===r){q=q.concat(t.fs);}});return q;},getPivotFormAction:function(AB,q){var r=this.getCellTitleInfo(AB),x=r.title,t=x.fs,w=(t&&t.length)||0,u=x.id,v=this.getAttributeFormsInTemplate(u),AA=w>1?(AB.idx%v.length):(x.fix-1),p=v[AA],z;if(q==="l"){z=AA-1;}else{if(q==="r"){z=AA+1;}}return{act:"pivot",unitPos:z+1,attFormId:p.id,unitId:u};},getValuesDefaultFormatGridZoneAction:function(t){var r={},v=mstrmojo.models.FormatModel,q,x=this.xtab,w=x.gridInfo.fmts,u=[];N.forEach(t,function(z){u.push({unitId:z.did,unitType:H,regions:["g"]});});var p;N.forEach(w&&w.va,function(AA,z){p=v.getFormatPropertyInfo(z);if(p){r=N.mergeHashes(r,v.getFormatUpdate(z,(p.pt==B)?AA:v.decodeValue(z,AA)));}});q=x.model.getZoneFormatAction.call(x.model,"va",r,x.k);q.units=[].concat(u);return q;},isRecursiveAttribute:function Z(p){var q=this.getObjectInfoFromDataset(p);return q&&q.t===12&&q.st===3076;},getRAExpandAction:function F(r,u,t){var q=this.getCellTitleInfo(r).title,p={act:"raExpandCollapse",unitId:q.id,sliceId:u,depth:r.dpt,ordinal:(r.o!==undefined)?r.o:r._ei,isExpand:t?1:(r.epd?0:1)};if(t){p.expand_dsts=1;}return p;},getRAExpandAllAction:function o(q,p){return{act:"raExpandCollapseAll",unitId:q,isExpandAll:p?1:0};},getUnitNameInDataSet:function(p){return this.docModel.findUnitNameInDataSetFromUnit(p);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu","mstrmojo.vi.ui.TargetSelector","mstrmojo.Label","mstrmojo.dom","mstrmojo.css","mstrmojo.func","mstrmojo.tooltip","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.vi.models.EnumDragSources","mstrmojo.models.FormatModel","mstrmojo.EnumRWUnitType");var G=mstrmojo.css,P=mstrmojo.dom,t=mstrmojo.func,C="\u001E",l=mstrmojo.EnumRWUnitType,k=mstrmojo.models.FormatModel,m=k.getFormatUpdate,f=k.ENUM_PROPERTY_NAMES,N=mstrmojo.DocSelector.STYLES;function K(x){return x&&x.did!=="-1"&&x.t!==14;}function M(x){var z=x.getCtxtDragData();return(z.items||[]).filter(K)[0];}function D(x){var z=x.getCtxtDragData();return z.src&&(z.items||[]).some(K);}function v(){return !!this.boxContent.defn.srcid;}function J(){var z=this.boxContent.defn.srcid,x=this.model.getDatasetUnits(["att","mx"],function(AA){return AA.did===z;});return(x.length&&x[0])||null;}function Y(x){var z=this.targetSelector=new mstrmojo.vi.ui.TargetSelector({alias:"targetSelector",orientation:this.orientation,hostId:this.id});this.showControlOverlay([z]);if(x){z.enterSelectMode();}else{z.enterPreSelectMode();}}function n(){if(v.call(this)){if(!this.targetSelector){this.targetSelector=new mstrmojo.vi.ui.TargetSelector({alias:"targetSelector",orientation:this.orientation,hostId:this.id});}var x=this.targetSelector;if(this.getTargetKeys().length>0){x.enterOffMode();this.hideControlOverlay();}else{this.showControlOverlay([x]);x.enterPreSelectMode();}}}function X(){return !this.defn.ob;}function w(x){this.domNode.setAttribute("title",x?this.getDisplayName():"");this.set("useRichTooltip",x);}function O(){G.toggleClass(this.domNode,"horizontal",!!this.defn.horiz);}mstrmojo.vi.ui.rw.FilterBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,[mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu,mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.ui.rw.FilterBox",init:function u(x){this._super(x);G.addWidgetCssClass(this,"mstrmojo-FilterBox");},targetSelector:null,useRichTooltip:true,isDynamicTooltip:true,onclick:function e(x){var AC=P.isPrimaryMouseBtn(x.e),z=v.call(this),AB=P.contains(this.containerNode,x.getTarget(),true,this.domNode),AA;if(AC&&z){if(AB){AA=true;x.e.ptvSelected=true;}else{if(!P.contains(this.titlebarNode,x.getTarget(),true,this.domNode)){x.e.ptvSelected=true;}}}this._super(x);if(AA){this.getEditorModel().selectTargetByValue(mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE);}},moveTooltip:function T(x,AA){this.domNode.removeAttribute("title");var z=P.findWidget(x.target);if(z.id!==this.boxContent.id){return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-A",content:this.getDisplayName(),top:x.clientY+15,left:x.clientX-15};this._super(x,AA);},postBuildRendering:function U(){O.call(this);this._super();this.generateToolbar();if(!v.call(this)){this.boxContent.set("visible",false);this.showControlOverlay([{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(13258,"Drag object here.")}]);}else{if(!this.getTargetKeys().length){Y.call(this);}}if(!this.showTitleBar){var x=J.call(this);this.set("title",(x&&x.n)||"");}if(this.model){G.toggleClass(this.domNode,"items-fit-content",this.model.itemsFitContent);}},onRender:function F(){w.call(this,!this.showTitleBar);},orientationHasChanged:function b(){if(X.call(this)){var x=this.orientation,AA=x==="h",z=this.boxContent.content;z.isHoriz=AA;z.set("orientation",x);this.defn.horiz=AA;O.call(this);}},addFormatProps:function o(AA,z){AA=this._super(AA,z);var x=this.orientation;if(this.boxContent.content.orientation!==x&&X.call(this)){AA=AA||this.model.getUnitFormatAction(this,NaN,null,z);mstrmojo.models.FormatModel.getFormatUpdate(mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES.CONTROL_ORIENTATION,x==="v"?0:1,AA.format);this.defn.horiz=x==="h";if(!z){window.setTimeout(function(){this.parent.rebuildChild(this);}.bind(this),0);}}return AA;},createDeleteUpdate:function d(){var x=this.model;update=x.getRemoveControlUpdate(this.k,this.parent.k,this.defn.tks||"");if(this.defn.tks&&this.boxContent.isSelectAll&&!this.boxContent.isSelectAll()){update.setTreesToRender(3);}update.addUpdate(x.associatedNodesUpdate(this.parent.children));return update;},updateToolbar:function g(x){var z=this.boxContent,AA=this.targetSelector;n.call(this);if(this.canShowDesignMenuItems()&&z&&v.call(this)){this.addModeMenuItems(x,z);x.addSeparator();this.addClearFilterMenuItem(x,z);x.addSeparator();this.addQualMenuItems(x,z);this.addFilterStyleMenuItem(x,z);this.addMultiSelectMenuItem(x,z);x.addSeparator();this.addMenuItemIfSelectTargetsValid(x,z,mstrmojo.desc(12288,"Target the following visualizations or filters:"));x.addSeparator();this.addToggleTitleMenuItem(x);}return this._super(x);},showControlOverlay:function c(z,x){this._super(z,x);G.addClass(this.domNode,"overlay");},hideControlOverlay:function B(){this._super();G.removeClass(this.domNode,"overlay");},addContextMenuItems:function q(z,x){this._super(z,x);if(v.call(this)){this.addMenuItemIfSelectTargetsValid(z,this.boxContent,mstrmojo.desc(12288,"Target the following visualizations or filters:"),false);}return z;},getFormatMenuItemTarget:function H(x){if(!x||!P.contains(this.titlebarNode,x.getTarget(),true,this.domNode)){return mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE;}return this._super(x);},getTargetInfo:function S(){var AA=this.parent,z=[l.GRID,l.GRAPH,l.MOJOVISUALIZATION].concat(this.model.isFromSolrCube(this.boxContent.defn.srcid)?[]:[l.SELECTOR]),x=AA.getTargetKeysByType(z).map(function(AB){var AC=AA.getUnitByKey(AB);return{n:AC.getDisplayName(),id:AB,st:AC.defn.style};}).filter(function(AB){return(AB.id!==this.k&&AB.st!==N.ATTR_QUAL);},this);return{keys:this.getTargetKeys(),items:x};},toggleTitleBar:function W(x){this._super(x);w.call(this,!x);},getDisplayName:function E(){return this._super()||mstrmojo.desc(6189,"Filter");},updateDisplayName:function I(x,z){this._super(x,z,true);},getAvatarCls:function h(){return this._super().concat(["filterAvatar"]);},allowDropFromDataset:function V(x){return !v.call(this)&&D(x)&&mstrApp.allowWebDashboardDesign();},dropFromDataSource:function r(AA){var AO=M.call(this,AA),AJ=this.id,AQ,AI,AH;if(AO){var AB=this.getDocModel(),AL=AB.getDataService(),AC=this.defn,z=this.getTargetKeys(),AM=[this.k].concat(z),x=this.boxContent,AN=!v.call(this),AG=(AA.actions||[]).concat([AL.getSetCtrlSourceAction(AC.ck,AO.did,AO.t)]),AD=t.wrapMethods(AA.callback,{success:function(AR){var AS=mstrmojo.all[AJ];AB.partialUpdate(AR.data,AB.getTargetDefn(AM.join(C)),AR.defn,[x.defn.ckey]);AS=AS.parent.rebuildChild(AS);if(AN){AS.hideControlOverlay();delete AS.targetSelector;}AS.boxContent.set("visible",true);AS.generateToolbar();if(!z.length){Y.call(AS);}}});AQ=AB.getCtrlStyleFromDatasetUnit(AO);AG=AG.concat(AB.getCtrlActionsByStyle(AO,x.ck,AQ,this.orientation==="v"?0:1,parseInt(this.height,10),parseInt(this.width,10)));AH=this.height;AI=0;if(AO.t===4){AG.push(AB.getUnitFormatAction(this,5,m(f.SHOW_TITLE_BAR,true)));if(AH==="40px"){AI=20;}}if(this.orientation==="h"){var AK=this.parent,AP=AK.boxLayoutConfig,AF=AP.box,AE=AF&&AF.children&&AF.children[AP.getBoxPath(this)];AI=AI+AB.getICSCtrlMoveHeightByStyle(AQ);if(AE&&AE.f){AE.l=AE.l+AI;AG=AG.concat(AK.getChildPositionActions(true));AG=AG.concat(AK.getBoxLayoutActions(true));}}AB.submitDataDefnUpdate(AG,AD);}},dropFromDataset:function Q(x){this.dropFromDataSource(x);},dropFromAllObjects:function p(x){this.augmentDropContextForSchema(x,this.getDocModel());this.dropFromDataSource(x);},setTargets:function Z(x){this.getDocModel().changeFilterTargets(this,this.getTargetKeys(),x,true,true);},getTargetKeys:function A(){var x=this.defn.tks;return(x&&x.split(C))||[];},getTitleBarCfg:function L(){var x=this._super();x.titleEdited=function z(AB,AF,AA){var AE=this.parent,AH={success:function AG(AI){AE.defn.ttl=AI;AE.set("title",AI);},failure:function AD(AI){mstrApp.onerror(AI);AE.titleBar.set("title",AA);}};if(AF){var AC=AE.getDocModel();AC.updateTitle(AB,this.title,AE.k,AC.currlaykey,"ttl",AH);}};return x;},applyCSSFormatToNode:function a(z,x){var AB=this.boxContent;if(AB&&AB.content&&AB.content.hasRendered){var AA=AB._inSyncPhase;AB._inSyncPhase=true;AB.content.refresh();AB._inSyncPhase=AA;}this._super(z,x);},getBoxConfiguration:function R(){var x=this._super();if(this.showTitleBar){x=mstrmojo.hash.clone(x);x.f.v+=20;}return x;}});mstrmojo.vi.ui.rw.FilterBox.boxConfiguration={f:{h:150,v:42},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.models.EnumDragSources","mstrmojo.models.FormatModel","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.css","mstrmojo.hash","mstrmojo.array","mstrmojo.vi.ui.DatasetUnitMenuUtils");var Z=mstrmojo.vi.models.EnumDragSources,d=mstrmojo.models.FormatModel,I=d.getFormatUpdate,S=d.ENUM_PROPERTY_NAMES,G=mstrmojo.vi.ui.DatasetUnitMenuUtils,N=mstrmojo.array,V=mstrmojo.hash;function C(f){var e=this.width;f.forEach(function(l){var h=l.getLayoutOffsets&&l.getLayoutOffsets(),k=(h&&h.w)||0,g=e;if(k){g=parseInt(g,10)-k+"px";}if(l.setDimensions){l.setDimensions(l.height,g);}});}function J(){this._dividers.forEach(function(e){e.style.height=0;});}function A(){var e=this.containerNode;this._dividers.forEach(function(f){e.removeChild(f);});this._dividers=[];}function c(){var o=this._orderedSelectors=(this.getPanelChildren()||[]).filter(function(u){return !!u.togglePortlet;}).sort(function(v,u){var w=function(x){return(x&&x.selector&&x.selector.defn&&x.selector.defn.fmts&&x.selector.defn.fmts["z-index"])||0;};return(parseInt(w(v))>parseInt(w(u)))?1:-1;});this.set("empty",!o.length);A.call(this);var n=o.map(function(v){var u=v.selector;return{node:v.domNode,selector:u,fmts:u.defn.fmts};}),g=this.containerNode,m=this.model,l=this._dividers=[],p="z-index",k=[];while(g.lastChild){g.removeChild(g.lastChild);}n.forEach(function(w,u){if(parseInt(w.fmts[p],10)!==u){k.push(m.getUnitFormatAction(w.selector,1,I(S.Z_INDEX,u)));}w.fmts[p]=u;var v=document.createElement("div");v.className="fp-divider";g.appendChild(v);l.push(v);g.appendChild(w.node);});var r=this.emptyMsgBoxNode;if(r){g.appendChild(r);}if(k.length){var q=m.controller.cmdMgr,f=q.getInterimCmd(),t,h=mstrmojo.DocDataService.SUPPRESS_DATA;if(f){t={success:mstrmojo.emptyFn};f.submit(k,t,h,q.CMD_PHASE.LAST);}else{var e=m.getDataService();t={success:function(){var u=m.getDataService().stid||0,v=m.lastSavedStid||0;if(u-v===1){m.lastSavedStid=u;}}};e.submitUpdates(k,t,V.copy(h,{preserveUndo:true}));}}}function B(f){var e=f&&f.src;return e&&(e===Z.DATASETS||e===Z.VIZ_EDITOR||e===Z.ALL_OBJECT_LIST);}function P(g){var o=g.tgtData,n=g.tgt.pos.y,f=o.map,k=f&&f.length;if(!f){var h=mstrmojo.dom.position(this.domNode).y;f=g.tgtData.map=(this._orderedSelectors||[]).map(function(p){var q=p.domNode;return h+q.offsetTop+Math.round(q.offsetHeight/2);});k=f&&f.length;}(o.map||[]).every(function(q,p){if(n<q){k=p;return false;}return true;});if(o.tgtIdx===k){return ;}o.tgtIdx=k;J.call(this);var m=this._dividers[k],e=g.src.data,l=(e&&e.dim&&e.dim.h)||null;if(m){m.style.height=(l||"48")+"px";}}function Q(f){var e=this.model;return f.did!=="-1"&&f.t!==14&&G.isValidAddToFP(e,f);}mstrmojo.vi.ui.rw.FilterPanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.ui.rw.FilterPanel",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:function(){C.call(this,this.children||[]);},onemptyChange:function(){mstrmojo.css.toggleClass(this.emptyMsgBoxNode,"hide",!this.empty);}},width:null,model:null,subPanelCssText:"background-color: transparent;",empty:true,init:function W(e){this._super(e);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIFilterPanel");this._dividers=[];this.attachEventListener("childrenRendered",this.id,c);},postBuildRendering:function a(){var e=this.containerNode;if(e&&!this.emptyMsgBoxNode){var f=document.createElement("div");f.className="fp-empty-msgbox";f.innerHTML=mstrmojo.desc(13258,"Drag objects here.");e.appendChild(f);this.addSlots({emptyMsgBoxNode:f});}return this._super();},isEmpty:function T(){return this.empty;},updateForPU:function Y(e){var g=e.defn&&e.defn.ck;this.node.data.objects=this.node.data.objects.filter(function(h){if(g[h.k]){return true;}return false;});if(e.data&&e.data.objects){var f=this.node.data.objects;N.forEach(e.data.objects,function(h){if(N.find(f,"k",h.k)<0){f.push(h);}});}this.update(e);},refresh:function D(g,f){var e=this.domNode.clientWidth-2*2;this.contentWidth=(e>0)?e:0;this._super(g,f);},refreshFP:function H(){c.call(this);},unrender:function X(e){A.call(this);this._super(e);},addChildren:function M(g,e,f){var h=this.parent;if(g&&g.constructor!==Array){g=[g];}C.call(this,g);this._super(g,e,f);if(!g||!g.length){c.call(this);}if(h&&h.scrollNode){h.updateScrollbars();}},toggleFilters:function L(k){var n=this,l=n.model,m=k?1:0,e=mstrmojo.DocDataService,p=e.EMPTY_CALLBACK,g=e.SUPPRESS_DATA,h=k,f=function(){n.raiseEvent({name:"filterPanelUpdated"});};var o=function(){h=!h;(n.children||[]).forEach(function(q){q.set("_onCollapseAll",true);q.togglePortlet(h);q.set("_onCollapseAll",false);});f();};l.execute({execute:function(){var q=l.getDataService().newUpdate(this);(n.children||[]).forEach(function(r){if(r.togglePortlet){r.set("_onCollapseAll",true);r.togglePortlet(k);r.set("_onCollapseAll",false);q.addActions(l.getUnitFormatAction(r.selector,1,{FormattingView:{WindowState:m}}));}});q.addCallbacks({success:f});q.addExtras(e.REQUEST_ONLY_DEFINITION);q.submit();},urInfo:{undo:function(){o();},redo:function(){o();},callback:p,extras:g}});},getContextDragData:function(e){var f=this._super(e);if(f.src===Z.ALL_OBJECT_LIST){this.augmentDropContextForSchema(e,this.model);e.preInfo={actions:e.actions,callback:e.callback};}return f;},allowDrop:function E(e){var h=this.getContextDragData(e);if(h){var g=h.src;if(B(h)){var f=this;return h.items.some(function(k){return Q.call(f,k);});}if(g===Z.FILTERS){return true;}}return false;},ondragenter:function O(e){this._super(e);e.tgtData={tgtIdx:999};P.call(this,e);},ondragover:function U(e){P.call(this,e);},ondrop:function b(f){var h=f.tgtData;if(!h){return this._super(f);}var m=f.src&&f.src.data,g=m&&m.src,q=this.model,t=this,p=function(){return h.tgtIdx;};if(B(m)){var n=[];m.items.forEach(function(u){if(Q.call(t,u)){n.push(u);}});var e=function(u){q.addFilterStackSelectors(u,p(),{preInfo:f.preInfo,postInfo:f.postInfo});};if(g===Z.ALL_OBJECT_LIST){var o=f.src.widget,l=o&&o.dataProvider;if(l){l.loadObjects(n,{success:function(u){e((u&&u.objects)||n);}},true,true);}}else{e(n);}}else{if(g===Z.FILTERS){var r=parseInt(m.idx,10),k=p();if(r<k){k--;}if(r!==k){q.pivotFilterStackSelector(this._orderedSelectors[r].selector,r,k);}}}this._super(f);},getDropAvatarIcon:function R(f){var h=f.src.data,g=h&&h.src,e="unselectable";if(B(h)){e="add";}else{if(g===Z.FILTERS){e="move";}}return e;},cleanUpAfterTarget:function K(e){J.call(this);this._super(e);},clearAllFilter:function F(){(this.children||[]).forEach(function(e){if(e.clearFilters){e.clearFilters();}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.rw.RichTooltipBox","mstrmojo._FormatDefinition","mstrmojo.css","mstrmojo.Label","mstrmojo.Button","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.models.EnumFieldTypes","mstrmojo._FormatDefinition","mstrmojo.hash");var b=mstrmojo.css,T=mstrmojo.hash,K=mstrmojo._FormatDefinition,D=mstrmojo.string,c=mstrmojo.vi.models.EnumDragSources,L=mstrmojo.vi.models.EnumFieldTypes;function O(f){this.boxContent.update({defn:this.defn,data:{v:f}});}function J(f){var k=f&&f.src&&f.src.data,g=this.model.datasets,h;if(!k||(k.src!==c.DATASETS&&k.src!==c.ALL_OBJECT_LIST)){return[];}h=g&&g[k.dsid];return(k.items||[]).filter(function(l){return !!l.n;}).map(function(m){var l=true;T.forEach(g,function(n){if(n.did!==k.dsid&&n.mx&&n.mx.some(function(o){return o.n===m.n;})){l=false;}});return h&&!l?"{["+h.name+"]:["+m.n+"]}":"{["+m.n+"]}";});}function R(){return !this.boxContent||D.isEmpty(this.boxContent.getRawText());}function Z(){if(R.call(this)){this.showControlOverlay(this.getEditOverlayControls());}else{this.hideControlOverlay();}}function E(h,g,f){if(g!==f){O.call(mstrmojo.all[h],f);}}mstrmojo.vi.ui.rw.TextBox=mstrmojo.declare(mstrmojo.vi.ui.rw.RichTooltipBox,[mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.ui.rw.TextBox",isDynamicTooltip:true,tooltipTopOffset:35,init:function V(f){this._super(f);b.addWidgetCssClass(this,"mstrmojo-VITextBox");},getDisplayName:function M(){return this.defn.n||mstrmojo.desc(1013,"Text");},textEdited:function Q(h,g,f){if(g){var k=this.id;this.model.editField(this,L.TEXT,{fail:function(){E(k,h,f);}},h,f,null);}},getFormats:function e(){var f=T.clone(this._super());if(f){delete f.fx;}return f;},dropFromAllObjectsHandler:function W(k,h,f,g){if(h){var l=this.id;this.model.editField(this,L.TEXT,{fail:function(){E(l,k,f);}},k,f,{actions:g.actions,callback:g.callback});}},applyBoxSize:function U(f,h,m,l){this._super(f,h,m,l);var k=this.boxContent,g=k&&k.getFormats();if(g){g.height=f;g.width=h;k.refresh();}},createDeleteUpdate:function G(){return this.model.getRemoveFieldUpdate(this);},addFormatProps:function B(h,g){h=this._super(h,g)||this.model.getUnitFormatAction(this,NaN,null,g);var f=h.format=T.copy(h.format,{FormattingSize:{}});f.FormattingSize.HeightMode=0;return h;},getBoxDimension:function F(g){var h=this.boxContent,f=h&&h.getFormats();return(g==="h")?{f:false,l:null}:{f:true,l:parseInt(f.height||"40px",10)};},getAvatarCls:function P(){return this._super().concat(["textAvatar"]);},ondrop:function Y(g){this._super(g);var f=J.call(this,g);if(f.length){var h=this.boxContent.getRawText();if(h){f.unshift(h);}if(g.getCtxtDragData().src===c.ALL_OBJECT_LIST){this.augmentDropContextForSchema(g,this.getDocModel());this.dropFromAllObjectsHandler(f.join(" "),true,h,g);}else{this.textEdited(f.join(" "),true,h);}}},allowDropFromDataset:function d(){return mstrApp.allowWebDashboardDesign();},getEditOverlayControls:function H(){return[{scriptClass:"mstrmojo.Widget",markupString:'<div class="init-img"></div>'},{scriptClass:"mstrmojo.Label",cssClass:"init-label",text:mstrmojo.desc(13034,"Type directly or drag objects here.")}];},switchToEditMode:function N(){if(this.ctrlOverlay.visible){this.hideControlOverlay();}if(!this.boxContent.isEditing){var f=this.boxContent.getRawText();if(f){this.boxContent.set("text",f);}}this.boxContent.set("isEditing",true);},updateToolbar:function I(g){if(this.canShowDesignMenuItems()){var k=this.id,f=K.DefaultFormat.FormattingNumber,h=this.model;g.addPopupMenuItem(mstrmojo.desc(3573,"Number Format..."),k,function(){var o=this.defn.numFmts||{},m=o.cat,l={category:m===undefined?mstrmojo._FormatDefinition.NumberFormatCategory.Automatic:m,decimalPlaces:o.dp||2,thousandSeparator:o.ts||parseInt(f.ThousandSeparator,10),currencySymbol:o.cs||f.CurrencySymbol,currencyPosition:o.cp||f.CurrencyPosition,format:o.nfs||"",negativeNumbers:o.nn||f.NegativeNumbers},n=T.clone(l);return new mstrmojo.ui.menus.EditorConfig({data:n,cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:l,myData:n,oldData:T.clone(l)}],fnOk:function p(r){h.execute({execute:function q(){var v=h.getDataService().newUpdate(this),u=mstrmojo.all[k];v.addActions(Object.keys(f).map(function(w){var x={};x[w]=r[w.substr(0,1).toLowerCase()+w.substr(1)];return h.getUnitFormatAction(u,1,{FormattingNumber:x});}));v.addCallbacks({success:function t(w){h.partialUpdate(w.data,h.getTargetDefn(u.k),w.defn,[u.k]);h.selectVIUnit(k);}});v.addExtras({style:{params:{treesToRender:3}}});v.submit();}});}});});}return this._super(g);},isDragValid:function C(f){return this._super(f)&&!this.boxContent.isEditing;},postBuildRendering:function X(){this._super();this.ctrlOverlay.domNode.onclick=function f(){this.switchToEditMode();}.bind(this);this.addDragHandle();var g=this.boxContent;this.toggleDragHandleVisibility(g.hasActiveLink()&&g.text);},postUpdateLayout:function A(){var f=this.isNewUnitContainer;this._super();if(f&&R.call(this)){this.switchToEditMode();}},destroy:function a(g){var f=this.ctrlOverlay.domNode;if(f){delete f.onclick;}this._super(g);},shouldShowCustomizeContextMenu:function(){return !this.boxContent.isEditing;},updateOverlay:function S(){Z.call(this);var f=this.boxContent;this.toggleDragHandleVisibility(f.hasActiveLink()&&f.text);}});mstrmojo.vi.ui.rw.TextBox.boxConfiguration={f:{h:150,v:42},o:"v"};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.VisUtility");var A=mstrmojo.VisUtility,B=mstrmojo.hash;mstrmojo.heatmap.vi.VisHeatmapUtility=mstrmojo.provide("mstrmojo.heatmap.vi.VisHeatmapUtility",{setStepperEnabled:function(C,G,E){var F=["max","min"],D=["lt","gt"];F.forEach(function(J,H){var I=G.every(function(L){var K=D[H],M=A.getPropertyByPath(E,[L,J].join("."),K);return M===K;});C.getControl(H+1).set("enabled",I);});},getStepper:function(F,C){var E=new mstrmojo.Button(mstrmojo.Button.newIconButton(mstrmojo.desc(13607,"Increase Font Size"),"single-operator-plus",function(){F(1);},undefined,{slot:"col1Node"})),D=new mstrmojo.Button(mstrmojo.Button.newIconButton(mstrmojo.desc(13608,"Decrease Font Size"),"single-operator-minus",function(){F(-1);},undefined,{slot:"col2Node"}));C=B.copy(C,{col1Width:"50%",col2Width:"50%",children:[E,D]});return new mstrmojo.ui.editors.controls.TwoColumnContainer(C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.vi.viz","VisualizationTransition","EnumDSSDropZones","NetworkVisualizationHelper");var T=mstrmojo,H=T.array,S=T.vi.viz,K=T.VisUtility,A=S.KnownVisualizations,O=T.chart.model.enums,M=O.EnumDSSObjectType,B=M.DssTypeMetric,E=["#CC2525","#E34B4B","#E97D7D","#79D479","#57BA57","#2CA02C"],J=[0.1,0.3,0.5,0.7,0.9];function F(W,Y,V){var X=[];H.forEach(W,function(Z){H.forEach(Y,function(a){if((Z.id===a.did)||(Z.did===a.did)){if((V&&(a.t===B))||(!V&&(a.t!==B))){X.push(a);return false;}}});});return X;}function D(W,V){var X=[];H.forEach(W,function(Y){var Z=false;H.forEach(V,function(a){if(Y.id===a.id){Z=true;return false;}});if(!Z){X.push(Y);}});return X;}function G(V,W){if(V&&V.ColorBy&&V.ColorBy.TemplateMetric){return F(V.ColorBy.TemplateMetric,W,true);}return[];}function L(V,W){if(V&&V.SizeBy&&V.SizeBy.TemplateMetric){return F(V.SizeBy.TemplateMetric,W,true);}return[];}function R(V){return(V&&V.TemplateUnit)||[];}function N(V){return(V&&V.TemplateMetric)||[];}function U(V,Y,a){var Z=[],W=0,X;H.forEach(V,function(b){if(W===a){X=Z.length;}W++;if(b instanceof Array){Z=Z.concat(b);}else{if(Y==="attribute"){Z=Z.concat(R(b));}else{Z=Z.concat(N(b));}}});if(Y==="attribute"){return Z;}return{metrics:Z,idx:X};}function I(X,a){var Z=X.data,b=Z.gsi,e=Z.dz,d,V=(b.rows||[]).concat(b.cols||[]);switch(Z.visName){case"GraphMatrixVisualizationStyle":var c=R(e.ColorBy),Y=D(R(e.SliceBy),c),W=D(R(e.BreakBy),c);d=U([Y,e.Rows,e.YAxis,e.Columns,e.XAxis,c,W],"attribute");break;case"VIHeatMapVisualizationStyle":d=U([e.Grp,e.ColorBy],"attribute");break;case"ESRIMapVisualizationStyle":case"GoogleMapVisualizationStyle":d=U([e.Geo,e.Lat,e.Long,e.AdditionalMetrics],"attribute");break;}if(d&&d.length>0){d=F.call(this,d,V,false);}else{d=V;}H.forEach(d,function(f){if(f.t!==M.DssTypeMetric&&f.t!==M.DssTypeDimension&&f.did!=="-1"){a.fromItemAttribute=f;return false;}});H.forEach(d,function(f){if(f.t!==M.DssTypeMetric&&f.t!==M.DssTypeDimension&&f.did!=="-1"&&f.did!==a.fromItemAttribute.did){a.toItemAttribute=f;return false;}});}function C(X,c,Z,V){var a=X.data,g=a.dz,f=a.gsi.mx||[],e,b,Y;f.forEach(function(h){h.t=4;});var d=G.call(this,g,f);if(d.length>0){c.edgeColorMetric=d[0];d=d.slice(1);}var W=L.call(this,g,f);switch(a.visName){case"GraphMatrixVisualizationStyle":b=U([g.AngleBy,g.Rows,g.YAxis,g.Columns,g.XAxis,d,W,g.AdditionalMetrics],"metric",6);break;case"VIHeatMapVisualizationStyle":b=U([g.Grp,W,d,g.AdditionalMetrics],"metric",1);break;case"ESRIMapVisualizationStyle":case"GoogleMapVisualizationStyle":b=U([d,W,g.AdditionalMetrics],"metric",1);break;default:e=f;break;}if(b){Y=b.idx;e=b.metrics;}if(e&&e.length>0){e=F.call(this,e,f,true);}else{if(!g||!g.ColorBy){e=f;}}if(!c.edgeColorMetric&&e&&e[0]){c.edgeColorMetric=e[0];e=e.slice(1);Y--;}if(W.length>0){c.nodeSizeMetric=W[0];if(Y>=0){e=e.slice(0,Y).concat(e.slice(Y+1));}}if(!e&&a.visName&&A.getDefinition(a.visName).id===A.UNKNOWN){c.edgeColorMetric=null;c.nodeSizeMetric=null;c.edgeSizeMetric=null;e=f;}e.forEach(function(h){if(!c.nodeSizeMetric){c.nodeSizeMetric=h;}else{if(!c.edgeSizeMetric){c.edgeSizeMetric=h;}}});if(c.edgeColorMetric){this.addThresholds(X,c.edgeColorMetric,V,E,J);}}function Q(Y,a,W,Z){var V=new S.NetworkVisualizationHelper({node:Y});I.call(this,Y,V);C.call(this,Y,V,W,Z);var X=V.getAddDropZonesAction();X.actions=W.concat(X.actions).concat(Z);if(X.actions.length){a.push(X);}return{wp:V.getXml(),handled:false};}mstrmojo.vi.viz.NetworkVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.NetworkVisualizationTransition",transitionDropZones:function P(a,e){var X=this.vis,Z=X.node,b=Z.data,f=b.visName||"Grid",Y=[],V=[],d,W,c=K.getPropertyByPath(X,"node.data.gsi.thresholds");this.clearImageThreshold(c,V);if(A.getDefinition(f).id!==A.NETWORK){return Q.call(this,X.node,a,Y,V);}return{wp:"",handled:false};}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales");mstrmojo.requiresCls("mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresCls("mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.chart.common","DSSDateTime","ScalePlate");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphDataTextShowType","EnumDSSGraphObject");var g=mstrmojo.chart,c=g.model,q=mstrmojo.VisUtility,Q=g.enums,E=Q.EnumFontStyle,S=c.enums,AB=S.EnumDSSGraphProperty,X=S.EnumDSSGraphDataTextShowType,AC=S.EnumDSSGraphObject;var F=mstrmojo.gm.EnumDataLabels;var V=[["xAxLbFntClr","yAxLbFntClr","dlFntClr","lgdFntClr"],["xAxLbFntFml","yAxLbFntFml","dlFntFml","lgdFntFml"],["xAxLbFntSz","yAxLbFntSz","dlFntSz","lgdFntSz"],["xAxLbFntStyle","yAxLbFntStyle","dlFntStyle","lgdFntFml"]];var r=[["majorGridLnThk","minerGridLnThk","majorGridLnThk","minerGridLnThk"],["majorGridLnClr","minerGridLnClr","majorGridLnClr","minerGridLnClr"],["majorGridLnStyle","minerGridLnStyle","majorGridLnStyle","minerGridLnStyle"]];var Y=[["bgFillClr"],["bgFillStyle"],["bgFillTrans"]];function U(AL){switch(AL){case AB.DssGraphFontColor:return 0;case AB.DssGraphFontName:return 1;case AB.DssGraphFontSize:return 2;case AB.DssGraphFontStyle:return 3;case AB.DssGraphFontSize100:return 4;default:return -1;}}function w(AL){switch(AL){case AB.DssGraphAreaColor:return 0;case AB.DssGraphFillEffect:return 1;case AB.DssGraphAreaAlpha:return 2;}return -1;}function z(AL){var AM;switch(AL){case AC.DssGraphX1Body:case AC.DssGraphX1Label:case AC.DssGraphX1Major:case AC.DssGraphX1Minor:case AC.DssGraphUserLabel3:case AC.DssGraphUserLine3:AM="X1";break;case AC.DssGraphX2Body:case AC.DssGraphX2Label:case AC.DssGraphX2Major:case AC.DssGraphX2Minor:case AC.DssGraphUserLabel4:case AC.DssGraphUserLine4:AM="X2";break;case AC.DssGraphY1Body:case AC.DssGraphY1Label:case AC.DssGraphY1Major:case AC.DssGraphY1Minor:case AC.DssGraphUserLabel1:case AC.DssGraphUserLine1:AM="Y1";break;case AC.DssGraphY2Body:case AC.DssGraphY2Label:case AC.DssGraphY2Major:case AC.DssGraphY2Minor:case AC.DssGraphUserLabel2:case AC.DssGraphUserLine2:AM="Y2";break;case AC.DssGraphZBody:AM="Z";break;case AC.DssGraphO1Body:case AC.DssGraph2DO1Label:case AC.DssGraphO1Major:case AC.DssGraphO1Minor:AM="O1";break;case AC.DssGraphO2Body:case AC.DssGraph2DO2Label:case AC.DssGraphO2Major:case AC.DssGraphO2Minor:AM="O2";break;default:AM="No_Axis";break;}return AM;}function d(AL,AM){if(!!AL===false){return undefined;}return undefined;}function W(AQ,AL){if(!!AQ===false){return undefined;}var AV,AT,AS=AL.isVertical!==undefined?AL.isVertical:true,AN=AL.isGridChart||false,AW=AL.isPieShape||false,AR={Name:0,Value:0},AO=AQ.gaid,AP=AQ.goid,AM=AQ.gsid,AU=AQ.v;if(!!AO===false){return undefined;}switch(AO){case AB.DssGraphShowLBLFeeler:if(AW){AR.Name="DataLabel";if((AU&X.DssGraphDataTextValue)!==0){AR.Value=F.SHOW_VALUE_ONLY;}else{if((AU&X.DssGraphDataTextLabel)!==0){AR.Value=F.SHOW_TEXT_ONLY;}else{AR.Value=F.HIDE;}}}break;case AB.DssGraphAreaColor:case AB.DssGraphFillEffect:case AB.DssGraphAreaAlpha:AT=w.call(this,AO);if(AT<0){return undefined;}if(AP===AC.DssGraphBackground){AR.Name=Y[AT][0];if(AR.Name.search("Trans")!==-1){AR.Value=AU/255*100;}else{AR.Value=AU;}}break;case AB.DssGraphShowLegendText:AR.Name="LegendVisibleness";AR.Value=AU===0?false:true;break;case AB.DssGraphSDShowDataText:AR.Name="ShowSeriesDataLabel";AR.Value=AU!==0;break;case AB.DssGraphShowDataText:if(AW===false){AR.Name="DataLabel";AR.Value=F.HIDE;if(AU&X.DssGraphDataTextValue){AR.Value=F.SHOW_VALUE_ONLY;}else{if(AU&X.DssGraphDataTextLabel){AR.Value=F.SHOW_TEXT_ONLY;}}}break;case AB.DssGraphFontColor:case AB.DssGraphFontName:case AB.DssGraphFontSize100:case AB.DssGraphFontSize:case AB.DssGraphFontStyle:AR.Value=AU;AV=z.call(this,AP);AT=U.call(this,AO);if(AT<0){return undefined;}if(AT===4){AT=3;AR.Value/=100;}if(AV==="No_Axis"){if(AP===AC.DssGraphDataText){if(AW){return undefined;}AR.Name=V[AT][2];}else{if(AP===AC.DssGraphPieFeelerLabel||AP===AC.DssGraphPieFeelerLabel){if(AW===false){return undefined;}AR.Name=V[AT][2];}else{if(AP===AC.DssGraphLegendText){AR.Name=V[AT][3];}else{return undefined;}}}}else{if(AV[0]==="X"){AR.Name=V[AT][0];}else{if(AV[0]==="Y"){AR.Name=V[AT][1];}else{if(AV[0]==="O"){AR.Name=AS?V[AT][0]:V[AT][1];}else{return undefined;}}}}break;}return AR;}var T,k=String.fromCharCode,AF=mstrmojo.locales.datetime,AK=0,L=document.getElementById("measureText"),B={},h={};var o=0.03,K=0,R=0,H=0.2;function p(AM){var AL,AN=[],AO;for(AL=0;AL<=AM;AL++){AO=AL.toString(16);if(AO.length===1){AO="0"+AO;}AN[AL]=AO;}T=AN;return AN;}function AI(AL){var AM=parseFloat(AL);if(isNaN(AM)===false&&AM!==undefined&&AM!==null){return AM;}return 0;}function D(AL){AL=AL.replace(/ddd/g,"EEE");AL=AL.replace(/AM\/PM/g,"a");AL=AL.replace(/tt/g,"a");AL=AL.replace(/:'/g,":");AL=AL.replace(/'\/'/g,"/");AL=AL.replace(/\\/g,"");var AM,AO=true,AN=AL.length;for(AM=0;AM<AN;AM++){if(AL[AM]==="h"||AL[AM]==="H"||AL[AM]===":"){AO=true;}else{if(AL[AM]===" "&&AO){AO=true;}}if(AL[AM]==="m"&&AO){AL=AL.substring(0,AM)+"M"+AL.substring(AM+1);}}return AL;}mstrmojo.chart.common.Utility=mstrmojo.provide("mstrmojo.chart.common.Utility",{point2D:{},rect2D:{},tripleId:{create:function M(AM,AQ,AO,AN,AP){if(AM===null||AM===undefined){AM=-3;}if(AQ===null||AQ===undefined){AQ=-3;}if(AO===null||AO===undefined){AO=-3;}var AL={mObjectId:AM,mSeriesId:AQ,mGroupId:AO};if(AN!==undefined&&AN!==null){AL.angleByIndex=AN;}if(AP!==undefined&&AP!==null){AL.sliceById=AP;}return AL;},walks:function m(AP,AN){if(!!AP===false||!!AN===false){return null;}if(AP.length===1){return AN[AP[0]];}var AO=(AP&&AP.length)||0,AM,AL=AP[AM];for(AM=0;AM<AO;AM++){if(AN[AL]===undefined){AN[AL]={};}AN=AN[AL];}return AN;},equal:function a(AL,AM){return(AL.mObjectId===AM.mObjectId&&AL.mSeriesId===AM.mSeriesId&&AL.mGroupId===AM.mGroupId);},reset:function t(AN,AP,AO,AM,AL,AQ){AN.mObjectId=AP!==undefined?AP:-3;AN.mSeriesId=AO!==undefined?AO:-3;AN.mGroupId=AM!==undefined?AM:-3;if(AL!==undefined&&AL!==null){AN.angleByIndex=AL;}if(AQ!==undefined&&AQ!==null){AN.sliceById=AQ;}return AN;}},transformProperty:function A(AL,AN,AM){if(AN===0){return W.call(this,AL,AM);}return d.call(this,AL,AM);},abbreviateNumber:function b(AV,AL){var AW,AM,AX="",AO=(AV<0),AY=(this.isIntegar(AV)===false);if(AY){AL++;}if(AV<0){AL++;}var AR=AO?-AV:AV;var AS=0;if(AR>=1e+27){AR=999;AX="Y";}else{if(AR>=1e+24){AR/=1e+24;AX="Y";}else{if(AR>=1e+21){AR/=1e+21;AX="Z";}else{if(AR>=1000000000000000000){AR/=1000000000000000000;AX="E";}else{if(AR>=1000000000000000){AR/=1000000000000000;AX="P";}else{if(AR>=1000000000000){AR/=1000000000000;AX="T";}else{if(AR>=1000000000){AR/=1000000000;AX="B";}else{if(AR>=1000000){AR/=1000000;AX="M";}else{if(AR>=1000){AR/=1000;AX="K";}else{if(AR>=1){AS++;}else{if(AR>=0.001){AS++;}else{if(AR>=0.000001){AS++;}else{if(AR>=1e-9){AS++;}else{if(AR>=1e-12){AS++;}else{AO=false;}}}}}}}}}}}}}}if(this.isIntegar(AR)===false){AW=AR.toString();var AN=5,AQ=2,AZ;AM=AW.indexOf(".");AZ=AW.length-AM-1;if(AZ>AN||(AZ>AQ&&AZ>AM)){if(AZ>AN&&AL-AZ<0){AQ=Math.max(AQ,Math.min(AQ,AL-AZ));}else{AQ=Math.max(1,Math.min(AQ,AL-AZ));}AR=AR.toFixed(AQ);}}AW=AR.toString();if(this.isIntegar(AR)===false){var AU=AW.length-1;AM=AW.indexOf(".");if(AM!==-1){if(AM>=AU){AW=AW.substring(0,AM);}else{var AT,AP=true;for(AT=AU;AT>AM&&AP;--AT){if(AW[AT]!=="0"){AP=false;}}if(AP){AW=AW.substring(0,AM);}}}}if(AO){AW="-"+AW;}AW+=AX;return AW;},getScalePlate:function AH(AL){AL=AL||false;this.mScalePlate=mstrmojo.chart.common.ScalePlate;if(AL){this.mScalePlate.clear();}return this.mScalePlate;},prepareScalePlateOptions:function AE(AN,AM,AO){var AL={mUseLogarithmicScale:AN,mAlwaysIncludeZero:!AN&&(AM||!!(AO&1)||!!(AO&2)),mShowMinLabel:true,mShowMaxLabel:true,mDrawCustomLine:false,mAxisMinValue:0,mAxisMaxValue:0,mAxisCustomValue:0,mUseCustomMinMax:false};return AL;},evaluateTextMargin:function P(AL){this.mTextMargins=this.mTextMargins||{};var AM=this.mTextMargins;if(AM[AL]){return AM[AL];}var AN=[];AN[0]=Math.floor(AL*o+0.5);AN[1]=Math.floor(AL*K+0.5);AN[2]=Math.max(Math.floor(AL*R+0.5),1);AM[AL]=AN;return AN;},AlmostZero:function AA(AL){return(Math.abs(AL)<0.000001);},isValidNumber:function J(AL){if(typeof AL==="number"){if(AL===0){return true;}return !!AL;}return false;},isIntegar:function l(AL){return AL===+AL&&AL===(AL|0);},HasArrayIntersection:function O(AM,AL){var AN;for(AN=0;AN<AM.length;AN++){if(AL.indexOf(AM[AN])!==-1){return true;}}return false;},EscapeString:function C(AL){var AN='"',AM='\\"',AO=new RegExp(AN,"g");return String(AL).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"\\\\").replace(AO,AM).replace(/\r\n/g,"<br/>").replace(/\r/g,"<br/>").replace(/\n/g,"<br/>");},EscapeStringForJSON:function N(AL){var AN='"',AM='\\"',AO=new RegExp(AN,"g");return String(AL).replace(/\\/g,"\\\\").replace(AO,AM).replace(/\r/g,"\\r").replace(/\n/g,"\\n");},TrimLastComma:function AG(AM){var AL;if(!AM.buf||AM.len===-1){return ;}AL=AM.len;var AN=String(AM.buf[AL]);if(AN&&AN[AN.length-1]===","){AM.buf[AL]=AN.slice(0,-1);}},decodeUTF8:function f(AL){var AM="",AO=0,AQ=0,AP=0,AN=0;while(AO<AL.length){AQ=AL.charCodeAt(AO);if(AQ<128){AM+=k(AQ);AO++;}else{if((AQ>191)&&(AQ<224)){AP=AL.charCodeAt(AO+1);AM+=k(((AQ&31)<<6)|(AP&63));AO+=2;}else{AP=AL.charCodeAt(AO+1);AN=AL.charCodeAt(AO+2);AM+=k(((AQ&15)<<12)|((AP&63)<<6)|(AN&63));AO+=3;}}}return AM;},formatDateTimeValue:function e(AM,AR){var AP=new mstrmojo.chart.common.DSSDateTime({ifTime:AR});var AL="";var AO="";var AS=0;while(AS<AM.length){var AN=1;switch(AM.charAt(AS)){case"[":AS++;while(AS<AM.length&&AM.charAt(AS)!=="]"){AO+=AM.charAt(AS);AS++;}if(AO.length>0&&(AO[0]===">"||AO[0]==="<"||AO[0]==="=")){AO="";}AS++;break;case"y":AS++;while(AS<AM.length&&AM.charAt(AS)==="y"){AN++;AS++;if(AN===4){break;}}if(AN===1||AN===2){AL+=this.fillZeroToWidth(AP.mnYear%100,2);}else{if(AN===3){AL+=this.fillZeroToWidth(AP.mnYear%100,2);AS--;}else{if(AN===4){AL+=AP.mnYear;}}}break;case"M":AS++;while(AS<AM.length&&AM.charAt(AS)==="M"){AN++;AS++;}if(AN<3){AL+=this.fillZeroToWidth(AP.mnMonth,AN);}else{if(AN===3){AL+=AF.MONTHNAME_SHORT[AP.mnMonth];}else{AL+=AF.MONTHNAME_FULL[AP.mnMonth];}}break;case"d":AS++;while(AS<AM.length&&AM.charAt(AS)==="d"){AN++;AS++;}if(AN<3){AL+=this.fillZeroToWidth(AP.mnDay,AN);}else{if(AN===3){AL+=AF.dayShortNames[AP.mnDay];}else{AL+=AF.dayNames[AP.mnDay];}}break;case"h":AS++;while(AS<AM.length&&AM.charAt(AS)==="h"){AN++;AS++;}var AQ=AP.mnHour;if(AQ===0){AQ=12;}if(AQ>12){AQ-=12;}AL+=this.fillZeroToWidth(AQ,AN);break;case"H":AS++;while(AS<AM.length&&AM.charAt(AS)==="H"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnHour,AN);break;case"m":AS++;while(AS<AM.length&&AM.charAt(AS)==="m"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnMinute,AN);break;case"s":AS++;while(AS<AM.length&&AM.charAt(AS)==="s"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnSecond,AN);break;case"S":AS++;while(AS<AM.length&&AM.charAt(AS)==="S"){AN++;AS++;}AL+=this.fillZeroToWidth(AP.mnMillisecond,AN);break;case"a":AQ=AP.mnHour;if(AQ<12){AL+=AF.AM_NAME;}else{AL+=AF.PM_NAME;}AS++;break;default:AL+=AM.charAt(AS++);break;}}if(AO.length!==0){AL='<SPAN STYLE="COLOR: '+AO+'" >'+AL+"</SPAN>";}return AL;},fillZeroToWidth:function n(AP,AN){var AM="",AO=AM+AP;var AL=AO.length;while(AL<AN){AO="0"+AO;AL++;}return AO;},updateCache:function AJ(AM,AP,AQ){var AO=(AP&&AP.length)||0,AN,AL,AR=AM;for(AN=0;AN<AO-1;AN++){AL=AP[AN];if(!AR[AL]){AR[AL]={};}AR=AR[AL];}AR[AP[AO-1]]=AQ;},measureTextHeight:function(AQ,AN,AU,AR,AL){var AT,AP=AQ;if(AP===" "){AP="\u00A0";}AL=AL||"pt";if(typeof AU==="number"){AU=AU+AL;}var AM="none",AS="normal";if(AR&E.FS_ITALIC){AM="italic";}if(AR&E.FS_BOLD){AS="bold";}var AO={fontFamily:AN,fontSize:AU,fontStyle:AM,fontWeight:AS};if(h&&h.H&&h.H[AN]&&h.H[AN][AU]&&h.H[AN][AU][AR]){AT=h.H[AN][AU][AR];}else{AT=q.measureTextHeight("H",AO,1);this.updateCache(h,["H",AN,AU,AR],AT);}return AT;},measureText:function x(AS,AP,AY,AT,AN){var AM=true,AL,AW=AY+1;var AR=AS;if(AR===" "){AR="\u00A0";}AN=AN||"pt";if(typeof AY==="number"){AY=AY+AN;}if(B&&B[AR]&&B[AR][AP]&&B[AR][AP][AY]&&B[AR][AP][AY][AT]){return B[AR][AP][AY][AT];}if(AM){var AO="normal",AU="normal";if(AT&E.FS_ITALIC){AO="italic";}if(AT&E.FS_BOLD){AU="bold";}var AQ={fontFamily:AP,fontSize:AY,fontStyle:AO,fontWeight:AU};if(h&&h.H&&h.H[AP]&&h.H[AP][AY]&&h.H[AP][AY][AT]){AW=h.H[AP][AY][AT];}else{AW=q.measureTextHeight("H",AQ,true);this.updateCache(h,["H",AP,AY,AT],AW);}AL=q.measureTextWidth(AS,AQ,0);}else{if(!L){var AV=document.createElement("div");AV.id="measureText";AV.style.position="absolute";AV.style.top="0";AV.style.visibility="hidden";AV.style.height="auto";AV.style.width="auto";document.body.appendChild(AV);L=AV;}L.innerHTML="";L.appendChild(document.createTextNode(AR));L.style.fontFamily=AP;L.style.fontSize=AY;L.style.fontWeight="normal";L.style.fontStyle="none";if(AT&E.FS_ITALIC){L.style.fontStyle="italic";}if(AT&E.FS_BOLD){L.style.fontWeight="bold";}AL=L.scrollWidth+1;AW=L.scrollHeight+1;}var AX={Width:AL,Height:AW};this.updateCache(B,[AR,AP,AY,AT],AX);return AX;},ReplaceDecimalPoint:function AD(AM,AL){return AM.replace(".",AL);},ReplaceMinusSign:function v(AL,AM){return AL.replace("-",AM);},insert:function G(AM,AL,AN){if(typeof AM==="string"&&typeof AL==="string"&&AN<=AM.length){return AM.substr(0,AN)+AL+AM.substr(AN);}return AM;},InsertThousandSeparator:function u(AN,AO,AS){var AL=AS.mstrDecimalPoint;var AM=AN.indexOf(AL);if(AM===-1){AM=AN.length;}var AP=0;while(AP<AM&&!this.chk_val(AN.charAt(AP))){AP++;}var AR=AN;var AQ;for(AQ=AM-3;AQ>AP;AQ-=3){AR=this.insert(AR,AO,AQ);}return AR;},chk_val:function I(AL){return/^\d+$/.test(AL);},hFormatValue:function Z(AY,AP,Aj,A8){var AW=0;var Ar=0;var Af=AY.length;var BG=false;if(!A8){A8={};var Ap=window.navigator.userLanguage||window.navigator.language;var BR=Ap.split("-");this.mstrLanguageCode=BR[0];this.mstrCountryCode=BR[1]||BR[0];A8.mstrThousandSeparator=mstrmojo.locales.number.THOUSANDSEPARATOR||",";A8.mstrCurrencySymbol="$";A8.mstrDecimalPoint=mstrmojo.locales.number.DECIMALSEPARATOR||".";A8.mstrPercentSign="%";A8.mstrMinusSign="-";}while(AW<Af){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}}else{if(AY.charAt(AW)==="["){AW++;var Aq="";while(AW<Af&&AY.charAt(AW)!=="]"){Aq+=AY.charAt(AW);AW++;}if(Aq.length>1&&(Aq.charAt(0)===">"||Aq.charAt(0)==="<"||Aq.charAt(0)==="=")){var AM=-1;var BA=0;switch(Aq.charAt(0)){case">":if(Aq.charAt(1)>="0"&&Aq.charAt(1)<="9"){AM=1;BA=1;}else{if(Aq.charAt(1)==="="&&Aq.length>2&&Aq.charAt(2)>="0"&&Aq.charAt(2)<="9"){AM=2;BA=2;}}break;case"=":if(Aq.charAt(1)>="0"&&Aq.charAt(1)<="9"){AM=3;BA=1;}else{if(Aq.charAt(1)==="="&&Aq.length>2&&Aq.charAt(2)>="0"&&Aq.charAt(2)<="9"){AM=3;BA=2;}}break;case"<":if(Aq.charAt(1)>="0"&&Aq.charAt(1)<="9"){AM=5;BA=1;}else{if(Aq.charAt(1)==="="&&Aq.length>2&&Aq.charAt(2)>="0"&&Aq.charAt(2)<="9"){AM=4;BA=2;}}break;}if(AM>0){var Aa=Aq.substr(BA);var BJ=parseFloat(Aa);if((AM===1&&AP>BJ)||(AM===2&&AP>=BJ)||(AM===3&&AP===BJ)||(AM===4&&AP<=BJ)||(AM===5&&AP<BJ)){BG=true;}}}}else{if(AY.charAt(AW)===";"){if(BG){Af=AW;break;}else{Ar=AW+1;AW++;}}else{AW++;}}}}if(!BG){Ar=0;}AW=Ar;var Aw=false;while(AW<Af){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}}else{if(AY.charAt(AW)==="["){AW++;while(AW<Af&&AY.charAt(AW)!=="]"){AW++;}}else{if(AY.charAt(AW)==="y"||AY.charAt(AW)==="M"||AY.charAt(AW)==="d"||AY.charAt(AW)==="h"||AY.charAt(AW)==="H"||AY.charAt(AW)==="m"||AY.charAt(AW)==="s"||AY.charAt(AW)==="S"){Aw=true;break;}else{AW++;}}}}if(Aw){var BE="";if(BG){BE=AY.substr(Ar,Af-Ar);}else{BE=AY;}return mstrmojo.num.formatByMask(BE,AP);}var BI;var An;var At=false;var AS=false;var BD=false;var Ae=false;var BO=[];var Ai="K";var Ab=0;var A9=false;var AZ=0;var BP="";var AT="";var Am="";var A7="";var AX=0;var BL=0;var BK=false;var BB=A8.mstrCurrencySymbol;var A2=A8.mstrThousandSeparator;var Ay=A8.mstrDecimalPoint;var BC=A8.mstrPercentSign;var A6=A8.mstrMinusSign;AW=Ar;var Al="";if(AP<0&&!BG){while(AW<Af&&AY.charAt(AW)!==";"){if(AY.charAt(AW)==='"'){AW++;while(AW<Af&&AY.charAt(AW)!=='"'){AW++;}}AW++;}AW++;if(AW>=Af){if(AP<0){BP+="-";}AW=Ar;}}var BQ=false;while(AW<Af){var As=false;switch(AY.charAt(AW)){case"[":AW++;while(AW<Af&&AY.charAt(AW)!=="]"){Am+=AY.charAt(AW);AW++;}if(Am.length>0&&(Am.charAt(0)===">"||Am.charAt(0)==="<"||Am.charAt(0)==="=")){Am="";}AW++;break;case'"':AW++;while(AW<Af&&AY.charAt(AW)!=='"'){if(AY.charAt(AW)==="K"){BD=true;Ai="K";}else{if(BQ){AT+=AY.charAt(AW);}else{BP+=AY.charAt(AW);}}AW++;}AW++;break;case"#":case"0":var Ad=AY.charAt(AW);BQ=true;var Ah=1;AW++;while(AW<Af&&AY.charAt(AW)===Ad){Ah++;AW++;}if(AW+1<Af&&AY.charAt(AW)==="-"&&AY.charAt(AW+1)===Ad){Ae=true;BO.push(Ah);AW++;while(true){Ah=0;while(AW<Af&&AY.charAt(AW)===Ad){Ah++;AW++;}BO.push(Ah);if(AW>=Af||AY.charAt(AW)!=="-"){break;}AW++;}}while(AW<Af){if(AY.charAt(AW)===","){if(AW+1<Af&&AY.charAt(AW+1)===Ad){At=true;}else{break;}}else{if(AY.charAt(AW)!==Ad){break;}}AW++;}break;case".":BQ=true;AW++;Ab=0;while(AW<Af&&AY.charAt(AW)==="0"){Ab++;AW++;}if(Ab===0){while(AW<Af&&AY.charAt(AW)==="#"){Ab++;AW++;}}break;case"E":BL=6;while(AW<Af&&AY.charAt(AW)!=="0"){if(AY.charAt(AW)==="+"&&AW<Af&&AY.charAt(AW+1)==="0"){AS=true;}else{A7+=AY.charAt(AW);}AW++;}AX=0;while(AW<Af&&AY.charAt(AW)==="0"){AX++;AW++;}break;case"%":BL=4;AW++;break;case"(":AW++;BP+="(";break;case")":AW++;AT+=")";break;case"-":AW++;if(AP<0){BP+=A6;}break;case"?":AW++;break;case"/":if(AW>Ar&&AY.charAt(AW-1)==="?"&&AW+1<Af&&AY.charAt(AW+1)==="?"){BL=5;A9=false;An=AW-1;while(An>Ar&&AY.charAt(An)==="?"){An--;}while(An>Ar&&AY.charAt(An)===" "){An--;}if(An>=Ar&&(AY.charAt(An)==="#"||AY.charAt(An)==="0")){A9=true;}AZ=0;AW++;while(AW<Af&&AY.charAt(AW)==="?"){AZ++;AW++;}}else{AW++;}break;case",":if(AW>Ar&&(AY.charAt(AW-1)==="0"||AY.charAt(AW-1)==="#")){if(AW+1<Af&&(AY.charAt(AW+1)==="K"||AY.charAt(AW+1)==="k")){BD=true;Ai=AY.charAt(AW+1);AW++;}}An=AW+1;while(An<Af){if(AY.charAt(An)===","){An++;continue;}else{break;}}if(An===Af||AY.charAt(An)==="."){BK=true;}if(BK||(!BK&&AW+1<Af&&AY.charAt(AW+1)===",")){while(AW<Af&&AY.charAt(AW)===","){AP/=1000;AW++;}AW--;}AW++;break;case";":As=true;break;case"$":if(BQ){AT+=BB;}else{BP+=BB;}AW++;break;default:if(BQ){AT+=AY.charAt(AW);}else{BP+=AY.charAt(AW);}AW++;}if(As){break;}}if(AP<0){AP=-AP;}var A0="";if(Ae){var Av=0;for(BI=0;BI<BO.length;BI++){Av+=BO[BI];}A0=Al=this.fillZeroToWidth(Av,AP.toFixed());for(BI=0;BI<BO.length-1;BI++){Av-=BO[BI];var Au=A0.length-Av;A0=A0.slice(0,Au)+"-"+A0.slice(Au);}}else{switch(BL){case 0:if(BD){AP/=1000;}var A4=AP;if(A4<0){A4=-A4;}var AL=0;while(A4>=10){A4/=10;AL++;}if(AL>=15){A0=Al=this.fillZeroToWidth((AP<0?-AP:AP),10);var Ao=A0.indexOf(".");if(Ao!==-1){A0=A0.slice(0,Ao)+A0.slice(Ao+1);}A0=A0.substr(0,16);if(A0.charAt(15)>="5"){var AV=14;while(AV>=0&&A0.charAt(AV)==="9"){A0=A0.slice(0,AV)+"0"+A0.slice(AV+1);AV--;}var AQ=A0.charAt(AV);AQ++;if(AV>=0){A0=A0.slice(0,AV)+AQ+A0.slice(AV+1);}else{A0="1"+A0;}}A0=A0.substr(0,15);var BH;for(BH=AL-14;BH>0;BH--){A0+="0";}if(AP<0){A0=A6+A0;}}else{Al+=(AP+Math.pow(0.1,Ab+6)).toFixed(Ab);A0=Al;A0=this.ReplaceDecimalPoint(A0,Ay);if(AP<0){A0=this.ReplaceMinusSign(A0,A6);}}if(At){A0=this.InsertThousandSeparator(A0,A2,A8);}if(BD){A0+=Ai;}break;case 5:if(BD){AP/=1000;}var Ak=10;for(BI=1;BI<AZ;BI++){Ak*=10;}var AN={numerator:0,denominator:1};var AU={numerator:1,denominator:1};var AR={numerator:1,denominator:2};var Az={numerator:0,denominator:1};var Ag=AP>=0;var A5=Math.abs(AP);var A3=parseInt(A5,10);A5-=A3;while(AR.denominator<Ak){if(Math.abs(AI.call(AR)-A5)<1e-15){Az=AR;break;}if(AI.call(AR)>A5){AU=AR;}else{AN=AR;}AR.denominator=AN.denominator+AU.denominator;AR.numerator=AN.numerator+AU.numerator;}if(AR.denominator>=Ak){if(A5-AI.call(AN)<AI.call(AU)-A5){Az=AN;}else{Az=AU;}}if(A3>0){Az.numerator+=A3*Az.denominator;}if(Az.denominator===0){A9=false;}var BF=false;var A1=false;var BN=Az.numerator;if(A9){A3=Math.floor(Az.numerator/Az.denominator);BN=Az.numerator%Az.denominator;A1=A1||(BN!==0);if(A3>0){BF=true;Al+=A3;if(A1){Al+=" ";}}}if(!A1&&!BF&&BN===0){Al+="0";}else{if(!A1&&BF&&BN===0){AK++;}else{Al+=BN;Al+="/";Al+=Az.denominator;}}A0=Al;if(!Ag){A0=A6+A0;}if(At){A0=this.InsertThousandSeparator(A0,A2,A8);}if(BD){A0+=Ai;}break;case 4:AP*=100;Al+=(AP+Math.pow(0.1,Ab+6)).toFixed(Ab);A0=Al;A0=this.ReplaceDecimalPoint(A0,Ay);if(AP<0){A0=this.ReplaceMinusSign(A0,A6);}if(At){A0=this.InsertThousandSeparator(A0,A2,A8);}A0+=BC;break;case 6:var Ax=AP;var BM=0;if(Ax>1){while(Ax>=10){Ax/=10;BM++;}}else{if(Ax!==0){while(Ax<1){Ax*=10;BM--;}}}Al+=(Ax+Math.pow(0.1,Ab+6)).toFixed(Ab);Al+=A7;if(AS&&BM>=0){Al<<"+";}if(BM<0){Al<<"-";BM=-BM;}Al+=this.fillZeroToWidth(BM,AX);A0=Al;A0=this.ReplaceDecimalPoint(A0,Ay);if(AP<0){A0=this.ReplaceMinusSign(A0,A6);}break;}}var AO=BP+A0+AT;var Ac=false;if(Am.length!==0&&Ac){AO='<SPAN STYLE="COLOR: '+Am+'" >'+AO+"</SPAN>";}return AO;}});}());(function(){mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSObjectType","EnumDSSAxisName");mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.vi.viz","KnownVisualizations","EnumVisualizationTemplates","VisualizationTransition","HeatMapVisualizationHelper","NetworkVisualizationHelper","ImageLayoutHelper","ESRIMapHelper","GoogleMapHelper");var Y=mstrmojo,M=Y.hash,I=Y.array,X=Y.vi.viz,B=X.KnownVisualizations,E=X.EnumVisualizationTemplates,Q=Y.chart.model.enums,O=Q.EnumDSSObjectType,F=Q.EnumDSSAxisName,J="Grid",K=Y.VisUtility,V=[0.1,0.3,0.5,0.7,0.9],H=["#CC2525","#E34B4B","#E97D7D","#79D479","#57BA57","#2CA02C"];function C(a){var d=M.copy(a.data.gsi),b=d.tma===1?"rows":"cols",Z=d[b],c=d.mx;d[b]=Z.filter(function(e){return e.t!==-1&&e.did!=="-1";});if(c){c.forEach(function(e){e.t=4;});}return d;}function A(Z){return Z.did==="-1"||Z.t===4;}function U(c,b,e,Z,d){var a=b.getAddDropZonesAction();if(b.colorBy.length>0){var f=b.colorBy[0];if(A(f)){this.addThresholds(c,f,d,H,V);}}a.actions=Z.concat(a.actions).concat(d);if(a.actions.length){e.push(a);}return b.getXml();}function W(d,a,g){var c,Z,e=g.rows,b=g.cols;for(c=0,Z=e.length;c<Z;c++){var f=e[c];if(A(f)){a.push({act:"pivot",axis:F.DssAxisColumns,unitPos:b.length});}else{if(f.t!==O.DssTypeMetric&&!A(f)){d.groupingObjects.push(f);}}}}function L(d,e){var c,Z,b=e.cols;for(c=0,Z=b.length;c<Z;c++){var a=b[c];if(a.t!==O.DssTypeMetric&&!A(a)){d.groupingObjects.push(a);}}}function T(d,c,Z){var b=[],f=new X.HeatMapVisualizationHelper({node:c}),e,h=C(c);W(f,b,h);L(f,h);var g=h.mx,a=g.length;if(a>0){f.sizeByMetric=g[0];if(a>1){f.colorBy.push(g[1]);}else{f.colorBy.push(g[0]);}for(e=2;e<a;e++){if((g[e].did!==f.sizeByMetric.did)&&(g[e].did!==f.colorBy[0].did)){f.tooltipMetrics.push(g[e]);}}}return U.call(this,c,f,d,b,Z);}function S(e,d){var b,a,c=e.mx;if(c.length>0){for(b=0,a=c.length;b<a;b++){var Z=c[b];if(d.colorBy.length===0){d.colorBy.push(Z);}else{if(!d.sizeByMetric){d.sizeByMetric=Z;}else{if((Z.did!==d.sizeByMetric.did)&&(Z.did!==d.colorBy[0].did)&&Z.t===O.DssTypeMetric){d.tooltipMetrics.push(Z);}}}}}}function N(e,d,Z){var b=[],f=new X.HeatMapVisualizationHelper({node:d}),g=new X.NetworkVisualizationHelper({node:d}),h=C(d);g.setData(d.data.dz);var c=f.groupingObjects;if(g.fromItemAttribute){c.push(g.fromItemAttribute);}if(g.toItemAttribute){c.push(g.toItemAttribute);}var a=g.edgeColorMetric;if(a){f.colorBy.push(a);}if(g.nodeSizeMetric){f.sizeByMetric=g.nodeSizeMetric;}else{if(g.edgeSizeMetric){f.sizeByMetric=g.edgeSizeMetric;}}S.call(this,h,f);return U.call(this,d,f,e,b,Z);}function P(e,b,c){var Z=[],a=new X.HeatMapVisualizationHelper({node:b}),f=new X.GraphMatrixHelper({node:b}),d=C(b);d.mx=this.filterGMTrainingMetric(b.data.dz,d.mx);f.setData(b.data.dz);W(a,Z,d);L(a,d);I.forEach(f.sizeByObjects,function(g){if(a.isMetric(g)){a.sizeByMetric=g;return false;}});I.forEach(f.colorByObjects,function(g){a.colorBy.push(g);if(a.isMetric(g)){return false;}});S.call(this,d,a);return U.call(this,b,a,e,Z,c);}function G(g,d,e){var Z=[],b=new X.HeatMapVisualizationHelper({node:d}),c=new X.ImageLayoutHelper({node:d}),f=C(d);c.setData(d.data.dz);var a=f.mx;if(c.geoAttribute){b.groupingObjects.push(c.geoAttribute);}if(c.colorByMetric){b.colorBy.push(c.colorByMetric);}if(c.sizeByMetric){b.sizeByMetric=c.sizeByMetric;}S.call(this,f,b);return U.call(this,d,b,g,Z,e);}function D(g,d,l,a){var c,f,e=(l===E.ESRIMAP)?X.ESRIMapHelper:X.GoogleMapHelper,h=new X.HeatMapVisualizationHelper({node:d}),b=[];c=new e({data:d.data});c.setWidget(this.vis);f=c.getGeoUnit();if(f){h.groupingObjects.push(f);}var m=c.getColorByUnit(),Z=c.getSizeByUnit(),k=c.getTooltipUnits();f=m||Z||k.pop();if(f){h.colorBy.push(f);}m=(m&&m.t===O.DssTypeMetric)?m:undefined;f=Z||m||k.pop();if(f){h.sizeByMetric=f;}S.call(this,{mx:k},h);return U.call(this,d,h,g,b,a);}mstrmojo.vi.viz.HeatMapVisualizationTransition=mstrmojo.declare(mstrmojo.vi.viz.VisualizationTransition,null,{scriptClass:"mstrmojo.vi.viz.HeatMapVisualizationTransition",transitionDropZones:function R(d,h){var g="";var b=this.vis,f=b.node.data,l=f.visName?f.visName:J,c=B.getDefinition(l).id,k,a,Z=[],e=K.getPropertyByPath(b,"node.data.gsi.thresholds");this.clearImageThreshold(e,Z);switch(c){case B.GRAPHMATRIX:g=P.call(this,d,b.node,Z);break;case B.GOOGLEMAP:g=D.call(this,d,b.node,c,Z);break;case B.ESRIMAP:g=D.call(this,d,b.node,c,Z);break;case B.IMAGELAYOUT:g=G.call(this,d,b.node,Z);break;case B.NETWORK:g=N.call(this,d,b.node,Z);break;case B.HEATMAP:break;default:g=T.call(this,d,b.node,Z);break;}return{wp:g,handled:false};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.DynamicClassFactory","mstrmojo.ListDocSelector","mstrmojo.TextBoxDocSelector","mstrmojo.SearchBoxDocSelector","mstrmojo.MetricQualDocSelector","mstrmojo.MetricSliderDocSelector","mstrmojo.AttrQualDocSelector","mstrmojo._DocActionSelector","mstrmojo._IsThresholdConditionTarget");var C={"default":"ListDocSelector",7:"MetricSliderDocSelector",8:"MetricQualDocSelector",9:"SearchBoxDocSelector",10:"TextBoxDocSelector",11:"AttrQualDocSelector"};mstrmojo.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocSelectorViewFactory",getDocSelectorClass:function A(F,G,E,H){var D=C[G.defn.style]||C["default"];if(G.defn.ct==="4"){return(mstrmojo.DynamicClassFactory.newComponent(mstrmojo[D],[mstrmojo._DocActionSelector,mstrmojo._IsThresholdConditionTarget],{scriptClass:"mstrmojo.DocActionXSelector"}));}return mstrmojo[D];},newDocSelector:function B(E,G,D,I){var H=this.getDocSelectorClass(E,G,D,I),F={id:G.id,node:G,model:E};return new H(F);}});mstrmojo.DocSelectorViewFactory.CLASS_MAP=C;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.models.EnumDragSources","mstrmojo._HasLayout","mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.vi.ui.DatasetUnitMenuUtils");var L=mstrmojo.array,K=mstrmojo.dom,B=mstrmojo.func,F=mstrmojo.hash,J=mstrmojo.vi.ui.DatasetUnitMenuUtils,D="tbl",P="dmaList";function I(X,V,Q){var R=this,T=this.setting&&this.setting.table&&this.setting.table(V.did);return({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:V.n,tableId:V.did,dataset:X,tabelsWidget:this,ignoreLayout:false,showTitleBarContextMenu:true,level:R.level+1,getLayoutOffsets:function(){return{h:0,w:0};},setting:T,isCollapsed:T?!!(T.getCollapsed()):false,onclick:function(Y){if(K.contains(this.titleBar.leftToolNode,Y.getTarget(),true,this.domNode)){R.onTableCollapsedChange(this.tableId,this.isCollapsed);}},updateToolbar:function U(Y){Y.hostId=this.id;Y.isHostedWithin=false;Y.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.ctxt.titleBar.editTitle();},this);return Y;},postCreate:function S(){var Y=this;R.attachEventListener("toggleAllCollapsed",this.id,function(Z){if(Z.isRecover){Y.togglePortlet(Y.setting?Y.setting.getCollapsed():Y.defaultCollapsed?Y.defaultCollapsed:false);}else{if(Z.changeSetting){Y.setting.isCollapsed=Z.isCollapsed;}Y.togglePortlet(Z.isCollapsed);}});},getTitleBarCfg:function W(){var Y=this.constructor.prototype.getTitleBarCfg.call(this),Z=this;return F.copy({editTitleOnDoubleClick:true,titleEdited:function b(d,f,c){if(f){var e=function(){Z.titleBar.set("title",c);},g=function(){var h=Z.parent.parent.docModel;h.warnForEditStandaloneDS(X.set,function(){h.renameEmmaSrcTable(V.did,X.id,d.trim(),B.wrapMethods(h.getDatasetsUpdateCallback()),{failure:function(k){mstrApp.onerror(k);Z.titleBar.set("title",c);}});},e);};J.validateName(d,g,e);}},updateTooltipConfig:function a(d){var e=d.target||K.eventTarget(d.hWin,d.e);if(e.scrollWidth<=e.clientWidth){this.richTooltip=null;}else{var c=K.position(this.domNode);this.richTooltip={content:this.getTooltipContent(d),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:c.y-2,left:c.x+c.w+6};}}},Y);},children:[{alias:"tulist",scriptClass:this.unitListScriptClass,draggable:false,panelId:this.panelId,docModel:this.docModel,bindings:{filterScope:"this.parent.tabelsWidget.filterScope",filterExpr:"this.parent.tabelsWidget.filterExpr",level:"this.parent.level + 1"},postCreate:function S(){this.doubleClickItem=B.composite([this.doubleClickItem,mstrmojo.all[this.panelId].doubleClickItemHandler]);},dataset:X,getAllItems:function(){return[].concat(V.att).concat(V.mx);},onitemsChange:function(){this.parent.set("visible",!!this.items.length);}}]});}function O(){var U=this.dataset,R=[];L.forEach(U.set.tables,function(X,W){R.push(I.call(this,U,X,W));},this);var T=this.tbl;var V=[].concat(T.children||[]);T.removeChildren();V.forEach(function(W){W.destroy();});T.addChildren(R);T.children.forEach(function(W){W.doLayout();});if(!this[P]){this.addChildren({alias:P,scriptClass:this.unitListScriptClass,draggable:false,dataset:U,docModel:this.docModel,panelId:this.panelId,bindings:{filterScope:"this.parent.filterScope",filterExpr:"this.parent.filterExpr",level:"this.parent.level + 1"},postCreate:function S(){this.doubleClickItem=B.composite([this.doubleClickItem,mstrmojo.all[this.panelId].doubleClickItemHandler]);},getAllItems:function Q(){return[].concat(U.set.att).concat(U.set.mx).filter(function(W){return J.isDocumentLevelItem(W);});}});}}mstrmojo.vi.ui.DatasetTables=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{layoutConfig:{w:{containerNode:"100%"},xt:true}});mstrmojo.vi.ui.DatasetTableView=mstrmojo.declare(mstrmojo.Box,[mstrmojo.vi.ui._HasUnitListAvatar,mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.DatasetTableView",layoutConfig:{w:{containerNode:"100%"},xt:true},markupMethods:{ondatasetChange:function A(){O.call(this);},onfilterExprChange:function(){var Q=false;Q=this[D].children.some(function(R){return !!R.tulist.items.length;})||!!(this[P].items&&this[P].items.length);this.emptyIndicator.set("visible",!Q);}},draggable:true,avatarCssClass:"mstrmojo-VIUnitList",dataset:null,unitListScriptClass:"",docModel:null,panelId:"",setting:{},onTableCollapsedChange:mstrmojo.emptyFn,children:[{alias:"emptyIndicator",cssClass:"emptyIndicator",scriptClass:"mstrmojo.Label",bindings:{text:function(){if(!this.visible){return"";}return this.parent.filterExpr?mstrmojo.desc(11904,"No matched object"):mstrmojo.desc(11905,"No object");}}},{alias:D,scriptClass:"mstrmojo.vi.ui.DatasetTables"}],getTableWidgets:function H(){return this[D].children||[];},toggleAllNodesCollapsed:function G(Q,S,R){this.raiseEvent({name:"toggleAllCollapsed",isCollapsed:Q,changeSetting:S,isRecover:R});},getSelectedItems:function C(){var Q=this[P];return this[D].children.reduce(function(R,S){L.forEach(S.tulist.getSelectedItems(),function(T){if(L.find(R,"did",T.did)<0){R.push(T);}});return R;},[]).concat(Q.getSelectedItems());},clearSelect:function(){this[D].children.forEach(function(Q){Q.tulist.clearSelect();});this[P].clearSelect();},isDragValid:function M(Q){return !isNaN(parseInt(Q.src.node.getAttribute("idx"),10))||this._super(Q)||false;},ondragstart:function E(S){var T=null,R=this[P],Q=function(U){return K.contains(U.domNode,S.src.node,true,U.domNode);};L.forEach(this[D].children,function(V){var U=V.tulist;if(Q(U)){T=U;return false;}});if(!T&&Q(R)){T=R;}if(T){T.selectDragNode(S);}this._super(S);},getDragData:function N(Q){var R=this._super(Q);R.item=R.items&&R.items[0];R.dsid=this.dataset.id;R.src=mstrmojo.vi.models.EnumDragSources.DATASETS;return R;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.vi.models.EnumDragSources","mstrmojo._HasMarkup","mstrmojo._HasLayout","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.vi.ui.DatasetUnitMenuUtils");var T=mstrmojo.hash,G=mstrmojo.dom,Y=mstrmojo.func,H=mstrmojo.vi.ui.DatasetUnitMenuUtils,X=mstrmojo._HasMarkup.addMarkupMethods,O="dimensions",U="metricFolder",M="folders",J="metrics",Q="levels",L="derivedObjects",c="multiLevelHierarchies",a="singleLevelHierarchies",F="recursiveAttributes",P="_emptyIndicator";function C(n,g){var l=T.copy(g,{scriptClass:n.unitListScriptClass,treeContext:n,docModel:n.docModel,panelId:n.datasetsPanelId,_isUnitList:true,draggable:false,postCreate:function k(){this.doubleClickItem=Y.composite([this.doubleClickItem,n.doubleClickItemHandler]);},onallItemsChange:function h(){this.reloadItems();},getAllItems:function f(){return this.allItems||[];},isEmpty:function m(){return !(this.items&&this.items.length);}});l.bindings=T.copy(g.bindings,{dataset:function(){var o=this.treeContext.dataset;return o&&{id:o.did,set:o};},filterScope:"this.treeContext.filterScope",filterExpr:"this.treeContext.filterExpr",filterFunc:"this.treeContext.filterFunc",level:"this.parent.level + 1"});return l;}function Z(g,f){return T.copy(f,{scriptClass:"mstrmojo.vi.ui.MDXTreeNodeList",treeContext:g});}function A(g,f){return T.copy(f,{treeContext:g});}mstrmojo.vi.ui._IsMDXTreeComponent=mstrmojo.provide("mstrmojo.vi.ui._IsMDXTreeComponent",{treeContext:null,data:null,setting:null,isEmpty:function S(){return this.getRealChildren().every(function(f){return f.isEmpty();});},isRealChild:function D(f){return !f.ignoredChild;},getRealChildren:function I(){return(this.children||[]).filter(this.isRealChild,this);},getSelectedItems:function K(){return this.getRealChildren().reduce(function(f,g){return f.concat(g.getSelectedItems());},[]);},clearSelect:function e(){this.getRealChildren().forEach(function(f){f.clearSelect();});}});mstrmojo.vi.ui.MDXTreePortletNode=mstrmojo.declare(mstrmojo.vi.ui.PanelPortlet,[mstrmojo.vi.ui._IsMDXTreeComponent],{scriptClass:"mstrmojo.vi.ui.MDXTreePortletNode",ignoreLayout:false,getLayoutOffsets:function(){return{h:0,w:0};},handleDataChange:mstrmojo.emptyFn,init:function W(f){var g=this;this._super(f);this.treeContext.view.attachEventListener("toggleAllCollapsed",this.id,function(h){if(h.isRecover){g.togglePortlet(g.setting?g.setting.getCollapsed():g.defaultCollapsed?g.defaultCollapsed:false);}else{if(h.changeSetting){g.setting.isCollapsed=h.isCollapsed;}g.togglePortlet(h.isCollapsed);}});},isRealChild:function D(f){return f.alias!=="titleBar"&&this._super(f);},onCollapsedChange:function(){this.treeContext.view.onNodeCollapsedChange(this);}});X(mstrmojo.vi.ui.MDXTreePortletNode,{ondataChange:function V(){this.handleDataChange();}});mstrmojo.vi.ui.MDXTreeNodeList=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsMDXTreeComponent],{scriptClass:"mstrmojo.vi.ui.MDXTreeNodeList",treeContext:null,data:null,createChildConfig:null,layoutConfig:{w:{containerNode:"100%"},xt:true}});X(mstrmojo.vi.ui.MDXTreeNodeList,{ondataChange:function V(){this.destroyChildren();this.addChildren((this.data||[]).map(this.createChildConfig,this));}});mstrmojo.vi.ui.MDXDimension=mstrmojo.declare(mstrmojo.vi.ui.MDXTreePortletNode,null,{scriptClass:"mstrmojo.vi.ui.MDXDimension",handleDataChange:function N(){var g=this.data,f=[],h=[];if(g.recursiveAtt&&g.recursiveAtt.length>0){g.recursiveAtt.forEach(function(k){f.push(k);});}else{g.hierarchies.forEach(function(k){h.push(k);});}this[c].set("data",h);this[F].set("allItems",f);},init:function W(f){var g=this;this._super(f);this.addChildren([Z(this.treeContext,{alias:c,createChildConfig:function(k){var h=g.setting&&g.setting.hierarchy&&g.setting.hierarchy(k.did);return A(this.treeContext,{scriptClass:"mstrmojo.vi.ui.MDXHierarchy",title:k.n,data:k,setting:h,defaultCollapsed:true,isCollapsed:h?!!(h.getCollapsed()):true,level:g.level+1});}}),C(this.treeContext,{alias:F})]);}});mstrmojo.vi.ui.MDXHierarchy=mstrmojo.declare(mstrmojo.vi.ui.MDXTreePortletNode,null,{scriptClass:"mstrmojo.vi.ui.MDXHierarchy",init:function W(f){this._super(f);this.addChildren([C(this.treeContext,{alias:Q,bindings:{allItems:"this.parent.data.att"}})]);}});mstrmojo.vi.ui.MDXMetricFolder=mstrmojo.declare(mstrmojo.vi.ui.MDXTreePortletNode,null,{scriptClass:"mstrmojo.vi.ui.MDXMetricFolder",init:function W(f){var g=this;this._super(f);this.addChildren([Z(this.treeContext,{alias:M,bindings:{data:"this.parent.data && this.parent.data.folders"},createChildConfig:function(h){var k=g.setting&&g.setting.folder&&g.setting.folder(h.n);return A(this.treeContext,{scriptClass:"mstrmojo.vi.ui.MDXMetricFolder",title:h.n,data:h,setting:k,defaultCollapsed:true,isCollapsed:k?!!(k.getCollapsed()):true,level:g.level+1});}}),C(this.treeContext,{alias:J,bindings:{allItems:"this.parent.data.mx"}})]);}});function R(){var f=function(){if(this.isEmpty){var h=this.isEmpty();this.set("visible",!h);if(!h){var g=this.getRealChildren&&this.getRealChildren();if(g&&g.length){g.forEach(function(k){f.call(k);});}}}};this[P].set("visible",this.isEmpty());this.getRealChildren().forEach(function(g){f.call(g);});}mstrmojo.vi.ui.DatasetMDXView=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo.vi.ui._HasUnitListAvatar,mstrmojo.vi.ui._IsMDXTreeComponent],{scriptClass:"mstrmojo.vi.ui.DatasetMDXView",draggable:true,avatarCssClass:"mstrmojo-VIUnitList",data:null,unitListScriptClass:"",docModel:null,datasetsPanelId:"",layoutConfig:{w:{containerNode:"100%"},xt:true},onNodeCollapsedChange:mstrmojo.emptyFn,init:function W(g){this._super(g);var h=this;var k=this.treeContext=new mstrmojo.Model({view:this,docModel:this.docModel,datasetsPanelId:this.datasetsPanelId,unitListScriptClass:this.unitListScriptClass,bindings:{dataset:"this.view.data",table:"this.dataset && this.dataset.tables && this.dataset.tables[0]",filterExpr:"this.view.filterExpr",filterScope:"this.view.filterScope",filterFunc:"this.view.filterFunc"},doubleClickItemHandler:mstrmojo.all[this.datasetsPanelId].doubleClickItemHandler});var f=h.setting&&h.setting.rootMetricFolder;this.addChildren([Z(k,{alias:O,bindings:{data:"this.treeContext.table && this.treeContext.table.dimensions",visible:'this.treeContext.filterScope !== "mx"'},createChildConfig:function(m){var l=h.setting&&h.setting.dimension&&h.setting.dimension(m.did);return A(this.treeContext,{scriptClass:"mstrmojo.vi.ui.MDXDimension",data:m,title:m.n,setting:l,defaultCollapsed:true,isCollapsed:l?!!(l.getCollapsed()):true,level:h.level+1});}}),A(this.treeContext,{alias:U,scriptClass:"mstrmojo.vi.ui.MDXMetricFolder",bindings:{data:"this.treeContext.table && this.treeContext.table.metricFolder",visible:'this.treeContext.filterScope !== "att"'},title:mstrmojo.desc(14007,"Measures"),setting:f,isCollapsed:f?!!(f.getCollapsed()):false,level:h.level+1}),C(k,{alias:L,bindings:{allItems:function(){var l=this.treeContext.dataset;return l&&[].concat(l.att).concat(l.mx).filter(function(m){return H.isDocumentLevelItem(m);})||[];}}})]);},markupMethods:{onfilterExprChange:function(){if(this.hasRendered){R.call(this);}}},onRender:function(){this._super();R.call(this);},toggleAllNodesCollapsed:function d(f,h,g){this.raiseEvent({name:"toggleAllCollapsed",isCollapsed:f,changeSetting:h,isRecover:g});},children:[{alias:P,cssClass:"emptyIndicator",scriptClass:"mstrmojo.Label",ignoredChild:true,bindings:{text:function(){if(!this.visible){return"";}return this.parent.filterExpr?mstrmojo.desc(11904,"No matched object"):mstrmojo.desc(11905,"No object");}}}],isDragValid:function B(f){return !isNaN(parseInt(f.src.node.getAttribute("idx"),10))||this._super(f)||false;},ondragstart:function b(f){var h=f.src.node;var g=G.findWidget(h);while(g&&g!==this){if(g._isUnitList&&g.treeContext===this.treeContext){g.selectDragNode(f);break;}g=g.parent;}return this._super(f);},getDragData:function E(f){var g=this._super(f);g.item=g.items&&g.items[0];g.dsid=this.data.id||this.data.did;g.src=mstrmojo.vi.models.EnumDragSources.DATASETS;return g;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.UnitList","mstrmojo.vi.ui._HasUnitListAvatar","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.dom","mstrmojo.css","mstrmojo.string");mstrmojo.requiresDescs(629,6424);var I=mstrmojo.desc,F=mstrmojo.dom,J=mstrmojo.hash,B=mstrmojo.string,L="mnu",C="clsx",O="icn "+L+"_sub",M="icn "+C+"_sub",R;function Q(S,U,T){return function(){U.style.overflow=S?"visible":"hidden";if(T){T();}};}mstrmojo.vi.ui.InteractiveUnitList=mstrmojo.declare(mstrmojo.vi.ui.UnitList,[mstrmojo.vi.ui._HasUnitListAvatar,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:true,panelId:"",useRichTooltip:true,hasTooltipContent:function(T,U){var S=this.getLabelNode(U);return S.scrollWidth>S.clientWidth;},getItemTooltip:function(W,Y,X){var U=this.getLabelNode(Y);if(this.hasTooltipContent(W,Y)){var T=F.position(U),V="<div>"+B.encodeHtmlString(W.n,true)+"</div>"+(W.dsc?"<div>"+B.encodeHtmlString(W.dsc,true)+"</div>":"");var S={areaId:W._renderIdx+"text",cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:V,top:T.y-6,left:T.x,enableHover:true};return S;}return null;},showTooltip:function D(S,V){var U=S.target||F.eventTarget(S.hWin,S.e),T=this.getItemFromTarget(U);if(T&&T.n){var W=this.getItemNodeFromTarget(U);this.richTooltip=this.getItemTooltip(T,W,U);if(this.richTooltip){this._super(S,V);}}},getItemMarkup:function E(S){if(!R){R=this._super(S).replace(">{@en@n}",'><span class="txt" unselectable="on">{@en@n}</span><div class="'+L+'"><div title="'+I(6424,"Menu")+'" class="'+O+'"></div></div><div class="'+C+'" title="'+I(629,"Delete")+'"><div class="'+M+'"></div></div>').replace("<{@tag}",'<{@tag} unselectable="on" ');}return R;},getLabelNode:function N(S){return S.getElementsByClassName("txt")[0];},ondblclick:function H(S){var U=S.getTarget(),T=(F.findWidget(U)===this)&&this.getItemFromTarget(U);if(!!T){S.cancel();this.doubleClickItem(T);}},onItemContextMenu:function P(V,T){var X=T.getTarget();if(V){this.closePopup();var S=mstrmojo.all[this.panelId],U=S&&S.getPanelSelectedItems&&S.getPanelSelectedItems(),W=U&&U.length>1;this[W?"showMultiSelectionMenu":"showItemMenu"](W?U:V,this.getItemNodeFromTarget(X),F.getMousePosition(T.e,T.hWin));return true;}},configurePopup:function K(S,W,V,U){mstrmojo.all[this.panelId].addPopupHandlers(S);var T=W.parentNode;S.addPopupHandlers("iulMenuOverflow",Q(true,T,V),Q(false,T,U));S.hostId=this.id;S.isHostedWithin=false;S.hostElement=W;},showItemMenu:mstrmojo.emptyFn,showMultiSelectionMenu:mstrmojo.emptyFn,deleteItem:mstrmojo.emptyFn,doubleClickItem:mstrmojo.emptyFn,isDragValid:function A(S){return !isNaN(parseInt(S.src.node.getAttribute("idx"),10))||this._super(S)||false;},getSelectedItems:function G(){var V=this,S=this.items,U=null,T=[];J.forEach(this.selectedIndices,function(X,W){U=S[W];if(X&&U){U=J.copy(U);U.ulist=V;U.itemNode=V._getItemNode(U._renderIdx);T.push(U);}});return T;}});mstrmojo.vi.ui.InteractiveUnitList.CLS_HAS_MENU="has-m";mstrmojo.vi.ui.InteractiveUnitList.CLS_HAS_X="has-x";}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.array","mstrmojo.vi.models.editors.ControlsViewFactory","mstrmojo.Label","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.ui.editors.MoreOptionsEditor");var E=mstrmojo.hash,A=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,I="mstrmojo-more-options-editor";mstrmojo.vi.models.editors.EditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.ControlsViewFactory,null,{scriptClass:"mstrmojo.vi.models.editors.EditorModel",hostId:"",help:"",getHost:function Q(){return mstrmojo.all[this.hostId];},docModel:null,getEditorContents:mstrmojo.emptyFn,getGroupTitle:function J(R){return new mstrmojo.Label({cssClass:"edt-title",text:R});},getShowTitleCheckbox:function C(){var R=this.getHost();return this.getCheckboxAndLabel(R.parent.getTitleBarVisibility(),mstrmojo.desc(13599,"Show titlebar"),function(S){R.parent.toggleTitleBar(!!S);});},getTextAlign:function L(T,U,S){var R=new mstrmojo.vi.ui.TextAlignButtonBar(!S?null:{itemsValueMap:S});R.singleSelect(mstrmojo.array.find(R.items,"id",T));R.onValueChange=U;return R;},getWrapText:function B(S,R){return this.getCheckboxAndLabel(S,mstrmojo.desc(13577,"Wrap text"),R);},getTextDirection:function K(S,T){var R=0;if(S){R=S===3?1:2;}return this.getLabelAndControl(mstrmojo.desc(11914,"Direction:"),this.getPulldown([{n:mstrmojo.desc(2066,"Horizontal"),v:0},{n:mstrmojo.desc(5155,"90 degrees"),v:90},{n:mstrmojo.desc(5156,"-90 degrees"),v:-90}],T,R));},getOverflow:function O(S,R){return this.getLabelAndControl(mstrmojo.desc(11915,"Overflow:"),this.getPulldown([{n:mstrmojo.desc(2974,"Clip"),v:false},{n:mstrmojo.desc(2976,"Scroll"),v:true}],R,S?1:0));},getChangeFormatPropertyFn:function H(R,S){var T=this.id;return function(W,U){var V=mstrmojo.all[T];V.docModel.changeUnitFormatProperty(V.getHost().parent,[{formatType:S||1,propertyName:R,newValue:W,oldValue:U}]);};},getChangeGroupPropertyFn:function P(R){var S=this.id;return function(T,V,U){(mstrmojo.all[S].getChangeFormatPropertyFn(T,R))(V,U);};},getCharacterGroup:function G(U,R,S){var V={onGroupValueChange:U};if(S){V.visibleControls=S;}var T=new mstrmojo.ui.editors.controls.CharacterGroup(V);T.setFormatSource(R);return T;},getContainerGroup:function F(R,U,S,T){var V=new mstrmojo.ui.editors.controls.ContainerGroup(E.copy(T,{onGroupValueChange:U||this.getChangeGroupPropertyFn(),visibleControls:S||(A.FILL_COLOR+A.BORDER)}));V.setFormatSource(R);return V;},getMoreOptionsEditorLink:function N(S,R,T){return new mstrmojo.Label({text:mstrmojo.desc(9126,"More options"),cssClass:"edt-link",onclick:function(){this.openMoreOptionsEditor(S,R,T);}.bind(this)});},openMoreOptionsEditor:function D(V,R,W){var T=this.getHost();var S=mstrmojo.all[I]||new mstrmojo.vi.ui.editors.MoreOptionsEditor({id:I,submitAction:function U(Z,X,d,Y){var a=this.host,b=a.controller,c=[];if(!E.isEmpty(Z)){d=mstrmojo.func.wrapMethods(b._getXtabCallback(a),d);c=[b.dataService().getUpdateTemplateAction(a.k,[a.model.getAdvancedPropertiesAction(Z)])];}c=c.concat(X||[]);if(!E.isEmpty(c)){b.submitUndoRedoUpdates(c,null,d,Y);}}});S.set("data",V);S.set("showHeadersSection",!!R);S.set("lockHeadersCase",W);S.set("host",T);S.open();},replaceChildControls:function M(T,S){var R=[].concat(T.children||[]);T.removeChildren();R.forEach(function(U){U.destroy();});T.addChildren(S);T.doLayout();}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.EditorModel","mstrmojo.ui.editors.CharacterToolbarPopup","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.ui.editors.controls.LinkGroup","mstrmojo.NumStepperContentProvider","mstrmojo.hash");var C=mstrmojo.models.FormatModel,E=C.ENUM_PROPERTY_NAMES;mstrmojo.vi.models.editors.TextEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.TextEditorModel",help:"dashboard_editor_text_properties.htm",getEditorContents:function D(){var H=this.getHost().getFormats(),G=this.getChangeGroupPropertyFn(),F=new mstrmojo.ui.editors.controls.CharacterGroup({onGroupValueChange:G,showNoFillInColor:false}),I=this,K=new mstrmojo.ui.editors.controls.ContainerGroup({showBackgroundNoFill:false,showBorderNoFill:false,onGroupValueChange:function(){I.getHost().parent.clearCache();G.apply(null,arguments);}}),J=new mstrmojo.ui.editors.controls.LinkGroup({docModel:this.docModel,hostId:this.hostId,hostType:3});if(!mstrApp.allowWebDashboardDesign()){return[];}F.setFormatSource(H);K.setFormatSource(H);return[this.getEditorGroup([F]),this.getEditorGroup([this.getTextAlign(H["text-align"]||"left",this.getChangeFormatPropertyFn(E.TEXT_ALIGN)),this.getWrapText(H["white-space"]!=="nowrap",this.getChangeFormatPropertyFn(E.TEXT_WRAP)),this.getTextDirection(H.fx&&H.fx.rt,this.getChangeFormatPropertyFn(E.TEXT_DIRECTION)),this.getOverflow(H.overflow==="auto",this.getChangeFormatPropertyFn(E.TEXT_OVERFLOW))]),this.getEditorGroup([K]),this.getEditorGroup([J])];},getChangeFormatPropertyFn:function B(F,G){var H=this.id;return function(N,K){var L=mstrmojo.all[H],M=L.getHost().parent,J=L.docModel,I=[{formatType:G||1,propertyName:F,newValue:N,oldValue:K}];J.saveUnitFormatProperty(M,I,{success:function(Q){if(!(M&&M.parent)){M=J.getSelectedViUnit();}var P=M.parent,R=M.k,O=M.boxContent;J.partialUpdate(null,J.getTargetDefn(R),Q.defn,[R]);O.update(O.node);M.refresh();P.selectVIUnit(M,true);}},mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);};},getFormattingToolbar:function A(F,I,G){var H=new mstrmojo.ui.editors.CharacterToolbarPopup(mstrmojo.hash.copy({onGroupValueChange:this.getChangeGroupPropertyFn(),anchorElement:I},G));H.setFormatSource(this.getHost().getFormats());return H;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.EditorModel","mstrmojo.models.FormatModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.ui.TextAlignButtonBar","mstrmojo.ui.editors.CharacterToolbarPopup","mstrmojo.array","mstrmojo.hash");var B=0,I=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,S=mstrmojo.models.FormatModel,H=S.ENUM_PROPERTY_NAMES.TEXT_ALIGN,K=mstrmojo.hash,T=B;function L(Z,U,W,a,X){var V=Z===this.getTitleFormatCode(),Y;if(W===H){Y=function(b){return this.titleAlignButtonBar.items.filter(function(c){return c.v===b;})[0].id;}.bind(this);}this.getHost().parent.changeUnitFormats(V,Z,U,W,a,X,Y,function(b){this.raiseEvent({name:"BEMFormatChange",propertyName:W,value:b,isTitle:V});}.bind(this));}function Q(V,W){var U=new mstrmojo.vi.ui.TextAlignButtonBar({includeJustify:false});this.titleAlignButtonBar=U;U.singleSelect(U.items.map(function(X){return X.id;}).indexOf(V));U.onValueChange=function(Y,X){W(H,Y,X);};return this.getLabelAndControl(mstrmojo.desc(13597,"Alignment:"),U);}function C(X){var W=this.getHost().getFormats(),b=W.ttl,V=[];if(b){var a=L.bind(this,this.getTitleFormatCode(),W),Z=this.getHost(),U=Z.parent.getTitleBarVisibility(),Y=[this.getCharacterGroup(a,b),this.getContainerGroup(b,a,I.FILL_COLOR,{showBackgroundNoFill:false}),Q.call(this,S.getFormatBlockValue(b,H),a)];Y.forEach(function(c){c.set("enabled",U);});V.push(this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(4756,"Title")),this.getCheckboxAndLabel(U,mstrmojo.desc(13599,"Show titlebar"),function(c){Z.parent.toggleTitleBar(!!c);})].concat(Y),{cssClass:"bem-tc-title",showDivider:false}));}V.push(this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(11917,"Container")),this.getContainerGroup(W,L.bind(this,1,W),this.getContainerCtrlFlags(),{showBackgroundNoFill:false,showBorderNoFill:false})],{cssClass:"bem-tc-container"}));this.replaceChildControls(X,V.concat(this.getTitleAndContainerControls()));}function D(U){var W=this.getTargetPulldownItems(U);var V=this.getPulldown(W,function(X){T=X;W[W.map(function(Y){return Y.v;}).indexOf(X)].h(X);});V.set("selectedIndex",Math.max(W.map(function(X){return X.v;}).indexOf(T),0));return V;}mstrmojo.vi.models.editors.BaseEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.BaseEditorModel",titleAlignButtonBar:null,init:function N(U){this._super(U);T=this.getInitialTarget();},selectTargetByValue:function M(U){if(U!==undefined){var V=this._targetPulldown;if(V){V.selectItemByField("v",U);}}},getInitialTarget:function R(){return B;},getEditorContents:function O(){var U=this.getEditorGroup([],{cssClass:"bem-dynamic-grp",showDivider:false,isNested:true,isContainer:true});var W=this._targetPulldown=D.call(this,U),V=[U].concat(this.getCommonControls());if(W.items.length>1){V.unshift(this.getEditorGroup([W]));}return V;},getFormattingToolbar:function F(V,a,W){if(V===B){var Z=this.getHost(),U=Z.getFormats(),Y=U.ttl;if(Y){Y=K.copy(Y);Y[H]=this.titleAlignButtonBar.items.filter(function(b){return b.id===Y["text-align"];})[0].v;var X=new mstrmojo.ui.editors.CharacterToolbarPopup(K.copy({onGroupValueChange:L.bind(this,this.getTitleFormatCode(),U),textAlignJustify:false,textAlignFmtName:H,anchorElement:a},W));X.setFormatSource(Y);return X;}}return null;},getCommonControls:function E(){return[];},getContainerCtrlFlags:function A(){return I.FILL_COLOR+I.BORDER;},getTitleAndContainerControls:function P(){return[];},getTargetPulldownItems:function G(V){var U=this.getHost().getFormats(),W=[];if(U&&(this.getHost().showTitleAndContainerFormats!==false)){W.push({n:mstrmojo.desc(12049,"Title and Container"),v:B,h:C.bind(this,V)});}return W;},getTitleFormatCode:function J(){return 2;}});mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE=B;}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.Button","mstrmojo.vi.models.editors.EditorModel","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.models.FormatModel","mstrmojo.ui.ScrollableTextArea");var E=mstrmojo.string,B=mstrmojo.models.FormatModel;var F="url",D="htmlText";var A=[{n:mstrmojo.desc(4555,"iFrame"),v:0,id:0},{n:mstrmojo.desc(4554,"Html Text"),v:1,id:1}];function G(H,I,N,J){var M=this.getHost(),L=M.parent,K=function(O){B.updateFormatBlock(H,I,O);if(!L.parent){L=this.getHost().parent;}L.clearSlotBackgroundCSS("domNode");L.applyCSSFormatToNode("domNode",H);L.selectVIUnit(true);};this.docModel.saveUnitFormatProperty(L,[{formatType:undefined,propertyName:I,newValue:N,oldValue:J}],{success:K.bind(this,N,J)},mstrmojo.DocDataService.SUPPRESS_DATA,{silent:true,undo:K.bind(this,J,N),redo:K.bind(this,N,J)});}mstrmojo.vi.models.editors.HtmlContainerEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.HtmlContainerEditorModel",help:"dashboard_editor_html_container_properties.htm",getEditorContents:function C(){if(!mstrApp.allowWebDashboardDesign()||(!mstrApp.isSingleTier&&!this.docModel.controller.rootCtrl.resolveFeature("create-html-container"))){return[];}var H=this.id,O=this.getHost(),J=O.node.data,N=O.parent,L=N.getHintText(),M=O.getFormats(),K=new mstrmojo.ui.editors.controls.ContainerGroup({showBackgroundNoFill:false,showBorderNoFill:false,onGroupValueChange:function(Q,S,R){G.call(mstrmojo.all[H],M,Q,S,R);}}),I=N.htmlType;K.setFormatSource(M);return[this.getEditorGroup([this.getButtonBar(A,I,function(R){var Q=R.v,S=this.parent.textArea;S.set("emptyText",L[Q]);S.value=N.defn[Q?D:F];S.refresh();},{alias:"typeBtn",showIcon:false,cssClass:"htmlTypeBtn"}),{scriptClass:"mstrmojo.ui.ScrollableTextArea",alias:"textArea",cssClass:"htmlText",value:E.decodeHtmlString(J.rv||J.v),emptyText:L[I],maxLength:undefined,keepEmpty:true,onfocus:function P(){N.setDefaultTextCaretPosition(this.inputNode,this.emptyText);if(this.inputNode.value===this.emptyText){this.scrollNode.scrollTop=35;}}},mstrmojo.Button.newWebButton(mstrmojo.desc(8708,"OK"),function(){var Q=this.parent;N.updateHtmlBox(Q.typeBtn.selectedItem.v,Q.textArea.value);N.hideControlOverlay();},true)]),this.getEditorGroup([K])];}});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.num","mstrmojo.Button","mstrmojo.TextBox","mstrmojo.Label","mstrmojo.models.FormatModel","mstrmojo.vi.ui.rw.DocImage","mstrmojo.ui.editors.controls.LinkGroup","mstrmojo.vi.models.editors.EditorModel","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.vi.ui.ImageEditorPanelImagePicker");mstrmojo.requiresDescs(12057,13580,12059,12060,14552);var J=mstrmojo.vi.ui.rw.DocImage.EnumSizeModes,T=J.FIXED,I=J.FIT_TO_CONTAINER,M=J.FILL_CONTAINER,E=J.STRETCH,F=mstrmojo.dom,S=mstrmojo.boxmodel.px2Inches,U=mstrmojo.models.FormatModel,L=U.ENUM_PROPERTY_NAMES,Q=mstrmojo.num;var N=[{n:mstrmojo.desc(12057,"Fixed to"),v:T},{n:mstrmojo.desc(13580,"Fit to container"),v:I},{n:mstrmojo.desc(12059,"Fill container"),v:M},{n:mstrmojo.desc(12060,"Stretch"),v:E}];function H(f,g){var k=f.model,h=k.getZoomProps(),d=[].concat(g),c=function(m,o){var n,l;for(n=0,l=d.length;n<l;n++){if(d[n].propertyName===m){return d[n][o];}}},Y=function(l){if(l!==undefined){l=typeof l==="number"?l:Q.parseNumeric(l);return(l*h.zf*h.dpi).toFixed();}return NaN;},Z=function(l){return{ih:Y(c("ih",l)),iw:Y(c("iw",l)),ism:c("ism",l),lock:c("lockAspectRatio",l)};},V=Z("oldValue"),W=Z("newValue"),e=f.parent,X=e.parent.k,b=e.k,a=function(o){var n=k.getCurrentLayoutKey(),m=k.getLayoutUnitDefn(b,n),l=k.getPanel(X,n);if(!m){return ;}if(o.ih!==undefined){m.ih=o.ih+"px";}if(o.iw!==undefined){m.iw=o.iw+"px";}if(o.ism!==undefined){m.ism=o.ism;}if(o.lock!==undefined){m.lock=o.lock;}l.selectVIUnit(l.rebuildChild(l.getUnitByKey(b)),true);};k.saveUnitFormatProperty(e,d,{success:a.bind(this,W)},mstrmojo.DocDataService.SUPPRESS_DATA,{undo:a.bind(this,V),redo:a.bind(this,W)});}function O(e,h){var f=e.model.getZoomProps(),b=e.getImageWidth(),c=e.getImageHeight(),X=function(k){if(typeof h[k]!=="undefined"&&isNaN(h[k])){h[k]=(k==="iw")?parseInt(b):parseInt(c);}};X("iw");X("ih");var Z=e.getCalculatedImageDimensions(h),d=Z.h,g=Z.w,Y=h.mode,a=[{formatType:1,propertyName:L.IMAGE_HEIGHT,newValue:S(f,d===undefined?c:d),oldValue:S(f,c)},{formatType:1,propertyName:L.IMAGE_WIDTH,newValue:S(f,g===undefined?b:g),oldValue:S(f,b)}];if(Y!==T){var V=e.defn.lock,W=Y!==E;if(W!==V){a=a.concat({formatType:1,propertyName:L.LOCK_ASPECT_RATIO,newValue:W,oldValue:V});}}return a;}function G(V){return O(V,{mode:J.ORIGINAL});}function B(W,V){return new mstrmojo.TextBox({value:W,valueChangeDelay:3000,onvalueChange:V,onkeydown:function(X){if(X.e.keyCode===13){this.blur();}}});}function K(){var V=this.getHost();var W=V.v;if(V.parent.isEmbedded){W=V.parent.embeddedImageName;}return B(W,function X(){var Y=this.value;if(Y!==W){V.parent.urlEdited(Y);}});}function R(){var W=this.getHost();var Y=W.v;if(W.parent.isEmbedded){Y=W.parent.embeddedImageName;}var V=new mstrmojo.vi.ui.ImageEditorPanelImagePicker();V.slot="col1Node";V.imageBox=W.parent;var a=mstrmojo.Button.newActionButton(mstrmojo.desc(1442,"OK"),function(){W.parent.urlEdited(Z.value);},{alias:"okBtn",slot:"col2Node",enabled:false});var X=new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:"50%",col2Width:"50%",children:[V,a]});var Z=new mstrmojo.TextBox({value:Y,hint:mstrmojo.desc(14552,"Enter an image URL or choose a file."),onvalueChange:function(){var c=this.value;var b=!mstrmojo.string.isEmpty(c)&&(c!==Y);X.okBtn.set("enabled",b);X.okBtn.set("iconClass",b?"hot":"");},onkeydown:function(b){if(b.e.keyCode===13){if(X.okBtn.enabled===true){X.okBtn.onclick();}else{this.blur();}}}});return this.getEditorGroup([Z,X]);}function A(){var W=this.getHost(),X=W.getSizeMode(),V=Math.max(N.map(function(Y){return Y.v;}).indexOf(X),0);return this.getLabelAndControl(mstrmojo.desc(9735,"Size:"),this.getPulldown(N,function(Z,Y){var a={mode:Z,lock:W.isAspectRatioLocked()};H(W,O(W,a).concat({formatType:1,propertyName:L.IMAGE_SIZE_MODE,newValue:Z,oldValue:Y}));},V));}function C(){var W=this.getHost(),X=function X(b,Z){var a={mode:W.getSizeMode(),lock:W.isAspectRatioLocked()};a[b]=parseFloat(Z);H(W,O(W,a));},V=this.getLabelAndControl("X:",B(W.getImageWidth(),function(Z){X(L.IMAGE_WIDTH,Z.value);}),"20%","70%"),Y=this.getLabelAndControl("Y:",B(W.getImageHeight(),function(Z){X(L.IMAGE_HEIGHT,Z.value);}),"30%","70%");V.slot="col1Node";Y.slot="col2Node";V.cssClass=Y.cssClass="dim-input";Y.cssClass+=" y";return new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:"50%",col2Width:"50%",children:[V,Y],visible:W.getSizeMode()===T});}function D(){var W=this.getHost(),Z=W.getSizeMode(),Y=Z===I||Z===M,V=Z===E,a=Y?true:(V?false:W.isAspectRatioLocked()),X=this.getCheckboxAndLabel(a,mstrmojo.desc(13639,"Lock aspect ratio"),function(c){var b=[{formatType:1,propertyName:L.LOCK_ASPECT_RATIO,newValue:c,oldValue:!c}];b=b.concat(O(W,{lock:c}));H(W,b);});X.enabled=!Y&&!V;return X;}mstrmojo.vi.models.editors.ImageEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.ImageEditorModel",help:"Dashboard_Editor_Image_Properties.htm",getChangeFormatPropertyFn:function(V,W){var X=this.id;return function(a,Y){var d=mstrmojo.all[X],c=d.docModel,h=d.getHost().parent,Z=h.parent,e=h.k,g="domNode",f=[{formatType:W||1,propertyName:V,newValue:a,oldValue:Y}],b=function(m){var l,k;c.partialUpdate(m.data,c.getTargetDefn(e),m.defn,[e]);l=Z.rebuildChild(Z.getUnitByKey(e));k=l.defn.fmts;Z.selectVIUnit(l,true);l.clearCache();l.clearSlotBackgroundCSS(g);l.applyCSSFormatToNode(g,k);};c.saveUnitFormatProperty(h,f,{success:b.bind(h)},mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);};},getEditorContents:function P(){var c=this.getHost(),Y=c.getFormats(),W=mstrmojo.Button.newWebButton(mstrmojo.desc(12061,"Restore to Original Size"),function(){H(c,c.getSizeMode()===T?G(c):G(c).concat({formatType:1,propertyName:L.IMAGE_SIZE_MODE,newValue:T,oldValue:c.getSizeMode()}));}),V=new mstrmojo.ui.editors.controls.LinkGroup({docModel:this.docModel,hostId:this.hostId,hostType:2}),d=this.getChangeGroupPropertyFn(),b=!!c.v||!!c.oid,Z={showDivider:false,enabled:b,shouldPropagateEnabled:true};if(!mstrApp.allowWebDashboardDesign()){return[];}var a=!!mstrApp.enableEmbeddedImages&&!F.isIE9;var X=a?[R.call(this)]:[this.getEditorGroup([K.call(this)])];return X.concat([this.getEditorGroup([A.call(this)],{showDivider:a,enabled:b,shouldPropagateEnabled:true}),this.getEditorGroup([C.call(this)],Z),this.getEditorGroup([D.call(this)],Z),this.getEditorGroup([W],Z),this.getEditorGroup([this.getContainerGroup(Y,function(){c.parent.clearCache();d.apply(null,arguments);},NaN,{showBackgroundNoFill:false,showBorderNoFill:false})]),this.getEditorGroup([V])]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.InteractiveUnitList","mstrmojo.vi.ui._IsDropTarget","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.vi.models.DropZonesModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo.array","mstrmojo.gm.GMEnums","mstrmojo.vi.viz.DropZoneHelper");var M=mstrmojo.dom,C=mstrmojo.css,O=mstrmojo.hash,g=mstrmojo.array,k=mstrmojo.vi.viz.EnumDSSDropZones,R=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,AA=R.ABOVE,z=R.ON,N=R.BELOW,AB=mstrmojo.vi.models.EnumDragSources,AE="is-mh",V="icon",A="zone",H="form",Q=mstrmojo.vi.viz.EnumDSSDropZones,q=Q.XAxis,T=Q.YAxis,b=Q.ColorBy,t="mstrmojo-VIVizEditor-Menu",K=mstrmojo.gm.DualAxisSubAxisBit,S=K.SECONDARY,Z=mstrmojo.vi.viz.DropZoneHelper.isMetricNames;var P={};P[AA]="Top";P[z]="";P[N]="Bottom";var f='<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}"><div class="outer-wrap"><div unselectable="on" class="inner-wrap"><span unselectable="on" class="txt">{@en@n}</span><div class="'+V+'"></div><div class="'+A+'"></div></div></div></{@tag}>';var c=[];function n(AG){var AF=function(AH){O.keyarray(P).forEach(function(AI){C.removeClass(AH,"dragIn"+P[AI]);});};c.forEach(AF);c=[];AF(AG);}function m(AI,AL,AG){var AK=AI.y,AF=AI.h*this.zonesModel.getTargetEdgePortion(AG),AH=M.getMousePosition(AL).y,AJ=z;if((AH>=AK)&&(AH<AK+AF)){AJ=AA;}else{if(AH>=AK+AI.h-AF){AJ=N;}}return AJ;}function a(AH,AF){if(!Z(AH)){var AG={zone:this.zonesSource,item:AH};if(this.zonesModel.hasReplaceCandidates(AG)){var AI=this.zonesModel.getReplaceSubMenu(AG,{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11703,"Replace with:"),cssClass:"mstrmojo-menu-replaceLabel"});AI.position=AF;AI.isHostedWithin=false;AI.hostId=this.id;this.openPopup(AI.newInstance());}}}function x(AI,AF){var AH=this.zonesSource.id;if(AH===k.Latitude||AH===k.Longitude){var AG={zone:this.zonesSource,item:AI};if(this.zonesModel.getSelectGeoFormMenu){var AJ=this.zonesModel.getSelectGeoFormMenu(AG);if(AJ){AJ.position=AF;AJ.isHostedWithin=false;AJ.hostId=this.id;this.openPopup(AJ.newInstance());}}}}function w(AH,AL,AG,AK){if(M.contains(this.itemsContainerNode,AK,true,this.domNode)){var AF=AG.tgtData.item,AI=(this.items||[]).length-1,AJ=m.call(this,AH,AL,AG);if(AF){AI=AF._renderIdx;}else{AJ=AI>=0?N:AA;}return{item:AG.getCtxtDragData().item,edge:AJ,idx:Math.max(AI,0)};}return null;}function AC(){mstrmojo.all[this.panelId].set("activeZoneId",this.id);}function G(){var AF=mstrmojo.all[this.panelId].activeZoneId;return !AF||(AF===this.id);}function v(AH,AF,AG){var AJ=new mstrmojo.ui.menus.MenuConfig({menuCssClass:t}),AI=this.getLabelNode(AH);AG.call(this,AJ,AI);if(AJ.hasMenuItems()){AJ.position=AF;AJ.isHostedWithin=false;AJ.hostId=this.id;this.openPopup(AJ.newInstance());}}mstrmojo.vi.ui.VisualizationEditorUnitList=mstrmojo.declare(mstrmojo.vi.ui.InteractiveUnitList,[mstrmojo.vi.ui._IsDropTarget],{scriptClass:"mstrmojo.vi.ui.VisualizationEditorUnitList",zonesModel:null,zonesSource:null,multiSelect:true,useListModKeys:true,useRichTooltip:true,getItemTooltip:function(AG,AI,AH){var AF=M.position(AH);if(AH===this.getIconNode(AI)&&!Z(AG)){return{areaId:AG._renderIdx+"icon",cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:mstrmojo.desc(11687,"Click to replace"),top:AF.y-8,left:AF.x-4};}else{if(AH===this.getZoneNode(AI)&&AG.geoWarning){return{areaId:AG._renderIdx+"zone",cssClass:"vi-regular vi-tooltip-A",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_TOPLEFT,content:mstrmojo.desc(14113,"Select an attribute form as geographic role"),top:AF.y+28,left:AF.x-4};}}return this._super(AG,AI,AH);},doItemSelect:function(AH,AG){var AF=AG.hWin,AI=AG.e;if(G.call(this)||(!M.shiftKey(AF,AI)&&!M.isMetaKey(AF,AI))){AC.call(this);this._super(AH,AG);}},isDragValid:function W(AF){var AG=AF.src.e;return !(!G.call(this)&&(AG.ctrlKey||AG.shiftKey||AG.metaKey))||this._super(AF)||false;},ondragstart:function r(AF){this.selectDragNode(AF);this._super(AF);},onItemContextMenu:function U(AO,AN){var AK=AN.e,AG=this.getItemNodeFromTarget(AN.getTarget()),AI=AN.hWin,AH=this.getSelectedItems().some(function(AP){return AP.itemNode===AG;});if(AO&&!AH){this.doItemSelect(AO,AN);}var AL=AN.getTarget(),AM=this.getSelectedItems();if(AM.length){this.closePopup();var AJ=AM&&AM.length>1,AF=AJ?"showMultiSelectionMenu":"showItemMenu";this[AF](AJ?AM:AO,this.getItemNodeFromTarget(AL),M.getMousePosition(AK,AI));return true;}},showItemMenu:function I(AH,AG,AF){v.call(this,AG,AF,function(AI,AJ){this.zonesModel.getUnitMenuItems(AI,this.zonesSource,AH,AJ);});},showMultiSelectionMenu:function X(AG,AH,AF){v.call(this,AH,AF,function(AI){this.zonesModel.getMultiUnitsMenuItems(AI,this.zonesSource,AG,null);});},deleteItem:function F(AF){this.zonesModel.deleteItem(this.zonesSource,AF._renderIdx);},deleteItems:function E(AF){this.zonesModel.deleteItems(this.zonesSource,AF);},getItemProps:function h(AH,AF){var AG=this._super(AH,AF);AG.n=AG.n||"&nbsp; ";if(AH.t===4&&Z(AH)){AG.addCls(AE);AG.n=mstrmojo.desc(11808,"Metric Names");}var AI=AH.zone;if(!this.zonesModel||this.zonesModel.shouldMetricNameShowIcon(AH,AH.zone)){if(AI!==undefined){AI="icz"+AI;if(AH.ax===S){AI+="s";}AG.addCls(AI);}}if(AH.hidden){AG.addCls("hidden");}if(AH.attn&&AH.fnm){AG.attn=AH.attn;AG.fnm=AH.fnm;}if(AH.geoWarning){AG.addCls(AH.geoWarning);}return AG;},getItemMarkup:function J(AF){if(AF&&AF.attn&&AF.fnm){return f.replace("{@en@n}",'{@en@attn}@<span unselectable="on" class="'+H+'">{@en@fnm}</span>');}return f;},getDragData:function l(AF){this.selectDragNode(AF);var AH=this._super(AF),AG=this;AH.itemIdx=AF.src.node.getAttribute("idx");AH.item=this.items[AH.itemIdx];if(AH.items===undefined){AH.items=[];}if(g.find(AH.items,"did",AH.item.did)===-1){AH.items.push(AH.item);}AH.src=AB.VIZ_EDITOR;AH.srcZoneId=this.zonesSource.id;AH.onRemove=function(AI){if(AI.length>1){AG.deleteItems(AI);}else{AG.deleteItem(AI);}};AH.allowDropOnTarget=function(AK,AJ){var AI=true;if(this.allowDropOnTarget){AI&=this.allowDropOnTarget(AJ,AK);}return AI;}.bind(AG.zonesModel,AH);return AH;},createAvatar:function Y(AH,AG){var AF=this._super(AH,AG);Array.prototype.slice.call((AF&&AF.childNodes)||[]).forEach(function(AI){C.removeClass(AI,mstrmojo.vi.ui.InteractiveUnitList.CLS_HAS_X);C.addClass(AI,mstrApp.rootCtrl.view.themeClassName);},this);return AF;},getIconNode:function AD(AG){var AF=AG.firstElementChild.firstElementChild.childNodes;return AF&&AF[1];},getZoneNode:function L(AG){var AF=AG.firstElementChild.firstElementChild.childNodes;return AF&&AF[2];},ondragover:function e(AI){var AU=this,AR=AI.tgt,AH=AU.getItemNodeFromTarget(AR.node)||AR.node,AJ=AI.tgtData,AL=AJ&&AJ.node,AK=AR.widget&&AR.widget.items;if(!AJ||AL!==AH){AJ=AI.tgtData={item:AU.zonesSource.items[parseInt(AH.getAttribute("idx"),10)],node:AH,pos:M.position(AH,true)};if(AL){n(AL);}}n(AH);var AG=w.call(this,AJ.pos,AR.e,AI,AH),AN=AG&&AG.edge,AM=this.getContextDragData(AI),AQ=this.zonesModel,AS=this.zonesSource,AT=AG&&O.copy(AG,AQ.getAllowDropInfo(AS,AM.items,AG.idx,AG.edge,AI));if(AT&&AT.allowedItems.length){var AV=this.itemsContainerNode,AO=Array.prototype.slice.apply(AV.childNodes);if(!AO.length||AO.every(function(AW){return(AW.className||"").indexOf("hidden")>-1;})){C.addClass(AV,"dragIn");this.raiseHLToggle(true);}else{AQ.getHighlightTargets(AS,AT).forEach(function(AX){var AW=AO[AX.idx];c.push(AW);C.addClass(AW,"dragIn"+P[AX.edge]);});this.raiseHLToggle(true);}if(AM.setAvatarClass){var AF=AM.src,AP="";if(AF===AB.DATASETS||AF===AB.ALL_OBJECT_LIST){AP=AN===z?"replace":"add";g.forEach(AK,function(AW){if(AW.zone===b){var AX=0,AY=0;g.forEach(AM.items,function(AZ){if(AQ.isMetric(AZ)){AX++;}else{if(AQ.isAttrCategory(AZ)){AY++;}}});if(!(AX&&AY)&&(AQ.differInType(AW,AM.item)||AQ.isMetric(AM.item))){AP="replace";}}if((AW.zone===q||AW.zone===T)&&AQ.differInType(AW,AM.item)){AP="replace";}});}else{if(AF===AB.VIZ_EDITOR||AF===AB.VIZ){AP=(AN===AA||AN===N||AR.node===AV)?"move":(AN===z?"replace":"");}}AM.setAvatarClass(AP);}}else{if(AM.setInvalidAvatarClass){AM.setInvalidAvatarClass();}}},getDropAvatarIcon:function B(AH){var AI=AH.getCtxtDragData(),AF=AI.src,AG=this.zonesSource.getDropIconCls(AI);if(AF===AB.DATASETS||AF===AB.ALL_OBJECT_LIST){AG="add";}return AG;},ondrop:function d(AG){this.ondragover(AG);var AN=AG.tgt,AK=AG.src&&AG.src.data,AH=AK&&AK.src,AF=w.call(this,AG.tgtData.pos,AN.e,AG,this.getItemNodeFromTarget(AN.node)||AN.node),AM=this.zonesModel,AO=this.zonesSource,AP=AF&&O.copy(AF,AM.getAllowDropInfo(AO,AG.getCtxtDragData().items,AF.idx,AF.edge,AG));if(AP&&AP.allowedItems.length){AM.getHost().model.addEditNodeForDatasetAction(AG,AM.getHost().k);var AI=function(){AM.unitsDropped(AO,AG,AP);};if(AH===AB.ALL_OBJECT_LIST){var AL=AG.src.widget,AJ=AL&&AL.dataProvider;if(AJ){AJ.loadObjects(AP.allowedItems,{success:AI},true);}}else{AI();}}this._super(AG);},allowDrop:function D(AG){var AH=AG.getCtxtDragData(),AF=AH.src;if(AF===AB.DATASETS||AF===AB.VIZ_EDITOR||AF===AB.ALL_OBJECT_LIST||AF===AB.VIZ){return this.zonesModel.isZoneDropAllowed(this.zonesSource,AH);}return false;},onclick:function o(AF){var AH=AF.target||M.eventTarget(AF.hWin,AF.e),AG=this.getItemFromTarget(AH);if(AG!==undefined){switch(AH.className){case V:M.preventDefault(window,AF.e);AH=AF.getTarget();AG=this.getItemFromTarget(AH);if(AG){AF.cancel();this.closePopup();a.call(this,AG,M.getMousePosition(AF.e,AF.hWin));}break;case A:case H:M.preventDefault(window,AF.e);AH=AF.getTarget();AG=this.getItemFromTarget(AH);if(AG&&(AG.geoWarning||(AG.attn&&AG.fnm))){AF.cancel();this.closePopup();x.call(this,AG,M.getMousePosition(AF.e,AF.hWin));break;}default:this._super(AF);}}},cleanUpAfterTarget:function p(AF){var AG=AF.tgtData;if(AG){n(AG.node);this.raiseHLToggle(false);}this._super(AF);},raiseHLToggle:function u(AG){var AF;this.parent.parent.parent.model.raiseEvent(O.copy({name:"viVizEditorDrag",isIn:AG,id:this.parent.parent.parent.viPanelType},AF));}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.InteractiveUnitList","mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.vi.models.EnumDragSources");mstrmojo.requiresDescs();var F=mstrmojo.array,G=mstrmojo.css,E=mstrmojo.dom,B=mstrmojo.hash,K=mstrmojo.string,N=16,A=9,L=13,D="\u001E";function C(){this._dsetId=this.dataset&&this.dataset.id||"";this.set("items",this.filterItems(this.getAllItems()).map(function(P){return B.copy(P);}));}mstrmojo.vi.ui.DatasetUnitList=mstrmojo.declare(mstrmojo.vi.ui.InteractiveUnitList,null,{scriptClass:"mstrmojo.vi.ui.DatasetUnitList",dataset:null,filterScope:"",filterExpr:"",filterFunc:null,level:null,dropZone:false,init:function O(P){this._super(P);C.call(this);},getItemMarkup:function J(P){return this._super(P).replace('<span class="txt" unselectable="on">{@en@n}</span>','<div class="icon" style="{@iconLeft}"></div><span class="txt" unselectable="on">{@en@n}</span>').replace("{@en@n}","{@matchHTML}");},getItemProps:function H(W,V){var S=this._super(W,V);if(W.mnu){S.addCls(mstrmojo.vi.ui.InteractiveUnitList.CLS_HAS_MENU);}S.dsc=W.dsc;var Q=this.filterExpr,U,X=S.n,R=mstrmojo.string.encodeHtmlString;if(Q){U=new RegExp(K.regEscape(Q),"ig");if(U.test(X)){X=X.replace(U,function(Y){return D+Y+D;});}var P=F.map((X||"").split(D),function(Z,Y){return(Y%2===0)?R(Z):("<em>"+R(Z)+"</em>");});S.matchHTML=P.join("");}else{S.matchHTML=R(X);}if(this.level!==null){var T=A+this.level*L;S.addStyle("padding-left: "+(T+N)+"px;");S.iconLeft=K.encodeHtmlString("left:"+T+"px;");}return S;},prefilterScopeChange:C,prefilterExprChange:C,ondatasetChange:C,getAllItems:null,reloadItems:C,filterItems:function(P){P=P.filter(function(S){return !S.hide;});switch(this.filterScope){case"att":P=P.filter(function(S){return S.t!==4;});break;case"mx":P=P.filter(function(S){return S.t===4;});break;}var R=this.filterExpr;if(R){var Q=[];F.forEach(P,function(T){var S=B.copy(T),V=S.n,U=new RegExp(K.regEscape(R),"ig");if(U.test(V)){Q.push(S);}});P=Q;}if(this.filterFunc){P=this.filterFunc(P);}return P;},addMenuProp:false,getDragData:function M(P){this.selectDragNode(P);var Q=this._super(P);Q.item=Q.items&&Q.items[0];Q.dsid=this.dataset.id;Q.src=mstrmojo.vi.models.EnumDragSources.DATASETS;return Q;},selectDragNode:function I(Q){this._super(Q);var R=Q.src.data;if(R){var P=R.items=mstrmojo.all[R.srcId].getSelectedItems();R.item=P&&P[0];}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu","mstrmojo.vi._MonitorsAppState","mstrmojo.util.ui._HostsSplitter","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.CheckList","mstrmojo.ui.ScrollableContainer","mstrmojo.Label","mstrmojo.ToolSeparator","mstrmojo.vi.ui.InteractiveUnitList","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.boxmodel","mstrmojo.css","mstrmojo.expr","mstrmojo.vi.models.VIComponentMap","mstrmojo.ME._MetricEditorHelper","mstrmojo.DocDataService");var q=mstrmojo.array,U=mstrmojo.hash,C=mstrmojo.css,T=mstrmojo.dom,R=mstrmojo.expr,AC=R.BFTP,P=mstrmojo.DocSelector.STYLES,k=mstrmojo.elementHelper,F=mstrmojo.vi.models.VIComponentMap.TYPES,a="\u001E",n=4,z=12,O=47,L=257,m=776,Y=779,b=1,w=250,AD=1,AF=10,E=74,G=85;function d(AG){var AJ=AG.tgt.pos,AM=AJ.x,AL=AJ.y,AK=AG.src.data.parentDim,AO=AK.x,AN=AO+AK.w,AI=AK.y,AH=AI+AK.h;return AM>=AO&&AM<=AN&&AL>=AI&&AL<=AH;}function l(){var AN=function(AV,AU){var AT=[];Object.keys(AV).forEach(function(AX){var AW=AV[AX];AT=AT.concat((AW[AU]||[]).filter(function(AY){var AZ=q.find(AT,"did",AY.did);if(AZ>-1){if(AT[AZ].hide&&!AY.hide){AT[AZ].hide=false;}return false;}return true;}).map(function(AY){var AZ=mstrmojo.hash.clone(AY);AZ.dsc="("+AW.name+")";return AZ;}));});return AT;},AH=this.selector,AS=AH.model,AG=AH.defn.srcid,AI=AS.datasets,AQ=AN(AI,["att"]),AL=AN(AI,["mx"]),AO=function(AV){var AU=[],AT={};Object.keys(AV).forEach(function(AW){var AZ=AV[AW],AX=AZ.att||[],Aa=AZ.mx||[];if(q.find(AX,"did",AG)>=0){var AY=AX.filter(function(Ab){return Ab.formType===AC.NUMBER&&Ab.did!==AG&&!Ab.hide&&!AT[Ab.did];}).map(function(Ab){Ab.dsc=AZ.name;return Ab;}).concat(Aa.filter(function(Ab){return !Ab.hide&&!AT[Ab.did];}).map(function(Ab){Ab.dsc=AZ.name;return Ab;}));AU=AU.concat(AY);AY.forEach(function(Ab){AT[Ab.did]=true;});}});return AU;},AK=q.filterOne(AQ,function(AT){return AT.did===AG;}),AM=AO(AI||{}),AR=function(AU){var AT={},AV={};(AU||[]).forEach(function(AW){if(AW.n&&AT[AW.n]){AV[AW.n]=true;}AT[AW.n]=true;});return AV;},AJ=AR(AM);return new mstrmojo.ui.menus.EditorConfig({cssClass:"topRank",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11503,"Ranked By:")},{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:AM,hasTooltipContent:function(AT){return mstrmojo.vi.ui.InteractiveUnitList.prototype.hasTooltipContent.apply(this,arguments)||AJ[AT.n];},getItemTooltip:function(AV,AW){var AU=mstrmojo.vi.ui.InteractiveUnitList.prototype.getItemTooltip.apply(this,arguments);if(AU){var AT=T.position(AW);U.copy({cssClass:"vi-regular vi-tooltip-C",content:AV.n+" ("+AV.dsc+")",posType:mstrmojo.tooltip.POS_TOPLEFT,top:AT.y,left:AT.x+AT.w+6},AU);}return AU;},listHooks:{select:function AP(AW,AX){var AU=AS.findDatasetIdFromUnit(AK.did),AV=function(Ae,Ag){var Ad=Ag+" by "+Ae,Ab=Ad,Af=q.hash(AL.map(function(Ah){return Ah.n;})),Ac=1;while(Af[Ab]){Ab=Ad+" ("+(Ac++)+")";}return Ab;},AT=AV(AK.n,AX.n),Aa=AS.getDataService(),AY=function(Ad,Ab){var Af=[],Ag={oi:{did:"8107C31BDD9911D3B98100C04F2233EA",t:11,st:2826,n:"Sum"},v:"Sum"},Ae=function(Ah){return{tp:2,lv:1,v:Ah};},Ac=function(Ai){var Ah={v:mstrmojo.ME.MetricToken.brackets(Ai.n),lv:1,oi:{did:Ai.did,t:Ai.t,n:Ai.n}};if(Ai.st){Ah.oi.st=Ai.st;}return Ah;};Af=[Ag,Ae("("),Ac(Ad),Ae(")"),Ae("{"),Ac(Ab),Ae("}")];return mstrmojo.ME._MetricEditorHelper.getTokenStreamXML({tks:{items:Af}});},AZ=[Aa.getAddDerivedMetricToDatasetAction({dsid:AU,formula:AY(AX,AK),isTokenStream:true,name:AT,Ids:["$GUID_1"],afb:true,sfb:true}),Aa.getEditDocUnitPropAction({dsid:AU,unitId:"$GUID_1",unitType:n,prop:2,value:"1"})];AS.datasetsSettings.unitOpr(AT,"isDeleteWithFilter",true);AS.datasetsSettings.unitOpr(AT,"completeHide",true);AZ=AZ.concat(AS.datasetsSettings.getSaveActions());Aa.submitUpdates(AZ,mstrmojo.func.wrapMethods(AS.getDatasetsUpdateCallback(),{success:function(Ac){var Ab=AN(Ac.datasets,["mx"]).filter(function(Ad){return q.find(AL,"did",Ad.did)===-1;}).map(function(Ad){Ad.isTopRank=true;Ad.qt=AD;Ad.cs=AF;return Ad;});AS.addFilterStackSelectors(Ab,AH.fmts["z-index"]+1,null,true);}}));this.hideTooltip();this.parent.parent.closeAllMenus();return true;}}}]}]});}var r=function(AH){var AG=[];(Object.keys(AH)||[]).forEach(function(AJ){var AI=AH[AJ];if(AI&&AI.st!==m&&AI.st!==Y){AG=AG.concat({n:AI.name,did:AJ});}});return AG;};function W(){var AH=this.selector,AJ=AH.model,AG=(AH.defn.dsTks||"").split(a),AL=AJ.datasets,AI=r(AL)||[],AK={};AG.forEach(function(AO){var AN=q.find(AI,"did",AO);if(AN>=0){AK[AN]=true;}});var AM=new mstrmojo.ui.CheckList({cssClass:"selectors",items:AI,selectedIndices:AK});return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"filterDataset",contents:[AM],fnOk:function(){var AR=[],AO=AH.model,AQ=AO.getDataService(),AN=AM.getSelectedItems()||[],AP=AH.defn.ck;if(!AN.length){mstrmojo.alert(mstrmojo.desc(13765,"Please choose at least one dataset as target."));return false;}AR.push(AQ.getClearCtrlTargetAction(AP));AR.push(AQ.getClearCtrlTargetDatasetAction(AP));if(AN.length>0){AN.forEach(function(AS){AR.push(AQ.getAddCtrlTargetDatasetAction(AP,AS.did));});AR.push(AQ.getChangeControlElementSource(AP,b));AO.submitDataDefnUpdate(AR,mstrmojo.func.wrapMethods(AJ.controller.getRefreshCallback(),AJ.controller.resumeVIPanelSelection()));}}});}function g(){var AH=this.baseTitle,AG=this.count;if(AG&&AG.length){AH+=" ("+AG+")";}return AH;}function S(){var AJ=this.selector,AN=AJ&&AJ.defn;if(!AN||AN.srct!==z){return"";}var AL=AJ.children&&AJ.children[0],AG=AL.items,AH=AJ.style,AI=AJ.include;if(AH===P.ATTR_QUAL){return AL.getSummaryText();}var AK=AH===P.SEARCH_BOX?Object.keys(AG):Object.keys(AJ.selIdx),AP=AK.length;if(!!AJ.unset||AK.indexOf(String(q.find(AG,"v",k.ELEM_ALL_ID)))>-1){return"";}if(!AP){return mstrmojo.desc(2057,"None");}if(AH===P.SCROLLER&&(AK[AK.length-1]-AK[0])===(AP-1)){var AM=AI?"":mstrmojo.desc(1099,"Not")+" ";return AM+(AP===1?AG[AK[0]].n:(AG[AK[0]].n+" - "+AG[AK[AP-1]].n));}var AO=AK.map(function(AQ){return AG[AQ].n;}).join(", ");if(!AN.include){AO=mstrmojo.desc(1099,"Not")+" "+AO;}return AO;}function AB(AG){AG=AG||"";return[{scriptClass:"mstrmojo.Label",alias:"summaryBar",cssClass:"subtitle",title:AG,text:AG,slot:"domNode"}];}function h(AG){var AI=AG.parent;if(AI.isCollapsed){var AH=S.call(AI),AJ=AI.summaryBar;AJ.set("text",AH);AJ.set("title",AH);}}function e(AG){var AI=[],AK=AG.defn.srcid,AJ=AG.defn.srct===4?"mx":"att";mstrmojo.hash.forEach(AG.model.datasets,function(AM){var AL=AM[AJ];AI=AI.concat(AL);});var AH=q.filterOne(AI,function(AL){return AL.did===AK;});return !!q.filterOne(AI,function(AL){return AL.n===AH.n&&AL.did!==AH.did&&AL.t===AH.t;});}function M(AG){var AI=AG.defn.srct===4?"mx":"att",AJ=AG.defn.srcid,AH=[];mstrmojo.hash.forEach(AG.model.datasets,function(AM){var AL=AM[AI];var AK=q.find(AL,"did",AJ);if(AK!==-1){AH.push(AM.name);}});return AH;}function x(AH,AG){var AI;T.attachEvent(AH,"mousedown",function(){AI=window.setTimeout(function(){C.addClass(AG,"showFPBorder");},300);});T.attachEvent(AH,"mouseup",function(){window.clearTimeout(AI);C.removeClass(AG,"showFPBorder");});}var AE=mstrmojo.mixin({scriptClass:"__DraggableFP",avatarCssClass:"mstrmojo-filterportlet-avatar",selfAvatarCssClass:"mstrmojo-filterportlet-selfAvatar",getDragData:function t(AG){var AJ=this.id,AH=this;return{item:this.selector,idx:this.selector.defn.fmts["z-index"],src:mstrmojo.vi.models.EnumDragSources.FILTERS,dim:T.position(this.domNode),parentDim:T.position(this.parent.domNode),setAvatarClass:function AI(AK){var AN=mstrmojo.all[AJ],AL=d(AG)?AG._selfAvatar:AG._avatarNode;if(AL){var AM=[(AL===AG._selfAvatar?AN.selfAvatarCssClass:AN.avatarCssClass),"hasOwnAvatar",AK];AL.className=AM.join(" ");}},onRemove:function(AL){delete AH.domNode;var AK=!!(AL.isSelectAll&&AL.isSelectAll());AL.model.deleteFilterStackSelectors([AL.defn],AK);}};},isDragValid:function c(AG){return T.contains(this.titlebarNode,AG.src.node);},ondragstart:function v(AG){this._super(AG);this.domNode.style.display="none";},ondragmove:function J(AH){if(d(AH)){var AI=AH.src.data,AJ=AI&&AI.dim,AG=AI&&AI.parentDim;this.avatar=AH._selfAvatar;this.positionAvatar({x:(AJ.x-AG.x),y:(AH.tgt.pos.y-AG.y)});AH._avatarNode.style.display="none";AH._selfAvatar.style.display="block";return true;}this.avatar=AH._avatarNode;AH._avatarNode.style.display="block";AH._selfAvatar.style.display="none";return this._super(AH);},wasDropped:function(){delete this.selector.node.defn.iifp;this.parent.removeChildren(this);this.destroy();},ondragend:function D(AG){var AI=this.domNode;if(AI){C.removeClass(AI,"showFPBorder");AI.style.display="block";}this.avatar=AG._avatarNode;this._super(AG);if(AG._selfAvatar){var AH=this.parent;if(AH){AH.domNode.firstChild.removeChild(AG._selfAvatar);}delete AG._selfAvatar;}},createAvatar:function f(AJ,AH){var AG;if(!AH._avatarNode){AG=AH._avatarNode=document.createElement("div");AG.appendChild(this.titlebarNode.cloneNode(true));AG.style.margin="20px 0 0 20px";AG.style.display="none";AG.className=this.avatarCssClass;}if(!AH._selfAvatar){if(this.domNode.className.indexOf("showFPBorder")===-1){C.addClass(this.domNode,"showFPBorder");}AG=AH._selfAvatar=document.createElement("div");AG.className=this.selfAvatarCssClass;AG.appendChild(this.domNode.cloneNode(true));var AI=document.createElement("div");AI.className="icon";AG.appendChild(AI);AG.style.position="absolute";AG.style.opacity=0.75;this.parent.domNode.firstChild.appendChild(AG);}return AH._avatarNode;}},mstrmojo.mixin(mstrmojo._HasOwnAvatar,{}));mstrmojo.vi.ui.rw.FilterPortlet=mstrmojo.declare(mstrmojo.vi.ui.PanelPortlet,[AE,mstrmojo.vi.ui.rw.selectors._HasFilterContextMenu,mstrmojo.vi._MonitorsAppState,mstrmojo.util.ui._HostsSplitter],{scriptClass:"mstrmojo.vi.ui.rw.FilterPortlet",layoutConfig:{h:{titlebarNode:"20px",containerNode:"100%",handleNode:"4px"},w:{titlebarNode:"all",containerNode:"all"},xt:true},canCollapse:true,showTitleBarContextMenu:true,srcId:"",selector:null,summaryBar:null,postBuildRendering:function X(){var AJ=this.handleNode;C.addClass(AJ,"showSplitter "+mstrApp.getThemeClassName());C.removeClass(AJ,"v");C.addClass(AJ,"h");this.registerSplitter(this.handleNode);var AI=this.titleBar,AH=AI.lblTitle,AG=AH.onclick;AH.onclick=function(AK){var AM=this._timeoutClick,AL=this;if(!AM){this._timeoutClick=window.setTimeout(function(){AG.call(AH,AK);AI.btnCollapse.onclick(AK);delete AL._timeoutClick;},w);}};x(this.titlebarNode,this.domNode);if(this.isCollapsed&&!this.summaryBar){this.addChildren(AB.call(this,S.call(this)));}this.height=Math.max(parseInt(this.height,0),E)+"px";if(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){this.draggable=false;}return this._super();},onAppStateChange:function u(AH){var AG=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION,AI=AH.value===AG;if(AI||AH.valueWas===AG){this.draggable=!AI;this.generateToolbar();}},getFormats:function K(){var AG=this.selector.getFormats();delete AG.left;delete AG.top;return AG;},getTitleBarCfg:function I(){var AH=this._super(),AG=this.selector;AH.isCollapsed=this.isCollapsed;this.baseTitle=AH.title;this.title=AH.title=g.call(this);AH.useRichTooltip=true;AH.shouldShowTooltip=function AJ(AK,AL){this._showTooltipForSameNameObj=e(AG);return this.constructor.prototype.shouldShowTooltip.call(this,AK,AL)||this._showTooltipForSameNameObj;};AH.getTooltipContent=function AI(AK){return this.constructor.prototype.getTooltipContent.call(this,AK)+(this._showTooltipForSameNameObj?"("+mstrmojo.string.encodeHtmlString(M(AG).join(","))+")":"");};return AH;},onisCollapsedChange:function o(){var AN=this,AM=AN.k,AI=this.selector,AL=AI.model,AK=this.isCollapsed,AG=AK?1:0;AI.defn.set("ds",AG);AI.set("visible",!AK);this.handleNode.style.display=AK?"none":"block";if(!this._onCollapseAll){var AP=AL.getVIComponent(F.FILTER_PANEL),AJ=function(){AP.raiseEvent({name:"filterPanelUpdated"});};AL.execute({execute:function(){this.submit(AL.getUnitFormatAction(AI,1,{FormattingView:{WindowState:AG}}),{success:AJ},mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);},urInfo:{callback:{success:function(AQ){AL.updateDefnCache(AQ.defn,[AM]);AP.rebuildChild(AP.children.filter(function(AR){return AR.k===AM;})[0]);AJ();}},treesToRender:1}});}var AH=this.summaryBar;if(AK){var AO=S.call(this);if(!AH){this.addChildren(AB.call(this,AO));}else{AH.set("text",AO);AH.set("title",AO);AH.render();}}else{if(AH){AH.unrender();this.removeChildren(AH);}}},oncountChange:function p(){this.set("title",g.call(this));},onbaseTitleChange:function B(){this.set("title",g.call(this));},clearFilters:function A(){var AG=this.selector;if(AG){AG.clearSelector();h(AG);}},getSplitterInfo:function AA(){return{min:G};},splitterMoved:function Q(AM){var AO=parseInt(this.height,10)+AM+"px",AQ,AI=this.selector,AL=AI.model,AG=this.handleNode,AN=this,AR=AN.parent,AH=function(AS){var AT=AN;if(!AT.parent){(AR.children||[]).forEach(function(AU){if(AU.k===AT.k){AT=AU;}});}AQ=AT.height;AT.set("height",AS);AG.style.top="";AT.doLayout();AI.getFilterPanel().updateScrollbars();};AH(AO);var AK=AL.getUnitFormatAction(AI,1,{FormattingSize:{Height:mstrmojo.boxmodel.px2Inches(AL.getZoomProps(),AO)}}),AP={success:function(AS){AL.updateDefnCache(AS.defn,[AI.k]);}},AJ={style:{params:{treesToRender:1}}};AL.execute({execute:function(){this.submit(AK,AP,AJ);},urInfo:{undo:function(){AH(AQ);},redo:function(){AH(AQ);},callback:AP,extras:AJ}});},setSlotDimensions:function Z(AI,AH,AG){if(AI!=="containerNode"){this._super(AI,AH,AG);}},doLayout:function H(){this._super();var AG=this.domNode;if(AG){AG.style.height="auto";}},addMenuItems:function N(AN){var AI=this.selector;AN.isHostedWithin=false;AN.hostId=this.id;if(!AI.isRecursiveAttributeSelector()){this.addModeMenuItems(AN,AI,function(){h(AI);});}AN.addSeparator();var AG=AI.ckey,AR=AI.getFilterPanel(),AP=this.id,AH=mstrApp.appState===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION,AQ=AI.model.isFromSolrCube(AI.defn.srcid);this.addClearFilterMenuItem(AN,AI,function(){AR.clearSingleBuffSlice(AG);h(AI);});AN.addSeparator();this.addQualMenuItems(AN,AI);if(!AH){if(AI.isAttributeSelector()&&!AQ){AN.addEditorMenuItem(mstrmojo.desc(13628,"Filter by Rank"),AP,l);}AN.addSeparator();if(!AQ){this.addFilterStyleMenuItem(AN,AI);}this.addMultiSelectMenuItem(AN,AI);AN.addSeparator();}if(AI.supportsSetTarget()&&!AQ){this.addMenuItemIfSelectTargetsValid(AN,AI,mstrmojo.desc(11572,"Select other filters within the Filter panel."));AN.addSeparator();}if(!AH){AN.addMenuItem(mstrmojo.desc(629,"Delete"),"Delete",function(){var AS=!!(AI.isSelectAll&&AI.isSelectAll());AI.model.deleteFilterStackSelectors([AI.defn],AS);});}var AK=AN.menus,AM=AK.length,AL,AO=-1,AJ=AM;if(AK&&AM>1){for(AL=0;AL<AM;AL++){if(AK[AL].cls!=="seperator"){break;}AO=AL;}for(AL=AM-1;AL>=0;AL--){if(AK[AL].cls!=="separator"){break;}AJ=AL;}AN.menus=AK.slice(AO+1,AJ);}},getTargetInfo:function V(){var AG=this.selector;var AH=AG.getFilterPanel().getFilterDefinitions().filter(function(AI){return(AI.ckey!==AG.ckey)&&((AI.srct===z&&AI.style!==P.ATTR_QUAL)||AI.srct===O||AI.srct===L);}).map(function(AI){return{n:AI.ttl,id:AI.ckey,st:AI.style};});return{keys:(AG.defn.tks||"").split(a).filter(function(AI){return AH.some(function(AJ){return AJ.id===AI;});}),items:AH};}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelectorViewFactory","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.ListBoxHoriz","mstrmojo.ListBoxSelector","mstrmojo.LinkList","mstrmojo.ButtonList","mstrmojo.DropDownList","mstrmojo.Slider","mstrmojo.AttributeSlider","mstrmojo.TextBoxSelector");var E=mstrmojo.DocSelector.STYLES;var F={};F[E.RADIO]=["RadioListHoriz","RadioList"];F[E.CHECKBOX]=["CheckListHoriz","CheckList"];F[E.LIST]=["ListBoxHoriz","ListBoxSelector"];F[E.LINK]=["LinkListHoriz","LinkList"];F[E.BUTTON]=["ButtonListHoriz","ButtonList"];F[E.SCROLLER]="AttributeSlider";F[E.METRIC_SLIDER]="MetricSlider";F[E.METRIC_QUAL]="MetricQualification";F[E.SEARCH_BOX]="SearchBoxSelector";F[E.TEXT_BOX]="TextBoxSelector";var D={_mixinName:"_oivmDocSelector",preBuildRendering:function C(){var Q=this._super(),O=this.style,I=this.children[0],J=this.node,P=J.defn,U=P.horiz,S=this.getFormats(),K,V,T,X,W=O===E.PULLDOWN;if(P.hm===0&&O!==E.SCROLLER&&O!==E.METRIC_SLIDER){this.contentNodeCssText+="overflow-"+(U?"x":"y")+":hidden;";}if(S){I.color=K=S.color;V=S.height;T=S["background-color"];X=S["text-decoration"];if(X){mstrmojo.css.addWidgetCssClass(this,X);}}if(W){if(S){if(K){this.itemCssText+="color:"+K+";";}}I.cssText=this.itemCssText;}else{I.cellCssClass="";I.tableCssText="table-layout:"+((P.iwm===0)?"fixed":"auto")+";";if(V!==undefined){if(O===E.LIST){if(V.indexOf("px")==V.length-2){var N=parseInt(V.substr(0,V.length-2));if(N>4){N=N-4;}V=N+"px";}}I.cssText="height:"+V+";";}if(O===E.LIST&&T){I.cssText+="background-color:"+T+";";}switch(O){case E.RADIO:case E.CHECKBOX:I.labelCssText=this.itemCssText;break;case E.BUTTON:case E.LINK:case E.LIST:if(O===E.BUTTON){if(K){this.itemCssText+="color:"+K+";";}}if(U){this.itemCssText+="height:"+V+";";}I.itemCssText=this.itemCssText;this["background-color"]=T;break;}}var R=this,M=R.model.getTargetInfoWin(P.tks),L=(W&&I.list)?I.list:I;if(P.ifw||(M&&M.length)){L.makeSelection=function(Y){R.showInfoWin(Y&&Y.selItem);};if(L.selectionPolicy!==undefined){if(!P.multi){L.selectionPolicy="reselect";}if(!L.makeSelHandler&&P.ct!=="4"){L.makeSelHandler=L.attachEventListener("selectionChange",L.id,function(Z){if(Z){var b=Z.added||[],a=Z.removed||[],Y=b.length?b[0]:a[0];if(Y!==undefined&&Y!==null&&I.hasRendered){if(W){this.makeSelection({selItem:I.domNode});}else{this.makeSelection({selItem:this._getItemNode(Y)});}}}});}}}return Q;},newPulldown:function H(I){return new mstrmojo.DropDownList({k:I.ck,cssDisplay:"block",cssClass:"mstrmojo-DocSelector-DropDownList",selectCssClass:"mstrmojo-DocSelector-DropDownList-select",onselectedChange:function(){if(!I._inSyncPhase){I.showInfoWin();I.selectorControlChange(this);}}});},getWidgetClass:function B(L,K,J){var I=F[K];if(I){if(I.constructor===Array){I=I[J?0:1];}return I;}else{return this._super(L,K,J);}}};mstrmojo.OIVMDocSelectorViewFactory=mstrmojo.declare(mstrmojo.DocSelectorViewFactory,null,{scriptClass:"mstrmojo.OIVMDocSelectorViewFactory",getDocSelectorClass:function A(J,K){var I=this._super(J,K);return mstrmojo.DynamicClassFactory.newComponent(I,[D],null);},getOIVMDocSelectorMixin:function G(){return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.requiresClsP("mstrmojo.vi.viz","KnownVisualizations","VisualizationTransition","BaseVisualizationTransition","GridVisualizationTransition","GMVisualizationTransition","HeatMapVisualizationTransition","NetworkVisualizationTransition","GoogleMapVisualizationTransition","ImageLayoutVisualizationTransition","ESRIMapVisualizationTransition","CustomVisualizationTransition");var B=mstrmojo.vi.viz;mstrmojo.vi.factories.VisualizationTransitionFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.factories.VisualizationTransitionFactory",newVisualizationTransition:function A(D,F){var C=B.KnownVisualizations,E=C.getDefinition(D);if(E!==undefined){switch(E.id){case C.GRID:return new B.GridVisualizationTransition(F);case C.NETWORK:return new B.NetworkVisualizationTransition(F);case C.GRAPHMATRIX:return new B.GMVisualizationTransition(F);case C.HEATMAP:return new B.HeatMapVisualizationTransition(F);case C.ESRIMAP:return new B.ESRIMapVisualizationTransition(F);case C.GOOGLEMAP:return new B.GoogleMapVisualizationTransition(F);case C.IMAGELAYOUT:return new B.ImageLayoutVisualizationTransition(F);case C.UNKNOWN:return new B.BaseVisualizationTransition(F);case C.CUSTOM:return new B.CustomVisualizationTransition(F);}}return null;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.color","mstrmojo.chart","mstrmojo.chart.common.Utility");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphObject");var o=mstrmojo,p=mstrmojo.array,P=mstrmojo.hash,H=mstrmojo.num,G=mstrmojo.VisUtility,a=mstrmojo.chart,K=a.enums,b=K.EnumGraphMajorType,J=a.common.Utility,T=a.model,M=T.enums,x=M.EnumDSSGraphObject,AC=mstrmojo.VisEnum.ControlType,z=o.gm,U=mstrmojo.gm.EnumTextAlignH,r=mstrmojo.gm.EnumTextAlignV,w=";",k=",",A="_tmsp",L=" ",Y=-20,l=mstrmojo.gm.EnumSelectionOptionLevel,AE=mstrmojo.gm.EnumShape,f=mstrmojo.color,I=mstrmojo.gm.EnumIdentityType,R=0.00001,D,Z=Math.pow(2,30),c=Math.pow(2,60);var e=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(4046,"First"),mstrmojo.desc(4049,"Last"),mstrmojo.desc(7194,"Constant")];function m(AK,AJ){var AL,AI=AK.length;if(AI!==AJ.length){return false;}for(AL=0;AL<AI;AL++){if(AK[AL]!==AJ[AL]){return false;}}return true;}function AD(AL,AJ,AM){var AK=false,AN=AM+A,AI=AL[AN],AO=AJ[AN];if(AJ[AM]===undefined){AK=true;}else{if((AO===undefined&&AI!==undefined)||(AO!==undefined&&AI!==undefined&&AO<AI)){AK=true;}}if(AK){AJ[AM]=AL[AM];if(AO!==undefined){AJ[AN]=AI;}}}function AH(AJ,AI){var AK;for(AK in AJ){if(AJ.hasOwnProperty(AK)){AD(AJ,AI,AK);}}return AI;}function W(AM){var AL={},AK,AJ=[],AI;p.forEach(AM,function(AN){if(AN!==undefined){AJ.push(AN);}});AI=AJ.length;if(AI===1){return AJ[0];}for(AK=0;AK<AI;AK++){AH(AJ[AK],AL);}return AL;}function AB(AI){return{n:AI,s:AI.toString(),on:AI};}function X(AK,AI,AM){if(AI===AK){return 0;}var AJ=AI-AK,AL=1;while(AJ<1){AJ*=10;AL/=10;}while(AJ>=10){AJ/=10;AL*=10;}if(AJ<1.8){AL*=0.2;}else{if(AJ<3.1){AL*=0.4;}else{if(AJ<4.6){AL*=0.5;}else{if(AJ>=8.1){AL*=2;}}}}if(AM){AL=Math.round(AL);if(AL<1){AL=1;}}return AL;}function B(AL,AP,AR,AJ){var AN=[];if(AL===AP){if(AL<0){AN.push(mstrmojo.gm.GMUtility.formatNumber(AL,"nearest"));}AN.push({n:0,s:"0",on:0});if(AL>0){AN.push(mstrmojo.gm.GMUtility.formatNumber(AL,"nearest"));}return AN;}var AI=AJ>0?AJ:X(AL,AP,AR);var AK=Math.ceil(AP/AI)*AI;if(AK-AP>=AI*0.9){AK=Math.floor(AP/AI)*AI;}var AO=Math.floor(AL/AI)*AI;if(AL-AO>=AI*0.9){AO=Math.ceil(AL/AI)*AI;}var AQ=Math.floor((AK-AO+AI/100)/AI)+1,AM;for(AM=0;AM<AQ;++AM){AN.push(mstrmojo.gm.GMUtility.formatNumber(AO+AM*AI,"nearest"));}return AN;}function S(AI,AL){var AK;AI.mMaxTick=1;if(this.mChartContextPtr.mIsGraphMatrix){AI.mStep=this.mMinimum<0?0.2:0.1;if(AL.mUseCustomMinMax){var AJ=AL;AI.mMaxTick=AJ.mAxisMaxValue;AI.mMinTick=AJ.mAxisMinValue;AI.mMaxTick=Math.min(1,AI.mMaxTick);AI.mMinTick=Math.max(-1,AI.mMinTick);AI.mStep=0.1;}else{if(this.mMaximum>=0.5){AI.mMaxTick=1;AI.mMinTick=Math.floor(this.mMinimum/AI.mStep)*AI.mStep;AI.mMinTick=(AI.mMinTick*this.mMinimum<0)?0:(AI.mMinTick>0?0:AI.mMinTick);if(this.mMinimum<-0.5){AI.mMinTick=-1;}}else{if(this.mMaximum>0){AI.mMaxTick=Math.ceil(this.mMaximum/AI.mStep)*AI.mStep;AI.mMinTick=-1;}else{AI.mStep=0.1;AI.mMaxTick=0;AI.mMinTick=-1;}}}}else{AI.mMinTick=(this.mMinimum<0)?-1:0;if(v.call(this,AI)){return ;}AI.mStep=this.mMajorGrid.mUseManualGrid?this.mMajorGrid.mGridInterval:(AI.mMaxTick-AI.mMinTick)/10;}for(AK=AI.mMinTick+AI.mStep;AK+a.gModuleMain.mTolerance<AI.mMaxTick;AK+=AI.mStep){AI.mTicks.push(Math.round(AK*100)/100);}}function O(AI,AN){var AM,AJ,AP=AN,AO=AP.mDrawCustomLine,AK=AP.mAxisCustomValue,AL;AI.mStep=1;if(this.mMaximum<=0){AI.mMinTick=1;AI.mMaxTick=10;if(AO&&AK<=1){AP.mAxisCustomValue=AI.mMinTick;}return ;}if(this.mMinimum<=0){AJ=this.mMaximum>1?0:-1;AI.mMinTick=Math.pow(10,AJ);if(AP.mUseCustomMinMax){AI.mMaxTick=this.mMaximum;AM=Math.floor(g.call(this,this.mMaximum));if(g.call(this,this.mMaximum)===AM){AM--;}}else{AM=Math.ceil(g.call(this,this.mMaximum));AI.mMaxTick=Math.pow(10,AM);}for(AL=AJ+1;AL<AM;++AL){AI.mTicks.push(Math.pow(10,Math.floor(AL)));}if(AO&&AK<=0){AP.mAxisCustomValue=Math.max(AI.mMinTick,AP.mAxisCustomValue);}return ;}if(AP.mUseCustomMinMax){AM=g.call(this,this.mMaximum);AJ=g.call(this,this.mMinimum);AI.mMaxTick=this.mMaximum;AI.mMinTick=this.mMinimum;}else{AM=Math.ceil(g.call(this,this.mMaximum));AJ=Math.floor(g.call(this,this.mMinimum));AI.mMaxTick=Math.pow(10,AM);AI.mMinTick=Math.pow(10,AJ);}for(AL=AJ+1;AL<AM;++AL){AI.mTicks.push(Math.pow(10,Math.floor(AL)));}if(AO&&AK<=0){AP.mAxisCustomValue=AI.mMinTick;}}function t(AS,AN){var AK=AN,AI,AL;AS.mStep=d.call(this,this.mMaximum,this.mMinimum,AK.mAlwaysIncludeZero);AS.mMaxTick=Math.ceil(this.mMaximum/AS.mStep)*AS.mStep;AS.mMinTick=Math.floor(this.mMinimum/AS.mStep)*AS.mStep;AS.mMinTick=(AS.mMinTick*this.mMinimum<0)?0:AS.mMinTick;if(AK.mAlwaysIncludeZero){AS.mMaxTick=(this.mMaximum<0)?0:AS.mMaxTick;AS.mMinTick=(this.mMinimum>0)?0:AS.mMinTick;}var AM=AS.mMaxTick-AS.mMinTick;if(AS.mStep>=AM){return ;}if(v.call(this,AS)){return ;}AI=Math.floor((AS.mMaxTick-AS.mMinTick+AS.mStep/100)/AS.mStep)+1;var AO=this.mNumberFormat;for(AL=1;AL<AI-1;++AL){var AQ=AS.mMinTick+AL*AS.mStep,AR,AJ,AP;if(AS.mStep<1&&AO.mFormatType===4&&AO.mCustomFormat.indexOf("%")!==-1){AR=AQ*100;if(!J.isIntegar(AR)){AJ=Math.round(AR);AP=Math.abs(AR-AJ);if(AP<R){AQ=AJ/100;}}}AS.mTicks.push(AQ);}}function C(AS,AM){var AR=AM,AL,AI,AP,AK,AO,AN,AJ,AQ;AS.mMaxTick=AR.mAxisMaxValue;AS.mMinTick=AR.mAxisMinValue;if(v.call(this,AS)){return ;}if(!V.call(this)||this.mMajorGrid.mUseManualGrid){AS.mStep=d.call(this,AS.mMaxTick,AS.mMinTick,false);AL=AS.mMaxTick-AS.mMinTick;if(AS.mStep>=AL){return ;}AI=Math.floor(AL/AS.mStep);if(!(this.mChartContextPtr.mIsTimeSeriesChart)&&AL===AI*AS.mStep){for(AK=1;AK<AI;++AK){AS.mTicks.push(AS.mMinTick+AK*AS.mStep);}}else{AL=AS.mMaxTick-AS.mMinTick;AP=10;AO=false;for(AK=3;AK<AI;++AK){AN=AL/AK;while(AN<1){AN*=10;}while(AN>=10){AN/=10;}if(AN===Math.floor(AN)){AP=AK;AO=true;break;}}if(AO){AS.mStep=AL/AP;for(AK=1;AK<AP;++AK){AS.mTicks.push(AS.mMinTick+AK*AS.mStep);}}else{AJ=Math.ceil((AS.mMinTick+AS.mStep/100)/AS.mStep)*AS.mStep;AQ=Math.floor((AS.mMaxTick-AS.mStep/100-AJ)/AS.mStep)+3;for(AK=0;AK<AQ-2;++AK){AS.mTicks.push(AJ+AK*AS.mStep);}}}}else{AL=AS.mMaxTick-AS.mMinTick;AP=10;for(AK=6;AK<=9;++AK){AN=AL/AK;while(AN<10){AN*=10;}while(AN>=100){AN/=10;}if(AN===Math.floor(AN)){AP=AK;break;}}AS.mStep=AL/AP;for(AK=1;AK<AP;++AK){AS.mTicks.push(AS.mMinTick+AK*AS.mStep);}}}function E(AI,AM){var AL,AJ,AK;AI.mMaxTick=AM.mAxisMaxValue;if(AI.mMaxTick<=this.mMinimum){this.mMinimum=AI.mMaxTick-1;}AI.mStep=d.call(this,AI.mMaxTick,this.mMinimum,AM.mAlwaysIncludeZero&&(AI.mMaxTick>0));AL=(AM.mAlwaysIncludeZero&&(this.mMinimum>0))?0:this.mMinimum;if(V.call(this)){AI.mMinTick=AI.mMaxTick-Math.ceil((AI.mMaxTick-AL)/AI.mStep)*AI.mStep;}else{AI.mMinTick=Math.floor(AL/AI.mStep)*AI.mStep;}if(v.call(this,AI)){return ;}AJ=Math.floor((AI.mMaxTick-AI.mStep/100-AI.mMinTick)/AI.mStep)+2;for(AK=1;AK<AJ-1;++AK){AI.mTicks.push(AI.mMinTick+AK*AI.mStep);}}function h(AI,AN){var AJ,AM,AK,AL;AI.mMinTick=AN.mAxisMinValue;if(AI.mMinTick>=this.mMaximum){this.mMaximum=AI.mMinTick+1;}AI.mStep=d.call(this,this.mMaximum,AI.mMinTick,AN.mAlwaysIncludeZero&&(AI.mMinTick<0));AJ=(AN.mAlwaysIncludeZero&&(this.mMaximum<0))?0:this.mMaximum;if(V.call(this)){AI.mMaxTick=AI.mMinTick+Math.ceil((AJ-AI.mMinTick)/AI.mStep)*AI.mStep;}else{AI.mMaxTick=Math.ceil(AJ/AI.mStep)*AI.mStep;}if(v.call(this,AI)){return ;}AM=Math.ceil((AI.mMinTick+AI.mStep/100)/AI.mStep)*AI.mStep;AK=Math.floor((AI.mMaxTick-AM+AI.mStep/100)/AI.mStep)+2;for(AL=0;AL<AK-2;++AL){AI.mTicks.push(AM+AL*AI.mStep);}}function d(AY,AS,AK){var AR,AM;if(this.mMajorGrid.mUseManualGrid){return this.mMajorGrid.mGridInterval;}AR=0;if(AK){AR=Math.max(AY,AY-AS);AR=Math.max(AR,-AS);}else{AR=AY-AS;}if(AR===0){this.mIsShown=false;return 1;}if(AR>=1&&AR<=4&&parseInt(AR)===AR){var AZ=this.PrimaryMetricIndex,AN=AZ.length;for(var AU=0;AU<AN;AU++){var AQ=this.mChartContextPtr.mDatasetPtr,AT=AQ.dataProvider,AL=AT.getSeriesCount(),AP=AT.getGroupCount(),AJ=AZ[AU],AO,AW;for(var AX=0;AX<AL;AX++){AO=AT.getMetricIndexForSeries(AX);if(AO===AJ){AW=true;for(var AV=0;AV<AP;AV++){var Aa=AQ.GetData(AX,AV);if(parseInt(Aa)!==Aa){AW=false;break;}}}if(AW){return 1;}}}}var AI=AR;AM=1;while(AR<1){AR*=10;AM/=10;}while(AR>=10){AR/=10;AM*=10;}if(AR<1.8){AM*=2;AM/=10;}else{if(AR<3.1){AM*=4;AM/=10;}else{if(AR<4.6){AM*=5;AM/=10;}else{if(AR>=8.1){AM*=2;}}}}AM=this.postProcessStep(AM,AI);return AM;}function v(AI){if(this.mChartContextPtr.mIsGraphMatrix){return false;}var AJ=this.mMajorGrid;return AJ.mUseManualGrid&&(AJ.mGridInterval<(AI.mMaxTick-AI.mMinTick)/30);}function g(AI){return Math.log(AI)/Math.log(10);}function V(){return(this.mGraphMajorType===b.GMT_HISTOGRAM||this.mGraphMajorType===b.GMT_POLAR)&&this.mTripleId.mObjectId===x.DssGraphX1Body;}function AA(AL){var AM=this,AI=AM.id,AK=AL.metricId,AJ=new o.ui.menus.MenuConfig();(AL.options).forEach(function(AN){if(AN!==z.EnumRefLineModelType.CONST){AJ.addMenuItem(e[AN],"xt",function(){AM.toggleRefLineEnabled(AK,AN,true);});}else{AJ.addEditorMenuItem(e[z.EnumRefLineModelType.CONST],AI,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",dtp:mstrmojo.expr.DTP.FLOAT,constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR},onEnter:function(){this.validate();}}],fnOk:function(AP,AO){var AQ=AO.constVal;if(AQ.isValid()){AM.toggleRefLineEnabled(AK,AN,true,AQ.value);}}});});}});return AJ;}function u(AK){var AL=this,AJ=AK.metricId,AI=new o.ui.menus.MenuConfig();(AK.options).forEach(function(AO){var AM=AO.refType,AN=e[AM]+((AM===z.EnumRefLineModelType.CONST)?("-["+H.toLocaleString(AO.c)+"]"):"");AI.addMenuItem(AN,"xt",function(){AL.toggleRefLineEnabled(AJ,AM,false,0,AO.modix);});});return AI;}function AF(AM,AI){var AL=AM.GMController,AJ=AL.getForbiddenShapeForMetric(AI),AK=[];[{text:mstrmojo.desc(12097,"Bar"),value:AE.BAR},{text:mstrmojo.desc(2059,"Line"),value:AE.LINE},{text:mstrmojo.desc(9738,"Area"),value:AE.AREA},{text:mstrmojo.desc(12100,"Circle"),value:AE.CIRCLE},{text:mstrmojo.desc(12101,"Square"),value:AE.SQUARE},{text:mstrmojo.desc(12102,"Tick"),value:AE.TICK}].forEach(function(AN){if(AJ.indexOf(AN.value)<0){AK.push(AN);}});return AK;}function q(AJ,AI){return function(AL,AK){if(AL!==AK){AI({ctxt:{sp:AL,mid:AJ}});}};}function AG(AL){var AJ=AL.options,AI=this.getMenuHandler("changeShape"),AK=new mstrmojo.ui.menus.MenuConfig();AK.addRadioMenuGroup(AL.currValue,q(AL.metricId,AI),AJ,"checkMark",undefined,true);return AK;}mstrmojo.gm.GMUtility=mstrmojo.provide("mstrmojo.gm.GMUtility",{mTimers:[],mUseTimer:true,timerId:0,startTimer:function Q(AJ){if(this.mUseTimer){var AI=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:AI,desc:AJ.functionName+": "+AJ.purpose});return AI;}},endTimer:function F(AI){if(this.mUseTimer){var AM,AL=this.mTimers;if(AI===undefined){AM=AL.pop();}else{var AK,AJ;for(AK=0;AK<AL.length;AK++){AJ=AL[AK];if(AJ.timerId===AI){AM=AJ;AL.splice(AK,1);AK--;}}}if(AM){G.visPrint("%c"+AM.desc+": "+(new Date()-AM.timeStamp)+"ms","color: blue");}}},computeTicksForPercentchart:function(AJ,AI,AK){return B(AJ,AI,false,AK);},computeTicksForFlexMinMax:function(AJ,AI,AK,AL){return B(AJ,AI,AK,AL);},formatNumber:function(AK,AJ,AI){return AB(AK,AJ,AI===undefined?3:AI);},sizeCalculator:{sum:function(AI,AM,AN){var AK,AJ=0,AL=0;if(AN===undefined){AN=AI.length;}AM=AM||1;for(AK=0;AK<AN;AK++){if(AI[AK]>0){AL+=AI[AK];AJ+=1;}}if(AJ>1){AL+=(AJ-1)*AM;}return AL;},add:function(AK,AI,AJ){AJ=AJ||1;if(AI>0){AK+=(AI+AJ);}return AK;},minus:function(AK,AI,AJ){if(AI>0){AK-=(AI+AJ);}return AK;}},replaceSpecialChars:function(AI){AI=AI.replace(/&/g,"&amp;");AI=AI.replace(/</g,"&lt;");AI=AI.replace(/>/g,"&gt;");AI=AI.replace(/"/g,"&quot;");return AI;},restoreSpecialChars:function(AI){AI=AI.replace(/&nbsp;/g," ");AI=AI.replace(/&lt;/g,"<");AI=AI.replace(/&gt;/g,">");AI=AI.replace(/&quot;/g,'"');AI=AI.replace(/&amp;/g,"&");return AI;},removeExtraSpace:function(AI){return AI.replace(/ {2,}/g," ");},stringToJSON:function(AI){if(AI===undefined){return undefined;}if(typeof AI==="string"){AI=AI.replace(/'/g,'"');return JSON.parse(AI);}return AI;},everythingToString:function(AJ){if(AJ===undefined){return undefined;}var AI;if(typeof AJ==="object"){AI=JSON.stringify(AJ.jsonObj||AJ);}else{AI=AJ.toString();}AI=AI.replace(/"/g,"'");return AI;},compareElementObj:function(AM,AJ){var AL=AM.tid.toString(),AI=AJ.tid.toString(),AN=AM.eid,AK=AJ.eid;if(AL!==AI){return AL>AI?1:-1;}if(AN===AK){return 0;}return AN>AK?1:-1;},isEqualComb:function(AJ,AI){var AN=true,AM,AL=AJ.length,AK=AI.length;if(AL!==AK){return false;}if(AJ.length>1){AJ.sort(this.compareElementObj);}if(AI.length>1){AI.sort(this.compareElementObj);}for(AM=0;AM<AL;AM++){if(this.compareElementObj(AJ[AM],AI[AM])!==0){AN=false;break;}}return AN;},serializeCombination:function(AJ){var AI="";if(AJ.length>1){AJ.sort(this.compareElementObj);}p.forEach(AJ,function(AK){if(AI!==""){AI+=w;}AI+=(AK.tid+k+AK.eid);});return AI;},deserializeCombination:function(AJ){var AK=AJ.split(w),AI=[];p.forEach(AK,function(AO){var AL=AO.split(k);var AN=AL[0];var AM=AL[1];AI.push({tid:AN,eid:AM});});return AI;},getElementCombinationForMetric:function(AI){var AJ=[];AJ.push({tid:-1,eid:AI});return AJ;},getResolvedFormatsObject:function(AI){return W(AI);},isDigitalArrayEqual:function(AJ,AI){return m.call(this,AJ,AI);},indexOf:function(AJ,AL){var AK,AI=AJ.length;for(AK=0;AK<AI;AK++){if(m(AJ[AK],AL)){return AK;}}return -1;},parseAxisScaleData:function(AM){var AK,AN,AJ,AI=AM.split(","),AL=[];for(AK=0,AN=AI.length;AK<AN;AK++){AJ=AI[AK].split(":");AL.push(AJ);}return AL;},parseCSSColor:function(AM,AJ){var AL=AM.slice(1),AI=[],AK;if(AL.length===6){if(AJ===true){AI[0]=AL[4];AI[1]=AL[5];AI[2]=AL[2];AI[3]=AL[3];AI[4]=AL[0];AI[5]=AL[1];}else{for(AK=0;AK<6;AK++){AI[AK]=AL[AK];}}}else{if(AJ===true){for(AK=2;AK>=0;AK--){AI.push(AL[AK]);AI.push(AL[AK]);}}else{for(AK=0;AK<3;AK++){AI.push(AL[AK]);AI.push(AL[AK]);}}}return parseInt("0x"+AI.join(""),16);},RGB_BRG_Switch:function(AJ){var AL=(AJ>>16)&255,AK=(AJ>>8)&255,AI=(AJ>>0)&255;return(AI<<16)|(AK<<8)|(AL<<0);},encodeColor:function(AJ){if(AJ===undefined||AJ===null||AJ==="transparent"||AJ==="default"){return AJ;}var AK=false,AI={};if(AK){if(typeof AJ==="object"){AI.c1=this.RGB_BRG_Switch(f.encodeColor(AJ.c1));AI.c2=this.RGB_BRG_Switch(f.encodeColor(AJ.c2));AI.or=AJ.or;return AI;}return this.RGB_BRG_Switch(f.encodeColor(AJ));}if(typeof AJ==="object"){AI.c1=f.encodeColor(AJ.c1);AI.c2=f.encodeColor(AJ.c2);AI.or=AJ.or;return AI;}return f.encodeColor(AJ);},checkEquality:function(AJ,AI){if(typeof AJ==="object"&&AJ.c1!==undefined){if(AJ.c1!==AI.c1){return false;}if(AJ.c2!==AI.c2){return false;}if(AJ.or!==AI.or){return false;}return true;}return AJ===AI;},decodeColor:function(AJ){if(AJ===undefined||AJ===null||AJ==="transparent"||AJ==="default"){return AJ;}var AK=false,AI={};if(AK){if(typeof AJ==="object"){AI.c1=f.decodeColor(this.RGB_BRG_Switch(AJ.c1));AI.c2=f.decodeColor(this.RGB_BRG_Switch(AJ.c2));AI.or=AJ.or;return AI;}return f.decodeColor(this.RGB_BRG_Switch(AJ));}if(typeof AJ==="object"){AI.c1=f.decodeColor(AJ.c1);AI.c2=f.decodeColor(AJ.c2);AI.or=AJ.or;return AI;}return f.decodeColor(AJ);},getTrendLineToggleHandler:function(AI,AK,AJ){return function(){AI.switchOnOffTrendLineForMetric(AK,AJ);};},getTrendLineToggleState:function(AI,AJ){return AI.queryTrendLineStatusForMetric(AJ);},getEditTrendLineHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(I.TREND_LINE,AJ);};},getEditRefLineHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(I.REF_LINE,AJ);};},getEditAxisScaleHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(I.AXIS_SCALE,AJ);};},getEditAxisOriginHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(I.AXIS_ORIGIN_DEFINE,AJ);};},getEditLogScaleHandler:function(AI,AJ){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AI.raiseEventCMSelection(I.LOG_SCALE,AJ);};},getOptionObjArr:function(AI,AK,AM){if(!D){D=mstrmojo.gm.GMUtility;}var AJ={},AL;if(AK!==undefined){AK=AK.toLowerCase();if(AK==="x1"){AK="x";}else{if(AK==="y1"){AK="y";}}}if(AI.length>1||(AM&&AI.length===1)){if(AK==="x"){AJ.opt=mstrmojo.desc(11712,"Bottom Axis");AJ.key="XAxis";}else{if(AK==="x2"){AJ.opt=mstrmojo.desc(11710,"Top Axis");AJ.key="X2Axis";}else{if(AK==="y"){AJ.opt=mstrmojo.desc(11715,"Left Axis");AJ.key="YAxis";}else{if(AK==="y2"){AJ.opt=mstrmojo.desc(11713,"Right Axis");AJ.key="Y2Axis";}else{if(AK==="z"){AJ.opt=mstrmojo.desc(12090,"SizeBy");AJ.key="SizeBy";}}}}}AJ.optLvl=l.AXIS;AJ.mos=this.getMetricFormatFromIndexArray(AI);}else{if(AI.length===1){AL=this.getMetricFormat(AI[0]);AJ.opt=AL.n;AJ.mos=[AL];AJ.key=AL.mId;AJ.comb=D.getElementCombinationForMetric(AL.mId);AJ.optLvl=l.METRIC;if(AK==="z"){AJ.sizeBy=true;}}}return AJ;},filterInValidMetricIndex:function(AJ){var AI=[];p.forEach(AJ,function(AK){if(AK!==Y){AI.push(AK);}});return AI;},fillBackgroundDiv:function(AJ){var AI=document.createElement("div");AI.setAttribute("class","gm-bk-div");AI.style.backgroundColor="rgba(0,0,0,0)";AJ.appendChild(AI);},getSubMenu:function(AN,AO,AM,AL){var AK=AF(AN,AL),AI=AN.getMenuHandler("changeShape"),AJ=AN.GMController.getOnTheFlyShapeForMetric(AL);if(AK.length>1){AO.addSubMenuItem(mstrmojo.desc(11972,"Change Shape"),"",AN.id,AG,{currValue:AJ,options:AK,metricId:AM});}else{AO.addRadioMenuGroup(AJ,q(AM,AI),AK,"checkMark",undefined,true);}},getReferenceLineSubMenu:function(AJ,AN,AO,AI){var AP=mstrmojo.gm.EnumSubtype,AM=AJ.GMController.chartSubType;if(AO&&AM===AP.PERCENT){return ;}var AQ=AJ.id,AK=AJ.getAvailableRefLineTypes(AI)||[];if(AK.length>0){AN.addSubMenuItem(mstrmojo.desc(13021,"Add Reference Line"),"xt",AQ,AA,{metricId:AI,options:AK});}var AL=AJ.getExistingRefLineOptions(AI)||[];if(AL.length>0){AN.addMenuItem(mstrmojo.desc(13659,"Edit Reference Line"),"xt",D.getEditRefLineHandler(AJ,AI));AN.addSubMenuItem(mstrmojo.desc(13022,"Remove Reference Line"),"xt",AQ,u,{metricId:AI,options:AL});}},reverseMapping:function n(AJ){var AL={},AK,AI=AJ.length;for(AK=0;AK<AI;AK++){AL[AJ[AK]]=AK;}return AL;},longIntAnd:function(AJ,AI){var AK;if(AJ===AI){return AJ;}if(AJ>c||AI>c){throw new Error("Operand exceeds valid data range.");}if(AJ<Z&&AI<Z){return AJ&AI;}if(AJ>=Z||AI>=Z){if(AJ<AI){AK=AJ;AJ=AI;AI=AK;}}var AM=Math.floor(AJ/Z),AL=Math.floor(AI/Z),AO=AJ-AM*Z,AN=AI-AL*Z;return(AO&AN)+(AM&AL)*Z;},longIntOr:function(AJ,AI){var AK;if(AJ===AI){return AJ;}if(AJ<Z&&AI<Z){return AJ|AI;}if(AJ<AI){AK=AJ;AJ=AI;AI=AK;}AK=this.longIntAnd(AJ,AI);return AI-AK+AJ;},parseNumeric:function(AI){return +AI||parseFloat(AI);},fillTextInDiv:function(AI,AR,AT,AJ,AU,AK,AW,AM,AP){if(AJ===undefined){AJ=AI.offsetWidth;}if(AU===undefined){AU=AI.offsetHeight;}if(AM===undefined){AM=U.MIDDLE;}if(AP===undefined){AP=r.MIDDLE;}if(AK===undefined){AK=false;}var AQ,AS,AO,AV=AK?"gm-text-body":"gm-text-body-nowrap",AL=false,AN;AQ=G.measureTextWidth(AT,AW,6);AN=G.measureTextWidth("...",AW,6);if(AQ>AJ&&AN>AJ){return ;}AO=document.createElement("div");AO.setAttribute("class",AV);AO.setAttribute("type",AC.GM_TEXT_BODY);AO.identity=AR;G.applyStyles2DomNode(AO,AW);AO.innerHTML=AT;AI.appendChild(AO);if(AK){if(AQ>AJ){AS=AO.offsetHeight;}else{AS=G.measureTextHeight(AT,AW,4);}}else{AS=G.measureTextHeight(AT,AW,4);AL=AQ>AJ;}AQ=Math.min(AQ,AJ);AO.style.width=AQ+"px";if(AK){AL=AO.scrollWidth>AQ||AO.scrollHeight>AS;}if(AL){AO.setAttribute("title",AT);}else{AO.setAttribute("title","");}switch(AM){case U.LEFT:AO.style.left="0px";AO.style.textAlign="left";break;case U.MIDDLE:AO.style.left=((AJ-AQ)>>1)+"px";break;case U.RIGHT:AO.style.right="0px";AO.style.textAlign="right";break;}switch(AP){case r.TOP:AO.style.top="0px";break;case r.MIDDLE:AO.style.top=((AU-AS)>>1)+"px";break;case r.BOTTOM:AO.style.bottom="0px";break;}},updateTextColorAndAlignment:function(AI,AK,AL){var AM=AI.firstChild,AN=AM.style,AJ=AI.clientWidth,AO=AM.clientWidth,AQ=AI.clientHeight,AP=AM.clientHeight;AN.left="auto";AN.right="auto";switch(AK){case U.LEFT:AN.left="0px";break;case U.MIDDLE:AN.left=((AJ-AO)>>1)+"px";break;case U.RIGHT:AN.right="0px";break;}AN.top="auto";AN.bottom="auto";switch(AL){case r.TOP:AN.top="0px";break;case r.MIDDLE:AN.top=((AQ-AP)>>1)+"px";break;case r.BOTTOM:AN.bottom="0px";break;}},toggleDisplay:function(AJ,AI){if(!AJ){return ;}if(AI){AJ.style.display="block";}else{AJ.style.display="none";}},isTrendLineAvailableForMetric:function(AM,AN,AQ){var AX=false,AU=mstrmojo.gm.EnumSubtype,AP=o.gm.EnumShape,AV=AM.GMController,AR=AV.chartSubType,AW=AM.model.data.dz,AK=AW.XAxis,AI=AW.YAxis,AL=AW.BreakBy,AO=AW.SliceBy,AS=AQ,AJ=AV.getChartInfo(),AT=AV.getBreakByAttrsID().length>0||(AJ.isABL&&((AK.MetricNames!==undefined)||(AI.MetricNames!==undefined)||(AL.MetricNames!==undefined)||(AO.MetricNames!==undefined)));if(AS===undefined){AS=AV.getOnTheFlyShapeForMetric(AN);}if(AJ.isABL&&AR===AU.PERCENT){AX=true;}if(AT&&!AJ.isBubbleOrScatter&&(AS===AP.BAR||AR===AU.STACKED||(AR===AU.AUTO&&AS===AP.AREA))){AX=true;}if(AJ.isABL){if(AK.TemplateUnit&&AK.TemplateUnit.length>1){AX=true;}if(AI.TemplateUnit&&AI.TemplateUnit.length>1){AX=true;}if(AK.TemplateUnit===undefined&&AI.TemplateUnit===undefined){AX=true;}}AX=AX||this.isIgnoredMetric(AM,AN);return !AX;},isTrendLineAvailableForAnyMetric:function(AK){var AJ=AK.model.data.gsi.mx,AI;for(AI in AJ){if(this.isTrendLineAvailableForMetric(AK,AI)){return true;}}return false;},isIgnoredMetric:function(AL,AJ){var AK=AL.GMController,AM,AI;if(AK.bubbleSeriesNum!==undefined){AM=AK.getMetricsOnYAxis();AI=AM.indexOf(AJ);if(AI>=AK.bubbleSeriesNum){return true;}AM=AK.getMetricsOnXAxis();AI=AM.indexOf(AJ);if(AI>=AK.bubbleSeriesNum){return true;}}return false;},getAxisMetricsInfo:function(AN){var AI=AN.model.data.dz,AO=AN.model.data.gsi.mx,AJ,AK,AM=[];if(!AI||!AI.ColorBy||!AO){return AO;}var AL=function(AP){return(AP&&AP.TemplateMetric)||[];};AJ=AL(AI.YAxis).concat(AL(AI.XAxis));p.forEach(AO,function(AP){AK=false;p.forEach(AJ,function(AQ){if(AP.did===AQ.id){AK=true;return false;}});if(AK){AM.push(AP);}});return AM;},isInvalidTemplate:function N(AL){if(AL.eg){return false;}var AJ=AL.gts;var AI=AJ.row.length===0&&AJ.col.length===0;p.forEach(AJ.row,function(AO){if(AO.otp===-1){AI=true;}});var AN=AJ.col;if(AN.length>0){var AK,AM=AN.length-1;for(AK=0;AK<AM;AK++){if(AN[AK].otp===-1){AI=true;}}}return AI;},isNoData:function(AI){return AI.eg!==undefined;},getInvalidTemplateErrMsg:function(AI){return AI||mstrmojo.desc(12094,"The Graph Matrix requires:")+"\n"+mstrmojo.desc(12095,"- at least one attribute to be placed on the row or column axis")+"\n"+mstrmojo.desc(12096,"- all metrics to be placed on the column axis, below any attributes");},initColorPickerBtnWithGradientDir:function(AJ,AK){mstrmojo.func.override({showPickerForCurrentMode:function AI(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var AL=this.gradientOrientation,AM=AK.getChartInfo().dirc===mstrmojo.gm.EnumABLDirection.VERTICAL;AL.set("selectedIndex",p.find(AL.items,"id",AM?0:1));}}},AJ.colorPicker);},generateToolTipContent:function(AR,AM,AI,AN,AP,AO,AU){var AL,AJ,AK,AQ,AS,AT;for(AL=AR;AL<AM;AL++){AJ=AN[AL];AQ=AP[AL];if(AL>AR){AK=AN[AL-1];AS=AP[AL-1];if(AJ.id===AK.id){if(AQ===""){continue;}if(AJ.fid===AK.fid&&AQ.idx===AS.idx){continue;}if(AJ.n===""){AO[AO.length-1].v+=L+AQ.n;continue;}}}if(AU){AO.push({n:AJ.n,tid:AJ.id,v:AQ.n});}else{AT=AI===undefined?AJ.isRowAttribute:AI;AO.push({n:AJ.n,tid:AJ.id,v:AQ.n,eid:AQ.id,tp:AJ.otp,axis:AT?1:2,tui:AJ.tui,ui:AJ.tui,dpt:AJ.tui+1,at:AQ.at,isRowAttribute:AT,dei:AQ.dei,o:AQ.o});}}},getAttributeFormCnt:function(AI){var AJ;if((AI.fcnt===undefined||AI.fcnt===null)&&AI.fs){AI.fcnt=AI.fs.length||1;}if(AI.fcnt!==undefined&&AI.fcnt!==null){AJ=AI.fcnt;}else{if(AI.t===47){AJ=1;}else{AJ=AI.cs!==undefined?AI.cs:AI.rs;}}return AJ;},isTrueForBoolValue:function(AI){return AI===true||AI==="true";},computeTicksForAxis:function(AL,AJ){var AK=AL.mOptions,AM,AI={mTicks:[]};if(AJ){AM=P.copy(AK);P.copy(AJ,AM);}else{AM=AK;}if(AL.mIsPercent){S.call(AL,AI,AM);return AI;}if(AM.mUseLogarithmicScale){O.call(AL,AI,AM);return AI;}if(AL.mGraphMajorType===b.GMT_BUBBLE&&AL.mTripleId.mObjectId===x.DssGraphZBody){AI.mMinTick=AM.mUseMinValue?AM.mAxisMinValue:AL.mMinimum;AI.mMaxTick=AM.mUseMaxValue?AM.mAxisMaxValue:AL.mMaximum;if(AL.mMinTick>=AL.mMaxTick){AI.mMaxTick=AI.mMinTick+1;}return AI;}if(!AM.mUseMaxValue&&!AM.mUseMinValue){t.call(AL,AI,AM);}else{if(AM.mUseMaxValue&&AM.mUseMinValue){C.call(AL,AI,AM);}else{if(AM.mUseMaxValue){E.call(AL,AI,AM);}else{h.call(AL,AI,AM);}}}return AI;},computeTicksForLogScale:function(AK){var AJ=AK.mOptions,AI={mTicks:[]};O.call(AK,AI,AJ);return AI;},destroyDisposable:function(AI,AJ){if(AJ){p.removeItem(AI.disposables,AJ);AJ.destroy();}},handleDestroy:function(AL,AK){if(!AL){return ;}var AM,AJ=0,AI=AL.disposables,AN=(AI&&AI.length)||0;while(AJ<AN){AM=AI[AJ];if(!AM.scriptClass||AK.indexOf(AM.scriptClass)<0){this.destroyDisposable(AL,AM);}if(AI.length<AN){AN=AI.length;}else{AJ++;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.DocXtabModel","mstrmojo.array","mstrmojo.func","mstrmojo.EnumRWUnitType");var B=mstrmojo.array;var D="Metrics",C=2;mstrmojo.vi.models.DocVisModel=mstrmojo.declare(mstrmojo.vi.models.DocXtabModel,null,{scriptClass:"mstrmojo.vi.models.DocVisModel",getSelectedAttributeElementIdStr:function(M){var L=M[0],E=L.tid,F,G=L.selections,H=[],J=[];B.forEach(G||[],function(N){H=H.concat(B.filter(N,function(O){return O.tid===E;}));});H=B.distinct(H,"eid");(H||[]).forEach(function(N){J.push(N.eid);});F=J.join("\u001E");var K=this.scm,I=(E&&K[E]);if(I){if(I.showall){if(J.length===0){F="OA:(All)";}}}return F;},getAction:function A(P){var N=P[0],H=N&&N.at,J=N.anchor,Q=N.isClearAll,E=N.tid,F,G=N.selections,L=[];F=this.getSelectedAttributeElementIdStr(P);if(G.length!==0&&F===""){return null;}var I;if(H){if((H&C)>0){var M=this.scm;var K=(E&&M[E])||M[D];if(K){var O=this.xtab;if(F!==""){I={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:J,ck:K.ck,tks:K.tks,eid:F,ctlKey:K.ckey,sliceId:O.sid,isUConDS:K.isUConDS,isDocVis:true}};}}}}return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.Box","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.rw._IsViewDataGrid","mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig");var Y=mstrmojo.array,U=mstrmojo.hash,W=mstrmojo.dom,T=mstrmojo.Button.newWebButton,L=mstrmojo.vi.ui.DatasetUnitMenuUtils,H=4,C=3,K=10,S,N=function N(a,b){var d=b&&b.xtab;if(d){var Z=b.xtab.getCellForNode(b.td),c=Z.axis;if((c===2&&Z.hasOwnProperty("mix"))||(c===1&&Z.es)){Z.at=Z.at&24;return true;}return false;}return true;},R=function R(b,c){var a=[],d=b.getDatasetUnits(["mx","att"]),Z=c&&c.getDropZones();if(Z&&Z.zones){Z.zones.forEach(function(e){e.items.forEach(function(f){if(parseInt(f.did,10)!==-1){a.push(d[Y.find(d,"did",f.did)]);}});});}return a;},B=function(a,Z,c){var b=R(a,Z);return a.getDatasetUnits(["mx","att"],null,c).filter(function(d){return Y.find(b,"did",d.did)===-1&&!d.hide;});},G=function G(){var e=this.grid,l=this.model,k=l.getSelectedViUnit(),a=k.boxContent.model.data.datasetId,f=k.getZonesModel(),d=[],b=function(p){p.tooltip=p.n+" ("+p.ds+")";return p;},o=B(l,f,a),h=(o.filter(function(p){return p.t!==4;})).map(b),n=(o.filter(function(p){return p.t===4;})).map(b),c=function(p){var q={};(p||[]).forEach(function(t,r){if(Y.find(R(l,e.zonesModel),"did",t.did)>-1){q[r]=true;}});return q;},m=function(p){return(p||[]).filter(function(q){return !q.hide||q.usedInDropZones;});},Z=function(p){p.unshift({t:"All",formType:3,n:mstrmojo.desc(4928,"All"),tooltip:"Select All Objects"});return p;};function g(r,p){p=m(p);p=Z(p);if(p.length){var q=new mstrmojo.ui.CheckList({cssClass:"units",allIdx:0,items:p.map(function(t){t.tt=t.n+" ("+t.ds+")";t.css=L.getUnitCssClass(t);return t;}),selectedIndices:c(p)});d.push({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:r,children:[q],getSelectedItems:function(){var t=q.getSelectedItems();if(t.length>0&&t[0].t=="All"){t.shift();}return t||[];}});}}g(mstrmojo.desc(3581,"Attributes"),L.getSortedDatasetUnits(h));g(mstrmojo.desc(3582,"Metrics"),L.getSortedDatasetUnits(n));return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mstrmojo-ui-Menu visible datasetObjects",contents:d,hostId:this.id,fnOk:function(){var u=[],AB,w,p=e.zonesModel,r=p.getDropZones().zones,z=r[1],AC=r[0],v=[],q=z.items.length+1,AA=AC.items.length+1,t=R(p.docModel,p),x=R(l,f);d.forEach(function(AD){u=u.concat(AD.getSelectedItems());});AB=(u||[]).filter(function(AD){return Y.find(t,"did",AD.did)===-1;});w=(t||[]).filter(function(AD){if(AD.did==="-1"){return false;}return Y.find(u,"did",AD.did)===-1&&Y.find(x,"did",AD.did)===-1;});AB.forEach(function(AD){v.push(e.model.getAddTemplateUnitAction(AD,a,(AD.t===4?z:AC).id,AD.t===4?q++:AA++));});w.forEach(function(AD){v.push(e.model.getRemoveTemplateUnitAction(AD));});e.controller.onSubmitTemplateUpdates(e,v);}});},J=function(b,c,Z){return{success:function d(f){var e=mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.ViewDataDialog",grid:f,model:b,isViewFilter:c,showUnits:Z});e.set("visible",true);e.render();},failure:function a(e){throw {message:"Couldn't open view data dialog <br>("+(e.message||"")+")",name:"Something went wrong"};}};},D=function(Z){return mstrApp.rootCtrl.docCtrl.view.builder.getLayoutVIMap(Z.getCurrentLayoutKey()).getComponent(5).selectedKey;},A,Q=function Q(Z){if(Z&&mstrmojo.dom.isMetaKey(null,Z)&&Z.keyCode===65&&A){A.selectAll();return false;}return true;},I=function I(Z){var a=mstrApp.isSingleTier;if(a||!!mstrApp.features["web-export-to-excel-privilege"]){Z.push({n:mstrmojo.desc(3958,"Excel"),v:H});}if(a||!!mstrApp.features["web-export-to-pdf-privilege"]){Z.push({n:mstrmojo.desc(1877,"PDF"),v:C});}if(a||!!mstrApp.features["web-export-to-csv-privilege"]){Z.push({n:mstrmojo.desc(11807,"Data"),v:K});}};mstrmojo.vi.ui.ViewDataDialog=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.ViewDataDialog",title:mstrmojo.desc(11476,"Show Data"),help:"show_data_dialog_box_for_html5_dashboards.htm",cssClass:"mstrmojo-ViewDataDialog",modal:true,visible:false,btnAlignment:"right",init:function V(c){var b=c.grid,d=this,Z,a=[];if(!b.openPopup){b.requiresCls(["mstrmojo._HasPopup"]);}this.grid=b;b.viewDataDialog=this;A=b;Z=b.openPopup;b.openPopup=function(){if(N.apply(b,arguments)&&Z){Z.apply(b,arguments);}};b.model.canShowCellMenu=function(e){var f=b.model.getCellDataUnion(e);return !!e&&(f.length===0||(f.length===1&&!f[0].eid));};this.set("buttons",[T(mstrmojo.desc(2177,"Close"),function(){d.close();})]);I.call(this,a);c.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:[{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",alias:"toolbar",useRichTooltip:true,visible:c.showUnits},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-export-type",alias:"exportType",value:mstrmojo.desc(13287,"Export Data"),isHostedWithin:true,items:a,visible:a.length>0,onitemSelected:function(e){this.selectedNode.innerHTML=mstrmojo.desc(121,"Export Data");d.xport(e.v);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-addGridButton mstrmojo-WebHoverButton",text:mstrmojo.desc(11893,"Add as Grid"),onclick:function(){d.close(true);},bindings:{visible:function(){return mstrApp.allowWebDashboardDesign();}}},{scriptClass:"mstrmojo.Label",alias:"rowCount",cssClass:"mstrmojo-rowcount",text:""}],slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-gridBox",children:[b],slot:"containerNode"}];W.attachEvent(document.body,"keydown",Q);this._super(c);},postBuildRendering:function X(){this._super();var a=this.tools.exportType;if(a.visible){a.list.popupConfig.clear();}else{this.tools.rowCount.domNode.className+=" no-export";}var Z=document.createElement("textarea");Z.className="hiddenArea";Z.onblur=function(){Z.focus();Z.select();};this.editorNode.appendChild(Z);this.grid.hiddenField=Z;},openXtabCellMenu:function P(Z){var b=mstrApp.rootCtrl.document,a=new mstrmojo.vi.ui.rw.xtab.ViewDataXtabMenuConfig({isHostedWithin:false,position:Z.cmPos||W.position(Z.btn.domNode),hostId:this.id});a.buildXtabMenuConfig(U.copy({tabularGrid:true,hideAdvancedSort:true},Z));if(a.hasMenuItems()){Z.opener=this;b.openPopup(a.newInstance(),Z);}},closePopup:function(){var Z=mstrApp.rootCtrl.document;if(Z){Z.closePopup();}},close:function O(b){var a=this;W.detachEvent(document.body,"keyup",Q);A=null;this.model.controller.startAutoRefresh();this.model.removeViewDataGrid(this.grid,!!b,S,{failure:function Z(c){throw {name:"Something went wrong.",message:"Couldn't close view data dialog <br>("+(c.message||"")+")"};}});a.destroy();},xport:function M(a){var Z=this.model.controller;switch(a){case K:Z.exportCSV(this.grid.k);break;default:Z.exportVisualization(this.grid,a);}},updateToolbar:function F(a){var d=this,b=this.model,f=b.getSelectedViUnit(),e=f.boxContent.model.data.datasetId,Z=f.getZonesModel(),c=B(b,Z,e);a.btns.push({n:mstrmojo.desc(11780,"Add Data"),cls:"add mojo-theme-dark mstrmojo-Button mstrmojo-WebButton"+(c.length===0?" disabled":""),fn:function(h,g){if(c.length!==0){g.openMenu(G.call(d),h);}}});return a;},passToolbarCfg:function E(Z){this.tools.toolbar.set("toolbarCfg",Z);},oncontextmenu:function(Z){W.preventDefault(window,Z.e);return false;}});mstrmojo.vi.ui.ViewDataDialog.openDS=function(Z,b,a){S=Z.createViewDataGrid(Z.getDatasetUnits(["mx","att"],null,a),Z.getCurrentLayoutKey(),null,J(Z,false,false),a);};mstrmojo.vi.ui.ViewDataDialog.openDSTable=function(Z,c,a,b){S=Z.createViewDataGrid(Z.getDatasetUnits(["mx","att"],null,a,b),Z.getCurrentLayoutKey(),null,J(Z,false,false),a);};mstrmojo.vi.ui.ViewDataDialog.open=function(g,e){var c=g.getDocModel(),d=c.controller;if(d.autoRefReqSent){mstrApp.serverProxy.cancelRequest(d.autoRefReqId);}d.pauseAutoRefresh();g.selectVIUnit();var Z=g.boxContent,h=Z.model.data,b=Z.model,a=(Z.getSelections&&Z.getSelections())||{},f,k=function k(){S=c.createViewDataGrid(null,D(c),f,J(c,e,true),null,Z,g.getZonesModel().getDropZones());};if(e){f=b.getSelectorDataFromViewFilter(h.vfexpr)||[];f=f.concat({keepOnly:true,data:a});k();}else{k();}};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.TemplateBasedDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.array","mstrmojo.hash","mstrmojo.func");var I=mstrmojo.array,C=mstrmojo.hash,M="-1",P=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION;function O(){var Q=this.getHostModel();return Q?Q.gsi:null;}function L(Y,V,T,X,Q){var Z=this.getHost(),U=Z.controller,S,W;S=Y.did;W=Y.t;if(Q){var R=this.getUnitIndexInZone(V,Y);if(R!==-1){if(R<X){X--;}}}U.submitUndoRedoUpdates(this.getUpdateTemplateAction([Z.model.getPivotUnitAction(T,X,S,W)]),null,mstrmojo.func.wrapMethods(U._getXtabCallback(Z),this.getUpdateCallback()));}function J(T){var c=T.item,X=T.zone,Q=T.dsid,a=T.index,R=T.edge,Z=T.isPivot;var d=this.getHost(),W=d.controller,b=X.items,V=d.model,S=X.id,U=[];if(b.length){if(R===P.ON){var Y=b[a];U.push(V.getRemoveTemplateUnitAction(Y));}else{if(R===P.BELOW){a++;}}}else{a=0;}if(Z&&R!==P.ON){L.call(this,c,X,S,a,true);return ;}U.push(V.getAddTemplateUnitAction(c,Q,S,a));W.submitUndoRedoUpdates((T.actions||[]).concat(this.getUpdateTemplateAction(U)),null,mstrmojo.func.wrapMethods(W._getXtabCallback(d),this.getUpdateCallback()));}function K(Q){return Q.src.data.src===mstrmojo.vi.models.EnumDragSources.VIZ_EDITOR;}mstrmojo.vi.models.BaseVisDropZones=mstrmojo.declare(mstrmojo.vi.models.TemplateBasedDropZones,null,{scriptClass:"mstrmojo.vi.models.BaseVisDropZones",addZoneItem:function A(S,T,R){var U=R.mx,Q;if(S.did===M){I.forEach(U,function(V){Q={did:V.did,n:V.n,t:4};T.push(Q);});}else{this._super(S,T);}},getDropZones:function N(){var Q=O.call(this),R=this.getHost();return Q?{n:R.defn.ttl,zones:[this.getZone(mstrmojo.desc(3581,"Attributes"),1,Q.rows,false,{mx:Q.mx,title:mstrmojo.desc(13828)}),this.getZone(mstrmojo.desc(3582,"Metrics"),-1,Q.mx,false,{mx:Q.mx,title:mstrmojo.desc(13827)})]}:{n:R.defn.ttl,zones:[]};},getAvatarIconClass:function G(){return"viXtab";},getAllowDropInfo:function F(R,S,Q,U,T){var W=this._super(R,S,Q,U,T),V=R.id===-1;return C.copy({allowedItems:W.allowedItems.filter(function(Y){var X=Y.t===4;return V?X:!X;})},W);},unitsDropped:function E(Q,S,T,V,U){var R=T.allowedItems[0];J.call(this,{item:R,zone:Q,dsid:S.src.data.dsid,index:T.idx,edge:T.edge,isPivot:K(S),actions:S.actions});},deleteItem:function B(R,Q){this.deleteItems(R,[R.items[Q]]);},deleteItems:function D(R,S){var T=this.getHost(),Q=T.controller,U=[];(S||[]).forEach(function(V){U.push(T.model.getRemoveTemplateUnitAction(V));});if(U.length){Q.submitUndoRedoUpdates(this.getUpdateTemplateAction(U),null,mstrmojo.func.wrapMethods(Q._getXtabCallback(T),this.getUpdateCallback()));}},getExtraUnitMenuItems:function H(R,Q,T,S){this._super(R,Q,T,S);if(T.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Metric&&this.getHost().showThreshold){R.addSeparator();this.buildThresholdMenuOptions(R,{item:T},true);}},getHostModel:function(){return this.getHost().model.data;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.TemplateBasedDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.express.ui.SubtotalsWidget","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.VisEnum");mstrmojo.requiresDescs(101,122,144,190,1018,2453,2968,3224,3573,3582,3647,5188,7974,7975,7976,7978,7979,8138,11099,11609,11610,11667,11806,11908,12193,12194);var c=mstrmojo.array,k=mstrmojo.vi.ui.DatasetUnitMenuUtils,U=mstrmojo.hash,P=mstrmojo.func.wrapMethods,O=-1,M=1,n=2,h="-1",Z=[null,"rows","cols"],R=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION;mstrmojo.vi.models.XtabDropZonesMenuContextType=null;mstrmojo.vi.models.DropZonePivotItemType=null;function Y(){return mstrmojo.all[this.hostId];}function o(){return Y.call(this).gridInfo||{};}function g(u){var t=Y.call(this).model.docModel.getVIComponentKey(mstrmojo.vi.models.VIComponentMap.TYPES.PAGEBY_PANEL);if(t){u.forEach(function(x){var w=x.partialRetrieval=x.partialRetrieval||{},v=w.nodes=w.nodes||[];v.push(t);});}}function H(AC,x,AA,w,t){var AB=Y.call(this),v,z;if(AC.did!==h){v=AC.did;z=AC.t;}if(t){var u=this.getUnitIndexInZone(x,AC);if(u!==-1){if(u<AA){AA--;}}}return AB.model.getPivotUnitAction(w,AA,v,z);}function D(u,t,v){var AC=Y.call(this),z=[],AB=[],w=0,AA=this;if(v){z=U.copy(v,z);AB=U.copy(v,AB);}c.forEach(u.items,function(AE){z.push(H.call(AA,AE,u.zone,u.idx+(w++),u.axis,t));});if(u.axis===n){u.items.forEach(function(AF){var AE=AF.cardg>0?AF.cardg:AF.card;if(!AE||AE<=AA.CARDLIMIT){AB.push(H.call(AA,AF,u.zone,u.idx+(w++),u.axis,t));}});}var x=function(){AC.controller.submitUndoRedoTemplateUpdates(AC,z,AA.getUpdateCallback());},AD=function(){AC.controller.submitUndoRedoTemplateUpdates(AC,AB,AA.getUpdateCallback());};if(u.axis===n){this.checkAndWarnLargeItemsForAddUnits(u.items,x,AD,true,u.zone);return ;}x();}function m(w){var z=Y.call(this),u=z?z.gridData.gts:undefined,x=u[w.axis===n?"col":"row"][w.idx],t=z.getBasicSubtotalEditorConfig(x.ast),v=this;t.fnOk=z.getOnSubtotalsChangeFn(t,x,v.getUpdateCallback());return t;}function N(v){var t=this.getDropZones().zones,u={};t.forEach(function(w){(w.items||[]).forEach(function(z,x){if(z.did===v.did){u.index=x;u.axis=w.id;}if(z.did===-1){u.metricAxis=w.id;}});});return u;}function F(v,x){var AA=[],u=[],z=o.call(this).mx,w=z.length-1,t;for(w;w>=0;w--){AA.push(v.getRemoveTemplateUnitAction(z[w]));if(u){t=N.call(this,z[w]);u.push(v.getAddTemplateUnitAction(U.copy(z[w],{t:4}),x||this.docModel.findDatasetIdFromUnit(z[w]),t.metricAxis,t.index));}}u.reverse();return{actions:AA,undoActions:u};}function e(t){return t.src.data.src===mstrmojo.vi.models.EnumDragSources.VIZ_EDITOR;}function K(t){var u=o.call(this);[M,n].forEach(function(v){u[Z[v]].forEach(function(x,w){t.call(this,v,x,w);},this);},this);}function W(){var v=Y.call(this),t=v.model,w=[],u;K.call(this,function(x,z){if(z.did===h){u=F.call(this,t);w=w.concat(u.actions);}else{w.push(t.getRemoveTemplateUnitAction(z));}});v.controller.submitUndoRedoTemplateUpdates(v,w,this.getUpdateCallback());}function X(v,u){var t=v.model,w=[];if(u.did===h){w.concat(F.call(this,t).actions);}else{w=[t.getRemoveTemplateUnitAction(u)];}return w;}function r(x,v,u,w,t){return[x.model.getAddTemplateUnitAction(v,w,u,t)];}mstrmojo.vi.models.XtabDropZones=mstrmojo.declare(mstrmojo.vi.models.TemplateBasedDropZones,null,{CARDLIMIT:mstrmojo.VisEnum.VIS_CARDLIMIT.GRID,getDropZones:function d(){var t=o.call(this);return{n:Y.call(this).defn.ttl,zones:[this.getZone(mstrmojo.desc(2968,"Rows"),M,t.rows,false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(122,"Columns"),n,t.cols,false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(3582,"Metrics"),O,t.mx,false,{title:mstrmojo.desc(13827)})]};},getAvatarIconClass:function T(){return"viXtab";},canSwapAxis:function l(){return true;},swapAxis:function A(){var z=Y.call(this),AB=[],v=[],AA={},u;this.getDropZones().zones.every(function(AC){u=(AC.id===M)?AC:null;return !u;});K.call(this,function(AC,AD){AA[AC]=true;});K.call(this,function(AF,AG,AC){var AE=null,AJ=AG.did===h,AI=AF===M?n:M,AH=z.model.getPivotUnitAction(AI,AC,AJ?"":AG.did,AJ?"":AG.t);AB.push(AH);if(AI===n){u.items.every(function(AK){AE=(AK.did===AG.did)?AK:null;return !AE;});var AD=AE.cardg>0?AE.cardg:AE.card;if(!AD||AD<=this.CARDLIMIT){v.push(AH);}}else{v.push(AH);}});var x=this,t=function(){z.controller.submitUndoRedoTemplateUpdates(z,AB,x.getUpdateCallback());},w=function(){z.controller.submitUndoRedoTemplateUpdates(z,v,x.getUpdateCallback());};if(AB.length){this.checkAndWarnLargeItemsForAddUnits(u.items,t,w,true,u);return ;}t();},canDefineSubtotals:function E(){var u=this.getHostModel().gsi,t=u&&u.mx;return t&&t.length>0;},hasVisibleSubtotals:function b(){var t=this.getHostModel().gsi;return t&&t.hassb&&!t.hidesb;},showQuickSubtotals:function G(){var v=Y.call(this),x=this.getHostModel().gsi,u=v.model;if(x.hassb){if(x.hidesb){v.controller.submitUndoRedoTemplateUpdates(v,u.getShowDefinedSubtotalsAction());}return ;}var w=[],t=x.tma===M?n:M;x[Z[t]].forEach(function(z){w.push(u.getShowTotalsUnitAction(z.did,z.t,[-10],[]));});v.controller.submitUndoRedoTemplateUpdates(v,w);},hideDefinedSubtotals:function p(){var t=Y.call(this);t.controller.submitUndoRedoTemplateUpdates(t,{act:"hideDefinedSubtotals"});},clearAllSubtotals:function(){var t=Y.call(this);t.controller.submitUndoRedoTemplateUpdates(t,{act:"clearAllSubtotals"});},getExtraUnitMenuItems:function V(u,t,x,w){var v=this,z=this.id;u.addSeparator();if(this.showNumberFormat(x)){u.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),z,this.getNumberFormatEditorCfg,w);}this.buildThresholdMenuOptions(u,w,false);if(x.t===12||x.t===14||(x.t===47&&x.st===12033)){u.addEditorMenuItem(mstrmojo.desc(6193,"Show Totals"),z,m,w);}else{if(x.t===4){u.addToggleMenuItem(mstrmojo.desc(6193,"Show Totals"),"",function(){this.showQuickSubtotals();},function(){this.hideDefinedSubtotals();},z,this.hasVisibleSubtotals());}}if(this.shouldShowDisplayFormsMenu(x)){u.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),this.id,function(){return v.getDisplayFormsMenu(x);});}},getMultiUnitsMenuItems:function a(u,t,v){var z=this.id,w=t.id;if(w!==O){var x=(w===M)?mstrmojo.desc(13262,"Move to Column Header"):mstrmojo.desc(13263,"Move to Row Header");u.addMenuItem(x,"xt",function(){D.call(mstrmojo.all[z],{items:v,zone:t,axis:w===M?n:M,idx:0},false);});u.addSeparator();}this._super(u,t,v);},getAllowDropInfo:function C(z,w,AC,v,t){var u=this._super(z,w,AC,v,t),x=z.id===O,AA=this,AB=o.call(AA);return U.copy({allowedItems:u.allowedItems.filter(function(AD){if(AD.t===4){if(AD.did===h){if(x){return false;}}else{if(!x&&AB.mx&&AB.mx.length){return false;}}}else{if(x){return false;}}return true;})},u);},getHostModel:function B(){return this.getHost().gridData;},unitsDropped:function q(AM,w,AD){var AO=this.getHost(),z=AO.model,AJ=AD.allowedItems,AB=w.getCtxtDragData&&w.getCtxtDragData().dsid,AG=AD.idx,AA=AD.edge,AE=[],AH=[],v=AM.id,AF=AM.items;if(AF.length){if(AA===R.ON&&AD.removeReplaced){var AL=AF[AG];if(AL.did===h){AE=AE.concat(F.call(this,z,AB).actions);}else{AE.push(z.getRemoveTemplateUnitAction(AL));}}else{if(AA===R.BELOW){AG++;}}}else{AG=0;}if(e(w)){D.call(this,{items:AJ,zone:AM,axis:v,idx:AG},true,AE);return ;}var x=false,AC=[];AJ.reverse().forEach(function(AS){var AQ=this.isMetric(AS),AT=AQ&&AM.id!==O&&x,AP=AT?O:AM.id,AV=AT?0:AG,AR=AT?O:(AM.id===1?n:M),AU=-1;AH=AE.concat(r.call(this,AO,AS,AR,AB,AU));AE=AE.concat(r.call(this,AO,AS,AP,AB,AV));if(AQ){AC.push(AS);}x=x||AQ;},this);if(x){AE.push(AO.model.getValuesDefaultFormatGridZoneAction(AC));}var AK=z.docModel,AI=AK.controller,AN=this,t=function(){AI.submitUndoRedoUpdates(AE,null,P(w.callback,AI._getXtabCallback(AO),{success:function(AP){AK.partialUpdate(AP.data,AK.getUnitDefinitions(AO.k));}},AN.getUpdateCallback()));},u=function(){AI.submitUndoRedoUpdates(AH,null,P(w.callback,AI._getXtabCallback(AO),{success:function(AP){AK.partialUpdate(AP.data,AK.getUnitDefinitions(AO.k));}},AN.getUpdateCallback()));};AE=(w.actions||[]).concat(this.getUpdateTemplateAction(AE));AH=(w.actions||[]).concat(this.getUpdateTemplateAction(AH));g.call(this,AE);g.call(this,AH);if(v===n){this.checkAndWarnLargeItemsForAddUnits(AJ,t,u,true,AM);return ;}t();},deleteItem:function J(u,t){this.changeZoneUnits(u,[u.items[t]]);},deleteItems:function I(t,u){this.changeZoneUnits(t,u);},changeZoneUnits:function f(u,t,w){var v=Y.call(this),x=[];t=t||[];w=w||[];w.forEach(function(z){x=x.concat(r.call(this,v,z,u.id,z.dsId,u.items.length-t.length));},this);t.forEach(function(z){x=x.concat(X.call(this,v,z));},this);g.call(this,x);v.controller.submitUndoRedoTemplateUpdates(v,x,this.getUpdateCallback());},getZoneAddCandidates:function S(t){return this.docModel.getDatasetUnits(t.id===-1?["mx"]:["att"]);},clearAllUnits:function L(){W.call(this);},canSupportImageThreshold:function Q(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui._HasScroller","mstrmojo.util.ui._HostsSplitter","mstrmojo.vi.ui._HasMask","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.models.DropZonesModel","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.tooltip");mstrmojo.requiresClsP("mstrmojo.vi.ui","_IsViPanel","VizGalleryList");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");mstrmojo.requiresDescs(114,517,518,1995,7696,7697);var Y=mstrmojo,B=Y.vi.viz,K=Y.dom,C=Y.css,p=Y.string,o=B.EnumWidgetTypes,Q=o.GRID,M=B.EnumVisualizationTemplates,Z=mstrmojo.array,h=mstrmojo.vi.ui.VizGalleryList,m=h.VIZ_LIST_TYPE;var d={n:mstrmojo.desc(114,"Grid"),id:"VisGrid",vt:M.GRID},U="custom",S="none",V="http://visualizations.microstrategy.com";function q(v,x,z){var u=x.getSelectedViUnit(),AB=u&&u.getZonesModel(),AC=['<div><span class="vi-name">{@n}</span>'+(z?'<div class="vi-tooltip-icn icn-tooltip-{@id}"></div>':"")],AD=[],AG={};if(AB&&v){v.forEach(function(AK){var AJ=AK.t,AL=AK.r,AI=AB.getRequiredItemsInfo(AJ),AH={12:mstrmojo.desc(13429,"# more ##attributes###"),4:mstrmojo.desc(13431,"# more ##metrics###"),"long":mstrmojo.desc(13433,"# more ##longitudes###"),lat:mstrmojo.desc(13435,"# more ##latitudes###")};if(AI<AL){AD.push(AH[AJ].replace("###","</span><br/>").replace("##",'<span class="type'+AJ+'">').replace("#",AL-AI));}else{AG["t"+AJ]=AL;}});if(!AD.length){var AA=AG["t"+12],AF=AG["t"+4],AE=[mstrmojo.desc(13436,"# attribute and ## metric"),mstrmojo.desc(13437,"# attribute and ## metrics"),mstrmojo.desc(13438,"# attributes and ## metric"),mstrmojo.desc(13439,"# attributes and ## metrics"),mstrmojo.desc(13440,"# attribute"),mstrmojo.desc(13441,"# attributes"),mstrmojo.desc(13442,"## metric"),mstrmojo.desc(13443,"## metrics")],w=-1;if(AA&&AF){w=Math.min(AA-1,1)<<1|Math.min(AF-1,1);}else{if(AA){w=3+Math.min(AA,2);}else{if(AF){w=5+Math.min(AF,2);}}}if(w!==-1){AD.push(AE[w].replace("##",AF).replace("#",AA));}}}if(AD.length){AD=['<span class="vi-reqs">'].concat(AD).concat(["</span>"]);}AC=AC.concat(AD);AC.push("</div>");return AC.join("");}function r(){var u=this.model.getSelectedViUnit();return !u||!(u instanceof mstrmojo.vi.ui.rw.VizBox);}function f(){this.set("isMasked",r.call(this));}function H(u){var v=u.added,w=v&&this.items[v[0]];if(w){this.parent.model.changeSelectedVisType(w.s||"",w.vt,w.wtp||Q,w.dz);}}mstrmojo.vi.ui.VizGallery=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.vi.ui._IsViPanel,mstrmojo.ui._HasScroller,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState,mstrmojo.util.ui._HostsSplitter,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.vi.ui.VizGallery",markupString:'<div id="{@id}" class="mstrmojo-VIGallery {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIGallery-handle splitter v"></div><div class="mstrmojo-VIGallery-contents"><div class="mstrmojo-VIGallery-builtinVizList"></div><div class="mstrmojo-VIGallery-divider"></div><div class="mstrmojo-VIGallery-galleryLabel"></div><div class="mstrmojo-VIGallery-customVizList"></div><div class="mstrmojo-VIGallery-importCustomVizButton"></div></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{handleNode:function N(){return this.domNode.firstChild;},containerNode:function R(){return this.domNode.childNodes[1];},builtinVizListNode:function I(){return this.domNode.childNodes[1].childNodes[0];},dividerNode:function W(){return this.domNode.childNodes[1].childNodes[1];},galleryLabelNode:function O(){return this.domNode.childNodes[1].childNodes[2];},customVizListNode:function T(){return this.domNode.childNodes[1].childNodes[3];},importCustomVizBtnNode:function g(){return this.domNode.childNodes[1].childNodes[4];},maskNode:function L(){return this.domNode.lastChild;}},layoutConfig:{h:{containerNode:"100%"},xt:true},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},init:function n(u){this._super(u);this.model.attachEventListener("viUnitSelected",this.id,f);},getLayoutOffsets:function E(){return{w:1,h:0};},useRichTooltip:true,preview:false,DEFAULT_WIDTH:52,DEFAULT_LEFT_MARGIN:8,vizList:null,customVizList:null,model:null,handleNode:null,onAppStateChange:function b(u){this._super(u);this.set("isMasked",r.call(this)||u.value===mstrmojo.vi.VisualInsightApp.APP_STATES.SELECTOR_TARGETING);},setOpenStatus:function F(v,u,z,w){this._super(v,u,z,w);if(!u){var x=mstrApp.rootCtrl.docCtrl.view.layoutViewer;x.boxLayoutConfig.box.go=this.visible;x.saveBoxLayout(undefined,undefined,undefined,z);}},children:[{scriptClass:"mstrmojo.vi.ui.VizGalleryList",slot:"builtinVizListNode",alias:"vizList",selectionPolicy:"reselect",type:m.BUILT_IN_LIST,items:[d],postselectionChange:function A(u){H.call(this,u);}},{scriptClass:"mstrmojo.Widget",markupString:"<div class='separator'></div>",slot:"galleryLabelNode"},{scriptClass:"mstrmojo.Label",text:"CUSTOM",slot:"galleryLabelNode",cssClass:"galleryLabel"},{scriptClass:"mstrmojo.vi.ui.VizGalleryList",slot:"customVizListNode",alias:"customVizList",type:m.CUSTOM_LIST,selectionPolicy:"reselect",items:[],postselectionChange:function A(u){H.call(this,u);}},{scriptClass:"mstrmojo.Button",slot:"importCustomVizBtnNode",cssClass:"importVizButton",onclick:function(){var u=K.position(this.domNode),v=this.domNode.parentNode;u.x=u.x+4;u.y=u.y+3.65;C.addClass(v,"clicked");var w=new mstrmojo.ui.menus.MenuConfig({position:u,isHostedWithin:false,menuCssClass:"importVizMenu"});w.addMenuItem(mstrmojo.desc(14736,"Import Visualization..."),"",function(){window.FormWrapper.importCustomVisualization();});w.addSeparator();w.addMenuItem(mstrmojo.desc(14691,"Browse Gallery..."),"",function(){window.FormWrapper.openPage(V);});this.parent.openPopup(w.newInstance(),{onClose:function(){C.removeClass(v,"clicked");}});}},],postBuildRendering:function P(){var u=this.handleNode;u.style.display="block";if(!mstrApp.isSingleTier){this.importCustomVizBtnNode.style.display=S;if(this.customVizList.items.length===0){this.dividerNode.style.display=S;this.galleryLabelNode.style.display=S;this.customVizListNode.style.display=S;}}this.registerSplitter(u);return this._super();},setDimensions:function c(z,v){this._super(z,v);var x=this.handleNode,u=x&&x.style;if(u){u.top=0;u.right=v;u.height=z;u.width="6px";}},getSplitterInfo:function l(){return{isReverseMove:true,min:this.DEFAULT_WIDTH,max:this.DEFAULT_WIDTH*3-this.DEFAULT_LEFT_MARGIN};},splitterMoved:function J(u){var AB="width",v=parseInt(this[AB],10),AA=0,w=u/this.DEFAULT_WIDTH,z=parseInt(w),x=Math.abs(w%1);if(x>0.25){AA=(u>0)?1:-1;}z+=AA;if(z!==0){v+=(this.DEFAULT_WIDTH-this.DEFAULT_LEFT_MARGIN)*z;this.set(AB,v+"px");}this.parent.doLayout();},splitterMouseDown:function G(){this.domNode.parentNode.previousSibling.style.pointerEvents="none";},splitterMouseUp:function D(){this.domNode.parentNode.previousSibling.style.pointerEvents="inherit";},update:function X(u){if(mstrApp.getRecentGallery){mstrApp.getRecentGallery(u);}this.vizList.set("items",[d].concat(h.getVizList(m.BUILT_IN_LIST)));this.customVizList.set("items",h.getVizList(m.CUSTOM_LIST));this.cleanUpListeners();this.updateScrollbars(true);},showTooltip:function t(AE,z){var AB=K.findAncestorByAttr(K.eventTarget(z,AE),"idx",true,this.domNode),w=AB&&AB.node,AD=w&&w.className.indexOf(U)>-1,AC=AD?this.customVizList:this.vizList,AF=AB&&AC.items[AB.value],u=AF&&AF.n,v=AF&&AF.id;if(!u||u===""){return ;}var x=K.position(w),AA=p.apply(q(AF.mr,this.model,this.preview),{n:u,id:v});if(!AA){return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_TOPRIGHT,cssClass:"viGallery-tooltip vi-regular vi-tooltip-D"+(this.preview?" preview":""),content:AA,top:x.y-12-(this.preview?56:0),left:x.x-7,keepArrowYPos:true};this._super(AE,z);},setupScrollNodes:function e(){this.scrollNode=this.containerNode;},updateScrollbars:function k(u){this._super();if(u){this.addScrollNodeProperties();}},cleanUpListeners:function a(){Z.forEach(this.installedEventListeners,function(u){K.detachEvent(u.e,u.evt,u.fn);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.MapDropZones","mstrmojo.vi.viz.ESRIMapHelper");mstrmojo.vi.models.ESRIMapDropZones=mstrmojo.declare(mstrmojo.vi.models.MapDropZones,null,{scriptClass:"mstrmojo.vi.models.ESRIMapDropZones",zonesCfg:mstrmojo.vi.viz.ESRIMapHelper.zonesCfg,getAvatarIconClass:function A(){return"viESRIMap";}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.MapDropZones","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.models.datasets.DataInterface","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.util.TemplateUtils","mstrmojo.vi.viz.GoogleMapHelper");var A=mstrmojo.vi.viz.EnumDSSDropZones,J=mstrmojo.models.datasets.DataInterface,F=mstrmojo.vi.util.TemplateUtils,I=mstrmojo.vi.viz.MapHelper;function B(K){var M=null,L=null;(K||[]).forEach(function(N){if(I.isLatitude(N.fnm,N.fgr)&&N.obf){M=N;}if(I.isLongitude(N.fnm,N.fgr)&&N.obf){L=N;}});return{latForm:M,longForm:L};}function D(K,S,R,N){var P=[],T=this.getHost().getDropZoneItems(A.GeoAttribute)[0],U=this.getHost().getDropZoneItems(A.Latitude)[0],V=this.getHost().getDropZoneItems(A.Longitude)[0],Q=S.did||S.id,O=!(T&&T.id===Q),M=function(W){P.push({act:"addForm",unitId:Q,attFormId:W.fid,unitPos:1});},L=function(W,Z){var Y=Z.getZoneModelByZoneId(W);if(Y&&Y.items.length){var X=Z.getRemoveDropZoneUnitAction(Y,Y.items[0]);if(X){P.push(X);}}};if(O){L(A.GeoAttribute,this);P=P.concat(this.getAddDropZoneUnitsActions({id:A.GeoAttribute},[{did:Q,t:12}],0,{datasetId:K}));}if(R||(O&&U&&U.t===21)){L(A.Latitude,this);}if(R){M(R);P=P.concat(this.getAddDropZoneUnitsActions({id:A.Latitude},[{did:R.fid,t:21}],0,{datasetId:K}));}if(N||(O&&V&&V.t===21)){L(A.Longitude,this);}if(N){M(N);P=P.concat(this.getAddDropZoneUnitsActions({id:A.Longitude},[{did:N.fid,t:21}],0,{datasetId:K}));}return P;}mstrmojo.vi.models.GoogleMapDropZones=mstrmojo.declare(mstrmojo.vi.models.MapDropZones,null,{scriptClass:"mstrmojo.vi.models.GoogleMapDropZones",zonesCfg:mstrmojo.vi.viz.GoogleMapHelper.zonesCfg,getAvatarIconClass:function C(){return"viGoogleMap";},getSelectGeoFormMenu:function H(L){var M=L.item,T=L.zone,U=this,Q=null,S=T.id,P,K,V=(S===A.Latitude),O=(S===A.Longitude);if((V||O)&&M){if(this.isAttribute(M)){Q=M;P=Q.fs;}else{if(M.t===21){Q=this.getHost().getDropZoneItems(A.GeoAttribute)[0];P=J.getFormsByAttrId(Q.id,this.docModel.datasets);}}P=P.filter(function(W){return !!W.obf;});if(Q){K=B(P);if(P.length>1&&((!K.latForm&&V)||(!K.longForm&&O))){var R=new mstrmojo.ui.menus.MenuConfig(),N=function(X,W){return function(){var Z=V?X:null,Y=O?X:null;if(W!==X.fid){U.submitDropZoneUpdates([U.getUpdateTemplateAction(D.call(U,U.getHostModel().datasetId,Q,Z,Y))],U.getHost().model.docModel.controller._getXtabCallback(U.getHost()));}};};if(this.isAttribute(M)){P.forEach(function(W){R.addMenuItem(W.fnm,"",N(W));},this);}else{if(M.t===21){P.forEach(function(W){R.addMenuItem(W.fnm,W.fid===M.did?"on":"",N(W,M.did));},this);}}return R;}}}return null;},getDropActions:function G(S,T,K){var R=T.allowedItems,U=R[0],Q=S.id,N=[],L=B(U.fs),O=L.latForm,M=L.longForm,P=!!(U&&U.fs&&U.fs.length>1)&&O&&M;if(P&&((Q===A.Latitude&&O)||(Q===A.Longitude&&M))){N=D.call(this,K,U,O,M);}return N.length>0?this.getUpdateTemplateAction(N):this._super(S,T,K);},getZone:function E(P,N,K,Q,U){var O=K[0],T=null,R,L,M=function(V,X){var W=null;V.forEach(function(Y){if(Y.fid===X){W=Y;return false;}});return W;};if((N===A.Latitude||N===A.Longitude)&&O){if(this.isAttribute(O)){T=O;}else{if(O.t===21){T=this.getHost().getDropZoneItems(A.GeoAttribute)[0];T=F.findUnitsById(this.getHostModel().gsi,T.id)[0];}}if(T){R=J.getFormsByAttrId(T.id||T.did,this.docModel.datasets);L=B(R);if(R.length>1&&((!L.latForm&&N===A.Latitude)||(!L.longForm&&N===A.Longitude))){if(this.isAttribute(O)){return mstrmojo.vi.models.DropZonesModel.prototype.getZone.call(this,P,N,[{did:O.id,t:12,n:O.n,geoWarning:"geo-warning"}],Q,U);}else{if(O.t===21){var S=M(R,O.id);return mstrmojo.vi.models.DropZonesModel.prototype.getZone.call(this,P,N,[{did:O.id,t:21,n:T.n+"@"+S.fnm,attn:T.n,fnm:S.fnm}],Q,U);}}}}}return this._super(P,N,K,Q,U);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.Editor","mstrmojo.SaveAsEditor","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricFormatEditor","mstrmojo.ColorPicker","mstrmojo.ME.MetricEditBox","mstrmojo.InlineEditBox","mstrmojo.MenuButton","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.FunctionSelector");mstrmojo.requiresDescs(517,1763,2213,9559,9562,11897);var B=mstrmojo.desc,M=mstrmojo.dom;var N=mstrmojo.expr,C={functionSelector:0,advanced:65536,simple:131072,func:196608},L=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS;function K(E,P){var O=[];E.oi.tks.met=C.functionSelector;E.oi.tks.items=O;P.clearTokens(O);}mstrmojo.ME.MetricEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper],{scriptClass:"mstrmojo.ME.MetricEditor",cssClass:"mstrmojo-MetricEditor",zIndex:10,title:B(517,"Metric"),help:"Metric_Formula_Editor.htm",getMetricEditBox:function J(){return this.metricEditBox;},getTokenInputBox:function J(){return this.metricEditBox.inputBox;},isEmpty:function D(){return this.getMetricDefAsTokens().length===0;},onObjectInsert:function F(O){var P=this.metricEditBox.inputBox,E={v:mstrmojo.ME.MetricToken.brackets(O.n),oi:O,isNew:true};P.insertTokens([E]);this.closePopup();},onOpen:function A(){var O=this,E=this.oi,P=this.metricEditBox,Q=P.inputBox;this._setupCandidatesCache(Q);Q.noCache=this.noCache;Q.useKeyDelay=this.useKeyDelay;this.set("title",B(9559,"Formula Editor:")+" "+E.n);if(E&&E.tks){this.preprocessTokenStram(E.tks);Q.set("items",E.tks.items);}P.set("iStatus","");P.set("vStatus",E.tks.items.length>0?this.vStatus:mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN);if(Q.items.length===0){this.set("cValid",false);}},getMetricDefAsTokens:function G(){return(this.oi.tks.items);},onClose:function I(){if(this._super){this._super();}this.vStatus=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN;this.metricEditBox.inputBox.set("items",[]);this.metricEditBox.inputBox.resetTokensCache();},handleValidation:function H(E){this.metricEditBox.handleValidation(E);},children:[mstrmojo.ME._MetricEditorHelper.formatAndOptionsBarRef,mstrmojo.ME._MetricEditorHelper.nameEditBoxRef,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ME-ops",items:[{t:1,v:"+",cls:"plus"},{t:1,v:"-",cls:"minus"},{t:1,v:"*",cls:"multi"},{t:1,v:"/",cls:"divide"},{t:1,v:"()",cls:"par"},{t:1,v:"<>",cls:"bra"},{t:3,v:"V",cls:"clear right",n:B(1763,"Clear all")},{t:2,v:"",cls:"validate right",n:B(11897,"Validate")}],itemMarkupFunction:function(O,E){if(O.t===1){return'<div class="mstrmojo-item '+O.cls+'" idx='+E+' title="'+(O.n||"")+'">'+(O.n||"")+"</div>";}return'<div class="mstrmojo-Button mstrmojo-WebHoverButton '+O.cls+'"><div class="mstrmojo-Button-text" idx='+E+">"+(O.n||"")+"</div></div>";},onmouseup:function(X){var S=X.hWin,T=X.e,E=mstrmojo.dom.eventTarget(S,T),W=E.getAttribute("idx")||-1;this.set("selectedIndex",W);var V=this.parent,Q=V.metricEditBox,R=Q.inputBox,P=this.selectedItem,Z=P.v.split(""),U=[];if(M.getButton(X.hWin,X.e)===M.MOUSE_BUTTON.LEFT){switch(P.t){case 1:mstrmojo.array.forEach(Z,function O(a){U.push({v:a,isDelimiter:true,isNew:true});},this);var Y=R.insertTokens(U);if(U.length===2){R._delaySetTextCaretPos(R.itemsContainerNode.childNodes[Y]);}break;case 2:Q.set("vStatus",L.VALIDATING);V.tbValidate=this;V.validateSyntax(this);break;case 3:K(V,R);R.raiseChangeEvent({type:"clear"});break;}}}},{scriptClass:"mstrmojo.ME.MetricEditBox",alias:"metricEditBox",bindings:{browseItemVisible:"!this.parent.isDME",candidates:"this.parent.candidates"},ontokensModify:function(O){this.parent.onmetricModify();var E=this.inputBox.items.length;this.parent.set("cValid",E>0);if(E===0){this.parent.btnSwitch.set("enabled",true);}},continueValidataion:function(){var E=this.parent;E.validateSyntax(E.tbValidate);}},{scriptClass:"mstrmojo.Button",alias:"btnSwitch",cssClass:"mstrmojo-ME-switch mstrmojo-Editor-button mstrmojo-WebButton",text:B(9562,"Switch to Function Editor"),bindings:{enabled:function(){var O=this.parent.metricEditBox.vStatus===L.ERROR&&!this.parent.cValid,E=parseInt(this.parent.oi.tks.met,10),P=!O&&(!E||(E&&E!==C.advanced)),Q=this.parent.metricEditBox.inputBox.items.length===0;return P;}},onclick:function(){var O=this.parent;var E=function(S){var T=S.oi,Q=T.tks.met||C.functionSelector,P={zIndex:S.zIndex+1,candidates:S.candidates,oi:T,did:T.did,insertMode:false},U={0:"functionSelector",131072:"simpleMetricRef",196608:"wizard"}[Q],R={0:"mstrFSE",131072:"mstrSME",196608:"mstrFE"}[Q];if(Q===C.functionSelector||Q===C.func){P.functions=S.functions;}if(U){if(S.dirty){P.dirty=S.dirty;}S.switch2Editor(R,P);}};if(O.metricEditBox.inputBox.items.length===0){O.close();O.ide.browsersContainer.funcBrowser.handleSelectedFunction();}else{O.cbSwtichEditor=E;O.tbValidate=this;O.validateSyntaxAndSwitch(this,"switch");}},slot:"buttonNode"},mstrmojo.ME._MetricEditorHelper.buttonBarRef]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.Box","mstrmojo.Pulldown","mstrmojo.Label","mstrmojo.TextBoxWithLabel","mstrmojo.ME.MetricEditor","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(1952,2213,8950,9560);var N=mstrmojo.hash,Z=mstrmojo.css,M=mstrmojo.ME._MetricEditorHelper,c=mstrmojo.ME.MetricDataService;var B=null;mstrmojo.ME.ENUM={METRIC_ACTIONS:{ADD:"add",EDIT:"edit",EIDT_NEW:"editNew"},EDITOR_IDS:{ADVANCED:"mstrME",FORMULA:"mstrME",WIZARD:"mstrFE",SIMPLE:"mstrSME",SELECOTR:"mstrFSE"},EDITOR_TYPES:{ADVANCED:"ADVANCED",FUNCTION:"FUNCTION",SIMPLE:"SIMPLE",SELECTOR:"SELECTOR"},METRIC_EDIT_TYPES:{ADVANCED:65536,SIMPLE:131072,FUNCTION:196608},METRIC_TYPES:{65536:"ADVANCED",131072:"SIMPLE",196608:"FUNCTION"},NEW_METRIC_DEFINITION:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}},getNewDefinition:function(){return{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};}};var F=function(d){d=N.copy(d,{left:0,top:0});this.left=(parseInt(this.left||this.editorNode.style.left,10)||0)+d.left+"px";this.top=(parseInt(this.top||this.editorNode.style.top,10)||0)+d.top+"px";};var U=function(e){var h=this,d=h.isDME,g=e.id,f=g.replace("_1",""),k=h.getEditorHelpTopic(f);var l={scriptClass:h.getEditorScriptClass(f),id:g,isDME:d,zIndex:h.zIndex++,oi:e.oi,bindings:{functions:h.funcsPath||"mstrmojo.all.mstrMetricIDE.functions",candidates:h.candidatesPath||"mstrmojo.all.mstrMetricIDE.candidates",dsUnits:"this.ide.dsUnits",attrCandidates:"this.ide.attrCandidates"},tbBrowsable:!d,tbFormatable:!d,ide:h};if(k){l.help=k;}N.copy(e,l);return l;};var A=function(d){var f=this.getEditorId(d),e=mstrmojo.all[f];if(!e){e=mstrmojo.insert(U.call(this,d));e.onvisibleChange=F;e.onPostClose=function(){this.destroy();};}N.copy(d,e);e.candidates=null;e.set("candidates",this.candidates);return e;};var E=function(d){var h=this,g=d.oi;if(h.setExtraMetricTokens){h.setExtraMetricTokens(g);}var f=this.getEditorId(d);var e=mstrmojo.all[f];if(!e){var k=mstrmojo.hash.copy({slot:"editorsContainerNode",left:"0px",top:"0px",modal:false,showTitle:false,postCreate:function(){Z.addWidgetCssClass(this,"mstrmojo-MetricIDE-editor inline");},onPostClose:function(){var l=h.curtain;if(l){l.set("visible",false);l.set("refNode",null);}h.editorConfig=null;h.set("editor",null);},onCancel:function(){h.close();},onSaved:function(){h.close();},switch2Editor:function(m,l){if(l){l.id=m;}h.set("editorConfig",{editorId:m,cfg:l});}},U.call(this,d));if(h.isExpEditor(f)){k.onvisibleChange=function(){var t=B,l=h.browsersContainer.ob,u=this.visible,q=250;if(u){l.set("visible",u);var n=h.browsersContainer.funcBrowser,m=n.functionList,p=m.domNode,o=p.querySelector&&p.querySelector(".mstrmojo-suggest-text.fn[idx]");if(o){var r=o.lastChild;Z.addClass(r,"forceDisplay");window.setTimeout(function(){m.richTooltip=m.getEditBtnTooltip(r);mstrmojo.tooltip.open(m);window.setTimeout(function(){Z.removeClass(r,"forceDisplay");m.hideTooltip();},1000);},q);}}else{l.set("visible",u);}Z.toggleClass(h.editorNode,"exp",u);Z.addClass(h.editorNode,"transition-left");mstrmojo.dom.center(t.editorNode);window.setTimeout(function(){Z.removeClass(h.editorNode,"transition-left");F.call(h);},q);};}if(h.configInlineEditor){h.configInlineEditor(k);}e=mstrmojo.insert(k);e.attachEventListener("fctDidChange",h.browsersContainer.funcBrowser.id,"onfctDidChange");h.addChildren([e]);}else{e.set("oi",g);e.candidates=null;e.set("candidates",h.candidates);}if(d.useGUIDefault!==true){e.useGUIDefault=false;}h.set("editor",e);h.set("help",e.help);return e;};function L(){var f=this,h=500,e=function(l){var k=(l&&l.items)||[],m=f.candidates||{items:[]};m.items=m.items.concat(k);m.isComplete=m.isComplete&&(l.bc===-1||(l.bb+l.bc>l.sz));if(f.functions){m.items=m.items.concat(c.sortFunctions(f.functions));}f.candidates=null;f.set("candidates",m);},d=function(k){mstrmojo.alert(k.getResponseHeader("X-MSTR-TaskFailureMsg"));},g=function(k){if(k){var l={items:k.items,isComplete:(k.bc===-1||(k.bb+k.bc>k.sz))};f.candidates=l;}c.getMetrics({rootFolderType:c.rootFolderTypes.ALL,pattern:"*",blockBegin:1,blockCount:h},{success:e,failure:d});};if(!this.noCache&&!this.candidates){c.getMetricComponents({rootFolderType:c.rootFolderTypes.ALL,pattern:"*",blockBegin:1,blockCount:h},{success:g,failure:d});}else{e({bc:-1,mcComplete:true});}}var W=function(f,h){var g=null,e=function(n,l){if(!mstrmojo.all[h.id]||mstrmojo.all[h.id]._timeStamp!==l){return ;}if(n&&n.tks){M.preprocessTokenStram(n.tks);M.checkEditorFallback(c.sortFunctions(h.functions),n);}h.set("oi",n);if(!h.action.n){h.set("title",mstrmojo.desc(11579,"Metric Editor")+" - "+n.n);}if(h.action.cmd!==mstrmojo.ME.ENUM.METRIC_ACTIONS.ADD){var m=h.showAsSimpleIDE(n);h.set("showLeftPanel",!m);E.call(h,{id:h.editorId,oi:n,functions:g,simple:m}).open(h);}},d=function(l){mstrmojo.alert(l.getResponseHeader("X-MSTR-TaskFailureMsg"));},k=function(m){try{if(!mstrmojo.all[h.id]){return ;}g=h.filterFunctions(m);h.set("functions",g);L.call(h);h.loadObjectDefn({success:function(n){e(n,h._timeStamp);},failure:d});}catch(l){}};c.getFunctions({success:k,failure:d});};mstrmojo.ME.MetricIDE=mstrmojo.declare(mstrmojo.Editor,[],{scriptClass:"mstrmojo.ME.MetricIDE",cssClass:"mstrmojo-MetricIDE",id:"mstrMetricIDE",_timeStamp:0,title:mstrmojo.desc(11579,"Metric Editor"),help:" ",zIndex:4,noCache:true,editorId:null,editor:null,editorConfig:{editorId:null,cfg:{}},getEditorHelpTopic:function R(d){switch(d){case"mstrME":return"metric_expression_editor_for_html5_dashboards.htm";}return"metric_function_editor_for_html5_dashboards.htm";},getEditorScriptClass:function H(d){return"mstrmojo.ME."+{mstrFE:"FunctionWizard",mstrSME:"SimpleMetricEditor",mstrME:"MetricEditor",mstrRFE:"RankEditor",mstrOFE:"OLAPEditor"}[d];},oneditorConfigChange:function O(){var e=this.editorConfig,d=e.cfg;if(this.editor){this.editor.close();}E.call(this,d).open(this,d);},showLeftPanel:true,onshowLeftPanelChange:function K(){Z.toggleClass(this.editorNode,"simple",!this.showLeftPanel);if(this.editor){this.editor.set("simple",!this.showLeftPanel);this.browsersContainer.funcBrowser.set("showFullSyntax",this.isExpEditor(this.editor.id));}var d=this.getBrowsersContainer().domNode.offsetWith/2||120;this.set("left",(parseInt(this.left||this.editorNode.style.left,10)||0)+(this.showLeftPanel?-1:1)*d+"px");if(this.showLeftPanel){this.browsersContainer.funcBrowser.functionList.refresh();}},filterFunctions:function b(d){return d;},isExpEmpty:function a(){var d=mstrmojo.all.mstrME;return d&&d.getMetricDefAsTokens().length===0;},init:function T(f){if(this._super){this._super(f);}var g=mstrApp,d=g&&g.useQuickSearch&&g.useQuickSearch(),e=d?((g&&g.searchAutoCompleteDelay&&g.searchAutoCompleteDelay())||0):0;this.suggestDelay=e||200;this.noCache=this.noCache&&d&&!this.isDME;c.suggestDelay=this.suggestDelay;c.noCache=this.noCache;B=this;this._timeStamp=mstrmojo.now();},onClose:function D(){if(this.editor){this.editor.close();}this.browsersContainer.funcBrowser.cleanup();this.destroy();},onOpen:function I(){F.call(this);this.set("showLeftPanel",true);W(this.metricId||this.did,this);this.set("title",mstrmojo.desc(11579,"Metric Editor")+" - "+(this.action.n||mstrmojo.desc(2213,"New Metric")));B=this;},setExtraMetricTokens:mstrmojo.emptyFn,getTokenInputBox:function C(){return mstrmojo.all.mstrME.metricEditBox.inputBox;},insertTokens:function(d){return this.getTokenInputBox().insertTokens(d);},onObjectInsert:function(d){mstrmojo.all.mstrME.onObjectInsert(d);},setRefOi:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-MetricIDE-browsers-container",alias:"browsersContainer",children:[{scriptClass:"mstrmojo.ME.FunctionSelector",cssClass:"mstrmojo-MetricIDE-editor inline",alias:"funcBrowser",left:"0px",top:"0px",modal:false,showTitle:false,bindings:{functions:function(){return this.parent.parent.functions;},oi:function(){return this.parent.parent.oi||mstrmojo.ME.ENUM.getNewDefinition();},isDME:function(){return this.parent.parent.isDME;},activeEditor:function(){var d=this.parent.parent.editor;this.buttonNode.style.visibility=this.parent.parent.editor?"hidden":"visible";if(d){this.set("showFullSyntax",B.isExpEditor(d.id));}}},onfctDidChange:function(f){var e=Math.max(0,c.getCategoryIndex(f.did)),d=this.fcHBox.fcPulldown,h=d.selectedItem.did;if(h<0){return ;}d.set("value",c.getFunctionCatList()[e].did);var g=this.functionList;window.setTimeout(function(){e=mstrmojo.array.find(g.items,"did",f.did);g.singleSelect(e,false);},100);},switch2Editor:function(e,d){if(d){d.id=e;}B.set("editorConfig",{editorId:e,cfg:d});},handleCloseAction:function(){if(this.onPreClose()){B.close();}},handleSelectedFunction:function(h){var d=this;var f=B.editor;if(f&&B.isExpEditor(f.id)){if(h){B.insertTokens(d.getTokens());var e=function(k){return !isNaN(k)&&k<0;};if(!e(this.functionList.selectedItem.did)){B.getTokenInputBox().insertParenthesisTokens();}}}else{var g=d.functionList;d.openWizard(g.items[g.selectedIndex]);}},openWizard:function(g,f){B.help=B.getEditorHelpTopic("mstrFE");if(!g||g.did===-7){return ;}var e=B,d={zIndex:e.zIndex+1,candidates:e.candidates,oi:mstrmojo.ME.ENUM.getNewDefinition()};if(c.isBasicAggMap(g.did)||g.did<-1){d.did=g.did;d.id="mstrSME";d.useGUIDefault=true;}else{d.fctOi=g;d.id="mstrFE";d.paramItemsPath=e.feParamItemsPath;}e.setRefOi(d);e.set("editorConfig",{cfg:d,opener:f});}}]},{scriptClass:"mstrmojo.Box",alias:"editorsContainer",cssClass:"mstrmojo-MetricIDE-editors-container",children:[{scriptClass:"mstrmojo.Label",cssText:"line-height:380px; text-align:center;",text:mstrmojo.desc(11567,"Select a function from left"),bindings:{visible:"!this.parent.parent.editor",editor:function(){return !this.parent.parent.editor;}}}]},{scriptClass:"mstrmojo.ME.FunctionInfo",slot:"buttonNode",alias:"funcSyntaxDesc",bindings:{foi:function(){return this.parent.browsersContainer.funcBrowser.functionList.selectedItem;},showFullSyntax:function(){return this.parent.browsersContainer.funcBrowser.showFullSyntax;}}}],getBrowsersContainer:function Y(){return this.browsersContainer;},renderObjectsBrowser:function X(){var e=this;var d=this.getBrowsersContainer();if(d){d.addChildren([{scriptClass:"mstrmojo.ObjectBrowser",cssClass:"mstrmojo-MetricIDE-ob",alias:"ob",fishEyeVisible:false,closeable:false,closeOnSelect:false,quickSearch:true,visible:false,bindings:{visible:function(){var f=this.parent.parent.editorRef;return f&&f.id==="mstrME";}},onvisibleChange:function(){if(this.visible&&!this.loaded){this.browse({folderLinksContextId:23,onSelectCB:[e,"onObjectInsert"],useDblSelect:true,browsableTypes:""});this.loaded=true;}},postCreate:function(){this.children=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(1952,"All objects"),cssClass:"mstrmojo-MetricIDE-obLabel"}].concat(this.children);}}]);}},postBuildRendering:function(){if(this._super){this._super();}this.addSlots({editorsContainerNode:this.editorsContainer.domNode});this.renderObjectsBrowser();this.set("help",this.getBrowsersContainer().funcBrowser.help);},loadObjectDefn:function V(f){var d=this.metricId||this.did;if(d){c.getMetricDefintion({id:d,msgID:this.isDME?mstrApp.getMsgID():null},f);}else{var e=mstrmojo.ME.ENUM.getNewDefinition();f.success(e);}},isExpEditor:function S(d){return d==="mstrME";},getModalEditor:function Q(d){this.setRefOi(d);return A.call(this,d);},getEditorId:function P(e){var g=e.oi,d=g&&g.tks&&g.tks.met;var f=e.id||{65536:"mstrME",131072:"mstrSME",196608:"mstrFE"}[d]||"mstrME";if(f==="mstrSME"||f==="mstrFE"||f==="mstrSME_1"||f==="mstrFE_1"){f=M.getSpecialFunctionEditorId(this.getRootFunction(e),e.modal)||f;}e.id=f;return f;},showAsSimpleIDE:function G(d){var e=false;if(this.isDME&&d.did&&d.tks){e=parseInt(d.tks.met,10)!==mstrmojo.ME.ENUM.METRIC_EDIT_TYPES.ADVANCED&&!mstrmojo.string.isEmpty(M.getSpecialFunctionEditorId(d.tks.items[0].oi));}return e;},getRootFunction:function J(d){var e=d.fctOi;if(!e){e=M.getRootFunction(d.oi);}return e;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.MetricEditor","mstrmojo.ME._DerivedMetricEditorHelper");mstrmojo.requiresDescs(2213,8950);var B=mstrmojo.desc;mstrmojo.ME.DerivedFormulaMetricEditor=mstrmojo.declare(mstrmojo.ME.MetricEditor,[mstrmojo.ME._DerivedMetricEditorHelper],{scriptClass:"mstrmojo.ME.DerivedFormulaMetricEditor",title:mstrmojo.desc(2536,"Derived Metric:"),init:function A(C){mstrmojo.css.addWidgetCssClass(this,"dme");this._super(C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.XtabDropZones","mstrmojo.vi.models.EnumDragSources","mstrmojo.array");mstrmojo.requiresDescs(3631,3632,3582);var H=mstrmojo.array,B=-1,C=1,G=2;function F(){return mstrmojo.all[this.hostId];}function D(){return F.call(this).gridInfo;}mstrmojo.vi.models.GraphDropZones=mstrmojo.declare(mstrmojo.vi.models.XtabDropZones,null,{getDropZones:function E(){var I=D.call(this);return{n:F.call(this).defn.ttl,zones:[this.getZone(mstrmojo.desc(3631,"Categories"),C,I.rows),this.getZone(mstrmojo.desc(3632,"Series"),G,I.cols),this.getZone(mstrmojo.desc(3582,"Metrics"),B,I.mx)]};},getUnitMenuItems:function A(M,O,Q,P){if(!Q){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var N=O.items,K=N.length,L=O.id,J={zone:O,axis:L,idx:H.indexOf(N,Q),cnt:K,item:Q,metricsAxis:D.call(this).tma},I=this.id;M.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[I].deleteItem(O,J.idx);});}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.func","mstrmojo.hash","mstrmojo.ToolSeparator","mstrmojo.CheckBox","mstrmojo.Label","mstrmojo.Dialog","mstrmojo.Button","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi.models.VIComponentMap","mstrmojo.vi.ui.VizBoxTitleBar","mstrmojo.vi.ui.ViewDataDialog","mstrmojo.vi.ui.rw.UnitContainer","mstrmojo.vi.ui.editors.VisAsFilterDialog","mstrmojo.vi.ui.VizGalleryList","mstrmojo.EnumRWUnitType","mstrmojo.vi.viz.KnownVisualizations","mstrmojo.vi.viz.EnumWidgetTypes","mstrmojo.vi.models.EnumDragSources");mstrmojo.requiresDescs(14389,9126);var C=mstrmojo.css,Q=mstrmojo.dom,AJ=mstrmojo.func,S=mstrmojo.hash,AA=mstrmojo.EnumRWUnitType,e=mstrmojo.vi.viz.KnownVisualizations,AM=mstrmojo.vi.viz.EnumWidgetTypes,W=AM.GRID,AC=mstrmojo.vi.models.EnumDragSources,AR="px",A=0,h=2,P=mstrmojo.vi.models.VIComponentMap.TYPES,T=mstrmojo.vi.viz.EnumVisualizationTemplates;var l=mstrmojo;var D="vf-active",AS="hidden",AQ="hasViewFilter";var U=true;var c=3,o=4;var AG="web-export-to-pdf-privilege",p="web-export-to-excel-privilege",I="web-export-to-csv-privilege";var L=4;var E={n:mstrmojo.desc(4541,"Maximize"),cls:"max",fn:function f(){this.parent.setPortalState(this,h);this.isMaxed=true;},ctxt:null,dsbld:false};var AK={n:mstrmojo.desc(4540,"Restore"),cls:"rt",fn:function f(){this.parent.setPortalState(this,A);delete this.isMaxed;},ctxt:null,dsbld:false};function Y(AT){mstrApp.onerror(AT);}function z(AV){var AU=this.model,AY=this,AT=[{n:mstrmojo.desc(11670,"Copy to"),toLayoutTitle:mstrmojo.desc(13933,"Copy to #"),toNewLayoutTitle:mstrmojo.desc(13934,"Copy to a New Sheet"),crossLayoutMessage:mstrmojo.desc(12137,"Copying will clear all filters from the new visualization. Do you want to continue?"),cls:"",fn:function AX(AZ,Ab,Ac,Aa){AU.copyVisualization(AZ,Ab,Ac,Aa);}},{n:mstrmojo.desc(10461,"Move to"),toLayoutTitle:mstrmojo.desc(13935,"Move to #"),toNewLayoutTitle:mstrmojo.desc(13936,"Move to a New Sheet"),crossLayoutMessage:mstrmojo.desc(13937,"Moving will clear all filters from the new visualization. Do you want to continue?"),cls:"",fn:function AX(AZ,Ab,Ac,Aa){AU.moveVisualization(AZ,Ab,Ac,Aa);}}],AW=function AW(Ab,Aa,AZ){return function(){mstrmojo.warn(Aa,{confirmBtn:{fn:AZ}},{title:Ab});};};AT.forEach(function(AZ){AV.addPopupMenuItem(AZ.n,null,function(){var Af=AZ.fn,Ab=new mstrmojo.ui.menus.MenuConfig(),Ac=AY.boxContent.builder.getLayoutVIMap(AU.getCurrentLayoutKey()).getComponent(P.VIZ_CONTENT),Aa=AU.getCurrentLayoutKey(),Ad=Ac.panels.filter(function(Ag){return Ag.k!==Ac.selectedKey;}),Ae=AU.defn.layouts.filter(function(Ag){return Ag.k!==Aa;});Ad.forEach(function(Ag){var Ah=Ag.k;Ab.addMenuItem(Ag.titleText,"",function(){Af(AY,Ac,Ah,Aa);});});Ab.addMenuItem(mstrmojo.desc(11671,"New Panel"),"",function(){Af(AY,Ac,null,Aa);});Ab.addSeparator();Ae.forEach(function(Ag){Ab.addMenuItem(Ag.title,"",AW(AZ.toLayoutTitle.replace("#",Ag.title),AZ.crossLayoutMessage,function(){Af(AY,Ac,null,Ag.k);}));});Ab.addMenuItem(mstrmojo.desc(11672,"New Sheet"),"",AW(AZ.toNewLayoutTitle,AZ.crossLayoutMessage,function(){Af(AY,Ac,null,null);}));return Ab;},AZ.cls);});}function H(){var Ac=this.boxContent,AW=Ac.node.data;if(!AW){return ;}var AY=Ac.model,Aa=AW.vfexpr,AZ=AW.vlexpr,Ab=AY.getSelectorDataFromViewFilter(Aa),AT=this.filterBtnNode,AU;if(AZ||Ab===null||Ab.length>0){var AX=Ac.controller,AV=function AV(Ad){var Af=AJ.wrapMethods(AX._getXtabCallback(Ac),{success:function Ae(){Ac.raiseEvent({name:"regenerateToolbar"});}});AX.applyKeepOnly(Ac,Af,undefined,Ad.ctxt);};AU=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstrmojo-viz-fe-menu",isHostedWithin:false,useTooltip:true});AU.addMenuItem(mstrmojo.desc(1763,"Clear All"),"",AV,-1);AU.addSeparator();if(Ab===null||AZ){AU.addMenuItem(AW.vftext||mstrmojo.desc(14016,"Advanced Qualification"),"",AV,-1);}else{Ab.forEach(function(Ah,Ad){var Ai=[],Ag=mstrmojo.desc(2827,"Clear"),Aj="",Af=true;Ah.data.every(function(Ak){[].concat(Ak).every(function(Al){if(Aj===""){Aj=Al.tn;}return(Af=(Aj===Al.tn));});return Af;});Ah.data.forEach(function(Am,Ak){if(Ak>0){Ai.push(mstrmojo.desc(5283,"OR"));}var Al=[];[].concat(Am).forEach(function(An){Al.push((Af?"":(An.tn+" = "))+(An.v||mstrmojo.desc(14323,"NULL")));});Ai.push(Al.join(" "));});var Ae=Ah.keepOnly?"##":mstrmojo.desc(13232,"Not ##");AU.addMenuItem(Ag+' "'+Ae.replace("##",(Af?Aj+" = ":"")+Ai.join(" "))+'"',"",AV,Ad);});}}this.filterMenuCfg=AU;r.call(this,!!AU);C.toggleClass(AT,AS,!AU);}function J(){if(this.filterMenuCfg){var AT=this._onMoveCount;if(AT===undefined||AT>=5){this._onMoveCount=0;window.clearTimeout(this._hideDNDHandler);var AU=this.filterBtnNode;C.removeClass(AU,AS);this._hideDNDHandler=window.setTimeout(function(){C.addClass(AU,AS);},2000);}else{this._onMoveCount++;}}}function AN(AT){var AW=this.model.controller.id,AV=this.boxContent,AU=AV.k;AT.addPopupMenuItem(mstrmojo.desc(246,"Export"),this.id,function(){var AY=new mstrmojo.ui.menus.MenuConfig(),AX=e.getDefinition(this.boxContent.model.data.visName||"Grid").id;if(Z(AX)){AY.addMenuItem(mstrmojo.desc(3958,"Excel"),"exportToExcel",function(){mstrmojo.all[AW].exportVisualization(AV,o);});}if(b(AX)){AY.addMenuItem(mstrmojo.desc(1877,"PDF"),"exportToPDF",function(){if(AV.isClientExport&&AV.exportVisualization){AV.exportVisualization(c);}else{mstrmojo.all[AW].exportVisualization(AV,c);}});}if(AP()){AY.addMenuItem(mstrmojo.desc(11807,"Data"),"exportToCSV",function(){mstrmojo.all[AW].exportCSV(AU);});}return AY;},"export");}function Z(AT){return(AT===e.GRID&&(!!mstrApp.features[p]||!!mstrApp.isSingleTier));}function b(AT){return([e.UNKNOWN,e.IMAGELAYOUT].indexOf(AT)===-1&&(!!mstrApp.features[AG]||!!mstrApp.isSingleTier));}function AP(){return !!mstrApp.features[I]||!!mstrApp.isSingleTier;}function AF(){var AT=e.getDefinition(this.boxContent.model.data.visName||"Grid").id;return Z(AT)||b(AT)||AP();}function m(AT){var AV=this.boxContent,AW=mstrmojo.vi.ui.VizGalleryList,AU=AW.VIZ_LIST_TYPE;AT.addPopupMenuItem(mstrmojo.desc(13165,"Change Visualization"),this.id,function(){var AZ=new l.ui.menus.MenuConfig(),AY=AV.model.data.visName||"",Aa=[{n:mstrmojo.desc(114,"Grid"),id:"VisGrid",s:"",vt:T.GRID}].concat(AW.getVizList(AU.BUILT_IN_LIST+AU.CUSTOM_LIST));Aa=Aa.filter(function(Ab){return(Ab.s===""||l.ExpressVisList.getVis(Ab.s)!==null)&&Ab.s!==AY;});var AX=(AV.getDocModel&&AV.getDocModel())||AV.model.docModel;Aa.forEach(function(Ab){AZ.addMenuItem(Ab.n,"",function(){AX.changeSelectedVisType(Ab.s||"",Ab.vt,Ab.wtp||W,Ab.dz);});});return AZ;},"");}function AI(AT,AV){var AU=AT.getCtxtDragData();this.getZonesModel().addUnitsFromDataSource(AU.items,AU.dsid,AT.actions,AV?AT.callback:null);}function r(AT){if(this.titleBar){C.toggleClass(this.titleBar.domNode,AQ,AT);}}mstrmojo.vi.ui.rw.VizBox=mstrmojo.declare(mstrmojo.vi.ui.rw.UnitContainer,[mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.ui.rw.VizBox",showTitleBar:true,titleBar:null,filterMenuCfg:null,filterBtnNode:null,init:function AH(AT){this._super(AT);C.addWidgetCssClass(this,"mstrmojo-VIBox");this.isMaxed=(this.defn.ds===h);},getPanelForAddAction:function v(){return"editPanel";},getExcludedPanels:function AO(){return[];},getDocModel:function AL(){var AT=this.model;return AT.docModel||AT;},getTitleBarCfg:function N(){var AT=this._super();AT.scriptClass="mstrmojo.vi.ui.VizBoxTitleBar";AT.close=function AV(){var AX=this.parent,AW=AX.parent;AW.deleteBoxAndSubmit(AX);AW.removeChildren(AX);AX.destroy();};AT.titleEdited=function AU(AX,Ab,AW){var Aa=this.parent;Aa.draggable=true;if(Ab){var AZ=Aa.getDocModel();AZ.renameRWUnitTitle(AX,this.title,Aa.k,{success:function Ac(Ad){Aa.defn.ttl=Ad;Aa.set("title",Ad);},failure:function AY(Ad){Y(Ad);Aa.titleBar.set("title",AW);}});}};return AT;},getTitleVisibilityFmts:function g(AU){var AT=this._super(AU);AT.FormattingView.ShowWidgetTitleBar=AU;return AT;},onclick:function u(AT){this._super(AT);this.titleBar.onclick();},switchPropertyOnClick:function t(){var AT=this.boxContent;if(!AT||!AT.supportsEditorClickSwitching){return false;}return this._super();},postBuildRendering:function V(){try{this._super();var AU=this.filterBtnNode=document.createElement("div"),AX=this.id;AU.className="hover-filter-btn "+AS;r.call(this,!!this.filterMenuCfg);Q.attachEvent(AU,"click",function(){var AZ=mstrmojo.all[AX],AY=AZ.filterMenuCfg;AY.hostId=AX;AY.hostElement=AU;AZ.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:AY}));});this.domNode.appendChild(AU);if(this.defn.ds===h){this.parent.setPortalState(this,h,true);}if(U){C.addClass(this.titleBar.leftToolbar.domNode,D);}}catch(AV){var AW=this.domNode.appendChild(document.createElement("div"));AW.className="errorNode";AW.innerText=mstrmojo.desc(11461,"There was an error rendering your visualization");this.getZonesModel=function AT(){return null;};}},doLayout:function M(){var AT=this.boxContent;if(AT){AT.skipReRender=true;}this._super();if(AT){delete AT.skipReRender;}},applyBoxSize:function d(AT,AV,AZ,AY){this._super(AT,AV,AZ,AY);var AX=this.boxContent,AU=AX&&AX.getFormats();if(AU){var AW=this.titleBar.visible?Q.position(this.titlebarNode).h:0;AU.height=(parseInt(AT,10)-AW)+AR;AU.width=AV;}},updateDisplayName:function F(AT,AU){this._super(AT,AU,true);},createDeleteUpdate:function n(){var AU=this.model,AX=AU.getDataService().newUpdate(),AV=AU.clearVisAsFilterAction(this,true);if(AV){AX.addUpdate(AV);}var AW=this.boxContent.node.k;this.parent.children.forEach(function(AZ){var AY=AZ.defn,Aa=AY.tks;if(Aa){if((Aa||"").split("\u001E").indexOf(AW)>-1){AX.addActions(AU.getDataService().getRemoveCtrlTargetAction(AY.ck,AW,undefined,true));if(AZ.defn&&AZ.defn.srct&&AZ.defn.srct===L){AX.setTreesToRender(3);}}}});var AT=AU.getSourceFilterKeys(AW,true);if(AT){AX.setTreesToRender(3);}AX.addUpdate(AU.getRemoveUnitUpdate({unit:this,partialRetrievalKeys:AT}));AX.addUpdate(AU.associatedNodesUpdate(this.parent.children));return AX;},generateToolbar:function q(){H.call(this);this._super();},updateToolbar:function w(AY){var AZ=this,Ac=this.boxContent,AV=this.canShowDesignMenuItems(),AX=function(){AY.addMenuItem(mstrmojo.desc(11476,"Show Data"),"shwd",function(){mstrmojo.vi.ui.ViewDataDialog.open(mstrmojo.all[AZ.id]);});},Aa=function(Ad,Ae){if(Ad&&Ad.length===2){AY.addDualStateItem(AZ.id,Ad[0],Ad[1],Ae);}},AW=null,Ab=this.parent,AU=mstrApp.isAppStatePresentation();if(Ab&&Ab.hasMultipleChildren()){AW=[E,AK];if(this.isMaxed){AW.reverse();}}Aa(AW,true);if(!AU&&mstrApp.allowWebDashboardDesign()){m.call(this,AY);if(Ac.getContainerMenuItems){Ac.getContainerMenuItems(AY);}AY.addSeparator();var AT=Ac.zonesModel;if(AT&&AT.canSwapAxis()){AY.addMenuItem(mstrmojo.desc(11658,"Swap"),"",function(){AT.swapAxis();});AY.addSeparator();}if(AT&&AT.canDefineSubtotals()){AY.addToggleMenuItem(mstrmojo.desc(6193,"Show Totals"),"",function(){AT.showQuickSubtotals();},function(){AT.hideDefinedSubtotals();},null,AT.hasVisibleSubtotals());AY.addSeparator();}if(Ac.handlesMultiSelection){if(Ab&&Ab.getTargetKeysByType([AA.GRID,AA.GRAPH,AA.MOJOVISUALIZATION]).length>1){AY.addMenuItem(mstrmojo.desc(11958,"Use as Filter..."),"uaf",function(){mstrmojo.vi.ui.editors.VisAsFilterDialog.open(mstrmojo.all[AZ.id]);});AY.addSeparator();}}AX();AY.addMenuItem(mstrmojo.desc(14389,"Remove Data"),"",function(){var Ad=Ac.zonesModel;Ad.clearAllDropZones(Ad.docModel.clearVisAsFilterAction(AZ));});AY.addPopupMenuItem(mstrmojo.desc(12949,"Data Source"),this.id,function(){var Ai=new mstrmojo.ui.menus.MenuConfig(),Af=AZ.model,Ag=Af.datasets,Ae=AZ.boxContent.model.data.datasetId||"",Ad=[];var Ah=function(Ak){var Aj=false;S.forEach(Ak,function(Am){var Al=Am.att&&Am.att[0];if(Al&&Al.t===12&&Al.st===3076){Aj=true;return false;}});return Aj;};S.forEach(Ag,function(Aj,Ak){Ad.push({name:Aj.name,id:Ak});});if(!Ah(Ag)){Ad.push({name:mstrmojo.desc(5949,"None"),id:""});}Ad.forEach(function(Aj){var Ak=Aj.id;Ai.addMenuItem(Aj.name,Ae===Ak?"on":"",function(){var Al=AZ.k,Am=Ak;if(Ae===Ak){return ;}Ac.zonesModel.submitActionForDatasetUpdate({act:"editNode",nodeKey:Al,treeType:AZ.defn.tt,datasetId:Am||"00000000000000000000000000000000",partialRetrieval:{nodes:[Al]}});});});return Ai;});AY.addSeparator();if(AF.call(this)){AN.call(this,AY);}if(AV){AY.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){AZ.model.duplicateVisualization(AZ);});z.call(this,AY);}AY.addSeparator();this.addToggleTitleMenuItem(AY);}else{AX();AN.call(this,AY);}Aa(AW,false);this._super(AY);if(!AU&&mstrApp.allowWebDashboardDesign()){AY.addSeparator();AY.addMenuItem(mstrmojo.desc(9126,"More Options...")+"...","",function(){var Ad=AZ.getEditorModel(),Ae=Ad.getHost().model,Ag=Ae&&Ae.data,Af=(Ag&&Ag.gsi&&Ag.gsi.prop)||{};if(Ac instanceof mstrmojo.vi.ui.rw.Xtab){Ad.openMoreOptionsEditor(Af,true,Ag.lhv);}else{Ad.openMoreOptionsEditor(Af);}});}return AY;},addFormatMenuItem:function k(AX,AW,AT){var AV=this.getEditorModel(),AU=AV.getFormatToTargetFn&&AV.getFormatToTargetFn();if(AU){AT=AT?AJ.composite([AT,AU]):AU;}return this._super(AX,AW,AT);},getFormatMenuItemTarget:function B(AV){var AT=this.boxContent;if(AT.getFormatMenuItemTarget){var AU=AT.getFormatMenuItemTarget(AV);if(AU!==undefined){return AU;}}return this._super(AV);},getZonesModel:function O(){return this.boxContent.zonesModel;},allowDropFromDataset:function X(AT){var AU=this.boxContent;if(AU&&AU.allowBoxDropFromDataset){return AU.allowBoxDropFromDataset(AT);}return true;},dropFromDataset:function R(AT){AI.call(this,AT,false);},dropFromAllObjects:function AE(AT){this.augmentDropContextForSchema(AT,this.getZonesModel().docModel);AI.call(this,AT,true);},isDragValid:function a(AT){var AU=this.boxContent;if(AU.canOnlyDragOnTitleBar){if(!Q.contains(this.titleBar.getLabelNode(),AT.src.node,true,this.domNode)){return false;}}return this._super(AT)&&!this.isMaxed;},getAvatarCls:function x(){return this._super().concat(["viz-avi"]);},ondragenter:function G(AU){var AV=this.boxContent,AT=AU.getCtxtDragData().src;if(AV.handleDndForParentNode&&AV.ondragenter){if(AT===AC.DATASETS||AT===AC.VIZ_EDITOR||AT===AC.VIZ||AT===AC.ALL_OBJECT_LIST){AV.ondragenter(AU);return ;}}this._super(AU);},setTitleBarVisibility:function AB(AT){this._super(AT);this.titleBar.onclick();C.toggleClass(this.filterBtnNode,AS,AT||!this.filterMenuCfg);},onmouseover:function K(AT){this._super(AT);if(!mstrApp.isInteractive()){return ;}Q.attachEvent(this.domNode,"mousemove",J.bind(this));},onmouseout:function AD(AT){this._super(AT);Q.detachEvent(this.domNode,"mousemove",J.bind(this));}});mstrmojo.vi.ui.rw.VizBox.ENUM_PORTAL_STATE={RESTORE:A,MAXIMIZE:h};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.RadioList","mstrmojo.VisEnum","mstrmojo.array","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.Pulldown","mstrmojo._FormatDefinition","mstrmojo.hash","mstrmojo.models.FormatModel","mstrmojo.gm.GMUtility","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.func","mstrmojo.css","mstrmojo.models.FormatModel","mstrmojo.VisUtility","mstrmojo.heatmap.vi.VisHeatmapUtility","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.vi.viz.EnumDSSDropZones");var k=mstrmojo.array,N=mstrmojo._FormatDefinition,Q=mstrmojo.hash,d=mstrmojo.gm.GMUtility,v=mstrmojo.func,D=mstrmojo.css,x=mstrmojo.VisUtility,O=mstrmojo.heatmap.vi.VisHeatmapUtility,e=mstrmojo.ui.editors.controls.AdvancedColorPicker,b=mstrmojo.models.FormatModel,U=b.ENUM_PROPERTY_NAMES,L=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,H=mstrmojo.chart.enums.EnumFontStyle,c=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,f=mstrmojo.VisEnum.HEATMAP_LABEL_SIZE,G=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS,t=mstrmojo.vi.viz.EnumDSSDropZones;var z={};z[U.FONT_SIZE]=L.LEGEND_FONT_SIZE;z[U.FONT_FAMILY]=L.LEGEND_FONT_FAMILY;z[U.COLOR]=L.LEGEND_FONT_COLOR;var I="de",m="lgd";var T="widgetSelectionChangeHandlers",o="colorByColorChangeHandlers",n="fontScaleChangeHandlers";function l(AB){var AC=this;return function(AF){var AE=AC.getHost(),AD=x.getPropertyByPath(AE,"observableModel."+AB);if(AD){AD.setValue(AF);}};}function E(){var AB=this.getHost();if(AB){return AB.getPropsInfo();}return null;}var K=N.Families.slice(1).map(function(AB){return{n:AB.n,id:AB.n};});function AA(AH,AF,AE){AH=AH&&AH!=="false";var AD=new mstrmojo.ui.Checkbox({checked:AH,oncheckedChange:function(){var AI=this.checked;AE(AI,!AI);}});var AG=this.getLabelAndControl(AF,AD,"20px","100%",true);D.addWidgetCssClass(AG,"checkLabel");var AC=AG.getLabel();AC.onclick=function AB(){AD.onclick();};AC.cssDisplay="inline-block";return AG;}function P(AC,AB,AG,AF,AE){var AD=new mstrmojo.ui.Pulldown(Q.copy(AE,{items:AC}));AD.set("selectedIndex",AB);AD.postselectedIndexChange=function(AH){var AK=AH.value,AJ=AH.valueWas;if(AK!==AJ){var AI=this.items;AF(AI[AK]&&AI[AK].id,AI[AJ]&&AI[AJ].id);}};if(AG){return this.getLabelAndControl(AG,AD);}else{AD.getCtrl=function(){return AD;};return AD;}}function Z(AB){return new mstrmojo.Label({text:AB});}function p(AB,AD){var AC,AE;if(typeof AD==="number"){k.forEach(AB,function(AG,AF){if(!AE){AC=AF;}else{if((AD-AG.id)*(AD-AE.id)<=0){AC=Math.abs(AD-AG.value)<Math.abs(AD-AE.value)?AF:AF-1;return false;}}AE=AG;});}else{if(typeof AD==="string"){k.forEach(AB,function(AG,AF){if(AG.id===AD){AC=AF;return false;}});}}return AC;}function A(AD,AC,AE){var AB=[];if(AD!==undefined){AB.push(Z.call(this,AD));}var AF={onGroupValueChange:function(AK,AL,AJ){if(AK.indexOf("FillTrans")>=0){if(!Q.equals(AL,AJ)){AC.opacity.setValue(AL/100);}}}};AF.propNames=[AE+"Clr",AE+"FillTrans"];var AI=new mstrmojo.ui.editors.controls.FillConfigGroup(AF);if(AI){AI.iniChildrenComp(AF.propNames);}var AG=AI.getChildComp(AF.propNames[0]);if(AG){AG.set("selectedValue",AC.value.getValue());AG.postselectedValueChange=function(AJ){var AL=AJ.value,AK=AJ.valueWas;if(!Q.equals(AL,AK)){AC.value.setValue(AL);}};}var AH=AI.getChildComp(AF.propNames[1]);if(AH){AH.set("value",AC.opacity.getValue()*100);}AB.push(AI);AC.attachEventListener("valueChanged",this.id,function(){AG.set("selectedValue",AC.value.getValue());AH.set("value",AC.opacity.getValue()*100);});return AB;}function S(AJ){var AN=this.getHost(),AI=AN.textSelectedIndex?AN.textSelectedIndex:0;AN.attachEventListener("formatclick",this.id,function(AO){if(AO.formatValue==="headerOnTop.header"){AN.textSelectedIndex=1;}else{if(AO.formatValue==="headerOnTop.cell"){AN.textSelectedIndex=2;}}});function AD(){var AO=E.call(this).labelSize;if(AO===f.Proportional){if(AK&&AE.getSelectedItem().id!==1||!AK){AL.set("enabled",false);}}}var AG=function(AQ){var AO="",AP=false;k.forEach(AQ,function(AR){var AS=AR.family.getValue();if(!AP){AO=AS;AP=true;}else{if(AO!==AS){AO="";}}});return AO;};var AK=!!AJ.cell,AM=AK?(AI===1?[AJ.header]:[AJ.cell]):[AJ],AL=O.getStepper(function(AR){var AO=AM.length,AQ;for(AQ=0;AQ<AO;AQ++){var AS=AQ!==AO-1,AP=AM[AQ];if(AR>0){AP.scale.setValue(AP.scale.getValue()+0.1,AS);}else{AP.scale.setValue(Math.max(0.1,AP.scale.getValue()-0.1),AS);}}}),AF=P.call(this,K,p(K,AG(AM)),null,function(AQ){var AO=AM.length,AP;for(AP=0;AP<AO;AP++){AM[AP].family.setValue(AQ,AP!==AO-1);}},{isHostedWithin:false});this._fontStepper=AL;AJ.attachEventListener("valueChanged",this.id,function(AO){var AP=AO.target,AQ=false;k.forEach(AM,function(AR){if(AP===AR.family){AQ=true;return false;}});if(AQ){AF.set("selectedIndex",p(K,AG(AM)));}});AL.slot="col1Node";AF.slot="col2Node";var AB=new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:"50%",col2Width:"50%",children:[AL,AF]});var AE;var AH=this;var AN=this.getHost();var AC=[AB];if(AK){AE=P.call(this,[{n:mstrmojo.desc(2461,"All"),id:0,limitNames:["header","cell"]},{n:mstrmojo.desc(2967,"Headers"),id:1,limitNames:["header"]},{n:mstrmojo.desc(12007,"Labels"),id:2,limitNames:["cell"]}],AI,null,function(AP){if(AP===0){AM=[AJ.header,AJ.cell];}else{if(AP===1){AM=[AJ.header];}else{AM=[AJ.cell];}}var AO=p(K,AG(AM));if(AO!==undefined){AF.set("selectedIndex",AO);}else{if(AO===undefined){AF.selectedNode.innerHTML="";}}AN.triggerFontScaleChangeEvent();},{isHostedWithin:false});AC.unshift(AE);}W.call(this,n,"stepper",function(AO){var AP;if(AK){AP=(AE.getSelectedItem().limitNames||[]).map(function(AQ){return"headerOnTop."+AQ;});}else{AP=["headerOnMiddle"];}O.setStepperEnabled(AL,AP,AO.limits);AD.call(AH);});AN.triggerFontScaleChangeEvent();return AC;}function M(AH){var AB=function(){var AN=this.getHost(),AK=AN.readGlobalAttriLegndProperty(L.LEGEND_FONT_FAMILY),AO=AN.readGlobalAttriLegndProperty(L.LEGEND_FONT_SIZE),AM=d.decodeColor(AN.readGlobalAttriLegndProperty(L.LEGEND_FONT_COLOR)),AL=parseInt(AN.readGlobalAttriLegndProperty(L.LEGEND_FONT_STYLE),10);var AJ={};AJ["text-decoration"]="";AJ[U.FONT_FAMILY]=AK;AJ[U.FONT_SIZE]=parseInt(AO,10);AJ[U.COLOR]=AM;if((AL&H.FS_BOLD)>0){AJ[U.FONT_WEIGHT]="bold";}if((AL&H.FS_ITALIC)>0){AJ[U.FONT_STYLE]="italic";}if((AL&H.FS_UNDERLINE)>0){AJ[U.UNDERLINE]="underline";}if((AL&H.FS_STRIKETHROUGH)>0){AJ[U.LINE_THROUGH]="line-through";}AH.setFormatSource(AJ);}.bind(this);var AG=this.getHost();var AF={bold:H.FS_BOLD,italic:H.FS_ITALIC,underline:H.FS_UNDERLINE,strikeout:H.FS_STRIKETHROUGH};var AE=["fontFamily","fontStyle","fontSize","fontColor"];function AD(AK,AJ){var AL=null;if(AE.indexOf(AJ)>-1){AL=AK[AJ];}return AL;}var AI=AD(AH,AE[3]);AI.showNoFill=false;var AC=AD(AH,AE[1]);if(AC){AC.postselectionChange=function(AJ){var AM=AJ.added,AN=this.items[(AM&&AM[0]!==undefined)?AM[0]:AJ.removed[0]],AL=!!AM,AK=AG.readGlobalAttriLegndProperty(L.LEGEND_FONT_STYLE),AO=(AK===undefined?H.NORMAL:AK);if(AL){AO=AO|AF[AN.css];}else{AO=AO&(~AF[AN.css]);}this.parent.raiseFormatValueChange(L.LEGEND_FONT_STYLE,AO,AK);};}AB();x.addLegendFontChangeListeners(this,function(){if(AH.eventFromEdtModel){return ;}AB();});return AH;}function V(AB){var AC=this;return M.call(this,new mstrmojo.ui.editors.controls.CharacterGroup(Q.copy({onGroupValueChange:function(AF,AH,AE){if(Q.equals(AH,AE)){return ;}if(AF!==L.LEGEND_FONT_STYLE){AF=z[AF];}if(AF===L.LEGEND_FONT_COLOR){AH=d.encodeColor(AH);}var AG=AC.getHost(),AD=AG.observableModel[AF];if(AD){this.eventFromEdtModel=true;AD.setValue(AH);this.eventFromEdtModel=false;}},onFmtPropsChangedDefault:mstrmojo.emptyFn},AB)));}function w(){var AF="layout",AE=E.call(this)[AF],AB={isHostedWithin:false},AC=[{n:mstrmojo.desc(13758,"Keep readability"),displayName:mstrmojo.desc(12124,"Keep readability, not element order"),id:0},{n:mstrmojo.desc(13759,"Balance"),displayName:mstrmojo.desc(13760,"Balance readability and element order"),id:1},{n:mstrmojo.desc(13761,"Keep element order"),displayName:mstrmojo.desc(12126,"Keep element order, not readability"),id:2}],AD=P.call(this,AC,AE,null,l.call(this,AF),AB);AD.list.getItemDisplayName=function(AG){return AG.displayName;};return AD;}function u(){var AH="isHeaderOnTop",AE=E.call(this)[AH],AF=l.call(this,AH),AG=this.getHost(),AB=AG&&AG.model.docModel;var AC=[{n:mstrmojo.desc(13605,"On top"),id:true},{n:mstrmojo.desc(13604,"In center"),id:false}];var AD=mstrmojo.desc(13602,"Headers:");return P.call(this,AC,AE?0:1,AD,function(AJ,AI){AF(AJ,AI);if(AB){AB.selectVIUnit(AG.parent.id,true);}});}function Y(){var AE="labelSize",AC=E.call(this)[AE],AD=this;var AB=0;if(AC===f.Off){AB=1;}else{if(AC===f.Proportional){AB=2;}}return P.call(this,[{n:mstrmojo.desc(6030,"On"),id:"On"},{n:mstrmojo.desc(6031,"Off"),id:"Off"},{n:mstrmojo.desc(11990,"Proportional"),id:"Proportional"}],AB,mstrmojo.desc(13603,"Labels:"),v.composite([l.call(this,AE),function(AG){AD._showMetricValuesController.set("enabled",AG!=="Off");var AF=AD.getHost();if(AF){AF.triggerFontScaleChangeEvent();}}]));}function C(){var AC=E.call(this);var AB=mstrmojo.desc(12122,"Show metric values");var AE="showMetricValues";var AD=AA.call(this,AC[AE],AB,l.call(this,AE));AD.enabled=AC.labelSize!==f.Off;this._showMetricValuesController=AD;return AD;}function a(){function AN(AS,AR){function AT(){if(AR===undefined){AR=0;}else{AH=AR;}var AV=AQ[AR];this.setChildValue(AL,AV.color);this.setChildValue(AE,AV.opacity);var AU=AF().some(function(AW){return x.isColorManuallySet(AO,AQ[AW].comb);});x.setColorPickerShowAutomatic(this,AU);}if(AS){this.syncControls(AT);}else{AT.call(this);}}function AM(AR){return(AR||[]).map(function(AS){AS=Q.clone(AS);return x.findInArray(AQ,function(AT){return d.isEqualComb(AS,Q.clone(AT.comb));});}).filter(function(AS){return AS!==-1;});}function AF(){return[].concat(AH===0?AJ:AH);}var AO=this.getHost(),AQ=AO.getColorByElements(),AP=AM(AO&&AO.edtModelCbInitSelection),AH,AL="ShapeClr",AE="ShapeFillTrans",AK=e.VAL_AUTOMATIC,AB=AQ.map(function(AS,AR){return{n:AS.text,title:AS.text,v:AR};}),AJ=x.range(1,AB.length),AD=false,AI=mstrmojo.desc(12092,"Multiple Elements"),AC,AG;if(AP.length===0){AH=0;}else{if(AP.length===1){AH=AP[0];}else{AH=AP;AD=true;}}AG=new mstrmojo.ui.editors.controls.FillConfigGroup({onGroupValueChange:function(AX,AW){var AV=[],AT=[],AR=AX===AL,AS=AX===AE,AU=AF();AU.forEach(function(AY){var Ab=AQ[AY],Aa=Ab.comb,AZ;AT.push(Aa);if(AR){if(AW===AK){AV.push("default");AZ=AO.listenToUpdateColorMap(function(){var Ad=AT.length,Ac;AU.forEach(function(Ae){var Af=AQ[Ae];Ac=d.decodeColor(x.getCombColor(AO,Af.comb));Af.color=Ac;});if(Ad>1){Ac=AQ[0].color;}AG.syncControls(function(){this.setChildValue(AL,Ac);x.setColorPickerShowAutomatic(AG,false);});AO.detachUpdateColorMapListener(AZ);});}else{AV.push(d.encodeColor(AW));Ab.color=AW;}}else{if(AS){AV.push(AW);Ab.opacity=AW;}}});if(AR){AO.updateColorMap(AT,AV);x.setColorPickerShowAutomatic(this,true);}if(AS){AO.updateColorByOpacity(AT,AV);}}});if(AG){AG.iniChildrenComp([AL,AE]);AN.call(AG,true,AD?undefined:AH);}AC=this.getPulldown(AB,AN.bind(AG,true),AD?undefined:AH,{setDisplayText:function(AR){var AS=this.selectedNode;if(AS){AS.innerHTML=AR;AS.title=AR;}}});if(AD){AC.attachEventListener("renderComplete",AC.id,function(){AC.setDisplayText(AI);});}W.call(this,T,"shapeColor",function(AR){var AT=AM(AR.colorbyElements),AS=AT.length;if(AS<1){return ;}if(AT.length===1){AC.set("selectedIndex",AT[0]);}else{AC.setDisplayText(AI);AH=AT;AN.call(AG,true);}});W.call(this,o,"fill",function(AR){AG.syncControls(function(){AG.setChildValue(AL,AR.fill);x.setColorPickerShowAutomatic(AG,AR.showAutomatic);});});W.call(this,o,"opacity",function(AR){AG.syncControls(function(){AG.setChildValue(AE,AR.opacity);});});W.call(this,o,"invalidateCache",function(){AQ.forEach(function(AS,AR){if(AR===0){return ;}AS.color=d.decodeColor(x.getCombColor(AO,AS.comb));});});return this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(13753,"Shape Color")),AC,AG]);}function h(){function AF(){if(AB){AB.syncControls(function(){var AJ=x.getPropertyByPath(AE,"observableModel.colorByOpacity"),AK=AJ!==undefined?AJ.getValue():1,AI=AK*100;this.setChildValue(AG,AI.toString());});}}var AE=this.getHost();var AG="ShapeFillTrans";var AB,AC;var AH=new mstrmojo.Label({text:mstrmojo.desc(14110,"Select Color Ranges..."),cssText:"text-decoration: underline; cursor: pointer; padding-top: 2px; padding-bottom: 2px;",onclick:function(){AE.model.openThresholdEditor(x.getMetricsInDropZone(AE.zonesModel,t.ColorBy)[0],true,false);}});var AD=this.getLabelAndControl(mstrmojo.desc(13658,"Fill Opacity"),new mstrmojo.ui.editors.controls.FillConfigGroup({visibleControls:G.FILL_TRANSPARENCY,onGroupValueChange:function(AK,AJ){if(AK===AG){var AI=x.getPropertyByPath(AE,"observableModel.colorByOpacity");if(AI){AI.setValue(AJ/100);}}}}));if(AD){AB=AD.getCtrl();AB.iniChildrenComp([AG]);AF();AC=x.getPropertyByPath(AE,"observableModel.colorByOpacity");if(AC){AC.attachEventListener("valueChanged",AE.id,AF);}}return this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(13753,"Shape Color")),AH,AD]);}function J(){var AD=this.getHost(),AC=E.call(this),AB=AD.levelAttributes;if(AD&&AC.isHeaderOnTop&&AB&&AB.length>1){var AE=A.call(this,undefined,AD.observableModel.headerColors,"headerColor");AE.unshift(this.getGroupTitle(mstrmojo.desc(14115,"Header Fill:")));return this.getEditorGroup(AE);}}function R(AF){var AJ=this.getHost(),AE=AJ.observableModel,AI=AJ.getPropsInfo().colorByType,AB,AH;if(!AE){return ;}var AG=AE&&AE.fonts,AC=AG&&(AJ.props&&AJ.props.isHeaderOnTop?AG.headerOnTop:AG.headerOnMiddle),AD=[this.getGroupTitle(mstrmojo.desc(3544,"Text"))];if(AC){AD=AD.concat(S.call(this,AC));}AB=[this.getEditorGroup([Z.call(this,mstrmojo.desc(7195,"Layout:")),w.call(this),u.call(this),Y.call(this),C.call(this)]),this.getEditorGroup(AD),J.call(this),this.getEditorGroup([this.getMoreOptionsEditorLink((AJ.modelData&&AJ.modelData.gsi&&AJ.modelData.gsi.prop)||{})])];if(AI==="attribute"){AH=a.call(this);}else{if(AI==="metric"&&x.getMetricsInDropZone(AJ.zonesModel,t.ColorBy)[0]!==undefined){AH=h.call(this);}}if(AH){AB.splice(1,0,AH);}this.replaceChildControls(AF,AB);}function B(AD,AC){var AB=!!(AD&&AD.getValue()),AF=AA.call(this,AB,mstrmojo.desc(13600,"Show legend"),function(AG){x.toggleControlEnabled(AC,AG);if(AD){AD.setValue(AG);}}),AE=AF.getCtrl();if(AD){AD.attachEventListener("valueChanged",this.id,function(AG){var AH=AG.newValue;if(AE.checked!==AH){AE.set("checked",AH);}});}return AF;}function X(AG){var AF=this.getHost().observableModel,AD=AF&&AF.showLegend,AC=!!(AD&&AD.getValue()),AB=[V.call(this,{controlName:"LegendTextFontGroup"})],AE;AB=AB.concat(A.call(this,mstrmojo.desc(13601,"Fill:"),AF.legendBackground,"legendBackground"));AE=AB.slice();AB.unshift(B.call(this,AD,AE));this.replaceChildControls(AG,[this.getEditorGroup(AB)]);x.toggleControlEnabled(AE,AC);}function W(AB,AF,AE,AD){var AC=this[AB];if(AC===undefined){this[AB]={};AC=this[AB];}AC[AF]={fn:AE,context:AD};}function F(AB){var AC=this;return function(AD){var AE=AC[AB]||{},AG=AD.type==="*"?Object.keys(AE):[].concat(AD.type),AF;AG.forEach(function(AH){if(AE.hasOwnProperty(AH)){AF=AE[AH];AF.fn.call(AC,AD,AF.context);}});};}mstrmojo.vi.models.editors.HeatMapEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.HeatMapEditorModel",help:"dashboard_editor_heat_map_html5_properties.htm",init:function(AC){if(this._super){this._super(AC);}var AD=this.getHost();if(!AD){return ;}var AB=F.bind(this);AD.attachEventListener("selectionChange",this.id,AB(T));AD.attachEventListener("colorByColorChange",this.id,AB(o));AD.attachEventListener("fontScaleChange",this.id,AB(n));},getInitialTarget:function r(){return I;},getTargetPulldownItems:function q(AB){var AD=this.getHost(),AC=this._super(AB),AE=function(AF){return AF.bind(this,AB);}.bind(this);if(!AD.isEmpty()&&AD.highlightCanvas){AC.push({n:mstrmojo.desc(11974,"Data Exploration"),v:I,h:AE(R)});AC.push(AC.shift());if(AD.hasSizebyOrColorby()){AC.push({n:mstrmojo.desc(2403,"Legend"),v:m,h:AE(X)});}}return AC;},onBEMFormatChange:function g(AB){if(!AB.isTitle&&AB.propertyName===c.BACKGROUND_COLOR){var AD=this.getHost()||{},AC=AD.observableModel;if(AC){AC.background.value.setValue(AB.value);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.gm.GMEnums","mstrmojo.gm.GMUtility","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.util.ThresholdUtils");mstrmojo.requiresClsP("mstrmojo.vi.ui","SubtotalsWidget","DatasetUnitMenuUtils");mstrmojo.requiresClsP("mstrmojo.vi.models","DropZonesModel","EnumDragSources","_DropZoneCommon");mstrmojo.requiresDescs(101,122,144,190,1018,2453,2968,3582,7974,7975,7976,7978,7979,11099,11699,12143,12144,12145,12146,12147);var m=mstrmojo,n=m.array,O=m.hash,AI=m.func,AF=mstrmojo.gm,F=AF.GMUtility,AN=AF.EnumABLDirection,V=mstrmojo.vi.models.DropZonesModel.ENUM_TARGET_POSITION,S=mstrmojo.vi.models.EnumDragSources,U=mstrmojo.vi.viz.EnumDSSDropZones,J=mstrmojo.vi.util.ThresholdUtils,z=mstrmojo.vi.ui.DatasetUnitMenuUtils,AL=3,h=AF.WidgetPropertyTag,t=AF.EnumShape,L=U.Rows,AD=U.Columns,u=U.XAxis,X=U.YAxis,G=U.BreakBy,b=U.SliceBy,g=U.ColorBy,Q=U.SizeBy,I=U.AdditionalMetrics,q=U.Angle,Z=1,M=AF.DualAxisSubAxisBit,T="00000000000000000000000000000000",a=0,AE={n:"Metric Names",did:T,t:a},e=3,d=-20;function c(AO){return(AO===L||AO===AD||AO===X||AO===u||AO===G||AO===b);}function C(AO){return AO===X||AO===u;}function N(AP,AQ){var AR=[];function AO(AS){return !!(AS[0]===d&&AS[1]===d);}n.forEach(AP,function(AS){if(AS[0]===AQ){AS[0]=d;}if(AS[1]===AQ){AS[1]=d;}if(!AO(AS)){AR.push(AS);}});return AR;}function AH(AP,AT,AS){var AQ=false,AR=[d,d],AO=AS?0:1;n.forEach(AP,function(AU){if(!AQ&&AU[AO]===d){AQ=true;AU[AO]=AT;}});if(AQ){return AP;}AR[AO]=AT;AP.push(AR);return AP;}function D(AS,AR,Ab,Aa){var AW=AS.tgtData,AU=AW.edge,AP=AW&&AW.tgtInfo,Ad=AP&&(parseInt(AP.axisIndex,10)+(AU===V.BELOW?1:0)),AV=Aa?0:1,AQ=AU===V.ABOVE||AU===V.BELOW,Ac,AO,AT,AY,AZ,AX;for(AZ=0;AZ<AR.length;AZ++){AY=AR[AZ];for(AX=0;AX<AY.length;AX++){if(AY[AX]===Ab){if(AY[1-AX]===d&&(Ad!==AZ||AQ)){AR.splice(AZ,1);if(AZ<Ad){Ad--;}}else{AY[AX]=d;}}}}if(Ad>AR.length){Ad=AR.length;}if(AU===AL&&Ad<AR.length&&AR[Ad][AV]===d){AR[Ad][AV]=Ab;}else{if(AU===V.ON){AR[Ad][AV]=Ab;}else{Ac=AR.slice(0,Ad);AO=AR.slice(Ad);AT=[d,d];AT[AV]=Ab;AR=Ac.concat([AT],AO);}}return AR;}mstrmojo.vi.models.XtabDropZonesMenuContextType=null;function f(){return mstrmojo.all[this.hostId];}function AC(){var AO=f.call(this);return AO.getHostStructure();}function Y(AO){return AI.wrapMethods(AO.controller._getXtabCallback(AO),{success:function(){AO.resetXMLDirtyFlag();}});}function AB(){var Aa=f.call(this),AX=this.getZoneModelByZoneId(L),AT=this.getZoneModelByZoneId(AD),AQ=this.getZoneModelByZoneId(X),AS=this.getZoneModelByZoneId(u),AR=[],AO=Aa.GMController.getChartInfo(),AP=[],AZ=[];if(AO.isBubbleOrScatter){AP=Aa.copyTrendLineInfoForSwap(AQ,AS);}if(AO.isABL){AZ=Aa.copyRefLineInfoForSwap();}AR=AR.concat(this.getSwapDZUnitActions(AX,AT));AR=AR.concat(this.getSwapDZUnitActions(AQ,AS));var AY=this.docModel.getDataService(),AV=Aa.k,AW=Y(Aa),AU=[AY.getUpdateTemplateAction(AV,AR)].concat(AP).concat(AZ);if(Aa.isXMLDirty()){AU.push(Aa.getPersistAction());}Aa.controller.submitUndoRedoUpdates(AU,null,AW);}function AA(AO,AT){var AQ,AR=this,AS=[],AP=[];AQ=this.getZoneModelByZoneId(AO);n.forEach(AQ.items,function(AU){if(AU.t===12){AP.push(AU);AS.push(AR.getRemoveDropZoneUnitAction(AQ,AU,AT));}});return{actions:AS,removedItems:AP};}function v(AO,AR){var AQ=[],AT=this,AP=this.getZoneModelByZoneId(AO),AS=this.getItemCountInZone(AO);n.forEach(AR,function(AU){AQ.push(AT.getAddDropZoneUnitAction(AP,AU,AS++));});return{actions:AQ};}function x(AO,AT){var AR=[],AS=this,AP=this.getZoneModelByZoneId(AO),AQ=AP.items;n.forEach(AT,function(AV){var AU=n.find(AQ,"did",AV.did);if(AU!==-1&&c(AV.zone)){AR.push(AS.getAddDropZoneUnitAction(AP,AV,AU));}});return{actions:AR};}function AK(AO,AP){var AQ=AO.id;if((AQ===u||AQ===X)&&this.isMetric(AP)){return true;}return false;}function AJ(AO,AR,AQ){var AT="0",AP=AR.item,AS=AR.idx;if(AQ){AT="1";}return function(){var AY=this.getAddDropZoneUnitAction(AO,AP,AS,{isPrimary:AP.ax===0});AY.condense=AT;var AX=f.call(this),Ab=AX.id,Aa=AX.getDocModel().getDataService(),AU=AX.k,AV=Aa.getUpdateTemplateAction(AU,AY);var AW=function(Ag){var Ae=m.all[Ab],Af=Ae.model.data,Ac=Af.dz,Ad=[Ac.AngleBy,Ac.Rows,Ac.YAxis,Ac.Columns,Ac.XAxis,Ac.ColorBy,Ac.SizeBy,Ac.AdditionalMetrics],Ah=Ae.parent.getZonesModel&&Ae.parent.getZonesModel().getUpdateCallback();n.forEach(Ad,function(Ai){if(Ai&&Ai.TemplateMetric){n.forEach(Ai.TemplateMetric,function(Aj){if(Aj.id===AP.id){Aj.cds=Ag;return false;}});}});Ae.clientRerenderGraphMatrix();if(Ah&&Ah.success){Ah.success();}};var AZ={undo:function(){AW(!AQ);},redo:function(){AW(AQ);}};AW(AQ);AX.submitUpdatesAndPersistXML([AV],undefined,AZ,true);};}mstrmojo.vi.models.GMDropZones=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.GMDropZones",dropZones:[],getHostStructure:function AC(){var AO=f.call(this);return AO.getHostStructure();},isZonesEmptyAfterDelItem:function R(AP){var AQ={},AR=this.getHostStructure(),AO=AP.zone;AQ[L]=AR.Rows.length;AQ[AD]=AR.Columns.length;AQ[u]=AR.XAxis.length;AQ[X]=AR.YAxis.length;AQ[Q]=AR.SizeBy.length;AQ[G]=AR.BreakBy.length;AQ[q]=AR.AngleBy.length;AQ[I]=this.getItemCountInZone(I);AQ[AO]--;if(AQ[L]>0||AQ[AD]>0||AQ[u]>0||AQ[X]>0||AQ[Q]>0||AQ[q]>0||AQ[I]>0){return false;}return true;},getAutoSubtypeControl:function(AQ){var AX,AT,AW,AS,AV;var AU=mstrmojo.gm.EnumSubtype,AP=mstrmojo.gm.WidgetPropertyTag.SUB_TYPE,AO=f.call(this),AR=AO.GMController.chartSubType,AY=AO.readGlobalProperty(AP);AT={scriptClass:"mstrmojo.ui.Checkbox",enabled:!AQ,alias:"AutoSubType",checked:AY===AU.AUTO,oncheckedChange:function(AZ){if(AZ.value){AO.writeGlobalProperty(AP,AU.AUTO);}else{AO.writeGlobalProperty(AP,AR);}}};AW={scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12135,"Automatic subtype"),setDimensions:function(Ab,AZ){var Aa=this.domNode;if(Aa){Aa.style.width=AZ;}}};AT.slot="col1Node";AW.slot="col2Node";AX={scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",col1Width:AS||"20%",col2Width:AV||"80%",children:[AT,AW]};return AX;},getSubtypeButtonBar:function B(AS,AP,AW){var AR=[null,{id:12143,desc:"Automatic"},{id:12144,desc:"Absolute"},{id:12145,desc:"Stacked"},{id:12146,desc:"Clustered"},{id:12147,desc:"Percent"}],AY=mstrmojo.gm.EnumSubtype,AV=mstrmojo.gm.WidgetPropertyTag.SUB_TYPE,AU=f.call(this),Aa=AU.GMController.chartSubType,AQ=AU.getChartInfo();function AZ(Ad){var Ab=[],Ac;if(Ad.shape===t.BAR){Ac=[AY.CLUSTERED,AY.STACKED,AY.PERCENT];}else{Ac=[AY.ABSOLUTE,AY.STACKED,AY.PERCENT];}if(!Ad.isCombo){Ac.forEach(function(Ae){Ab.push({n:AR[Ae]?mstrmojo.desc(AR[Ae].id,AR[Ae].desc):null,id:Ae});});}else{Ac.forEach(function(Ae){Ab.push({n:(Ae===AY.CLUSTERED)?mstrmojo.desc(AR[AY.ABSOLUTE].id,AR[AY.ABSOLUTE].desc):(AR[Ae]?mstrmojo.desc(AR[Ae].id,AR[Ae].desc):null),id:Ae});});}return Ab;}function AO(Ad){var Ac=-1,Ab=0;Ad.forEach(function(Ae){if(Ae.id===Aa){Ac=Ab;}Ab++;});return Ac;}function AT(Ac,Ab){if(Ab!==Ac&&(Ab===AY.PERCENT||Ac===AY.PERCENT)){AU.abandonCustomAxisScale();AU.resetAxisOrigin();}AU.writeGlobalProperty(AV,Ac);}var AX={scriptClass:"mstrmojo.ui.ButtonBar",n:"Subtype",selectedIndex:-1,enabled:!AW,showIcon:false,alias:"SubtypeBB",postselectionChange:function(Ab){AT(Ab.src.items[Ab.added[0]].id,Ab.src.items[Ab.removed[0]].id);}};AX.items=AZ(AQ);AX.selectedIndex=AO(AX.items,Aa);return AX;},getDropZones:function(){var AP=AC.call(this),AS=f.call(this),AR=AS.GMController,AQ=AR.isPie,AO=[this.getZone(mstrmojo.desc(14294,"Angle"),q,AP.AngleBy),this.getZone(mstrmojo.desc(6188,"Slice"),b,AP.SliceBy),this.getZone(mstrmojo.desc(2968,"Rows"),L,AP.Rows),this.getZone(mstrmojo.desc(122,"Columns"),AD,AP.Columns),this.getZone(mstrmojo.desc(12086,"XAxis"),u,AP.XAxis),this.getZone(mstrmojo.desc(12088,"YAxis"),X,AP.YAxis),this.getZone(mstrmojo.desc(11662,"Color By"),g,AP.ColorBy)];var AT=this.getZone(mstrmojo.desc(12173,"Break By"),G,AP.BreakBy);if(AS.getChartInfo().isABL){AT.siblings=[this.getSubtypeButtonBar("Subtype",[],false),this.getAutoSubtypeControl(false)];}AO.push(AT);AO.push(this.getZone(mstrmojo.desc(12090,"Size By"),Q,AP.SizeBy));AO.push(this.getZone(mstrmojo.desc(2962,"Tooltip"),I,AP.AdditionalMetrics));if(!AQ){AO=AO.slice(2);}else{AO.splice(1,0,AO.splice(6,1)[0]);}this.dropZones=AO;this.updateBreakByAndSliceUnits();return{n:f.call(this).defn.ttl,zones:AO};},updateMetricNameUnit:function(){var AQ,AS,AT,AV=f.call(this),AO=O.clone(AE),AU=this.shouldShowMetricNames(),AW=this.hGetItemOccurrence(AO),AR=AW.length,AP=[];if(AU&&AR===0){AT=this.getZoneModelByZoneId(L);AO.zone=L;AP.push(this.getAddDropZoneUnitAction(AT,AO,AT.items.length));AT.items.push(AO);}if(!AU&&AR>0){for(AQ=0;AQ<AR;AQ++){AT=this.getZoneModelByZoneId(AW[AQ].zoneId);AS=AW[AQ].itemIndex;AP.push(this.getRemoveDropZoneUnitAction(AT,AT.items[AS]));AT.items.splice(AS,1);}}if(AP.length>0){this.submitUpdatesAndPersistWidgetXMLIfNecessary(AV,AP,mstrmojo.emptyFn);}},shouldShowMetricNames:function(){var AP=this;if(AP.getMetricCntInZone(u)>Z){return true;}if(AP.getMetricCntInZone(X)>Z){return true;}var AO=AP.getZoneModelByZoneId(q)!==undefined;if(AO&&AP.getMetricCntInZone(q)>Z){return true;}return false;},hHasMetricInZone:function(AO){var AR,AP=false,AQ=this.getZoneModelByZoneId(AO).items,AS=AQ.length;for(AR=0;AR<AS;AR++){if(AQ[AR].t===4){AP=true;break;}}return AP;},canSwapAxis:function w(){return true;},swapAxis:function A(){var AO=f.call(this);AO.clearChartScale();AB.call(this);},shouldShowCondensedMenu:function(AO,AP){return AK.call(this,AO,AP);},getCondenseLableHandler:function(AO,AQ,AP){return AJ(AO,AQ,AP);},getUnitMenuItems:function o(AV,Al,Ak,AP){if(!Ak){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var Ao=this,Af=mstrmojo.all[this.hostId].zonesModel.id,AO=f.call(this),Ae=AO,Am=AO.GMController,Aa=Am.getChartInfo(),Ad=Al.items,Ah=Ad.length,AQ=Al.id,AW={zone:Al,axis:AQ,idx:n.find(Ad,"id",Ak.id),cnt:Ah,item:Ak,metricsAxis:AC.call(this).tma,useDropzone:true},AS;function Ag(Aq,Ar){if(Ar.axis===L||Ar.axis===AD){}}if(this.isMetricName(Ak)){if(Al.id===g){AV.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[Af].deleteItem(Al,AW.idx);});return ;}return ;}var AR=Am.attributeSelectionInfo;if(this.isNewDerivedElement(Ak)){AV.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"eg",this.getCreateOrEditElementGroupFunc(AW));if(AQ===L||AQ===AD||AQ===u||AQ===X){AV.addSeparator();AS=AR&&AR[Ak.id];AV.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",AO.getMenuHandler("sortAttributeTitle"),{isAsc:true,selInfo:AS});AV.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",AO.getMenuHandler("sortAttributeTitle"),{isAsc:false,selInfo:AS});if(Am.firstRes.gsi.sorts[0].length!==0||Am.firstRes.gsi.sorts[1].length!==0){AV.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"xt",AO.getMenuHandler("clearSort"));}AV.addSeparator();}}else{if(this.isConsolidation(Ak)){if(AQ===L||AQ===AD||AQ===u||AQ===X){AV.addSeparator();AS=AR&&AR[Ak.id];AV.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",AO.getMenuHandler("sortAttributeTitle"),{isAsc:true,selInfo:AS});AV.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",AO.getMenuHandler("sortAttributeTitle"),{isAsc:false,selInfo:AS});if(Am.firstRes.gsi.sorts[0].length!==0||Am.firstRes.gsi.sorts[1].length!==0){AV.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"xt",AO.getMenuHandler("clearSort"));}AV.addSeparator();}}else{if(this.isMetric(Ak)){if(Ak.um){AV.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){Ao.editDerivedMetric(AW,"edit");},AW);AV.addSeparator();}if(Aa.isABL&&(AQ===X||AQ===u)){var Ai=Am.metricSelectionInfo;AS=Ai&&Ai[Ak.id];AV.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",AO.getMenuHandler("sortMetricTitle"),{isAsc:true,selInfo:AS});AV.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",AO.getMenuHandler("sortMetricTitle"),{isAsc:false,selInfo:AS});Ag(AV,AW);if(Am.firstRes.gsi.sorts[1].length!==0||Am.firstRes.gsi.sorts[0].length!==0){AV.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"xt",AO.getMenuHandler("clearSort"));}}AV.addSeparator();if(this.docModel.findDatasetIdFromUnit(Ak.did)&&!this.docModel.isFromSolrCube(Ak.did)&&!this.docModel.isFromMDXCube(Ak.did)){AV.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",Af,Ao.getAggregateByMetricSubMenu,AW);AV.addSeparator();}AV.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),Af,Ao.getCalculationEditorCfg,AW);if(Am.getChartInfo().isABL){AV.addSubMenuItem(mstrmojo.desc(12287,"Shortcut Metric"),"",Af,Ao.getShortcutMetricSubMenu,AW);}AV.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){Ao.newDerivedMetric(AW);},AW);AV.addSeparator();if(AK.call(this,Al,Ak)){var Aj=Ak.cds;var Ac=AJ.call(this,Al,AW,true),Ab=AJ.call(this,Al,AW,false);AV.addToggleMenuItem(mstrmojo.desc(14324,"Condense Axis Labels"),"",Ac,Ab,this.id,Aj);}AV.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),Af,this.getNumberFormatEditorCfg,AW);if(Al.id===g){this.buildThresholdMenuOptions(AV,AW,true);}AV.addSeparator();if(Aa.isABL&&(Al.id===u||Al.id===X)&&!Aa.isPie){F.getSubMenu(Ae,AV,Ak.id,Ak.idx);}AV.addSeparator();if(AQ===u||AQ===X){if((Aa.isBubbleOrScatter&&AQ===X)||Aa.isABL){if(F.isTrendLineAvailableForMetric(AO,Ak.idx)){AV.addToggleMenuItem(mstrmojo.desc(12155,"Enable trendline for ##").replace("##",Ak.n),"xt",F.getTrendLineToggleHandler(AO,Ak.id,true),F.getTrendLineToggleHandler(AO,Ak.id,false),Af,F.getTrendLineToggleState(AO,Ak.id));if(F.getTrendLineToggleState(AO,Ak.id)){AV.addMenuItem(mstrmojo.desc(12163,"Edit trendline..."),"xt",F.getEditTrendLineHandler(AO,Ak.id));}}}}var An=Am.getMetricsOnXAxis().concat(Am.getMetricsOnYAxis()),AU=Am.model&&Am.model.getMetricIDsFromIndex(An),Ap=false;if(Ak.id){if(AU&&AU.indexOf(Ak.id)>=0){Ap=true;}}var AT=false;if(Am.isStacked&&!Am.splitPlottingMetrics){AT=true;}else{if(!Ap){AT=true;}}AT=AT||F.isIgnoredMetric(Ae,Ak.idx);if(!AT){F.getReferenceLineSubMenu(Ae,AV,Aa.isABL,Ak.id);}AV.addSeparator();}else{if(this.isAttrCategory(Ak)){var AZ=Ak.did||"",AY=AZ?z.getDatasetFromAttributeId(this.docModel.datasets,AZ):null,AX=!AY||!this.docModel.isMDXDataset(AY);if(Ak.da&&AX){AV.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){Ao.editDerivedAttribute(AW);},AW);AV.addSeparator();}if(AQ===L||AQ===AD||AQ===u||AQ===X){AS=AR&&AR[Ak.id];AV.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",AO.getMenuHandler("sortAttributeTitle"),{isAsc:true,selInfo:AS});AV.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",AO.getMenuHandler("sortAttributeTitle"),{isAsc:false,selInfo:AS});Ag(AV,AW);if(Am.firstRes.gsi.sorts[0].length!==0||Am.firstRes.gsi.sorts[1].length!==0){AV.addMenuItem(mstrmojo.desc(11699,"Clear Sort"),"xt",AO.getMenuHandler("clearSort"));}AV.addSeparator();}if(!this.isDynamicLink(Ak)){if(this.allowInsertNewAttribute(Al)&&((!AY)||!z.hasCGorCon(AY))&&AX){AV.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){Ao.newDerivedAttribute(AW);},AW);}if(!z.hasOldDEOverDatasets(Ak.did,this.docModel.datasets)&&!this.isRecursiveAttribute(Ak)){AV.addMenuItem(mstrmojo.desc(13295,"Create Groups..."),"eg",this.getCreateOrEditElementGroupFunc(AW));}AV.addSeparator();}if(this.showNumberFormat(Ak)){AV.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),Af,this.getNumberFormatEditorCfg,AW);}if(this.shouldShowDisplayFormsMenu(Ak)){AV.addEditorMenuItem(mstrmojo.desc(11908,"Display Attribute Forms"),Af,function(){return Ao.getDisplayFormsMenu(Ak);});}}}}}AV.addSeparator();if(Ao.hasReplaceCandidates(AW)){AV.addSubMenuItem(mstrmojo.desc(14003,"Replace with"),"",Af,Ao.getReplaceSubMenu,AW);}AV.addMenuItem(mstrmojo.desc(1388,"Rename"),"xt",function(){Ao.renameItem(AP,Ak);});AV.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){Ao.deleteItem(Al,AW.idx);});},isGraphDroppingAllowed:function P(AS,AO,AW){var AP=AS.id,AT=true,AV=f.call(this).GMController,AR=AV.isBubbleOrScatter();var AU=this.isMetric(AW),AQ=this.isMetricName(AW);switch(AP){case L:case AD:if(AU){AT=false;}break;case u:case X:if(!AR&&AQ&&this.hHasMetricInZone(AP)){AT=false;}break;default:break;}return AT;},allowDropOnTarget:function E(AP,AQ){var AO=true;if(AP===S.DATASETS&&this.isMetricName(AQ.item)){AO&=(AQ.srcZoneId===g);}return AO;},allowMoveMetricName:function H(AO,AP){if(this.isDualAxis(X)&&AO===AD&&AP===u){return false;}else{if(this.isDualAxis(u)&&AO===L&&AP===X){return false;}}return true;},isItemDropAllowed:function l(AZ,AW,Ac,AP,AR){var AO;if(AP&&AP.src){AO=AP.src.data.src;}var AU,AT=AZ.id,AQ=this.getItemCountInZone(AT),Ab=f.call(this).GMController,AX=Ab.isBubbleOrScatter(),AY=Ab.isGrid()&&!Ab.isEmptyVis(),Aa=this.isMetric(AW),AS=this.isAttrCategory(AW),AV=this.isMetricName(AW);if(AR===V.BELOW||AR===AL){AR=V.ABOVE;Ac++;}if(AR===V.ON){AU=AZ.items[Ac];if(this.isMetricName(AU)&&AZ.id!==g){return false;}}if(AW===AZ.items[Ac]){return false;}switch(AT){case L:case AD:if(Aa){return false;}if(AV&&(Ac<AQ||!this.allowMoveMetricName(AZ.id,AW.zone))){return false;}break;case u:case X:if(AV){if(AX){if(AR===V.ON&&this.isMetric(AU)){return false;}if(this.isMetricZone(AT)&&Ac<AQ){return true;}}else{if(this.hHasMetricInZone(AT)||AR===V.ON){return false;}}}break;case Q:if(AS||AV){return false;}if(Aa){if(AQ>0&&!AX&&AR!==V.ON){if(this.getUnitIndexInZone(AZ,AW)===-1){return false;}}}break;case G:if(AY||Aa){return false;}break;case b:if(Aa){return false;}break;case q:if(Aa){return true;}else{return false;}break;case I:if(AS){return false;}if(AV){return false;}break;default:break;}return true;},changeToDualAxis:function r(AO){var AP=0,AQ=0;n.forEach(AO.items,function(AR){if(AR.ax===0){AP++;}else{if(AR.ax===1){AQ++;}}});return AP>0&&AQ>0;},getActionsOnUnitDropped:function(As,Ac,BF,BA,Aa,AQ,AZ,BG){var Af=this,A5,A2,Ah,AY=false,Ak=Af.getZoneModelByZoneId(G),Aj=Af.getZoneModelByZoneId(I),AV=f.call(Af),Ay=AV.GMController,BC=Ay.getChartInfo(),A4=Af.getUnitIndexInZone(Ac,As),AT=Af.getUnitIndexInZone(Aj,As),AX=Ac.id,Ab=Ac.items,Aw=[],Ag={},AW={},Ai,AP=Af.isAttrCategory(As),AS=Af.isMetricName(As),Ar,A0,A6,A3,BB=BF.src.data.src,A9=Af.isDualAxis(Ac.id),A7=Af.isMetricZone(AX),Ae=function(){if(AX===g){if(c(As.zone)&&AP){var BI=Af.getZoneModelByZoneId(As.zone),BH=Af.getUnitIndexInZone(BI,As);BI.items.splice(BH,1);}Ah=Af.hGetItemOccurrence(As,[L,AD,u,X,G,b]);if(Ah.length===0&&!Af.isMetric(As)){Aw.push(Af.getAddDropZoneUnitAction(Af.getZoneModelByZoneId(BC.isPie?b:(Ay.isGrid()?u:G)),As,0));}}else{if((As.zone===g)&&c(AX)){Aw.push(Af.getRemoveDropZoneUnitAction(Af.getZoneModelByZoneId(g),As,1));}else{if(AX===G||AX===b){if(c(As.zone)||BB!==S.VIZ_EDITOR){Aw.push(Af.getRemoveDropZoneUnitAction(Af.getZoneModelByZoneId(g),As,1));}}}}};AQ=(AQ===undefined?true:AQ);Ag[u]=Af.isMetricZone(u);Ag[X]=Af.isMetricZone(X);AW[u]=Af.getMetricCntInZone(u);AW[X]=Af.getMetricCntInZone(X);Ai=Af.getZoneModelByZoneId(q)!==undefined;if(Ai){Ag[q]=Af.isMetricZone(q);AW[q]=Af.getMetricCntInZone(q);}else{Ag[q]=false;AW[q]=0;}if(Ab.length){if(AX===g&&Aa!==V.ON&&(Af.isMetric(As)||((Af.isAttrCategory(As)||Af.isMetricName(As))&&Af.isOnlyMetricZone(AX)))){Aa=V.ON;}if(C(AX)&&this.differInType(As,Ab[0])){if(AP){Ag[AX]=false;}if(this.isMetric(As)){Ag[AX]=true;}AW[AX]=1;Aw=Aw.concat(this.getClearDZUnitActions(Ac));BA=0;}else{if(Aa===V.ON){A0=Ac.items[BA];A6=(As.did===A0.did);A3=(AX===g);if(Af.getUnitIndexInZone(Ac,As)!==-1&&A0.did!==As.did){AW[AX]--;}if(Af.isMetric(As)&&Af.isMetric(A0)){AQ=A0.ax===0;}if(A3&&((Af.isAttrCategoryZone(g)&&Af.isMetric(As))||(Af.isMetricZone(g)&&AP))){Aw=Aw.concat(Af.getClearDZUnitActions(Ac,false));BA=0;}else{if(!A6){Aw.push(Af.getRemoveDropZoneUnitAction(Ac,A0));if(A4<BA&&A4>=0){BA--;}}}if(A3&&Af.isAttrCategory(A0)&&!A6){this.removeColorByItemFromBreakByIfExists(A0,Aw);}else{Ae();}}else{if(Aa===V.ABOVE&&Af.getUnitIndexInZone(Ac,As)===-1){AW[AX]+=1;if(AW[AX]===1&&As.t===4){Ag[AX]=true;}}else{if((Aa===V.BELOW||Aa===AL)&&Af.getUnitIndexInZone(Ac,As)===-1){AW[AX]+=1;if(AW[AX]===1&&As.t===4){Ag[AX]=true;}if((BA<Ab.length)&&(A4===-1)){BA++;}}}}}}else{AW[AX]+=1;if(AW[AX]===1&&Af.isMetric(As)){Ag[AX]=true;}BA=0;}if(C(AX)&&As.zone===AX&&BC.isBubbleOrScatter&&Ab.length>1){var Av=(As.ax===0);if(Av!==AQ){n.forEach(Ab,function(BH){if(BH.did!==As.did){Aw.push(Af.getAddDropZoneUnitAction(Ac,BH,BA,{isPrimary:AQ}));}});}}if(AX!==I&&AT!==-1){Aw.push(Af.getRemoveDropZoneUnitAction(Aj,Aj.items[AT],1));}if(AX===I){Ah=Af.hGetItemOccurrence(As);for(A5=0,A2=Ah.length;A5<A2;A5++){if(Ah[A5].zoneId!==I){Ar=Af.getZoneModelByZoneId(Ah[A5].zoneId);Aw.push(Af.getRemoveDropZoneUnitAction(Ar,Ar.items[Ah[A5].itemIndex],1));if(AW[Ar.id]){AW[Ar.id]--;}}}}if(!Ag[u]&&!Ag[X]&&Ac.id!==G){Aw=Aw.concat(Af.getClearDZUnitActions(Ak));var Ad=Af.hGetItemOccurrence(AE,[G]);if(Ad){Aw=Aw.concat(Af.getClearDZUnitActions(Ak,false));}}if(AP||AS){if(A4!==-1){if(AX===G||AX===b){if(Ab[A4].hidden){Aw.push(Af.getRemoveDropZoneUnitAction(Af.getZoneModelByZoneId(g),As));}}else{if(AX===g){Ae();}}}else{Ae();}}else{if(this.isMetric(As)){var An=this.hGetItemOccurrence(As,[u,X,q]),Az=([u,X,q,g,Q,I]).filter(function(BH){return BH!==As.zone;}),AR=Af.hGetItemOccurrence(As,Az),AU=AR.length>0?1:0;if((BB===S.VIZ_EDITOR||BB===S.VIZ)&&(As.zone!==AX)){Aw.push(Af.getRemoveDropZoneUnitAction(Af.getZoneModelByZoneId(As.zone),As,1));if(An.length&&AW[An[0].zoneId]&&An[0].zoneId!==AX){AW[An[0].zoneId]--;}}else{if(BB===S.DATASETS&&An.length!==0&&AX!==g&&AX!==Q&&AX!==q&&An[0].zoneId!==AX&&An[0].zoneId!==q){Aw.push(Af.getRemoveDropZoneUnitAction(Af.getZoneModelByZoneId(An[0].zoneId),As,AU));AW[An[0].zoneId]--;}}}}Aw.push(Af.getAddDropZoneUnitAction(Ac,As,BA,{isPrimary:AQ}));if(!BF.metricNamesHandled){if(!this.isMetricName(As)){var Ap=O.clone(AE,[L,AD,u,X]),BE=Af.hGetItemOccurrence(Ap),Aq=BE.length>0,Al=Af.hGetItemOccurrence(AE,[L]),AO=Af.hGetItemOccurrence(AE,[AD]),Ax=Af.hGetItemOccurrence(AE,[u]),Am=Af.hGetItemOccurrence(AE,[X]),Au=Af.hGetItemOccurrence(AE,[L,AD,u,X,G]);if((Ag[u]&&AW[u]>Z)||(Ag[X]&&AW[X]>Z)||(Ag[q]&&AW[q]>Z)){AY=true;}var Ao=Au.length?Au[0].zoneId:L,A8=Af.changeToDualAxis(Ac);if(!Aq&&AX===u){Ao=AD;}if(!Aq&&BF.dndGM&&Af.isMetric(As)&&Aa!==V.ON){if(AZ){if(AX===u){Ao=AD;}else{Ao=L;}}else{if(AX===u){Ao=X;}else{Ao=u;}}}var A1=false;if(Af.isAttrCategory(As)&&AX!==L&&AX!==AD&&AX!==g&&AX!==G&&AX!==b){n.forEach(BE,function(BH){if(BH.zoneId===AX){A1=true;}});if(!A7&&(AX===u||AX===X)){A1=true;}if(AY&&Aq&&!A1){if(Ax.length){Ao=AD;}else{if(Am.length){Ao=L;}}Ac=Af.getZoneModelByZoneId(Ao);Ap.zone=Ao;Aw.push(Af.getAddDropZoneUnitAction(Ac,Ap,Ac.items.length));}}if(!A9&&A8&&(As.zone===u||AX===u)&&Al.length>0){Ao=X;}else{if(!A9&&A8&&(As.zone===X||AX===X)&&AO.length>0){Ao=u;}}if(AY!==Aq||BB===S.VIZ||(Aq&&AZ!==[AD,L].indexOf(BE[0].zoneId)>=0)){Aw=Aw.concat(Af.getUpdateMetricNameUnitActions(AY,Ao));}}}if(As.t===4){var At;if(Ay.shallWeUseGroupInfo){if(Af.isMetricName(As)&&(AX===u||AX===X)){Ay.shallWeUseGroupInfo=false;Ay.removeGroupInfo();}else{At=Ay.getGroupInfo();if((BC.dirc===AN.VERTICAL&&AX===X)||(BC.dirc===AN.HORIZONTAL&&AX===u)){if(Aa===V.ON&&A0!==undefined&&Af.isMetric(A0)){At=Af.replaceItemInGroupInfo(At,As.did,AQ,A0.did);}else{At=Af.fillGroupInfo(BF,At,As.did,AQ);}}Ay.setGroupInfo(At);}}else{if((AQ===false&&Ay.getSplitPlottingMetrics())){Ay.shallWeUseGroupInfo=true;if(BC.isBubbleOrScatter&&AW[X]===0){Ay.horizontalMode=true;}At=Ay.getDummyGroupInfo();At=Af.fillGroupInfo(BF,At,As.did,AQ);}else{if(Af.isMetricName(As)&&(AX===L||AX===AD)&&Ay.getSecondaryMetrics().length>0){Ay.shallWeUseGroupInfo=true;At=Ay.getDummyGroupInfo();}else{if(BG){Ay.shallWeUseGroupInfo=true;At=Ay.getDummyGroupInfo(As.did,AQ,Aa===V.ABOVE);}}}}if(Ay.shallWeUseGroupInfo){AV.setWidgetPropertyValue(h.GROUP_INFO,JSON.stringify(At));}}Af.checkAndAddThresholdAction(AX,As,Aw);var BD=function(BJ){if(!AP){return BJ;}var BI=Af.getZoneModelByZoneId(g),BN=Af.getZoneModelByZoneId(b),BM=Af.getZoneModelByZoneId(G),BP,BK,BL=[],BQ=function(){for(A5=n.find(BI.items,"did",As.did)-1;A5>=0;A5--){BP=n.find(Ac.items,"did",BI.items[A5].did);if(BP!==-1){return BP+1;}}return 0;},BO=function(BS,BR,BT){BS.items=BS.items.filter(function(BU){return BU.did!==BT.did;});BS.items.splice(BR,0,BT);},BH=function(BR,BS){return BJ.some(function(BT){return(BT.zoneId===BR.id&&BT.unitId===BS.did);});};BJ.forEach(function(BR){if(BR.act==="addDropZoneUnit"){Ac=Af.getZoneModelByZoneId(BR.zoneId);As={t:BR.unitType,did:BR.unitId};BA=BR.unitPos-1;BA=BA>=0?BA:0;if(Ac.id===G||Ac.id===b){if(n.find(BI.items,"did",As.did)!==-1){BA=BQ();BR.unitPos=BA+1;}BO(Ac,BA,As);}else{if(Ac.id===g){BO(Ac,BA,As);if(BN&&n.find(BN.items,"did",As.did)!==-1){BP=BQ();BO(BN,BP,As);if(!BH(BN,As)){BK=O.clone(BR);BK.zoneId=BN.id;BK.unitPos=BP+1;BL.push(BK);}}if(BM&&n.find(BM.items,"did",As.did)!==-1){BP=BQ();BO(BM,BP,As);if(!BH(BM,As)){BK=O.clone(BR);BK.zoneId=BM.id;BK.unitPos=BP+1;BL.push(BK);}}}}}});return BJ.concat(BL);};Aw=BD(Aw);return Aw;},checkAndAddThresholdAction:function AG(AR,AP,AQ){var AO=this.getHost();if(this.isMetric(AP)&&AR===g){J.addThresholds(AO.model,AO,AO.node,AP,AQ,undefined,undefined,false);return true;}return false;},isDualAxis:function K(AO){var AT=this,AS=AT.getZoneModelByZoneId(AO),AQ=0,AR=0;var AP=function(AU){if(AU===true||AU===1){AQ++;}else{if(AU===false||AU===0){AR++;}}};n.forEach(AS.items,function(AU){if(AT.isMetric(AU)){AP(AU.ax);}});return AQ>0&&AR>0;},getUnitDroppedActions:function(Ad,AW,AP,Ab,AQ,AX,AO,Aa){var AT=[],AY=(Aa===L||Aa===AD);AT=AT.concat(this.getActionsOnUnitDropped(Ad,AW,AP,Ab,AQ,AX,AO,AY));if(Aa){var AS=O.clone(AE,[L,AD,u,X]),Ac=this.hGetItemOccurrence(AS),AU=this.getZoneModelByZoneId(Aa),AR=AU.items.length,AZ;if(Ac.length>0){var AV=this.getZoneModelByZoneId(Ac[0].zoneId);AZ=AV.items[Ac[0].itemIndex];}else{AZ=AS;AZ.zone=Aa;}AT=AT.concat(this.getActionsOnUnitDropped(AZ,AU,AP,AR,V.BELOW,true));}return AT;},getUpdateMetricNameUnitActions:function(AW,AX){var AR,AT,AV,AP=O.clone(AE),AY=this.hGetItemOccurrence(AP),AS=AY.length,AQ=[];if(AW&&AS===0){AV=this.getZoneModelByZoneId(AX);AP.zone=AX;AQ.push(this.getAddDropZoneUnitAction(AV,AP,AV.items.length));}if(!AW&&AS>0){for(AR=0;AR<AS;AR++){AV=this.getZoneModelByZoneId(AY[AR].zoneId);AT=AY[AR].itemIndex;AQ.push(this.getRemoveDropZoneUnitAction(AV,AV.items[AT]));}}if(AQ.length===0&&AX!==L){if(AS>0){var AU=false;var AO;for(AR=0;AR<AS;AR++){AO=AY[AR].zoneId;if(AO===AX){AU=true;break;}}if(AU===false){AV=this.getZoneModelByZoneId(AX);AP.zone=AX;AQ.push(this.getAddDropZoneUnitAction(AV,AP,AV.items.length));}}}return AQ;},getClearDZUnitActions:function(AP,AO){var AQ,AR,AS=AP.items,AU=AS.length,AT=[];if(AO===undefined){AO=true;}for(AQ=AU-1;AQ>=0;AQ--){AR=AS[AQ];if(this.isMetricName(AR)&&AO){continue;}AT.push(this.getRemoveDropZoneUnitAction(AP,AR));}return AT;},getClearDZMetricActions:function(AR,AU,AT){var AQ,AV,AX=AR.items,AO=AX.length,AW=this.getZoneModelByZoneId(I),AS=AW.items.length,AP=[];for(AQ=AO-1;AQ>=0;AQ--){AV=AX[AQ];if(!this.isMetric(AV)){continue;}AT.push(AV.did);AP.push(this.getAddDropZoneUnitAction(AW,AV,AS++,{isPrimary:AV.ax===0}));AP.push(this.getRemoveDropZoneUnitAction(AR,AV,AU));}return AP;},removeMetricFromTooltips:function(AO){var AP,AQ,AU=this.getZoneModelByZoneId(I),AR=AU.items,AT=AR.length,AS=[];for(AP=AT-1;AP>=0;AP--){AQ=AR[AP];if(this.isMetric(AQ)&&AO.indexOf(AQ.did)>=0){AS.push(this.getRemoveDropZoneUnitAction(AU,AQ,1));}}return AS;},getSwapDZUnitActions:function(AS,AQ){var AT,Ab,AU=AS.items.slice(0),AZ=AQ.items.slice(0),Aa=AU.length,AY=AZ.length,AR=[],AW=[],AV=[],AX=[],AP,AO=this.isAttrCategoryZone(AS.id);AR=AR.concat(this.getClearDZMetricActions(AS,1,AX));AR=AR.concat(this.getClearDZMetricActions(AQ,1,AX));for(AT=0;AT<Aa;AT++){Ab=AU[AT];if(this.isMetric(Ab)){AP={isPrimary:Ab.ax===0};}else{AP={};}AW.push(this.getAddDropZoneUnitAction(AQ,Ab,AT,AP));}for(AT=0;AT<AY;AT++){Ab=AZ[AT];if(this.isMetric(Ab)){AP={isPrimary:Ab.ax===0};}else{AP={};}AV.push(this.getAddDropZoneUnitAction(AS,Ab,AT,AP));}if(AO){AR=AR.concat(AW);AR=AR.concat(AV);}else{AR=AR.concat(AV);AR=AR.concat(AW);}AR=AR.concat(this.removeMetricFromTooltips(AX));return AR;},getAddDropZoneUnitAction:function p(AT,AW,AU,AQ){var AV=f.call(this),AR=AV.model,AX=AR.data,AS=AV.itemId2DsIdMap[AW.did]||AX.datasetId,AO,AP;AQ=AQ||{};AQ.datasetId=AS;AQ.datasetType=AS===T?a:e;if(this.isMetricName(AW)){AU=AT.items.length;}AP=this._super(AT,AW,AU,AQ);if(AQ.isPrimary===undefined||AQ.isPrimary===true){AO=M.PRIMARY;}else{AO=M.SECONDARY;}if(AT.id===u||AT.id===X){AW.ax=AO;AP.ax=AO;if(AW.zone===u||AW.zone===X){AW.zone=AT.id;}}if(AT.items===undefined){return AP;}if(AU<=AT.items.length){if(AT.id===G){n.forEach(AT.items,function(AY){if(AY.did===AW.did&&AY.hidden){AW.hidden=true;}});}AT.items=AT.items.filter(function(AY){return AY.did!==AW.did;});AT.items.splice(AU,0,AW);}return AP;},getRemoveDropZoneUnitAction:function W(AO,AP,AR){var AQ=this._super(AO,AP,AR);if(AO.items===undefined){return AQ;}AO.items=AO.items.filter(function(AS){return AS.did!==AP.did;});return AQ;},moveAttributesToZone:function(AS,AP){var AQ,AR,AO;AQ=AA.call(this,AS,1);AR=v.call(this,AP,AQ.removedItems);AO=x.call(this,g,AQ.removedItems);return AQ.actions.concat(AR.actions).concat(AO.actions);},deleteItem:function(AP,AO,AQ){this.deleteItems([AP.items[AO]],AQ);},deleteItems:function(Ab,Aj){var Am=f.call(this),AW,Ai=Am.GMController,AX=Ai.getChartInfo(),AU=[],AT,Ae=O.clone(AE),AO={},Af={},Ah,Ag,Aa,AS,AV,AR,Ak=this;var AY=function(Ax){AW=Ax.zone;if(c(AW)&&Ak.isMetricName(Ax)){var At=Ai.dz.XAxis.TemplateMetric||[],Ay=Ai.dz.YAxis.TemplateMetric||[];if(Ax.cs&&(At.length>1||Ay.length>1)){AU=AU.concat(Ak.getUpdateMetricNameUnitActions(true,G));}return ;}var Au=Ak.getZoneModelByZoneId(AW),An=Ak.getZoneModelByZoneId(g),Ap=Ak.getZoneModelByZoneId(G),Aq=Ak.getZoneModelByZoneId(I),Ar=Ak.hGetItemOccurrence(Ax,[g]),As=Ak.hGetItemOccurrence(Ax,[u,X,g,G]);if(Ax.cs&&Ax.zone===b&&Ar.length){AU=AU.concat(Ak.getRemoveDropZoneUnitAction(Au,Ax));AU=AU.concat(Ak.getAddDropZoneUnitAction(An,Ax,An.items.length));AU=AU.concat(Ak.getAddDropZoneUnitAction(Ap,Ax,Ap.items.length));return ;}if(Ax.cs&&Ax.zone===Q&&!As.length){AU=AU.concat(Ak.getRemoveDropZoneUnitAction(Au,Ax));AU=AU.concat(Ak.getAddDropZoneUnitAction(Aq,Ax,Aq.items.length));return ;}Aj=Aj||Z;Aa=Ak.getZoneModelByZoneId(q)!==undefined;AO[u]=Ak.isMetricZone(u);AO[X]=Ak.isMetricZone(X);Af[u]=Ak.getMetricCntInZone(u);Af[X]=Ak.getMetricCntInZone(X);if(Aa){AO[q]=Ak.isMetricZone(q);Af[q]=Ak.getMetricCntInZone(q);}else{AO[q]=false;Af[q]=0;}if(Ax.t===4&&(AW===u||AW===X||AW===q)){Af[AW]-=1;if(Af[AW]===0){AO[AW]=false;}}if(!((AO[u]&&Af[u]>Aj)||(AO[X]&&Af[X]>Aj)||(AO[q]&&Af[q]>Aj))){Ah=Ak.hGetItemOccurrence(Ae);AR=Ah.length;for(Ag=0;Ag<AR;Ag++){AV=Ak.getZoneModelByZoneId(Ah[Ag].zoneId);AS=Ah[Ag].itemIndex;AU.push(Ak.getRemoveDropZoneUnitAction(AV,AV.items[AS]));}}if(!(AO[u]&&Af[u])&&!(AO[X]&&Af[X])){if(!Ak.isZonesEmptyAfterDelItem(Ax)){var Ao=Ak.getZoneModelByZoneId(G);n.forEach(Ao.items,function(Az){if(Ak.isMetricName(Az)){var A0=Ak.getZoneModelByZoneId(L);AU.push(Ak.getAddDropZoneUnitAction(A0,Ae,A0.items.length));}AU.push(Ak.getRemoveDropZoneUnitAction(Ao,Az));});}}if(Ak.isMetricName(Ax)&&Ax.zone===g){var Av=Ak.hGetItemOccurrence(AE,[L,AD,u,X,G,b]);if(Av.length===0){if(AX.isPie){AU=AU.concat(Ak.getUpdateMetricNameUnitActions(true,b));}else{AU=AU.concat(Ak.getUpdateMetricNameUnitActions(true,G));}}}AU.push(Ak.getRemoveDropZoneUnitAction(Au,Ax));if(Ak.isAttrCategory(Ax)&&AW===g){Ak.removeColorByItemFromBreakByIfExists(Ax,AU);}if(AX.isABL&&Ax.t===4){Am.updateMetricShape(Ax);var Aw=Ai.hasGroupInfoStored();if(Aw.existing){AT=Aw.gi;if((AX.dirc===AN.VERTICAL&&AW===X)||(AX.dirc===AN.HORIZONTAL&&AW===u)){AT=N(AT,Ax.did);}Ai.setGroupInfo(AT);}}};n.forEach(Ab,function(An){AY(An);});if(AU.length===0&&!Am.isXMLDirty()){return ;}var Ad=this.docModel.getDataService(),AQ=Am.k,Al=Y(Am),AZ=Ad.getUpdateTemplateAction(AQ,AU),Ac=AZ.partialRetrieval.nodes,AP=[AZ];AZ.partialRetrieval.nodes=Ac.concat(this.docModel.getSourceFilterKeys(AQ));if(Am.isXMLDirty()){AP.push(Am.getPersistAction());}Am.controller.submitUndoRedoUpdates(AP,null,Al);},getHostModel:function(){return this.getHost().model.data;},replaceItemInGroupInfo:function(AO,AW,AU,AV){var AT=AO.length,AQ,AR,AS,AP;AR=AU?0:1;for(AS=0;AS<AT;AS++){AQ=AO[AS];AP=false;if(AQ[AR]===AW){AQ[AR]=d;if(AQ[1-AR]===d){AP=true;}}else{if(AQ[1-AR]===AW){AQ[1-AR]=d;if(AQ[AR]===d){AP=true;}}}if(AP){AO.splice(AS,1);AT=AO.length;AS-=1;}}for(AS=0;AS<AT;AS++){AQ=AO[AS];if(AQ[AR]===AV){AQ[AR]=AW;break;}}return AO;},fillGroupInfo:function k(AP,AO,AX,AV){var AS,AQ,AU,AR=-1,AW=-1,AT=AO.length;if(!AP.dndGM){for(AS=0;AS<AT;AS++){AQ=AO[AS];if(AQ[0]===AX){AR=AS;}if(AQ[1]===AX){AW=AS;}}if((AV&&AR!==-1)||(!AV&&AW!==-1)){return AO;}if(AV&&AW!==-1){AU=AW;AQ=AO[AU];AQ[1]=d;if(AQ[0]===d){AQ[0]=AX;return AO;}}if(!AV&&AR!==-1){AU=AR;AQ=AO[AU];AQ[0]=d;if(AQ[1]===d){AQ[1]=AX;return AO;}}AO=AH(AO,AX,AV);}else{AO=D(AP,AO,AX,AV);}return AO;},getHighlightTargets:function AM(AT,AQ,AS){if(!AT.items.length){return null;}var AP=true;AS.allowedItems.forEach(function(AU){if(AU.t===AT.items[AS.idx].t){AP=false;}});if(AP){var AR=[],AO;AT.items.forEach(function(AV,AU){AO=AU+(AQ||0);AR.push({idx:AO,edge:AS.edge});},this);return AR;}return null;},getUpdateGroupInfoActionForNewMetric:function(AO,AP,AU){if(AP<=0){return null;}var AT=f.call(this),AS=AT.GMController,AV,AQ,AR;if(AS.shallWeUseGroupInfo){AQ=AS.getGroupInfo();AV=AS.getChartInfo();if(AV.isABL&&((AV.dirc===AN.VERTICAL&&AO===X)||(AV.dirc===AN.HORIZONTAL&&AO===u))){AR="idx:"+AP;AQ=this.fillGroupInfo({dndGM:false},AQ,AR,AU);AS.setGroupInfo(AQ);if(AT.isXMLDirty()){return AT.getPersistAction();}}}return null;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.expr","mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.models.FormatModel","mstrmojo.VisEnum","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.gm.GMUtility","mstrmojo.VisUtility","mstrmojo.models.FormatModel","mstrmojo._CanValidate");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","CharacterGroup","ContainerGroup","TwoColumnContainer","ColorPickerButton","LineStyleButton");var H=mstrmojo.hash,b=mstrmojo.array,g=mstrmojo.gm.GMUtility,v=mstrmojo.VisUtility,T=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES;var E=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,R=mstrmojo.models.FormatModel,L=R.ENUM_PROPERTY_NAMES,B=mstrmojo.chart.enums.EnumFontStyle,N=E.LEGEND_BG_COLOR,h=E.LEGEND_BG_FILL_TRANSPARENCY,u=E.LEGEND_FONT_SIZE,Z=E.LEGEND_FONT_FAMILY,z=E.LEGEND_FONT_COLOR,D=E.LEGEND_FONT_STYLE,k=mstrmojo.VisEnum.NETWORK_MAX_NODE_SIZE_TYPE,a=mstrmojo.VisEnum.NETWORK_MIN_NODE_SIZE_TYPE,r=mstrmojo.expr.DTP;var AA={};AA[L.FONT_SIZE]=u;AA[L.FONT_FAMILY]=Z;AA[L.COLOR]=z;var M="de",m="lgd";var S="30%",P="70%";function J(AC){var AB=AC,AD=this.getHost().defaultsLegendPop||{},AE=this.getPropertyValue(AB);return AE!==undefined?AE:AD[AC];}function x(AB){this._doNotSave=true;AB.call(this);this._doNotSave=false;}function F(){function AG(AM,AT,AN,AJ){var AR=this,AK="observableModel."+AM;function AI(AY){var AX=AR.getHost();var AW=v.getPropertyByPath(AX,AK);if(AW){AW.setValue(AY);}}function AU(){var AZ=AO.getSelectedItem().v,AY={type:AZ};var AX=AR.getPropertyInfo();AX.unmarshal(AM,AY);AY=AX[AM];AS.set("enabled",AJ.textboxEnabled(AZ));AS.updateText(AY.ratio);AI(AY);var AW=AJ.onSizeChanged;if(AW instanceof Function){AW(AY);}}var AV=this.getHost();var AL=v.getPropertyByPath(AV,AK,{});var AQ=AL.type.getValue();var AP=AL.ratio.getValue();var AO=this.getPulldown(AN,AU,!isNaN(AQ)?(AQ-1):0);var AS=new mstrmojo.ui.editors.controls.ValidationTextBox({required:true,dtp:r.FLOAT,constraints:H.copy(AJ.valueRange,{min:0.01,max:1,trigger:mstrmojo.validation.TRIGGER.ALL}),validationDelay:1500,value:AP.toString(),enabled:AJ.textboxEnabled(AQ),onValid:function(){var AX={type:AO.getSelectedItem().v,ratio:parseFloat(this.value)};AI(AX);var AW=AJ.onSizeChanged;if(AW instanceof Function){AW(AX);}},updateText:function(AW){this.inputNode.value=AW;this.value=AW;}});return[new mstrmojo.Label({text:AT}),p([AO,AS],{col1Width:"70%",col2Width:"30%"})];}var AH=(function(){var AI=["not used",mstrmojo.desc(13743,"The smallest element's size is proportional to its data element"),mstrmojo.desc(13744,"The smallest element's size is fixed, independent of its data value"),mstrmojo.desc(13740,"The smallest element's size is ## of the largest element's size")];return function(){var AL=this.getHost();if(AL.hasSizeByMetric()){var AJ=AL.propInfo;var AK=AJ.minNodeSize;var AM=AI[AK.type];if(AK.type===a.ADJUSTED_RANGE){AM=AM.replace("##",(AK.ratio*100).toFixed(0)+"%");}return AM;}}.bind(this);}.call(this));var AF=AG.call(this,"maxNodeSize",mstrmojo.desc(14116,"Item Max Size (0.01 - 1)"),[{n:mstrmojo.desc(6019,"Automatic"),v:k.AUTOMATIC},{n:mstrmojo.desc(8262,"Manual"),v:k.MANUAL}],{textboxEnabled:function(AI){return AI===k.MANUAL;}});var AD=AG.call(this,"minNodeSize",mstrmojo.desc(14117,"Item Min Size (0.00 - 1)"),[{n:mstrmojo.desc(11990,"Proportional"),v:a.PROPORTIONAL},{n:mstrmojo.desc(13741,"Full Range"),v:a.FULL_RANGE},{n:mstrmojo.desc(14118,"Adjusted Range"),v:a.ADJUSTED_RANGE}],{valueRange:{min:0,max:1},textboxEnabled:function(AI){return AI===a.ADJUSTED_RANGE;},onSizeChanged:function(){AB.set("text",AH());}});var AB;var AC=[].concat(AF,AD);var AE=this.getHost();if(!AE.hasSizeByMetric()){AD.forEach(function(AI){AI.set("enabled",false);});}else{AB=new mstrmojo.Label({text:AH(),cssText:"line-height: 115%;"});AC.push(AB);}return this.getEditorGroup(AC);}function I(AC){var AB=function(AI,AH,AG){return this.getCheckboxAndLabel(this.getPropertyValue(AG),AI,X.call(this,AH));}.bind(this);var AE="nodeSizeAggregation",AD=this.getHost().model.data,AF=mstrmojo.VisEnum.NETWORK_AGGREGATION_METHOD[this.getPropertyValue("nodeSizeAggregation")];this.replaceChildControls(AC,[this.getEditorGroup([AB(mstrmojo.desc(12080,"Show Edge Direction"),"showEdgeDirection","showEdgeDirection"),AB(mstrmojo.desc(12081,"Animate Layout Transition"),"showTransition","showTransition"),new mstrmojo.Label({text:mstrmojo.desc(12082,"Item Size Aggregation:")}),this.getPulldown([{n:mstrmojo.desc(2123,"Count"),v:"Count of"},{n:mstrmojo.desc(2131,"Sum"),v:"Sum of"},{n:mstrmojo.desc(2122,"Average"),v:"Average of"},{n:mstrmojo.desc(2127,"Minimum"),v:"Min of"},{n:mstrmojo.desc(2125,"Maximum"),v:"Max of"}],X.call(this,AE),AF===undefined?1:AF)]),F.call(this),this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(13861,"Item Formatting"))].concat(c.call(this))),V.call(this),this.getEditorGroup([this.getEditorGroup([this.getMoreOptionsEditorLink((AD&&AD.gsi&&AD.gsi.prop)||{})])],{isNested:true,showDivider:true,isContainer:true})]);}function Q(AD){var AH=O.call(this,{controlName:"LegendTextFontGroup"}),AF=new mstrmojo.Label({text:mstrmojo.desc(13601,"Fill:")}),AB=d.call(this,null,{controlName:"LegendBackgroundFillGroup"}),AE=[AH,AB],AJ=this.getHost(),AC=v.getPropertyByPath(AJ,"observableModel.showLegend"),AI=!!(AC&&AC.getValue()),AG=this.getEditorGroup([K.call(this,AC,AE),AH,AF,AB]);AG.attachEventListener("renderComplete",AG.id,function(){v.toggleControlEnabled(AE,AI);});this.replaceChildControls(AD,[AG]);}function A(){var AB=[{n:mstrmojo.desc(12100,"Circle"),v:"Circle"},{n:mstrmojo.desc(12101,"Square"),v:"Square"},{n:mstrmojo.desc(14433,"Diamond"),v:"Diamond"},{n:mstrmojo.desc(14434,"Hexagon"),v:"Hexagon"},{n:mstrmojo.desc(14435,"Triangle"),v:"Triangle"},{n:mstrmojo.desc(12103,"Ring"),v:"Ring"}];return AB;}var t=function(AE,AD){var AB="",AC=false;b.forEach(AE,function(AF){var AG=AD==="color"?AF.color.opacity.getValue():AF.shape.getValue();if(!AC){AB=AG;AC=true;}else{if(AB!==AG){AB="";}}});return AB;};var e=function(){var AB=[0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1];return AB;};var C=function(AB){mstrmojo.css.toggleClass(AB.previewNode,"conflict",true);AB.selectedValue="";if(!!AB.list){AB.setEmptyOption();}AB.previewNode.style.backgroundColor="white";};function n(AB,AD){var AC;b.forEach(AB,function(AF,AE){if(AF===AD||AF.v===AD){AC=AE;return false;}});return AC;}function Y(AE,AF){var AB=A(),AC=n(A(),AE),AD=this.getPulldown(AB,AF,AC);AD.setEmptyOption=function(){AD.selectedNode.innerHTML="";AD.selectedIndex="";AD.list.selectedIndices="";AD.list.render();};return this.addDisposable(AD);}function w(AB,AE){var AC=[0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1];var AD=this.getPulldown(AC.map(function(AF){return{v:AF,n:(AF*100)+"%"};}),AE,AC.indexOf(AB),{getIndexOfValue:function(AG){var AF=true;return this.items.reduce(function(AI,AK,AH){if(!AF){return AI;}var AJ=AG-AK.v,AL=AG-AI.v;if(AJ*AL<=0){AF=false;return Math.abs(AJ)<Math.abs(AL)?AH:AH-1;}return AK;});}});AD.setEmptyOption=function(){AD.selectedNode.innerHTML="";AD.selectedIndex="";AD.list.selectedIndices="";AD.list.render();};return this.addDisposable(AD);}function l(AB){return function(AC){var AE=AC.value,AD=AC.valueWas;if(!H.equals(AE,AD)){AB(AE,AD);}};}function U(AD,AE,AC){var AB=this.addDisposable(new mstrmojo.ui.editors.controls.ColorPickerButton(H.copy(AC,{selectedValue:AD})));AB.postselectedValueChange=l(AE);AB.setEmptyOption=function(){AB.selectedValue="";AB.list.selectedIndices="";AB.list.render();};return AB;}function f(AB,AD){var AC=this.addDisposable(new mstrmojo.ui.editors.controls.LineStyleButton());x.call(this,function(){AC.set("selectedValue",AB);});AC.postselectedValueChange=l(AD);AC.setEmptyOption=function(){AC.selectedValue="";AC.list.selectedIndices="";AC.list.render();};return AC;}function V(){var AG=this,AK=this.getHost(),AF=AK&&AK.stage,AJ="stage.observableModel.circleLabelStyle",AB="stage.observableModel.circleStyle.showNodeLabel",AI=v.getCharGroupValueChangeCb(function(){var AM=AG.getHost();return v.getPropertyByPath(AM,AJ);}),AD=this.getCharacterGroup(AI,(AF&&AF.getDataLabelFormats())||{}),AL=v.getPropertyByPath(AK,AB),AC=!!(AL&&AL.getValue()),AH=this.getCheckboxAndLabel(AC,mstrmojo.desc(13596,"Show Data Labels"),function(AN){var AO=AG.getHost(),AM=v.getPropertyByPath(AO,AB);if(AM!==undefined){AM.setValue(AN);}}),AE=v.getPropertyByPath(AK,AJ);if(AL!==undefined){AL.attachEventListener("valueChanged",this.id,function(){AH.getCtrl().set("checked",AL.getValue());});}if(AE!==undefined){AE.attachEventListener("valueChanged",this.id,function(){var AM=this.getHost(),AN=AM&&AM.stage;AD.setFormatSource(AN.getDataLabelFormats());});}return this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(11993,"Data Labels")),AH,AD]);}function p(AB,AC){AB.forEach(function(AE,AD){AE.slot="col"+(AD+1)+"Node";});AC=H.copy(AC,{col1Width:"50%",col2Width:"50%",children:AB});return new mstrmojo.ui.editors.controls.TwoColumnContainer(AC);}function c(){var AQ=this.getHost(),AX=AQ&&AQ.stage,AZ=AX&&AX.observableModel,AE=AZ&&AZ.circleStyle,AC=AQ.textSelectedIndex||0;if(!AE){return[];}var AR=function(Ab){var Aa=v.getPropertyByPath(AQ,"stage.observableModel."+Ab);if(Aa===undefined){throw new Error("invalid observable model");}return Aa;},AG=function(Ac,Ad,Ab){var Aa=AR(Ad);return Ac.call(this,Aa.getValue(),function(Ai){var Ah,Ae=function(Aj,Ak,Al){Ad=Ad.replace(new RegExp(Aj?"fromNode":"toNode","g"),Aj?"toNode":"fromNode");Ah=AR(Ad);Ah.setValue(Ak,Al);};if(AQ.textSelectedIndex===2){Ae(true,Ai,false);}else{if(AQ.textSelectedIndex===1){Ae(false,Ai,false);}else{Ah=AR(Ad);var Ag=Ah.getValue(),Af=Ad.split(".").indexOf("fromNode")===-1;if(Ag!==Ai){Ae(!Af,Ai,true);}else{Ae(Af,Ai,true);Af=!Af;}Ae(Af,Ai,false);}}},Ab);}.bind(this);var AK=AG(w,"circleStyle.fromNode.color.opacity"),AP=AG(w,"circleStyle.toNode.color.opacity"),AD=AG(U,"circleStyle.fromNode.color.value",{showNoFill:false}),AT=AG(U,"circleStyle.toNode.color.value",{showNoFill:false}),AF=AG(U,"circleStyle.fromNode.border.color.value",{showNoFill:false,showGradient:false}),AL=AG(U,"circleStyle.toNode.border.color.value",{showNoFill:false,showGradient:false}),AI=AG(f,"circleStyle.fromNode.border.style"),AO=AG(f,"circleStyle.toNode.border.style"),AJ=AG(Y,"circleStyle.fromNode.shape"),AY=AG(Y,"circleStyle.toNode.shape"),AW=AC===1?[AR("circleStyle.fromNode")]:[AR("circleStyle.toNode")],AB,AH,AN,AS,AV,AM=A();AE.attachEventListener("valueChanged",this.id,function(){var Aa="selectedValue";if(AQ.textSelectedIndex===1){AJ.set("selectedIndex",n(AM,AE.fromNode.shape.getValue()));AK.set("selectedIndex",AK.getIndexOfValue(AE.fromNode.color.opacity.getValue()));AD.set(Aa,AE.fromNode.color.value.getValue());AF.set(Aa,AE.fromNode.border.color.value.getValue());AI.set(Aa,AE.fromNode.border.style.getValue());}else{if(AQ.textSelectedIndex===2){AY.set("selectedIndex",n(AM,AE.toNode.shape.getValue()));AP.set("selectedIndex",AP.getIndexOfValue(AE.toNode.color.opacity.getValue()));AT.set(Aa,AE.toNode.color.value.getValue());AL.set(Aa,AE.toNode.border.color.value.getValue());AO.set(Aa,AE.toNode.border.style.getValue());}else{if(AE.fromNode.shape.getValue()===AE.toNode.shape.getValue()){AJ.set("selectedIndex",n(AM,AE.fromNode.shape.getValue()));AY.set("selectedIndex",n(AM,AE.toNode.shape.getValue()));}if(AE.fromNode.color.opacity.getValue()===AE.toNode.color.opacity.getValue()){AK.set("selectedIndex",AK.getIndexOfValue(AE.fromNode.color.opacity.getValue()));AP.set("selectedIndex",AP.getIndexOfValue(AE.toNode.color.opacity.getValue()));}if(AE.fromNode.color.value.getValue()===AE.toNode.color.value.getValue()){AD.set(Aa,AE.fromNode.color.value.getValue());AT.set(Aa,AE.toNode.color.value.getValue());}if(AE.fromNode.border.color.value.getValue()===AE.toNode.border.color.value.getValue()){AF.set(Aa,AE.fromNode.border.color.value.getValue());AL.set(Aa,AE.toNode.border.color.value.getValue());}if(AE.fromNode.border.style.getValue()===AE.toNode.border.style.getValue()){AI.set(Aa,AE.fromNode.border.style.getValue());AO.set(Aa,AE.toNode.border.style.getValue());}}}});if(AC===0||AQ.textSelectedIndex===0){AB=AJ;AB.selectedIndex=AJ.selectedIndex===AY.selectedIndex?AJ.selectedIndex:-1;AH=AD;AH.selectedValue=AD.selectedValue===AT.selectedValue?AD.selectedValue:"conflict";AN=AK;AN.selectedIndex=AK.selectedIndex===AP.selectedIndex?AK.selectedIndex:"conflict";AS=AF;AS.selectedValue=AF.selectedValue===AL.selectedValue?AF.selectedValue:"conflict";AV=AI;AV.selectedValue=AI.selectedValue===AO.selectedValue?AI.selectedValue:"conflict";}else{var AU=AC===1||AQ.textSelectedIndex===1;AB=AU?AJ:AY;AH=AU?AD:AT;AN=AU?AK:AP;AS=AU?AF:AL;AV=AU?AI:AO;}return[this.getPulldown([{n:mstrmojo.desc(14430,"From and To Items"),v:"AllItems"},{n:mstrmojo.desc(14431,"From Items"),v:"FromItems"},{n:mstrmojo.desc(14432,"To Items"),v:"ToItems"}],function(Ac){if(Ac==="FromItems"){AQ.textSelectedIndex=1;}else{if(Ac==="ToItems"){AQ.textSelectedIndex=2;}else{AQ.textSelectedIndex=0;}}if(AQ.textSelectedIndex===0){AW=[AE.fromNode,AE.toNode];if(AE.fromNode.color.opacity.getValue()!==AE.toNode.color.opacity.getValue()){AN.setEmptyOption();}if(AE.fromNode.color.value.getValue()!==AE.toNode.color.value.getValue()){C(AH);}if(AE.fromNode.border.color.value.getValue()!==AE.toNode.border.color.value.getValue()){C(AS);}if(AE.fromNode.border.style.getValue()!==AE.toNode.border.style.getValue()){C(AV);}if(AE.fromNode.shape.getValue()!==AE.toNode.shape.getValue()){AB.setEmptyOption();}}else{if(AQ.textSelectedIndex===1){AW=[AE.fromNode];}else{AW=[AE.toNode];}}var Aa=n(A(),t(AW,"shape")),Ab=n(e(),t(AW,"color"));if(Aa!==undefined&&AQ.textSelectedIndex!==0){var Ad;if(AQ.textSelectedIndex===2){Ad=AE.toNode;}else{Ad=AE.fromNode;}AB.set("selectedIndex",Aa);AH.set("selectedValue",Ad.color.value.getValue());AN.set("selectedIndex",Ab);AS.set("selectedValue",Ad.border.color.value.getValue());AV.set("selectedValue",Ad.border.style.getValue());}},AC),this.getLabelAndControl(mstrmojo.desc(9734,"Shape:"),AB,S,P),this.getLabelAndControl(mstrmojo.desc(13601,"Fill:"),p([AH,AN]),S,P),this.getLabelAndControl(mstrmojo.desc(13598,"Border:"),p([AS,AV]),S,P)];}function K(AC,AB){var AD=!!(AC&&AC.getValue()),AF=this.getCheckboxAndLabel(AD,mstrmojo.desc(13600,"Show legend"),function(AG){v.toggleControlEnabled(AB,AG);if(AC){AC.setValue(AG);}}),AE=AF.getCtrl();if(AC){AC.attachEventListener("valueChanged",this.id,function(AG){var AH=AG.newValue;if(AE.checked!==AH){AE.set("checked",AH);}});}return AF;}function G(AF){var AE=function(){var AH=J.call(this,Z),AK=J.call(this,u),AJ=g.decodeColor(J.call(this,z)),AI=parseInt(J.call(this,D),10);var AG={"text-decoration":""};AG[L.FONT_FAMILY]=AH;AG[L.FONT_SIZE]=parseInt(AK,10);AG[L.COLOR]=AJ;if((AI&B.FS_BOLD)>0){AG[L.FONT_WEIGHT]="bold";}if((AI&B.FS_ITALIC)>0){AG[L.FONT_STYLE]="italic";}if((AI&B.FS_UNDERLINE)>0){AG[L.UNDERLINE]="underline";}if((AI&B.FS_STRIKETHROUGH)>0){AG[L.LINE_THROUGH]="line-through";}x.call(this,function(){AF.setFormatSource(AG);});}.bind(this);var AC=this.getHost(),AB={bold:B.FS_BOLD,italic:B.FS_ITALIC,underline:B.FS_UNDERLINE,strikeout:B.FS_STRIKETHROUGH};AF.fontColor.showNoFill=false;var AD=AF.fontStyle;if(AD){AD.postselectionChange=function(AG){var AJ=AG.added,AK=this.items[(AJ&&AJ[0]!==undefined)?AJ[0]:AG.removed[0]],AI=!!AJ,AH=AC.readGlobalProperty(D),AL=(AH===undefined?0:AH);if(AI){AL=AL|AB[AK.css];}else{AL=AL&(~AB[AK.css]);}this.parent.raiseFormatValueChange(D,AL,AH);};}AE();v.addLegendFontChangeListeners(this,function(){if(AF.eventFromEdtModel){return ;}AE();});}function X(AC,AB){var AD=this.id;return function(AI){var AG=mstrmojo.all[AD],AH=AG.getHost(),AE=AH&&AH.observableModel,AF=AC;if(AE&&AE[AF]){AE[AF].setValue(AI,AG._doNotSave);}else{if(!AG._doNotSave){AH.setProperty(AC,AI,{suppressData:AB});}}};}function O(AB){var AD=this;var AC=new mstrmojo.ui.editors.controls.CharacterGroup(H.copy({onGroupValueChange:function(AF,AG,AE){if(AF!==D){AF=AA[AF];}if(AF===z){AG=g.encodeColor(AG);AE=g.encodeColor(AE);}AC.eventFromEdtModel=true;(X.call(AD,AF))(AG,AE);AC.eventFromEdtModel=false;},onFmtPropsChangedDefault:function(){x.call(this,mstrmojo.emptyFn);}},AB));x.call(this,function(){G.call(AD,AC);});return AC;}function d(AI,AH){var AB=this.id,AG,AF=function(){x.call(this,function(){AE.setChildrenValue([[N,g.decodeColor(J.call(this,N))],[h,J.call(this,h)]]);});}.bind(this),AE=new mstrmojo.ui.editors.controls.FillConfigGroup(H.copy({onGroupValueChange:function(AL,AM,AK){if(AL===N){AM=g.encodeColor(AM);AK=g.encodeColor(AK);}AG=true;(X.call(mstrmojo.all[AB],AL))(AM,AK);AG=false;},getChildComp:function AJ(AK){if(AK===N){return this.fillColorAndTrans.fillColor;}if(AK===h){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},setChildValue:function AD(AL,AM){var AK=this.getChildComp(AL);if(AK===undefined){return false;}switch(AK.alias){case"fillColor":if(AM!==AK.selectedValue){AK.set("selectedValue",AM);}break;case"fillAlphaText":if(AM!==AK.value){AK.set("value",AM);}break;}},setChildrenValue:function AC(AK){var AL=this;AK.forEach(function(AM){AL.setChildValue(AM[0],AM[1]);});},onFmtPropsChangedDefault:function(AK,AL){this.syncControl(function(){this.setChildValue(AK,AL);});}},AH));AE.fillColorAndTrans.fillColor.propName=N;AE.fillColorAndTrans.fillAlpha.fillAlphaText.propName=h;AF();v.addLegendBackgroundChangeListeners(this,function(){if(AG){return ;}AF();});return !!AI?this.getLabelAndControl(AI,AE,S,P):AE;}mstrmojo.vi.models.editors.NetworkEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.NetworkEditorModel",help:"dashboard_editor_network_html5_properties.htm",init:function(AB){this._super(AB);},getPropertyInfo:function(){var AB=this.getHost();return(AB&&AB.propInfo)||{};},getPropertyValue:function(AB){var AC=this.getPropertyInfo();return AC&&AC[AB];},getInitialTarget:function q(){return M;},getTargetPulldownItems:function o(AB){var AD=this.getHost(),AC=this._super(AB),AE=function(AF){return AF.bind(this,AB);}.bind(this);if(!AD.isEmpty()&&AD.stage){AC.unshift({n:mstrmojo.desc(11974,"Data Exploration"),v:M,h:AE(I)});if(AD.hasSizebyOrColorby()){AC.push({n:mstrmojo.desc(2403,"Legend"),v:m,h:AE(Q)});}}return AC;},onBEMFormatChange:function W(AB){if(!AB.isTitle&&AB.propertyName===T.BACKGROUND_COLOR){var AE=this.getHost()||{},AD=AE.stage||{},AC=AD.observableModel;if(AC){AC.background.value.setValue(AB.value);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.num","mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.Pulldown","mstrmojo.tooltip","mstrmojo.gm.GMUtility","mstrmojo.VisUtility","mstrmojo.NumStepperContentProvider","mstrmojo.ui.CheckList","mstrmojo.vi.ui.rw.selectors.CheckList","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.Menu","mstrmojo.gm.GMEnums","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.Stepper","mstrmojo.ui.editors.controls.CustomRange","mstrmojo.ui.editors.controls.GMReferenceLineList");var Bb="[undefinedIdentity]",a=0;var CT=mstrmojo.emptyFn,B4=mstrmojo.Widget,CL=mstrmojo.array,Aq=mstrmojo.hash,Bx=mstrmojo.css,AN=mstrmojo.func,B=mstrmojo.num,Bs=mstrmojo.gm,Ah=mstrmojo.VisUtility,o=mstrmojo.expr.DTP,CJ=Bs.GMUtility,B0=Bs.EnumSelectionOptionLevel,AV=Bs.WidgetPropertyTag,Cc=Bs.FormatingPropertyTag,Az=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,AB=mstrmojo.chart.enums.EnumFontStyle,BD=Bs.EnumIdentityType,B2=Bs.EnumShape,Ca=Bs.EnumSubtype,D=Bs.EnumSelectionOptionLevel,X=mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS,S=mstrmojo.ui.editors.controls.AdvancedColorPicker,Bw=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS,Bn={isNested:false,showDivider:false},A3={isNested:false,showDivider:true},CH={propagateChildProps:function(Ce){if(Ce!=="enabled"){this._super();}}};var Bu=AV.AXIS_SCALE_DATA,p=AV.AXIS_ORIGIN;var B8=1,AI=2,BU=4,Ae=8,Aa=16,A1=32,BP=64,v=128,CM=256,q=512,AA=1024,W=2048,K=4096,Bc=8192,BT=16384,CE=32768,Bq=65536,AH=131072,AS=262144;var U="de",CA="tln",Bg="rln",A0=mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE,CB="sp",Bh="ax",N="lgd",AP="rcl";var u="panel",AT="selector";var AR="default";var Bv="selAxSc4",Bf="selBdrMtxLn4",BI="selBgFill4",BK="rwColBgFill4",BF="selAxLbl4",AF="selAxLn4",Al="selAxTil4",CD="selGL4",F="selRwCl4",Ak="selTln4",l="selRfMtcln4",A5="selRfTyln4";var An="@",CW=":",G="#",Ab="_default",BJ="rwTxt",z="colTxt",A4="rwHdr",Be="colHdr",Bm="allTxt",k="lgd",BX="lgdBg",Bl="shp",h="shpBdr",B5="dl",BH="allAxLb",BZ="xAxLb",M="yAxLb",Ay="FntFml",R="FntStyle",By="FntSz",CX="FntClr",A7="Rtt",BV="Shw",Ba="Clr",Aj="CmbStyle",Ax="FillClr",n="FillTrans",CU="TxtAlignH",BS="TxtAlignV",Ai=1,A9=0,CS=1;var Au=[{n:mstrmojo.desc(11980,"Per cell"),v:Bs.EnumTrendRefLevel.DssModelLevelPerCell},{n:mstrmojo.desc(11981,"Per row"),v:Bs.EnumTrendRefLevel.DssModelLevelPerRow},{n:mstrmojo.desc(11982,"Per column"),v:Bs.EnumTrendRefLevel.DssModelLevelPerColumn},{n:mstrmojo.desc(11983,"Entire table"),v:Bs.EnumTrendRefLevel.DssModelLevelPerPanel}];var At="propEditor-Menu";var As=false;function Am(Ce){if(As&&window.console){window.console.log(Ce);}}function Ac(Ce){Am(Ce);return undefined;}var O={IN_FORMATTING_MODE:"inFmtMode",SELECTED_CATEGORY:"selCat"},C={};function Bo(Ce){(Ce||[]).forEach(function(Cf){Cf.onHighlightObjChange(a);});}function AE(Cg,Cf){var Ce=Cf?Bx.addClass:Bx.removeClass;Ce(Cg.domNode,"hilight");}function r(Ce){return function(){var Cg=(Ce&&Ce._hilightObjListens);if(Cg){Bo(Cg);}if(!Ce.host.formattingMode){return ;}if(this.groupTitle){AE(this.groupTitle,true);}var Cf=((this.groupTitle&&this.groupTitle.scopeSelectors&&this.groupTitle.scopeSelectors[0])||(this.scopeSelectors&&this.scopeSelectors[0]));if(Cf){Ce.sendNonShapeTargetSelectionIdentity(Cf);}};}function Ar(Cf,Ce){return Cf.some(function(Cg){return CJ.longIntAnd(Cg,Ce)===Cg;});}function L(Ce){while(Ce&&Ce.parentIdentity){Ce=Ce.parentIdentity;}return Ce;}function BO(Cf,Ce){var Cg=[];(Cf||[]).forEach(function(Ch){if(Cg.length===0&&Ce){Cg.push({n:Ch.opt,identity:Ce,v:Ch});}else{Cg.push({n:Ch.opt,v:Ch});}});return Cg;}function B9(Ce){return(Ce||[]).map(function(Cf){return Aq.copy(Cf,{v:Cf});});}function Q(){return BO(this.getHost().getNumericAxisOptions(true));}function Av(){return BO(this.getHost().getReferenceAxisOption());}function Cd(){return BO(this.getHost().getDependentMetricOptions());}function BE(){return BO(this.getHost().getIndependentMetricOptions());}function t(Ci,Ch){var Cf=this.broker,Ce=Cf.editorManager,Cg=this.getGroupTitle(Ci);Aq.copy({onHighlightObjChange:function(Ck){var Cj=this.highlightObjects;if(!Cj){return Ac("[GroupTitle] "+Ci+": not listen on any Highlight Objects but was registered as listener.");}AE(this,Ar(Cj,Ck));},highlightObjects:[]},Cg);Aq.copy(Ch,Cg);Ce.registerGroupTitle(Cg);return Cg;}function Ap(Cg,Ce){var Cf=Cg._sync;Cg._sync=true;Ce.call(Cg);Cg._sync=Cf;}function E(Cj,Ce,Cg,Cm,Ck){var Ch=Aq.copy(Ck,{postclick:r(Cm),updateSelection:function(Co,Cq){var Cp=this._sync;this._sync=true;var Cn=-1,Cr=a;this.items.forEach(function(Ct,Cs){var Cu=Ct.identity;if(Ar([Cu],Co)&&Ar([Cr],Cu)){Cn=Cs;Cr=Cu;}});this.set("selectedIndex",Cn);this._sync=Cp;},isHostedWithin:false});var Cf=this.addDisposable(this.getPulldown(Cg,Ch.fnChange||function(Cn){Cm.onTargetSelectionChanged(Ce,Cn);if(this._sync){return ;}Cm.sendNonShapeTargetSelectionIdentity(Ce);},0,Ch));Cm.registerSelector(Ce,Cf,Ch.highlightObjects);if(typeof Cj==="string"){var Cl=!!this.usingSpecialFormat,Ci=this.getLabelAndControl(Cj,Cf,Cl?"40%":"30%",Cl?"60%":"70%");Cf.label=Ci.getLabel();return Ci;}return Cf;}function w(Ce,Cf){return{broker:Ce,manager:Ce.editorManager,smartNames:Cf,controlName:Cf[0],reInitDefault:function(){(this.listenFormatProps).forEach(function(Cg){this.onFmtPropsChanged(Cg,this.broker.getFormatPropertyValue(Cg));},this);},reInit:function(){this.reInitDefault();},preBuildRendering:function(){this.reInit();},syncControl:function(Cg){var Ch=this._sync;this._sync=true;var Ci=Cg.call(this);this._sync=Ch;return Ci;},onFmtPropsChangedDefault:CT,onFmtPropsChanged:function(Cg,Ci,Ch){this.onFmtPropsChangedDefault(Cg,Ci,Ch);},onSelectorsValueChangedDefault:function(){this.reInit();},onSelectorsValueChanged:function(Cg,Ch){this.onSelectorsValueChangedDefault(Cg,Ch);},postclick:r(Ce.editorManager),onHighlightObjChange:function(Ch){var Cg=this.highlightObjects;if(!Cg||!Cg.length||!this.label){return Ac("[Control] "+this.controlName+": was registered as listener but does not listen on any Highlight Objects or has no label attached.");}AE(this.label,Ar(Cg,Ch));}};}function CC(Cj,Ch,Cf,Ce){if(!Cj){return ;}function Ci(Cq){return Object.keys(CL.hash(CL.ensureArray(Cq)));}var Cl=Cj.listenFormatProps||[],Cn=Cj.listenSelector||[];(Cj.smartNames||[]).forEach(function(Cq){CL.insert(Cl,null,Cq);CL.insert(Cn,null,Cj.broker.getDependingSelectorNames(Cq));});Cj.listenFormatProps=Ci(Cl);Cj.listenSelector=Ci(Cn);Cj.manager.registerFormatControl(Cj);var Cp=Cj;if(typeof Ch==="string"){var Cg=(Cf===CS),Ck=Cg?"20px":"30%",Cm=Cg?"100%":"70%";if(Ce){Ck=Ce[0];Cm=Ce[1];}Cp=this.getLabelAndControl(Ch,Cj,Ck,Cm,Cg);Cj.label=Cp.getLabel();if(Cg){Cp.cssClass="checkLabel multiLine";Cj.label.onclick=function Co(){Cj.onclick();};Cj.label.cssDisplay="inline-block";}else{if(Cf===A9){Cp.cssClass="characterGroup";}}}Cj.getCtrlContainer=function(){return Cp;};return Cp;}function AC(Cf,Ck){var Cg=this.broker,Cm=Cg.editorManager,Cj=Cf.allItem,Ci=Cf.metricItems,Cl=Cf.colorByItems,Ce=true;if(Ci.length<2&&Cl.length<1&&(!Cg.getLocalState(O.IN_FORMATTING_MODE)||!Cg.getVisProfile(BT))){Ce=false;}var Ch=this.addDisposable(new mstrmojo.ui.editors.controls.MenuPulldown(Aq.copy(Ck,{selectorName:"shapeObjectSelector",visible:Ce,syncControl:function(Cn){var Co=this._sync;this._sync=true;var Cp=Cn.call(this);this._sync=Co;return Cp;},value:Cl.length?Cl[0]:Cj,valueWas:null,onvalueChange:function(Cn){var Co=Cn.value;this.updateTooltip(this.selectedNode,Co.opt);if(!this._sync&&Co&&!(Co.optLvl===B0.COLOR_BY&&Co.key==="multiple")){Cm.sendShapeOption(true);}Cm.shapeFormatControls.forEach(function(Cp){Cp=Cp.getCtrl?Cp.getCtrl():Cp;Cp.reInit();});},updateSelection:function(Cn){this.syncControl(function(){var Co=this.value;if(!Cm.isShapeOptionEqual(this.value,Cn)||(Co&&(Co.key==="multiple"||Co.optLvl===D.ITSELF))){this.set("value",Aq.copy(Cn));if(Cg.getLocalState(O.IN_FORMATTING_MODE)){this.set("valueWas",Aq.copy(Cn));}}});},updateTooltip:function(Cp,Cr){if(!Cp){return ;}var Co={};Co.fontFamily=Bx.getStyleValue(Cp,"font-family");Co.fontSize=Bx.getStyleValue(Cp,"font-size");Co.fontStyle=Bx.getStyleValue(Cp,"font-style");Co.fontWeight=Bx.getStyleValue(Cp,"font-weight");var Cq=Ah.measureTextWidth(Cr,Co),Cn=parseInt(Bx.getStyleValue(Cp,"width"));Cp.title=Cq>Cn?Cr:"";},onwidthChange:function(){if(this.selectedNode){this.updateTooltip(this.selectedNode,this.selectedNode.innerHTML);}},postBuildRendering:function(){if(this.selectedNode){this.updateTooltip(this.selectedNode,this.selectedNode.innerHTML);}},getDisplayText:function(Cn){return(Cn&&Cn.opt)||"";},getMenuConfig:function(){var Co=this;function Cn(Cq){var Cr=new mstrmojo.ui.menus.MenuConfig({menuCssClass:At,newInstance:function(Cs){return new mstrmojo.ui.menus.Menu(mstrmojo.hash.copy({popupConfig:this,themeClassName:mstrApp.getThemeClassName()},Cs));}});(Cq||[]).forEach(function(Cs){Cr.addMenuItem(Co.getDisplayText(Cs),"",function(){Co.set("value",Cs);});});return Cr;}var Cp=new mstrmojo.ui.menus.MenuConfig({menuCssClass:At,hostId:Co.id,hostElement:Co.containerNode,isHostedWithin:false});Ah.absorbMenuItems(Cp,Cn([Cj]));if(Ci.length>1){if(Cl.length>0){Cp.addPopupMenuItem(mstrmojo.desc(962,"Metrics"),"",function(){return Cn(Ci);});Cp.addSeparator();}else{Ah.absorbMenuItems(Cp,Cn(Ci));}}if(Cl.length>0){Ah.absorbMenuItems(Cp,Cn(Cl));}return Cp;}})));Cm.shapeObjSel=Ch;Cm.sendShapeOption(true);return Ch;}function Bt(Cl,Ce,Cf,Cn,Cm){var Ch=this.broker,Co=Ch.editorManager,Cj=w(Ch,Cn);function Ck(Cq,Cp){return Ch.generateSmartName(null,AV.REF_LINE_DEF,Cq,Cp);}Aq.copy({controlName:Cf,items:[],metricOpt:Ce,_toggleRefLineEnabled:function(Cq,Cp){var Cr=Ck(AV.REF_ENABLED,Cq.v);Ch.setFormatPropertyValue(Cr,Cp);},reInitDefault:function(){this.syncControl(function(){this.set("items",this.broker.getOptionItems(this.controlName,this.metricOpt));if(this.items.length>0){this.selectItemByField("key",this.items[0].key);}});},generateNewRefLineItem:function Cg(Cp,Cs){var Cq=Ch.vis.getRealReferenceOptionFromAxisOption(this.metricOpt,Cp),Cr=Aq.copy(Cq,{v:Cq});if(Cr.refType===Bs.EnumRefLineModelType.CONST){Cr.c=B.parseNumeric(Cs);}return Cr;},onselectRefLine:function(Cp){this.manager.onTargetSelectionChanged(Cf,Cp);},onremoveRefLine:function(Cp){if(this._sync){return ;}this._toggleRefLineEnabled(Cp,false);},onrenameRefLine:function(Cq){if(this._sync){return ;}var Cp=Cq.key;if(Cq.refType===Bs.EnumRefLineModelType.CONST){var Cr=Ck(AV.REF_LINE_NAME,Cq.v);Ch.setFormatPropertyValue(Cr,Cq[AV.REF_LINE_NAME]);}this.selectItemByField("key",Cp);},onaddRefLine:function(Cq){if(this._sync){return ;}var Cp=Cq.key;if(Cq.refType===Bs.EnumRefLineModelType.CONST){var Cr=Ck(AV.REF_CONST_VALUE,Cq.v);Ch.setFormatPropertyValue(Cr,Cq.c);}else{this._toggleRefLineEnabled(Cq,true);}this.selectItemByField("key",Cp);},onFmtPropsChangedDefault:function(){this.syncControl(function(){var Cq=this.getSelectedItem(),Cp=Cq&&Cq.key;this.reInit();this.selectItemByField("key",Cp);});},onSelectorsValueChangedDefault:function(Cp,Cq){if(Cq!==this.metricOpt){this.metricOpt=Cq;this.reInit();}}},Cj);Aq.copy(Cm,Cj);var Ci=this.addDisposable(new mstrmojo.ui.editors.controls.GMReferenceLineList(Cj));Co.registerSelector(Cf,Ci,Cj.highlightObjects);return CC.call(this,Ci,Cl);}function Ao(Ch,Cg,Cf,Cl){var Ce=this.broker,Ck=[Cf],Ci=w(Ce,Ck);Aq.copy({showIcon:false,items:Cg,onFmtPropsChangedDefault:function(Cm,Cn){this.syncControl(function(){if(this.multiSelect){this.select((this.items||[]).map(function(Cp,Co){return(Cn&Cp.v)>0?Co:null;}).filter(function(Co){return Co!==null;}));}else{if(typeof Cn==="undefined"){this.clearSelect();}else{this.singleSelectByField(Cn,"v");}}});},postselectionChange:function(Cm){if(this._sync){return ;}var Cn=Cm.added&&this.items[Cm.added[0]].v;if(this.multiSelect){if(!Cg||!Cg.length){return Ac("[GMEditorModel getBitwiseValFromMultiSelection] no items in caller");}Cn=Cg.reduce(function(Cq,Cp,Co){return this.selectedIndices[Co]?Cq|=Cp.v:Cq;}.bind(this),0);}this.broker.setFormatPropertyValue(this.smartNames[0],Cn);}},Ci);Aq.copy(Cl,Ci);var Cj=this.addDisposable(new mstrmojo.ui.ButtonBar(Ci));return CC.call(this,Cj,Ch);}function CR(Ci,Cg){var Ch="00000000000000000000000000000000",Cf=Ci.dropZones,Ce=CL.find(Cf,"id",Cg);return Ce===-1?[]:CL.filter(Cf[Ce].items,function(Cj){return Cj.t===4&&Cj.id!==Ch;});}function BM(Cl,Cj,Ce,Cm,Ci){Cm=Cm||{};var Cg=this.broker,Cn=[Ce],Ck=w(Cg,Cn),Cf=Cm.fnChange||function(Co){if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],Co);};Aq.copy({onFmtPropsChangedDefault:function(Co,Cp){this.syncControl(function(){if(Cp==="undefined"){this.set("selectedIndex",-1);}else{this.selectItemByField("v",Cp);}});}},Ck);Aq.copy(Cm,Ck);var Ch=this.addDisposable(this.getPulldown(Cj,Cf,0,Ck));return CC.call(this,Ch,Cl,null,Ci||["40%","60%"]);}function Z(Cg,Cf,Ck){var Ce=this.broker,Cj=[Cf],Ch=w(Ce,Cj);Aq.copy({dtp:o.FLOAT,required:true,onValid:function(){if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],B.parseNumeric(this.value));},onFmtPropsChangedDefault:function(Cl,Cm){this.syncControl(function(){this.set("value",Cm);this.validate();});}},Ch);Aq.copy(Ck,Aq.copy(T(Ce,Cf),Ch));var Ci=this.addDisposable(new mstrmojo.ui.editors.controls.ValidationTextBox(Ch));return CC.call(this,Ci,Cg);}function AL(Ch,Cg,Cl,Ce){var Cf=this.broker,Ck=[Cg],Ci=w(Cf,Ck);Aq.copy({provider:new mstrmojo.NumStepperContentProvider(Aq.copy(Ce,{item:{interval:1},curVal:0,min:0,getInvalidMsg:function(){return mstrmojo.desc(14312,"This field accepts only integers greater than or equal to zero");},onTraverse:function(){var Cm=this.parent,Cn=this;if(Cm._sync){return ;}if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete Cn._lastTimeoutId;Cm.broker.setFormatPropertyValue(Cm.smartNames[0],Cn.curVal);},1000);},oncurValChange:function(){var Cm=this.parent;if(Cm.textNode){Cm.updateDisplayText();}}})),preBuildRendering:function(){this.reInit();mstrmojo.ui.editors.controls.Stepper.prototype.preBuildRendering.call(this);},onFmtPropsChangedDefault:function(Cm,Cn){this.syncControl(function(){if(typeof Cn==="undefined"){Cn="";}this.provider.set("curVal",Cn);});}},Ci);Aq.copy(Cl,Ci);var Cj=this.addDisposable(new mstrmojo.ui.editors.controls.Stepper(Ci));Cj.provider.parent=Cj;return CC.call(this,Cj,Ch,null,["40%","60%"]);}function Bj(Cf,Ce,Cj){var Ck=Cf.getFormatPropertyKey(Ce),Ch=function(){var Cm=Cf._resolveLevelOptionWithRuntime(Ck),Cl=[];if(Cm.key==="AllMetrics"){Cl.push(Cm.mos[0].mId);}else{Cm.mos.forEach(function(Cn){Cl.push(Cn.mId);});}return Cl;};var Cg,Ci=Ch();Cg=Cf.vis.formatAsAxisLabel(Ci,Cj);if(Cg!==undefined){return Cg;}return this.constructor.prototype.getConvertValue(Cj);}function Bk(Ck,Cj,Cg){var Cf=String(Ck),Ce=String(Cj),Co=Cf.split(".")[1],Cm=Ce.split(".")[1],Ci=Co?Co.length:0,Ch=Cm?Cm.length:0,Cn=Number(Cf.replace(".","")),Cl=Number(Ce.replace(".",""));if(Cg){return Cn*Cl/Math.pow(10,Ci+Ch);}else{return Bk(Cn/Cl,Math.pow(10,Ch-Ci),true);}}function BL(Cl,Cj,Cf,Ce,Cm){var Ci=[mstrmojo.desc(11976,"Global"),mstrmojo.desc(11985,"Per row/column"),mstrmojo.desc(11980,"Per cell"),mstrmojo.desc(13871,"Custom..."),mstrmojo.desc(13661,"Different")];var Cg=this.broker,Cn=[Cj],Ck=w(Cg,Cn);Aq.copy({getMenuConfig:function(){var Co=this,Cp=Aq.valarray(Bs.EnumAxisScale).slice(0,3),Cq=new mstrmojo.ui.menus.MenuConfig({menuCssClass:At,hostId:Co.id,hostElement:Co.containerNode,isHostedWithin:false});Cp.forEach(function(Cr){Cq.addMenuItem(Co.getDisplayText(Cr),"",function(){Co.set("value",Cr);});});Cq.addPopupMenuItem(Co.getDisplayText(Bs.EnumAxisScale.CUSTOM),"",function(){var Cr=Cf,Cu=Ce,Cs={},Cx={},Ct=Cg.getVisProfile(CM),Cv=Ct?100:1;Aq.keyarray(Cr).forEach(function(Cy){Cs[Cy]=Bk(Cg.getFormatPropertyValue(Cr[Cy]),Cv,true);});Aq.keyarray(Cu).forEach(function(Cy){Cx[Cy]=Cg.getFormatPropertyValue(Cu[Cy]);});var Cw=Ct?{min:-100,max:100}:{min:Cs.min,max:Cs.max};return new mstrmojo.ui.menus.EditorConfig({cssClass:At+" "+mstrApp.getThemeClassName(),data:{newRangeValid:true,rangeKeysChanged:[],autoKeysChanged:[],scaleTypeWillChange:Co.value!==Bs.EnumAxisScale.CUSTOM},contents:[{scriptClass:"mstrmojo.ui.editors.controls.CustomRange",alias:"rangeCtrl",range:Cs,auto:Cx,labelOfCustomRange:mstrmojo.desc(13662,"Axis Range"),rangeConstraints:{min:{min:null,max:Cs.max},max:{min:Cs.min,max:null}},oninputValidChange:function(Cy){this.parent.data.set("newRangeValid",Cy.value);},autoChanged:function(){var Cz=this.getAuto(),Cy=CL.filter(Aq.keyarray(Cx),function(C0){return String(Cx[C0])!==String(Cz[C0]);});if(this.parent){this.parent.data.set("autoKeysChanged",Cy);}},rangeChanged:function(){var Cy=this.getRange(),Cz=CL.filter(Aq.keyarray(Cs),function(C0){return String(Cs[C0])!==String(Cy[C0]);});this.parent.data.set("rangeKeysChanged",Cz);},getConvertValue:function(Cy){return Bj.call(this,Cg,Cr.min,Bk(Cy,Cv,false));}}],bindings:{okEnabled:function(){return(this.data.newRangeValid&&(this.data.rangeKeysChanged.length>0||this.data.scaleTypeWillChange))||this.data.autoKeysChanged.length>0;}},onOpen:function(){this.rangeCtrl.updateDisplay();},fnOk:function(C2,C0){var Cz=C0.rangeCtrl.getRange(),C1=this.data.rangeKeysChanged,C3=C0.rangeCtrl.getAuto(),Cy=this.data.autoKeysChanged;C1.forEach(function(C6,C5,C4){Cg.setFormatPropertyValue(Cr[C6],Bk(Cz[C6],Cv,false),null,C2.scaleTypeWillChange||C5!==C4.length-1);});Cy.forEach(function(C6,C5,C4){Cg.setFormatPropertyValue(Cu[C6],C3[C6],null,C2.scaleTypeWillChange||C5!==C4.length-1);});Co.set("value",Bs.EnumAxisScale.CUSTOM);}});});return Cq;},getDisplayText:function(Co){return(!isNaN(Co)&&Ci[Co])||"";},onvalueChange:function(Co){if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],Co.value);},onFmtPropsChangedDefault:function(Co,Cp){this.syncControl(function(){this.set("value",Cp);});}},Ck);Aq.copy(Cm,Ck);var Ch=this.addDisposable(new mstrmojo.ui.editors.controls.MenuPulldown(Ck));return CC.call(this,Ch,Cl,null,["40%","60%"]);}function Bp(Cf,Cl){var Ci=this,Ce=this.broker,Ck=[Cf],Ch=w(Ce,Ck),Cg=BE.call(this);Aq.copy({value:Cg[0],getDisplayText:function(Cm){return(Cm&&Cm.n)||"";},getMenuConfig:function(){var Cm=this,Cn=new mstrmojo.ui.menus.MenuConfig({menuCssClass:At,hostId:Cm.id,hostElement:Cm.containerNode,isHostedWithin:false});Cg.forEach(function(Co){Cn.addPopupMenuItem(Cm.getDisplayText(Co),"",function(){var Cu=Co.v;function Cw(Cx){return Ce.generateSmartName(null,AV.TREND_BUBBLE_FORE_DEF,Cx,Cu);}var Cp=Cw(AV.TREND_BUBBLE_FORE_ENABLED),Cs=Ce.getFormatPropertyValue(Cp),Cr={min:Cw(AV.TREND_BUBBLE_MIN),max:Cw(AV.TREND_BUBBLE_MAX),customMin:Cw(AV.TREND_BUBBLE_FORE_BWD),customMax:Cw(AV.TREND_BUBBLE_FORE_FWD)},Ct={};Aq.keyarray(Cr).forEach(function(Cx){Ct[Cx]=Ce.getFormatPropertyValue(Cr[Cx]);});var Cq=Ci.addDisposable(new mstrmojo.ui.editors.controls.CustomRange({alias:"rangeCtrl",range:Ct,enabled:Cs,labelOfCustomRange:mstrmojo.desc(13734,"Forecast"),rangeConstraints:{min:{min:null,max:Ct.min},max:{min:Ct.max,max:null}},oninputValidChange:function(Cx){this.parent.data.set("newRangeValid",Cx.value);},rangeChanged:function(){var Cx=this.getRange(),Cy=CL.filter(Aq.keyarray(Ct),function(Cz){return String(Ct[Cz])!==String(Cx[Cz]);});this.parent.data.set("rangeKeysChanged",Cy);},getConvertValue:function(Cx){return Bj.call(this,Ce,Cr.min,Cx);},getTextBoxCfg:function(Cx,Cy){Cy=[];Aq.copy({getInvalidMsg:function(Cz){if(Cz.code===mstrmojo.validation.STATUSCODE.INVALID_OUTOFRANGE){if(!this.constraints.min){return mstrmojo.desc(14325,"Forecasting requires the horizontal axis to be extrapolated to smaller than its current min value of #").replace("#",this.parent.getConvertValue(Ct.min));}if(!this.constraints.max){return mstrmojo.desc(14326,"Forecasting requires the horizontal axis to be extrapolated to greater than its current max value of #").replace("#",this.parent.getConvertValue(Ct.max));}}return this.constructor.prototype.getInvalidMsg(Cz);}},Cy);return this.constructor.prototype.getTextBoxCfg(Cx,Cy);}})),Cv=Ci.getCheckboxAndLabel(Cs,mstrmojo.desc(12026,"Enable Forecasting"),function(){this.parent.parent.data.set("rangeEnabled",this.checked);Cq.set("enabled",this.checked);});return new mstrmojo.ui.menus.EditorConfig({cssClass:At+" "+mstrApp.getThemeClassName(),data:{newRangeValid:true,rangeKeysChanged:[],rangeEnabled:Cs},contents:[Cv,{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12027,"Extrapolate values by adjusting the horizontal axis"),cssClass:"textLabel"},Cq],bindings:{okEnabled:function(){var Cx=this.data.rangeEnabled!==Cs;return(this.data.rangeEnabled&&this.data.newRangeValid&&(this.data.rangeKeysChanged.length>0||Cx))||(!this.data.rangeEnabled&&Cx);}},fnOk:function(C1){var Cy=C1.rangeEnabled,Cz=Cy!==Cs;if(Cy){var Cx=Cq.getRange(),C0=this.data.rangeKeysChanged;C0.forEach(function(C4,C3,C2){Ce.setFormatPropertyValue(Cr[C4],Cx[C4],null,Cz||C3!==C2.length-1);});}if(Cz){Ce.setFormatPropertyValue(Cp,Cy);}Cm.set("value",Co);}});});});return Cn;}},Ch);Aq.copy(Cl,Ch);var Cj=this.addDisposable(new mstrmojo.ui.editors.controls.MenuPulldown(Ch));return CC.call(this,Cj);}function Bz(Cg,Cf,Cj){var Ce=this.broker,Ci=[Cf],Ch=w(Ce,Ci);Aq.copy({oncheckedChange:function(){if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],this.checked);},onFmtPropsChangedDefault:function(Ck,Cl){this.syncControl(function(){this.set("checked",!!Cl);});}},Ch);Aq.copy(Cj,Ch);return CC.call(this,this.addDisposable(new mstrmojo.ui.Checkbox(Ch)),Cg,CS);}function AQ(Cg,Cf,Cl){var Ce=this.broker,Ck=[Cf],Ci=CL.find(Cg,"isAll",true),Ch=w(Ce,Ck);Aq.copy({items:Cg,allIdx:Ci,reInitDefault:function(){var Cm=this.smartNames[0],Cn={};(this.listenFormatProps).forEach(function(Co){if(Co===Cm){return ;}this.onFmtPropsChanged(Co,this.broker.getFormatPropertyValue(Co));},this);(this.items||[]).forEach(function(Cp,Co){if(this.broker.getFormatPropertyValue(Cf,Cp.opt)){Cn[Co]=true;}},this);this.syncControl(function(){this.set("selectedIndices",Cn,true);});},postselectionChange:function(Cn){if(this._sync){return ;}var Cp=!!Cn.added,Cm=Cp?Cn.added[0]:Cn.removed[0],Co=this.items[Cm].opt;this.broker.setFormatPropertyValue(this.smartNames[0],Cp,Co);},onFmtPropsChangedDefault:function(Cm,Co,Cn){this.syncControl(function(){var Cr=CL.filterOne(this.items,function(Cs){return Cs.opt.key===Cn.key;}),Cp=Cr&&this.items.indexOf(Cr);if(!!Co){if(this.allIdx>-1&&Cp>-1){var Cq=Aq.copy(this.selectedIndices);Cq[Cp]=true;if(Aq.keyarray(Cq).length===this.items.length-1){Cp=this.allIdx;}}this.addSelect(Cp);}else{this.removeSelect(Cp);}});}},Ch);Aq.copy(Cl,Ch);var Cj=this.addDisposable(new mstrmojo.ui.CheckListIcon(Ch));return CC.call(this,Cj,null);}mstrmojo.ui.CheckListIcon=mstrmojo.declare(mstrmojo.ui.CheckList,null,{scriptClass:"mstrmojo.ui.CheckListIcon",init:function CZ(Ce){this._super(Ce);mstrmojo.css.addWidgetCssClass(this,"gm-CheckList");},getItemMarkup:function AX(Cg,Ce){var Cf='<table><tr><td><span class="icon"></span></td><td><span>{@en@n}</span></td></tr></table>';return this._super(Cg).replace("<span>{@en@n}</span>",Cf);}});function CK(Cf,Cg){AN.override({showPickerForCurrentMode:function Ce(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var Ch=this.gradientOrientation,Ci=Cg.getChartInfo().dirc===Bs.EnumABLDirection.VERTICAL;Ch.set("selectedIndex",CL.find(Ch.items,"id",Ci?0:1));}}},Cf.colorPicker);}function T(Cg,Cf){function Ce(Ci){var Cj=Ci.value;return(Cj===undefined||Cj==="")&&Cg.getFormatPropertyValue(Cf)===undefined;}return{onInvalid:function Ch(){if(Ce(this)){if(this.hasRendered){this.clearValidation();}return ;}if(this.hasRendered){mstrmojo.ui.editors.controls.ValidationTextBox.prototype.onInvalid.call(this);}},onRender:function(){if(Ce(this)){this.clearValidation();}}};}function b(Cg,Cf,Ck){var Ce=this.broker,Cj=[Cf],Ch=w(Ce,Cj);Aq.copy({showGradient:true,postselectedValueChange:function(Cl){if(this._sync){return ;}var Cm=Cl.value;if(Cm===S.VAL_AUTOMATIC){Cm=AR;}this.broker.setFormatPropertyValue(this.smartNames[0],Cm);},onFmtPropsChangedDefault:function(Cl,Cm){this.syncControl(function(){if(typeof Cm==="undefined"){Cm="conflict";}if(this.colorDefaultSN&&this.broker.getFormatPropertyValue(this.colorDefaultSN)){this.set("autoPreviewColor",Cm);Cm=S.VAL_AUTOMATIC;}this.set("selectedValue",Cm);});}},Ch);Aq.copy(Ck,Ch);var Ci=this.addDisposable(new mstrmojo.ui.editors.controls.ColorPickerButton(Ch));return CC.call(this,Ci,Cg);}function Bi(Ch,Cf){var Ce={},Ck=Ch.getFormatPropertyValue(Cf.fontStyle),Ci=Ch.getFormatPropertyValue(Cf.fontColor),Cg=Ch.getFormatPropertyValue(Cf.fontFamily),Cj=Ch.getFormatPropertyValue(Cf.fontSize);if(Ck!==undefined){Ce[Az.FONT_WEIGHT]=(!isNaN(Ck)&&((Ck&AB.FS_BOLD)>0));Ce[Az.FONT_STYLE]=(!isNaN(Ck)&&((Ck&AB.FS_ITALIC)>0));Ce[Az.UNDERLINE]=(!isNaN(Ck)&&((Ck&AB.FS_UNDERLINE)>0));Ce[Az.LINE_THROUGH]=(!isNaN(Ck)&&((Ck&AB.FS_STRIKETHROUGH)>0));}Ce[Az.COLOR]=Ci!==undefined?Ci:-1;Ce[Az.FONT_SIZE]=Cj!==undefined?Cj:-1;Ce[Az.FONT_FAMILY]=Cg!==undefined?Cg:-1;return Ce;}function A6(Cl,Ch,Cm){var Ce=this.broker,Cn=Aq.valarray(Ch),Ck=w(Ce,Cn),Cj={},Ci={};Ci[Az.FONT_SIZE]=Ch.fontSize;Ci[Az.COLOR]=Ch.fontColor;Ci[Az.FONT_FAMILY]=Ch.fontFamily;Ci[Az.FONT_WEIGHT]=Ci[Az.FONT_STYLE]=Ci[Az.UNDERLINE]=Ci[Az.LINE_THROUGH]=Ch.fontStyle;Cj[Az.FONT_WEIGHT]=AB.FS_BOLD;Cj[Az.FONT_STYLE]=AB.FS_ITALIC;Cj[Az.UNDERLINE]=AB.FS_UNDERLINE;Cj[Az.LINE_THROUGH]=AB.FS_STRIKETHROUGH;Aq.copy({smartNamesMap:Ch,syncWithAllText:false,onGroupValueChange:function(Cr,Cq){var Ct=Ci[Cr];if(Ct===Ch.fontStyle){var Cp=Ce.getFormatPropertyValue(Ct),Cs=Cj[Cr],Co=Cq;Cq=Co?(Cp|Cs):(Cp&(~Cs));}else{if(Ct===Ch.fontSize){if(this.visibleControls&X.FONT_SIZE_USE_STEPPER){Cq=Cq[0];}Cq=parseInt(Cq,10)+"pt";}}this.broker.setFormatPropertyValue(Ct,Cq);},onFmtPropsChangedDefault:function(Co){this.syncControl(function(){var Cp=this.smartNamesMap,Cq=CL.filterOne(Aq.keyarray(Cp),function(Cr){return Cp[Cr]===Co;});if(Cq||this.syncWithAllText){if(!Cq&&Co.indexOf(Bm)===-1){Am("[CharacterGroup] Unnecessary refresh which might be due to incorrect listenFormatProps.");}this.refreshValues();}});},refreshValues:function(){this.syncControl(function(){var Co=Bi(this.broker,this.smartNamesMap);if(this.visibleControls&X.FONT_SIZE_USE_STEPPER){Co[Az.FONT_SIZE]=[parseInt(Co[Az.FONT_SIZE],10)];}this.setFormatSource(Co);});}},Ck);Aq.copy(Cm,Ck);if(Ck.syncWithAllText){var Cg=Aq.valarray(Ce.getSmartNamesMapForFontGroup(Bm));Ck.listenFormatProps=(Ck.listenFormatProps||[]).concat(Cg);}var Cf=this.addDisposable(new mstrmojo.ui.editors.controls.CharacterGroup(Ck));return CC.call(this,Cf,Cl,A9);}function B7(Cf,Cg,Cl){var Ce=this.broker,Ck=Aq.valarray(Cg),Ch=w(Ce,Ck);Aq.copy({smartNamesMap:Cg,onGroupValueChange:function(Cm,Cn){if(this._sync){return ;}this.broker.setFormatPropertyValue(Cm,Cn);},onFmtPropsChangedDefault:function(Cm,Cn){this.syncControl(function(){this.setChildValue(Cm,Cn);});}},Ch);Aq.copy(Cl,Ch);var Cj=this.addDisposable(new mstrmojo.ui.editors.controls.LineConfigGroup(Ch));Cj.iniChildrenComp(Ck);var Ci=Cj.getChildComp(Ba);if(Ci){CK(Ci,this.getHost());}return CC.call(this,Cj,Cf);}function Cb(Cf,Cg,Cl){var Ce=this.broker,Ck=Aq.valarray(Cg),Ch=w(Ce,Ck);Aq.copy({smartNamesMap:Cg,onGroupValueChange:function(Cm,Cn){if(!this._sync){Ce.setFormatPropertyValue(Cm,Cn);}},onFmtPropsChangedDefault:function(Cm,Cn){this.syncControl(function(){var Co=this;if(CL.filterOne(this.propNames,function(Cp){return(Cp===Cm);})){Co.setChildValue(Cm,Cn);}else{this.propNames.forEach(function(Cp){Co.setChildValue(Cp,Co.broker.getFormatPropertyValue(Cp));});}});}},Ch);Aq.copy(Cl,Ch);var Cj=this.addDisposable(new mstrmojo.ui.editors.controls.FillConfigGroup(Ch));Cj.iniChildrenComp(Ck);var Ci=Cj.getChildComp(Ba);if(Ci){CK(Ci,this.getHost());}return CC.call(this,Cj,Cf);}mstrmojo.vi.models.editors.GMEditorManager=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.editors.GMEditorManager",host:null,initializing:false,targetSelectors:null,shapeObjSel:null,shapeFormatControls:null,_fmtPropBindings:null,_fmtSelBindings:null,_hilightObjListens:null,_IdentityTypeMapping:null,_nonShapeSelectionToIdentityMapping:null,init:function CZ(Ce){this._super(Aq.copy(Ce,{targetSelectors:{},_fmtPropBindings:{},_fmtSelBindings:{},_hilightObjListens:[],_IdentityTypeMapping:{},_nonShapeSelectionToIdentityMapping:{},shapeFormatControls:[]}));},clearControlsReference:function(){this.targetSelectors={};this._fmtPropBindings={};this._fmtSelBindings={};this._hilightObjListens=[this.model];this.shapeFormatControls.length=0;var Ce=this._IdentityTypeMapping;CL.forEach(Object.keys(Ce),function(Cf){Ce[Cf][AT].length=0;});},_addListener:function(Ch,Ce,Cg){var Cf=Ch[Ce]||[];Cf.push(Cg);Ch[Ce]=Cf;},initIdentityPanelMapping:function(){var Cg=u,Ce=this._IdentityTypeMapping;Aq.forEach(BD,function(Ch){var Ci=Ce[Ch]={};Ci[u]=[];Ci[AT]=[];});var Cf=this._nonShapeSelectionToIdentityMapping;Cf[BD.X_NUMERIC]=BD.X_CATEGORY;Cf[BD.Y_NUMERIC]=BD.Y_CATEGORY;Ce[BD.AXIS_SCALE][Cg]=Ce[BD.LOG_SCALE][Cg]=Ce[BD.AXIS_ORIGIN_DEFINE][Cg]=U;Ce[BD.TREND_LINE][Cg]=CA;Ce[BD.REF_LINE][Cg]=Bg;Ce[BD.VIZ_BOX_TITLE][Cg]=Ce[BD.VIZ_BOX_CONTAINER][Cg]=A0;Ce[BD.LEGEND][Cg]=Ce[BD.LEGEND_TEXT][Cg]=Ce[BD.COLOR_SQUARE][Cg]=N;Ce[BD.X_AXIS][Cg]=Ce[BD.Y_AXIS][Cg]=Ce[BD.X2_AXIS][Cg]=Ce[BD.Y2_AXIS][Cg]=Ce[BD.X_NUMERIC][Cg]=Ce[BD.X_CATEGORY][Cg]=Ce[BD.Y_NUMERIC][Cg]=Ce[BD.Y_CATEGORY][Cg]=Ce[BD.GRID_LINE][Cg]=Ce[BD.MINOR_GRID_LINE][Cg]=Ce[BD.X_METRIC_AXIS_TITLE][Cg]=Ce[BD.Y_METRIC_AXIS_TITLE][Cg]=Ce[BD.AXIS_ORIGIN][Cg]=Bh;Ce[BD.ROW_TITLE][Cg]=Ce[BD.COL_TITLE][Cg]=Ce[BD.ROW_HEADER][Cg]=Ce[BD.COL_HEADER][Cg]=Ce[BD.ROWS_BACKGROUND][Cg]=Ce[BD.COLS_BACKGROUND][Cg]=Ce[BD.H_MATRIX_LINE][Cg]=Ce[BD.V_MATRIX_LINE][Cg]=AP;Ce[BD.GRAPH_SHAPE][Cg]=Ce[BD.SHAPE_COLLECTION][Cg]=Ce[BD.DATA_LABEL][Cg]=CB;},switchPanelByValue:function(Ce){if(this.initializing){return ;}this.model.selectTargetByValue(Ce);},notifyPropChangeToListeners:function(Ce,Cg,Cf){if(this.initializing){return ;}(this._fmtPropBindings[Ce]||[]).forEach(function(Ch){if(Ch.onFmtPropsChanged){Ch.onFmtPropsChanged(Ce,Cg,Cf);}});},notifyNonShapeSelectionChangeToListeners:function(Cl){if(this.initializing){return ;}var Ch=Cl.identities.length===0,Ce=a,Ck=a,Cg=[],Cj=this;if(!Ch){Cl.identities.forEach(function(Co){var Cp=L(Co);if(!(Cp&&Cp.objType!==undefined)){return ;}var Cn=(Cj._nonShapeSelectionToIdentityMapping[Cp.objType]||Cp.objType);Ce=CJ.longIntOr(Ce,Cn);Cg.push(Cn);});Ck=L(Cl.identities[0]).objType;Ck=(Cj._nonShapeSelectionToIdentityMapping[Ck]||Ck);if(!Cj._IdentityTypeMapping[Ck]){return ;}var Cm=Cj._IdentityTypeMapping,Cf=Cm[Ck][u];this.switchPanelByValue(Cf);var Ci=[];Cg.forEach(function(Cn){Ci=Ci.concat(CL.difference(Cm[Cn][AT]||[],Ci));});Ci.forEach(function(Cn){if(Cn.updateSelection){Cn.updateSelection(Ce,Cl.identities);}});}this._hilightObjListens.forEach(function(Cn){Cn.onHighlightObjChange(Ce);});},_notifyShapeSelectionChangeToListeners:function(Ce){if(this.initializing){return ;}var Ci=this.host,Cl=Ad.call(this.model),Ch=Ce.arrayOfComb||Ce.arrayOfColorByComb,Ck={opt:"Multiple Elements",key:"multiple",optLvl:B0.COLOR_BY,comb:[]};var Cj=Ce.selectionlevel,Cg=Cj===B0.COLOR_BY,Cf;if(Ch&&Ch.length>1&&Cg){Cf=Ck;}else{if(Ch&&(Cg||Cj===B0.METRIC)){Cf=Aq.copy(CL.filterOne(Cg?Cl.colorByItems:Cl.metricItems,function(Cm){return CJ.isEqualComb(Cm.comb,Ch[0]);}));}else{Cf=Aq.copy(CL.filterOne(Cl.originCollection,function(Cm){return Cj===Cm.optLvl;}));}}this.switchPanelByValue(CB);if(this.shapeObjSel){this.shapeObjSel.updateSelection(Cf);}},_notifyFormatModeChangeToListeners:function(Ce){if(this.initializing){return ;}if(this.shapeObjSel){this.shapeObjSel.onFormattingModeChange(Ce);}},_notifyOnContextMenuSelectionListeners:function(Ce){this.switchPanelByValue(this._IdentityTypeMapping[Ce.identityType][u]);var Cf=this._IdentityTypeMapping[Ce.identityType][AT]||[];Cf.forEach(function(Cg){if(Cg.updateSelection){Cg.updateSelection(Ce.identityType,[{key:Ce.metricId,tlOpt:{key:Ce.metricId}}]);}});this._hilightObjListens.forEach(function(Cg){Cg.onHighlightObjChange(Ce.identityType);});},getTargetSelector:function(Ce){if(!this.targetSelectors[Ce]){Am("Selector with name "+Ce+" does not found.");}return this.targetSelectors[Ce];},getSelectedValue:function(Cf,Ch,Ce){var Cg=this.getTargetSelector(Cf);Ch=Ch||"v";return Cg&&Cg.getSelectedItem(Ce)&&Cg.getSelectedItem(Ce)[Ch];},onTargetSelectionChanged:function(Ce,Cg){var Cf=Ce&&this._fmtSelBindings[Ce];(Cf||[]).forEach(function(Ch){if(!Ch.onSelectorsValueChanged){return Ac("[Manager] onSelectorsValueChanged not defined for control: "+Ch.controlName);}Ch.onSelectorsValueChanged(Ce,Cg);},this);},sendNonShapeTargetSelectionIdentity:function(Cf){var Ce=this.targetSelectors[Cf];if(!this.host.formattingMode||!Ce||Ce.selectedIndex===undefined||Ce.selectedIndex===null){return ;}var Cg=Ce.items[Ce.selectedIndex].identity,Ch=[];if(!Cg||Cg===Bb){return ;}Aq.forEach(BD,function(Cj){if((Cg&Cj)>0){Ch.push(Cj);}});var Ci={name:"highLightObjectChange",identities:Ch};this.host.raiseEvent(Ci);return Ci;},isShapeOptionEqual:function(Cf,Ce){if(!Cf&&!Ce){return true;}if(!Cf||!Ce){return false;}if(Cf.optLvl!==Ce.optLvl){return false;}if(Cf.opt!==Ce.opt){return false;}return(Cf.comb===Ce.comb)||(Cf.comb&&Ce.comb&&CJ.isEqualComb(Cf.comb,Ce.comb));},sendShapeOption:function(Cf){var Ce=this.shapeObjSel,Cg=Ce.value;if((!Cf&&!this.host.formattingMode)||this.isShapeOptionEqual(Cg,Ce.valueWas)){return ;}Ce.set("valueWas",Aq.copy(Cg));this.host.onFormatableTargetChanged(Cg);},registerFormatControl:function(Cf){var Ce=Cf.listenFormatProps;(Ce||[]).forEach(function(Cg){this._addListener(this._fmtPropBindings,Cg,Cf);},this);Ce=Cf.listenSelector;(Ce||[]).forEach(function(Cg){this._addListener(this._fmtSelBindings,Cg,Cf);},this);if(Cf.highlightObjects&&Cf.highlightObjects.length){this._hilightObjListens.push(Cf);}},registerSelector:function(Ce,Ci,Ch){var Cg=AT,Cf=this._IdentityTypeMapping;this.targetSelectors[Ce]=Ci;(Ch||[]).forEach(function(Cj){if(!Cf[Cj]){var Ck=Cf[Cj]={};Ck[u]=[];Ck[AT]=[];}Cf[Cj][Cg].push(Ci);});Ci.set("selectedIndex",0);},registerGroupTitle:function(Ce){if(Ce.highlightObjects){this._hilightObjListens.push(Ce);}}});mstrmojo.vi.models.editors.GMBroker=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.editors.GMBroker",vis:null,editorManager:null,_smartNameToPropertyKeyLookup:null,_dynamicPrefixToSmartNamesLookup:null,_subscriptions:null,_titleSubs:null,init:function CZ(Ce){this._super(Aq.copy(Ce,{_smartNameToPropertyKeyLookup:{},_dynamicPrefixToSmartNamesLookup:[],_subscriptions:[]}));},getLocalState:function x(Cg){var Cf=C[this.vis.node.k],Ce=Cf&&Cf[Cg];if(Ce===undefined){switch(Cg){case O.IN_FORMATTING_MODE:Ce=this.vis.formattingMode;break;case O.SELECTED_CATEGORY:Ce=U;break;}}return Ce;},updateLocalState:function CQ(Cg,Cf){var Ce=C[this.vis.node.k]||{};Ce[Cg]=Cf;C[this.vis.node.k]=Ce;},attachEditorRuntime:function BW(Ce){if(!Ce){return Ac("[Broker] Could not attach undefined editor manager! Broker not connected to panel runtime.");}var Cf=this.vis;this.editorManager=Ce;this._subscriptions=[Cf.attachEventListener("formattingObjectChanged",this.id,function(Cg){if(Cg.selectionlevel!==B0.COLOR_BY||(Cg.arrayOfComb&&Cg.arrayOfComb.length>0)){Ce._notifyShapeSelectionChangeToListeners(Cg);}else{Bo(Ce._hilightObjListens);}}),Cf.attachEventListener("nonShapeFormatableChanged",this.id,function(Cg){if(true||this.getLocalState(O.IN_FORMATTING_MODE)){Ce.notifyNonShapeSelectionChangeToListeners(Cg);}}),Cf.attachEventListener("propertyChanged",this.id,function(Cg){var Ch=this.translateFormatPropertyChangeFromGM(Cg.n,Cg.v,Cg.opt);(Ch||[]).forEach(function(Ci){Ce.notifyPropChangeToListeners(Ci.sn,Ci.val,Cg.opt);});}),Cf.attachEventListener("formattingModeChanged",this.id,function(Cg){this.updateLocalState(O.IN_FORMATTING_MODE,Cg.isFmtMode);Ce._notifyFormatModeChangeToListeners(Cg.isFmtMode);Bo(Ce._hilightObjListens);}),Cf.attachEventListener("onContextMenuSelection",this.id,function(Cg){if(Cg.identityType){Ce._notifyOnContextMenuSelectionListeners(Cg);}})];this._titleSubs=[Cf.parent.titleBar&&Cf.parent.titleBar.attachEventListener("titleBarRMC",this.id,function(Cg){if(this.getLocalState(O.IN_FORMATTING_MODE)){Cg.identities=[{objType:BD.VIZ_BOX_TITLE}];Ce.notifyNonShapeSelectionChangeToListeners(Cg);}})];},detachEditorRuntime:function AK(){(this._subscriptions).forEach(function(Cf){this.vis.detachEventListener(Cf);},this);(this._titleSubs).forEach(function(Cf){if(this.vis.parent.titleBar){this.vis.parent.titleBar.detachEventListener(Cf);}},this);var Ce=this.editorManager;this.editorManager=null;return Ce;},translateFormatPropertyChangeFromGM:function g(Cj,Cg,Ch){function Co(Cq,Cp,Cr){return CL.filter(Cq,function(Cs){return(Cs.indexOf(Cp+(Cr||""))===0);});}function Ci(Cr,Cq,Cu){var Ct=Aq.keyarray(Ck._smartNameToPropertyKeyLookup),Cp=Co(Ct,Cr),Cs="";if(Cq){Cs+=CW+Cq;Cp=Co(Cp,Cr,Cs);}if(Cp.length===1){return Cp[0];}if(Cp.length>1){if(Cp.indexOf(Cr+(Cs||""))!==-1){return Cr+(Cs||"");}Cs+=Cu&&(Cu.opt||Cu.key);Cp=Co(Cp,Cr,Cs);}if(Cp.length===1){return Cp[0];}return undefined;}var Ck=this,Ce=[undefined],Cf,Cm,Cn=[Cg],Cl=[];if(Cg&&Cg.modifiedPropertyKeys){Ce=Cg.modifiedPropertyKeys;if(!Ce){return Ac("[Broker] modifiedPropertyKeys is empty for actual prop name: "+Cj);}Cn=Ce.map(function(Cp){return Cg.jsonObj[Cp];});}Ce.forEach(function(Cr,Cq){var Cp=[],Ct=Aq.keyarray(Ck._dynamicPrefixToSmartNamesLookup),Cs;Cf=Ci(Cj,Cr,Ch);if(Cf){Cp.push(Cf);}(Ct||[]).forEach(function(Cu){Cs=Ck.editorManager.getSelectedValue(Cu.slice(0,-1),"prefix");if(Cj.indexOf(Cs)===0){Cf=Ci(Cj.replace(Cs,Cu),Cr,Ch);if(Cf){Cp.push(Cf);}}});Cm=Cn[Cq];if(Cm!==undefined&&Cp.length!==0&&Ck.isColorProperty(Ck.getFormatPropertyKey(Cp[0]))){Cm=CJ.decodeColor(Cm);}Cp.forEach(function(Cx){var Cw=Ck.getFormatPropertyKey(Cx),Cv=Cw&&Cw.levelSelector,Cu;if(!Cw){return Ac("[Broker] Got a smart name in event but failed to locate the matched property key: "+Cx);}if(Cv&&typeof Cv==="string"){Cu=Ck.editorManager.getSelectedValue(Cv);if(!Cu){return Ac("[Broker] Failed to get selection option by selector name: "+Cv);}if(Cu.key!==Ch.key){return undefined;}}Cl.push({sn:Cx,val:Cm});});});return Cl;},getSmartNamesMapForFontGroup:function BR(Cj,Cl,Cf,Ce,Ci,Cg){var Ch=this;function Ck(Co){var Cn=Cl,Cm=Cf;if(Ce==="fld"){Cm=(Cm||"")+Co;}else{Cn=(Cn||"")+Co;}return Ch.generateSmartName(Cj,Cn,Cm,Ci,Cg);}return{fontFamily:Ck(Ay),fontStyle:Ck(R),fontSize:Ck(By),fontColor:Ck(CX)};},getSmartNamesMapForLineGroup:function CV(Cj,Cl,Cf,Ce,Ci,Cg){var Ch=this;function Ck(Co){var Cn=Cl,Cm=Cf;if(Ce==="fld"){Cm=(Cm||"")+Co;}else{Cn=(Cn||"")+Co;}return Ch.generateSmartName(Cj,Cn,Cm,Ci,Cg);}return{lineColor:Ck(Ba),lineStyle:Ck(Aj)};},getSmartNamesMapForFillGroup:function CF(Cj,Cl,Cf,Ce,Ci,Cg){var Ch=this;function Ck(Co){var Cn=Cl,Cm=Cf;if(Ce==="fld"){Cm=(Cm||"")+Co;}else{Cn=(Cn||"")+Co;}return Ch.generateSmartName(Cj,Cn,Cm,Ci,Cg);}return{fillColor:Ck(Ax),fillAlpha:Ck(n)};},getVisProfile:function BY(Ce){var Cg=this.vis,Cf=Cg.GMController.enableCombiChart?Cg.GMController.metricShapeArr:[Cg.getChartInfo().shape];switch(Ce){case B8:return Cg.getChartInfo().isBubbleOrScatter;case AA:return Cg.getChartInfo().isABL;case W:return Cg.GMController.pureAreaChart;case AI:return Cg.isSeasonalityEnabled();case BU:return Cg.getNumericAxisOptions().length>0;case Ae:return Cg.GMController.hasSizeBy();case Aa:return Cg.GMController.hasColorBy();case BT:return Cg.GMController.getBreakByAttributes().length>0;case A1:return Cg.GMController.textTypeDataLabelEnabled();case BP:return Cf.every(function(Ch){return Ch===B2.LINE||Ch===B2.TICK;});case v:return Cg.GMController.valueTypeDataLabelEnabled();case CM:return Cg.GMController.chartSubType===Ca.PERCENT;case q:return Cg.GMController.getSizeByMetrics()&&Cg.GMController.getSizeByMetrics().length>0;case K:return Cg.getChartInfo().shape===B2.LINE;case Bc:return Cg.getChartInfo().shape===B2.TICK;case CE:return Cf.every(function(Ch){return[B2.BAR,B2.AREA,B2.CIRCLE,B2.SQUARE,B2.RING,B2.PIE].indexOf(Ch)!==-1;});case Bq:return Cf.indexOf(B2.LINE)>-1||Cf.indexOf(B2.AREA)>-1;case AH:return Cg.GMController.isAxisAttributeInColorBy();case AS:return Cg.GMController.isEmptyVis();}return Ac("[Broker getVisProfile] Unrecognized profile name: "+Ce);},getOptionItems:function BB(Cf,Ce){var Cg=this.vis;switch(Cf){case A5:return B9(Cg.getEnabledReferenceLineOptions(Ce));}return Ac("[Broker getOptionItems] Unrecognized optionName: "+Cf);},getDataLabelItems:function BQ(){var Ce=this.vis.getShowDataLabelOptions(),Cf=[];(Ce||[]).forEach(function(Cg){Cf.push({n:Cg.opt,opt:Cg,isAll:Cg.key&&Cg.key==="AllMetrics"});});return Cf;},generateSmartName:function A8(Ch,Cm,Ck,Ci,Cg){function Cj(Cn){var Co=Cn.levelSelector,Cq=Co&&(Co.opt||Co.key),Cp=(Cn.namePrefix||"")+(Cn.nameSuffix||"");if(Cn.filedAlias){Cp+=CW+Cn.filedAlias;}if(Cq){Cp+=G+Cq;}return Cp;}var Cl={namePrefix:Ch,nameSuffix:Cm,filedAlias:Ck,levelSelector:Ci,target:Cg},Cf=Cj(Cl),Ce=this._smartNameToPropertyKeyLookup[Cf];if(Ce&&!Aq.equals(Ce,Cl)){Am("[Broker] smart name conflict for : "+Cf);}this._smartNameToPropertyKeyLookup[Cf]=Cl;if(Ch&&Ch.slice(-1)===An){this._dynamicPrefixToSmartNamesLookup[Ch]=this._dynamicPrefixToSmartNamesLookup[Ch]||[];this._dynamicPrefixToSmartNamesLookup[Ch].push(Cf);}return Cf;},getFormatPropertyKey:function AY(Ce){var Cf=this._smartNameToPropertyKeyLookup[Ce];if(!Cf){Am("[Broker] Format property key not found for smart name: "+Ce);}return Cf;},getDependingSelectorNames:function B1(Cf){var Cg=this.getFormatPropertyKey(Cf),Ci=[];if(!Cg){return Ci;}var Ce=Cg.namePrefix,Ch=Cg.levelSelector;if(this._dynamicPrefixToSmartNamesLookup[Ce]){Ci.push(Ce.slice(0,-1));}if(Ch&&typeof Ch==="string"){Ci.push(Ch);}return Ci;},_resolveFormatPropNameWithRuntime:function AZ(Cf){var Ce=Cf.namePrefix,Cg;if(this._dynamicPrefixToSmartNamesLookup[Ce]){Cg=this.editorManager.getSelectedValue(Ce.slice(0,-1),"prefix",Cf.nameSuffix);}else{Cg=Ce;}return(Cg||"")+Cf.nameSuffix;},_resolveLevelOptionWithRuntime:function A(Cf){var Cg=Cf.levelSelector,Ce;if(!Cg){return undefined;}if(typeof Cg==="string"){Ce=this.editorManager.getSelectedValue(Cg);if(!Ce){return Ac("[Broker] Failed to get selection option by selector name: "+Cg);}}else{Ce=Cg;}return Ce;},isColorProperty:function(Cf){var Ce=Cf.filedAlias||Cf.nameSuffix;if(Ce&&Ce.slice(-3)===Ba){return true;}return false;},getFormatPropertyValue:function BN(Cf,Ch){var Cg=this.getFormatPropertyKey(Cf);if(!Cg){return Ac("[Broker] Failed to locate a property key by smart name: "+Cf);}if(!this.editorManager){return Ac("[Broker] Editor runtime offline while trying to get property value for : "+Cf);}var Cj=this.vis,Ci,Ce,Ck;if(Cg.target===Ai){Ce=Cj.getPropertiesOfFormatable();}else{Ch=Ch||this._resolveLevelOptionWithRuntime(Cg);Ci=this._resolveFormatPropNameWithRuntime(Cg);Ce=Cj.readGlobalProperty(Ci,Ch);}if(Cg.filedAlias){if(!Ce||!Ce.jsonObj){return Ac("[Broker] Result value collection is not in expected structure for smart name: "+Cf);}Ck=Ce.jsonObj[Cg.filedAlias];}else{if(typeof Ce==="object"){return Ac("[Broker] Expect a string value while got a structure for smart name: "+Cf);}Ck=Ce;}if(Ck===undefined){Ck=Cj.getDefaultProperties()[Ci];Am("[Broker] get format value failed for smart name: "+Cf+". Fall back to default value and got: "+Ck);}if(Ck!==undefined&&this.isColorProperty(Cg)){Ck=CJ.decodeColor(Ck);}return Ck;},setFormatPropertyValue:function P(Cf,Ck,Cj,Cn){var Cl=this.getFormatPropertyKey(Cf);if(!Cl){return Ac("[Broker] Failed to locate a property key by smart name: "+Cf);}if(!this.editorManager){return Ac("[Broker] Editor runtime offline while trying to set property value for : "+Cf);}if(Ck!==undefined&&this.isColorProperty(Cl)&&Ck!==AR){Ck=CJ.encodeColor(Ck);}var Cm=this.vis,Ci,Ch=Cl.filedAlias,Cg,Ce;if(Cl.target===Ai){Cg=Cm.getPropertiesOfFormatable();}else{Cj=Cj||this._resolveLevelOptionWithRuntime(Cl);Ci=this._resolveFormatPropNameWithRuntime(Cl);Cg=Cm.readGlobalProperty(Ci,Cj);if(Ci==="refDef"){Cg.opt=Cj;}}if(Ch){if(!Cg||!Cg.jsonObj){return Ac("[Broker] Result value collection is not in expected structure for smart name: "+Cf);}Ce=Cg.jsonObj[Ch];if(Ck!==Ce){Cg.setProperty(Ch,Ck);if(Cl.target===Ai){Am("[Broker] writeFormatableProperties("+Ch+", "+Ck+")");Cm.writeFormatableProperties(Cg);}else{Am("[Broker] writeGlobalProperty("+Ci+":"+Ch+", "+Ck+", "+Cj+")");Cm.writeGlobalProperty(Ci,Cg,Cj,Cn);}}}else{if(typeof Cg==="object"){return Ac("[Broker] Expect a string value while got a structure for smart name: "+Cf);}Ce=Cg;if(Ck!==Ce){Am("[Broker] writeGlobalProperty("+Ci+", "+Ck+", "+Cj+")");Cm.writeGlobalProperty(Ci,Ck,Cj,Cn);}}}});mstrmojo.ui.editors.controls.MenuPulldown=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ui.editors.controls.MenuPulldown",markupString:'<div id="{@id}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click><div class="mstrmojo-ui-Pulldown-text">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function V(){return this.domNode.firstChild;},containerNode:function CI(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:B4.visibleMarkupMethod,onheightChange:B4.heightMarkupMethod,onwidthChange:B4.widthMarkupMethod,onvalueChange:function Bd(){this.selectedNode.innerHTML=this.getDisplayText(this.value);},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},value:undefined,anchorSlot:"selectedNode",getDisplayText:function c(Ce){return Ce||"";},onclick:function BG(){var Ce=this.getMenuConfig();if(!Ce){return ;}if(!this.isClosedByAnchor){this.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:Ce,themeClassName:mstrApp.getThemeClassName()}));}else{this.closePopup();this.isClosedByAnchor=false;}},onPopupAutoClosed:function B3(Cf,Ce){if(mstrmojo.dom.eventTarget(Ce,Cf)===this[this.anchorSlot]){this.isClosedByAnchor=true;}},getMenuConfig:CT});function e(Cf,Ce,Ch,Cg){Cf.slot="col1Node";Ce.slot="col2Node";return new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:Ch||"40%",col2Width:Cg||"60%",children:[Cf,Ce]});}function CP(){var Ce=t.call(this,mstrmojo.desc(14313,"All Graph Fonts"));return[Ce,A6.call(this,null,this.broker.getSmartNamesMapForFontGroup(Bm),{controlName:"AllTextFontGroup",groupTitle:Ce,visibleControls:X.FONT_FAMILY|X.FONT_SIZE_AND_COLOR|X.FONT_STYLE|X.FONT_SIZE_USE_STEPPER})];}function Br(){var Cw=this.broker,Cm=Cw.editorManager,Ch=Bv,Cs=Q.call(this),Co=Cw.getVisProfile(CM),Cv=Co?100:1;if(!Cs.length){return[];}function Cl(Cy,Cx){return Cw.generateSmartName(null,Cy,Cx,Ch);}function Cn(){var Cx=Cr.items[Cr.selectedIndex];return Cx._renderIdx===0||!(Cx.v.sizeBy||Cx.v.key==="SizeBy");}var Cu=t.call(this,mstrmojo.desc(13872,"Axis Configuration"),{highlightObjects:[BD.AXIS_SCALE,BD.LOG_SCALE,BD.AXIS_ORIGIN_DEFINE],scopeSelectors:[Ch]}),Cr=E.call(this,null,Ch,Cs,Cm),Ci=Cl(Bu,AV.SINGLE_AXIS_SCALE_TYPE),Ce=BL.call(this,mstrmojo.desc(13873,"Axis scale:"),Ci,{min:Cl(Bu,AV.AXIS_SCALE_REAL_MIN),max:Cl(Bu,AV.AXIS_SCALE_REAL_MAX),customMin:Cl(Bu,AV.AXIS_SCALE_MANUAL_MIN),customMax:Cl(Bu,AV.AXIS_SCALE_MANUAL_MAX)},{autoMin:Cl(Bu,AV.AXIS_SCALE_AUTO_MIN),autoMax:Cl(Bu,AV.AXIS_SCALE_AUTO_MAX)},{groupTitle:Cu}),Ck=BM.call(this,mstrmojo.desc(13874,"Log scale:"),[{n:mstrmojo.desc(10035,"Yes"),v:true},{n:mstrmojo.desc(2180,"No"),v:false}],Cl(Bu,AV.LOG_SCALE),{groupTitle:Cu,reInit:function(){this.reInitDefault();this.parent.set("enabled",!Co&&Cn());}}),Cg=Cl(p,AV.AXIS_ORIGIN_AUTO),Ct=Bz.call(this,null,Cg),Cp=Cl(p,AV.AXIS_ORIGIN_VALUE),Cj=Z.call(this,null,Cp,{listenFormatProps:[Cg],errRevert:false,useRichTooltip:true,constraints:Co?{min:-100,max:100}:{min:null,max:null},updateTooltipConfig:function(){if(this.isValid()){this.richTooltip=null;return ;}var Cx=this.validationStatus;this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:this.getInvalidMsg(Cx)};},onValid:function(){var Cx=Bk(this.value,Cv,false);if(this._sync){return ;}this.broker.setFormatPropertyValue(this.smartNames[0],Cx);},onFmtPropsChanged:function(Cy,C0){if(Cy===Cg){this.set("enabled",!C0);var Cx=C0?mstrmojo.desc(12143,"Automatic"):"";this.syncControl(function(){this.set("emptyText",Cx);if(C0){this.set("value",null);}if(C0&&this.hasRendered){this.clearValidation();}});}else{if(this.enabled){if(Cy===Cp){C0=Bk(C0,Cv,true);}this.onFmtPropsChangedDefault(Cy,C0);}}var Cz=Cn();this.parent.parent.set("enabled",Cz);this.set("enabled",Cz&&!Ct.checked);}}),Cf=this.getLabelAndControl(mstrmojo.desc(13875,"Axis origin:"),this.addDisposable(e(Ct,Cj,"20px","100%")),"40%","60%"),Cq=[Cu,Ce,Ck,Cf];if(Cr.items.length>1){CL.insert(Cq,1,[Cr]);}if(Cq.length){Cq=[this.getEditorGroup(Cq)];}return Cq;}function CO(){var Cj=this.broker,Ce=Cj.getVisProfile(Ae),Cf={trigger:mstrmojo.validation.TRIGGER.ONBLUR,min:0.01,max:1,regExp:mstrmojo.locales.number.DECIMALSEPARATOR==="."?/^\d+(\.\d{1,2})?$/:/^\d+(\,\d{1,2})?$/},Cl=Cj.getVisProfile(W),Ci=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13917,"Min size (0.01 - 1.0):")})),Cp=this.addDisposable(new mstrmojo.Label()),Ch=mstrmojo.desc(13740,"The smallest element's size is ## of the largest element's size");function Cm(Cq){return Cj.generateSmartName(null,Cq);}var Cn=Cm(AV.MAX_SIZE_TYPE),Ck=Cm(AV.MIN_SIZE_TYPE),Cg=e(BM.call(this,null,[{n:mstrmojo.desc(6019,"Automatic"),v:Bs.EnumMaxSizeType.AUTO},{n:mstrmojo.desc(8262,"Manual"),v:Bs.EnumMaxSizeType.MANUAL}],Cn,{reInit:function(){this.parent.set("enabled",!Cl);if(!Cl){this.reInitDefault();}}}),Z.call(this,null,Cm(AV.MAX_SIZE_VALUE),{constraints:Cf,listenFormatProps:[Cn],onFmtPropsChanged:function(Cq,Cr){if(Cq===Cn){this.set("enabled",Cr===Bs.EnumMaxSizeType.MANUAL);}else{this.onFmtPropsChangedDefault(Cq,B.toLocaleString(Cr));}}}),"75%","25%"),Co=e(BM.call(this,null,[{n:mstrmojo.desc(11990,"Proportional"),v:Bs.EnumMinSizeType.PROPORTIONAL},{n:mstrmojo.desc(13741,"Full Range"),v:Bs.EnumMinSizeType.AUTO},{n:mstrmojo.desc(14118,"Adjusted Range"),v:Bs.EnumMinSizeType.MANUAL}],Ck,{reInit:function(){var Cq=!Cl&&Ce;this.parent.set("enabled",Cq);Ci.set("enabled",Cq);if(Cq){this.reInitDefault();}},onFmtPropsChanged:function(Cq,Cr){this.onFmtPropsChangedDefault(Cq,Cr);if(Cr===Bs.EnumMinSizeType.PROPORTIONAL){Cp.set("text",mstrmojo.desc(13743,"The smallest element's size is proportional to its data element"));}else{if(Cr===Bs.EnumMinSizeType.AUTO){Cp.set("text",mstrmojo.desc(13744,"The smallest element's size is fixed, independent of its data value"));}}}}),Z.call(this,null,Cm(AV.MIN_SIZE_VALUE),{constraints:Cf,listenFormatProps:[Ck],onFmtPropsChanged:function(Cq,Cs){if(!Ce){this.set("enabled",false);return ;}if(Cq===Ck){var Cr=Cs===Bs.EnumMinSizeType.MANUAL;this.set("enabled",Cr);if(Cr){Cp.set("text",Ch.replace("##",this.value*100+"%"));}}else{this.onFmtPropsChangedDefault(Cq,B.toLocaleString(Cs));if(this.enabled){Cp.set("text",Ch.replace("##",Cs*100+"%"));}}}}),"75%","25%");this.addDisposable([Cg,Co]);return[this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13918,"Max size (0.01 - 1.0):")})),Cg,Ci,Co,Cp];}function I(){var Ce=this.broker;function Cf(Cg){return Ce.generateSmartName(null,Cg);}return[BM.call(this,mstrmojo.desc(2776,"Fit to:"),[{n:mstrmojo.desc(5374,"Content"),v:Bs.EnumFitTo.CONTENT},{n:mstrmojo.desc(11917,"Container"),v:Bs.EnumFitTo.PANEL},{n:mstrmojo.desc(14445,"Container (Compact)"),v:Bs.EnumFitTo.COMPACT}],Cf(AV.FIT_TO),undefined,["20%","80%"]),this.getLabelAndControl(mstrmojo.desc(13745,"Banding on rows"),Bz.call(this,null,Cf(AV.BANDING)),"20px","100%",true)];}function AU(Cf){var Ce=Br.call(this);this.replaceChildControls(Cf,Ce.concat([this.getEditorGroup(CO.call(this),A3),this.getEditorGroup(I.call(this),A3),this.getEditorGroup(CP.call(this),A3),this.getEditorGroup([this.getMoreOptionsEditorLink(this.getHost().model.data.gsi.prop)],A3)]));}function A2(Cv){var C7=this.broker,Cy=C7.editorManager,Cm=Ak,Cw=AV.TREND_LINE_DEF,Cr=Cd.call(this),Cu=CJ.isTrendLineAvailableForAnyMetric(C7.vis);function Cq(DA,DB){return C7.generateSmartName(null,Cw,DA,DB);}function Ce(DA){return{listenFormatProps:[DA],onFmtPropsChanged:function(DB,DC){if(DB===DA){this.getCtrlContainer().set("enabled",DC&&Cu);}else{this.onFmtPropsChangedDefault(DB,DC);}}};}function Cl(){return(Cr||[]).some(function(DA){return C7.getFormatPropertyValue(Ct,DA.v);});}var Ct=Cq(AV.TREND_ENABLED,Cm),Cz=E.call(this,null,Cm,Cr,Cy,{highlightObjects:[BD.TREND_LINE],enabled:Cu,updateSelection:function Cx(DB,DD){var DC=DD[0].tlOpt.key,DA=-1;CL.forEach(this.items,function(DF,DE){if(DF.v.key===DC){DA=DE;return false;}});Ap(this,function(){this.set("selectedIndex",DA);});}}),Ci=Bz.call(this,mstrmojo.desc(13746,"Enable Trend Line"),Ct),C5=B7.call(this,null,C7.getSmartNamesMapForLineGroup(null,Cw,"trdRefLn","fld",Cm),Aq.copy({lineTitle:mstrmojo.desc(13927,"Line:"),controlName:"TrendLineLineGoup",showNoneOption:false,showNoFillInColor:false,showGradient:!C7.getVisProfile(AH)},Ce(Ct))),Ck=Cq(AV.TREND_TYPE,Cm),Ch=BM.call(this,mstrmojo.desc(13876,"Model:"),[{n:mstrmojo.desc(13877,"Best fit"),v:Bs.EnumTrendLineModelType.BEST_FIT},{n:mstrmojo.desc(4888,"Linear"),v:Bs.EnumTrendLineModelType.LINEAR},{n:mstrmojo.desc(12021,"Logarithmic"),v:Bs.EnumTrendLineModelType.LOG},{n:mstrmojo.desc(12022,"Exponential"),v:Bs.EnumTrendLineModelType.EXP},{n:mstrmojo.desc(12023,"Power"),v:Bs.EnumTrendLineModelType.POW},{n:mstrmojo.desc(12024,"Polynomial"),v:Bs.EnumTrendLineModelType.POLY}],Ck,Aq.copy(Ce(Ct))),Cf=BM.call(this,mstrmojo.desc(13919,"Degree:"),[{n:"2",v:2},{n:"3",v:3},{n:"4",v:4},{n:"5",v:5},{n:"6",v:6}],Cq(AV.TREND_POLY_DEGREE,Cm),{listenFormatProps:[Ct,Ck],onFmtPropsChanged:function(DA,DB){if(DA===Ct){this.set("enabled",DB&&Cu);}else{if(DA===Ck){this.parent.set("visible",DB===Bs.EnumTrendLineModelType.POLY);}else{this.onFmtPropsChangedDefault(DA,DB);}}}},{curVal:2,min:2,max:6}),C9=BM.call(this,mstrmojo.desc(1452,"Level:"),Au,Cq(AV.TREND_LEVEL,Cm),{listenFormatProps:[Ct],onFmtPropsChanged:function C2(DB,DD){if(DB===Ct){var DC=C7.vis.GMController,DA=DC.hasAttributesInDropzone("Rows")||DC.hasAttributesInDropzone("Columns");this.parent.set("enabled",Cu&&DA&&DD);}else{this.onFmtPropsChangedDefault(DB,DD);}}}),Cp=[Ci,C5,Ch,Cf,C9],Cs;Ci.set("enabled",Cu);if(Cz.items.length>1){CL.insert(Cp,0,[Cz]);}mstrmojo.css.addWidgetCssClass(Ci,"title");if(C7.getVisProfile(AA)){var Co=Bz.call(this,mstrmojo.desc(13878,"Include Break-by Attribute"),Cq(AV.TREND_INCLUDE_BREAK_BY,Cm),{listenFormatProps:[Ct],onFmtPropsChanged:function(DA,DB){if(!C7.getVisProfile(BT)){this.parent.set("enabled",false);}else{if(DA===Ct){this.parent.set("enabled",DB&&Cu);}else{this.onFmtPropsChangedDefault(DA,DB);}}}});CL.insert(Cp,Cp.length,[Co]);var Cj=Cq(AV.TREND_FORECAST_ENABLED),C4=Bz.call(this,mstrmojo.desc(12026,"Enable Forecasting"),Cj,{listenFormatProps:[Ct],onFmtPropsChanged:function(DA,DB){if(DA===Ct){this.parent.set("enabled",Cu&&Cl());}else{this.onFmtPropsChangedDefault(DA,DB);}}});var C3=function(){return{listenFormatProps:[Ct,Cj],onFmtPropsChanged:function(DA,DB){if(DA===Ct||DA===Cj){this.parent.set("enabled",Cu&&C7.getFormatPropertyValue(Cj)&&Cl());}else{this.onFmtPropsChangedDefault(DA,DB);}}};};var Cn=AL.call(this,mstrmojo.desc(13879,"Forward:"),Cq(AV.TREND_FWD_FORECAST),C3()),Cg=AL.call(this,mstrmojo.desc(13880,"Backward:"),Cq(AV.TREND_BWD_FORECAST),C3()),C1=BM.call(this,mstrmojo.desc(13881,"Seasons:"),[{n:mstrmojo.desc(5949,"None"),v:Bs.EnumTimeRole.None},{n:mstrmojo.desc(10048,"Week"),v:Bs.EnumTimeRole.DayOfWeek},{n:mstrmojo.desc(871,"Month"),v:Bs.EnumTimeRole.DayOfMonth},{n:mstrmojo.desc(10050,"Quarter"),v:Bs.EnumTimeRole.MonthOfQuarter},{n:mstrmojo.desc(873,"Year"),v:Bs.EnumTimeRole.MonthOfYear},{n:mstrmojo.desc(13748,"Decade"),v:Bs.EnumTimeRole.YearOfDecade}],Cq(AV.TREND_SEASONALITY),{listenFormatProps:[Ct,Ck],onFmtPropsChanged:function(DA,DB){if(DA===Ck||DA===Ct){this.parent.set("enabled",Cu&&C7.getVisProfile(AI)&&Cl());}else{this.onFmtPropsChangedDefault(DA,DB);}}});Aq.copy({useRichTooltip:true,updateTooltipConfig:function C0(){this.richTooltip=this.enabled?null:{content:mstrmojo.desc(14314,"This option is available only when a time based attribute is placed on the axis"),refNode:this.domNode,cssClass:"vi-regular",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,top:18,left:70};}},C1);mstrmojo.css.addWidgetCssClass(C4,"title");Cs=[this.getEditorGroup(Cp,Bn),this.getEditorGroup([C4,Cn,Cg],Bn),this.getEditorGroup([C1],Bn)];}else{var C6=t.call(this,mstrmojo.desc(13932,"Forecasting")),C8=Bp.call(this,Ct,{groupTitle:C6,onFmtPropsChanged:function(){var DA=Cu&&Cl();this.set("enabled",DA);C6.set("enabled",DA);}});Cs=[this.getEditorGroup(Cp,Bn)].concat(this.getEditorGroup([C6,C8],Bn));}this.replaceChildControls(Cv,Cs);}function J(Cs){var Cx=this.broker,Cw=Cx.editorManager,Ct=AV.REF_LINE_DEF,Cv=l,Ce=A5,Cp=Cx.generateSmartName(null,Ct,AV.REF_ENABLED),Cl=Cx.generateSmartName(null,Ct,AV.REF_LINE_NAME),Cz=!Cx.getVisProfile(CM),Cn={reInit:function(){var C0=this.manager.getSelectedValue(Ce,"v");this.getCtrlContainer().set("enabled",!!C0&&Cz);if(this.controlName==="ReferenceLineLabelCharacterGroup"){var C1=parseInt(this.fontSize.selectedValue,10).toString();this.fontSize.set("selectedValue",C1);}if(C0){this.reInitDefault();}else{Ap(this,function(){this.resetValue();});}}};function Co(C0){return Cx.generateSmartName(null,Ct,C0,Ce);}var Cr=Av.call(this),Cg=E.call(this,null,Cv,Cr,Cw,{enabled:Cz}),Cq=Bt.call(this,null,Cr[0].v,Ce,[Cp,Cl],{restrictedTypes:Cx.getVisProfile(B8)?[Bs.EnumRefLineModelType.FIRST,Bs.EnumRefLineModelType.LAST]:[],listenSelector:[Cv],highlightObjects:[BD.REF_LINE],enabled:Cz,updateSelection:function Cu(C0,C1){var C4=C1[0],C3=C4.key,C2=C1[0].tlOpt.key;Ap(Cg,function(){var C5=-1;CL.forEach(Cg.items,function(C7,C6){if(C7.v.key===C3){C5=C6;return false;}});Cg.set("selectedIndex",C5);});Ap(this,function(){this.selectItemByField("key",C2);});}}),Cj=B7.call(this,null,Cx.getSmartNamesMapForLineGroup(null,Ct,"trdRefLn","fld",Ce),Aq.copy(Cn,{lineTitle:mstrmojo.desc(13927,"Line:"),controlName:"ReferenceLineLineGroup",showNoneOption:false,showNoFillInColor:false,showGradient:!Cx.getVisProfile(AH),resetValue:function Ch(){this.lineColorAndStyle.lineColor.set("color","#000000");this.lineColorAndStyle.lineStyle.set("selectedValue","none");}})),Ci=BM.call(this,mstrmojo.desc(1452,"Level:"),Au,Co(AV.REF_LEVEL),{reInit:function(){var C2=this.manager.getSelectedValue(Ce,"v"),C1=Cx.vis.GMController,C0=Cz&&(C1.hasAttributesInDropzone("Rows")||C1.hasAttributesInDropzone("Columns"))&&(C2&&C2.refType!==Bs.EnumRefLineModelType.CONST);if(this.parent){this.parent.set("enabled",C0);}if(C0){this.reInitDefault();}if(!C2){Ap(this,function(){this.resetValue();});}},resetValue:function Ch(){this.set("selectedIndex",0);}}),Cf=Co(AV.REF_SHOW_LABEL),Cm=Bz.call(this,mstrmojo.desc(13749,"Show label"),Cf,Aq.copy(Cn,{resetValue:function Ch(){this.set("checked",false);}})),Cy=Ao.call(this,null,[{n:mstrmojo.desc(8733,"Type"),v:Bs.EnumTrendRefModelLabels.DssModelLabelsType},{n:mstrmojo.desc(4779,"Metric"),v:Bs.EnumTrendRefModelLabels.DssModelLabelsMetric},{n:mstrmojo.desc(527,"Value"),v:Bs.EnumTrendRefModelLabels.DssModelLabelsValue}],Co(AV.REF_LABEL_TYPE),Aq.copy(Cn,{listenFormatProps:[Cf],onFmtPropsChanged:function(C0,C1){if(C0===Cf){var C2=this.manager.getSelectedValue(Ce,"v");this.set("enabled",!!C2&&C1&&Cz);}else{this.onFmtPropsChangedDefault(C0,C1);}},multiSelect:true,resetValue:function Ch(){this.clearSelect();}})),Ck=A6.call(this,null,Cx.getSmartNamesMapForFontGroup(null,Ct,"rfLn","fld",Ce),Aq.copy(Cn,{controlName:"ReferenceLineLabelCharacterGroup",syncWithAllText:true,listenFormatProps:[Cf],onFmtPropsChanged:function(C0,C2){if(C0===Cf){var C3=this.manager.getSelectedValue(Ce,"v"),C1=!!C3&&C2&&Cz;this.set("enabled",C1);if(C1){this.refreshValues();}}else{if(this.enabled){this.onFmtPropsChangedDefault(C0,C2);}}},resetValue:function Ch(){this.fontColor.set("selectedValue","#000000");this.fontStyle.clearSelect();this.fontSize.set("selectedValue","10");this.fontFamily.set("selectedIndex",0);}}));mstrmojo.css.addWidgetCssClass(Cm,"title");this.replaceChildControls(Cs,[this.getEditorGroup([Cg,Cq,Cj,Ci],Bn),this.getEditorGroup([Cm,Cy,Ck],Bn)]);}function AM(Ch){var Cg=this.broker;function Ci(Cn){return Cg.generateSmartName(null,Cn);}var Ck=Ci(AV.LEGEND_VISIBLE),Cj=function(Co,Cq){if(Co===Ck){var Cp=this.parent,Cn=this;if(Cp&&Cp.scriptClass==="mstrmojo.ui.editors.controls.TwoColumnContainer"){Cn=Cp;}Cn.set("enabled",!!Cq);}else{this.onFmtPropsChangedDefault(Co,Cq);}},Cf=Bz.call(this,mstrmojo.desc(13600,"Show legend"),Ck),Cm=A6.call(this,null,Cg.getSmartNamesMapForFontGroup(k),{controlName:"LegendTextFongGroup",syncWithAllText:true,listenFormatProps:[Ck],onFmtPropsChanged:Cj}),Cl=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13601,"Fill:")})),Ce=Cb.call(this,null,Cg.getSmartNamesMapForFillGroup(BX),{controlName:"LegendBackgroundFillGroup",listenFormatProps:[Ck],onFmtPropsChanged:Cj});mstrmojo.css.addWidgetCssClass(Cf,"title");this.replaceChildControls(Ch,[this.getEditorGroup([Cf,Cm,Cl,Ce],Bn)]);}function Af(){var Cl=this.broker,Ci=BF,Cm=Ci+An;function Cr(Cu){return Cl.generateSmartName(Cm,Cu);}function Co(Cu){return(Cu.TemplateMetric!==undefined)||(Cu.TemplateUnit!==undefined)||(Cu.MetricNames!==undefined);}var Ct=Cl.vis.model.data.dz,Cj=Co(Ct.XAxis),Ch=Co(Ct.YAxis),Cs=Cj&&Ch,Cp=[],Cn=[];if(Cs){Cn.push((BD.X_CATEGORY|BD.Y_CATEGORY));Cp.push({n:mstrmojo.desc(13920,"X and Y axes"),identity:(BD.X_CATEGORY|BD.Y_CATEGORY),prefix:BH,v:0});}if(Cj){Cn.push(BD.X_CATEGORY);Cp.push({n:mstrmojo.desc(13921,"X axis"),identity:BD.X_CATEGORY,prefix:BZ,v:1});}if(Ch){Cn.push(BD.Y_CATEGORY);Cp.push({n:mstrmojo.desc(13922,"Y axis"),identity:BD.Y_CATEGORY,prefix:M,v:2});}var Cf=Cr(BV),Ce=t.call(this,mstrmojo.desc(12003,"Axis Labels"),{highlightObjects:Cn,scopeSelectors:[Ci]}),Cg=E.call(this,null,Ci,Cp,Cl.editorManager,{highlightObjects:Cn,groupTitle:Ce}),Cq=Bz.call(this,mstrmojo.desc(13923,"Show labels"),Cf,{groupTitle:Ce}),Ck=Cr(A7);return[Ce,Cg,Cq,A6.call(this,null,Cl.getSmartNamesMapForFontGroup(Cm),{controlName:"AxisLabelsFontGroup",syncWithAllText:true,groupTitle:Ce,listenFormatProps:[Cf],showNoFillInColor:false,onFmtPropsChanged:function(Cu,Cv){if(Cu===Cf){this.set("enabled",Cv);}else{this.onFmtPropsChangedDefault(Cu,Cv);}}}),BM.call(this,mstrmojo.desc(13924,"Rotation:"),[{n:mstrmojo.desc(12284,"Automatic"),v:Bs.EnumLabelRotation.AUTOMATIC},{n:mstrmojo.desc(12285,"Vertical"),v:Bs.EnumLabelRotation.VERTICAL},{n:mstrmojo.desc(12286,"Horizontal"),v:Bs.EnumLabelRotation.HORIZONTAL}],Ck,{groupTitle:Ce,listenFormatProps:[Cf],onFmtPropsChanged:function(Cv,Cw){var Cx=Cg.selectedIndex===1,Cu=Cq.getCtrl().checked;if(Cv===Cf||Cv===Ck){this.parent.set("enabled",Cu&&Cx);}if(Cv===Ck&&Cw){this.onFmtPropsChangedDefault(Cv,Cw);}}})];}function CN(){var Cj=this.broker,Co=Cj.editorManager,Ch=AF,Ck=Ch+An,Ce=t.call(this,mstrmojo.desc(12008,"Axis Lines"),{highlightObjects:[(BD.X_AXIS|BD.Y_AXIS|BD.AXIS_ORIGIN),(BD.X_AXIS|BD.Y_AXIS),BD.X_AXIS,BD.Y_AXIS,BD.AXIS_ORIGIN],scopeSelectors:[Ch]}),Cm=[{n:mstrmojo.desc(13925,"All lines"),identity:(BD.X_AXIS|BD.Y_AXIS|BD.AXIS_ORIGIN),prefix:"allLn",v:0},{n:mstrmojo.desc(13920,"X and Y axes"),identity:(BD.X_AXIS|BD.Y_AXIS),prefix:"allAxLn",v:1},{n:mstrmojo.desc(13921,"X axis"),identity:BD.X_AXIS,prefix:"xAxLn",v:2},{n:mstrmojo.desc(13922,"Y axis"),identity:BD.Y_AXIS,prefix:"yAxLn",v:3}],Cl={n:mstrmojo.desc(13926,"Axis origin"),identity:BD.AXIS_ORIGIN,prefix:"axOriLn",v:4},Ci=Q.call(this);if(Ci&&Ci.length>0){var Cn=Cj.generateSmartName(null,p,AV.AXIS_ORIGIN_AUTO,Bv),Cp=Cj.getFormatPropertyValue(Cn,Ci[0].v);if(!Cp){Cm.push(Cl);}}var Cg=E.call(this,null,AF,Cm,Co,{highlightObjects:[(BD.X_AXIS|BD.Y_AXIS|BD.AXIS_ORIGIN),(BD.X_AXIS|BD.Y_AXIS),BD.X_AXIS,BD.Y_AXIS,BD.AXIS_ORIGIN],groupTitle:Ce}),Cf=B7.call(this,null,Cj.getSmartNamesMapForLineGroup(Ck),{lineTitle:mstrmojo.desc(13927,"Line:"),controlName:"AxisLineGroup",groupTitle:Ce,showNoFillInColor:false,showNoneOption:false,showGradient:false,onSelectorsValueChanged:function(Cq,Cr){if(Cq===AF){this.set("showNoneOption",Cr!==4&&Cr!==0);}this.onSelectorsValueChangedDefault(Cq,Cr);}});return[Ce,Cg,Cf];}function AD(){var Cl=this.broker,Cs=Cl.editorManager,Cj=Al,Cm=Cj+An,Ce=t.call(this,mstrmojo.desc(12010,"Axis Titles"),{highlightObjects:[CJ.longIntOr(BD.X_METRIC_AXIS_TITLE,BD.Y_METRIC_AXIS_TITLE),BD.X_METRIC_AXIS_TITLE,BD.Y_METRIC_AXIS_TITLE],scopeSelectors:[Cj]});var Cf=[],Cq={XAxisTitle:{n:mstrmojo.desc(13921,"X axis"),identity:BD.X_METRIC_AXIS_TITLE,prefix:"xAxTt",v:1},YAxisTitle:{n:mstrmojo.desc(13922,"Y axis"),identity:BD.Y_METRIC_AXIS_TITLE,prefix:"yAxTt",v:2},XAndYAxesTitle:{n:mstrmojo.desc(13920,"X and Y axes"),identity:CJ.longIntOr(BD.X_METRIC_AXIS_TITLE,BD.Y_METRIC_AXIS_TITLE),prefix:"allAxTt",v:0}},Cr=Cl.vis.GMController,Co=Cr.haveMetricAxisTitle("y"),Ck=Cr.haveMetricAxisTitle("x");Co=Co||Cr.haveAttributeAxisTitle("y");Ck=Ck||Cr.haveAttributeAxisTitle("x");if(Co){Cf.unshift(Cq.YAxisTitle);}if(Ck){Cf.unshift(Cq.XAxisTitle);}if(Co&&Ck){Cf.unshift(Cq.XAndYAxesTitle);}var Cp=Cf.length===0,Ci=E.call(this,null,Cj,Cf,Cs,{highlightObjects:[CJ.longIntOr(BD.X_METRIC_AXIS_TITLE,BD.Y_METRIC_AXIS_TITLE),BD.X_METRIC_AXIS_TITLE,BD.Y_METRIC_AXIS_TITLE],groupTitle:Ce,enabled:!Cp}),Cn=Cl.generateSmartName(Cm,BV),Ch=Bz.call(this,mstrmojo.desc(13928,"Show axis titles"),Cn,{groupTitle:Ce}),Cg=A6.call(this,null,Cl.getSmartNamesMapForFontGroup(Cm),Cp?null:{controlName:"AxisTitlesFontGroup",groupTitle:Ce,syncWithAllText:true,listenFormatProps:[Cn],onFmtPropsChanged:function(Ct,Cu){if(Ct===Cn){this.set("enabled",Cu);}else{this.onFmtPropsChangedDefault(Ct,Cu);}}});Ce.set("enabled",!Cp);Ch.set("enabled",!Cp);Cg.set("enabled",!Cp);return[Ce,Ci,Ch,Cg];}function Ag(){var Ci=this.broker,Cm=Ci.editorManager,Cg=CD,Cj=Ci.generateSmartName(null,Cc.ALL_GRID_LINES_SHOW);var Ce=t.call(this,mstrmojo.desc(11991,"Grid Lines"),{highlightObjects:[(BD.GRID_LINE|BD.MINOR_GRID_LINE),BD.GRID_LINE,BD.MINOR_GRID_LINE],scopeSelectors:[Cg]}),Ch=BM.call(this,null,[{n:mstrmojo.desc(6019,"Automatic"),v:Bs.EnumGridLines.AUTO},{n:mstrmojo.desc(13929,"Show major and minor"),v:Bs.EnumGridLines.SHOW},{n:mstrmojo.desc(13930,"Show major only"),v:Bs.EnumGridLines.SHOW_MAJOR_ONLY},{n:mstrmojo.desc(2772,"Hide"),v:Bs.EnumGridLines.HIDE}],Cj,{groupTitle:Ce,fnChange:function(Co){Cm.onTargetSelectionChanged(Cg,Co);Cm.sendNonShapeTargetSelectionIdentity(Cg);if(this._sync){return ;}Ci.setFormatPropertyValue(Cj,Co);}});Cm.registerSelector(Cg,Ch);var Cf=Ci.generateSmartName(BF+An,BV),Ck=Ci.generateSmartName(BZ,BV),Cn=Ci.generateSmartName(M,BV);var Cl=B7.call(this,null,Ci.getSmartNamesMapForLineGroup(null,"allGridLn"),{lineTitle:mstrmojo.desc(13927,"Line:"),controlName:"GridLineGroup",showNoneOption:false,groupTitle:Ce,showNoFillInColor:false,listenFormatProps:[Cf,Cj],showGradient:false,onFmtPropsChanged:function(Cp,Cu){if(Cp===Cf||Cp===Cj){var Co=true,Cq=Ci.getFormatPropertyValue(Ck),Cv=Ci.getFormatPropertyValue(Cn);if(Ci.getVisProfile(B8)&&!Cq&&!Cv){Co=false;}else{if(Ci.getVisProfile(AA)){var Cs=Ci.vis.getChartInfo();if(Cs.dirc===Bs.EnumABLDirection.HORIZONTAL&&!Cq){Co=false;}else{if(Cs.dirc===Bs.EnumABLDirection.VERTICAL&&!Cv){Co=false;}}}}this.getCtrlContainer().parent.set("enabled",Co);var Cr=Ci.getFormatPropertyValue(Cj),Ct=(Cr===Bs.EnumGridLines.AUTO&&!Ci.vis.isMajorGridLineShow())||Cr===Bs.EnumGridLines.HIDE;this.getCtrlContainer().set("enabled",Co&&!Ct);}else{this.onFmtPropsChangedDefault(Cp,Cu);}}});return[Ce,Ch,Cl];}function B6(Ce){this.replaceChildControls(Ce,[this.getEditorGroup(Af.call(this),A3),this.getEditorGroup(CN.call(this),A3),this.getEditorGroup(AD.call(this),Aq.copy(A3,CH)),this.getEditorGroup(Ag.call(this),A3)]);}function d(){var Cm=this.broker,Cr=Cm.editorManager,Ck=F,Cn=Ck+An,Cf=Co(BV);function Cl(){return{highlightObjects:[(BD.ROW_HEADER|BD.COL_HEADER|BD.ROW_TITLE|BD.COL_TITLE),(BD.ROW_HEADER|BD.ROW_TITLE),(BD.COL_HEADER|BD.COL_TITLE),BD.ROW_TITLE,BD.COL_TITLE,BD.ROW_HEADER,BD.COL_HEADER]};}function Co(Cs){return Cm.generateSmartName(Cn,Cs);}function Cj(){return{listenFormatProps:[Cf],onFmtPropsChanged:function(Cs,Ct){if(Cs===Cf){this.getCtrlContainer().set("enabled",Ct);}else{this.onFmtPropsChangedDefault(Cs,Ct);}}};}var Ce=t.call(this,mstrmojo.desc(1013,"Text"),Aq.copy(Cl(),{scopeSelectors:[Ck]})),Ci=E.call(this,null,Ck,[{n:mstrmojo.desc(3524,"All"),identity:(BD.ROW_HEADER|BD.COL_HEADER|BD.ROW_TITLE|BD.COL_TITLE),prefix:"allRwCol",v:0},{n:mstrmojo.desc(13665,"Row Text"),identity:(BD.ROW_HEADER|BD.ROW_TITLE),prefix:BJ,v:1},{n:mstrmojo.desc(13666,"Column Text"),identity:(BD.COL_HEADER|BD.COL_TITLE),prefix:z,v:2},{n:mstrmojo.desc(12014,"Row Headers"),identity:BD.ROW_TITLE,prefix:A4,v:3},{n:mstrmojo.desc(12015,"Column Headers"),identity:BD.COL_TITLE,prefix:Be,v:4},{n:mstrmojo.desc(12016,"Row Values"),identity:BD.ROW_HEADER,prefix:"rwVl",v:5},{n:mstrmojo.desc(12017,"Column Values"),identity:BD.COL_HEADER,prefix:"colVl",v:6}],Cr,Aq.copy(Cl(),{groupTitle:Ce})),Ch=Bz.call(this,mstrmojo.desc(14315,"Show text"),Cf,{groupTitle:Ce}),Cg=A6.call(this,null,Cm.getSmartNamesMapForFontGroup(Cn,"Txt"),Aq.copy(Cj(),{controlName:"RowsAndColsFontGroup",groupTitle:Ce,syncWithAllText:true})),Cq=Ao.call(this,mstrmojo.desc(3498,"Align"),[{n:mstrmojo.desc(3049,"Left"),v:Bs.EnumTextAlignH.LEFT,css:"left"},{n:mstrmojo.desc(2193,"Center"),v:Bs.EnumTextAlignH.MIDDLE,css:"center"},{n:mstrmojo.desc(2166,"Right"),v:Bs.EnumTextAlignH.RIGHT,css:"right"}],Co(CU),Aq.copy(Cj(),{cssClass:"txtAlign",showIcon:true,groupTitle:Ce})),Cp=Ao.call(this,"",[{n:mstrmojo.desc(2256,"Top"),v:Bs.EnumTextAlignV.TOP,css:"top"},{n:mstrmojo.desc(8631,"Middle"),v:Bs.EnumTextAlignV.MIDDLE,css:"middle"},{n:mstrmojo.desc(2257,"Bottom"),v:Bs.EnumTextAlignV.BOTTOM,css:"bottom"}],Co(BS),Aq.copy(Cj(),{cssClass:"verticalAlign",showIcon:true,groupTitle:Ce}));return[Ce,Ci,Ch,Cg,Cq,Cp];}function AG(){var Ch=this.broker,Ck=Ch.editorManager,Ci=BK,Ce=Ci+An,Cj=BI+An;var Cg=t.call(this,mstrmojo.desc(3905,"Background"),{highlightObjects:[BD.ROWS_BACKGROUND,BD.COLS_BACKGROUND],scopeSelectors:[Ci]}),Cf=Ch.getSmartNamesMapForFillGroup(Ce);return[Cg,E.call(this,null,Ci,[{n:mstrmojo.desc(2968,"Rows"),prefix:A4,identity:BD.ROWS_BACKGROUND,v:0},{n:mstrmojo.desc(122,"Columns"),prefix:Be,identity:BD.COLS_BACKGROUND,v:1}],Ck,{highlightObjects:[BD.ROWS_BACKGROUND,BD.COLS_BACKGROUND],groupTitle:Cg}),Cb.call(this,mstrmojo.desc(2885,"Fill"),Cf,{listenFormatProps:Aq.valarray(this.broker.getSmartNamesMapForFillGroup(Cj)),controlName:"BackgroundFillGroup",groupTitle:Cg,showGradient:!Ch.getVisProfile(AH)})];}function AO(){var Cf=this.broker,Ci=Cf.editorManager,Cg=Bf,Ce=Cg+An;var Ch=t.call(this,mstrmojo.desc(12050,"Matrix Lines"),{highlightObjects:[(BD.H_MATRIX_LINE|BD.V_MATRIX_LINE),BD.H_MATRIX_LINE,BD.V_MATRIX_LINE],scopeSelectors:[Cg]});return[Ch,E.call(this,null,Cg,[{n:mstrmojo.desc(11998,"All Matrix Lines"),prefix:"allMatrixLn",identity:(BD.H_MATRIX_LINE|BD.V_MATRIX_LINE),v:0},{n:mstrmojo.desc(11999,"Horizontal Matrix Lines"),prefix:"hMatrixLn",identity:BD.H_MATRIX_LINE,v:1},{n:mstrmojo.desc(12000,"Vertical Matrix Lines"),prefix:"vMatrixLn",identity:BD.V_MATRIX_LINE,v:2}],Ci,{highlightObjects:[(BD.H_MATRIX_LINE|BD.V_MATRIX_LINE),BD.H_MATRIX_LINE,BD.V_MATRIX_LINE],groupTitle:Ch}),B7.call(this,null,Cf.getSmartNamesMapForLineGroup(Ce),{lineTitle:mstrmojo.desc(13927,"Line:"),controlName:"MatrixLineGroup",groupTitle:Ch,showNoFillInColor:false,showGradient:!Cf.getVisProfile(AH)})];}function CY(Ce){this.replaceChildControls(Ce,[this.getEditorGroup(d.call(this),Bn),this.getEditorGroup(AG.call(this),A3),this.getEditorGroup(AO.call(this),A3)]);}function H(Ce){var Cg=this.broker.vis,Cf=CR(Cg.zonesModel,mstrmojo.vi.viz.EnumDSSDropZones.ColorBy);return this.getLabelAndControl(mstrmojo.desc(6242,"Color"),this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13174,"Select color ranges..."),cssText:"text-decoration: underline;cursor: pointer;",postclick:Ce,onclick:function(){Cg.model.openThresholdEditor(Cf[0],true,false);}})),"30%","70%");}function Ad(){var Cg,Cf=[],Ch=[],Ce=this.getHost().getStyleEffectsOptions(),Ci=false;Ce.forEach(function(Ck){var Cj=Ck.optLvl;if(Cj===B0.ALL_SHAPE){Cg=Ck;}else{if(Cj===B0.METRIC){Cf.push(Ck);}else{if(Cj===B0.COLOR_BY){if(Ck.isMetricNames){Ci=true;}Ch=Ck.subOptions||[];}}}});if(Ci){Cf=[];}return{allItem:Cg,metricItems:Cf,colorByItems:Ch,originCollection:Ce};}function BA(){var Cg=this.getHost(),Cq=this.broker,C4=Cq.editorManager,C0=CR(Cq.vis.zonesModel,mstrmojo.vi.viz.EnumDSSDropZones.ColorBy).length>0,Cw=Cg.isShapeCombonation(),Cx=Cw.isComb,Co=Ad.call(this),DA=Co.allItem,Cs=Co.metricItems,Ck=Co.colorByItems;var DC="ShapeFormatting";function Cz(DE){return Cq.generateSmartName(null,DC,DE,null,Ai);}function Cm(DE){return Cz(Cq.getFormatPropertyKey(DE).filedAlias+Ab);}function C2(){return function(){r(C4).call(this);C4.sendShapeOption();};}var Ci=t.call(this,mstrmojo.desc(13751,"Shape Formatting")),Cj=AC.call(this,{allItem:DA,metricItems:Cs,colorByItems:Ck},{groupTitle:Ci,postclick:C2(C4)}),Cn=[];function C8(){var DE=[B2.AREA,B2.LINE];if(Cq.getVisProfile(AA)){DE=[];}else{if(Cq.getVisProfile(B8)){DE.push(B2.BAR);}}return CL.filter([{n:mstrmojo.desc(12097,"Bar"),v:B2.BAR},{n:mstrmojo.desc(12098,"Line"),v:B2.LINE},{n:mstrmojo.desc(12099,"Area"),v:B2.AREA},{n:mstrmojo.desc(12100,"Circle"),v:B2.CIRCLE},{n:mstrmojo.desc(12101,"Square"),v:B2.SQUARE},{n:mstrmojo.desc(12102,"Tick"),v:B2.TICK},{n:mstrmojo.desc(12103,"Ring"),v:B2.RING},{n:mstrmojo.desc(12104,"Pie"),v:B2.PIE}],function(DF){return DE.indexOf(DF.v)===-1;});}var C3=[B2.BAR,B2.AREA,B2.CIRCLE,B2.SQUARE],Cf=[B2.LINE,B2.TICK],Ct=function Ct(){var DE=Cj.value&&Cj.value.optLvl;return(Ck.length>0&&DE!==B0.ALL_SHAPE&&DE!==B0.METRIC)||(Ck.length===0&&DE===B0.ALL_SHAPE);},DD=function DD(DH,DE){if(DE){Aq.copy({col1Node:"58%",col2Node:"42%"},DH.layoutConfig.w);var DF=3;Aq.copy({cssText:"margin-left: "+DF+"px;",getLayoutOffsets:function DG(){return{h:0,w:DF};}},DH.getCtrl());}return DH;};function Cu(DG,DE,DJ,DK){var DI={postclick:C2(C4),groupTitle:Ci,preBuildRendering:CT,onRender:function(){this.reInit();}},DF=Cm(DE);if(!DG){Aq.copy({reInit:function(){var DL=Ct();if(DJ){this.getCtrlContainer().set("enabled",DL);}else{this.setChildEnable(Ba,DL);}this.reInitDefault();},onGroupValueChange:function(DL,DM){if(DE&&DL===DE&&DM===S.VAL_AUTOMATIC){DM=AR;}this.broker.setFormatPropertyValue(DL,DM);},onFmtPropsChanged:function DH(DL,DN){if(DE&&DL===DE){var DM=this.broker.getFormatPropertyValue(DF);this.syncControl(function(){this.getChildComp(DL).set("autoPreviewColor",DM?DN:null);this.setChildValue(DL,DM?S.VAL_AUTOMATIC:DN);});}else{this.onFmtPropsChangedDefault(DL,DN);if(DK&&DL===DK){this.setChildEnable(Ba,Ct()&&DN!==mstrmojo.gm.EnumCombinedLineStyle.NONE);}}}},DI);}return DI;}var C6=function(DH,DI){var DF=DH?mstrmojo.desc(13752,"Line Style"):null,DE={lineColor:Cz(Cc.SHAPE_FILL_COLOR),lineStyle:Cz(Cc.SHAPE_LINE_COMBINED_STYLE)},DJ=DH,DG=AN.override(DI,Aq.copy({controlName:"shapeLineGroup",hideColorControl:DH,showNoFillInColor:false,showAutomaticInColor:true,showNoneOption:false},Cu(DH,DE.lineColor,DJ,DE.lineStyle)));if(DH){delete DE.lineColor;}return DD(B7.call(this,DF,DE,AN.override({reInit:function(){var DL=Cg.GMController,DK=CL.difference(DL.getShapeForOption(Cj.value),Cf).length===0,DM=DL.getSizeByMetrics().length>0;this.setChildEnable(DE.lineStyle,!(DK&&DM));this._super();}},DG)),DH);}.bind(this);var C9=function(DM,DJ,DG){var DN=mstrmojo.desc(2885,"Fill"),DH=Cq.getSmartNamesMapForFillGroup(null,DC,Bl,"fld",null,Ai),DE=DM||DJ,DL=Aq.copy({controlName:"shapeFillGroup",showGradient:Cg.interactor.isShowGradientAllowed(),showAutomaticInColor:true},Cu(DM,DH.fillColor,DE));if(DM){DN=mstrmojo.desc(13658,"Fill Opacity");delete DH.fillColor;DL.visibleControls=Bw.FILL_TRANSPARENCY;}else{if(DJ){DN=mstrmojo.desc(13753,"Shape Color");delete DH.fillAlpha;DL.visibleControls=Bw.FILL_COLOR;}}var DF=DD(Cb.call(this,DN,DH,AN.override(DG,DL)),DE),DI=DH.fillAlpha,DK=DI&&DF.getCtrl().getChildComp(DI);if(DK){Aq.copy(T(Cq,DI),DK);}return DF;}.bind(this);var Ch=function(DH,DI){var DF=null,DE=Cq.getSmartNamesMapForLineGroup(null,DC,h,"fld",null,Ai),DJ=DH,DG=Aq.copy({lineTitle:mstrmojo.desc(9736,"Border"),controlName:"shapeBorderGroup",hideColorControl:DH,showNoFillInColor:false,showAutomaticInColor:true},Cu(DH,DE.lineColor,DJ,DE.lineStyle));if(DH){delete DE.lineColor;DF=mstrmojo.desc(3538,"Border Style");DG.lineTitle=null;}return DD(B7.call(this,DF,DE,AN.override(DI,DG)),DJ);}.bind(this);var C5=C8(),Cl,Cp;if(Cx){Cl=-1;}else{if(Cw.shapeType===undefined){Cp=Cg.getChartInfo().shape;}else{Cp=Cw.shapeType;}Cl=CL.map(C5,function(DE){return DE.v;}).indexOf(Cp);}var DB=this.getPulldown(C5,function(DE){Cg.setWidgetPropertyValue(AV.METRIC_SHAPES,{});Cg.processChangeShape(DE);},Cl,{onRender:function(){var DE=this.selectedNode;if(DE&&Cx){DE.innerHTML=mstrmojo.desc(5576,"Combination");}}}),Cr=this.getLabelAndControl(mstrmojo.desc(13754,"Shape Type"),DB,"40%","60%");if(Cq.getVisProfile(BP)){Cn.push(C6(C0));}else{if(Cq.getVisProfile(CE)){Cn.push(C9(C0),Ch(C0));}else{if(Cx){if(!C0){Cn.push(C9(false,true));}var C7=function C7(DE){return{reInit:function(){this._super();if(DE){var DF=Cg.GMController.getShapeForOption(Cj.value);this.getCtrlContainer().set("enabled",CL.intersection(DF,DE).length>0);}}};},Cy=C6(true,C7(Cf)),C1=C9(true,false,C7(C3)),Cv=Ch(false,C7(C3));Cn.push(Cy,C1,Cv);}}}C4.shapeFormatControls=Cn;var Ce=[Cr,Ci,Cj];if(C0){Ce.splice(Cs.length===1?3:2,0,H.call(this,C2(C4)));}return Ce.concat(Cn);}function AJ(){var Cf=this.broker;function Ci(Ck,Cj){return Cf.generateSmartName(null,Ck,Cj);}var Ch=Ci(Cc.LINE_MARKER_SHOW),Ce=function(Cj){return Cf.getVisProfile(Bq)&&!Cf.getVisProfile(q)&&(Cf.vis.skipPaintedCheck||Cf.vis.interactor.isLineOrAreaPaint());};return[Bz.call(this,mstrmojo.desc(13755,"Show Marker"),Ch,{reInit:function Cg(){this.getCtrlContainer().set("enabled",Ce(this));this.reInitDefault();}}),b.call(this,mstrmojo.desc(13756,"Marker Color"),Ci(Cc.LINE_MARKER_COLOR,Cc.LINE_MARKER_COLOR),{listenFormatProps:[Ch],colorDefaultSN:Ci(Cc.LINE_MARKER_COLOR,Cc.LINE_MARKER_COLOR+Cc.IS_DEFAULT_VALUE),showAutomatic:true,onFmtPropsChanged:function(Cj,Ck){if(Cj===Ch){this.parent.set("enabled",Ck&&Ce(this));}else{this.onFmtPropsChangedDefault(Cj,Ck);}}})];}function AW(){var Ci=this.broker,Ch=[{n:mstrmojo.desc(2057,"None"),v:Bs.EnumDataLabels.HIDE}],Ck={txt:{n:mstrmojo.desc(1013,"Text"),v:Bs.EnumDataLabels.SHOW_TEXT_ONLY},val:{n:mstrmojo.desc(2175,"Values"),v:Bs.EnumDataLabels.SHOW_VALUE_ONLY}},Ce=false;if(Ci.getVisProfile(v)){Ch.unshift(Ck.val);}if(Ci.getVisProfile(A1)){Ch.unshift(Ck.txt);}if(Ch.length===1){CL.insert(Ch,0,Aq.valarray(Ck));Ce=true;}var Cg=Ci.generateSmartName(null,AV.DATA_LABEL),Cm=Ci.generateSmartName(null,AV.DATA_LABELS_PLACEMENT),Cj=Ci.getDataLabelItems(),Cf=Cj&&Cj.length>1,Cl=[t.call(this,mstrmojo.desc(11993,"Data Labels"),{highlightObjects:[BD.DATA_LABEL]}),Ao.call(this,null,Ch,Cg,Aq.copy(Ce?{enabled:false}:undefined,{cssClass:"dataLabel "+("itemsCnt"+Ch.length)})),Bz.call(this,mstrmojo.desc(14606,"Hide overlapping labels"),Cm,{listenFormatProps:[Cm],reInitDefault:function(){(this.listenFormatProps).forEach(function(Cn){this.onFmtPropsChanged(Cn,this.broker.getFormatPropertyValue(Cn)!==mstrmojo.gm.EnumDataLabelPlacements.GENERIC);},this);}})];if(Cf){Cl.push(AQ.call(this,Cj,Ci.generateSmartName(null,AV.METRIC_LEVEL_DATA_LABEL),{controlName:"DataLabelList",listenFormatProps:[Cg],onFmtPropsChanged:function(Cn,Cp,Co){if(Cn===Cg){this.set("enabled",Cp!==Bs.EnumDataLabels.HIDE);}else{this.onFmtPropsChangedDefault(Cn,Cp,Co);}}}));}Cl.push(A6.call(this,null,Ci.getSmartNamesMapForFontGroup(B5),{controlName:"DataLabelFontGroup",syncWithAllText:true,listenFormatProps:[Cg],onFmtPropsChanged:function(Cn,Co){if(Cn===Cg){this.set("enabled",Co!==Bs.EnumDataLabels.HIDE);}else{this.onFmtPropsChangedDefault(Cn,Co);}}}));return Cl;}function f(Cf){var Ce=[this.getEditorGroup(BA.call(this),Bn)];if(this.broker.getVisProfile(Bq)){Ce.push(this.getEditorGroup(AJ.call(this),A3));}Ce.push(this.getEditorGroup(AW.call(this),A3));this.replaceChildControls(Cf,Ce);}mstrmojo.vi.models.editors.GMEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.GMEditorModel",help:"dashboard_editor_graph_html5_properties.htm",broker:null,init:function CZ(Ce){this._super(Ce);this.broker=this.addDisposable(new mstrmojo.vi.models.editors.GMBroker({vis:this.getHost()}));},getInitialTarget:function Aw(){return U;},getEditorContents:function BC(){CJ.handleDestroy(this,["mstrmojo.vi.models.editors.GMBroker"]);var Ck=this.addDisposable(new mstrmojo.vi.models.editors.GMEditorManager({host:this.getHost(),model:this}));Ck.initializing=true;var Ce=this.broker;if(Ce.editorManager){Ce.detachEditorRuntime().destroy();}this.broker.attachEditorRuntime(Ck);Ck.initIdentityPanelMapping();var Cj=this._super(),Ch=this.id,Cg=Cj[0],Cf=function(){var Cl=mstrmojo.all[Ch];if(!Cg.hasRendered){Bx.addWidgetCssClass(Cg,[(Cl._hilightGMTitle?"hilightGMTitle":""),(Cl._hilightGMContainer?"hilightGMContainer":"")]);}else{Bx.toggleClass(Cg.domNode,"hilightGMTitle",Cl._hilightGMTitle);Bx.toggleClass(Cg.domNode,"hilightGMContainer",Cl._hilightGMContainer);}};Cf();this.onHighlightObjChange=function Ci(Cl){var Cm=mstrmojo.all[Ch];Cm._hilightGMTitle=Ar([BD.VIZ_BOX_TITLE],Cl);Cm._hilightGMContainer=Ar([BD.VIZ_BOX_CONTAINER],Cl);Cf();};Ce.editorManager._hilightObjListens.push(this);Ck.initializing=false;return Cj;},getTargetPulldownItems:function m(Cf){var Cg=this._super(Cf),Ce=this.broker,Ch=function(Ci){return function(Cj){Ce.editorManager.clearControlsReference();CJ.handleDestroy(this,["mstrmojo.vi.models.editors.GMBroker","mstrmojo.vi.models.editors.GMEditorManager"]);Ci.bind(this,Cf)(Cj);}.bind(this);}.bind(this);if(Ce.getVisProfile(AS)){return Cg;}Cg.push({n:mstrmojo.desc(11974,"Data Exploration"),v:U,h:Ch(AU)});if(Ce.getVisProfile(BU)){Cg.push({n:mstrmojo.desc(12018,"Trend Lines"),v:CA,h:Ch(A2)});Cg.push({n:mstrmojo.desc(12030,"Reference Lines"),v:Bg,h:Ch(J)});}Cg.push({cls:"separator"});Cg.push(Cg.shift());if(Ce.getVisProfile(Ae)||Ce.getVisProfile(Aa)){Cg.push({n:mstrmojo.desc(2403,"Legend"),v:N,h:Ch(AM)});}Cg.push({n:mstrmojo.desc(13931,"Axis Lines and Labels"),v:Bh,h:Ch(B6)});Cg.push({n:mstrmojo.desc(11978,"Rows and Columns"),v:AP,h:Ch(CY)});Cg.push({n:mstrmojo.desc(13757,"Shapes and Data Labels"),v:CB,h:Ch(f)});return Cg;},getFormatToTargetFn:function Y(){var Ce=this.id;return function(Cg){var Ch=mstrmojo.all[Ce],Cf=Ch&&Ch.broker&&Ch.broker.editorManager;if(Cg===mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE&&Cf&&Cf.notifyNonShapeSelectionChangeToListeners){Cf.notifyNonShapeSelectionChangeToListeners({identities:[{objType:BD.VIZ_BOX_TITLE}]});}};},getPulldown:function CG(Cf,Ci,Ce,Ch,Cg){Ch=Aq.copy({_set_selectedIndex:function Cj(Cm,Ck){if(Ck===-1){this.selectedIndex=Ck;this.getPopupList().clearSelect();var Cl=this.selectedNode;if(Cl){Cl.innerHTML="";}return false;}return this.constructor.prototype._set_selectedIndex.call(this,Cm,Ck);}},Ch);return this._super.apply(this,arguments);}});mstrmojo.vi.models.editors.GMEditorModel.PropertyKeyType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService","mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.Button");mstrmojo.requiresClsP("mstrmojo.mstr","EnumFunction","EnumDSSXMLBaseFormType","EnumDSSXMLObjectTypes","EnumDataType");mstrmojo.requiresClsP("mstrmojo.ME","AttributeEditBox","MetricToken");mstrmojo.requiresClsP("mstrmojo.vi.ui","DatasetUnitList","DatasetUnitMenuUtils");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","Menu","EditorConfig");mstrmojo.requiresDescs(190,1388,2213,2453,2789,3323,3329,5188,9748,11490,11491,11492,11493,11614,11615,14717);var X=mstrmojo.mstr.EnumFunction,a=mstrmojo.array,K=mstrmojo.dom,h=mstrmojo.vi.ui.DatasetUnitMenuUtils,p=mstrmojo.func,M=mstrmojo.hash,d=mstrmojo.mstr.EnumDataType,D=mstrmojo.mstr.EnumDSSXMLBaseFormType,r=mstrmojo.mstr.EnumDSSXMLObjectTypes,Y=1,A="\u001E",u=mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS,Z,l={style:{params:{treesToRender:1}}};function Q(AA,AB,z){var x=this.docModel,w=x.controller;w.cmdMgr.execute({execute:function(){this.submit(AA,AB,z);},urInfo:{callback:AB}});}function C(x,z,AA){var w=x.docModel;return h.getAggregateByMenu(z,function(AC,AB){w.addShortcutMetric({dsid:AA,funcType:AB,items:[{did:AC.did,t:AC.t}]},w.getDatasetsUpdateCallback());});}function B(x,z,AB){var AA=x.dataset.set.mx,w=a.filter(AA,function(AC){return !AC.hide;});return h.getCalculationMetricEditor(w,z,function(AE,AD,AH,AF){var AC=x.docModel,AG={act:"addShortcutMetric",dsid:AB,funcType:AH,funcType2:AF,units:[AE,AD]};Q.call(x,AG,AC.getDatasetsUpdateCallback(),l);});}function S(x){if(!x){return ;}if(!x.links){x.links={};var w=x.links;a.forEach(x,function(z){M.forEach(z,function(AA,AB){if(!w[AB]){w[AB]=[];}w[AB].push(AA);if(!w[AA]){w[AA]=[];}w[AA].push(AB);});});}}function O(AE,z,AC){if(AC.t!==r.Attribute){return ;}var AD=z._dsetId,x=z.docModel,w=x.controller,AB=function(AF){var AG=AF.code||AF.getResponseHeader("X-MSTR-TaskErrorCode");if(AG==="-2147156975"){mstrmojo.confirm(mstrmojo.desc(14148,"For this dataset, this action can only be performed in the Dataset Editor. Click OK to open the editor now."),{confirmBtn:{t:mstrmojo.desc(1442,"OK"),fn:function(){T(z);}},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}});}},AA=function(AF){var AG=p.wrapMethods(w.getRefreshCallback(),{success:function(){w.cmdMgr.reset();},failure:AB});x.getDataService().submitUpdates(AF,AG,{config:{showProgress:true,hideProgress:true,progressStateText:[mstrmojo.desc(8445,"Loading")],silent:true}});};S(x.als);h.getAttributeLinkMenu(AE,AC,AD,x,AA);}function T(AA){var w=mstrmojo.all[AA.panelId],z=AA.dataset.set,AB=AA._dsetId,x=AA.docModel;w.showDataImport({isEdit:true,isNewAnalysis:false,isManagedCube:z.mngd,AnalysisId:x.mid,ReportId:AB,CubeName:z.name,CubeDesc:z.dsc,StatusCode:1});}function t(z,x,w){return z.links[x+" "+w];}function L(z,w,x){if(!V(x,w.docModel.als).isLinked){return ;}z.addMenuItem(mstrmojo.desc(9748,"Unlink"),"",function(){var AB=w.docModel,AE=x.did,AC=[],AA=[],AF=[],AD;a.forEach(x.fs,function(AH){var AG=t(AB.als,AE,AH.fid);a.forEach(AG,function(AI){AC.push(AH.fid);var AJ=AI.split(" ");AA.push(AJ[0]);AF.push(AJ[1]);});});AD={act:"applyAttributeLinking",srcAttrId:AE,srcFormId:AC.join(A),tgtAttrId:AA.join(A),tgtFormId:AF.join(A),unlink:true};Q.call(w,AD,AB.controller.getRefreshCallback());});}function N(z){if(!this.docModel){return false;}var x=0,w=2;M.forEach(this.docModel.datasets,function(AA){if(x>=w){return false;}a.forEach(AA.att,function(AB){if(AB.did===z){x++;return false;}});});return x>=w;}function V(z,AA){var w={isLinked:false,isId:false},x=N.call(this,z.did);if(z.t===r.Attribute){if(x){return{isLinked:true,isId:true};}if(AA){S(AA);a.forEach(z.fs,function(AB){if(t(AA,z.did,AB.fid)){w={isLinked:true,isId:!!AB.idf};return false;}});}}return w;}function m(z,w){var x=0;a.forEach(w,function(AA){if(a.find(AA.att,"did",z.did)>=0){x++;}});return x>=2;}function P(AE,AA,AC){var z=mstrmojo.all[AA.panelId].data,w=AA.docModel,AB=[{3072:true,3077:true}],AD=function(AH,AG){var AF=false;if(AH.st===AG.st){AF=true;}else{AB.some(function(AI){if(AI[AH.st]&&AI[AG.st]){AF=true;return true;}});}return AF;},x=[];M.forEach(z,function(AF){a.forEach(AF.mx.concat(AF.att),function(AG){if(AG.did!==AC.did&&AG.t===AC.t&&AD(AG,AC)&&!AG.hide&&a.find(x,"did",AG.did)===-1){x.push(AG);}});});if(x.length===0){return ;}x=h.getSortedDatasetUnits(x);AE.addEditorMenuItem(mstrmojo.desc(11490,"Replace Reference With"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"replaceReference",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:x,listHooks:{select:function AF(AG,AH){var AI={act:"applyReconciliation",is_rr:true,members:[{srcid:AC.did,srct:AC.t,tgtid:AH.did,tgtt:AH.t}]};w.submitDataDefnUpdate(w.addUpdateObjects(AI,{id:AH.did,type:AH.t,flag:u.DATA_CHANGE}),p.wrapMethods(w.getDatasetsUpdateCallback(),w.controller.getPartialUpdateCallback()),mstrmojo.DocDataService.REQUEST_DEFN_DATA);}}}]}]});});}function n(){return mstrApp.rootCtrl.docCtrl;}function f(AC,AE,x,AB){if(AE.t===r.Metric){var AA=n(),AD=AA.model.getDataService(),w,z={dsid:AC._dsetId,alias:AE.alias||AE.n},AF=null;if(x==="edit"){w={metricId:AE.did,editorId:AB,action:{cmd:"edit",n:AE.n}};z.did=AE.did;AF=AD.getEditDerivedMetricSubmitFunc(z);}else{w={metricId:"",editorId:AB,action:{cmd:x,refOi:{did:AE.did,n:AE.n}}};AF=AD.getAddNewDerivedMetricToDatasetSubmitFunc(z);}if(AA.model.isFromSolrCube(AE.did)||AA.model.isFromMDXCube(AE.did)){w.disableAFB=true;}AA.openDME(AC,w,AF);}}function v(AD,z){var AG=this.ctxt,AF=z.parentNode,AE=new mstrmojo.WaitIcon({placeholder:AF.appendChild(document.createElement("span")),markupString:'<span id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="{@cssText}"></span>',cssText:"z-index:1; position:absolute; top:0;; right:3px;"});AE.render();if(AG.t===r.Attribute&&AG.da){var AB=n(),AA={dsid:AD._dsetId,did:AG.did,n:AG.n,forms:AG.fs};var AH=function(AI){AE.set("visible",AI);};var x=window&&window.event,AC=!!(x.ctrlKey&&x.altKey),w=AA.forms||[];if(H(AG)&&!AC){AB.openDynamicLinkEditor(AD,AA,AH);}else{AB.openDAE(AD,AA,AH);}}}function k(AB,z){var x=AB.docModel,w=x.controller,AD=AB._dsetId,AC=[];var AA=[];z.forEach(function(AG){var AE=AG.did,AF=AG.t;if(AF===4&&AG.um){AC.push({act:"removeDerivedMetricFromDataset",dsid:AD,metricId:AE});}else{if(AF===12&&AG.da){AC.push({act:"removeDAFromDS",dsid:AD,attrId:AE});}else{if(AG.st===12033){AC.push({act:"removeNDEFromDS",dsid:AD,oid:AE});}else{AC.push({act:"removeBaseUnitFromDataset",dsid:AD,unitId:AE,unitType:AF});}}}AA.push({id:AE,type:AF,flag:u.DATA_CHANGE});});return function(){w.cmdMgr.execute({execute:function(){this.submit(AC,w.getRefreshCallback(),mstrmojo.DocDataService.REQUEST_DEFN_DATA);},urInfo:{treesToRender:3,undo:function(){this.urInfo.puObjs=AA;this.urInfo.callback=p.wrapMethods(x.getDatasetsUpdateCallback(),{success:function(AE){if(AE.pukeys){x.getRebuildCallback().success(AE);}}});},redo:function(){this.urInfo.puObjs=null;this.urInfo.callback=w.getRefreshCallback();}}});};}function E(w){return w.every(function(x){return(x.t===r.Metric&&x.um)||(x.t===r.Attribute&&x.da)||x.st===12033;});}function e(){var w=this.docModel,x=w.getSelectedViUnit().getZonesModel();return p.wrapMethods(w.getDatasetsUpdateCallback(),{success:function(AB){if(AB.pukeys){var z=AB.pukeys&&AB.pukeys.split("\u001E"),AC=w.getUnitDefinitions(z),AD=w.partialUpdate(AB.data,AC,AB.defn,z),AA=Object.keys(AC).filter(function(AE){return Object.keys(AD.def).indexOf(AE)===-1;});AA.forEach(function(AH){var AF=w.getWidgetId({k:AH,wid:1}),AG=AF&&mstrmojo.all[AF],AE;while(AG){AE=AG.defn;if(AE&&AE.t===mstrmojo.EnumRWUnitType.PANEL&&AG.setDirty){AG.setDirty(true);break;}AG=AG.parent;}});}}},w.getUpdateHiddenLayoutsCallback(),x&&x.getUpdateCallback());}function o(z,AA,x,AC){var w=z.docModel,AB;if(AA.t===r.Metric&&AA.um){AB={act:"updateDerivedMetricOnDataset",dsid:AC,did:AA.did,name:x};}else{if(AA.t===r.Attribute&&AA.da){AB={act:"updateDA",dsid:AC,attrId:AA.did,name:x};}else{if(AA.t===r.Consolidation&&AA.st===12033){AB={act:"applyDEChanges",deId:AA.did,attId:AA.attId,actions:[{act:"updateDeObject",name:x}]};}else{AB={act:"editDocUnitProp",dsid:AA.t===r.Metric?AC:null,unitId:AA.did,unitType:AA.t,prop:Y,value:x};}}}Q.call(z,w.addUpdateObjects(AB,{id:AA.did,type:AA.t,flag:u.FORMAT_CHANGE}),e.call(z),mstrmojo.DocDataService.REQUEST_DEFN_DATA);}function c(AA,AG,AD,AC,w){var AH=AG.t===r.Metric,AB=AH?M.copyProps([AC],AA.docModel.datasets,{}):AA.docModel.datasets,x=AH?"mx":"att",AE=[],z=[],AF=function(){o(AA,AG,AD,AC);};M.forEach(AB,function(AK){var AJ=false,AI=false;a.forEach(AK[x],function(AL){if(AL.did===AG.did){AJ=true;}else{if(AL.t===AG.t&&AL.n===AD){AI=true;}}});if(AI){if(AJ){AE.push(AK.name);}else{z.push(AK.name);}}});if(AE.length){mstrmojo.alert(mstrmojo.desc(11650,'Cannot rename: "##" already exists in dataset ###.').replace("###",AE.join(", ")).replace("##",AD),w,mstrmojo.desc(1388,"Rename"));return ;}if(z.length){mstrmojo.warn(mstrmojo.desc(11654,'"##" already exists in dataset ###. Do you want to proceed?').replace("###",z.join(", ")).replace("##",AD),{confirmBtn:{fn:AF},cancelBtn:{fn:w}},{title:mstrmojo.desc(1388,"Rename")});return ;}if((AG.t===r.Metric&&AG.um)||(AG.t===r.Attribute&&AG.da)||(AG.t===r.Consolidation)){h.validateName(AD,AF,w);}else{AF();}}function g(z,w){var x=a.filter(z.items,function(AA){return a.find(w,"did",AA.did)<0;});z.clearSelect();z.set("items",x);}function q(AA,z){var AC=[],x=AA.docModel,AB=AA._dsetId,w=function(AD){return x.getToggleHiddenObjectAction(AB,AD,true);};a.forEach(z,function(AD){AC.push(w(AD));});return function(){g(AA,z);Q.call(AA,AC,x.getDatasetsUpdateCallback(),l);};}function J(w){return{act:"addShortcutMetric",funcType:w.formType===2?X.FunctionSum:X.FunctionCount,units:[{id:w.did,type:w.t}]};}function U(AA,z){var w=true,AB,x;a.forEach(M.keyarray(z),function(AC){AB=z[AC];x=AB.att.concat(AB.mx);if(a.find(x,"did",AA)!==-1&&h.hasCGorCon(AB)){w=false;return false;}});return w;}function H(x){var w=x.fs||[];return x.t===r.Attribute&&x.da&&w.length===2&&w[1].bftp===D.DssXmlBaseFormHTMLTag&&w[1].fnm==="DYNAMICLINK";}mstrmojo.vi.ui.DocDatasetUnitList=mstrmojo.declare(mstrmojo.vi.ui.DatasetUnitList,null,{scriptClass:"mstrmojo.vi.ui.DocDatasetUnitList",docModel:null,addMenuProp:true,multiSelect:true,useListModKeys:true,getItemTooltip:function(x,z){var w=K.position(z);return M.copy({cssClass:"vi-regular vi-tooltip-C",posType:mstrmojo.tooltip.POS_TOPLEFT,top:w.y-2,left:w.x+w.w+6},this._super(x,z));},showMultiSelectionMenu:function R(z,AB,w){var AD=new mstrmojo.ui.menus.MenuConfig(),AE=this.id,x=this.docModel,AA=h.getMultiSelectionShortcutMetricFunctions(z),AC=z.filter(function(AF){return AF.t===r.Attribute||AF.t===r.Metric||AF.t===r.Filter||AF.t===r.Consolidation;});if(AA&&AA.length){AD.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",AE,function(){return h.getMultipleMetricsCalculationMenus(z,mstrmojo.all[AE]._dsetId,function(AF){x.addShortcutMetric(AF,x.getDatasetsUpdateCallback());});});AD.addSeparator();}if(AC.length>0){h.insertAddUnitToFilterMenu(AD,this.docModel,AC);}AD.addMenuItem(mstrmojo.desc(1995,"Hide"),"",q(this,z));if(E(z)&&((this.dataset.set.att||[]).length+(this.dataset.set.mx||[]).length)>z.length){AD.addMenuItem(mstrmojo.desc(629,"Delete"),"",k(this,z));}this.configurePopup(AD,AB);AD.position=w;if(AD.hasMenuItems()){this.openPopup(AD.newInstance());}},showItemMenu:function G(AR,x,AX){var AF=this._dsetId,AV=this,AQ=AV.docModel,AL=AQ.controller,AN=new mstrmojo.ui.menus.MenuConfig({position:AX,isHostedWithin:false}),AM=AV.id,AC=mstrmojo.vi.ui.DatasetUnitMenuUtils.getHighlightElementHandler,AI=function(){return h.getCreateTimeDAEditorCfg(AR,function(AZ){for(var AY in AZ){AZ[AY].act="addDAToDataset";AZ[AY].dsid=AF;}Q.call(mstrmojo.all[AM],AZ,AQ.getDatasetsUpdateCallback(),l);});},AW=this.dataset.set,z=h.hasCGorCon(AW),AK=AW.st===779,AE=AR.t===r.Attribute&&AR.st===3076,AU=H(AR),AP=AQ.isMDXDataset(AW),AD=AQ.isDDADataset(AW);if(AR.t===r.Attribute){if(AR.da&&!(AD&&AP)){AN.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){v.call(this,AV,x);},AR);AN.addSeparator();}if(!AR.da){AN.addMenuItem(mstrmojo.desc(13236,"Duplicate as Metric"),"",function(){Q.call(mstrmojo.all[AM],[M.copy(J(AR),{dsid:AF})],AQ.getDatasetsUpdateCallback(),l);},AR);}if(!z&&!AE&&!AU){AN.addEditorMenuItem(mstrmojo.desc(9918,"Data Type"),AM,function(){return h.getConfDataTypeMenuCfg(AQ,AR,AF,function(Aa,AY){var AZ;if(Aa){AZ={act:"addDAToDataset",isTokenStream:true,dsid:AF,forms:AY,name:AR.n};}else{AZ={act:"updateDA",isTokenStream:true,dsid:AF,attrId:AR.did,update:AY};}Q.call(AV,AQ.addUpdateObjects(AZ,{id:AR.did,type:AR.t,flag:u.DATA_CHANGE}),p.wrapMethods(AQ.getDatasetsUpdateCallback(),AL.getPartialUpdateCallback()),mstrmojo.DocDataService.REQUEST_DEFN_DATA);});},AR);if(!(AD&&AP)&&!AU){AN.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",function(){n().openDAE(AV,{dsid:AF},mstrmojo.emptyFn,AR);},AR);AN.addMenuItem(mstrmojo.desc(14717,"Create Links..."),"",function(){n().openDynamicLinkEditor(AV,{dsid:AF},mstrmojo.emptyFn,AR);},AR);}}AN.addSeparator();}else{if(AR.t===r.Metric){if(AR.um){AN.addMenuItem(mstrmojo.desc(3224,"Edit..."),"",function(){f.call(this,AV,this.ctxt,"edit");},AR);AN.addSeparator();}if(!AR.um&&!AR.rdm&&U(AR.did,AQ.datasets)&&!AQ.isMDXDataset(this.dataset.set)){AN.addMenuItem(mstrmojo.desc(13235,"Duplicate as Attribute"),"",function(){var AZ=AR.dt,AY=(AZ===d.DataTypeDouble||AZ===d.DataTypeFloat||AZ===d.DataTypeReal),Ab=function(Ad){var Ae=[],Ac={v:mstrmojo.ME.MetricToken.brackets(AR.n),tp:266,lv:1,oi:{did:AR.did,t:AR.t,n:AR.n}};Ae.push({v:"!",tp:33,lv:4});if(Ad){Ae.push({v:"Round2(",tp:"2",lv:1});Ae.push(Ac);Ae.push({v:mstrConfig.listSep+"2)",tp:"2",lv:1});}else{Ae.push(Ac);}Ae.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Ae});},Aa={act:"addDAToDataset",dsid:AF,isTokenStream:true,forms:[{bft:D.convertDataType2BaseFormType(AZ),formula:Ab(AY)}],name:AR.n};Q.call(AV,Aa,AQ.getDatasetsUpdateCallback(),l);},AR);}if(AQ.findDatasetIdFromUnit(AR.did)&&!AQ.isFromSolrCube(AR.did)&&!AQ.isFromMDXCube(AR.did)){AN.addSubMenuItem(mstrmojo.desc(11806,"Aggregate By"),"",AM,function(){var AY=C(AV,AR,AF);return AY;});}AN.addSeparator();AN.addEditorMenuItem(mstrmojo.desc(5188,"Calculation"),AM,function(){return B(AV,AR,AF);},AR);AN.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",function(){f.call(this,AV,this.ctxt,"editNew");},AR);AN.addSeparator();}else{if(AR.t===r.Consolidation&&AR.st===12033){AN.addMenuItem(mstrmojo.desc(13296,"Edit Groups..."),"",function(){AL.openDEEditor(AV,{dsId:AF,attId:null,attName:null,deObj:AR,elemId:null,dispName:AR.n,fromDatasetPanel:true});},AR);AN.addSeparator();}}}var AJ=[1,2,8,9,11];if(AR.t===r.Metric||(AR.t===r.Attribute&&!AU&&(AR.fs||[]).some(function(AY){return AJ.indexOf(AY.bftp)!==-1;}))){AN.addEditorMenuItem(mstrmojo.desc(13237,"Number Format"),AM,function(){var Aa=function(Ab){Q.call(AV,AQ.addUpdateObjects(Ab,{id:AR.did,type:AR.t,flag:u.FORMAT_CHANGE}),e.call(AV),mstrmojo.DocDataService.REQUEST_DEFN_DATA);};if(AR.um){var AY=function AZ(Ac){var Ae=["Format","Category","DecimalPlaces","ThousandSeparator","CurrencySymbol","CurrencyPosition","NegativeNumbers"],Ad=null,Ab={};M.forEach(Ac,function(Ag,Af){Ad=Ae.filter(function(Ah){return Ah.toLowerCase()===Af.toLowerCase();})[0];if(Ad){Ab[Ad]=Ag;}});return Ab;};return h.getNumberFormatEditor(AR,AR.nf||{},function(Ab){var Ac={act:"formatDerivedMetric",dsid:AF,mid:AR.did,format:{FormattingNumber:AY(Ab)}};Aa(Ac);});}else{return h.getNumberFormatEditor(AR,AR.nf||{},function(Ac){var Ab=AQ.getNumberFormatAction(AR.did,AR.t,Ac);if(AR.t===r.Metric){Ab.datasetId=AF;Ab.datasetType=AV.dataset.set.type;}Aa(Ab);});}});AN.addSeparator();}if(AR.t===r.Attribute){if(!AR.da&&AQ.allowManageDocumentDataset()&&(!AK||(AK&&AQ.hasPrivilegesForAllTables(this.dataset.set.tables)))&&!AD){var AG=a.filter(this.dataset.set.tables,function(AY){return a.find(AY.attRefs,"did",AR.did)!==-1;}),w=this.dataset.set.mngd,AT;if(AG&&AG.length>0){AT=function(){return h.getMarkGeoRoleEditorCfg(AQ,AR,AF,w,AG,function(AZ,AY){if(AY){AQ.getDataService().submitUpdates(AZ,AL.getRefreshCallback());}else{AQ.getDataService().submitUpdates(AQ.addUpdateObjects(AZ,{id:AR.did,type:AR.t,flag:u.DATA_CHANGE}),p.wrapMethods(AQ.getDatasetsUpdateCallback(),AL.getPartialUpdateCallback()),mstrmojo.DocDataService.REQUEST_DEFN_DATA);}});};if(AT()&&!AQ.isFromSolrCube(AR.did)&&!(mstrApp.isSingleTier&&AW.hcs)){var AB=-2147483648,AH=true,AO=a.filter(AR.fs,function(AY){return(AY.bftp===2||AY.bftp===3)&&(Number(AY.der&2147483648)!==AB);});for(i=0;i<AO.length;i++){if(AO[i].fnm==="Latitude"||AO[i].fnm==="Longitude"){AH=false;break;}}if(AH){AN.addEditorMenuItem(mstrmojo.desc(13526,"Define Geography"),AM,AT,AR);}else{AN.addDisabledMenuItem(mstrmojo.desc(13526,"Define Geography"),"");}}}}if(!(AD&&AP)&&!z&&AI()){AN.addEditorMenuItem(mstrmojo.desc(12701,"Create Time Attributes"),AM,AI,AR);}AN.addSeparator();}if(AQ.allowManageDocumentDataset()&&(!AK||(AK&&AQ.hasPrivilegesForAllTables(this.dataset.set.tables)))&&!AU){O(AN,AV,AR);L(AN,AV,AR);if(AR.t===r.Attribute&&m(AR,this.dataset.set.tables)){var AS=mstrmojo.all[this.panelId],AW=this.dataset.set;if(this.dataset.set.hcs!==true){AN.addMenuItem(mstrmojo.desc(13173,"Unmap Attributes..."),"",function(){T(AV);});}}AN.addSeparator();}P(AN,AV,AR);if(AR.t===r.Attribute||AR.t===r.Metric||AR.t===r.Filter||AR.t===r.Consolidation){h.insertAddUnitToFilterMenu(AN,AQ,AR);}if(AR.t===r.Attribute||(AR.t===r.Metric)||AR.t===r.Filter||AR.t===r.Consolidation||AR.t===r.Dimension){var AA=this.getLabelNode(this.getItemNodeFromTarget(x));AN.addMenuItem(mstrmojo.desc(1388,"Rename"),"",function(){h.renameItem(AA,AR,function(AY){var AZ=AR.n,Aa=function(){AY.set("text",AZ);};c(AV,AR,AY.text.trim(),AF,Aa);},{allowEmptyText:true,cssClass:AA.className});},AR);AN.addMenuItem(mstrmojo.desc(1995,"Hide"),"",q(AV,[AR]));if(E([AR])&&((this.dataset.set.att||[]).length+(this.dataset.set.mx||[]).length)>1){AN.addMenuItem(mstrmojo.desc(629,"Delete"),"",k(AV,[AR]));}}this.configurePopup(AN,x);AN.addPopupHandlers("highlight",AC(true,x),AC(false,x));AN.position=AX;this.openPopup(AN.newInstance());},doItemSelect:function(AI,AH){var AA=AH.hWin,AD=AH.e,z=mstrmojo.all[this.panelId],x=K.isMetaKey(AA,AD),AE=K.shiftKey(AA,AD),AG=z.getPanelSelectedItems(),w=AG[0]&&AG[0].ulist.dataset.set.did,AC=this.dataset.set.did,AB=w&&w!==AC,AF=AG.some(function(AJ){return AJ.ulist!==this;},this);if(AF){if(AE){if(!this.getSelectedItems().length){return ;}}else{if(x){if(AB){return ;}}else{z.getDatasetPanel(w).clearSelect();}}}this._super(AI,AH);},getItemMarkup:function I(w){if(!Z){Z=this._super(w).replace("</{@tag}>",'<div class="mark"></div></{@tag}>');}return Z;},getItemProps:function b(AA,w){var z=this._super(AA,w),x=V.call(this,AA,this.docModel.als);if(AA.t===r.Attribute&&x.isLinked){if(!x.isId){z.addCls("noId");}z.addCls("isAttrLink");}z.addCls(AA.ne?"hilight":"");AA.ne=false;return z;},deleteItem:function F(w){var x=this.dataset;window.alert('Delete item "'+(w.n||w.did)+'" from dataset "'+((x&&x.id)||"unknown")+'".');},doubleClickItem:function W(w){n().model.getSelectedViUnit().getZonesModel().addUnitsFromDataSource([w],this._dsetId);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Box","mstrmojo.Button","mstrmojo.Container","mstrmojo.dom","mstrmojo.Editor","mstrmojo.hash","mstrmojo.Label","mstrmojo.DynamicClassFactory","mstrmojo.vi.ui._IsDropTarget","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.AllObjectsBrowser","mstrmojo.vi.ui.DatasetUnitList","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.ui.CheckList","mstrmojo.ui.menus.EditorConfig");var P=mstrmojo.hash,F=mstrmojo.dom,K=mstrmojo.array,U=mstrmojo.vi.models.EnumDragSources,R=mstrmojo.vi.ui.DatasetUnitMenuUtils,M={id:"",att:[],mx:[]};function S(X,b,Z){var Y=Z?X.add:X.del,a=Z?X.del:X.add;var c=K.find(a,"did",b.did);if(c===-1){Y.push(b);}else{K.removeIndices(a,c,1);}if(!Z){X.fs.add=K.filter(X.fs.add,function(d){return b.did!==d.unitId;});X.fs.del=K.filter(X.fs.del,function(d){return b.did!==d.unitId;});}}function H(Y,c,a){var Z=a?Y.fs.add:Y.fs.del,b=a?Y.fs.del:Y.fs.add,d=-1,X;for(X=0;X<b.length;X++){if(b[X].unitId===c.unitId&&b[X].attFormId===c.attFormId){d=X;}}if(d===-1){Z.push(c);return true;}K.removeIndices(b,d,1);return false;}function I(Y,Z,X){K.forEach(Y,function(c){var b=c.t===4?Z.mx:Z.att,a=b.length;K.forEach(b,function(d,e){if(d.n>c.n){a=e;return false;}});S(X,c,true);c.isNew=true;K.insert(b,a,[c]);});}function E(Y){var X,Z=this;K.forEach(Y,function(a){X=a.t===4?Z.dataset.mx:Z.dataset.att;S(Z.modifiedItems,a,false);K.removeIndices(X,K.find(X,"did",a.did),1);});Z.set("dataset",P.copy(Z.dataset));Z.updateScrollbars();}function Q(Y,Z,X){if(mstrApp.serverRequest){mstrApp.serverRequest(Y,Z,X);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(Z,Y,false,X);}}function C(Y,a,X){var Z=[];K.forEach(Y,function(b){if((b.t===4&&K.find(a,"did",b.did)===-1)||(b.t!==4&&K.find(X,"did",b.did)===-1)){Z.push(b);}});return Z;}function V(Y,X){return function(){var c=[],d=null,b=new mstrmojo.ui.menus.EditorConfig({data:{item:X},contents:[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",selectedIndices:c,postBuildRendering:function(){var f=this.itemsContainerNode.childNodes;K.forEach(this.items,function(h,g){if(h.idf){mstrmojo.css.addClass(f[g],"disableOption");return false;}});},preselectionChange:function a(g){var f=g.removed&&g.removed[0];if(g.removed&&this.items[f].idf){this.selectedIndices[f]=true;return false;}return true;}}],okBtnText:mstrmojo.desc(1442,"Ok"),setAllItems:function(f){this.contents[0].items=f;this.set("contents",this.contents);},fnOk:function e(k,h){var l=h.fs,g=l.selectedIndices,f=l.items,m=1;P.forEach(d,function(o,p){if(o){H(Y.parent.parent.parent.modifiedItems,{act:"removeAttrFormFromDataset",unitId:X.did,attFormId:f[p].id},false);X.fs[p].obf=false;}});P.forEach(g,function(o,q){if(o){var p=H(Y.parent.parent.parent.modifiedItems,{act:"addAttrFormToDataset",unitId:X.did,attFormId:f[q].id,unitPos:m},true);if(p){m++;}X.fs[q].obf=true;}});}});var Z=[];K.forEach(X.fs,function(f){Z.push({id:f.fid,n:f.fnm,idf:f.idf});if(f.obf||f.idf){c[Z.length-1]=true;}});if(!d){d=P.cloneArray(c);}b.setAllItems(Z);return b;};}function G(b){return{scriptClass:"mstrmojo.vi.ui.DatasetUnitList",alias:b+"List",cssClass:b+"Unitlist",cssDisplay:"inline-block",multiSelect:true,draggable:false,useListModKeys:true,postCreate:function(){this.avatarCssClass+=" noIcon";},doItemSelect:function(g,d){var f=this,e=F.isMetaKey(d.hWin,d.e);if(!e){K.forEach(this.parent.allList,function(h){if(h!==f.alias){f.parent[h].clearSelect();}});}this.constructor.prototype.doItemSelect.call(this,g,d);},onItemContextMenu:function Y(p,o){var l=o.e,f=this.getItemNodeFromTarget(o.getTarget()),h=o.hWin,g=this.getSelectedItems().some(function(e){return e.itemNode===f;});if(p&&!g){this.doItemSelect(p,o);}var m=o.getTarget(),n=this.parent.getSelectedItems();if(n.length){this.closePopup();var k=n&&n.length>1,d=k?"showMultiSelectionMenu":"showItemMenu";this[d](k?n:p,this.getItemNodeFromTarget(m),mstrmojo.dom.getMousePosition(l,h));return true;}},getItemProps:function Z(g,d){var f=this.constructor.prototype.getItemProps.call(this,g,d),h=this.parent.parent.parent.dataset,e=K.find(h[b],"did",g.did);f.addCls(g.isNew?"hilight":"");h[b][e].isNew=false;return f;},getAttributeForms:function a(d,e){Q.call(this,{taskId:"getAttributeForms",styleName:"VIMojoAttributeStyle",attributeID:d,displayedForms:0},e,{showProgress:false});},showItemMenu:function c(k,g,d){var m=new mstrmojo.ui.menus.MenuConfig({position:d,isHostedWithin:false}),f=this.parent.parent.parent;m.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){E.call(f,[k]);});if(k.t===12){var e=k.fs,h=function(){if(e.length>1){m.addPopupMenuItem(mstrmojo.desc(14327,"Available Attribute Forms"),"",V(this,k));}}.bind(this);if(!e){var l=function l(){this.getAttributeForms(k.did,{success:function(o){var n=f.dataset.att;e=k.fs=n[K.find(n,"did",k.did)].fs=(o.fms||[]).map(function(p){return{fid:p.did,fnm:p.n,obf:!!p.obf,idf:!!p.idf};});h();this.openPopup(m.newInstance());}.bind(this),failure:function(n){mstrmojo.alert(n.message);}});}.bind(this);if(mstrApp.isSingleTier){f.editorContainer.objectBrowser.dataProvider.loadObjects([k],{success:function(){l();}});}else{l();}return ;}h();}this.openPopup(m.newInstance());},showMultiSelectionMenu:function X(e,g,d){var h=new mstrmojo.ui.menus.MenuConfig({position:d,isHostedWithin:false}),f=this.parent.parent.parent;h.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){E.call(f,e);});this.openPopup(h.newInstance());},getAllItems:function(){return this.dataset&&K.filter(this.dataset[b],function(d){return !d.um&&!d.da&&d.st!==12033;});},filterItems:function(d){return d;},bindings:{dataset:"this.parent.parent.parent.dataset"}};}mstrmojo.vi.ui.DatasetEditorContent=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.Box,[mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._HasUnitListAvatar],{allowDrop:function(Z){var b=Z.src.data,Y=b.items,a=this.dataset,c=a.mx,X=a.att;return C(Y,c,X).length&&b.src===U.ALL_OBJECT_LIST;},isDragValid:function A(X){return !isNaN(parseInt(X.src.node.getAttribute("idx"),10))||this._super(X)||false;},ondragstart:function W(Y){var a=null,Z=this,X=function(b){return F.contains(b.domNode,Y.src.node,true,b.domNode);};K.forEach(this.allList,function(b){if(X(Z[b])){a=Z[b];return false;}});if(a){a.selectDragNode(Y);}this._super(Y);}});var B=mstrmojo.Button.newWebButton(mstrmojo.desc(118,"Save"),function(){var k=this.parent.parent,b=k.dataset,Y=k.docModel.datasets,a=[],g=k.modifiedItems.fs.add.concat(k.modifiedItems.fs.del),e={act:"addUnitToDataset"},f={act:"removeBaseUnitFromDataset"},c={act:"setDatasetFilter",useJson:false},Z="$GUID_141",h=0;if(k.modifiedItems.convert){a.push(k.modifiedItems.convert);h=K.indexOf(P.keyarray(Y),b.did)+1;e.dsidx=f.dsidx=c.dsidx=h;K.forEach(g,function(l){l.dsidx=h;});}else{if(!b.did&&k.modifiedItems.add.length){a.push(k.modifiedItems.create||{act:"createDataset",prm:true,mgo:true,newObjectIds:[Z]});var X=k.docModel.getSelectedViUnit().getZonesModel();if(X){a.push({act:"editNode",nodeKey:X.getHost().k,datasetId:Z});}a=a.concat(k.docModel.getOpenDatasetPanelAction());e.dsid=c.dsid=Z;K.forEach(g,function(l){l.dsid=Z;});}else{if(b){var d=b.did;e.dsid=f.dsid=c.dsid=d;K.forEach(g,function(l){l.dsid=d;});}}}K.forEach(k.modifiedItems.add,function(l){a.push(P.copy(e,{unitId:l.did,unitType:l.t}));});K.forEach(k.modifiedItems.del,function(l){a.push(P.copy(f,{unitId:l.did,unitType:l.t}));});a=a.concat(g);if((k.modifiedItems.filter||null)!==(b.filter||null)){a.push(P.copy(c,{expr:mstrmojo.fe.FilterUtils.getExprXml(k.modifiedItems.filter)}));}if(a.length){if(!b.mngd&&!!b.did&&!k.modifiedItems.convert){a.push({act:"datasetSaveAs",managed:false,nonDelta:true,dsID:b.did,rptName:b.name,rptDesc:"",folderID:b.pfid,saveAsOverwrite:true});}}if(k.modifiedItems.add.length){k.editorContainer.objectBrowser.dataProvider.loadObjects(k.modifiedItems.add,{success:function(){k.onOk(a);}});}else{k.onOk(a);}k.close();},true,{bindings:{enabled:"!!this.parent.parent.editorContainer.unitListContainer.attList.items.length || !!this.parent.parent.editorContainer.unitListContainer.mxList.items.length"}}),O=mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function(){var X=this.parent.parent;if(X.onCancel){X.onCancel();}X.close();});mstrmojo.vi.ui.DatasetEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.vi.ui.DatasetEditor",cssClass:"mstrmojo-VIDatasetEditor",dataset:M,docModel:null,dataProvider:null,modifiedItems:{add:[],del:[],fs:{add:[],del:[]},filter:undefined},init:function(X){this.buttons=[B,O];this._super(X);B.text=this.okBtnText||mstrmojo.desc(118,"Save");},onOpen:function(){if(!this.dataset.did){this.dataset=P.clone(M);}else{this.updateScrollbars();}this.modifiedItems.add=[];this.modifiedItems.del=[];this.modifiedItems.fs.add=[];this.modifiedItems.fs.del=[];this.modifiedItems.filter=this.dataset.filter;},onPreClose:function N(){if(this.onCancel){this.onCancel();}return this._super();},setupScrollNodes:function J(){this.scrollNode=this.editorContainer.containNode;},children:[{scriptClass:"mstrmojo.Container",alias:"editorContainer",markupString:'<div class="mstrmojo-VIDatasetEditorContents"><div class="objbrowserContainer"></div><div class="datasetEditorContainer"><div class="datasetEditorTopContainer"><div class="filterLink"></div></div><div class="datasetEditorContent"><div mstrAttach:mouseout,mouseover></div></div></div></div>',markupSlots:{browserNode:function(){return this.domNode.firstChild;},filterNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},containNode:function(){return this.domNode.childNodes[1].childNodes[1].firstChild;}},onmouseout:function(){mstrmojo.css.removeClass(this.containNode.parentNode,"entered");},onmouseover:function(){mstrmojo.css.addClass(this.containNode.parentNode,"entered");},children:[{scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",alias:"objectBrowser",cssClass:"datasetEditorobjbrowser",slot:"browserNode",bindings:{model:"this.parent.parent.docModel"},dblClickOnNodes:function(X){var b=X.getTarget(),Z=F.findWidget(b).data,Y=this.parent.parent,a=Y.dataset;if(Z&&K.indexOf([4,12,1,47],Z.t)!==-1){if((Z.t===4&&K.find(a.mx,"did",Z.did)===-1)||(Z.t!==4&&K.find(a.att,"did",Z.did)===-1)){I.call(this,[Z],a,Y.modifiedItems);}Y.set("dataset",P.copy(a));}},postBuildRendering:function(){this.set("dataProvider",this.parent.parent.dataProvider);this.set("opened",true);this.constructor.prototype.postBuildRendering.call(this);},allowDrop:function(X){var Y=X.src.data;return Y&&Y.src!==U.ALL_OBJECT_LIST;},getDropAvatarIcon:function L(){return"hasIcon remove";},ondrop:function T(X){if(X.src.data.onRemove){X.src.data.onRemove(X.src.data.items);}}},{scriptClass:"mstrmojo.Button",slot:"filterNode",text:mstrmojo.desc(13402,"Edit Filter..."),cssClass:"filterButton",bindings:{visible:"!this.parent.parent.dataset.idd"},onclick:function(){var Y=this.parent.parent,a=Y.dataset,X=Y.modifiedItems.filter,Z=function(b){Y.modifiedItems.filter=b.expr;};if(a){R.getFilterEditor({datasetName:"- "+(a.name||mstrmojo.desc(11636,"New Dataset")),datasetFilter:X||a.filter,att:Y.editorContainer.unitListContainer.attList.items,mx:Y.editorContainer.unitListContainer.mxList.items,fnOk:Z,browseParam:mstrmojo.emptyFn,zIndex:Y.zIndex+1});}}},{scriptClass:"mstrmojo.vi.ui.DatasetEditorContent",alias:"unitListContainer",slot:"containNode",bindings:{dataset:"this.parent.parent.dataset",cssClass:function(){return"datasetEditorUnitlistContainer"+(this.dataset.idd?" noFilter":"");}},ondrop:function T(X){var a=this,Z=a.parent.parent,b=Z.dataset,Y=C(X.src.data.items,Z.dataset.mx,Z.dataset.att);I.call(this,Y,b,a.parent.parent.modifiedItems);Z.set("dataset",P.copy(b));Z.updateScrollbars();},allList:["attList","mxList"],getDragData:function D(X){var a=this.constructor.prototype.getDragData.call(this,X),Z=this,Y=Z.parent.parent;a.onRemove=function(b){E.call(Y,b);};return a;},getSelectedItems:function(){var Y=this,X=[];this.allList.forEach(function(Z){X=X.concat(Y[Z].getSelectedItems());});return X;},children:[G.call(this,"att"),G.call(this,"mx"),{scriptClass:"mstrmojo.Label",cssClass:"dragObjectMsg",bindings:{visible:"!this.parent.attList.items.length && !this.parent.mxList.items.length"},text:mstrmojo.desc(11668,"Drag objects here.")}]}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.SearchWidget","mstrmojo.dom","mstrmojo.Label","mstrmojo.VBox","mstrmojo.func","mstrmojo.hash","mstrmojo.vi._MonitorsAppState");mstrmojo.requiresClsP("mstrmojo.ui","_HasScroller","ScrollableList","Pulldown");mstrmojo.requiresClsP("mstrmojo.ui.menus","_HasMenuPopup","MenuConfig");mstrmojo.requiresClsP("mstrmojo.vi.ui","_IsDropTarget","_IsViPanel","_HasMask","PanelContents","PanelPortlet","DatasetPortlet","DatasetTableView","DatasetMDXView","DatasetUnitList","CollapsibleTitleBar");mstrmojo.requiresDescs(221,1158,1388,2461,3303,3581,5903,8708,11241,11307,11308);var Q=mstrmojo.hash,H=mstrmojo.dom,d=mstrmojo.vi.models.EnumDragSources;var O="dsGroup_",T=mstrmojo.desc(2461,"All");function E(){var p=this,n=this.filter,l=this.getDatasetCount(),o=this.data,m=this.gridSource,k=[{n:T,dsId:"",fScope:"",cls:"all"}],h=0;if(p.filterNodeConfig.att){k.push({n:mstrmojo.desc(3581,"Attributes"),dsId:"",fScope:"att",cls:"att"});}if(p.filterNodeConfig.mx){k.push({n:mstrmojo.desc(1158,"Metrics"),dsId:"",fScope:"mx",cls:"mx"});}if(l>1){k.push({isSeparator:true,cls:"separator"});Q.forEach(o,function(q,r){k.push({n:q.name,dsId:r,fScope:"ds",cls:" ds "+(m===r?"grid-source":"")});});}k.some(function(r,q){if(!r.isSeparator&&p._filterSelection===(r.dsId||r.fScope)){h=q;return true;}return false;});n.set("items",k);n.set("selectedIndex",h);}function K(){var n=this.data,m=[],l=this.id,k=this;Q.forEach(n,function(p,q){m.push(this.getDatasetPortlet(p,q,k,l));},this);var h=this.contents;var o=[].concat(h.children||[]);h.removeChildren();o.forEach(function(p){p.destroy();});h.addChildren(m);this.doLayout();}function f(){var h=this;window.setTimeout(function(){h.updateScrollbars();},0);}mstrmojo.vi.ui.DatasetObjects=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui._IsViPanel,mstrmojo.ui._HasScroller,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.DatasetObjects",importDataBox:null,markupString:'<div id="{@id}" class="mstrmojo-VIPanel mstrmojo-VIDatasetObjects {@cssClass}" style="{@cssText}"><div class="mstrmojo-VIPanel-titlebar"></div><div class="mstrmojo-VIPanel-search"><div><div><div class="filter-box" mstrAttach:click><div class="pdl"></div></div></div><div><div class = "search-box"></div></div></div></div><div class="mstrmojo-VIEditor-divider"></div><div class="mstrmojo-VIPanel-content-wrapper" style="overflow:hidden;"><div class="mstrmojo-VIPanel-content"></div></div><div class="mstrmojo-VIDND-mask"></div><div class="mstrmojo-object-browser-content"></div><div class="mstrmojo-VIPanel-handle splitter v"></div></div>',markupSlots:{titlebarNode:function C(){return this.domNode.firstChild;},searchNode:function e(){return this.domNode.childNodes[1];},filterNode:function V(){return this.domNode.childNodes[1].firstChild.firstChild.firstChild;},searchBox:function J(){return this.domNode.childNodes[1].firstChild.childNodes[1].firstChild;},dividerNode:function B(){return this.domNode.childNodes[2];},containerNode:function X(){return this.domNode.childNodes[3].firstChild;},maskNode:function F(){return this.domNode.childNodes[4];},browserNode:function N(){return this.domNode.childNodes[5];},handleNode:function D(){return this.domNode.lastChild;}},layoutConfig:{h:{titlebarNode:"19px",searchNode:"39px",containerNode:"100%",browserNode:"0"},w:{titlebarNode:"100%",searchNode:"100%",containerNode:"100%",browserNode:"0"},xt:true},filterNodeConfig:{att:true,mx:true},getLinksForEmptyData:function g(){return[];},markupMethods:{onvisibleChange:function P(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";if(this.visible){this.raiseEvent({name:"showPanel"});}},ondataChange:function U(){var k=this.data,l=this.importDataBox;if(!k||!Object.keys(k).length){if(!l){var h=this.getLinksForEmptyData();if(h.length){this.addChildren([{scriptClass:"mstrmojo.VBox",alias:"importDataBox",cssClass:"importDataBox",children:h}]);}}}else{if(l){this.removeChildren(l);l.destroy();}}K.call(this);E.call(this);}},onAppStateChange:function S(h){this._super(h);this.set("isMasked",h.value===mstrmojo.vi.VisualInsightApp.APP_STATES.SELECTOR_TARGETING);},doubleClickItemHandler:mstrmojo.emptyFn,datasetUnitListScriptClass:"mstrmojo.vi.ui.DatasetUnitList",onuseTableViewChange:function(){if(this.hasRendered){K.call(this);}},getDatasetTableView:function R(k,l){var h=this;return{alias:"tableView",scriptClass:"mstrmojo.vi.ui.DatasetTableView",panelId:this.id,docModel:this.model,unitListScriptClass:this.datasetUnitListScriptClass,dataset:{id:l,set:k},bindings:{filterScope:"this.parent.parent.filterScope",filterExpr:"this.parent.parent.filterExpr",level:"this.parent.level"},onTableCollapsedChange:function(){f.call(h);}};},getDatasetMDXView:function(k){var h=this;return{alias:"mdxView",scriptClass:"mstrmojo.vi.ui.DatasetMDXView",docModel:this.model,datasetsPanelId:this.id,unitListScriptClass:this.datasetUnitListScriptClass,data:k,bindings:{filterScope:"this.parent.parent.filterScope",filterExpr:"this.parent.parent.filterExpr",filterFunc:"this.parent.parent.parent.filterFunc",level:"this.parent.level"},onNodeCollapsedChange:function(){f.call(h);}};},getDatasetPortlet:function Z(n,h,k,m){var t=this,p=function(){return[].concat(n.att).concat(n.mx);},o=function(v){return Q.copy(v,{scriptClass:t.datasetUnitListScriptClass,panelId:m,docModel:k.model,bindings:{filterScope:"this.parent.parent.filterScope",filterExpr:"this.parent.parent.filterExpr",filterFunc:"this.parent.parent.parent.filterFunc",level:"this.parent.level + 1"},dataset:{id:h,set:n},postCreate:function w(){this.doubleClickItem=mstrmojo.func.composite([this.doubleClickItem,t.doubleClickItemHandler]);}});};var r={scriptClass:"mstrmojo.vi.ui.DatasetPortlet",dataset:n,title:n.name,alias:O+h,did:h,level:0,panelId:m,useTableView:t.useTableView&&n.tables&&n.tables.length>1,layoutConfig:{h:{titlebarNode:"35px",containerNode:"100%"},w:{titlebarNode:"100%",containerNode:"100%"},xt:true},getLayoutOffsets:function(){return{h:0,w:4};},onisCollapsedChange:function q(){f.call(t);},getTitleBarCfg:function u(){return t.getDatasetTitleBarCfg(this);}};if(this.model.isMDXDataset(n)){Q.copy({children:[this.getDatasetMDXView(n,h)],getSelectedItems:function(){return this.mdxView.getSelectedItems();},clearSelect:function(){this.mdxView.clearSelect();}},r);}else{if(r.useTableView){Q.copy({children:[this.getDatasetTableView(n,h)],getSelectedItems:function(){return this.tableView.getSelectedItems();},clearSelect:function(){this.tableView.clearSelect();}},r);}else{Q.copy({children:[o({alias:"ulist",getAllItems:function l(){return p();}}),{scriptClass:"mstrmojo.Label",cssClass:"emptyIndicator",bindings:{visible:"!this.parent.ulist.items.length",text:function(){if(!this.visible){return"";}return this.parent.ulist.filterExpr?mstrmojo.desc(11904,"No matched object"):mstrmojo.desc(11905,"No object");}}}],getSelectedItems:function(){var v=this.ulist;return v.getSelectedItems();},clearSelect:function(){this.ulist.clearSelect();}},r);}}return r;},getDatasetTitleBarCfg:function(h){return h.constructor.prototype.getTitleBarCfg.call(h);},title:mstrmojo.desc(13965,"Dashboard Datasets"),titleBar:null,titlebarNode:null,containerNode:null,maskNode:null,filterNode:null,contents:null,data:null,model:null,dropZone:true,isSearching:false,init:function(k){this.children=[{scriptClass:"mstrmojo.vi.ui.CollapsibleTitleBar",slot:"titlebarNode",alias:"titleBar",editTitleOnDoubleClick:false,close:function m(){this.parent.setOpenStatus(false);},onclick:function(){this.parent.clickOnCollapsibleTitleBar();},bindings:{title:"this.parent.title"}},{scriptClass:"mstrmojo.vi.ui.PanelContents",alias:"contents",slot:"containerNode"},{scriptClass:"mstrmojo.SearchWidget",slot:"searchBox",alias:"search",quickSearch:true,onsearch:function o(p){this.parent.contents.set("filterExpr",p);this.parent.toggleAllNodesCollapsed(false,false);this.parent.isSearching=true;},onclear:function l(){this.parent.contents.set("filterExpr","");this.parent.recoverAllNodesCollapsed();this.parent.isSearching=false;}},{scriptClass:"mstrmojo.ui.Pulldown",slot:"filterNode",alias:"filter",onitemSelected:function h(){var r=this.getSelectedItem().dsId,t=this.getSelectedItem().fScope,u=this.selectedNode,p=this.parent,q=p.contents;if(u){u.className="mstrmojo-ui-Pulldown-text "+t;}Q.forEach(p.data,function(x,v){var w=q[O+v];if(w){w.set("visible",!r||v===r);if(v===r){w.togglePortlet(false);}}});q.set("filterScope",t);p._filterSelection=r||t;p.onDatasetFilterChange(r);},getPopupListConfig:function n(){return Q.copy({useRichTooltip:true,showTooltip:function p(u,t){var r=H.eventTarget(t,u),q=this.getItemNodeFromTarget(r);if(q&&(q.scrollWidth>q.clientWidth)){this.constructor.prototype.showTooltip.call(this,u,t);}}},this.constructor.prototype.getPopupListConfig.call(this));}}];this._super(k);},allowDrop:function G(k){var l=k.src.data,h=!!(l&&l.src===d.VIZ_EDITOR)||!!(l&&l.src===d.FILTERS)||!!(l&&l.src===d.VIZ);if(l!==undefined&&l.allowDropOnTarget!==undefined){h&=l.allowDropOnTarget(d.DATASETS);}return h;},ondrop:function a(k){var l=k.src.data,h=l.items;if(l){l.onRemove(h&&h.length>1?h:l.item);}},getDropAvatarIcon:function M(k){var l=k.src.data,h="unselectable";if(l.src===d.VIZ_EDITOR||l.src===d.FILTERS||l.src===d.VIZ){h="remove";}return h;},ongridSourceChange:function(){E.call(this);},clickOnCollapsibleTitleBar:mstrmojo.emptyFn,getPanelSelectedItems:function W(){var h=this.contents;return Q.keyarray(this.data).reduce(function(k,m){var l=h[O+m];return k.concat(l.getSelectedItems(m));},[]);},doLayout:function A(){if(!this.visible){return ;}this._super();},getLayoutOffsets:function c(){return{h:0,w:(H.isChrome||H.isFF)?2:1};},updateDatasets:function b(h){var k=this.contents,l=this.data;Q.forEach(h,function(p,m){var o=k[O+m].ulist,n=h[m];if(o&&n){o.set("dataset",{id:m,set:p});l[m]=p;}});},getDatasetPanel:function(h){return this.contents[O+h];},addPopupHandlers:function Y(h,l,k){h.addPopupHandlers(this.id,l,k);},setupScrollNodes:function L(){this.scrollNode=this.containerNode;},getDatasetCount:function I(){return Q.keyarray(this.data).length;},onDatasetFilterChange:function(){this.updateScrollbars();},toggleAllNodesCollapsed:function(k,l){var h=mstrmojo.all[this.id],m=h.settings,n=(h.contents.children||[]).length===1;(h.contents.children||[]).forEach(function(q){var p=m&&m.dataset(q.did),o=q.tableView||q.mdxView;if(l){p.isCollapsed=n?false:k;}q.togglePortlet(n?false:k);if(o){o.toggleAllNodesCollapsed(k,l);}});this.updateScrollbars();if(l){h.saveSettings();}},recoverAllNodesCollapsed:function(){var h=mstrmojo.all[this.id],k=h.settings;(h.contents.children||[]).forEach(function(n){var m=k&&k.dataset(n.did),l=n.tableView||n.mdxView;n.togglePortlet(m?m.getCollapsed():n.defaultCollapsed?n.defaultCollapsed:false);if(l){l.toggleAllNodesCollapsed(null,null,true);}});this.updateScrollbars();}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.vi.ui._IsUnitDependentPanel","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui.VisualizationEditorUnitList","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.ui.CheckList");mstrmojo.requiresDescs(14389);var H=mstrmojo.array,G=mstrmojo.hash,B=mstrmojo.css;mstrmojo.vi.ui.VisualizationEditor=mstrmojo.declare(mstrmojo.vi.ui.BoxPanel,[mstrmojo.vi.ui._IsUnitDependentPanel,mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.VisualizationEditor",activeZoneId:"",layoutConfig:{h:{controlNode:"25px",containerNode:"100%"},w:{controlNode:"100%",containerNode:"100%"},xt:true},onvisibleChange:function A(I){if(this.viPanelType===mstrmojo.vi.ui.BoxPanel.PANEL_TYPES.DROP_ZONES&&I.value){this.refresh();}},init:function F(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIVizEditor");},onactiveZoneIdChange:function E(I){var J=I.valueWas;if(J){mstrmojo.all[J].clearSelect();}},onVIUnitSelected:function C(L){var I=L&&L.getZonesModel(),S=I&&I.getDropZones(),N=this.contents,K=this.id;B.toggleClass(this.domNode,"empty",!S);if(S){var U=function(V){return{scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:V.n,panelId:K,canCollapse:false,enabled:V.enabled,portletSrc:V,children:[V]};},M=function(W){var V={scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:W.n,getTitleBarCfg:function(){return G.copy({useRichTooltip:true,shouldShowTooltip:function(){return true;},getTooltipContent:function(){return W.title;}},this.constructor.prototype.getTitleBarCfg.call(this));},panelId:K,canCollapse:false,enabled:W.enabled,portletSrc:W,children:[{scriptClass:"mstrmojo.vi.ui.VisualizationEditorUnitList",items:W.items,alias:"unitList",cssClass:W.cssClass,panelId:K,zonesModel:I,zonesSource:W}]};if(W.siblings){V.children=V.children.concat(W.siblings);}return V;},Q=[],O=I.docModel.datasets,R=function(V){(V||[]).forEach(function(W){if(W.usedInDropZones){W.usedInDropZones=false;}});},P=function(V,X){var W=H.find(V,"did",X.did);if(W>-1){V[W].usedInDropZones=true;return true;}return false;},J=new mstrmojo.ui.menus.ToolbarConfig();(S.zones||[]).forEach(function(V){Q=Q.concat(V.items);});if(I.canSwapAxis()){J.addToolbarBtn(mstrmojo.desc(11658,"Swap"),"swap",function(){I.swapAxis();});}else{J.addDisabledToolbarBtn(mstrmojo.desc(11658,"Swap"),"swap");}if(I.canDefineSubtotals()){J.addToggleToolbarButton(mstrmojo.desc(6193,"Show Totals"),"totals",function(){I.showQuickSubtotals();},function(){I.hideDefinedSubtotals();},null,I.hasVisibleSubtotals());}else{J.addDisabledToolbarBtn(mstrmojo.desc(6193,"Show Totals"),"totals");}J.addToolbarBtn(mstrmojo.desc(14389,"Remove Data"),"clearall",function(){I.clearAllDropZones(I.docModel.clearVisAsFilterAction(L));});N.addChildren([{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",alias:"toolbar",visible:true,useRichTooltip:true,cssClass:"VizEditorToolbar",getItemMarkup:function T(V){return this.constructor.prototype.getItemMarkup.call(this,V).replace("{@en@n}",'<div class="icn"></div>');},getLayoutOffsets:function(){return{w:6};}}]);N.toolbar.set("toolbarCfg",J);G.keyarray(O).forEach(function(V){R(O[V].att);R(O[V].mx);(Q||[]).forEach(function(W){if(!P(O[V].att,W)){P(O[V].mx,W);}});});(S.zones||[]).forEach(function(V){if(V.scriptClass){N.addChildren([U(V)]);}else{N.addChildren([M(V)]);}});this.activeZoneId="";this.generateToolbar();}this.doLayout();},updateToolbar:function D(I){if(mstrApp.allowWebDashboardDesign()){this.addRenameTargetMenuItem(I);}this.addHelpTopicMenuItem(I,mstrmojo.desc(1143,"Help"),"html5_dashboard_editor_editor_panel.htm");return this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.ui.editors.controls.XtabResizeGroup","mstrmojo.ui.editors.CharacterToolbarPopup","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.models.FormatModel","mstrmojo.models.template.DataInterface");var O=2,R=3,U=4,G=5;var K=mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS,M=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,F=mstrmojo.models.FormatModel.getFormatUpdate,Q=mstrmojo.hash,J=mstrmojo.array;var E={};E[O]="ch";E[R]="rh";E[U]="va";var N={left:2,center:3,right:4,justify:6};function D(){var W=this.getHost().gridData,X=W&&W.gsi;return(X&&X.fmts)||{};}function C(){var Y=this.getHost(),W=Y.gridInfo&&Y.gridInfo.prop&&Y.gridInfo.prop.sb,X=function(Z){Y.showBanding(Z);};return this.getCheckboxAndLabel(!!W,mstrmojo.desc(13578,"Show banding"),X);}function T(W,X){return this.getLabelAndControl(mstrmojo.desc(3435,"Alignment"),this.getButtonBar([{n:mstrmojo.desc(7575,"Top"),v:1,css:"top"},{n:mstrmojo.desc(8631,"Middle"),v:2,css:"middle"},{n:mstrmojo.desc(7576,"Bottom"),v:3,css:"bottom"}],W[M.VERTICAL_ALIGN]-1,function(Y,Z){X(Y.v,Z.v);},{cssClass:"cellAlign"}));}function P(W,X){return this.getTextAlign(Q.keyarray(N).filter(function(Y){return W[M.TEXT_ALIGN]===N[Y];})[0],X,N);}function L(W){return D.call(this)[E[W]];}function S(W){var X=this.getHost();return function(Y,Z){X.formatGridZone(E[W],F(Y,Z));};}function B(X,Z){var W=L.call(this,Z),a=S.call(this,Z),Y=function(b){return function(c){a(b,c);};};this.replaceChildControls(X,[this.getEditorGroup([this.getCharacterGroup(a,W),this.getContainerGroup(W,a,K.FILL_COLOR),this.getContainerGroup(W,a,K.BORDER,{borderTitle:mstrmojo.desc(12130,"Horizontal Lines"),targetBorder:"bottom"}),this.getContainerGroup(W,a,K.BORDER,{borderTitle:mstrmojo.desc(12131,"Vertical Lines"),targetBorder:"right"}),T.call(this,W,Y(M.VERTICAL_ALIGN)),P.call(this,W,Y(M.TEXT_ALIGN)),this.getWrapText(!!W[M.TEXT_WRAP],Y(M.TEXT_WRAP))])]);}function A(c){var k=this.getHost(),f=k.gridData,Z=new mstrmojo.models.template.DataInterface(f);var a=new mstrmojo.ui.editors.controls.XtabResizeGroup({});a.setFormatSource(k);k.attachEventListener("xtabColsMeasured",a.id,function(){a.setFormatSource(k);});var h=Z.getAggregatePadding(),m=5,W=0,l=[m,m],e=m,Y=false;if(h){l=[h.h,h.v].sort(function(o,n){return o-n;});e=l[1];W=Math.max(Math.min(Math.round((e-m)/m),2),0);Y=true;}var X=this.getLabelAndControl(mstrmojo.desc(13579,"Padding:"),this.getButtonBar([{n:mstrmojo.desc(12141,"S"),v:m,css:"small"},{n:mstrmojo.desc(12142,"M"),v:m*2,css:"medium"},{n:mstrmojo.desc(12140,"L"),v:m*3,css:"large"}],W,function(n){k.formatPadding(n.v,n.v*(l[0]/e));},{cssClass:"cellPadding",showIcon:false}));X.set("enabled",Y);var d=this,b=function(n,o){k.batchFormatGridZones([O,R,U].map(function(p){return E[p];}),J.isArray(o)?o.map(function(p){return F(n,p);}):[O,R,U].map(function(){return F(n,o);}));},g=function(){var n=null;[O,R,U].forEach(function(q){var r=D.call(d)[E[q]],p=M.FONT_SIZE,t=M.FONT_FAMILY,o=M.COLOR;if(Object.keys(r).length===0){return ;}if(!n){n=Q.copy(r);n[p]=J.ensureArray(n[p]);}else{n[p].push(r[p]);if(n[t]!==r[t]){n[t]=-1;}if(n[o]!==r[o]){delete n[o];}}});return n;};this.replaceChildControls(c,[this.getEditorGroup([]),this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(14006,"All Grid Fonts")),this.getCharacterGroup(b,g(),23)]),this.getEditorGroup([C.call(this)]),this.getEditorGroup([this.getGroupTitle(mstrmojo.desc(12129,"Grid Size")),X,a]),this.getEditorGroup([this.getMoreOptionsEditorLink(f&&f.gsi&&f.gsi.prop,true,f&&f.lhv)])]);}mstrmojo.vi.models.editors.XtabEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.XtabEditorModel",help:"dashboard_editor_grid_properties_html5.htm",getInitialTarget:function V(){return G;},getTargetPulldownItems:function I(Y){var c=this.getHost(),a=c.gridInfo,b=this._super(Y);if(a&&(a.rows.length||a.cols.length)){var W=c.getFormats(),X=B.bind(this,Y);b.unshift({n:mstrmojo.desc(6560,"General Settings"),v:G,h:A.bind(this,Y)});if(W){var Z=D.call(this);if(Z){if(Z.ch){b.push({n:mstrmojo.desc(12132,"Column Headers"),v:O,h:X});}if(Z.rh){b.push({n:mstrmojo.desc(12133,"Row Headers"),v:R,h:X});}if(Z.va){b.push({n:mstrmojo.desc(12134,"Values"),v:U,h:X});}}}}return b;},getFormattingToolbar:function H(X,a,Y){var W=L.call(this,X);if(W){var Z=new mstrmojo.ui.editors.CharacterToolbarPopup(Q.copy({onGroupValueChange:S.call(this,X),textAlignValueMap:N,anchorElement:a},Y));Z.setFormatSource(W);return Z;}return this._super(X,a,Y);}});mstrmojo.vi.models.editors.XtabEditorModel.ENUM_EDITOR_TARGETS={GENERAL:G,COLUMNS:O,ROWS:R,VALUES:U};}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.array","mstrmojo.color","mstrmojo.vi.viz.MapHelper","mstrmojo.vi.util.ThresholdUtils","mstrmojo.ui.CheckList","mstrmojo.models.FormatModel","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.gmaps.MapEnums");var R=mstrmojo.vi.viz.EnumDSSDropZones,L=mstrmojo.array,v=mstrmojo.color,AV=mstrmojo.vi.viz.MapHelper,AC=mstrmojo.vi.util.ThresholdUtils,AG=mstrmojo.gmaps,w=AG.EnumMapType,k=AG.PropertyTypes,a=AG.EnumGeographicRole,d=AG.EnumZoomBehavior,H=AG.EnumDataLabel,b=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,AT=mstrmojo.chart.enums.EnumFontStyle,AJ=mstrmojo.gmaps.EnumDataLabelShowOption,AL=1,AO=2,A=R.Latitude,l=R.Longitude,AU=R.GeoAttribute;function T(AY){return new mstrmojo.Label({text:AY,cssClass:"prop-title"});}function q(){return false;}function AE(AY){return(AY===w.Area);}function AA(AY){return(AY===w.Area);}function AH(AY){return(AY===w.Marker||AY===w.Area||AY===w.Density);}function S(AY){return(AY===w.Density);}function X(AZ){var AY=this.getHost(),Aa,Ab;if(AZ===w.Marker||AZ===w.Bubble||AZ===w.Density){Aa=AY.getDropZoneItems(AU);if(Aa&&Aa.length>0){Ab=AY.getDropZoneItems(A);if(!Ab||Ab.length<=0){return true;}}}return false;}function o(AY){return(AY===w.Bubble||AY===w.Area);}function O(Aa){if(Aa===w.Marker||Aa===w.Bubble||Aa===w.Density){var AY=this.getHost(),Ab=AY.getDropZoneItems(AU);if(Ab&&Ab.length>0){var AZ=AY.getDropZoneItems(l);if(!AZ||AZ.length<=0){return true;}}}return false;}function W(AZ,AY){return L.filterOne(AZ.fs,function(Aa){return AY(Aa.fnm,Aa.fgr)&&Aa.obf;});}function AK(AY){return W(AY,AV.isLatitude);}function K(AY){return W(AY,AV.isLongitude);}function AI(AY){var AZ=this.id;return function(Aa){mstrmojo.all[AZ].onPropertiesChanged(AY,Aa.id);};}function AN(Ac,Ad,AZ){var Ab=this.getHost(),Ae="id",AY=function(Af){this.host.getObservableModel().set(k.mapStyle,Af[Ae]);};if(Ac&&Ac.length){var Aa=mstrmojo.ui.Pulldown.newPulldown(Ac,AY,Ad,{host:Ab,bindings:{value:function(){var Af=this.host.observableModel.dv;if(!Ab.isESRIMap){Af=parseInt(Af);Af=isNaN(Af)?0:Af;}this.selectItemByField(Ae,Af);return this.items[this.selectedIndex].n;}}});AZ.push(this.getLabelAndControl(mstrmojo.desc(13583,"Map styles:"),Aa));}}function M(AZ,Ab,Aa){var AY=false;switch(AZ){case k.clusterMode:case k.shapeFile:case k.themeType:AY=true;break;case k.markerType:if(this.getActionsWithUpdateProperty().length===0){AY=true;}break;default:break;}return AY;}function z(AZ,Ab,Aa){var AY=false;switch(AZ){case k.redrawType:AY=true;break;default:break;}return AY;}function AW(Aa){var AZ,AY={},Ab=Aa[H.DATA_LABEL_FONT_STYLE];AY[b.FONT_WEIGHT]=(Ab&AT.FS_BOLD)>0;AY[b.FONT_STYLE]=(Ab&AT.FS_ITALIC)>0;AY[b.UNDERLINE]=(Ab&AT.FS_UNDERLINE)>0;AY[b.LINE_THROUGH]=(Ab&AT.FS_STRIKETHROUGH)>0;AZ=Aa[H.DATA_LABEL_FONT_COLOR];AY[b.COLOR]=AZ==="transparent"?AZ:v.decodeColor(AZ);AY[b.FONT_SIZE]=Aa[H.DATA_LABEL_FONT_SIZE];AY[b.FONT_FAMILY]=Aa[H.DATA_LABEL_FONT_FAMILY];return AY;}mstrmojo.vi.models.editors.MapEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.MapEditorModel",editingProperty:null,getEditingGridKey:function N(){var AY=this.getHost();if(AY){return AY.model.data.k;}return null;},getEditingGrid:function f(){var Aa=this.getHost();if(Aa){var AY=this.getEditingGridKey(),AZ=Aa.getData();if(AZ.k===AY){return AZ;}else{if(AZ.sdp&&AZ.sdp[AY]){return AZ.sdp[AY];}}}return null;},getShapeAttributeGeoRole:function AS(Ac,Ad){var AZ,Af,Ae,AY,Aa,Ah,Ab,Ag=a.EnumGeographicRoleNone;if(!Ac){return Ag;}AZ=Ac.gts;if(!AZ||!AZ.row){return Ag;}if(!!Ad){for(Ah=0;Ah<AZ.row.length;Ah++){Ae=AZ.row[Ah];if(Ae.id===Ad){AY=Ae.fs;for(Ab=0;Ab<AY.length;Ab++){Aa=AY[Ab];Af=Aa.fgr+"";if(Af!==a.EnumGeographicRoleNone&&Af!==a.EnumGeographicRoleLatitiude&&Af!==a.EnumGeographicRoleLongitude){return Af;}}}}}return Ag;},onPropertiesChanged:function u(Ab,AZ){var Ag=this.getHost(),Af=this.getEditingGridKey(),Ac=Ag.getProperties(Af),AY=Ac[Ab],Ad,Ae;this.updateProperties(Ab,AZ);Ad=M.call(this,Ab,AZ,AY);Ae=z.call(this,Ab,AZ,AY);if(Ad||Ae){Ag.updateAfterPropertiesChange(null,true);if(Ad){Ag.drawMarkerLayers();}else{if(Ae){Ag.updateMapExtent();}}var Aa=Ag.zonesModel&&Ag.zonesModel.getUpdateCallback();if(Aa){Aa.success();}}else{Ag.updateAfterPropertiesChange();}},updateProperties:function Y(AY,Ac){var Ab=this.getHost(),Aa=this.getEditingGridKey(),AZ=Ab.getProperties(Aa);if(AZ[AY]===undefined||AZ[AY].toString()!==Ac.toString()){this.editingProperty=AY;AZ[AY]=Ac;}},getActionsWithUpdateProperty:function AB(){var Ai=this.getHost(),Ag=Ai.zonesModel,Ae=[],Au=this.getEditingGridKey(),Ad=Ai.getProperties(Au),Af=!!Ad&&!!this.editingProperty?Ad[this.editingProperty]:null,As=Ai.getData(),Ac=!!As?As.datasetId:null,An=null,Aj=null,Ah=null,Aq=null,Ap=null,Ab=null,Av,Ar;if(this.editingProperty===k.mapType){if(q.call(this,Af)){An=Ai.getDropZoneItems(AU);if(An&&An.length>0){Ab={did:An[0].id,t:An[0].t};Ae.push(Ag.getRemoveDropZoneUnitAction({id:AU},Ab));}}if(AE.call(this,Af)){Aj=Ai.getDropZoneItems(A);if(Aj&&Aj.length>0){Ab={did:Aj[0].id,t:Aj[0].t};Ae.push(Ag.getRemoveDropZoneUnitAction({id:A},Ab));}}if(AA.call(this,Af)){Ah=Ai.getDropZoneItems(l);if(Ah&&Ah.length>0){Ab={did:Ah[0].id,t:Ah[0].t};Ae.push(Ag.getRemoveDropZoneUnitAction({id:l},Ab));}}if(AH.call(this,Af)){Aq=Ai.getDropZoneItems(R.SizeBy);if(Aq&&Aq.length>0){Ab={did:Aq[0].id,t:Aq[0].t};Ae.push(Ag.getRemoveDropZoneUnitAction({id:R.SizeBy},Ab));}}if(S.call(this,Af)){Ap=Ai.getDropZoneItems(R.ColorBy);if(Ap&&Ap.length>0){Ab={did:Ap[0].id,t:Ap[0].t};Ae.push(Ag.getRemoveDropZoneUnitAction({id:R.ColorBy},Ab));}}var At=function(Aw,Ax){Ae.push({act:"addForm",unitId:Aw,attFormId:Ax,unitPos:1});};if(X.call(this,Af)){Av=Ag.getZoneModelByZoneId(AU);Ar=!!Av?Av.items[0]:{};var Ao=AK.call(this,Ar);if(Ao){At(Ar.did,Ao.fid);Ae=Ae.concat(Ag.getAddDropZoneUnitsActions({id:A},[{did:Ao.fid,t:21}],0,{datasetId:Ac}));}}if(O.call(this,Af)){Av=Ag.getZoneModelByZoneId(AU);Ar=!!Av?Av.items[0]:{};var AZ=K.call(this,Ar);if(AZ){At(Ar.did,AZ.fid);Ae=Ae.concat(Ag.getAddDropZoneUnitsActions({id:l},[{did:AZ.fid,t:21}],0,{datasetId:Ac}));}}if(o.call(this,Af)){var Aa=Ag.getZoneModelByZoneId(R.ColorBy),Al=!!Aa?Aa.items[0]:{},AY=As.gsi&&As.gsi.thresholds,Ak=AY&&Al&&AY[Al.did],Am=false;if(Ak){if(Ak.length>0&&Ak[0].rtp===4){Am=true;}}if(Am){AC.addThresholds(Ai.model,Ai,Ai.node,Al,Ae,null,null,true);}}}return Ae.length>0?L.ensureArray(Ag.getUpdateTemplateAction(Ae)):[];},getMapType:function AR(){var AZ=this.getHost(),AY=this.getEditingGridKey(),Aa=AZ.getProperties(AY)[k.mapType];Aa=Aa?Aa:w.Marker;return Aa;},getMapTypes:function U(){return null;},getMapTypeSelectedIndex:function Z(){return 0;},getMapStyle:function E(){var AZ=this.getHost(),AY=this.getEditingGridKey();return AZ.getProperties(AY).dv;},getMapStyles:function J(){return null;},getMapStyleSelectedIndex:function AF(){var Ad=this.getMapStyle(),Ac=this.getMapStyles(),Aa,Ab=Ac?Ac.length:0,AZ,AY=0;if(!!Ad){for(AZ=0;AZ<Ab;AZ++){Aa=Ac[AZ];if(Aa.id==Ad){AY=AZ;break;}}}return AY;},getMarkerType:function AD(){var AY=this.getMapType();if(AY!==w.Marker&&AY!==w.Bubble){AY=w.Marker;}return AY;},getMarkerTypes:function AQ(){return[{n:mstrmojo.desc(11836,"Bubbles"),id:w.Bubble},{n:mstrmojo.desc(11837,"Pins"),id:w.Marker}];},getMarkerTypeSelectedIndex:function e(){return this.getMarkerType()===w.Marker?1:0;},getLegendSwitch:function F(){var Aa=this.getHost(),AZ=this.getEditingGridKey(),AY=Aa.getProperties(AZ)[k.legendSwitch];return AY===undefined||AY.toString()==="true";},getMarkerClusteringType:function c(){return null;},getMarkerClusteringTypes:function m(){return null;},getMarkerClusteringTypeSelectedIndex:function C(){return 0;},getDensityTheme:function h(){var AZ=this.getHost(),AY=this.getEditingGridKey(),Aa=parseInt(AZ.getProperties(AY)[k.themeType],10);return isNaN(Aa)?1:Aa;},getDensityThemes:function AM(){return[{id:1,cls:"rainbow",title:mstrmojo.desc(9234,"Rainbow")},{id:2,cls:"fire",title:mstrmojo.desc(9235,"Fire")},{id:3,cls:"sunrise",title:mstrmojo.desc(9236,"Sunrise")},{id:4,cls:"desert",title:mstrmojo.desc(9237,"Desert")},{id:5,cls:"brick",title:mstrmojo.desc(9238,"Brick")}];},getDensityThemeSelectedIndex:function P(){return this.getDensityTheme()-1;},getAreaShape:function B(){return null;},getAreaShapes:function g(){return null;},getAreaShapeSelectedIndex:function Q(){return 0;},getMapRedrawType:function t(){var AZ=k.redrawType,Aa=this.getHost(),AY=this.getEditingGridKey(),Ab=Aa.getProperties(AY)[AZ],Ab=Ab?Ab:d.Keep;return Ab;},getMapRedrawTypes:function p(){return[{id:d.Keep,n:mstrmojo.desc(13585,"Keep current zoom level")},{id:d.Automatic,n:mstrmojo.desc(13586,"Dynamically change zoom level")}];},getMapRedrawSelectedIndex:function V(){var AZ=this.getMapRedrawType(),AY=0;if(AZ===d.Automatic){AY=1;}return AY;},getPartialUpdateCallback:function G(AY){var AZ=this;return function(Ab){var Aa=AZ.getHost();Aa.setProperty(AY,Ab,{suppressData:true});if(AY===k.legendSwitch){Aa.toggleLegend(Ab);}};},getEditorContents:function D(){var AY=this.getHost();if(AY.gridParams&&(AY.scriptClass!=="mstrmojo.esrimap.ESRIMap"||!AY.useESRICloud||!!AY.mapStyleReady)){return this._super();}else{return null;}},getDelayedEditorContents:function I(AY,Aa){var AZ=this.getHost();this.propertyEditor=AY;this.vizUnit=Aa;AZ.addGridParameterDownloadListener(this,this.updateEditorContent);},updateEditorContent:function AP(){if(this.vizUnit){var AY=this.propertyEditor;if(AY){AY.onVIUnitSelected(this.vizUnit);}}this.propertyEditor=null;this.vizUnit=null;},getContainerCtrlFlags:function r(){return mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS.BORDER;},getInitialTarget:function AX(){return AL;},getTargetPulldownItems:function x(AY){var Aa=this.getHost(),AZ=this._super(AY),Ab=function(Ac){return function(Ad){this.replaceChildControls(AY,Ad.call(this));}.bind(this,Ac);}.bind(this);AZ.unshift({n:mstrmojo.desc(13271,"Map Options"),v:AL,h:Ab(this.getMapOptionControls)});if(Aa.showDataLabelOption()){AZ.push({n:mstrmojo.desc(11993,"Data Labels"),v:AO,h:Ab(this.getDataLabelsControls)});}return AZ;},getMapOptionControls:function n(){var Aa=[],Ad=k,Ab=this.getHost().model.data,Ac=this.getMapType(),Af=function(Ah,Ag,Aj,Al,Ak){if(Ah&&Ah.length){var Ai=mstrmojo.ui.Pulldown.newPulldown(Ah,AI.call(this,Al),Ag,{isHostedWithin:false});if(Ak){Aa.push(this.getEditorGroup([T.call(this,Aj),Ai],{showDivider:true,isNested:true,isContainer:true}));}else{Aa.push(this.getLabelAndControl(Aj,Ai));}}}.bind(this);AN.call(this,this.getMapStyles(),this.getMapStyleSelectedIndex(),Aa);Af(this.getMapTypes(),this.getMapTypeSelectedIndex(),mstrmojo.desc(13582,"Map type:"),Ad.mapType);if(Ac===w.Marker||Ac===w.Bubble){Af(this.getMarkerClusteringTypes(),this.getMarkerClusteringTypeSelectedIndex(),mstrmojo.desc(11841,"Clustering"),Ad.clusterMode);Af(this.getMarkerTypes(),this.getMarkerTypeSelectedIndex(),mstrmojo.desc(13584,"Marker type:"),Ad.markerType);}else{if(Ac===w.Area){Af(this.getAreaShapes(),this.getAreaShapeSelectedIndex(),mstrmojo.desc(11842,"Boundaries"),Ad.shapeFile);}else{if(Ac===w.Density){var AY=this.getDensityThemes();if(AY&&AY.length>0){var AZ=AI.call(this,Ad.themeType);Aa.push(T.call(this,mstrmojo.desc(11839,"Density map color gradient:")));var Ae=new mstrmojo.ui.CheckList({cssClass:"mem-density-list",orientation:"h",items:AY,multiSelect:false});Ae.set("selectedIndex",this.getDensityThemeSelectedIndex());Ae.postselectionChange=function(Ag){AZ(AY[Ag.added[0]]);};Aa.push(Ae);}}}}Af(this.getMapRedrawTypes(),this.getMapRedrawSelectedIndex(),mstrmojo.desc(13820,"Zoom behavior when filtering:"),Ad.redrawType,true);if(this.getHost().hasColorByOrSizeBy()){Aa.push(this.getCheckboxAndLabel(this.getLegendSwitch(),mstrmojo.desc(12001,"Show Legend"),this.getPartialUpdateCallback(Ad.legendSwitch)));}Aa.push(this.getEditorGroup([this.getEditorGroup([this.getMoreOptionsEditorLink((Ab&&Ab.gsi&&Ab.gsi.prop)||{})])],{isNested:true,showDivider:true,isContainer:true}));return[this.getEditorGroup([this.getEditorGroup(Aa)],{showDivider:true,isNested:true,isContainer:true})];},getCharacterControl:function(Ab){var Ae,Ad=this.getHost(),AZ=this.getEditingGridKey(),AY=Ad.getProperties(AZ),Aa={enabled:!Ab},Ac={};Ac[b.FONT_WEIGHT]=AT.FS_BOLD;Ac[b.FONT_STYLE]=AT.FS_ITALIC;Ac[b.UNDERLINE]=AT.FS_UNDERLINE;Ac[b.LINE_THROUGH]=AT.FS_STRIKETHROUGH;Aa.onGroupValueChange=function(Ag,Ah){var Ai,Af=Ah;switch(Ag){case b.COLOR:Ai=H.DATA_LABEL_FONT_COLOR;Af=Ah==="transparent"?Ah:v.encodeColor(Ah);break;case b.FONT_SIZE:Ai=H.DATA_LABEL_FONT_SIZE;break;case b.FONT_FAMILY:Ai=H.DATA_LABEL_FONT_FAMILY;break;case b.FONT_WEIGHT:case b.FONT_STYLE:case b.UNDERLINE:case b.LINE_THROUGH:Ai=H.DATA_LABEL_FONT_STYLE;Af=Ah?(AY[Ai]|Ac[Ag]):(AY[Ai]&(~Ac[Ag]));break;}Ad.persistDataLabelFormatting(Ai,Af);};Ae=new mstrmojo.ui.editors.controls.CharacterGroup(Aa);Ae.setFormatSource(AW(AY));return Ae;},getShowOptionControl:function(){var Ac,Ad,Aa=false,AY=false,Af={multiSelect:true,showIcon:false},Ai=this.getHost(),Ag=this.getEditingGridKey(),Ae=Ai.getProperties(Ag),AZ=[{n:mstrmojo.desc(2057,"None"),v:AJ.NONE}],Ab={txt:{n:mstrmojo.desc(1013,"Text"),v:AJ.SHOW_TEXT},val:{n:mstrmojo.desc(2175,"Values"),v:AJ.SHOW_VALUE}};if(Ai.showDataLabelValue()){AZ.unshift(Ab.val);}if(Ai.showDataLabelText()){AZ.unshift(Ab.txt);}Ad=AZ.length;if(Ad===1){AZ.splice(0,0,Ab.txt,Ab.val);AY=true;}Af.items=AZ;if(AY){Af.enabled=false;}Af.postselectionChange=function(Aj){if(this._sync){return ;}this._sync=true;var Al,Am,Ak;if(Aj.added){if(this.items[Aj.added[0]].v===AJ.NONE){for(Al=0;Al<Ad-1;Al++){if(this.selectedIndices[Al]){this.removeSelect(Al);}}}else{if(this.selectedIndices[Ad-1]){this.removeSelect(Ad-1);}}}else{if(Aj.removed){Ak=true;for(Al=0;Al<Ad;Al++){if(this.selectedIndices[Al]){Ak=false;break;}}if(Ak){this.addSelect(Ad-1);}}else{mstr_profile.log("Should never happen");}}Am=AZ.reduce(function(Ap,Ao,An){return this.selectedIndices[An]?(Ap|Ao.v):Ap;}.bind(this),0);Ai.persistDataLabelFormatting(H.DATA_LABEL_SHOW,Am);this._sync=false;};Ac=new mstrmojo.ui.ButtonBar(Af);var Ah=function(Ak){var Aj;this._sync=true;if(Ak===AJ.NONE){this.singleSelectByField(Ak,"v");Aa=true;}else{Aj=(this.items||[]).map(function(Am,Al){return(Ak&Am.v)>0?Al:null;}).filter(function(Al){return Al!==null;});if(Aj.length<=0){this.singleSelectByField(AJ.NONE,"v");Aa=true;}else{this.select(Aj);}}this._sync=false;}.bind(Ac);Ah(Ae[H.DATA_LABEL_SHOW]);return{control:Ac,disableCtrls:AY||Aa};},getShowAllCheckBoxControl:function(AZ){var Ag=this.getHost(),Af=this.getEditingGridKey(),Ad=Ag.getProperties(Af),Ab=H.DATA_LABEL_SHOW_ALL,Ac=new mstrmojo.ui.Checkbox({checked:!Ad[Ab],oncheckedChange:function AY(Ah){Ag.persistDataLabelFormatting(Ab,!Ah.value);}}),Aa=this.getLabelAndControl(mstrmojo.desc(14606,"Hide overlapping labels"),Ac,"20px","100%",true,{enabled:!AZ}),Ae=Aa.getLabel();Ae.onclick=function(){Ac.onclick();};return Aa;},getDataLabelsControls:function(){var AY=this.getShowOptionControl(),AZ=AY.disableCtrls;return[this.getEditorGroup([AY.control,this.getShowAllCheckBoxControl(AZ),this.getCharacterControl(AZ)])];}});}());(function(){mstrmojo.requiresCls("mstrmojo.models.FormatModel","mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.DocSelector");var C=3;var B=mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS,E=mstrmojo.models.FormatModel,L=E.getFormatUpdate,H=E.ENUM_PROPERTY_NAMES,G="#DBDBDC";function D(P,N,O,M){return this.getLabelAndControl(P,this.getPulldown(N,O,M||0));}function I(T){var U=this,R=this.getHost(),P=R.parent,S=R.model,V=R.defn,Y=[],X=R.getSelectorStyleList(),W=V.ssc,O;if(!R.isRecursiveAttributeSelector()){Y.push(D.call(this,mstrmojo.desc(3059,"Style:"),X,function(Z){S.changeFilterStyle(R,Z);},X.map(function(Z){return Z.v;}).indexOf(V.style)));}Y.push(this.getCharacterGroup(this.getChangeGroupPropertyFn(1),this.getHost().getFormats()||{},B.FONT_FAMILY+B.FONT_SIZE_AND_COLOR+B.FONT_STYLE_NO_STRIKEOUT));if(R.supportSelectionColor()){if(R.content&&R.content.getPropertyDefaultValue){O=R.content.getPropertyDefaultValue(H.SELECTOR_SELECTION_COLOR);}if(!O){O=G;}Y.push(this.getLabelAndControl(mstrmojo.desc(14057,"Selection:"),new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:true,selectedValue:W!==undefined?E.decodeValue(H.SELECTOR_SELECTION_COLOR,W):O,postselectedValueChange:function(Z){S.changeUnitFormatProperty(P,[{formatType:1,propertyName:H.SELECTOR_SELECTION_COLOR,newValue:Z.value,oldValue:Z.valueWas}]);}})));}if(R.allowsOrientationChange()){Y.push(this.getButtonBar([{n:mstrmojo.desc(4604,"Auto"),v:-1},{n:mstrmojo.desc(12286,"Horizontal"),v:1},{n:mstrmojo.desc(12285,"Vertical"),v:0}],V.ob?(V.horiz?1:2):0,function(b){var d=b.v,c=P.domNode,a=d===-1,e=(a?(c.offsetWidth>c.offsetHeight):d)?1:0;P.set("orientation",e);V.ob=a?0:1;var Z=L(H.CONTROL_ORIENTATION_BEHAVIOR,a?0:1);L(H.CONTROL_ORIENTATION,e?1:0,Z);S.submitUndoRedoFormatChange(P,{1:Z},null,null,mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);},{showIcon:false}));}if(R.supportsInclude()){Y.push(D.call(this,mstrmojo.desc(2707,"Mode:"),[{n:mstrmojo.desc(3945,"Include"),v:true},{n:mstrmojo.desc(3946,"Exclude"),v:false}],function(Z){R.set("include",Z);},R.include?0:1));}if(R.allowsTogglingMultiSelect()){Y.push(this.getCheckboxAndLabel(R.multi,mstrmojo.desc(4742,"Allow multiple selections"),function(a,Z){S.submitUndoRedoFormatChange(P,{1:L(H.CONTROL_MULTISELECT,a)},null,{success:function(){var c=S.getUnitDefinitions(R.k)[R.k];c.multi=a;var b=mstrmojo.all[P.id];P.parent.selectVIUnit(P.parent.rebuildChild(b),true);}},mstrmojo.DocDataService.SUPPRESS_DATA);}));}if(R.allowsSameSizeItems()){var N=this.getCheckboxAndLabel(V.iwm===0,mstrmojo.desc(4782,"Make all item same width"),function(Z){S.submitUndoRedoFormatChange(P,{1:L(H.CONTROL_ITEM_WIDTH_MODE,Z?0:1)},null,{success:function(){var b=S.getUnitDefinitions(R.k)[R.k];b.iwm=Z?0:1;S.itemsFitContent=b.iwm;var a=mstrmojo.all[P.id];P.parent.selectVIUnit(P.parent.rebuildChild(a),true);}},mstrmojo.DocDataService.SUPPRESS_DATA);});S.itemsFitContent=!N.children[0].checked;Y.push(N);}if(R.isAttributeSelector()&&!R.isAttrQualSelector()&&!R.isSearchBox()&&R.include){var Q=V.showall;Y.push(this.getCheckboxAndLabel(Q,mstrmojo.desc(4741,"Show option for all"),function(Z){S.submitSelectorPropsChange(P,{showAll:!!Z});}));if(Q){var M=this.getLabelAndControl(mstrmojo.desc(4851,"Alias:"),new mstrmojo.TextBox({value:V.allStr||"",valueChangeDelay:300,onvalueChange:function(){V.allStr=this.value;S.submitSelectorPropsChange(P,{allAlias:this.value});}}),"53px","100%");M.getLabel().cssText="text-align:right;";Y.push(M);}}this.replaceChildControls(T,[this.getEditorGroup(Y,{showDivider:false})]);}mstrmojo.vi.models.editors.FilterEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.editors.FilterEditorModel",help:"dashboard_editor_selector_properties.htm",getInitialTarget:function A(){return !this.getHost().node.defn.srcid?mstrmojo.vi.models.editors.BaseEditorModel.TITLE_CONTAINER_VALUE:C;},getTargetPulldownItems:function J(M){var N=this._super(M);N.push({n:mstrmojo.desc(6189,"Filter"),v:C,h:I.bind(this,M)});N.reverse();return N;},getTitleFormatCode:function K(){return 5;},getEditorContents:function F(){return mstrApp.allowWebDashboardDesign()?this._super():[];}});mstrmojo.vi.models.editors.FilterEditorModel.SELECTOR_VALUE=C;}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","CharacterGroup","ContainerGroup","TwoColumnContainer","ColorPickerButton","LineStyleButton","ValidationTextBox");var R=mstrmojo.hash,X=mstrmojo.emptyFn,O=mstrmojo.array,H=mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS,A=mstrmojo.chart.enums.EnumFontStyle,Q=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,N=mstrmojo.gm,V=mstrmojo.expr.DTP;var P="allTxt",E="lg",Y=0,a=1;var I=false;function B(b){if(I&&window.console){window.console.log(b);}}function Z(b,d){return{broker:b,smartNames:d,controlName:d[0],reInitDefault:function(){(this.listenFormatProps).forEach(function(e){this.onFmtPropsChanged(e,this.broker.getFormatPropertyValue(e));},this);},reInit:function(){this.reInitDefault();},preBuildRendering:function(){this.reInit();},syncControl:function(e){var f=this._sync;this._sync=true;var g=e.call(this);this._sync=f;return g;},onFmtPropsChangedDefault:X,onFmtPropsChanged:function(e,g,f){this.onFmtPropsChangedDefault(e,g,f);},onSelectorsValueChangedDefault:function(){this.reInit();},onSelectorsValueChanged:function(e,f){this.onSelectorsValueChangedDefault(e,f);},destroy:function c(e){this.broker.removeRegisterFormatControl(this);return this.constructor.prototype.destroy.call(this,e);}};}function L(g,e,c,b){if(!g){return ;}function f(p){return Object.keys(O.hash(O.ensureArray(p)));}var k=g.listenFormatProps||[],m=g.listenSelector||[];(g.smartNames||[]).forEach(function(p){O.insert(k,null,p);O.insert(m,null,g.broker.getDependingSelectorNames(p));});g.listenFormatProps=f(k);g.listenSelector=f(m);g.broker.registerFormatControl(g);var o=g;if(typeof e==="string"){var d=(c===a),h=d?"20px":"30%",l=d?"100%":"70%";if(b){h=b[0];l=b[1];}o=this.getLabelAndControl(e,g,h,l,d);g.label=o.getLabel();if(d){o.cssClass="checkLabel multiLine";g.label.onclick=function n(){g.onclick();};g.label.cssDisplay="inline-block";}else{if(c===Y){o.cssClass="characterGroup";}}}g.getCtrlContainer=function(){return o;};return o;}function T(d,c){var e=d.getFormatPropertyValue(c);function b(g){var h=g.value;return(h===undefined||h==="")&&e===undefined;}return{onInvalid:function f(){if(b(this)){if(this.hasRendered){this.clearValidation();}return ;}else{if(this.hasRendered){mstrmojo.ui.editors.controls.ValidationTextBox.prototype.onInvalid.call(this);}}},onRender:function(){if(b(this)){this.clearValidation();}}};}function G(e,c){var b={},h=e.getFormatPropertyValue(c.fontStyle),f=e.getFormatPropertyValue(c.fontColor),d=e.getFormatPropertyValue(c.fontFamily),g=e.getFormatPropertyValue(c.fontSize);if(h!==undefined){b[Q.FONT_WEIGHT]=(!isNaN(h)&&((h&A.FS_BOLD)>0));b[Q.FONT_STYLE]=(!isNaN(h)&&((h&A.FS_ITALIC)>0));b[Q.UNDERLINE]=(!isNaN(h)&&((h&A.FS_UNDERLINE)>0));b[Q.LINE_THROUGH]=(!isNaN(h)&&((h&A.FS_STRIKETHROUGH)>0));}b[Q.COLOR]=f!==undefined?f:-1;b[Q.FONT_SIZE]=g!==undefined?g:-1;b[Q.FONT_FAMILY]=d!==undefined?d:-1;return b;}mstrmojo.imagelayout.ImageLayoutEditorHelper=mstrmojo.provide("mstrmojo.imagelayout.ImageLayoutEditorHelper",{getFillConfigComp:function U(f,c,d,k){var b=f.propertyManager,h=R.valarray(d),e=Z(b,h);R.copy({smartNamesMap:d,onGroupValueChange:function(l,m){if(!this._sync){b.setFormatPropertyValue(l,m);}},onFmtPropsChangedDefault:function(l,m){this.syncControl(function(){var n=this;if(O.filterOne(this.propNames,function(o){return(o===l);})){n.setChildValue(l,m);}else{this.propNames.forEach(function(o){n.setChildValue(o,b.getFormatPropertyValue(o));});}});}},e);R.copy(k,e);var g=f.addDisposable(new mstrmojo.ui.editors.controls.FillConfigGroup(e));g.iniChildrenComp(h);return L.call(this,g,c);},getLineConfigComp:function W(f,c,d,k){var b=f.propertyManager,h=R.valarray(d),e=Z(b,h);R.copy({smartNamesMap:d,onGroupValueChange:function(l,m){if(!this._sync){b.setFormatPropertyValue(l,m);}},onFmtPropsChangedDefault:function(l,m){this.syncControl(function(){this.setChildValue(l,m);});}},e);R.copy(k,e);var g=f.addDisposable(new mstrmojo.ui.editors.controls.LineConfigGroup(e));g.iniChildrenComp(h);return L.call(this,g,c);},getCharacterConfigComp:function D(g,l,f,m){var b=g.propertyManager,n=R.valarray(f),k=Z(b,n),h={},e={};e[Q.FONT_SIZE]=f.fontSize;e[Q.COLOR]=f.fontColor;e[Q.FONT_FAMILY]=f.fontFamily;e[Q.FONT_WEIGHT]=e[Q.FONT_STYLE]=e[Q.UNDERLINE]=e[Q.LINE_THROUGH]=f.fontStyle;h[Q.FONT_WEIGHT]=A.FS_BOLD;h[Q.FONT_STYLE]=A.FS_ITALIC;h[Q.UNDERLINE]=A.FS_UNDERLINE;h[Q.LINE_THROUGH]=A.FS_STRIKETHROUGH;R.copy({smartNamesMap:f,syncWithAllText:false,onGroupValueChange:function(r,q){var u=e[r];if(u===f.fontStyle){var p=b.getFormatPropertyValue(u),t=h[r],o=q;q=o?(p|t):(p&(~t));}else{if(u===f.fontSize){if(this.visibleControls&H.FONT_SIZE_USE_STEPPER){q=q[0];}q=parseInt(q,10)+"pt";}}this.broker.setFormatPropertyValue(u,q);},onFmtPropsChangedDefault:function(o){this.syncControl(function(){var p=this.smartNamesMap,q=O.filterOne(R.keyarray(p),function(r){return p[r]===o;});if(q||this.syncWithAllText){if(!q&&o.indexOf(P)===-1){B("[CharacterGroup] Unnecessary refresh which might be due to incorrect listenFormatProps.");}this.refreshValues();}});},refreshValues:function(){this.syncControl(function(){var o=G(this.broker,this.smartNamesMap);if(this.visibleControls&H.FONT_SIZE_USE_STEPPER){o[Q.FONT_SIZE]=[parseInt(o[Q.FONT_SIZE],10)];}this.setFormatSource(o);});}},k);R.copy(m,k);if(k.syncWithAllText){var d=R.valarray(b.getSmartNamesMapForFontGroup(P));k.listenFormatProps=(k.listenFormatProps||[]).concat(d);}var c=g.addDisposable(new mstrmojo.ui.editors.controls.CharacterGroup(k));return L.call(this,c,l);},getPropertyCheckBox:function J(f,d,c,k){var b=f.propertyManager,h=[c],e=Z(b,h);R.copy({oncheckedChange:function(){if(this._sync){return ;}b.setFormatPropertyValue(this.smartNames[0],this.checked);},onFmtPropsChangedDefault:function(l,m){this.syncControl(function(){this.set("checked",!!m);});}},e);R.copy(k,e);var g=f.addDisposable(new mstrmojo.ui.Checkbox(e));return L.call(this,g,d,a);},getPropertyPulldown:function S(f,k,g,b,l){l=l||{};var d=f.propertyManager,m=[b],h=Z(d,m),c=l.fnChange||function(n){if(this._sync){return ;}d.setFormatPropertyValue(this.smartNames[0],n);};R.copy({onFmtPropsChangedDefault:function(n,o){this.syncControl(function(){if(typeof o==="undefined"){this.set("selectedIndex",-1);}else{this.selectItemByField("v",o);}});}},h);R.copy(l,h);var e=f.addDisposable(this.getPulldown(g,c,0,h));return L.call(this,e,k,null,["40%","60%"]);},getPropertyButtonBar:function M(e,h,f,b,k){var c=e.propertyManager,l=[b],g=Z(c,l);R.copy({showIcon:false,items:f,onFmtPropsChangedDefault:function(m,n){this.syncControl(function(){if(this.multiSelect){this.select((this.items||[]).map(function(p,o){return(n&p.v)>0?o:null;}).filter(function(o){return o!==null;}));}else{if(typeof n==="undefined"){this.clearSelect();}else{this.singleSelectByField(n,"v");}}});},postselectionChange:function(m){if(this._sync){return ;}var n=m.added&&this.items[m.added[0]].v;if(this.multiSelect){if(!f||!f.length){return B("[ImageLayoutEditorModel getBitwiseValFromMultiSelection] no items in caller");}n=f.reduce(function(q,p,o){return this.selectedIndices[o]?q|=p.v:q;}.bind(this),0);}c.setFormatPropertyValue(this.smartNames[0],n);}},g);R.copy(k,g);var d=e.addDisposable(new mstrmojo.ui.ButtonBar(g));return L.call(this,d,h);},getPropertyValidationTextBox:function C(f,d,c,k){var b=f.propertyManager,h=[c],e=Z(b,h);R.copy({dtp:V.FLOAT,required:true,onValid:function(){if(this._sync){return ;}b.setFormatPropertyValue(this.smartNames[0],this.value);},onFmtPropsChangedDefault:function(l,m){this.syncControl(function(){this.set("value",m);this.validate();});}},e);R.copy(k,R.copy(T(b,c),e));var g=f.addDisposable(new mstrmojo.ui.editors.controls.ValidationTextBox(e));return L.call(this,g,d);},getPulldown:function F(c,f,b,e,d){R.copy({_set_selectedIndex:function g(l,h){if(h===-1){this.selectedIndex=h;this.getPopupList().clearSelect();var k=this.selectedNode;if(k){k.innerHTML="";}return false;}return this.constructor.prototype._set_selectedIndex.call(this,l,h);}},e);return mstrmojo.ui.Pulldown.newPulldown(c,function(h,k){f.call(this,h.v,k&&k.v);},b,e,d);},getLabelAndControl:function K(d,e,g,k,f,h){var l=new mstrmojo.Label({text:d,setDimensions:function(o,m){var n=this.domNode;if(n){n.style.width=m;}}}),c=l,b=e;if(f){c=e;b=l;}c.slot="col1Node";b.slot="col2Node";return new mstrmojo.ui.editors.controls.TwoColumnContainer(R.copy(h,{col1Width:g||"40%",col2Width:k||"60%",children:[c,b],getLabel:function(){return l;},getCtrl:function(){return this.children.filter(function(m){return m!==l;})[0];}}));}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.BaseEditorModel","mstrmojo.imagelayout.ImageLayoutEditorHelper","mstrmojo.locales");mstrmojo.requiresClsP("mstrmojo.ui.editors.controls","CharacterGroup","ContainerGroup","TwoColumnContainer","ColorPickerButton","LineStyleButton","FillConfigGroup");var K=mstrmojo.hash,W=mstrmojo.array,m=mstrmojo.func,p=mstrmojo.locales,F=mstrmojo.VisEnum.IMAGELAYOUT_PROPERTIES,k=mstrmojo.gm,Y=k.EnumIdentityType,Z=mstrmojo.imagelayout.ImageLayoutEditorHelper,J=mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS;var C="de",a="lgd",I="rcl",U="dl";var g="allTxt",A="dl",Q="lg",P=Q+"Bg",c="shape",M="shapeBorder",S="@",E="selBdrMtxLn4";function V(r,q,u,t){r.slot="col1Node";q.slot="col2Node";return this.addDisposable(new mstrmojo.ui.editors.controls.TwoColumnContainer({col1Width:u||"40%",col2Width:t||"60%",children:[r,q]}));}function n(q,t,r,v){var u=this.addDisposable(Z.getPulldown(t,v.fnChange||function(w){r.onTargetSelectionChanged(q,w);if(this._sync){return ;}},0,v));r.registerSelector(q,u);return u;}function d(){var r=this.broker.vis,q=r.zonesModel.getZoneModelByZoneId(mstrmojo.vi.viz.EnumDSSDropZones.ColorBy).items;return this.getLabelAndControl(mstrmojo.desc(6242,"Color"),this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13174,"Select color ranges..."),cssText:"text-decoration: underline;cursor: pointer;",onclick:function(){r.model.openThresholdEditor(q[0],true,false);}})),"30%","70%");}function h(){var z=this.getHost(),t=this.broker,w=this.getGroupTitle(mstrmojo.desc(13751,"Shape Formatting")),v,u,x,AA=[w],q=t.getSmartNamesMapForColorFormat(c),r=t.getSmartNamesMapForLineGroup(M);if(z.getColorByIndex()>=0){v=d.call(this);u=this.addDisposable(this.getLabelAndControl(mstrmojo.desc(13658,"Fill Opacity"),Z.getFillConfigComp(z,null,q,{visibleControls:J.FILL_TRANSPARENCY}),"60%","40%"));x=this.addDisposable(this.getLabelAndControl(mstrmojo.desc(3538,"Border Style"),Z.getLineConfigComp(z,null,r,{hideColorControl:true,showNoFillInColor:false,showAutomaticInColor:true}),"60%","40%"));AA=AA.concat([v,u,x]);}else{u=Z.getFillConfigComp(z,mstrmojo.desc(13601,"Fill:"),q,{controlName:"shapeFormattingFillGroup",showGradient:false});x=Z.getLineConfigComp(z,null,r,{lineTitle:mstrmojo.desc(9736,"Border")});AA=AA.concat([u,x]);}return AA;}function H(){var v=this.getHost(),q=v.propertyManager,x=q.CONSTANTS.DISPLAY_MODE,u=F.DISPLAY_MODE,t=this.getGroupTitle(mstrmojo.desc(4963,"Display Mode")),r=Z.getPropertyPulldown(v,null,[{n:mstrmojo.desc(6019,"Automatic"),v:x.AUTOMATIC},{n:mstrmojo.desc(9738,"Area"),v:x.AREA},{n:mstrmojo.desc(348,"Bubble"),v:x.BUBBLE}],u,{listenFormatProps:["enableDisplayMode"],onFmtPropsChanged:function(z,AA){if(z==="enableDisplayMode"){this.set("enabled",AA);}else{this.onFmtPropsChangedDefault(z,AA);}}}),w=[t,r];return w;}function l(){var v=this.getHost(),t=v.propertyManager,u=F.MAP_FILE_PATH,r=this.getGroupTitle(mstrmojo.desc(14446,"Shape File")),q=Z.getPropertyPulldown(v,null,W.map(v._shapeFileList,function(z){var x=z.descWeb,AA=x?mstrmojo.desc(parseInt(x.slice(x.indexOf(".")+1),10),z.name):z.name;return{n:AA,v:z.shapeFile};}),u,{listenFormatProps:["isMultipleIL"],onFmtPropsChanged:function(x,z){if(x==="isMultipleIL"){this.set("enabled",!z);}else{this.onFmtPropsChangedDefault(x,z);}}}),w=[r,q];return w;}function G(w){var AA=this.getHost(),u=AA.propertyManager,z=u.CONSTANTS.DATA_LABEL,t=[{n:mstrmojo.desc(1013,"Text"),v:z.SHOW_TEXT},{n:mstrmojo.desc(2175,"Values"),v:z.SHOW_VALUE},{n:mstrmojo.desc(2057,"None"),v:z.NONE}],r=F.DATA_LABEL_SWITCH,v=this.broker,q=this.getGroupTitle(mstrmojo.desc(11993,"Data Labels")),x=Z.getPropertyButtonBar(AA,null,t,r,{multiSelect:true,cssClass:"dataLabel "+("itemsCnt"+t.length),onFmtPropsChangedDefault:function(AD,AE){this.syncControl(function(){if(AE===z.NONE){this.singleSelectByField(AE,"v");}else{this.select((this.items||[]).map(function(AG,AF){return(AE&AG.v)>0?AF:null;}).filter(function(AF){return AF!==null;}));}});},postselectionChange:function(AD){if(this._sync){return ;}var AG=AD.added&&this.items[AD.added[0]].v,AE=(AG===z.NONE),AF=AD.removed&&(this.items[AD.removed[0]].v===z.NONE),AH=!this.selectedIndices||(this.selectedIndices&&!this.selectedIndices[0]&&!this.selectedIndices[1]);if(AF){if(AH){if(!this.selectedIndices[2]){this.addSelect(2);}}return ;}if(AE){W.forEach([0,1],function(AI){if(this.selectedIndices[AI]){this.removeSelect(AI);}}.bind(this));}else{if(AH){if(!this.selectedIndices[2]){this.addSelect(2);}}else{if(this.selectedIndices[2]){this.removeSelect(2);}}AG=t.reduce(function(AK,AJ,AI){return this.selectedIndices[AI]?AK|=AJ.v:AK;}.bind(this),0);}this.broker.setFormatPropertyValue(this.smartNames[0],AG);}}),AC=Z.getCharacterConfigComp(AA,null,v.getSmartNamesMapForFontGroup(A),{controlName:"DataLabelFontGroup",listenFormatProps:[r],onFmtPropsChanged:function(AD,AE){if(AD===r){this.set("enabled",AE!==z.NONE);}else{this.onFmtPropsChangedDefault(AD,AE);}}}),AB=[q,x,AC];return AB;}function X(){var AI=this.getHost(),x=AI.propertyManager,AD=x.CONSTANTS.EnumMaxSizeType,AB=x.CONSTANTS.EnumMinSizeType,q=(AI.calculateSizeByIndex()>-1),z=p.number.DECIMALSEPARATOR,r={trigger:mstrmojo.validation.TRIGGER.ONBLUR,min:0.01,max:1,regExp:new RegExp("^\\d+("+z+"\\d{1,2})?$")},v=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13918,"Max size (0.01 - 1.0):")})),w=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13917,"Min size (0.01 - 1.0):")})),AH=this.addDisposable(new mstrmojo.Label()),u=mstrmojo.desc(13740,"The smallest element's size is ## of the largest element's size");var AF=x.CONSTANTS.DISPLAY_MODE,AA=x.getFormatPropertyValue(F.DISPLAY_MODE)===AF.BUBBLE;var AE=F.MAX_SIZE_TYPE,AC=F.MIN_SIZE_TYPE,t=V.call(this,Z.getPropertyPulldown(AI,null,[{n:mstrmojo.desc(6019,"Automatic"),v:AD.AUTO},{n:mstrmojo.desc(8262,"Manual"),v:AD.MANUAL}],AE,{listenFormatProps:["calcDisplayMode"],onFmtPropsChanged:function(AJ,AK){if(AJ==="calcDisplayMode"){this.parent&&this.parent.set("enabled",AK!==AF.AREA&&q);}else{this.onFmtPropsChangedDefault(AJ,AK);}}}),Z.getPropertyValidationTextBox(AI,null,F.MAX_SIZE_VALUE,{constraints:r,listenFormatProps:[AE],onFmtPropsChanged:function(AJ,AK){if(AJ===AE){this.set("enabled",AK===AD.MANUAL);}else{this.onFmtPropsChangedDefault(AJ,AK);}}}),"75%","25%"),AG=V.call(this,Z.getPropertyPulldown(AI,null,[{n:mstrmojo.desc(11990,"Proportional"),v:AB.PROPORTIONAL},{n:mstrmojo.desc(13741,"Full Range"),v:AB.AUTO},{n:mstrmojo.desc(14118,"Adjusted Range"),v:AB.MANUAL}],AC,{listenFormatProps:["calcDisplayMode"],onFmtPropsChanged:function(AJ,AK){if(AJ==="calcDisplayMode"){this.parent&&this.parent.set("enabled",AK!==AF.AREA&&q);}else{this.onFmtPropsChangedDefault(AJ,AK);if(AK===AB.PROPORTIONAL){AH.set("text",mstrmojo.desc(13743,"The smallest element's size is proportional to its data element"));}else{if(AK===AB.AUTO){AH.set("text",mstrmojo.desc(13744,"The smallest element's size is fixed, independent of its data value"));}}}}}),Z.getPropertyValidationTextBox(AI,null,F.MIN_SIZE_VALUE,{constraints:r,listenFormatProps:[AC],onFmtPropsChanged:function(AJ,AL){if(!q){this.set("enabled",false);return ;}if(AJ===AC){var AK=AL===AB.MANUAL;this.set("enabled",AK);if(AK){AH.set("text",u.replace("##",this.value*100+"%"));}}else{this.onFmtPropsChangedDefault(AJ,AL);if(this.enabled){AH.set("text",u.replace("##",AL*100+"%"));}}}}),"75%","25%");this.addDisposable([t,AG]);return[v,t,w,AG,AH];}function o(){var v=this.getHost(),t=v.propertyManager,r=this.broker,u=E,q=u+S;var w=this.getGroupTitle(mstrmojo.desc(12050,"Matrix Lines"));return[w,n.call(this,u,[{n:mstrmojo.desc(11998,"All Matrix Lines"),prefix:"allMatrixLn",identity:(Y.H_MATRIX_LINE|Y.V_MATRIX_LINE),v:0},{n:mstrmojo.desc(11999,"Horizontal Matrix Lines"),prefix:"hMatrixLn",identity:Y.H_MATRIX_LINE,v:1},{n:mstrmojo.desc(12000,"Vertical Matrix Lines"),prefix:"vMatrixLn",identity:Y.V_MATRIX_LINE,v:2}],t,{highlightObjects:[(Y.H_MATRIX_LINE|Y.V_MATRIX_LINE),Y.H_MATRIX_LINE,Y.V_MATRIX_LINE],groupTitle:w}),Z.getLineConfigComp(v,null,r.getSmartNamesMapForLineGroup(u+S),{listenSelector:[u],listenFormatProps:["allMatrixLnClr","allMatrixLnCmbStyle"],lineTitle:mstrmojo.desc(13927,"Line:"),controlName:"MatrixLineGroup",groupTitle:w,showNoFillInColor:false,showGradient:false})];}function L(r){var q=[this.getEditorGroup(H.call(this)),this.getEditorGroup(l.call(this)),this.getEditorGroup(X.call(this))];this.replaceChildControls(r,q);}function B(r){var q=[this.getEditorGroup(o.call(this))];this.replaceChildControls(r,q);}function T(r){var q=[this.getEditorGroup(h.call(this)),this.getEditorGroup(G.call(this))];this.replaceChildControls(r,q);}function D(r,t){m.override({showPickerForCurrentMode:function q(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var u=this.gradientOrientation;u.set("selectedIndex",W.find(u.items,"id",0));}}},r.colorPicker);}function R(w){var AA=this.getHost(),t=F.LEGEND_SHOW,v=this.broker,x=function(AC,AE){if(AC===t){var AD=this.parent,AB=this;if(AD&&AD.scriptClass==="mstrmojo.ui.editors.controls.TwoColumnContainer"){AB=AD;}AB.set("enabled",!!AE);}else{this.onFmtPropsChangedDefault(AC,AE);}},u=Z.getPropertyCheckBox(AA,mstrmojo.desc(13600,"Show legend"),t),q=Z.getCharacterConfigComp(AA,null,v.getSmartNamesMapForFontGroup(Q),{controlName:"LegendFontGroup",listenFormatProps:[t],onFmtPropsChanged:x}),z=this.addDisposable(new mstrmojo.Label({text:mstrmojo.desc(13601,"Fill:")})),r=Z.getFillConfigComp(AA,null,v.getSmartNamesMapForColorFormat(P),{controlName:"LegendBackgroundFillGroup",listenFormatProps:[t],onFmtPropsChanged:x});mstrmojo.css.addWidgetCssClass(u,"title");this.replaceChildControls(w,[this.getEditorGroup([u,q,z,r])]);}mstrmojo.vi.models.editors.ImageLayoutEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.BaseEditorModel,null,{scriptClass:"mstrmojo.vi.models.ImageLayoutEditorModel",help:"dashboard_editor_image_layout_html5_properties.htm",broker:null,init:function(q){this._super(q);this.broker=this.getHost().propertyManager;var r=this.getHost();r.switchToPanelListener=r.attachEventListener("switchToPanel",this.id,function(t){var u=t.panelID;if(u!==undefined){this.switchPanelByValue(u);}});r.switchTargetSelectorListener=r.attachEventListener("switchTargetSelector",this.id,function(t){var u=t.selName,v=t.value;this.switchTargetSelector(u,v);});},getInitialTarget:function f(){return C;},getTargetPulldownItems:function b(q){var t=this._super(q),r=this.getHost(),u=function(w){this.broker.clearRegisterFormatControl();return w.bind(this,q);}.bind(this),v=function(w){this.broker.clearRegisterFormatControl();return function(){var x=this.getHost();x.getShapeFileListWithXHR(w.bind(this,q));}.bind(this);}.bind(this);t.unshift({n:mstrmojo.desc(11974,"Data Exploration"),v:C,h:v(L)});t.push({n:mstrmojo.desc(11978,"Rows and Columns"),v:I,h:u(B)});t.push({n:mstrmojo.desc(13757,"Shapes and Data Labels"),v:U,h:u(T)});if(r.hasSizeByOrColorByThs()){t.push({n:mstrmojo.desc(2403,"Legend"),v:a,h:u(R)});}return t;},getEditorGroup:function O(q,r){if(!this._super){return new mstrmojo.vi.ui.editors.EditorGroup(K.copy(r,{children:q}));}return this.addDisposable(this._super(q,r));},switchPanelByValue:function(q){if(this.initializing){return ;}this.selectTargetByValue(q);},switchTargetSelector:function(r,t){if(this.initializing){return ;}var q=this.broker,u=q.getTargetSelector(r);if(u.selectItemByField){u.selectItemByField("v",t);}},detachListeners:function N(){var q=this.getHost();if(q.switchToPanelListener){q.detachEventListener(q.switchToPanelListener);delete q.switchToPanelListener;}if(q.switchTargetSelectorListener){q.detachEventListener(q.switchTargetSelectorListener);delete q.switchTargetSelectorListener;}},destroy:function e(q){this.detachListeners();if(this._super){this._super(q);}delete this.broker;}});}());(function(){mstrmojo.requiresCls("mstrmojo.OIVMDocSelectorViewFactory","mstrmojo.DocSelector","mstrmojo.vi.models.VIComponentMap","mstrmojo.vi.models.editors.FilterEditorModel","mstrmojo.vi.ui.rw.selectors._IsDocSelector","mstrmojo.vi.ui.rw.selectors._IsPageBySelector","mstrmojo.vi.ui.rw.selectors._IsFilterSelector","mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo._HasLayout");var C=mstrmojo.vi.models.VIComponentMap.TYPES;function D(G,E,F){return this.docBuilder.getLayoutVIMap(G.defn._lkz).isComponent(F,E);}mstrmojo.vi.ui.rw.selectors.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.OIVMDocSelectorViewFactory,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.DocSelectorViewFactory",docBuilder:null,getDocSelectorClass:function A(I,J,H,L){var E=[mstrmojo._HasLayout,mstrmojo.vi.ui.rw.selectors._IsDocSelector,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],G=L.pk,F=J.defn,K=this._super(I,J);if(D.call(this,J,G,C.PAGEBY_PANEL)){E.push(mstrmojo.vi.ui.rw.selectors._IsPageBySelector);}if(D.call(this,J,G,C.FILTER_PANEL)){E.push(mstrmojo.vi.ui.rw.selectors._IsFilterSelector);}return mstrmojo.DynamicClassFactory.newComponent(K,E,null);},newDocSelector:function B(G,H,F,J){var I=this.getDocSelectorClass(G,H,F,J),E=J.pk,K=new I({id:H.id,node:H,controller:G.controller,model:G,slot:this.docBuilder.defaultSlot});if(!D.call(this,H,E,C.PAGEBY_PANEL)&&!D.call(this,H,E,C.FILTER_PANEL)){K.edtModel=new mstrmojo.vi.models.editors.FilterEditorModel({hostId:K.id,docModel:G});}if(H.defn&&H.defn.style===9){K.filterElemALL=true;}return K;}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.MapEditorModel");mstrmojo.requiresDescs(7736,8068,8102,8069,9237,2797,8958,8764,8765,13254,13256,11845,11846,11847);var D=mstrmojo.gmaps.EnumMapType;mstrmojo.vi.models.editors.GoogleMapEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.MapEditorModel,null,{scriptClass:"mstrmojo.vi.models.GoogleMapEditorModel",help:"dashboard_editor_google_map_html5_properties.htm",getMapTypes:function A(){return[{n:mstrmojo.desc(13254,"Marker"),id:D.Marker},{n:mstrmojo.desc(13256,"Density"),id:D.Density}];},getMapTypeSelectedIndex:function C(){var F=this.getMapType(),E=0;switch(F){case D.Marker:case D.Bubble:E=0;break;case D.Density:E=1;break;default:break;}return E;},getMapStyles:function B(){var F=[{n:mstrmojo.desc(7736,"Map"),id:0},{n:mstrmojo.desc(8068,"Satellite"),id:1},{n:mstrmojo.desc(8102,"Terrain"),id:2},{n:mstrmojo.desc(8069,"Hybrid"),id:3}],J=this.getHost().model.data.mstProp,E,H,G,I={4:mstrmojo.desc(9237,"Desert"),5:mstrmojo.desc(2797,"Blank"),6:mstrmojo.desc(11845,"Ice"),7:mstrmojo.desc(8958,"Dark"),8:mstrmojo.desc(11846,"Nature"),9:mstrmojo.desc(11847,"Arctic")};if(J){for(E in J){H=J[E];G=I[E];if(!!G){F.push({n:G,id:E});}}}return F;}});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.models.editors.MapEditorModel","mstrmojo.gmaps.MapPropertiesHelper","mstrmojo.gmaps.MapEnums","mstrmojo.array");mstrmojo.requiresDescs(8068,6030,6031,13254,13256,13255,11849,11850,11851,11852,11853,11854,11855);var G=mstrmojo.gmaps.MapPropertiesHelper,E=mstrmojo.gmaps,N=E.EnumGeographicRole,A=E.PropertyTypes,C=E.EnumMapType,R=E.EnumClusterMode,I=mstrmojo.array;mstrmojo.vi.models.editors.ESRIMapEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.MapEditorModel,null,{scriptClass:"mstrmojo.vi.models.ESRIMapEditorModel",help:"dashboard_editor_esri_map_html5_properties.htm",vizUnit:null,defaultShapeId:null,updateProperties:function H(S,W){var V=this.getHost(),U=this.getEditingGridKey(),T=V.getProperties(U);this.editingProperty=S;if(S==A.mapType||S==A.markerType){switch(W){case C.Marker:case C.Bubble:case C.Density:T.sm="1";T.sa="0";T[S]=W;break;case C.Area:T.sm="0";T.sa="1";this.getAreaShapes();T.lid=this.getAreaShape();T[S]=W;break;default:T[S]=W;break;}}else{if(T[S]===undefined||T[S]===null||T[S].toString()!==W.toString()){T[S]=W;}}},getMapType:function B(){var T=A.mapType,U=this.getHost(),S=this.getEditingGridKey(),W=U.getProperties(S),V;if(W&&W.sa&&W.sa=="1"){V=C.Area;}else{if(W&&W[T]){V=W[T];}else{if(W&&W.sm&&W.sm=="1"){V=C.Marker;}}}return V;},getMapTypes:function L(){return[{n:mstrmojo.desc(13254,"Marker"),id:C.Marker},{n:mstrmojo.desc(13255,"Area"),id:C.Area},{n:mstrmojo.desc(13256,"Density"),id:C.Density}];},getMapTypeSelectedIndex:function F(){var T=this.getMapType(),S=0;switch(T){case C.Marker:case C.Bubble:S=0;break;case C.Area:S=1;break;case C.Density:S=2;break;default:break;}return S;},getMapStyles:function M(){var W=this.getHost(),V=[],S=W.mapStylesCache,X,U={"World Street Map":mstrmojo.desc(13821,"Street"),"Light Gray Map":mstrmojo.desc(13822,"Light gray"),"Relief Map":mstrmojo.desc(13823,"Relief"),"Topographic Map":mstrmojo.desc(11852,"Topographic"),"Physical Map":mstrmojo.desc(13824,"Physical"),"Terrain Map":mstrmojo.desc(8102,"Terrain"),"Satellite View Map":mstrmojo.desc(8068,"Satellite")};if(!!W.gridParams&&!!W.gridParams.config&&!!W.gridParams.config.useESRICloud&&W.gridParams.config.useESRICloud==1){if(!!S){for(var T=0;T<S.length;T++){X=S[T];V.push({n:U[X],id:X});}}}return V;},getMarkerClusteringType:function D(){var T=A.clusterMode,U=this.getHost(),S=this.getEditingGridKey(),V=U.getProperties(S)[T];if(V!==R.ON&&V!==R.OFF&&V!==R.PIE){V=R.OFF;}return V;},getMarkerClusteringTypes:function O(){return[{n:mstrmojo.desc(6030,"On"),id:R.ON},{n:mstrmojo.desc(344,"Pie"),id:R.PIE},{n:mstrmojo.desc(6031,"Off"),id:R.OFF}];},getMarkerClusteringTypeSelectedIndex:function P(){var T=this.getMarkerClusteringType(),S=0;switch(T){case R.ON:S=0;break;case R.PIE:S=1;break;case R.OFF:default:S=2;break;}return S;},getAreaShape:function Q(){var T=A.shapeFile,U=this.getHost(),S=this.getEditingGridKey(),V=parseInt(U.getProperties(S)[T],10);V=isNaN(V)?this.defaultShapeId:V;return V;},getAreaShapes:function J(){var b=this.getEditingGridKey(),d=this.getHost(),Z=d.getProperties(b),V=d.zonesModel.getZoneModelByZoneId(mstrmojo.vi.viz.EnumDSSDropZones.GeoAttribute),e,T,W,Y,U=[],S=this.getEditingGrid(),a=N.EnumGeographicRoleNone,c;I.forEach(V&&V.items,function(f){c=f.id;return false;});if(!c&&!!Z){c=Z.ma;}if(!c||c.length==1){Z.lid="";this.defaultShapeId=null;return null;}a=this.getShapeAttributeGeoRole(S,c)||a;e=d.gridParams&&d.gridParams.config;if(e&&parseInt(e.useESRICloud,10)!=1){return null;}if(e){T=e.shapes;for(W=0;W<T.length;W++){Y=T[W];if(a===N.EnumGeographicRoleNone||a===N.EnumGeographicRoleOther&&Y.custom&&Y.custom==true||a==Y.roleId){U.push({id:Y.id,n:Y.desc});}}}this.defaultShapeId=null;var X=G.getMatchingShape(T,null,a===N.EnumGeographicRoleNone?null:a);if(!!X){this.defaultShapeId=X.id;}return U;},getAreaShapeSelectedIndex:function K(){var T=this.getAreaShapes(),X=this.getAreaShape(),W=T?T.length:0,V,U,S=-1;for(V=0;V<W;V++){U=T[V];if(U.id==X){S=V;break;}}return S;}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.dom","mstrmojo.color","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.Label","mstrmojo.DocDataService","mstrmojo.Xtab","mstrmojo._HasOwnAvatar","mstrmojo._HasPopup","mstrmojo.vi.ui._IsDropTarget","mstrmojo.rw.xtab._XtabColResize","mstrmojo.vi.ui._XtabCellHoverMgr","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.VIDragUnit","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights","mstrmojo.ui.editors.RenameEditor","mstrmojo.models.FormatModel","mstrmojo.models.template.DataInterface","mstrmojo.vi.models.editors.XtabEditorModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste");mstrmojo.requiresClsP("mstrmojo.vi.ui.rw","_IsMultiselectXtab","_HasVisSelections","_XtabHighlights","_XtabDE","_XtabRA","VizDropCue");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates");mstrmojo.requiresDescs(11664,11668,13766,13767,14668);var k=mstrmojo,Ao=k.array,n=k.func,X=k.hash,AL=k.dom,AO=k.models,AD=k.vi.models,Am=k.vi.viz,Aa=AO.template.DataInterface,u=AO.FormatModel,r=u.ENUM_PROPERTY_NAMES,AV=u.getFormatUpdate,K=mstrmojo.DocDataService.SUPPRESS_DATA,I=Ao.fnReduceNumber,AH="px",Ai=Am.EnumVisualizationTemplates,Ad=mstrmojo.vi.models.EnumDragSources;var l=Aa.ENUM_GRID_RESIZE,AS=l.FIXED,S=l.FIT_TO_WINDOW,AU=l.FIT_TO_CONTENTS,t=AD.EnumDragSources,Ab=AD.editors.XtabEditorModel.ENUM_EDITOR_TARGETS,Ag=Ab.COLUMNS,AT=Ab.ROWS,Aq=Ab.VALUES,v=4,E="00000000000000000000000000000000";function AQ(At){this.submitUndoRedoActionsWithCallback(this.controller.dataService().getUpdateTemplateAction(this.k,At));}function m(){var Av=this.id,At=this.model.docModel;return{success:function Au(Ax){var Az=mstrmojo.all[Av],Ay=Az.parent,Aw=Az.getScrollPos();Ay=At.partialUpdateAndRebuildChild(Ay,Ax)||Ay;window.setTimeout(function(){At.selectVIUnit(Ay.id,true);Ay.boxContent.scrollTo(Aw,true);},0);}};}function Ar(){this.raiseEvent({name:"toggleCtrlOverlay",visible:(!this.gridData||this.gridData.eg===""),controls:[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")}]});}function AE(){var At=document.createElement("textarea");At.className="xTabHiddenTextArea";this.domNode.appendChild(At);this.xTabHiddenTextArea=At;}function x(Au,At,Av){Au.push({x:At,y:Av});}function h(Ax,Av,Ay,Au,A3,Aw,A1,At){var A4=A1.o,A0=0,Az={or:A4,size:A1.cueSize+AH},A2=function(){return Math.max(A0+Aw-6,A1.cueMinPos)+AH;};if(A4==="v"){A0=Ax;Az.top=Av+AH;Az.left=A2();}else{A0=Av;Az.top=A2();Az.left=Ax+AH;}At.push({id:Ay+"|"+Au,points:A3,cue:Az});}function Z(Ay,Ax,Au,Az){var Aw=[],At=Au/2,Av=Az.end;x(Aw,Ay,Ax);if(Az.o==="v"){x(Aw,Ay,Av);x(Aw,Ay+At,Av);x(Aw,Ay+At,Ax);}else{x(Aw,Ay,Ax+At);x(Aw,Av,Ax+At);x(Aw,Av,Ax);}return Aw;}function H(Az,Ay,Au,A0,Aw){var At=Au/2,Av=A0.end,Ax=[];if(A0.o==="v"){x(Ax,Az+At,Ay);x(Ax,Az+At,Av);if(Aw){x(Ax,A0.side,Av);x(Ax,Az+Au,A0.header);}else{x(Ax,Az+Au,Av);}x(Ax,Az+Au,Ay);}else{x(Ax,Az,Ay+At);x(Ax,Az,Ay+Au);if(Aw){x(Ax,Av,A0.side);x(Ax,Av,Ay+Au);}else{x(Ax,Av,Ay+Au);}x(Ax,Av,Ay+At);}return Ax;}function AK(A1,Ax,Az,Aw,Ay,A0,At){var Av=A1.x,Au=A1.y;h(Av,Au,Aw,Ay,Z(Av,Au,Ax,A0),0,A0,At);h(Av,Au,Aw,Ay+1,H(Av,Au,Ax,A0,Az),Ax,A0,At);}function Q(Ax,Az,Ay,A0,Av,A2,Au){var A1=0,Aw=Ax[0],At=function(){var A3=Az.splice(0,A1).map(Av).reduce(I,0);AK(A2(Ay),A3,false,-1,Aw+1,A0,Au);return A3;};Ax.forEach(function(A3){if(A3===Aw){A1++;}else{Ay+=At();Aw=A3;A1=1;}});At();}function d(Av,At,Aw,Ay,Az,Au){var Ax=Av.length-1;Av.forEach(function(A1,A0){AK(Az(At,Aw),A1,A0===Ax,Aw,A0+1,Ay,Au);At+=A1;});}function AF(Aw,Av,Au){var At={order:[]};Aw.forEach(function(Az){var Ax=Az.id||"metrics",Ay=At[Ax];if(!Ay){At.order.push(Ax);}At[Ax]=(Ay&&Ay+1)||(Az.fs&&Az.fs.length)||1;});return At.order.map(function(Ax){return Av.splice(0,At[Ax]).map(Au).reduce(I,0);});}function Ah(At){var BE=new mstrmojo.models.template.DataInterface(this.gridData),A6=AL.position(this.zone.tableNode),A5=this.gridInfo,A7=this.gridData,BB=A7.twm.bottom.map(function(BF){return parseInt(BF.w,10);}),BC=AF(BE.getRowTitles().titles,BB,function(BF){return BF;}),Az=Array.prototype.slice.call(this.zone.domNode.getElementsByTagName("tr"),0),A1=BC.reduce(I,0),A3=AF(BE.getColTitles().titles,Az,function(BF){return BF.offsetHeight;}),A8=A6.y,Ay=A8+A3.reduce(I,0),A0=A6.x+A6.w,A2=A6.y+A6.h,BD=A6.x,A9=AL.position(this.domNode.parentNode),A4={cueSize:Math.min(A9.h,A6.h),cueMinPos:A9.x,header:Ay,side:A0,end:A2,o:"v"},Au={cueSize:Math.min(A9.w,A6.w),cueMinPos:A9.y,header:Ay,side:A2,end:A0,o:"h"},Ax=function(BF){return{x:BF,y:A8};},BA=function(BF,BG){var BH={x:BD,y:BF};if(BG===2){BH.x+=A1;}return BH;},Aw=[];if(At.getCtxtDragData().item.t===v&&A5.mx&&A5.mx.length){var Av=A7.gvs.items;if(A5.tma===2){Q(Av[0].items.map(function(BF){return BF.mix;}),BB,BD+A1,A4,function(BF){return BF;},Ax,Aw);}else{Q(Av.map(function(BF){return BF.items[0].mix;}),Az,Ay,Au,function(BF){return BF.offsetHeight;},BA,Aw);}}else{Au.cueSize-=A1;d(BC,BD,1,A4,Ax,Aw);d(A3,A8,2,Au,BA,Aw);}return Aw;}function A(){var At=this.model;return !!(At.getSelectorControlMapInfo?At.getSelectorControlMapInfo():[]).length;}function Ae(Av){if(!Av){return Ab.GENERAL;}var At=Av.info;if(!At){return undefined;}if(At.isSrcTitle){return Ag;}var Au=At.title;if(Au.otp===-1&&!Av.isMetricHeader){return Aq;}return Au.axis===1?AT:Ag;}function T(){var Au=this.msgNode,At=this.getFormats()["background-color"];if(Au&&At){Au.style.color=mstrmojo.color.getContrastingColor(At,"#cdcdcd","#444649");}}mstrmojo.vi.ui.rw.Xtab=mstrmojo.declare(mstrmojo.Xtab,[mstrmojo._HasOwnAvatar,mstrmojo.rw.xtab._XtabColResize,mstrmojo.ui._HasScroller,mstrmojo.vi.ui.rw._IsMultiselectXtab,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights,mstrmojo.vi.ui.rw._XtabHighlights,mstrmojo.vi.ui.rw._XtabDE,mstrmojo._HasPopup,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi.ui.rw.xtab._SupportXtabCopyPaste,mstrmojo.vi.ui.rw._XtabRA],{scriptClass:"mstrmojo.vi.ui.rw.Xtab",controller:null,formatHandlers:{msgNode:["height"],viewport:["D"]},dropZone:true,isMultiSelect:true,cellHoverMgr:"mstrmojo.vi.ui._XtabCellHoverMgr",CELL_HIGHLIGHT:"xtabSel",isVIXtab:true,supportsEditorClickSwitching:true,_set_edtModel:function a(Au,Av){var At=this._edtModelListener;if(At){At.clear();}this.edtModel=this.addDisposable(Av);this._edtModelListener=Av.attachEventListener("BEMFormatChange",this.id,function(Aw){if(Aw.propertyName===r.BACKGROUND_COLOR){T.call(this);}});return true;},handlesMultiSelection:function p(){return true;},getVisType:function C(){return{s:"VisGrid",vt:Ai.GRID};},_set_gridData:function c(Au,At){this.gridData=At;this.raiseEvent({name:"regenerateToolbar"});return true;},submitUndoRedoActionsWithCallback:function w(At,Au){this.controller.submitUndoRedoTemplateWithCallback(this,At,Au);},updateForPU:function(At){this.node=At;this.update(At);},update:function o(Aw){var Av=this.gridData,Ay=Av&&Av.gsi&&Av.gsi.fmts;if(Ay){var Au=Aw.data,Ax=Au[0]||Au,At=Ax&&Ax.gsi&&Ax.gsi.fmts;if(At){X.keyarray(At).forEach(function(Az){if(At[Az].empty){At[Az]=Ay[Az];}});}}this._super(Aw);Ar.call(this);},postBuildRendering:function As(){this._super();this.shouldClipLockableXtab=false;T.call(this);Ar.call(this);AE.call(this);},supportsContextMenu:function F(){return true;},setupScrollNodes:function O(){this.scrollNode=this.scrollboxNode;this.scrollbarHostNode=this.domNode;},drill:function AX(At,Ax){var Aw,Au=this.model,Av=this;if(!At._e){Aw=Au.getDrillAction(this.getActionCells(At),Ax);}else{Aw=Au.getDrillAction(Ao.map(this.selCells,function(Ay){return Av.getCellForNode(Ay);}),Ax);}this.controller.onDrill(this,Aw);},pivot:function g(Au,Aw){var Ax=this,Av=this.model,At=function(){AQ.call(Ax,Av.getPivotAction(Au,Aw));};if(Aw==="2"){Av.xtab.zonesModel.checkAndWarnLargeItemsForAddUnits([Au],At,null,true);return ;}At();},pivotForm:function P(At,Au){if(Au==="l"||Au==="r"){AQ.call(this,this.model.getPivotFormAction(At,Au));}},showTotal:function b(At,Av,Au){AQ.call(this,this.model.getTotalsAction(At,Av,Au));},renameUnit:function AW(A0){var Ay=A0&&A0.mix!==undefined&&!!A0._e,Au=(Ay?A0._e.oid:A0.id),Az=Ay?4:A0.otp,Aw=this.model,Ax=this.gridInfo,At=Ax.rows.concat(Ax.cols).concat(Ax.mx).filter(function(A2){return A2.did===Au;})[0],Av=Aw.getUnitNameInDataSet(Au),A1=(At&&At.n)||A0.n||A0.v;(new mstrmojo.ui.editors.RenameEditor({renameText:A1,helpText:Av&&A1!==Av?mstrmojo.desc(14668,"Original Name: ##").replace("##",Av):null,onRename:function(A2){var A3=function(){AQ.call(this,Aw.getRenameTemplateUnitAction(Au,Az,A2,Az===v));}.bind(this);if(Aw.doesNameExistOnTemplate(this,Au,Az,A2)){mstrmojo.confirm(mstrmojo.desc(11664,'"##" already exists in the visualization. Do you want to proceed?').replace("##",A2),{confirmBtn:{fn:A3}});}else{A3();}}.bind(this)})).open();},removeUnit:function W(At){var Au=At&&At.mix!==undefined&&!!At._e;AQ.call(this,this.model.getRemoveTemplateUnitAction({did:Au?At._e.oid:At.id,t:Au?4:At.otp}));},removeTotal:function V(Au){var Aw=Au.hst;if(Aw!==undefined){var Av=this.model,Ax=Av.getCellTitleInfo(Au).title;var At=![].concat(Ax.ast||[]).some(function(Ay){return Ay.t===Aw;});if(At){AQ.call(this,Av.getRemoveAxisTotalsAction(Aw,Au.axis));}else{this.showTotal(Ax,[],[Aw]);}}},formatGridZone:function AM(Au,At){AQ.call(this,this.model.getZoneFormatAction(Au,At,this.k));},batchFormatGridZones:function N(Au,At){var Av=this;AQ.call(this,Au.map(function(Ax,Aw){return Av.model.getZoneFormatAction(Ax,At[Aw],Av.k);}));},formatPadding:function Al(Au,Av){var At=AV(r.GRID_HORIZONTAL_PADDING,Au,AV(r.GRID_VERTICAL_PADDING,Av));AQ.call(this,["ch","rh","va"].map(function(Aw){return this.model.getZoneFormatAction(Aw,At,this.k);},this));},keepOnlyOrExclude:function G(At,Av){var Au=this.controller,Aw=this.getSelections(),Ax=n.wrapMethods(Au._getXtabCallback(this));Au.applyKeepOnly(this,Ax,{keepOnly:Av,data:Aw.length>0?Aw:[this.model.getCellDataUnion(At)]});if(!Av){this.clearSelections();this.endSelections();}},setAllXtabWidths:function Y(Aw){var Av=this.gridData.twm||{},At=Av.top,Au=Av.bottom;(Au||[]).forEach(function(Ax,Ay){At[Ay].w=Ax.w=Aw?(Aw+AH):Aw;});},changeResizeScenario:function AZ(A6,At,Az,BA){var Au=new mstrmojo.models.template.DataInterface(this.gridData),Ay=Au.getRowResizeInfo(),A4=this.gridData.twm||{},A7=A4.bottom,A2=Au.getColumnHeaderData(),BE=this,Ax=this.model,A5=this.id,BF=this.k,A1=[],Aw=[],A9=[],Av=1,A8=At?Au.getColResizeScenario():Ay.v,BC=[];if(A8===A6){return ;}if(At){A1.push({act:"changeXtabColWidthScenario",value:A6});if(A6===AS||A8===AS){A2.forEach(function(BH,BG){var BL=BH.oid||BH.id,BK=function(BM){return BM.unitId===BL&&BM.depth===Av;},BJ=A2[BG-1];if(!(BH.fs&&BH.fs.length>0)||(BJ&&BL!==(BJ.oid||BJ.id))){Av=1;}var BI=BL===(Az&&Az.did)&&Av===Az.depth;if(!BC.some(BK)){BC.push({unitId:BL,depth:Av});Aw.push({colIndex:BG,value:BI?Az.width+AH:A7[BG].w});A9.push({colIndex:BG,value:A7[BG].w});if(A6===AS){A1.push(Ax.getColumnResizeAction(BL,BH.otp,BI?Az.width:parseInt((A7[BG].w)||0,10),Av,BI?Az.isExtra:false));}}Av++;});}var BB=function BB(BG,BI){var BH=mstrmojo.all[A5];if(BG===AS){BE.updateRelatedColWidths(BI);}BE.updateScenario(BG);};if(!BA){this.controller.cmdMgr.execute({execute:function A0(){BB(A6,Aw);this.submit(Ax.getDataService().getUpdateTemplateAction(BF,A1),m.call(mstrmojo.all[A5]),K);},urInfo:{undo:function BD(){BB(A8,A9);},redo:function A3(){BB(A6,Aw);},callback:m.call(this)}});}else{BB(A6,Aw);}}else{A1.push({act:"changeXtabRowHeightScenario",value:A6,height:Ay.height});if(!BA){AQ.call(this,A1);}}return BA?A1:undefined;},submitColumnWidthChange:function e(A0,Ax,At,Aw){var Ay=this;if(!Ax){this.controller.cmdMgr.execute({execute:function Az(){this.submit(Ay.model.getDataService().getUpdateTemplateAction(Ay.k,A0),m.call(Ay),K);},urInfo:{undo:function Au(){Ay.updateRelatedColWidths(At);},redo:function Av(){Ay.updateRelatedColWidths(Aw);},callback:m.call(this),extras:K}});}},changeColumnWidth:function An(A7,A5,A4,Au,A2,A8){var At=new mstrmojo.models.template.DataInterface(this.gridData),A1=this.gridData.twm||{},A3=A1.bottom,A0=At.getColumnHeaderData(),BA=this,Ay=this.model,Az=[],Aw=[],A6=[],Av=1,Ax=-1,A9=[];if(At.getColResizeScenario()!==AS){Az=this.changeResizeScenario(AS,true,{did:A7,t:A5,width:A4,depth:Au,isExtra:A2},A8);return A8?Az:undefined;}if(A7==="all"){A0.forEach(function(BC,BB){var BF=BC.oid||BC.id,BE=function(BG){return BG.unitId===BF&&BG.depth===Av;},BD=A0[BB-1];if(!(BC.fs&&BC.fs.length>0)||(BD&&BF!==(BD.oid||BD.id))){Av=1;}if(!A9.some(BE)){A9.push({unitId:BF,depth:Av});Aw.push({colIndex:BB,value:A4+AH});A6.push({colIndex:BB,value:A3[BB].w});Az.push(Ay.getColumnResizeAction(BF,BC.otp,A4,Av,false));}Av++;});}else{A0.every(function(BC,BB){var BD=(BC.oid===A7||BC.id===A7);if(BD){Ax=BB+Au-1;}return !BD;});if(Ax>=0){Aw.push({colIndex:Ax,value:A4+AH});A6.push({colIndex:Ax,value:A3[Ax].w});Az.push(Ay.getColumnResizeAction(A7,A5,A4,Au,A2));}}BA.updateRelatedColWidths(Aw);BA.submitColumnWidthChange(Az,A8,A6,Aw);return A8?Az:undefined;},changeRowHeight:function Aj(At){AQ.call(this,{act:"changeXtabRowHeightScenario",value:AS,height:At});},showBanding:function z(At){this.controller.submitUndoRedoUpdates(this.model.getDataService().getUpdateTemplateAction(this.k,{act:"showBanding",show:!!At}),{},m.call(this));},getDragData:function Ap(At){var Aw=At.src.node,Ay=this;if(!this.isColResizeNode(Aw)&&!this.isDraggingScrollBar(At)){var Ax=this.model,A2=this.getCellForNode(Aw),Av=Ax.getCellInfo(A2),Az=Av.isTitle,A1=(Av.isMetric&&Av.isHeader);if(Az||A1){var A0=Az?Ax.getCellTitleInfo(A2).title.id:A2._e.oid,A3=Ax.getObjectInfo(A0);A3.cell=A2;var Au=(At.dragUnitHelper=new mstrmojo.vi.ui.VIDragUnit()).getUnitDragData(At,[A3]);Au.src=Ad.VIZ;Au.onRemove=function(A4){Ay.removeUnit(A4.cell);};Au.allowDropOnTarget=function(A4){if(A4===Ad.DATASETS){return true;}return false;};return Au;}}return this._super(At);},isDragValid:function AB(Au){var Av=Au.src.node,At={};if(!this.isColResizeNode(Av)&&!this.isDraggingScrollBar(Au)){At=this.model.getCellInfo(this.getCellForNode(Av));}return At.isTitle||(At.isMetric&&At.isHeader)||this._super(Au);},createAvatar:function R(Au,At){if(At.dragUnitHelper&&!this.isColResizeNode(Au)){return At.dragUnitHelper.getUnitAvatar(At);}return this._super(Au,At);},positionAvatar:function f(Au,At){if(At.dragUnitHelper){At.dragOffsets=At.dragUnitHelper.getDragUnitOffsets();}this._super(Au,At);},allowBoxDropFromDataset:function AG(Au){var At=this.gridData;return !At||At.egt!==undefined;},allowDrop:function D(Au){var Av=Au.getCtxtDragData(),At=Av&&Av.items;return Au.dragUnitHelper||Au.src===this||Au.src===this||((At&&At.length===1)&&Av.src===t.DATASETS);},getDropData:function AA(At){var Av=At.getCtxtDragData().item,Au=Av&&(new mstrmojo.models.template.DataInterface(this.gridData)).getUnitById(Av.did),Aw=!!Au?mstrmojo.desc(13766,"Move ##"):mstrmojo.desc(13767,"Add ##");return{cue:new mstrmojo.vi.ui.rw.VizDropCue(),unit:Au,tip:Aw.replace("##",Av.n),avatar:!!Au?"move":"add"};},ondragenter:function L(Au){var At=Au.xtabMaps=Au.xtabMaps||{};if(!At[this.id]){At[this.id]=Ah.call(this,Au);}this.openPopup(Au.getCtxtDropData().cue);this.ignoreHover=true;},ondragover:function AI(At){var Au=At.xtabMaps[this.id],Az=At.getCtxtDropData(),Ax;Au.every(function(A2){if(mstrmojo.boxmodel.isPtInPolygon(At.tgt.pos,A2.points)){Ax=A2;return false;}return true;});var Aw=(Ax&&Ax.id)||"";if(Az.areaId!==Aw){var Av=At.getCtxtDragData(),A0=null,A1="",Ay=Ax&&Ax.cue;if(Ay){A0={tip:Az.tip,or:Ay.or,size:Ay.size,top:Ay.top,left:Ay.left};A1=Az.avatar;}else{if(Av.src===t.DATASETS){A1=Az.unit?"no-op":"add";}}Az.cue.set("cueConfig",A0);Az.areaId=Aw;Av.setAvatarClass(A1);}},ondrop:function B(Av){var A0=Av.getCtxtDropData().areaId,Ax=Av.getCtxtDragData();if(A0){var A8=A0.split("|"),A5=parseInt(A8[0],10),A2=parseInt(A8[1],10),Az=Ax.items[0],Aw=this.model,A9=Az.did,BA=Aw.getCurrentUnitAxisAndPosition(A9),A7;if(Av.src===this||BA){var A3=BA.axis,A6=BA.depth;if(A5!==A3||(A2!==A6&&A2!==A6+1)){if(A5===A3&&A6<A2){A2--;}A7=Aw.getPivotUnitAction(A5,A2-1,A9,Az.t);}}else{Aw.addEditNodeForDatasetAction(Av,this.k);A7=Aw.getAddTemplateUnitAction(Az,Ax.dsid,A5,A2-1);}if(A7){var BB=this,A1=this.controller,At=function(){var BG=Av.actions||[],BE;BE=A1.dataService().getUpdateTemplateAction(BB.k,[A7]);if(BE&&BE.actions){var BF=false,BD=[],BC;Ao.forEach(Av.getCtxtDragData().items,function(BH){BC=(BH.t===v&&BH.id!==E);BF=BC||BF;if(BC){BD.push(BH);}});if(BF){BE.actions.push(BB.model.getValuesDefaultFormatGridZoneAction(BD));}}BG.push(BE);BB.submitUndoRedoActionsWithCallback(BG,Av.callback);},Au=function(){var BC=Av.actions||[];BB.submitUndoRedoActionsWithCallback(BC,Av.callback);};if(A5===2){Aw.xtab.zonesModel.checkAndWarnLargeItemsForAddUnits([Az],At,Au,true);return this._super(Av);}if(Ax.src===t.ALL_OBJECT_LIST){var Ay=Av.src.widget,A4=Ay&&Ay.dataProvider;if(A4){A4.loadObjects([Az],{success:At});}}else{At();}}}else{if(Ax.dsid){this.zonesModel.addUnitsFromDataSource(Ax.items,Ax.dsid,Av.actions,Av.callback);}}this._super(Av);},cleanUpAfterTarget:function Ac(Au){this._super(Au);var At=Au.getCtxtDropData().cue;if(At){this.closePopup();At.destroy();}this.ignoreHover=false;},getFormatMenuItemTarget:Ae,getFormatTargetFromCell:function M(At){return Ae({info:this.model.getCellTitleInfo(At),isMetricHeader:At&&At.mix!==undefined&&!!At._e});},highlightFormatTarget:function AP(Aw){var Av=mstrmojo.vi.ui.rw.SelectionType,Au=Av.METRIC_VALUES,At=!!(this.hasAssociatedNodes()&&this.getSelections()),Ax=(this.highlights||[]).slice();if(Aw===Ag){Au=Av.COL_HEADERS;}else{if(Aw===AT){Au=Av.ROW_HEADERS;}}this.highlightRange(Au,At);return At?Ax:null;},highlightNumberFormatTarget:function Ak(At){var Au=(this.highlights||[]).slice();if(At&&At.did){this.highlightCellsById(At.did,At.t);}else{if(At&&At._e){this.highlightCellsById(At._e.id,12,true);}}return Au;},restoreHighlights:function AC(At){if(At){this.clearHighlights();this.highlightCells(At);}else{this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}},onclick:function AJ(At){this._super(At);if(AL.isPrimaryMouseBtn(At.e)&&!At.ctrlKey&&!At.shiftKey&&!At.metaKey){var Au=this.getCellForNode(At.getTarget());if(Au){var Av=this.getFormatTargetFromCell(Au);if(Av){At.e.ptvSelected=true;if(this.edtModel){this.edtModel.selectTargetByValue(Av);}}}}},editDerivedAttribute:function J(Aw){var At=this.model.docModel,Av=this.getDerivedAttribute(Aw.id),Au;if(Av){Au={dsid:Av.dsid,did:Aw.id,n:Aw.n,alias:Aw.n,forms:Av.fs,datasets:At.datasets};this.controller.openDAE(this,Au,mstrmojo.emptyFn,null);}},newDerivedAttribute:function q(Ax){var At=this.model.docModel,Aw=this,Au={forceRefresh:true,alias:"New Attribute",datasets:At.datasets,precreate:function Av(Ay){Ay=X.copy({act:"addDAToTemplate",nodeKey:Aw.k,treeType:Aw.defn.tt,axis:Ax.axis},Ay);if(Ax.ui!==undefined){Ay.pos=Ax.ui+2;}return Ay;}};this.controller.openDAE(this,Au,mstrmojo.emptyFn,null);},newDynamicLinkAttr:function AN(Az){var Au=this.model.docModel,Ay=this,Aw={forceRefresh:true,alias:"New Link",datasets:Au.datasets,precreate:function Ax(A0){A0=X.copy({act:"addDAToTemplate",nodeKey:Ay.k,treeType:Ay.defn.tt,axis:Az.axis},A0);if(Az.ui!==undefined){A0.pos=Az.ui+2;}return A0;}};var Av=function Av(A0){return A0.did===Az.id;};var At=Au.getDatasetUnits(["att"],Av)[0]||null;this.controller.openDynamicLinkEditor(this,Aw,mstrmojo.emptyFn,At);},getDerivedAttribute:function AR(Aw){var Au=this.model.docModel,At=Au.datasets,Av=null;X.forEach(At,function(Az,Ay){var Ax=Ao.find(Az.att,"did",Aw);if(Ax>=0&&Az.att[Ax].da){Av=Az.att[Ax];Av.dsid=Ay;return false;}});return Av;},isStatusBarPositioned:true,doSelection:function U(Av,At,Aw){var Au=mstrmojo._HasMarkup.newDomEvent("click",At,Av);Au.getTarget=function(){return Aw;};this.onclick(Au);},selectSiblings:function AY(At){return !(!(this.selectorControl||A.call(this))||this.isSelectAllCell(At));},onNDECreated:function(){this.clearSelections();this.clearSelectionsCache();},getOnSubtotalsChangeFn:function(At,Au,Av){return function(){var Ay=At.contents.getSubtotalTypes(),Ax=this.model,Az=Ay[0],Aw=Ay[1],A0=[];if(Ax.data.gsi.hidesb){if(Au.ast){Aw=Au.ast.map(function(A1){return A1.t;});Aw=Ao.filter(Aw,function(A1){return Ao.indexOf(Az,A1)===-1;});}A0.push(Ax.getShowDefinedSubtotalsAction());}A0.push(Ax.getShowTotalsUnitAction(Au.id,Au.otp,Az,Aw));this.controller.submitUndoRedoTemplateUpdates(this,A0,Av);}.bind(this);},onPageRendered:function Af(Av,At,Au,Aw){if(this._super){this._super(Av,At,Au,Aw);}this.updateScrollbars();}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.Container","mstrmojo.vi._MonitorsAppState","mstrmojo.models.FormatModel","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.vi.ui._HasBoxLayout","mstrmojo.vi.ui.BoxPanelContainer","mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.VisualizationEditor","mstrmojo.vi.ui.VIBoxPropertyEditor","mstrmojo.DocDataService","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.array","mstrmojo.func","mstrmojo.hash");mstrmojo.requiresClsP("mstrmojo.vi.models","VIComponentMap","EnumPanelTypes");mstrmojo.requiresClsP("mstrmojo.vi.ui","_HasBoxLayout","BoxPanelContainer","BoxPanel","VisualizationEditor","VIBoxPropertyEditor");var m=8,d=mstrmojo,U=d.vi.models,e=d.array,v=d.func,W=d.boxmodel,P=d.dom,Q=d.hash,n=d.models.FormatModel,r=n.getFormatUpdate,g=n.ENUM_PROPERTY_NAMES,I="layout",S="c",c=U.VIComponentMap.TYPES,L=d.vi.ui.BoxPanel.PANEL_TYPES,AA=L.DROP_ZONES,t=L.PROPS,O=L.FILTERS,K=d.DocDataService.SUPPRESS_DATA,Y=d.EnumRWUnitType,l=U.EnumPanelTypes,H;var p={};p[AA]={n:mstrmojo.desc(11312,"Editor"),cls:"edt",id:AA};p[t]={n:mstrmojo.desc(7558,"Properties"),cls:"prp",id:t};p[O]={n:mstrmojo.desc(6189,"Filter"),cls:"flt",id:O};function x(AE){if(AE==="filterPanel"){return O;}return AE==="editPanel"?AA:t;}function h(AE){return AE.src.data.tabInfo;}function T(AE){if(AE.t===S){AE.k=mstrmojo.all[AE.id].getIdentifier();}else{e.forEach(AE.children,function(AF){T(AF);});}return AE;}function AB(AF,AE,AG){return AE.getLayoutVIMap(AF.getCurrentLayoutKey()).getComponent(AG);}function M(AF,AE){return AB(AF,AE,c.FILTER_STACK);}function X(AI,AG,AE){var AJ=AI.id,AH={model:AG,viPanelType:AJ,layoutKey:AG.currlaykey};switch(AJ){case AA:return new mstrmojo.vi.ui.VisualizationEditor(AH);case t:if(!mstrApp.allowWebDashboardDesign()){return null;}return new mstrmojo.vi.ui.VIBoxPropertyEditor(AH);default:var AF=M(AG,AE);if(AF){AF.viPanelType=AJ;return AF;}return null;}}function z(AJ,AG,AF,AK){if(AJ.t===S){var AH=AJ.k;if(AH===I){AJ.id=AK.id;}else{var AI=new mstrmojo.vi.ui.BoxPanelContainer({model:AG});AJ.id=AI.id;AH.split("|").forEach(function(AQ,AL){var AO=AQ.length-1,AN=AQ.charAt(AO)==="*";if(AN){AQ=AQ.substr(0,AO);}var AM=p[AQ],AP=X(AM,AG,AF);if(AP){AP.setOpenStatus(true,true,null);AI.addPanel(AM,AP,AL,AN);}});return[AI];}}else{var AE=[];e.forEach(AJ.children,function(AL){AE=AE.concat(z(AL,AG,AF,AK));});return AE;}return[];}function D(){return e.filter(this.children,function(AE){return AE instanceof mstrmojo.vi.ui.BoxPanelContainer;});}function f(AE){var AF=this.boxLayoutConfig;AF.useDefaultBox([{},this.docLayout],["185",100]);var AG=AF.box.children;AG[0].k=AE.map(function(AI,AH){return AI+(!AH?"*":"");}).join("|");AG[1].k=I;if(!AG[0].k){AG.shift();}}function J(AI){var AH=this.model,AG=this.builder,AJ=JSON.stringify(AI);if(AI&&AJ.match('"k":"(1|2|3)')){AI=null;}AI=AI&&JSON.parse(AJ.replace(/vi_edt/g,AA));var AK=this.boxLayoutConfig=new mstrmojo.vi.ui.BoxLayoutConfig({hostId:this.id,identifier:"id",box:AI});if(!AI){var AE=[],AL=AH.getVIPanelKeyFromUnits(mstrmojo.vi.models.EnumPanelTypes.VISUALIZATION),AF=AH.getUnitDefinitions(AL);AF=AF&&AF[AL];if(!(AF&&!AF.dzv)){AE.push(AA);}if(M(AH,AG)){AE.push(O);}if(AE.length>0){AE.push(t);}f.call(this,AE);AK.box.go=true;}D.call(this).forEach(function(AM){this.removeChildren(AM);AM.unrender();},this);this.addChildren(z(AK.box,AH,AG,this.docLayout));}mstrmojo.vi.ui.rw.DocLayoutViewer=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi.ui._HasBoxLayout,mstrmojo.vi._MonitorsAppState,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocLayoutViewer",markupString:'<div id="{@id}" class="mstrmojo-VIDocLayoutViewer {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},docLayout:null,editorPanel:null,model:null,builder:null,init:function w(AE){this._super(AE);if(mstrApp.appState===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION){this.isBoxLayoutDirty=true;}this.model.attachEventListener("updateRootDefn",this.id,function(){if(!this.parent){this.isBoxLayoutDirty=true;}});},updateRootBoxLayout:function N(){J.call(this,this.model.getRootNode().defn.layoutXML);},onAppStateChange:function k(AE){if(this.model.getCurrentLayoutKey()===this.k){H=!!this.getViPanel("filterPanel");this.changePanelsVisibility();}this._super(AE);},shouldSaveSplitterMoves:function E(){return false;},getSplitterHost:function B(){return this.containerNode;},preBuildRendering:function A(){var AH=this.parent;if(AH){var AG=AH[this.slot].style,AF=this.height,AE=this.width;this.height=parseInt((AF&&AF!=="auto")?AF:AG.height,10)-m+"px";this.width=parseInt((AE&&AE!=="auto")?AE:AG.width,10)-m+"px";}this.bs=this.model.bs;return this._super();},onRender:function C(){this._super();this.updateRootBoxLayout();this.buildBoxLayout();delete this.isBoxLayoutDirty;},destroy:function q(){this._super();this.controller.view.raiseEvent({name:"destroyLayout",key:this.k});},getLayoutOffsets:function G(){return{h:m,w:m};},beginBoxMove:function V(AG,AE,AH){var AF=h(AG);this._super(AG,AE,!!(AF&&!AF.isSingleTab)||AH);},endBoxMove:function a(AF,AE){this._super(AF,AE);if(!h(AF)){this.getSplitterHost().appendChild(AE.domNode);}},getBoxLayoutSaveAction:function R(AG){var AF=this.model,AE={};r(g.USE_PAGE_WIDTH_AS_LAYOUT_WIDTH,true,AE);r(g.MARGIN_LEFT,0,AE);r(g.MARGIN_RIGHT,0,AE);var AH=[AF.getUnitFormatAction(AF.getRootNode(),1,r(g.LAYOUT_XML,T(AG)))];AF.defn.layouts.forEach(function(AI){AH.push(AF.getUnitFormatAction({k:AI.k,defn:AI},1,JSON.parse(JSON.stringify(AE))));});return AH;},getChildPositionActions:function F(){var AP=this._super(),AS=this.builder,AI=this.model,AQ=M(AI,AS),AH=AB(AI,AS,c.MAIN_CONTENT),AM=AB(AI,AS,c.PAGEBY_STACK),AK=AB(AI,AS,c.VIZ_CONTENT),AR=P.position(AQ&&AQ.domNode),AJ=P.position(AH.domNode),AU=P.position(AM&&AM.domNode),AG=P.position(AK.domNode),AY=5,AT=Math.abs(AR.x-AJ.x)>AY,AW=AT?"x":"y",AF=AR[AW]<AJ[AW],AN=(AQ&&AQ.getFilters().length>0),AX=P.position(mstrApp.rootCtrl.view.domNode).w,AE=2,AL=19;AR.x=AR.y=0;AJ.x=AJ.y=0;AU.x=AU.y=0;AG.x=AG.y=0;if(AQ){AR.w=AR.w||parseInt(AQ.width,10);AR.h=AR.h||parseInt(AQ.height,10);}if(AF&&AN){AJ[AW]=AR[AW==="x"?"w":"h"];}else{if(!AF){AR[AW]=AJ[AW==="x"?"w":"h"];}}if(AM&&AM.visible){AG.y+=AU.h;var AZ=AM.unit;if(AZ){var AV=AZ.ckey;AP.push(AI.getDimensionAndPositionAction({k:AV,defn:AI.getCurrentLayoutDef().units[AV]},AU));}}if(AN){if(AT){AJ.w=AG.w=AX-AR.w;}}else{AJ.w=AG.w=AX;}AG.w-=AE;AG.h-=AE;var AO=[undefined,AR,AJ,AU,AG];AI.defn.layouts.forEach(function(Aa){AP.push(AI.getUnitFormatAction({k:Aa.k,defn:Aa},1,r(g.PAGE_WIDTH,W.px2Inches(AI.getZoomProps(),AX))));Object.keys(l).forEach(function(Ac){var Ab=AI.getVIPanelKeyFromUnits(l[Ac],Aa.k);AP.push(AI.getDimensionAndPositionAction({k:Ab,defn:Aa.units[Ab]},AO[l[Ac]]));});});AI.defn.layouts.forEach(function(Aa){Object.keys(Aa.units).forEach(function(Ag){var Af=Aa.units,Ai=Af[Ag],Ak=(Ai&&Ai.t)||Y.LAYOUT,Ah=Ai.layoutXML;if(Ai&&Ai._isDeleted){return ;}if(Ak===Y.SUBSECTION){var Ae=Q.copy(AJ);Ae.h+=2;AP.push(AI.getDimensionAction({k:Ag,defn:Ai},Ae));}else{if(Ak===Y.GRID||Ak===Y.GRAPH||Ak===Y.GRIDGRAPH){var Ab=Ai&&Ai.vis;if(Ab){if(Ab.we&&Ab.wcn){var Aj=this.builder.visList.findVisName(Ab.wcn);if(Aj){AP.push(AI.getUnitChangeVizAction(Aj,Ab.wcn,{k:Ag,defn:Ai}));}}}}}if(Ah!==undefined){var Ac=new mstrmojo.vi.ui.BoxLayoutConfig({box:Ah,padding:0,getBoxChildClass:function(Am){var Al=mstrmojo.vi.ui.BoxLayoutConfig.prototype.getBoxChildClass(Am);if(Al){return Al;}return AS.getPortletClass(Af[Am.k]);}}),Ad=this.calculateBoxLayout(Ac,{height:AG.h-AE-AL,width:AG.w-AE,top:AG.y,left:AG.x}).box;Object.keys(Ad).forEach(function(Am){var Al=Ad[Am].dim;AP.push(AI.getDimensionAndPositionAction({k:Am,defn:Af[Am]},{h:(parseInt(Al.height,10)-AE)+"px",w:(parseInt(Al.width,10)-AE)+"px",x:Al.left,y:Al.top}));});}},this);},this);return AP;},getViPanel:function AC(AG){var AE=this.docLayout.getViPanel(AG);if(!AE){var AF=x(AG);D.call(this).every(function(AH){AE=AH.getPanelByType(AF);return !AE;});}return AE;},openViPanel:function u(AM,AN,AJ,AE){var AG=x(AM),AI=D.call(this)[0],AK=this.model,AL=this.builder,AF=this.id,AH=function(){var AR=mstrmojo.all[AF],AS=AK.getDataService().newUpdateWithoutCmd();if(AI){var AP=p[AG],AO=X(AP,AK,AL);AI.addPanel(AP,AO,NaN,true);if(AO){AO.setOpenStatus(true,false,AS);}}else{f.call(AR,[AG]);var AQ=z(AR.boxLayoutConfig.box,AK,AL,AR.docLayout);AR.addChildren(AQ);AQ.forEach(function(AU){var AT=AU&&AU[AG];if(AT){AT.setOpenStatus(true,false,AS);}});if(!AE){AR.buildBoxLayout();}}if(!AJ){AR.saveBoxLayout(undefined,undefined,AN,AS);AS.addExtras(K);AS.submit();}mstrApp.rootCtrl.generateToolbar();};if(AG!==O||M(AK,AL)){AH();}else{AK.loadHiddenFilterStack(AL,function(){AH();});}},changePanelsVisibility:function Z(){var AI=this.controller,AE=AI._oldBoxLayout,AH=["propertiesPanel","editPanel"],AG,AF=function(AK){AK.forEach(function(AM){var AL=this.getViPanel(AM);if(AL){AL.setOpenStatus(false,true,undefined,true);}},this);};if(mstrApp.isAppStatePresentation()){AI._oldBoxLayout=Q.clone(this.getBoxLayoutConfig().box);AF.call(this,AH);if(H){AI._oldBoxLayoutWithFilter=Q.clone(this.getBoxLayoutConfig().box);}AG=this.getViPanel("filterPanel");var AJ=AG&&AG.contents;if(AJ&&AJ.empty){AG.setOpenStatus(false,true,undefined,true);}this.model.updateRootDefn({root:{layoutXML:this.getBoxLayoutConfig().box}});}else{if(mstrApp.isAppStatePrintPreview()){AI._oldBoxLayout=Q.clone(this.getBoxLayoutConfig().box);AF.call(this,["propertiesPanel","editPanel","filterPanel"]);this.model.updateRootDefn({root:{layoutXML:this.getBoxLayoutConfig().box}});}else{if(AE){this.model.updateRootDefn({root:{layoutXML:AE}});this.updateRootBoxLayout();delete AI._oldBoxLayout;delete AI._oldBoxLayoutWithFilter;}}}},syncFilterPanelStack:function o(){var AG=this.model.getVIComponent(mstrmojo.vi.models.VIComponentMap.TYPES.FILTER_STACK),AF=this.getViPanel("filterPanel"),AE=AG&&AG.isEmpty();if(H){if(AE&&!AF){J.call(this,this.controller._oldBoxLayoutWithFilter);this.buildBoxLayout();}if(!AE&&AF){AF.setOpenStatus(false,true,undefined);}}},getBoxLayoutConfig:function AD(){var AE=this.boxLayoutConfig;if(AE){T(AE.box);}return AE;},saveBoxLayout:function b(AI,AG,AK,AJ,AE){var AF=this.model,AH=this.getBoxLayoutConfig();if(AH){AK=AK||{};v.wrapMethods({success:function(){AF.updateRootDefn({root:{layoutXML:AH.box}});}},AK);}this._super(AI,AG,AK,AJ,undefined,AE);}});mstrmojo.vi.ui.rw.DocLayoutViewer.getViPanelType=function(AE){return x(AE);};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.vi.ui.DatasetObjects","mstrmojo.vi.ui.DocDatasetUnitList","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.util.ui._HostsSplitter","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.ui.toolbars._HasToolbar","mstrmojo.ui.menus.MenuConfig","mstrmojo.ui.menus.ToolbarConfig","mstrmojo.IVEDatasetPicker","mstrmojo.vi.ui.PanelContents","mstrmojo.vi.ui.PanelPortlet","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.SelectDatasetWizardEditor","mstrmojo.vi.ui.ReplaceObjectEditor","mstrmojo.ui.ScrollableContainer","mstrmojo.fe.FilterEditor","mstrmojo.fe.FilterUtils","mstrmojo.array","mstrmojo.hash","mstrmojo.form","mstrmojo.func","mstrmojo.dom","mstrmojo.Button","mstrmojo.mstr.EnumFunction","mstrmojo.SaveAsEditor","mstrmojo.vi.ui.ViewDataDialog","mstrmojo.vi.ui.DatasetEditor","mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy","mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy","mstrmojo.vi.ui.AllObjectsBrowser","mstrmojo.vi.enums.EnumDSSAccessRightFlags");var W=mstrmojo.hash,E=mstrmojo.css,k=mstrmojo.array,AI=mstrmojo.func,U=mstrmojo.dom,N=mstrmojo.vi.ui.DatasetUnitMenuUtils,P={IN_MEMORY:1,DIRECT_ACCESS:2},f={SupportDDAOrInMemory:1,SupportInMemoryOnly:2,SupportDDAOnly:3},AA={style:{params:{treesToRender:1}}},u=mstrmojo.warn,l=mstrmojo.vi.enums.EnumDSSAccessRightFlags,AC=30,X=30;function C(){return mstrApp.isSingleTier?new mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy():new mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy();}function d(AR){this.model.cmdMgr().execute({execute:function(){AR(this);}});}function F(AR){return mstrApp.rootCtrl.resolveFeature(AR);}function n(){return !F("single-workingset");}function Z(AR){return(!AR.hcs||AR.idd)&&!(AR.tables&&AR.tables[0]&&AR.tables[0].xdaType===400);}function AK(AR){var AU=AR.id||"mstrIVE_DS",AS=mstrmojo.all[AU];if(!AS){AS=new mstrmojo.IVEDatasetPicker({id:AU,onOk:mstrmojo.emptyFn,onCancel:mstrmojo.emptyFn,onPreClose:function(){this.onCancel();return true;},onRender:function AT(){var AW=false;this.btnImport.set("visible",AW);this.newLabel.set("visible",AW);this.useExistingLabel.set("visible",AW);this.ob.set("scrollableIncFetch",true);this.btnHBox.destroyChildren();var AV=mstrmojo.Button.newWebButton(mstrmojo.desc(547,"Select"),function(){if(this.enabled){AS.onOk();AS.close();}},true);AV.bindings={enabled:function(){return this.parent.parent.multiSelect?!!this.parent.parent.selectedItems.length:!!this.parent.parent.item;}};this.btnHBox.addChildren([AV,mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function(){AS.onCancel();AS.close();},false)]);}});if(AR.title){AS.set("title",AR.title);}}W.forEach(AR,function(AW,AV){AS.set(AV,AW);});return AS;}function AP(AT,AS){var AR=this;return function(){mstrApp.rootCtrl.docCtrl.openDME(AR,{metricId:"",editorId:"mstrME",action:{cmd:"editNew"}},AS.getDataService().getAddNewDerivedMetricToDatasetSubmitFunc({dsid:AT}));};}function x(AT,AS){var AR=this;return function(){mstrApp.rootCtrl.docCtrl.openDAE(AR,{dsid:AT,datasets:AS},mstrmojo.emptyFn);};}function t(AS,AU){var AT=new mstrmojo.ui.menus.MenuConfig(),AR=[{n:mstrmojo.desc(14476,"Primary (outer join)"),v:1},{n:mstrmojo.desc(14477,"Secondary (inner join)"),v:0}];AR.forEach(function(AV){AT.addMenuItem(AV.n,AV.v===AU.ipm?"on":"",function(){var AW=AS.controller,AX=AW.getRefreshCallback();AW.cmdMgr.execute({execute:function(){this.submit([{act:"setJoinBehavior",dsid:AU.did,dst:AU.type,prm:AV.v}],AX,{style:{params:{treesToRender:3}}});},urInfo:{callback:AX}});});});return AT;}function K(AR,AS,AW,AV){var AU={taskId:"mojoGetDocumentManifest"},AT=function(AY){var AZ=[],AX=1;W.forEach(AR.data,function(Aa){AY.forEach(function(Ab){if(AX===parseInt(Ab,10)){AZ.push(Aa);}});AX++;});return AZ;};if(AV){AU.dsid=AV;}AS.getDataService().submitUpdates({},{success:function(AZ){var AX=[],Aa={},AY={};W.forEach(AR.data,function(Ab){Ab.att.concat(Ab.mx).forEach(function(Ac){Aa[Ac.did]=Ac;});});AZ.manifest_objects.forEach(function(Ab){if(Aa[Ab.did]){Ab.cubes=AT(Ab.cube_ids||[]);AX.push(W.copy(Aa[Ab.did],Ab));AY[Ab.did]=Ab;}});AZ.manifest_objects.forEach(function(Ab){if(Ab.dependents){Ab.dependentObjects=[];Ab.dependents.forEach(function(Ac){Ab.dependentObjects.push(AY[Ac]);});}});AX=N.getSortedDatasetUnits(AX);AW(AX);},failure:function(){AS.cmdMgr().onFailure();}},{params:AU,preserveUndo:true});}function Y(AR,AT,AU){var AS=AR.datasets[AT];if(AS){AU(AS);}else{AR.getDataService().submitUpdates({},{success:function(AV){AU(AV);},failure:function(){AR.cmdMgr().onFailure();}},{params:{taskId:"mojoGetReportWorkingSet",reportId:AT,chkViewReport:1},preserveUndo:true});}}function o(AS){var AR=W.clone(AS.att.concat(AS.mx));AR.forEach(function(AT){if(AT.hc){AT.cont_did=AS.did;AT.cont_tp=AS.type;}});return k.filter(AR,function(AT){return !AT.um;});}function T(AT,AU,AS,AV,AR,AW){return function AX(Aa,Ab){var Ae=[{act:"applyReconciliation",clr_af:Ab,members:Aa,disablePU:true}].concat(AR);if(!!AV.isOneTierCubeImport){Ae[0].sourceId=(AS?"all":AV.source.did);}if(AS){W.forEach(AT.data,function(Ag,Af){Aa.unshift({srcid:Af,srct:3,tgtid:AV.target.did,tgtt:3});});}else{Aa.unshift({srcid:AV.source.did,srct:3,tgtid:AV.target.did,tgtt:3});}var Ad=AU.cmdMgr(),Ac=Ad.getInterimCmd(),AZ=AU.controller.getRefreshCallback(),AY=AI.wrapMethods(AZ,(AW||mstrmojo.emptyFn));if(Ac){Ac.urInfo.callback=AZ;Ac.submit(Ae,AY,mstrmojo.DocDataService.REQUEST_DEFN_DATA,Ad.CMD_PHASE.LAST);}else{Ad.execute({execute:function(){this.submit(Ae,AY,mstrmojo.DocDataService.REQUEST_DEFN_DATA);},urInfo:{callback:AZ}});}};}function AM(AU,AY){var Ab=AU.model,Ac="mstrReconReplaceEditor",AX=null,AZ=function AZ(){var Ae=Ab.cmdMgr().getInterimCmd();if(Ae){var Ad=Ae.urInfo;Ad.callback={success:mstrmojo.emptyFn};Ad.treesToRender=0;Ae.cancel();}},AR=function(Ad){if(!AX){AX=mstrmojo.all[Ac]||mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.ReplaceObjectEditor",id:Ac});}AX.set("showUnitTooltip",AY);AX.setUnits({source:Ad.source,target:Ad.target});B(W.keyarray(Ab.datasets).filter(function(Ae){return Ae===Ad.target.did;}).map(function(Ae){return{dsid:Ae,collapsed:false};}),AU);AX.onOk=T(AU,Ab,AY,Ad,AU.settings.getSaveActions(),{success:function(){AU.set("allObjectBrowserOpened",false);},failure:function(){AX.open();}});AX.onCancel=AZ;AX.set("onBack",Ad.onBack||mstrmojo.emptyFn);AX.open();},AT=function(Ae){AU.showDataImport({isEdit:false,AnalysisId:Ab.mid,callback:function Ad(Af){if(Af){var Ag=Af[0];if(Ag.mngd){if(!mstrApp.isSingleTier){Ab.cmdMgr().getInterimCmd().resetCmdMgrOnComplete();}Ae(Ag);}else{Y(Ab,Ag.did,Ae);}}else{AZ();}}});},AW=function(Ad){AU.openDatasetEditor({modifiedItems:{create:{act:"createDataset",mgo:true,prm:true,noRowCount:1,newObjectIds:["$GUID_141"]},add:[],del:[],fs:{add:[],del:[]},filter:null},title:mstrmojo.desc(13362,"Report Editor")+" - "+mstrmojo.desc(11636,"New Dataset"),docModel:Ab,okBtnText:mstrmojo.desc(4447,"Add"),onOk:function(Ae){Ab.cmdMgr().getInterimCmd().submitInterim(Ae,{success:function(Af){W.forEach(Af.datasets,function(Ag,Ah){if(!Ab.datasets[Ah]){Af.datasets[Ah].did=Ah;Ad(Af.datasets[Ah]);}});}});},onCancel:AZ});},AV=function(Ae){var Ad=AK({id:"mstrReconDatasetPicker",title:mstrmojo.desc(11940,"Select Existing Dataset"),onOk:function(){Y(Ab,Ad.item.did,Ae);},onCancel:AZ});Ad.open();},AS=function(Ad){Ab.controller.openCubeBrowser({success:function(Ae){Y(Ab,Ae.did,Ad);},failure:function(){AZ();}});},Aa=function(Af){var Ad=Af.sourceDatasetId,Ag=!!Af.isOneTierCubeImport,Ae=Af.openDialog;K(AU,Ab,function(Ah){function Ai(){d.call(AU,function(){Ae(function(Ak){var Aj=o(Ak);AR({isOneTierCubeImport:Ag,source:{did:Ad,all:!!AY,units:Ah},target:{did:Ak.did,units:Aj},onBack:AI.composite([AZ||mstrmojo.emptyFn,Ai])});});});}Ai();},AY?null:Ad);};return function(){var Ad=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,menuCssClass:"reconsoliationMenu"}),Ah=this.did,Ag=AY?null:Ah,Ae=Object.keys(AU.data).length;if(n()){var Af=mstrApp.isSingleTier;if(Ab.allowImportData()){Ad.addMenuItem((Af)?mstrmojo.desc(14303,"New Data..."):mstrmojo.desc(13569,"External Data..."),"",function(){Aa({sourceDatasetId:Ah,openDialog:AT});});}if(!Af&&!AU.hasUnsubmitDataset&&Ab.allowNewOrEditRolapDS()&&Ab.isSchemaDefined()){Ad.addMenuItem(mstrmojo.desc(13572,"New Report..."),"",function(){Aa({sourceDatasetId:Ah,openDialog:AW});});}Ad.addMenuItem((Af)?mstrmojo.desc(14304,"Dataset from Server..."):mstrmojo.desc(13573,"Existing Dataset..."),"",function(){Aa({sourceDatasetId:Ah,isOneTierCubeImport:Af,openDialog:Af?AS:AV});});}if(Ae>1){Ad.addSeparator();W.forEach(AU.data,function(Aj,Ai){if(Ai===Ah){return true;}Ad.addMenuItem(Aj.name,"",function(){d.call(AU,function(){K(AU,Ab,function(Ak){Y(Ab,Ai,function(Al){AR({source:{did:Ah,all:!!AY,units:Ak},target:{did:Ai,units:o(Al)}});});},Ag);});});});}return Ad;};}function AD(){var AS=this,AR=AS.model,AT=[];W.forEach(AR.datasets,function(AU){if(AU.st===779&&AR.hasPrivilegesForAllTables(AU.tables)){AT.push(AU);}});return function(){AS.showDataImport({isEdit:false,datasets:AT,AnalysisId:AS.model.mid,needDefn:true});};}function V(){var AS=this,AR=AS.model,AT=[];W.forEach(AR.datasets,function(AU){if(AU.st===779&&AR.hasPrivilegesForAllTables(AU.tables)){AT.push({cube_id:AU.did,cname:AU.name,ddam:AU.dsm,mdt:"2014-12-10 20:57:25",sz:421,st:AU.st});}else{if(AU.st===776){AT.push({cube_id:AU.did,cname:AU.name,ddam:AU.dsm,mdt:"2014-12-10 20:57:25",sz:421,st:AU.st});}}});return function(){AS.showDataImport({isEdit:false,datasets:{cubes:{cube:AT}},AnalysisId:AS.model.mid,StatusCode:2,refreshMultipleCubes:true,rwb:AR.getDataService().rwb});};}function AJ(AR){return function(){var AS=new mstrmojo.ui.menus.MenuConfig(),AU=this;var AT=mstrApp.isSingleTier;if(n()&&AU.model.allowImportData()){AS.addMenuItem((AT)?mstrmojo.desc(14303,"New Data..."):mstrmojo.desc(13569,"External Data..."),"",AD.call(AU));}if(!AT&&!AR.hasUnsubmitDataset&&AU.model.allowNewOrEditRolapDS()&&AU.model.isSchemaDefined()){AS.addMenuItem(mstrmojo.desc(13572,"New Report..."),"",function(){AR.openDatasetEditor({title:mstrmojo.desc(13362,"Report Editor")+" - "+mstrmojo.desc(11636,"New Dataset"),okBtnText:mstrmojo.desc(4447,"Add"),docModel:AU.model});});}if(!AT){AS.addMenuItem(mstrmojo.desc(13573,"Existing Dataset..."),"",AR.getShowDatasetPicker());}return AS;};}function AO(AR){var AT=AR&&AR.datasets,AS=(AR.datasetsSettings&&AR.datasetsSettings.units)||{},AV=function(AX){return AX.hide&&!(AS[AX.n]&&AS[AX.n].completeHide);},AW,AU;for(AU in AT){AW=AT[AU];if(k.filterOne(AW&&AW.att,AV)||k.filterOne(AW&&AW.mx,AV)){return true;}}return false;}function G(AS){var AU=AS&&AS.datasets,AW=[],AR=function(Ac,AZ){var AY=(AS.datasetsSettings&&AS.datasetsSettings.units)||{},Ad=k.filter(Ac.att,function(Ae){return Ae.hide&&!(AY[Ae.n]&&AY[Ae.n].completeHide);}),Ab=k.filter(Ac.mx,function(Ae){return Ae.hide&&!(AY[Ae.n]&&AY[Ae.n].completeHide);}),AX=Ad.concat(Ab);if(AX.length===0){return ;}var Aa=new mstrmojo.ui.CheckList({cssClass:"units",items:AX.map(function(Ae){Ae.tt=Ae.n;Ae.css=N.getUnitCssClass(Ae);return Ae;})});AW.push({scriptClass:"mstrmojo.vi.ui.PanelPortlet",title:Ac.name,dsid:AZ,children:[Aa],getSelectedItems:function(){return Aa.getSelectedItems()||[];},markupMethods:AI.override({onisCollapsedChange:function(){this._super();this.parent.updateScrollbars();}},W.copy(mstrmojo.vi.ui.PanelPortlet.prototype.markupMethods))});},AV;for(AV in AU){AR(AU[AV],AV);}return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mstrmojo-ShowHiddenEditor",contents:{scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"scrollableContainer",children:AW},onOpen:function AT(){this.scrollableContainer.updateScrollbars();},fnOk:function(){var AX=[];AW.forEach(function(AZ){var Aa=AZ.getSelectedItems();Aa.forEach(function(Ab){AX.push(AS.getToggleHiddenObjectAction(AZ.dsid,Ab,false));});});var AY=AS.getDatasetsUpdateCallback();AS.controller.cmdMgr.execute({execute:function(){this.submit(AX,AY,AA);},urInfo:{callback:AY}});}});}function B(AS,AR){k.forEach(AS,function(AU){var AV=AU.dsid,AT=AR.settings.dataset(AV);AT.isCollapsed=!!AU.isCollapsed;});}function J(AS,AR){B(AS,AR);AR.saveSettings();}function AN(AS,AR){return function(){var AU=AS.model,AT=AU&&AU.controller,AV=[{act:"removeDataset",did:AR,disablePU:true}],AW=AT.getRefreshCallback();if(AS.getDatasetCount()===2){B(W.keyarray(AU.datasets).filter(function(AX){return AX!==AR;}).map(function(AX){return{dsid:AX,collapsed:false};}),AS);AV=AV.concat(AS.settings.getSaveActions());}AT.cmdMgr.execute({execute:function(){this.submit(AV,AW,{style:{params:{treesToRender:3}}});},urInfo:{callback:AW}});};}function AB(AS,Ab,AT,AR,AY){var AZ=C(),AX=mstrmojo.onetier.vi.prefs.handleErrorMessage,AU=AT.dsm===AY,Ac,AV=function Aa(Ae,Ag){AZ.getPollingStatus({id:Ae.id},{success:function Af(Ah){switch(Ah.status){case 1:case 2:mstrApp.getRootController().showOrHideProgressBar(mstrmojo.desc(13568,"Download from server"),false);if(Ah.status===2){if(Ag.failure){Ag.failure(Ah.data);}}else{AZ.refreshNativeDialogMenu();Ag.success(Ah.data);}break;case 4:mstrApp.getRootController().showOrHideProgressBar(mstrmojo.desc(13568,"Download from server"),false);return ;default:mstrApp.getRootController().updateProgressBar({pct:Ah.pct,msg:Ah.msg,requestID:Ae.id,canCancel:Ah.status===0});AV(Ah,Ag);}},failure:function Ad(){mstrApp.getRootController().showOrHideProgressBar("Download from server",false);}});},AW=function(){AZ.loadCube({objectID:AR,addDatasetToDocument:false,dda:AY===P.DIRECT_ACCESS},{success:function(Ad){mstrApp.getRootController().showOrHideProgressBar("Download from server",true);AV({id:Ad.id},{success:function(){K(AS,Ab,function(Ae){Y(Ab,AT.did,function(Ai){var Ag=o(Ai),Af=[],Ah;Ag.forEach(function(Aj){if(mstrmojo.array.find(Ae,"did",Aj.did)!==-1){Ah={tgtid:Aj.did,tgtt:Aj.t,srcid:Aj.did,srct:Aj.t};if(Aj.cont_did&&Aj.cont_tp){Ah.cont_did=Aj.cont_did;Ah.cont_tp=Aj.cont_tp;}Af.push(Ah);}});T(AS,Ab,false,{isOneTierCubeImport:true,source:{did:AR,units:Ae},target:{did:Ai.did,units:Ag},onBack:mstrmojo.emptyFn})(Af,false);});},AR);}});}});};AZ.getCubeInfo({cubeIds:AR},{success:function(Af){if(AY===P.IN_MEMORY){if(Af.hsf){mstrmojo.alert(mstrmojo.desc(14171,"You can not download the data because a security filter has been defined for you in this project."));}else{if(Af.acld){mstrmojo.alert(mstrmojo.desc(14172,"You can not download the data because you do not have access to all the objects in the selected Intelligent cube."));}else{if(Af.dda){Ac=AU?mstrmojo.desc(14079,"Data Access Mode for the corresponding Intelligent Cube on the MicroStrategy Server has changed from In-Memory to Connect Live. Due to this change, you will not be able to continue in In-Memory mode. Do you want to switch to Live Connection?"):mstrmojo.desc(14080,"Data Access Mode for the corresponding Intelligent Cube on the MicroStrategy Server has changed from In-Memory to Connect Live. Due to this change, you will not be able to switch to In-Memory mode.");mstrmojo.confirm(Ac,{confirmBtn:{fn:function(){AY=P.DIRECT_ACCESS;AW();}}});}else{var Ae=function(Ai){return"{"+(Ai>=1048576?(Ai/1048576).toFixed(2)+"GB":(Math.round((Ai||0)*100/1024)/100).toFixed(2)+"MB")+"}";},Ah=Af.maxcs*1024,Ad=Af.cs,Ag=Ad>Ah;if(Ag){mstrmojo.alert(mstrmojo.desc(14081,"The size of the Intelligent Cube #  is more than the download limit ## set by the administrator. Therefore, you can only Connect Live to the selected Intelligent Cube.").replace("##",Ae(Ah)).replace("#",Ae(Ad)));}else{AW();}}}}}else{AW();}},failure:function(Ad){AX(Ad);}});}function a(AT,AV,AR,AU,AW){if(mstrApp.isSingleTier&&AT.hcs){var AS=AT.dsm===P.DIRECT_ACCESS?"You are using Live connection to an Intelligent Cube residing on a MicroStrategy Server. In order to continue, you need to first convert the cube to a local cube. Do you want to continue?":"You are using an Intelligent Cube from a MicroStrategy Server. In order to continue, you need to first convert the cube to a local cube. Do you want to continue?";mstrmojo.confirm(AS,{confirmBtn:{fn:function(){AR.getDataService().submitUpdates({act:"disconnectDataset",dsid:AV,dsm:P.IN_MEMORY,ignoreExecution:AU},AI.wrapMethods(AW,{failure:mstrApp.onerror}),{style:{params:{treesToRender:0}}});}}});}}function p(AR,AU,AW,AS){function AT(AZ){var AX=AR.model,AY=function(){if(AZ===AU.dsm){return ;}if(AU.hcs){AB(AR,AX,AU,AW,AZ);}else{function Aa(){AS.controller.cmdMgr.execute({execute:function(){this.submit({act:"toggleDatasetServeMode",dsid:AW,dsm:AZ},AS.controller.getRefreshCallback(),{style:{params:{treesToRender:3}}});},urInfo:{callback:AS.controller.getRefreshCallback()}});}function Ab(){AX.getDataService().checkMissingCredentials({dsid:AW},{success:function(Ac){if(Ac.success){Aa();}else{mstrmojo.confirm(mstrmojo.desc(14396,"Some credentials are missing for the selected dataset. You will have to enter these credentials in order to proceed. Do you want to continue?"),{confirmBtn:{fn:function(){window.setTimeout(function(){if(AR&&AR.showDataImport){AR.showDataImport({documentModel:Ac,StatusCode:4,callback:function(){Ab();}});}},0);return true;}},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:mstrmojo.emptyFn}},{title:mstrmojo.desc(1695,"Warning")});}},failure:function(Ac){mstrmojo.alert(Ac);}});}if(mstrApp.isSingleTier){Ab();}else{Aa();}}};return function(){AS.warnForEditStandaloneDS(AU,AY);};}return function AV(){var AX=new mstrmojo.ui.menus.MenuConfig();AX.addMenuItem(mstrmojo.desc(11921,"In-Memory"),AU.dsm===P.IN_MEMORY?"on":"",AT(P.IN_MEMORY));AX.addMenuItem(mstrmojo.desc(12726,"Connect Live"),AU.dsm===P.DIRECT_ACCESS?"on":"",AT(P.DIRECT_ACCESS));return AX;};}function AL(AT,AU,AS){var AR={act:"datasetSaveAs",managed:AT.managed,nonDelta:true,dsID:AT.dsID,rptName:AT.rptName,rptDesc:AT.rptDesc,saveAsOverwrite:AT.saveAsOverwrite};if(!AT.managed){AR.folderID=AT.folderID;}AS.model.getDataService().submitUpdates([AR],AI.wrapMethods(AS.model.getDatasetsUpdateCallback(),AU),{config:{showProgress:true,hideProgress:true,progressStateText:[mstrmojo.desc(8445,"Loading")],silent:true}});}function H(AS,AT){var AU="mstrIVE_DS_SAVER";return function AR(){var AV=mstrmojo.all[AU];if(!AT){return ;}if(!AV){AV=new mstrmojo.SaveAsEditor({id:AU,folderLinksContextId:32,showCompletePath:false,saveParams:{},saveAs:function(AY){var AW=this.contPanel;this.name=AW.name.value;this.desc=AW.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var AZ=this.saveParams||{};AZ.managed=false;AZ.folderID=this.ob.currentFolder.did;AZ.rptName=this.name||"";AZ.rptDesc=this.desc||"";AZ.saveAsOverwrite=!!AY;var AX=this.saveAsCallback();AX.failure=function(Ab){var Aa=Ab.code,Ac=this.parent;if(Aa==="-2147217373"||Aa==="-2147216857"){u(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",Ac.typeDesc||"Object").replace("###",Ac.name),{confirmBtn:{fn:function(){Ac.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite")});}else{if(Aa==="-2147202302"){mstrmojo.alert(mstrmojo.desc(11642,"Cannot save report ## to overwrite report ###, because report #### is also used by the document.").replace("##",AS.data[AT].name).replace("###",Ac.name).replace("####",Ac.name),null,mstrmojo.desc(11643,"Dataset Overwrite Error"));}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+Ab.message);}}};AX.complete=AI.wrapMethods(AX.complete,function(){mstrApp.hideWait();});AX.parent=this;AL(AZ,AX,AS);mstrApp.showWait({message:mstrmojo.desc(10492,"Saving...")});AV.close();}});AV.render();}AV.saveParams.dsID=AT;AV.open();};}function R(AT,AR,AV){var AS=AV.tables.map(function(AX){var AY=AX.mxRefs[k.find(AX.mxRefs,"rm",true)],AW=AY&&AV.mx[k.find(AV.mx,"did",AY.did)];return W.copy(AX,{rowCountMetric:AW});}).filter(function(AW){return AW.rowCountMetric&&AW.rowCountMetric.hide;});if(!AS.length){return ;}var AU=new mstrmojo.ui.menus.MenuConfig();AS.forEach(function(AW){AU.addMenuItem(AW.n,"",function(){var AX=[AR.getToggleHiddenObjectAction(AV.did,AW.rowCountMetric,false)];var AY=AR.getDatasetsUpdateCallback();AR.controller.cmdMgr.execute({execute:function(){this.submit(AX,AY,AA);},urInfo:{callback:AY}});});});AT.addSubMenuItem(mstrmojo.desc(13228,"Show Row Count"),"",null,function(){return AU;});}function L(){var AR=[];k.forEach(this.contents.children,function(AS){if(AS.visible){AR.push(AS);}});return AR;}function r(AS,AR){return function(){var AT=AS.model;AT.getDataService().submitUpdates([{act:"refreshReport",dsID:AR}],AT.controller.getRefreshCallback());};}function O(AS,AT,AR){return function(){var AU=AS.model;function AV(AX){AS.showDataImport({AnalysisId:AU.mid,ReportId:AT,CubeName:AR.name,CubeDesc:AR.dsc,isManagedCube:AR.mngd,StatusCode:2,missingCredentialsData:AX});}function AW(){AU.getDataService().checkMissingCredentials({dsid:AT},{success:function(AX){if(AX.success){AV();}else{AV(AX);}},failure:function(AX){mstrmojo.alert(AX);}});}if(mstrApp.isSingleTier){AW();}else{AV();}};}function A(){var AR=this.settings;this.set("useTableView",!!(AR&&AR.useTableView));}function I(AR){var AU=this.settings,AV=(this.contents.children||[]).length===1;if(AR){if(AV){var AT=this.contents.children[0],AS=AT.tableView||AT.mdxView;return AS&&AS.setting.hasCollapsedChildNodes(false,false);}else{return(this.contents.children||[]).some(function(AX){var AW=AU.dataset(AX.did);return AW.getCollapsed()===false;});}}else{return(this.contents.children||[]).some(function(AY){var AX=AU.dataset(AY.did),AW=AY.tableView||AY.mdxView;if(AX.getCollapsed()===true){return true;}else{return AW&&AW.setting&&AW.setting.hasCollapsedChildNodes(true,true);}});}}function AQ(AR){var AT=this.browserNode.style,AS=AR?(AC+"px"):((parseInt(this.height,10)-X)+"px");AT.top=AS;}function z(AS){var AU=this.browserNode.style,AR=this.objectBrowser&&this.objectBrowser.domNode,AT=AS?((parseInt(this.height,10)-AC)+"px"):(X+"px");AU.height=AT;if(AR){AR.style.height=AT;if(AS){this.objectBrowser.height=AT;this.objectBrowser.doLayout();}AR.style.overflow=AS?"":"hidden";}}function D(){var AR=this.objectBrowser&&this.objectBrowser.domNode,AS;if(AR){AS=m.call(this)&&!this.model.hasMDXRADataset()?"":"hidden";AR.style.visibility=AS;}}function m(){return mstrApp.isSingleTier||(n()&&this.model.isSchemaDefined()&&this.model.allowNewOrEditDummyDS());}function c(AT){var AU=this,AS=function(AV){E.removeClass(AU.browserNode,["opened","toggling"]);E.addClass(AU.browserNode,AV);},AR=function(AV){E.toggleClass(AU.searchNode,"allObjOpened",AV);E.toggleClass(AU.dividerNode,"allObjOpened",AV);};if(AT){AS("toggling");AQ.call(AU,true);z.call(AU,true);setTimeout(function(){AS("opened");AR.call(AU,true);},500);}else{AS("toggling");AQ.call(AU,false);AR.call(AU,false);setTimeout(function(){E.removeClass(AU.browserNode,["opened","toggling"]);z.call(AU,false);},500);}}mstrmojo.vi.ui.DocDatasetObjects=mstrmojo.declare(mstrmojo.vi.ui.DatasetObjects,[mstrmojo.util.ui._HostsSplitter,mstrmojo.vi.ui.toolbars._HasToolbar],{scriptClass:"mstrmojo.vi.ui.DocDatasetObjects",cssClass:"mstrmojo-VIDocDatasetObjects",datasetUnitListScriptClass:"mstrmojo.vi.ui.DocDatasetUnitList",settings:null,allObjectBrowserOpened:false,loadOBDataprovider:function(AS){var AR=mstrApp.rootCtrl.datasetsPanel;AR.model.controller.rootCtrl.loadDataProvider(function(AT){AR.objectBrowser.set("dataProvider",AT);AS();});},onLogout:function(AU){var AS=mstrApp.rootCtrl,AR=AS.datasetsPanel,AT=AR.objectBrowser,AV=AT.dataProvider&&AT.dataProvider.sessionState;if(!AU||(AV&&AV===AU)){AS.set("dataProvider",null);AT.set("dataProvider",null);AR.set("allObjectBrowserOpened",false);}},onallObjectBrowserOpenedChange:function(){var AR=mstrApp.rootCtrl.datasetsPanel,AS=function(AT){AR.objectBrowser.set("opened",AT);c.call(AR,AT);};if(AR.allObjectBrowserOpened){AS(true);}else{if(AR.objectBrowser){AS(false);}}},clickOnCollapsibleTitleBar:function(){if(this.allObjectBrowserOpened){this.set("allObjectBrowserOpened",false);}},init:function AH(AR){this._super(AR);this.model.attachEventListener("updateUseTableView",this.id,function(){A.call(this);});A.call(this);},onsettingsChange:function(){A.call(this);},widgetResized:function(){if(this.browserNode){AQ.call(this,this.allObjectBrowserOpened);z.call(this,this.allObjectBrowserOpened);D.call(this);}this._super();},toggleAllObjectsBrowser:function e(){if(!this.allObjectBrowserOpened){if(mstrApp.browseAllObjects===false){mstrmojo.alert(mstrmojo.desc(14332,"You do not have the privileges to browse the objects in this project."));}else{this.set("allObjectBrowserOpened",!this.allObjectBrowserOpened);}}else{this.set("allObjectBrowserOpened",!this.allObjectBrowserOpened);}},getLinksForEmptyData:function h(){var AV=mstrApp.isSingleTier;var AY={scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13570,"Create New Report"),onclick:function(){this.model.controller.createDataset();}.bind(this)},AS={scriptClass:"mstrmojo.Label",text:AV?mstrmojo.desc(14306,"Add Dataset from Server"):mstrmojo.desc(13571,"Add Existing Dataset"),onclick:function(){this.model.controller.addDataset();}.bind(this)},AW={scriptClass:"mstrmojo.Label",text:AV?mstrmojo.desc(14306,"Add Dataset from Server"):mstrmojo.desc(13571,"Add Existing Dataset"),onclick:function(){this.model.controller.openCubeBrowser();}.bind(this)},AU={scriptClass:"mstrmojo.Label",text:AV?mstrmojo.desc(14305,"Add New Data"):mstrmojo.desc(13836,"Add External Data"),onclick:function(){this.model.controller.importFile();}.bind(this)},AX={scriptClass:"mstrmojo.Label",text:AV?mstrmojo.desc(14307,"Browse Objects on Server"):mstrmojo.desc(14082,"Add Existing Schema"),onclick:function(){var AZ=this;this.loadOBDataprovider(function(){if(mstrApp.browseAllObjects===false){mstrmojo.alert(mstrmojo.desc(14332,"You do not have the privileges to browse the objects in this project."));}else{AZ.set("allObjectBrowserOpened",true);}});}.bind(this)},AR={scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13941,"Browse All Objects"),onclick:function(){var AZ=this;this.loadOBDataprovider(function(){if(mstrApp.browseAllObjects===false){mstrmojo.alert(mstrmojo.desc(14332,"You do not have the privileges to browse the objects in this project."));}else{AZ.set("allObjectBrowserOpened",true);}});}.bind(this)},AT=[];if(this.model.allowImportData()){AT.push(AU);}if(mstrApp.isSingleTier){AT.push(AW);AT.push(AX);}else{if(this.model.allowNewOrEditRolapDS()&&this.model.isSchemaDefined()){AT.push(AY);}if(this.model.allowManageDocumentDataset()){AT.push(AS);}if(m.call(this)){AT.push(AR);}}return AT;},getDatasetTableView:function M(AT,AU){var AS=this,AR=this.settings;return mstrmojo.mixin({setting:AR.dataset(AU),onTableCollapsedChange:function(AW,AV){this._super();if(!AS.isSearching){this.setting.table(AW).isCollapsed=AV;AS.saveSettings();}}},this._super(AT,AU));},getDatasetMDXView:function w(AT,AU){var AS=this,AR=AT.tables&&AT.tables[0]&&AT.tables[0].did;return mstrmojo.mixin({setting:this.settings.dataset(AU).table&&this.settings.dataset(AU).table(AR),onNodeCollapsedChange:function(AV){this._super();if(!AS.isSearching){AV.setting.isCollapsed=AV.isCollapsed;AS.saveSettings();}}},this._super(AT,AU));},getDatasetPortlet:function AG(AV,AS,AT,AU){var AY=this,AW=AY.model,Aa=this._super(AV,AS,AT,AU),AX=AV.st===776,AZ=AV.st===779,Ab=this.settings&&this.settings.dataset(AS);W.copy({isCollapsed:Ab?!!(Ab.getCollapsed()):false,onclick:function(Ad){var Ae=Ad.getTarget(),Ac=this;if(mstrmojo.dom.contains(Ac.titleBar.leftToolNode,Ae,true,Ac.domNode)){AY.updateScrollbars();if(!AY.isSearching){J([{dsid:Ac.did,isCollapsed:Ac.isCollapsed}],AT);}}},addMenuItems:function AR(Ac){Ac.hostId=this.id;Ac.isHostedWithin=false;if(!(AW.isMDXDataset(AV)&&!AZ)&&!AX&&AV.rt!==8&&Z(AV)&&((AZ&&AW.hasPrivilegesForAllTables(AV.tables))||(!AZ&&((!AV.idd&&!AV.mngd&&AW.allowManageDocumentDataset())||(!AV.idd&&AV.mngd&&AW.allowNewOrEditRolapDS())||(AV.idd&&AW.allowNewOrEditDummyDS()))))){Ac.addMenuItem(mstrmojo.desc(11923,"Edit Dataset..."),"",function(){var Ag=AW.controller,Ai=function(Aj){mstrmojo.confirm(mstrmojo.desc(13955,"Re-running this report may take some time. Do you want to run it anyway?"),{confirmBtn:{t:mstrmojo.desc(13954,"Run"),fn:Aj},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:mstrmojo.emptyFn}},{title:mstrmojo.desc(1695,"Warning")});},Af={dataset:W.clone(AV),docModel:AW,title:mstrmojo.desc(13362,"Report Editor")+" - "+AV.name,okBtnText:mstrmojo.desc(13954,"Run"),onOk:function(Aj){var Ak=Ag.getRefreshCallback();if(Aj.length){Ai(function(){Ag.cmdMgr.execute({execute:function(){this.submit(Aj,Ak);},urInfo:{callback:Ak}});});}}},Ah={isEdit:true,isNewAnalysis:false,isManagedCube:AV.mngd,AnalysisId:AW.mid,ReportId:AS,CubeName:AV.name,CubeDesc:AV.dsc,StatusCode:1,needDefn:true};if(!AV.mngd){u(mstrmojo.desc(13363,"Editing this dataset will immediately affect other documents and dashboards that share the dataset.  Do you want to edit the stand-alone dataset or keep your changes local to this dashboard?"),{},{buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){if(AZ){AY.showDataImport(Ah);}else{var Aj=W.copy(Af);Aj.onOk=function(Ak){if(Ak.length){Ai(function(){AW.getDataService().submitUpdates(Ak,AW.controller.getRefreshCallback());});}};AT.openDatasetEditor(Aj);}}),mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),mstrmojo.emptyFn),mstrmojo.Button.newWebButton(mstrmojo.desc(13364,"Keep Changes Local"),function(){var Ak=AW.datasets,Aj={act:"convertDatasetToManaged",dsID:AS};if(AZ){d.call(AY,function(){var Al=Ag.cmdMgr.getInterimCmd();Al.urInfo.callback=Ag.model.getDatasetsUpdateCallback();Al.submitInterim(Aj,{success:function(Ao){var An=null,Am=null;W.forEach(Ao.datasets,function(Ap,Aq){if(!Ak[Aq]){An=Ap;An.did=Am=Aq;return false;}});AY.showDataImport({isEdit:true,isNewAnalysis:false,isManagedCube:An.mngd,AnalysisId:AW.mid,ReportId:Am,CubeName:An.name,CubeDesc:An.dsc,StatusCode:1,callback:function(Ar){var At=AY.model.cmdMgr(),As=At.getInterimCmd();if(Ar){var Aq=AY.model.controller.getRefreshCallback();As.urInfo.callback=Aq;As.resetCmdMgrOnComplete();As.submit([],Aq,null,At.CMD_PHASE.LAST);}else{var Ap=As.urInfo;Ap.callback={success:mstrmojo.emptyFn};Ap.treesToRender=0;As.cancel();}}});}});});}else{AT.openDatasetEditor(W.copy(Af,{modifiedItems:{convert:Aj,add:[],del:[],fs:{add:[],del:[]},filter:null}}));}},true)]});}else{if(AZ){AY.showDataImport(Ah);}else{AT.openDatasetEditor(Af);}}});}if(AV.dsm===P.IN_MEMORY&&!AW.isMDXDataset(AV)){if(!AV.tables||AV.tables.length===1){Ac.addMenuItem(mstrmojo.desc(13537,"Show Data..."),"shwd",function(){mstrmojo.vi.ui.ViewDataDialog.openDS(AW,AV,AS);});}else{Ac.addPopupMenuItem(mstrmojo.desc(11476,"Show Data"),"",function(){var Ag=new mstrmojo.ui.menus.MenuConfig(),Af=AV.tables;Af.forEach(function(Ai,Ah){Ag.addMenuItem(Ai.n,"",function(){mstrmojo.vi.ui.ViewDataDialog.openDSTable(AW,AV,AS,Ah);});});return Ag;});}}Ac.addSubMenuItem(mstrmojo.desc(4571,"Join Behavior"),"",this.id,function(){return t(AW,AV);});Ac.addSeparator();if(!AW.isDataImportRemoteDataSource(AV)||mstrApp.isSingleTier){if(AV.hcs){if(AV.idd!==true){Ac.addMenuItem(mstrmojo.desc(773,"Refresh"),"",function(){AB(AT,AT.model,AV,AS,AV.dsm);});}}else{if((AV.rt===1&&AW.allowReExecuteRegularReport())||(AV.rt===8&&AW.allowReExecuteViewReport())){Ac.addMenuItem(mstrmojo.desc(13609,"Re-run Report..."),"",function(){mstrmojo.confirm(mstrmojo.desc(13955,"Re-running this report may take some time. Do you want to run it anyway?"),{confirmBtn:{t:mstrmojo.desc(13954,"Run"),fn:r(AT,AV.did)},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:mstrmojo.emptyFn}},{title:mstrmojo.desc(2914,"Warning")});});}else{if(AX&&AW.allowManageDocumentDataset()&&AW.allowReExecuteCubeReport()&&!AV.localbin){Ac.addMenuItem(mstrmojo.desc(13610,"Republish Cube..."),"",function(){mstrmojo.confirm(mstrmojo.desc(13956,"Publishing time depends on your dataset. Are you sure you want to republish?"),{confirmBtn:{t:mstrmojo.desc(13953,"Republish"),fn:r(AT,AV.did)},cancelBtn:{t:mstrmojo.desc(2140,"Cancel"),fn:mstrmojo.emptyFn}},{title:mstrmojo.desc(2914,"Warning")});});}else{if(AZ&&AV.sda!==f.SupportDDAOnly&&AV.dsm!==P.DIRECT_ACCESS&&AW.allowManageDocumentDataset()&&AW.allowReExecuteCubeReport()&&AW.hasPrivilegesForAllTables(AV.tables)){Ac.addMenuItem(mstrmojo.desc(13610,"Republish Cube..."),"",O(AT,AS,AV));}}}}}if(AV.sda===f.SupportDDAOrInMemory&&AV.rt===7&&AW.allowManageDocumentDataset()&&AV.acg&l.DssAccessRightWriteFlag){Ac.addSubMenuItem(mstrmojo.desc(11922,"Data Access Mode"),"",this.id,p(AT,AV,AS,AW));}if((n()||AY.getDatasetCount()>1)&&AW.allowManageDocumentDataset()&&!(this.mdxView&&this.mdxView.docModel.isDatasetHasRecursiveAttribute(this.dataset))){Ac.addSubMenuItem(mstrmojo.desc(11484,"Replace Dataset with"),"",this.id,AM(AT));}Ac.addSeparator();if(AZ&&this.useTableView){R(Ac,AW,AV);}Ac.addMenuItem(mstrmojo.desc(13624,"Create Metric..."),"",AP.call(this,this.did,AW));if(!(AW.isMDXDataset(AV)&&AW.isDDADataset(AV))&&!N.hasCGorCon(AV)){Ac.addMenuItem(mstrmojo.desc(13625,"Create Attribute..."),"",x.call(this,this.did,AY.data));}Ac.addSeparator();if(!mstrApp.isSingleTier&&!AV.idd&&AW.allowSaveDataset()){if(((AV.att||[]).length+(AV.mx||[]).length)>0){Ac.addMenuItem(mstrmojo.desc(13239,"Save Dataset..."),"",H(AT,this.did));}}if(AV.mngd&&AW.allowManageDocumentDataset()){if(((AV.att||[]).length+(AV.mx||[]).length)>0){if(!(mstrApp.isSingleTier&&AV.hcs&&!AV.idd)){Ac.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){this.ctxt.titleBar.editTitle();},this);}}}if(AW.allowManageDocumentDataset()){Ac.addMenuItem(mstrmojo.desc(629,"Delete"),"",AN(this.parent.parent,this.did));}if(AT.gridSource===this.did){Ac.addToolbarBtn(mstrmojo.desc(11647,"This is the primary dataset."),"default-set",mstrmojo.emptyFn);}var Ad=N.getHighlightElementHandler;Ac.addPopupHandlers(this.id,Ad(true,this.titlebarNode),Ad(false,this.titlebarNode));if(AZ&&AW.allowManageDocumentDataset()&&AW.hasPrivilegesForAllTables(AV.tables)){var Ae=AV.tables;if(Ae&&Ae.length>1&&!(mstrApp.isSingleTier&&AV.dsm===P.DIRECT_ACCESS)){Ac.addSubMenuItem(mstrmojo.desc(11924,"Delete Table"),"","",function(){var Af=new mstrmojo.ui.menus.MenuConfig();Ae.forEach(function(Ag){Af.addMenuItem(Ag.n,"",function(){var Ah=function(){AW.warnForEditStandaloneDS(AV,function(){AW.getDataService().submitUpdates({act:"deleteEMMATable",dsid:AS,tbid:Ag.did},AI.override({success:function(Ai){this._super.call(AW,Ai);AW.controller.cmdMgr.reset();}},AW.controller.getRefreshCallback()));});};if(mstrApp.isSingleTier&&AV.hcs){a(AV,AS,AW,true,{success:function(){Ah();}});}else{Ah();}});});return Af;});}}return Ac;}},Aa);return Aa;},getDatasetTitleBarCfg:function(AY){var AR=this._super(AY),AU=this,AX=AY.dataset;W.copy({editTitleOnDoubleClick:AU.model.allowManageDocumentDataset()&&!!AX.mngd&&((AX.att||[]).length+(AX.mx||[]).length)>0,useRichTooltip:true,titleEdited:function AW(Aa,Ad,AZ){if(Ad){var Ab=function(){AY.titleBar.set("title",AZ);},Ae=function(){AU.model.renameDataset(AY.did,Aa.trim(),AI.wrapMethods(AU.model.getDatasetsUpdateCallback()),{failure:function(Af){mstrApp.onerror(Af);AY.titleBar.set("title",AZ);}});};var Ac=false;W.forEach(AU.model.datasets,function(Af){if(Af.name===Aa.trim()){Ac=true;return false;}});if(Ac){u(mstrmojo.desc(13365,"Another dataset with same name exists. Do you want to keep this name?"),{},{buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){N.validateName(Aa,Ae,Ab);},true),mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(){Ab();})]});}else{N.validateName(Aa,Ae,Ab);}}},updateTooltipConfig:function AV(Aa){var Ab=Aa.target||U.eventTarget(Aa.hWin,Aa.e);if((Ab.scrollWidth<=Ab.clientWidth)&&!this.getDatasetConnectivityTooltipText()){this.richTooltip=null;}else{var AZ=U.position(this.domNode);this.richTooltip={content:this.getTooltipContent(Aa),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:AZ.y-2,left:AZ.x+AZ.w+6};}},shouldShowTooltip:function(AZ,Ab){var Aa=this._super(AZ,Ab);Aa=Aa||!!this.getDatasetConnectivityTooltipText();return Aa;},getTooltipContent:function AS(AZ){var Ac,Ab="",Aa=this.getDatasetConnectivityTooltipText();Ac=AZ.target||U.eventTarget(AZ.hWin,AZ.e);if(Ac.scrollWidth>Ac.clientWidth){Ab=this.constructor.prototype.getTooltipContent.call(this,AZ);}if(!!Aa){Ab=Ab+" "+Aa;}return Ab;},getDatasetConnectivityTooltipText:function AT(){var Aa=AY.dataset,AZ=function(Ab){return"<span class = 'dataset-connection-status-tooltip'>"+Ab+"</span>";};if(mstrApp.isSingleTier){if(!Aa.hcs&&!Aa.connInfo){if(Aa.dsm==2){return AZ(mstrmojo.desc(13575,"(Live)"));}}else{if(!!Aa.hcs&&!!Aa.connInfo){if(Aa.dsm==2&&(Aa.sdsm==1||Aa.sdsm==2)){return AZ(mstrmojo.desc(14400,"Live (Server)"));}}}}else{if(Aa.dsm===2){return AZ(mstrmojo.desc(13575,"(Live)"));}}return null;}},AR);return AR;},saveSettings:function(){if(this.settings){this.settings.save();this.generateToolbar();}},ongridSourceChange:function(){this._super();var AS=this,AR=function(){W.forEach(AS.data,function(AU,AT){var AV=AS.getDatasetPanel(AT);if(AV){AV.generateToolbar();}});};if(this.visible){AR();}else{if(!this.updateToolbarHandle){this.updateToolbarHandle=this.attachEventListener("showPanel",this.id,function(){AS.updateToolbarHandle.clear();delete AS.updateToolbarHandle;AR();});}}},handleNode:null,unit:null,gridSource:null,postBuildRendering:function b(){var AR=this.handleNode;AR.style.display="block";this.registerSplitter(AR);return this._super();},setDimensions:function v(AU,AS){this._super(AU,AS);var AT=this.handleNode,AR=AT&&AT.style;if(AR){AR.top=0;AR.left=AS;AR.height=AU;AR.width="6px";}},getSplitterInfo:function AE(){return{min:120,max:Math.max(parseInt(this.parent&&this.parent.width,10)/2,330)};},postCreate:function g(){var AR=this.getSplitterInfo().min,AS=U.windowDim().w/2;if(parseInt(this.width,10)<AR){this.set("width",AR);}if((AS>=AR&&parseInt(this.width,10)>AS)||parseInt(this.width,10)>2000){this.set("width","168px");}},initChildren:function(){if(m.call(this)){var AR=this;this.layoutConfig=W.clone(this.layoutConfig);this.children.push({scriptClass:"mstrmojo.vi.ui.AllObjectsBrowser",alias:"objectBrowser",slot:"browserNode",model:this.model,bindings:{opened:"this.parent.allObjectBrowserOpened"},close:function(){if(!AR.allObjectBrowserOpened){if(this.dataProvider===null||this.dataProvider!==mstrApp.rootCtrl.dataProvider){this.reset();}AR.loadOBDataprovider(function(){if(mstrApp.browseAllObjects===false){mstrmojo.alert(mstrmojo.desc(14332,"You do not have the privileges to browse the objects in this project."));}else{AR.set("allObjectBrowserOpened",true);}});}else{AR.set("allObjectBrowserOpened",false);}}});this.layoutConfig.h.browserNode="30px";this.layoutConfig.w.browserNode="100%";}this._super();},splitterMoved:function S(AR){var AT="width",AS=parseInt(this[AT],10)+AR;this.set(AT,AS+"px");this.parent.doLayout();this.getPanelSaver().saveProperty("size",AS);},passToolbarCfg:function Q(AR){var AS=this.titleBar.toolbarCfg;if(AS){AS.destroy();}this.titleBar.set("toolbarCfg",AR);},updateToolbar:function q(AY){var AX=mstrApp.isSingleTier;var AT=this.id,AZ=this,AW=this.contents.children,AV=L.call(this),Aa=(AX)?mstrmojo.desc(14305,"Add New Data"):mstrmojo.desc(11780,"Add Data");AY.hostId=this.id;AY.isHostedWithin=false;if(AX&&AZ.model.allowImportData()){AY.addPopupMenuItem(Aa,AT,function(){var Ac=new mstrmojo.ui.menus.MenuConfig();Ac.addMenuItem(mstrmojo.desc(14303,"New Data..."),"",AD.call(AZ));Ac.addMenuItem(mstrmojo.desc(14304,"Dataset from Server..."),"",function(){mstrApp.rootCtrl.openCubeBrowser();});return Ac;},"");}else{if(AZ.model.allowManageDocumentDataset()&&!AZ.model.hasMDXRADataset(AZ.model.datasets)){AY.addPopupMenuItem(Aa,AT,AJ(AZ),"");}}if((n()||AZ.getDatasetCount()>1)&&AZ.model.allowManageDocumentDataset()&&!AZ.model.hasMDXRADataset()){AY[(AZ.getDatasetCount()>0)?"addSubMenuItem":"addDisabledMenuItem"](mstrmojo.desc(11485,"Replace All Datasets"),"",this.id,AM(AZ,true));}AY.addSeparator();if(AO(AZ.model)){AY.addEditorMenuItem(mstrmojo.desc(11612,"Show Hidden Objects"),this.id,function(){return G(AZ.model);});}AY.addSeparator();var Ab=W.valarray(AZ.data).some(function(Ac){return Ac.tables&&Ac.tables.length>1;});var AS=W.valarray(AZ.data).some(function(Ad){if(AZ.model.isMDXDataset(Ad)){var Ac=Ad.tables[0];return(Ac.dimensions&&Ac.dimensions.length>0)||(Ac.metricFolder&&Ac.metricFolder.folders&&Ac.metricFolder.folders.length>0);}return false;});if(Ab){AY.addSeparator();AY.addRadioMenuGroup(!!AZ.settings.useTableView,function(Ac){var Ad=AZ.settings;Ad.useTableView=Ac;AZ.model.raiseEvent({name:"updateUseTableView",useTableView:Ac});AZ.saveSettings();},[{value:false,text:mstrmojo.desc(11925,"Flat View")},{value:true,text:mstrmojo.desc(11926,"Table View")}],"",null,true);}if(AW&&(AW.length>1||(Ab&&AZ.settings.useTableView)||AS)){AY.addSeparator();var AU=true,AR=true;if(AV.length<AW.length){AU=false;AR=false;}else{AU=I.call(AZ,false);AR=I.call(AZ,true);}if(!AU){AY.addDisabledMenuItem(mstrmojo.desc(11816,"Expand All"),"expand-all");}else{AY.addMenuItem(mstrmojo.desc(11816,"Expand All"),"expand-all",function(){AZ.toggleAllNodesCollapsed(false,true);});}if(!AR){AY.addDisabledMenuItem(mstrmojo.desc(11817,"Collapse All"),"collapse-all");}else{AY.addMenuItem(mstrmojo.desc(11817,"Collapse All"),"collapse-all",function(){AZ.toggleAllNodesCollapsed(true,true);});}}AY.addSeparator();AY.addMenuItem(mstrmojo.desc(1143,"Help"),"help",function(){mstrApp.showHelpTopic("dashboard_editor_dataset_panel.htm");});return AY;},getShowDatasetPicker:function(){var AR=this;return function(){var AS=AK({id:"mstrIVE_DS",multiSelect:true,onOk:function(){d.call(AR,function(){AR.model.addDataset(AS.selectedItems);});}});AS.open();};},openDatasetEditor:function(AT){if(mstrApp.isSingleTier&&(mstrApp.browseAllObjects===false)){mstrmojo.alert(mstrmojo.desc(14332,"You do not have the privileges to browse the objects in this project."));return ;}var AR=AT.docModel.controller,AU=this,AS=W.copy(AT,{onOk:function(AV){var AW=AI.wrapMethods(AR.getRefreshCallback(),{success:function(){AU.set("allObjectBrowserOpened",false);}});if(AV.length){AR.cmdMgr.execute({execute:function(){this.submit(AV,AW,{style:{params:{treesToRender:3}}});},urInfo:{callback:AW}});}}});this.model.controller.rootCtrl.loadDataProvider(function(AV){AS.dataProvider=AV;var AW=new mstrmojo.vi.ui.DatasetEditor(AS);AU.datasetEditorId=AW.id;AW.open();});},onDatasetFilterChange:function(AR){if(AR&&this.settings.dataset(AR).isCollapsed){J([{dsid:AR,isCollapsed:false}],this);}this.generateToolbar();this.updateScrollbars();},showDataImport:function AF(AS){AS.hasNonRADataset=this.model.hasNonRADataset();var AU;if(this.dataImportId){AU=mstrmojo.all[this.dataImportId];}if(!AU){AU=mstrmojo.insert(mstrmojo.DI.DIContainer);}this.dataImportId=AU.id;var AT=this,AR=function(){W.copy(AS,AU.dataImportParams);AU.open();};if(AS.callback){AU.dataImportCallback=function(AV){AS.callback(AV);};AR();}else{AU.dataImportCallback=function(AZ){var AX=[],Ab=AT.model.cmdMgr(),Aa=Ab.getInterimCmd();if(AZ){AX=(AZ||[]).filter(function(Ac){return !AT.model.datasets[Ac.did]&&!Ac.mngd;});if(AX.length){AT.model.addDataset(AX,{success:function(){Aa.completeSubmit();}});}else{var AW=AI.wrapMethods(AT.model.controller.getRefreshCallback(),{success:function(){AT.set("allObjectBrowserOpened",false);}}),AY=AS.needDefn?mstrmojo.DocDataService.REQUEST_DEFN_DATA:null;Aa.urInfo.callback=AW;if(!mstrApp.isSingleTier){Aa.resetCmdMgrOnComplete();}Aa.submit(AT.model.getOpenDatasetPanelAction(),AW,AY,Ab.CMD_PHASE.LAST);}}else{var AV=Aa.urInfo;AV.callback={success:mstrmojo.emptyFn};AV.treesToRender=0;Aa.cancel();}};d.call(AT,AR);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.gm.EnumGraphType","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.gm.EnumShape","mstrmojo.chart.model.enums.EnumDSSAxisName","mstrmojo.chart.model.enums.EnumDSSDynamicShortcut","mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap");mstrmojo.requiresClsP("mstrmojo.vi.models","DropZonesModel","GMDropZones","EnumDragSources");mstrmojo.requiresDescs(11710,11711,11712,11713,11714,11715);var v=mstrmojo,w=v.array,T=v.hash,AM=v.func,AU=v.vi,Q=v.chart.model.enums.EnumDSSObjectType,b=AU.models.DropZonesModel.ENUM_TARGET_POSITION,Z=mstrmojo.vi.models.EnumDragSources,AP=b.ABOVE,z=b.ON,S=b.BELOW,g=1,a="00000000000000000000000000000000",h=0,AH={n:"Metric Names",did:a,t:h},p=false,AB=mstrmojo.gm.EnumShape,N=mstrmojo.gm.DualAxisSubAxisBit,U=N.PRIMARY,d=N.SECONDARY,AK=v.gm,AJ=AK.WidgetPropertyTag,M=1,AG=2,AC=3,f=4,F=5,l=6,o=7,V=8,H=9,AA=10,R=11,e=12,n={1:4,4:1,2:3,3:2},X=mstrmojo.chart.model.enums.EnumDSSXMLAxesBitMap,Y=mstrmojo.chart.model.enums.EnumDSSAxisName,E=mstrmojo.chart.model.enums.EnumDSSDynamicShortcut;function C(AV){return AV===f||AV===AC;}function AF(AX,Aa){var AW=Aa.getZoneModelByZoneId(o),Ad=Aa.getZoneModelByZoneId(l),Ac=Aa.getZoneModelByZoneId(F),Ag,Af,Ab,AV,AY=[],Ae=function(){return[Ad&&Ad.items,Ac&&Ac.items].every(function(Ah){for(Ab=0,AV=0;Ah&&Ab<Ah.length;Ab++){Ag=Ah[Ab];Af=w.find(AW.items,"did",Ag.did);if(Af!==-1&&Af<AV){return false;}AV=Af>AV?Af:AV;}return true;});},AZ=function(){[Ad,Ac].forEach(function(Ah){for(Ab=0;Ah&&Ah.items&&Ab<AW.items.length;Ab++){Ag=AW.items[Ab];Af=w.find(Ah.items,"did",Ag.did);if(Af!==-1){AY.push(Aa.getAddDropZoneUnitAction(Ah,Ag,Ah.items.length-1));}}});};if((AX===l||AX===F||AX===o)&&!Ae()){AZ();}return AY;}function AS(Aa,Af,AW,Ad){AW=(AW===undefined)?z:AW;var AZ=this.gmZones,AY,AV,Ab,AX,Ae,Ac=AW;switch(Aa.id){case R:case e:AV=AZ.getZoneModelByZoneId((Aa.id===e)?f:AC);AY=AZ.getZoneModelByZoneId((Aa.id===e)?M:AG);if(AV.items.length===0&&AY.items.length===0){AX=AV;Ae=0;Ac=AP;}else{Ab=AY.items.length;if(Af===Ab-1&&AW===S&&Ad){AX=AV;Ae=0;Ac=AP;}else{if(Af<Ab){AX=AY;Ae=Af;}else{if(Af===Ab&&AW===AP&&!Ad){AX=AY;Ae=(Ab>0)?(Ab-1):0;Ac=S;}else{AX=AV;Ae=Af-Ab;}}}}break;default:AX=AZ.getZoneModelByZoneId(Aa.id);Ae=Af;break;}return{zone:AX,idx:Ae,edge:Ac};}function u(AX,AY,AW,Aa,Ab){var AZ=AS.call(this,AX,AW,Ab,this.isMetric(AY));var AV=this.gmZones.isItemDropAllowed(AZ.zone,AY,AZ.idx,Aa,AZ.edge);if(p){window.console.log("isItemDrop: zone="+AX.id+",idx="+AW+",edge="+Ab+",xzone="+AZ.zone.id+",xidx="+AZ.idx+",xedge="+AZ.edge+",res="+AV);}return AV;}function K(){var AW=this,AV=[AC,f];return AV.some(function(AX){return AW.gmZones.isDualAxis(AX);});}function P(Aa,AZ,Ab){var AY,Ac,AV=[],AX=this;w.forEach(AZ,function(Ad){if(AX.isMetric(Ad)){AV.push(Ad);}});AY=Aa.readGlobalProperty(AJ.METRIC_SHAPES);Ac=AY.jsonObj[Ab.did];if(Ac!==undefined){Aa.updateMetricShape(Ab);for(var AW=0;AW<AV.length;AW++){AY=Aa.readGlobalProperty(AJ.METRIC_SHAPES);AY.setProperty(AV[AW].did,Ac);Aa.setWidgetPropertyValue(AJ.METRIC_SHAPES,AY.jsonObj);}}}mstrmojo.vi.models.CombineDropZonesModel=mstrmojo.declare(mstrmojo.vi.models.DropZonesModel,[mstrmojo.vi.models._DropZoneCommon],{scriptClass:"mstrmojo.vi.models.CombineDropZonesModel",dropZones:[],gmZones:null,init:function AL(AV){this._super(AV);},getMetricCntInAxis:function c(AV){var AX=0,AW=this;w.forEach(AV.items,function(AY){if(AW.isMetric(AY)){AX++;}});return AX;},shouldMetricNameShowIcon:function AR(Aa,AW){var AZ=this,AY=this.gmZones,Ac=AY.getHost(),Ab=Ac.GMController,AV=K.call(AZ);if(AZ.isMetricName(Aa)){if(Ab.isBubbleOrScatter()){return true;}if(AV){return false;}var AX;if(AW===M||AW===f){AX=[M,f];}else{if(AW===AG||AW===AC){AX=[AG,AC];}}if(AX){return !AX.some(function(Ad){return AY.getMetricCntInZone(Ad);});}}return true;},addZoneItem:function r(AW,AX,AV){if(!AW.did){AW.did=AW.id;}this._super(AW,AX,AV);},getDropZones:function(){var Ad=this.gmZones,AW=Ad.getHostStructure(),Aa=Ad.getHost(),Af=Aa.GMController,Ac=Af.isPie,Ab=(Af.chartType===mstrmojo.gm.EnumGraphType.GRID&&!Af.isEmptyVis()&&!Af.isEmptyBreakby()),Ae=Af.pureAreaChart,AY=this.getZone(mstrmojo.desc(12173,"Break By"),F,AW.BreakBy,Ab,{title:mstrmojo.desc(13828)}),AX=this.getZone(mstrmojo.desc(12090,"Size By"),V,AW.SizeBy,Ae,{allowSingle:!Af.isBubbleOrScatter(),title:mstrmojo.desc(13829)}),AZ=[this.getZone(mstrmojo.desc(14294,"Angle"),AA,AW.AngleBy,false,{title:mstrmojo.desc(13827)}),this.getZone(mstrmojo.desc(6188,"Slice"),l,AW.SliceBy,false,{title:mstrmojo.desc(13828)}),this.getZone(mstrmojo.desc(2069,"Vertical"),e,AW.Rows.concat(AW.YAxis),false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(3691,"Horizontal"),R,AW.Columns.concat(AW.XAxis),false,{title:mstrmojo.desc(11668)}),this.getZone(mstrmojo.desc(11662,"Color By"),o,AW.ColorBy,false,{title:mstrmojo.desc(11668)}),AY,AX,this.getZone(mstrmojo.desc(2962,"Tooltip"),H,AW.AdditionalMetrics,false,{title:mstrmojo.desc(13827)})];if(!Ac){AZ=AZ.slice(2);}else{AZ.splice(1,0,AZ.splice(4,1)[0]);}this.dropZones=AZ;this.updateBreakByAndSliceUnits();if(Ae){AX.items.forEach(function(Ag){Ag.hidden=true;});}if(Ab){AY.items.forEach(function(Ag){Ag.hidden=true;});}var AV=Ad.getDropZones();AV.zones.forEach(function(Ag){if(Ag.id===F){AY.siblings=Ag.siblings;}});return{n:Ad.getHost().defn.ttl,zones:AZ};},getZone:function AE(Aa,AZ,AY,AW,AX){var AV=this._super(Aa,AZ,AY,AW,AX);if(AZ===R||AZ===e){AV.cssClass=AV.cssClass+" mergedZone";}return AV;},canSwapAxis:function AD(){return this.gmZones.canSwapAxis();},swapAxis:function A(){this.gmZones.swapAxis();},getClearAllUnitsActions:function O(){var AW=[],AV=this;w.forEach(AV.gmZones.getDropZones().zones,function(AX){w.forEach((AX&&AX.items)||[],function(AY){AW.push(AV.getRemoveDropZoneUnitAction(AX,AY));});});return AW;},getClearAllUnitsUnTemplateActions:function q(){var AY=[],AW=this,AV=this.getHost(),AX=AV.GMController;AX.removeGroupInfo();if(AV.isXMLDirty()){AY.push(AV.getPersistAction());}return AY;},getUnitMenuItems:function x(AY,Aj,Ai,AX){if(!Ai){throw new Error(this.scriptClass+"::getUnitMenuItems: Item must be provided.");}var An=this,AW=An.gmZones,Ae=(Ai.t===Q.DssTypeMetric&&!this.isMetricName(Ai)),Al=(Ai.ax||U),AV=(Al===U),Aa=AW.getZoneModelByZoneId((Aj.id===e)?M:AG),Ac=AW.getZoneModelByZoneId((Aj.id===e)?f:AC),Am,Ak=An.isMetricName(Ai),Ag=K.call(An),Af=An.getHost().GMController.isBubbleOrScatter(),Ao=An.getMetricCntInAxis(Aj);if(Ak){Am=AW.getZoneModelByZoneId(Ai.zone);}else{var Ab=AS.call(this,Aj,Ai._renderIdx);Am=Ab.zone;}var Ah=Ae?Al:(Am.id===Ac.id?U:d),Ad=function(Ap,Aq,As){var Ar=Ap!==Aq,At=C(As.newZone.id);if(Ar){An.unitsDropped(As.newZone,{src:{data:{src:Z.VIZ_EDITOR}}},{idx:At?0:As.newZone.items.length,edge:At?AP:S,allowedItems:[Ai]},As.isPrimary);}return Ar;};if(Aj.id===R){if(!Ak||(Ak&&!Ag&&(Af||(!Af&&Ao<=0)))){AY.addRadioMenuGroup(Ah,Ad,[{value:d,text:Ae?mstrmojo.desc(11710,"Top Axis"):mstrmojo.desc(11711,"Top Column"),newZone:Ae?Ac:Aa,isPrimary:Ae?!AV:true},{value:U,text:mstrmojo.desc(11712,"Bottom Axis"),newZone:Ac,isPrimary:true}],"checkMark");}}else{if(Aj.id===e){var AZ=[];if(!Ak||(Ak&&!Ag&&(Af||(!Af&&Ao<=0)))){if(!Ae){AZ.push({value:d,text:mstrmojo.desc(11714,"Left Row"),newZone:Aa,isPrimary:true});}AZ.push({value:U,text:mstrmojo.desc(11715,"Left Axis"),newZone:Ac,isPrimary:true});}if(Ae){AZ.push({value:d,text:mstrmojo.desc(11713,"Right Axis"),newZone:Ac,isPrimary:!AV});}AY.addRadioMenuGroup(Ah,Ad,AZ,"checkMark");}}if(!this.isMetricName(Ai)&&(Aj.id===R||Aj.id===e)){AY.addSeparator();}return this.gmZones.getUnitMenuItems(AY,Am,Ai,AX);},getDynamicBreakByAxisOptions:function(AW){var AX=this.getHost(),AY=AX.GMController,AV=[];if(AY.getAttributesOnDropZone("Rows").length){AV.push({n:AW?mstrmojo.desc(3326,"By Columns"):mstrmojo.desc(122,"Columns"),axes_bitmap:X.DssXmlAxisRowsBit,dmy:"@cols"});}if(AY.getAttributesOnDropZone("Columns").length){AV.push({n:AW?mstrmojo.desc(3327,"By Rows"):mstrmojo.desc(2968,"Rows"),axes_bitmap:X.DssXmlAxisColumnsBit,dmy:"@rows"});}if(AY.getAttributesOnDropZone("Rows").length||AY.getAttributesOnDropZone("Columns").length){AV.push({n:AW?mstrmojo.desc(13283,"By Cell"):mstrmojo.desc(13399,"Cell"),axes_bitmap:Y.DssAxisDynamicShortcutRoot+E.DssDynamicShortcutCell,dmy:"@cell"});}if(AY.getAttributesOnDropZone("BreakBy").length){AV.push({n:AW?mstrmojo.desc(13284,"By Shape"):mstrmojo.desc(2923,"Shape"),axes_bitmap:Y.DssAxisDynamicShortcutRoot+E.DssDynamicShortcutShape,dmy:"@shape"});}return AV;},filterAllowItems:function W(Aa,AW,AY,AZ){var AX,AV;if(AY>0&&AZ>0){for(AX=Aa.length-1;AX>=0;AX--){AV=this.isMetric(Aa[AX]);if((AV&&AW)||(!AV&&!AW)){Aa.splice(AX,1);}}}if(Aa.length>1&&this.isMetric(Aa[0])){Aa.splice(1,Aa.length-1);}return Aa;},allowDropOnTarget:function AI(AV,AX){var AW=AS.call(this,this.getZoneModelByZoneId(AX.srcZoneId),AX.itemIdx),AY=T.copy(AX);AY.srcZoneId=AW.zone.id;AY.itemIdx=AW.idx;return this.gmZones.allowDropOnTarget(AV,AY);},getAllowDropInfo:function B(Al,AW,Ac,AX,AV){var Ak=this._super(Al,AW,Ac,AX,AV),Ab=Ak.allowedItems,Am=this,Aj,Ag=0,An=0,Ad=0,Ai={},Ah=AV.src.data.src,Ae=this.gmZones.getZoneModelByZoneId(AA)!==undefined;Ai[AC]=Am.gmZones.getMetricCntInZone(AC);Ai[f]=Am.gmZones.getMetricCntInZone(f);if(Ae){Ai[AA]=this.gmZones.getItemCountInZone(AA);}w.forEach(Ab,function(Ao){if(Am.isMetric(Ao)){An++;}else{if(Am.isMetricName(Ao)){Ad++;}else{Ag++;}}});if(An>0&&Ad>0&&Al.id!==Ah){var AY=Al;if(Al.id===e||Al.id===R){AY=this.gmZones.getZoneModelByZoneId((Al.id===e)?f:AC);if(Ah===AG||Ah===M){Ah=this.gmZones.getZoneModelByZoneId((Al.id===e)?AC:f);}}Ai[AY.id]+=An;Ai[Ah.id]-=An;w.forEach(Ab,function(Ap,Ao){if(Am.isMetricName(Ap)&&!(Ai[AC]>1||Ai[f]>1||Ai[AA]>1)){Ab.splice(Ao,1);}});}if(An>0&&Ag>0&&(Al.id===R||Al.id===e)){if(AX===b.ON){var Aa=Al.items[Ac];if(this.isMetricName(Aa)){Ak.allowedItems=[];}}return Ak;}else{if(Ab.length>1&&(An>=1||Ag>=1)&&Al.id===o){if(this.getItemCountInZone(o)===0){var AZ=(Ag+Ad>=An);Ab=this.filterAllowItems(Ab,AZ,An,Ag+Ad);return Ak;}var Af=this.isAttrCategory(Al.items[0])||this.isMetricName(Al.items[0]);Ab=this.filterAllowItems(Ab,Af,An,Ag+Ad);return Ak;}}for(Aj=Ab.length-1;Aj>=0;Aj--){if(!u.call(Am,Al,Ab[Aj],Ac,AV,AX)){Ab.splice(Aj,1);}}return Ak;},getAvatarIconClass:function k(){var AV=this.gmZones,AX=AV.getHost(),AY=AX.getChartInfo();if(AY.isCombo){return"viGMCombo";}if(AY.isPie){return"viGMPie";}if(AY.isBubbleOrScatter){return"viGMBubble";}if(AY.isABL){var AW=AY.shape;if(AW===AB.BAR){return"viGMBar";}if(AW===AB.LINE){return"viGMLine";}if(AW===AB.AREA){return"viGMArea";}return"viGMLine";}return"viGMCombo";},shouldAddMetricCount:function L(Aa,AW,AZ,AV){var AX=1,AY=this.gmZones.hGetItemOccurrence(AH,[F]);Aa.forEach(function(Ab){if(Ab.did===AW.did){AX=0;}});if(AZ===z&&AY.length&&Aa[AV].did===AW.did){AX=-1;}return AX;},processDualAxis:function J(Ab,Ag){var Ac=0,Ad=this,AW=Ad.gmZones.getZoneModelByZoneId(AC),AV=Ad.gmZones.getZoneModelByZoneId(f),AY=[],AZ,Af=Ab===AC?AW:AV,Ae=Af===AW?AV:AW,AX=Ab===AC?f:AC,Aa=Ad.gmZones.getMetricCntInZone(AX);if(Aa){w.forEach(Af.items,function(Ah){if(Ad.isMetric(Ah)&&Ah.id!==Ag.id&&Ah.ax!==Ag.ax){Ac=1;AY.push(Ad.gmZones.getAddDropZoneUnitAction(Af,Ah,Ah.idx,{isPrimary:Ag.ax===0?true:false}));}});}if(Ac!==1){AZ=Ad.gmZones.isDualAxis(AX);if(AZ){w.forEach(Ae.items,function(Ah){if(Ah.id!==Ag.id&&Ah.ax===1){AY.push(Ad.gmZones.getAddDropZoneUnitAction(Ae,Ah,Ah.idx,{isPrimary:true}));}});}}return AY;},getUnitDroppedActions:function I(At,AX,Ar,Af,Ab,Aj,Ap,AY){var Aw=this,AV=this.gmZones,Au=AS.call(this,At,Af,Ab,this.isMetric(Ar)),As=AX.src.data.src,Ae=[],AW=Aw.isMetric(Ar);if(AX&&(As===Z.DATASETS||As===Z.VIZ_EDITOR)&&!u.call(Aw,At,Ar,Af,AX,Ab)){return Ae;}if(p){window.console.log("unitDropped: zone="+At.id+", idx="+Af+", edge="+Ab+", xzone="+Au.zone.id+", xidx="+Au.idx+", xedge="+Au.edge);}if(!Ar.did){Ar.did=Ar.id;}if(At.id===e||At.id===R){var Ad=AV.getZoneModelByZoneId((At.id===e)?f:AC),Ac=AV.getZoneModelByZoneId((At.id===e)?M:AG),Ai=AV.isMetricZone(Ad.id),An=false,Am;if((Au.zone.id===Ad.id)&&Ad.id!==Ar.zone&&!Ai&&Ab!==z&&!this.isMetricName(Ar)&&!this.isMetric(Ar)){w.forEach(Ad.items,function(Ax){if(!Aw.isMetricName(Ax)&&Ax.did!==Ar.did){Am=Ax;return false;}});if(Am){Ae.push(AV.getAddDropZoneUnitAction(Ac,Am,Ac.items.length));Ad.items.splice(w.indexOf(Ad.items,Am),1);if(Au.idx){Au.idx--;}else{if(Au.idx===0&&Au.edge===S){Au.edge=AP;}}Ae.callback=AM.wrapMethods(AV.getUpdateCallback(),{failure:function(){Ac.items.pop();Ad.items=[Am].concat(Ad.items);}});}AX.metricNamesHandled=true;}if(AW){var Ao=AV.getZoneModelByZoneId(AA),Ag=false,AZ=0,Aa=Ac.id;if(Ao!==undefined){Ag=this.isMetricZone(AA);AZ=Ao.items.length;}var Av=0;w.forEach(Ad.items,function(Ax){if(Aw.isMetric(Ax)){Av++;}});var Al=Aw.shouldAddMetricCount(Ad.items,Ar,Au.edge,Af);if(Av+(Al&&Ab!==z?1:0)>g){An=true;}if(AX.dndGM&&!Ap&&Ab!==b.ON){if(Ad.id===AC){Aa=f;}else{Aa=AC;}}var Ak=T.clone(AH),Aq=this.gmZones.hGetItemOccurrence(Ak,[M,AG,AC,f,o,F,l]);if(Aq.length===0){Ae=Ae.concat(AV.getUpdateMetricNameUnitActions(An,Aa));AX.metricNamesHandled=true;}else{AX.metricNamesHandled=false;}}}Ae=Ae.concat(AV.getUnitDroppedActions(Ar,Au.zone,AX,Au.idx,Au.edge,Aj,Ap,AY));if(AW&&(At.id===e||At.id===R)){var Ah=AV.getZoneModelByZoneId((At.id===e)?f:AC);if(Ah.id===AC){Ae=Ae.concat(Aw.processDualAxis(AC,Ar));}else{if(Ah.id===f){Ae=Ae.concat(Aw.processDualAxis(f,Ar));}}}if(AW&&AX.src.data.src===mstrmojo.vi.models.EnumDragSources.VIZ){if(At.id===AC){Ae=Ae.concat(Aw.processDualAxis(AC,Ar));}else{if(At.id===f){Ae=Ae.concat(Aw.processDualAxis(f,Ar));}}}return Ae;},unitsDropped:function AO(Aw,AZ,Ag,An,Au,Ab){var AW=this.gmZones,AY=AZ.actions||[],Ai=[],Ar,Al=Ag.idx,Ad=Ag.edge,Aj=Ag.allowedItems,A0=this,As,A2=v.all[this.hostId],Af=false,Ap,Az=K.call(this);if(Aw.id===e||Aw.id===R){if(this.isMetric(Aw.items[Al])&&An===undefined){if(Ad===z){An=(Aw.items[Al].ax===0);}else{if(Aj.length>0&&this.isMetric(Aj[0])&&Aj[0].ax!==undefined){An=(Aj[0].ax===0);}}}}if(Ad===z&&this.isMetric(Aw.items[Al])){P.call(this,A2,Aj,Aw.items[Al]);}Ai=Ai.concat(AF(Aw.id,AW));if(Aj.length>1&&(Aw.id===R||Aw.id===e)){var Aa=[],At=[];w.forEach(Aj,function(A3){if(A0.isMetric(A3)){Aa.push(A3);}else{At.push(A3);}});if(Aa.length>0&&At.length>0){var Av=AS.call(this,Aw,Al,Ad,false),Ah=Av.zone,Ac=AW.getZoneModelByZoneId(n[Ah.id]),Ae=(Ah.id===AC||Ah.id===f)?Aa:At,Ay=(Ac.id===AC||Ac.id===f)?Aa:At,Ax=function(A4,A3){return A0.isAttrCategory(A4)&&A0.isMetricName(A3.items[A3.items.length-1]);};Al=Av.idx;Ad=Av.edge;if(Ax(Ae[0],Ah)&&(Al>=Ah.items.length-1)){Al-=1;}Ae.forEach(function(A4,A3){Ap=(A3!==0?S:Ad);Ar=A0.getUnitDroppedActions(Ah,AZ,A4,Al,Ap,true,Au);Al+=(Ar.length>0&&Ap===S?1:0);Ai=Ai.concat(Ar);});Al=Ac.items.length-1;if(Ax(Ay[0],Ac,Al)){Al-=1;}Ay.forEach(function(A3){Ar=A0.getUnitDroppedActions(Ac,AZ,A3,Al++,S,true,Au);Ai=Ai.concat(Ar);});Af=true;}}if(!Af){for(As=0;As<Aj.length;As++){Ap=(As!==0?S:Ad);Ar=A0.getUnitDroppedActions(Aw,AZ,Aj[As],Al,Ap,An,Au,Ab);Al+=(Ar.length>0&&Ap===S?1:0);Ai=Ai.concat(Ar);}}var AV=K.call(this);var Am=AW.getZoneModelByZoneId(o);if(!Az&&AV&&Am!==undefined&&Am.items.length===0){Ai=Ai.concat(AW.getUpdateMetricNameUnitActions(true,o));}var Aq=this.docModel.getDataService(),AX=A2.k,A1=AM.wrapMethods({success:function(){A2.resetXMLDirtyFlag();}},A2.controller._getXtabCallback(A2)),Ak=Aq.getUpdateTemplateAction(AX,Ai);var Ao=Ak.partialRetrieval.nodes;A1=AM.wrapMethods(AZ.callback,A1);Ak.partialRetrieval.nodes=Ao.concat(this.docModel.getSourceFilterKeys(AX));AY.push(Ak);if(A2.isXMLDirty()){AY.push(A2.getPersistAction());}this.checkAndWarnLargeItemsForAddUnits(Aj,function(){A2.controller.submitUndoRedoUpdates(AY,null,A1);});},getRemoveDZUnitAction:function AN(AW,AV){var AX=AS.call(this,AW,AV);return this.gmZones.getRemoveDZUnitAction(AX.zone,AX.idx);},getClearDZUnitActions:function AT(AW,AV){var AX=this.gmZones,AY=[];switch(AW.id){case R:AY.concat(AX.getClearDZUnitActions(AX.getZoneModelByZoneId(AG),AV));AY.concat(AX.getClearDZUnitActions(AX.getZoneModelByZoneId(AC),AV));break;case e:AY.concat(AX.getClearDZUnitActions(AX.getZoneModelByZoneId(M),AV));AY.concat(AX.getClearDZUnitActions(AX.getZoneModelByZoneId(f),AV));break;default:AY=AX.getClearDZUnitActions(AW,AV);break;}return AY;},getAddDZUnitAction:function(AW,AY,AV,AZ){var AX=this.gmZones;return AX.getAddDropZoneUnitAction(AW,AY,AV,{isPrimary:AZ});},moveAttributesToZone:function m(AW,AV){return this.gmZones.moveAttributesToZone(AW,AV);},deleteItem:function G(AW,AV){var AX=AS.call(this,AW,AV);this.gmZones.deleteItem(AX.zone,AX.idx,g-1);},deleteItems:function(AV,AW){this.gmZones.deleteItems(AW,g-1);},getHostModel:function(){return this.gmZones.getHostModel();},getMultiUnitsMenuItems:function t(AW,AV,AX){var AZ=this.id;if(mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(AX).length){var AY=AV;if(AV.id===e||AV.id===R){AY=this.gmZones.getZoneModelByZoneId((AV.id===e)?f:AC);}AW.addSubMenuItem(mstrmojo.desc(5188,"Calculation"),"",this.id,function(){return mstrmojo.all[AZ].getMultipleMetricsCalcMenus(AY,AX,true);});}AW.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",function(){mstrmojo.all[AZ].deleteItems(AV,AX);});},addUnitsFromDataSource:function D(AW,AX,AY,AV){this.gmZones.addUnitsFromDataSource(AW,AX,AY,AV);},getHighlightTargets:function AQ(Ac,AZ){var Aa=AS.call(this,Ac,AZ.idx,AZ.edge),AV=Aa.zone,AY,Ab,AX;if(AV.id===AC||AV.id===f){Ab=this.gmZones.getZoneModelByZoneId((Ac.id===e)?M:AG);AX=Ab.items.length;AY=this.gmZones.getHighlightTargets(AV,AX,{allowedItems:AZ.allowedItems,idx:Aa.idx,edge:Aa.edge});}var AW=(this.isAttrCategory(AZ.item)&&this.isMetric(Ac.items[AZ.idx]))||(this.isMetric(AZ.item)&&(this.isAttrCategory(Ac.items[AZ.idx])||this.isMetricName(Ac.items[AZ.idx])));if(Ac.id===o&&Ac.items.length&&AW){AY=[];Ac.items.forEach(function(Ae,Ad){AY.push({idx:Ad,edge:AZ.edge});},this);return AY;}if(!AY){return this._super(Ac,AZ);}return AY;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.vi.ui._HasBoxLayout","mstrmojo.ui._HasScroller","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.BoxLayoutConfig","mstrmojo.vi.ui.rw.VizBox","mstrmojo.vi.ui.rw.FilterBox","mstrmojo.func","mstrmojo.hash","mstrmojo.string","mstrmojo.boxmodel","mstrmojo.models.FormatModel","mstrmojo.vi.models.EnumDragSources","mstrmojo.css");var o=mstrmojo.func,Q=mstrmojo.hash,D=mstrmojo.css,r=mstrmojo.string,q=mstrmojo.vi.models.EnumDragSources,T=mstrmojo.vi.ui.rw.VizBox.ENUM_PORTAL_STATE,h=mstrmojo.models.FormatModel,m=h.getFormatUpdate,e=h.ENUM_PROPERTY_NAMES;function k(z,x){z=z||[];(this.children||[]).forEach(function(AB){var AA=AB.addFormatProps(undefined,x);if(AA){z.push(AA);}});return z;}function X(z,x){z.push(this.model.getUnitFormatAction(this,1,m(e.LAYOUT_XML,this.boxLayoutConfig.getBoxState()),x));return z;}function t(){(this.children||[]).forEach(function(x){x.generateToolbar();});}function K(){if(this.visible){this.raiseEvent({name:"panelDisplaying"});}}function R(x){D.toggleClass(this.domNode,"undraggable-uc",x);}function A(){var AB=mstrmojo.vi.VisualInsightApp.APP_STATES,x=AB.PRESENTATION,z=mstrApp.appState===x,AA=this.domNode;D.toggleClass(this.domNode,"pulse",!z);setTimeout(function(){D.toggleClass(AA,"pulse",false);},500);}mstrmojo.vi.ui.rw.DocRelativePanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo.vi.ui._HasBoxLayout,mstrmojo.ui._HasScroller,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.rw.DocRelativePanel",formatHandlers:null,childPadding:4,allowPanelEdgeTargeting:true,children:null,model:null,titleText:null,subPanelCssText:"position:absolute;",markupString:'<div id="{@id}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="{@containerNodeCssText}{@subPanelCssText}"><div></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild.firstChild;}},init:function p(x){this._super(x);D.addWidgetCssClass(this,"mstrmojo-VIDocRelativePanel");var z=this.id;this.controller.view.getLayout(this.node.defn._lkz).attachEventListener("layoutRedisplay",z,function(){if(this.selected){K.call(this);}});this.markupMethods=o.override({onvisibleChange:function(){this._super();if(this.visible){t.call(this);}K.call(this);}},Q.copy(this.markupMethods));this.boxLayoutConfig=new mstrmojo.vi.ui.BoxLayoutConfig({hostId:z,padding:this.childPadding,needsValidation:true,getBoxChildClass:function(AA){return mstrmojo.all[z].getBoxLayoutChild(AA).scriptClass;}});this.model.attachEventListener("viIconTabClicked",z,function(AB){var AA=this.model.hgl;if(AB.id=="vi_flt"&&!!AA==0){A.call(this);}});},onremoveChild:function M(){R.call(this,!this.hasMultipleChildren());},onaddChild:function L(){R.call(this,!this.hasMultipleChildren());},setupScrollNodes:function l(){this.scrollNode=null;this.scrollbarHostNode=null;},isPanelDisplaying:function(){return this.selected&&this.node.defn._lkz===this.model.getCurrentLayoutKey();},getLayoutOffsets:function E(){return{h:8,w:8};},getBoxLayoutChild:function S(x){var z=this._super(x);if(!z){return this.getUnitByKey(x.k);}return z;},addChildren:function b(AB,x,z){this._super(AB,x,z);var AA=this.model,AE=AA.findKeyMap(this.node);if(AE){var AD=this.boxLayoutConfig.replaceLayoutXmlKeys(AE);if(AD){var AC=AA.replaceKeyBoxes=AA.replaceKeyBoxes||[];AC.push(this);}}this.buildBoxLayout();},refresh:function w(){this.boxLayoutConfig.dirty=true;this._super();this.buildBoxLayout();},update:function d(AB){var AA=AB.defn,x=AA&&AA.layoutXML,z=this.boxLayoutConfig;if(x){z.box=x;}else{this.defn.layoutXML=z.useDefaultBox(AB.data.objects||[]);}this.title=AA&&AA.ttl;this.titleText=r.decodeHtmlString(this.title);},hasMultipleChildren:function a(){return(this.children.length>1);},getSplitterHost:function B(){return this.containerNode;},getTargetKeysByType:function f(x){return(this.children||[]).filter(function(z){return(x||[]).indexOf(parseInt(z.defn.t,10))>-1;}).map(function(z){return z.k;});},getTargetKeysExcludingTypes:function N(x){return(this.children||[]).filter(function(z){return(x||[]).indexOf(parseInt(z.defn.t,10))<0;}).map(function(z){return z.k;});},insertNewBoxAndSaveDeferred:function(AE,AA,AB,AD,x,z){var AC=this.id;this.addChildren([AA]);this._super(AE,AA,AB,o.wrapMethods({failure:function(){mstrmojo.all[AC].removeChildren(AA);AA.destroy();}},AD),x,z);},addUnit:function H(AB,z,AA,AD,AC){this.addChildren([AB]);var x=this.insertNewBox(AB,z,AA,AD);if(AD){this.addSaveBoxLayoutActions(AD,AC);}return x;},setPortalState:function V(AB,x,AE){var z=this.id,AC=this.model,AI=AB.defn,AA=AI.ds,AG=function(AM){var AL=mstrmojo.all[z];if(!mstrmojo.all[AB.id]){var AK=AB.k;mstrmojo.array.forEach(AL.children,function(AO){if(AO.k===AK){AB=AO;return false;}});}if(!mstrmojo.all[AB.id]){return ;}var AN=AB.isMaxed=AM===T.MAXIMIZE,AJ=AN?2:1;if(AN){AL.maximizedBox=AB;}else{if(AM===T.RESTORE){delete AL.maximizedBox;}}R.call(this,AB.isMaxed);AB.set("zIndex",AJ);AI.ds=AM;AL.buildBoxLayout();AB.generateToolbar();};if(!AE){AC.controller.cmdMgr.execute({execute:function AF(){var AL=mstrmojo.all[z],AM=x===T.MAXIMIZE,AJ=AM?2:1,AN=[AC.getUnitFormatAction(AB,1,{FormattingOrder:{ZIndex:AJ},FormattingView:{WindowState:x}})];k.call(AL,AN);this.submit(AN,{failure:function AK(){AG(AA);}},{params:{suppressData:true}});AG(x);},urInfo:{silent:true,undo:function AH(){AG(AA);},redo:function AD(){AG(x);}}});}else{AG(x);}},buildBoxLayout:function J(z,x){if(!this.visible){return ;}if(!this.children){return ;}var AB=this.boxLayoutConfig;if(AB.needsValidation){var AA=this.children;if(!AB.validateBoxLayout(AA)){this.defn.layoutXML=AB.useDefaultBox(AA);}AB.needsValidation=false;}this._super(z,x);var AC=this.maximizedBox;if(AC){AC.updateLayout({left:"0px",top:"0px",height:this.height,width:this.width});}},endBoxMove:function U(z,x){this._super(z,x);this.getSplitterHost().appendChild(x.domNode);},getChildPositionActions:function F(x){return k.call(this,[],x);},getBoxLayoutActions:function u(x){return X.call(this,[],x);},getBoxLayoutSaveCallback:function g(){var x=this.id;return{success:function(){t.call(mstrmojo.all[x]);}};},addSaveBoxLayoutActions:function I(AB,x){var AA=this.id,z=AB.actions;k.call(this,z,x);X.call(this,z,x);AB.addCallbacks({success:function(){t.call(mstrmojo.all[AA]);}});},saveBoxLayout:function Z(AA,x,AC,AB,z){this._super(AA,x,AC,AB,z);this.defn.layoutXML=this.boxLayoutConfig.box;if(AB){AB.addCallbacks(this.getBoxLayoutSaveCallback());}},postBuildBoxLayout:function n(){var x=this.model.getLatestSelectedViUnitKey(),z=x&&this.getUnitByKey(x);if(z){this.model.selectVIUnit(z.id);}else{this.selectFirstBox();}},selectFirstBox:function Y(){var x=this.firstBoxId;if(this.visible&&x){this.model.selectVIUnit(x);}},selectVIUnit:function c(z,x){var AB=this._tgtSelections,AA=true;if(AB){if(z.id===AB.id){AA=false;}else{AA=AB.toggleSelection(z.k);AB.notify();}}else{this.model.selectVIUnit(z.id,x);}return AA;},getUnitByKey:function P(x){return(this.children||[]).filter(function(z){return z.k===x;})[0];},enterTargetSelectionMode:function O(AE,x,AD){if(!this._tgtSelections){this.children.forEach(function(AF){AF.set("enabled",AF.id===x||AF instanceof mstrmojo.vi.ui.rw.VizBox||AF instanceof mstrmojo.vi.ui.rw.FilterBox);});var AB=this.model,AA=AB.getSelectedViUnit().id,z={},AC=function(){return Q.keyarray(z).filter(function(AF){return z[AF];});};this._tgtSelections={id:x,notify:function(AF){AE(AC(),!!AF);},toggleSelection:function(AF){z[AF]=!z[AF];return z[AF];},restore:function(){AB.selectVIUnit(AA,true);}};AB.selectVIUnit("");(AD||[]).forEach(function(AF){AB.getUnitInstance(AF,1).parent.selectVIUnit();},this);}},exitTargetSelectionMode:function G(x){var z=this._tgtSelections;if(z){delete this._tgtSelections;this.children.forEach(function(AA){AA.set("enabled",true);});z.restore();if(x){z.notify(x);}}},unload:function C(){this.destroyChildren();this.defn.l=false;this.builtChildren=false;},getPanelTargetEdge:function v(x){if(x.src.widget.parent!==this&&x.getCtxtDragData().src!==q.FILTERS){return"";}return this._super(x);},dropBox:function W(AB,z,AC,AF){AF=false;this._super(AB,z,AC,AF);var x=this,AA=x.model,AE=mstrmojo.DocDataService;var AD=AA.getUIState();AD[Q.keyarray(AD)[0]].boxState=Q.clone(AB.box.initState);AA.execute({execute:function(){x.saveBoxLayout(this);},urInfo:{callback:AE.EMPTY_CALLBACK,extras:AE.SUPPRESS_DATA},undoUIState:AD});}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.rw.DocRelativePanel,{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.ME.DerivedFunctionWizard","mstrmojo.ME.DerivedSimpleMetricEditor","mstrmojo.ME.DerivedRankEditor","mstrmojo.ME.DerivedFormulaMetricEditor","mstrmojo.ME.DerivedOLAPEditor","mstrmojo.ME.MetricIDE","mstrmojo.hash");mstrmojo.requiresDescs();var F=mstrmojo.desc,N=mstrmojo.expr,A=mstrmojo.hash;var B;function G(E){return E.datasets;}function H(U){var P=G(U),T=[],W={},E;for(E in P){var Q=P[E],Y=Q.name,X=O([].concat(Q.mx).concat(Q.att)),S=X.length,R;for(R=0;R<S;R++){var V=X[R];V.dsdid=E;V.path=Y;if(!W[V.did]){W[V.did]=V;}}}T=A.valarray(W);return{items:T,isComplete:true,bc:-1};}function O(E){return mstrmojo.array.filter(E,function(P){return P.st!==N.STP.CONS&&P.st!==N.STP.CUSTOMGROUP&&P.did!==B.metricId;});}function I(){return mstrmojo.all.mstrMetricIDE;}mstrmojo.ME.DerivedMetricIDE=mstrmojo.declare(mstrmojo.ME.MetricIDE,null,{scriptClass:"mstrmojo.ME.DerivedMetricIDE",isDME:true,noCache:false,disableAFB:false,getEditorScriptClass:function J(E){return{mstrFE:"mstrmojo.ME.DerivedFunctionWizard",mstrSME:"mstrmojo.ME.DerivedSimpleMetricEditor",mstrME:"mstrmojo.ME.DerivedFormulaMetricEditor",mstrRFE:"mstrmojo.ME.DerivedRankEditor",mstrOFE:"mstrmojo.ME.DerivedOLAPEditor"}[E];},filterFunctions:function K(R){var Q=mstrmojo.ME.MetricDataService.getDataMiningCatIndex(R),E=Q>-1?R[Q].did:"";var P={"1762CA4760014C78B365C868019C6F3E":"HistogramMedian"};return mstrmojo.array.filter(R,function(S){if(S.did!==E){var T=S.fns;S.fns=mstrmojo.array.filter(T,function(U){return(!U.idbo&&U.ip)&&!P[U.did];});return S;}});},onOpen:function D(){this.set("datasets",G(this));this.set("dsUnits",H(this));this.set("feParamItemsPath","mstrmojo.all.mstrMetricIDE.dsUnits.items");this.set("candidates",H(this));if(this._super){this._super();}},init:function L(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"dme");B=this;},setExtraMetricTokens:function M(E){if(mstrmojo.string.isEmpty(E.n)){E.n=this.action.n||mstrmojo.desc(2213,"New Metric");}E.alias=E.alias||this.action.alias;},setRefOi:function(E){E.refOi=this.action&&this.action.refOi;},renderObjectsBrowser:function C(){var E=this.datasetsObjects;if(E){E.alias="ob";E.bindings={visible:function(){return mstrmojo.all.mstrME.visible;}};E.onvisibleChange=function(){if(this.visible){var P=this;window.setTimeout(function(){if(P.doLayout){P.doLayout();}},50);}};E.doubleClickItemHandler=function(P){I().onObjectInsert(P);};this.getBrowsersContainer().addChildren([E]);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.MetricIDE","mstrmojo.ME.DerivedAttributeEditor","mstrmojo.ME.DynamicLinkEditor","mstrmojo.ME.AttributeEditBox","mstrmojo.ME.BandingDAEditor","mstrmojo.ME.MetricDataService");mstrmojo.requiresDescs(11404,2870,11616,11618,12199,9826,9571);var I=mstrmojo.desc,L=mstrmojo.array,S=mstrmojo.hash,F=mstrmojo.dom,Z=mstrmojo.expr,D="daObjectBrowsers",U=1,H=0;function Q(g){return g.action.datasets||g.view.docModel.datasets;}function P(p){var m=p.fs||[],o=0,l=0,r=0,n=1,q=8,k=3,g=2,h=mstrmojo.ME.DerivedAttributeIDE;mstrmojo.array.forEach(m,function(t){switch(t.bftp){case n:case q:r++;break;case k:o++;break;case g:l++;break;}});if(r){return h.FUNC_CATEGORY_DATE;}if(l&&m.length===l){return h.FUNC_CATEGORY_BASIC;}return h.FUNC_CATEGORY_STRING;}function c(h){var k=mstrmojo.ME.DerivedAttributeIDE,l=mstrmojo.ME.MetricDataService,g=h.browsersContainer.funcBrowser;if(g){g.postfunctionsChange=function(){var n=h.action||{},p=n.funccat||k.FUNC_CATEGORY_STRING,o=this.functions,m;switch(p){case k.FUNC_CATEGORY_BASIC:m=l.getBasicCategoryIndex(o);break;case k.FUNC_CATEGORY_DATE:m=l.getDateTimeCategoryIndex(o);break;default:m=l.getStringCategoryIndex(o);break;}this.set("selectedCategory",m+1);};}}function V(h,g){return !(h.um||h.rdm||h.t===48||(h.t===47&&h.st===12033)||h.did===g);}function K(q,w,r){var l=Q(q),p={},n=q.action,h=n.did,m,g,v,t=function(z){var x=false;L.forEach(z.att,function(AB){var AD=(AB.t===1||AB.t===47),AA=(AB.t===47&&AB.st===12033),AC=(AB.t===12&&AB.de);x=(AD&&!AA||AC);if(x){return false;}});return x;},k=function(x){if(!V(x,h)){return ;}x.dsdid=g;x.path=v;p[x.did]=x;if(!w){L.forEach(x.fs,function(z){if(z.obf||x.da){z.path=v;z.attid=x.did;z.attn=x.n;z.did=z.fmdid=z.fid;z.n=z.fnm;p[z.attid+"@"+z.did]=z;}});}};var o=[];var u;for(g in l){m=l[g];if(t(m)||(m.isMDX&&m.isDDA)){continue;}v=m.name;u=[].concat((r||m.isMDX)?[]:m.mx).concat(m.att);o=o.concat(u);L.forEach(u,k);}return{all:o,items:S.valarray(p),isComplete:true,bc:-1};}function J(g){var h={isComplete:true,items:[]};h.items.push({n:"This",did:"This",t:12,fs:[{fnm:"ID",fid:"ID",t:21}]});if(!g){h.items.push({n:"ID",did:"ID",attid:"This",attn:"This",fnm:"ID",t:21});}return h;}function d(m){var h=m.datasetsObjects,o=mstrmojo.insert({scriptClass:"mstrmojo.StackContainer",cssClass:"mstrmojo-DA-obContainer",id:D,alias:"ob",children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-DA-obDESC",visible:false,initWarning:function n(){var p=this;p.thisid.showInfo(document.getElementById("DA_THIS_ID"));window.setTimeout(function(){p.thisid.hideInfo();},3000);},children:[{scriptClass:"mstrmojo.Label",text:I(2870,"Objects")},{scriptClass:"mstrmojo.ListBase",cssClass:"mstrmojo-VIUnitList",alias:"thisid",draggable:true,itemField:"n",items:[{n:"This@ID"}],ondblclick:function(){m.onObjectInsert(this.items[0]);},getDragData:function l(){var q=this.items[0],p='<div class="mstrmojo-VIUnitList"><div class="item unit ic21" ><span>'+q.n+"</span></div></div>";return{item:q,html:p};},showInfo:function k(q){var t=mstrmojo.dom.position(q,false),r=this,p=r._autoCloseFn=function(v){var u=self,w=r.tooltip;if(w&&!F.contains(w.domNode,F.eventTarget(u,v),true,document.body)){r.hideInfo();}};r.richTooltip={posType:mstrmojo.tooltip.POS_TOPRIGHT,content:I(11618,"You can define this and additional DESC forms based on the current attribute ID."),contentNodeCssClass:"dae-desc-info me-tooltip-content regular up",left:t.x+32,top:t.y+20};r.hasOpenTooltip=false;r.showTooltip();F.attachEvent(document.body,"mousedown",p,true);},hideInfo:function g(){m.hideTooltip();if(this._autoCloseFn){F.detachEvent(document.body,"mousedown",this._autoCloseFn,true);delete this._autoCloseFn;}},itemRenderer:{render:function(r,p,q){return'<div class="item unit ic21" ><span>'+r.n+'</span><div id="DA_THIS_ID" class="tidinfo" onclick="mstrmojo.all[\''+q.id+"'].showInfo(this)\" ></div></div>";}}}]}]});if(h){o.addChildren([h]);o.set("selected",h);}return o;}function M(o,h,n,l,m,g){var k=function(p){if(p.vs!==0){mstrmojo.alert(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),null,mstrmojo.desc(9571,"Syntax Error!"));return ;}var q;if(h){q={act:"updateDA",name:n,dsid:o,attrId:h,isTokenStream:true,update:[{did:l,formula:p.tokenXML}]};}else{q={act:"addDAToDataset",dsid:o,name:n,isTokenStream:true,forms:[{n:"ID",formula:p.tokenXML}]};}g(q);};mstrmojo.ME.AttributeEditBox.validateSyntax(h,m,true,k);}mstrmojo.ME.DerivedAttributeIDE=mstrmojo.declare(mstrmojo.ME.MetricIDE,null,{scriptClass:"mstrmojo.ME.DerivedAttributeIDE",id:"mstrDerivedAttrIDE",noCache:false,isDME:true,title:I(11616,"Attribute Editor"),formulaEditorId:"mstrDAE",nameLabel:I(12199,"Attribute Name:"),hasFunctionBrowser:true,getEditorScriptClass:function E(g){return{mstrFE:"mstrmojo.ME.DerivedFunctionWizard",mstrSME:"mstrmojo.ME.SimpleMetricEditor",mstrDAE:"mstrmojo.ME.DerivedAttributeEditor",mstrBDAE:"mstrmojo.ME.BandingDAEditor",mstrDLE:"mstrmojo.ME.DynamicLinkEditor"}[g];},isBanding:function R(g){return mstrmojo.ME.MetricDataService.isBanding(g);},isObjectVisible:V,filterFunctions:function e(k){var h=mstrmojo.ME.MetricDataService.getDataMiningCatIndex(k),g=h>-1?k[h].did:"";return mstrmojo.array.filter(k,function(l){if(l.did!==g){var m=l.fns;l.fns=mstrmojo.array.filter(m,function(n){return(!n.idbo&&n.ip&&n.sqt===3);});return l.fns.length>0;}});},getTokenInputBox:function B(){return mstrmojo.all.mstrDAE.attrEditBox.inputBox;},onObjectInsert:function(g){mstrmojo.all.mstrDAE.onObjectInsert(g);},onOpen:function G(){this.set("datasets",Q(this));this.set("dsUnits",K(this,true));this.set("candidates",K(this));this.set("feParamItemsPath","mstrmojo.all.mstrDerivedAttrIDE.dsUnits.items");this.set("funcsPath","mstrmojo.all.mstrDerivedAttrIDE.functions");this.set("candidatesPath","mstrmojo.all.mstrDerivedAttrIDE.candidates");this.browsersContainer.funcBrowser.set("includeFakeFuncs",false);if(!this.hasFunctionBrowser){this.set("attrCandidates",K(this,false,true));this.browsersContainer.funcBrowser.set("visible",false);this.funcSyntaxDesc.set("visible",false);}var g=this.browsersContainer.ob,h=g&&g.children[U];if(h){g.set("selected",h);h.refresh();if(h.doLayout){window.setTimeout(function(){h.doLayout();},50);}}if(this._super){this._super();}if(this.editorId==="mstrDLE"){this.set("title",mstrmojo.desc(14718,"Link Editor")+" - "+(this.action.n||"New Link"));}else{this.set("title",mstrmojo.desc(11616,"Attribute Editor")+" - "+(this.action.n||mstrmojo.desc(11404,"New Attribute")));}},renderObjectsBrowser:function b(){var g=mstrmojo.all[D]||d(this);this.getBrowsersContainer().addChildren([g]);},onformsTabSwitch:function f(h){var l=this.browsersContainer.ob,k=(h&&h.nidx)||0,g=l&&l.children[k>=1?H:U];mstrmojo.css.toggleClass(l.domNode," show-all",k>0);if(g){l.set("selected",g);if(h.toNewTab){g.initWarning();}}this.set("dsUnits",k===0?K(this,true):J(true));},isExpEditor:function Y(g){return g==="mstrDAE";},configInlineEditor:function N(h){var g=this.action;h.paramItemsPath=this.feParamItemsPath;h.oncreate=g.oncreate;h.onupdate=g.onupdate;},postBuildRendering:function a(){if(this._super){this._super();}c(this);mstrmojo.css.addClass(this.editorNode,"mstrmojo-DA-IDE");if(!this.hasFunctionBrowser){mstrmojo.css.addClass(this.editorNode,"hideFuncBrowser");}},setRefOi:function(g){g.refOi=this.action&&this.action.refOi;},getEditorId:function W(h){var m=h.oi,n=m.forms&&m.forms.length,k,g,l;if(n===1){k=m.forms[0];g=k.met;m.tks={items:k.ftk,met:k.met};}if(!h.id&&mstrmojo.ME.BandingDAEditor.showAsBandingEditor(m)){l="mstrBDAE";}else{l=h.id||{65536:"mstrDAE",196608:"mstrFE"}[g]||"mstrDAE";}h.id=l;return l;},getEditorHelpTopic:function X(h){var g=mstrApp.isSingleTier?{mstrDLE:"creating_a_grid_visualization.htm"}:{mstrDLE:"creating_a_grid_visualization_html5.htm#dynamic-link"};return g[h]||"derived_attribute_editor.htm";},showAsSimpleIDE:function C(g){var h=g.forms&&g.forms.length;return(h===1||mstrmojo.ME.BandingDAEditor.showAsBandingEditor(g))&&parseInt(g.forms[0].met,10)!==mstrmojo.ME.ENUM.METRIC_EDIT_TYPES.ADVANCED;},oneditorConfigChange:function T(){var h=this.editorConfig,g=h.cfg,k=g.oi||{},l=k.forms&&k.forms.length;if(k.tks&&l===1){k.forms[0].ftk=k.tks.items;}this._super();},getValidFuncParamTypes:function O(g){var h=[Z.TP.METRIC];if(!g||g.sqt===1||g.sqt===3){h.push(Z.TP.ATTR);}return h;},validateAndSave:function A(n,l){var m=this,g=m.action,o=g.dsid,k=(n.forms&&n.forms[0])||{},h=function(q){l();m.close();var p=n.did?g.onupdate:g.oncreate;if(p){p(q);}};M(o,n.did,n.n,k.did,n.tks,h);},loadObjectDefn:function(q){var o=this.action,k=o.n,h=o.did,l,p=0,g=[],n=o.msgID,m=function(r){var t=l[p-1];if(r&&r.tks&&t){g.push({did:t.fid,n:t.fnm,k:t.fid,ftk:r.tks.items,met:r.tks.met,vs:1,is:""});}if(p===l.length){q.success({n:k,did:h,forms:g,dsid:o.dsid,alias:o.alias});return ;}t=l[p++];mstrmojo.ME.MetricDataService.validateMetric({metricId:h,formID:t.fid,objectType:12,tokenStreamXML:"",metricXML:"",msgID:n},{success:m});};if(h){l=o.forms;m();}else{q.success({n:k||mstrmojo.desc(11404,"New Attribute"),dsid:o.dsid});}}});mstrmojo.ME.DerivedAttributeIDE.FUNC_CATEGORY_BASIC=1;mstrmojo.ME.DerivedAttributeIDE.FUNC_CATEGORY_DATE=2;mstrmojo.ME.DerivedAttributeIDE.FUNC_CATEGORY_STRING=3;mstrmojo.ME.DerivedAttributeIDE.getDefaultFunctionCategory=P;}());(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.expr","mstrmojo.NumberFormat","mstrmojo.Button","mstrmojo.CustomGroupEditor","mstrmojo.ME.MetricIDE","mstrmojo.SharingEditor");var N=mstrmojo.dom,J=mstrmojo.expr,F=J.STP,C=256;var E=mstrmojo.mstr.EnumDSSXMLObjectTypes;var G={ExecuteCubeReport:"web-execute-cube-report",CreateAnalysis:"create-analysis"};function L(Q,O,S,P){var R=mstrApp.sessionManager;if(R&&R.sessionTimedout){R.openLoginEditor({success:function(){if(P!=="_blank"){mstrApp.showWait();}mstrmojo.form.send(Q,O,S,P);}});}else{if(P!=="_blank"){mstrmojo._IsWebApp.showWait({message:mstrmojo.desc(97,"Executing...")});}mstrmojo.form.send(Q,O,S,P);}}function M(O){L(O,null,"post");}mstrmojo.mstr._ObjectActions=mstrmojo.provide("mstrmojo.mstr._ObjectActions",{_mixinName:"mstrmojo.mstr._ObjectActions",execute:function I(c,P){mstrmojo.hash.copy(mstrApp.searchAppFeatures,mstrApp.features);var R=mstrApp.features;var a=mstrApp.name;var U=parseInt(c.tp||c.t,10),Z=parseInt(c.stp||c.st,10),f=c.et&&parseInt(c.et,10),g=c.dssid||c.did,b=c.viewMedia||c.dvm,X=c.visMode||0,d={};switch(U){case E.Filter:switch(Z){case 256:d={evt:3113,filterID:g,src:a+".3113"};break;case 257:this.openCustomGroupEditor(c,P);return ;}break;case E.Metric:this.openMetricEditor(c,P);return ;case E.Folder:d={evt:2001,folderID:g,src:a+".2001"};break;case E.ReportDefinition:if(this.designMode){d={evt:3005,src:a+".3005",reportID:g,reportDesignMode:this.designMode};break;}var e=1;switch(Z){case F.REPORT_CUBE:case F.REPORT_EMMACUBE:if(!mstrApp.features[G.CreateAnalysis]){return ;}var T=!R.IE9Pre||R.IE9Pre&&(R["run-vi-flash"]||R["run-vi-smart"]);if(T){var Q=R.flashvi?"analysis":"HTML5VI";B.convertFromCube({st:Z,type:Q,did:g,folderId:H(c),et:f});}else{mstrmojo.alert(mstrmojo.desc(12187,"Please upgrade your browser or turn off Internet Explorer Compatibility View to work with HTML5 dashboards."));}return ;case F.REPORT_GRID:e=1;break;case F.REPORT_GRAPH:e=2;break;case F.REPORT_GRIDGRAPH:e=3;break;}d={reportID:g,evt:4001,src:a+".4001",visMode:X,reportViewMode:e};break;case E.DocumentDefinition:var W={Reserved:0,ViewStatic:1,ViewInteractive:2,ViewEditable:4,ViewFlash:8,ExportExcel:16,ExportPDF:32,ExportHTML:64,ExportFlash:128,ExportExcelPlainText:256,ExportCSV:512,ExportPlainText:1024,ViewAnalysis:2048,HTML5Dashboard:8192,All:134217727},O={DATA:1,DESIGN:2,PDF:3,EXCEL:4,SAVE:5,DETAILS:6,FLASH_EXPORT:7,FLASH_VIEW:8,FLASH_BINARY_VIEW:9};var Y={};Y[W.ExportPDF]=O.PDF;Y[W.ExportExcel]=O.EXCEL;Y[W.ExportFlash]=O.FLASH_EXPORT;var S={};S[W.ViewStatic]=2048001;S[W.ViewInteractive]=2048001;S[W.ViewEditable]=2048001;S[W.ExportHTML]=3130;S[W.ExportExcel]=3069;S[W.ExportFlash]=3069;S[W.ExportPDF]=3069;S[W.ViewAnalysis]=2048001;S[W.HTML5Dashboard]=3140;var V=2048001;if(Z===14081){if(this.designMode){V=3104;d={evt:V,objectID:g,src:a+"."+V,rwDesignMode:this.designMode,executionMode:2};}else{if(b>8){V=S[b];d={evt:V,documentID:g,src:a+"."+V};if(b===W.HTML5Dashboard){if(N.ISDXIE&&!N.isIE9){mstrmojo.alert(mstrmojo.desc(12187,"Please upgrade your browser or turn off Internet Explorer Compatibility View to work with HTML5 dashboards"));return false;}}else{d.executionMode=Y[b]||0;}}else{V=2048001;d={evt:V,documentID:g,src:a+"."+V,visMode:X||0,currentViewMedia:b||2};}}}else{if(Z===14080){d={evt:32001,documentID:g,src:a+".32001"};}}break;case E.Prompt:d={evt:3119,objectID:g,promptType:c.pt,src:a+".3119"};break;default:return false;}M(d);},openCustomGroupEditor:function(U,W){var R=U.did;var P="mstrCGE",T=mstrmojo.all[P],V=function(X){if(!T){return ;}X.scriptClass="mstrmojo.Obj";T.set("model",mstrmojo.insert(X));T.open();},Q=function(){var X={success:function(Y){if(!Y){mstrmojo.alert("Error retrieving the Custom Group definition!");return ;}V(Y);},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,X,{taskId:"getCustomGroup",customGroupId:R,styleName:"MojoCustomGroupStyle"});},S=function(){V({cgp:{agg:1,flat:false,pf:true,rfi:-1,ce:true,isp:true}});},O=R?Q:S;if(!T){T=mstrmojo.insert(mstrmojo.CustomGroupEditor);T.set("noRefresh",true);if(W&&W.zIndex){T.set("zIndex",W.zIndex);}}O();},openMetricEditor:function(Q,O){var P=Q.did;var S="mstrMetricIDE",R=mstrmojo.all[S];if(!R){R=mstrmojo.insert({scriptClass:"mstrmojo.ME.MetricIDE",id:S,metricId:P,noRefresh:true});if(O&&O.zIndex){R.zIndex=O.zIndex;}}else{R.set("metricId",P);}R.open(null,{action:{cmd:P?"edit":"add"}});},openDataImport:function(){K({});},createFilter:function(){var O={evt:3113,src:(mstrApp.servletName||mstrApp.name)+".3113",isNew:true};L(O);},createDashboard:function(){var P=!mstrmojo.resolveFeature("flashvi"),O={evt:3187,src:(mstrApp.servletName||mstrApp.name)+".3187"};if(P&&mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(12187));return false;}if(P&&mstrApp.currentFolderId){O.parentFolderId=mstrApp.currentFolderId();}L(O);},openSharingEditor:A});var B={isCubeSupportDDA:function(O){return !!(O&&(O.dda===1||O.dda===3));},allowCreateReport:function(O){if(O&&O.ddam===2){mstrmojo.alert(mstrmojo.desc(13384,"The 'Create Report' option is currently not available for Live Connection Datasets."));}return true;},getCubesInfo:function(O,P){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Q){P(Q);}},{taskId:"getUserDICubeInfo",cubeIds:O.join(",")});},convertFromCube:function(P){var S=this,R=P.type,O=P.did,Q=P.folderId;this.getCubesInfo([O],function(U){var V=U[O],Z=mstrApp.name,Y=(V&&!V.published&&S.isCubeSupportDDA(V)),X=!!Y?128:0,W={};if(V&&V.ddam!==2&&!V.published){mstrmojo.confirm(mstrmojo.desc(14111,"This cube has not been published"),{confirmBtn:{t:mstrmojo.desc(9242,"Republish"),fn:function T(){if(P.st===779&&(P.et&C)>0){K({CubeDesc:"",CubeName:P.executeReport,ReportId:O,folderId:Q,StatusCode:2,isEdit:false,callback:function(){S.convertFromCube(P);}});}else{var a={evt:4001,src:mstrApp.name+".4001",reportID:O,visMode:0,reportViewMode:1};M(a);}}}});return ;}switch(R){case"document":W={evt:"3104",src:Z+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:O,rwCreateFlags:0};if(Q){W.saveFolderId=Q;}break;case"analysis":W={evt:"3104",src:Z+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:O,rwCreateFlags:16,rwViewMode:8192};break;case"HTML5VI":W={evt:"3185",src:Z+".3185",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:O,rwCreateFlags:32};if(Q){W.saveFolderId=Q;}break;case"report":if(!S.allowCreateReport(V)){return ;}W={evt:"3005",src:Z+".3005",srcID:O,srcType:2,reportDesignMode:1};break;}if(typeof W.rwCreateFlags==="number"){W.rwCreateFlags|=X;}M(W);});}};function H(Q){if(Q.fdid){return Q.fdid;}var O=Q.anc&&Q.anc.items||[],P=O[O.length-1];return P&&P.did;}function D(P){var O=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Q){if(Q){var S=Q.descriptors.length,R;for(R=0;R<S;R++){var T=Q.descriptors[R];mstrmojo.descriptors[T.key]=T.v;}}if(P.callback){P.callback();}},failure:function(){if(P.callback){P.callback();}}},{taskId:"getBundleDescriptors",bundle:P.bundle});};O();}function K(Q){var R=Q.folderId,S=this;mstrmojo._IsWebApp.showWait();var P=function(){var U;if(S.dataImportId){U=mstrmojo.all[S.dataImportId];}if(!U){O();mstrmojo.requiresBundle("mojo-di.js");U=mstrmojo.insert({scriptClass:"mstrmojo.DI.DIContainer"});U.dataImportCallback=function(V){var W=document.getElementById("formRefresh");if(W&&V&&V.length>0){W.submit();}};S.dataImportId=U.id;}if(Q){mstrmojo.hash.copy(Q,U.dataImportParams);if(Q.callback){U.dataImportCallback=function(V){Q.callback(V);};}else{if(Q.isCalledByFlex){U.dataImportCallback=function(W){if(W&&W.length>0){var V;if(navigator.appName.indexOf("Microsoft")!==-1){V=window.MstrFlashFlashViewer;}else{V=document.MstrFlashFlashViewer;}if(V){V.onCloseDI(W);}}};}}}if(R){mstrmojo.hash.copy({cubeSaveFolderId:R},U.dataImportParams);}U.open();mstrmojo._IsWebApp.hideWait();};var T=function(){var V={success:function(W){if(W){P();}else{if(mstrApp.onSessionExpired){mstrApp.onSessionExpired();}}}},U={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,U);};var O=function(){var U="data-import.css";if(N.isIE8||N.isIE9){U="data-import-ie.css";}var V=document.createElement("link");V.rel="stylesheet";V.href="../javascript/mojo/css/"+U;V.type="text/css";document.head.appendChild(V);};if(!this.dataImportId){D({bundle:"mojo-di",callback:T});}else{T();}}function A(Q,Y,P,V){var U="sharingEditor",O=mstrApp.oi,T=(Y&&Y.objId)||O.objId,R=(Y&&Y.objType)||O.objType,X=(Y&&Y.mid)||mstrApp.getMsgID&&mstrApp.getMsgID(),W=V&&V.showLinkOnOpen,Z=function(c){var b=mstrmojo.all[U];if(!b){V=V||{};c.acls=V.acls||c.acls;b=mstrmojo.insert(mstrmojo.hash.copy(V,{scriptClass:"mstrmojo.SharingEditor",guestModeEnabled:mstrApp.guestModeEnabled,mid:X,id:U,oi:c,href:Q,isLinkDirty:P,viewMode:Y?Y.viewMode:1,lastState:Y?Y.lastState:0,showWait:function(){mstrApp.showWait();},hideWait:function a(){mstrApp.hideWait();},onClose:function(){this.destroy();}}));}else{b.set("oi",c);b.href=Q;b.mid=X;b.isLinkDirty=P;b.viewMode=Y?Y.viewMode:1;b.lastState=Y?Y.lastState:0;b.showLinkOnOpen=W;}b.open();},S=function(){var a={success:function(b){Z(b.objects[0]);},failure:function(b){mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){mstrApp.hideWait();}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,a,{taskId:"getObjectInfo",objectIDs:T,objectTypes:R,includeACL:mstrmojo.resolveFeature("web-use-sharing-editor"),sessionState:mstrApp.sessionState});};mstrApp.showWait();S();}}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.string","mstrmojo.Container","mstrmojo.WidgetList","mstrmojo.mstr._ObjectActions");mstrmojo.requiresDescs(3364,3366,9202);var H=mstrmojo.desc,C=mstrmojo.css,D=mstrmojo.string.escape4HTMLText;mstrmojo.mstr.search.SearchIconView=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo.mstr._ObjectActions],{scriptClass:"mstrmojo.mstr.search.SearchIconView",init:function G(I){this._super(I);C.addWidgetCssClass(this,"mstrmojo-SearchIconView");},itemFunction:function A(L,I,J){var K=new mstrmojo.mstr.search.SearchIconItem({parent:J,idx:I,data:L});J.attachListener4ItemWidget(K,J);return K;},attachListener4ItemWidget:function F(L,M){var J=["ItemExecute"],I=J.length,K;for(K=0;K<I;K++){L.attachEventListener(J[K],M.id,"itemEventHandler");}return L;},itemEventHandler:function(I){var K=I.name,J=I.data;switch(K){case"ItemExecute":this.execute(J,{zIndex:mstrmojo.mstr.search.Search.zIndex+2});break;}}});mstrmojo.mstr.search.SearchIconItem=mstrmojo.declare(mstrmojo.Container,[],{scritpClass:"mstrmojo.mstr.search.SearchIconItem",markupString:'<div class="mstrmojo-SearchIconItem" mstrAttach:click ><i class="mstrIcon-lg" data-role="icn"></i><div class="ttl" data-role="ttl"></div><div class="owner" data-role="owner"><label>'+H(3364,"Owner:")+'</label><span></span></div><div class="modified" data-role="mdt"><label>'+H(3366,"Modified:")+'</label><span></span></div><div class="desc" data-role="desc"></div></div>',markupSlots:{iconNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.childNodes[1];},ownerNode:function(){return this.domNode.childNodes[2].lastChild;},modifiedNode:function(){return this.domNode.childNodes[3].lastChild;},descNode:function(){return this.domNode.lastChild;}},markupMethods:{ondataChange:function(){var I=this.data||{},J=I.desc||"";C.addClass(this.iconNode,this.getIconCls(I));this.titleNode.innerHTML=D(I.n);this.ownerNode.innerHTML=D(I.owner);this.modifiedNode.innerHTML=D(I.mdt);this.descNode.innerHTML=this.allowHTMLOnObjectDesc?J:D(J);}},data:{},getIconCls:function E(I){I=I||this.data;return"t"+I.t+(I.st?" st"+I.st:"")+(I.isc?" isc":"")+(I.dvm?" dvm"+I.dvm:"");},onclick:function B(I){var K=I.getTarget(),J=(K.dataset&&K.dataset.role)||K.getAttribute("data-role");if(J==="icn"||J==="ttl"){this.raiseEvent({name:"ItemExecute",data:this.data});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.menus.MenuConfig","mstrmojo.mstr.ui.EnumWebPromptsList","mstrmojo.form","mstrmojo.IVEDatasetPicker","mstrmojo.mstr.MDXCubeBrowser","mstrmojo.NewFolderEditor","mstrmojo.mstr._ObjectActions","mstrmojo.mstr.ui.MstrFileUploadHelper");var D=mstrmojo.tstid;var B={BLANK:"05B202B9999F4C1AB960DA6208CADF3D",XDA:"1ADEAA2C4754E2DE5DFEC08022DAFDC6",ICUBE:"DB8D5B064BBE3C24F541DAA81A507FDC"};function C(N,L,O,M){if(window.iframe){window.iframe.showWaitPage(true);}mstrmojo.form.send(N,L,O,M);}function H(L){if(mstrApp.currentFolderId){L.saveFolderId=mstrApp.currentFolderId();}}function E(N,R){function P(Z){function a(c){if(c){C(c.params,null,"post");}}var X=Z.config;if(Z.config.did===B.ICUBE){var b="mstr-create-objectExpl",Y=mstrmojo.all[b];if(!Y){Y=new mstrmojo.IVEDatasetPicker({id:b,cssClass:"mstr-create-menu-cubePicker",title:mstrmojo.desc(4354,"Select Intelligent Cube"),help:"Select_Intelligent_Cube_dialog_box.htm",onOk:function(){X.params={evt:3005,src:T+".3005",srcType:2,srcID:this.item.did,reportDesignMode:1,name:"editReport"};H(X.params);a(X);},onCancel:function(){Y.close();},onRender:function(){var e=false,d=this;this.btnImport.set("visible",e);this.newLabel.set("visible",e);this.useExistingLabel.set("visible",e);this.ob.set("scrollableIncFetch",false);this.btnHBox.destroyChildren();var c=mstrmojo.Button.newWebButton(mstrmojo.desc(547,"Select"),function(){if(this.enabled){d.onOk();d.onCancel();}},true);c.bindings={enabled:function(){return this.parent.parent.multiSelect?!!this.parent.parent.selectedItems.length:!!this.parent.parent.item;}};this.btnHBox.addChildren([c,mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function(){d.onCancel();},false)]);}});}if(X.title){Y.set("title",X.title);}if(X.cssClass){Y.set("cssClass",X.cssClass);}Y.open();}else{if(Z.config.did===B.XDA){(new mstrmojo.mstr.MDXCubeBrowser({onClose:function(){this.destroy();},onOK:function(c){var d={evt:3005,src:(mstrApp.servletName||mstrApp.name)+".3005",srcType:1,srcID:c.did,reportDesignMode:1};H(d);C(d);}})).open();}else{if(X.did){a(X);}}}if(Z.menuOpener.createMenu&&Z.menuOpener.createMenu.close){Z.menuOpener.createMenu.close();}return true;}function S(a,X){var Z=a.config,Y='<a class="mstrMenuItem subMenuItem '+Z.name+' {@cls} {@newGroup}" idx="{@idx}" value="'+Z.value+'"title="'+Z.desc+'"><span class=""></span><span class="label">{@n}</span></a>';return Y;}var L=this,O=mstrmojo.hash.clone(R||L.createMenuData.rl),T=mstrApp.servletName||mstrApp.name;for(var Q=0;Q<O.length;Q++){if(O[Q].did===B.BLANK){var M=O[Q];O.splice(Q,1);O.splice(0,0,M);continue;}if(O[Q].did===B.XDA||O[Q].did===B.ICUBE){var M=O[Q];O.splice(Q,1);O.splice(1,0,M);continue;}}for(var Q=0;Q<O.length;Q++){var U=false;var V=O[Q].did;if(V===B.ICUBE){if(mstrmojo.resolveFeature("web-define-view-report")){U=true;}}else{U=true;if(!mstrmojo.resolveFeature("template-reports")||(V===B.BLANK&&(!mstrmojo.resolveFeature("design-mode")||!mstrmojo.resolveFeature("modify-report-list")))||(V===B.XDA&&(!mstrmojo.resolveFeature("dhtml")||!mstrmojo.resolveFeature("web-define-view-report")||!mstrmojo.resolveFeature("define-query-report-builder")))){U=false;}}if(!U){continue;}var W;if(O[Q].t===8){W=J(O[Q],L,N,E);}else{W=N.addCustomMenuItem(O[Q].n,"",P,S);O[Q].params={reportID:O[Q].did,blank_reportDesignMode:1,reportDesignMode:4,evt:3005,src:T+".3005",reportViewMode:1,promptStyle:"PromptsTransformCreateReport",promptsExecuteStyle:"PromptsTransformClassicSave",promptsCreateStyle:""};H(O[Q].params);if(O[Q].did===B.BLANK){O[Q].params.reportDesignMode=1;}W.config=O[Q];W.menuOpener=L;}}}function A(O){function T(W){var X={DssXmlViewMediaViewStatic:1,DssXmlViewMediaViewInteractive:2,DssXmlViewMediaViewEditable:4};var V=X.DssXmlViewMediaViewStatic;if(W!==0){if((W&X.DssXmlViewMediaViewEditable)>0){V=X.DssXmlViewMediaViewEditable;}else{if((W&X.DssXmlViewMediaViewInteractive)>0){V=X.DssXmlViewMediaViewInteractive;}else{if((W&X.DssXmlViewMediaViewStatic)>0){V=X.DssXmlViewMediaViewStatic;}}}}return V;}var N=this,Q=N.createMenuData.dl,U=N.createMenuData.docList,R=mstrApp.servletName||mstrApp.name;function P(V){var X="";if(!V){return X;}for(var W=0;W<V.length;W++){X+='<a title="'+V[W].n+" - "+V[W].desc+'" id = vt_'+V[W].did+' class="dashboardStyleTemplate mstrMenuItem subMenuItem" idx="{@idx}" rwviewmode = "'+T(V[W].avm)+'" data-id = "'+V[W].did+'"></a>';}return X;}function M(V){if(!V){return"";}var X="";for(var W=0;W<V.length;W++){X+='<a class="mstrMenuItem subMenuItem {@cls}" title = "'+V[W].desc+'" idx="{@idx}" data-id = '+V[W].did+' rwviewmode = "'+T(V[W].avm)+'" >'+V[W].n+"</a>";}return X;}function L(){var X='<div class = "mstr-dashboard-subMenu dashboardTemplates">'+P(Q)+"</div>";var W='<div class = "mstr-dashboard-subMenu docList" >'+M(U)+"</div>";var V="";if(Q){V+=X;}if(U){V+="<hr>"+W;}return V;}function S(W,V){var X={blank_rwDesignMode:1,rwDesignMode:1,evt:3104,src:R+".3104",createDocument:"*-1.*-1.0.0.0"};X.rwViewMode=V._evtTarget.getAttribute("rwviewmode");X.objectID=V._evtTarget.getAttribute("data-id");H(X);C(X,null,"post");return true;}O.addCustomMenuItem("DashDoc Templates","",S,L);}function G(S){function R(T){C(T.config.params);return true;}function L(V,T){var U=V.config;return"<a "+D(U.name+"Item")+' class="mstrMenuItem subMenuItem '+U.name+' {@cls} {@newGroup}" idx="{@idx}" value="'+U.value+'"><span class=""></span><span class="label">{@n}</span></a>';}var M=mstrmojo.mstr.ui.EnumWebPromptsList.get();for(var N=0;N<M.length;N++){var Q=M[N],P=mstrmojo.desc(Q.descId)||Q.n,O=S.addCustomMenuItem(P,"",R,L);O.config=Q;}}function J(N,Q,L,M){if(!N.items&&!N.loading){N.loading=true;var P=new mstrmojo.SimpleXHR({async:false});P.request("POST",mstrConfig.taskURL,{success:function O(S){var T=S.items||[];if(T.length===0){T.push({n:mstrmojo.desc(3693,"(None)")});}N.items=T;delete N.loading;}},{folderID:N.did,taskId:"folderBrowse",styleName:Q.folderBrowsingStyle,includeObjectDesc:true});}return L.addPopupMenuItem(N.n,"",function R(){var S=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstr-create-menu"});M.call(Q,S,N.items);return S;});}function I(M){var N=this,L=M;return function(){var O=mstrmojo.insert({scriptClass:"mstrmojo.ui.menus.MenuConfig",menuCssClass:"mstr-create-menu",hostProxyCssClass:"mstrmojo-create-menu-host",tstid:M+"Sbm"});switch(L){case"template":E.call(N,O);break;case"templateDoc":O.menuCssClass=O.menuCssClass+" mstr-dashboard-subMenu collapse";A.call(N,O);break;case"prompt":G.call(N,O);break;}return O;};}function F(X){var M=this,R=M.createMenuData.sl;var Y=mstrmojo.all["mscld-create-menuList"],T=mstrApp.servletName||mstrApp.name;if(!Y){var U=mstrmojo.insert({scriptClass:"mstrmojo.ui.menus.MenuConfig",menuCssClass:M.cssClassName+" collapse",hostProxyCssClass:M.hostCssClassName,anchorElement:X.domNode,hostId:X.id,isHostedWithin:false,includeScroll:false,tstid:"createMenu"});if(M.alignMenuToRight){U.setAlignment(mstrmojo.ui.PopupConfig.ENUM_CORNERS.BOTTOM_RIGHT,mstrmojo.ui.PopupConfig.ENUM_CORNERS.TOP_RIGHT);}function S(e,b){var d=e.config;var c="<a "+D(d.name+"Item")+' class="mstrMenuItem '+d.name+' {@cls} {@newGroup}" idx="{@idx}" onclick=" mstrmojo.all[\''+M.id+"'].onclick('"+e.name+'\',event)" href="'+d.href+'" useIframe="'+d.iframe+'"';if(d.accept!==undefined){c+=' accept = "'+d.accept+'"';}c+=' name="'+d.name+'"><span class="micn"></span><span>{@n}</span></a>';return c;}function W(e,b){var d=e.config;var c="<label "+D(d.name+"Item")+' for ="myFile" class="mstrMenuItem '+d.name+' {@cls} {@newGroup}" idx="{@idx}" onclick=" mstrmojo.all[\''+M.id+"'].onclick('"+e.name+'\',event)" href="'+d.href+'" target="'+d.target+'" useIframe='+d.iframe+'"';if(d.accept!==undefined){c+=' accept = "'+d.accept+'"';}c+='name="'+d.name+'"><span class="micn"></span><span>{@n}</span></label>';return c;}function P(c){if(c.config.name==="folder"){var b=mstrmojo.insert({scriptClass:"mstrmojo.NewFolderEditor",fId:mstrApp.currentFolderId?mstrApp.currentFolderId():"",Index:Y.domNode.style.zIndex+10,navigateAfter:true,okFn:function(){var d=this,e={evt:2001,src:T+"."+mstrApp.pageName+".fbb.fb.2001",folderID:d.fId};C(e,mstrApp.name,"POST");},onClose:function(){this.destroy();}});b.open();}if(Y&&Y.close){window.setTimeout(function(){Y.close();},10);}return true;}var L=false;for(var Q=0;Q<R.sl.length;Q++){var O=R.sl[Q];if(O.grp){U.addSeparator();}var a={},N=L===false?"":"collapsable ";if(O.name==="prompt"||O.name==="template"||O.name==="templateDoc"){a=U.addPopupMenuItem(O.n,U.id,I.call(M,O.name));a.cls=a.cls+N+O.name;a.tstid=O.name+"Item";}else{if(O.name==="myFile"){a=U.addCustomMenuItem(O.n,N,P,W);var Z='<form id="import_form" class="mstrmojo-FileUploadBox" target="hidden_import_iframe" enctype="multipart/form-data" method="post" action="'+mstrConfig.taskURL+'"><input id="myFile" name="myFile" type="file" class="mstrmojo-FileUploadBox-file mstr-create-menu-fileUpload" size="30" onchange="mstrApp.uploadMstrFileFn.upload(\'import_form\');" accept=".mstr" title=""><input type="hidden" name="fileFieldName" value="myFile"><input type="hidden" name="taskId" value="importAsyncSaveRWD"><input type="hidden" name="taskEnv" value="jsonp2"><input type="hidden" name="jsonp" value="parent.mstrApp.uploadMstrFileFn.callback(@R@)"><input type="hidden" name="myfile" value=""><input type="hidden" name="folderID" value="" id="import_folderID"></form>';Z+='<iframe name="hidden_import_iframe" style="display:none;" src="about:blank"></iframe>';if(!document.getElementById("import_form")){var V=document.createElement("SPAN");V.innerHTML=Z;document.body.appendChild(V);}}else{a=U.addCustomMenuItem(O.n,N,P,S);a.tstid=O.name;}a.config=O;if(O.name==="folder"){a.config.params={evt:17001,src:T+"."+mstrApp.pageName+".OMDCreateFolder.17001",targetName:"fb",iframe:true,target:"frameManager"};}}a.name=O.name;}Y=U.newInstance({id:"mscld-create-menuList"});}Y.set("includeScroll",false);Y.open(X);M.createMenu=Y;Y.onClose=function(){X.toggleButtonClass(false);};}function K(N){var R=this,P=R.createMenuData;function L(T){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function S(U){T.createMenuData.dl=U.items;T.createMenuData.loadData.dlLoaded=true;O();}},{folderID:"FCA4BAFE4AF0D00088028989D7497A4F",taskId:"folderBrowse",styleName:T.folderBrowsingStyle,includeObjectDesc:true,objectType:"55"});mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function S(U){T.createMenuData.docList=U.items;T.createMenuData.loadData.dlLoaded=true;O();}},{folderID:"6C87013036D94E65B9FD227CF919327E",taskId:"searchMetadata",styleName:T.folderBrowsingStyle,recursive:1,includeAncestorInfo:false,includeObjectDesc:true,objectType:"14081"});}function Q(T){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function S(U){T.createMenuData.rl=U.items;T.createMenuData.loadData.rlLoaded=true;O();}},{taskId:"folderBrowse",systemFolder:"16",styleName:T.folderBrowsingStyle,includeObjectDesc:true,objectType:"55"});}function O(){if(R.createMenuData.sl&&M(R.createMenuData.loadData)){F.call(R,N);}}if(!P){R.createMenuData={};mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(U){var T;R.createMenuData.sl=U;R.createMenuData.loadData={};for(T=0;T<U.sl.length;T++){var S=U.sl[T]["feature-id"];switch(S){case"create-view-reports":R.createMenuData.loadData.rlLoaded=false;Q(R);break;case"template-documents;dhtml;documents-design-mode":R.createMenuData.loadData.dlLoaded=false;L(R);break;}}O();}},{taskId:"getShortcutsList",pageName:"createOptions"});}else{O();}function M(U){if(!U){return true;}var T=true;for(var S in U){T=T&&U[S];}return T;}}mstrmojo.mstr.ui.CreateMenu=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.mstr._ObjectActions],{scriptClass:"mstrmojo.mstr.ui.CreateMenu",hostCssClassName:"mstrmojo-create-menu-host",cssClassName:"mstr-create-menu",opener:null,folderBrowsingStyle:"MobileFolderStyle",onclick:function(L,M){if(L!=="myFile"){mstrmojo.dom.preventDefault(window,M);}switch(L){case"customGroup":this.openCustomGroupEditor({});break;case"metric":this.openMetricEditor({});break;case"queryBuilder":this.openDataImport({});break;case"filter":this.createFilter();break;case"scNewIVE":this.createDashboard();break;}},loadCreateMenu:function(){if(!this.opener){return ;}K.call(this,this.opener);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.Container","mstrmojo.Label","mstrmojo.ui.List","mstrmojo.ui._HasListTooltip","mstrmojo.mstr._ObjectActions","mstrmojo.mstr.search._IconCssClassBuilder");mstrmojo.requiresDescs(60,61,945,1050,3364,3366,9202);var D=mstrmojo.css,C=mstrmojo.array;var I,A=function(J){return mstrmojo.all[I].getBuilder(J,this.dataField);};mstrmojo.mstr.search.SearchGridView=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo.mstr._ObjectActions],{scritpClass:"mstrmojo.mstr.search.SearchGridView",cssClass:"mstrmojo-Search-GridView",makeObservable:true,banding:false,columns:[{headerText:mstrmojo.desc(945,"Name"),dataField:"n",dataWidgetBuilder:A,colCss:"name"},{headerText:mstrmojo.desc(60,"Owner"),dataField:"owner",dataWidgetBuilder:A,colCss:"owner"},{headerText:mstrmojo.desc(61,"Modified"),dataField:"mdt",dataWidgetBuilder:A,colCss:"mdt"},{headerText:mstrmojo.desc(1050,"Location"),dataField:"anc",dataWidgetBuilder:A,colCss:"anc"}],init:function H(J){this._super(J);I=this.id;},getBuilder:function B(K,M){var J=null;switch(M){case"n":J={scriptClass:"mstrmojo.mstr.search.SearchGridViewItem",items:[K]};break;case"anc":var L=K.anc.items.slice(2);J={scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Search-Ancester",children:[{scriptClass:"mstrmojo.Label",alias:"toggle",cssClass:"toggle",text:" ",fullPath:false,onclick:function(){this.fullPath=!this.fullPath;D.toggleClass(this.parent.domNode,"full",this.fullPath);},onRender:function(){this.set("bindings",{enabled:function(){return this.parent.path.ellipsized;}});}},{scriptClass:"mstrmojo.ui.List",alias:"path",ellipsized:false,items:C.map(L,function(N){if(N.hid){N.n="[...]";}return N;}),postclick:function(){if(!this.selectedItem.hid){this.parent.dataGrid.execute(this.selectedItem);}},onRender:function(){var O=this,N=O.domNode.firstChild;window.setTimeout(function(){O.set("ellipsized",N.clientWidth<N.scrollWidth);},10);}}]};break;default:J={scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Search-nonbreakable "+M,cssDisplay:"inline-block",text:K[M]};break;}J.alias="itemWidget";return J;}});mstrmojo.mstr.search.SearchGridViewItem=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasListTooltip,mstrmojo.mstr.search._IconCssClassBuilder],{scritpClass:"mstrmojo.mstr.search.SearchGridViewItem",getItemMarkup:function F(K,J){return this._super(K,J).replace("{@en@n}",'<i class="{@icnCls}"></i>{@en@n}');},getItemProps:function E(K,J){var L=this._super(K,J);L.addCls("mstrmojo-Search-GridViewItem");L.icnCls="mstrmojo-ListIcon "+this.getIconCssClass(K);L.txtCls="mstrmojo-Search-nonbreakable name";return L;},onclick:function G(J){this._super(J);this.dataGrid.execute(this.selectedItem,{zIndex:mstrmojo.mstr.search.Search.zIndex+2});}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocBuilder","mstrmojo.vi.ui.rw.selectors.DocSelectorViewFactory","mstrmojo.ui.BuilderBox","mstrmojo.ExpressVisList","mstrmojo.hash","mstrmojo.array","mstrmojo.DynamicClassFactory","mstrmojo.EnumRWUnitType","mstrmojo.vi.ui.ScrollableDocTextfield","mstrmojo.DocHTMLContainer");mstrmojo.requiresClsP("mstrmojo.vi.models","DocXtabModel","DocVisModel","EnumPanelTypes","XtabDropZones","GMDropZones","GoogleMapDropZones","ESRIMapDropZones","ImageLayoutDropZones","CombineDropZonesModel","PanelFormatSaver","VIComponentMap","GraphDropZones","BaseVisDropZones","HeatMapDropZones","NetworkDropZones");mstrmojo.requiresClsP("mstrmojo.vi.models.editors","TextEditorModel","ImageEditorModel","HtmlContainerEditorModel","HeatMapEditorModel","ImageLayoutEditorModel","NetworkEditorModel","BaseEditorModel","XtabEditorModel","GoogleMapEditorModel","ESRIMapEditorModel","GMEditorModel");mstrmojo.requiresClsP("mstrmojo.vi.ui.rw","DocLayoutViewer","DocLayout","DocSection","DocSubsection","Xtab","ImageBox","FilterPanelStack","FilterPanel","FilterPortlet","DocVIPanelStack","DocVIMainPanel","DocVIVisualizationsPanelStack","DocRelativePanel","VizBox","DocTextfield","DocImage","TextBox","FilterBox","ImageBox","HtmlBox","_IsViewDataGrid");var P=mstrmojo.hash,d=mstrmojo.array,V=mstrmojo.DynamicClassFactory.newComponent,h=mstrmojo.vi.models.editors,F=mstrmojo.vi.models.VIComponentMap.TYPES,f=mstrmojo.vi.models.EnumPanelTypes,Y=f.FILTERS,g=f.PAGEBY,H={},Z=mstrmojo.elementHelper,S=mstrmojo.EnumRWUnitType,O=mstrmojo.DocSelector.STYLES;H[S.IMAGE]="mstrmojo.vi.ui.rw.ImageBox";H[S.TEXTFIELD]="mstrmojo.vi.ui.rw.TextBox";H[S.HTMLCONTAINER]="mstrmojo.vi.ui.rw.HtmlBox";H[S.SELECTOR]="mstrmojo.vi.ui.rw.FilterBox";var B="containerNode";var U=function A(){this.parent.set("unit",this.unit);};function e(r){var q=r.defn.psType;if(!q){return 0;}return parseInt(q,10);}function k(t){var r=t.defn,w=t.data.elms,v=t.data.ces||[],u=t.data.unset,q="";if(!r.sec){return"";}if(r.style===O.SEARCH_BOX){if(!r.sos&&(d.find(v,"v",Z.ELEM_ALL_ID)>-1||v.length===0||u)){return"";}q=Z.buildElemsCountStr(v,[]);}else{if(r.style!==O.SCROLLER){if(r.multi){if(u&&(!v||v.length===0)){q=Z.buildElemsCountStr(w,w);}else{q=Z.buildElemsCountStr(v,w);}}else{q=Z.buildElemsCountStr(w,w);}}}return q;}function G(t,u,r,q){var w=P.walk(r.scriptClass,window),x=new q({docModel:t}),v=new w({id:u.id,node:u,controller:this.parent.controller,model:t,edtModel:x});v.addDisposable(x);v.edtModel.hostId=v.id;return v;}mstrmojo.vi.ui.DocBuilder=mstrmojo.declare(mstrmojo.DocBuilder,null,{scriptClass:"mstrmojo.vi.ui.DocBuilder",viMap:null,defaultSlot:B,visList:mstrmojo.ExpressVisList,init:function n(q){this._super(q);this.viMap={};},createSelectorFactory:function c(){return new mstrmojo.vi.ui.rw.selectors.DocSelectorViewFactory({docBuilder:this});},createClassMap:function a(){var q=this._super();q[S.LAYOUT]={n:"Layout"};q[S.SUBSECTION]={n:"DocSubsection"};q[S.PANELSTACK]={n:"PanelStack"};q[S.PANEL]={n:"Panel"};q[S.IMAGE]={n:"Image",scriptClass:"mstrmojo.vi.ui.rw.DocImage"};q[S.TEXTFIELD]={n:"Textfield",scriptClass:"mstrmojo.vi.ui.rw.DocTextfield"};return q;},isPortlet:function p(r){var q=r.t;return !!((r.httl||this._super(r))||q===S.TEXTFIELD||q===S.IMAGE||q===S.SELECTOR||q===S.HTMLCONTAINER);},extractWidget:function K(r,q){return this._super(r,q)||e(q)===g;},getPortletClass:function L(q){return H[q.t]||"mstrmojo.vi.ui.rw.VizBox";},createPortlet:function b(AE,r,AC,AD){var u=e(r);if(u){if(u===Y){return null;}return AC;}var x=r.defn,v=this.getLayoutVIMap(x._lkz);if(x.iifp){AC.alias="selector";return new mstrmojo.vi.ui.rw.FilterPortlet({title:x.ttl||"",children:[AC],panelId:v.getComponent(F.FILTER_STACK).id,k:AC.k,isCollapsed:parseInt(x.ds,10)===1,count:k(r),srcId:AC.defn.srcid,height:x.fmts.height});}var AB=AD&&AD.pk;if(AB){if(v.getComponentKey(F.PAGEBY_PANEL)===AB){return AC;}if(v.isRelativePanel(AB)){var AA=x.fmts,q=AA.left,z=AA.top,AF=P.walk(this.getPortletClass(x),window);AA.left=0;AA.top=0;AC.slot="containerNode";AC.alias="boxContent";return new AF({title:x.ttl||"",children:[AC],k:AC.k,defn:x,model:this.model,height:AA.height,width:AA.width,top:z,left:q,nk:x.fgk||AD.fgk});}}},newLayout:function E(t,x){var r=x.data,q=x.defn,v,u,z={alias:"layoutViewer",n:q.title||mstrmojo.desc(3437,"Layout")+" 1",numDupl:q.numDupl||0,model:t,node:x,controller:this.parent.controller,tbc:q.tbc,slot:B,ifs:r.ifs,gb:r.gbys};v=new mstrmojo.vi.ui.rw.DocLayoutViewer(z);u=v.defn=P.copy(q);u.fmts=P.copy(q.fmts);this.viMap[x.k]=this.addDisposable(new mstrmojo.vi.models.VIComponentMap());var w=new mstrmojo.vi.ui.rw.DocLayout({cssClass:"mstrmojo-VILayout",slot:"containerNode",id:x.id,k:x.k,rules:q.rules,builder:this,node:x,defn:q,model:t});v.addChildren([w]);return v;},removeVIMapRef:function J(q){var r=this.viMap[q];d.removeItem(this.disposables,r);r.destroy();delete this.viMap[q];},newSection:function X(q,r){return this.newRWUnitInstance(q,r,mstrmojo.vi.ui.rw.DocSection,{slot:B});},newDocSubsection:function C(q,r){return this.newRWUnitInstance(q,r,mstrmojo.vi.ui.rw.DocSubsection,{slot:B});},newTextfield:function o(r,t,q){return G.call(this,r,t,q,h.TextEditorModel);},newImage:function D(r,t,q){return G.call(this,r,t,q,h.ImageEditorModel);},newHTMLContainer:function T(t,u,r){var q=this.newRWUnitInstance(t,u,(u.defn.ht===1)?mstrmojo.vi.ui.ScrollableDocTextfield:mstrmojo.DocHTMLContainer,{formatHandlers:{domNode:["D"]}});q.edtModel=new h.HtmlContainerEditorModel({hostId:q.id,docModel:t});return q;},newPanelStack:function M(q,u){var t=u.defn,w=0,r={id:u.id,node:u,k:u.k,controller:this.parent.controller,model:q,builder:this},v;switch(e(u)){case Y:w=F.FILTER_STACK;v=mstrmojo.vi.ui.rw.FilterPanelStack;r.cssClass="mstrmojo-VIFilterStack";r.title=q.getCurrentLayoutDef().title;r.autoApply=!!t.cas;break;case f.VIS_CONTENT:w=F.MAIN_CONTENT;v=mstrmojo.vi.ui.rw.DocVIPanelStack;r.cssClass="mstrmojo-VIMainVizPanel";r.slot=B;break;case g:if(t.empty===true){return ;}w=F.PAGEBY_STACK;v=mstrmojo.ui.BuilderBox;r.height="45px";r.slot=B;r.onunitChange=U;break;case f.VISUALIZATION:w=F.VIZ_CONTENT;v=mstrmojo.vi.ui.rw.DocVIVisualizationsPanelStack;r.slot=B;r.title=t.n;break;}if(v){return this.getLayoutVIMap(t._lkz).createComponent(w,v,r);}},newPanel:function Q(v,u,t,AB){var AA=u.k,AC=mstrmojo.DocPanel,w=this.getLayoutVIMap(u.defn._lkz),z=AB.pk,x={id:u.id,node:u,numDupl:0,model:v,builder:this,controller:v.controller},r=0;if(w.isComponent(F.FILTER_STACK,z)){AC=mstrmojo.vi.ui.rw.FilterPanel;x.alias="contents";x.cssClass="mstrmojo-VIFilterPanel";x.slot=B;r=F.FILTER_PANEL;}else{if(w.isComponent(F.VIZ_CONTENT,z)){AC=mstrmojo.vi.ui.rw.DocRelativePanel;x.slot=B;w.addRelativePanel(AA);}else{if(w.isComponent(F.MAIN_CONTENT,z)){AC=mstrmojo.vi.ui.rw.DocVIMainPanel;x.slot=B;}else{if(w.isComponent(F.PAGEBY_STACK,z)){AC=mstrmojo.ui.BuilderBox;x.slot=B;x.onunitChange=U;x.preBuildRendering=function(){this.set("unit",null);return mstrmojo.ui.BuilderBox.prototype.preBuildRendering.call(this);};r=F.PAGEBY_PANEL;}}}}var q;if(r){q=w.createComponent(r,AC,x);}else{q=new AC(x);}return q;},getDefaultXtab:function R(q){if(q&&!!q.isViewDataGrid){if(!mstrmojo.VDXtab){mstrmojo.VDXtab=V(mstrmojo.vi.ui.rw.Xtab,[mstrmojo.vi.ui.rw._IsViewDataGrid],{scriptClass:"mstrmojo.VDXtab"});}return mstrmojo.VDXtab;}return mstrmojo.vi.ui.rw.Xtab;},newXtab:function m(r,t,q,v){var u=this._super(r,t,q,v);u.zonesModel=u.addDisposable(new mstrmojo.vi.models.XtabDropZones({hostId:u.id,docModel:r}));u.set("edtModel",new mstrmojo.vi.models.editors.XtabEditorModel({hostId:u.id,docModel:r}));return u;},getDefaultMojoVisModel:function W(){return mstrmojo.vi.models.DocVisModel;},newXtabModel:function N(q){return new mstrmojo.vi.models.DocXtabModel(q);},newMojoVisualization:function I(v,r){var AD=this._super(v,r),AA=r.data.visName,q,x,u;if(!!AD){q={hostId:AD.id,docModel:v};}if(AD instanceof mstrmojo.Xtab){return AD;}if(AA==="GraphMatrixVisualizationStyle"){AD.zonesModel=AD.addDisposable(new mstrmojo.vi.models.CombineDropZonesModel({hostId:AD.id,docModel:v,gmZones:AD.addDisposable(new mstrmojo.vi.models.GMDropZones(q))}));AD.edtModel=AD.addDisposable(new mstrmojo.vi.models.editors.GMEditorModel({hostId:AD.id,docModel:v}));}else{if(AA==="GoogleMapVisualizationStyle"){x="GoogleMapDropZones";u="GoogleMapEditorModel";}else{if(AA==="ESRIMapVisualizationStyle"){x="ESRIMapDropZones";u="ESRIMapEditorModel";}else{if(AA==="ImageLayoutVisualizationStyle"){x="ImageLayoutDropZones";u="ImageLayoutEditorModel";}else{if(AA==="VIHeatMapVisualizationStyle"){x="HeatMapDropZones";u="HeatMapEditorModel";}else{if(AA==="NetworkVisualizationStyle"){x="NetworkDropZones";u="NetworkEditorModel";}else{if(mstrConfig.pluginsVisList[AA]){var AC=mstrConfig.pluginsVisList[AA],t=AC.dz,z=AC.em;if(t){mstrmojo.requiresCls("mstrmojo."+t);var AB=P.walk(t,mstrmojo);AD.zonesModel=new AB({hostId:AD.id,docModel:v,visModel:AD.model});}else{AD.zonesModel=new mstrmojo.vi.models.BaseVisDropZones({hostId:AD.id,docModel:v,visModel:AD.model});}if(z){mstrmojo.requiresCls("mstrmojo."+z);var w=P.walk(z,mstrmojo);AD.edtModel=new w(q);}else{u="BaseEditorModel";}}}}}}}}if(x){AD.zonesModel=AD.addDisposable(new mstrmojo.vi.models[x](q));}if(u){AD.edtModel=AD.addDisposable(new h[u](q));}if(AD){AD.updateFormatsOnUpdate=false;}return AD;},getLayoutVIMap:function l(q){return this.viMap[q];}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocModel","mstrmojo.func","mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.elementHelper","mstrmojo.EnumRWUnitType","mstrmojo.boxmodel","mstrmojo.models.FormatModel","mstrmojo.DocDataService","mstrmojo.mstr.EnumDataType","mstrmojo.DI.DIConstants.xdaType","mstrmojo.vi.models._LayoutActions","mstrmojo.vi.models._PanelActions","mstrmojo.vi.models._FilterStackActions","mstrmojo.vi.models._VisActions","mstrmojo.vi.models._FieldActions","mstrmojo.vi.models._DataGridActions","mstrmojo.Button","mstrmojo.mstr.EnumWebAPIErrorCodes","mstrmojo.mstr.EnumDSSXMLBaseFormType","mstrmojo.DocSelector");mstrmojo.requiresClsP("mstrmojo.vi.models","PanelFormatSaver","EnumPanelTypes","VIComponentMap");mstrmojo.requiresClsP("mstrmojo.vi.ui","DatasetObjects","DocDatasetObjects","DatasetUnitMenuUtils");var R=mstrmojo,m=R.func,BN=R.array,Ak=R.boxmodel,AQ=R.hash,C=R.num,BV=R.elementHelper,BE=R.mstr.EnumWebAPIErrorCodes,BM=R.vi.ui.DatasetUnitMenuUtils,k=mstrmojo.models.FormatModel,BD=k.getFormatUpdate,AS=k.ENUM_PROPERTY_NAMES,BC=R.EnumRWUnitType,AG=mstrmojo.DocSelector.STYLES,Bk=mstrmojo.mstr.EnumDSSXMLBaseFormType,Bh=R.mstr.EnumDataType,O="\u001E",p=R.vi.models,Ba=p.EnumPanelTypes,Ae=mstrmojo.vi.models.VIComponentMap.TYPES,J=Ae.MAIN_CONTENT,A7=Ae.VIZ_CONTENT,Bb=Ae.PAGEBY_PANEL,H=[A7],An=mstrmojo.DI.DIConstants.xdaType,F=mstrmojo.DI.DIConstants.datasetServeMode;var S=12,M=4;var BI=3076;var Af=2;var BB=8;mstrmojo.vi.models.DatasetInfoType=null;mstrmojo.vi.models.DEObjectType=null;function a(Bn){return mstrApp.rootCtrl.resolveFeature(Bn);}function Ar(Bn,Bo){return(Bn===47&&Bo!==12033)||Bn===1;}function o(Bo){var Bq=this.controller.view.getLayouts(),Bn=Bq.length,Bp;for(Bp=0;Bp<Bn;Bp++){this.data.layouts[Bp].loaded=false;if(Bo){Bq[Bp].defn.loaded=false;}}}function Bi(Bp,Bn,Bu,Bt,Bs,Br,By){Bt=Bt||this.currlaykey;var Bv=this.defn.layouts.filter(function(Bz){return Bz.k===Bt;})[0],Bq=Bu===Bt?Bv:Bv.units[Bu],Bo=function Bo(Bz){return k.getFormatUpdate(Br,Bz);},Bw={k:Bu,defn:Bq},Bx;if(Bs){By=m.wrapMethods({success:function(Bz){Bq[Bs]=Bz;}},By);}Bx=By.success;By.success=function(Bz){Bx(k.getValueFromUpdate(Br,Bz)||Bp);};this.updateUnitFormatWithUndo(Bw,1,Bo(Bp),Bo(Bn),By);}var Bj=mstrmojo.DocDataService.REQUEST_DEFN_DATA;var Bc=mstrmojo.DocDataService.REQUEST_ONLY_DATASETS;function N(Bp,Bn,Bo,Br,Bq){Br=Br||this.getNextKey();Bq=Bq||this.getCurrentLayoutKey();var Bt={k:Br,wid:1},Bs={k:Br,id:this.getWidgetId(Bt,Bq),defn:{fmts:{top:"0px",left:"0px",height:"100px",width:"100px"},_lkz:Bq},data:Bt};if(Bp){Bs.data=Bp(Bt,Bs);}if(Bn){Bs.defn=Bn(Bs.defn,Bs);}if(Bo){Bs=Bo(Bs);}return Bs;}function A3(Bn){var Bo=this.controller.view.getLayouts();Bo.forEach(function(Bp){if(Bp.k===Bn){Bp.defn.loaded=false;}});this.data.layouts.forEach(function(Bp){if(Bp.k===Bn){Bp.loaded=false;}});}function d(Bp,Br){var Bn=this.controller,Bo=Bn.view.builder,Bq=this.getPanel(Br);Br=Bq.k;return Bo.build([Bp],this,{pk:Br})[0];}function Ah(Bp){var Bn=this.getVIPanelKeyFromUnits(Bp),Bo=this.getTargetDefn(Bn)[Bn];return this.getUnitFormatAction({defn:Bo,k:Bn},1,{FormattingAppearance:{Visible:1}});}function f(Bn,Bv,Bq,Bt){var Br=this.getVIPanelKeyFromUnits(Bn),Bu=this.getTargetDefn(Br),Bo=Bq.data;var Bs=this.getCurrentLayoutKey(),Bp=AQ.walk(Bv,Bo.layouts.filter(function(Bw){return Bw.k===Bs;})[0]);this.updateDataCache(Bo,Bu);Bt.build(this.getChildren({data:Bp,defn:Bu[Br],id:this.getWidgetId(Bp),k:Br}).filter(function(Bw){return Bw.k===Br;}),this);}function Al(Br,Bo,Bn,Bq){var Bp=this.id;this.getDataService().submitUpdates(Ah.call(this,Br),{success:function(Bs){f.call(mstrmojo.all[Bp],Br,Bo,Bs,Bn);Bq();}},{preserveUndo:true});}function AB(Bn,Bo){return"1"+O+Bn+O+Bo;}function BT(Bn){var Bo=Bn.split(O);return{nodeKey:Bo[1],ctrlKey:Bo[2]};}function A0(Bp,Bs,Bn,Br){Br=Br||{};var Bo=this,Bt=(Bp&&this.extractChildren(Bp))||[],Bq;Bt.forEach(function(Bu){Bq=Bu.k;Bn=Bn||Bs.hasOwnProperty(Bq);if(Bn){Br[Bq]=true;}A0.call(Bo,Bu,Bs,Bn,Br);});return Br;}function Y(Bn){AQ.forEach(Bn,function(Bo){Bo.att=BM.getSortedDatasetUnits(Bo.att);Bo.mx=BM.getSortedDatasetUnits(Bo.mx);if(Bo.tables&&!this.isMDXDataset(Bo)){Bo.tables.forEach(function(Bp){Bp.att=BM.getSortedDatasetUnits(Bp.att);Bp.mx=BM.getSortedDatasetUnits(Bp.mx);});}},this);}function Bl(Bo){var Bn=this;if(typeof Bo==="string"){if(Bo.indexOf("{")===0){Bo=JSON.parse(Bo);}}Bo=AQ.copy({dataset:function(Bt){var Bs=function(Bv,Bu){Bv.getCollapsed=function(){return this.isCollapsed===undefined?Bu.isCollapsed:this.isCollapsed;};};var Br=function(Bx,Bw,Bu){this[Bx]=this[Bx]||{};var Bv=this[Bx][Bw]=this[Bx][Bw]||{};Bs(Bv,Bu);return Bv;};var Bq=function(){return Bn.datasets[Bt];};if(!Bq()){return null;}var Bp=Br.call(this,"datasets",Bt,{isCollapsed:false});Bp.hasCollapsedChildNodes=function(Bw,Bv){var Bu=false,Bx=this;AQ.forEach(Bq().tableMap,function(Bz,By){var B0=Bx.table(By);if(B0.getCollapsed()===Bw||(Bv&&B0.hasCollapsedChildNodes(Bw,Bv))){Bu=true;return false;}});return Bu;};if(!Bp.table){Bp.table=function(By){var Bw=function(){return Bq().tableMap[By];};if(!Bw()){return null;}var Bx=Br.call(this,"tables",By,{isCollapsed:false});Bx.hasCollapsedChildNodes=function(){return false;};if(Bn.isMDXTable(Bw())){Bx.hasCollapsedChildNodes=function(B2,B1){var B0=false,B3=this;AQ.forEach(Bw().dimensionMap,function(B7,B5){var B6=B3.dimension(B5);if(B6.getCollapsed()===B2||(B1&&B6.hasCollapsedChildNodes(B2,B1))){B0=true;return false;}});if(B0){return B0;}var B4=B3.rootMetricFolder;if(B4.getCollapsed()===B2||(B1&&B4.hasCollapsedChildNodes(B2,B1))){B0=true;}return B0;};if(!Bx.dimension){Bx.dimension=function(B0){var B2=function(){return Bw().dimensionMap[B0];};if(!B2()){return null;}var B1=Br.call(this,"dimensions",B0,{isCollapsed:true});B1.hasCollapsedChildNodes=function(B4){var B3=false,B5=this;AQ.forEach(B2().hierarchyMap,function(B6,B7){var B8=B5.hierarchy(B7);if(B8.getCollapsed()===B4){B3=true;return false;}});return B3;};if(!B1.hierarchy){B1.hierarchy=function(B4){var B3=function(){return B2().hierarchyMap[B4];};if(!B3()){return null;}return Br.call(this,"hierarchies",B4,{isCollapsed:true});};}return B1;};}var Bv=function(B1,B0){if(!B1.hasCollapsedChildNodes){B1.hasCollapsedChildNodes=function(B4,B3){var B5=this,B2=false;AQ.forEach(B0().folderMap,function(B8,B7){var B6=B5.folder(B7);if(B6.getCollapsed()===B4||(B3&&B6.hasCollapsedChildNodes(B4,B3))){B2=true;return false;}});return B2;};}if(!B1.folder){B1.folder=function(B3){var B2=function(){return B0().folderMap[B3];};if(!B2()){return null;}var B4=Br.call(this,"folders",B3,{isCollapsed:true});Bv(B4,B2);return B4;};}};var Bu=function(){return Bw().metricFolder;},Bz=Bx.rootMetricFolder=Bx.rootMetricFolder||{};Bs(Bz,{isCollapsed:false});Bv(Bz,Bu);}return Bx;};}return Bp;},getSaveActions:function(){var Bp=this;AQ.forEach(this.datasets,function(Br,Bs){var Bt=Bn.datasets[Bs];if(!Bt){delete Bp.datasets[Bs];return ;}if(!Bt.tables){delete Br.tables;return ;}AQ.forEach(Br.tables,function(Bw,Bv){var Bx=Bt.tableMap[Bv];if(!Bx){delete Br.tables[Bs];return ;}if(Bn.isMDXTable(Bx)){var Bu=function(By,Bz){AQ.forEach(By.folders,function(B0,B1){if(!Bz.folderMap[B1]){delete By.folders[B1];return ;}Bu(B0,Bz.folderMap[B1]);});if(AQ.isEmpty(By.folders)){delete By.folders;}};AQ.forEach(Bw.dimensions,function(B0,Bz){var By=Bx.dimensionMap[Bz];if(!By){delete Bw.dimensions[Bz];return ;}AQ.forEach(B0.hierarchies,function(B3,B1){var B2=By.hierarchyMap[B1];if(!B2){delete B0.hierarchies[B1];}});if(AQ.isEmpty(B0.hierarchies)){delete B0.hierarchies;}});if(AQ.isEmpty(Bw.dimensions)){delete Bw.dimensions;}Bu(Bw.rootMetricFolder,Bx.metricFolder);delete Bw.metricFolders;}});});var Bq=JSON.stringify(this);return[Bn.getUnitFormatAction(Bn.getRootNode(),1,{FormattingAnalysis:{DatasetsSettings:Bq}})];},save:function(){Bn.execute({execute:function(){this.submit(Bo.getSaveActions(),{},mstrmojo.DocDataService.SUPPRESS_DATA);},urInfo:{callback:Bn.getDatasetsUpdateCallback()}});},unitOpr:function(Bs,Bt,Bp){var Br,Bq;this.units=this.units||{};this.units[Bs]=this.units[Bs]||{};Br=this.units[Bs];if(Bp!==undefined){if(Bp){Bq=Br[Bt]=Bp;}else{delete Br[Bt];if(AQ.isEmpty(Br)){delete this.units[Bs];}}}else{Bq=Br[Bt];}return Bq;}},Bo);return Bo;}function Av(Bn,Bo){this.datasetsSettings=Bl.call(this,Bo);AQ.forEach(Bn,function(Br,Bt){Br.did=Bt;if(Br.tables){var Bq=function(Bu){return function(Bv){return Bu.filter(function(Bw){return Bw.did===Bv.did;})[0]||null;};},Bp=Bq(Br.att),Bs=Bq(Br.mx);Br.tableMap={};Br.tables.forEach(function(Bw){Br.tableMap[Bw.did]=Bw;if(this.isMDXTable(Bw)){var Bu=function(By){By.folderMap={};By.mxRefs=By.mxRefs||[];By.folders=By.folders||[];By.mx=By.mxRefs.map(Bs);By.folders.forEach(function(Bz){By.folderMap[Bz.n]=Bz;Bu(Bz);});};Bw.dimensionMap={};var Bv=Bw.dimensions[0].hierarchies[0],Bx=!Bv.attRefs&&Bp(Bv);if(Bx&&Bx.t===S&&Bx.st===BI){Bw.dimensions.forEach(function(By){Bw.dimensionMap[By.did]=By;By.recursiveAtt=[];By.hierarchies.forEach(function(Bz){By.recursiveAtt.push(Bp(Bz));});});}else{Bw.dimensions.forEach(function(By){Bw.dimensionMap[By.did]=By;By.hierarchyMap={};By.hierarchies.forEach(function(Bz){By.hierarchyMap[Bz.did]=Bz;Bz.att=Bz.attRefs.map(Bp);});});}Bw.metricFolder=Bw.metricFolder||{};Bu(Bw.metricFolder);}else{Bw.attRefs=Bw.attRefs||[];Bw.att=Bw.attRefs.map(Bp);Bw.mxRefs=Bw.mxRefs||[];Bw.mx=Bw.mxRefs.map(Bs);}},this);}},this);delete this.deMap;Y.call(this,Bn);this.set("datasets",Bn);}function L(Bn,Bo){AQ.forEach(Bo,function(Bs,Br){var Bp=Bn[Br],Bq=Bp&&Bp.att.concat(Bp.mx),Bt=Bs.att.concat(Bs.mx);if(Bq){BN.forEach(Bt,function(Bv){var Bu=BN.find(Bq,"did",Bv.did);if(Bu<0){Bv.ne=true;}if(Bv.t===47&&Bv.st===12033){var Bw=Bu<0?null:Bq[Bu];BN.forEach(Bv.des,function(Bx){if(!Bw||BN.find(Bw.des,"id",Bx.id)<0){Bx.ne=true;}});}});}});}function Ag(Bo,Bq){var Bn=this.getVIComponent(Bb),Bp=Bn.id,Br=[Bn.k];if(Bo){Br.push(this.getVIComponentKey(J));}return function(Bt){this.partialUpdate(Bt.data,this.getTargetDefn(Br.join(O)),Bt.defn,Bq);var Bs=mstrmojo.all[Bp];Bs.parent.rebuildChild(Bs);}.bind(this);}function BP(Bn){var Bp,Bo=this.getCurrentLayoutKey();this.obCntrs=this.obCntrs||{};this.obCntrs[Bo]=this.obCntrs[Bo]||{};Bp=this.obCntrs[Bo][Bn];if(isNaN(Bp)){Bp=0;AQ.forEach(this.getCurrentLayoutDef().units,function(Bq){if(Bq.t===Bn){Bp++;}});this.obCntrs[Bo][Bn]=Bp;}return Bp;}mstrmojo.vi.models.DocModel=mstrmojo.declare(mstrmojo.DocModel,[mstrmojo.vi.models._LayoutActions,mstrmojo.vi.models._PanelActions,mstrmojo.vi.models._FilterStackActions,mstrmojo.vi.models._VisActions,mstrmojo.vi.models._FieldActions,mstrmojo.vi.models._DataGridActions],{scriptClass:"mstrmojo.vi.models.DocModel",datasets:null,deObjectMap:null,controller:null,lastSavedStid:0,_selectedUnitId:null,_latestSelectedViUnitKey:null,init:function Bg(Bn){this._super(Bn);Av.call(this,this.datasets,this.datasetsSettings);},getVIMap:function BO(Bn){return this.getDocBuilder().getLayoutVIMap(Bn||this.getCurrentLayoutKey());},getVIComponent:function AY(Bo,Bn){return this.getVIMap(Bn).getComponent(Bo);},getVIComponentKey:function u(Bo,Bn){return this.getVIMap(Bn).getComponentKey(Bo);},buildKeyContext:AB,loadHiddenVIStack:Al,buildLoadedVIStack:f,getShowVIStackAction:Ah,getVIPanelKeyFromUnits:function BF(Bp,Bn){var Bo=this.getLayoutDefn(Bn||this.getCurrentLayoutKey()).units;return Object.keys(Bo).filter(function(Bq){return Bo[Bq].psType===Bp;})[0];},updateTitle:function AE(Bq,Bp,Bo,Bn,Bs,Br){Bi.call(this,Bq,Bp,Bo,Bn,Bs,AS.TITLE,Br);},createNewUnitNode:N,getPanel:function Ay(Bo,Bn){return Bo?mstrmojo.all[this.getWidgetId({k:Bo,wid:1},Bn)]:this.getVizContentPanel(Bn);},createUnit:d,deferredInsertUnit:function r(Bs,Bo,Br,Bn,Bp){var Bq=Bo.k;Bs.setTreesToRender(3);Bs.addCallbacks({success:function(Bu){var By=Bo.defn._lkz,Bw=Bu.defn.layouts.filter(function(B3){return B3.k===By&&B3.loaded;})[0],Bx=!AQ.isEmpty(Bw);if(!Bx){A3.call(this,By);return ;}var B1=this.getPanel(Br),Bt=Bo.nk,Bv,B2,Bz=this.currlaykey;this.controller.view.updateXtabStyles(By,Bu.data.layouts[BN.find(Bu.data.layouts,"k",By)].xtabStyles);this.updateDefnCache(Bu.defn,[Bq,B1.k]);this.updateDataCache(Bu.data,this.getTargetDefn(Bq));if(this.getLayoutDataCache(Bz)[B1.id]){B2=BN.filterOne(this.data.layouts,function(B3){return(B3.k===Bz);});this.updateDataCache({layouts:[B2]},this.getTargetDefn(B1.k));}B1.update(B1.node);var B0=Bx&&(!!this.getChildrenByKey(B1.node,false,[Bq])[0]);if(B0){Bv=B1.rebuildChild(B1.getUnitByKey(Bq));this.selectVIUnit(Bv.id,true,{isAddAction:true});}if(Bt){Bv.nk=Bt;}}.bind(this)});this.getPanel(Br).addUnit(Bo,Bn,Bp,Bs,true);},markDirtyLayout:A3,getVizContentPanel:function AA(Bn){return this.getVIComponent(A7,Bn).getSelectedPanel();},getSelectedViUnit:function h(){return mstrmojo.all[this._selectedUnitId];},getRootNode:function BX(){var Bn=this.defn.root;return{k:Bn.k,defn:Bn};},getHighLightNDECallback:function A2(){var Bn=this;return this.newCallback({method:"hightLightNDE",success:function(Bp){var Bq=Bp.datasets,Bo=[];AQ.forEach(Bq,function(Br){BN.forEach(Br.att,function(Bs){if(Bs.t===47&&Bs.st===12033){BN.forEach(Bs.des,function(Bt){if(Bt.ne&&Bt.t!==4){Bo.push({id:Bt.id,n:Bt.n,es:Bt.es,attId:Bs.attId,unitId:Bs.did});}});}});});if(Bo.length>0){Bn.callOnNDECreated(Bo);}}});},callOnNDECreated:function(Bo){var Bn=this.getPanel();BN.forEach(Bn.children,function(Bp){if(Bp.boxContent&&Bp.boxContent.onNDECreated){Bp.boxContent.onNDECreated(Bo);}});},getRebuildCallback:function K(){var Bn=this;return this.newCallback({method:"rebuild",success:function(Bz){if(!Bn.checkStatus(Bz)){return ;}var Bv=Bz.data,By=Bz.defn,Bw=Bz.pukeys,Bx=Bw&&Bw.split(O),B0={},Bs;if(Bx&&Bx.length){if(By){var B1=Bn.getLayoutDefn(Bn.getCurrentLayoutKey()),Bo=B1&&B1.units,Bp=By.layouts,Bu=Bp&&Bp[BN.find(Bp,"k",Bn.getCurrentLayoutKey())],Br=Bu&&Bu.units,Bt=function(B2){var B3=[];B2.forEach(function(B5){if(!Bo[B5]&&Br&&Br[B5]){var B4=Br[B5].pnk;if(B4){B3.push(B4);}}});return B3;},Bq=Bt(Bx);while(Bq.length){Bx=Bx.concat(Bq);Bq=Bt(Bq);}Bs=BN.hash(Bx);B0=A0.call(Bn,Bv,Bs,false);}else{Bs=BN.hash(Bx);}Bn.partialUpdate(Bv,Bs,By,AQ.keyarray(B0));}else{if(Bn.updateLayouts(Bz)){Bn.controller.view.updateLayouts(Bz);}}}});},buildSliceUrInfo:function BZ(Bo){var Bp=Bo.events||{K0:Bo},Bn=[],Bq=2;Object.keys(Bp).forEach(function(Bs){var Bt=Bp[Bs],Br=Bt.ck;if(Br){var Bu=BT(Br);Bn.push(Bu.nodeKey,Bu.ctrlKey);}if(Bt.changeInclude||Bt.changeQual){Bq=3;}});return{extraPuKeys:Bn,treesToRender:Bq};},getUIState:function Az(){var Bn={};H.forEach(function(Bo){Bn[Bo]=this.getVIComponent(Bo).getUIState();},this);return Bn;},restoreUIState:function AX(Bn){H.forEach(function(Bo){this.getVIComponent(Bo).restoreUIState(Bn[Bo]);},this);},cmdMgr:function Ap(){return this.controller.cmdMgr;},execute:function AJ(Bn){return this.controller.cmdMgr.execute(Bn);},slice:function l(Bn){var Bo=this;this.execute({execute:function(){var Bp=Bo.getDataService().newUpdate(this);Bo.sliceDeferred(Bp,Bn);if(Bp.actions&&Bp.actions.length>0){this.submitUpdate(Bp);}},urInfo:Bo.buildSliceUrInfo(Bn)});},insertNewFilter:function AV(){var Bs=this.id,Bo=mstrmojo.all[Bs],Bq=Bo.getDataService(),Br=Bo.getVizContentPanel().k,Bn=Bo.getNextKey(),Bp=Bo.createNewUnitNode(null,function(Bt,Bu){Bt.t=BC.SELECTOR;Bt.ck=AB(Bn,Bu.k);Bt.ckey=Bu.k;return new mstrmojo.Model(Bt);});this.execute({execute:function(){var Bv=Bq.newUpdate(this,{extras:Bj}),Bt=Bo.createUnit(Bp,Br),Bu=Bt.k;Bv.addActions([Bq.getAddCtrlAction(Br,Bn,Bu,[Bu]),Bo.getUnitFormatAction(Bp,5,BD(AS.SHOW_TITLE_BAR,false)),Bo.getUnitFormatAction(Bp,1,BD(AS.CONTROL_ITEM_WIDTH_MODE,0)),Bo.getUnitFormatAction(Bp,1,BD(AS.CONTROL_EXPORT_AS_SHOWN_ON_WEB,1))]);Bo.deferredInsertUnit(Bv,Bt,Br,null,null);this.submitUpdate(Bv);},urInfo:{undo:function(){this.urInfo.callback={};var Bu=Bo.getPanel(Br),Bt=Bu.getUnitByKey(Bp.k);if(Bt){Bu.deleteBoxAndSubmitDeferred(Bo.getDataService().newUpdate(),Bt,null,true);Bt.destroy();}},redo:function(){if(Bp){var Bu=Bq.newUpdate(this,{extras:Bj}),Bt=Bo.createUnit(Bp,Br);Bo.deferredInsertUnit(Bu,Bt,Br,null,null);if(this.urInfo){this.urInfo.callback=Bu.callback;}}},extraPuKeys:[Br],treesToRender:3}});},insertExistingFilter:function AK(Bs,Bt,Bn){var Bq=this,Bo=this.getPanel().k,Bu=this.getDataService(),Bw=Bs.defn,Br=Bs.defn.tks.split(O),Bx=this.getVizContentPanel().getTargetKeysByType([BC.GRID,BC.GRAPH,BC.MOJOVISUALIZATION]),Bv=Bq.getVIComponent(Ae.FILTER_PANEL),Bp=function(By){By.raiseEvent({name:"filterPanelUpdated"});};Bq.execute({execute:function(){var B5=Bu.newUpdate(this);var B0=Bq.createUnit(Bs,Bo),B1=Bw.ck,Bz=Bw.srct,B2=Bw.srcst,B3=[],B4=false;Br.forEach(function(B6){var B7=mstrmojo.array.ensureArray(B6);if(!B4){B7.push(Bw.pnk);B4=true;}B3.push(Bu.getRemoveCtrlTargetAction(B1,B6,B7));});Bx.forEach(function(B6){B3.push(Bu.getAddCtrlTargetAction(B1,B6,B6,Ar(Bz,B2)));});B3.push(Bu.getMoveControlAction(B1,Bo));if(Bn==="Top"||Bn==="Bottom"){B3.push(Bq.getUnitFormatAction(Bs,1,BD(AS.CONTROL_ORIENTATION,1)));}B3.push(Bq.getUnitFormatAction(Bs,1,BD(AS.FILL_STYLE,0)));B3.push(Bq.getUnitFormatAction(Bs,5,BD(AS.FILL_STYLE,0)));B3.push(Bq.getUnitFormatAction(Bs,1,BD(AS.BORDER_COLOR,"#fefefe")));B5.addActions(B3);Bq.deferredInsertUnit(B5,B0,Bo,Bt,Bn);var By=Br.join(O);B5.callback={success:function(B6){var B8=Bq.getPanel(Bo),B7=B8.getUnitByKey(Bs.k);if(B7&&B7.clearFormats){B7.clearFormats();}Bv.refreshFP();Bq.partialUpdate(B6.data,Bq.getTargetDefn(By),B6.defn,[Bs.k,Bo,Bw.pnk]);Bp(Bv);}};this.submitUpdate(B5);},urInfo:{undo:function(){this.urInfo.callback={};var Bz=Bq.getPanel(Bo),By=Bz.getUnitByKey(Bs.k);if(By){Bz.removeChildren(By);By.destroy();mstrApp.rootCtrl.docCtrl.selectViPanel("filterPanel");}Bp(Bv);},redo:function(){var Bz=(Bv.children||[]).filter(function(B2){return B2.k===Bs.k;})[0];if(Bz){Bv.removeChildren(Bz);Bz.destroy();}delete Bs.defn.iifp;var B1=Bu.newUpdate(this),B0=Bq.createUnit(Bs,Bo);if(!Bt.parent){Bq.getPanel(Bo).children.forEach(function(B2){if(B2.k===Bt.k){Bt=B2;}});}Bq.deferredInsertUnit(B1,B0,Bo,Bt,Bn);var By=Br.join(O);B1.callback={success:function(B2){var B4=Bq.getPanel(Bo),B3=B4.getUnitByKey(Bs.k);if(B3&&B3.clearFormats){B3.clearFormats();}Bq.partialUpdate(B2.data,Bq.getTargetDefn(By),B2.defn,[Bs.k,Bo,Bw.pnk]);Bp(Bv);}};if(this.urInfo){this.urInfo.callback=B1.callback;}},extraPuKeys:[Bq.getVIComponent(Ae.FILTER_PANEL).k,Bo]}});},selectVIUnit:function AW(Bp,Bn,Bo){if(Bn||Bp!==this._selectedUnitId){this._selectedUnitId=Bp;this._latestSelectedViUnitKey=Bp&&mstrmojo.all[Bp].k;this.raiseEvent(AQ.copy({name:"viUnitSelected",id:Bp},Bo));}},getLatestSelectedViUnitKey:function D(){return this._latestSelectedViUnitKey;},getDocDatasetsPanel:function A(){var Bo=this.getRootNode(),Bp=Bo.defn,Bq=this.id,Bn=new mstrmojo.vi.ui.DocDatasetObjects({data:this.datasets,visible:!!Bp.dsv,width:Bp.dsw,model:this,unit:Bo,settings:this.datasetsSettings,getPanelSaver:function(){var Br=mstrmojo.all[Bq];return p.PanelFormatSaver.getPanelSaver(Br,{size:{set:"FormattingAnalysis",name:"DatasetObjectsWidth",convert:true},visible:{set:"FormattingAnalysis",name:"DatasetObjectsVisible"}});}});this.attachEventListener("updateDatasets",Bn.id,function(Br){Bn.set("data",Br.datasets);Bn.set("settings",Br.datasetsSettings);});this.attachEventListener("viUnitSelected",Bn.id,function(Bs){var Br=mstrmojo.all[Bs.id];Bn.set("gridSource",Br&&Br.boxContent.model.data.datasetId);});return Bn;},getDatasetsPanel:function Am(Bq,Bo,Bp,Br){var Bn=new mstrmojo.vi.ui.DatasetObjects({data:(!Bp?this.datasets:Bp(this.datasets)),width:Bq||"200px",model:this,useTableView:this.datasetsSettings.useTableView,title:mstrmojo.desc(2870,"Objects"),filterFunc:Bo,filterNodeConfig:Br||{att:true,mx:true}});this.attachEventListener("updateDatasets",Bn.id,function(Bs){Bn.set("useTableView",Bs.datasetsSettings.useTableView);Bn.set("data",!Bp?Bs.datasets:Bp(Bs.datasets));});this.attachEventListener("updateUseTableView",Bn.id,function(Bs){this.set("useTableView",Bs.useTableView);});return Bn;},updateDatasets:function As(Bn,Bo){if(!Bn){return ;}L(this.datasets,Bn);Av.call(this,Bn,Bo);this.raiseEvent({name:"updateDatasets",datasets:this.datasets,datasetsSettings:this.datasetsSettings});},getDatasetsUpdateCallback:function AM(){var Bn=this;return{success:function(Bo){Bn.als=Bo.als;Bn.updateDatasets(Bo.datasets,Bo.datasetsSettings);}};},renameDataset:function Ab(Bo,Bn,Bp){this.getDataService().submitUpdates([{act:"renameDataset",datasetID:Bo,name:Bn}],Bp,Bc);},renameEmmaSrcTable:function BU(Bo,Bp,Bn,Bq){this.getDataService().submitUpdates([{act:"renameEmmaSrcTable",dsid:Bp,did:Bo,n:Bn}],Bq,Bj);},addDataset:function I(Bp,Bq){if(!Bp||!Bp.length){return ;}var Br=this,Bo=Br.controller;function Bs(Bu){var Bw=[],Bt=[];function Bv(){var B0=Bo.cmdMgr,Bz=B0.getInterimCmd();if(Bw.length>0){var By={success:function(B1){Bo.getRefreshCallback().success(B1);Bo.datasetsPanel.set("allObjectBrowserOpened",false);},failure:function(B1){window.setTimeout(function(){var B2=Bz.urInfo;B2.callback={success:mstrmojo.emptyFn};Bz.cancel(true);},0);}},Bx=B0.CMD_PHASE;Bz.urInfo.callback=By;Bz.submit(Bw,m.wrapMethods(By,Bq),{skipUICmdMgrOnFailure:[BE.DOCDATA_PREPARE_TASK_REPORT_INCOMP],style:{params:{treesToRender:3}}},Bq?Bx.MIDDLE:Bx.LAST);}else{Bz.cancel();}}Bp.forEach(function(By){var Bx=Bu[By.did];Bw.push({act:"addDataset",did:By.did,t:By.t,g:AQ.keyarray(Bo.datasetsPanel.data).length===1?1:0,disablePU:true});if(Bx&&!Bx.published){if(!(Bx.dda===1&&Bx.ddam===F.dda)&&Bx.dda!==3){Bw.pop();Bt.push(By);}}});if(Bw.length){Bw=Bw.concat(Br.getOpenDatasetPanelAction());}if(Bt.length>0){mstrmojo.alert(mstrmojo.desc(13762,"The following datasets will not be added. You need to publish them first.")+" "+Bt.map(function(Bx){return"<br/>- "+Bx.n;}).join(""),Bv,null,null,null,{allowHTML:true});}else{Bv();}}var Bn=Bp.map(function(Bt){return Bt.did;});if(mstrApp.isSingleTier){Bs({});}else{this.getDataService().getUserDICubeInfo(Bn,{success:function(Bt){Bs(Bt);}});}},getReloadLayoutModelCallback:function AP(Bo){var Bn=this;return m.wrapMethods({success:function(Bp){o.call(Bn,true);Bn.loadLayout(Bp);}},Bo);},getRemoveUnitUpdate:function Be(Bq){var Bo=Bq.unit,Bn=Bq.partialRetrievalKeys,Bp=[{act:"removeUnit",unitKey:Bo.k,unitType:Bo.defn.t,clearTargets:Bq.clearTargets}];if(Bn){Bp[0].partialRetrieval={nodes:Bn};}return this.getDataService().newUpdate(null,{actions:Bp});},getCopyEmptyTemplateAction:function BK(Bo,Bn){return{act:"copyUnit",unitKey:this.getCurrentLayoutDef().btn,unitType:521,newKey:Bo,toKey:Bn,partialRetrieval:{nodes:[Bo]}};},getToggleHiddenObjectAction:function Ad(Bp,Bo,Bn){return{act:"editDocUnitProp",dsid:Bp,unitId:Bo.did,unitType:Bo.t,prop:Af,value:Bn?"1":"0"};},updateUnitFormatWithUndo:function AT(Bq,Br,Bs,Bo,Bu){var Bt=this.getDataService(),Bp=this,Bn=function(){var Bv=this,Bw=Bt.newUpdate(Bv,{actions:[Bp.getUnitFormatAction(Bq,Br,Bv.getStateValue(Bs,Bo))],callback:AQ.copy({success:function(){Bu.success(Bs);}},AQ.copy(Bu)),extras:mstrmojo.DocDataService.SUPPRESS_DATA});Bw.submit();};this.execute({execute:Bn,urInfo:{silent:true,undo:function(){Bu.success(Bo);},redo:function(){Bu.success(Bs);}}});},renameRWUnitTitle:function v(Bp,Bo,Bn,Bq){this.updateTitle(Bp,Bo,Bn,this.currlaykey,null,Bq);},renameRWUnit:function AD(Bn,Bo,Bp,Bq){Bi.call(this,Bn,Bo,Bp,this.currlaykey,"n",AS.NAME,Bq);},getRemoveControlUpdate:function U(Bn,Bv,Bo){var Bu=this.getDataService(),Bq=Bu.newUpdate(),Bt=[Bv].concat(Bo.split(O)),Bp=Bu.getRemoveCtrlAction(Bn,Bt),Bs=this,Br={success:function(Bw,By){var B0=JSON.parse(By.params.params),Bx=B0.partialRetrieval,Bz=(Bx&&Bx.nodes)?Bx.nodes.join(O):"";Bs.partialUpdate(Bw.data,Bs.getTargetDefn(Bz),Bw.defn);}};Bq.addActions(Bp);Bq.addCallbacks(Br);return Bq;},findKeyMap:function Bf(Br){var Bx=this.mapLayKeys;if(!Bx){return null;}var Bt=Bx.oldKey,B1=Bx.newKey,Bu=Bt?this.getLayoutDefn(Bt):null,Bw=B1?this.getLayoutDefn(B1):null,Bv=Br.k,Bo={},B3,B0,B2,Bs;var Bz=function(B5){var B4={};Object.keys(B5.units).forEach(function(B6){var B8=B5.units[B6],B7=B8.pnk;if(B7){var B9=B4[B7]=B4[B7]||[];B9[B8.chdidx]=B6;}});return B4;};var Bn=function(B6,B8,B5,B7){if(B6===B8||!B8){return[];}var B9=B7[B8].pnk,B4=B7[B8].chdidx;B3=Bn(B6,B9,B5,B7).concat(B4);return B3;};var Bq=function(B4,B8,B6){var B7=B4[B6];if(B8.length>0&&B7){var B5=B8.shift();return Bq(B4,B8,B7[B5]);}return B7;};var Bp=Bz(Bw);if(Bu){if(!Bu.loaded){return null;}var By=Bz(Bu);B3=Bn(B1,Bv,Bp,Bw.units);B0=Bq(By,B3,Bt);B2=Bp[Bv];for(Bs=0;B0&&Bs<B0.length;Bs++){if(B0[Bs]){Bo[B0[Bs]]=B2[Bs];}}}else{Bo["default"]=BN.filterOne(Bp[Bv],function(B4){return !!B4;});}return Bo;},loadHiddenPageByStack:function AO(Bn,Bo){Al.call(this,Ba.PAGEBY,"sections.0.subsections.0.objects.0.panels.0",Bn,Bo);},getCtrlStyleFromDatasetUnit:function P(By,Bs){if(By.um&&By.isTopRank){return AG.METRIC_QUAL;}var Bw=By.t,Bu=By.card||0,B0=Bu<=15?(Bs?AG.CHECKBOX:AG.LINK):Bu<=100?AG.CHECKBOX:AG.SEARCH_BOX,Bx=Bu<=50?AG.SCROLLER:Bu<=1000?AG.CHECKBOX:AG.SEARCH_BOX,Bz={12:{3:B0,2:Bx,8:AG.ATTR_QUAL,1:AG.ATTR_QUAL,9:Bx,11:Bx,"default":B0},4:{1:AG.METRIC_SLIDER,6:AG.METRIC_SLIDER,9:AG.METRIC_QUAL,16:AG.METRIC_QUAL,30:AG.METRIC_QUAL,31:AG.METRIC_SLIDER,"default":AG.METRIC_SLIDER},1:AG.CHECKBOX,47:AG.CHECKBOX}[Bw];if(Bw===S){if(By.lock){return AG.ATTR_QUAL;}if(By.st===BI){return AG.CHECKBOX;}if(By.de&&Bz[By.formType]===AG.ATTR_QUAL){return Bz["default"];}if(!Bu){var Bq=this.datasets,Bo,Br,Bv,Bn,Bp=false,Bt=function(B1){Bv=B1.formType;Bn=B1.did===By.did&&!B1.card;Bp=Bp||Bn;return Bn;};for(Bo in Bq){Br=Bq[Bo];if(Br.att.some(Bt)&&(Br.dsm===2||Br.idd)){if(Bv===Bk.DssXmlBaseFormDate||Bv===Bk.DssXmlBaseFormDateTime){return Bz[Bv]||Bz["default"];}return AG.SEARCH_BOX;}}if(!Bp){Bv=By.formType;if(Bv&&(Bv===Bk.DssXmlBaseFormDate||Bv===Bk.DssXmlBaseFormDateTime)){return Bz[Bv]||Bz["default"];}return AG.SEARCH_BOX;}}return Bz[By.formType]||Bz["default"];}if(Bw===M){return Bz[By.dt||"default"]||Bz["default"];}return Bz;},getCtrlHeightByStyle:function AL(Bo,Bn){var Bp={"default":140,4:200,9:140,1:80,3:200,0:80,7:100,8:80,11:100};if((Bo===3||Bo===4)&&Bn<=8){return 22*Math.max(Bn,2)+24;}return Bp[Bo]||Bp["default"];},getICSCtrlMoveHeightByStyle:function AR(Bn){var Bo={"default":20,4:20,9:40,1:60,3:20,0:60,7:60,8:60,11:60};return Bo[Bn]||Bo["default"];},getCtrlActionsByStyle:function B(Bx,Bv,By,Bp,B0,Bo,Bw,Bt){var Bq={FormattingSize:{HeightMode:"0"}},B2=Bq.FormattingSize,B1=BT(Bv),Bs=B1.nodeKey,Bn=B1.ctrlKey,Br=[],Bz=this.getZoomProps(),Bu=Bx.card||0;BD(AS.CONTROL_STYLE,By,Bq);if(Bx.t===M&&Bx.dt&&Bx.dt!==Bh.DataTypeDouble&&Bx.dt!==Bh.DataTypeInteger&&Bx.dt!==Bh.DataTypeCellFormatData){BD(AS.CONTROL_METRIC_CONDITION_TYPE,1,Bq);}if(Bp){BD(AS.CONTROL_ORIENTATION,Bp,Bq);}if(B0){B2.Height=C.toLocaleString(Ak.px2Inches(Bz,B0));}if(Bo){B2.Width=C.toLocaleString(Ak.px2Inches(Bz,Bo));}if(Bw!==undefined){BD(AS.Z_INDEX,Bw,Bq);}if(Bu===0||Bu>50){BD(AS.CONTROL_ITEM_WIDTH_MODE,1,Bq);}if(Bt!==undefined){BD(AS.CONTROL_SHOW_ELEMENT_COUNT,Bt,Bq);}BD(AS.CONTROL_EXPORT_AS_SHOWN_ON_WEB,1,Bq);Br.push({act:"format",unitType:BC.SELECTOR,keyContext:Bv,formatType:1,format:Bq});if(Bx.isTopRank){Br.push(this.getDataService().getSelectorExpressionAction({ck:Bv,ckey:Bn,srcid:Bx.did,srct:Bx.t,f:1,ft:2,cs:Bx.cs,dtp:Bh.DataTypeReal,type:1,include:true,changeQual:true,qt:Bx.qt,unset:false}));}if(By!==3){Br.push({act:"setControlShowAll",nodeKey:Bs,controlKey:Bn,showAll:true});}return Br;},clearMapLayout:function q(){delete this.mapLayKeys;delete this.replaceKeyBoxes;},isInDataset:function c(Bo,Bq,Bn){Bn=Bn||["att","mx"];var Bp=this.datasets[Bo]||{};foundIt=false;BN.forEach(Bn,function(Br){AQ.forEach(Bp[Br]||{},function(Bs){foundIt=Bs.did===Bq;return !foundIt;});return !foundIt;});return foundIt;},findDatasetIdFromUnit:function(Bo){var Bn=null;AQ.forEach(this.datasets,function(Bp,Bq){AQ.forEach((Bp.att||[]).concat(Bp.mx),function(Br){if(Br.did===Bo){Bn=Bq;return false;}});if(!!Bn){return false;}});return Bn;},findUnitNameInDataSetFromUnit:function(Bo){var Bn=null;AQ.forEach(this.datasets,function(Bp,Bq){AQ.forEach((Bp.att||[]).concat(Bp.mx),function(Br){if(Br.did===Bo){Bn=Br.n;return false;}});if(!!Bn){return false;}});return Bn;},addShortcutMetric:function(Bp,Bq){var Bn=Bp.items,Bo=this;Bo.execute({execute:function(){this.submit(AQ.copyProps(["dsid","nodeKey","treeType","funcType","funcType2","prs","breakBys"],Bp,{act:"addShortcutMetric",units:Bn&&Bn.length?Bn.map(function(Br){return{id:Br.did,type:Br.t};}):[]}),Bq,{style:{params:{treesToRender:1}}});},urInfo:{callback:Bq}});},submitDataDefnUpdate:function e(Bn,Bo){this.getDataService().submitUpdates(Bn,Bo,Bj);},rebuildUnitFromDataCache:function AN(Bp,Bo,Bn){return Bn.build([this.getLayoutDataCache(this.getCurrentLayoutKey())[Bp]],this,{pk:Bo})[0];},getDocBuilder:function X(){return this.controller.view.builder;},submitUndoRedoFormatChange:function Aa(Bv,Bo,Bq,By,Bp){var Bt=this,Bu=Bv.k,Br=Bv.id,Bn=Bv.parent,Bs=function(Bz){var B0=[];AQ.keyarray(Bz).forEach(function(B1){B0.push(Bt.getUnitFormatAction(Bv,B1,Bz[B1]));});return B0;},Bw=!!(By&&By.success);this.controller.submitUndoRedoUpdates(Bs(Bo),{},m.wrapMethods({success:function Bx(B0){Bt.partialUpdate(B0.data,Bt.getTargetDefn(Bu),B0.defn,[Bu]);if(!Bw){var Bz=mstrmojo.all[Br];Bn.selectVIUnit(Bn.rebuildChild(Bz),true);}}},By),Bp||Bj);},removePageByUnit:function BL(Bn,Bp){var Bs=this.getDataService(),Bo=this,Bq=false,Bt={success:function Br(Bu){Ag.call(Bo,true)(Bu);Bn.setOpenStatus(Bq,true);Bq=!Bq;}};this.cmdMgr().execute({execute:function(){var Bu=Bo.getVIComponent(Bb),Bv=Bs.newUpdate(this,{actions:[Bs.getRemoveCtrlAction(Bp.ckey,[Bu.k,Bo.getVIComponentKey(A7)]),Bo.getUnitFormatAction(Bu,1,BD(AS.VISIBLE,false))],callback:Bt});this.submitUpdate(Bv);},urInfo:{callback:Bt}});},changePageByStyle:function x(Bn,Bo){var Bq=Bn.ckey,Bp=this.getUnitFormatAction(Bn.node,1,BD(AS.CONTROL_ORIENTATION,1,BD(AS.CONTROL_STYLE,Bo)));this.controller.submitUndoRedoUpdates(Bp,null,{success:Ag.call(this,false,[Bq])},Bj);},changeFilterTargets:function AF(Bq,By,Bs,Bo,Bn){var Bw=this.getDataService(),B1=Bq.defn,Bt=B1.ck,Bu=B1.srct,Br=B1.srcst,Bv=Bq.k,B0=Bs.filter(function(B2){return By.indexOf(B2)<0;}),Bz=By.filter(function(B2){return Bs.indexOf(B2)<0;}),Bx=function(B3){var B4=this.getTargetDefn(B3)[B3],B2=B4.ck;if(B2){B3=BT(B2).nodeKey;}return B3;}.bind(this),Bp=Bz.map(function(B2){B2=Bx(B2);return Bw.getRemoveCtrlTargetAction(Bt,B2,B2,Bo);}).concat(B0.map(function(B3){var B4=Ar(Bu,Br),B2=B2;B3=Bx(B3);B2=(B3&&B4)?false:B2;return Bw.getAddCtrlTargetAction(Bt,B3,B3,B4,B2,Bn);}.bind(this)));if(Bp.length===0){return ;}this.controller.submitUndoRedoUpdates(Bp,null,{success:function(B3){var B4=this.getVizContentPanel().getUnitByKey(Bv),B2=[Bv].concat(B0).concat(Bz).join(O);this.partialUpdate(B3.data,this.getTargetDefn(B2),B3.defn,[Bv]);if(B4){B4.parent.rebuildChild(B4);}}.bind(this)},Bj);},changeFilterStyle:function BS(Bt,Bv,Bx){var Bw=Bt.isInFilterPanel(),Bs=Bt.style,B1=Bt.k,B2=Bt.defn.srct,Bu=Bt.node.data.ces||[],Bo=BD(AS.CONTROL_STYLE,Bv),Bz=Bx?1:(Bx===false?-1:0),Bq=mstrmojo.DocSelector.STYLES,B0=this.getDatasetUnits(["att","mx"],function(B3){return B3.did===Bt.defn.srcid;})[0],Bn,By={style:{params:{treesToRender:1}}};if(!Bz){switch(Bv){case Bq.RADIO:Bz=-1;break;case Bq.PULLDOWN:case Bq.BUTTON:case Bq.LINK:case Bq.LIST:Bz=Bu.length<=1?-1:1;break;case Bq.CHECKBOX:case Bq.SCROLLER:case Bq.SEARCH_BOX:Bz=1;break;}}if(Bz){BD(AS.CONTROL_MULTISELECT,Bz>0,Bo);}if(Bw){var Br=function(B3){return(B3===Bq.SCROLLER||B3===Bq.METRIC_QUAL||B3===Bq.METRIC_SLIDER)?1:0;};Bn=Br(Bv);if(Br(Bs)!==Bn){BD(AS.CONTROL_ORIENTATION,Bn,Bo);}BD(AS.HEIGHT,mstrmojo.boxmodel.px2Inches(this.getZoomProps(),this.getCtrlHeightByStyle(Bv,B0.card||((Bv===Bq.RADIO||Bv===Bq.CHECKBOX)?BB:0)+(Bt.showall?1:0))),Bo);}else{Bn=(Bt.parent.orientation==="h")?1:0;BD(AS.CONTROL_ORIENTATION,Bn,Bo);}if((B2===M)||(Bs===Bq.SEARCH_BOX&&Bt.defn.sos)||(Bs===Bq.ATTR_QUAL)||(Bv===Bq.ATTR_QUAL)){By=Bj;}var Bp=function(){var B5=this,B4=B5.controller,B3=B4.cmdMgr;this.controller.submitUndoRedoUpdates(this.getUnitFormatAction(Bt,1,Bo),null,{failure:function(B6,B8){var B7=null;if(B6.code==BE.DFC_QRYENG_RES_TRUNC){B7=function(){B3.cmds.pop();B3.pos--;Bt.skipUR=true;B5.changeFilterStyle(Bt,Bq.SEARCH_BOX);};}mstrmojo.error({longDesc:B6.message},B7,{onClose:B7,title:"Error"});},success:function(B7){this.updateDefnCache(B7.defn,[B1]);this.updateDataCache(B7.data,this.getTargetDefn(B1));if(Bt.skipUR){Bt.skipUR=false;B3.cmds.pop();B3.pos--;}if(Bw){var B8=this.getVIComponent(Ae.FILTER_PANEL);B8.rebuildChild(B8.children.filter(function(B9){return B9.k===B1;})[0]);}else{var B6=this.getVizContentPanel().getUnitByKey(B1);B6.parent.rebuildChild(B6);}}.bind(this)},By);}.bind(this);if(By===Bj&&Bv!==Bq.SEARCH_BOX&&B0&&B0.card>2000){mstrmojo.warn(mstrmojo.desc(13140,"This attribute has ## distinct values. Changing the display style may take a long time or potentially cause instability. Are you sure you want to continue?").replace("##",B0.card),{confirmBtn:{fn:Bp}},{cssClass:"filterPanel-confirm"});}else{Bp();}},changeUnitFormatProperty:function Q(Bq,Bn){var Bo=Bq.parent,Br=Bq.k,Bp=this;this.saveUnitFormatProperty(Bq,Bn,{success:function(Bs){Bp.partialUpdate(Bs.data,Bp.getTargetDefn(Br),Bs.defn,[Br]);Bo.selectVIUnit(Bo.rebuildChild(Bo.getUnitByKey(Br)),true);}},mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION);},saveUnitFormatProperty:function AC(Bu,Bs,Bv,Bo,Bq){var Bt=this.getDataService(),Bn=Bu.parent,Br=Bu.k,Bp=this;Bq=Bq||{callback:Bv};this.execute({execute:function(){var Bw=Bt.newUpdate(this,{extras:Bo});[].concat(Bs).forEach(function(Bx){Bw.addActions(Bp.getUnitFormatAction(Bn.getUnitByKey(Br),Bx.formatType,BD(Bx.propertyName,this.getStateValue(Bx.newValue,Bx.oldValue))));},this);Bw.addCallbacks(Bv);Bw.submit();},urInfo:Bq});},getKeepOnlyOrExcludeAction:function BG(Bn,Bo){var Bq=this,Bp={},Br;BN.forEach(Bo,function(Bs){BN.forEach(Bs.data,function(Bt){BN.forEach(Bt,function(Bu){if(BV.isNonGroupNull(Bu)){Bu.eid="h"+BV.TERSE_NULL+";"+Bu.tid;}else{Br=Bu.tid;if(Bp[Br]===undefined){Bp[Br]=!!Bq.getDEObject(Br);}Bu.isDe=Bp[Br];}});});});return{act:"keepOnly",keyContext:Bn,selectorObjects:[].concat(Bo),partialRetrieval:{nodes:[Bn].concat(this.getSourceFilterKeys(Bn))}};},partialUpdateAndRebuildChild:function A4(Bq,Bn,Bo){if(!Bn.data&&!Bn.defn){return ;}var Bp=[Bn.data,this.getTargetDefn(Bq.k)];if(Bo){Bp=Bp.concat([Bn.defn,Bo]);}this.partialUpdate.apply(this,Bp);if(Bq.clearCache){Bq.clearCache();}return Bq.parent.rebuildChild(Bq);},getUpdateHiddenPanelsCallback:function Ac(){var Bn=this;return{success:function(Bp){if(Bp.pukeys){var Bq=Bn.getUnitDefinitions(Bp.pukeys),Br=Bn.partialUpdate(Bp.data,Bq),Bo=Object.keys(Bq).filter(function(Bs){return Object.keys(Br.def).indexOf(Bs)===-1;});Bo.forEach(function(Bv){var Bt=Bn.getWidgetId({k:Bv,wid:1}),Bu=Bt&&mstrmojo.all[Bt],Bs;while(Bu){Bs=Bu.defn;if(Bs&&Bs.t===mstrmojo.EnumRWUnitType.PANEL&&Bu.setDirty){Bu.setDirty(true);break;}Bu=Bu.parent;}});}}};},getUpdateHiddenLayoutsCallback:function t(){var Bn=this;return{success:function(Br){var Bq=Br.pukeys&&Br.pukeys.split("\u001E");if(Bq&&Bq.length>0){var Bo=Bn.getUnitDefinitions(Bq);var Bp=function(Bu){var Bt=Bu.defn;if(Bt.units[Bs]!==undefined){Bt.loaded=false;}};for(var Bs in Bo){if(Bo[Bs]===undefined){(Bn.controller.view.getLayouts()||[]).forEach(Bp);}}}}};},submitSelectorPropsChange:function AU(Bo,Bq){var Bp=this,Br=Bo.defn.ck,Bt=Bo.k,Bn=Bo.parent;this.controller.submitUndoRedoUpdates(AQ.copy(Bq,{act:"editSelectorProps",keyContext:Br,ctrlKey:Bo.k,partialRetrieval:{nodes:[this.getDataService().getNodeKeyFromKeyContext(Br)]}}),{},{success:function Bs(Bv){Bp.partialUpdate(Bv.data,Bp.getTargetDefn(Bt),Bv.defn,[Bt]);var Bu=Bn.getUnitByKey(Bt);Bn.selectVIUnit(Bn.rebuildChild(Bu),true);}},Bj);},getDEObject:function A1(Bq){var Bp=this.deMap=this.deMap||{},Bo=Bp[Bq],Bn;if(!Bo){AQ.forEach(this.datasets,function(Bt,Br){Bn=BN.find(Bt.att,"did",Bq);var Bs=Bt.att[Bn];if(Bn>=0&&Bs.t===47&&Bs.st===12033){Bo=Bs;Bo.dsId=Br;Bp[Bq]=Bo;return false;}});}return Bo;},getBrowseFormTypes:function w(Bp){var Bo=[],Bn;AQ.forEach(this.datasets,function(Bq){Bn=BN.find(Bq.att,"did",Bp);if(Bn>=0){BN.forEach(Bq.att[Bn].fs,function(Br){if(Br.isbf){Bo.push(Br.bftp);}});return false;}});return Bo;},isOldDEObject:function BJ(Bp){var Bo=false,Bn;AQ.forEach(this.datasets,function(Bq){Bn=BN.find(Bq.att,"did",Bp);if(Bn>=0&&Bq.att[Bn].de){Bo=true;return false;}});return Bo;},changeCurrLytTabTtl:function A8(Bo,Bn){this.controller.view.changeCurrLytTabTtl(Bo,Bn);},updateRootDefn:function BH(Bn){AQ.copy(Bn&&Bn.root,this.getRootNode().defn);this.raiseEvent({name:"updateRootDefn"});},addUpdateObjects:function AI(Bo,Bn){if(Bo){Bo.partialUpdate=Bo.partialUpdate||{};Bo.partialUpdate.objects=mstrmojo.array.ensureArray(Bn);}return Bo;},updateTypeCounter:function G(Bo){var Bn=BP.call(this,Bo)+1;this.obCntrs[this.getCurrentLayoutKey()][Bo]=Bn;return Bn;},getNumberFormatAction:function Ai(Bs,Bo,Br){var Bq=this.getVIComponent(Ae.FILTER_STACK),Bn=Bq&&Bq.getFilterBySrcId(Bs),Bp=AQ.copy({act:"numberFormat",unitId:Bs,unitType:Bo},this.createNumberFormatParams(Br));if(Bo===4&&Bn){Bp.partialRetrieval={nodes:[Bn.k]};}return Bp;},isFromSolrCube:function Z(Bp){var Bo=this.datasets[this.findDatasetIdFromUnit(Bp)],Bn=Bo&&Bo.tables&&Bo.tables.length===1&&Bo.tables[0];return Bn&&Bn.dict===131078;},isFromMDXCube:function Bm(Bn){return this.isMDXDataset(this.datasets[this.findDatasetIdFromUnit(Bn)]);},isMDXDataset:function Aq(Bn){return Bn.tables&&Bn.tables[0]&&Bn.tables[0].xdaType===2;},isDatasetHasRecursiveAttribute:function g(Bn){return Bn&&Bn.att&&Bn.att[0]&&Bn.att[0].t===S&&Bn.att[0].st===BI;},hasMDXRADataset:function n(Bo){var Bn=false;Bo=Bo||this.datasets;AQ.forEach(Bo,function(Bp){if(this.isMDXDataset(Bp)&&this.isDatasetHasRecursiveAttribute(Bp)){Bn=true;return false;}},this);return Bn;},hasNonRADataset:function b(Bo){var Bn=false;Bo=Bo||this.datasets;AQ.forEach(Bo,function(Bp){if(!(this.isMDXDataset(Bp)&&this.isDatasetHasRecursiveAttribute(Bp))){Bn=true;return false;}},this);return Bn;},isMDXTable:function Ax(Bn){return Bn.xdaType===2;},isDDADataset:function BA(Bn){return Bn.st===779&&Bn.dsm===F.dda;},isDataImportRemoteDataSource:function A6(Bn){return Bn.tables&&Bn.tables[0]&&Bn.tables[0].xdaType===400;},createNumberFormatParams:function BR(Bp){var Bn=Bp.category,Bo={c:Bn,f:Bp.format};var Br=Bp.decimalPlaces,Bq=Bp.negativeNumbers;switch(Bn){case 0:Bo.ndp=Br;Bo.nth=Bp.thousandSeparator;Bo.nnn=Bq;break;case 1:Bo.ndp=Br;Bo.ncs=Bp.currencySymbol;Bo.ncp=Bp.currencyPosition;Bo.nnn=Bq;break;case 4:Bo.ndp=Br;Bo.nnn=Bq;break;case 6:Bo.ndp=Br;break;}return Bo;},_selsWarningFlags:null,openSelWarnFlag:function BW(Bo){var Bn=this._selsWarningFlags=this._selsWarningFlags||{};Bn[Bo]=true;},closeSelWarnFlag:function AZ(Bo){var Bn=this._selsWarningFlags=this._selsWarningFlags||{};Bn[Bo]=false;},isSelWarnFlagOn:function E(Bo){var Bn=this._selsWarningFlags;if(Bn){return !!Bn[Bo];}return false;},allowManageDocumentDataset:function Bd(){return !a("web-disable-manage-document-dataset");},allowNewOrEditRolapDS:function W(){return !a("vi-unsupport-create-edit-rolap-report");},allowNewOrEditDummyDS:function A9(){return !a("vi-unsupport-create-edit-dummy-dataset");},allowSaveDataset:function BQ(){return !a("disable-save-dataset");},allowAccessDataFromFile:function AH(){return !a("disable-access-data-from-file");},allowAccessDataFromDatabase:function z(){return !a("disable-access-data-from-database");},allowAccessDataFromCloudApp:function At(){return !a("disable-access-data-from-cloud-app");},allowImportData:function Aj(){return this.allowAccessDataFromFile()||this.allowAccessDataFromDatabase()||this.allowAccessDataFromCloudApp();},allowReExecuteRegularReport:function Au(){return !a("disable-reexecute-regular-report");},allowReExecuteViewReport:function Aw(){return !a("disable-reexecute-view-report");},allowReExecuteCubeReport:function T(){return !a("disable-reexecute-cube-report");},isSchemaDefined:function V(){return !!a("web-is-schema-defined");},hasPrivilegesForAllTables:function A5(Bo){var Bn=true;Bo.forEach(function(Bp){switch(Bp.xdaType){case An.text:case An.excel:case An.refine:case An.dataImportOAuthGDrive:case An.dataImportOAuthDropbox:if(!this.allowAccessDataFromFile()){Bn=false;return ;}break;case An.dataImportOAuthGBigQuery:case An.dataImportOAuthGBigQueryFFSQL:case An.dataImportOAuthGBigQuerySingleTable:case An.qbSingleTable:case An.ffsql:case An.querybuilder:case An.mdx:if(!this.allowAccessDataFromDatabase()){Bn=false;return ;}break;case An.salesforce:case An.dataImportOAuthGAnalytics:case An.twitter:case An.facebook:if(!this.allowAccessDataFromCloudApp()){Bn=false;return ;}break;}},this);return Bn;},getOpenDatasetPanelAction:function BY(){var Bn=this.controller.rootCtrl.datasetsPanel;if(Bn.getOpenStatus()!==true){Bn.setOpenStatus(true,true);return[this.getUnitFormatAction(this.getRootNode(),1,{FormattingAnalysis:{DatasetObjectsVisible:true}},true)];}return[];},populateAttributeIdLinkInfo:function Ao(){var Bo=this.als;if(!Bo){return ;}if(!Bo.idLinks){Bo.idLinks={};var Bn=Bo.idLinks;BN.forEach(Bo,function(Bp){AQ.forEach(Bp,function(By,Bz){var Bx=Bz.split(" "),Bw=By.split(" "),Bt=Bx[0],Bs=Bw[0],Bv,Bu;Bn[Bt]=Bn[Bt]||[];Bv=Bn[Bt];BN.forEach(Bv,function(B0){Bn[B0]=Bn[B0]||[];Bn[B0].push(Bs);});Bn[Bt].push(Bs);if(!!Bn[Bs]){var Br=Bn[Bs];BN.forEach(Br,function(B0){if(B0!==Bt&&Bn[Bt].indexOf(B0)===-1){Bn[Bt].push(B0);}});}Bn[Bs]=Bn[Bs]||[];Bu=Bn[Bs];BN.forEach(Bu,function(B0){Bn[B0]=Bn[B0]||[];Bn[B0].push(Bt);});Bn[Bs].push(Bt);if(!!Bn[Bt]){var Bq=Bn[Bt];BN.forEach(Bq,function(B0){if(B0!==Bs&&Bn[Bs].indexOf(B0)===-1){Bn[Bs].push(B0);}});}});});}},warnForEditStandaloneDS:function(Bp,Bn,Bo){if(!Bp.mngd){mstrmojo.confirm(mstrmojo.desc(13525,"Modifications to this dataset will affect other reports, documents, and dashboards that share the dataset. Do you want to continue?"),{confirmBtn:{fn:function(){Bn();}},cancelBtn:{t:mstrmojo.desc(221,"Cancel"),fn:Bo}});}else{Bn();}}});mstrmojo.vi.models.DocModel.DatasetUnitType=null;mstrmojo.vi.models.DocModel.UnitFormatInfo=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasBuilder","mstrmojo._IsRwDocument","mstrmojo.express.ui._IsDocumentView","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.DocBuilder","mstrmojo.vi.ui.VisualizationEditor","mstrmojo.vi.ui.tabs.LayoutTabStrip","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.css","mstrmojo.vi.ui.rw.xtab.XtabMenuConfig");var M=mstrmojo.array,Y=mstrmojo.func,R=mstrmojo.hash;function I(n,k){var g=mstrmojo.desc(11450,"## copy ###"),e=M.find(n,"k",k),m=n[e],f=m.numDupl===0?g.replace("###","").replace("##",m.n):g.replace("###",m.numDupl).replace("##",m.n),l={};(n||[]).forEach(function(h){l[h.n]=true;});while(l[f]){m.numDupl++;f=g.replace("###",m.numDupl).replace("##",m.n);}return f;}function L(f,g,h){var e=this.model;return{success:function(k){var l=this.replaceLayout(null,e.getChildren(k,false,f,1)[0],f);this.selector.setTabs(this.getLayouts(),g);e.currlaykey=k.currlaykey;this.reDisplayLayout(h,l);}.bind(this),failure:function(k){mstrApp.onerror(k);}};}function H(e){return{success:function(){var f=e.replaceKeyBoxes,g=e.cmdMgr().getInterimCmd(),h=e.getDataService().newUpdate(g,{extras:mstrmojo.DocDataService.SUPPRESS_DATA});if(f&&f.length>0){M.forEach(f,function(k){k.addSaveBoxLayoutActions(h,true);});}e.clearMapLayout();g.submitUpdate(h,e.cmdMgr().CMD_PHASE.LAST);}};}function a(){var e=this.selector,f=this.model.tsp!==0,h=f?"bottom":"top",g=e.hasRendered;if(g){this.removeChildren(e);}e.slot=h+"CtrlNode";e.set("isAlignBottom",f);if(g){this.addChildren([e]);}}mstrmojo.vi.ui.DocumentView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasBuilder,mstrmojo._IsRwDocument,mstrmojo.express.ui._IsDocumentView,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.DocumentView",markupString:'<div id="{@id}" class="mstrmojo-VIDocument {@cssClass}" style="{@cssText}" ><div></div><div class="mstrmojo-VIDocument-doc"></div><div></div></div>',markupSlots:{topCtrlNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.childNodes[1];},bottomCtrlNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{topCtrlNode:"auto",containerNode:"100%",bottomCtrlNode:"auto"},w:{topCtrlNode:"100%",containerNode:"100%",bottomCtrlNode:"100%"},xt:true},hasDataSource:false,selector:null,layoutViewer:null,model:null,builder:null,renderedLayoutsQueue:[],LAYOUTS_CACHE_SIZE:10,init:function X(f){this._super(f);var e=this.model;this.addDisposable(this.builder=new mstrmojo.vi.ui.DocBuilder({parent:this,model:e}));e.attachEventListener("tspChange",this.id,a);a.call(this);},children:[{scriptClass:"mstrmojo.vi.ui.tabs.LayoutTabStrip",alias:"selector",isStatic:true}],buildChildren:function D(){var e=this.selector,g=this.editor,f=[e];if(g){f.push(g);}var h=this._layouts=this._super(true);this.addChildren(f);e.setTabs(h,this.model.getCurrentLayoutKey());},onRender:function G(){var e=this.getSelectedLayoutWidget();this.addChildren([e]);this.selector.setStatic(false);},pushToRenderedQueue:function T(h,k){var e=this.renderedLayoutsQueue||[];if(e.indexOf(h.k)===-1){e.push(h.k);if(e.length>this.LAYOUTS_CACHE_SIZE){var g=e.shift(),l=this._layouts,f=l[M.find(l,"k",g)]||{};if(f.hasRendered&&g!==k.k){f.unrender();}}}},showLayout:function Q(f,k,h){var g=f.k,e=this.getSelectedLayoutWidget();if(g!==e.k){this.getNewLayout({layoutKey:g},this._layouts,true,{success:function(l){this.reDisplayLayout(e,l,k);}.bind(this)},h);return true;}return false;},reDisplayLayout:function E(l,o,r){var g=this.selector,k=this.model,f=k.getSelectedViUnit(),h=f&&f.k,m=o.k,q=this._layouts;g.setStatic(true);var n=(this.children||[]).filter(function(v){return v.k===m;})[0];if(n){o=this.rebuildChild(n);}else{this.removeChildren(l);this.pushToRenderedQueue(l,o);this.addChildren([o]);if(o.isBoxLayoutDirty){o.updateRootBoxLayout();o.buildBoxLayout();delete o.isBoxLayoutDirty;}}var p=M.find(q,"k",m);q[p]=o;(n||o).raiseEvent({name:"layoutRedisplay"});this.updateXtabStyles(m);var t=k.getVizContentPanel(),e=h&&t.getUnitByKey(h);if(e){t.selectVIUnit(e,true);}else{t.selectFirstBox();}g.setSelectedTab(m);g.setStatic(false,true);var u=this.controller.rootCtrl;u.generateToolbar();if(r){r();}if(mstrApp.isAppStatePresentation()){this.layoutViewer.syncFilterPanelStack();}this.doLayout();},replaceLayout:function S(h,f,g){var k=this._layouts||[],e=M.find(k,"k",h&&h.k);if(e>=0){h.unrender();h.destroy();this.model.getDocBuilder().removeVIMapRef(h.k);}var l=this.builder.build([f],this.model)[0];if(e>=0){k[e]=l;}else{M.insert(k,g,[l]);}this._layouts=k;return l;},destroy:function b(e){(this._layouts||[]).forEach(function(f){f.destroy(e);});this.builder.destroy();this._super(e);},getLayouts:function(){return this._layouts;},updateLayouts:function(f){var o=this.getLayouts(),h=[],e=this.model.getChildren(f,false),l=this.getSelectedLayoutWidget(),g=this.selector,k,p,n;for(k=0;k<e.length;k++){p=e[k].k;n=M.find(o,"k",p);if(n<0){this.replaceLayout(null,e[k]);}else{if(e[k].data.loaded&&this.model.currlaykey!==f.currlaykey){this.replaceLayout(o[n],e[k]);}}}for(k=0;k<o.length;k++){n=M.find(e,"k",o[k].k);if(n<0){var m=o.splice(k,1)[0];g.deleteTab(k);m.unrender();m.destroy();k--;}}for(k=0;k<e.length;k++){p=e[k].k;n=M.find(o,"k",p);if(n>=0){h.push(o[n]);}}this._layouts=h;this.model.currlaykey=f.currlaykey;g.setTabs(this._layouts,f.currlaykey);this.reDisplayLayout(l,this.getSelectedLayoutWidget());},moveLayout:function V(e,o){var k=this,g=this.model,n=this._layouts,f=function(p,q){g.moveLayout(p,q);n.splice(q,0,n.splice(p,1)[0]);};g.execute({execute:function l(){var p=g.getMoveLayoutAction(e,o);f(e,o);this.submitSilent(p);},urInfo:{undo:function m(){f(o,e);k.selector.moveTab(o,e,o,true);return true;},redo:function h(){f(e,o);k.selector.moveTab(e,o,e,true);return true;}}});},deleteLayout:function C(f,n){var k=this._layouts,e=M.find(k,"k",f),m=this.id,l=true,g=function(q){var u=mstrmojo.all[m],t=k.splice(e,1)[0],p=l?u.model.getChildren(q,false):k,o=q.currlaykey,r=M.find(p,"k",o),v;if(l){v=u.replaceLayout(k[r],p[r],r);}else{v=p[r];}u.selector.deleteTab(e);u.selector.setTabs(u.getLayouts(),o);u.model.currlaykey=o;u.reDisplayLayout(t,v);t.unrender();t.destroy();u.model.getDocBuilder().removeVIMapRef(f);};this.model.removeLayout(f,{success:g},n);var h=e+1;if(!k[h]){h=e-1;}this.model.getDataService().setCurrentDocLayout(k[h].k,null,n);l=this.needLoadLayout(k[h]);n.setTreesToRender(l?3:1);},duplicateLayout:function N(k,e){var g=this.getLayouts(),f=M.find(g,"k",e)+1,h=this.model.getNextKey();this.model.duplicateLayout(k,{srcKey:e,destKey:h,name:I(g,e),index:f+1},Y.wrapMethods(L.call(this,f,h,this.getSelectedLayoutWidget(),k),H(this.model)));},addNewLayout:function d(k,f,h){var g=(h&&h.nodeKey)||this.model.getNextKey(),e=this.getLayouts().length;f=(0<=f&&f<e)?f:e;this.model.addNewLayout(k,R.copy(h,{nodeKey:g,index:f+1}),Y.wrapMethods(L.call(this,f,g,this.getSelectedLayoutWidget()),H(this.model)));},importDashboard:function J(l,f,k){var h=(k&&k.nodeKey)||this.model.getNextKey(),e=this.getLayouts().length,g=this.model.controller;f=e;this.model.addExistingLayouts(l,R.copy(k,{index:f+1}));},getSelectedLayoutWidget:function P(){return(this._layouts||[]).filter(function(e){return(e.k===this.model.getCurrentLayoutKey());},this)[0];},showSelectedLayout:function A(){var e=this.getSelectedLayoutWidget();if(this.containerNode.children.length>0){return ;}(this.children||[]).filter(function(f){return f.k===e.k;}).forEach(function(f){this.removeChildren(f);f.destroy();},this);this.addChildren([e]);},getViPanel:function W(e){return this.getSelectedLayoutWidget().getViPanel(e);},selectViPanel:function c(f){var e=this.getViPanel(f);if(e){e.parent.selectPanel(e);}else{this.openViPanel(f);}},openViPanel:function B(e,f){this.getSelectedLayoutWidget().openViPanel(e,f);},onAppStateChange:function U(){this.selector.set("visible",(!mstrApp.isAppStatePrintPreview())&&(!mstrApp.isAppStatePresentation()||this._layouts.length>1));},onLayoutSelected:function O(h){var e=this.model,g=e.controller.cmdMgr,f=g.getInterimCmd();if(f){f.submitUpdate(h,g.CMD_PHASE.LAST);}else{e.execute({execute:function(){this.submitUpdate(h,g.CMD_PHASE.LAST);},urInfo:{treesToRender:3}});}},loadDocLayout:function K(e,h,g){var f=!g;g=g||this.model.getDataService().newUpdate();this._super(e,h,g);if(f){this.onLayoutSelected(g);}},setCurrentDocLayout:function F(e,g,f){f=f||this.model.getDataService().newUpdate(this);this._super(e,g,f);f.setTreesToRender(1);this.onLayoutSelected(f);},changeCurrLytTabTtl:function Z(h,e){var f=this.selector,g=f.getSelectedTab();if(g){g.set("title",h);g.titleEdited(h,e);}},getXtabCellMenuConfig:function(e){return new mstrmojo.vi.ui.rw.xtab.XtabMenuConfig(e);}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.DocumentView,{onhasDataSourceChange:function(){mstrmojo.css.toggleClass(this.domNode,"noDataSource",!this.hasDataSource);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css","mstrmojo.array","mstrmojo.Model","mstrmojo.IncFetch","mstrmojo.Label","mstrmojo.ui.ButtonBar","mstrmojo.ui.List","mstrmojo.mstr.search.SearchIconView","mstrmojo.mstr.search.SearchGridView","mstrmojo.mstr._ObjectActions");mstrmojo.requiresDescs(3364,3366,9202,14557);var D=mstrmojo.desc,H=mstrmojo.css,C=mstrmojo.hash;mstrmojo.mstr.search.SearchResults=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.mstr.search.SearchResults",markupString:'<div id="{@id}" class="mstrmojo-SearchResults {@cssClass}"><div class="mstrmojo-SearchResults-list"></div><div class="mstrmojo-SearchResults-toolbar"></div><div class="mstrmojo-SearchResults-if"></idv></div>',markupSlots:{listNode:function(){return this.domNode.firstChild;},toolbarNode:function(){return this.domNode.childNodes[1];},incFetchNode:function(){return this.domNode.lastChild;}},markupMethods:{onresultsChange:function(){if(this.hasRendered){this.listNode.style.height=this.results&&this.results.items&&this.results.items.length>0?"":0;}}},height:"430px",supportIncFetch:true,results:{},iconView:false,init:function I(L){if(this._super){this._super(L);}this.addChildren([this.getViewRef(),{scriptClass:"mstrmojo.Label",alias:"notFoundMsg",cssText:"text-align: center",allowHTML:true,visible:false,ontextChange:function(){this.set("visible",!mstrmojo.string.isEmpty(this.text));},slot:"listNode"},{scriptClass:"mstrmojo.ui.ButtonBar",items:[{n:"Icon View",v:1,css:"iconView"},{n:"Grid View",v:2,css:"gridView"}],showIcon:true,cssClass:"viewModesButtonBar",selectedIndex:1,postselectionChange:function(O){var P=this.items,Q=P[O.added[0]],R=P[O.removed&&O.removed[0]];if(Q.v!==R.v){this.parent.set("iconView",Q.v===1);}},bindings:{visible:function(){return !this.parent.notFoundMsg.visible&&this.parent.list.visible;}},slot:"toolbarNode"}]);if(this.supportIncFetch){var M=this;this.addChildren([{scriptClass:"mstrmojo.IncFetch",alias:"incFetch",slot:"incFetchNode",np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onifsChange:function N(O){mstrmojo.hash.copy(O.value,this);if(this.np>1){this.children=null;this.refresh();}H.toggleClass(this.domNode,"show",this.np>1);},onfetch:function K(O){M.onfetch(O);}}]);}},getViewRef:function F(){var K=this.iconView?"mstrmojo.mstr.search.SearchIconView":"mstrmojo.mstr.search.SearchGridView";return{scriptClass:K,alias:"list",slot:"listNode",bindings:{visible:function(){return this.items&&this.items.length>0;}}};},oniconViewChange:function A(){this.removeChildren(this.list);this.addChildren([this.getViewRef()]);this.renderChildren();this.onresultsChange();},onresultsChange:function J(){this.list.set("items",this.results&&this.results.items);this.updateNotFoundMsg();this.updateIncFetch();},updateNotFoundMsg:function G(){var K=this.parent,L=K?K.getNotFoundMsg():"";this.notFoundMsg.set("text",K.hasUserInput()&&C.isEmpty(this.results&&this.results.items)?L:"");},updateIncFetch:function B(){var K=this.results;if(this.supportIncFetch){var L=this.getTotalSize(),N=K.bb,M=K.bc;this.incFetch.set("ifs",{np:Math.floor(L/M)+((L%M>0)?1:0),cp:Math.floor(N/M)+((N%M>0)?1:0)});}},getTotalSize:function E(){return Math.min(this.maxSearchResults,this.results.sz);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.mstr.ui.CreateMenu","mstrmojo.ui.menus._HasMenuPopup");var B=mstrmojo.dom;var C="mscld-create-menu";mstrmojo.mstr.ui.CreateButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.mstr.ui.CreateButton",markupString:'<div id="mscld-create" class="mstrmojo-CreateButton mscld-create analysis" title="'+mstrmojo.desc(3291,"Create")+'" mstrAttach:click><span class="mstrMenuItemcreate"><span id="mscld-create-menu" class="mscld-create-menu">'+mstrmojo.desc(3291,"Create")+"</span></span></div>",markupSlots:{menuButtonNode:function(){return this.domNode;}},onclick:function(){var D=mstrmojo.all[C];if(!D){D=mstrmojo.insert({scriptClass:"mstrmojo.mstr.ui.CreateMenu",id:"mscld-create-menu",opener:this,alignMenuToRight:this.alignMenuToRight});}this.toggleButtonClass(true);D.loadCreateMenu();},toggleButtonClass:function(D){if(this.domNode.className.indexOf("open")>0){mstrmojo.css.toggleClass(this.domNode,"open",D);}else{mstrmojo.css.toggleClass(this.domNode,"open",D);}},init:function(E){this._super(E);if(!this._listenerProc){var F=this;var D=this._listenerProc=function(){F.browserResized();};B.attachEvent(window,"resize",D);}},browserResized:function(){if(this.timer){clearTimeout(this.timer);}var D=mstrmojo.all[C];if(D){this.timer=setTimeout(function(){D.createMenu.adjustCornersForPopupOverflow();},100);}},destroy:function A(D){if(this._listenerProc){B.detachEvent(window,"resize",this._listenerProc);}this._super(D);},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.Model","mstrmojo.Container","mstrmojo._HasSuggestion","mstrmojo._IsWebApp","mstrmojo.mstr.search.SearchSettings","mstrmojo.mstr.search.SearchResults");var J=mstrmojo.desc,C=mstrmojo.css,f=mstrmojo.array,q=mstrmojo.string;var e=[16,1,2,4,8],a=e,G=[1,2,4,8],d=[3,8,14081],V=-1;var I={suggest:function(w){return{success:function(AA){if(!mstrmojo.all.search){return ;}if(!w.hasSearchPattern){w.clear();w.hideSuggestion();return ;}w.sItems=AA.items||[];var z,x=w.sItems.length;for(z=0;z<x;z++){w.sItems[z].t=V;}if(x){w.selectedSuggestionIndex=null;}else{w.hideSuggestion();}var AB=AA.items&&AA.items[0]&&AA.items[0].n.toLowerCase();if(AB){w.suggestInputNode.value=AB.replace(new RegExp("^"+w.searchPattern,"i"),w.inputNode.value);w.syncInputWithSuggest();}else{AB=w.searchPattern;}w.suggest=AB;if(w.last_searchPattern!==AB){w.last_searchPattern=AB;window.setTimeout(function(){w.requestResults();},0);}},failure:function(x){mstrmojo.alert(x.status+" : "+x.statusText);},complete:function(x){w.showSpinnerIcon(false);w.handleSearchErrorAndModeSwitching(x);}};},search:function(w){return{success:function(z){if(!mstrmojo.all.search){return ;}var x;for(x in w){this[x]=w[x];}if(!w.hasSearchPattern&&!w.allowEmptyInput){w.clear();w.hideSuggestion();return ;}if(!z){mstrmojo.xhr.abort();w.requestResults();return ;}w.rItems=z.items||[{t:0,dssid:"",n:mstrmojo.desc(9135,"No match found")}];if(w.showAsPopup){w.renderResultsPopup(w.rItems);}else{w.renderResults(z||{});}},failure:function(x){mstrmojo.alert(x.status+" : "+x.statusText);},complete:function(x){w.showSpinnerIcon(false);w.handleSearchErrorAndModeSwitching(x);}};}};var N=function(x){var w=mstrApp.adminInfo;return x.replace("#",(w&&w.length>0?" ("+w+")":""));};var v=function(){if(mstrmojo.dom.isDXIE||mstrmojo.dom.isSafari){var w=this.inputNode;window.setTimeout(function(){w.focus();},10);}};mstrmojo.mstr.search.Search=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasSuggestion,mstrmojo._IsWebApp],{scriptClass:"mstrmojo.mstr.search.Search",noCache:true,suggestionPopupCssClss:"mstrmojo-Search-suggestion",resultsOnly:false,allowEmptyInput:false,showAsPopup:true,allowHTMLOnObjectDesc:false,searchDelay:200,doAutoComplete:true,minSearchLength:1,supportIncFetch:true,searchTootipText:mstrmojo.desc(9168,"Type to search"),enableSuggestion:true,hasSearchPattern:false,searchProps:null,quickSearch:false,includeObjectDesc:true,blockBegin:1,blockCount:10,rootFolderType:39,rootFolderID:null,nameWildcards:16,recursive:1,objectType:[3,8,14081],fields:"name",dereferenceshortcut:"1",dateType:1,created:0,dateSubType:1,intervalUnit:1,intervalValue:1,startDate:"",endDate:"",ownerType:1,description:"",maxObjects:100,searchDomain:2,styleName:"MojoFolderStyle",clearVisible:false,spinnerVisible:false,markupString:'<div class="mstrmojo-Search {@cssClass}" style="{@cssText}"><div class="mstrmojo-Search-settings1"></div><div class="mstrmojo-Search-container"><div class="mstrmojo-Search-input" style="position: relative"  mstrAttach:mousedown><div class="mstrmojo-Search-search" style="position: relative"><input class="searchPattern" maxlength="100" autocomplete="off" {@autofocus}                                   placeholder="{@searchTootipText}"mstrAttach:mousedown,keyup,keydown,blur,paste,cut,input /><div class="SearchBox-tip" n="searchTip"></div></div><div class="mstrmojo-Search-suggest" style="background: none transparent;"><input class="suggestPattern" maxlength="100" autocomplete="off" disabled="disabled" data-act="suggest"/></div></div><div class="mstrmojo-Search-btns" mstrAttach:click><div class="mstrmojo-Search-btnClear" data-act="clear"></div><div class="mstrmojo-Search-btnSpinner" data-act="spinner"></div><div class="mstrmojo-Search-btnSearch" data-act="search"></div></div></div><div class="mstrmojo-Search-btnSettings" data-act="settings" mstrAttach:click>'+mstrmojo.desc(14521,"Refineseaaa")+'</div><div class="mstrmojo-Search-infoIcon" data-act="info"></div><div class="mstrmojo-Search-settings"></div><div class="mstrmojo-Search-result"></div></div>',markupSlots:{settings1ContainerNode:function(){return this.domNode.firstChild;},suggestInputNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1].firstChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[0].firstChild;},searchTipNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1].childNodes[1];},btnsNode:function(){return this.domNode.childNodes[1].childNodes[1];},clearNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[0];},spinnerNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[1];},searchNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[2];},settingsBtnNode:function(){return this.domNode.childNodes[2].childNodes[2];},infoIconNode:function(){return this.domNode.childNodes[3];},settingsContainerNode:function(){return this.domNode.childNodes[4];},resultsContainerNode:function(){return this.domNode.childNodes[5];}},markupMethods:{onclearVisibleChange:function(){C.toggleClass(this.btnsNode,"clear",this.clearVisible);},onspinnerVisibleChange:function(){C.toggleClass(this.btnsNode,"spinner",this.spinnerVisible);C.toggleClass(this.domNode,"searching",this.spinnerVisible);}},init:function p(x){var z=this;this.autofocus=mstrmojo.dom.isSafari?"":"autofocus";if(this._super){this._super(x);}if(this.resultsOnly){C.addWidgetCssClass(this,"resultsOnly");}this.updateQuickSearchEnabled();mstrmojo.hash.copy(x.searchProps,this);this.objectType=f.filter(this.objectType,function(AA){return f.find(z.allowedObjectTypesData,"t",parseInt(AA,10))>-1;});this.maxObjects=parseInt(this.maxSearchResults||this.blockCount,10);var w=new Date();this.endDate=mstrmojo.date.formatDateInfo({day:w.getDate(),month:parseInt(w.getMonth(),10)+1,year:w.getFullYear()},mstrmojo.locales.datetime.DATEOUTPUTFORMAT);this.nameWildcards=(this.pqse?16:1);if(this.rootFolderID){this.rootFolderType=0;}else{this.rootFolderType=(parseInt(this.rootFolderType,10)>=0?this.rootFolderType:39);}this.updateQuickSearchEnabled();},preBuildRendering:function A(){var w=this;this.addChildren([mstrmojo.mstr.search.SearchSettings.getLocationPulldown({rootFolderName:this.rootFolderName,rootFolderType:this.rootFolderType,slot:"settings1ContainerNode"}),mstrmojo.mstr.search.SearchSettings.getSearchTypePulldown({className:"searchType",qse:this.qse,slot:"settings1ContainerNode"}),{scriptClass:"mstrmojo.mstr.search.SearchSettings",alias:"settingsWidget",allowedObjectTypesData:this.allowedObjectTypesData,model:new mstrmojo.Model({settings:{rootFolderType:this.rootFolderType,rootFolderID:this.rootFolderID,nameWildcards:this.nameWildcards,objectType:this.objectType,dereferenceshortcut:this.dereferenceshortcut,dateType:this.dateType,created:this.created,dateSubType:this.dateSubType,intervalUnit:this.intervalUnit,intervalValue:this.intervalValue,startDate:this.startDate,endDate:this.endDate,ownerType:this.ownerType,description:this.description}}),onmodelChange:function(){mstrmojo.hash.copy(this.model.settings,w);w.blockBegin=1;w.delayedRequestResults();},slot:"settingsContainerNode"}]);if(this._super){this._super();}},postBuildRendering:function T(){if(this._super){this._super();}this.showSearchInfoIcon();if(this.showInfoIcon){this.addChildren([{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",bindings:{visible:function(){return this.showInfoIcon||true;}},useRichTooltip:true,richTooltip:{posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"mstrmojo-Search-infoIcon-tip",keepArrowXPos:true,refNode:this.infoIconNode,content:N(mstrmojo.desc(9264))},slot:"infoIconNode"}]);this.renderChildren();}v.call(this);if(this.searchPattern){this.inputNode.value=this.searchPattern;}},getSearchPattern:function O(){if(this.inputNode){this.searchPattern=mstrmojo.string.trim(this.inputNode.value);}else{this.searchPattern=null;}return this.searchPattern;},getRootFolderName:function r(){var w={0:this.rootFolderName,7:J(2,"Shared Reports"),20:J(3,"My Reports"),39:mstrConfig.projectName};return w[this.rootFolderType||39];},getNotFoundMsg:function Z(){var w=function(z){return"<b>"+mstrmojo.string.escape4HTMLText(z)+"</b>";};var x=J(9202,"Your search for ## in ### returned no results").replace("###",w(this.getRootFolderName())).replace("##",w(this.getSearchPattern()));return x;},onmousedown:function g(){v.call(this);},onkeyup:function o(x){var AB=this;var AC=x.e;this.value=x.getTarget().value;var z=this.value;var AA=AC.keyCode;if(AA==32&&/^\s/.test(z)){this.value=z.replace(/^\s+/,"");x.cancel();return false;}AB.hasSearchPattern=this.value&&(this.value.length>0);if(!AB.doAutoComplete){if(AB.hasSearchPattern){AB.showClearIcon();}AB.searchPattern=this.value;if(AC.keyCode!==13){return ;}}var w=function(AE,AF){if(AF.indexOf("?")>-1||AF.indexOf("*")>-1){return false;}var AD=false;try{if(typeof AE==="string"){AD=(new RegExp("^"+AF,"")).test(AE);}else{var AG;for(AG in AE){AD=(new RegExp("^"+AF,"i")).test(AE[AG].n);if(!AD){break;}}}}catch(AH){}return AD;};if(AA&&f.indexOf([8,13,27,37,38,39,40],AA)===-1&&w(AB.suggestInputNode.value,this.value)&&w(AB.sItems,this.value)){return ;}AB.processInput(x);AB.syncInputWithSuggest();this.set("clearVisible",this.getSearchPattern().length>0);},onkeydown:function Q(w){if(mstrmojo.dom.isIE){var x=w.e;if(x.keyCode===27){x.cancelBubble=true;return false;}}},onpaste:function u(w){var x=this;window.setTimeout(function(){x.onkeyup(w);},0);},onclick:function l(z){var w=z.hWin,AA=z.e||w.event,AB=AA.target||AA.srcElement,x=AB&&((AB.dataset&&AB.dataset.act)||AB.getAttribute("data-act"));switch(x){case"search":this.forceSearch();break;case"clear":this.clear();break;case"settings":this.settingsWidget.set("visible",!this.settingsWidget.visible);break;}},processInput:function h(w){var AA=w.e,z=AA.keyCode,x=this.inputNode.value;this.searchPattern=x;this.blockBegin=1;if(!this.doAutoComplete&&z!==13){return ;}if(z===13||x.length<this.minKeyLength){if(!this.hasSearchPattern){this.clear();}this.hideSuggestion();this.forceSearch();return ;}else{switch(z){case 38:case 40:if(this.updateSelectedIndex(z)){this.delayedRequestResults();}else{if(this.tmrRR){window.clearTimeout(this.tmrRR);}}break;case 13:case 27:this.hideSuggestion();this.cancel();break;case 37:break;case 39:if(this.suggestInputNode.value&&this.inputNode.value!==this.suggestInputNode.value){this.inputNode.value=this.suggestInputNode.value;this.suggestInputNode.value="";}break;default:if(!this.enableSuggestion){return ;}this.showSpinnerIcon(true);this.suggestInputNode.value="";this.delayedRequestSuggestion(x);}}},cancel:function E(){mstrmojo.xhr.cancel();},requestSuggestion:function t(){return this.showSuggestion(this.getSearchPattern());},delayedRequestSuggestion:function t(w){if(this.tmrRS){window.clearTimeout(this.tmrRS);}if(this.tmrRR){window.clearTimeout(this.tmrRR);}var x=this;this.tmrRS=window.setTimeout(function(){x.requestSuggestion(w);},this.searchDelay);},requestResults:function K(){if(!this.hasUserInput()){return ;}if(!this.searchPattern){this.searchPattern="";}var x=this;var z=function(AD){if(!x.isMiniSearchBox){return AD.toString();}var AE=[],AB=d,AC;for(AC in AB){if(f.find(AD,AB[AC])>-1){AE.push(AB[AC]);}}return AE.toString();};var w=function(){var AC="";if(x.isMiniSearchBox||x.dereferenceshortcut=="1"){return AC;}if(x.objectType.length===0||f.indexOf(x.objectType,18)===-1){return AC;}var AD=[],AB;for(AB=0;AB<x.allowedObjectTypesData.length;AB++){AD.push(x.allowedObjectTypesData[AB].t);}return AD.toString();};var AA={taskId:"searchMetadata",searchId:this.blockBegin>this.blockCount?this.searchId||"":"",quickSearch:this.qse,fields:this.fields,styleName:this.styleName,searchPattern:this.last_searchPattern||this.searchPattern,objectType:z(this.objectType),targetObjectType:w(),rootFolderType:this.rootFolderType,rootFolderID:(this.rootFolderType=="0"?this.rootFolderID:""),dereferenceshortcut:this.dereferenceshortcut,searchDomain:this.searchDomain,servletName:mstrApp&&mstrApp.name,supportOMD:this.supportOMD,maxObjects:this.maxObjects,blockCount:this.blockCount,blockBegin:this.blockBegin,nameWildcards:this.nameWildcards,recursive:this.recursive,sortKey:this.qse?-1:6,dateType:this.dateType,created:this.created,dateSubType:this.dateSubType,intervalUnit:this.intervalUnit,intervalValue:this.intervalValue,startDate:this.startDate,endDate:this.endDate,ownerType:this.ownerType,description:this.description,includeObjectDesc:false,includeAncestorInfo:true,includeHiddenAncestors:true,uses:this.uses||""};this.serverRequest(AA,I.search(this));this.showSpinnerIcon(true);},delayedRequestResults:function K(){if(this.tmrRR){window.clearTimeout(this.tmrRR);}var w=this;this.tmrRR=window.setTimeout(function(){w.requestResults();},this.searchDelay);},renderResults:function U(w){var x=this;if(!this.resultsWidget){this.addChildren([{scriptClass:"mstrmojo.mstr.search.SearchResults",alias:"resultsWidget",slot:"resultsContainerNode",maxSearchResults:this.maxSearchResults,allowHTMLOnObjectDesc:this.allowHTMLOnObjectDesc,onfetch:function(z){x.fetchPage(z);}}]);this.renderChildren();}this.resultsWidget.set("results",w);},renderResultsPopup:function U(x){var w=this.suggestionPopup.list.selectedIndex;this.set("suggestionItems",x.concat(this.sItems));this.suggestionPopup.list.set("selectedIndex",w);},hasUserInput:function P(){if(!this.inputNode){return false;}var w=this.hasSearchPattern;w=w||!q.isEmpty(this.description)||this.ownerType==2||(this.dateType!=1)&&((this.dateSubType==1)&&!q.isEmpty(this.intervalValue)||(this.dateSubType==2)&&!q.isEmpty(this.startDate));return w||this.allowEmptyInput;},forceSearch:function b(){if(!this.hasUserInput()){return ;}this.suggestInputNode.value="";this.hideSuggestion();this.last_searchPattern=null;this.currentPage=1;this.blockBegin=1;this.requestResults();},updateQuickSearchEnabled:function c(){this.qse=!!this.isQuickSearchEngineEnabled&&this.enableQuickSearchPref;this.pqse=this.qse;this.qse=this.qse&&(f.indexOf(a,parseInt(this.nameWildcards,10))>-1);this.doAutoComplete=this.qse&&this.enableSearchAutoComplete;this.searchDelay=Math.max(0,this.searchAutoCompleteDelay);},syncInputWithSuggest:function X(){return ;},getSelectedIndex:function(){return this.suggestionPopup.list.selectedIndex;},getSelectedItem:function(){return this.suggestionPopup.list.selectedItem;},updateSelectedIndex:function W(w){try{if(!this.suggestionShown){return ;}if(w==38||w==40||w==13){switch(w){case 40:this.nextHighlight();break;case 38:this.preHighlight();break;case 13:this.hideSuggestion();this.selectedIndex=-1;return ;}var x=this.getSelectedItem()||{};var AA=false;if(x.t=="-1"){AA=this.applySuggestionItem(x);}else{AA=false;this.selectedIndex=this.getSelectedIndex()-((this.sItems&&this.sItems.length)||0);}return AA;}}catch(z){}},clear:function k(){this.showClearIcon(false);this.showSpinnerIcon(false);this.searchPattern="";this.last_searchPattern="";this.hasSearchPattern=false;this.inputNode.value="";this.suggestInputNode.value="";if(this.resultsWidget){this.resultsWidget.set("results",{});}this.hideSuggestion();v.call(this);},showSpinnerIcon:function L(w){this.set("spinnerVisible",w);},showClearIcon:function D(w){this.set("clearVisible",w);},getCandidatesThroughTaskCall:function R(z,w){z={taskId:"getSearchSuggestions",keyword:this.searchPattern};var x=I.suggest(this);w=mstrmojo.func.wrapMethods(x,w);this.serverRequest(z,w);},getSuggestionPos:function Y(){var w=mstrmojo.dom.position(this.inputNode,true);return{left:Math.round(w.x)+"px",top:Math.round(w.y+w.h)+"px",zIndex:102};},onSuggestionItemSelect:function n(w){if(this.applySuggestionItem(w)){this.delayedRequestResults();}},applySuggestionItem:function B(w){this.inputNode.value=w.n;this.suggestInputNode.value=this.inputNode.value;var x=false;if(this.last_searchPattern!=this.suggestInputNode.value){this.last_searchPattern=this.suggestInputNode.value;x=true;}this.selectedSuggestionIndex=this.getSelectedIndex();return x;},fetchPage:function F(w){var x=Math.max(w.v-1,0);this.blockBegin=x*this.blockCount+1;this.requestResults();},serverRequest:function H(w,x){mstrmojo.xhr.request("POST",mstrConfig.taskURL,x,w);},handleSearchErrorAndModeSwitching:function M(AD){if(!AD){return ;}var z=this;if(z.qse){var x=AD.getResponseHeader("X-MSTR-TaskErrorCode"),AC=AD.getResponseHeader("X-MSTR-TaskFailureMsg")||"";if(!x||x==-2147209051){return ;}var AA=-2147212073;var AB=-2147212154;if(x==AA||x==AB){z.isQuickSearchEngineEnabled=false;z.updateQuickSearchEnabled();z.nameWildcards={16:1,2:2,4:4,8:8}[z.nameWildcards];z.requestResults();this.showInfoIconOnce=true;}else{mstrmojo.alert(z.addAdminInfo(AC));}}else{var w=JSON.parse(AD.responseText).qsr;if(this.enableQuickSearch&&w){this.isQuickSearchEnabled=true;z.updateQuickSearchEnabled();z.nameWildcards={1:16,2:2,4:4,8:8}[z.nameWildcards];z.requestResults();}}},showSearchInfoIcon:function S(w){this.set("showInfoIcon",!this.qse||w);},destroy:function m(w){this._super(w);this.destroyChildren(true);}});mstrmojo.mstr.search.Search.zIndex=10;}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.mstr.search.Search");mstrmojo.mstr.search.SearchButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.mstr.search.SearchButton",cssClass:"mstrmojo-SearchButton",onclick:function A(B){this.searchEditor=new mstrmojo.Editor({cssClass:"mstrmojo-Search-editor",zIndex:mstrmojo.mstr.search.Search.zIndex,children:[{scriptClass:"mstrmojo.mstr.search.Search",id:"search",searchProps:this.searchProps,showAsPopup:false,isQuickSearchEngineEnabled:mstrConfig.isQuickSearchEngineEnabled,enableQuickSearchPref:mstrConfig.enableQuickSearchPref,enableSearchAutoComplete:mstrConfig.enableSearchAutoComplete,searchAutoCompleteDelay:mstrConfig.searchAutoCompleteDelay}],onOpen:function(){var C=45;this.set("top",mstrmojo.dom.getVerticalScroll()+C+"px");window.setTimeout(function(){mstrmojo.all.search.inputNode.focus();},200);},onClose:function(){this.destroy();}});this.searchEditor.open();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.DynamicClassFactory","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.array","mstrmojo.ui.pathbar.PathStarBurst","mstrmojo.ui.pathbar.PathNavigation","mstrmojo.ui.pathbar.PathAncestors","mstrmojo.ui.pathbar.PathExtraLinks","mstrmojo.ui.pathbar.PathHamburger","mstrmojo.ui.pathbar._PreAppExit","mstrmojo.mstr.search.SearchButton","mstrmojo.mstr.ui.CreateButton"," mstrmojo.ui._HasListTooltip");mstrmojo.ui.pathbar.List=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit,mstrmojo.ui._HasListTooltip]);function B(){var G=false,F=mstrApp.getPersistParams().hiddensections;if(F){G=mstrmojo.array.indexOf(F.split(","),"path")>=0;}return G;}function C(G){var F;for(F in G){return false;}return true;}function A(I){var G=I&&I.items,F=G&&G.length,H;for(H=F-1;H>=0;H--){if(C(G[H])){G.splice(H,1);}H--;}}mstrmojo.ui.pathbar.PathBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.pathbar.PathBar",markupString:'<div id="{@id}" class="mojoPath {@cssClass}" style="{@cssText}"><div id="mojoPath-starburst" class="mojoPath-starburst"></div><div id="mojoPath-navigation" class="mojoPath-navigation"></div><div id="mojoPath-path" class="mojoPath-path"></div><div id="mojoPath-toolbar" class="mojoPath-toolbar"></div><div id="mojoPath-create" class="mojoPath-create"></div><div id="mojoPath-search" class="mojoPath-search"></div><div id="mojoPath-extraLinks" class="mojoPath-extraLinks"></div></div>',markupSlots:{starburstNode:function(){return this.domNode.firstChild;},navigationNode:function(){return this.domNode.childNodes[1];},pathNode:function(){return this.domNode.childNodes[2];},toolbarNode:function(){return this.domNode.childNodes[3];},createNode:function(){return this.domNode.childNodes[4];},searchNode:function(){return this.domNode.childNodes[5];},extraLinksNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{starburstNode:"auto",navigationNode:"auto",pathNode:"auto",toolbarNode:"auto",createNode:"auto",searchNode:"auto",extraLinksNode:"auto"},w:{starburstNode:"auto",navigationNode:"auto",pathNode:"100%",toolbarNode:"auto",createNode:"auto",searchNode:"50px",extraLinksNode:"auto"}},getLayoutOffsets:function E(){return{h:2,w:0};},init:function D(I){if(B()){this.visible=false;return ;}var L=[];this._super(I);var G=this.pathInfo,J=G.sb,F=G.nb,K=G.pt,H=G.el,M=G.tbModelData&&G.tbModelData.n;A(M);if(J&&J.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathStarBurst",slot:"starburstNode",items:J});}if(F&&F.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathNavigation",slot:"navigationNode",items:F});mstrApp.prevPageHref=F[1]&&F[1].href;}if(K&&K.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathAncestors",slot:"pathNode",items:K,delimiter:G.dlmt});}if(H&&H.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathExtraLinks",alias:"pathExtraLinks",slot:"extraLinksNode",items:H});}if(mstrmojo.resolveFeature("object-search")){L.push({scriptClass:"mstrmojo.mstr.search.SearchButton",slot:"searchNode",searchProps:mstrConfig.searchProps});}if(M&&M.items&&M.items.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathHamburger",slot:"toolbarNode",items:M.items});}if(this.showCreateButton){if(mstrmojo.resolveFeature("create-objects")||(mstrmojo.resolveFeature("dhtml")&&mstrmojo.resolveFeature("create-analysis"))){L.push({scriptClass:"mstrmojo.mstr.ui.CreateButton",slot:"createNode",useConfigClickHandler:false,alignMenuToRight:true});}}this.addChildren(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi._MonitorsAppState","mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo.date","mstrmojo.ui._HasUITheme","mstrmojo.ui.pathbar.PathBar","mstrmojo.css");mstrmojo.requiresDescs(3540,3541,6724,3196,14495,14496,14498,14499,14500,14501,14502);var J=40,H=10,B=mstrmojo.date,I=annotationToolbar=waitBox=imageSrc=null;function L(P){var T=P.toDataURL(),R=mstrApp.docModelData,Q=(R&&R.n||"Annotation")+" ("+B.getTimeStamp()+")";if(mstrApp.isSingleTier){var N=T.indexOf(",");T=T.slice(N+1);window.FormWrapper.saveToLocalDisk(T,".png",Q);}else{var S=document.createElement("a");S.setAttribute("href",T);S.setAttribute("download",Q+".png");S.setAttribute("style","display: block;");var O=document.createElement("img");O.setAttribute("src",T);O.setAttribute("width",P.width);O.setAttribute("height",P.height);S.appendChild(O);document.body.appendChild(S);S.click();setTimeout(function(){S.parentNode.removeChild(S);},200);}}function D(P){var Q=P.toDataURL();if(mstrApp.isSingleTier){var N=Q.indexOf(",");Q=Q.slice(N+1);window.FormWrapper.print(Q);}else{var O=window.open("","Print Window");O.document.write("<html><head><title>Print Window</title></head><body><img src='"+Q+"' /></body></html>");O.document.close();O.focus();O.print();O.close();}}function M(P){var T=P.toDataURL();if(mstrApp.isSingleTier){var N=T.indexOf(",");T=T.slice(N+1);var S=window.FormWrapper.saveImageToAppFolder(T);if(S!==null&&S!==""){var Q="file://"+S;var R=document.createElement("img");R.src=Q;document.body.appendChild(R);var O=document.createRange();O.selectNode(R);window.getSelection().addRange(O);document.execCommand("copy");document.body.removeChild(R);window.FormWrapper.deleteFile(S);}}}function K(){if(mstrApp.isSingleTier){window.FormWrapper.toggleNetMenu("enable");}I.style.visibility="hidden";annotationToolbar.style.visibility="hidden";while(I.firstChild){I.removeChild(I.firstChild);}while(annotationToolbar.firstChild){annotationToolbar.removeChild(annotationToolbar.firstChild);}if(waitBox!==null){waitBox.close();}}function E(N){var O;switch(N){case"Undo":O=mstrmojo.desc(3540,"Undo");break;case"Redo":O=mstrmojo.desc(3541,"Redo");break;case"Comment":O=mstrmojo.desc(6724,"Comment");break;case"Rectangle":O=mstrmojo.desc(3196,"Rectangle");break;case"Arrow":O=mstrmojo.desc(14495,"Arrow");break;case"Free Form":O=mstrmojo.desc(14496,"Free form");break;case"Export Snapshot":O=mstrmojo.desc(14498,"Export Snapshot");break;case"Print Snapshot":O=mstrmojo.desc(14499,"Print Snapshot");break;case"Email Snapshot":O=mstrmojo.desc(14500,"Email Snapshot");break;case"Copy to Clipboard":O=mstrmojo.desc(14502,"Copy to Clipboard");break;case"Exit Annotation Mode":O=mstrmojo.desc(14501,"Exit Annotation Mode");break;}return O;}function A(Q){I=Q.annotationsOverlayNode;annotationToolbar=Q.annotationsToolbarNode;I.style.visibility="visible";annotationToolbar.style.visibility="visible";var P=Q.pathbarNode;var O=parseInt(P.style.height);var N=J-H+O;I.style.top=N+"px";I.style.width=parseInt(Q.width)+"px";I.style.height=parseInt(Q.height)-N+"px";}function G(N){A(N);var O={width:parseInt(I.style.width),height:parseInt(I.style.height),borderColor:"#2bacfe",lineColor:"#cc2525",noteColor:"rgba(255,255,102,0.90)",textColor:"#333333",type:"text",img:imageSrc,lineWidth:3,fontSize:"10pt",bootstrap:false,position:"top"};$MSTR_JQUERY(N.annotationsOverlayNode).annotate(O,K,L,D,M,E,N);if(waitBox!==null){waitBox.hide();}}function F(){if(mstrApp.isSingleTier){imageSrc=window.FormWrapper.getScreenCapture();imageSrc="data:image/png;base64,".concat(imageSrc);window.FormWrapper.toggleNetMenu("disable");}waitBoxID="AnnotationWait",waitBox=mstrmojo.all[waitBoxID]||mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:waitBoxID,cssClass:"mstrWaitBox",draggable:false,showTitle:false,zIndex:9,onOpen:function(){var N=this.curtainNode.style;N.background="black";N.opacity=0.5;},hide:function(){this.editorNode.style.visibility="hidden";},show:function(){this.editorNode.style.visibility="visible";},position:null,children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrIcon-wait",alias:"icon"},{scriptClass:"mstrmojo.Label",cssClass:"mstrWaitMsg",text:mstrmojo.desc(11960,"Loading Data...")}]});if(!waitBox.visible){waitBox.open();waitBox.show();}}mstrmojo.vi.ui.Annotations=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.ui.Annotations",id:"annotations",displayAnnotations:function C(N){window.setTimeout(function(){F();G(N);},50);}});}());(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.NumberFormat","mstrmojo.Button");var Q=mstrmojo.desc,F=mstrmojo.css,AA=mstrmojo.Button.newWebButton,k=mstrmojo.date,AP=mstrmojo.func,S=mstrmojo.hash,v=mstrmojo.array,x=mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep),AR="1:Width",Y="2:Page",G=44,o=28,V=29,g=17,AN=function(){return mstrmojo.locales.datetime;};function AL(AX,AV,AZ,AW){var AY=mstrApp.sessionManager;if(AY&&AY.sessionTimedout){AY.openLoginEditor({success:function(){if(AW!=="_blank"&&AW!=="mstrExportWindow"){mstrApp.showWait();}mstrmojo.form.send(AX,AV,AZ,AW);}});}else{if(AW!=="_blank"&&AW!=="mstrExportWindow"){mstrApp.showWait();}mstrmojo.form.send(AX,AV,AZ,AW);}}function c(AV){AL(AV,null,"post");}function m(AW,AY){var AV=AW.model;var AX={evt:2048001,messageID:AV.mid,rwb:AV.bs};if(AY<50||AY===2048){AX.visMode=0;AX.currentViewMedia=AY;}else{AX.visMode=AY;AX.currentViewMedia=1;}c(AX);}function AG(){var AW=mstrApp.pathInfo.nb,AV=mstrmojo.array.find(AW,"n","Return");return AV>-1?AW[AV].href:null;}function M(AW){var AV=AW.model,AX={};var AY=AG();if(AV.isnew){if(parseInt(AV.ecf,10)===32||(mstrApp.prevPageHref&&mstrApp.prevPageHref!=="#"&&!mstrApp.isHomePage)||mstrApp.isOIVM&&mstrApp.isOIVM()){AX.evt=3124;AX.relativePageNumber="-1";AX.src=AV.bp+".3124";AX.rwb=AV.bs;c(AX);return ;}else{AX.evt=mstrApp.preferences.startPage=="3187"?3060:3010;}}else{if(mstrApp.isVI&&AY&&AY!=="#"){mstrmojo.form.sendLinkAsForm(AY);return ;}else{AX.evt=2001;AX.folderID=AV.pfid;if(AV.sysFolder){AX.systemFolder=AV.sysFolder;}}}c(AX);}function AU(AX,AW,AZ,AY){var AV=AX.model;c({evt:2048030,src:AV.bp+".2048030",rePrompt:AW,fresh:AZ,regenerate:AY,rwb:AV.bs});}function T(Ae,AW){var Aa=Ae.model,Ab=(Aa&&Aa.zt)||0,AX,AZ,AV;switch(Ab){case 1:AX="Width";AV=AR;AZ=Q(4809);break;case 2:AX="Page";AV=Y;AZ=Q(4808);break;default:AX=(Aa&&Aa.getZoomFactor())||1;AV=Ab+":"+x.format(AX);AZ=parseInt(AX*100,10)+"%";}var AY=Ae.zoomOptions,Ac;if(AY){var Ad=mstrmojo.array.find(AY,"dssid",AV);if(Ad>-1){Ac=AY[Ad];}}if(!Ac){Ac={n:AZ,dssid:AV,f:AX,tp:Ab};}if(AW===true){Ae.view.zoomValue=Ac;}else{Ae.view.set("zoomValue",Ac);}}function O(Ad,Af,AV,AX,Ae,Aa,Ac,AZ){var AY=Ad.model,AW=AY&&AY.dty,Ab=AY&&AY.isnew;if(!AZ&&!AW||AZ&&!Ab){Ae(Aa);return ;}mstrmojo.warn(AX,{confirmBtn:{t:mstrmojo.desc(118,"Save"),fn:function(){mstrmojo.requiresCls("mstrmojo.Serializer");Ad.save(Ac);}},cancelBtn:{t:mstrmojo.desc(2140,"Cancel")}},{title:Af||mstrmojo.desc(11812,"Notification"),help:AV});}function AI(AW){var AV=AW.model;AV.showDialogBeforeSave=false;AV.getDataService().setPreference("askBeforeSaveChanges\u001E2",{success:mstrmojo.emptyFn,failure:function(AX){mstrmojo.alert(AX.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}var AK=-1,f=3,AC=4,J=7,AS=10,u=18;mstrmojo._DocToolbarActions=mstrmojo.provide("mstrmojo._DocToolbarActions",{_mixinName:"mstrmojo._DocToolbarActions",staticViewMode:function C(){m(this,1);},interactiveViewMode:function K(){m(this,2);},editableMode:function z(){m(this,4);},flashViewMode:function l(){m(this,8);},IVEMode:function P(){m(this,2048);},IVEHelp:function P(){var AV=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/MicroStrategy_Web_Help.htm#";window.open(AV+"about_interactive_visual_data_exploration.htm","_blank");return true;},remainExpressViewMode:function N(){},designViewMode:function AH(AV,AW){c({evt:3104,rwDesignMode:1,convertFromVI:(AW===true)?1:0,messageID:this.model.mid,rwb:this.model.bs,jsonMode:false});},onmodelChange:function B(){T(this,true);},convertToDoc:function t(AW){var AV=this;if(AV.model.hasMDXRADataset()){mstrmojo.alert(mstrmojo.desc(14692,'The "Convert to Document" option is currently not available for MDX cube with Hierarchical Attributes.'),null,mstrmojo.desc(3610,"MicroStrategy Web"));}else{mstrmojo.warn(mstrmojo.desc(13653,"Converting a dashboard to a document cannot be undone. Do you want to convert?"),{confirmBtn:{t:mstrmojo.desc(13654,"Convert"),fn:function(){AV.designViewMode(undefined,AW);}},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}},{title:mstrmojo.desc(5180,"Convert to Document")});}},saveAs:function(AV){this.save();},save:function a(AW,AV){if(mstrApp.isSingleTier){FormWrapper.saveas();return ;}this.model.saveAsRW(AW,AV);},dSave:function AQ(Ad){var Ab=this,AW=Ab.model,AZ=AW&&AW.isnew,AY=AW&&AW.isRWReadonly,AX=60,Aa=AW.n;if(mstrApp.isSingleTier){FormWrapper.save();return ;}if(Aa.length>AX){Aa=Aa.substr(0,AX-1)+"...";}if(AZ||AY){this.save();}else{var Ae=mstrApp.features["ask-before-save-changes"];if(Ae){var AV="dialogBeforeSave",Ac=function(){mstrmojo.all.dialogBeforeSave.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:AV,title:Q(5728),cssClass:"mstrmojo-dta save",btnAlignment:"right",modal:true,visible:true,onClose:Ac,buttons:[AA(Q(1442),function(){var Af=mstrmojo.all[AV];if(Af.t.ctrlChk.checked){Ab.setDontAskAgain();mstrApp.features["ask-before-save-changes"]=false;}Ab.directSave(Ad);Ac();},true),AA(Q(218),function(){var Af=mstrmojo.all[AV];if(Af.t.ctrlChk.checked){AI(Ab);}Ab.save();Ac();}),AA(Q(2140),Ac)],children:[{scriptClass:"mstrmojo.Table",alias:"t",rows:2,cols:1,children:[{scriptClass:"mstrmojo.Label",text:Q(11165,"Are you sure you want to overwrite the existing copy of ##?").replace(/##/,"<b>"+Aa+"</b>"),visible:true,cssClass:"ucalert",slot:"0,0",allowHTML:true},{scriptClass:"mstrmojo.CheckBox",label:Q(211),alias:"ctrlChk",visible:true,checked:false,slot:"1,0"}]}]}).render();}else{Ab.directSave(Ad);}}},setDontAskAgain:function H(){var AW=this,AV=AW.model;AV.showDialogBeforeSave=false;AV.getDataService().setPreference("askBeforeSaveChanges\u001E0",{success:mstrmojo.emptyFn,failure:function(AX){mstrmojo.alert(AX.getResponseHeader("X-MSTR-TaskFailureMsg"));}});},directSave:function R(Ab){Ab=Ab||{};var AZ=this,AV=AZ.model,AW=mstrmojo.string.decodeHtmlString(AV.n),AY=mstrmojo.emptyFn,AX=Ab.success||AY,Aa=Ab.failure||AY,Ac=Ab.complete||AY;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Ad){var Ae=function(){if(!Ab.ignoreOrgSucc){mstrmojo.alert(Q(3336).replace("##",AV.n),null,null,null,null,{allowHTML:true});}AZ.cmdMgr.reset();};AV.lastSavedStid=AV.getDataService().stid;AV.dty=false;AX(Ad);if(Ad.needToGetResults){AV.getDataService().retrieveServerJson({},AP.wrapMethods(AV.controller.getRefreshCallback(),{success:Ae}),{preserveUndo:true,style:{name:"ServerJsonRWDStyle",params:{treesToRender:3}},params:{styleName:"ServerJsonRWDStyle"}});}else{Ae();}},failure:function(Ad){if(!Ab.ignoreOrgFail){mstrmojo.alert(Q(4107));}Aa(Ad);},complete:function(Ad){Ac(Ad);}},{taskId:"saveRW",msgID:AV.mid,folderID:AV.sfid||AV.pfid,objName:AW,objDesc:AV.dsc,saveAsFlags:3,taskEnv:"xhr",taskContentType:"json"});},quickSave:function w(){this.model.saveRW();},browseParent:function AF(){var AV=this.model,AW={evt:3010};if(!AV.pfh){AW.evt=2001;AW.folderID=AV.pfid;if(AV.sysFolder){AW.systemFolder=AV.sysFolder;}}c(AW);},close:function n(){M(this);},openPage:function Z(AW){var AV=this.model;c({evt:3124,src:mstrApp.name+"."+mstrApp.pageName+".3124",relativePageNumber:AW,messageID:AV.mid,rwb:AV.bs});},saveToInbox:function q(){var AW=this;mstrApp.serverRequest({taskId:"addDocToHistoryList",rwb:AW.model.bs},{success:function(){var AX=AW.model.features;if(AX){if(AX.set){AX.set("enable-add-history-list",false);}else{AX["enable-add-history-list"]=false;}}mstrmojo.alert(Q(8047));},failure:function AV(){mstrmojo.alert(mstrmojo.desc(13774,"Your history list is full. Please delete a few messages and try again."));}},{silent:true});},ShowSharingEditor:function X(){var Ac="sharingEditor",Aa=mstrmojo.all[Ac],AZ=this,AX=AZ.model,AW=AX.isnew,AY=AX.getDataService().stid,Ab=function(Ad){if(Aa){Aa.set("oi",Ad);S.copy({objectName:AX.n,href:null,mid:AX.mid,isLinkDirty:Aa.lastState!==AY,lastState:AY},Aa);}else{Aa=new mstrmojo.SharingEditor({guestModeEnabled:mstrApp.guestModeEnabled,mid:AX.mid,id:Ac,oi:Ad,href:null,isLinkDirty:true,viewMode:1,lastState:AY});}Aa.open();},AV={success:function(Ad){Ab(Ad.objects[0]);},failure:function(Ad){mstrmojo.alert(Ad.getResponseHeader("X-MSTR-TaskFailureMsg"));}};if(AW){mstrmojo.alert(mstrmojo.desc(14122),null,mstrmojo.desc(8101));}else{AX.getDataService().getObjectInfo({objectIDs:this.model.oid,objectTypes:55,includeACL:mstrApp.features?!!mstrApp.features["web-use-sharing-editor"]:false},AV);}},annotationMode:function p(){(mstrmojo.all.annotations||new mstrmojo.vi.ui.Annotations({})).displayAnnotations(this.rootCtrl.view);},createPersonalView:function L(){var AY=this,AV=AY.model,AW=AV&&AV.isnew;if(AW){mstrmojo.alert(mstrmojo.desc(13963,"You must save your dashboard before continuing."),null,mstrmojo.desc(9173));}else{var Ac=AV.n,AX="mstrPVD",Ab={scriptClass:"mstrmojo.PersonalViewSaveAs",id:AX,objectType:55,objectSubType:14081},Aa=mstrmojo.all[AX]||mstrmojo.insert(Ab);if(Ac){var AZ=k.getDateJson(new Date());Ac+=" "+k.formatDateInfo(AZ,AN().DATEOUTPUTFORMAT)+" "+k.formatTimeInfo(AZ,AN().TIMEOUTPUTFORMAT);Aa.set("name",Ac);}Aa.msgID=this.model.mid;Aa.open();}},reprompt:function W(){AU(this,true,false,false);},refresh:function U(){AU(this,false,false,false);},rerun:function AE(){AU(this,false,true,false);},toggleAutoRefresh:function(AY){var AX=AY.src,AW=this.model.controller,AV=AW.isAutoRefreshStarted();AW[(AV?"stop":"start")+"AutoRefresh"]();AX.set("iconClass",(AV?"tbStart":"tbStop")+"AutoRefresh");AX.domNode.setAttribute("title",AV?"*Resume Auto Refresh*":"*Pause Auto Refresh*");},docVisualizationModeAJAX:function r(){m(this,51);},docVisualizationModeFlash:function AJ(){m(this,50);},sendNow:function AM(){O(this,mstrmojo.desc(2331,"Send Now"),"Sending_an_analysis_in_an_email.htm",mstrmojo.desc(2513,"You must save the report/document before you can send it."),c,{evt:3037,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:2},true);},scheduleHL:function e(){O(this,Q(5017,"Subscribe to History List"),"",Q(13963,"You must save your dashboard before continuing."),c,{evt:3128,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3});},scheduleEmail:function AD(){O(this,Q(3282,"Schedule Delivery to E-mail"),"",Q(13963,"You must save your dashboard before continuing."),c,{evt:3036,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3});},zoomValue:null,zoom:function AO(Ad){var Ac=(Ad!==null)?String(Ad).split(":"):[],Af=parseInt(Ac[0],10),Ag=Ac[1],AX=x.parse(Ag);if(isNaN(Af)||(!Af&&isNaN(AX))){return ;}var Ae=this.model;if(Af===1||Af===2){var AZ=this.view.selected,Aa=(AZ&&AZ.docLayout)||null,Ai=Aa&&(Aa.containerNode||Aa.domNode),AY=Ai&&Ai.ownerDocument.documentElement,Ab=(Ae&&Ae.getZoomFactor())||1;var AW=function(Ak){Ak-=G;if(Ae.multiLayout){Ak-=o;}if(Ae.hasGroupby){Ak-=V;}return Ak;};var AV=function(Am){var Ak=Ai&&Ai["offset"+Am];if(!Ak){return Ab;}var Al=Math.max(1,AY["client"+Am]);if(Am==="Height"){Al=AW(Al);}return Math.min(4,Math.max(0.1,Math.floor(Ab*Al*100/Ak)/100));};var Ah=function(An){var Ak=Ai&&Ai.offsetHeight;if(Ak){var Al=Math.max(1,AY.clientWidth),Am=AW(Math.max(1,AY.clientHeight));if(Ak*An/Ab>Math.max(1,Am)){An=Math.floor(An*(Al-g)*100/Al)/100;}}return An;};AX=AV("Width");if(parseInt(Af,10)===1){AX=Ah(AX);}if(Af===2){AX=Math.min(AX,AV("Height"));}Ag=x.format(AX);}if(Af!==Ae.zt||Ag!==x.format(Ae.getZoomFactor())){var Aj=this;Ae.getDataService().setDocZoom({zoomType:Af,zoomFactor:Ag,rwb:Aj.model.bs,currLayoutKey:Ae.currlaykey},{success:function(Al){if(Af!==0){var An=Aj.view.children,Ak;for(Ak in An){var Am=An[Ak];if(Am.k===Aj.model.currlaykey){continue;}if(Am.defn){Am.defn.loaded=false;}}}Ae.zt=Al.zt;Ae.replaceLayout(Al.currlaykey,Al);Ae.raiseEvent({name:"rebuildLayout"});T(Aj,false);Aj=null;},failureName:"zoom.set"});}},syncZoom:function(){var AV=this.model,AW=x.format(AV.getZoomFactor());mstrApp.serverRequest({taskId:"setDocZoom",rwb:AV.bs,styleName:"EmptyStyle",zoomFactor:AW,zoomType:AV.zt,layoutKey:AV.currlaykey},null);},exportCmd:function D(Aa,Ac,Ak){Ac=typeof Ac!=="string"?undefined:Ac;if(!mstrApp.isSingleTier){var AW=this.model,Af=this.view,Ah=(parseInt(Aa,10)===AK)?3130:3132,Ae=AW.exopt,Ag=AW.huc&&Aa===J,Ab=Ae.s&&(Aa===AC||Aa===f)&&!Ac,AV=false,AZ=false;if(Ab){if(!!(AW.defn&&AW.defn.layouts&&AW.defn.layouts.length>1)){AZ=true;}else{var AY=Af.selected,Aj=AY&&AY.gb&&AY.children[1];AV=(!Aj||Aj.areUnitsSetToAll());if(AV){Ab=false;}}}var AX=function(){var Ao={evt:Ah,src:mstrApp.name+"."+Ah};if(Ah===3132){Ao.executionMode=Aa;if(Ac!=null){Ao.gridKey=Ac;}if(Ak>0){Ao.sliceId=Ak;}}if(!Ab){Ao.rwb=AW.bs;}else{var An=mstrmojo.Serializer;var Al=[[2048062,AW.bp+".2048062","mode",Ae.m,"range",Ae.r],[]];S.forEach(Ao,function(Aq,Ap){if(Ap==="executionMode"){Al[1]=Al[1].concat([Ap,Aq]);}else{Al[1].push(Aq);}});Ao.evt=1024001;Ao.src=AW.bp+".1024001";Ao.events=An.serializeValueGroup(Al);Ao["1024001"]=1;Ao.messageId=AW.mid;}Ao.name=Date.parse(new Date());var Am=function(){AL(Ao,null,"post",(Ae.n)?"_blank":"mstrExportWindow");};if(!mstrmojo.dom.isIE||Aa!==J){Am();}else{mstrmojo.alert(Q(5873),Am);}};var Ad;if(Ab||Ag){Ad=function(){var Am="mojoExOpx9",Al=function(){mstrmojo.all.mojoExOpx9.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:Am,title:Q(971),cssClass:"mstrmojo-dta export",btnAlignment:"right",onClose:Al,draggable:false,buttons:[AA(Q(1442),function(){mstrmojo.requiresCls("mstrmojo.Serializer");var An=mstrmojo.all[Am];if(AZ){Ae.r=An.ctrlLyt.selectedIndex;}if(!AV){Ae.m=(An.ctrlChk.checked)?0:1;}Al();AX();},true),AA(Q(2140),Al)],children:[{scriptClass:"mstrmojo.Label",cssClass:"ucalert",text:Q(7482),visible:Ag},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"exp_opts",cssDisplay:"block",alias:"ctrlLyt",visible:!!AZ,selectedIndex:Ae.r,items:[{n:Q(14583),v:0},{n:Q(14582),v:1}]},{scriptClass:"mstrmojo.CheckBox",label:Q(5165),cssDisplay:"block",alias:"ctrlChk",visible:!mstrApp.isVI&&!AV&&Ab,checked:(Ae.m===0)}]}).render();};}if(Aa===AC&&Q(3809)!==undefined&&!Ac){mstrmojo.confirm(Q(3809),{confirmBtn:{fn:Ad||AX,t:Q(1442)},cancelBtn:{t:Q(2140)}});}else{if(Ad){Ad();}else{AX();}}}else{if(Ac!==undefined){var Ai={3:{mode:"2",version:""},4:{mode:"1",version:"4"},10:{mode:"5",version:""}};FormWrapper.doExport(Ai[Aa].mode,Ai[Aa].version,Ac);}}},printPDF:function d(AV){this.exportCmd(f,AV);},exportExcel:function b(AV){this.exportCmd(AC,AV);},exportCSV:function AB(AV){this.exportCmd(AS,AV);},exportHTML:function I(){this.exportCmd(AK);},exportMSTR:function AT(){var AW=this,AV=function AV(AX){AW.exportCmd(AX);};O(this,null,"",Q(13963,"You must save your dashboard before continuing."),AV,u,{saveAsOrigin:14},true);},openHome:function E(AV){c({evt:3010,src:mstrApp.name});},updateZoom:function A(){T(this,false);},resetSelections:function h(){var AX=this,AW=AX.model,AV=!!AW.hasGroupby;AW.getDataService().resetSelections(null,AV,{success:function(Ab){var Ae=AX.view.children,AY=(Ae&&Ae.length)||0,Af=AW.getCurrentLayoutKey(),Aa;for(Aa=0;Aa<AY;Aa++){var Ac=Ae[Aa];if(Ac.defn&&Ac.defn.loaded&&Af!==Ac.k){Ac.defn.loaded=false;}}if(AV){AW.loadLayout(Ab);return ;}if(Ab.pukeys){var Ad=AW.partialUpdate(Ab.data,AW.getUnitDefinitions(Ab.pukeys)),AZ=AW.getLayoutDataCache(AW.getCurrentLayoutKey());S.forEach(Ad.upd,function(Ai,Ak){var Ah=mstrmojo.all[Ak];if(Ah&&Ah.defn&&Ah.defn.t===mstrmojo.EnumRWUnitType.PANELSTACK){var Ag=AZ&&AZ[Ak]&&AZ[Ak].data,Aj=Ag&&Ag.selKey;if(Aj&&Ah.selectedKey!==Aj){Ah.defn.set("selKey",Aj);}Ah.setDirtyChildren();}});}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.form","mstrmojo._IsDocController","mstrmojo.AdvancedSortEditor","mstrmojo._DocToolbarActions","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr");var H=3,g="mstrmojo-advancedSort";var V=mstrmojo.func;mstrmojo.rw.DocController=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsDocController,mstrmojo._DocToolbarActions],{scriptClass:"mstrmojo.rw.DocController",start:function E(){var h=this.model;h.lastSavedStid=h.stid||0;this.cmdMgr=new mstrmojo.vi.controllers.UICmdMgr({controller:this,model:h});this.cmdMgr.dataService=h.getDataService();},onCmdMgrChanged:function d(){},getSorts:function A(m){var k=[],h=m.axis-1,l=[],n=[];k[h]=l;l.push({key:m.sortKey,isAsc:m.isAsc});n[h]=m.subTotalsPos;return{sorts:k,subTotalsPos:n};},onSort:function Q(h,l){var k=this.getSorts(l);this.onAdvancedSort(h,k.sorts,k.subTotalsPos,l.stt);},onAdvancedSort:function f(k,l,h,m){k.model.sort({sorts:l,stp:h,stt:m},this._getXtabCallback(k));},onGetAdvSortData:function D(k,n,m){var o=this,h=function h(p){var r=mstrmojo.all[g]||mstrmojo.insert({scriptClass:"mstrmojo.AdvancedSortEditor",id:g,postCreate:function q(){if(mstrmojo.dom.isIE8){mstrmojo.css.addWidgetCssClass(this,"ie8");}}});r.set("sortData",p);r.set("controller",o);r.set("xtab",k);r.set("sourceAxis",n||1);r.set("sourceType",m||-1);r.open();};k.model.getAdvSortData({partialDisplayKeys:k.k,gridStyle:"AdvSortDataStyle"},this.model.newCallback({success:function(p){h(p.grids[0]);},failure:function l(p){mstrmojo.alert(p.code+": "+p.message);}}));},onPivot:function e(h,k){h.model.pivot(this._addNodeKeyToAction(h,k),this._getXtabCallback(h));},onSubmitTemplateUpdates:function J(h,k,l){h.model.submitTemplateActions(h.k,k,V.wrapMethods(this._getXtabCallback(h),l));},onShowTotals:function Y(h,k){h.model.showTotals(this._addNodeKeyToAction(h,k),this._getXtabCallback(h));},onDrill:function W(h,n,p){var l=this.model,k=this.model.prefs,o=k.rtprnt,m=k.rtthld;if(n.isWithin){if(!this.isInRequest()){n.retainParent=k.rtprnt;this.submitDrillWithin(h,n,p);}}else{mstrmojo.form.send({evt:3125,displayMode:-1,drillPathKey:n.drillPathKey,elementList:n.drillElements,rwMesageID:l.mid,retainParent:isNaN(o)?"":o,retainThresh:isNaN(m)?"":m,rwGroupByElements:this.getGroupByElements(h).join(","),sliceId:h.sid||0},null,null,((k.drillnw)?"_blank":null));}},onDrillGraph:function b(h,n,p){var l=this.model,k=this.model.prefs,o=k.rtprnt,m=k.rtthld;if(n.isWithin){if(!this.isInRequest()){n.retainParent=k.rtprnt;this.submitDrillWithin(h,n,p);}}else{mstrmojo.form.send({evt:3126,drillPathKey:n.drillPathKey,retainParent:isNaN(o)?"":o,retainThresh:isNaN(m)?"":m,rwMesageID:l.mid,"3126.x":n.x,"3126.y":n.y,graphHeight:n.graphHeight,graphWidth:n.graphWidth,rwGroupByElements:this.getGroupByElements(h).join(","),sliceId:h.sid||0,displayMode:n.displayType||2},null,null,((k.drillnw)?"_blank":null));}},submitDrillWithin:function a(h,k,l){h.model.drillGrid(this._addNodeKeyToAction(h,k),mstrmojo.func.wrapMethods(this._getXtabCallback(h),l));},onExecuteNewObject:function O(k,l){if(l){var h={};if(l.objType===H){h.evt=4001;h.reportID=l.did;h.reportViewMode=1;if(l.forceExec){h.execFlags=1;h.doNotUpdateCaches=true;}}else{h.evt=2048001;h.objectID=l.did;if(l.forceExec){h.freshExec=true;h.doNotUpdateCaches=true;}}if(l.linkAnswers){h.linkAnswers=l.linkAnswers;}mstrmojo.form.send(h,null,"POST",null);}},onReExecute:function(h,m){var k=h.model,l={evt:2048030,src:k.bp+".2048030",rwb:k.bs};if(m){l.ignoreStatus=true;mstrmojo.form.send(l,null,"POST",null);}else{mstrmojo.form.send(l,null,"POST",null);}},isAutoRefreshEnabled:function R(){return this.model&&this.model.rf;},isAutoRefreshStarted:function G(){return !!this.autoRefreshHandler;},startAutoRefresh:function M(){var h=this.model,k=h.rf,l=this;if(this.autoRefreshHandler){this.stopAutoRefresh();}this.autoRefreshHandler=setTimeout(function(){h.getDataService().refresh({},{success:function m(n){if(h.clearDisposables){h.clearDisposables();}h.loadLayout(n);if(l.autoRefreshHandler){l.startAutoRefresh();}}});},k*1000);},stopAutoRefresh:function P(){clearTimeout(this.autoRefreshHandler);this.autoRefreshHandler=null;},offlineTransactionsSubmitted:function C(h){},transactionDiscarded:function I(h){},openOfflineTransactions:function N(){},invalidClientCache:function Z(){},confirmMsgBeforeSubmit:function S(){},onLink:function B(p,l){if(l.link){var m,r,o=l.link,k=(o.prms?o.prms.length:0);for(m=0;m<k;m++){r=o.prms[m];if(r.pa&&r.pa.v){r.pa.v=mstrmojo.string.decodeHtmlString(r.pa.v,false);}}var q=l.link.toXml();if(q){l.linkAnswers=q;}delete l.link;}if(l.linkInfo&&l.linkInfo.so>0){l.originMessageID=this.model.mid;if(!l.linkAnswers){l.promptAnswerMode="0";}l.selectorMode=l.linkInfo.so;}var n=l.target||l.linkTarget||"_self";if(l.url){if(l.url.toLowerCase().indexOf("javascript:")>=0&&!mstrConfig.isLinkJSEnabled){return ;}if(mstrApp.isSingleTier){window.FormWrapper.openPage(l.url);}else{if(l.submitAsPost||l.url.length>2083){var h=mstrmojo.form.createDynamicForm(l.url);h.target=n;h.submit();}else{window.open(l.url,n);}}}else{mstrmojo.form.send(l,null,"POST",n);}},onTransactionUpdates:function c(l,n,m,h){var k={name:"TransactionUpdates",ctlKey:h};if(m){l.autoRefresh(k);}},onDownloadGridData:function K(h,k){this.model.downloadGridData(this._addNodeKeyToAction(h,k));},onGroupBy:function L(h,n){var l=h.model,k=n.groupbyKey,m=false;n.flags=l.agb===2?2:0;m=!!n.flags;l.getDataService().changeDocGroupBy(n,{success:function(o){if(m){h.parent.parent.unloadGbLayuts(k);}l.loadLayout(o);}});},_getAdvSortCallback:function(l,h){var o=this,n=o.model,k=function k(q){var r=mstrmojo.all[g];if(!r){r=mstrmojo.insert({scriptClass:"mstrmojo.AdvancedSortEditor",gridData:q,controller:o,model:n,xtab:l,subTotalsPos:h});}else{r.set("gridData",q);}r.open();};return n.newCallback({submission:mstrmojo.emptyFn,success:function p(q){k(q.grids[0]);},failure:function m(q){mstrmojo.alert(q.code+": "+q.message);},complete:mstrmojo.emptyFn});},onXtabColumnsResized:function T(h,k){h.model.resizeXtabColumn(this._addNodeKeyToAction(h,k));},addScrollPosition:function U(h,l,k){if(window.sessionStorage){window.sessionStorage.setItem("sp."+h,JSON.stringify({x:l,y:k}));}},getScrollPosition:function X(h){var k=(window.sessionStorage&&window.sessionStorage.getItem("sp."+h));if(k){k=JSON.parse(k);}return k;},onRemoveUnit:function F(h,k){h.model.removeUnit(this._addNodeKeyToAction(h,k),this._getXtabCallback(h));}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocController","mstrmojo.vi.ui.DocumentView","mstrmojo.vi.ui.VizGallery","mstrmojo.vi.models.DocModel","mstrmojo.ME.DerivedAttributeIDE","mstrmojo.hash","mstrmojo.func","mstrmojo.vi.ui.DatasetEditor","mstrmojo.vi.controllers.UICmdMgr","mstrmojo.vi.ui.editors.ConfirmSaveEditor","mstrmojo.vi.ui.DatasetUnitMenuUtils","mstrmojo.vi.ui.editors.DerivedElementsEditor","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.vi.models.DEConsolidation","mstrmojo.vi.ui.editors.RenameDEEditor","mstrmojo.expr","mstrmojo.models.FormatModel","mstrmojo.dom");mstrmojo.requiresClsP("mstrmojo.vi.factories","VisualizationTransitionFactory");mstrmojo.requiresDescs(221,1388,5414,5415,5421,5422,11812,13157,14719);var q=mstrmojo.vi,X=mstrmojo.func,Q=mstrmojo.hash,L=mstrmojo.array,A=mstrmojo.desc,C=mstrmojo.Button.newWebButton,AG=mstrmojo.expr,b=mstrmojo.vi.ui.DatasetUnitMenuUtils,w=mstrmojo.dom;var AX=3,v=4,u=1000;var AU={config:{waitBoxCfg:{message:mstrmojo.desc(10492,"Saving...")}}};function o(Ad,E,Ag){var Af="mstrmojo-renameDerivedElement",Ae=mstrmojo.all[Af]||mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.editors.RenameDEEditor",id:Af,title:(Ag.funcVal===-1)?A(5414,"Create Group "):A(5415,"Create Calculation")});Ae.view=E;Ae.action=Ag;Ae.controller=Ad;Ae.open();Ae.set("title",(Ag.act.indexOf("edit")>=0)?A(1388,"Rename"):(Ag.funcVal===-1)?A(5187,"Group"):A(5188,"Calculation"));Ae.children[0].name.set("value",Ag.deName);}function J(Ae,Ad,E){var Af=this.id;this.view.layoutViewer.saveBoxLayout(undefined,undefined,{success:function Ag(){Ae.apply(mstrmojo.all[Af],Ad);}.bind(this)},undefined,E);}function AA(Ah,Ak,Ao,Ae){var Am=this,Ad=[],Ag=[],Ai=[],An="\u001E",Aj=X.wrapMethods({success:function(Aq){Ah.als=Aq.als;}},Ah.controller.getRefreshCallback());L.forEach(Ao,function(Ar){var Aq=Ah.als&&Ah.als.links[Ak+" "+Ar.fid];L.forEach(Aq,function(As){Ad.push(Ar.fid);var At=As.split(" ");Ag.push(At[0]);Ai.push(At[1]);});});if(Ad.length>0){var E=Ag[0],Al=null,Ap=null;Q.forEach(Ah.datasets,function(Aq){L.forEach(Aq.att,function(Ar){if(Ar.did===E){Al=Ar.n;}else{if(Ar.did===Ak){Ap=Ar.n;}}if(Al&&Ap){return false;}});if(Al&&Ap){return false;}});new mstrmojo.Editor({params:null,cssClass:"mstrmojo-ConfirmEditLink-Editor",title:A(11812,"Notification"),onPreClose:function Af(){Ae.canceled();this.hideTooltip();return true;},children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Warning-Box",children:[{scriptClass:"mstrmojo.Box",cssClass:"icon"},{scriptClass:"mstrmojo.Label",text:A(13157,"## and ### are linked. You need to unlink these attributes to make changes to ##.").replace("###",Al).replace(/##/g,Ap),cssClass:"message"}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Box"},C(mstrmojo.desc(13156,"Unlink and Edit"),function(){var Ar=this.parent.parent,Aq={act:"applyAttributeLinking",srcAttrId:Ak,srcFormId:Ad.join(An),tgtAttrId:Ag.join(An),tgtFormId:Ai.join(An),unlink:true};Am.cmdMgr.execute({execute:function(){this.submit(Aq,X.wrapMethods(Aj,Ae));},urInfo:{callback:Aj}});Ar.close();},true,{width:"100px"}),C(mstrmojo.desc(221,"Cancel"),function(){Ae.canceled();this.parent.parent.close();})]}]}).render();}else{Ae.success();}}function B(Ad,Ah){var Af=this,E=function(Aj){var Ai=Af.daIDE.action,Al=Ai.did,Ak=false;Aj=L.filter(Aj,function(Ao){var An=(Ao.t===1||Ao.t===47),Am=(Ao.t===47&&Ao.st===12033);Ak|=(An&&!Am);return Ao.did!==Al&&!Ao.um&&!Ao.rdm&&!Ao.de&&!An&&!Am&&(!Ah||Ao.t!==4);});if(Ak||Ad.isMDXDataset(this.dataset.set)){Aj=L.filter(Aj,function(Am){return Am.t!==4;});}return Aj;},Ae=function(Ai){var Aj={};Q.forEach(Ai,function(Ak,Al){Ak.isMDX=Ad.isMDXDataset(Ak);Ak.isDDA=Ad.isDDADataset(Ak);if(!b.hasCGorCon(Ak)&&!(Ak.isMDX&&Ak.isDDA)){Aj[Al]=Ak;}});return Aj;},Ag=Ah?{att:false,mx:false}:undefined;return Q.copy({doubleClickItemHandler:function(Ai){Af.daIDE.onObjectInsert(Ai);}},Ad.getDatasetsPanel("190px",E,Ae,Ag));}function AK(E,Ad){E.model.getDataService().refresh({styleName:"JsonRWDStyle"},X.wrapMethods(E.getRefreshCallback(),Ad));}function AR(E){return !!Object.keys(E.datasets||{}).length;}function d(){if(mstrApp.isSingleTier){var E=window.FormWrapper;if(E){E.serverRequest("syncRequests","","","");}}}mstrmojo.vi.controllers.DocumentController=mstrmojo.declare(mstrmojo.rw.DocController,null,{scriptClass:"mstrmojo.vi.controllers.DocumentController",model:null,datasetsPanel:null,rootCtrl:null,view:null,visTransitionFactory:null,cmdMgr:null,refStartTime:0,remTimeForRef:0,autoRefReqSent:false,autoRefReqId:undefined,start:function O(Ag){var Af=new mstrmojo.vi.models.DocModel(Ag),Ak=this.rootCtrl;Af.lastSavedStid=Af.stid||0;Af.controller=this;var Aj=this.cmdMgr=new mstrmojo.vi.controllers.UICmdMgr({controller:this,model:Af});Aj.dataService=Af.getDataService();this.datasetsPanel=Ak.setDatasetObjectsPanel(Af.getDocDatasetsPanel());var E=this.visTransitionFactory=new q.factories.VisualizationTransitionFactory(),Ad=Ag.defn.root.layoutXML,Ae=Ad?!!Ad.go:true;var Al=new q.ui.VizGallery({model:Af,visible:Ae&&mstrApp.allowWebDashboardDesign()});Ak.setGalleryView(Al);var Ah=parseInt(mstrApp.viLayoutsCacheSize);var Ai=this.view=new q.ui.DocumentView({controller:this,model:Af,hasDataSource:AR(Af),LAYOUTS_CACHE_SIZE:Ah>=0?Ah:10});this.set("model",Af);Ak.setDocumentView(Ai);if(mstrApp!==undefined&&window.mstrLocalStorage!==undefined){mstrLocalStorage.addScreenshot(mstrApp.getLastMsgRecoveryInfo(),Ai.domNode);}Af.attachEventListener("updateDatasets",this.id,function(){Ai.set("hasDataSource",AR(Af));});this.addDisposable([Aj,E,Af,Al,Ai]);if(mstrApp&&mstrApp.onDocReady){mstrApp.onDocReady();}},build:function S(){this.view.buildChildren();},submitUndoRedoTemplateUpdates:function AF(E,Af,Ag,Ae,Ad){this.submitUndoRedoTemplateWithCallback(E,this.dataService().getUpdateTemplateAction(E.k,Af),Ag,Ae,Ad);},submitUndoRedoTemplateWithCallback:function AD(E,Af,Ag,Ae,Ad){this.submitUndoRedoUpdates(Af,{},X.wrapMethods(this._getXtabCallback(E),Ag),Ae,Ad);},submitUndoRedoUpdates:function h(Af,Ad,Ag,Ae,E){this.cmdMgr.execute({execute:function(){this.submit(Af,Ag,Ae);},urInfo:Q.copy(E,{callback:Ag})});},convertToDoc:function T(){J.call(this,this._super,[true]);},save:function V(Ad,E){d();J.call(this,this._super,[].concat(Ad||{}).concat(E||[]),AU);},printPDF:function R(E){J.call(this,this._super,[E]);},print:function K(E){if(w.isChrome||(w.isSafari&&w.isMac())){var Af=this;this.rootCtrl.togglePrintPreview(true);var Ad=window.matchMedia;if(Ad){var Ae=Ad("print");function Ag(Ah){var Ai=function(){Af.rootCtrl.togglePrintPreview(false);Ae.removeListener(Ag);};if(!Ah.matches){Ai();}}Ae.addListener(Ag);}window.setTimeout(function(){window.print();},1300);}else{this.printPDF(E);}},exportVisualization:function AW(E,Ag){var Ae=10000000;var Af=E.node.data.rw,Ad=function(){switch(Ag){case AX:this.printPDF(E.k);break;case v:this.exportExcel(E.k);break;}}.bind(this);if(Af&&(Af.col.tc*Af.row.tc>Ae)){mstrmojo.warn(mstrmojo.desc(14017,"Exporting the dashboard may take a few minutes. Do you want to export anyway?"),undefined,{buttons:[C(mstrmojo.desc(246,"Export"),Ad),C(mstrmojo.desc(221,"Cancel"),undefined,true)]});}else{Ad();}},dSave:function AB(Ag){var Ad=this,Af=this._super,E=Ad.model,Ae=function(){E.getDataService().submitUpdates({},{success:function(Ai){var Aj=function(An,Al,Am,Ak){return mstrmojo.Button.newWebButton(An,Ak,Al,{visible:Am,cssDisplay:"inline-block"});};if(Ai.objects[0]&&Ai.objects[0].dvm===2048){var Ah=Ad.rootCtrl.resolveFeature("warn-overwrite-flashVI");mstrmojo.warn(mstrmojo.desc(12188,""),null,{cssClass:"save-over",buttons:[Aj(mstrmojo.desc(12190,"Save Over"),false,!!Ah,function(){Af.call(Ad,Ag);}),Aj(mstrmojo.desc(12191,"Save as New"),true,true,function(){E.saveAsRW();}),Aj(mstrmojo.desc(2223,"Cancel"),false,true)]});}else{Af.call(Ad,Ag);}}},Q.copy(AU,{params:{taskId:"getObjectInfo",objectIDs:Ad.model.oid,objectTypes:"55"}}));};d();J.call(this,mstrApp.isSingleTier?this._super:Ae,undefined,AU);},openDME:function(Ai,Af,Aj){var Ah=this,Ae=Ah.model,Ad=function Ag(Ak){return mstrmojo.array.filter(Ak,function(Al){return Al.st!==AG.STP.CONS&&Al.st!==AG.STP.CUSTOMGROUP&&Al.did!==Af.metricId;});},E=new mstrmojo.ME.DerivedMetricIDE({datasetsObjects:mstrmojo.hash.copy({visible:false},Ae.getDatasetsPanel("190px",Ad)),zIndex:5});Af.onApplyMetricCallback=Aj;Af.datasets=Ae.datasets;E.open(Ai,Af);E.datasetsObjects.refresh();this.addDisposable([E]);},openDAE:function k(Al,Ae,Aj,Af){var Ag=this.model,Am=this.daIDE=new mstrmojo.ME.DerivedAttributeIDE({datasetsObjects:B.call(this,Ag),zIndex:5}),Ak=this,Ad=function(As,Ao){var Ap=Am.action,Aq=Ap.did?Ap.preupdate:Ap.precreate,Ar=Ag.controller.getRefreshCallback();As=Aq?Aq(As):As;Ak.submitUndoRedoUpdates(As,null,X.wrapMethods(Ao,Ar),Ap.extras);};Q.copy({cmd:"editNew",fnWait:Aj,msgID:Ag.mid,oncreate:Ad,onupdate:Ad},Ae);if(Af){Ae.funccat=mstrmojo.ME.DerivedAttributeIDE.getDefaultFunctionCategory(Af);var Ai=Af.fs&&Af.fs[0];if(Ai){Ae.refOi={n:Af.n+"@"+Ai.fnm,did:Af.did+"@"+Ai.fid};}}Am.action=Ae;Am.view=Al;if(Ae.did){AA.call(this,Ag,Ae.did,Ae.forms,{success:function An(){Am.open(Al,{editorId:Ae.id});},failure:function E(){Am.destroy();},canceled:function Ah(){Am.destroy();}});}else{Am.open(Al,{editorId:Ae.id});}this.addDisposable([Am]);},openDynamicLinkEditor:function AI(Al,Ae,Aj,Af){var Ag=this.model,Ah=this.daIDE=new mstrmojo.ME.DerivedAttributeIDE({datasetsObjects:B.call(this,Ag,true),zIndex:5,hasFunctionBrowser:false,onObjectInsert:function(An){mstrmojo.all.mstrDLE.onObjectInsert(An);}}),Ak=this,Ad=function(Ar,An){var Ao=Ah.action,Ap=Ao.did?Ao.preupdate:Ao.precreate,Aq=Ag.controller.getRefreshCallback();Ar=Ap?Ap(Ar):Ar;Ak.submitUndoRedoUpdates(Ar,null,X.wrapMethods(An,Aq),Ao.extras);};Q.copy({cmd:"editNew",fnWait:Aj,msgID:Ag.mid,oncreate:Ad,onupdate:Ad},Ae);if(Af){Ae.refOi=Af;Ae.n=Af.n+mstrmojo.desc(14719,"(Link)");}Ah.action=Ae;Ah.view=Al;if(Ae.did){AA.call(this,Ag,Ae.did,Ae.forms,{success:function Am(){Ah.open(Al,{editorId:"mstrDLE"});},failure:function E(){Ah.destroy();},canceled:function Ai(){Ah.destroy();}});}else{Ah.open(Al,{editorId:"mstrDLE"});}this.addDisposable([Ah]);},getReloadLayoutViewCallback:function c(Ad){var E=this.view;return X.wrapMethods({success:function(){E.showSelectedLayout();}},Ad);},getRefreshCallback:function AT(){var E=this.model;return X.wrapMethods(E.getDatasetsUpdateCallback(),E.getReloadLayoutModelCallback(),this.getReloadLayoutViewCallback());},getUpdateLayoutViewCallback:function P(Ad){var E=this.view;return X.wrapMethods({success:function(Ae){E.updateLayouts(Ae);}},Ad);},getUpdateLayoutsCallback:function G(){var E=this.model;return X.wrapMethods(E.getDatasetsUpdateCallback(),this.getUpdateLayoutViewCallback());},getPartialUpdateCallback:function F(Ag){var E={},Ae=this,Ad=Ae.model,Af=Ad.getSelectedViUnit().getZonesModel();return X.wrapMethods({success:function(Ai){var Ah=Ai.pukeys&&Ai.pukeys.split("\u001E");if(Ah&&Ah.length>0){E=Ad.getUnitDefinitions(Ah);}Ad.partialUpdate(Ai.data,E,Ai.defn,Ah);}},Ad.getUpdateHiddenLayoutsCallback(),Ag||Af&&Af.getUpdateCallback());},resumeVIPanelSelection:function AY(Ah){function Ae(Aj){var Ai=mstrmojo.array.filter(Aj.children,function(Ak){return Ak instanceof mstrmojo.vi.ui.BoxPanelContainer;});return Ai&&Ai[0];}function Ad(Aj){var Ak=Aj.view&&Aj.view.getSelectedLayoutWidget(),Ai=Ak&&Ae(Ak);return Ai&&Ai.tabList;}var Ag=this,E=Ad(this),Af=E&&E.selectedIndex;return X.wrapMethods({success:function(){var Ai=Ad(Ag);if(Ai){Ai.singleSelect(Af);}}},Ah);},insertVisualization:function x(){this.model.addVisualization();},insertFilter:function n(){this.model.insertNewFilter();},getViPanel:function I(E){return this.view.getViPanel(E);},openViPanel:function AN(E,Ad){this.view.openViPanel(E,Ad);},selectViPanel:function e(E){this.view.selectViPanel(E);},insertText:function z(){this.model.insertNewText();},insertHtml:function AE(){this.model.insertNewHtmlContainer();},clearAllUnits:function g(){this.model.getSelectedViUnit().getZonesModel();},insertImage:function U(){this.model.insertNewImage();},_getXtabCallback:function Y(Ad,Ae,E){return X.wrapMethods(this._super(Ad,E),Ae||(Ad.parent.getZonesModel&&Ad.parent.getZonesModel().getUpdateCallback()));},refresh:function AP(){AK(this);},toggleAutoRefresh:function(){this[(!!this.isAutoRefreshStarted()?"stop":"start")+"AutoRefresh"]();},startAutoRefresh:function D(){var E=this.model,Ad=E.rf,Ae=this;if(Ad>0){if(this.autoRefreshHandler){this.stopAutoRefresh();}this.refStartTime=new Date();this.autoRefreshHandler=setTimeout(function(){AK(Ae,{success:function Ag(){if(Ae.autoRefreshHandler){Ae.startAutoRefresh();}},submission:function Ah(Ai){Ae.autoRefReqId=Ai;Ae.autoRefReqSent=true;},complete:function Af(){Ae.autoRefReqId=undefined;Ae.autoRefReqSent=false;Ae.remTimeForRef=0;}});},((this.remTimeForRef!==0)?this.remTimeForRef:Ad)*u);}},pauseAutoRefresh:function N(){if(this.autoRefreshHandler){clearTimeout(this.autoRefreshHandler);this.remTimeForRef=this.model.rf-(new Date().getTime()-this.refStartTime.getTime())/u;}},addDataset:function AV(){var Ad=this,Ae=Ad&&Ad.datasetsPanel,E=Ae&&Ae.getShowDatasetPicker();if(E){E();}},createDataset:function Aa(){var E=this,Ad=E&&E.datasetsPanel;if(Ad){Ad.openDatasetEditor({title:mstrmojo.desc(13362,"Report Editor")+" - "+mstrmojo.desc(11636,"New Dataset"),okBtnText:mstrmojo.desc(4447,"Add"),docModel:E.model});}},undo:function AQ(){this.cmdMgr.undo();},redo:function Ac(){this.cmdMgr.redo();},onCmdMgrChanged:function f(){mstrApp.rootCtrl.generateToolbar();},importFile:function r(){var E=this.model&&this.model.controller,Ad=this.model,Af=E&&E.datasetsPanel,Ae=[];Q.forEach(Ad.datasets,function(Ag){if(Ag.st===779&&Ad.hasPrivilegesForAllTables(Ag.tables)){Ae.push(Ag);}});if(Af&&Af.showDataImport){Af.showDataImport({isEdit:false,datasets:Ae,AnalysisId:this.model.mid,needDefn:true});}},inputConnectionDetails:function AO(Af){var Ae=this;if(Af&&Object.keys(Af).length>0){this.model.existingServerConnection=Af;}else{Af=this.model.existingServerConnection;}this.model.operation="inputConnectionDetails";var Ad=function(){if(Ae.model.operation==="inputConnectionDetails"){Ae.model.operation="none";}mstrApp.serverRequest({taskId:"resumeDashboardExecution",checkCS:true},{success:function Ag(Ah){if(Ah&&Ah.statusOnly!==true){mstrApp.start(Ah);}}},{doNotHold:true});};var E=function(Ah){if(Af&&Ah&&Ah.currentProject&&Ah.currentProject.project.id===Af.datasets[0].connInfo.pid){mstrApp.serverRequest({taskId:"changeConnString",ws:Ah.currentProject.webServer.connection.id,isn:Ah.currentProject.iServer.name,isp:Ah.currentProject.iServer.port,pn:Ah.currentProject.project.name,pid:Ah.currentProject.project.id},{success:function Ai(Aj){Ad();},failure:function Ag(Aj){mstrmojo.error({shortDesc:mstrmojo.desc(14397,"Something went wrong when changing the connection string.")});}},{doNotHold:true});}else{if(Af&&Ah&&Ah.currentProject.project.id!==Af.datasets[0].connInfo.pid){mstrmojo.error({shortDesc:"We cannot find the dataset(s) in the logged in server. Please try a different server or edit the connection by going to preferences."});}else{}}};this.rootCtrl.loadDataProvider(E);},inputCredentials:function AH(Ae){var E=this.model&&this.model.controller,Ad=E&&E.datasetsPanel;if(Ad&&Ad.showDataImport){Ad.showDataImport({documentModel:Ae,StatusCode:4,callback:function(){mstrApp.serverRequest({taskId:"resumeDashboardExecution"},{success:function Af(Ag){if(Ag&&Ag.statusOnly!==true){mstrApp.start(Ag);}}},{doNotHold:true});}});}},isDocChanged:function l(){var E=this.model,Ad=E.getDataService().stid||0,Ae=E.lastSavedStid||0;return Ad>Ae;},saveBeforeClosing:function p(Ak,Ah){var Ai=this,Ad=Ai.model,Ag=Ad&&Ad.isnew,Ae=Ad&&Ad.isRWReadonly,Af=function(){if(Ak&&Ak.success){Ak.success();}if(Ak&&Ak.complete){Ak.complete();}};if(this.isDocChanged()&&this.rootCtrl.resolveFeature("save-analysis")){var Aj=function(){this.close();this.destroy();},E=new mstrmojo.vi.ui.editors.ConfirmSaveEditor({onSave:function(){if(Ag||Ae){Ai.save(null,Ah);}else{Ai.dSave(Ak);}Aj.call(this);},onDonotSave:function(){Af();Aj.call(this);},onCancel:function(){Aj.call(this);}});E.open();}else{Af();}},openDEEditor:function AC(E,Af){var Aj=this,Ae="mstrmojo-derivedElements",Ai=mstrmojo.all[Ae]||mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.editors.DerivedElementsEditor",id:Ae}),Ah=Af.deObj,Ak=Af.fromDatasetPanel,Ag,Ad;if(Af.elemId){Ad=Af.elemId;delete Af.elemId;}Ag=new mstrmojo.vi.models.DEConsolidation(Af);Ag.xtab=Ak?null:E;Ag.docModel=Ak?E.docModel:E.model.docModel;Ag.controller=Aj;Ag.fromDS=Ak;Ai.browseConfig={attributeID:Af.attId||Ah.attId,datasetID:(Af&&Af.dsId)||(Ah&&Ah.dsId),messageID:Aj.model.mid};Ai.set("model",Ag);Ai.open();if(Ad||!Af.deObj){Ai.editItem(Ad);}},onAddQuickDE:function AM(E,Ae){var Ad=this;o(Ad,E,Ae,"addQuickDE");},onEditQuickDEList:function W(E,Ae){var Ad=this;o(Ad,E,Ae,"editQuickDEList");},onEditQuickDECalculation:function AJ(E,Ae){var Ad=this;o(Ad,E,Ae,"editQuickDECalculation");},onSetDEHierachyOptions:function AS(E,Ad){this.submitDEAction(E,Ad);},editQuickDECalculation:function M(E,Ad){this.submitDEAction(E,Ad);},editQuickDECalculationNumberFormat:function AL(E,Ad){this.submitDEAction(E,Ad);},removeQuickDE:function Z(E,Ad){this.submitDEAction(E,Ad);},submitDEAction:function t(E,Af){this._addNodeKeyToAction(E,Af);var Ae=this.dataService().getUpdateTemplateAction(E.k,Af),Ad=this.model;Ad.addUpdateObjects(Ae,{id:Af.oId,type:47,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE});this.submitUndoRedoUpdates([Ae],{},X.wrapMethods(Ad.getRebuildCallback(),Ad.getDatasetsUpdateCallback()));},addDSFromDatabase:mstrmojo.emptyFn,addDSFromFreeform:mstrmojo.emptyFn,dataService:function H(){return this.model.getDataService();},close:function m(){var E=this._super.bind(this);mstrApp.onNavigateOut(null,E);},onKeepOnlyOrExcludeNodeAdded:function a(Ad,E,Af){var Ah=E.vfexpr,Ae=E.vlexpr,Ag=Ad.getSelectorDataFromViewFilter(Ah);if(Ae||Ag===null){mstrmojo.warn(mstrmojo.desc(null,"This action will overwrite the advanced qualification set in the filter. Do you want to proceed?"),{confirmBtn:{fn:Af}});}else{Af();}},applyKeepOnly:function AZ(Ak,Aj,Ai,Ag){var E=Ak.model,Ad=Ak.gridData||Ak.model.data||Ak.node.data,Af=Ad.vfexpr,Ae=Ad.vlexpr,Ah=function(Am){var An=E.getKeepOnlyActionsForAssociatedNodes(Am||[],Aj);if(Ae){An.actions.push(this.dataService().getUpdateTemplateAction(Ak.k,E.getRemoveMetricLimitsAction(Ae)));}this.submitUndoRedoUpdates(An.actions,null,An.callback);}.bind(this),Al;if(Ag===-1){Al=[];}else{Al=[].concat(E.getSelectorDataFromViewFilter(Af));}if(Ag===-2){Al=mstrmojo.array.filter(Al,function(Am){return !Am.keepOnly;});}else{if(Ag>=0){Al.splice(Ag,1);}}if(Ai){this.onKeepOnlyOrExcludeNodeAdded(E,Ad,function(){Ah(Al.concat(Ai));});}else{Ah(Al);}},openCubeBrowser:function Ab(E){mstrApp.rootCtrl.openCubeBrowser(E);},browseObjectsOnServer:function(){var Ae=this.datasetsPanel;var Ad=this;function Af(){if(mstrApp.browseAllObjects===false){mstrmojo.alert(mstrmojo.desc(14332,"You do not have the privileges to browse the objects in this project."));}else{Ae.set("allObjectBrowserOpened",true);}Ad.model.operation="none";}this.model.operation="browseAllObjects";var E=mstrApp.rootCtrl.datasetsPanel;E.model.controller.rootCtrl.loadDataProvider(function(Ag){E.objectBrowser.set("dataProvider",Ag);Af();});},uploadImageToServer:function(Ad,Ae){var E=this.dataService();E.uploadImageToServer(Ad,Ae);}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.OIVMViewFactory","mstrmojo.vi.ui.BoxPanel","mstrmojo.vi.ui.DocBuilder","mstrmojo.vi.models.DocModel","mstrmojo.vi.controllers.DocumentController","mstrmojo.vi.controllers.UICmdMgr","mstrmojo.mstr.VisPropsEditorPanel");var O=mstrmojo.array;var R=mstrmojo.hash;var D=mstrmojo.EnumRWUnitType;var C=11;var H="mstrmojo-more-options-editor";var N="mstrmojo-simple-threshold-editor";var E={gm:"GraphMatrixVisualizationStyle",heatmap:"VIHeatMapVisualizationStyle",network:"NetworkVisualizationStyle"};function B(Z,Y){var a=null;if(Z!==null&&typeof Z==="object"){if(Z.k===Y&&Z.vis&&Z.vis.we){return Z;}R.forEach(R.keyarray(Z),function(b){if(Z.hasOwnProperty(b)){a=B(Z[b],Y);}if(a){return false;}});}return a;}function A(Z,Y){var a=null;O.forEach(Z.defn.layouts,function(b){O.forEach(R.keyarray(b.units),function(d){var c=b.units,e=c[d],f=(e&&e.t);if(!e||e._isDeleted||d!==Y){return ;}if([D.GRID,D.GRAPH,D.GRIDGRAPH].indexOf(f)>-1){a=e;return false;}});if(a){return false;}});return a;}var S=[];mstrmojo.mstr.VisPropsEditor=mstrmojo.declare(mstrmojo.Editor,[],{scriptClass:"mstrmojo.mstr.VisPropsEditor",title:"Visualization Properties Editor",width:"220px",nodeKey:null,init:function T(Y){this._super(Y);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VisPropsEditor rw");if(!mstrApp.onerror){mstrApp.onerror=function(Z){window.console.log(Z);};S.push("onerror");}if(!mstrApp.isInteractive){mstrApp.isInteractive=function(){return false;};S.push("isInteractive");}},start:function G(){this.loadDocModelData();},close:function P(){this._super();mstrmojo.array.forEach(S,function(Y){delete mstrApp[Y];});if(mstrmojo.all[H]){mstrmojo.all[H].destroy();}if(mstrmojo.all[N]){mstrmojo.all[N].destroy();}},children:[{scriptClass:"mstrmojo.HBox",alias:"buttonBarx",slot:"buttonNode",cssClass:"mstrmojo-VPE-buttonBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"btnOK",text:"OK",bindings:{enabled:function(){return(this.parent.parent.actions||[]).length>0;}},onclick:function(){var Y=this.parent.parent;Y.saveProps(Y.actions);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:"Cancel",onclick:function(){var Y=this.parent.parent;Y.close();}}]}],preparePropsPanelRendering:function X(Z){var Y=this;this.model=new mstrmojo.vi.models.DocModel(Z);this.model.getDocBuilder=null;this.builder=new mstrmojo.vi.ui.DocBuilder({parent:this,model:this.model});mstrApp.viewFactory=new mstrmojo.OIVMViewFactory();this.controller=new mstrmojo.vi.controllers.DocumentController({model:this.model,submitUndoRedoUpdates:function(d){var b=Y;d=mstrmojo.array.ensureArray(d);var c=d[0],a=b.mergeActions(c.actions?[{act:c.act,keyContext:c.keyContext||Y.nodeKey,actions:c.actions}]:d);b.saveProps(a);}});this.model.controller=this.controller;this.controller.cmdMgr=new mstrmojo.vi.controllers.UICmdMgr({controller:this.controller,model:this.model,dataService:this.model.getDataService()});},isVizValid:function(){var Y=this.getVisNode();if(this.visName===E.gm){if(mstrmojo.gm.GMUtility.isInvalidTemplate(Y.data)){this.close();mstrmojo.alert(mstrmojo.gm.GMUtility.getInvalidTemplateErrMsg());return false;}}return true;},renderPropsPanel:function Q(Y){this.preparePropsPanelRendering(Y);if(!this.isVizValid()){return ;}this.addChildren([{scriptClass:"mstrmojo.mstr.VisPropsEditorPanel",alias:"propsPanel",width:parseInt(this.width)-2*C+"px",height:parseInt(this.height)-2*C+"px",edtModel:this.getEditorModel()}]);this.render();},getEditorModel:function F(){return this.getVisInstance().edtModel;},getVisNode:function W(){this.node={defn:A(this.model,this.nodeKey),data:B(this.model.data,this.nodeKey)};var Y=this.visName=this.builder.getMojoVisName(this.node);if(Y){this.node.data.visName=Y;}return this.node;},getVisInstance:function L(){var b=this,Z=this.model,a=this.node=this.getVisNode();var Y=this.builder.newMojoVisualization(Z,a);Y.defn=a.defn;Y.k=this.nodeKey;Y.updateAfterAction=function(c){b.set("actions",b.mergeActions(c));};if(this.visName===E.gm||this.visName===E.heatmap){Y.submitUpdatesAndPersistXML=function(c){c=c||[];if(this.isXMLDirty&&this.isXMLDirty()){c.push(this.getPersistAction());}if(c.length===0){return ;}b.set("actions",b.mergeActions(c));};}Y.parent=this;this.getTitleBarVisibility=function(){return true;};Y.showTitleAndContainerFormats=false;if(Y.zonesModel){Y.zonesModel.checkAndWarnLargeItemsForAddUnits=function(c,d){d();};Y.zonesModel.getUpdateCallback=function(){return{success:function(){var c=b.propsPanel&&b.propsPanel.contents;if(c){c.removeChildren();b.propsPanel.raiseEvent({name:"edtModelChanged"});}}};};}Y.skipPaintedCheck=true;Y.forceUpdateColorMap=true;Y.skipSuppressDataCheck=true;Y.update(a);this.renderViz(Y);return Y;},renderViz:function M(Y){var Z=[E.heatmap,E.gm,E.network].indexOf(this.visName)>-1;if(Z){mstrApp.getThemeClassName=function(){return"mojo-theme-light";};Y.placeholder=document.createElement("span");Y.width="0px";Y.height="0px";Y.render();}if(this.visName===E.network){Y.refresh=function(){};}if(this.visName===E.heatmap){Y.reRender=function(){};}},mergeActions:function I(Y){return(this.actions||[]).concat(Y);},saveProps:function K(c,a){var b=this,Z=function(){if(a!==false){b.close();}};if(c.length>0){this.submitPropsChange(c,function Y(){if(b.onOK){b.onOK();}Z();});}else{Z();}},submitPropsChange:function J(b,Y){var a={actions:b,style:{name:"RWIVEMojoStyle",params:{treesToRender:0}}};var Z={taskId:"mojoRWManipulation",rwb:this.rwb,messageID:this.messageID,stateID:-1,params:JSON.stringify(a),suppressData:true};var c={success:function(d){Y(d);},failure:function(d){mstrmojo.alert(d.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,c,Z);},loadDocModelData:function V(){var Z=this,Y="ServerJsonRWDStyle";this.retrieveServerJson({host:this,nodes:[this.nodeKey]},{success:function(a){Z.renderPropsPanel(a);},failure:function(a){mstrmojo.alert(a.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{style:{name:Y,params:{treesToRender:3}},params:{styleName:Y}});},retrieveServerJson:function U(Z,g,a){var e={},Y,c;var d=Z.nodes;if(d){e.partialRetrieval=d;}var f=Z.slices;if(f){e.slices=f;}if(a){Y=a.style;c=a.params;}var b={taskId:"getServerJSONResults",styleName:"ServerJsonRWDStyle",compress:1,rwb:this.rwb,messageID:this.messageID,stateID:-1,params:JSON.stringify(e)};if(this.executionMode){b.executionMode=this.executionMode;}mstrmojo.hash.copy(c,b);mstrmojo.xhr.request("POST",mstrConfig.taskURL,g,b);}});}());
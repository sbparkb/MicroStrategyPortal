var mstr={};mstr.Props={};mstr.Props.Widget={ID:"id",SCRIPTCLASS:"scriptClass",FEATURES:"features",CSSCLASS:"cssClass",LISTENS_TO:"listensTo",PROPOGATES_EVENTS:"propogatesEvents",UPDATES:"updates",PATH:"path",FOR:"for",PROPOGATES:"propogates",DOCUMENT:"document",ELEMENTID:"elementId",ELEMENT:"element",ISELEMENTVALID:"isElementValid",RENDERSTATUS:"renderStatus",PARENT:"parent",LAYOUTFILE:"layoutFile",LAYOUTCLASS:"layoutClass",LAYOUTHANDLERS:"layoutHandlers",ENABLED:"enabled",VISIBLE:"visible",MESSAGE:"message",HEIGHT:"height",WIDTH:"width",TYPE:"type",VALUE:"value",VALUEFORMS:"valueForms",VALUEFORMSMAP:"valueFormsMap",BROWSEFORMS:"browseForms",BROWSEFORMSMAP:"browseFormsMap",AVAILABLEVALUES:"availableValues",ISVALUEFROMLIST:"isValueFromList",ISVALUEFROMTREE:"isValueFromTree",ANSWER:"answer",DEFAULTANSWER:"defaultAnswer",RESTRICTION:"restriction",REQUIRED:"required",PAGENUMBER:"pageNumber",CAPTION:"caption",IMAGEENABLED:"imageEnabled",IMAGEDISABLED:"imageDisabled",STATUSCODE:"statusCode",SHOWREADYSTATE:"showReadyState",CHILDREN:"children",PREINITCHILDREN:"preInitChildren",CONTENTS:"contents",INPUT:"input",SIMPLEINPUT:"simpleInput",COMPLEXINPUT:"complexInput",INPUT1:"input1",INPUT2:"input2",ALLOWFILEIMPORT:"allowFileImport",ALLOWELEMENTBROWSE:"allowElementBrowse",BUTTONBAR:"buttonBar",LINK:"link",SHOWLINK:"showLink",BOOK:"book",TOC:"toc",SUMMARY:"summary",PREVIOUSBUTTON:"previousButton",NEXTBUTTON:"nextButton",CLOSESUMMARYBUTTON:"closeSummaryButton",CSSSHADOW:"cssShadow",MIN:"min",MAX:"max",AUTOSELECT:"autoSelect",ATTRIBUTE:"attribute",FORM:"form",ISLIST:"isList",ISTREE:"isTree",DATAFORMS:"dataForms",ROOT:"root",ROOTFLATTENEDTREE:"rootFlattenedTree",LISTITEMS:"listItems",SELECTEDINDICES:"selectedIndices",BLOCKCOUNT:"blockCount",BLOCKCOUNTMAP:"blockCountMap",BLOCKBEGIN:"blockBegin",FOLDER:"folder",FOLDERSIZE:"folderSize",FOLDERNODELOCATION:"folderNL",PATHTREE:"pathTree",PATHFLATTENEDTREE:"pathFlattenedTree",SEARCHXML:"searchXML",FILTERXML:"filterXML",ATTRIBUTEID:"attributeId",OBJECTTYPES:"objectType",ALLOWUNAVAILABLEVALUE:"allowUnavailableValue",INSERTUNAVAILABLEVALUEAT:"insertUnavailableValueAt",PRESERVEVALUEONREADYSTATECHANGE:"preserveValueOnReadyStateChange",LEAFELEMENTS:"leafElements",DISPLAYFORMTEXT:"displayFormText",DISPLAYFORMICON:"displayFormIcon",DISPLAYFORMS:"displayForms",NOSELECTIONTEXT:"noSelectionText",NOSELECTIONTEXT:"noSelectionIcon",MULTISELECTIONTEXT:"multiSelectionText",MULTISELECTIONTEXT:"multiSelectionIcon",EMPTYLISTTEXT:"emptyText",ICONFORM:"iconForm",MULTISELECT:"multiSelect",COMMANDID:"cmdId",DELEGATESCOMMANDS:"delegatesCommands",APPLIESTOPATH:"appliesToPath",POPUPID:"popupId",POPUPOBJECT:"popupObj",POPORIENTATION:"popOrientation",FRAMENAME:"frameName",TIMEOUT:"timeout",PROCESSORPOOLSIZE:"processorPoolSize",ENABLEWHILEFETCHING:"enableWhileFetching",FOLDER_OBJECT:"folderObj",FOLDER_STARTINDEX:"startIndex","FETCHBLOCKSIZE ":"fetchBlockSize",BACKGROUNDLOAD:"backgroundLoad",FETCHLABEL:"fetchLabel",PAGES:"pages",PAGESIN:"pagesIn",PAGERANGE:"pageRange",CURRENTPAGE:"currentPage",TITLE:"title",ROWS:"rows",COLUMNS:"columns",SHOWCOLUMNHEADERS:"showColumnHeaders",ROWSPERCOLUMN:"arrangementSize",COLUMNSPERROW:"arrangementSize",FROM:"from",TO:"to",FROMPATH:"fromPath",SHOWPATH:"showPath",SHOWSEARCH:"showSearch",SHOWUPDOWN:"showUpDown",SHOWFETCH:"showFetch",SHOWMATCHCASE:"showMatchCase",MATCHCASEDEFAULT:"matchCaseDefault",MATCHCASECAPTION:"matchCaseCaption",SHOWANDORPICKER:"showANDORPicker",SHOWNOTPICKER:"showNOTPicker",ANDORDEFAULT:"ANDORDefault",NOTDEFAULT:"NOTDefault",FLAT:"flat",KEEPAVAILABLEITEMS:"keepAvailableItems",INSERTIONMODE:"insertionMode",SORTPOSITIONFORM:"sortPositionForm",REQUESTSCRIPTCLASS:"requestScriptClass",BROWSEABLEITEMSEXPRESSION:"browseableItemsExp",DELIMITER:"delimiter",DATATYPE:"dataType",PREFIX:"prefix",HINTPREFIX:"hintPrefix",HINTSUFFIX:"hintSuffix",HINT:"hint",SHOWHINT:"showHint",OBJECTPATH:"objectPath",METRICQUAL_OBJECTPICKER:"objectPicker",METRICQUAL_FUNCTIONPICKER:"functionPicker",METRICQUAL_CONSTANT1:"constant1",METRICQUAL_CONSTANT2:"constant2",METRICQUAL_LEVELPICKER:"levelPicker",ATTRQUAL_OBJECTPICKER:"objectPicker",ATTRQUAL_FORMPICKER:"formPicker",ATTRQUAL_FUNCTIONPICKER:"functionPicker",ATTRQUAL_CONSTANT1:"constant1",ATTRQUAL_CONSTANT2:"constant2",ALLOWQUALIFYORSELECT:"allowQualifyOrSelect",ALLOWMETRICQUALIFY:"allowMetricQualify",SHOWMETRICDIMTY:"showMetricDimty",LABELDIMTY:"labelDimty",BETWEENWORD:"betweenWord",FUNCTIONCATEGORY:"functionCategory",DISPLAYEDFORMS:"displayedForms",DEFAULTOPERATOR:"defaultOperator",DEFAULTEXPRESSIONTYPE:"defaultExpressionType",DEFAULTATTREXPRESSIONTYPE:"defaultAttributeExprType",DEFAULTMETRICQUALFUNCTION:"defaultMetricQualFunction",DEFAULTMETRICLEVEL:"defaultMetricLevel",DEFAULTATTRQUALFUNCTION:"defaultAttrQualFunction",DEFAULTATTRLISTFUNCTION:"defaultAttrListFunction",RENDERMEMO:"renderMemo",ALLOWBROWSEFOLDER:"allowBrowseFolder",ALLOWBROWSEATTRIBUTE:"allowBrowseAttribute",ALLOWBROWSEHIERARCHY:"allowBrowseHierarchy",ROOTLESSNODETEXT:"rootlessNodeText",EMPTYTREETEXT:"emptyTreeText",COLLECTFORMS:"collectForms",YEAR:"year",MONTH:"month",DAY:"day",SEARCHREQUIRED:"searchRequired",SEARCHREQUIREDTEXT:"searchRequiredText"};mstr.$W=mstr.Props.Widget;mstr.Props.Cache={CACHETYPE:"cacheType"};mstr.Props.Log={LEVEL:"level"};mstr.Props.MSTRFolderItem={DSSID:"dssid",NAME:"n",DISPLAYNAME:"dispn",DESC:"desc",ICON:"tp",TYPE:"otp",SUBTYPE:"dsstp",DSSTYPE:"dsstp",DATATYPE:"dtp",DSSFORMS:"dssforms",LOCKED:"locked",ISBROWSE:"isBrowse"};mstr.Enum={};mstr.Enum.REGEXP_RESERVED_CHARS={"$":true,"(":true,")":true,"*":true,"+":true,".":true,"?":true,"[":true,"\\":true,"]":true,"^":true,"{":true,"|":true,"}":true};mstr.Enum.Widget={};mstr.Enum.Widget.PROPTYPE={SCALAR:0,LIST:1,HASH:2};mstr.Enum.Widget.UPDATES={DEFAULT:1,ENABLED:2,STATE:4,VALUE:8,VALUESSUPPORTED:16,CUSTOM:32};mstr.Enum.Widget.STATE={HOVER:1,SELECTED:2};mstr.Enum.Widget.READYSTATE={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};mstr.Enum.Widget.RENDERSTATUS={NOT_STARTED:0,IN_PROGRESS:1,RENDEREDSELF:2,RENDEREDCHILDREN:3,RENDEREDALL:4,ERROR:5};mstr.Enum.Widget.POPORIENTATION={CONTEXTMENU:0,VERTICAL:1};mstr.Enum.Widget.NOTIFIES={NONE:0,SELF:1,LISTENERS:2,CHILDREN:4,PARENT:8};mstr.Enum.Widget.AUTOWRITEBACK={OFF:0,ONBLUR:1,ONKEYPRESS:2};mstr.Enum.Widget.AUTOFORMAT={OFF:0,ONBLUR:1,ONKEYPRESS:2,USEDEFAULT:3};mstr.Enum.Widget.AUTOVALIDATE={OFF:0,ONBLUR:1,ONKEYPRESS:2,USEDEFAULT:3};mstr.Enum.MSTRFolderItem={};mstr.Enum.MSTRFolderItem.TYPE={FILTER:1,TEMPLATE:2,REPORTDEFINITION:3,METRIC:4,AGGMETRIC:7,FOLDER:8,PROMPT:10,ATTRIBUTE:12,FACT:13,DIMENSION:14,HIERARCHY:14,ELEMENT:1048576,ATTRIBUTEFORM:21,CONSOLIDATION:47,CONSOLIDATIONELEMENT:48,PROJECT:32,DIMTYUNIT:1048578,DIMTYUNITATTRIBUTE:1048581,DIMTYUNITDIMENSION:1048582};mstr.Enum.MSTRFolderItem.ICON={FOLDER:"f",FOLDERSHORTCUT:"f_sc",ATTRIBUTE:"a",LOCKEDATTRIBUTE:"la",ATTRIBUTEFORM:"fo",TEMPLATE:"t",FILTER:"fi",METRIC:"m",ELEMENT:"ae",HIERARCHY:"hi",PROJECT:"p"};mstr.Enum.DataForm={};mstr.Enum.DataForm.DATATYPE={NUMERIC:1,STRING:2,DATE:3,INTEGER:4,IMAGE:5,HTML:6};mstr.Enum.Textbox={};mstr.Enum.Textbox.DATATYPE={UNKNOWN:0,STRING:1,NUMERIC:2,INTEGER:4,DATE:3};mstr.Enum.Column={};mstr.Enum.Column.SHOWAS={TEXT:0,ICON:1};mstr.Enum.Request={};mstr.Enum.Log={};mstr.Enum.Log.LEVEL={TRACE:8,WARNING:2,ERROR:1};mstr.Enum.Log.CATEGORY={CREATE:"Init",RENDER:"Render",NOTIFY:"Notify",CACHE:"Cache",LAYOUT:"Layout"};mstr.Enum.Response={};mstr.Enum.Response.STATUSCODE={SUCCESS:200};mstr.Enum.Validation={};mstr.Enum.Validation.STATUSCODE={VALID:0,INVALID_DATATYPE:1,EXCEEDS_MIN_VALUE:2,EXCEEDS_MAX_VALUE:3,EXCEEDS_MIN_LENGTH:4,EXCEEDS_MAX_LENGTH:5,EXCEEDS_MIN_COUNT:6,EXCEEDS_MAX_COUNT:7,INVALID_ANSWERS:8,NO_INPUT:9,NO_PERSONAL_ANSWER_NAME:10,INCOMPLETE_CONDITION:11,TRUNCATED:12,INCOMPLETE_CONDITION_ON_AUTO_NODE:13,INVALID_PERSONAL_ANSWER_NAME:14,DUPLICATED:15,INVALID:999};mstr.Enum.Event={};mstr.Enum.Event.NAME={ANY:"*",LOAD:"load",RESIZE:"resize",AFTERRESIZE:"afterresize",CHANGEELEMENT:"changeelement",CHANGEVISIBLE:"changevisible",CHANGEENABLED:"changeenabled",CHANGESTATE:"changestate",CHANGEMESSAGE:"changemessage",CHANGEHEIGHT:"changeheight",CHANGEWIDTH:"changewidth",CHANGEFOLDER:"changefolder",CHANGEFOLDERSIZE:"changefoldersize",CHANGEBLOCKBEGIN:"changeblockbegin",CHANGEBLOCKCOUNT:"changeblockcount",CHANGEPATHTREE:"changepathtree",CHANGELISTITEMS:"changelistitems",ADDLISTITEMS:"addlistitems",REMOVELISTITEMS:"removelistitems",CHANGESELECTEDINDICES:"changeselectedindices",ADDSELECTEDINDICES:"addselectedindices",REMOVESELECTEDINDICES:"removeselectedindices",CHANGELEADSELECTEDINDEX:"changeleadselectedindex",CHANGEROOTNODE:"changerootnode",ADDTREENODES:"addtreenodes",REMOVETREENODES:"removetreenodes",CHANGENODEVALUE:"changetreenodevalue",ADDCONDITION:"addcondition",EDITNODE:"editnode",CHANGESELECTEDPATHS:"changeselectedpaths",ADDSELECTEDPATHS:"addselectedpaths",REMOVESELECTEDPATHS:"removeselectedpaths",CHANGELEADSELECTEDPATH:"changeleadselectedpath",CHANGEEDITPATH:"changeeditpath",CHANGEDATAFORMS:"changedataforms",CHANGEVALUE:"changevalue",CHANGEAVAILABLEVALUES:"changeavailablevalues",CHANGERENDERSTATUS:"changerenderstatus",MOUSEDOWNLISTITEM:"mousedownlistitem",CLICKLISTITEM:"dblclicklistitem",DBLCLICKLISTITEM:"dblclicklistitem",BEFOREEXEC:"beforeexec",MOUSEDOWNTREENODE:"mousedowntreenode",CLICKTREENODE:"dblclicktreenode",DBLCLICKTREENODE:"dblclicktreenode",POPUPOPEN:"open",POPUPCLOSE:"close",EDITOROK:"ok",EDITORAPPLY:"apply",EDITORCANCEL:"cancel",EDITORSAVE:"save",ADDREQUEST:"addrequest",REMOVEREQUEST:"removerequest",CHANGEREADYSTATE:"changereadystate",CHANGEPAGERANGE:"changepagerange",CHANGEPAGE:"changepage",LOGIN:"login",TOGGLETOC:"toggletoc"};mstr.$Evt=mstr.Enum.Event.NAME;mstr.Enum.VIEWMEDIA={STATIC:1,INTERACTIVE:2,EDITABLE:4,FLASH:8,EXPORT_EXCEL:16,EXPORT_PDF:32,EXPORT_HTML:64,EXPORT_FLASH:128,PRIVATE:32768};mstr.Enum.Widget.COMMANDID={ADD:"Add",ADDALL:"AddAll",REMOVE:"Remove",REMOVEALL:"RemoveAll",CLEAR:"Clear",MOVEUP:"MoveUp",MOVEDOWN:"MoveDown",SELECTNEXT:"SelectNext",FETCHFIRST:"FetchFirst",FETCHPREVIOUS:"FetchPrevious",FETCHNEXT:"FetchNext",FETCHLAST:"FetchLast",FETCHBLOCK:"FetchBlock",BROWSEPATH:"BrowsePath",UPFOLDER:"BrowseParent",SEARCH:"Search",SEARCHFOLDERS:"SearchFolders",SEARCHELEMENTS:"SearchElements",BROWSE:"Browse",BROWSEFORMS:"BrowseForms",BROWSEFOLDER:"BrowseFolder",BROWSEATTRIBUTE:"BrowseAttribute",BROWSEHIERARCHYITEM:"BrowseHierarchyItem",CANCELREQUEST:"CancelRequest",OK:"OK",CANCEL:"Cancel",SAVE:"Save",OPEN:"Open",CLOSE:"Close",GROUP:"Group",UNGROUP:"Ungroup",DELETENODES:"DeleteNodes",SWAPWITHPREVIOUS:"SwapWithPrevious",SWAPWITHNEXT:"SwapWithNext",ADDCONDITION:"AddCondition"};mstr.$Cmd=mstr.Enum.Widget.COMMANDID;mstr.Settings={};mstr.Settings.Http={IMAGEPATH:"../style/mstr/images/",CACHE:true};mstr.Settings.Log={LEVEL:mstr.Enum.Log.LEVEL.TRACE};mstr.Settings.Locale={ID:1033,DECIMALSEP:".",THOUSANDSEP:",",LISTSEP:",",DATEINPUTFORMATS:[],TIMEINPUTFORMATS:[],NUMBERINPUTFORMATS:[],INTEGERINPUTFORMATS:[],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",TWODIGITYEARSTART:2029,MONTHNAME_SHORT:[],MONTHNAME_FULL:[],AM_NAME:"AM",PM_NAME:"PM"};mstr.Settings.Hints={NUMBER:"##.##",INTEGER:"##",STRING:null,DATE:mstr.Settings.Locale.DATEOUTPUTFORMAT};mstr.Settings.Scheme={DEFAULT_BORDEROLOR:null,DEFAULT_BGCOLOR:null,FLAT_BORDERCOLOR:"#c0c0c0",FLAT_BGCOLOR:"#d4d0c8",HOVER_BORDERCOLOR:"#0A246A",HOVER_BGCOLOR:"#B6BDD2",SELECTED_BORDERCOLOR:"#0A246A",SELECTED_BGCOLOR:"#D4D5D8",SELECTED_HOVER_BGCOLOR:"#8592B5",LARGEPREVIEWS:{pkr1:"graphpkr1",pkr2:"graphpkr2",pkr4:"graphpkr4",pkr8:"graphpkr8",pkr16:"graphpkr16",pkr32:"graphpkr32",pkr64:"graphpkr64",pkr128:"graphpkr128",pkr256:"graphpkr256",pkr512:"graphpkr512",pkr1024:"graphpkr1024",pkr2048:"graphpkr2048",pkr4096:"graphpkr4096",pkr8192:"graphpkr8192",pkr16384:"graphpkr16384",pkr32768:"graphpkr32768",pkr65536:"graphpkr65536",pkr131072:"graphpkr131072",pkr262144:"graphpkr262144",pkr524288:"graphpkr524288",pkr1048576:"graphpkr1048576",pkr2097152:"graphpkr2097152",pkr4194304:"graphpkr4194304",pkr8388608:"graphpkr8388608",pkr16777216:"graphpkr16777216",pkr33554432:"graphpkr33554432"}};mstr.Settings.Render={REPAINT_EVERY_CHILDCOUNT:10};mstr.Enum.Nodes={};mstr.Enum.Nodes.DATATYPE={UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30,INT64:34};mstr.Enum.Nodes.VariantType={VT_EMPTY:0,VT_NULL:1,VT_I2:2,VT_I4:3,VT_R4:4,VT_R8:5,VT_CY:6,VT_DATE:7,VT_BSTR:8,VT_DISPATCH:9,VT_ERROR:10,VT_BOOL:11,VT_VARIANT:12,VT_UNKNOWN:13,VT_DECIMAL:14,VT_I1:16,VT_UI1:17,VT_UI2:18,VT_UI4:19,VT_I8:20,VT_UI8:21,VT_INT:22,VT_UINT:23,VT_VOID:24,VT_HRESULT:25,VT_PTR:26,VT_SAFEARRAY:27,VT_CARRAY:28,VT_USERDEFINED:29,VT_LPSTR:30,VT_LPWSTR:31,VT_RECORD:36,VT_FILETIME:64,VT_BLOB:65,VT_STREAM:66,VT_STORAGE:67,VT_STREAMED_OBJECT:68,VT_STORED_OBJECT:69,VT_BLOB_OBJECT:70,VT_CF:71,VT_CLSID:72,VT_BSTR_BLOB:4095,VT_VECTOR:4096,VT_ARRAY:8192,VT_BYREF:16384,VT_RESERVED:32768,VT_ILLEGAL:65535,VT_ILLEGALMASKED:4095,VT_TYPEMASK:4095};mstr.Enum.Nodes.FUNCTION={EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000};mstr.Enum.Nodes.MRPFUNCTION={TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23};mstr.Enum.Nodes.FUNCTIONTYPE={DEFAULT:1,RANK:2,RANKPERCENT:3};mstr.Enum.IMAGE_URL_TYPE={DUMMY_URL:0,HTTP_URL:1,BLOB_URL:2,IMAGE_NAME:3,TASK_URL:4};mstr.$debugging=true;mstr.$debug=function(A){if(mstr.$debugging){mstr.$debugging=window.confirm(A);}};mstr.$debugobj=function(C){var A=[];if(C){for(var B in C){A.push(B+" = "+C[B]);}}return A.join("\n");};mstr.timers={};mstr.controllers={};mstr.controllers.Factory=(function(){var F={};F.PATHDELIM="/";F._objs={};F._IDCOUNTER=1;F.add=function F_add(obj){if(obj){var id=this.validateId(obj);this._objs[id]=obj;return id;}return null;};F.obj=function F_obj(id){if(id in this._objs){return this._objs[id];}if(typeof (microstrategy)!="undefined"){return microstrategy.bone(id);}return null;};F.getPath=function F_getPath(p,contextObj){var v;var match=(p!=null)&&p.match(/^\"(.*)\"$/);if(match){v=match[1];if(String(parseInt(v))==v){v=parseInt(v);}return v;}var obj=contextObj;if(obj&&p&&p.split){var ps=p.split(this.PATHDELIM);for(var i=0,len=ps.length;i<len;i++){var n=ps[i];var matchId=n.match(/^\#(.*)/);v=matchId&&this.obj(matchId[1])||null;if(v==null){v=obj[n];}if(v==undefined){v=obj.props&&obj.props[n];}if(v==undefined){v=obj.get&&obj.get(n);}if(v==undefined){var match=n.match(/(.+)\((.*?)\)/);if(match){var methodName,argString;methodName=match[1];if(obj[methodName]){var args;args=this.resolveArgsString(match[2],contextObj);v=obj[methodName].apply(obj,args||[]);}}}obj=v;if(obj==null){break;}}}return obj;};F.resolveArgsString=function F_rsvArgsStr(str,contextObj){var args=[];if(str==null||str==""){return args;}str=str.replace(/\./gm,"/");var json=str.match(/\{(.*)\}/);if(json){var hash=args[0]={};var jsonPairs=(json[1].split(","))||[];var nameValuePair;for(var i=0,len=jsonPairs.length;i<len;i++){nameValuePair=jsonPairs[i].split(":");if(nameValuePair[0]==""||nameValuePair.length<2){continue;}hash[nameValuePair[0]]=this.getPath(nameValuePair[1],contextObj);}}else{var paths=str.split(",");for(var i=0,len=paths.length;i<len;i++){args[i]=this.getPath(paths[i],contextObj);}}return args;};F.setPath=function F_setPath(p,contextObj,v,bSilent){var i=p.lastIndexOf(this.PATHDELIM);if(i>0){contextObj=this.getPath(p.substring(0,i),contextObj);}if(contextObj){p=p.substr(i+1);if(String(parseInt(p))==p){p=parseInt(p);}if(bSilent){if(contextObj.props){contextObj.props[p]=v;}else{if(contextObj.set){contextObj.set(p,v);}else{contextObj[p]=v;}}}else{if(contextObj.set){contextObj.set(p,v);}else{if(contextObj.props){contextObj.props[p]=v;}else{contextObj[p]=v;}}}}};F.create=function F_create(json){var sc=json&&json[mstr.$W.SCRIPTCLASS];if(sc){return eval("new "+sc+"(json)");}return null;};F.safeget=function F_safeget(obj,p){if(!obj||p==null){return undefined;}var v=obj[p];if(v==undefined){v=obj.props&&obj.props[p];}if(v==undefined){v=obj.get&&obj.get(p);}return v;};F.safeset=function F_safeset(obj,p,v){if(!obj||p==null){return ;}if(obj.set){return obj.set(p,v);}else{if(obj.props){obj.props[p]=v;}else{obj[p]=v;}}};F.registerElement=function F_registerElement(el,hWin,json){this.registerWindow(hWin);if(el){if(!json){var s=el.value;if(s){eval("json = "+s);}}var obj=this.registerJSON(json,el.ownerDocument);if(obj){obj.props&&(obj.props[mstr.$W.ELEMENT]=el);obj.init&&obj.init();}return obj;}};F.registerWindow=function F_registerWindow(hWin){var doc=hWin&&hWin.document;if(!doc||doc.mstrRegistered){return ;}var fg=function(e){try{var evt=new mstr.lang.Event(e,hWin,hWin.document);mstr.controllers.EventManager.notifyWindowListeners(evt);}catch(localerr){}};var gt=function(e){var t=mstr.$E.target(e,hWin);var tagName=null;if(t&&t.tagName){tagName=t.tagName.toLowerCase();}return tagName;};var editable=function(t){while(t){if(t.contentEditable=="true"){return true;}t=t.parentNode;}return false;},fo=function(e){var tagName=gt(e),t=mstr.$E.target(e,hWin);return(tagName=="object"||tagName=="embed"||tagName=="textarea"||tagName=="select"||tagName=="input"||tagName=="html"||tagName=="option"||tagName=="label")||editable(t);};var fImg=function(e,b){if(gt(e)=="img"||(mstr.$E.target(e,hWin)&&mstr.$E.target(e,hWin).getAttribute&&mstr.$E.target(e,hWin).getAttribute("dg"))){doc.dragging=b;}};var fu=function(e){fImg(e,false);fg(e);};var fd=function(e){if(isMac&&mstr.utils.ISFF&&getButtonId(e)==2){return true;}fImg(e,true);fg(e);if(mstr.utils.ISW3C){return fo(e);}};var fm=function(e){fImg(e,true);fg(e);if(mstr.utils.ISIE4){return fo(e)?true:!doc.dragging;}};doc.onmousedown=mstr.utils.Objects.compositeFunc(doc.onmousedown,fd);doc.onmouseup=mstr.utils.Objects.compositeFunc(doc.onmouseup,fu);doc.onmousemove=mstr.utils.Objects.compositeFunc(doc.onmousemove,fm);var el=mstr.utils.ISW3C?hWin:doc.body;el.onunload=mstr.utils.Objects.compositeFunc(el.onunload,fg);el.onresize=mstr.utils.Objects.compositeFunc(el.onresize,fg);if(mstr.utils.ISIE6){el=doc.documentElement;el.onscroll=mstr.utils.Objects.compositeFunc(el.onscroll,fg);}else{el.onscroll=mstr.utils.Objects.compositeFunc(el.onscroll,fg);}doc.mstrRegistered=true;};F.registerJSON=function F_registerJSON(json,doc){var obj=this.create(json);if(obj){var id=this.add(obj);if((id!=null)&&obj.props){if(doc&&obj.props){obj.props[mstr.$W.DOCUMENT]=doc;}if(obj.isHTTPProcessor){mstr.http.Governor.addProc(obj);}}}return obj;};F.nextFreeId=function F_nextFreeId(){return"id_mstr"+this._IDCOUNTER++;};F.validateId=function F_validateId(obj){if(!obj){return ;}var id=obj.props?obj.props[mstr.$W.ID]:obj[mstr.$W.ID];if(id==null){id=this.nextFreeId();if(obj.props){obj.props[mstr.$W.ID]=id;}else{obj[mstr.$W.ID]=id;this._objs[id]=obj;}}return id;};F.plugin=function F_plugin(obj,plugin){if(!obj||!plugin){return ;}for(var n in plugin){if(n!="init"){obj[n]=plugin[n];}}if(plugin.init){plugin.init.apply(obj,[]);}};return F;})();mstr.$obj=function(A){return mstr.controllers.Factory.obj(A);};mstr.$path=function(B,A){return mstr.controllers.Factory.getPath(B,A);};mstr.$register=function(C,A){if(!A){A=window;}var B=mstr.controllers.Factory.registerElement(A.document.getElementById(C),A);return B;};mstr.$deferRegister=function(C,A){if(!mstr.deferredRegisters){mstr.deferredRegisters=[];}mstr.deferredRegisters.push({textareaId:C,hWin:A});if(!window.mstrDefersRegisters){window.mstrDefersRegisters=true;if(typeof (window.onload)=="function"){var B=window.onload;window.onload=function(D){B&&B();mstr.$doDeferredRegisters();};}else{window.onload=function(){mstr.$doDeferredRegisters();};}}};mstr.$doDeferredRegisters=function(){var A=mstr.deferredRegisters,B;if(!A||!A.shift){return ;}while(B=A.shift()){mstr.$register(B.textareaId,B.hWin);}};mstr.controllers.EventManager=(function(){var N={};N._listeners={};N.attachEventListener=function C(O,Q,E,P){if(!O||!Q||!E||!P){return ;}this.attachEventListenerByIds(mstr.controllers.Factory.validateId(O),mstr.controllers.Factory.validateId(Q),E,P);};N.attachEventListenerByPath=function I(P,E,O,R){var Q=mstr.controllers.Factory.getPath(E,P);this.attachEventListener(P,Q,O,R);};N.attachEventListenerByIds=function G(P,E,O,Q){if(!this._listeners[O]){this._listeners[O]={};}if(!this._listeners[O][E]){this._listeners[O][E]={};}this._listeners[O][E][P]=Q;};N.attachWindowEventListener=function D(O,E,P){this.attachEventListenerByIds(mstr.controllers.Factory.validateId(O),"win",E,P);};N.detachEventListener=function K(Q,R,O){if(!O){return ;}var E=Q&&Q.props&&Q.props.id;if(E==null){return ;}var P=R&&R.props&&R.props.id;if(P==null){return ;}this.detachEventListenerById(E,P,O);};N.detachEventListenerById=function H(P,E,O){if(this._listeners[O]&&this._listeners[O][E]){delete this._listeners[O][E][P];}};N.detachWindowEventListenerById=function A(O,E){if(!E){return ;}this.detachEventListenerById(O,"win",E);};N.detachWindowEventListener=function J(P,O){if(!O){return ;}var E=P&&P.props&&P.props.id;if(E==null){return ;}this.detachEventListenerById(E,"win",O);};N.notifyListeners=function F(O,E){this.notifyListenersOfId(O&&O.props&&O.props.id,E);};N.notifyWindowListeners=function M(E){this.notifyListenersOfId("win",E);};N.notifyListenersOfId=function L(P,O){var E=this.getListeners(P,O&&O.name);if(E){for(var S in E){var Q=mstr.$obj(S);if(Q){var R=E[S];Q[R]&&Q[R](O);}}}};N.getListeners=function B(E,O){if((E!=null)&&(O!=null)){return this._listeners[O]&&this._listeners[O][E];}};return N;})();mstr.controllers.ModalEditors=(function(){var A={};A._currentModalEditor=new Array();A.add=function(B){this._currentModalEditor[this._currentModalEditor.length]=B.props.id;return this._currentModalEditor;};A.remove=function(C){for(var B=0;B<this._currentModalEditor.length;B++){if(this._currentModalEditor[B]==C.props.id){this._currentModalEditor.length=B;break;}}return this._currentModalEditor;};A.size=function(){return this._currentModalEditor.length;};return A;})();mstr.utils={};(function(){var B=navigator&&navigator.userAgent||"",A=document.documentMode;mstr.utils.ISOPERA=!!(B.indexOf("Opera")>-1);mstr.utils.ISIE4=!!(self&&self.document&&self.document.all&&!mstr.utils.ISOPERA);mstr.utils.ISIE6=!!(B.indexOf("MSIE 6.0")>-1);mstr.utils.ISIE11=((B.indexOf("Trident/7.0")>-1)&&A===11);if(window.isEdgeModeEnabled){mstr.utils.ISIE7=((B.indexOf("MSIE 7.0")>-1)&&!A||A==7);mstr.utils.ISIE8=(A==8);mstr.utils.ISIE9=(A==9);mstr.utils.ISIE10=(A==10);mstr.utils.ISIE8PLUS=!!A;mstr.utils.ISDXIE=mstr.utils.ISIE4&&A<=9;}else{mstr.utils.ISIE7=!!(B.indexOf("MSIE 7.0")>-1);mstr.utils.ISIE8=!!(B.indexOf("MSIE 8.0")>-1&&A==8);mstr.utils.ISIE8PLUS=!!document.documentMode;mstr.utils.ISIE9=!!(B.indexOf("MSIE 9.0")>-1&&A==9);mstr.utils.ISIE10=!!(B.indexOf("MSIE 10.0")>-1&&A==10);mstr.utils.ISDXIE=mstr.utils.ISIE4&&!mstr.utils.ISIE10;mstr.utils.ISIE8C=((B.indexOf("Trident/4.0")>-1)&&A==7);mstr.utils.ISIE9C=((B.indexOf("Trident/5.0")>-1)&&A==7);mstr.utils.ISIE10C=((B.indexOf("Trident/6.0")>-1)&&A==7);mstr.utils.ISIE7C=(mstr.utils.ISIE8C||mstr.utils.ISIE9C||mstr.utils.ISIE10C);}mstr.utils.ISW3CIE=!!navigator.userAgent.match(/Trident.*rv/);mstr.utils.ISANYIE9=!!(B.indexOf("MSIE 9.0")>-1&&(navigator.userAgent.indexOf("Trident/5.0")>-1));mstr.utils.ISIE9Pre=mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8;mstr.utils.ISIE=B.indexOf("Trident/")>-1;mstr.utils.ISFF2=!!(B.indexOf("Firefox/2")>-1);mstr.utils.ISFF3=!!(B.indexOf("Firefox/3")>-1);mstr.utils.ISFF3_0=!!(B.indexOf("Firefox/3.0")>-1);mstr.utils.ISFF3_5=!!(B.indexOf("Firefox/3.5")>-1);mstr.utils.ISFF4PLUS=!!(B.search(/Firefox\/(\d{2}|[4-9])/)>-1);mstr.utils.ISFF=!!(B.indexOf("Firefox/")>-1);mstr.utils.ISCHROME=!!(B.indexOf("Chrome")>-1);mstr.utils.ISSAFARI=!!(B.indexOf("Safari")>-1)&&!mstr.utils.ISCHROME;mstr.utils.ISSAFARI3=mstr.utils.ISSAFARI&&!!(navigator.userAgent.indexOf("Version/3")>-1);mstr.utils.ISWK=!!(B.indexOf("AppleWebKit")>-1);mstr.utils.ISW3C=!!(self&&self.document&&self.document.getElementById&&(!mstr.utils.ISIE4||mstr.utils.ISIE8||mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE));}());mstr.utils.aboutBlankRestricted=null;mstr.utils.Objects=(function(){var D={};D.extendsClass=function B(F,E){F.prototype=new E();F.prototype.constructor=F;};D.compositeFunc=function C(E,F){if(!E&&!F){return null;}if(!E){return F;}if(!F){return E;}return(function(){var H=E(arguments[0],arguments[1],arguments[2]);var G=F(arguments[0],arguments[1],arguments[2]);return H&&G;});};D.findParentPopup=function A(G,E){if(!G){return null;}var F=E?G:G.get&&G.get("parent");while(F&&F.get){if(F.get("opener")){return F;}F=F.get("parent");}return null;};return D;})();mstr.$O=mstr.utils.Objects;mstr.utils.LayoutRenderer=(function(){var K={};K._checkAboutBlankRestricted=function(){if(mstr.utils.aboutBlankRestricted==null&&mstr.utils.ISIE4){mstr.utils.aboutBlankRestricted=true;var L=document.createElement("div");L.innerHTML="<div onclick='mstr.utils.aboutBlankRestricted = false; return false;'>&nbsp;</div>";document.body.appendChild(L);L.firstChild.click();document.body.removeChild(L);}};K.render=function B(S,R){if(!S||!R){return ;}this._checkAboutBlankRestricted();var L={};L.html=this._generateHTMLStr(S,R);var Q=this._markRenderTokens(L.html);L.html=Q.html;L.childPaths=Q.childPaths;if(L.html){var T=S[mstr.$W.DOCUMENT]||(S[mstr.$W.ELEMENT]&&S[mstr.$W.ELEMENT].ownerDocument);L.el=this._generateHTMLDom(T,L.html);}L.renderStatus=L.el?mstr.Enum.Widget.RENDERSTATUS.RENDEREDSELF:mstr.Enum.Widget.RENDERSTATUS.ERROR;return L;};K._markRenderTokens=function D(R){var T=[];var Q=new RegExp('<mstrlayout:wRender name=\\"([^"]+)\\"[^>]*>(.*?)</mstrlayout:wRender>',"gm");var S=function(V,U,X){var W=mstr.controllers.Factory.nextFreeId();T.push({name:U,id:W});return'<span class="mstrPlaceholder" name="'+U+'" id="'+W+'">'+X+"</span>";};var L=R.replace(Q,S);return{html:L,childPaths:T};};K._generateHTMLStr=function H(L,Q){return this._replaceIterationTokens(L,this._replaceAttributeTokens(L,Q));};K._replaceAttributeTokens=function P(X,L){var V=this._getLayoutHTMLInfo(X.layoutClass,L);if(!V||!V.arr){return ;}var R=V.arr;var U=V.tokens;var T={};for(var Q=0,S=mstr.$A.len(U);Q<S;Q++){var Y=U[Q].path;var W=T[Y];if(W==null){if(Y.indexOf(mstr.controllers.Factory.PATHDELIM)<0){W=X[Y];}else{W=mstr.controllers.Factory.getPath(Y,X);}if(W==null){W="";}T[Y]=W;}R[U[Q].index]=W;}return R.join("");};K.replaceLayoutHandlerTokens=function M(R,W){var a=R&&R.info,Y=R&&R.sequence;if(!a||!Y||!W){return R;}var V=/\-\-([^\-]*)\-\-/m;var T=["name","prop","eventName"];var L,h={},Z,U,S,g,b,Q,X;for(var c=0,f=mstr.$A.len(Y);c<f;c++){b=Y[c];if(b==null){continue;}Q=b.replace(/\-\-/g,"_doubledash_");if(!a[Q]||!a[Q].prop){continue;}if(L=a[Q].prop.match(V)){if(!S){S={info:mstr.$H.clone(R.info),sequence:[].concat(R.sequence)};}Z=L[1];U=h[Z];if(U==null){if(Z.indexOf(mstr.controllers.Factory.PATHDELIM)<0){U=W.get(Z);}else{U=mstr.controllers.Factory.getPath(Z,W);}if(U==null){U="";}h[Z]=U;}g=mstr.$H.clone(S.info[Q]);for(var d=0,e=T.length;d<e;d++){g[T[d]]=g[T[d]].replace("--"+Z+"--",U);}X=b.replace("--"+Z+"--",U);S.info[X]=g;delete S.info[Q];S.sequence[c]=X;}}return S||R;};K._getLayoutHTMLInfo=function G(Q,L){var S=Q.replace(/\./g,"_");var R=this.layoutHTMLCache&&this.layoutHTMLCache[S];if(!R){R=this._parseLayoutHTML(L);if(!this.layoutHTMLCache){this.layoutHTMLCache={};}this.layoutHTMLCache[S]=R;}return R;};K._parseLayoutHTML=function I(T){T=this._trimLayoutNodes(T);var R=/\{\@([^}]*)\}/m;var Q=[];var U=[];var L=0;var S;while(S=T.match(R)){Q[L]=T.substring(0,S.index);U.push({path:S[1],index:L+1});L+=2;T=T.substr(S.index+S[0].length);}Q[L]=T;return{arr:Q,tokens:U};};K._replaceAttributeTokensOrig=function N(L,Q){var S={};var R=function(U,T){var V=S[T];if(V==null){if(T.indexOf(mstr.controllers.Factory.PATHDELIM)<0){V=L[T];}else{var V=mstr.controllers.Factory.getPath(T,L);}if(V==null){V="";}S[T]=V;}return V;};return this._trimLayoutNodes(Q).replace(/\{\@([^}]*)\}/gm,R);};K._replaceIterationTokens=function F(Q,U){var S=new RegExp('<mstrlayout:wIterate name="([^"]+)" id="([^"]+)"[^>]*>(.*?)</mstrlayout:wIterate>',"m");var L=[];var T;while(T=U.match(S)){L.push(U.substring(0,T.index));var R=this._iterateContent(Q,T[0],T[1],T[2],T[3]);if(R){L.push(R);}U=U.substr(T.index+T[0].length);}L.push(U);return L.join("");};K._iterateContent=function O(Y,L,Q,R,X){if(!Q){return"";}if(!R){R=Q+"__#";}if(!X){X='<mstrlayout:wRender name="'+R+'"></mstrlayout:wRender>';}var S=mstr.controllers.Factory.getPath(Q,Y);var U=mstr.$A.len(S);if(U){var V=new RegExp('<mstrlayout:wRender name="'+R+'"[^>]*>(.*?)</mstrlayout:wRender>',"gm");var W=[];for(var T=0;T<U;T++){W.push(X.replace(V,'<mstrlayout:wRender name="'+Q+mstr.controllers.Factory.PATHDELIM+T+'">$1</mstrlayout:wRender>'));}return W.join("");}return"";};K._trimLayoutNodes=function J(Q){var L=Q.indexOf(">");return Q.substring(L+1,Q.length-20);};K._generateHTMLDom=function C(Q,R){var L=Q.createElement("span");if(mstr.utils.aboutBlankRestricted){Q.body.appendChild(L);L.innerHTML=R;Q.body.removeChild(L);}else{L.innerHTML=R;}return L;};K.getLayoutHandlers=function E(R,Q){var S=R.replace(/\./g,"_");var L=this.layoutHandlerCache&&this.layoutHandlerCache[S];if(!L){L=this._parseLayoutHandlers(Q);if(!this.layoutHandlerCache){this.layoutHandlerCache={};}this.layoutHandlerCache[S]=L;}return L;};K._parseLayoutHandlers=function A(V){var T=V.indexOf(">");V=V.substring(0,T);var S={},W;var R=[];var U;while(U=V.match(/([^\s=]+)=\"([^\"]+)\"/m)){var Q={};Q.name=U[1];Q.str=U[2];var L=U[1].split("_");L.shift();Q.prop=L.pop();Q.method=L.pop();if(Q.method=="win"){Q.src=Q.method;Q.eventName=Q.prop;}else{Q.src=L.pop();Q.eventName=[Q.method,Q.prop].join("_");}W=Q.name.replace(/\--/g,"_doubledash_");S[W]=Q;R.push(Q.name);V=V.substr(U.index+U[0].length);}return{info:S,sequence:R};};return K;})();mstr.utils.Animations=(function(){var C={};C._lookup={};C.add=function G(A,P,Q,S){if(!Q||!P){return ;}var R=P.id;if(!R){R=P.id=mstr.controllers.Factory.nextFreeId();}if(!this._lookup[A]){this._lookup[A]={};}Q.id=R;Q.el=P;Q.callback=S;this._lookup[A][R]=Q;return R;};C.remove=function E(A,P){if(this._lookup[A]){delete this._lookup[A][P];}};C.doAnimationRequest=function K(P,Q){var A=false;if(this["do_animation_"+P]){A=this["do_animation_"+P](Q);}if(!A){this.afterAnimationRequest(P,Q);}};C.afterAnimationRequest=function N(A,Q){var P=this._lookup[A]&&this._lookup[A][Q];if(P&&P.callback){P.callback();}this.remove(A,Q);};C.isAnimating=function J(P,A){return !!(P&&this._lookup[A]&&this._lookup[A][P.id]);};C.scroll=function I(Q,A,U,P,T){if(!Q){return false;}P=parseInt(P);if(!P||P<0){P=10;}var R={endX:A,endY:U,steps:P,stepCounter:0};if(A!=null){R.startX=Q.scrollLeft;R.stepX=(A-R.startX)/P;}if(U!=null){R.startY=Q.scrollTop;R.stepY=(U-R.startY)/P;}var S=this.add("scroll",Q,R,T);return this.doAnimationRequest("scroll",S);};C.do_animation_scroll=function D(Q){var P=this._lookup.scroll&&this._lookup.scroll[Q];if(!P||!P.el){return ;}P.stepCounter++;if(P.endX!=null){P.el.scrollLeft=P.endX-P.stepX*(P.steps-P.stepCounter);}if(P.endY!=null){P.el.scrollTop=P.endY-P.stepY*(P.steps-P.stepCounter);}if(P.stepCounter<P.steps){var A=100-parseInt(95*Math.sin(Math.PI*P.stepCounter/P.steps));self.setTimeout("mstr.utils.Animations.doAnimationRequest('scroll', '"+Q+"')",A);return true;}return false;};C.resize=function B(Q,A,U,P,T){if(!Q){return false;}P=parseInt(P);if(!P||P<0){P=10;}var R={endX:A,endY:U,steps:P,stepCounter:0};if(A!=null){R.startX=Q.offsetWidth;R.stepX=(A-R.startX)/P;}if(U!=null){R.startY=Q.offsetHeight;R.stepY=(U-R.startY)/P;}var S=this.add("resize",Q,R,T);return this.doAnimationRequest("resize",S);};C.do_animation_resize=function H(Q){var P=this._lookup.resize&&this._lookup.resize[Q];if(!P||!P.el){return ;}P.stepCounter++;if(P.endX!=null){P.el.style.width=(P.endX-P.stepX*(P.steps-P.stepCounter))+"px";}if(P.endY!=null){P.el.style.height=(P.endY-P.stepY*(P.steps-P.stepCounter))+"px";}if(P.stepCounter<P.steps){var A=100-parseInt(95*Math.sin(Math.PI*P.stepCounter/P.steps));self.setTimeout("mstr.utils.Animations.doAnimationRequest('resize', '"+Q+"')",A);return true;}return false;};C.alpha=function M(R,A,Q,P,U){if(!R){return false;}P=parseInt(P);if(!P||P<0){P=15;}var S={opStart:A,opStop:Q,steps:P,opDelta:(Q-A)/P,stepCounter:0};var T=this.add("alpha",R,S,U);return this.doAnimationRequest("alpha",T);};C.do_animation_alpha=function F(R){var P=this._lookup.alpha&&this._lookup.alpha[R];if(!P||!P.el){return ;}P.stepCounter++;var Q=P.opStop-P.opDelta*(P.steps-P.stepCounter);if(mstr.utils.ISDXIE){P.el.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+Q+")";}else{P.el.style.opacity=Q/100;}if(P.stepCounter<P.steps){var A=100-parseInt(95*Math.sin(Math.PI*P.stepCounter/P.steps));self.setTimeout("mstr.utils.Animations.doAnimationRequest('alpha', '"+R+"')",A);return true;}return false;};C.move=function L(Q,A,U,P,T){if(!Q){return false;}P=parseInt(P);if(!P||P<0){P=10;}var R={endX:A,endY:U,steps:P,stepCounter:0};if(A!=null&&!isNaN(A)){R.startX=mstr.utils.BoxModel.getElementLeft(Q);R.stepX=(A-R.startX)/P;}if(U!=null&&!isNaN(U)){R.startY=mstr.utils.BoxModel.getElementTop(Q);R.stepY=(U-R.startY)/P;}var S=this.add("move",Q,R,T);return this.doAnimationRequest("move",S);};C.do_animation_move=function O(Q){var P=this._lookup.move&&this._lookup.move[Q];if(!P||!P.el){return ;}P.stepCounter++;if(P.endX!=null){P.el.style.left=(P.endX-P.stepX*(P.steps-P.stepCounter))+"px";}if(P.endY!=null){P.el.style.top=(P.endY-P.stepY*(P.steps-P.stepCounter))+"px";}if(P.stepCounter<P.steps){var A=100-parseInt(95*Math.sin(Math.PI*P.stepCounter/P.steps));self.setTimeout("mstr.utils.Animations.doAnimationRequest('move', '"+Q+"')",A);return true;}return false;};return C;})();mstr.utils.BoxModel=(function(){var R={};R.getBox=function J(a){var b={};b.height=mstr.utils.BoxModel.getElementOuterHeight(a);b.width=mstr.utils.BoxModel.getElementOuterWidth(a);b.left=mstr.utils.BoxModel.getElementSumOffsetLeft(a);b.right=b.left+b.width;b.top=mstr.utils.BoxModel.getElementSumOffsetTop(a);b.bottom=b.top+b.height;return b;};R.getElementOuterWidth=function E(a){return this.getElementDimension(a,"offsetWidth");};R.getElementOuterHeight=function Z(d){var c=this.getElementDimension(d,"offsetHeight");if(mstr.utils.ISFF&&!c&&d&&d.nodeName&&(d.nodeName.toLowerCase()=="span")&&mstr.utils.CSS.getStyleValue(d,"display")!="block"){var e=d.childNodes;var a=0;for(var b=0;b<e.length;b++){a=this.getElementDimension(e[b],"offsetHeight");c=Math.max(c,a);}}return c;};R.getElementInnerWidth=function X(a){return this.getElementDimension(a,"clientWidth");};R.getElementInnerHeight=function C(a){return this.getElementDimension(a,"clientHeight");};R.getElementDimension=function F(b,c){var a=parseInt(b&&b[c]);return(isNaN(a))?0:a;};R.getElementTop=function L(a){if(a){if(mstr.utils.ISIE4){return a.style.pixelTop;}else{if(mstr.utils.ISW3C){return parseInt(document.defaultView.getComputedStyle(a,"").getPropertyValue("top"))||0;}else{return a.top;}}}return 0;};R.getElementContentWidth=function Q(b,a,f,g){var k=8;if(mstr.utils.ISIE6){k=parseInt(b.currentStyle.fontSize);}var h=0;var c=null;var e=microstrategy.findChildrenWithAtt(b,a,f,g);for(var d in e){h=(e[d].innerHTML.length*k);c=Math.max(c,h);}return(c&&c>0)?c:null;};R.getElementLeft=function K(a){if(a){if(mstr.utils.ISIE4){return a.style.pixelLeft;}else{if(mstr.utils.ISW3C){return parseInt(document.defaultView.getComputedStyle(a,"").getPropertyValue("left"));}else{return a.left;}}}return 0;};R.getElementSumOffsetTop=function T(c,a){var f=0;for(var b=0;c&&(c!=a);b++){f+=c.offsetTop;try{c=c.offsetParent;}catch(d){c=document.body;}}return f;};R.getElementSumOffsetLeft=function O(c,a){var f=0;for(var b=0;c&&(c!=a);b++){f+=c.offsetLeft;try{c=c.offsetParent;}catch(d){c=document.body;}}return f;};R.getElementSumOffsetLeftAccurately=function U(b,a){return this.getElementSumOffsetLeft(b)-this.getElementSumOffsetLeft(a);};R.getElementSumOffsetTopAccurately=function A(b,a){return this.getElementSumOffsetTop(b)-this.getElementSumOffsetTop(a);};R.computeDistanceFromAncestor=function B(b,f){var l=b&&b.ownerDocument,g=l&&l.body,e=l&&l.documentElement;if(!f){f=g;}var h={};h.offsetX=0;h.offsetY=0;h.scrollX=0;h.scrollY=0;var o=b;while(o&&(o!=f)){h.offsetX+=o.offsetLeft;h.offsetY+=o.offsetTop;var q=o.style,d=mstr.utils.CSS.getStyleValue(o,"position")==="fixed",a=d?null:o.offsetParent,m=true;if(q.left||q.top||q.position.toLowerCase()=="absolute"||d){m=false;}if(m){var c=o.parentNode;while(c){var k=c.scrollLeft;if(k!=null){h.scrollX+=k;h.scrollY+=c.scrollTop;}if(c==a){break;}c=c.parentNode;}}o=a;}h.left=h.offsetX-h.scrollX;h.top=h.offsetY-h.scrollY;h.right=h.left+mstr.utils.BoxModel.getElementOuterWidth(b)-1;h.right=Math.max(h.right,h.left);h.bottom=h.top+mstr.utils.BoxModel.getElementOuterHeight(b)-1;h.bottom=Math.max(h.bottom,h.top);return h;};R.getBrowserWindowHeight=function I(b){if(!b){return 0;}if(mstr.utils.ISIE4){return(b.documentElement&&b.documentElement.clientHeight)||(b.body&&b.body.clientHeight)||0;}else{var a=b.doctype?(String(b.doctype.publicId).toLowerCase().indexOf("transitional")>-1):false;return a?b.documentElement&&b.documentElement.clientHeight:b.body&&b.body.clientHeight;}};R.getBrowserWindowWidth=function P(b){if(!b){return 0;}if(mstr.utils.ISIE4){return(b.documentElement&&b.documentElement.clientWidth)||(b.body&&b.body.clientWidth)||0;}else{var a=b.doctype?(String(b.doctype.publicId).toLowerCase().indexOf("transitional")>-1):false;return a?b.documentElement&&b.documentElement.clientWidth:b.body&&b.body.clientWidth;}};R.getBrowserWindowRect=function V(b){var a={};a.width=this.getBrowserWindowWidth(b);a.height=this.getBrowserWindowHeight(b);a.scrollX=(b&&b.documentElement&&b.documentElement.scrollLeft)||(b&&b.body&&b.body.scrollLeft)||0;a.scrollY=(b&&b.documentElement&&b.documentElement.scrollTop)||(b&&b.body&&b.body.scrollTop)||0;a.left=a.scrollX;a.right=a.left+a.width;a.top=a.scrollY;a.bottom=a.scrollY+a.height;return a;};R.isElementWithinScrollWindow=function W(b,d,g){if(b&&d){var a=this.getElementSumOffsetTop(d,b);var c=a+d.offsetHeight;var f=b.scrollTop;var e=f+b.clientHeight;return mstr.utils.Math.rangesIntersect({min:a,max:c},{min:f,max:e},g);}return false;};R.scrollToElement=function D(a,e){if(!a||!e){return ;}var g=a.scrollTop;if(g==null){return ;}var d=this.getElementInnerHeight(a);if(!d){return ;}var f=e.offsetTop;if(mstr.utils.ISW3C){f-=a.offsetTop;}if(g>f){a.scrollTop=f+1;}else{var c=Math.min(this.getElementOuterHeight(e),d);if((f+c)>(g+d)){var b=Math.max(f+c-d,0);a.scrollTop=b;}}};R.centerElementOnObject=function Y(b,a){if(!a||!b){return ;}a.style.left=Math.max(((this.getElementOuterWidth(b)/2)-(this.getElementOuterWidth(a)/2)),0)+"px";a.style.top=Math.max(((this.getElementOuterHeight(b)/2)-(this.getElementOuterHeight(a)/2)),0)+"px";};R.fitRectWithinRect=function G(c,b){var d=3,a=c.left,e=c.top;a=Math.min(a,b.width-c.width-d);a=Math.max(d,a);e=Math.min(e,b.height-c.height-d);e=Math.max(d,e);return{left:a,top:e,width:c.width,height:c.height};};R.getClientCoords=function H(c){var d=c.ownerDocument,a=d&&d.body,b=d&&d.documentElement;if(c==a||c==b){c=null;}return c?this.computeDistanceFromAncestor(c,b):{left:0,top:0};};R.setClientCoords=function S(b,e,d){var a=b&&b.style;if(!a){return ;}var c=this.getClientCoords(b.offsetParent);a.left=(e-c.left)+"px";a.top=(d-c.top)+"px";};R.hasScrollbar=function M(b,d){var e={x:mstr.utils.CSS.getStyleValue(b,"overflowX"),y:mstr.utils.CSS.getStyleValue(b,"overflowY")};switch(d){case"x":if(e.x=="hidden"){return false;}var c=b.scrollLeft>0;if(!c){var a=b.scrollLeft;b.scrollLeft=1;c=b.scrollLeft>0;b.scrollLeft=a;}return e.x=="scroll"||c;break;case"y":if(e.y=="hidden"){return false;}var c=b.scrollTop>0;if(!c){var a=b.scrollTop;b.scrollTop=1;c=b.scrollTop>0;b.scrollTop=a;}return e.y=="scroll"||c;break;case"xy":if(e.x=="hidden"||e.y=="hidden"){return false;}return this.hasScrollbar(b,"x")&&this.hasScrollbar(b,"y");break;default:if(e.x=="hidden"&&e.y=="hidden"){return false;}return this.hasScrollbar(b,"x")||this.hasScrollbar(b,"y");break;}};R.position=function N(b,c){var e={left:0,top:0};if(b.getBoundingClientRect){e=b.getBoundingClientRect();e={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top};if(this.isIE&&!this.isIE8){var g=b.ownerDocument.documentElement,f=g.getBoundingClientRect();e.left-=f.left;e.top-=f.top;}}if(c){function a(){var k=0,p=0,l=window,m=document,h=m.body,o=m.documentElement;if(typeof (l.pageYOffset)=="number"){p=l.pageYOffset;k=l.pageXOffset;}else{if(h&&(h.scrollLeft||h.scrollTop)){p=h.scrollTop;k=h.scrollLeft;}else{if(o&&(o.scrollLeft||o.scrollTop)){p=o.scrollTop;k=o.scrollLeft;}}}return{x:k,y:p};}var d=a();e.left+=d.x;e.top+=d.y;}return e;};R.prototype=new Object();return R;})();mstr.$BM=mstr.utils.BoxModel;mstr.utils.Dom=(function(){var A={};A.replaceNode=function L(T,D){if(!T||!D){return ;}if(T.swapNode){T.swapNode(D);}else{var S=T.parentNode;if(S){S.insertBefore(D,T);S.removeChild(T);}}};A.insertNode=function Q(S,D,T){if(S&&D){if(T){return D.insertBefore(S,T);}else{return D.appendChild(S);}}return null;};A.findAncestor=function J(W,T,S,D,V){if(typeof (V)=="undefined"){V=true;}var U=(!!V)?W:W&&W.parentNode;if(S!=null){S=String(S).toLowerCase();while(U){if(String(U[T]).toLowerCase()==S){return U;}if(U==D){break;}U=U.parentNode;}}else{while(U){if(U[T]!=null){return U;}if(U==D){break;}U=U.parentNode;}}return null;};A.findPositionedAncestor=function I(S,D){var U=function(X){var W=X.style;if(!W){return false;}var Y=W.position.toLowerCase();return((Y=="relative"||Y=="absolute")||W.left||W.top);};if(D&&U(S)){return S;}var V=mstr.utils.ISIE4?"offsetParent":"parentNode";var T=S[V];while(T){if(U(T)){return T;}T=T[V];}return S.ownerDocument.body;};A.containsElement=function E(T,S,D){if(T&&S){if((D!=false)&&(T==S)){return true;}if(S.ownerDocument==T.ownerDocument){var U=S.parentNode;while(U){if(U==T){return true;}U=U.parentNode;}}}return false;};A.clearChild=function H(D,S){if(S>-1){return D&&D.childNodes&&D.childNodes[S]&&D.removeChild(D.childNodes[S]);}};A.clearChilds=function K(S){var T=S&&S.childNodes;for(var D=mstr.$A.len(T);D>0;D--){S.removeChild(T[D-1]);}};A.clearBrowserHighlights=function B(D){D=D||window;if(mstr.utils.ISIE4){if(D&&D.document&&D.document.selection&&(D.document.selection.empty&&typeof (D.document.selection.empty)=="function")){D.document.selection.empty();}}else{if(mstr.utils.ISW3C){if(D&&D.getSelection&&D.getSelection()){if(D.getSelection().removeAllRanges){D.getSelection().removeAllRanges();}}}}};A.addFormHiddenInput=function O(D,S,U){if(D&&D.ownerDocument&&S){var T=D.ownerDocument.createElement("input");if(T){T.type="hidden";T.name=String(S);T.value=String(U);D.appendChild(T);}}};A.removeFormInputNames=function G(D,X){var Y=D&&D.childNodes,W=(Y&&Y.length)||0,S,T;if(W){var Z=X&&X.split&&X.split(","),V=Z&&Z.length&&mstr.$A.toHash(Z);for(var U=W-1;U>-1;U--){S=Y[U];T=S&&S.name;if(T&&V[T]){D.removeChild(S);}}}};A.moveElementTo=function C(T,S,V){if(T!=null){var D=parseInt(S);var U=parseInt(V);if(!isNaN(D)&&!isNaN(U)){if(mstr.utils.ISIE4||mstr.utils.ISW3C){T.style.left=D+"px";T.style.top=U+"px";}else{document.layers[T.id].left=D;document.layers[T.id].top=U;}}}};A.insertPopupMask=function N(U,T,D,V){if(mstr.utils.ISW3C){return null;}var S=T.ownerDocument.createElement("iframe");S.src="../html/Empty.html";S.style.width=mstr.utils.BoxModel.getElementOuterWidth(U)+"px";S.style.height=mstr.utils.BoxModel.getElementOuterHeight(U)+"px";if(D){S.style.left=D;}if(V){S.style.top=V;}S.style.display="block";T.appendChild(S);return S;};A.setBGIconClass=function M(S,T){var D=A.getBGIconClass(T);if(D!=null){S.className=D+" "+S.className.replace(/mstrBGIcon_[^\s]*/,"");}};A.getBGIconClass=function R(D){if(!D){return null;}return"mstrBGIcon_"+D;};A.attachEvent=function F(T,S,U,D){if(T.addEventListener){return T.addEventListener(S,U,!!D);}else{return T.attachEvent("on"+S,U);}};A.detachEvent=function P(T,S,U,D){if(!T){return ;}if(T.removeEventListener){T.removeEventListener(S,U,!!D);}else{T.detachEvent("on"+S,U);}};return A;})();mstr.$D=mstr.utils.Dom;mstr.utils.Events=(function(){H.mouseX=0;H.mouseY=0;H.target=function C(K,J){J=J||window;if(mstr.utils.ISIE4){return J&&J.event&&J.event.srcElement;}else{if(mstr.utils.ISW3C){return K&&K.target;}}return null;};H.shiftKey=function D(K,J){J=J||window;K=K||J.event;return !!(K&&K.shiftKey);};H.ctrlKey=function I(K,J){J=J||window;K=K||J.event;return !!(K&&K.ctrlKey);};H.getMousePosition=function B(K,J){J=J||window;if(mstr.utils.ISIE4){mstr.utils.Events.mouseX=J.event.clientX;mstr.utils.Events.mouseY=J.event.clientY;}else{if(mstr.utils.ISW3C){mstr.utils.Events.mouseX=K.pageX;mstr.utils.Events.mouseY=K.pageY;}}return{x:mstr.utils.Events.mouseX,y:mstr.utils.Events.mouseY};};H.button=function A(K,J){J=J||window;if(mstr.utils.ISIE4){return(J&&J.event&&J.event.button)||1;}else{if(mstr.utils.ISW3C){return(!K||(K.button<2))?1:2;}else{return 1;}}};H.keyCode=function G(K,J){K=K||(J&&J.event);return K&&K.keyCode;};H.keyChar=function F(L,J){var K=J.event?J.event.keyCode:(L&&L.which);return K&&String.fromCharCode(K);};H.cancel=function E(K,J){if(K&&K.preventDefault){K.preventDefault();}else{K=K||(J&&J.event);if(K){K.returnValue=false;}}};function H(){}return H;})();mstr.$E=mstr.utils.Events;mstr.utils.Math=(function(){var H={};H.isDataTypeNumeric=function A(M){var O=mstr.Enum.Nodes.DATATYPE;switch(parseInt(M)){case O.INTEGER:case O.NUMERIC:case O.DECIMAL:case O.REAL:case O.DOUBLE:case O.FLOAT:case O.INT64:return true;default:return false;}};H.isDataTypeBigDecimal=function J(M){return M==mstr.Enum.Nodes.DATATYPE.BIGDECIMAL;};H.isDataTypeInteger=function N(M){return M==mstr.Enum.Nodes.DATATYPE.INTEGER||M==mstr.Enum.Nodes.DATATYPE.UNSIGNED||M==mstr.Enum.Nodes.DATATYPE.INT64;};H.isDataTypeDateTime=function D(M){var O=mstr.Enum.Nodes.DATATYPE;switch(parseInt(M)){case O.DATE:case O.TIME:case O.TIMESTAMP:return true;default:return false;}};H.isDataTypeString=function K(M){var O=mstr.Enum.Nodes.DATATYPE;switch(parseInt(M)){case O.CHAR:case O.VARCHAR:case O.LONGVARCHAR:return true;default:return false;}};H.canCastDataType=function L(M,O){if(M==O){return true;}if(this.isDataTypeInteger(O)){return this.isDataTypeInteger(M);}else{if(this.isDataTypeNumeric(O)){return this.isDataTypeNumeric(M);}else{if(this.isDataTypeDateTime(O)){return this.isDataTypeDateTime(M);}else{if(this.isDataTypeBigDecimal(O)){return this.isDataTypeBigDecimal(M);}else{return true;}}}}};H.getCommonDataType=function I(P,O){var M=mstr.Enum.Nodes.DATATYPE;if(!O){return P||M.UNKNOWN;}if(!P){return O||M.UNKNOWN;}if(P==O){return P;}if(this.canCastDataType(O,P)){return P;}if(this.canCastDataType(P,O)){return O;}return M.VARCHAR;};H.convertStringToDataType=function F(P,O){var M=P;switch(O){case mstr.Enum.Nodes.DATATYPE.INTEGER:case mstr.Enum.Nodes.DATATYPE.UNSIGNED:if(P!=null){M=parseInt(P);if(isNaN(M)){M=P;}}break;case mstr.Enum.Nodes.DATATYPE.NUMERIC:case mstr.Enum.Nodes.DATATYPE.DECIMAL:case mstr.Enum.Nodes.DATATYPE.REAL:case mstr.Enum.Nodes.DATATYPE.DOUBLE:case mstr.Enum.Nodes.DATATYPE.FLOAT:case mstr.Enum.Nodes.DATATYPE.BIGDECIMAL:case mstr.Enum.Nodes.DATATYPE.INT64:if(P!=null){M=Number(P);if(isNaN(M)){M=P;}}break;case mstr.Enum.Nodes.DATATYPE.CHAR:case mstr.Enum.Nodes.DATATYPE.VARCHAR:case mstr.Enum.Nodes.DATATYPE.LONGVARCHAR:if(P==null){M="";}}return M;};H.convertIndicesToRanges=function C(U,R){var O=U;if(!R){O=mstr.$A.sortNumericArray(U.concat());}var P=[];var Q={min:O[0]};for(var S=1,M=mstr.$A.len(O);S<M;S++){var T=O[S]-O[S-1];if(T!=0&&T!=1){Q.max=O[S-1];P.push(Q);Q={min:O[S]};}}Q.max=O[M-1];P.push(Q);return P;};H.rangesIntersect=function E(O,M,P){P=P||0;if(O&&M){M.min-=P;M.max+=P;if(O.min<M.min){return O.max>=M.min;}else{if(O.min==M.min){return true;}else{if(O.min<M.max){return true;}}}}return false;};H.inNumericRange=function G(O,P,M){if(Number(P)==0&&(O+"").indexOf("-")>-1){return -1;}O=Number(O);if((P!=null)&&(O<Number(P))){return -1;}if((M!=null)&&(O>Number(M))){return 1;}return 0;};H.roundUpDiv=function B(O,M){return parseInt(O/M)+((O%M)?1:0);};return H;})();mstr.utils.String=(function(){var B={};B.trim=function E(L){return this.trimDelimited(L,null);};B.trimDelimited=function F(L,M){if(L&&typeof (L)=="string"){L=L.replace(/^\s+/,"").replace(/\s+$/,"");if(M){L=L.replace(new RegExp("\\"+M+"\\s+","gm"),M);}}return L;};B.padDelimited=function H(L,M){if(M&&L&&typeof (L)=="string"){return L.replace(new RegExp("\\"+M+"(\\S+?)","gm"),M+" $1");}return L;};B.isEmpty=function C(L){if(!L){return true;}return String(L).replace(/\s*/g,"")==""?true:false;};B.smartSplit=function D(O,P,M){if(P&&!this.isEmpty(O)){if(typeof (P)=="string"){P=[P];}O=String(O);for(var N=0,L=P.length;N<L;N++){if(O.indexOf(P[N])>-1){if(M){O=mstr.utils.String.trimDelimited(O,P[N]);}return O.split(P[N]);}}}return[O];};B.preserveWhiteSpace4HTML=function J(L){return L.replace(/\u0020\u0020/g," &nbsp;");};B.escape4HTMLText=function K(S){var P=/\"/gm;var N="&quot;";var T=/\&/gm;var R="&amp;";var Q=/\</gm;var L="&lt;";var O=/\>/gm;var M="&gt;";return S.replace(T,R).replace(P,N).replace(Q,L).replace(O,M);};B.multiReplace=function A(M,P,O){var L;O=O||[];if(!M){return"";}var N=[];for(L in P){if(!O||(mstr.utils.Arrays.find(O,L)===-1)){N.push(L.k||L);}}return M.replace(new RegExp(N.join("|"),"g"),function(Q){var R=P[Q];return R.v||R;});};B.encodeXMLAttribute=function I(L){var M={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"};return mstr.utils.String.multiReplace(L,M);};B.decodeHtmlString=function G(N,M){var L={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'},O={"&amp;":"&","&lt;":"<","&gt;":">","&#039;":"'","&quot;":'"',"&#8364;":"\u20ac"};return M?mstr.utils.String.multiReplace(N,O):mstr.utils.String.multiReplace(N,L);};return B;})();mstr.utils.LocaleParser=(function(){var D={};D.BROWSER_DECIMALSEP=String(1/10).match(/\D/)||".";D.whichDataType=function X(u,l,k){var m=this._getMethodLookup();for(var o=0,r=l&&l.length||0;o<r;o++){var q=l[o],t=m[q];var p=t&&this[t](u,k);if((p!==null)&&(p!==false)){return k?{dataType:q,formatted:p}:q;}}return null;};D._getMethodLookup=function h(){if(!this.dtpChecker){var l=this.dtpChecker={},k=mstr.Enum.Nodes.DATATYPE;l[k.INTEGER]="isInteger";l[k.UNSIGNED]="isUnsigned";l[k.NUMERIC]=l[k.DECIMAL]=l[k.REAL]=l[k.DOUBLE]=l[k.FLOAT]="isNumeric";l[k.CHAR]=l[k.VARCHAR]=l[k.LONGVARCHAR]="isString";l[k.DATE]=l[k.TIME]=l[k.TIMESTAMP]="isDateAndOrTime";l[k.BIGDECIMAL]="isBigDecimal";}return this.dtpChecker;};D.REGEXPS={DATES:{},TIMES:{}};D.CACHE={PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}};D.isInteger=function Q(k,o){if(k==null){return false;}if(typeof (k)!="string"){k=String(k);}var p=mstr.utils.String.trim(k).replace(new RegExp("\\"+mstr.Settings.Locale.THOUSANDSEP,"g"),"").replace(/^\-(\s)*/,"-"),m=p.replace(/^\-/,""),l=m.match(/\d/)&&!m.match(/\D/);if(o){return l?p:null;}else{return !!l;}};D.isUnsigned=function G(k,o){var l=this.isInteger(k,o);if(l){var m=parseInt(k)>=0;if(m){return l;}else{return o?null:false;}}return l;};D.isNumeric=function S(l,o){if(l==null){return false;}if(typeof (l)!="string"){l=String(l);}l=mstr.utils.String.trim(l);var p=mstr.utils.String.trim(l).replace(new RegExp("\\"+mstr.Settings.Locale.THOUSANDSEP,"g"),"").replace(/^\-(\s)*/,"-").replace(/\s+\%$/,"%"),k=p.replace(/\-/,"").replace(/\%$/,"").replace(/E(\+)?/i,"").replace(new RegExp("\\"+mstr.Settings.Locale.DECIMALSEP),""),m=k.match(/\d/)&&!k.match(/\D/);if(o){return m?p:null;}else{return !!m;}};D.isBigDecimal=function V(m,o){if(m==null){return false;}var k=m.match(/^\s*\#(.*)\#\s*$/);if(k){m=k[1];if(mstr.utils.String.isEmpty(m)||m.replace(/E/i,"").match(/[a-zA-Z]/)){return o?null:false;}else{return o?"#"+mstr.utils.String.trim(m)+"#":true;}}else{var l=this.isNumeric(m,o);if(o){if(l){return k?"#"+l+"#":l;}else{return null;}}else{return l;}}};D.isDate=function O(l,q,k){var o=this.parseDate(l,k);var p=!!(o&&this.doesDateExist(o.month,o.day,o.year));if(q){if(p){var m=this.formatDateInfo(o,mstr.Settings.Locale.DATEOUTPUTFORMAT);if(k){return{match:o.match,formatted:m};}else{return m;}}else{return null;}}else{return !!p;}};D.formatDateInfo=function C(m,o){if(!o){return"";}var k=mstr.Settings.Locale,l=o.replace(/dd/g,this.formatInteger(m.day,2)).replace(/d/g,Number(m.day)).replace(/yyyy/g,Number(m.year)).replace(/yy/g,this.formatInteger(Number(m.year)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,k.MONTHNAME_FULL[Number(m.month)-1]).replace(/\~\~\~\~/g,k.MONTHNAME_SHORT[Number(m.month)-1]).replace(/\@\@/g,this.formatInteger(m.month,2)).replace(/\^/g,Number(m.month));return l;};D.formatInteger=function a(m,l){var q=String(m),p=Math.max(l-q.length,0);if(p>0){var k=[q];for(var o=1;o<=p;o++){k.push("0");}q=k.reverse().join("");}return q;};D.parseDate=function Y(w,q){if(w==null){return false;}if(typeof (w)!="string"){w=String(w);}w=mstr.utils.String.trim(w);var k=D.CACHE.PARSEDATE[q?"CONTAINS":"EQUALS"],m=k[w];if(m||(m===null)){return m;}var l=null;var u=mstr.Settings.Locale,t=[].concat(u.DATEINPUTFORMATS);t.unshift(u.DATEOUTPUTFORMAT);for(var o=0,p=t.length;o<p;o++){var r=this._buildRegExp4DateFormat(t[o]),v=r&&w.match(q?r.reContains:r.reEquals);if(v){l={match:v[0],year:r.yearIndex&&this.fourDigitYear(v[r.yearIndex]),day:r.dayIndex&&parseInt(Number(v[r.dayIndex])),month:r.monthIndex&&this.numericMonth(v[r.monthIndex])};break;}}k[w]=l;return l;};D.isTime=function B(l,p,k){var q=this.parseTime(l,k);var o=!!(q&&this.doesTimeExist(q.hour,q.min,q.sec));if(p){if(o){var m=this.formatTimeInfo(q,mstr.Settings.Locale.TIMEOUTPUTFORMAT);if(k){return{match:q.match,formatted:m};}else{return m;}}else{return null;}}else{return !!o;}};D.parseTime=function B(x,q){if(x==null){return false;}if(typeof (x)!="string"){x=String(x);}x=mstr.utils.String.trim(x);var k=D.CACHE.PARSETIME[q?"CONTAINS":"EQUALS"],m=k[x];if(m||(m===null)){return m;}var l=null;var v=mstr.Settings.Locale,u=[].concat(v.TIMEINPUTFORMATS);u.unshift(v.TIMEOUTPUTFORMAT);for(var o=0,p=u.length;o<p;o++){var t=this._buildRegExp4TimeFormat(u[o]),w=t&&x.match(q?t.reContains:t.reEquals);if(w){var r=t.ampmIndex&&w[t.ampmIndex];l={match:w[0],hour:t.hourIndex&&this.capitalHour(w[t.hourIndex],r),min:t.minIndex&&parseInt(Number(w[t.minIndex])),sec:t.secIndex&&parseInt(Number(w[t.secIndex]))};break;}}k[x]=l;return l;};D.formatTimeInfo=function Z(p,m){if(!m){return"";}var k=mstr.Settings.Locale,o=!(Number(p.hour)%12)?12:(Number(p.hour)%12),l=m.replace(/HH/g,this.formatInteger(p.hour,2)).replace(/H/g,Number(p.hour)).replace(/hh/g,this.formatInteger(o,2)).replace(/h/g,o).replace(/mm/g,this.formatInteger(Number(p.min)||0,2)).replace(/m/g,Number(p.min)||0).replace(/ss/g,this.formatInteger(Number(p.sec)||0,2)).replace(/s/g,Number(p.sec)||0).replace(/a/g,(Number(p.hour)<12)?k.AM_NAME:k.PM_NAME);return l;};D.doesTimeExist=function J(r,l,q){var p=parseInt(r);if(p>=0&&p<=23){var k=parseInt(l);if(k>=0&&k<=59){if(!q){return true;}var o=parseInt(q);if(o>=0&&o<=59){return true;}}}return false;};D.capitalHour=function F(l,m){l=parseInt(Number(l));var k=mstr.Settings.Locale;if(m&&(m.match(k.AM_NAME)||m.match(/AM/i))){return l%12;}else{if(m&&(m.match(k.PM_NAME)||m.match(/PM/i))){return 12+(l%12);}else{return l;}}};D.isDateAndOrTime=function g(k,l){return this.isDateTime(k,l)||this.isDate(k,l)||this.isTime(k,l);};D.isDateTime=function L(v,k){var p=this.parseDateAndOrTime(v),t=p&&p.date,o=p&&p.time,r=!!t&&!!o&&this.doesDateExist(t.month,t.day,t.year)&&this.doesTimeExist(o.hour,o.min,o.sec);if(k){if(r){var l=this.formatDateInfo(t,mstr.Settings.Locale.DATEOUTPUTFORMAT),m=this.formatTimeInfo(o,mstr.Settings.Locale.TIMEOUTPUTFORMAT),u=v.indexOf(t.match),q=v.indexOf(o.match);return(q<u)?m+" "+l:l+" "+m;}else{return null;}}else{return !!r;}};D.parseDateAndOrTime=function K(k){var l=this.parseDate(k,true);var m=mstr.utils.String.trim((l&&l.match)?k.replace(l.match,""):k),o=this.parseTime(m,false);if(!l&&!o){return null;}else{return{date:l,time:o};}};D.isString=function Q(l,o){var k=(l!=null)?typeof (l):null,m=(k=="string");if(o){return m?String(l):null;}else{return !!m;}};D.inBigDecimalRange=function A(m,l,k){if((k!=null)&&(this.compareBigDecimal(m,k)>0)){return 1;}if((l!=null)&&(this.compareBigDecimal(m,l)<0)){return -1;}return 0;};D.compareBigDecimal=function N(m,k){var o=isNaN(m)?this.convertToBrowserBigDecimal(String(m)):m,l=isNaN(k)?this.convertToBrowserBigDecimal(String(k)):k;return o-l;};D.convertToBrowserBigDecimal=function M(k){if(k&&k.replace){k=k.replace(/^\s*\#/,"").replace(/\#\s*$/,"");}return this.convertToBrowserNumber(k);};D.inNumericRange=function e(m,l,k){if((k!=null)&&(this.compareNumber(m,k)>0)){return 1;}if((l!=null)&&(this.compareNumber(m,l)<0)){return -1;}return 0;};D.compareNumber=function f(m,k){var o=isNaN(m)?this.convertToBrowserNumber(String(m)):m,l=isNaN(k)?this.convertToBrowserNumber(String(k)):k;return o-l;};D.convertToBrowserNumber=function(k){return Number(k.replace(new RegExp("\\"+mstr.Settings.Locale.THOUSANDSEP,"g"),"").replace(new RegExp("\\"+mstr.Settings.Locale.DECIMALSEP),this.BROWSER_DECIMALSEP));};D.inDateTimeRange=function W(m,p,s){var l=this.parseDateAndOrTime(m),q=l&&l.date,t=l&&l.time;if(!q&&!t){return 0;}if(p!=null){var o=this.parseDateAndOrTime(p);if(q&&o.date){var u=this.compareDate(q,o.date);if(u<0){return -1;}else{if(u==0){if(t&&o.time&&(this.compareTime(t,o.time)<0)){return -1;}}}}}if(s!=null){var k=this.parseDateAndOrTime(s);if(q&&k.date){var r=this.compareDate(q,k.date);if(r>0){return 1;}else{if(r==0){if(t&&k.time&&(this.compareTime(t,k.time)>0)){return 1;}}}}}return 0;};D.compareDate=function b(m,k){if(m==k){return 0;}var o=typeof (m)=="string"?this.parseDate(m):m,l=typeof (k)=="string"?this.parseDate(k):k;if(!o){return -1;}if(!l){return 1;}return(o.year-l.year)||(o.month-l.month)||(o.day-l.day)||0;};D.compareTime=function E(l,k){if(l==k){return 0;}var o=typeof (l)=="string"?this.parseTime(l):l,m=typeof (k)=="string"?this.parseTime(k):k;if(!o){return -1;}if(!m){return 1;}return(o.hour-m.hour)||(o.min-m.min)||(o.sec-m.sec)||0;};D.compareDateTime=function d(l,k){return this.compareDate(l,k)||this.compareTime(l,k);};D._buildRegExp4DateFormat=function c(m){if(!m){return null;}var p=D.REGEXPS.DATES[m];if(!p){if(!D.REGEXPS.MONTHNAME_FULL){D.REGEXPS.MONTHNAME_FULL=mstr.Settings.Locale.MONTHNAME_FULL.join("|");D.REGEXPS.MONTHNAME_SHORT=mstr.Settings.Locale.MONTHNAME_SHORT.join("|");}p=D.REGEXPS.DATES[m]={};p.formatStr=m;var l=p.reStr=m.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+D.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+D.REGEXPS.MONTHNAME_SHORT+")");p.reEquals=new RegExp("^"+l+"$");p.reContains=new RegExp(l);var q=[{key:"monthIndex",index:m.indexOf("M")},{key:"dayIndex",index:m.indexOf("d")},{key:"yearIndex",index:m.indexOf("y")}];q.sort(function(s,r){return s.index-r.index;});var k=1;for(var o=0;o<3;o++){p[q[o].key]=q[o].index>-1?k++:null;}}return p;};D._buildRegExp4TimeFormat=function T(o){if(!o){return null;}var r=D.REGEXPS.TIMES[o],s=mstr.Settings.Locale;if(!r){if(!D.REGEXPSTR_AMPM){D.REGEXPSTR_AMPM=[s.AM_NAME,s.PM_NAME,String(s.AM_NAME).toLowerCase(),String(s.PM_NAME).toLowerCase()].join("|");}r=D.REGEXPS.TIMES[o]={};r.formatStr=o;var p=o.replace(/\'\'/g,'"');var l=p.match(/\'(.+?)\'/g);p.replace(/\'(.+?)\'/g,"*");p=p.replace(/([^H|h|m|s|z|Z|a|\s])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/gi,"("+D.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");for(var m=1,q=l&&l.length||0;m<q;m++){p=p.replace(/\*/,l[m]);}p=p.replace(/\"/g,"'");r.reEquals=new RegExp("^"+p+"$");r.reContains=new RegExp(p);var t=[{key:"hourIndex",index:o.search(/h|H/)},{key:"minIndex",index:o.indexOf("m")},{key:"secIndex",index:o.indexOf("s")},{key:"ampmIndex",index:o.indexOf("a")},{key:"zoneIndex",index:o.search(/z|Z/)}];t.sort(function(v,u){return v.index-u.index;});var k=1;for(var m=0;m<5;m++){r[t[m].key]=t[m].index>-1?k++:null;}}return r;};D.doesDateExist=function R(q,l,p){var k=parseInt(q);if(k<0||k>12){return false;}var r=parseInt(l);if(l<0){return false;}var o=new Date(p,q-1,1);if(l<0||l>this.getDaysOfMonth(o)){return false;}return true;};D.isLeapYear=function U(k){if(((k%4)==0)&&((k%100)!=0)||((k%400)==0)){return(true);}else{return(false);}};D.getDaysOfMonth=function I(k){month=k.getMonth()+1;year=k.getFullYear();switch(month){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;break;case 4:case 6:case 9:case 11:return 30;break;case 2:if(this.isLeapYear(year)){return 29;}else{return 28;}}};D.fourDigitYear=function P(l){l=parseInt(Number(l));if(!isNaN(l)){var k=(mstr.Settings.Locale.TWODIGITYEARSTART%100)||0;if(l>=0&&l<=k){l=2000+l;}else{if(l>k&&l<100){l=1900+l;}}}return l;};D.numericMonth=function H(o){var m=parseInt(Number(o));if(!isNaN(m)){return m;}var k=o&&o.length||0,l=-1;if(k){if(k<=3){l=mstr.utils.Arrays.find(mstr.Settings.Locale.MONTHNAME_SHORT,o);}if(l==-1){l=mstr.utils.Arrays.find(mstr.Settings.Locale.MONTHNAME_FULL,o);}}return l+1;};return D;})();mstr.utils.Arrays=(function(){var S={};S.isArray=function T(A){return !!(A&&(typeof (A)=="object")&&Object.prototype.toString.call(A)==="[object Array]");};S.toArray=function M(A){if((A!=null)&&!this.isArray(A)){return[A];}else{return A;}};S.fromHashKeys=function b(e,c){var A=[];if(c){for(var d in e){A.push(parseInt(d));}}else{for(var d in e){A.push(d);}}return A;};S.fromHashValues=function a(d){var A=[];for(var c in d){A.push(d[c]);}return A;};S.toHash=function X(c){var e={};for(var d=0,A=this.len(c);d<A;d++){e[c[d]]=true;}return e;};S.toHashProperties=function H(c,f){var k=(f)?f.length:0;var e={};for(var d=0,A=this.len(c);d<A;d++){var g=(d<k)?f[d]:d;e[g]=c[d];}return e;};S.len=function B(A){return(A&&A.length)||0;};S.insert=function W(A,c,d){if(!A){A=[];}if((typeof (d)=="undefined")||(d>=A.length)||(d<0)){return[].concat(A).concat(c);}else{if(d==0){return[].concat(c).concat(A);}else{if(d>0){return A.slice(0,d).concat(c.concat(A.slice(d,A.length)));}}}};S.remove=function U(A,e,d){if(A&&A.length&&e&&e.length){var f=d?e:mstr.$A.sortNumericArray(e);var c=mstr.utils.Math.convertIndicesToRanges(f,true);return this.removeRanges(A,c);}return A;};S.removeRange=function O(c,g,f){var A=(c&&c.length)||0;if(A&&f){if(mstr.utils.ISFF){g=Math.max(0,parseInt(g)||0);var d=g?c.slice(0,g):[],e=g+f;if(e<A){d=d.concat(c.slice(e));}return d;}else{c.splice(Math.max(0,g),f);}}return c;};S.removeRanges=function N(A,c){if(A&&A.length&&c&&c.length){for(var f=c.length-1;f>-1;f--){var d=c[f];if(d&&d.max>=0){var e=Math.max(d.min,0);A=S.safeRemove(A,e,d.max-e+1);}}}return A;};S.safeRemove=function G(A,f,e){try{A.splice(f,e);return A;}catch(d){var c=[].concat(A);c.splice(f,e);return c;}};S.safeSplice=function F(A,g,f,d){try{A.splice(g,f,d);return A;}catch(e){var c=[].concat(A);c.splice(g,f,d);return c;}};S.removeItems=function P(c,d){if(c&&c.length){for(var f=0,A=this.len(d);f<A;f++){var e=this.find(c,d[f]);if(e>-1){c.splice(e,1);}}}return c;};S.removeItemsByForm=function R(c,d,e){var A=this.findByFormMultiple(c,d,e,false);if(A&&A.foundCount&&A.indices){return this.remove(c,A.indices);}return c;};S.find=function Q(c,e){if(c.indexOf){return c.indexOf(e);}for(var d=0,A=this.len(c);d<A;d++){if(c[d]==e){return d;}}return -1;};S.findMultiple=function D(d,e,h){var c={foundCount:0,foundAll:false,indices:[]};if(d&&d.length){var A=this.len(e);if(A){c.foundAll=true;for(var g=0;g<A;g++){var f=this.find(d,e[g]);if(f>-1){c.indices[h?g:c.foundCount]=f;c.foundCount++;}else{if(h){c.indices[g]=f;}c.foundAll=false;}}}}return c;};S.findByGetter=function I(c,f,g,e){for(var d=0,A=this.len(c);d<A;d++){if(c[d]&&c[d][f](e)==g){return d;}}return -1;};S.findByForm=function I(c,g,f,d){for(var e=0,A=this.len(c);e<A;e++){var h=c[e][f];if(d&&typeof (h)=="string"&&typeof (g)=="string"){if(h.toLowerCase()==g.toLowerCase()){return e;}}else{if(h==g){return e;}}}return -1;};S.matchByForm=function L(c,f,h,k){var A=this.len(c),k=(k&&(k>-1))?k:0,d;for(var g=k;g<A;g++){if(f.test(String(c[g][h]))){return g;}}if(k>0){for(var e=0;e<k;e++){if(f.test(String(c[e][h]))){return e;}}}return -1;};S.findByFormMultiple=function Y(f,h,m,k){var p={foundCount:0,foundAll:false,indices:[]};var l=p.indices;var A=this.len(f);if(A){var c=mstr.utils.Hash.generateItemArrayLookup(f,m);p.foundAll=true;var e=this.len(h);for(var d=0;d<e;d++){var o=h[d][m];var g=c[o];if(g!=null){l[k?d:p.foundCount]=g;p.foundCount++;if(p.foundCount>=A){break;}}else{if(k){l[d]=-1;}p.foundAll=false;}}}return p;};S.sortNumericArray=function K(d){if(!d){return null;}var f=d.concat();var c=this.len(f);var e=(c%2)?f.pop():null;this.heapSort(f);if(e!=null){var A=this.binarySearch(f,e,0,c-2);f=this.insert(f,[e],A.index);}return f;};S.binarySearch=function C(A,f,g,d){while(g<=d){var c=parseInt((g+d)/2);var e=A[c];if(f>e){g=c+1;}else{if(f<e){d=c-1;}else{return{found:true,index:c};}}}return{found:false,index:g};};S.heapSort=function E(c){var A=this.len(c);for(var e=parseInt(A/2-1);e>=0;e--){this._siftDown(c,e,A);}var d;for(var e=A-1;e>=1;e--){d=c[0];c[0]=c[e];c[e]=d;this._siftDown(c,0,e-1);}return c;};S._siftDown=function Z(c,e,g){var d=false,A,f;while(!d&&(e*2<=g)){if(e*2==g){A=e*2;}else{if(c[e*2]>c[e*2+1]){A=e*2;}else{A=e*2+1;}}if(c[e]<c[A]){f=c[e];c[e]=c[A];c[A]=f;e=A;}else{d=true;}}};S.intSorter=function V(A,c){return A-c;};S.rangeSorter=function J(c,A){return c.min-A.min;};S.smartJoin=function(c,d){var A=c&&c.length||0;if(!A){return"";}if(d==null){d="";}return(c.join&&c.join(d))||"";};S.filter=function(d,g,e){var c=[],A=d&&d.length||0;if(A&&g&&e){for(var f=0;f<A;f++){if(g[e](d[f])){c.push(d[f]);}}}return c;};S.removeInstances=function(c,e){var A=(c&&c.length)||0;for(var d=A-1;d>-1;d--){if(c[d]===e){c.splice(d,1);}}return c;};S.forEach=function(g,e,d){d=d||(function(){return this;})();for(var c=0,A=g&&g.length||0;c<A;c++){if(e.call(d,g[c],c,g)===false){break;}}};return S;})();mstr.$A=mstr.utils.Arrays;mstr.utils.Hash=(function(){var P={};P.len=function I(T){var S=0;if(T){for(var H in T){if(H!=null){S++;}}}return S;};P.lenGreaterThan=function J(U,S){if(U){var H=0;for(var T in U){H++;if(H>S){return true;}}}return false;};P.isEmpty=function K(S){if(S){for(var H in S){return false;}}return true;};P.applydefault=function E(S,T){S=S||{};for(var H in T){if(S[H]==null){S[H]=mstr.utils.Hash.deepClone(T[H]);}}return S;};P.overwrite=function L(T,S){var U;if(T){for(var H in S){if(T[H]!=S[H]){if(!U){U={};}U[H]=S[H];T[H]=S[H];}}}return U;};P.remove=function D(T,S){var U;if(T){for(var H in S){if(T[H]!=null){if(!U){U={};}U[H]=T[H];delete T[H];}}}return U;};P.clear=function N(S){var T;if(S){for(var H in S){if(S[H]!=null){if(!T){T={};}T[H]=S[H];delete S[H];}}}return T;};P.clone=function R(H){if(!H){return undefined;}var T={};for(var S in H){T[S]=H[S];}return T;};P.deepClone=function C(U){if(!U){return U;}if(mstr.$A.isArray(U)){var T=U.length;var H=new Array(T);for(var S=0;S<T;S++){H[S]=mstr.utils.Hash.deepClone(U[S]);}return H;}if(typeof (U)=="object"){var V={};for(var W in U){V[W]=mstr.utils.Hash.deepClone(U[W]);}return V;}return U;};P.firstKey=function B(S){if(S){for(var H in S){if(H!=null){return H;}}}};P.firstItem=function Q(S){if(S){for(var H in S){if(H!=null&&S[H]!=null){return S[H];}}}};P.equals=function O(T,S){if(T==S){return true;}if(!T||!S){return false;}for(var H in T){if(T[H]!=S[H]){return false;}}return this.len(T)==this.len(S);};P.fromRanges=function G(T){var X={};var S=mstr.utils.Arrays.len(T);for(var W=0;W<S;W++){var V=T[W].min;var H=T[W].max;for(var U=V;U<=H;U++){X[U]=true;}}return X;};P.maxNumber=function F(T){if(!T){return null;}var H=null;for(var S in T){if(Number(S)>H){H=Number(S);}}return H;};P.minNumber=function M(T){if(!T){return null;}var S=null;for(var H in T){if(S==null){S=H;}if(Number(H)<=S){S=Number(H);}}return S;};P.generateItemArrayLookup=function A(S,U){var V={};for(var T=0,H=mstr.$A.len(S);T<H;T++){V[S[T][U]]=T;}return V;};return P;})();mstr.$H=mstr.utils.Hash;mstr.utils.CSS=(function(){var B={};B.getStyleValue=function C(E,F){if(document.defaultView&&document.defaultView.getComputedStyle){F=F=="float"?"cssFloat":F;var D=document.defaultView.getComputedStyle(E,null);value=D?D[F]:null;}else{if(E.currentStyle){F=F=="float"?"styleFloat":F;value=E.currentStyle[F];}}return value;};B.setStyleValue=function A(E,G,F){if(mstr.utils.$A.isArray(G)&&mstr.utils.$A.isArray(F)){for(var D in G){E.style[G[D]]=F[D];}}else{E.style[G]=F;}};return B;})();mstr.$CSS=mstr.utils.CSS;mstr.utils.Color=(function(){var D={};D.hexChars="0123456789ABCDEF";D.toHex=function M(C){C=C||0;C=Math.max(Math.min(isNaN(C)?0:parseInt(C,10),255),0);return mstr.utils.Color.hexChars.charAt((C-C%16)/16)+mstr.utils.Color.hexChars.charAt(C%16);};D.toDec=function N(C){return mstr.utils.Color.hexChars.indexOf(C.toUpperCase());};D.rgbStr2rgb=function I(C){var O=[0,0,0];C=C.replace(/ /g,"");var P=C.indexOf("rgb");if(P>=0){C=C.substring(P+4,C.length-1);O=C.split(",");}return O;};D.rgbStr2hex=function E(C){if(C.indexOf("rgb")>=0){var O=mstr.utils.Color.rgbStr2rgb(C);return"#"+mstr.utils.Color.rgb2hex(O[0],O[1],O[2]);}return C;};D.rgb2hex=function F(P,O,C){return mstr.utils.Color.toHex(P)+mstr.utils.Color.toHex(O)+mstr.utils.Color.toHex(C);};D.rgb2hsv=function G(C,S,W){var U=[C,S,W];U.sort(function(d,c){return d-c;});var R,Z,Y=0;var Q=U[0];var V=U[2];Y=V/255;Z=(V!=0)?(parseFloat(V)-parseFloat(Q))/parseFloat(V):0;if(Z==0){R=0;}else{var T=V-Q;var O=(V-C)/T;var P=(V-S)/T;var X=(V-W)/T;if(C==V){R=X-P;}else{if(S==V){R=2+O-X;}else{R=4+P-O;}}R=R/6;if(R<0){R=R+1;}}return[Math.round(R*360),Math.round(Z*100),Math.round(Y*100)];};D.hex2rgb=function K(P){var C=(P.charAt(0)=="#")?P.substr(1):P;var O=[0,0,0];O[0]=(mstr.utils.Color.toDec(C.substr(0,1))*16)+(mstr.utils.Color.toDec(C.substr(1,1)));O[1]=(mstr.utils.Color.toDec(C.substr(2,1))*16)+(mstr.utils.Color.toDec(C.substr(3,1)));O[2]=(mstr.utils.Color.toDec(C.substr(4,1))*16)+(mstr.utils.Color.toDec(C.substr(5,1)));return O;};D.hex2hsv=function H(O){var C=mstr.utils.Color.hex2rgb(O);return mstr.utils.Color.rgb2hsv(C);};D.hsv2rgb=function B(U,a,Y){U=U/360;a=a/100;Y=Y/100;var C,V,X;if(a==0){C=Y*255;V=Y*255;X=Y*255;}else{var Q=U*6;if(Q==6){Q=0;}var T=Math.floor(Q);var P=Y*(1-a);var O=Y*(1-a*(Q-T));var Z=Y*(1-a*(1-(Q-T)));var W,R,S;switch(T){case 0:W=Y;R=Z;S=P;break;case 1:W=O;R=Y;S=P;break;case 2:W=P;R=Y;S=Z;break;case 3:W=P;R=O;S=Y;break;case 4:W=Z;R=P;S=Y;break;default:W=Y;R=P;S=O;break;}C=W*255;V=R*255;X=S*255;}return[Math.round(C),Math.round(V),Math.round(X)];};D.hsv2hex=function J(Q,P,C){var O=mstr.utils.Color.hsv2rgb(Q,P,C);return mstr.utils.Color.rgb2hex(O[0],O[1],O[2]);};D.getContrastingColor=function A(P,C){var O=mstr.utils.Color.hex2rgb(P);return(((O[0]*299)+(O[1]*587)+(O[2]*114))/1000<125)?C[0]:C[1];};D.get3DBorderColor=function L(P,S){var O=parseInt(P[0])*0.3+parseInt(P[1])*0.59+parseInt(P[2])*0.11;var R=parseInt(P[0]);var Q=parseInt(P[1]);var C=parseInt(P[2]);switch(S){case"light":if(O>150){R=R*0.9;Q=Q*0.9;C=C*0.9;}else{R=R*0.6+102;Q=Q*0.6+102;C=C*0.6+102;}break;case"dark":if(O>10){R=R*0.4;Q=Q*0.4;C=C*0.4;}else{R=R*0.8+30;Q=Q*0.8+30;C=C*0.8+30;}}return"#"+mstr.utils.Color.rgb2hex(Math.round(R),Math.round(Q),Math.round(C));};return D;})();mstr.utils.Controls=(function(){var D={};D.getSelectionRange=function B(H){var C={start:-1,end:-1};if("selectionStart" in H){C={start:H.selectionStart,end:H.selectionEnd};}else{if(document.selection){var E=document.selection.createRange();if(E.parentElement()==H){var F=E.duplicate();F.moveEnd("textedit",1);var G=E.duplicate();G.moveStart("textedit",-1);C={start:H.value.length-F.text.length,end:G.text.length};}}}return C;};D.setSelectionRange=function A(H,I,C){if(C===undefined){C=I;}if("selectionStart" in H){try{H.setSelectionRange(I,C);}catch(G){}H.focus();}else{if(document.selection){var E=H.createTextRange();E.collapse(true);E.moveStart("character",I);E.moveEnd("character",C-I);try{E.select();}catch(F){}}}};return D;})();mstr.utils.ListModelHelper=(function(){var B={};B.canAdd=function A(D,E){if(!E){return false;}var F=D.props.allowedItemFormName;if(F!=null){if(D.props.allowedItemFormValues){if(!D.props.allowedItemFormValuesHash){D.props.allowedItemFormValuesHash=mstr.$A.toHash(D.props.allowedItemFormValues&&D.props.allowedItemFormValues.split(","));}return !!D.props.allowedItemFormValuesHash[E[F]];}else{if(D.props.prohibitedItemFormValues){if(!D.props.prohibitedItemFormValuesHash){D.props.prohibitedItemFormValuesHash=mstr.$A.toHash(D.props.prohibitedItemFormValues&&D.props.prohibitedItemFormValues.split(","));}return !D.props.prohibitedItemFormValuesHash[E[F]];}}}return true;};B.verifySelectionKeys=function C(E,G){var D=E.getItems();for(var F in G){if(!mstr.utils.ListModelHelper.canAdd(E,D[F])){delete G[F];}}return(mstr.utils.Hash.isEmpty(G))?null:G;};return B;})();mstr.utils.ListViewHelper=(function(){var LVH={};LVH.getItemRenderer=function LVH_getIR(view){var rc=view.props.itemRendererClass;if(rc){if(typeof (rc)=="object"){return rc;}else{if(typeof (rc)=="string"){try{eval("rc = "+rc);}catch(localerr){}view.props.itemRendererClass=rc;if(rc){return rc;}}}}var hInfo=view._layoutHandlers&&view._layoutHandlers.info&&view._layoutHandlers.info.itemRendererClass;if(!hInfo){return ;}if(!hInfo.obj){var fqcn=hInfo&&hInfo.str;if(fqcn){try{eval("hInfo.obj = "+fqcn);}catch(localerr){}hInfo.str=null;}}return hInfo.obj;};LVH.getItemBrowseCommand=function LVH_getItemBrowseCommand(view,item){if(!item){return null;}var m=view.props.model;if(!m){return null;}if(view.props.allowBrowseFolder&&m.canBrowseFolder(item)){return mstr.$Cmd.BROWSEFOLDER;}if(!view.props.allowBrowseHierarchy&&!view.props.allowBrowseAttribute){return null;}var bAttr=(parseInt(item.tp)==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE);var bAttrInHierarchy=false;if(bAttr){var con=m.getContainer();if(con){if(con.isWithinHierarchy==null){con.isWithinHierarchy=this.isWithinHierarchy(con);}bAttrInHierarchy=!!con.isWithinHierarchy;}}if(bAttr&&!bAttrInHierarchy){if(view.props.allowBrowseAttribute&&m.canBrowseAttribute(item)){return mstr.$Cmd.BROWSEATTRIBUTE;}}else{if(view.props.allowBrowseHierarchy&&m.canBrowseHierarchy(item)){return mstr.$Cmd.BROWSEHIERARCHYITEM;}}return null;};LVH.getFetchBlockForTask=function LVH_getFetchBlockForTask(taskId){var map=mstr.Settings.TaskBlockCountMap;if(map){var bc=parseInt(map[taskId]);if(isNaN(bc)){bc=parseInt(map["*"]);}if(!isNaN(bc)){return bc;}}return -1;};LVH.isWithinHierarchy=function LVH_isWithinHierarchy(node){while(node){if(node.isWithinHierarchy){return true;}switch(node.value&&parseInt(node.value.tp)){case mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY:return true;}node=node.parent;}return false;};LVH.getHierarchyId=function LVH_getHierarchyId(node){while(node){switch(node.value&&parseInt(node.value.tp)){case mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY:return node.value.dssid;}node=node.parent;}return null;};return LVH;})();mstr.utils.xhr=(function(){var A={};A.request=function(B,E,F,C){var D=new mstr.http.XHRProcessor({id:E.taskId,taskURL:B,inputs:{params:E,callback:{success:F.success,failure:F.failure,complete:F.complete}}});D.submit(C===false?false:true);};return A;})();mstr.$XHR=mstr.utils.xhr;mstr.lang={};mstr.lang.Event=(function(){A.prototype.target=function C(){return mstr.$E.target(this.e,this.win);};A.prototype.shift=function F(){return mstr.$E.shiftKey(this.e,this.win);};A.prototype.ctrl=function E(){return mstr.$E.ctrlKey(this.e,this.win);};A.prototype.rightClick=function B(){return 2==mstr.$E.button(this.e,this.win);};A.prototype.clone=function D(){return new mstr.lang.Event(this.e,this.win,this.src,this.name,this.memo,this.originalSrc);};function A(K,H,L,J,I,G){this.win=H||window;this.e=K||(this.win&&this.win.event);this.src=L;this.name=(J!=null)?J:(this.e&&this.e.type);this.memo=I;this.originalSrc=G||L;if(mstr.utils.ISIE4){this.x=this.e?this.e.clientX+((this.win&&this.win.document.documentElement&&this.win.document.documentElement.scrollLeft)||0):null;this.y=this.e?this.e.clientY+((this.win&&this.win.document.documentElement&&this.win.document.documentElement.scrollTop)||0):null;}else{if(mstr.utils.ISW3C){this.x=this.e?this.e.pageX:null;this.y=this.e?this.e.pageY:null;}}}return A;})();mstr.lang.CustomEvent=(function(){mstr.$O.extendsClass(A,mstr.lang.Event);function A(G,E,D,F,C,B){mstr.lang.Event.apply(this,[F,C,G,E,D,B]);}return A;})();mstr.models={};mstr.models.IModel={get:null,set:null,listadd:null,listremove:null,hashadd:null,hashremove:null,attachEventListener:null,removeEventListener:null,execCommand:null,queryCommandEnabled:null};mstr.models.BaseModel=(function(){T.prototype.DEFAULTS={readyState:mstr.Enum.Widget.READYSTATE.IDLE};T.prototype.BROADCASTS={_DEFAULT_:true};T.prototype.get=function a(d){return this.props[d];};T.prototype.set=function M(f,d){var e=this.props[f];if(e!=d){if(d==null){delete this.props[f];}else{this.props[f]=d;}this.raiseEvent("set_"+f,{name:f,value:d,valueWas:e});return true;}return false;};T.prototype.setPropertyByPath=function C(f,e,d){mstr.controllers.Factory.setPath(f,this,e,d);};T.prototype.getId=function L(){return this.props[mstr.$W.ID];};T.prototype.setId=function b(d){this.props[mstr.$W.ID]=d;};T.prototype.listadd=function O(g,e,f){var d=mstr.$A.len(e);if(d){this.props[g]=mstr.$A.insert(this.props[g],e,f);if(f==null||f<0){f=mstr.$A.len(this.props[g])-d;}this.raiseEvent("listadd_"+g,{name:g,start:f,count:d});return f;}return null;};T.prototype.listremove=function I(h,e,f){var d=mstr.$A.len(e);if(d){var g=f?e:e.concat().sort(mstr.$A.rangeSorter);this.props[h]=mstr.$A.removeRanges(this.props[h],g);this.raiseEvent("listremove_"+h,{name:h,ranges:g});return g;}return null;};T.prototype.listclear=function F(g){var e=this.props[g],d=e&&e.length;if(d){e.splice(0,d);var f={min:0,max:d-1};this.raiseEvent(new mstr.lang.CustomEvent(this,"listremove_"+g,{name:g,ranges:[f]}));return f;}return null;};T.prototype.hashadd=function B(f,d){var e=mstr.$H.overwrite(this.props[f],d);if(e){this.raiseEvent("hashadd_"+f,{name:f,at:e});return true;}return false;};T.prototype.hashremove=function V(f,d){var e=mstr.$H.remove(this.props[f],d);if(e){this.raiseEvent("hashremove_"+f,{name:f,at:e});return true;}return false;};T.prototype.hashclear=function W(f){var e=this.props[f],d=e&&mstr.utils.Hash.clear(e);if(d){this.raiseEvent(new mstr.lang.CustomEvent(this,"hashremove_"+f,{name:f,at:d}));return true;}return false;};T.prototype.attachEventListener=function N(e,d,f){mstr.controllers.EventManager.attachEventListener(e,this,d,f);};T.prototype.detachEventListener=function D(e,d){mstr.controllers.EventManager.detachEventListener(e,this,d);};T.prototype.raiseEvent=function J(f,e){if(this._shouldBroadcastEvent(f)){var d=new mstr.lang.CustomEvent(this,f,e);if(this["on_"+f]){this["on_"+f](d);}this.notifyListeners(d);}};T.prototype._shouldBroadcastEvent=function P(e){var d=this.BROADCASTS[e];if(d==undefined){d=this.BROADCASTS._DEFAULT_;}return d;};T.prototype.getRMCModel=function K(){return this.props.rmc;};T.prototype.setRMCModel=function Q(e,d,f){this.props.rmc=e;if(e){e.props.parent=this;}};T.prototype.notifyListeners=function R(d){mstr.controllers.EventManager.notifyListeners(this,d);};T.prototype.execCommand=function c(g){if(this["exec"+g]){var f=[],d=arguments.length;for(var e=1;e<d;e++){f[e-1]=arguments[e];}return this["exec"+g].apply(this,f);}if(g.substring(0,4)=="Set_"){g=g.substring(4);if(g!=""){return this.set(g,arguments[1]);}}};T.prototype.queryCommandEnabled=function A(e,d){if(e.substring(0,4)=="Set_"){return true;}if(this["queryEnabled"+e]){return this["queryEnabled"+e](d);}else{return !!this.props["CommandEnabled"+e];}};T.prototype.submitRequest=function S(h,f){var k=mstr.http&&mstr.http.Governor;if(!k){return ;}if(!this.onRequestCallback){return ;}var d=this.props.requestContext;if(d&&d.id){var e=false;switch(this.props.readyState){case mstr.Enum.Widget.READYSTATE.WAITING:case mstr.Enum.Widget.READYSTATE.SUCCESS:if((d.inputs.url==h.url)&&mstr.$H.equals(d.inputs.params,h.params)){d.memo=f;return d.id;}break;}this.cancelRequest(d.id);}var l=k.submitRequest(h,this.getId(),"onRequestCallback");if(!d){d=this.props.requestContext={};}d.id=l;d.inputs=h;d.memo=f;d.response=null;this.onRequestCallback(k.requests.lookup[l]);return l;};T.prototype.cancelRequest=function E(d){if(this.successTimer){self.clearTimeout(this.successTimer);delete this.successTimer;}return mstr.http.Governor.cancelRequest(d,this.getId());};T.prototype.execCancelRequest=function H(){var d=this.props.requestContext;if(d&&d.id){return this.cancelRequest(d.id);}return false;};T.prototype.onRequestCallback=function U(e){if(!e||!this.props.requestContext||(this.props.requestContext.id!=e.id)){return ;}this.props.requestContext.response=e.response;this.set("readyState",e.readyState);if(e.readyState==mstr.Enum.Widget.READYSTATE.SUCCESS){if(this.loadRequestResponse){var f=this.getId(),d=this;this.successTimer=self.setTimeout(function(){mstr.$obj(f).loadRequestResponse();delete d.successTimer;},1);}else{this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);}}};T.prototype.init=function Y(q){var l=this.props;var o=l[mstr.$W.DOCUMENT];var k=(q)?("|"+q.join("|")+"|"):"";for(var e in l){if(k.indexOf("|"+e+"|")!=-1){continue;}var p=l[e];if(p==null||e=="parent"){continue;}var g=null;if(mstr.$A.isArray(p)){var d=0;for(var f=0,h=mstr.$A.len(p);f<h;f++){var m=p[f];if(m==null){continue;}if(m.getId){m.props&&(m.props[mstr.$W.PARENT]=this);d=0;}else{if(typeof (m)=="object"){g=m[mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(m,o);if(g){p[f]=g;g.props&&(g.props[mstr.$W.PARENT]=this);g.init&&g.init();d=0;}else{d++;if(d>2){break;}}}}}}else{if(p.getId){p.props&&(p.props[mstr.$W.PARENT]=this);}else{if(typeof (p)=="object"){g=p[mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(p,o);if(g){l[e]=g;g.props&&(g.props[mstr.$W.PARENT]=this);g.init&&g.init();}}}}}};T.prototype._createNewModel=function G(g){var f=g.scriptClass;if(!f){return null;}var e=new mstr.models[f](g);if(!e){return null;}mstr.controllers.Factory.add(e);var d=e.init&&e.init();return e;};T.prototype.getAncestorByProperty=function Z(f,d){var e=(d)?this:this.get("parent");while(e){if(mstr.controllers.Factory.getPath(f,e)){return e;}e=e.get("parent");}return null;};T.prototype.getAncestorByPropertyValue=function X(h,e,d){if(!(e instanceof RegExp)){e=new RegExp(e);}var g=this.getAncestorByProperty(h,d);while(g){var f=mstr.controllers.Factory.getPath(h,g);if(f&&e.test(f)){return g;}g=g.getAncestorByProperty(h,d);}return null;};function T(d){this.props=mstr.utils.Hash.applydefault(d,this.DEFAULTS);}return T;})();mstr.models.BooleanTaskModel=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.execSubmit=function A(D){this.submitRequest(D,{});};B.prototype.loadRequestResponse=function C(){var D=this.props.requestContext;var E=D&&D.response;if(!E||!E.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}this.set("readyState",mstr.Enum.Widget.READYSTATE.SUCCESS);};function B(D){mstr.models.BaseModel.apply(this,[D]);}return B;})();mstr.http={};mstr.http.Governor=(function(){var L={};L.procs={};L.requests={pending:[],lookup:{}};L.go=function F(){var G=this._nextRequest();if(!G){return ;}var O=this._freeProc(G);if(!O){var P=G&&G.inputs&&G.inputs.params&&G.inputs.params.processorClass;if(P){O=new P();mstr.controllers.Factory.add(O);this.addProc(O,true);}}if(!O){this.requests.pending.unshift(G.id);return ;}this._assignRequestToProc(G,O);};L._nextRequest=function E(){var G=this.requests.pending.shift();return G&&this.requests.lookup[G];};L._freeProc=function M(G){for(var Q in this.procs){var O=this.procs[Q];if(!O){continue;}switch(O.props.readyState){case mstr.Enum.Widget.READYSTATE.IDLE:case mstr.Enum.Widget.READYSTATE.SUCCESS:case mstr.Enum.Widget.READYSTATE.ERROR:case mstr.Enum.Widget.READYSTATE.CANCELLED:case mstr.Enum.Widget.READYSTATE.TIMEOUT:var P=G&&G.inputs&&G.inputs.params&&G.inputs.params.processorClass;if(P){if(O.constructor==P){return O;}}else{if(O.constructor!=mstr.http.PUProcessor){return O;}}}}};L.addProc=function D(O,G){if(!O){return ;}var P=mstr.controllers.Factory.validateId(O);this.procs[P]=O;mstr.controllers.EventManager.attachEventListener(this,O,"set_readyState","on_proc_set_readyState");if(!G){this.go();}};L.submitRequest=function N(O,G,Q){var R;var P=this.searchForRequestInputs(O);if(P){R=P.id;P.callbacks[G]=Q;}else{var R=mstr.controllers.Factory.nextFreeId();var P={id:R,inputs:O,callbacks:{},readyState:mstr.Enum.Widget.READYSTATE.WAITING,response:null,proc:null};this.requests.lookup[R]=P;P.callbacks[G]=Q;this.requests.pending.push(R);window.setTimeout("mstr.http.Governor.go()",10);}return R;};L.searchForRequestInputs=function B(O){if(!O||O.htmlForm){return null;}var G=this.requests.lookup;for(var Q in G){switch(G[Q]["readyState"]){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:case mstr.Enum.Widget.READYSTATE.CANCELLED:continue;}var P=G[Q]["inputs"];if((P.url==O.url)&&mstr.utils.Hash.equals(P.params,O.params)){return G[Q];}}return null;};L.cancelRequest=function J(Q,G){if(!Q){return ;}var P=this.requests.lookup[Q]&&this.requests.lookup[Q].callbacks;if(P){delete P[G];}var O=false;if(P){for(var R in P){O=true;break;}}if(!O){this.removeRequest(Q);}};L.removeRequest=function I(G){this.requests.pending=mstr.$A.removeItems(this.requests.pending,[G]);delete this.requests.lookup[G];};L._assignRequestToProc=function K(O,G){O.proc=G;G.props.req=O;G.setInputs(O.inputs);G.submit();};L.on_proc_set_readyState=function H(P){var O=P&&P.src;var G=O.get("readyState");var S=O.props.req;if(S){if(S.readyState!=G){S.readyState=G;switch(G){case mstr.Enum.Widget.READYSTATE.SUCCESS:S.totalTime=O.props.lastSuccess-O.props.lastSubmit;mstr.timers.lastRequest=S.totalTime;case mstr.Enum.Widget.READYSTATE.ERROR:var R=S.response=O.getResponse();if(R&&R.data){var Q=mstr.controllers.Factory.create(R.data);if(Q){Q.init&&Q.init();R.data=Q;}}}this._notifyRequestCallbacks(S);switch(G){case mstr.Enum.Widget.READYSTATE.SUCCESS:if(!mstr.Settings.Http.CACHE){S.response=null;this.removeRequest(S.id);}break;}}}switch(G){case mstr.Enum.Widget.READYSTATE.SUCCESS:case mstr.Enum.Widget.READYSTATE.ERROR:case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.CANCELLED:O.props.req=null;O.props.readyState=mstr.Enum.Widget.READYSTATE.IDLE;if(S){S.proc=null;}this.go();break;}};L._notifyRequestCallbacks=function A(G){if(!G||!G.callbacks){return ;}for(var Q in G.callbacks){var P=mstr.controllers.Factory.obj(Q);if(!P){continue;}var O=G.callbacks[Q];if(P[O]){P[O](G);}}};L.onFrameProcLoad=function(G){if(G&&G.name){var O=this._findFrameProcByFrameName(G.name);O&&O.update&&O.update(G);}};L._findFrameProcByFrameName=function C(P){for(var O in this.procs){var G=this.procs[O];if(G&&G.props&&(G.props.frameName==P)){return G;}}return null;};L.props={};L.getId=function(){return this.props.id;};L.setId=function(G){this.props.id=G;};mstr.controllers.Factory.add(L);return L;})();mstr.http.XHRProcessor=(function(){mstr.$O.extendsClass(XHR,mstr.models.BaseModel);XHR.prototype.isHTTPProcessor=true;XHR.prototype.setInputs=function XHR_setInputs(inputs){this.props.inputs=inputs;this.props.readyState=mstr.Enum.Widget.READYSTATE.IDLE;this.props.response=null;};XHR.prototype.submit=function XHR_submit(async){var ps=this.props;ps.response=null;ps.cancelled=true;ps.readyState=mstr.Enum.Widget.READYSTATE.WAITING;ps.lastSubmit=new Date();var xhr=this._xhr;if(!xhr){xhr=this._xhr=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}if(xhr){var inputs=ps.inputs,params=inputs&&inputs.params,arr=[];this._addEnv(params);var url=this._getURL(params);for(var key in microstrategy.persistParams){params[key]=microstrategy.persistParams[key];}this._makeArray(params,arr);arr.push("_xts_="+new Date().getTime());var paramString=arr.join("&");url=microstrategy.addJSessionID(url);if(mstr.utils.ISIE4){xhr.abort();}var xhrCallback=new Function("","mstr.$obj('"+this.getId()+"')._onreadystatechange()");if(!mstr.$obj(this.getId())){var me=this;xhrCallback=function(){me._onreadystatechange();};}if(mstr.utils.ISFF3_5){xhr.onload=xhr.onerror=xhrCallback;}else{xhr.onreadystatechange=xhrCallback;}xhr.open("POST",url,async!=undefined&&async===false?false:true);xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.setRequestHeader("Content-Length",paramString.length);XHR._requests[this.getId()]=true;xhr.send(paramString);}else{this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);}};XHR.READYSTATE={UNINITIALIZED:0,LOADING:1,LOADED:2,INTERACTIVE:3,COMPLETE:4};XHR.prototype._addEnv=function XHR_addEnv(params){if(params){params.taskEnv="juil_xhr";}};XHR.prototype._makeArray=function XHR_makeArray(params,arr){for(var n in params){arr.push(n+"="+encodeURIComponent(params[n]));}};XHR.prototype._getURL=function XHR_getURL(params){return this.props.taskURL;};XHR.prototype._processResponse=function XHR_processResponse(txt){var r;if(txt){try{eval("r = "+txt);}catch(localerr){}}this.props.response={data:r};};XHR.prototype._onreadystatechange=function XHR_onreadystatechange(){var xhr=this._xhr,xhr_rs=xhr&&xhr.readyState,enXHR=XHR.READYSTATE,enRS=mstr.Enum.Widget.READYSTATE;var emptyFn=function(){},inputs=this.props.inputs,cb=inputs&&inputs.callback,success=cb&&cb.success||emptyFn,failure=cb&&cb.failure||emptyFn,complete=cb&&cb.complete||emptyFn;var sessionExpired=false;switch(xhr_rs){case enXHR.UNINITIALIZED:rs=enRS.IDLE;break;case enXHR.LOADING:case enXHR.LOADED:case enXHR.INTERACTIVE:rs=enRS.WAITING;break;case enXHR.COMPLETE:delete XHR._requests[this.getId()];rs=enRS.ERROR;if(xhr.status==200){var txt=xhr.responseText;this._processResponse(txt);rs=enRS.SUCCESS;this.props.lastSuccess=new Date();success(this.getResponse().data);}else{if(xhr.status>=400){var res={status:xhr.status,statusText:xhr.statusText};var headers=xhr.getAllResponseHeaders().split("\n");if(headers){var headerJSON={};for(var i=0;i<headers.length-1;i++){var header=headers[i];header=header.split(": ",2);headerJSON[header[0]]=header[1];}if(headerJSON["X-MSTR-TaskFailureMsg"]){res.data=headerJSON["X-MSTR-TaskFailureMsg"];}if(headerJSON["X-MSTR-TaskErrorCode"]){res.taskErrorCode=parseInt(headerJSON["X-MSTR-TaskErrorCode"])+4294967296;}}this.props.response=res;var app=mstrApp,sessionExp=app&&app.onSessionExpired,isSessionExpiredError=function(taskErrorCode){var MSI_SERVER_NAME_NOT_INITIALIZED=2147760371,MSI_INVALID_SESSION_ID=2147760372,E_MSI_USERMGR_USER_NOTFOUND=2147758245,E_MSI_CONNECT_FAILED=2147759877;var c=taskErrorCode;c=(c<0)?(4294967296+parseInt(c,10)):c;switch(c){case MSI_SERVER_NAME_NOT_INITIALIZED:case MSI_INVALID_SESSION_ID:case E_MSI_USERMGR_USER_NOTFOUND:case E_MSI_CONNECT_FAILED:return true;}return false;};if(sessionExp&&(sessionExpired=isSessionExpiredError(res.taskErrorCode))){sessionExp();}else{failure(this.getResponse().data,this.getResponse().taskErrorCode);}}}complete(this.getResponse().data);if(!sessionExpired){var sm=mstrApp.sessionManager;if(sm&&sm.restart){sm.restart();}}if(!mstr.utils.ISIE4&&!mstr.utils.ISWK&&xhr.abort){xhr.abort();}break;default:rs=enRS.ERROR;delete XHR._requests[this.getId()];break;}this.set("readyState",rs);};XHR.prototype.cancel=function XHR_cancel(){if(this.props.readyState==mstr.Enum.Widget.READYSTATE.WAITING){this.props.cancelled=true;if(this._xhr&&this._xhr.abort){this._xhr.abort();}this.set("readyState",mstr.Enum.Widget.READYSTATE.CANCELLED);delete XHR._requests[this.getId()];}};XHR.prototype.getResponse=function XHR_getResponse(){return this.props.response;};XHR._requests={};XHR.hasRequests=function XHR_hasRequests(){return Object.keys(XHR._requests).length>0;};function XHR(props){mstr.models.BaseModel.apply(this,[props]);}return XHR;})();mstr.http.PUProcessor=(function(){mstr.$O.extendsClass(PUP,mstr.http.XHRProcessor);PUP.prototype._addEnv=function PUP_addEnv(params){};PUP.prototype._makeArray=function PUP_makeArray(params,arr){for(var n in params){if(typeof params[n]=="object"){for(var j=0;j<params[n].length;j++){arr.push(n+"="+encodeURIComponent(params[n][j]));}}else{arr.push(n+"="+encodeURIComponent(params[n]));}}};PUP.prototype._getURL=function PUP_getURL(params){var url=params.action;params.xhr="true";delete params.action;delete params.processorClass;delete params.target;return url;};PUP.prototype._processResponse=function PUP_processResponse(txt){var r;if(txt){txt=txt.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");var errorEnd=txt.indexOf("{status");if(errorEnd!=-1){try{eval("r = "+txt.substring(errorEnd));if(r){r.components.push({id:"mstrWeb_error",content:txt.substring(0,errorEnd).replace(/\r\n/g,"")});}}catch(localerr){}}}if(r){this.props.response={data:r};}else{this.props.response={text:txt};}};function PUP(props){mstr.http.XHRProcessor.apply(this,[props]);}return PUP;})();mstr.behaviors={};mstr.behaviors.featureResolver=(function(){var FR={};FR.absorbFeatures=function FR_absorbFeatures(features){this.features=features;};FR.resolveFeatSet=function FR_resolveFeatSet(featSet,def){if(featSet){var res=true,featArr=featSet.split(";");mstr.$A.forEach(featArr,function(feat){res=res&&FR.featAvailable(feat);});return res;}else{return def;}};FR.featAvailable=function FR_featAvailable(feature){var resolvers=[];var reportBone;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){resolvers.push(microstrategy.getViewerBone());}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){reportBone=mstr.$obj("UniqueReportID");resolvers.push("ReportFrame",reportBone);}}resolvers.push(FR);var resIndex;var resolverObjs=new Array();for(resIndex in resolvers){var resolver=typeof (resolvers[resIndex])=="string"?mstr.$obj(resolvers[resIndex]):resolvers[resIndex];if(resolver){resolverObjs.push(resolver);}}if(feature.charAt(0)=="e"&&feature.charAt(1)==":"){var m=microstrategy;var _bone_=reportBone;if(!_bone_&&feature.indexOf("_bone_")>0){return false;}return eval(feature.substring(2,feature.length));}var feat=feature,show,undef,currBone,neg;if(feature.charAt(0)=="!"){feat=feature.substring(1,feature.length);neg=true;}show=false;undef=true;for(resIndex in resolverObjs){currBone=resolverObjs[resIndex];if(currBone&&currBone.features){undef=undef&&currBone.features[feat]==undefined;show=show||(currBone.features[feat]!=undefined&&currBone.isFeatureAvailable(feat));}}show=neg?!(undef||show):undef||show;return show;};FR.isFeatureAvailable=function FR_isFeatureAvailable(name){var __result=true;if((this.features!=null)&&typeof (this.features[name])!=undefined){__result=this.features[name];}return __result;};return FR;})();var useXHR=true;var javaScriptPath="";var mstrLogImplScript=false;var mstrToolbarImplScript=false;var mstrRwToolbarImplScript=false;var mstrGraphToolbarImplScript=false;var mstrPageSetupTabImplScript=false;var mstrTreeImplScript=false;var mstrAllObjectBrowserTreeImplScript=false;var mstrRWObjSelectionsImplScript=false;var mstrReportObjSelectionsImplScript=false;var mstrObjectBrowserImplScript=false;var mstrRWObjectsImplScript=false;var mstrReportObjectsImplScript=false;var mstrReportWSObjectsImplScript=false;var mstrFormulaBarImplScript=false;var mstrResizeEditorImplScript=false;var mstrFormatImplScript=false;var mstrAccordionTabManagerImplScript=false;var mstrDocPropTabManagerImplScript=false;var mstrPageLayoutTabImplScript=false;var mstrPageMarginsTabImplScript=false;var mstrGeneralPropTabImplScript=false;var mstrGridPropTabImplScript=false;var mstrPicturePropTabImplScript=false;var mstrWatermarkPropTabImplScript=false;var mstrLayoutPropTabImplScript=false;var mstrLinePropTabImplScript=false;var GradientUtilScript=false;var mstrTabImplScript=false;var mstrNumberTabImplScript=false;var mstrNumberFormatTabImplScript=false;var mstrColorTabImplScript=false;var mstrAlignTabImplScript=false;var mstrFontTabImplScript=false;var mstrEffectsTabImplScript=false;var mstrGraphAxesTabImplScript=false;var mstrGraphTitlesTabImplScript=false;var mstrGraphGeneralTabImplScript=false;var mstrGraphAdvancedTabImplScript=false;var mstrNotesTabImplScript=false;var mstrGraphOptionTabImplScript=false;var mstrEditorImplScript=false;var mstrContactsEditorImplScript=false;var mstrSortEditorImplScript=false;var mstrGroupbyPropsImplScript=false;var mstrTreeAttributeFormsQualificaionImplScript=false;var mstrMetricQualLevelEditorImplScript=false;var mstrMsgBoxImplScript=false;var AttFormsScript=false;var cartScript=false;var mstrCartImplScript=false;var ncScript=false;var mstrSubscriptionsFolderImplScript=false;var objectBrowserScript=false;var CalendarScript=false;var incrementalFetchScript=false;var advancedDrillScript=false;var adminOptionsScript=false;var columnWidthsGGScript=false;var colHandlesSetScript=false;var outlineModeGGScript=false;var lockSetScript=false;var formatEditorScript=false;var Filter2Script=false;var promptFunctionsScript=false;var menuScript=false;var contextMenuManagerScript=false;var contextMenuScript=false;var incrementalFetchCheckBoxesScript=false;var mstrColResizeImplScript=false;var mstrColorPickerEditorImplScript=false;var mstrColorGradientEditorImplScript=false;var mstrRWColorGradientEditorImplScript=false;var mstrPageByReportImplScript=false;var mstrPageByMapperImplScript=false;var mstrPageByImplScript=false;var mstrFilterEditorImplScript=false;var mstrOutlineModeImplScript=false;var mstrExportOptionsImplScript=false;var mstrAdvancedPropTabImplScript=false;var mstrDeliveryTabImplScript=false;var mstrOtherPropTabImplScript=false;var mstrDocPropsExportTabImplScript=false;var mstrTocPropTabImplScript=false;var mstrObjSelectionsImplScript=false;var mstrAttFormsImplScript=false;var ObjectManipulationScript=false;var mstrProjectBrowserImplScript=false;var mstrReportAllObjectsImplScript=false;var mstrDataExplorerImplScript=false;var mstrProjectBrowserSelectionsImplScript=false;var mstrElementPickerImplScript=false;var mstrFilterObjectsImplScript=false;var mstrUserEntityEditorImplScript=false;var mstrAdminGenericTabImplScript=false;var mstrTreeControlScript=false;var mstrTreeViewImplScript=false;var mstrOutlineViewImplScript=false;var mstrFolderActionsScript=false;var mstrFolderTreeViewImplScript=false;var mstrFolderFrameTreeViewImplScript=false;var mstrTreeCartImplScript=false;var mstrUserEntitiesTreeCartImplScript=false;var mstrEntitySelectorImplScript=false;var mstrSingleObjectSelectorImplScript=false;var mstrObjSelProjectBrowserImplScript=false;var mstrPromptDefTabImplScript=false;var mstrPromptQuestionsTabImplScript=false;var mstrPromptDisplayTabImplScript=false;var mstrPromptAdvancedTabImplScript=false;var mstrPromptQualificationTabImplScript=false;var mstrPromptDefImplScript=false;var mstrTabStripImplScript=false;var mstrTabStripMapperImplScript=false;var mstrLayoutTabImplScript=false;var mstrSectionsTabImplScript=false;var mstrPortalImplScript=false;var mstrPromptDefTabManImplScript=false;var mstrUnselectableObjectExplorerImplScript=false;var mstrSaveAsEditorImplScript=false;var mstrSaveAsReportImplScript=false;var mstrSaveAsObjectImplScript=false;var mstrCreateFolderImplScript=false;var mstrAdvancedOptionsImplScript=false;var mstrHyperLinkEditorImplScript=false;var mstrHyperLinkObjectExplorerImplScript=false;var mstrAlertsObjectExplorerImplScript=false;var mstrFilterDetailsFormattingEditorImplScript=false;var mstrSubtotalSimpleTabScript=false;var mstrSubtotalAdvancedTabScript=false;var mstrSubtotalDisplayTabScript=false;var mstrSubtotalsObjImplScript=false;var mstrAdminBrowserImplScript=false;var mstrSecurityFilterFrameImplScript=false;var mstrFunctionWizardEditorImplScript=false;var mstrSecurityRoleEditorImplScript=false;var mstrThresholdFormatEditorImplScript=false;var mstrSortRowTabImplScript=false;var mstrSortColTabImplScript=false;var mstrObjectListImplScript=false;var mstrUserEntitiesImplScript=false;var mstrContactsBrowserImplScript=false;var mstrUserAddressListImplScript=false;var mstrReportFrameImplScript=false;var mstrDerivedElementsBrowserImplScript=false;var mstrDerivedElementsEditorImplScript=false;var mstrDerivedElmtToolbarImplScript=false;var mstrDECalculationImplScript=false;var mstrPathImplScript=false;var mstrPickerImplScript=false;var mstrEditorToolbarScript=false;var mstrDMToolbarImplScript=false;var mstrThresholdEditorScript=false;var mstrThresholdSliderImplScript=false;var mstrSimpleThresholdEditorImplScript=false;var mstrAdvancedThresholdEditorScript=false;var mstrAlertsEditorScript=false;var mstrThresholdExpressionEditorScript=false;var mstrDivBasedCartImplScript=false;var mstrFolderImplScript=false;var mstrInlineRenameImplScript=false;var mstrGraphDropZonesEditorScript=false;var mstrInboxImplScript=false;var mstrDerivedElementFormatEditorImplScript=false;var mstrDerivedElementToolbarScript=false;var mstrFormatHelper=false;var importDerivedElementsEditorImplScript=false;var mstrRelatedReportsImplScript=false;var mstrTreeTabManagerImplScript=false;var mstrTabManagerTreeViewImplScript=false;var mstrFormatTreeTabManagerImplScript=false;var mstrObjectExplorerImplScript=false;var mstrReportXdaObjectsImplScript=false;var mstrXDAObjectExplorerImplScript=false;var mstrXDAEditorImplScript=false;var mstrVisualizationsEditorImplScript=false;var mstrRWControlImplScript=false;var mstrHTMLContainerImplScript=false;var mstrReportGraphImplScript=false;var mstrReportGraphCMImplScript=false;var mstrDatasetExplorerEditorImplScript=false;var mstrPanelStackScript=false;var mstrTableControlScript=false;var mstrRWActionControlImplScript=false;var mstrScrollerImplScript=false;var mstrMetricScrollerImplScript=false;var mstrSelectorPropTabImplScript=false;var mstrFlashPropTabImplScript=false;var mstrRoundedRectangleScript=false;var mstrRWUnitBoneImplScript=false;var mstrFlashViewerImplScript=false;var mstrFlashDashboardImplScript=false;var mstrSecondaryDataSourcesImplScript=false;var mstrWebHyperLinkEditorImplScript=false;var mstrOtherGridPropTabImplScript=false;var mstrAlertsExpressionEditorScript=false;var mstrFilterToolbarScript=false;var mstrGridStaticScript=false;var mstrGridReportScript=false;var mstrGridRWScript=false;var mstrIPhoneGridVisPropsEditorImplScript=false;var mstrIPhoneMarkerMashupVisPropsEditorImplScript=false;var mstrESRIVisPropsEditorImplScript=false;var mstrUsherConfigScript=false;var bFirstMetric=false;var sURL="";var bDesignMode=false;var lIndex=0;var sMsgID="";var sView="";var bAdvancedEdit=false;var flg_RTitle=1;var flg_QLinks=2;var flg_FTBar=4;var flg_Filt=8;var flg_PAxis=16;var flg_RTBar=32;var flg_SRTEditor=64;var flg_DRLEditor=128;var flg_FSELEditor=256;var flg_FRMEditor=512;var flg_FMATEditor=1024;var flg_SUBEditor=2058;var flg_Email=4096;var flg_Send=8192;var flg_ObjBr=16384;var flg_Grid=32768;var flg_IncFetch=65536;var SCROLLBAR_SIZE=17;var aEditorButton=new Array();aEditorButton[1]="";aEditorButton[2]=0;var aTemplateElements=new Array();var lPropertyAlias=0;var lPropertyKey=0;var lPropertyType=0;var lPropertyDerivedMetricType=3;var lPropertyDerivedMetric=0;var lPropertyIsDefinedOnDataset=0;var lPropertyFormula=0;var lPropertyPosition=0;var sNewMetric="";var DssXmlTemplateMetrics="";var logClientStopTimer=false;var logClient=false;var sTreeName="tree1";var lPropertyDynamicAlias=0;var recentObjectsAnchor;var currentPin="-1";var initializeCalls="";var bIsIE4=(document.all)?true:false,bIsIE6=false,bIsIE7=false,bIsIE8=false,bIsIE9=false,bIsIE10=false,ISIE7=false,bIsIEQuirks=false,bIsDXIE=false;var ua=navigator.userAgent;if(bIsIE4){var ie=parseFloat(ua.substring(ua.indexOf("MSIE")+4,ua.indexOf("MSIE")+8)),dm=document.documentMode;bIsIE6=(ie>=6)?true:false;if(window.isEdgeModeEnabled){bIsIE7=(((ua.indexOf("Trident")===-1)&&(ie===7))||dm>=7);ISIE7=(bIsIE7&&dm===7);bIsIE7C=(ua.indexOf("Trident")>-1&&dm===7);bIsIE8=(dm===8);bIsIE9=(dm===9);bIsIE10=(dm===10);bIsDXIE=(dm<=9);}else{bIsIE7=(ie>=7)?true:false;ISIE7=(ie==7)?true:false;bIsIE8=(ie>=8&&document.documentMode==8);bIsIE9=(ie>=9&&document.documentMode==9);bIsIE10=(ie>=10&&document.documentMode==10);bIsDXIE=!bIsIE10;}bIsIEQuirks=(dm===5||document.compatMode==="BackCompat");}var bIsW3CIE=function(){var C=-1,B=new RegExp("rv:([0-9]{1,}[.0-9]{0,})"),A=navigator.userAgent;if(A.indexOf("Trident")>=0&&B.exec(A)!=null){C=parseFloat(RegExp.$1);}return C>=11;}();var bIsW3C=(document.getElementById&&(!bIsIE4||bIsIE8||bIsIE9||bIsIE10||bIsW3CIE));var bIsFirefox=(bIsW3C&&ua.indexOf("Firefox")>-1);var bIsWK=(ua.indexOf("AppleWebKit")>-1);var bIsChrome=bIsWK&&(ua.indexOf("Chrome")>-1);var bIsSafari=bIsWK&&(ua.indexOf("Safari")>-1)&&!bIsChrome;var isMac=ua.indexOf("Macintosh")>-1;var lMouseX=0;var lMouseY=0;var bIsDHTML=(bIsIE4||bIsW3C)?true:false;var bIsInPortal=window.top!=window;var ENABLE="MSTRCSSANALYSER_Enable";if(typeof HTMLElement!="undefined"&&!HTMLElement.prototype.insertAdjacentElement){HTMLElement.prototype.insertAdjacentElement=function(A,B){switch(A){case"beforeBegin":this.parentNode.insertBefore(B,this);break;case"afterBegin":this.insertBefore(B,this.firstChild);break;case"beforeEnd":this.appendChild(B);break;case"afterEnd":if(this.nextSibling){this.parentNode.insertBefore(B,this.nextSibling);}else{this.parentNode.appendChild(B);}break;}};HTMLElement.prototype.insertAdjacentHTML=function(B,D){var C=this.ownerDocument.createRange();C.setStartBefore(this);var A=C.createContextualFragment(D);this.insertAdjacentElement(B,A);};HTMLElement.prototype.insertAdjacentText=function(B,C){var A=document.createTextNode(C);this.insertAdjacentElement(B,A);};}String.prototype.contains=function(C,A){try{if(!C){return false;}if(!A){return(this.indexOf(C)>-1);}var B=A+this+A;return(B.indexOf(A+C+A)>-1);}catch(D){alert(D);return false;}};function keyDownHandler(D){if(typeof (microstrategy)=="undefined"||microstrategy.eventManager==null||(iframe&&iframe.onWaitState!=false)){return true;}if(!D){D=window.event;}var E=getEventTarget(D);try{if(E){if(mstrmojo&&mstrmojo.dom&&mstrmojo.dom.contains(document.getElementById("DIContainer"),E,false)){return true;}if(E.tagName){var A=E.tagName.toLowerCase();if(A=="input"||A=="select"||A=="textarea"){return true;}}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){switch(D.keyCode){case 89:if(D.ctrlKey){microstrategy.eventManager.notifyOrphanBones("processRedo");return false;}break;case 90:if(D.ctrlKey){microstrategy.eventManager.notifyOrphanBones("processUndo");return false;}break;case 123:if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){toggleScreenMode();return false;}break;default:return true;break;}}else{var C=microstrategy.bone("rwb_viewer");if(C!=null&&C.doc!=null&&currentModalEditor.length==0&&!C.isDragging&&!C.mojoEditor){return C.doc.onkeydown(D);}}}return true;}catch(B){}}function keyPressHandler(C){switch((C||window.event).keyCode){case 27:if(iframe&&iframe.onWaitState){iframe.hideWaitPage();}return true;}if(typeof (microstrategy)=="undefined"||microstrategy.eventManager==null||(iframe&&iframe.onWaitState!=false)){return true;}var D=getEventTarget(C);if(D){if(D.tagName){var A=D.tagName.toLowerCase();if(A=="input"||A=="select"||A=="textarea"){return true;}}if(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION){var B=microstrategy.bone("rwb_viewer");if(B!=null&&B.doc!=null&&currentModalEditor.length==0){return B.doc.onkeypress(C);}}}return true;}function rightClick(D){var B=getEventTarget(D);if(bIsSafari){tagName=B.tagName;var C=window.getSelection&&window.getSelection();if(!(tagName=="INPUT"||tagName=="TEXTAREA")&&C&&C.removeAllRanges){C.removeAllRanges();}}var A=B;A=findTarget(A,"CX");if(A){A.clickedElement=B;return displayContextMenu(A,D);}return true;}function checkForFormSubmit(D,A){var C=window.event;if(C!=null&&C.keyCode==13){var B=A;if(typeof (B)=="string"){B=document.getElementById(A);}if(B!=null&&B.focus){B.focus();}}}function Init(){document.oncontextmenu=rightClick;document.onkeydown=keyDownHandler;document.onkeypress=keyPressHandler;if(logClientStopTimer){stopTimer(logClientName);}if(logClient){logClientTimes(currentUrlObjectID,currentFullURL);}var A=microstrategy.getRecentObjectsCount();var B=document.getElementById("mstrRecentObjects");if(B){}var D=document.createElement("div");D.setAttribute("id","mstrRecentsPopup");D.style.zIndex="101";document.body.appendChild(D);var D=document.getElementById("mstrRecentsPopup");if(D){D.onmousedown=function(E){if(window.event){window.event.cancelBubble=true;}else{E.cancelBubble=true;}};D.onclick=function(E){toggleRecentsPopup(true,D);};}var C=document.getElementById("mscld-recents-menu");if(C){C.onclick=function(){microstrategy.openRecentObjects(B);};}}function onDocumentClick(A){}function consolidateStyleSheets(F,B,J){var D=F.getElementsByTagName("STYLE"),K=[],L,I=J,H=0,C=[],A=function(R){var Q=document.getElementById(R+"IFrame");if(!Q){Q=document.getElementById(R);}if(Q){return Q;}},P=function(R,S){var Q="."+R+" {";if(R&&R.length>0){return S.indexOf(Q)>-1;}};if(D.length===0){return B;}L=A(I);while(L){C.push([I,L]);I=J+"_"+(++H);L=A(I);}for(var G=0;G<D.length;G++){for(var M=0;M<C.length;M++){var E,N,O;E=B[M]||"";if(E.length===0){L=C[M][1];E=L.innerHTML;}N=D[G].getAttribute("title");O=D[G].getAttribute("componentid");if(P(O,E)||M===C.length-1){if((!N||N.length===0)&&(O&&O.length>0)){E=replaceStyle(D[G],E,J!=="docObjectStyle");}K.push(E);break;}else{K.push(E);}}}return K;}function updateStyleContainer(C,B){if(C.length==0){return ;}stylesContainer=document.getElementById(B+"Container");if(stylesContainer!=null){var G=stylesContainer.getElementsByTagName("STYLE");if(G==null||G.length==0){var A=document.getElementById(B);if(A){A.parentNode.removeChild(A);}}}else{stylesContainer=document.createElement("div");stylesContainer.setAttribute("id",B+"Container");document.body.appendChild(stylesContainer);}var F=document.getElementById(B+"IFrame");if(F){F.parentNode.removeChild(F);}var E="";if(Object.prototype.toString.call(C)!=="[object Array]"){C=[C];}for(var D=0;D<C.length;D++){E+='<style id="'+B+(D>0?"_"+D:"")+'">'+C[D]+"</style>\n";}stylesContainer.innerHTML="<div>&nbsp;</div>"+E;}function replaceStyle(D,E,B){var C=D.getAttribute("componentid");if(C&&C.length>0){var A="."+C+" {";if(E.indexOf(A)>-1){E=E.substring(0,E.indexOf(A))+A+"}"+D.innerHTML+E.substring(E.lastIndexOf(A));}else{if(B){E+=A+"}"+D.innerHTML+A+"}";}else{E+=D.innerHTML;}}}else{E+=D.innerHTML;}return E;}function Unload(){window.isUnloading=true;if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.log)!="undefined"){microstrategy.log.show();}if(this.bIsIE6){this.DisconnectElement("object");}}function DisconnectElement(D){if(!document.getElementsByTagName){return ;}var E=document.getElementsByTagName(D);var B=(E!=null)?E.length:0;for(var C=0;C<B;C++){for(var A in E[C]){if(typeof E[C][A]=="function"){E[C][A]=function(){};}}}}function returnFormField(F,A){var B=F.elements;for(var D=0,C=B.length;D<C;D++){var E=B[D];if((E.id==A)||(E.name==A)){return E;}}return null;}function createDynamicForm(B){var E;var F=B.indexOf("?")>0;var D=B.indexOf("#")>0;E=document.createElement("FORM");E.name="dynamic_form";E.method="POST";var C=((F)?B.substring(0,B.indexOf("?")):B);if(D){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));C=C.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}C=microstrategy.addJSessionID(C);E.action=C;if(F){addURLAsHiddenInputsToForm(E,B);}document.body.insertAdjacentElement("beforeEnd",E);return E;}function createHiddenInput(E,B,D,A){var C=document.createElement("INPUT");C.type="HIDDEN";C.name=B;C.value=D;C.ps=(A===true);E.insertAdjacentElement("beforeEnd",C);return C;}function updateDynamicInput(G,B,F,D,A){var E=false;var C;if(!D){D=G.getElementsByTagName("input");}for(C=0;C<D.length;C++){E=(D[C].name==B);if(E){break;}}if(E){D[C].value=F;D[C].ps=(A===true);}else{createHiddenInput(G,B,F,A);}return true;}function submitFormSpecial(C,F,A){var D=null;var B=false;var E=getObj(C);for(i=0;i<F.length;i++){D=returnFormField(E,F[i]);if(D){D.value=A[i];}else{B=true;}}if(!B){submitForm(E);}}function submitFormValues(C,F,A){var D=null;var B=false;var E=getObj(C);synchForm(E);for(i=0,cnt=F.length;i<cnt;i++){D=getObj(F[i]);if(D){D.value=A[i];}else{B=true;}}if(!B){submitForm(E);}}function updatefbAvailableList(){var D=getObj("fbAvailable");var B=getObj("fbDataset");if(D&&!D.disabled&&B&&B.selectedIndex>=0){for(var A=0;A<D.children.length;A++){var C=D.children[A];C.style.display=C.getAttribute("dsidx")==B.selectedIndex?"block":"none";}}}function updatefbAvailableListSelected(A){var D=function(F){var G=F.className;if(/mstrListBlockItemSelected/.test(G)){G=G.replace(/mstrListBlockItemSelected/,"");}else{G+=" mstrListBlockItemSelected";}F.className=G;};var E=getObj("fbAvailable");var C=E.children;var B=E.selectedIndex;if(E){if(A!=B){if(!isNaN(B)&&B>=0){D(C[B]);}if(A>=0){D(C[A]);}}E.selectedIndex=A;}}function fbAvailableItemOnClick(C){var D=getObj("fbAvailable");var A=D.children;if(D&&!D.disabled){for(var B=0;B<A.length;B++){if(A[B]===C){updatefbAvailableListSelected(B);break;}}}}function fbdisableAvailableList(A){var C=getObj("fbAvailable");if(C&&A!=C.disabled){var B=C.className;if(!A){B=B.replace(/disabled/,"");}else{B+=" disabled";}C.className=B;C.disabled=A;}}function updatefbFormulaCaret(B){if(B.selectionEnd||B.selectionEnd==0){B.caret=B.selectionEnd;}else{if(document.selection&&document.selection.createRange){var C=document.selection.createRange();C.moveStart("character",-B.value.length);var A=C.htmlText.match(/<TEXTAREA(.*)>(.*)<\/TEXTAREA>/);if(A!=null&&A[2]){B.caret=A[2].length;}else{B.caret=C.text.length;}}}}function toggleCheck(B,A){var D=B.getAttribute("CV");var C=getObj(B.getAttribute("CL"));D--;if(D<-2){D=0;}switch(D){case -1:B.src=microstrategy.FOLDER_IMAGES+"check_on.gif";break;case 0:B.src=microstrategy.FOLDER_IMAGES+"check_off.gif";break;case -2:if(A){B.src=microstrategy.FOLDER_IMAGES+"Check_conflict.gif";}else{D=0;B.src=microstrategy.FOLDER_IMAGES+"check_off.gif";}break;}B.setAttribute("CV",D);C.value=D;}function synchForm(C){var A="";var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){A=B[i].name;A=A.toUpperCase();switch(A){case"INDEX":B[i].value=lStateID;break;case"MSGID":B[i].value=sMsgID;break;case"VIEW":B[i].value=sView;break;}}return true;}function getObj(A){return(typeof A=="string")?document.getElementById(A):A;}function getElementById(D){var C=document.getElementById(D);if(mstr.utils.ISW3C||C==null){return C;}if(!C.length||typeof (C.tagName)!="undefined"){C=[C];}for(var B=0,A=C.length;B<A;B++){if(C[B].id.length>0){return C[B];}}return null;}function getClientWidth(){var A=mstr.utils.BoxModel.getBrowserWindowWidth(document);return(bIsIE7)?(A-SCROLLBAR_SIZE+5):A;}function getClientHeight(){return mstr.utils.BoxModel.getBrowserWindowHeight(document);}function getDocumentScrollTop(){var A=document.documentElement;return(A&&A.scrollTop)?A.scrollTop:document.body.scrollTop;}function getDocumentScrollLeft(){var A=document.documentElement;return(A&&A.scrollLeft)?A.scrollLeft:document.body.scrollLeft;}function getObjInnerWidth(A){return mstr.utils.BoxModel.getElementInnerWidth(getObj(A));}function getObjOuterWidth(A){return mstr.utils.BoxModel.getElementOuterWidth(getObj(A));}function getObjWidth(A){return mstr.utils.BoxModel.getElementOuterWidth(getObj(A));}function getObjInnerHeight(A){return mstr.utils.BoxModel.getElementInnerHeight(getObj(A));}function getObjOuterHeight(A){return mstr.utils.BoxModel.getElementOuterHeight(getObj(A));}function getObjHeight(A){return mstr.utils.BoxModel.getElementOuterHeight(getObj(A));}function getObjTop(A){return mstr.utils.BoxModel.getElementTop(getObj(A));}function getObjSumTop(B,A){return mstr.utils.BoxModel.getElementSumOffsetTop(getObj(B),A||document.body);}function getObjSumTopScrolled(C,A){try{var E=getObj(C);var F=0;for(var B=0;(E&&E!=A);B++){F+=E.offsetTop;if(E.offsetParent&&E.offsetParent.scrollTop&&E.offsetParent.tagName.toLowerCase()!="html"&&E.offsetParent.tagName.toLowerCase()!="body"){F-=E.offsetParent.scrollTop;}E=E.offsetParent;}return parseInt(F);}catch(D){return 0;}}function getObjLeft(A){return mstr.utils.BoxModel.getElementLeft(getObj(A));}function getObjOffsetLeft(A){var B=getObj(A);if(B){return(bIsIE4)?B.offsetLeft:mstr.utils.BoxModel.getElementLeft(B);}}function getObjSumLeft(B){var C=getObj(B);var A=0;if(C&&(C.getClientRects||C.getBoundingClientRect)&&(!mstr.utils.ISIE8&&!mstr.utils.ISIE9)){A=C.getBoundingClientRect?C.getBoundingClientRect().left:C.getClientRects()[0].left;A=A-2+getDocumentScrollLeft();return Math.round(A);}return mstr.utils.BoxModel.getElementSumOffsetLeft(getObj(B),document.body);}function getObjSumLeftScrolled(C){try{var E=getObj(C);var B=0;for(var A=0;(E);A++){B+=E.offsetLeft;if(E.offsetParent&&E.offsetParent.scrollLeft&&E.offsetParent.tagName.toLowerCase()!="html"&&E.offsetParent.tagName.toLowerCase()!="body"){B-=E.offsetParent.scrollLeft;}E=E.offsetParent;}return parseInt(B);}catch(D){return 0;}}function getButtonId(A){if(bIsIE4&&!bIsIE9&&!bIsIE10&&A){return A.button;}if(bIsW3C&&A){return(A.button<2)?1:2;}else{return 1;}}function moveObjTo(C,B,F){var D=getObj(C);if(D!=null){var A=parseInt(B);var E=parseInt(F);if(!isNaN(A)&&!isNaN(E)){D.style.left=A+"px";D.style.top=E+"px";}}}function displayObj(A){var B=getObj(A);if(B){B.style.display=(bIsFirefox&&B.tagName.toLowerCase()=="table")?"table":"block";B.style.visibility="visible";}}function removeObj(A){var B=getObj(A);if(B){B.style.display="none";B.style.visibility="hidden";}}function isInDocument(A){if(!A){return false;}var B=getObj(A);if(!B){return false;}if(!B.offsetParent){return false;}if(bIsW3C){return(B.ownerDocument==window.document);}return(B.document==window.document);}function getMouse(A){if(bIsIE4){lMouseX=event.clientX+getDocumentScrollLeft();lMouseY=event.clientY+getDocumentScrollTop();}else{if(bIsW3C&&A!=null){lMouseX=A.pageX;lMouseY=A.pageY;}}}function writeToDiv(C,B){var A=getObj(B);if(A){A.innerHTML=C;}}function getEventTarget(C){try{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&C){if(!C){return null;}var B=C.target;if(typeof (C.target)=="function"){B=C.target();}if(bIsW3C&&B.tagName=="scrollbar"){B=B.parentNode;}if(B.nodeType==3){B=B.parentNode;}return B;}else{if(bIsIE4){return event.srcElement;}}}catch(A){}return null;}function stopEventBubbling(A){if(A){A.cancelBubble=true;if(A.stopPropagation){A.stopPropagation();}}}function cancelEvent(A){if(bIsW3C&&!bIsIE8&&!bIsIE9){A.preventDefault();}else{if(bIsIE4){event.returnValue=false;}}}function isAttributePresent(B,C,D){var A=B.attributes&&B.attributes.getNamedItem(C);if(!A||!A.specified){return false;}if(D){return(A.nodeValue==D);}return true;}function findTarget(A,B,C){while(A){if(isAttributePresent(A,B,C)){return A;}A=A.parentNode;}return null;}function findTargetTag(B,A){while(B.parentNode){if(B.nodeName.toLowerCase()==A.toLowerCase()){return B;}B=B.parentNode;}return null;}function toggleElement(C,A,B){var D=getObj(C);if(D){D.disabled=!B;if(A.length>0){D.className=A;}}}function addURLAsHiddenInputsToForm(G,E,D,F){if(G.nodeName!="FORM"){G=findTargetTag(G,"FORM");}E=E.substring(E.indexOf("?")+1,E.length);var J=E.split("&");var K="";var H="";var B="";var I=/\+/g;for(var C=0,A=J.length;C<A;C++){K=J[C].split("=");H=K[0];B=K[1];if(B){B=decodeURIComponent(B.replace(I," "));}if(D){updateDynamicInput(G,H,B,F);}else{createHiddenInput(G,H,B,F);}}return false;}function openExport(A,B){if(typeof (microstrategy)!="undefined"&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&microstrategy.bones.rwb_viewer&&microstrategy.bones.rwb_viewer.isFeatureAvailable(microstrategy.FEATURE_USE_OFFICE)&&(microstrategy.IS_RWD_DIRTY==microstrategy.TRUE||hasRWDChanged())){showMessage({contents:microstrategy.descriptors.getDescriptor("3809"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"submitExportForm('"+A+"','"+B+"');",type:mstrMsgBoxImpl.MSG_WARNING});}else{submitExportForm(A,B);}}function hasRWDChanged(){if(typeof (microstrategy)!="undefined"&&microstrategy.updateManager){var B=microstrategy.updateManager;for(var D=0,C=B.undoActions.length;D<C;D++){var F=B.undoActions[D];if(F==mstrUpdateManager.STATIC_ACTION){continue;}for(var A=0,E=F.length;A<E;A++){if(F[A].id!=mstrUpdateManager.FIX_STATE){return true;}}}}return false;}function submitExportForm(B,G,E,A){if(!B){return ;}if(!A&&(bIsIE6&&G!="_blank")){if(G=="_blank"){G=Date.parse(new Date());}submitEmptyForm(G);window.setTimeout("submitExportForm('"+B+"','"+G+"', "+E+", true);",500);return ;}var C=createDynamicForm(B);if(G!=""){C.target=G;}if(E){C.method="POST";}C.action=C.action+"?name="+Date.parse(new Date());if(typeof (microstrategy)!="undefined"&&(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)&&microstrategy.IN_OUTLINE_MODE){var F=microstrategy.bone("UniqueReportID");if(F!=null&&F.outlineMode!=null){var D=F.outlineMode.getExpansionState("UniqueReportID");if(D.length>0){createHiddenInput(C,"PDFOutlineModeState",D);}}}if(G=="_new"){iframe.hideWaitPage();}submitForm(C);return false;}function exportRW(A,G,H,E,I){var J=microstrategy.getViewerBone();if(!J){return ;}if(!H){if(A==microstrategy.EXEC_MODE_EXCEL){if(J.isFeatureAvailable(microstrategy.FEATURE_USE_OFFICE)&&(microstrategy.IS_RWD_DIRTY==microstrategy.TRUE||hasRWDChanged())){showMessage({contents:microstrategy.descriptors.getDescriptor("3809"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"exportRW("+A+",'"+G+"',true,"+E+","+I+");",type:mstrMsgBoxImpl.MSG_WARNING});return ;}}else{if(A==microstrategy.EXEC_MODE_FLASH&&bIsIE6&&isFlashMHTFormat()){showMessage({contents:microstrategy.descriptors.getDescriptor("5873"),elements:microstrategy.OK_BUTTON,okEval:"exportRW("+A+",'"+G+"',true,"+E+","+I+");",type:mstrMsgBoxImpl.MSG_WARNING});return ;}}}if(A==microstrategy.EXEC_MODE_EXCEL||A==microstrategy.EXEC_MODE_PDF){if(!E&&J.isFeatureAvailable("show-rw-export-options")&&(J.isFeatureAvailable("is-multi-layout-doc")||(!J.containsGroupByDifferentThanAll&&J.isFeatureAvailable("show-groupby-for-export")||(J.containsGroupByDifferentThanAll&&J.containsGroupByDifferentThanAll())))){var B=(A==microstrategy.EXEC_MODE_PDF)?"&isPDF=true":"";toggleShowBean("exportOptionsEditor",true,"executionMode="+A+B);return ;}}if(!I&&(bIsIE6&&G!="_blank")){submitEmptyForm(G);window.setTimeout("exportRW("+A+",'"+G+"',"+H+","+E+",true);",500);return ;}var K=microstrategy.updateManager.newWindow;var F=microstrategy.updateManager.newWindowName;var C=microstrategy.updateManager.getFormAction();var D=microstrategy.updateManager.getFixStateActions();microstrategy.updateManager.newWindow=true;microstrategy.updateManager.newWindowName=G;microstrategy.updateManager.setFormAction(microstrategy.servletName+"?name="+Date.parse(new Date()));microstrategy.updateManager.add(getRWExportActionObject(A),true);microstrategy.updateManager.flushAndSubmitChanges();microstrategy.updateManager.newWindow=K;microstrategy.updateManager.newWindowName=F;microstrategy.updateManager.setFormAction(C);microstrategy.updateManager.acknowledgeRequest();microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.FIX_STATE,microstrategy.getViewerBone().beanPath,[],[],[],[])],true);microstrategy.updateManager.add(D,true);}function getRWExportActionObject(A){if(A=="-1"){return[microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.RW_HTML_EXPORT,microstrategy.servletName,[],[],[],[])];}else{return[microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.RW_FAST_EXPORT,microstrategy.servletName,["3115"],[A],[],[])];}}function submitEmptyForm(B){var A=createDynamicForm("../html/Empty.html");A.target=B;A.method="GET";A.submit();}function submitForm(M,Q){var N=getObj("pageStateForm");var G=null;var J=null;var I;var H;var E;var P;appendPageState(M);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;updateDynamicInput(M,"docSelections",L.commands.queryState("selectionsKey"));L.adjustScrollValues();updateDynamicInput(M,"viewerScroll",L.dScrollTop+","+L.dScrollLeft);var A=microstrategy.bones.rwControlsToolbar;if(A!=null){updateDynamicInput(M,"isLocked",(A.locked)?1:0);if(A.selected&&A.selected.id){updateDynamicInput(M,"currentControl",A.selected.id);}}}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var C in microstrategy.bones){if(microstrategy.bones[C]!=null&&microstrategy.bones[C].type==microstrategy.OBJTYPE_GRID){var D=microstrategy.bones[C];if(D&&D.gridStructureInfo&&!D.gridStructureInfo.emptyCase&&!D.gridStructureInfo.isEmptyTemplate){if(D.isGrid){var K=D.commands.queryState("selections");if(K){updateDynamicInput(M,D.id,K);}}if(D.isGraph&&C.indexOf("_graph")==-1){updateDynamicInput(M,D.id+"_gs",D.commands.queryState("graphSelections"));}}}}}if(false){var G=M.getElementsByTagName("INPUT");var O="";for(I=0;I<G.length;I++){O+=G[I].name+": "+G[I].value+"\n";}var B=0;while(B<O.length){alert(O.substr(B,5000));B+=5000;}}if(M.target=="frameManager"&&useXHR&&!Q){if(microstrategy.updateManager){microstrategy.updateManager.submitPartialUpdate(UpdateHelper.createParamsFromForm(M));}}else{try{microstrategy.submitForm(M);}catch(F){if(M.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(F);}}}return false;}function appendPageState(F){for(var A=F.elements.length,B=A-1,E;B>=0;B--){E=F.elements[B];if(E.ps===true){var D=E.parentNode;D=D&&D.removeChild&&D.removeChild(E);}}var H=getObj("pageStateForm");var G=null;var C=null;var B;if(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit()){microstrategy.updateManager.flushChanges(F);addEvtOrder(F,mstrUpdateManager.multipleEventID);}if(H){if(F.method=="get"||F.method=="GET"){addURLAsHiddenInputsToForm(F,pageState,true,true);}else{G=H.getElementsByTagName("INPUT");C=F.getElementsByTagName("INPUT");for(B=0,cnt=G.length;B<cnt;B++){updateDynamicInput(F,G[B].name,G[B].value,C,true);}}}}function updateAndSubmitLink(A){microstrategy.updateManager.flushAndSubmitChanges();submitLink(A);return ;}function openLink(A){submitLink(A);window.open(A.href,A.target);return false;}function updateAndOpenLink(B,A){var C=updateLink(B);window.open(C,A);iframe.hideWaitPage();return false;}function updateLink(G){var D=G;var F=pageState;var B,E,C,A;if(F){while((B=F.indexOf("="))>=0){C=F.substr(0,B);A=((E=F.indexOf("&"))>=0)?F.substr(B+1,E-B-1):F.substr(B+1);D=replaceURLParameter(D,C,A);F=(E>=0)?F.substr(E+1):"";}}return D;}function toggleShowBean(E,B,D,C){if(typeof (microstrategy)!="undefined"&&microstrategy.updateManager){var A=new Array();A.push(microstrategy.updateManager.createActionObject(null,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[B,E],[]));microstrategy.updateManager.add(A);microstrategy.updateManager.addURL(D);microstrategy.updateManager.flushAndSubmitChanges(C);}return false;}function addArgument(E,B){if(E){var A=getObj(E);var C,D;if(A){D=A.id;C=A.value;if((typeof (D)!="undefined")&&(D.length>0)&&(typeof (C)!="undefined")){B.href=B.href+"&"+D+"="+escape(C);}}}}function addArgumentAndSubmitLink(B,A){addArgument(B,A);submitLink(A);}function submitLinkAsForm(C){var D=C.href,B=C.target,E=createDynamicForm(D);if(microstrategy.servletState&&window.microstrategy){var A=microstrategy.findChildWithAtt(E,"input","name",microstrategy.servletName);if(!A&&microstrategy.servletState){createHiddenInput(E,microstrategy.servletName,microstrategy.servletState);}}if(B){E.target=B;}submitForm(E);return false;}function getCookie(B){var A=cookieEnd=-1;if(document.cookie.length>0){A=document.cookie.indexOf(B+"=");if(A!=-1){A=A+B.length+1;cookieEnd=document.cookie.indexOf(";",A);if(cookieEnd==-1){cookieEnd=document.cookie.length;}return unescape(document.cookie.substring(A,cookieEnd));}}return null;}function submitLink(H,F){if(!F){F=window.event;}if(F&&F.ctrlKey){return false;}var B=H.target;if(iframe&&B.indexOf("_blank")===-1){iframe.showWaitPage(true);}window.mstrSubmitLink=true;if(H.getAttribute("useIframe")){if(history.pushState){var D=H.href.split(/[?#]/)[0];history.pushState({target:H.target,href:H.href},H.title,D);}H.href=replaceURLParameter(H.href,"iframe","true");}var G=H.href;var A=document.getElementById("cssAnalyzerToolbar");var I=(getCookie(ENABLE)=="true")&&(A!=null)&&F.altKey;if(I){return false;}if(B=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){if(!bIsIE7||document.readyState=="complete"){var J=createDynamicForm(G);if(B){J.target=B;}if(H.getAttribute("runAsExpress")=="1"){createHiddenInput(J,"innerWidth",getClientWidth());createHiddenInput(J,"innerHeight",getClientHeight());}submitForm(J);}return false;}if(typeof (pageState)!="undefined"){var C=updateLink(G);C=moveAnchor(C);var E=null;if(bIsIE6&&H.childNodes&&(H.childNodes.length==1)&&H.childNodes[0].nodeType==3){E=H.innerHTML;}var J=createDynamicForm(C);if(B){J.target=B;}submitForm(J);return false;}else{return true;}}function submitCreateAnalysis(B,C){var A=submitLink(B,C);if(A){B.href=replaceURLParameter(B.href,"fromPh","0");}return A;}function moveAnchor(D){var A=-1,B=-1,C="";A=D.indexOf("#");if(A>-1){B=D.indexOf("?",A);if(B==-1){B=D.indexOf("&",A);}if(B>-1){C=D.substr(A,B-A);D=D.replace(C,"")+C;}}return D;}function addEvtOrder(F,A,C){var B=F.getElementsByTagName("input"),D=false,E=0;for(j=0,cnt=B.length;j<cnt;j++){D=B[j].name=="evtorder";if(D){break;}}if(D){if(B[j].value.indexOf(A)<0){B[j].value=(C)?(B[j].value+","+A):(A+","+B[j].value);updateDynamicInput(F,A,"1",B);}}else{updateDynamicInput(F,"evtorder",A);for(j=0,cnt=B.length;j<cnt;j++){if(B[j].name=="evt"){E++;}}if(E<3){for(j=0,cnt=B.length;j<cnt;j++){if(B[j].name=="evt"){updateDynamicInput(F,B[j].value,"1");}}}}}function replaceURLParameter(G,B,E){var A="";if(G.indexOf("#")>-1){A=G.substr(G.indexOf("#"));G=G.substr(0,G.indexOf("#"));}var D=iFinalPos=-1,F=G.toUpperCase(),H=B.toUpperCase()+"=",C="";D=F.indexOf(H);if(D>-1){C=F.substr(D-1,1);if((C!="&")&&(C!="?")){D=F.indexOf(H,D+1);}if(D>-1){iFinalPos=G.indexOf("&",D);if(iFinalPos==-1){C=G.substr(D-1,1);if(C=="&"){G=G.substr(0,D-1);}}else{G=(C=="?")?G.substr(0,D)+G.substr(iFinalPos+1):G.substr(0,D-1)+G.substr(iFinalPos);}}}if(G.length>0){G+=(G.substr(-1)=="?")?(B+"="+E):("&"+B+"="+E);}else{G+=B+"="+E;}return G+A;}function getURLParameter(D,C){var B=new RegExp(C+"=(.*?)&|$");var A=B.exec(D,"i");return A[1]||"";}function insertDynamicScript(C,B){if(bIsIE4||mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISFF4PLUS||bIsW3CIE){microstrategy.dynamicJS.push({key:C,file:B});}else{if(!checkJSExists(C)){var A=document.getElementById(C+"_js");if(A){if(A.src!=B){A.src=B;}}else{A=document.createElement("script");A.id=C+"_js";A.setAttribute("language","javascript");document.body.appendChild(A);A.src=getResourcePathWithVersion(B);}}}}function checkJSExists(E){if(E.indexOf(".")<0){return window[E];}var B=E.split("."),F=window,C=n=null;for(var D=0,A=B.length;D<A;D++){n=B[D];C=F[n];if(C==undefined){return false;}F=C;if(F==null){return false;}}return true;}function loadInit(key,methodToExecute){if(eval(key)){eval(methodToExecute);}else{key=key.replace(/"/g,'\\"');methodToExecute=methodToExecute.replace(/"/g,'\\"');window.setTimeout('loadInit("'+key+'", "'+methodToExecute+'");',500);}}function togglePulldowns(E,B){if(bIsW3C){return ;}if(!B){if(E){var A=getObjWidth(E)||getObjInnerWidth(E);var D=getObjHeight(E)||getObjInnerHeight(E);var C=microstrategy.getPopupMask(E);C.style.left=E.style.left;C.style.top=E.style.top;C.style.width=A+"px";C.style.height=D+"px";if(E.style.zIndex>0){C.style.zIndex=E.style.zIndex-1;}else{if(typeof (microstrategy)!="undefined"&&microstrategy.styleObj){var F=microstrategy.styleObj.getValue(E,"zIndex");if(F&&!isNaN(parseInt(F))){C.style.zIndex=F;}}}}}else{microstrategy.releasePopupMask(E);}return ;}function closeDialog(B,D){if(getObj(B+"_pane")){removeObj(B+"_pane");}if(getObj("colHandlesPane")){removeObj("colHandlesPane");}var E=getURLParameter(pageState,D);E=E.replace(B,"*0");pageState=replaceURLParameter(pageState,D,E);var G=getObj("pageStateForm"),F;for(var C=0,A=G.elements.length;C<A;C++){F=G.elements[C];if(F.name==D){F.value=E;break;}}if(microstrategy.observer){microstrategy.observer.notifyAll("onstatechange");}microstrategy.eventManager.ondialogresize();return false;}function closeEditor(B){if(getObj(B+"_pane")){removeObj(B+"_pane");}var D=new RegExp("6012","g");if(microstrategy){var C=microstrategy.updateManager;if(C){var A=new Array();A.push(C.createActionObject(this,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],["false",B],[]));C.add(A,true);}}return false;}function showMessage(B){var A=null;if(B.messageBoxID==null){B.messageBoxID="msgBox";}if(B.positionInMiddle==null||typeof (B.positionInMiddle)=="undefined"){B.positionInMiddle=true;}A=microstrategy.bones[B.messageBoxID];if(A){A.cleanBeforeInit();if(B.messageBoxID=="msgBox"){A.setCssClass(B.boneCssClass);}if(B.href!=null){A.setHelpHref(B.href,B.appendHelpTopic);}if(B.type!=mstrMsgBoxImpl.MSG_EXPORT_LINK){A.setMessage(B.contents,B.type);}if(B.type==mstrMsgBoxImpl.MSG_TEXT_ONLY){A.setTextOnlyContentWidth();}A.setButtons(B.elements,B.okEval,B.cancelEval,B.applyEval,B.buttonLabels);A.setTitle(B.title);A.setPreference(B.type==mstrMsgBoxImpl.MSG_PREF_WARNING);A.show(B.positionInMiddle,B.zIndex);A.setButtonFocus(B.focusButton);}}function enablePulldowns(D,A){if(mstr.utils.ISIE6){var C=D.getElementsByTagName("select");if(C){if(A){for(var B=0;B<C.length;B++){if(C[B].getAttribute("db")=="true"){C[B].disabled=false;C[B].removeAttribute("db");}}}else{for(var B=0;B<C.length;B++){if(!C[B].disabled){C[B].disabled=true;C[B].setAttribute("db","true");}}}}}}function encode(C,B){var E=C;if(B==null){B=false;}if((C!=null)&&(C.length>0)){E="";for(var D=0,A=C.length;D<A;D++){switch(C.charAt(D)){case"&":if((C.length!=(D+1))&&(C.charAt(D+1)=="#")){E+="&";}else{E+="&amp;";}break;case"<":E+="&lt;";break;case">":E+="&gt;";break;case"'":E+="&#039;";break;case"\n":if(!B){E+="<br />";}else{E+=C.charAt(D);}break;case'"':E+="&quot;";break;case" ":if(D==0||(D<C.length-1&&C.charAt(D+1)==" ")){E+="&nbsp;";}else{E+=C.charAt(D);}break;default:E+=C.charAt(D);break;}}}return E;}function decode(B,A){var C=B;if(B!=null){C=C.replace(/&amp;/g,"&");C=C.replace(/&lt;/g,"<");C=C.replace(/&gt;/g,">");C=C.replace(/&#039;/g,"'");C=C.replace(/&nbsp;/g," ");if(!A){C=C.replace(/<BR>/ig,"\n");}C=C.replace(/&quot;/g,'"');}return C;}function trim(A){if(!A){return"";}return A.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}function gotoPromptAnchor(){if(promptFunctionsScript==true){resizePromptContent();gotoAnchor(currentPin);}}SimpleRect.prototype=new Object();function SimpleRect(A){this.left=getObjSumLeftScrolled(A);this.top=getObjSumTopScrolled(A);this.right=this.left+getObjWidth(A);this.bottom=this.top+getObjHeight(A);return this;}function setFilter(D,A,C){if(bIsIE4&&!(A=="Alpha"&&bIsIE9)&&!bIsIE10){var B=getFilter(D,A);var G;if(B){B.enabled=true;for(G in C){B[G]=C[G];}if(A=="Alpha"&&C.opacity==100){B.enabled=false;}}else{if(A=="Alpha"&&C.opacity==100){return ;}var E=" progid:DXImageTransform.Microsoft."+A+"(";for(G in C){E+=G+"="+C[G]+",";}E=E.substr(0,E.length-1)+")";var F=D.style.filter;if(!F){F=getFilter(D);if(F){D.style.filter+=F+E;}else{D.style.filter+=E;}}else{D.style.filter+=E;}}}else{if(mstr.utils.ISFF||mstr.utils.ISWK||mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE){if(A=="Alpha"){D.style.opacity=C.opacity/100;}}}}function getFilter(D,A){try{if(microstrategy&&microstrategy.styleObj){return microstrategy.styleObj.getFilter(D,A);}var B=null;if(bIsIE4&&!bIsIE10){var E=D.currentStyle.filter;if(!A){return E;}if(E.length>0){B=D.filters["DXImageTransform.Microsoft."+A];}}return B;}catch(C){microstrategy.errors.log(C);return false;}}function removeFilter(D,A){try{if(microstrategy&&microstrategy.styleObj){return microstrategy.styleObj.getFilter(D,A);}var B=null;if(bIsIE4&&!bIsIE10){var E=D.currentStyle.filter;if(!A){return E;}if(E.length>0){B=D.filters["DXImageTransform.Microsoft."+A];}}return B;}catch(C){microstrategy.errors.log(C);return false;}}function CheckTextAreaMaxLength(B,A){var C=(typeof (B.innerText)!="undefined")?B.innerText:B.value;if(C.length>A){LimitTextAreaMaxLength(B,A);}return true;}function LimitTextAreaMaxLength(B,A){if(B.value.length>A){B.value=B.value.substring(0,A);}}function toggleScreenMode(){var C;if(typeof (microstrategy)!="undefined"&&microstrategy.updateManager){C=microstrategy.updateManager;}if(!C){return true;}var D,E,B;if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){D=mstr.$obj("UniqueReportID");E=mstr.$obj("rptRibbonToolbarModel");}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){D=microstrategy.getViewerBone();E=mstr.$obj("rwRibbonToolbarModel");}}if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){B=new Array();B.push(C.createActionObject(this.elem,mstrUpdateManager.SWITCH_FULL_SCREEN_MODE,microstrategy.servletName+"."+microstrategy.pageName,["5028"],["1"],[]));microstrategy.updateManager.add(B,true);var A=document.getElementById("mstrWeb_shortcutsBar");if((D.currentRWViewMode!=microstrategy.RW_VIEW_MODE_FLASH)||(A)){document.body.className=document.body.className.replace(" mstrFullScreen","");}else{C.useIframe=false;C.flushAndSubmitChanges();}if(mstr.utils.ISIE4){var F=document.getElementById("td_mstrWeb_dockLeft");if(F){F.parentNode.insertBefore(F,F.nextSibling);}}D.features["page-full-screen-mode"]=false;microstrategy.pageScreenMode=microstrategy.PAGE_NORMAL_SCREEN_MODE;if(D.observer){D.observer.notifyAll("onScreenModeChange");}}else{B=new Array();B.push(C.createActionObject(this.elem,mstrUpdateManager.SWITCH_FULL_SCREEN_MODE,microstrategy.servletName+"."+microstrategy.pageName,["5028"],["2"],[]));microstrategy.updateManager.add(B,true);microstrategy.pageScreenMode=microstrategy.PAGE_FULL_SCREEN_MODE;if(!E){C.useIframe=false;C.flushAndSubmitChanges();return false;}else{E.execSelectValue(0);D.features["page-full-screen-mode"]=true;if(D.observer){D.observer.notifyAll("onScreenModeChange");}}document.body.className+=" mstrFullScreen";}window.setTimeout(function(){microstrategy.redoLayout(true);microstrategy.eventManager.notifyOrphanBones("onwinresize");},1);return false;}function submitSaveVisualization(A,D){var B=createDynamicForm(A);if(D){B.target=D;}B.method="POST";var C=microstrategy.bone("UniqueReportID");if(!C){C=microstrategy.bone("rwb_viewer");}if(C&&C.selectedVisualization){createHiddenInput(B,"styleName",C.selectedVisualization);}submitForm(B);}var graphUnitTooltipCache=null;function onMainGraphMouseMove(B){if(!B){B=window.event;}var C=B.currentTarget;if(C){var A=C.getAttribute("tooltip");if(A&&!graphUnitTooltipCache&&graphTooltipCache.length==0){C.onmouseout=new Function("e","onMainGraphMouseExit(e);");graphUnitTooltipCache=document.createElement("span");graphUnitTooltipCache.className="graph-tooltip";graphUnitTooltipCache.id="mainTooltip";getMouse(B);moveObjTo(graphUnitTooltipCache,lMouseX,lMouseY);document.body.appendChild(graphUnitTooltipCache);graphUnitTooltipCache.innerHTML=A;togglePulldowns(graphUnitTooltipCache,false);}}}function onMainGraphMouseExit(A){if(!A){A=window.event;}if(graphUnitTooltipCache){graphUnitTooltipCache.parentNode.removeChild(graphUnitTooltipCache);togglePulldowns(graphUnitTooltipCache,true);graphUnitTooltipCache=null;}}var graphTooltipCache=[];function onGraphMouseMove(B,A){if(!B){B=window.event;}var C=getEventTarget(B);if(C){C.onmouseout=new Function("e","onGraphExit(e);");graphShowTooltip(C,B,A);}}function onGraphExit(B){if(!B){B=window.event;}if(graphTooltipCache){for(var A=0;A<graphTooltipCache.length;++A){graphTooltipCache[A].parentNode.removeChild(graphTooltipCache[A]);togglePulldowns(graphTooltipCache[A],true);}graphTooltipCache=[];}}function getOverlappedItems(B,D){var A=[];for(var C=B.length-1;C>=0;--C){var E=B[C].getAttribute("coords");if(E&&E==D){A.push(B[C]);}}return A;}function graphShowTooltip(G,X,H){if(!X){X=window.event;}var S=null;if(graphTooltipCache.length>0){return ;}if(H){var E=microstrategy.bone(H);if(E){S=E.image;}}else{if(microstrategy){var T=microstrategy.findAncestorWithAtt(G,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE);if(T){S=microstrategy.objectFind(T,"img",microstrategy.OBJTYPE_GRAPH);}}}if(!S){var T=G.parentNode.parentNode;if(T){S=microstrategy.objectFind(T,"img",microstrategy.OBJTYPE_GRAPH);}}if(X&&G&&S){var C=G.getAttribute("tooltip"),L=y=99999;if(!C){if(graphTooltipCache){for(var V=0;V<graphTooltipCache.length;++V){graphTooltipCache[V].parentNode.removeChild(graphTooltipCache[V]);togglePulldowns(graphTooltipCache[V],true);}graphTooltipCache=[];}return ;}var U=G.getAttribute("coords"),B=getObjSumLeftScrolled(S),F=getObjSumTopScrolled(S),K=getObjWidth(S),W=getObjHeight(S),A=100;var R=getOverlappedItems(G.parentNode.children,U),N=5;if(U&&U.length>0){U=U.split(",");if(U.length>=4){N=U[2]-U[0];}L=99999;y=99999;var V=0;while(V+1<U.length){L=Math.min(L,parseInt(U[V++]));y=Math.min(y,parseInt(U[V++]));}L+=B;y+=F;}else{getMouse(X);L=lMouseX;y=lMouseY;}if(microstrategy.ZOOM_FACTOR){A=microstrategy.ZOOM_FACTOR;}var D=0,O=0,Q=5,M=Math.ceil(R.length/2),P;for(var V=0;V<R.length;++V){P=document.createElement("span");P.className="graph-tooltip";P.id="tooltip"+V;if(bIsIE8){P.style.left="1px";P.style.top="1px";}else{P.style.left="-10000px";}document.body.appendChild(P);P.innerHTML=R[V].getAttribute("tooltip");P.style.fontSize=(A/100)+"em";D=Math.max(D,getObjWidth(P));O=Math.max(O,getObjHeight(P));graphTooltipCache.push(P);}var J=function(Z,Y){if(Z+N+D+Q>B+K){return B+K-N-D-Q;}else{if(R.length>1&&Z-D-Q<0){return D+Q;}}return Z;},I=function(b,Z,Y){var a=Y==1?O:(Y*O+(Y-1)*Q)/2;if(a>b){return 0;}else{if(a+b>F+W){return F+W-a*2;}else{return b-a;}}};L=J(L,D);y=I(y,O,M);for(var V=0;V<graphTooltipCache.length;V++){if(V%2==0){moveObjTo(graphTooltipCache[V],L+N+Q,y);}else{moveObjTo(graphTooltipCache[V],L-getObjWidth(graphTooltipCache[V])-Q,y);y+=O+Q;}togglePulldowns(graphTooltipCache[V],false);}}}var templateTooltipCache=null;function onTemplateMouseMove(A){if(!A){A=window.event;}var B=getEventTarget(A);if(B){mstr.$D.attachEvent(B,"mouseout",onTemplateExit,false);tempShowTooltip(B,A);}}function onTemplateExit(A){if(!A){A=window.event;}if(templateTooltipCache){templateTooltipCache.style.left="-15000px";togglePulldowns(templateTooltipCache,true);}}function tempShowTooltip(F,D){if(!D){D=window.event;}if(D&&F){var B=microstrategy.findAncestorWithAtt(F,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_TEMPLATE);var A=y=99999,C=100,E=null;if(B){E=B.getAttribute("tooltip");}if(!E){if(templateTooltipCache){templateTooltipCache.style.left="-15000px";togglePulldowns(templateTooltipCache,true);}return ;}getMouse(D);A=lMouseX;y=lMouseY;if(!templateTooltipCache){templateTooltipCache=document.createElement("span");templateTooltipCache.className="graph-tooltip";if(templateTooltipCache){templateTooltipCache.style.left="-15000px";}document.body.appendChild(templateTooltipCache);}templateTooltipCache.innerHTML=E;if(microstrategy.ZOOM_FACTOR){C=microstrategy.ZOOM_FACTOR;}templateTooltipCache.style.fontSize=(C/100)+"em";y-=getObjHeight(templateTooltipCache)-40;moveObjTo(templateTooltipCache,A,y);togglePulldowns(templateTooltipCache,false);}}function getFooterHeight(){var B=document.getElementById("mstrWeb_footer");B=microstrategy.findChildWithAtt(B,"div",(mstr.utils.ISW3C?"class":"className"),"mstrFooter")||B;var A=parseInt(mstr.utils.CSS.getStyleValue(B,"marginTop"));return(B)?mstr.utils.BoxModel.getElementOuterHeight(B)+(isNaN(A)?0:A):0;}function exportReport(D,G,I,B,K,J){if(!J&&I=="buttonFlash"&&bIsIE6&&isFlashMHTFormat()){showMessage({contents:microstrategy.descriptors.getDescriptor("5873"),elements:microstrategy.OK_BUTTON,okEval:"exportReport('"+D+"','"+G+"','"+I+"',"+B+","+K+",true);",type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(!K&&(bIsIE6&&G!="_blank")){submitEmptyForm(G);if(D==null){D="";}window.setTimeout("exportReport('"+D+"','"+G+"','"+I+"',"+B+",true,"+J+");",500);return ;}var L=microstrategy.updateManager.newWindow;var H=microstrategy.updateManager.newWindowName;var C=microstrategy.updateManager.getFormAction();var E=microstrategy.updateManager.getFixStateActions();microstrategy.updateManager.newWindow=true;microstrategy.updateManager.newWindowName=G;microstrategy.updateManager.setFormAction(microstrategy.servletName+"?name="+Date.parse(new Date()));function F(){if(typeof (microstrategy)!="undefined"&&(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)&&microstrategy.IN_OUTLINE_MODE){var N=microstrategy.bone("UniqueReportID");if(N!=null&&N.outlineMode!=null){return N.outlineMode.getExpansionState("UniqueReportID");}}return"";}switch(I){case"export":var A=["3033","3005","3114"],M=["export",B,F()];if(D){A.splice(2,0,"3157");M.splice(2,0,D);}microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EXPORT_REPORT,microstrategy.servletName,A,M,[],[])],true);break;case"printPDF":microstrategy.updateManager.addURL("pdfPrint=1");case"buttonPDF":microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EXPORT_PDF_REPORT,microstrategy.servletName,["3033","3114"],["pdf",F()],[],[])],true);break;case"print":microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.PRINT_REPORT,microstrategy.servletName,["3033"],["print"],[],[])],true);break;case"buttonFlash":microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EXPORT_REDIRECT,microstrategy.servletName,["3153"],[mstrUpdateManager.EXPORT_FLASH_REPORT],[],[])],true);break;}microstrategy.updateManager.flushAndSubmitChanges();microstrategy.updateManager.newWindow=L;microstrategy.updateManager.newWindowName=H;microstrategy.updateManager.setFormAction(C);microstrategy.updateManager.acknowledgeRequest();microstrategy.updateManager.add(E,true);}function isFlashMHTFormat(){return microstrategy.FlashExportFileFormat=="0";}function panelHandler(I,J,K,D,N){var B;var E;var M;var H;var G;var F;E=document.getElementsByName(I+"_Content");function C(O){var P=getObj(O);if(bIsIE4||bIsW3C){return((P.style.visibility=="visible")||(P.style.visibility.length==0));}else{return((document.layers[P.id].visibility=="show")||(document.layers[P.id].visibility.length==0));}}if(E.length>0){F=(C(E.item(0)));}for(H=0;H<E.length;H++){if(F){if(bIsIE4||bIsW3C){E.item(H).style.display="none";E.item(H).style.visibility="hidden";}else{document.layers[E.item(H).id].visibility="hide";}B=document.getElementsByName(I);for(G=0;G<B.length;G++){B.item(G).title=J;}M=document.getElementsByName(I+"_Image");for(G=0;G<M.length;G++){M.item(G).src=K;M.item(G).alt=J;M.item(G).title=J;}}else{if(bIsIE4||bIsW3C){E.item(H).style.display="block";E.item(H).style.visibility="visible";}else{document.layers[E.item(H).id].visibility="show";}B=document.getElementsByName(I);for(G=0;G<B.length;G++){B.item(G).title=D;}M=document.getElementsByName(I+"_Image");for(G=0;G<M.length;G++){M.item(G).src=N;M.item(G).alt=D;M.item(G).title=D;}}}var A=false;try{A=(mstrUpdateManager!=null);}catch(L){}if(E.length>0&&A){if(microstrategy){microstrategy.updateBrowserSetting(I,(F)?"0":"1");}}}function getRecentObjectsMenu(A){if(A){A.innerHTML=(function(){var F="<div class='mstrMenuContent' ty='content'>";var E=microstrategy.handleRecentObjects(),C;var B=Math.min(E.length,10);for(C=0;C<B;C++){var D="";if(mstrConfig.showPreviews){D=(E[C].recoveryInfo.imgData!==undefined)?"data:image/png;base64,"+E[C].recoveryInfo.imgData:"";}if(E[C].lastRecovered!==undefined&&E[C].lastRecovered===true){F+="<span class='mstrMenuItem' style = 'border-bottom: 1px solid #D6D6D6;'><span class='mstrIcon-lv mstrIcon-recover'></span><a class='mstrLink' href="+E[C].recoveryURL+">"+microstrategy.descriptors.getDescriptor("11866").replace("#",E[C].recoveryName)+"</a></span>";}else{F+='<span class="mstrMenuItem mstr-recent-item"><span class="mstrIcon-lv '+E[C].iconClass+'"></span><a class="mstrLink" href="'+E[C].recoveryURL+'">'+E[C].recoveryName+"</a>";if(D!==""){F+='<img class = "img-preview" src = "'+D+'" height="200" width="250" style="zindex: 100; position: absolute;">';}F+="</span>";}}if(B==0){F+="<span class='mstrMenuItem'><a>"+microstrategy.descriptors.getDescriptor("14356")+"</a></span>";}F+="</div>";return F;})();}return A;}function toggleRecentsPopup(B,D,A,C){if(D){itemNodes=D.getElementsByTagName("span");if(itemNodes.length===0){return false;}itemHeight=itemNodes[0].offsetHeight,itemCount=itemNodes.length,makeVisible=isNaN(parseInt(D.style.left,10));if(makeVisible&&!B){D.style.visibility="visible";D.style.left=A+"px";D.style.top=C+"px";}else{D.style.visibility="hidden";D.style.left="";}}}function submitCreateIVELink(A,C){var D=!microstrategy.isFeatureAvailable("flashvi"),B=microstrategy.bones.folderAllModes;if(D&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}if(D&&B&&B.folderId){A.href=replaceURLParameter(A.href,"parentFolderId",B.folderId);}return submitLink(A,C);}function submitCreateRptAndRWDLink(A,C){var B=microstrategy.bones.folderAllModes;if(B&&B.folderId){A.href=replaceURLParameter(A.href,"parentFolderId",B.folderId);}return submitLink(A,C);}function encodeBrowsePathElement(B){if(B){B+="";return B.replace(/~|,|%/g,function A(C){switch(C){case"~":return"%7E";case",":return"%2C";case"%":return"%25";default:return C;}});}return"";}function updateSalesForceLogoutIframe(C){var B="logoutSalesForce";var A=document.getElementById(B);if(!A){A=document.createElement("IFRAME");A.id=B;document.body.appendChild(A);A.style.display="none";}A.src=C;}function rrISIE7(){return mstr.utils.ISIE7;}function removeCssClass(E,D){if(!E){return ;}if(D.constructor!==Array){D=[D];}var B=" "+(E.className||"")+" ";for(var C=0,A=D.length;C<A;C++){B=B.replace(new RegExp("\\s"+D[C]+"\\s","g")," ");}E.className=trimString(B);}function addCssClass(F,E){if(!F){return ;}if(E.constructor!==Array){E=[E];}var B=F.className||"",H=" "+B+" ",C=false;for(var D=0,A=E.length;D<A;D++){var G=E[D];if(!H.match(new RegExp("\\s"+G+"\\s"))){B+=" "+G;C=true;}}if(C){F.className=trimString(B);}}function trimString(A){return(A&&A.replace)?A.replace(/^\s+/,"").replace(/\s+$/,""):A;}function getResourcePathWithVersion(A){return A+((window.mstrConfig&&mstrConfig.webVersion)?"?v="+mstrConfig.webVersion:"");}var mstrInterfacePlugin={init:function(){var E=document.getElementById("mstrStarburst"),C=microstrategy.servletName,B;if(E){E.title="";var A=document.getElementById("mstrLogo");logoMenu=document.getElementById("mstrLogoMenu");if(A){A.title="";}if(microstrategy.hasSession&&!mstrApp.isAdminPage&&E.getAttribute("_isstatic")!="true"){B=E.href;E.setAttribute("_href",B);var D=microstrategy.menuHover?"mouseover":"click";if(logoMenu){logoMenu["on"+D]=microstrategy.showShortcutsList;}}}}};var iframe=new function(){};iframe.prototype=new Object();iframe.aboutBlankRestricted=null;iframe.checkAboutBlankRestricted=function(){if(bIsIE4&&iframe.aboutBlankRestricted==null){iframe.aboutBlankRestricted=true;var A=document.createElement("div");A.innerHTML="<div onclick='iframe.aboutBlankRestricted = false; return false;'>&nbsp;</div>";document.body.appendChild(A);A.firstChild.click();document.body.removeChild(A);}};iframe.isPromptedReport=false;var hasLoaded=false;iframe.isTreeProcessing=false;iframe.isAborting=false;iframe.windowTimer=null;iframe.waitCurtain=null;iframe.isProcessing=false;iframe.consolidatedStyles={};iframe.onWaitState=false;iframe.notifyParent=function(C){if(self.supressWaitPage){return ;}iframe.showWaitCurtain();var B=0,A=true;if(window.microstrategy){B=parseInt(window.microstrategy.waitPageDelay);if(isNaN(B)||B<0){B=0;}A=window.microstrategy.showWaitPopup;}if(A){if(B==0){iframe.showWaitPage(false,true);}else{if(B!=-1){iframe.windowTimer=window.setTimeout("iframe.showWaitPage(false, true)",B);}}}if(window.microstrategy){window.microstrategy.showWaitPopup=true;}if(!C){if(!window.isUnloading){window.setTimeout("iframe.checkChildStatus()",3000);}else{if(bIsIE4||bIsChrome){if(!iframe.isProcessing&&!window.mstrSubmitLink){window.setTimeout("if (typeof(iframe)!= 'undefined' && typeof(iframe.hideWaitPage) != 'undefined') iframe.hideWaitPage();",0);}}}}};iframe.stopWindow=function(){iframe.isAborting=true;if(window.event){window.event.cancelBubble=true;}if(window.frameManager&&window.frameManager.document){window.frameManager.document.execCommand("Stop");}document.execCommand("Stop");if(microstrategy.updateManager){microstrategy.updateManager.acknowledgeRequest();}iframe.hideWaitPage();};function reloadPreviousPage(){if(hasLoaded){var A=window.document.open("text/html");A.close();window.history.go(-1);}}iframe.checkChildStatus=function(){if(!iframe.isAborting){try{if(window.frameManager&&window.frameManager.document&&window.frameManager.document.readyState=="complete"&&window.document.readyState=="complete"){if(!window.frameManager.isIframe){var C=window.frameManager.document.documentElement.innerHTML;var A=window.document.open("text/html");if(C.indexOf("<!DOCTYPE")==-1){A.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}A.write(C);A.close();}if(!iframe.isProcessing){window.setTimeout("if (typeof(iframe)!= 'undefined' && typeof(iframe.hideWaitPage) != 'undefined') iframe.hideWaitPage();",1000);}}else{window.setTimeout("if (typeof(iframe)!= 'undefined') iframe.checkChildStatus()",3000);}}catch(B){iframe.hideWaitPage();}}else{if(window.frameManager&&window.frameManager.document&&window.frameManager.document.readyState=="complete"){if(!window.frameManager.isIframe&&!window.frameManager.document.body.onbeforeunload){window.frameManager.document.body.onbeforeunload=new Function("window.parent.iframe.notifyParent();");}}}};iframe.showWaitCurtain=function(){if(self.supressWaitPage){return ;}iframe.onWaitState=true;if(iframe.waitCurtain==null){var A=document.getElementById("mstrWeb_waitCurtain");if(!A){A=document.createElement("div");A.className="divWaitCurtain";A.appendChild(document.createTextNode(" "));document.body.appendChild(A);}A.onmousedown=new Function('if (typeof(window.event) != "undefined") {window.event.cancelBubble = true; } return false;');A.ondblclick=new Function('if (typeof(window.event) != "undefined") { window.event.cancelBubble = true; } return false;');iframe.waitCurtain=A;}if(!bIsW3C){enablePulldowns(document.body,false);}iframe.waitCurtain.style.display="block";};iframe.showWaitPage=function(B,A){if(self.supressWaitPage){return ;}iframe.isProcessing=false;if(currentPin==-1){if(A){hasLoaded=true;}var C=microstrategy.bone("divWaitBox");if(C&&C.elem){C.elem.style.display="block";C.elem.style.zIndex=9999;if(!bIsW3C){togglePulldowns(C.elem,false);}C.elem.style.visibility="visible";if(bIsIE7){window.setTimeout(function(){var D=C.elem.innerHTML+" ";C.elem.innerHTML="";window.setTimeout(function(){C.elem.innerHTML=D;},0);},1000);}if(B===true){iframe.showWaitCurtain();}}iframe.isAborting=false;}};iframe.hideWaitPage=function(C){window.clearTimeout(iframe.windowTimer);var A=document.getElementById("divWaitBox");if(A&&A.style.visibility=="visible"){var B=microstrategy.bone("divWaitBox");B&&B.closeDialog();if(bIsSafari){window.setTimeout(function(){A.style.display="none";},100);}else{A.style.display="none";}}if(typeof (C)=="undefined"){C=true;}if(C){iframe.hideWaitCurtain();}};iframe.hideWaitCurtain=function(){iframe.waitCurtain=iframe.waitCurtain||document.getElementById("mstrWeb_waitCurtain");if(iframe.waitCurtain){if(bIsSafari){window.setTimeout(function(){iframe.waitCurtain.style.display="none";},100);}else{iframe.waitCurtain.style.display="none";}if(!bIsW3C){enablePulldowns(document.body,true);}}iframe.onWaitState=false;};iframe.clearIFrameParents=function(A){var C=A,B=null;while((B=C.parentNode)!=null){if(B.tagName=="DIV"&&B.getAttribute("IFRAME")=="true"){B.setAttribute("IFRAME","false",0);}C=B;}};iframe.replaceComponents=function(C,B){if(B!=C&&!iframe.isAborting){this.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(C.document.body,false);}var L=B.document.getElementsByTagName("div"),D=B.document.getElementsByTagName("form"),H=B.document.getElementsByTagName("comment"),K=null,G,E,M,J,A;for(G=0,len=H.length;G<len;G++){if(H[G].getAttribute("IFRAME")=="true"){if(window.document.getElementById(H[G].id)){iframe.clearIFrameParents(H[G]);}else{if(H[G].getAttribute("dialog")!="true"&&!H[G].getAttribute("css")){H[G].setAttribute("IFRAME","false",0);}}}}for(G=0,len=L.length;G<len;G++){if(L[G].getAttribute("IFRAME")=="true"){if(window.document.getElementById(L[G].id)){iframe.clearIFrameParents(L[G]);}else{L[G].setAttribute("IFRAME","false",0);}}}for(G=0,len=H.length;G<len;G++){if((H[G].getAttribute("IFRAME")=="true")&&(H[G].getAttribute("ISEMPTY")!="true")){if(typeof H[G].text!="undefined"){E=H[G].text;}else{E=H[G].innerHTML;}var F=E.indexOf("<");var N=E.lastIndexOf(">");E=E.substr(F,N+1-F);E=E.substring(4,E.length-3);E=E.replace(/'/g,"'");C.iframe.updateComponent(H[G].getAttribute("ID"),E,H[G],true);}}for(G=0,len=L.length;G<len;G++){if(L[G].getAttribute("IFRAME")=="true"&&L[G].getAttribute("ISEMPTY")!="true"){if(L[G].getAttribute("errBox")!="true"||currentModalEditor.length==0){E=iframe.getOuterHTML(L[G]);E=E.replace(/'/g,"'");A=L[G].getAttribute("ID");C.iframe.updateComponent(A,E);}else{E=L[G].innerHTML;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}document.title=window.frameManager.pageTitle;for(var I in this.consolidatedStyles){updateStyleContainer(this.consolidatedStyles[I],I);}if(!bIsW3C){iframe.togglePulldownChildren(C.document.body,true);}if(iframe.isTreeProcessing){removeTreeWaitMessage();}microstrategy.loadDynamicJS();microstrategy.registerNewBones();}};iframe.togglePulldownChildren=function(F,C){try{var E=F.getElementsByTagName("select");if(E.length){if(C){for(var D=0,B=E.length;D<B;D++){var A=E[D].getAttribute("hd");if(A==null||A.length==0){E[D].style.visibility="visible";}}}else{for(var D=0,B=E.length;D<B;D++){E[D].style.visibility="hidden";}}}}catch(G){}};iframe.createPlaceHolder=function(A){var B=document.createElement("div");B.id=A;document.body.appendChild(B);};iframe.extractScript=function(E,C){var D=E.getElementsByTagName("SCRIPT");if((D)&&(D.length>0)){for(var B=0;B<D.length;B++){if(D[B].getAttribute("language")!="VBSCRIPT"&&(D[B].getAttribute("id")==""||D[B].getAttribute("id")==null)){var A=trim(D[B].innerHTML);if(A.indexOf("<!--")==0){A=A.substring(4,A.length-3);}C.push(A);}}}};iframe.extractImage=function(D,C){if(!bIsW3C){var B=D.getElementsByTagName("IMG");if(B&&(B.length>0)){for(var A=0;A<B.length;A++){if(B[A].getAttribute("dsrc")!=null){C.push(B[A]);}}}B=D.getElementsByTagName("INPUT");if(B&&(B.length>0)){for(var A=0;A<B.length;A++){if(B[A].getAttribute("dsrc")!=null){C.push(B[A]);}}}}};iframe.updateComponent=function(sComponentID,sNewHTML,iframeNode,shouldCreatePlaceHolder){var aScripts=null,oParentDivs,oParentDiv;if(iframeNode&&iframeNode.getAttribute("slid")){var slices=document.getElementsByName(sComponentID);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==iframeNode.getAttribute("slid")){oParentDiv=slices[i];break;}}}}if(!oParentDiv){oParentDivs=document.getElementById(sComponentID);if(!oParentDivs&&shouldCreatePlaceHolder){this.createPlaceHolder(sComponentID);oParentDivs=document.getElementById(sComponentID);}if(oParentDivs){if(oParentDivs.length>1){for(i=0,len=oParentDivs.length;i<len;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=sNewHTML.replace(/\r\n/g,"");var oDivNode=iframe.createElementFromHTML(sReplaceHTML);var scriptArray=[];iframe.extractScript(oDivNode,scriptArray);var chartArray=[];iframe.extractImage(oDivNode,chartArray);if(oDivNode.getAttribute("message")=="true"){showMessage({contents:sNewHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}if(oDivNode.getAttribute("css")=="1"){var styleId=oDivNode.getAttribute("styleid");if(!this.consolidatedStyles[styleId]){this.consolidatedStyles[styleId]=[];}this.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,this.consolidatedStyles[styleId],oDivNode.getAttribute("styleid"));}else{var commentsIdx=sReplaceHTML.indexOf("<comment ");if(commentsIdx>-1){return ;}if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(oDivNode.getAttribute("partialUpdate")&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){var p=oParentDiv.parentNode;p.insertBefore(oDivNode,oParentDiv);p.removeChild(oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var j=0,len=scriptArray.length;j<len;j++){eval(scriptArray[j].toString());}}}};iframe.createElementFromHTML=function(B){var A=document.createElement("div");if(this.aboutBlankRestricted==null){this.checkAboutBlankRestricted();}if(this.aboutBlankRestricted){document.body.appendChild(A);}A.innerHTML=B;iframe.adjustNode(A);if(this.aboutBlankRestricted){document.body.removeChild(A);}return A.firstChild;};iframe.adjustNode=function(A){if(bIsW3C&&A.childNodes.length>1){iframe.adjustNodes(A);if(microstrategy.pageName=="document"){iframe.adjustNodesForHTMLDocument(A);}}};iframe.getOuterHTML=function(A){return(typeof A.outerHTML!="undefined")?A.outerHTML:iframe.getManualOuterHTML(A);};iframe.getManualOuterHTML=function(F){var B="<"+F.tagName;var D=F.attributes;for(var E=0,A=D.length;E<A;E++){var C=D[E];if(C.specified&&C.nodeName!="_moz-userdefined"){B+=" "+C.nodeName+'="'+C.nodeValue+'"';}}B+=">"+F.innerHTML+"</"+F.tagName+">";return B;};iframe.adjustNodes=function(C){var B=C.childNodes;var F=C.lastChild;var D=B.length;for(var A=0;A<D;A++){var E=B[0];if(E.tagName.toLowerCase()=="script"){F.appendChild(E);}else{if(E.tagName.toLowerCase()=="style"){F.insertBefore(E,F.firstChild);}else{if(E.tagName.toLowerCase()=="link"){F.insertBefore(E,F.firstChild);}}}}};iframe.adjustNodesForHTMLDocument=function(C){var B=C.childNodes;var F=C.firstChild;var D=B.length;for(var A=1;A<D;A++){var E=B[1];F.appendChild(E);}};iframe.setOuterHTML=function(E,F){var C=E.attributes;for(var D=C.length-1;D>-1;D--){var B=C[D];if(B.specified){E.removeAttribute(B.nodeName);}}C=F.attributes;for(var D=0,A=C.length;D<A;D++){var B=C[D];if(B.specified&&B.nodeName!="_moz-userdefined"){E.setAttribute(B.nodeName,B.value);}}E.style.cssText=F.style.cssText;if(E.innerHTML.length==0&&F.innerHTML.length==0){return ;}E.innerHTML=F.innerHTML;};if(typeof (microstrategy)=="undefined"){self.microstrategy=new function(){};}microstrategy.prototype={};microstrategy.OBJTYPE_ATTRIBUTE="ATTR";microstrategy.OBJTYPE_METRIC="MV";microstrategy.OBJTYPE_OBJBROWSER="obbr";microstrategy.OBJTYPE_EDITOR="edt";microstrategy.OBJTYPE_GRAPH_ZONES="gzn";microstrategy.OBJTYPE_RW_PAGE="RWPA";microstrategy.OBJTYPE_RW_TEXTFIELD="TEXT";microstrategy.OBJTYPE_DOC="docu";microstrategy.OBJTYPE_DOC_OBJECT="obj";microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER="subscon";microstrategy.OBJTYPE_DOC_SUBSECTION="4";microstrategy.OBJTYPE_DOC_SECTION="dsec";microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER="hcont";microstrategy.OBJTYPE_DOC_PARENT_HORIZONTAL_CONTAINER="parenthcont";microstrategy.OBJTYPE_DOC_SELECTION="dsel";microstrategy.OBJTYPE_RW_HILITES="RWHI";microstrategy.OBJTYPE_RW_HANDLES="RWHA";microstrategy.OBJTYPE_RW_LASSO="RWLA";microstrategy.OBJTYPE_DOCKZONE="dock";microstrategy.OBJTYPE_TOOLBAR="tool";microstrategy.OBJTYPE_FOLDER="f";microstrategy.OBJTYPE_ATTRIBUTE="a";microstrategy.OBJTYPE_ELEMENT="e";microstrategy.OBJTYPE_GRID="g";microstrategy.OBJTYPE_GRAPH="gp";microstrategy.OBJTYPE_BTN_GROUP="btng";microstrategy.OBJTYPE_PAGE_BY="pgby";microstrategy.OBJTYPE_PAGE_BY_ELEM="pbel";microstrategy.OBJTYPE_FAKED_PAGE_BY_ELEM="fkpbel";microstrategy.OBJTYPE_FILTER_EDITOR="filt";microstrategy.OBJTYPE_RULER="rul";microstrategy.OBJTYPE_MASK="mask";microstrategy.OBJTYPE_MASK_MAP="mama";microstrategy.OBJTYPE_MASK_MAP_AREA="mmar";microstrategy.OBJTYPE_ANY="*";microstrategy.OBJTYPE_FORMULA_BAR="fmla";microstrategy.OBJTYPE_TAB="tab";microstrategy.OBJTYPE_TAB_SET="tset";microstrategy.OBJTYPE_INC_FETCH_PANE="incf";microstrategy.OBJTYPE_INC_FETCH="if";microstrategy.OBJTYPE_OBJECT_COUNT="objCount";microstrategy.OBJTYPE_EDITOR="edt";microstrategy.OBJTYPE_CONTEXT_MENU="cxt";microstrategy.OBJTYPE_MESSAGE_BOX="mbx";microstrategy.OBJTYPE_DSEL_MOVE_RECS="mrec";microstrategy.OBJTYPE_FLOATING_TOOLBAR="ftb";microstrategy.OBJTYPE_SECURITY_FILTER="sf";microstrategy.OBJTYPE_FIRST_CLASS_OBJECT="fco";microstrategy.OBJTYPE_XDA_DATA_ELEMENT="xdae";microstrategy.OBJTYPE_PANEL_STACK="pnls";microstrategy.OBJTYPE_SCROLLER_HANDLE="schn";microstrategy.OBJTYPE_SCROLLER_CONTAINER="sctb";microstrategy.OBJTYPE_SCROLLER_CONTAINER_GHOST="sctbgh";microstrategy.OBJTYPE_SCROLLER_TRACK="sctrk";microstrategy.OBJTYPE_RW_CONTROL="RWCTL";microstrategy.ORIENTATION_HORIZONTAL=0;microstrategy.ORIENTATION_VERTICAL=1;microstrategy.GRIDCELL_ORIENTATION_VERTICAL="V";microstrategy.GRIDCELL_ORIENTATION_HORIZONTAL="H";microstrategy.GRIDCELL_AXIS_METRICS=-1;microstrategy.GRIDCELL_AXIS_ATT_FORMS=0;microstrategy.GRIDCELL_AXIS_ROWS=1;microstrategy.GRIDCELL_AXIS_COLUMNS=2;microstrategy.GRIDCELL_AXIS_PAGE_BY=3;microstrategy.GRID_EFFECTIVE_VIEW_GRID=0;microstrategy.GRID_EFFECTIVE_VIEW_GRAPH=1;microstrategy.GRID_EFFECTIVE_VIEW_GRID_GRAPH=2;microstrategy.SUBOBJTYPE_TITLEBAR="titl";microstrategy.SUBOBJTYPE_STATUSBAR="stat";microstrategy.SUBOBJTYPE_TOOLBAR="tool";microstrategy.SUBOBJTYPE_TOOLBAR_HANDLE="toha";microstrategy.SUBOBJTYPE_GRID_TABLE="tabl";microstrategy.SUBOBJTYPE_TREE="tree";microstrategy.SUBOBJTYPE_TREE_VIEW="treeView";microstrategy.SUBOBJTYPE_BODY="body";microstrategy.SUBOBJTYPE_SECTION_HANDLE="shan";microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE="sshan";microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER="107";microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR="ctitl";microstrategy.SUBOBJTYPE_DOC_TEXT="106";microstrategy.SUBOBJTYPE_DOC_IMAGE="102";microstrategy.SUBOBJTYPE_DOC_LINE="105";microstrategy.SUBOBJTYPE_DOC_SHAPE="101";microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND="112";microstrategy.SUBOBJTYPE_DOC_TEMPLATE="52";microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|R";microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRID;microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRAPH;microstrategy.SUBOBJTYPE_DOC_GRID_GRAPH_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRID_GRAPH;microstrategy.GRAPH_CTL="52G";microstrategy.SUBOBJTYPE_DOC_PANEL_STACK="8";microstrategy.SUBOBJTYPE_DOC_PANEL="9";microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL="111";microstrategy.SUBOBJTYPE_DOC_WIDGET="113";microstrategy.SUBOBJTYPE_SEL_HANDLE="shan";microstrategy.SUBOBJTYPE_FOLDER_LIST="folderList";microstrategy.SUBOBJTYPE_FOLDER_UP="folderUp";microstrategy.SUBOBJTYPE_FILE_SEARCH="fileSearch";microstrategy.SUBOBJTYPE_FILE_LIST="fileList";microstrategy.SUBOBJTYPE_BTN="btn";microstrategy.SUBOBJTYPE_BTN_HANDLE="btnh";microstrategy.SUBOBJTYPE_VRULER="vRul";microstrategy.SUBOBJTYPE_VRULER_SHADE="vRulS";microstrategy.SUBOBJTYPE_HRULER="hRul";microstrategy.SUBOBJTYPE_HRULER_SHADE="hRulS";microstrategy.SUBOBJTYPE_TAB_CONTAINER="tabCont";microstrategy.SUBOBJTYPE_TAB_SAMPLE="sample";microstrategy.SUBOBJTYPE_TAB_SECTION="tabSection";microstrategy.SUBOBJTYPE_FORMULA_BAR_AREA="fmlaArea";microstrategy.SUBOBJTYPE_FORMULA_BAR_TEXT_AREA="fmlaTextArea";microstrategy.SUBOBJTYPE_RESIZE_VLINE="vline";microstrategy.SUBOBJTYPE_RESIZE_HLINE="hline";microstrategy.SUBOBJTYPE_ATTRIBUTE="ATT";microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM="ATTFORM";microstrategy.SUBOBJTYPE_METRIC="MV";microstrategy.SUBOBJTYPE_IMG="cimg";microstrategy.SUBOBJTYPE_PREVIEW_PANE="prv";microstrategy.SUBOBJTYPE_OUTLINE_MODE_IMG="outimg";microstrategy.SUBOBJTYPE_PANEL_CONTAINER="pc";microstrategy.SUBOBJTYPE_WINDOW_BUTTON="wBtn";microstrategy.SUBOBJTYPE_RA_BTN="raBtn";microstrategy.SUBOBJTYPE_SLIDER="slider";microstrategy.SUBOBJTYPE_ESRIMAP="esrimap";microstrategy.SUBOBJTYPE_GMAP="gmap";microstrategy.DSSTYPE_TEMPLATE="2";microstrategy.DSSTYPE_RPT_DEFINITION="3";microstrategy.DSSTYPE_DOC_DEFINITION="55";microstrategy.DSSTYPE_FOLDER="8";microstrategy.DSSTYPE_CONSOLIDATION_ELEMENT="48";microstrategy.DSSTYPE_METRIC="4";microstrategy.DSSTYPE_USER_METRIC="100";microstrategy.DSSTYPE_USER_SUMMARY_METRIC="101";microstrategy.DSSTYPE_ATTRIBUTE="12";microstrategy.DSSTYPE_ATTRIBUTE_FORM="21";microstrategy.DSSTYPE_FILTER="1";microstrategy.DSSTYPE_PROMPT="10";microstrategy.DSSTYPE_CONSOLIDATION="47";microstrategy.DSSTYPE_CUSTOM_GROUP="257";microstrategy.DSSTYPE_DIMENSION="14";microstrategy.DSSTYPE_GRID="768";microstrategy.DSSTYPE_GRAPH="769";microstrategy.DSSTYPE_GRID_AND_GRAPH="774";microstrategy.DSSTYPE_REPORT_CUBE="776";microstrategy.DSSTYPE_HIERARCHY="14";microstrategy.DSSTYPE_SHORTCUT="18";microstrategy.DISPUNITTYPE_ELEMENT="1048576";microstrategy.DSSSUB_TYPE_FILTER="256";microstrategy.DSSSUB_TYPE_RW="14081";microstrategy.DSSSUB_TYPE_PROMPT=2560;microstrategy.DSSSUB_TYPE_PROMPT_BOOLEAN=2561;microstrategy.DSSSUB_TYPE_PROMPT_LONG=2562;microstrategy.DSSSUB_TYPE_PROMPT_STRING=2563;microstrategy.DSSSUB_TYPE_PROMPT_DOUBLE=2564;microstrategy.DSSSUB_TYPE_PROMPT_DATE=2565;microstrategy.DSSSUB_TYPE_PROMPT_BIG_DECIMAL=2571;microstrategy.DSSSUB_TYPE_PROMPT_OBJECTS=2566;microstrategy.DSSSUB_TYPE_PROMPT_ELEMENTS=2567;microstrategy.DSSSUB_TYPE_PROMPT_EXPRESSION=2568;microstrategy.DSSSUB_TYPE_PROMPT_DIMPTY=2570;microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE=3077;microstrategy.HTMLATTR_SCRIPTCLASS="scriptclass";microstrategy.HTMLATTR_ID="id";microstrategy.HTMLATTR_OBJTYPE="ty";microstrategy.HTMLATTR_DSSTYPE="dss_ty";microstrategy.HTMLATTR_DISPLAY_NAME="ds";microstrategy.HTMLATTR_SUBOBJTYPE="sty";microstrategy.HTMLATTR_STYLE="styst";microstrategy.HTMLATTR_OBJINDEX="ind";microstrategy.HTMLATTR_DISPUNITTYPE="dty";microstrategy.HTMLATTR_DISPLAY_NAME="ds";microstrategy.HTMLATTR_ORIENTATION="or";microstrategy.HTMLATTR_ORIENTATIONS_SUPPORTED="ors";microstrategy.HTMLATTR_GRIDCELL_AXIS="ax";microstrategy.HTMLATTR_GRIDCELL_DEPTH="dpt";microstrategy.HTMLATTR_GRIDCELL_ID="i";microstrategy.HTMLATTR_GRIDCELL_ORDINAL="o";microstrategy.HTMLATTR_GRIDROW_ORDINAL="o";microstrategy.HTMLATTR_GRIDROW_MAX_DEPTH="mx";microstrategy.HTMLATTR_GRIDROW_LEVEL="level";microstrategy.HTMLATTR_GRIDCELL_ATTR_COL_TITLE_MISSING="ctm";microstrategy.HTMLATTR_CMD_ID="cmdid";microstrategy.HTMLATTR_CMD_TYPE="cmdtp";microstrategy.HTMLATTR_CMD_VALUE="cmdvl";microstrategy.HTMLATTR_CMD_FORMAT_TYPE="cmdft";microstrategy.HTMLATTR_CMD_PICKER="cmdpk";microstrategy.HTMLATTR_CMD_PROP="cmdprop";microstrategy.HTMLATTR_CMD_LEVEL="cmdlvl";microstrategy.HTMLATTR_DYN_TITLE="dynTT";microstrategy.HTMLATTR_COLOR="color";microstrategy.HTMLATTR_FILTER_VALUE="ftv";microstrategy.HTMLATTR_FILTER_TYPE="ftt";microstrategy.HTMLATTR_FILTER_COMPARISON="ftc";microstrategy.HTMLATTR_FILTER_COMPARISON_DEFAULT="0";microstrategy.HTMLATTR_FILTER_COMPARISON_BINARY="1";microstrategy.HTMLATTR_DSS_ID="oid";microstrategy.HTMLATTR_DSS_FORMULA="frma";microstrategy.HTMLATTR_DSS_TYPE="oty";microstrategy.HTMLATTR_DERIVED_METRIC="dr";microstrategy.HTMLATTR_PASS_THROUGH_METRIC="pthr";microstrategy.HTMLATTR_HAS_DERIVED_ELEMENTS="hde";microstrategy.HTMLATTR_DSS_SUBTYPE="ost";microstrategy.HTMLATTR_DSS_SET="ods";microstrategy.HTMLATTR_DSS_DESCRIPTION="otd";microstrategy.HTMLATTR_POINTS_TO="pt";microstrategy.HTMLATTR_TARGET="tg";microstrategy.HTMLATTR_DND_SOURCE="dg";microstrategy.HTMLATTR_DO_COND_FORMAT="cf";microstrategy.HTMLATTR_HEIGHT_MODE="hm";microstrategy.HTMLATTR_HEIGHT="ht";microstrategy.HTMLATTR_WIDTH_MODE="wm";microstrategy.HTMLATTR_WIDTH="wd";microstrategy.HTMLATTR_VISIBLE="visible";microstrategy.HTMLATTR_OLD_HEIGHT="oldht";microstrategy.HTMLATTR_OLD_WIDTH="oldwd";microstrategy.HTMLATTR_OLD_TOP="oldtop";microstrategy.HTMLATTR_OLD_LEFT="oldleft";microstrategy.HTMLATTR_HAS_CONDITIONAL_FORMATTING="hcf";microstrategy.HTMLATTR_VISIBLE_HTML_VIEW_MODE="shvm";microstrategy.HTMLATTR_CAN_GROW="cg";microstrategy.HTMLATTR_CAN_SHRINK="cs";microstrategy.HTMLATTR_MAX_HEIGHT="mh";microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL="cgh";microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL="csh";microstrategy.HTMLATTR_MAX_WIDTH="mw";microstrategy.HTMLATTR_IS_HORIZONTAL="hz";microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL="bhz";microstrategy.HTMLATTR_IS_END_HORIZONTAL="ehz";microstrategy.HTMLATTR_HIDE_IF_EMPTY="he";microstrategy.HTMLATTR_REPEAT_SECTION="rpts";microstrategy.HTMLATTR_FIT_EXCEL_ROW_HEIGHT="ferh";microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER="kst";microstrategy.HTMLATTR_REPEAT_HORIZONTALLY="rpth";microstrategy.HTMLATTR_FORCE_NEW_PAGE="fnp";microstrategy.HTMLATTR_AUTO_RESIZE_IN_DESIGNMODE="ard";microstrategy.HTMLATTR_HTML_TYPE="htype";microstrategy.HTMLATTR_HTML_SOURCE="hsrc";microstrategy.HTMLATTR_HTML_TEXT="htxt";microstrategy.HTMLATTR_IS_LINK="isl";microstrategy.HTMLATTR_ROUNDED_CORNERS="rc";microstrategy.HTMLATTR_DROP_SHADOW="dsw";microstrategy.HTMLATTR_DROP_SHADOW_EFFECT="dse";microstrategy.HTMLATTR_RADIUS="rd";microstrategy.HTMLATTR_TOP_CORNERS_ONLY="tco";microstrategy.HTMLATTR_BOTTOMLEFT_CORNER_RADIUS="blcr";microstrategy.HTMLATTR_TOPLEFT_CORNER_RADIUS="tlcr";microstrategy.HTMLATTR_ALPHA="alpo";microstrategy.HTMLATTR_ALPHA_EFFECT="alpe";microstrategy.HTMLATTR_LOCK_ASPECT_RATIO="lar";microstrategy.HTMLATTR_NEW_WINDOW="nw";microstrategy.HTMLATTR_IMAGE_SOURCE="imgsrc";microstrategy.HTMLATTR_LINK_HREF="href";microstrategy.HTMLATTR_LINK_HREFVALUE="hv";microstrategy.HTMLATTR_APPLIES_TO="at";microstrategy.HTMLATTR_GRID_AREA_PCT="gap";microstrategy.HTMLATTR_DISPLAY_MODE="dm";microstrategy.HTMLATTR_GRID_POS="gpos";microstrategy.HTMLATTR_RESIZE="rsz";microstrategy.HTMLATTR_PRIMEDATAID="pDataId";microstrategy.HTMLATTR_DETAILS_SECTION="dt";microstrategy.HTMLATTR_NUMBER_FORMAT_DECIMAL_PLACES="ndp";microstrategy.HTMLATTR_NUMBER_FORMAT_CATEGORY="nct";microstrategy.HTMLATTR_NUMBER_FORMAT_NEGATIVE_NUMBERS="nnn";microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_SYMBOL="ncs";microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_POSITION="ncp";microstrategy.HTMLATTR_NUMBER_FORMAT_THOUSAND_SEPARATOR="nth";microstrategy.HTMLATTR_NUMBER_FORMAT_STRING="nfs";microstrategy.HTMLATTR_FORM_POS="FRMPOS";microstrategy.HTMLATTR_FORM_ID="FRMID";microstrategy.HTMLATTR_FORM_NAME="FRMNAME";microstrategy.HTMLATTR_FORM_LIST="FRMLIST";microstrategy.HTMLATTR_SECTION_ID="sct";microstrategy.HTMLATTR_DTOP="dtp";microstrategy.HTMLATTR_DWIDTH="dwh";microstrategy.HTMLATTR_DHEIGHT="dht";microstrategy.HTMLATTR_DLEFT="dlf";microstrategy.HTMLATTR_ATTRIBUTE_ID="atid";microstrategy.HTMLATTR_PARENT_ID="pid";microstrategy.HTMLATTR_DESCRIPTION="ds";microstrategy.HTMLATTR_NAME="nm";microstrategy.HTMLATTR_ACL="acl";microstrategy.HTMLATTR_BORDER="br";microstrategy.HTMLATTR_PAGE_BREAK="pbs";microstrategy.HTMLATTR_SHOW_REPEAT_SECTION="rps";microstrategy.HTMLATTR_IS_LOCKED="ilk";microstrategy.HTMLATTR_TOOLTIP_FORMULA="tt";microstrategy.HTMLATTR_SHOW_WINDOW_TITLE="swt";microstrategy.HTMLATTR_WIDGET_SHOW_WINDOW_TITLE="swwt";microstrategy.HTMLATTR_WINDOW_STATE="ws";microstrategy.HTMLATTR_WINDOW_LAST_STATE="wls";microstrategy.HTMLATTR_WINDOW_TITLE="wt";microstrategy.HTMLATTR_TITLE_BAR_DISPLAY="tbd";microstrategy.HTMLATTR_SECTION_NAME="sn";microstrategy.HTMLATTR_QUICK_SWITCH="qs";microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW="uaiw";microstrategy.HTMLATTR_RESET_TO_FIRST_PANEL_WHEN_TARGETED="rtfp";microstrategy.HTMLATTR_HORIZONTAL_SWIPE_CHANGE="ehstc";microstrategy.HTMLATTR_STYLE_FOR_SWIPE_PANEL="sfwp";microstrategy.HTMLATTR_USE_AS_FILTER_PANEL="uafp";microstrategy.HTMLATTR_USE_AS_MASTER_PANEL="uamp";microstrategy.HTMLATTR_CTL_AUTO_SUBMIT="cas";microstrategy.HTMLATTR_CTL_SEARCH_ON_SERVER="sos";microstrategy.HTMLATTR_CTL_NO_SELECTION_BEHAVIOR="nsb";microstrategy.HTMLATTR_CTL_MAX_SELECTION_COUNT="masc";microstrategy.HTMLATTR_CTL_MIN_SELECTION_COUNT="misc";microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT="sec";microstrategy.HTMLATTR_LINK_TO="lnk";microstrategy.HTMLATTR_INFO_WIN_PLACEMENT="iwpl";microstrategy.HTMLATTR_EXPORT_OPTION="seo";microstrategy.HTMLATTR_SET_BADGE_TO_VALUE_ON_FIELD="sbtvof";microstrategy.HTMLATTR_INFO_WIN_MODE="iwm";microstrategy.HTMLATTR_INFO_WIN_POSITION="iwp";microstrategy.HTMLATTR_TAB_CLOSE_TO_DISMISS_INFOWIN="tctdiw";microstrategy.HTMLATTR_IOS_COPY_MODE="mcm";microstrategy.HTMLATTR_RA_LEVEL="lvl";microstrategy.HTMLATTR_RA_EXPAND="expd";microstrategy.HTMLATTR_RA_COLLAPSE_TIME="ct";microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL="uatc";microstrategy.HTMLATTR_TABLE_CONTROL_DEFINITION="tcd";microstrategy.FORMAT_TYPE_TABLE_BASE=2;microstrategy.FORMAT_TYPE_TABLE_GROUP=microstrategy.FORMAT_TYPE_TABLE_BASE;microstrategy.FORMAT_TYPE_TABLE_CELL=microstrategy.FORMAT_TYPE_TABLE_BASE+1;microstrategy.BUTTON_CTL="106B";microstrategy.HTMLATTR_DISPLAY_STYLE="dpst";microstrategy.HTMLATTR_NORMAL_URL="nmurl";microstrategy.HTMLATTR_HIGHLIGHT_URL="hlurl";microstrategy.HTMLATTR_FONT_HIGHLIGHT_COLOR="fhlc";microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR="bhlc";microstrategy.HTMLATTR_FILL_EFFECT="fe";microstrategy.BUTTON_STYLE_NOT_BUTTON=0;microstrategy.BUTTON_STYLE_CAPTION_ONLY=1;microstrategy.BUTTON_STYLE_ICON_ONLY=2;microstrategy.BUTTON_STYLE_ICON_LEFT=3;microstrategy.BUTTON_STYLE_ICON_RIGHT=4;microstrategy.BUTTON_STYLE_ICON_TOP=5;microstrategy.BUTTON_STYLE_CUSTOM=6;microstrategy.HTMLATTR_EFFECT_FLAT=0;microstrategy.HTMLATTR_EFFECT_GLOSSY=1;microstrategy.BUTTON_STYLE_CSS_SUFFIXES=[,"captionOnly","iconOnly","iconLeft","iconRight","iconTop","custom"];microstrategy.PROPERTIES_EDITOR_BUTTON_TAB=8;microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR="uanb";microstrategy.CONTROLSUBTYPE_NAVIGATION_BAR="NB";microstrategy.HTMLATTR_BORDER_3D_STYLE="b3dstyle";microstrategy.HTMLATTR_BORDER_3D_WEIGHT="b3dweight";microstrategy.HTMLATTR_BORDER_3D_TOP_COLOR="b3dtc";microstrategy.HTMLATTR_BORDER_3D_LEFT_COLOR="b3dlc";microstrategy.HTMLATTR_BORDER_3D_RIGHT_COLOR="b3drc";microstrategy.HTMLATTR_BORDER_3D_LEFT_COLOR="b3dlc";microstrategy.HTMLATTR_BORDER_TOP_COLOR="btc";microstrategy.HTMLATTR_BORDER_LEFT_COLOR="blc";microstrategy.HTMLATTR_BORDER_RIGHT_COLOR="brc";microstrategy.HTMLATTR_BORDER_BOTTOM_COLOR="bbc";microstrategy.HTMLATTR_BORDER_TOP_STYLE="bts";microstrategy.HTMLATTR_BORDER_LEFT_STYLE="bls";microstrategy.HTMLATTR_BORDER_RIGHT_STYLE="brs";microstrategy.HTMLATTR_BORDER_BOTTOM_STYLE="bbs";microstrategy.HTMLATTR_LINE_COLOR="lc";microstrategy.HTMLATTR_LINE_STYLE="ls";microstrategy.HTMLATTR_LINE_WEIGHT="lw";microstrategy.HTMLATTR_GRID_CELL_TYPE="cty";microstrategy.HTMLATTR_GRID_UNIT_POS="UPT";microstrategy.HTMLATTR_IS_DATASET_JOIN_PRIMARY="ijp";microstrategy.HTMLATTR_GRID_OVERFLOW="ovf";microstrategy.HTMLATTR_TEXT_OVERFLOW="tovf";microstrategy.HTMLATTR_GRID_EXPORT_OVERFLOW="xovf";microstrategy.HTMLATTR_GRAPH_EXPORT_OVERFLOW="xgovf";microstrategy.HTMLATTR_PS_TRANSPARENCY="trpr";microstrategy.HTMLATTR_PS_BLUR="blur";microstrategy.HTMLATTR_WIDGET_CLASS="twc";microstrategy.HTMLATTR_WIDGET_RSL_PATH="rsl";microstrategy.HTMLATTR_WIDGET_IS_APP="iap";microstrategy.HTMLATTR_NON_FLASH_RENDER="nfr";microstrategy.HTMLATTR_PDF_RENDER="pr";microstrategy.HTMLATTR_EXCEL_RENDER="er";microstrategy.HTMLATTR_DHTML_RENDER="dr";microstrategy.HTMLATTR_SEC_DATA_PROVIDERS="sdp";microstrategy.HTMLATTR_TRANSITION="ttr";microstrategy.HTMLATTR_TRANS_DURATION="tdr";microstrategy.HTMLATTR_LOCKED="lck";microstrategy.HTMLATTR_IS_VIS_GRID_BONE="ivgb";microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR="ssc";microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE="sstyle";microstrategy.HTMLATTR_IPHONE_VIS="iphv";microstrategy.HTMLATTR_IPAD_VIS="ipadv";microstrategy.HTMLATTR_WIDGET_PROPS="wp";microstrategy.HTMLATTR_ANDROID_VIS="aphv";microstrategy.HTMLATTR_ANDROID_TABLET_VIS="atv";microstrategy.HTMLATTR_SHOW_IN_RPT_COPY="sirc";microstrategy.GRIDCELLTYPE_UNIT_HEADER="1";microstrategy.GRIDCELLTYPE_UNIT_VALUE="2";microstrategy.GRIDCELLTYPE_SUBTOTAL_HEADER="3";microstrategy.GRIDCELLTYPE_SUBTOTAL_VALUE="4";microstrategy.GRIDCELLTYPE_LEVEL_ALL="5";microstrategy.GRIDCELLTYPE_LEVEL_NONE="0";microstrategy.GRIDCELLTYPE_LEVEL_MULTIPLE="-1";microstrategy.GRID_TARGET_NONE="0";microstrategy.GRID_TARGET_MULTIPLE="-1";microstrategy.FORMAT_LEVEL_FLAG_VIEWER=0;microstrategy.FORMAT_LEVEL_FLAG_DOC=1;microstrategy.FORMAT_LEVEL_FLAG_DOC_SELECTIONS=2;microstrategy.GRIDCELLTYPE_METRIC_DATA="data";microstrategy.TRUE="-1";microstrategy.FALSE="0";microstrategy.ACL_EXECUTE=128;microstrategy.ACL_USE=64;microstrategy.COPY_ITEM_SEPERATOR=";";microstrategy.OBJ_PREFIX="W";microstrategy.VISIBLE_ELEMS_NAME="visElem";microstrategy.VISIBLE_ELEMS_RULERS=1;microstrategy.VISIBLE_ELEMS_GRID=2;microstrategy.VISIBLE_ELEMS_DIVIDER=4;microstrategy.OK_BUTTON=1;microstrategy.CANCEL_BUTTON=2;microstrategy.APPLY_BUTTON=4;microstrategy.DESIGN_MODE=1;microstrategy.VIEW_MODE=2;microstrategy.RW_VIEW_MODE_STATIC=1;microstrategy.RW_VIEW_MODE_INTERACTIVE=2;microstrategy.RW_VIEW_MODE_EDITABLE=4;microstrategy.RW_VIEW_MODE_FLASH=8;microstrategy.RW_VIEW_MODE_VIEWANALYSIS=2048;microstrategy.IN_OUTLINE_MODE=false;microstrategy.IS_RELOAD=false;microstrategy.ALLOW_EDIT_MODE=1;microstrategy.NOT_ALLOW_EDIT_MODE=2;microstrategy.HTML_CONTAINER_TYPE_IFRAME="0";microstrategy.HTML_CONTAINER_TYPE_HTML="1";microstrategy.WINDOW_TITLE_HEIGHT="20";microstrategy.WINDOW_STATE_NORMAL="0";microstrategy.WINDOW_STATE_MINIMIZED="1";microstrategy.WINDOW_STATE_MAXIMIXED="2";microstrategy.MARQUEE_STYLE=microstrategy.MARQUEE_STYLE_PARTIAL;microstrategy.MARQUEE_STYLE_PARTIAL=0;microstrategy.MARQUEE_STYLE_FULL=1;microstrategy.DPI_CONVERSION=96;microstrategy.BASE_DPI=96;microstrategy.ZOOM_FACTOR=100;microstrategy.ZOOM_STATIC="0";microstrategy.ZOOM_FIT_WIDTH="1";microstrategy.ZOOM_FIT_PAGE="2";microstrategy.GRID_IMAGE="grid96MediumInch.gif";microstrategy.SNAP_SIZE=12;microstrategy.CURSOR_OFFSET=5;microstrategy.DND_HILITE_WIDTH=3;microstrategy.SNAP_OFF=false;microstrategy.SNAP_DIRET_POS=1;microstrategy.SNAP_DIRET_NEG=-1;microstrategy.DISPLAY_MODE_GRID=1;microstrategy.DISPLAY_MODE_GRAPH=2;microstrategy.DISPLAY_MODE_GRID_AND_GRAPH=3;microstrategy.FIRST_VISUALIZATION_VIEW_MODE=50;microstrategy.RWD_EXECUTION_MODE_DATA=1;microstrategy.RWD_EASE_CREATION_ANALYSIS=16;microstrategy.RWD_EASE_CREATION_HTML5_DASHBOARD_WITH_TEMPLATE=32;microstrategy.APP_BEAN_VIEW_EXECUTION=0;microstrategy.REPORT_EXECUTION=1;microstrategy.RWD_EXECUTION=2;microstrategy.FORM_LIST_NAME=0;microstrategy.FORM_LIST_ID=1;microstrategy.FORM_LIST_STATUS=2;microstrategy.FORM_ON_VIEW=1;microstrategy.FORM_ON_WS=2;microstrategy.FORM_NOT_ON_WS=3;microstrategy.DESIGNMODE_NOBORDER_STYLE="#999999 1px dashed";microstrategy.HAS_BORDER=1;microstrategy.NO_BORDER=0;microstrategy.RESIZE_VERTICAL=1;microstrategy.RESIZE_HORIZONTAL=2;microstrategy.WIDTH_UPDATE=1;microstrategy.HEIGHT_UPDATE=2;microstrategy.WIDTH_AND_HEIGHT_UPDATE=3;microstrategy.FIX_MODE=0;microstrategy.HUNDRED_PERCENT_MODE=1;microstrategy.AUTO_MODE=2;microstrategy.IS_RWD_DIRTY=microstrategy.FALSE;microstrategy.IS_OFFICE_EXPORT=microstrategy.FALSE;microstrategy.OPEN_EDITOR_ACTION_ADD=1;microstrategy.OPEN_EDITOR_ACTION_EDIT=0;microstrategy.PAGE_FULL_SCREEN_MODE=2;microstrategy.PAGE_NORMAL_SCREEN_MODE=1;microstrategy.FORMATTING_PROP_THRESHOLD="t";microstrategy.FORMATTING_PROP_TOC_FONT="df";microstrategy.FORMATTING_PROP_DERIVED_ELEMENT="de";microstrategy.TAB_SWITCH_MODE="switchMode";microstrategy.TAB_SWITCH_MODE_CACHED=0;microstrategy.TAB_SWITCH_MODE_FETCH=1;microstrategy.bones={};microstrategy.zones=new Array;microstrategy.observerItems=null;microstrategy.updateManager=null;microstrategy.number=null;microstrategy.descriptors=null;microstrategy.styleObj=null;microstrategy.controlVariables={};microstrategy.formatObj=null;microstrategy.mstrwid="";microstrategy.bonesToRegister=[];microstrategy.zoomType=microstrategy.ZOOM_TYPE_STATIC;microstrategy.viewerBoneId="";microstrategy.displayLocaleID=null;microstrategy.prototype.DISPLAY_MODE=microstrategy.DESIGN_MODE;microstrategy.prototype.EDIT_MODE=microstrategy.ALLOW_EDIT_MODE;microstrategy.prototype.activeCXMenu=null;microstrategy.prototype.activeCXBone=null;microstrategy.prototype.RMCTarget=null;microstrategy.prototype.isCXMenuOpen=false;microstrategy.prototype.isJLSCXMenuOpen=false;microstrategy.primeDataSetId=null;microstrategy.sortDefinedOnDefault=false;microstrategy.waitPageDelay="0";microstrategy.showWaitPopup=true;microstrategy.needToIgnorePop;microstrategy.IGNORE_RESIZE=1;microstrategy.RESIZE_TO_FIRST_SUBSECTION=2;microstrategy.RESIZE_EACH_SUBSECTION=3;microstrategy.REPORT_FMT_TOOLBAR="";microstrategy.FORMAT_TYPE_MAIN="1";microstrategy.FORMAT_TYPE_TITLE="2";microstrategy.FORMAT_TYPE_CONTROL_TITLE="5";microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;microstrategy.RESTORE_LEFT=0;microstrategy.RESTORE_TOP=1;microstrategy.RESTORE_BOTH=2;microstrategy.ACCORDION_REPORT_RP_OBJECT_PANEL="workingSet";microstrategy.ACCORDION_REPORT_ALL_OBJECT_PANEL="objectBrowser";microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL="relatedReports";microstrategy.ACCORDION_REPORT_NOTES_PANEL="notes";microstrategy.ACCORDION_RW_DATASET_PANEL="workingSet";microstrategy.ACCORDION_RW_RELATED_RP_PANEL="relatedReports";microstrategy.ACCORDION_RW_NOTES_PANEL="notes";microstrategy.ACCORDION_RW_OUTLINE_PANEL="outlineView";microstrategy.DHTML_RENDERER_SAME_AS_WIDGET="1";microstrategy.DHTML_RENDERER_SAME_AS_PDF_AND_EXCEL="0";microstrategy.GRID_UNIT_CONTAINER=0;microstrategy.GRID_BORDERS=1;microstrategy.GRID_OTHER=2;microstrategy.HTML_ELEMENT_NODE_TYPE=1;microstrategy.HTML_TEXT_NODE_TYPE=3;microstrategy.gridFormatCache={};microstrategy.graphPropertyCache={};microstrategy.WEB_API_ERROR_CODES={MSI_SERVER_NAME_NOT_INITIALIZED:2147760371,MSI_INVALID_SESSION_ID:2147760372,E_MSI_USERMGR_USER_NOTFOUND:2147758245,E_MSI_CONNECT_FAILED:2147759877};document.onmousedown=new Function("e","return microstrategy.onMouseDownHandler(e)");microstrategy.EXEC_MODE_EXCEL="4";microstrategy.EXEC_MODE_PDF="3";microstrategy.EXEC_MODE_FLASH="7";microstrategy.FILTER_BOX_NAME="drillFilterElementList";microstrategy.DRILL_BOX_NAME="deDrillElementList";microstrategy.VIS_EDITOR_SCOPE_REPORT=1;microstrategy.VIS_EDITOR_SCOPE_RW_GRID=2;microstrategy.VIS_EDITOR_SCOPE_RW=4;microstrategy.VIS_EDITOR_SCOPE_RW_LAYOUT=8;microstrategy.ENCODED_AMPERSAND="%26",microstrategy.ENCODED_EQUALS="%3D",microstrategy.SAVE_AS_SHARE_EDITOR=11;microstrategy.APPLIED_THEME_NONE="0";microstrategy.APPLIED_THEME_DEFAULT="1";microstrategy.APPLIED_THEME_CUSTOM="2";microstrategy.THEME_DARK_ID="F1FED8AC42B57AC1B0E9518FED0F89D6";microstrategy.THEME_LIGHT_ID="21E8ECEA4EACEA161B5828BD79A4B1E2";microstrategy.EXTENDED_TYPE_DATA_IMPORT=256;microstrategy.onMouseDownHandler=function(B){try{if(microstrategy.eventManager){microstrategy.eventManager.notifyOrphanBones("ondocumentclick",B);}microstrategy.hidePopups();return true;}catch(A){microstrategy.errors.log(A);return null;}};microstrategy.hidePopups=function(A,B){if(typeof (hidePopupMenus)!="undefined"){hidePopupMenus(A);}if(typeof (hideIncFetchGoToDialog)!="undefined"){hideIncFetchGoToDialog();}if(B){mstr.controllers.EventManager.notifyWindowListeners({name:"closeContextMenu",e:B});}};microstrategy.doLayout=function(D){var E=microstrategy.headerHeight,B=microstrategy.footerHeight,A=microstrategy.contentNode;if(A){microstrategy.updateContentNodeHeight();A.style.marginTop=E+"px";if(mstr.utils.ISWK||mstr.utils.ISIE8){A.style.paddingBottom=B+"px";}else{A.style.marginBottom=B+"px";}}document.body.style.height="auto";var C=(function(){var H=microstrategy.headerNode,G=H?H.scrollWidth:0;if(G>300000){G=0;}return G;}()),F=mstr.utils.BoxModel.getBrowserWindowWidth(document);document.body.style.minWidth=(C>=F)?C+"px":"";};microstrategy.syncLayout=function(F){try{if(!microstrategy.headerNode){return ;}var H=microstrategy.headerNode,J=H.scrollWidth,I=mstr.utils.BoxModel.getBrowserWindowWidth(document),E=document.documentElement.scrollLeft||document.body.scrollLeft||0,A=parseInt(H.style.left)||0;if(F!==true){if(I<J-A){H.style.left=-Math.min(J-I,E)+"px";}}else{if(F===true){var G=mstr.utils.BoxModel.position(H),D=G.left+G.width,C=I-D;if(C>=0){H.style.left=(A+C)+"px";}}}}catch(B){microstrategy.errors.log(B);}};microstrategy.initLayoutProps=function(F){try{var E=document.getElementById("mstrWebContents"),C=microstrategy.findChildWithCssClass(document.body,"table","mstrToolbarWrapper"),H=C?mstr.utils.BoxModel.position(C):{top:0,height:0},I=H.top+H.height,G=document.getElementById("mstrWeb_footer"),A=G?G.offsetHeight:0;if(mstr.utils.ISIE7&&G&&G.children.length==0){G.style.display="none";A=0;}microstrategy.contentNode=E;microstrategy.headerNode=C;microstrategy.footerNode=G;microstrategy.headerHeight=I;microstrategy.footerHeight=A;microstrategy.contentHeight=Math.max(0,getClientHeight()-I-A);var B=mstr.utils.ISW3C?window:document.body;B.onscroll=mstr.utils.Objects.compositeFunc(B.onscroll,microstrategy.syncLayout);B.onmouseup=mstr.utils.Objects.compositeFunc(B.onmouseup,microstrategy.syncLayout);}catch(D){microstrategy.errors.log(D);}};microstrategy.updateContentNodeHeight=function(B){var A=microstrategy.contentNode;if(A){if(!mstr.utils.ISIE7&&!mstr.utils.ISIE8){A.style.minHeight=microstrategy.getContentHeight()+"px";}}};microstrategy.updateLayoutProps=function(){microstrategy.headerHeight=microstrategy.headerNode&&microstrategy.headerNode.offsetHeight||0;microstrategy.footerHeight=microstrategy.footerNode&&microstrategy.footerNode.offsetHeight||0;microstrategy.contentHeight=microstrategy.getContentHeight();microstrategy.updateContentNodeHeight();};microstrategy.redoLayout=function(){microstrategy.updateLayoutProps();microstrategy.doLayout();microstrategy.syncLayout(true);};microstrategy.getContentHeight=function(){return(microstrategy.eventManager&&microstrategy.eventManager.browserHeight||getClientHeight())-microstrategy.headerHeight-microstrategy.footerHeight;};microstrategy.showAccountSCList=function(){microstrategy.showShortcutsList(null,"AC");};microstrategy.showShortcutsList=function(B,H){var G=microstrategy,D=G.shortcutsData;accData=G.shortcutsAccData;if(typeof H=="undefined"){H="ST";}var B=B||window.event;if(mstr.utils.ISIE8){if(B&&B.srcElement.id=="mstrLogoMenu"){stopEventBubbling(B);}}else{if(B&&B.target&&B.target.id=="mstrLogoMenu"){stopEventBubbling(B);}}var E="mstrSCListLoader",K=function(){var L=document.getElementById(E);if(!L){var M="open";L=document.createElement("div");L.id=E;if(H=="AC"){M+=" mstrAccountSCListPopup";}L.innerHTML='<div class="mstrSCListLoaderIcon"></div>';document.body.appendChild(L);G[E]=L;var N=document.getElementById("mstrWeb_path");L.style.top=(N.offsetHeight+N.offsetTop)+"px";}L.className=M;},A=function(){var L=G[E];if(L){L.className="";}};K();function F(){var M=mstrmojo,L;if(H==="AC"){L=M.all.mstrAccountSCList;}else{L=M.all.mstrSCList;}if(!L){var S,N,P,T;if(H==="AC"){S=G.shortcutsAccData.sl;N="mstrShortcutsListPopup mstrAccountSCListPopup";P="mstrAccountSCList";T="mstrPathAccount";}else{S=G.shortcutsData.sl;N="mstrShortcutsListPopup";P="mstrSCList";T="mstrStarburst";}var L=M.insert({id:P,scriptClass:"mstrmojo.Popup",autoCloses:true,locksHover:true,markupMethods:{onvisibleChange:function(){if(this.isOpen){mstrmojo.css.toggleClass(this.domNode,"open",this.visible);}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},onOpen:function O(){var W=this,U=W.domNode,V=document.getElementById("mstrWeb_path"),Y=mstr.utils.BoxModel.position(V),X=Y.top+Y.height;U.style.top=X+"px";W.set("visible",false);W.isOpen=true;window.setTimeout(function(){W.set("visible",true);},100);W.oldCssClassName=document.getElementById(T).className;document.getElementById(T).className="opened";microstrategy.toggleCurtain(true);},onClose:function R(){var U=this;window.setTimeout(function(){delete U.isOpen;},500);document.getElementById(T).className=U.oldCssClassName;microstrategy.toggleCurtain();},cssClass:N,children:[{scriptClass:"mstrmojo.ListBase",onclick:function(V){var X=V.getTarget(),U=X.getAttribute("idx")||X.parentNode.getAttribute("idx"),W=this.items[U];if(W&&W.name=="recentObjects"){microstrategy.openRecentObjects(X.nodeName=="DIV"?X:X.parentNode,16,true);}else{mstrmojo.form.sendLink(W.href,W.target);this.parent.close();}},onmouseover:function(V){var X=V.getTarget(),U=X.getAttribute("idx")||X.parentNode.getAttribute("idx"),W=this.items[U];if(W&&W.name=="recentObjects"){microstrategy.openRecentObjects(X.nodeName=="DIV"?X:X.parentNode,16,true);}else{if(M.all.mstrRecentsGenPopup){M.all.mstrRecentsGenPopup.close();}}},items:S,getItemMarkup:function(U){return'<div class="item {@name} {@cls} {@newGroup}" idx="{@idx}"><span class="icon"></span><span>{@n}</span></div>';},getItemProps:function Q(W,U){var V=!!W.selected,X=function(Y){var Z={"public":true,profile:true}[Y.name];return Y.appendState&&!Z;};return{sel:V,cls:(V)?"selected":"",newGroup:!!W.grp?"grp":"",n:W.n,idx:U,href:W.href,name:W.name,clsName:W.className||"",onclick:W.onclick||(X(W)&&"return submitLink(this, event);")||"return true;",target:W.target||"_self"};},itemRenderer:{render:function(V,U,W){V._renderIdx=U;return mstrmojo.string.apply(W.getItemMarkup(V),W.getItemProps(V,U));},select:function(V,W,U,X){delegateSelect("select",V,W,U,X);},unselect:function(V,W,U,X){delegateSelect("unselect",V,W,U,X);}}}]});L.render();}if(!L.isOpen){L.open();}else{if(!microstrategy.menuHover){L.close();}}A();}if(!D||!accData){var J,C,I={taskId:"getShortcutsList",pageName:G.pageName};if(H==="AC"){J="mstrPathAccount";I.listName="account";}else{J="mstrStarburst";}mstr.$XHR.request(mstrConfig.taskURL,I,{success:function(L){if(H==="AC"){G.shortcutsAccData=L;}else{G.shortcutsData=L;}if(L&&L.sl.length>0){if(typeof mstrmojo=="undefined"){G.jsLoader.get("mojo-starburst.js",true,F,false);}else{F();}}else{window.location.href=document.getElementById(J).getAttribute("_href");}}});}else{F();}return false;};microstrategy.openRecentObjects=function(D,E){var C=mstrmojo,B=C.all.mstrRecentsGenPopup;var H=C.mstr._RecentObjectsHelper;if(!H){H=C.insert("mstrmojo.mstr._RecentObjectsHelper");}var A=H.handleRecentObjects();if(!B){B=C.insert({id:"mstrRecentsGenPopup",scriptClass:"mstrmojo.ui.pathbar.PathPopup",cssClass:"mstrShortcutsListPopup",children:[{scriptClass:"mstrmojo.ui.List",alias:"menuItems",preclick:function F(){this.parent.close();},items:A,getItemMarkup:function(L){var J="";if(mstrConfig.showPreviews){if(L.recoveryInfo!==undefined){var K=(L.recoveryInfo.imgData!==undefined)?"data:image/png;base64,"+L.recoveryInfo.imgData:"";if(K!==""){J='<img class="img-preview" src="'+K+'" height="200" width="250" style="z-index: 100; position: absolute;">';}}}return'<span class="item mstrMenuItem {@itemCls}" style="{@cssText}"><span class="{@iconCls}"></span><a class="mstrLink" href="{@href}">{@n}'+J+"</a></span>";},getItemProps:function I(L,J){var K=!!L.selected;return{sel:K,iconCls:L.iconClass,itemCls:L.itemClass,cssText:L.cssText||"",cls:K?"selected":"",newGroup:!!L.grp?"grp":"",n:L.recoveryName,idx:J,href:L.recoveryURL,name:L.recoveryName,target:L.target||"_self"};},onclick:function(J){cancelEvent(J);stopEventBubbling(J);var K=J.getTarget();if(K.getAttribute("href")){submitLinkAsForm(K);}else{submitLinkAsForm(K.parentElement);}return false;}}]});}var G=D.getBoundingClientRect();B.targetNode=D;B.offsetLeft=G.right-G.left;B.offsetTop=G.top-G.bottom;if(E===undefined){E=!B.isOpen;}if(!B.isOpen&&E){B.open();}else{if(!microstrategy.menuHover&&!E){B.close();}}};microstrategy.getCubesInfo=function(A,B){mstr.$XHR.request(mstrConfig.taskURL,{taskId:"getUserDICubeInfo",cubeIds:A.join(",")},{success:function(C){B(C);}});};microstrategy.isCubeSupportDDA=function(A){return !!(A&&(A.dda===1||A.dda===3));};microstrategy.createIVE=function(G){var F=!microstrategy.isFeatureAvailable("flashvi")&&G;if(F&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return ;}microstrategy.showWait();var D=this,C=window.mstrmojo,E="mstrIVE",A=function(K){C=mstrmojo;var H={scriptClass:"mstrmojo.IVEDatasetPicker",id:E,cssClass:"mstrmojo-ive-dataset-picker",startingFolder:D.folderId,onRender:function I(){var L=microstrategy.isFeatureAvailable("web-import-data");this.btnImport.set("visible",L);this.newLabel.set("visible",L);},onClose:function(N){if(!N||!(N.item||N.action)){return ;}var O=microstrategy.updateManager,M=[],P=this,R=N.item,L=R?((F&&bIsW3C&&!bIsIE8)?mstrUpdateManager.CREATE_HTML5_VI:mstrUpdateManager.CONVERT_TO_DOCUMENT):(N.action?mstrUpdateManager.OPEN_IMPORT_ENTRY:null);function S(T,U){microstrategy.getCubesInfo([T],function(V){var W=V[T];U(W&&!W.published&&microstrategy.isCubeSupportDDA(W));});}function Q(T,U){S(T.did,function(Y){var X=Y?128:0,V=mstrUpdateManager.actions[U].paramID,W;if(F&&bIsW3C&&!bIsIE8){W=[T.did,1,3,64|X,true];}else{W=[T.did,"",0,1,3,2048,16|X];}M.push(O.createActionObject(null,U,microstrategy.servletName,V,W));O.add(M);O.useIframe=false;O.flushAndSubmitChanges();});}if(!L){return true;}if(R){Q(R,L);}else{microstrategy.openDataImport({AnalysisId:"00000000",callback:function(T){L=(F&&bIsW3C&&!bIsIE8)?mstrUpdateManager.CREATE_HTML5_VI:mstrUpdateManager.CONVERT_TO_DOCUMENT;Q(T[0],L);}});}}};var J=C.insert(H);J.render();J.open();microstrategy.showWait(false);};var B=C&&C.all&&C.all[E];if(B){B.set("startingFolder",this.folderId);B.open();microstrategy.showWait(false);}else{microstrategy.mojoLoader.loadWidget({scriptClass:"IVEDatasetPicker",bundle:"mojo-ive-picker.js",callback:A});}};microstrategy.toggleCurtain=function toggleCurtain(B){var A=microstrategy;if(!A.curtainNode){A.curtainNode=document.createElement("div");document.body.appendChild(A.curtainNode);}var D=A.curtainNode,C=D.style;C.position="absolute";C.top="0px";C.left="0px";C.height="100%";C.width="100%";C.zIndex="100";if(bIsIE4){C.background="#eee";if(bIsDXIE){C.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0))";}else{C.opacity=0;}}C.display=B?"block":"none";};microstrategy.updateActiveCXProps=function(A,B){microstrategy.activeCXMenu=A;microstrategy.RMCTarget=getEventTarget(B);microstrategy.activeCXBone=null;};microstrategy.setContextMenuStatus=function(A){microstrategy.isCXMenuOpen=A;};microstrategy.setJLSCXMenuOpen=function(A){microstrategy.isJLSCXMenuOpen=A;};microstrategy.isContextMenuOpen=function(){return microstrategy.isCXMenuOpen||microstrategy.isJLSCXMenuOpen;};microstrategy.getActiveCXBone=function(){try{if(!microstrategy.activeCXBone){microstrategy.activeCXBone=microstrategy.findBone(microstrategy.activeCXMenu);}return microstrategy.activeCXBone;}catch(A){microstrategy.errors.log(A);return null;}};microstrategy.updateBone=function(B){try{if(microstrategy.bone(B.id)){microstrategy.bone(B.id).absorbObject(B.properties);}else{microstrategy.bonesToRegister.push({id:B.id,loadCondition:B.loadCondition,properties:B.properties});}}catch(A){microstrategy.errors.log(A);}return null;};microstrategy.registerBone=function(id,loadCondition,propsObj){try{var elem=getElementById(id);if(!elem){return null;}microstrategy.controlVariables[id]=false;var scriptClass=elem.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);var conditionStatus=false;try{conditionStatus=checkJSExists(scriptClass)&&eval(loadCondition);}catch(e){conditionStatus=false;}if(conditionStatus){var bone=this.callConstructor([id],scriptClass);if(bone){if(this.bones[bone.id]&&this.bones[bone.id].unloadBone){this.bones[bone.id].onunload();}this.bones[bone.id]=bone;microstrategy.controlVariables[id]=true;if(bone.viewerBone){this.viewerBoneId=id;}if(propsObj){if(typeof (propsObj)=="string"){microstrategy.errors.log("Unexpected properties object type at microstrategy.registerBone.");eval("propsObj = "+propsObj);}for(var p in propsObj){bone[p]=propsObj[p];}}return bone;}}else{window.setTimeout(function registerBoneTimeout(){microstrategy.registerBone(id,loadCondition,propsObj);},250);}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.unRegisterBone=function(B){try{if(typeof (this.bones[B])!="undefined"){this.bones[B].onunload();delete this.bones[B];}return true;}catch(A){microstrategy.errors.log(A);return null;}};microstrategy.callConstructor=function(D,A){try{if(!A){elem=getElementById(D[0]);A=elem&&elem.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);if(!A){return null;}}var C=null;if(D){C=new window[A](D[0]);if(D.length>1){window[A].apply(C,D);}}else{C=new window[A]();}return C;}catch(B){microstrategy.errors.log(B);return null;}};microstrategy.bone=function(B){try{return(typeof (this.bones[B])!="undefined")?this.bones[B]:null;}catch(A){microstrategy.errors.log(A);return null;}};microstrategy.getViewerBone=function(){try{return this.bone(this.viewerBoneId);}catch(A){microstrategy.errors.log(A);}return null;};microstrategy.findBone=function(C){try{if(C==null){return null;}var G=findTarget(C,microstrategy.HTMLATTR_SCRIPTCLASS);if(G==null||G.getAttribute("id")==null){return null;}var O=this.bone(G.getAttribute("id"));if(O){return O;}else{if(G.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_TREE_VIEW){return microstrategy.findBone(G.parentNode);}}if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var B=C.getElementsByTagName("table");for(var E=0;E<B.length;E++){var L=B[E].parentNode;if(L&&L.id.toLowerCase().indexOf("divlock")>0){L=L.parentNode;}if(L&&L.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)&&(L.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_GRID_TABLE||L.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE)){var M=this.bone(L.getAttribute("id"));if(M&&(!M.quickSwitch||M.quickSwitchCurrent)){return M;}}}var H=C.getElementsByTagName("img");for(var E=0;E<H.length;E++){if(H[E].parentNode&&H[E].parentNode.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){var K=this.bone(H[E].parentNode.getAttribute("id"));if(K&&(!K.quickSwitch||K.quickSwitchCurrent)){return K;}}}var G=C.getElementsByTagName("object");if(G==null||G.length==0){G=C.getElementsByTagName("embed");}for(var E=0;E<G.length;E++){if(G[E].parentNode&&G[E].parentNode.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){var F=this.bone(G[E].parentNode.getAttribute("id"));if(F&&F.getGridContainerSpan){return F;}}}var A=C.getElementsByTagName("div");for(var E=0;E<A.length;E++){if(A[E]&&A[E].getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){if(A[E].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE){var N=this.bone(A[E].getAttribute("id"));if(N&&(!N.quickSwitch||N.quickSwitchCurrent)){return N;}}else{if(A[E].getAttribute(microstrategy.HTMLATTR_IS_VIS_GRID_BONE)=="1"){var I=this.bone(A[E].getAttribute("id"));if(I){return I;}}}}}}else{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){var A=microstrategy.findChildWithAtt(C,"DIV","scriptClass","mstrRWControlImpl");if(A){return this.bone(A.getAttribute("id"));}else{return this.findBone(C.parentNode);}}else{return this.findBone(C.parentNode);}}}else{switch(G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)){case microstrategy.OBJTYPE_DOC_SUBSECTION:if(G.parentNode.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_PANEL_CONTAINER){var J=this.findBone(G.parentNode.parentNode);if(J!=null&&J.isLoaded){return J.getPanel(G.getAttribute("id"));}else{return null;}}case microstrategy.OBJTYPE_DOC_SECTION:case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:case microstrategy.OBJTYPE_DOC:return(this.bone("rwb_viewer")!=null)?this.bone("rwb_viewer").getChildBone(G):null;break;}}return null;}catch(D){microstrategy.errors.log(D);return(null);}};microstrategy.objectType=function(B){try{var C=this.findAncestor(B);if(C){return B.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}return null;}catch(A){microstrategy.errors.log(A);return null;}};microstrategy.subObjectType=function(B){try{return B&&B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}catch(A){microstrategy.errors.log(A);return null;}};microstrategy.getRegisteredAncestor=function(A){if(!A){return null;}var C=findTarget(A,microstrategy.HTMLATTR_SCRIPTCLASS);if(C){var B=microstrategy.bone(C.getAttribute("id"));if(B){return B;}return microstrategy.getRegisteredAncestor(C.parentNode);}return null;};microstrategy.findAncestor=function(A){if(A){return(findTarget(A,microstrategy.HTMLATTR_OBJTYPE));}else{return null;}};microstrategy.findAncestorBone=function(C,A){try{var D=microstrategy.findAncestorWithAtt(C.elem,"scriptclass",A);if(D){return microstrategy.bone(D.id);}else{return null;}}catch(B){return null;}};microstrategy.findAncestorWithAtt=function(A,D,B){try{var C=(B)?function(H,F,G){return !!(H.getAttribute&&H.getAttribute(F)==G);}:function(G,F){return !!(G.getAttribute&&G.getAttribute(F)!=null);};while(A){if(C(A,D,B)){return A;}A=A.parentNode;}return null;}catch(E){return null;}};microstrategy.findAncestorWithTag=function(A,B){try{while(A){if(A.tagName==B){return A;}A=A.parentNode;}return null;}catch(C){return null;}};microstrategy.findChildrenWithAtt=function(C,A,H,B){try{if(!C){return null;}if(typeof (A)!="object"){A=[A];}var J=new Array;var I=0;if(B){for(var E=0;E<A.length;E++){if((C.tagName==A[E])&&(C.getAttribute(H)==B)){return C;}var G=C.getElementsByTagName(A[E]);if(G&&G.length){for(var F=0;F<G.length;F++){if(G[F].getAttribute(H)==B){J[I++]=G[F];}}}}}else{for(var E=0;E<A.length;E++){var G=C.getElementsByTagName(A[E]);if(G&&G.length){for(var F=0;F<G.length;F++){if(G[F].getAttribute(H)!=null){J[I++]=G[F];}}}}}return J;}catch(D){microstrategy.errors.log(D);return null;}};microstrategy.findRegisteredChildBone=function(E,C,A){try{if(!E){return null;}if((E.tagName.toLowerCase()==C)&&(isAttributePresent(E,"scriptclass",A))){return microstrategy.bone(E.id);}var F=E.getElementsByTagName(C);for(var B=0;F&&B<F.length;B++){if(isAttributePresent(F[B],"scriptclass",A)){return microstrategy.bone(F[B].id);}}return null;}catch(D){microstrategy.errors.log(D);return null;}};microstrategy.findRWObjectBone=function(D,A){try{if(microstrategy.objectType(D)||D.getAttribute("scriptclass")){var B=microstrategy.findAncestor(D);if(microstrategy.subObjectType(B)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return microstrategy.findRegisteredChildBone(D,"span");}else{return microstrategy.findRegisteredChildBone(D,"div",A);}}else{return microstrategy.findBone(D);}}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.findChildWithAtt=function(G,D,E,B){try{if(!G||B===undefined){return null;}if(typeof (D)!="object"){D=[D];}for(var A=0;A<D.length;A++){if((G.tagName!=null&&D[A]!=null&&G.tagName.toLowerCase()==D[A].toLowerCase())&&(G.getAttribute(E)==B)){return G;}var H=G.getElementsByTagName(D[A]);if(H&&H.length){for(var C=0;C<H.length;C++){if(H[C].getAttribute(E)!=null&&(H[C].getAttribute(E).toString()).toLowerCase()==B.toLowerCase()){return H[C];}}}}return null;}catch(F){microstrategy.errors.log(F);return null;}};microstrategy.findChildWithCssClass=function(B,A,I){try{if(!B){return null;}if(typeof (A)!="object"){A=[A];}for(var D=0;D<A.length;D++){var H=new RegExp("(^|\\s)"+I+"(\\s|$)","i");if((B.tagName!=null&&A[D]!=null&&B.tagName.toLowerCase()==A[D].toLowerCase())&&H.test(B.className)){return B;}if(B.getElementsByClassName){var G=B.getElementsByClassName(I);for(var E,F=0;E=G[F];F++){if(A[D].toLowerCase()==E.tagName.toLowerCase()){return E;}}}else{var G=B.getElementsByTagName(A[D]);for(var E,F=0;E=G[F];F++){if(H.test(E.className)){return E;}}}}return null;}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.findParentWithTag=function(D,A){try{var B=D.parentNode;while(B!=null){if(B.tagName&&B.tagName.toLowerCase()==A){return B;}B=B.parentNode;}}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.objectFind=function(D,B,A){try{return microstrategy.findChildWithAtt(D,B,microstrategy.HTMLATTR_OBJTYPE,A);}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.objectListFind=function(D,B,A){try{return microstrategy.findChildrenWithAtt(D,B,microstrategy.HTMLATTR_OBJTYPE,A);}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.subObjectFind=function(D,B,A){try{return microstrategy.findChildWithAtt(D,B,microstrategy.HTMLATTR_SUBOBJTYPE,A);}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.subObjectListFind=function(D,B,A){try{return microstrategy.findChildrenWithAtt(D,B,microstrategy.HTMLATTR_SUBOBJTYPE,A);}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.getRect=function(B){try{if(B){var C=new Object;C.left=getObjSumLeft(B);C.top=getObjSumTop(B);C.right=C.left+getObjWidth(B);C.bottom=C.top+getObjHeight(B);return C;}return null;}catch(A){microstrategy.errors.log(A);return null;}};microstrategy.doRectsIntersect=function(B,A){try{return(A.left<B.right&&A.right>B.left&&A.top<B.bottom&&A.bottom>B.top);}catch(C){microstrategy.errors.log(C);return false;}};microstrategy.isRectInRect=function(B,A){try{return(B.left>A.left&&B.right<A.right&&B.top>A.top&&B.bottom<A.bottom);}catch(C){microstrategy.errors.log(C);return false;}};microstrategy.relativeSnapCoordinate=function(B,A,G,D,E){try{var F=(G)?getObjSumTop(A):getObjSumLeft(A);if(!D){return B;}return this.snapCoordinate(B,F,D,E);}catch(C){microstrategy.errors.log(C);return B;}};microstrategy.isSnapped=function(B,A,E){try{var D=0;if(A!=null){D=(E)?getObjSumTop(A):getObjSumLeft(A);}return(((B-D)%microstrategy.SNAP_SIZE)==0);}catch(C){microstrategy.errors.log(C);return B;}};microstrategy.snapCoordinate=function(A,G,D,F){try{var E=A-G;if(D!=null&&D==false){return E;}var H=0;var C=A;if(E%microstrategy.SNAP_SIZE!=0){if(F!=null){H=(F==microstrategy.SNAP_DIRET_POS)?(microstrategy.SNAP_SIZE-E%microstrategy.SNAP_SIZE):(E%microstrategy.SNAP_SIZE)*microstrategy.SNAP_DIRET_NEG;C+=H;}else{H=E%microstrategy.SNAP_SIZE;if(H>microstrategy.SNAP_SIZE/2){H=H-microstrategy.SNAP_SIZE;}C-=H;}}return C;}catch(B){microstrategy.errors.log(B);return A;}};microstrategy.createAssociativeArray=function(D){try{if(D==null){return null;}var A={};if(!D.length){A.item=D;}else{for(var B=0;B<D.length;B++){A[B]=D[B];}}return A;}catch(C){microstrategy.errors.log(C);return D;}};microstrategy.boneForMask=function(C){if(!C){return null;}var A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var B=null;if(A==microstrategy.OBJTYPE_MASK||A==microstrategy.OBJTYPE_MASK_MAP){B=microstrategy.bone(C.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT));if(B==null){B=microstrategy.findBone(document.getElementById(C.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT)));}}else{if(A==microstrategy.OBJTYPE_MASK_MAP_AREA){B=microstrategy.bone(C.parentNode.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT));}}return B;};microstrategy.updatePreference=function(A,C){try{if(typeof (mstrUpdateManager)!="undefined"&&mstrUpdateManager.SET_PREFERENCE){this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,["5003","5004"],[A,C],[])],true);}}catch(B){microstrategy.errors.log(B);}};microstrategy.updateBrowserSetting=function(B,D,E){try{var A=E?mstrUpdateManager.SET_SESSION_BROWSER_SETTING:mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING;if(typeof (mstrUpdateManager)!="undefined"&&A){this.updateManager.add([this.updateManager.createActionObject(null,A,microstrategy.servletName+"."+microstrategy.pageName,["5005","5007"],[B,D],[])],true);}}catch(C){microstrategy.errors.log(C);return elem;}};microstrategy.updateCookieSetting=function(C,H){try{var A=C+microstrategy.ENCODED_EQUALS,I=microstrategy.getCookieSetting(C),B=A+(I||0),D=A+H;if(I===undefined){var G="bSet=",E=document.cookie.indexOf(G)!==-1;if(E){document.cookie=document.cookie.replace(G,G+D+microstrategy.ENCODED_AMPERSAND);}else{document.cookie=G+D;}}else{document.cookie=document.cookie.replace(B,D);}}catch(F){microstrategy.errors.log(F);return elem;}};microstrategy.getCookieSetting=function(A){try{return microstrategy.getCookieList()[A];}catch(B){microstrategy.errors.log(B);return elem;}};microstrategy.getCookieList=function(){try{var C=document.cookie,A={},B,E,F;if(!C||!(typeof C==="string")||C.indexOf("bSet")<0){return A;}C=C.split(";");for(B=0,F=C.length;B<F;B++){if(C[B].indexOf("bSet")>=0){C=trim(C[B]);break;}}C=C.replace("bSet=","").split(microstrategy.ENCODED_AMPERSAND);for(B=0,F=C.length;B<F;B++){E=C[B].split(microstrategy.ENCODED_EQUALS);A[E[0]]=E[1];}return A;}catch(D){microstrategy.errors.log(D);return elem;}};microstrategy.isValueInFilter=function(C,G,F){var E=true;try{if(C!=null&&G!=null){E=false;if(!F||(F==microstrategy.HTMLATTR_FILTER_COMPARISON_DEFAULT)){var A=G.split(",");var B=0;while(B<A.length&&!E){E=(A[B]==C);B++;}}else{E=parseInt(C)&parseInt(G);}}}catch(D){microstrategy.errors.log(D);}return E;};microstrategy.adjustUserPalette=function(C){try{var B=false;var A=this.userPalette;if(A.length==0){A=C;B=true;}else{if(A.indexOf(C)<0){var D=A.split(",");if(D.length==8){A=A.substr(8,A.length);}A+=","+C;B=true;}}if(B){this.userPalette=A;}return(B)?A:null;}catch(E){microstrategy.errors.log(E);return null;}};microstrategy.getFormatObject=function(){try{if(this.formatObj==null){this.formatObj=mstrFormatObject;}return this.formatObj;}catch(A){microstrategy.errors.log(A);return null;}};microstrategy.setSingleFormat=function(F,B){try{var E=[];var G=F;var D=B;var A=mstrFormatObject;switch(F){case"Bold":G="fontWeight";D=(B)?"bold":"normal";break;case"Italic":G="fontStyle";D=(B)?"italic":"normal";break;case"Underline":G="textDecoration";D=(B)?4:-4;break;case"StrikeOut":G="textDecoration";D=(B)?8:-8;break;case"fstyle":if(parseInt(B)&1){return microstrategy.setSingleFormat("Bold",B);}else{if(parseInt(B)&2){return microstrategy.setSingleFormat("Italic",B);}else{return microstrategy.setSingleFormat("Underline",B);}}break;case"TextAlign":case"align":G="textAlign";D=A.decodeValue(G,B);break;case"Horizontal":G="textAlign";D=A.decodeValue(G,B);break;case"GridHorizontal":G="textAlign2";D=A.decodeValue(G,B);break;case"Vertical2":G="verticalAlign2";D=A.decodeValue(G,B);break;case"Vertical":G="verticalAlign";D=A.decodeValue(G,B);break;case"FontFamily":case"font":case"Name":G="fontFamily";break;case"FontSize":case"fsize":case"Size":G="fontSize";D=A.decodeValue(G,B);break;case"bgcolor":case"FillColor":if(B==null||B.length==0){G="backgroundColor";D="transparent";}else{if(B.indexOf(",")>=0){G="Gradient";}else{G="backgroundColor";}}break;case"FillStyle":G="backgroundStyle";if(B==null||B.length==0){D="transparent";}if(B&&B.indexOf(",")>0){D="Gradient";}break;case"LineSpacing":G="lineHeight";if(B=="0"){B="normal";}if(B!="normal"){B+="in";}D=B;break;case"selectionColor":G="selectionColor";D=(B=="automatic")?"#60b1f6":B;break;case"selectionStyle":G="selectionStyle";D=(B=="automatic")?"0":"1";break;case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":G="paddingLeft";if(F=="RightPadding"){G="paddingRight";}if(F=="BottomPadding"){G="paddingBottom";}if(F=="TopPadding"){G="paddingTop";}D=B+"pt";break;case"TextWrap":G="whiteSpace";D=(B>0)?"normal":"nowrap";break;case"color":case"Color":case"FontColor":G="color";break;case"TopColor":case"LeftColor":case"RightColor":case"BottomColor":G="borderTopColor";if(F=="LeftColor"){G="borderLeftColor";}if(F=="RightColor"){G="borderRightColor";}if(F=="BottomColor"){G="borderBottomColor";}break;case"TopStyle":case"LeftStyle":case"RightStyle":case"BottomStyle":G="borderTopStyle";if(F=="LeftStyle"){G="borderLeftStyle";}if(F=="RightStyle"){G="borderRightStyle";}if(F=="BottomStyle"){G="borderBottomStyle";}switch(B){case"0":case"5":case"1":case"7":D="solid";break;case"3":D="dashed";break;case"4":D="dotted";break;case"6":D="double";break;}break;case"topWidth":case"leftWidth":case"rightWidth":case"bottomWidth":G="borderTopWidth";if(F=="leftWidth"){G="borderLeftWidth";}if(F=="rightWidth"){G="borderRightWidth";}if(F=="bottomWidth"){G="borderBottomWidth";}switch(B){case"0":D="0pt";break;case"3":case"4":case"1":case"7":D="1pt";break;case"5":D="1.5pt";break;case"6":D="2.5pt";break;}break;case"HasDropShadow":G="dropShadowEffect";D=(D)?"1":"0";break;case"HasRoundedCorners":G="hasRoundedCorners";D=(D)?"-1":"0";break;case"DropShadow":G="dropShadowDepth";break;case"TopCornersOnly":G="topCornersOnly";break;}E[0]=G;E[1]=D;return E;}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.checkACL=function(D,B){try{if(D&&B){var F=D.getAttribute(microstrategy.HTMLATTR_ACL);if(F&&F.length>0){var E=parseInt(F);for(var A=0;A<B.length;A++){if((parseInt(B[A])&E)==0){return false;}}}}return true;}catch(C){microstrategy.errors.log(C);return null;}};microstrategy.isValidGroupByType=function(A){try{if(A==microstrategy.DSSTYPE_CONSOLIDATION||A==microstrategy.DSSTYPE_FILTER||A==microstrategy.DSSTYPE_ATTRIBUTE){return true;}return false;}catch(B){microstrategy.errors.log(B);return false;}};microstrategy.toggleEditor=function(D,G,C){try{var A=this.bone(D);if(A){A.closeEditor();}else{var E=this.updateManager;var B=[];B.push(E.createActionObject(this,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[true,G],[]));E.add(B);if(!C){E.flushAndSubmitChanges();}}return true;}catch(F){microstrategy.errors.log(F);return false;}};microstrategy.showAccordionWhileWaiting=function(G,C){try{if(!G){G="td_mstrWeb_dockLeft";}if(!C){C="mstrWeb_dockLeft";}var A=document.getElementById("accordion_AccordionTabManagerStyle");if(A&&A.getAttribute(mstrHTMLAttributes.ATTR_HIDDEN)!="true"){var B=document.getElementById(G);if(B){B.style.display="block";B.style.width="220px";B.style.border="none";}var D=document.getElementById(C);if(D){D.style.display="block";}var F=microstrategy.findChildWithAtt(A,"IMG",(bIsW3C)?"class":"className","mstrIcon-btn mstrIcon-btnClose");if(F){F.style.display="none";}A.style.width="220px";if(bIsIE6){A.style.position="relative";var H=document.getElementById("relatedReportsId");if(H){H.style.width="210px";}}}}catch(E){microstrategy.errors.log(E);return false;}};microstrategy.toggleAccordion=function(B,D){try{var A=this.bone("accordion_AccordionTabManagerStyle");var H="lTbar";D=(typeof (D)!="undefined"&&!D)?false:true;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){H=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"obDesign":"obView";}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){H="accordionReportView";}}if(A&&(A.currentTabName==B||typeof (B)=="undefined")&&D){if(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION||microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){this.updateBrowserSetting(H,"0");A.closeEditor(false);var E=mstr.$obj("NotesIconModel_model");if(E){if(E.get("objectID")&&E.get("objectType")){E.execCheck();}else{var C=mstr.$obj("NotesIconView_view");if(C){C.set("visible",false);}}}}}else{if(A){A.setCurTab(B);}else{this.updateBrowserSetting(H,"1");if(typeof (B)!="undefined"){if(mstrApp.rememberLastEditorPanel!=="0"){this.updateBrowserSetting((microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)?"accordionRWTab":"accordionReportTab",B);}}toggleShowBean("accordion",true,(typeof (B)!="undefined")?"currentTabName="+B:"");var G=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.ACCORDION_REPORT_NOTES_PANEL:microstrategy.ACCORDION_RW_NOTES_PANEL;if(B==G){var C=mstr.$obj("NotesIconView_view");if(C){C.set("visible",false);}}else{var E=mstr.$obj("NotesIconModel_model");if(E){if(E.get("objectID")&&E.get("objectType")){E.execCheck();}}}}}return true;}catch(F){microstrategy.errors.log(F);return false;}};microstrategy.needSaveBeforeNotes=function(){try{var B=((microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.bone("UniqueReportID"):microstrategy.getViewerBone());return(B&&B.needSaveBeforeNotes);}catch(A){microstrategy.errors.log(A);return false;}};microstrategy.performSave=function(){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){var C=microstrategy.bone("UniqueReportID");return(C&&C.commands.exec("save"));}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var B=microstrategy.bone("rwb_viewer");return(B&&B.doc.commands.exec("save"));}}}catch(A){microstrategy.errors.log(A);return false;}};microstrategy.toggleRelatedReports=function(){try{var A=this.bones.relatedReports;if(A){this.updateBrowserSetting("lTbar","0");}else{this.updateBrowserSetting("lTbar","1");}this.updateManager.useIframe=false;this.updateManager.flushAndSubmitChanges();return true;}catch(B){microstrategy.errors.log(B);return false;}};microstrategy.toggleLeftToolbar=function(){try{var A=this.bone("leftToolbar");if(A){A.close();}else{this.updateBrowserSetting("lTbar","1");this.updateManager.useIframe=false;this.updateManager.flushAndSubmitChanges();}return false;}catch(B){microstrategy.errors.log(B);return false;}};microstrategy.disableTextSelection=function(B){try{if(!B){return ;}if(typeof B.onselectstart!="undefined"){B.onselectstart=function(){return false;};}else{if(typeof B.style.MozUserSelect!="undefined"){B.style.MozUserSelect="none";}}}catch(A){microstrategy.errors.log(A);}};mstrAreaObjectImpl.prototype={};function mstrAreaObjectImpl(){this.shape="rect";this.coords="0,0,0,0";this.pointsTo=null;this.onmouseovercoords=null;this.onmouseout=null;this.moveHilite=true;}mstrObjectInfoImpl.prototype={};mstrObjectInfoImpl.prototype.src=null;mstrObjectInfoImpl.prototype.left=0;mstrObjectInfoImpl.prototype.top=0;mstrObjectInfoImpl.prototype.height=0;mstrObjectInfoImpl.prototype.width=0;mstrObjectInfoImpl.prototype.alias="";mstrObjectInfoImpl.prototype.dssId="";mstrObjectInfoImpl.prototype.dssFrmId="";mstrObjectInfoImpl.prototype.dssType=0;mstrObjectInfoImpl.prototype.dssSubType=0;mstrObjectInfoImpl.prototype.dSetId=null;mstrObjectInfoImpl.prototype.dSetName="";mstrObjectInfoImpl.prototype.isUnique=true;function mstrObjectInfoImpl(C){try{if(C){this.src=C;this.alias=C.getAttribute("ds");var D=microstrategy.findBone(C);if(!D){var A=C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(A==microstrategy.SUBOBJTYPE_ATTRIBUTE||A==microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM||A==microstrategy.SUBOBJTYPE_METRIC){this.dssId=C.getAttribute(microstrategy.HTMLATTR_DSS_ID);this.dssType=C.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);}}else{this.dssType=C.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);this.dssSubType=C.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);if(this.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){if(D.type==microstrategy.OBJTYPE_OBJBROWSER){this.dssFrmId=C.getAttribute(microstrategy.HTMLATTR_DSS_ID);this.dssId=C.getAttribute(microstrategy.HTMLATTR_ATTRIBUTE_ID);}}else{this.dssId=C.getAttribute(microstrategy.HTMLATTR_DSS_ID);}switch(D.type){case microstrategy.OBJTYPE_OBJBROWSER:this.dSetId=microstrategy.primeDataSetId;if(D.isRWTab){this.dSetId=C.getAttribute("id").slice(0,32);this.dSetName=D.getDatasetName(this.dSetId);if(this.dssType==microstrategy.DSSTYPE_METRIC){this.isUnique=D.isMetricUnique(this.alias);}}break;case microstrategy.OBJTYPE_PAGE_BY_ELEM:this.dSetId=microstrategy.primeDataSetId;break;case microstrategy.OBJTYPE_DOC_SUBSECTION:case microstrategy.OBJTYPE_DOC_OBJECT:this.dSetId=C.getAttribute(microstrategy.HTMLATTR_DSS_SET);break;}}}return this;}catch(B){microstrategy.errors.log(B);return null;}}microstrategy.isEnabled=function(A,E){try{var D=this.getFormatObject();if(A&&D[E]){if(D[E][mstrFormatObject.APPLIES_TO]=="all"){return true;}for(var C in A){if(this.isEnabledForItem(A[C],E)){return true;}}}return false;}catch(B){microstrategy.errors.log(B);return false;}};microstrategy.isEnabledForItem=function(E,H){try{if(H=="Gradient"){return true;}var F=this.getFormatObject();if(F[H][mstrFormatObject.APPLIES_TO]=="all"){return true;}var A=F[H][mstrFormatObject.APPLIES_TO];var C=E.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var G=E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(A.contains(C,",")||A.contains(G,",")){if(G!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||H!="textAlign"){return true;}else{if(E.lastChild){var B=microstrategy.bone(E.lastChild.id);if(B){switch(B.ctlStyle){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:case mstrRWControlImpl.CTL_STYLE_SCROLLER:case mstrRWControlImpl.CTL_STYLE_LIST_BOX:return B.docViewer.commands.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE;default:return true;break;}}}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};microstrategy.setPrimeDataSetId=function(A){microstrategy.primeDataSetId=A;};microstrategy.getEventHandlerString=function(F){try{if(typeof (F)!="string"||F.length==0){return"if (true)";}var E=F.split(".");for(var B=1;B<E.length;B++){E[B]=E[B-1]+"."+E[B];}var A="";var C="";for(var B=0;B<E.length;B++){C+=A+"(typeof("+E[B]+") != 'undefined' && "+E[B]+" != null)";A=" && ";}return"if ("+C+")";}catch(D){microstrategy.errors.log(D);return"if (true)";}};microstrategy.isObjectBrowserOpen=function(){try{for(var B in this.bones){if(this.bones[B].type==microstrategy.OBJTYPE_OBJBROWSER){return true;}}}catch(A){microstrategy.errors.log(A);}return false;};microstrategy.getObjectBrowser=function(){try{for(var B in this.bones){if(this.bones[B].type==microstrategy.OBJTYPE_OBJBROWSER){return this.bones[B];}}}catch(A){microstrategy.errors.log(A);}return null;};microstrategy.retrievePaddingAndBorders=function(T,H,A){try{var B=[];var C=[];if(T!=null){if(H=="height"){C=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];}else{C=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];}var G=this.styleObj;for(var R=0;R<4;R++){var N=C[R],J;if(N.indexOf("border")>-1){var F=G.getValue(T,N.replace("Width","Style"))!="none";J=F?G.getValue(T,C[R]):0;}else{J=G.getValue(T,C[R]);}B.push(J);}return B;}var I=this.getFormatObject();var K={ts:"0",bs:"0",tp:"0",bp:"0",ls:"0",rs:"0",lp:"0",rp:"0"};C=[{ps:"FormattingBorder",p:"Style",a:["Top","Bottom","Left","Right"]},{ps:"FormattingPadding",p:"Padding",a:["Top","Bottom","Left","Right"]},{ps:"FormattingLine",p:"LineWeight"}];var M,P;for(var R=0;R<3;R++){var O=A[C[R].ps];var E=I[C[R].ps];if(!O||!E){continue;}var N=C[R].p;var U=C[R].a;if(U){for(var Q=0;Q<4;Q++){M=O[U[Q]+N];P=E[U[Q]+N];if(!M||!P){continue;}var S=P[mstrFormatObject.HTML_PROP_NAME];var L=I.decodeValue(S,M.defaultValue||"0");K[U[Q].substr(0,1).toLowerCase()+N.substr(0,1).toLowerCase()]=L;}}else{M=O[N];P=E[N];if(!M||!P){continue;}var S=P[mstrFormatObject.HTML_PROP_NAME];var L=I.decodeValue(S,M.defaultValue||"0");K.ts=L;K.bs=L;K.ls=L;K.rs=L;}}if(H=="height"){B=[K.ts,K.bs,K.tp,K.bp];}else{B=[K.ls,K.rs,K.lp,K.rp];}return B;}catch(D){microstrategy.errors.log(D);return[];}};microstrategy.getPaddingAndBorderPixels=function(G,A,B){try{var C=this.retrievePaddingAndBorders(G,A,B);var F=0;var H=0;for(var D=0;D<C.length;D++){if(C[D]!=null&&C[D].length>0&&!isNaN(parseFloat(C[D]))){if(bIsIE6){F+=Math.round(this.getFormatObject().getPxFromPt(C[D]));}else{H+=parseFloat(C[D]);}}}return F+this.getFormatObject().getPxFromPt(H);}catch(E){microstrategy.errors.log(E);return 0;}};microstrategy.getMaxZIndex=function(E){try{var A=0;if(this.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var B=this.bone("rwb_viewer");if(B!=null){if(B.commands&&B.commands.exec){A=B.commands.exec("maxZIndex");}}}var C=(!isNaN(E)&&E>-1?E:currentModalEditor.length)+mstr.controllers.ModalEditors.size();return A+C*2+100;}catch(D){microstrategy.errors.log(D);return 0;}};microstrategy.setCursorToEnd=function(B){if(B.createTextRange){var A=B.createTextRange();A.moveStart("character",B.value.length);A.collapse();A.select();}else{B.focus();}};microstrategy.openDialog=function(F,B,K,I,D){try{var L=(K!=null);if(!L){var K=[];}var A=new Array("5018","5017");var J=new Array(F,true);if(D){var E=new mstrSerializer();for(var C in D){var G=new mstrSerializer();G.addStr(C);G.addStr(D[C]);E.addStr(G.getState());}A.push("5024");J.push(E.getState());}K.push(this.updateManager.createActionObject(this,mstrUpdateManager.SHOW_BEAN,I,A,J,[]));if(!L){this.updateManager.add(K);}this.updateManager.addURL(B);return(L)?K:null;}catch(H){microstrategy.errors.log(H);return(K!=null)?K:false;}};microstrategy.getBonesByType=function(E){try{var B=[];var D=typeof (E);var C=(D.toLowerCase()=="string")?"~"+E+"~":"~"+E.join("~")+"~";for(var A in this.bones){if(C.search("~"+this.bones[A].type+"~")>-1){B.push(this.bones[A]);}}}catch(F){microstrategy.errors.log(F);}return B;};microstrategy.unregisterGridBones=function(C){try{for(var F in this.bones){var B=this.bones[F];if(B&&B.elem){var E=B.elem;var A=E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(A==microstrategy.SUBOBJTYPE_GRID_TABLE){microstrategy.unRegisterBone(F);}}}}catch(D){microstrategy.errors.log(D);}};microstrategy.adjustSelectedVisualization=function(I,C){try{var G;for(var F=0;F<I.visualizationList.length;F++){var A=I.visualizationList[F].name;if(A==I.selectedVisualization){G=I.visualizationList[F].vm;break;}}if(G==C){return ;}var J;for(var E=0;E<I.visualizationList.length;E++){var B=I.visualizationList[E].vm;if(B==C){J=I.visualizationList[E].name;break;}}if(J){var H=[];if(I.setVisualizationSettings){I.setVisualizationSettings(null,J,null,-1,H);}else{if(I.doc&&I.doc.setVisualizationSettings){I.doc.setVisualizationSettings(null,J,null,-1,H);}}this.updateManager.add(H);}}catch(D){microstrategy.errors.log(D);}};microstrategy.updateVisProps=function(E,I,G,A,J){try{if(E){J.visualizationsEnabled=E;}if(I!=null){J.selectedVisualization=I;}if(G!=null){var H=G.split(",");var C=J.getAllVisList();if(C&&H.length>0){J.visualizationList=[];for(var D=0;D<H.length;D++){var K=H[D];var F=C[K];if(F){J.visualizationList.push({name:K,desc:F.d,vm:F.vm});}}}}if(A&&A!=J.visualizationMode){J.visualizationMode=A;J.isVisualization=(A>=50);}}catch(B){microstrategy.errors.log(B);}};microstrategy.repaintContent=function(A){try{function D(K){var L=K&&K.rows,M=L&&L.length||0;for(var I=0;I<M;I++){var H=L[I].cells,G=H.length;for(var F=0;F<G;F++){var J=H[F].style;J.height="0px";J.height="auto";}}}var E=microstrategy.findAncestorWithAtt(document.getElementById(A),(bIsW3C)?"class":"className","repLayout");if(E){D(E);}var B=document.getElementById("mstrWebContentTable");D(B);}catch(C){microstrategy.errors.log(C);}};microstrategy.resolveBorderFlags=function(A,E){var C=[];try{if(A==0){C=[0];}else{if(A==31){C=[16];if(E){C=C.concat(1,2,4,8);}}else{var D=[1,2,4,8];for(i=0;i<4;i++){if((A&D[i])>0){C.push(D[i]);}}}}}catch(B){microstrategy.errors.log(B);}return C;};microstrategy.overwriteRequestParameters=function(D,A,B){try{var E=D.params||{};mstr.utils.Hash.overwrite(E,A);mstr.utils.Hash.overwrite(E,B);D.params=E;}catch(C){microstrategy.errors.log(C);}};microstrategy.openDataBasedBlockEditor=function(C,D,I,B,A,H,L,F){try{var G=this.getBlockEditorFromCache(C,B,A,H,F);if(G){return ;}var K=I.split(".");var J;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){J=new mstr.http.RwBlockLoaderInput(D,K[K.length-1]);}else{J=new mstr.http.ReportBlockLoaderInput(D,K[K.length-2]);}microstrategy.overwriteRequestParameters(J,B,A);this.openBlockEditor(C,J,H,L,F);}catch(E){microstrategy.errors.log(E);}};microstrategy.openFolderBasedBlockEditor=function(D,E,A,C,B,I,K,G){try{var H=this.getBlockEditorFromCache(D,C,B,I,G);if(H){return ;}var J=new mstr.http.FolderBlockLoaderInput(E,A);microstrategy.overwriteRequestParameters(J,C,B);this.openBlockEditor(D,J,I,K,G);}catch(F){microstrategy.errors.log(F);}};microstrategy.openBlockLoaderEditor=function(C,D,B,A,H,J,F){try{var G=this.getBlockEditorFromCache(C,B,A,H,F);if(G){return ;}var I=new mstr.http.BlockLoaderInput(D);microstrategy.overwriteRequestParameters(I,B,A);this.openBlockEditor(C,I,H,J,F);}catch(E){microstrategy.errors.log(E);}};microstrategy.getBlockEditorFromCache=function(E,C,A,J,H){try{var I=mstr.bones.editors.Map[this.id]&&mstr.bones.editors.Map[this.id][E];if(I&&!I.get("avoidCache")&&I.get("element").innerHTML){var B;var F=I.getModel();for(B in C){F.setPropertyByPath(B,C[B]);}if(F&&J){F.set("opener",J);}for(B in A){I.setPropertyByPath(B,A[B]);}if(J){I.set("opener",J);}var D=I.get("element");if(bIsW3CIE&&D.childElementCount===0){return ;}if(H&&!mstr.utils.Dom.containsElement(H,D,false)){H.appendChild(D);}I.set("visible",true);return I;}}catch(G){microstrategy.errors.log(G);}return null;};microstrategy.openBlockEditor=function(E,G,H,D,B){try{if(mstr.utils.ISIE4){self.supressWaitPage=true;}var C=document.createElement("textarea");C.setAttribute("id",E+"_ta");C.className="mstrJSON";if(B){B.appendChild(C);}else{document.body.appendChild(C);}if(!this.taskModel){this.taskModel=new mstr.models.TaskModel({parent:this});mstr.controllers.Factory.add(this.taskModel);var A=this.taskModel&&this.taskModel.init&&this.taskModel.init();if(!("id" in this)){mstr.controllers.Factory.add(this);}this.taskModel.attachEventListener(this,"set_readyState","handleTaskModelReadyStateChange");}this.taskModel.execFetchBlock(G,C,{editorId:E,opener:H,callback:D});}catch(F){microstrategy.errors.log(F);}};microstrategy.handleTaskModelError=function(A){if(mstr.utils.ISIE4){self.supressWaitPage=false;}rc=A.src.get("requestContext");var B=microstrategy.descriptors.getDescriptor(7484);if(rc&&rc.response){if(rc.response.taskErrorCode){switch(rc.response.taskErrorCode){case microstrategy.WEB_API_ERROR_CODES.MSI_SERVER_NAME_NOT_INITIALIZED:case microstrategy.WEB_API_ERROR_CODES.MSI_INVALID_SESSION_ID:case microstrategy.WEB_API_ERROR_CODES.E_MSI_USERMGR_USER_NOTFOUND:case microstrategy.WEB_API_ERROR_CODES.E_MSI_CONNECT_FAILED:this.updateManager.refreshPage();return ;default:B=B+microstrategy.descriptors.getDescriptor(7485)+rc.response.taskErrorCode;break;}}if(rc.response.data){B=B+"\n"+rc.response.data;}else{if(rc.response.status&&rc.response.statusText){B=B+"\n"+rc.response.status+": "+rc.response.statusText;}}}showMessage({contents:B,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});};microstrategy.handleTaskModelReadyStateChange=function(J){try{var A=J.src.get("requestContext");var H=function(){if(mstr.utils.ISIE4){self.supressWaitPage=false;}var K=A&&A.memo&&A.memo.callback;if(K){if(K.scope){K.method.apply(K.scope,[J]);}else{if(K.method){K.method(J);}}}};switch(J.memo.value){case mstr.Enum.Widget.READYSTATE.ERROR:microstrategy.handleTaskModelError(J);H();return ;case mstr.Enum.Widget.READYSTATE.IDLE:var B=mstr.bones.editors.Map[this.id]||{};var I=J.src.get("views");var C=A&&A.memo&&A.memo.opener;if(C){var F;for(F=0;I&&F<I.length;F++){I[F].set("opener",C);}var D=J.src.get("models");for(F=0;D&&F<D.length;F++){D[F].set("opener",C);}}var G=B[A.memo.editorId]=I[0];G.render();H();mstr.bones.editors.Map[this.id]=B;break;case mstr.Enum.Widget.READYSTATE.CANCELLED:H();break;}}catch(E){microstrategy.errors.log(E);}};mstrDNDHelperImpl.prototype={};mstrDNDHelperImpl.prototype.helperImg=null;mstrDNDHelperImpl.prototype.parentBone=null;mstrDNDHelperImpl.prototype.onmouseup=function(B){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener(B,"mousemove");this.parentBone.detachWinListener(B,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}this.parkHelperImage();}catch(A){microstrategy.errors.log(A);}};mstrDNDHelperImpl.prototype.parkObject=function(B){try{B.style.top="-10000px";B.style.left="-10000px";}catch(A){microstrategy.errors.log(A);}};mstrDNDHelperImpl.prototype.parkHelperImage=function(){try{if(this.helperImg){this.parkObject(this.helperImg);}}catch(A){microstrategy.errors.log(A);}};mstrDNDHelperImpl.prototype.moveHelperImage=function(D){try{if(!this.helperImg){this.initElement();}getMouse(D);this.helperImg.style.left=(lMouseX+10)+"px";this.helperImg.style.top=(lMouseY-20)+"px";var A=microstrategy.findAncestor(getEventTarget(D));if(A!=null){var C=this.getMaskedBone(A);if(C!=null&&C.getDNDHelperImage){var E=C.getDNDHelperImage(this.parentBone,A.getAttribute(microstrategy.HTMLATTR_POINTS_TO));if(E!=null&&this.helperImg.src.search(new RegExp(E))==-1){this.helperImg.src=E;}return ;}}this.parkHelperImage();}catch(B){microstrategy.errors.log(B);}};mstrDNDHelperImpl.prototype.getMaskedBone=function(A){try{var C=microstrategy.boneForMask(A);return(C!=null&&C.ondrop)?C:null;}catch(B){microstrategy.errors.log(B);return null;}};mstrDNDHelperImpl.prototype.initElement=function(){try{var A=document.createElement("img");A.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";A.style.position="absolute";A.style.top=A.style.left="-10000px";A.style.zIndex=1000;if(bIsIE6){A.style.height="auto";A.style.width="auto";}this.helperImg=document.body.appendChild(A);if(bIsIE6){A.style.height="auto";A.style.width="auto";}this.helperImg=document.body.appendChild(A);}catch(B){microstrategy.errors.log(B);}};function mstrDNDHelperImpl(A){this.parentBone=A;return this;}microstrategy.registerNewBones=function(){for(var C=0,B=microstrategy.bonesToRegister.length;C<B;C++){var A=microstrategy.bonesToRegister[C];microstrategy.registerBone(A.id,A.loadCondition,A.properties);}microstrategy.bonesToRegister.length=0;};microstrategy.addXmlAttr=function(A,C){try{return" "+A+'="'+C+'"';}catch(B){microstrategy.errors.log(B);return 0;}};microstrategy.addXmlAttrEncoded=function(C,F){if(!F){return"";}var B=[];var A=F.length;var E;for(var D=0;D<A;D++){E=F.charAt(D);switch(E){case">":B.push("&gt;");break;case"<":B.push("&lt;");break;case"&":B.push("&amp;");break;case"\u0009":B.push("&#x09;");break;case"\n":B.push("&#x0A;");break;case"\r":B.push("&#x0D;");break;case'"':B.push("&quot;");break;default:B.push(E);break;}}return" "+C+'="'+B.join("")+'"';};microstrategy.getPopupMask=function(H){var C=H&&H.popupMask;if(!C){if(!document.popupMasks){document.popupMasks=[];var F=document.getElementsByName("popupMask");if(F){for(var E=0,B=F.length;E<B;E++){F[E].setAttribute("free",true);document.popupMasks.push(F[E]);}}}var D=document.popupMasks;for(var E=0;E<D.length;E++){if(D[E].getAttribute("free")==true){C=D[E];break;}}if(!C){var G=document.getElementById("popupMask1");var A;if(G){A=G.cloneNode(false);}else{A=document.createElement("iframe");}document.body.appendChild(A);A.style.position="absolute";A.style.visibility="hidden";A.style.display="none";A.setAttribute("border","0");A.id="popupMask"+D.length;D.push(A);C=A;}}if(C){C.setAttribute("free",false);C.style.display="block";if(H){H.popupMask=C;C.elem=H;H.insertAdjacentElement("beforeBegin",C);C.style.visibility="visible";C.className="popupmask";}}return C;};microstrategy.releasePopupMask=function(D){if(D){var C=D.popupMask;if(C){C.style.display="none";C.style.visibility="hidden";C.style.zIndex=0;C.setAttribute("free",true);C.elem=null;}D.popupMask=null;}else{var E=document.popupMasks;if(E){for(var B=0;B<E.length;B++){E[B].style.display="none";E[B].style.visibility="hidden";E[B].style.zIndex=0;E[B].setAttribute("free",true);var A=E[B].elem;if(A){A.popupMask=null;}E[B].elem=null;}}}};microstrategy.execDynamiclLink=function(G,F,K){try{window.mstrSubmitLink=true;var I=null;var D=[G.tid];var A=null;var E=null;var H=microstrategy.updateManager;if(G.tty==microstrategy.DSSTYPE_RPT_DEFINITION){A=mstrUpdateManager.RUN_REPORT;I=["1001"];if(F){I.push("4222");D.push(F);}I.push("4115");D.push(microstrategy.getReportViewMode(G.tstp));}else{if(G.tty==microstrategy.DSSTYPE_DOC_DEFINITION){if(G.tstp==microstrategy.DSSSUB_TYPE_RW){var J=(G.tvmd&(8192|2048)&&!((G.tvmd&2048&&microstrategy.isFeatureAvailable("flashvi"))));if(J){if(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return ;}A=mstrUpdateManager.RUN_VI_DOCUMENT;}else{A=mstrUpdateManager.RUN_RW_DOCUMENT;}I=["2048001"];if(F){I.push("2048140");D.push(F);}if(G.so>0){I.push("2048087");D.push(this.bone("rwb_viewer").messageID);if(!F){I.push("2048201");D.push("0");}I.push("2048261");D.push(G.so);}}else{A=mstrUpdateManager.RUN_DOCUMENT;I=["1001"];if(F){I.push("32351");D.push(F);}}}}var C=H.useIframe;var L=H.newWindow;H.useIframe=false;H.newWindow=K;if(H.hasChangesToSubmit()){H.add([H.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}H.add([H.createActionObject(this.elem,A,"",I,D,[])]);H.flushAndSubmitChanges();H.acknowledgeRequest();H.newWindow=L;H.useIframe=C;}catch(B){microstrategy.errors.log(B);}};microstrategy.getReportViewMode=function(A){switch(A.toString()){case microstrategy.DSSTYPE_GRAPH:return microstrategy.DISPLAY_MODE_GRAPH;break;case microstrategy.DSSTYPE_GRID_AND_GRAPH:return microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;break;case microstrategy.DSSTYPE_GRID:default:return microstrategy.DISPLAY_MODE_GRID;break;}};microstrategy.isDoubleByte=function(){var A=microstrategy.displayLocaleID;if(A!=null&&(A==1041||A==1042||A==2052||A==1028)){return true;}return false;};microstrategy.loadAdditionalFiles=function(I){microstrategy.delayOnload();var E=document.getElementsByTagName("head")[0];for(var C=0,B=I.length;C<B;++C){var D="script",G="text/javascript",A=getResourcePathWithVersion(I[C]);if(bIsFirefox){var H=document.createElement(D),F="setAttribute";H[F]("src",A);H[F]("type",G);if(mstr.utils.ISFF4PLUS){H.async=false;}E.appendChild(H);}else{document.writeln("<"+D+' type="'+G+'" src="'+A+'" defer></'+D+">");}}};microstrategy.mstrOnLoadFn=null;microstrategy.delayOnload=function(){if(typeof (window.onload)=="function"){microstrategy.mstrOnLoadFn=window.onload;window.onload=null;if(mstr.utils.ISFF3_0){document.body.removeAttribute("onload");}}};microstrategy.getZoomFactor=function(){return microstrategy.ZOOM_FACTOR;};microstrategy.getPersistParams=function(){return microstrategy.persistParams;};microstrategy.useQuickSearch=function(){try{var D=(microstrategy.enableQuickSearch=="1");if(microstrategy.IServerVesion){var F=microstrategy.IServerVesion.split("."),E="9.2.400.013".split(".");for(var B=0,A=F.length;B<A;B++){if(F[B]>E[B]){break;}else{if(F[B]==E[B]){continue;}else{D==false;break;}}}}D=D&&(microstrategy.isQuickSearchEnabled);return D;}catch(C){microstrategy.errors.log(C);}};microstrategy.dynamicJS=[];microstrategy.insertScriptTag=function(D,E,C,F){var B=document.createElement("script");var A="setAttribute";B[A]("src",getResourcePathWithVersion(D));B[A]("type","text/javascript");B[A]("defer","defer");document.getElementsByTagName("head")[0].appendChild(B);if(bIsIE4){B.onreadystatechange=function(){if(B.readyState=="loaded"||B.readyState=="complete"){B.onreadystatechange=null;microstrategy.loadDynamicJS(E,C,F);}};}else{if(mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISFF4PLUS||bIsW3CIE){B.onload=function(){B.onload=null;microstrategy.loadDynamicJS(E,C,F);};}}};microstrategy.loadDynamicJS=function(B,A,C){if((bIsIE4||mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISFF4PLUS||bIsW3CIE)&&microstrategy.dynamicJS.length>0){if(!checkJSExists(microstrategy.dynamicJS[0]["key"])){microstrategy.insertScriptTag(microstrategy.dynamicJS[0]["file"],B,A,C);microstrategy.dynamicJS.shift();}else{microstrategy.dynamicJS.shift();microstrategy.loadDynamicJS(B,A,C);}}else{if(A){if(C){C();}else{microstrategy.eventManager.initializeBones(B);}}}};microstrategy.getVersion=function(){var A=microstrategy;return(A.buildVersion?"v="+A.buildVersion:"")+(A.appVersion?"&apv="+A.appVersion:"");};microstrategy.resourceLoader={LOADING:1,LOADED:2,status:{},TAG_DEF:{css:{n:"link",uri:"href",atts:{rel:"stylesheet",type:"text/css"},node:"styleSheets"},javascript:{n:"script",uri:"src",atts:{type:"text/javascript",defer:"defer"},node:"scripts"},image:{n:"img",uri:"src",atts:{},node:"images"}},checkStaticLoaded:function(E,B){if(E&&!this.status[E]){var A=this.TAG_DEF[B],C=document[A.node];if(C){var D=false,F=E;mstr.$A.forEach(C,function(I,G){var H=I[A.uri];if(H){D=new RegExp(encodeURIComponent(F)+"$","i").test(encodeURIComponent(H));if(D){return false;}}});this.status[E]=D;}}},buildURI:function(E,C,B,G){var D=(C=="javascript"?"js":C)+(B?"Mojo":"")+(G?"Bundle":"");var A={css:"../style/mstr",js:"../javascript",cssMojo:"../javascript/mojo/css",jsMojo:"../javascript/mojo/js/source",jsMojoBundle:"../javascript/bundles"}[D];var F=A+"/"+E;return getResourcePathWithVersion(F);},insertTag:function(F,C){var B=this.TAG_DEF[C||"javascript"];var E=document.createElement(B.n),A="setAttribute",G=this;for(var D in B.atts){E[A](D,B.atts[D]);}E[A](B.uri,F);E.onload=function(){E.onload=null;if(G){G.onFileLoad(F);G=null;E.onreadystatechange=null;}};E.onreadystatechange=function(){var H=E.readyState;if(H==="loaded"||H==="complete"){E.onreadystatechange=null;if(G){G.onFileLoad(F);G=null;E.onload=null;}}};document.getElementsByTagName("head")[0].appendChild(E);},onFileLoad:function(B){var A=this.status[B]||{},C=A.callback;A.state=this.LOADED;if(C){C();}},get:function(A,I,D,E,F){if(!A){if(F){F();}return ;}var C=this.buildURI(A,I,D,E);this.checkStaticLoaded(C,I);var G=this.status,H=G[C];if(!H){G[C]={state:this.LOADING,callback:F||function(){}};this.insertTag(C,I);}else{if(H.state===this.LOADING){if(F){var B=H.callback;H.callback=function(){if(B){B();}F();};}}else{if(H===true||H.state===this.LOADED){if(F){F();}}}}}};microstrategy.cssLoader={get:function(B,A,C){microstrategy.resourceLoader.get(B,"css",A,false,C);}};microstrategy.jsLoader={get:function(A,C,E,B){if(!A){if(E){E();}return ;}if(C){var D=function(){if(mstrConfig.projectName&&mstrmojo.locales&&!mstrmojo.locales.isLoaded){mstrmojo.locales.load(function(){microstrategy.resourceLoader.get(A,"javascript",C,C,E);});}else{microstrategy.resourceLoader.get(A,"javascript",C,C,E);}};if(typeof mstrmojo=="undefined"&&!B){microstrategy.resourceLoader.get("mojo-bootstrap.js","javascript",true,C,D);return ;}else{if(typeof mstrmojo!="undefined"){D();return ;}}}microstrategy.resourceLoader.get(A,"javascript",C,C,E);}};microstrategy.descriptorsLoader={loadDescriptors:function(A){loadDescriptorBundle=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(B){if(B){var D=B.descriptors.length,C;for(C=0;C<D;C++){var E=B.descriptors[C];mstrmojo.descriptors[E.key]=E.v;}}if(A.callback){A.callback();}},failure:function(){if(A.callback){A.callback();}}},{taskId:"getBundleDescriptors",bundle:A.bundle,localeID:microstrategy.displayLocaleID});};if(typeof mstrmojo=="undefined"&&!A.noBootstrap){microstrategy.jsLoader.get("mojo-bootstrap.js",true,function(){loadDescriptorBundle();});}else{loadDescriptorBundle();}}};microstrategy.mojoLoader={loadWidget:function(C){var E=this,B=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(F){var G=F.files;mstr.$A.forEach(G,function(H){microstrategy.dynamicJS.push({file:H.path,key:H.cls});});microstrategy.loadDynamicJS(null,true,function(){E.onload(C);E=null;});}},{taskId:"getBundles",bundles:C.bundle});},A=function(){microstrategy.jsLoader.get(C.bundle,true,function(){E.onload(C);E=null;});},D=microstrategy.jsBundleDebug?B:A;if(typeof mstrmojo=="undefined"&&!C.noBootstrap){microstrategy.jsLoader.get("mojo-bootstrap.js",true,function(){mstrmojo.locales.load(function(){D();});},true);}else{D();}},onload:function(B){var A=mstrmojo.all[B.id];if(!A&&B.scriptClass){var E=B.scriptClass,C=mstrmojo[E];if(!C){mstrmojo.requiresCls("mstrmojo."+E);C=mstrmojo[E];if(!C){return ;}}A=mstrmojo.insert(C);if(!A){return ;}var D=B.placeholder;if(D){A.placeholder=D;}}if(B.callback){B.callback();}}};microstrategy.showWait=function(A){var B=microstrategy.waitIcon;if(!B){B=document.createElement("div");B.className="mstrIcon-wait-container";B.style.cssText="position:fixed;left:0; top:0; right:0; bottom:0; z-index:"+microstrategy.getMaxZIndex();B.innerHTML='<div class="mstrIcon-wait" style="position:absolute;top:48%;left:48%;z-index:10;"><div class="mstrIcon-close-wait" onmousedown="microstrategy.showWait(false)" title="Cancel"></div>';'</div><div class="mstrCurtain"></div>';microstrategy.waitIcon=document.body.appendChild(B);}B.style.display=A===false?"none":"block";};microstrategy.openCustomGroupEditor=function(C){if((bIsIE6&&!bIsIE7)||bIsIEQuirks){showMessage({contents:microstrategy.descriptors.getDescriptor("7914"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_INFO});return ;}microstrategy.showWait();var H="mstrCGE",E=function(K){K.scriptClass="mstrmojo.Obj";var J=mstrmojo.insert(K),I=mstrmojo.all[H];if(!I){return ;}I.set("model",J);I.open();microstrategy.showWait(false);},F=function(){var I={success:function(J){if(!J){mstrmojo.alert("Error retrieving the Custom Group definition!");return ;}E(J);},failure:function(J){microstrategy.showWait(false);mstrmojo.alert(J.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,I,{taskId:"getCustomGroup",customGroupId:C,styleName:"MojoCustomGroupStyle"});},D=function(){E({cgp:{agg:1,flat:false,pf:true,rfi:-1,ce:true,isp:true}});},A=window.mstrmojo,B=A&&A.all[H],G=C?F:D;if(!B){microstrategy.mojoLoader.loadWidget({scriptClass:"CustomGroupEditor",id:H,bundle:"mojo-cge.js",callback:G});}else{G();}};microstrategy.openCustomSortEditor=function(G){if((bIsIE6&&!bIsIE7)||bIsIEQuirks){showMessage({contents:microstrategy.descriptors.getDescriptor("7914"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_INFO});return ;}microstrategy.showWait();var B="mstrCSort",H=G.att,K=H.dssId,D=H.dssSetId,J=G.mid,F=G.uKey,C=function(L){var M=mstrmojo.all[B]||mstrmojo.insert({scriptClass:"mstrmojo.sort.CustomSortEditor",id:B});M.set("model",L);M.onSave=G.onSave;M.open();microstrategy.showWait(false);},A=function(){var M={success:function(N){C(N);},failure:function(N){microstrategy.showWait(false);mstrmojo.alert(N.getResponseHeader("X-MSTR-TaskFailureMsg"));}},L={taskId:"getCustomSort",msgID:J,dsId:D,uKey:F,objectID:K};mstrmojo.xhr.request("GET",mstrConfig.taskURL,M,L);},E=window.mstrmojo,I=E&&E.all[B];if(!I){microstrategy.mojoLoader.loadWidget({id:B,bundle:"mojo-CustomSort.js",callback:A});}else{A();}};microstrategy.openMetricEditor=function(C){microstrategy.showWait();var E="mstrMetricIDE",D=function(){var F=mstrmojo.all[E];if(!F){F=mstrmojo.insert({id:E,metricId:C,scriptClass:"mstrmojo.ME.MetricIDE"});}else{F.set("metricId",C);}F.open(null,{action:{cmd:C?"edit":"add"}});microstrategy.showWait(false);};var A=window.mstrmojo,B=A&&A.all[E];if(!B){microstrategy.mojoLoader.loadWidget({bundle:"mojo-metric.js",id:E,callback:D});}else{D();}};microstrategy.openDataImport=function(O){var E="Data Import is not supported in your browser. We support Chrome 20+, Firefox 21+, Safari 5.1+ and Internet Explorer 8+. Please update your browser to import data.",K,J,I=ua.indexOf("Firefox")>-1,B=ua.indexOf("Chrome")>-1,C=parseFloat(ua.replace(/.*?(Firefox|Chrome|MSIE\s|Version)\/?(\d+\.\d).*/,"$2")),H=document.documentMode,G=microstrategy.bones.folderAllModes,P=G&&G.folderId,Q=this;if(!!document.all){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){K=!!ua.match(/MSIE 6/);J=((!!ua.match(/MSIE 7/)&&!H)||H===7);}else{K=!!ua.match(/MSIE 6/);J=!!ua.match(/MSIE 7/)&&!ua.match(/Trident/);}}if(K||J||(I&&C<21)||(B&&C<20)){var L=document.getElementById("dataImportError");if(!L){var F=document.getElementById("mstrWeb_content"),M=document.createElement("div");M.id="dataImportError";M.className="session_recovery_msg";M.innerHTML='<div class="message-before-grid warning"><div id="warning_session_timeout_countdownMsg">'+E+"</div></div>";F.parentNode.insertBefore(M,F);}return ;}microstrategy.showWait();var D=function(){var S;if(Q.dataImportId){S=mstrmojo.all[Q.dataImportId];}if(!S){S=mstrmojo.insert({scriptClass:"mstrmojo.DI.DIContainer"});S.dataImportCallback=function(T){var U=document.getElementById("formRefresh");if(U&&T&&T.length>0){submitForm(U);}};Q.dataImportId=S.id;}if(O){mstrmojo.hash.copy(O,S.dataImportParams);if(O.callback){S.dataImportCallback=function(T){O.callback(T);};}else{if(O.isCalledByFlex){S.dataImportCallback=function(U){if(U&&U.length>0){var T;if(navigator.appName.indexOf("Microsoft")!=-1){T=window.MstrFlashFlashViewer;}else{T=document.MstrFlashFlashViewer;}if(T){T.onCloseDI(U);}}};}}}if(P){mstrmojo.hash.copy({cubeSaveFolderId:P},S.dataImportParams);}S.open();microstrategy.showWait(false);};var A=function(){var T={success:function(U){if(U){D();}else{if(mstrApp.onSessionExpired){mstrApp.onSessionExpired();}}}},S={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,T,S);};var R=function(){microstrategy.cssLoader.get("cge.css",true);if(mstr.utils.ISIE9||mstr.utils.ISIE9Pre){microstrategy.cssLoader.get("data-import-ie.css",true,A);}else{microstrategy.cssLoader.get("data-import.css",true,A);}};var N=function(){microstrategy.mojoLoader.loadWidget({bundle:"mojo-di.js",callback:R});};if(!this.dataImportId){microstrategy.descriptorsLoader.loadDescriptors({bundle:"mojo-di",callback:N});}else{A();}};microstrategy.isDefaultTheme=function(A){return A===microstrategy.THEME_DARK_ID||A===microstrategy.THEME_LIGHT_ID;};microstrategy.hasAppliedTheme=function(C,D){var F,B,E=microstrategy.getViewerBone(),A=E.elem;while(C&&C!=A){F=C.id;B=F&&E.formattingAttributes[F]&&E.formattingAttributes[F]["thmlnk"];if(B===true||B===false){if(D){return B;}else{return true;}}else{C=microstrategy.findAncestor(C.parentNode);}}return false;};microstrategy.showSaveAsThemeEditor=function(){var H="saveAsThemeEditor",E=0,D=1,A=window.mstrmojo&&mstrmojo.all[H],G=function(J,I){microstrategy.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,I,J);},C=function(){microstrategy.showWait(false);A=mstrmojo.insert({scriptClass:"mstrmojo.SaveAsEditor",id:H,title:mstrmojo.desc(14562,"Save Theme As"),searchVisible:false,displaySaveLabel:false,folderLinksContextId:36,showCompletePath:false,browsableTypes:"8,14082",cssClass:"mstrmojo-SaveAsEditor saveAsThemeEditor",saveParams:{taskId:"saveRWTheme"},typeDesc:mstrmojo.desc(12083,"Theme"),saveAs:function(K){var I=this.contPanel;this.name=I.name.value;this.desc=I.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var L=this.saveParams||{};L.msgID=mstrApp.getMsgID();L.folderID=this.ob.currentFolder.did;L.objName=this.name||"";L.objDesc=this.desc||"";L.saveAsFlags=!!K?D:E;var J=this.saveAsCallback();J.failure=function(N){var M=N.getResponseHeader("X-MSTR-TaskErrorCode"),P=this.parent;if(M==="-2147217373"||M==="-2147216857"){mstrmojo.warn(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",P.typeDesc||"Object").replace("###",P.name),{confirmBtn:{fn:function(){P.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite")});}else{var O=N.message||N.getResponseHeader("X-MSTR-TaskFailureMsg");if(M==="-2147214579"){O=mstrmojo.desc(12587,"You do not have write access to this folder. Please select a different folder.");}mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+O);}};J.complete=function(){microstrategy.showWait(false);};J.parent=this;G(L,J);}});A.open();};var B=function(){if(A){A.open();}else{microstrategy.showWait();microstrategy.jsLoader.get("mojo-theme.js",true,C);}},F=function(){microstrategy.showWait(false);};mstrmojo.confirm(mstrmojo.desc(14565,"Only formatting options set as Control Default will be saved into Document Theme."),null,{id:"confirmation_dialog",title:mstrmojo.desc(11812,"Notification"),allowHTML:true,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),B,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),F)],onPreClose:function(){F();return true;}});};microstrategy.showApplyThemeEditor=function(C,B,A){var F="applyThemeEditor",D=window.mstrmojo&&mstrmojo.all[F],E=function(){microstrategy.showWait(false);D=mstrmojo.insert({scriptClass:"mstrmojo.CustomThemePicker",id:F,cssClass:"applyThemeEditor",zIndex:200,showApplyAsOptions:C,applyAsLink:!!B,onThemePicked:A});D.render();D.open();};if(D){D.set("showApplyAsOptions",C);if(typeof B==="boolean"){D.set("applyAsLink",B);}D.onThemePicked=A;D.open();}else{microstrategy.showWait();microstrategy.jsLoader.get("mojo-theme.js",true,E);}};microstrategy.openACLEditor=function(F,G,C){var H="mstrACL",E=[],A=function(J){var I=mstrmojo.all[H];if(!I){I=mstrmojo.insert({scriptClass:"mstrmojo.DI.ui.dialogs.DIPermissionDialog",id:H,oi:J,cubeid:F,candidates:E});}else{I.set("oi",J);I.cubeid=F;I.candidates=E;}I.formTypes=J.formTypes;I.open();},B=function(){var I={success:function(K){var L;mstrmojo.array.forEach(K.mapping.datap,function J(N){mstrmojo.array.forEach(N.maps&&N.maps.amps,function M(O){L=O.aimp;if(mstrmojo.array.find(E,"did",L.atid)===-1){E.push({n:L.atnm,did:L.atid,t:12});}});});if(E.length===0){K.canEdit=0;}A(mstrmojo.DI.DICubesList.prototype.populateACLItems(K));},failure:function(J){mstrmojo.alert(J.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){iframe.hideWaitPage();}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,I,{taskId:"DIGetCubeSecurityFilter",cubeid:F,isNew:true});};iframe.showWaitPage();var D=window.mstrmojo&&mstrmojo.all[H];if(D){B();}else{microstrategy.jsLoader.get("mojo-di.js",true,B);}};microstrategy.showSharingEditor=function(D,M,C,I){var H="sharingEditor",B=mstrApp.oi,G=(M&&M.objId)||B.objId,E=(M&&M.objType)||B.objType,K=(M&&M.mid)||mstrApp.getMsgID&&mstrApp.getMsgID(),J=I&&I.showLinkOnOpen,A=function(P){var O=mstrmojo.all[H];if(!O){I=I||{};P.acls=I.acls||P.acls;O=mstrmojo.insert(mstrmojo.hash.copy(I,{scriptClass:"mstrmojo.SharingEditor",guestModeEnabled:microstrategy.guestModeEnabled,mid:K,id:H,oi:P,href:D,isLinkDirty:C,viewMode:M?M.viewMode:1,lastState:M?M.lastState:0,showWait:function(){iframe.showWaitPage();},hideWait:function N(){iframe.hideWaitPage();}}));}else{O.set("oi",P);O.href=D;O.mid=K;O.isLinkDirty=C;O.viewMode=M?M.viewMode:1;O.lastState=M?M.lastState:0;O.showLinkOnOpen=J;}O.open();},F=function(){var N={success:function(O){A(O.objects[0]);},failure:function(O){mstrmojo.alert(O.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){microstrategy.showWait(false);}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,N,{taskId:"getObjectInfo",objectIDs:G,objectTypes:E,includeACL:microstrategy.isFeatureAvailable("web-use-sharing-editor"),sessionState:mstrApp.sessionState});};microstrategy.showWait();var L=window.mstrmojo&&mstrmojo.all[H];if(L){F();}else{microstrategy.jsLoader.get("mojo-sharing.js",true,F);}};microstrategy.openAdvSortEditor=function(D){var H=D.isReportDesignMode||D.isDocDesignMode,B=D.targetGrid,C="advancedSortEditor",L=window.mstrmojo&&mstrmojo.all[C],F={beanPath:D.beanPath,stp:D.subtotalPosition,onAdvancedSort:function J(a,U,b,Z,V){var S,R,T,X,Q,N,O,P,Z=window.parseInt(Z,10),c=[],Y=microstrategy.updateManager,W=function(f){var e=f.split("!"),d=false;if(e.length>0&&e[0]==microstrategy.DSSTYPE_METRIC){d=true;}return d;};for(S=0;S<2;S++){if(U[S]!=null){O=(S==0)?microstrategy.GRIDCELL_AXIS_ROWS:microstrategy.GRIDCELL_AXIS_COLUMNS;X=true;Q="1";for(R=0;T=U[S][R];R++){X=false;N=T.isAsc?"1":"0";if(W(T.key)&&!isNaN(Z)&&Z!=-1){P=Y.createActionObject(null,mstrUpdateManager.VIEW_EVENT_HIERARCHICAL_METRIC_SORT,this.beanPath,["4011","4012","4013","4138","4262","4015","4123"],[T.key,N,Q,this.stp[O],V,Z,1]);}else{P=Y.createActionObject(null,mstrUpdateManager.VIEW_EVENT_SORT,this.beanPath,["4011","4012","4013","4138","4262"],[T.key,N,Q,this.stp[O],V]);}c.push(P);Q="0";}if(X){P=Y.createActionObject(null,mstrUpdateManager.CLEAR_SORT,this.beanPath,["4006"],[O]);c.push(P);}}}if(c.length>0&&Y){if(D.isDocDesignMode){P=Y.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.beanPath,[],[],[],null);c.push(P);}Y.add(c,true);Y.flushAndSubmitChanges();}}},K=function(N){var P=mstrmojo.all[C]||mstrmojo.insert({scriptClass:"mstrmojo.AdvancedSortEditor",id:C,postCreate:function O(){if(mstr.utils.ISIE8){mstrmojo.css.addWidgetCssClass(this,"ie8");}}});if(H){N=D.sortData;}P.set("sortData",N);P.set("controller",F);P.set("xtab",null);P.set("sourceAxis",D.sourceAxis||1);P.set("sourceType",D.sourceType||-1);P.set("isDesignMode",H);P.open();},M={success:function(N){K((N.grids&&N.grids[0])||N);},failure:function(N){mstrmojo.alert(N.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){microstrategy.showWait(false);}},E=function(){if(H){K({});microstrategy.showWait(false);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,M,D.taskParams);}};if(H){var G=microstrategy.updateManager;if(G.newActions){G.add([G.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,D.beanPath,[],[],[],null)]);G.flushAndSubmitChanges(false,{success:function(){window.setTimeout(function(){if(D.isDocDesignMode){microstrategy.bone("rwb_viewer").commands.exec("edtSortGrid",D.sourceAxis);}else{microstrategy.bone("UniqueReportID").commands.exec("sort",D.sourceAxis);}},1);}});return ;}var A={rows:[],cols:[],appliedRows:[],appliedCols:[]},I=function(P){var S,R,V,N,U=B.gridStructureInfo,O=U.rowAxis,W=U.colAxis,T=U.metricAxis,Q=function(b,c,a){var X,Z,Y=b.attFormList.forms.length;for(X=0;Z=b.attFormList.forms[X];X++){if(Z[microstrategy.FORM_LIST_STATUS]==microstrategy.FORM_NOT_ON_WS){Y--;}}if(Y>1&&!c.showAttForms){return b.alias+" ("+a[microstrategy.FORM_LIST_NAME]+")";}else{if(Y>1){return b.alias+" "+a[microstrategy.FORM_LIST_NAME];}}return b.alias;};for(S=0;V=O.units[S];S++){if(!V.isMetricTemplateUnit&&V.attFormList.forms){for(R=0;N=V.attFormList.forms[R];R++){if(N[microstrategy.FORM_LIST_STATUS]!=microstrategy.FORM_NOT_ON_WS){P.rows.push({n:Q(V,U,N),v:V.dssType+"!"+V.dssId+"!"+N[microstrategy.FORM_LIST_ID]+"!"+microstrategy.DSSTYPE_ATTRIBUTE_FORM});}}}}for(S=0;V=W.units[S];S++){if(!V.isMetricTemplateUnit&&V.attFormList.forms){for(R=0;N=V.attFormList.forms[R];R++){if(N[microstrategy.FORM_LIST_STATUS]!=microstrategy.FORM_NOT_ON_WS){P.cols.push({n:Q(V,U,N),v:V.dssType+"!"+V.dssId+"!"+N[microstrategy.FORM_LIST_ID]+"!"+microstrategy.DSSTYPE_ATTRIBUTE_FORM+"!!"+microstrategy.GRIDCELL_AXIS_COLUMNS});}}}}if(U.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS&&W.units.length==1){for(S=0;V=T.units[S];S++){P.rows.push({n:V.alias,v:V.dssType+"!"+V.dssId+"!!!!"+microstrategy.GRIDCELL_AXIS_ROWS});}}P.appliedRows=B.sortRules.appliedRows;P.appliedCols=B.sortRules.appliedCols;P.hierarchicalSort=B.hierarchicalSort;return P;};D.sortData=I(A);}if(D.isReportDesignMode){if(!D.isReportBlank){D.taskParams.applyChanges="1";}else{showMessage({contents:"You must save this report before you can sort it.",elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+B.id+"').commands.exec('dmSaveAs');",buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("118")},type:mstrMsgBoxImpl.MSG_WARNING});return ;}}microstrategy.showWait();if(L){E();}else{microstrategy.jsLoader.get("mojo-sort.js",true,E);}};microstrategy.isFeatureAvailable=function(B){try{var A=true;return((microstrategy.features!=null)&&typeof (microstrategy.features[B])!="undefined");}catch(C){microstrategy.errors.log(C);return false;}};microstrategy.setupPageMessageDisplay=function(){try{var D=document.getElementById("message-before-grid");if(D){var F=function(){D.style.display="none";microstrategy.eventManager.notifyOrphanBones("onwinresize");};var A=document.createElement("img");A.src="../images/1ptrans.gif";A.title=microstrategy.descriptors.getDescriptor(2102);A.className="mstrIcon-btn mstrIcon-btnClose";A.style.cssText="position:absolute; right:1px; top:0; height:20px;width:20px;";A.onclick=F;D.appendChild(A);var B=3000,C=D.getAttribute("ty");switch(C){case"err":B=3600*1000;break;case"sub":case"hl":B=8000;}window.setTimeout(F,B);}}catch(E){microstrategy.errors.log(E);}};microstrategy.renderVis=function(F,E,D){if(!E||!E.scriptClass){alert("no mojo class defined");return ;}var G=E.id,B=function(){E=mstrmojo.hash.copy(E,D);var H=mstrmojo.all[E.id];var K=function J(){if(typeof (mstrmojo.Vis)!=="undefined"&&H instanceof mstrmojo.Vis){H.setModel(F);}else{var L=mstrmojo.insert({scriptClass:"mstrmojo.Obj",data:F});H.setModel(L);}H.render();};if(H&&H.scriptClass===E.scriptClass){mstrmojo.hash.copy(E,H);H.unrender();K();}else{if(H){H.destroy();}mstrmojo.requiresCls(E.scriptClass);H=mstrmojo.insert(E);if(H){K();}else{var I=window.setInterval(function(){H=mstrmojo.insert(E);if(H){window.clearInterval(I);K();}},1000);}}};var A=window.mstrmojo,C=A&&A.all[G];if(!C){microstrategy.mojoLoader.loadWidget({bundle:E.bundle||"mojo-bootstrap.js",id:G,callback:B});}else{B();}};microstrategy.addCSRFTokenToURL=function(A){if(!A){return"";}var C=(window.microstrategy&&microstrategy.validateRandNum)||(window.mstrConfig&&mstrConfig.validateRandNum)||(window.mstrApp&&mstrApp.validateRandNum);if(C&&C.length>0){if(A.indexOf("validateRandNum")==-1){try{if(!microstrategy.isUrlExternal(A)){if(A.indexOf("?")>=0){A+="&";}else{A+="?";}A+="validateRandNum="+C;}}catch(B){}}}return A;};microstrategy.uploadDashboardFile=function(H){var E=document.getElementById(H),D=microstrategy.findChildWithAtt(E,"input","name","myFile"),C=D.value,F=function(){if(mstr.utils.ISIE4){var I=document.createElement("form");D.parentNode.insertBefore(I,D);I.appendChild(D);I.reset();I.removeNode(false);}};if(C==""){return ;}else{if(/\.mstr$/.test(C.toLowerCase())){microstrategy.showWait(true);addURLAsHiddenInputsToForm(E,microstrategy.addCSRFTokenToURL(microstrategy.servletName+"="+encodeURIComponent(microstrategy.servletState)));var G=microstrategy.bones.folderAllModes;if(G){var B=document.getElementById("import_folderID");B.value=G.folderId;}if(!microstrategy.findChildWithAtt(E,"input","name","formId")){var A=document.createElement("input");A.type="hidden";A.name="formId";A.value=E.id;E.appendChild(A);}E.submit();E.reset();}else{mstr_descs=microstrategy.descriptors;showMessage({title:mstr_descs.getDescriptor(11226),contents:mstr_descs.getDescriptor(11227),type:mstrMsgBoxImpl.MSG_ERROR,elements:microstrategy.OK_BUTTON});}}F();};microstrategy.uploadVisualizationFile=function(E){var C=document.getElementById(E),B=microstrategy.findChildWithAtt(C,"input","name","myFile"),A=B.value,D=function(){if(mstr.utils.ISIE4){var F=document.createElement("form");B.parentNode.insertBefore(F,B);F.appendChild(B);F.reset();F.removeNode(false);}};if(A==""){return ;}else{if(/\.zip$/.test(A.toLowerCase())){C.submit();C.reset();}else{mstr_descs=microstrategy.descriptors;showMessage({title:"Unrecognized file",contents:"Please select a file with .zip extension.",type:mstrMsgBoxImpl.MSG_ERROR,elements:microstrategy.OK_BUTTON});}}D();};microstrategy.getExecuteDashboardUrl=function(E){var C=microstrategy.servletName,D,F;if(microstrategy.isFeatureAvailable("flashvi")){D=2048001;F={visMode:0};}else{D=3140;F={};}F.documentID=E;F.evt=D;F.src=C+"."+D;var A=[];for(var B in F){if(!F.hasOwnProperty(B)){continue;}A.push(encodeURIComponent(B)+"="+encodeURIComponent(F[B]));}return microstrategy.addCSRFTokenToURL(C+"?"+A.join("&"));};microstrategy.uploadCallback=function(res){microstrategy.jsLoader.get("import-bundle.js",true,function(){var success=res.status==200,resContent=res.content,sn=microstrategy.servletName,mstr_descs=microstrategy.descriptors,updateAndSubmitForm=function(params){var form=document.getElementById(resContent.formId||"import_form"),newInputsAdded=[],i=0,formInput;mstrmojo.hash.forEach(params,function(value,key){if(key==="folderId"){if(mstr.utils.ISIE8){var folder_id=document.getElementById("import_folderID");if(folder_id){folder_id.value=value;}}}else{formInput=document.createElement("input");formInput.type="hidden";formInput.name=key;formInput.value=value;form.appendChild(formInput);newInputsAdded[i++]=formInput;}});window.setTimeout(function(){form.submit();for(var i=0;i<newInputsAdded.length;i++){form.removeChild(newInputsAdded[i]);}},0);};if(resContent&&resContent.messageID){var folderId=(resContent.fdid?resContent.fdid:"");if(resContent.isConflict){var replaceFn=function(){updateAndSubmitForm({messageID:resContent.messageID,resume:true});},saveAsFn=function(){var renameEditor=mstrmojo.insert({scriptClass:"mstrmojo.ui.editors.RenameEditor",renameText:resContent.n,title:mstrmojo.desc(13052,"Upload"),zIndex:1002,onRename:function(newName){if(mstrmojo.string.isEmpty(newName)){mstrmojo.alert("Please enter a valid name",null,null,1004);return false;}else{updateAndSubmitForm({messageID:resContent.messageID,resume:true,dashboardName:newName});var conflictDialog=mstrmojo.all.ImportNameConflictDialog;if(conflictDialog){conflictDialog.destroy();}}}});renameEditor.open();return false;},closeFn=function(){microstrategy.showWait(false);};mstrmojo.confirm(mstrmojo.desc(8134,"The Dashboard ## already exists. Do you want to replace the existing Dashboard?").replace("##",("<strong>"+resContent.n+"</strong>")),null,{id:"ImportNameConflictDialog",title:mstrmojo.desc(13052,"Upload"),allowHTML:true,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(219,"Yes"),replaceFn,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3167,"Save As"),saveAsFn,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),closeFn)],onPreClose:function(){closeFn();return true;}});}else{updateAndSubmitForm({messageID:resContent.messageID,folderId:folderId});}}else{if(success){var okUrl=microstrategy.addCSRFTokenToURL(sn+"?evt=2001&src="+sn+".2001"+((resContent&&resContent.fdid)?("&folderID="+resContent.fdid):"&systemFolder=20")),dashboarUrl=microstrategy.getExecuteDashboardUrl(resContent.did),closeAndLoadUrl=function(url){if(this.parent===null&&this.close){this.close();}else{this.parent.parent.close();}eval(url);};viewDashboardFn=mstrmojo.emptyFn,shareDashboardFn=function(){microstrategy.showSharingEditor(resContent.servletPath+dashboarUrl,{objectName:resContent.n,objId:resContent.did,objType:"55",mid:-1},false,{showLinkOnOpen:true});};if(!microstrategy.isFeatureAvailable("flashvi")&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){viewDashboardFn=function(){closeAndLoadUrl.call(this);mstrmojo.alert(mstr_descs.getDescriptor(12187));};}else{viewDashboardFn=function(){closeAndLoadUrl.call(this,"location.href = '"+dashboarUrl+"'");};}var folderAllModes=microstrategy.bones.folderAllModes;var uploadResultEditor=mstrmojo.insert({scriptClass:"mstrmojo.onetier.vi.ui.UploadResultEditor",folderName:((folderAllModes&&folderAllModes.folderName)||"My Reports"),dashboardName:resContent.n,okFn:function(){closeAndLoadUrl.call(this,"location.href = '"+okUrl+"'");},viewDashboardFn:viewDashboardFn,shareDashboardFn:shareDashboardFn});uploadResultEditor.open();}else{mstrmojo.error({longDesc:res.errorMsg});}microstrategy.showWait(false);}},false);};microstrategy.addRecentObjectInfo=function(E){var B=window.localStorage,C=window.sessionStorage;if(!B||!window.JSON){return ;}var G="recentObjects"+mstrConfig.lastMsgKey,D=B.getItem(G)||[];if(D.length===0){D.push(E);B.setItem(G,JSON.stringify(D));}else{var A=JSON.parse(D);A.unshift(E);var F=A.length;if(F>20){A.splice(-1,(F-20));}B.setItem(G,JSON.stringify(A));}};microstrategy.clearRecentObjects=function(){var A=window.localStorage,B=window.sessionStorage;if(!A||!window.JSON){return ;}A.removeItem("recentObjects"+mstrConfig.lastMsgKey);};microstrategy.getRecentObjectsCount=function(){var A=window.localStorage,B=window.sessionStorage;if(!A||!window.JSON){return ;}var C=JSON.parse(A.getItem("recentObjects"+mstrConfig.lastMsgKey))||[];return C.length;};microstrategy.handleRecentObjects=function(){try{var G=window.localStorage,P=window.sessionStorage;if(!G||!window.JSON){return ;}var B=[];var O=function(S){var R,T=false;for(R in B){if(B[R].lastRecovered){continue;}if(B[R].did===S.did){T=true;break;}}return T;};var Q=function(R){var S="";switch(R){case 3:S="reportID=";break;case 55:S="documentID=";break;default:S="messageID=";break;}return S;};var C=function(V){var U=V.ty;var R="";switch(U){case 55:var T=V.vm;switch(T){case 8192:case 2048:R="mstrIcon-lv-rw avm";break;case 1:default:R="mstrIcon-lv-rw";break;}break;case 3:var S=V.viewMode;switch(S){case 1:R="mstrIcon-lv-g";break;case 2:R="mstrIcon-lv-gp";break;case 3:R="mstrIcon-lv-gpgs";break;default:R="";break;}break;}return R;};var M=JSON.parse(G.getItem("recentObjects"+mstrConfig.lastMsgKey));try{var H=mstrConfig.lastMsgKey,J=(JSON.parse(decodeURIComponent(microstrategy.getCookieSetting("lastMsgID")||"{}")))[H],L=function(R){return R&&(R.length===32)&&/^[A-Z0-9]{32}$/.test(R);};}catch(K){}if(L(J)){var F={};var A="lastMsgRecoveryInfo"+H,N=G.getItem(A);if(N){var N=JSON.parse(N);F.recoveryInfo=N;F.recoveryURL=microstrategy.addCSRFTokenToURL("?"+N.url.replace(/messageID.*/,"messageID="+J)),F.recoveryName=N.n;F.recoveryType=N.ty;F.did=N.did;F.iconClass=C(N);F.lastRecovered=true;B.push(F);}}for(var E in M){var I=M[E];if(I===""){continue;}var F={};var N=JSON.parse(I);F.recoveryInfo=N;F.recoveryURL=microstrategy.addCSRFTokenToURL("?"+N.url.replace(/messageID.*/,Q(N.ty)+N.did));F.recoveryName=N.n;F.recoveryType=N.ty;F.did=N.did;F.iconClass=C(N);F.lastRecovered=false;if(!O(F)){B.push(F);}}return B;}catch(D){microstrategy.errors.log(D);}};microstrategy.handleLastMessageRecovery=function(){try{var I=window.localStorage,O=window.sessionStorage;if(!I||!window.JSON){return ;}if(!microstrategy.enableAutomaticSessionRecovery){return ;}if(!microstrategy.showRecoverLink){return ;}try{var V=mstrConfig.lastMsgKey,M="lastMsgID",F=(JSON.parse(decodeURIComponent(microstrategy.getCookieSetting("lastMsgID")||"{}")))[V],G=function(W){return W&&(W.length===32)&&/^[A-Z0-9]{32}$/.test(W);};}catch(T){return ;}var U=O.getItem("msg_browser_not_closed"+V)===null;var D=O.getItem("msg_user_login")==1;O.setItem("msg_user_login",0);var H=I.getItem("msg_recovery_notify"+V)==="1";I.setItem("msg_recovery_notify"+V,"0");if(!G(F)){return ;}var P={LIVE_OR_HL:0,PERSISTED:1},Q=parseInt(microstrategy.getCookieSetting("sessionResCode"),10),L=U&&Q===P.PERSISTED;var N="lastMsgRecoveryInfo"+V,A=I.getItem(N);if(!A){return ;}A=JSON.parse(A);var B=microstrategy.addCSRFTokenToURL("?"+A.url.replace(/messageID.*/,"messageID="+F)),C=A.n,R=A.typeDescId,K=function(){var W=document.getElementById("mstr-auto-recovery-link");if(W&&C){var X=microstrategy.descriptors.getDescriptor("11866").replace("#",C);W.href=B;W.innerHTML=X;W.style.display="";W.parentNode.title=X;W.parentNode.style.display="";}},S=function(){if(!L&&H&&C&&D){var W=document.getElementById("mstrWeb_content"),X=document.createElement("div");X.className="session_recovery_msg";X.innerHTML='<div class="message-before-grid warning"><div id="warning_session_timeout_countdownMsg">'+microstrategy.descriptors.getDescriptor(11867).replace("####",'<a href="'+B+'">').replace("###","</a>").replace("##","<b>"+C+"</b>").replace("#",microstrategy.descriptors.getDescriptor(R))+"</div></div>";W.parentNode.insertBefore(X,W);}I.setItem("msg_recovery_notify"+V,"0");O.setItem("msg_user_login",0);},J=function(){var W=JSON.parse(decodeURIComponent(microstrategy.getCookieSetting(M)||"{}"));microstrategy.updateCookieSetting(M,JSON.stringify(W,function(Y,X){return Y==V?undefined:X;}));I.removeItem(N);};if(!C){J();return ;}if(Q===P.PERSISTED){K();S();}else{if(Q===P.LIVE_OR_HL){mstr.$XHR.request(mstrConfig.taskURL,{taskId:"docXMLResults",msgID:F,resultFlags:33554432},{success:function(W){K();S();},failure:function(X,W){if(W===2147498310){J();}}});}}}catch(E){microstrategy.errors.log(E);}};microstrategy.newDatasetObjectsBlock=function(D){var C=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"DAE-RWD-ObjectBrowser-container",visible:false,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2870,"Objects")},{scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",cssClass:"DAE-RWD-ObjectBrowser",bindings:{items:"this.parent.datasets"},item2textCss:function B(G){var F={3:"rpt",4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[G.t]||"";if(G.da||G.um||G.rdm){F+=" derived";}return F;},itemFunction:function(H,F,I){var G=mstrmojo.WidgetTree.prototype.itemFunction(H,F,I);G.state=!!H.items?1:2;if(G.state===2){G.draggable=true;G.getDragData=function(){return{item:H,html:G.domNode.outerHTML};};}return G;},onnodemousedown:function E(H){var F=H.hWin,J=H.e,I=mstrmojo.dom.eventTarget(F,J),G=mstrmojo.dom.findWidget(I);if(G){if(C.selectNode){C.selectNode.set("selected",false);}C.selectNode=G;G.set("selected",true);}},ondblclick:function A(){var F=C.selectNode;if(F.state===2){D(F.data);}}}]});return C;};microstrategy.hasCGorCon=function hasCGorCon(A){return mstr.$A.filter(A.att,{filter:function(C){var E=(C.t===1||C.t===47),D=(C.t===12&&C.de),B=(C.t===47&&C.st===12033);return(E&&!B||D);}},"filter").length>0;};microstrategy.openDerivedAttrEditor=function(A){A.isDM=false;A.wid="mstrDerivedAttrIDE";A.sc="mstrmojo.ME.DerivedAttributeIDE";A.wrapperClz="mstrmojo-DerivedAttrIDE-rwd";microstrategy._openDADMEditor(A);};microstrategy.openDerivedMetricEditor=function(A){A.isDM=true;A.wid="mstrMetricIDE";A.sc="mstrmojo.ME.DerivedMetricIDE";A.wrapperClz="mstrmojo-DerivedMetricIDE-rwd";microstrategy._openDADMEditor(A);};microstrategy._openDADMEditor=function(D){var F=D.wid,B=window.mstrmojo&&mstrmojo.all[F],E=microstrategy.getViewerBone(),A=function(I){var G=[],J,M,H;for(M in I){J=I[M];if(!D.isDM&&(J.isMDX&&J.isDDA||microstrategy.hasCGorCon(J))){continue;}var L=mstrmojo.array.filter(J.att,function(N){return N.st!==mstrmojo.expr.STP.CONS&&N.st!==mstrmojo.expr.STP.CUSTOMGROUP&&(N.st!==mstrmojo.expr.STP.NDE||N.st===mstrmojo.expr.STP.NDE&&D.isDM)&&N.did!==D.metricId;}),K=mstrmojo.array.filter(J.mx,function(N){return !N.um&&!N.rdm;});H={n:J.name,did:J.did,t:3,items:[].concat(L).concat(!D.isDM&&J.isMDX?[]:(D.isDM?J.mx:K))};G.push(H);}G.sort(function(O,N){return mstrmojo.array.stringSorter(O.n,N.n);});return G;},C=function(){if(!B){B=mstrmojo.insert({id:F,scriptClass:D.sc,datasetsObjects:microstrategy.newDatasetObjectsBlock(function(J){B.onObjectInsert(J);}),zIndex:4,postCreate:function I(){mstrmojo.css.addWidgetCssClass(this,D.wrapperClz);if(E){this.attachEventListener("visibleChange",this.id,function(){if(!this.visible){E.mojoEditor--;}});}}});}B.datasetsObjects.set("datasets",A(D.datasets));if(D.isDM){if(D.dsid){D.disableAFB=D.datasets[D.dsid].isMDX;}B.open(null,D);}else{if(D.onAttribute){var G=D.onAttribute,H=G.fs&&G.fs[0];if(H){D.funccat=mstrmojo.ME.DerivedAttributeIDE.getDefaultFunctionCategory(G);D.refOi={n:G.n+"@"+H.fnm,did:G.did+"@"+H.fid};}}D.cmd="editNew";B.action=D;B.open(null,{editorId:B.action.id});}if(E){E.mojoEditor=(E.mojoEditor||0)+1;}microstrategy.showWait(false);};if(!B){microstrategy.showWait();microstrategy.mojoLoader.loadWidget({bundle:"mojo-dae.js",id:F,callback:C});}else{C();}};microstrategy.submitHyperlink=function submitHyperlink(C){var D=C.getAttribute("hv")||C.href,A=C.target;if(microstrategy.isUrlExternal(D)){return true;}var F=document.createElement("FORM");F.name="dynamic_form";F.method="POST";var E=D.indexOf("?")>0,B=((E)?D.substring(0,D.indexOf("?")):D);F.action=B;if(E){addURLAsHiddenInputsToForm(F,D);}document.body.insertAdjacentElement("beforeEnd",F);if(A){F.target=A;}F.submit();if(window.event){window.event.cancelBubble=true;}return false;};microstrategy.addJSessionID=function addJSessionID(B){var A=microstrategy;if(!!A.addJSessionIdToURL&&A.httpSessionId&&B.indexOf("jsessionid=")==-1){return B+";jsessionid="+A.httpSessionId;}return B;};microstrategy.allowCreateReport=function(A){if(A&&A.ddam===2){showMessage({contents:microstrategy.descriptors.getDescriptor(13384),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_INFO});return false;}return true;};microstrategy.convertFromCube=function(C){var F=this,E=C.type,G=C.dsid,B=C.isJsonMode,A=microstrategy.bones.folderAllModes,D=A&&A.folderId;microstrategy.getCubesInfo([G],function(J){var L=J[G],O=microstrategy.servletName,N=(L&&!L.published&&microstrategy.isCubeSupportDDA(L)),H=!!N?128:0,I={};if(L&&L.ddam!==2&&!L.published){showMessage({contents:microstrategy.descriptors.getDescriptor(14111),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor(9242)},okEval:function(){if(C.st===779&&(C.et&microstrategy.EXTENDED_TYPE_DATA_IMPORT)>0){F.openDataImport({CubeDesc:"",CubeName:C.executeReport,ReportId:C.dsid,StatusCode:2,isEdit:false,callback:function(){F.convertFromCube(C);}});}else{submitCM(C.executeReport,false);}},type:mstrMsgBoxImpl.MSG_ERROR});return ;}switch(E){case"document":I={evt:"3104",src:O+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:G,rwCreateFlags:0};if(D){I.saveFolderId=D;}break;case"analysis":I={evt:"3104",src:O+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:G,rwCreateFlags:16,rwViewMode:8192};break;case"HTML5VI":I={evt:"3185",src:O+".3185",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:G,rwCreateFlags:32};if(B===false){I.jsonMode=false;}if(D){I.saveFolderId=D;}break;case"report":if(!microstrategy.allowCreateReport(L)){return ;}I={evt:"3005",src:O+".3005",srcID:G,srcType:2,reportDesignMode:1};break;}if(typeof I.rwCreateFlags==="number"){I.rwCreateFlags|=H;}var P,K=[],M=microstrategy.servletName+"?";for(P in I){if(I.hasOwnProperty(P)){K.push(P+"="+I[P]);}}M+=K.join("&");submitCM(M,false);});};microstrategy.createReportFromCube=function(A){var C=A.dsid,B=A.form;microstrategy.getCubesInfo([C],function(D){var E=D[C];if(!microstrategy.allowCreateReport(E)){return ;}B.submit();});};microstrategy.isUrlExternal=function isUrlExternal(A){var C=window.location.href;var B=(A.indexOf("?")===0||A.indexOf(microstrategy.servletName)===0||A.indexOf("./"+microstrategy.servletName)===0||A.indexOf(mstrConfig.taskURL)===0||A.indexOf("./"+mstrConfig.taskURL)===0||A.indexOf(C)===0||((C.indexOf("?")>0)&&(A.indexOf(C.substring(0,C.indexOf("?")))===0)));return !B;};microstrategy.scrollPageHorizontally=function(B){try{var A=30,D=lMouseX-getClientWidth(),E=document.documentElement.scrollLeft||document.body.scrollLeft,F=lMouseX-E<A?-A:(D>-A?A:0);document.documentElement.scrollLeft+=F;document.body.scrollLeft+=F;}catch(C){microstrategy.errors.log(C);}};microstrategy.submitForm=function(B,A){if(A!==false){iframe.showWaitPage();A=true;}B.submit();if(A){iframe.hideWaitPage();}};microstrategy.initFolderNavigationListener=function(){if(!window.onpopstate){window.onpopstate=function(){if(this.needToIgnorePop===undefined){this.needToIgnorePop=mstr.utils.ISSAFARI;}if(this.needToIgnorePop){this.needToIgnorePop=false;return ;}var A=document.URL;if(history.state&&history.state.target){var B=history.state.target;A=history.state.href;A=replaceURLParameter(A,"iframe","true");if(B=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){if(!bIsIE7||document.readyState=="complete"){var C=createDynamicForm(A);if(B){C.target=B;}}submitForm(C);}return false;}else{window.open(A,"_self");}};}};microstrategy.initReportNavigationListener=function(){if(!window.onpopstate&&history.pushState){window.onpopstate=function(){if(this.needToIgnorePop===undefined){this.needToIgnorePop=mstr.utils.ISSAFARI;}if(this.needToIgnorePop){this.needToIgnorePop=false;return ;}if(window.mstrSubmitLink){window.mstrSubmitLink=false;event.stopImmediatePropagation();return ;}var E=window.localStorage,D=parseInt((history.state&&history.state.index),10)||0,C=(E.getItem("nlli"));E.setItem("nlli",D);if(microstrategy.bones.pathBean_ReportPathStyle){microstrategy.bones.pathBean_ReportPathStyle.commands.exec("openPage",(D<=C)?"-1":"1");}};var A=document.URL,B=A.split(/[?#]/)[0];historyIndex=parseInt((history.state&&history.state.index),10)||0;history.pushState({target:A,href:A,index:historyIndex},B,B);}};microstrategy.tryNewHome=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(A){mstrmojo.form.send({evt:"3010",src:mstrApp.name+".3010"});}},{taskId:"setPreference",prefs:"startPage\u001E3194"});};microstrategy.loadIframeIdle=function(){var A=createDynamicForm(microstrategy.addCSRFTokenToURL(microstrategy.servletName+"?pg=iframeIdle"));A.target="frameManager";microstrategy.submitForm(A,false);document.body.removeChild(A);};microstrategy.errors=new mstrErrorsImpl;mstrErrorsImpl.prototype.errorMsg="";mstrErrorsImpl.prototype.staticErrorMsg="";mstrErrorsImpl.prototype.callers=new Array();mstrErrorsImpl.prototype.errorObj=null;mstrErrorsImpl.prototype.log=function(B){try{if(this.errorMsg.length==0){this.errorMsg=(!B.description)?B:B.description;var H=(microstrategy.descriptors!=null)?"*JavaScript errors were encountered on this page.*":"JavaScript errors were encountered on this page.";var E=(microstrategy.descriptors!=null)?microstrategy.descriptors.getDescriptor("2947"):"Click here for more details.";window.status=H;if(bIsFirefox){this.errorObj=B;}else{var F=0;var I=this.log.caller;while(I!=null){this.callers[this.callers.length]=String(I.toString());I=I.caller;F++;if(F>25){break;}}}if(this.staticErrorMsg.length==0){var A=document.createElement("div");A.className="mstrAlert";var C=document.createElement("img");C.src=microstrategy.FOLDER_IMAGES+"DocError.gif";C.setAttribute("id","mstrJSErrorImg");A.appendChild(C);A.appendChild(document.createTextNode(" "+H+" "+E));A.onclick=new Function("microstrategy.errors.show();");var D=document.getElementById("mstrWeb_error");if(D){D.insertAdjacentElement("afterEnd",A);microstrategy.eventManager.ondialogresize();}}this.staticErrorMsg="";if(typeof (console)!="undefined"){console.log(B);console.trace&&console.trace();}}}catch(G){alert(B.description);}return ;};mstrErrorsImpl.prototype.clear=function(){try{this.errorMsg="";this.callers=new Array;}catch(A){alert(A);}return ;};mstrErrorsImpl.prototype.show=function(){try{if(this.staticErrorMsg.length==0){var I=microstrategy.descriptors.getDescriptor("2948")+"<br /><br />"+this.errorMsg+"<br/>";if(this.errorObj){var B=this.errorObj;if(B.fileName&&B.lineNumber){I+="&nbsp;&nbsp;&nbsp;&nbsp;at "+B.fileName+":"+B.lineNumber+"<br /><br />";}this.errorObj=null;}else{for(var D=0;D<this.callers.length;D++){var H=methodName="";var F=this.callers[D].indexOf("@class");if(F!=-1){H=this.callers[D].substr(F+7);H=H.substr(0,H.indexOf(";"));}F=this.callers[D].indexOf("@method");if(F!=-1){methodName=this.callers[D].substr(F+8);methodName=methodName.substr(0,methodName.indexOf(";"));}I+="&nbsp;&nbsp;&nbsp;&nbsp;at ";if(H&&methodName){I+=H+"."+methodName+"</br>";}else{if(bIsIE4){I+="unknown "+this.callers[D].substr(0,this.callers[D].indexOf("{")).replace(/\n/g,"")+"<br/>";}else{var E=this.callers[D];var C=this.callers[D].indexOf("\n");var A=this.callers[D].indexOf("{");if(C>A){C=0;}else{C++;}I+="unknown "+this.callers[D].substr(C,A)+"<br/>";}}}}this.staticErrorMsg=I.replace(/\n/g,"<br/>");this.clear();}showMessage({contents:this.staticErrorMsg,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}catch(G){alert(G);}return ;};function mstrErrorsImpl(){return this;}mstrBoneImpl.prototype={};mstrBoneImpl.prototype.features={};mstrBoneImpl.prototype.isDormant=false;mstrBoneImpl.prototype.winListeners={};mstrBoneImpl.prototype.onload=function(){try{this.initBone();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrBoneImpl.prototype.onreload=function(){try{this.inReload=true;var B=true;if(!this.isBoneInPage()){microstrategy.unRegisterBone(this.id);}else{if(!this.isLoaded){B=this.onload();}else{if(getElementById(this.id)!=this.elem&&!this.disabled){this.onunload();B=this.onload();}}}}catch(A){microstrategy.errors.log(A);B=false;}this.inReload=false;return B;};mstrBoneImpl.prototype.isBoneInPage=function(){try{var B=getElementById(this.id);return(B&&(B.getAttribute("dialog")!="true"||B.childNodes.length>0));}catch(A){microstrategy.errors.log(A);return true;}};mstrBoneImpl.prototype.onrepostload=function(){try{if(!this.isPostLoaded){return this.onpostload();}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrBoneImpl.prototype.onpostload=function(B){try{this.isPostLoaded=true;return true;}catch(A){microstrategy.errors.log(A);}return true;};mstrBoneImpl.prototype.onmove=function(A){};mstrBoneImpl.prototype.onunload=function(C){try{for(var A in this.winListeners){this.detachWinListener(this.winListeners[A]);delete mstr.controllers.Factory._objs[A];}delete this.elem;this.isLoaded=false;}catch(B){microstrategy.errors.log(B);}return true;};mstrBoneImpl.prototype.initBone=function(){try{this.elem=getElementById(this.id);if(!this.elem){this.onunload();return false;}this.winListeners={};this.isLoaded=true;this.isPostLoaded=false;return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrBoneImpl.prototype.absorbObject=function(D,A){try{for(var E in D){if(A&&typeof (D[E])=="object"){if(typeof this[E]=="undefined"){this[E]={};}if(typeof this[E]=="object"){for(var C in D[E]){this[E][C]=D[E][C];}}}else{this[E]=D[E];}}}catch(B){microstrategy.errors.log(B);}};mstrBoneImpl.prototype.updateFeatures=function(D){try{var B=D&&D.features;if(B){for(var A in B){this.setFeature(A,B[A]);}}}catch(C){microstrategy.errors.log(C);}};mstrBoneImpl.prototype.setTimeout=function(condition,methodToExecute,timeOut){try{if(eval(condition)){eval(methodToExecute);}else{methodToExecute=methodToExecute.replace(/"/g,'\\"');condition=condition.replace(/"/g,'\\"');window.setTimeout('microstrategy.bone("'+this.id+'").setTimeout("'+condition+'", "'+methodToExecute+'",'+timeOut+");",timeOut);}}catch(err){microstrategy.errors.log(err);return false;}};mstrBoneImpl.prototype.isFeatureAvailable=function(B){try{var A=true;if((this.features!=null)&&typeof (this.features[B])!="undefined"){A=this.features[B];}return A;}catch(C){microstrategy.errors.log(C);return false;}};mstrBoneImpl.prototype.hasFeatures=function(){try{for(var B in this.features){return true;}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrBoneImpl.prototype.setFeature=function(A,C){try{if(this.features!=null){this.features[A]=C;}}catch(B){microstrategy.errors.log(B);return false;}};mstrBoneImpl.prototype.attachWinListener=function(D,A,E,B){try{if((!D.id||!microstrategy.bone(D.id))){if(!D.id&&D.path){D.id=D.path;}mstr.controllers.Factory.add(D);}if(!this.winListeners[D.id]){this.winListeners[D.id]={};}if(typeof (B)=="undefined"||B||(!this.winListeners[D.id][A])){this.winListeners[D.id][A]=E;if(typeof (mstr)!="undefined"){mstr.controllers.Factory.registerWindow(window);mstr.controllers.EventManager.attachWindowEventListener(D,A,E);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrBoneImpl.prototype.bindingEvents=function(B,C){if(typeof (mstr)!="undefined"){for(var A in C){this.attachWinListener(B,A,C[A].s);}}else{for(var A in C){document["on"+A]=new Function("e",C[A].a);}}};mstrBoneImpl.prototype.detachWinListener=function(E,A){try{var B=(E.id)?E.id:E;if(!this.winListeners[B]){return ;}if(A){mstr.controllers.EventManager.detachWindowEventListenerById(B,A);delete this.winListeners[B][A];}else{for(var D in this.winListeners[B]){if(typeof (mstr)!="undefined"){mstr.controllers.EventManager.detachWindowEventListenerById(B,D);}}delete this.winListeners[B];}}catch(C){microstrategy.errors.log(C);return false;}};mstrBoneImpl.prototype.initEvent=function(B,A){B=B||window.event;if(B.e){B=B.e;}if(A){getMouse(B);}return B;};function mstrBoneImpl(B){try{this.isLoaded=false;this.inReload=false;this.isPostLoaded=false;this.primaryBone=false;this.features={};this.id=B;return this;}catch(A){microstrategy.errors.log(A);return false;}}microstrategy.HTMLATTR_SIZES="SIZES";microstrategy.HTMLATTR_SIZES_DELIM=",";microstrategy.HTMLATTR_DRAG_DISABLED=0;microstrategy.HTMLATTR_DRAG_ENABLED=1;mstrDialogImpl.prototype=new mstrBoneImpl();mstrDialogImpl.prototype.titleBar=null;mstrDialogImpl.prototype.topPosition=null;mstrDialogImpl.prototype.leftPosition=null;mstrDialogImpl.prototype.rect=null;mstrDialogImpl.prototype.isMidDrag=false;mstrDialogImpl.prototype.closeAfterDrag=false;mstrDialogImpl.prototype.afterresize=null;mstrDialogImpl.prototype.errorMessage=null;mstrDialogImpl.prototype.resizeHorizontally=false;mstrDialogImpl.prototype.resizeVertically=false;mstrDialogImpl.prototype.focusFieldId=null;mstrDialogImpl.prototype.onselectstartFn=null;mstrDialogImpl.prototype.MIN_WIDTH=135;mstrDialogImpl.prototype.MAX_WIDTH=9999;mstrDialogImpl.prototype.onload=function(){try{this.initDialog();this.initErrorMessage();}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.initDialog=function(){try{this.initBone();this.isDraggable=((parseInt(this.elem.getAttribute("dg"))&1)!=0);this.initTitleBar();this.initBody();this.initStatusBar();this.addListeners();this.setFocus();}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.addListeners=function(){if(typeof (mstr)!="undefined"){this.attachWinListener(this,"resize","onresize");}else{document.onresize=new Function("e","return microstrategy.bone('"+this.id+"').onresize(e);");}};mstrDialogImpl.prototype.initErrorMessage=function(){try{if(this.errorMessage){this.renderErrorMessage();}}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.initResize=function(){try{if(this.elem){this.resizeLevel=parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_RESIZE));if(this.resizeLevel&&!isNaN(this.resizeLevel)){if(this.resizeLevel&microstrategy.RESIZE_VERTICAL){this.resizeVertically=true;}if(this.resizeLevel&microstrategy.RESIZE_HORIZONTAL){this.resizeHorizontally=true;}}if(this.resizeVertically||this.resizeHorizontally){this.initResizeHandles();this.moveResizeHandles();}}}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.renderErrorMessage=function(){try{showMessage({contents:this.errorMessage,elements:microstrategy.OK_BUTTON,okEval:"microstrategy.bone('"+this.id+"').onCloseErrorMessage()",type:mstrMsgBoxImpl.MSG_ERROR});}catch(A){microstrategy.errors.log(A);}};mstrDialogImpl.prototype.onCloseErrorMessage=function(){try{this.setFocus();}catch(A){microstrategy.errors.log(A);}};mstrDialogImpl.prototype.initTitleBar=function(){try{if(this.elem){this.titleBar=microstrategy.subObjectFind(this.elem,["DIV","TD","TR"],microstrategy.SUBOBJTYPE_TITLEBAR);if(this.titleBar){var A=this.elem.getAttribute(microstrategy.HTMLATTR_DRAG);A=(!isNaN(parseInt(A)))?parseInt(A):microstrategy.HTMLATTR_DRAG_DISABLED;if(A&microstrategy.HTMLATTR_DRAG_ENABLED){this.titleBar.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').ondragdialogmousedown(e);");}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDialogImpl.prototype.closeDialog=function(){try{if(this.isMidDrag){this.closeAfterDrag=true;return ;}this.closeAfterDrag=false;var B=2;this.fadeOut(B);}catch(A){microstrategy.errors.log(A);}};mstrDialogImpl.prototype.fadeOut=function(B){try{B=B-2;if(false){window.setTimeout("microstrategy.bone('"+this.id+"').fadeOut("+B+")",0);}else{this.elem.style.visibility="hidden";togglePulldowns(this.elem,true);var A=parseInt(this.elem.getAttribute("op"));A=90;if(isNaN(A)||A<1){A=100;}}}catch(C){microstrategy.errors.log(C);}};mstrDialogImpl.prototype.ondragdialogmousedown=function(C){try{this.onselectstartFn=document.onselectstart;if(!C){C=window.event;}var D=getEventTarget(C);if(D.tagName=="IMG"){return false;}document.onselectstart=function(){return false;};this.rect=getElementById(this.id+"_dg");if(this.rect==null){var B=document.createElement("div");B.id=this.id+"_dg";B.className="dragRect";this.elem.appendChild(B);this.rect=B;}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragdialogstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e","return microstrategy.bone('"+this.id+"').ondragdialogstart(e);");document.onmouseup=new Function("e","return microstrategy.bone('"+this.id+"').onmouseup(e);");}}catch(A){this.hideDragVisualCue();microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.ondragdialogstart=function(D){try{if(!D){D=window.event;}if(D.e){D=D.e;}var A=false;if(this.rect){if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragdialog");this.attachWinListener(this,"mouseup","ondragdialogend");}else{document.onmousemove=new Function("e","return microstrategy.bone('"+this.id+"').ondragdialog(e);");document.onmouseup=new Function("e","return microstrategy.bone('"+this.id+"').ondragdialogend(e);");}this.isMidDrag=true;this.rect.style.display="block";this.rect.style.visibility="visible";getMouse(D);var B=microstrategy.findAncestor(getEventTarget(D));if(B!=null){this.leftPosition=lMouseX;this.topPosition=lMouseY;if(this.rect){this.rect.style.width=getObjWidth(this.elem)+"px";this.rect.style.height=getObjHeight(this.elem)+"px";}this.ondragdialog(D);}else{A=true;}}else{A=true;}if(A){this.hideDragVisualCue();this.isMidDrag=false;this.onmouseup(D);}return false;}catch(C){this.hideDragVisualCue();this.isMidDrag=false;this.onmouseup(D);microstrategy.errors.log(C);return false;}};mstrDialogImpl.prototype.ondragdialogend=function(C){try{this.isMidDrag=false;if(!C){C=window.event;}if(C.e){C=C.e;}this.onmouseup(C);getMouse(C);togglePulldowns(this.elem,true);if(this.rect!=null){var D=getObjSumLeft(this.rect);var B=getObjSumTop(this.rect,document.getElementById("mstrWebContents"));if(D<0){D=1;}if(B<0){B=1;}this.move(D,B);this.hideDragVisualCue();}if(this.closeAfterDrag){this.closeDialog();}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.resizePopUp=function resizePopUp(E){try{if(E){var C=E.getAttribute("popupMask");if(C&&C.style){var A=getObjWidth(E);A=A||getObjInnerWidth(E);var B=getObjHeight(E);B=B||getObjInnerHeight(E);C.style.width=A+"px";C.style.height=B+"px";}}}catch(D){microstrategy.errors.log(D);}};mstrDialogImpl.prototype.onresize=function(A){this.resizePopUp(this.elem);};mstrDialogImpl.prototype.hideDragVisualCue=function(){try{if(this.rect){this.rect.style.visibility="hidden";this.rect.style.display="none";}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.ondragdialog=function(B){try{if(!B){B=window.event;}if(B.e){B=B.e;}getMouse(B);moveObjTo(this.rect,lMouseX-this.leftPosition,lMouseY-this.topPosition);}catch(A){microstrategy.errors.log(A);}return false;};mstrDialogImpl.prototype.move=function(E,D){try{if(this.moveTo(E,D)){var A=microstrategy.updateManager;if(A&&this.beanPath){var C=[];C.push(A.createActionObject(this.elem,mstrUpdateManager.SET_TOPLEFT_POSITION,this.beanPath,["73001","73002"],[getObjTop(this.elem),getObjLeft(this.elem)],[]));A.add(C,true);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrDialogImpl.prototype.moveTo=function(C,B){try{C=Math.floor(C);B=Math.floor(B);if(C!=getObjLeft(this.elem)||B!=getObjTop(this.elem)||C==0||B==0){moveObjTo(this.elem,C,B);}togglePulldowns(this.elem,false);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.initBody=function(){try{if(this.elem){this.body=microstrategy.subObjectFind(this.elem,["DIV","TD"],microstrategy.SUBOBJTYPE_BODY);}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.initStatusBar=function(){try{if(this.elem){this.statusBar=microstrategy.subObjectFind(this.elem,["DIV"],microstrategy.SUBOBJTYPE_STATUSBAR);}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.onCellResize=function(){this.moveResizeHandles();};mstrDialogImpl.prototype.initResizeHandles=function(){try{if(!this.resizeBottom){this.resizeBottom=document.createElement("img");this.resizeBottom.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";this.resizeBottom.style.position="absolute";this.resizeBottom.style.height="3px";this.resizeBottom.style.width="3px";if(!bIsIE4&&bIsW3C){this.resizeBottom.style.display="none";}if(this.resizeVertically){this.resizeBottom.style.cursor="n-resize";this.resizeBottom.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').onDialogResizeDown(e);");}this.elem.appendChild(this.resizeBottom);}if(!this.resizeRight){this.resizeRight=this.resizeBottom.cloneNode(true);this.resizeRight.style.width="3px";this.resizeRight.style.top="0px";if(this.resizeHorizontally){this.resizeRight.style.cursor="e-resize";this.resizeRight.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').onDialogResizeDown(e);");}this.elem.appendChild(this.resizeRight);}}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.moveResizeHandles=function(){try{if(this.resizeBottom==null){return false;}var cWidth=(this.elem.style!=null&&this.elem.style.width!=null&&this.elem.style.width.length>0&&parseInt(this.elem.style.width)==getObjWidth(this.elem))?parseInt(this.elem.style.width):getObjWidth(this.elem);var cHeight=(this.elem.style!=null&&this.elem.style.height!=null&&this.elem.style.height.length>0&&parseInt(this.elem.style.height)==getObjHeight(this.elem))?parseInt(this.elem.style.height):getObjHeight(this.elem);with(this.resizeBottom.style){width=cWidth+"px";top=(cHeight-3)+"px";left="0px";}with(this.resizeRight.style){height=cHeight+"px";left=(cWidth-3)+"px";top="0px";}if(!bIsIE4&&bIsW3C){this.resizeBottom.style.display="block";this.resizeRight.style.display="block";}}catch(err){microstrategy.errors.log(err);return false;}};mstrDialogImpl.prototype.onDialogResizeDown=function(B){try{if(!B){B=window.event;}getMouse(B);this.resizeX=lMouseX;this.resizeY=lMouseY;this.resizeHandler=getEventTarget(B);if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","onDialogResizeStart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e","return microstrategy.bone('"+this.id+"').onDialogResizeStart(e);");document.onmouseup=new Function("e","return microstrategy.bone('"+this.id+"').onmouseup(e);");}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.onDialogResizeStart=function(B){try{if(!B){B=window.event;}if(B.e){B=B.e;}document.body.style.cursor=this.resizeHandler.style.cursor;this.resizeRight.onmouseout=null;this.tempHandler=document.createElement("img");this.tempHandler.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";this.tempHandler.style.position="absolute";this.tempHandler.style.zIndex=10000;this.tempHandler.style.backgroundColor="#ffff00";if(this.resizeHandler.style.cursor.toLowerCase()=="e-resize"){this.tempHandler.style.left=getObjSumLeft(this.resizeRight);this.tempHandler.style.top=getObjSumTop(this.resizeRight);this.tempHandler.style.width="3px";this.tempHandler.style.height=this.resizeRight.style.height;}else{if(this.resizeHandler.style.cursor.toLowerCase()=="n-resize"){this.tempHandler.style.left=getObjSumLeft(this.resizeBottom);this.tempHandler.style.top=getObjSumTop(this.resizeBottom);this.tempHandler.style.width=this.resizeBottom.style.width;this.tempHandler.style.height="3px";}}document.body.appendChild(this.tempHandler);if(this.resizeVertically){this.resizeBottom.style.cursor="n-resize";this.resizeBottom.style.height="3px";}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","onDialogResize");this.attachWinListener(this,"mouseup","onDialogResizeEnd");}else{document.onmousemove=new Function("e","return microstrategy.bone('"+this.id+"').onDialogResize(e);");document.onmouseup=new Function("e","return microstrategy.bone('"+this.id+"').onDialogResizeEnd(e);");}this.onDialogResize(B);return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.onDialogResize=function(F){try{if(!F){F=window.event;}if(F.e){F=F.e;}getMouse(F);if(this.elem==null){return false;}this.resizeBottom.style.zIndex=-200;this.resizeRight.style.zIndex=-200;var I=getObjSumLeft(this.elem);var G=getObjSumTop(this.elem);var D=lMouseX-this.resizeX;var C=lMouseY-this.resizeY;var A=this.MIN_WIDTH;if(this.resizeHandler.style.cursor.toLowerCase()=="e-resize"){if(lMouseX<(I+A)){D=A-getObjLeft(this.resizeHandler);this.resizeBottom.style.width=A+"px";}else{var H=getObjWidth(this.resizeBottom)+D;if(H<0||H>this.MAX_WIDTH){return false;}this.resizeBottom.style.width=H+"px";}moveObjTo(this.resizeHandler,getObjLeft(this.resizeHandler)+D,getObjTop(this.resizeHandler));moveObjTo(this.tempHandler,getObjSumLeft(this.resizeHandler)+D,getObjSumTop(this.resizeHandler));}else{if(this.resizeHandler.style.cursor.toLowerCase()=="n-resize"){if(lMouseY<(G+A)){C=A-getObjHeight(this.resizeRight);this.resizeRight.style.height=A+"px";}else{var E=getObjHeight(this.resizeRight)+C;if(E<0){return false;}this.resizeRight.style.height=E;}moveObjTo(this.resizeHandler,getObjLeft(this.resizeHandler),getObjTop(this.resizeHandler)+C);moveObjTo(this.tempHandler,getObjSumLeft(this.resizeHandler),getObjSumTop(this.resizeHandler)+C);}}this.resizeX=lMouseX;this.resizeY=lMouseY;return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrDialogImpl.prototype.onDialogResizeEnd=function(G){try{if(!G){G=window.event;}if(G&&G.e){G=G.e;}this.onmouseup(G);var F=getObjLeft(this.resizeRight)+2;this.elem.style.width=(F)+"px";this.resizeRight.style.zIndex=1;if(this.resizeVertically){if(this.elem.style.height!=(getObjHeight(this.elem)+"px")){this.elem.style.height=(getObjTop(this.resizeBottom)-SCROLLBAR_SIZE)+"px";}else{this.elem.style.height=(getObjTop(this.resizeBottom)+2)+"px";}}this.resizeBottom.style.zIndex=1;if(this.mask){this.mask.onmaskedobjectresize();}this.resizeHandler.style.backgroundColor="";var D=this.updateManager;var A=[];var C=this.id;var H=getObjWidth(this.elem);var B=this.elem.style.height;document.body.style.cursor="auto";document.body.removeChild(this.tempHandler);microstrategy.eventManager.ondialogresize();if(this.afterresize){this.afterresize(F);}return false;}catch(E){microstrategy.errors.log(E);return false;}};mstrDialogImpl.prototype.onmouseup=function(C,B){try{document.onselectstart=this.onselectstartFn;if(typeof (mstr)!="undefined"){this.detachWinListener((B)?B:this,"mousemove");this.detachWinListener((B)?B:this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.initResize();this.setFocus();}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.setFocus=function(){try{if(this.focusFieldId){if(this.focusTimer){window.clearTimeout(this.focusTimer);}this.focusTimer=window.setTimeout("microstrategy.bone('"+this.id+"').doSetFocus()",100);}}catch(A){microstrategy.errors.log(A);return false;}};mstrDialogImpl.prototype.doSetFocus=function(){try{if(this.focusFieldId){var B=this.elem.getElementsByTagName("form")[0];if(B){var C=B.elements[this.focusFieldId];if(C){microstrategy.setCursorToEnd(C);}}}}catch(A){microstrategy.errors.log(A);return false;}};function mstrDialogImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}var mstrHTMLAttributes=new Object();mstrHTMLAttributes.ATTR_DIALOG="dialog";mstrHTMLAttributes.ATTR_HIDDEN="hidden";mstrHTMLAttributes.ATTR_MODAL="modal";mstrHTMLAttributes.ATTR_FLDID="FLDID";mstrHTMLAttributes.ATTR_FLD="FLD";mstrHTMLAttributes.ATTR_ZERO="ZERO";mstrHTMLAttributes.ATTR_DPN="DPN";mstrHTMLAttributes.ATTR_DPNND="DPNND";mstrHTMLAttributes.ATTR_DTY="DTY";mstrHTMLAttributes.ATTR_DF="DF";mstrHTMLAttributes.ATTR_MIN="MIN";mstrHTMLAttributes.ATTR_ERR="ERR";mstrHTMLAttributes.ATTR_MAX="MAX";mstrHTMLAttributes.ATTR_LT="LT";mstrHTMLAttributes.ATTR_LE="LE";mstrHTMLAttributes.ATTR_GT="GT";mstrHTMLAttributes.ATTR_GE="GE";mstrHTMLAttributes.ATTR_NOZEROSTR="NONZERO";mstrHTMLAttributes.ATTR_CMDID="cmdid";mstrHTMLAttributes.ATTR_CMDVL="cmdvl";mstrHTMLAttributes.ATTR_REGEX="REGEX";mstrHTMLAttributes.ATTR_REGEX_MSG="REGEX_MSG";mstrHTMLAttributes.ATTR_SCROLL_TYPE="st";mstrHTMLAttributes.ATTR_SHOW_ITEM="showItem";mstrHTMLAttributes.ATTR_CAN_DELETE="canDel";mstrHTMLAttributes.ATTR_CAN_MOVE="canMv";mstrHTMLAttributes.ATTR_CAN_RENAME="canRn";mstrHTMLAttributes.ATTR_CAN_CREATE_SHORTCUT="canCrSh";mstrHTMLAttributes.ATTR_CAN_REMOVE_CHILD="canRvCh";mstrHTMLAttributes.TITLE_SHOW_VALUE="titleshowvl";mstrHTMLAttributes.ATTR_CAN_COPY="canCopy";mstrEditorImplScript=true;mstrEditorImpl.INPUT_TYPE_PRINTER="101";mstrEditorImpl.INPUT_TYPE_FILENAME="102";mstrEditorImpl.INPUT_TYPE_EMAILADDR="103";mstrEditorImpl.INPUT_TYPE_FOLDERPATH="104";mstrEditorImpl.INPUT_TYPE_FILENAME_SPACE_DELIMITER="105";mstrEditorImpl.INPUT_TYPE_SUBSCRIPTION_NAME="106";mstrEditorImpl.INPUT_TYPE_DATE="201";mstrEditorImpl.prototype=new mstrDialogImpl();mstrEditorImpl.prototype.doSlide=false;mstrEditorImpl.prototype.maskFor=null;mstrEditorImpl.prototype.maskArea=null;mstrEditorImpl.prototype.navigateOnSubmit=null;mstrEditorImpl.prototype.okBtnId=null;mstrEditorImpl.prototype.type=microstrategy.OBJTYPE_EDITOR;mstrEditorImpl.prototype.CHECKBOX_UNSELECTED="checkOff";mstrEditorImpl.prototype.CHECKBOX_SELECTED="checkOn";mstrEditorImpl.prototype.CHECKBOX_DISABLED="checkDisabled";mstrEditorImpl.prototype.CHECKBOX_PARTIALLY_SELECTED="checkUndefined";var currentModalEditor=[];mstrEditorImpl.prototype.onload=function(){try{this.initEditor();}catch(A){microstrategy.errors.log(A);return false;}};mstrEditorImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.initResize();if(microstrategy.eventManager){microstrategy.eventManager.notifyOrphanBones("onstatechange");}}catch(A){microstrategy.errors.log(A);return false;}};mstrEditorImpl.prototype.onsubmit=function(A){if(!A){A=window.event;}if(this.validateInputs()){if(this.navigateOnSubmit){var B=this.elem.getElementsByTagName("form")[0];if(B){B.target="";}}}else{return false;}};mstrEditorImpl.prototype.onunload=function(){try{if(this.elem){this.hide();}mstrDialogImpl.prototype.onunload.call(this);this.hideCurtain();}catch(A){microstrategy.errors.log(A);return false;}};mstrEditorImpl.prototype.onnotifydragend=function(){try{if(this.mask&&this.mask.toggle){this.mask.toggle(false);}}catch(A){microstrategy.errors.log(A);return false;}};mstrEditorImpl.prototype.initEditor=function(){try{this.initDialog();if(this.elem.getAttribute(mstrHTMLAttributes.ATTR_DIALOG)=="true"){if(this.elem.getAttribute(mstrHTMLAttributes.ATTR_HIDDEN)!="true"){this.show();}else{this.hideCurtain();}}this.initErrorMessage();}catch(A){microstrategy.errors.log(A);return false;}};mstrEditorImpl.prototype.disableIFrame=function(C){try{if(!C){return false;}var E=findTargetTag(C,"FORM");if(E){if(E.target=="frameManager"){var B=E.getElementsByTagName("INPUT");for(var A=0;A<B.length;A++){if(B[A].name=="iframe"){B[A].value="false";break;}}E.target="";}}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrEditorImpl.prototype.getPosition=function(){try{var A=parseInt(this.elem.style.left);var C=parseInt(this.elem.style.top);if((isNaN(parseInt(A)))||(A<=0)||(isNaN(parseInt(C)))||(C<=0)){this.elem.style.display="block";}if((isNaN(parseInt(A)))||(A<=0)){A=((getClientWidth()-getObjWidth(this.elem))/2+getDocumentScrollLeft());}if((isNaN(parseInt(C)))||(C<=0)){C=(((getClientHeight()-getObjHeight(this.elem))/2)+getDocumentScrollTop());}return{x:Math.max(A,0),y:Math.max(C,0)};}catch(B){microstrategy.errors.log(B);return false;}};mstrEditorImpl.prototype.show=function(){if(this.elem){var A=this.elem.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true";var E=this.computeZIndex();if(A){this.showCurtain(E);}this.elem.style.display="block";this.elem.style.zIndex=E+1;var D=this.getPosition();this.moveTo(D.x,D.y);var C=this.getLayer(this.id);if(C+1<currentModalEditor.length){for(var B=C+1;B<currentModalEditor.length;B++){if(getObj(currentModalEditor[B])!=null){togglePulldowns(getObj(currentModalEditor[B]),false);enablePulldowns(getObj(currentModalEditor[B]),true);}}}else{enablePulldowns(this.elem,true);}if(!this.doSlide){displayObj(this.elem);}}return ;};mstrEditorImpl.prototype.slideOut=function(){try{if(!this.doSlide){return ;}this.doSlide=false;var B=this.elem;this.oHeight=getObjHeight(B);this.oWidth=getObjWidth(B);this.clipTop=this.oHeight-1;this.clipLeft=this.oWidth-1;this.oTop=getObjTop(B);this.oLeft=getObjLeft(B);this.top=this.oTop-this.oHeight;this.left=this.oLeft-this.oWidth;B.style.clip="rect("+this.clipTop+"px, "+this.oWidth+"px, "+this.oHeight+"px, "+this.clipLeft+"px)";B.style.top=this.top+"px";B.style.left=this.left+"px";displayObj(B);this.timer=window.setInterval("microstrategy.bone('"+this.id+"').slide();",1);}catch(A){microstrategy.errors.log(A);return false;}};mstrEditorImpl.prototype.slide=function(){try{var D=40;var E=this.elem;if(this.clipTop<1&&this.clipLeft<1){window.clearInterval(this.timer);E.style.clip="rect(auto, auto, auto, auto)";E.style.top=this.oTop+"px";E.style.left=this.oLeft+"px";return ;}var B=Math.max(this.clipTop-=D,0);var A=Math.max(this.clipLeft-=D,0);if(this.top<this.oTop){this.top=Math.min(this.oTop,this.top+=D);E.style.top=this.top+"px";}if(this.left<this.oLeft){this.left=Math.min(this.oLeft,this.left+=D);E.style.left=this.left+"px";}E.style.clip="rect("+this.clipTop+"px, "+this.oWidth+"px, "+this.oHeight+"px, "+this.clipLeft+"px)";}catch(C){microstrategy.errors.log(C);return false;}};mstrEditorImpl.prototype.showCurtain=function(J,E){var D=this.id+"_bg"+(E?"2":"");var C=document.getElementById(D);var F,B=document.getElementById("mstrWeb_footer"),G=B?B.offsetHeight:0,H={x:E?0:18,y:E?0:(18+G)};if(!C){C=document.createElement("div");C.id=D;C.className="mstrCurtain";F=(E||document.body);F.appendChild(C);}if(C){F=(E||document.documentElement);C.style.zIndex=J;C.style.visibility="visible";C.style.height="auto";C.style.width="auto";enablePulldowns(document.body,false);}if(ISIE7&&E){var I=document.getElementById("mstrWebContents");var A=I.style.zIndex;if(J>=A){this.lastZindex=A;I.style.zIndex=J;}else{this.lastZindex="";}}};mstrEditorImpl.prototype.hideCurtain=function(E){var D=[document.getElementById(this.id+"_bg")],C=document.getElementById(this.id+"_bg2"),B=0;if(C){D.push(C);}for(B=0;B<D.length;B++){var A=D[B];if(A&&A.style.visibility=="visible"){A.style.visibility="hidden";A.style.height="1px";A.style.width="1px";enablePulldowns(document.body,true);}}};mstrEditorImpl.prototype.hide=function(){try{this.elem.style.display="none";this.elem.setAttribute("hidden","1");this.hideCurtain();this.removeLayer();togglePulldowns(this.elem,true);if(ISIE7&&typeof (this.lastZindex)!="undefined"){var A=document.getElementById("mstrWebContents");if(A){A.style.zIndex=this.lastZindex;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrEditorImpl.prototype.close=function(){try{this.hide();if(this.id){var B=microstrategy.updateManager;if(B){var A=[];A.push(B.createActionObject(this,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],["false",this.getBeanName()],[]));microstrategy.updateManager.add(A,true);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrEditorImpl.prototype.closeEditor=function(C,A){try{this.close();var D=this.beanName;if(D&&A){microstrategy.updateCookieSetting(D,"0");}this.unregister();if(microstrategy.eventManager){microstrategy.eventManager.notifyOrphanBones("onstatechange");if(!this.isDraggable){microstrategy.eventManager.ondialogresize();}}if(microstrategy.updateManager){if(C==true){microstrategy.updateManager.flushAndSubmitChanges();}else{if(C!=false&&microstrategy.mstrwid!=""){microstrategy.updateManager.flushAndSubmitChanges();}else{microstrategy.eventManager.notifyOrphanBones("oneditorclose",this.id);}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrEditorImpl.prototype.unregister=function(){try{if(this.elem){this.elem.innerHTML="";}microstrategy.unRegisterBone(this.id);}catch(A){microstrategy.errors.log(A);return false;}};mstrEditorImpl.prototype.getBeanName=function(){try{var A="";if(this.beanName){A=this.beanName;}else{A=this.id;if(A.indexOf("_")>0){A=A.substr(0,A.indexOf("_"));}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrEditorImpl.prototype.getLayer=function(){var A=-1;if(this.isLoaded){for(var B=currentModalEditor.length-1;B>-1;B--){if(currentModalEditor[B]==this.elem.getAttribute("name")){A=B;break;}}}return A;};mstrEditorImpl.prototype.removeLayer=function(){try{for(var A=0;A<currentModalEditor.length;A++){if(currentModalEditor[A]==this.elem.getAttribute("name")){currentModalEditor.length=A;break;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrEditorImpl.prototype.addLayer=function(){try{var A=currentModalEditor.length;currentModalEditor[A]=this.elem.getAttribute("name");return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrEditorImpl.prototype.validateField=function(C,B,A){if(typeof (A)=="undefined"){A=true;}return mstrEditorImpl.validateField(C,B,A);};mstrEditorImpl.validateField=function(field,message,enforceValidation){try{if(typeof (enforceValidation)=="undefined"){enforceValidation=true;}if(field==null||!(field.type=="text"||field.type=="password")){return message;}if(!field.getAttribute(mstrHTMLAttributes.ATTR_FLD)&&!field.getAttribute(mstrHTMLAttributes.ATTR_FLDID)){return message;}if(field.disabled){return message;}var decimalSep=mstr.Settings.Locale.DECIMALSEP;var intRegExp=/(^-?\d\d*$)/;var numRegExp=new RegExp("(^-?\\d\\d*\\"+decimalSep+"\\d*$)|(^-?\\d\\d*\\"+decimalSep+"?\\d*[eE](\\+|-)?\\d+$)|(^-?\\d\\d*$)|(^-?\\"+decimalSep+"\\d\\d*$)");var interimMessage="";var value=trim(field.value);var fieldId=field.getAttribute(mstrHTMLAttributes.ATTR_FLDID);var fieldName=null;if(typeof (fieldId)!="undefined"&&fieldId!=null){fieldName=microstrategy.descriptors.getDescriptor(fieldId);}if(fieldName==null){fieldName=field.getAttribute(mstrHTMLAttributes.ATTR_FLD);}var zeroValid=field.getAttribute(mstrHTMLAttributes.ATTR_ZERO);var bCheck=true;var base=10;if(field.getAttribute(microstrategy.HTMLATTR_CMD_VALUE)!=null||enforceValidation){if(field.getAttribute(mstrHTMLAttributes.ATTR_DPN)){var oDepRadio=getObj(field.getAttribute(mstrHTMLAttributes.ATTR_DPN));if(oDepRadio){bCheck=(oDepRadio.length)?oDepRadio[field.getAttribute(mstrHTMLAttributes.ATTR_DPNND)].checked:oDepRadio.checked;}}if(bCheck){if(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)=="1"){if((!zeroValid&&value.length==0)||(value.length>0&&intRegExp.test(value)==false)||(value.length>0&&(parseInt(value,base)!=parseFloat(value)))){message+=microstrategy.descriptors.getDescriptor("3037")+" "+fieldName+"<br />";}}else{if(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)=="2"){if((!zeroValid&&value.length==0)||(value.length>0&&!numRegExp.test(value))){message+=microstrategy.descriptors.getDescriptor("3038")+" "+fieldName+"<br />";}}else{if(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)=="201"){if(value.length>0&&!mstrEditorImpl.getTime(field)){message+=microstrategy.descriptors.getDescriptor("7745")+" "+fieldName+"<br />";}}else{if(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)&&field.parentNode.style.visibility!="hidden"&&field.parentNode.style.display!="none"){switch(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)){case mstrEditorImpl.INPUT_TYPE_PRINTER:var regExp1=new RegExp('^[^$%:*?"<>|/\\\\]*$');var regExp2=new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$');if(value.length<0||(!regExp1.test(value)&&!regExp2.test(value))||value.indexOf("&#")!=-1){message+=microstrategy.descriptors.getDescriptor("5583").replace(/###/,"'"+fieldName+"'")+"<br />";}break;case mstrEditorImpl.INPUT_TYPE_FOLDERPATH:var regExpWin=new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$');var regExpUnix=new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$');if(value.length<0||(!regExpWin.test(value)&&!regExpUnix.test(value))||value.indexOf("&#")!=-1){message+=microstrategy.descriptors.getDescriptor("5583").replace(/###/,"'"+fieldName+"'")+"<br />";}break;case mstrEditorImpl.INPUT_TYPE_FILENAME:var regExp=new RegExp('^[^:*?"<>|/\\\\]+$');if(value.length<=0||!regExp.test(value)){var cleanFieldName=fieldName.replace(":","");message+=microstrategy.descriptors.getDescriptor("9272").replace(/##/,cleanFieldName).replace(/###/,'<b>:*?"<>|/\\</b> ')+"<br />";}if(value.indexOf("&#")!=-1){var cleanFieldName=fieldName.replace(":","");message+=microstrategy.descriptors.getDescriptor("14475").replace(/##/,cleanFieldName).replace(/&#/,"<b>&#</b> ").replace(/subscription names/,"file names")+"<br />";}break;case mstrEditorImpl.INPUT_TYPE_SUBSCRIPTION_NAME:if(value.length<=0||value.indexOf("&#")!=-1){var cleanFieldName=fieldName.replace(":","");message+=microstrategy.descriptors.getDescriptor("14475").replace(/##/,cleanFieldName).replace(/&#/,"<b>&#</b> ")+"<br />";}break;case mstrEditorImpl.INPUT_TYPE_FILENAME_SPACE_DELIMITER:var regExp=new RegExp('^[^:*?"<>|/\\\\]?$');if(!regExp.test(value)){var cleanFieldName=fieldName.replace(":","");message+=microstrategy.descriptors.getDescriptor("9272").replace(/##/,cleanFieldName).replace(/###/,'<b>:*?"<>|/\\</b> ')+"<br />";}break;case mstrEditorImpl.INPUT_TYPE_EMAILADDR:var regExp=new RegExp("^([&a-zA-Z0-9_.-])+@(([&a-zA-Z0-9-])+[.])+([a-zA-Z0-9])+$");if(value.length<=0||!regExp.test(value)){message+=microstrategy.descriptors.getDescriptor("5583").replace(/###/,"'"+fieldName+"'")+"<br />";}break;}}}}}if(field.getAttribute(mstrHTMLAttributes.ATTR_REGEX)){var regexValidation=new RegExp(field.getAttribute(mstrHTMLAttributes.ATTR_REGEX));if(regexValidation.test(value)){message+=field.getAttribute(mstrHTMLAttributes.ATTR_REGEX_MSG);}}var minValue=null,maxValue=null,minmaxError=false;if(field.getAttribute(mstrHTMLAttributes.ATTR_MIN)!=null&&field.getAttribute(mstrHTMLAttributes.ATTR_MIN).length>0){minValue=parseFloat(eval(field.getAttribute(mstrHTMLAttributes.ATTR_MIN)));if(parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(value))<minValue){if((field.getAttribute(mstrHTMLAttributes.ATTR_ERR)!=null)&&(field.getAttribute(mstrHTMLAttributes.ATTR_ERR).length>0)){message+=field.getAttribute(mstrHTMLAttributes.ATTR_ERR)+"<br />";}else{minmaxError=true;}}}if(field.getAttribute(mstrHTMLAttributes.ATTR_MAX)!=null&&field.getAttribute(mstrHTMLAttributes.ATTR_MAX).length>0){maxValue=parseFloat(eval(field.getAttribute(mstrHTMLAttributes.ATTR_MAX)));if(parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(value))>maxValue){if((field.getAttribute(mstrHTMLAttributes.ATTR_ERR)!=null)&&(field.getAttribute(mstrHTMLAttributes.ATTR_ERR).length>0)){message+=field.getAttribute(mstrHTMLAttributes.ATTR_ERR)+"<br />";}else{minmaxError=true;}}}if(minmaxError){if(minValue!==null&&maxValue!==null){message+=((microstrategy.descriptors.getDescriptor("6117").replace(/####/,maxValue)).replace(/###/,minValue)).replace(/##/,fieldName)+"<br />";}else{if(minValue!==null){message+=(microstrategy.descriptors.getDescriptor("3039").replace(/###/,minValue)).replace(/##/,fieldName)+"<br />";}else{if(maxValue!==null){message+=(microstrategy.descriptors.getDescriptor("3041").replace(/###/,maxValue)).replace(/##/,fieldName)+"<br />";}}}}var ltInput=null;var acceptEqual;if(value.length>0&&field.getAttribute(mstrHTMLAttributes.ATTR_LT)!=null&&field.getAttribute(mstrHTMLAttributes.ATTR_LT).length>0){ltInput=getElementById(field.getAttribute(mstrHTMLAttributes.ATTR_LT));acceptEqual=false;}else{if(value.length>0&&field.getAttribute(mstrHTMLAttributes.ATTR_LE)!=null&&field.getAttribute(mstrHTMLAttributes.ATTR_LE).length>0){ltInput=getElementById(field.getAttribute(mstrHTMLAttributes.ATTR_LE));acceptEqual=true;}}if(ltInput!=null&&!ltInput.disabled){ltValue=ltInput.value;if(ltValue!=null&&ltValue.length>0){var fieldValue=value;if(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)=="201"){ltValue=mstrEditorImpl.getTime(ltInput)+"";fieldValue=mstrEditorImpl.getTime(field)+"";if(ltValue==0){return message;}}if(parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(ltValue))<parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(fieldValue))||(!acceptEqual&&parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(ltValue))==parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(fieldValue)))){if((field.getAttribute(mstrHTMLAttributes.ATTR_ERR)!=null)&&(field.getAttribute(mstrHTMLAttributes.ATTR_ERR).length>0)){message+=field.getAttribute(mstrHTMLAttributes.ATTR_ERR)+"<br />";}else{message+=(microstrategy.descriptors.getDescriptor(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)=="201"?"7747":"3041").replace(/###/,ltInput.value)).replace(/##/,fieldName)+"<br />";}}}}var gtInput=null;if(value.length>0&&field.getAttribute(mstrHTMLAttributes.ATTR_GT)!=null&&field.getAttribute(mstrHTMLAttributes.ATTR_GT).length>0){gtInput=getElementById(field.getAttribute(mstrHTMLAttributes.ATTR_GT));acceptEqual=false;}else{if(value.length>0&&field.getAttribute(mstrHTMLAttributes.ATTR_GE)!=null&&field.getAttribute(mstrHTMLAttributes.ATTR_GE).length>0){gtInput=getElementById(field.getAttribute(mstrHTMLAttributes.ATTR_GE));acceptEqual=true;}}if(gtInput!=null&&!gtInput.disabled){gtValue=gtInput.value;if(gtValue&&gtValue.length>0){var fieldValue=value;if(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)=="201"){gtValue=mstrEditorImpl.getTime(gtInput)+"";fieldValue=mstrEditorImpl.getTime(field)+"";if(gtValue==0){return message;}}if(parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(fieldValue))<parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(gtValue))||(!acceptEqual&&parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(gtValue))==parseFloat(mstr.utils.LocaleParser.convertToBrowserNumber(fieldValue)))){if((field.getAttribute(mstrHTMLAttributes.ATTR_ERR)!=null)&&(field.getAttribute(mstrHTMLAttributes.ATTR_ERR).length>0)){message+=field.getAttribute(mstrHTMLAttributes.ATTR_ERR)+"<br />";}else{message+=(microstrategy.descriptors.getDescriptor(field.getAttribute(mstrHTMLAttributes.ATTR_DTY)=="201"?"7746":"3039").replace(/###/,gtInput.value)).replace(/##/,fieldName)+"<br />";}}}}if(field.getAttribute(mstrHTMLAttributes.ATTR_NOZEROSTR)!=null&&trim(value).length==0){message+=microstrategy.descriptors.getDescriptor("3878")+" "+fieldName+"<br />";}}}return message;}catch(err){microstrategy.errors.log(err);return message;}};mstrEditorImpl.getTime=function(C){var B=C.getAttribute(mstrHTMLAttributes.ATTR_DF);var E=getDateFromFormat(C.value,B,DATE_YEAR);var A=getDateFromFormat(C.value,B,DATE_MONTH)-1;var D=getDateFromFormat(C.value,B,DATE_DAY);if(E>0&&A>=0&&D>0){return(new Date(E,A,D)).getTime();}else{return 0;}};mstrEditorImpl.validateInputs=function(D,A){try{var G="";var H="";if(D){var F=D.getElementsByTagName("INPUT");var B=[];for(var E=0;E<F.length;E++){H=this.validateField(F[E],"",A);if(H.length==0&&!F[E].disabled){if(F[E].name=="rangeStart"||F[E].name=="rangeEnd"){B.push(F[E]);}}else{G+=H;}}if(B.length==2){var J=parseInt(B[0].value);var I=parseInt(B[1].value);if((B[0].name=="rangeStart"&&J>I)||(B[0].name=="rangeEnd"&&J<I)){G+=(microstrategy.descriptors.getDescriptor("5784").replace(/###/,microstrategy.descriptors.getDescriptor("6141"))).replace(/##/,microstrategy.descriptors.getDescriptor("6140"))+"<br />";}}if(G!=null&&G.length>0){showMessage({contents:G,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrEditorImpl.prototype.validateSingleInput=function(C){try{var A=mstrEditorImpl.validateField(C,"");if(A!=null&&A.length>0){showMessage({contents:A,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}}catch(B){microstrategy.errors.log(B);}return true;};mstrEditorImpl.prototype.validateInputs=function(){try{return mstrEditorImpl.validateInputs.call(this,this.elem,false);}catch(A){microstrategy.errors.log(A);}};mstrEditorImpl.prototype.getCheckboxesState=function(C){try{var A=null;if(C){for(var D=0;D<C.length;D++){var B=C[D];if(B.checked){switch(A){case this.CHECKBOX_PARTIALLY_SELECTED:case this.CHECKBOX_UNSELECTED:A=this.CHECKBOX_PARTIALLY_SELECTED;break;case this.CHECKBOX_SELECTED:default:A=this.CHECKBOX_SELECTED;break;}}else{switch(A){case this.CHECKBOX_PARTIALLY_SELECTED:case this.CHECKBOX_SELECTED:A=this.CHECKBOX_PARTIALLY_SELECTED;break;case this.CHECKBOX_UNSELECTED:A=this.CHECKBOX_UNSELECTED;break;default:A=this.CHECKBOX_UNSELECTED;break;}}if(A==this.CHECKBOX_PARTIALLY_SELECTED){break;}}}return A;}catch(E){microstrategy.errors.log(E);return this.CHECKBOX_UNSELECTED;}};mstrEditorImpl.prototype.adjustCheckboxes=function(B,E){try{if(B){for(var C=0;C<B.length;C++){var A=B[C];A.checked=E;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrEditorImpl.prototype.updateChildrenCheckboxes=function(B,A){try{if(B&&A){this.adjustCheckboxes(A,B.checked);}}catch(C){microstrategy.errors.log(C);return false;}};mstrEditorImpl.prototype.updateParentCheckboxImage=function(B,A){try{if(B&&B.className!=this.CHECKBOX_DISABLED&&A){B.className=this.getCheckboxesState(A);}}catch(C){microstrategy.errors.log(C);return false;}};mstrEditorImpl.prototype.computeZIndex=function(){var A=this.getLayer();if(A==-1){A=this.addLayer();}return microstrategy.getMaxZIndex(A);};mstrEditorImpl.prototype.customJS=function(jsCode){try{eval(jsCode);}catch(err){microstrategy.errors.log(err);return false;}};function mstrEditorImpl(A){this.inherits=mstrDialogImpl;this.inherits(A);delete this.inherits;return this;}microstrategy.MOUSE_MOVES_BUFFER=5;microstrategy.HTMLATTR_DRAG="DG";microstrategy.HTMLATTR_DRAG_OFF=0;microstrategy.HTMLATTR_DRAG_DRAGGABLE=1;microstrategy.HTMLATTR_DRAG_DOCKABLE=2;mstrEventsManagerImpl.prototype=new Object;mstrEventsManagerImpl.prototype.source=new Object;mstrEventsManagerImpl.prototype.browserHeight=null;mstrEventsManagerImpl.prototype.browserWidth=null;mstrEventsManagerImpl.prototype.onload=function(B){try{if(window.mstrInterfacePlugin){mstrInterfacePlugin.init();}microstrategy.updateLayoutProps();microstrategy.loadDynamicJS(B,true);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrEventsManagerImpl.prototype.initializeBones=function(B){try{microstrategy.registerNewBones();this.notifyOrphanBones("onload",B);this.notifyOrphanBones("onpostload",B);this.onforcerepaint();if(window.mstrApp&&mstrApp.pendingMojoEditor&&mstrApp.pendingMojoEditor!=""){microstrategy["show"+mstrApp.pendingMojoEditor]();delete mstrApp.pendingMojoEditor;}if(iframe){iframe.hideWaitPage(true);}microstrategy.handleLastMessageRecovery();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrEventsManagerImpl.prototype.onforcerepaint=function(){try{this.notifyOrphanBones("onforcerepaint");return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrEventsManagerImpl.prototype.onnotifydrag=function(A,D,B){try{this.notifyOrphanBones("onnotifydrag",A,D,B);return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrEventsManagerImpl.prototype.onreload=function(B){try{microstrategy.IS_RELOAD=true;if(microstrategy.updateManager){microstrategy.updateManager.acknowledgeRequest();}this.notifyOrphanBones("onreload",B);this.notifyOrphanBones("onrepostload",B);if(microstrategy.updateManager){microstrategy.updateManager.acknowledgeReloadEnd();}window.setTimeout("microstrategy.eventManager.onforcerepaint()",0);microstrategy.IS_RELOAD=false;microstrategy.setupPageMessageDisplay();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrEventsManagerImpl.prototype.onwinresize=function(){try{if(this.hasWindowResized()){microstrategy.redoLayout();this.notifyOrphanBones("onwinresize");this.notifyOrphanBones("onforcerepaint");if(typeof resizePromptContent!="undefined"){resizePromptContent();}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrEventsManagerImpl.prototype.ondialogresize=function(B){try{this.getSource(B);this.notifyOrphanBones("ondialogresize",B);this.notifyOrphanBones("onforcerepaint");if(typeof resizePromptContent!="undefined"){resizePromptContent();}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrEventsManagerImpl.prototype.getSource=function(C,B){try{this.source=new Object;try{getMouse(C);this.source.mousedownX=lMouseX;this.source.mousedownY=lMouseY;this.source.shiftKey=((bIsIE4)?event.shiftKey:C&&C.shiftKey);this.source.button=getButtonId(C);this.source.elem=(B)?B:microstrategy.findAncestor(getEventTarget(C));}catch(D){this.source.elem=null;}if(this.source.elem){this.source.id=this.source.elem.getAttribute("id");this.source.type=microstrategy.objectType(this.source.elem);this.source.subType=microstrategy.subObjectType(this.source.elem);this.source.bone=microstrategy.findBone(this.source.elem);this.source.left=getObjSumLeftScrolled(this.source.elem);this.source.top=getObjSumTopScrolled(this.source.elem);this.source.width=this.source.elem.offsetWidth;this.source.height=this.source.elem.offsetHeight;this.source.draggable=(this.source.bone&&this.source.bone.elem)?this.source.bone.elem.getAttribute(microstrategy.HTMLATTR_DRAG):null;this.source.draggable=(!isNaN(parseInt(this.source.draggable)))?parseInt(this.source.draggable):microstrategy.HTMLATTR_DRAG_OFF;}else{this.source.id=null;this.source.type=null;this.source.subType=null;this.source.bone=null;this.source.left=lMouseX;this.source.top=lMouseY;this.source.width=0;this.source.height=0;this.source.draggable=microstrategy.HTMLATTR_DRAG_OFF;}this.source.offsetX=this.source.left-lMouseX;this.source.offsetY=this.source.top-lMouseY;return this.source;}catch(A){microstrategy.errors.log(A);return false;}};mstrEventsManagerImpl.prototype.notifyBone=function(A,C){try{if(this.source&&this.source.bone&&A in this.source.bone){return this.source.bone[A](C,this.source);}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrEventsManagerImpl.prototype.notifyOrphanBones=function(){try{var I;var G=arguments[0];var J=[];for(I=1;I<arguments.length;I++){J[I-1]=arguments[I];}var B=0;var H=[];var E=[];for(var A in microstrategy.bones){var K=microstrategy.bones[A];if(K&&!K.parentBone&&!K.isDormant&&K[G]){B++;if(K.primaryBone){H.push(K);}else{E.push(K);}}}H.reverse();E.reverse();var C=H.concat(E);var F=true;for(I=0;I<B;I++){if(C[I][G].apply(C[I],J)==false){F=false;}}return F;}catch(D){microstrategy.errors.log(D);return false;}};mstrEventsManagerImpl.prototype.notifyZones=function(B,F){try{var A=microstrategy.zones;var E=A.length;for(var C=0;C<E;C++){if(A[C]&&B in A[C]){A[C][B](F);}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrEventsManagerImpl.prototype.executeFunction=function(functionToExecute){for(var bone in microstrategy.controlVariables){if(!microstrategy.controlVariables[bone]){window.setTimeout("microstrategy.eventManager.executeFunction('"+functionToExecute+"');",250);return ;}}eval(functionToExecute);microstrategy.controlVariables=new Object();};mstrEventsManagerImpl.prototype.hasWindowResized=function(){try{var B=false;var C=mstr.utils.BoxModel.getBrowserWindowHeight(document);var A=mstr.utils.BoxModel.getBrowserWindowWidth(document);if(C!=this.browserHeight||A!=this.browserWidth){this.browserHeight=C;this.browserWidth=A;B=true;}}catch(D){microstrategy.errors.log(D);}return B;};function mstrEventsManagerImpl(){return this;}if(microstrategy){microstrategy.eventManager=new mstrEventsManagerImpl();}mstrClientSideDescriptorImpl.prototype._Descriptors=new Object();function mstrClientSideDescriptorImpl(){return this;}microstrategy.descriptors=new mstrClientSideDescriptorImpl();mstrClientSideDescriptorImpl.prototype.addDescriptors=function(C){try{var G="\x1f";var E="\x1e";var A=C.split(E);for(var D=0;D<A.length-1;D++){var B=A[D].split(G);this._Descriptors[B[0]]=B[1];}}catch(F){microstrategy.errors.log(F);return false;}};mstrClientSideDescriptorImpl.prototype.getDescriptor=function(B){try{return(this._Descriptors[B])?this._Descriptors[B]:"Descriptor with id "+B+" not found";}catch(A){microstrategy.errors.log(A);return false;}};function mstrSearch(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;this.primaryBone=true;return this;}mstrSearch.prototype=new mstrBoneImpl();mstrSearch.prototype.id=null;mstrSearch.prototype.minKeyLength=1;mstrSearch.prototype.maxResultsSize=5;mstrSearch.prototype.maxSuggestSize=5;mstrSearch.prototype.ifSize=5;mstrSearch.prototype.tipText="Type to search";mstrSearch.prototype.showSuggestAsPopup=false;mstrSearch.prototype.showAsPopup=false;mstrSearch.prototype.enableSuggestion=true;mstrSearch.prototype.hasSearchPattern=false;mstrSearch.prototype.contentContainer=null;mstrSearch.prototype.taskId="searchMetadata";mstrSearch.prototype.blockBegin=1;mstrSearch.prototype.blockCount=10;mstrSearch.prototype.folderBrowserStyle=0;mstrSearch.prototype.rootFolderType=39;mstrSearch.prototype.rootFolderID="8D67909211D3E4981000E787EC6DE8A4";mstrSearch.prototype.nameWildcards="";mstrSearch.prototype.recursive=1;mstrSearch.prototype.objectType=[3,8,14081];mstrSearch.prototype.styleName="FolderStyleQuickSearchResults";mstrSearch.prototype.styleName4Json="MojoFolderStyle";mstrSearch.prototype.styleName4suggestion="WidgetFolderStyle";mstrSearch.prototype.fields="name";mstrSearch.prototype.dereferenceshortcut="1";mstrSearch.prototype.dateType=1;mstrSearch.prototype.created=0;mstrSearch.prototype.dateSubType=1;mstrSearch.prototype.intervalUnit=1;mstrSearch.prototype.intervalValue=1;mstrSearch.prototype.startDate="";mstrSearch.prototype.endDate="";mstrSearch.prototype.ownerType=1;mstrSearch.prototype.description="";mstrSearch.prototype.maxObjects=100;mstrSearch.prototype.searchDomain=2;mstrSearch.prototype.supportOMD=false;mstrSearch.prototype.qse=true;mstrSearch.prototype.target=null;mstrSearch.prototype.ok=null;mstrSearch.prototype.searchDelay=300;mstrSearch.prototype.showSuggestionLoadingIcon=false;mstrSearch.prototype.useCurtainOverResults=true;mstrSearch.selected_CssClass=" selected";mstrSearch.selected_regex=new RegExp(mstrSearch.selected_CssClass,"g");mstrSearch.ITEM_IDX="acidx";mstrSearch.SEARCH_TYPES=[16,1,2,4,8];mstrSearch.QUICK_SEARCH_TYPES=[16,1,2,4,8];mstrSearch.OLD_SEARCH_TYPES=[1,2,4,8];mstrSearch.DEFAULT_OBJECT_TYPE=[3,8,14081];mstrSearch.OBJECT_TYPE_SUGGESTION=-1;mstrSearch.prototype.onload=function(B){this.tipText=microstrategy.descriptors.getDescriptor(9168);this.endDate=mstr.utils.LocaleParser.formatDateInfo({day:new Date().getDate(),month:parseInt(new Date().getMonth())+1,year:new Date().getFullYear()},mstr.Settings.Locale.DATEOUTPUTFORMAT);this.updateQuickSearchEnabled();this.initBone();if(this.searchPattern!=undefined&&this.searchPattern.length==0){this.positionSearchBox(false);}this.updatePropertiesForProject();this.prepareObjectTypes();var A={elResultPlaceholder:microstrategy.findChildWithAtt(this.elem,"div","n","SearchResultsPlaceholder"),elIncFetchPlaceholder:microstrategy.findChildWithAtt(this.elem,"div","n","IncFetchPlaceholder"),elSuggestPlaceholder:microstrategy.findChildWithAtt(this.elem,"div","n","SearchSuggestionPlaceholder"),elSearchOptions:microstrategy.findChildWithAtt(this.elem,"div","n","search_options")||microstrategy.findChildWithAtt(document.body,"div","n","search_options"),elLocation:microstrategy.findChildWithAtt(this.elem,"div","n","location")||microstrategy.findChildWithAtt(microstrategy.findChildWithAtt(document.body,"div","n","search_options"),"div","n","location"),target:microstrategy.findChildWithAtt(this.elem,"input","n","searchPattern2"),elSuggestInput:microstrategy.findChildWithAtt(this.elem,"input","n","suggestedPattern"),elSearchTip:microstrategy.findChildWithAtt(this.elem,"div","n","searchTip"),elClear:microstrategy.findChildWithAtt(this.elem,"div","n","sbClear"),elSpinner:microstrategy.findChildWithAtt(this.elem,"div","n","sbSpinner"),elSearch:microstrategy.findChildWithAtt(this.elem,"div","n","sbSearch"),rootFolderType:(parseInt(this.rootFolderType)>=0?this.rootFolderType:39),objectType:this.objectType,nameWildcards:this.nameWildcards||(this.pqse?16:1)};for(var C in B){A[C]=B[C];}this.setup(A);this.updateUIState();this.updateQuickSearchEnabled();this.showSearchInfoIcon();this.isLoaded=true;};mstrSearch.prototype.getGUID=function(){return mstrApp.httpSessionId+"-"+microstrategy.projectId;};mstrSearch.prototype.prepareObjectTypes=function(){try{var F=[];this.allowedObjectTypes=this.allowedObjectTypesData.concat([]);mstr.$A.forEach(this.allowedObjectTypes,function(I,H,G){G[H]=parseInt(I.t);F[G[H]]=I.d;});if(this.allowedObjectTypes.length==0){this.objectType=[];return ;}var B=this.allowedObjectTypes,E=this.objectType;mstr.$A.forEach(E.concat([]),function(I,H,G){mstr.$A.removeItems(E,mstr.$A.find(B,parseInt(I))==-1?[I]:null);});if(E.length==0&&!(this.isMiniSearchBox||this.isDesktopSearchBox)){E=this.allowedObjectTypes;}this.miniSearchBoxTooltip="";for(var C=0,A=E.length;C<A;C++){this.miniSearchBoxTooltip+=F[E[C]]+(C<A-1?", ":"");}this.objectType=E;}catch(D){microstrategy.errors.log(D);}};mstrSearch.prototype.updateUIState=function(){try{var D=this.target,A=this.elSearch,C=function(){D.disabled="disabled";D.title=A.title="Disabled";};if(this.allowedObjectTypes.length==0){C();if(this.elSearchOptions){A.onclick=null;this.elSearchOptions.style.display="none";}}else{if((this.isMiniSearchBox||this.isDesktopSearchBox)){if(this.objectType.length==0){C();}else{D.title=A.title=microstrategy.descriptors.getDescriptor(11231).replace("#",this.miniSearchBoxTooltip);}}}}catch(B){microstrategy.errors.log(B);}};mstrSearch.prototype.updatePropertiesForProject=function(){try{var A=this.getGUID();if(typeof (this)=="object"){if(this.qsGUID!=undefined&&this.qsGUID.length>0&&this.qsGUID!=A){microstrategy.updateBrowserSetting("qsGUID",A,true);microstrategy.updateBrowserSetting("rootFolderID","",true);microstrategy.updateBrowserSetting("rootFolderName","",true);microstrategy.updateBrowserSetting("rootFolderType",39,true);this.qsGUID=A;this.rootFolderID="";this.rootFolderName="";this.rootFolderType=39;}}}catch(B){microstrategy.errors.log(B);}};mstrSearch.prototype.setup=function(N){try{this.maxObjects=parseInt(microstrategy.maxSearchResults||this.blockCount);for(var M in N){this[M]=N[M];}this.searchPattern=decode(this.searchPattern);var T=this.target;if(T){var f=this;T.setAttribute("autocomplete","off");var A=this.renderPopupContainer();var X=this.elSuggestPlaceholder||T.parentNode;X.appendChild(A);if(this.showSuggestAsPopup){T.onclick=function(d){f.hidePopup(d);};}T.onkeyup=function(k){k=k||window.event;var g=this.value;var h=mstr.$E.keyCode(k,window);if(h==32&&/^\s/.test(g)){this.value=g.replace(/^\s+/,"");mstr.$E.cancel(k,window);return false;}f.hasSearchPattern=this.value&&(this.value.length>0);if(!f.doAutoComplete){if(f.hasSearchPattern){f.showClearIcon();}f.searchPattern=this.value;if(k.keyCode!=13){return ;}}f.evt={};for(var l in k){f.evt[l]=k[l];}var d=function(o,p){if(p.indexOf("?")>-1||p.indexOf("*")>-1){return false;}var m=false;try{if(typeof (o)=="string"){m=(new RegExp("^"+p,"")).test(o);}else{for(var q in o){m=(new RegExp("^"+p,"i")).test(o[q].n);if(!m){break;}}}}catch(r){}return m;};if(k&&k.keycode&&mstr.$A.find([8,13,27,37,38,39,40],k.keyCode)===-1&&d(f.elSuggestInput.value,this.value)&&d(f.sItems,this.value)){return ;}f.processInput(f.evt);f.syncInputWithSuggest();};T.onpaste=function(d){window.setTimeout(function(){T.onkeyup(d);},0);};if(mstr.utils.ISIE4){T.onkeydown=function(d){d=window.event;if(d.keyCode==27){d.cancelBubble=true;return false;}};}T.onfocus=function(d){f.elSearchTip.style.display="none";if(!f.hasSearchPattern){this.value="";this.className=this.className.replace(/ tip/g,"");}};T.onblur=function(d){if(!f.hasSearchPattern){this.value="";f.elSearchTip.className+=" tip";f.elSearchTip.style.display="block";f.elSearchTip.innerHTML=f.tipText;}};f.elSearchTip.onclick=function(){this.style.display="none";f.target.focus();};this.sbClear=this.elClear;this.sbSpinner=this.elSpinner;this.sbSettings=this.elSettings;this.sbSearch=this.elSearch;this.sbSearch.onclick=function(){if(f.showAsPopup){f.goToSearchPage(f.target.className.indexOf(" tip")>-1?"":f.target.value);}else{f.forceSearch();}};this.sbSearch.onkeypress=function(g){var d=(g||window.event).keyCode;if(d==13){this.click();}};this.sbClear.onclick=function(){f.clear();};if(this.elSettings){this.elSettings.onclick=function(){f.toggleOptions(this);};}if(this.elSearchOptions){this.elDescription=microstrategy.findChildWithAtt(this.elSearchOptions,"textarea","id","description"),this.elSearchOptions.onclick=function(l){l=l||window.event;var o=l.target||l.srcElement;o=microstrategy.findAncestorWithAtt(o,"ty","stb");if(o&&o.getAttribute("ty")=="stb"){var m=o.parentNode;var g=microstrategy.findChildWithAtt(m,"div","ty","sc");if(g){var d=g.style.display=="none";d=mstr.utils.CSS.getStyleValue(g,"display")=="none";var k=g.offsetHeight;m.className=m.className.replace(/ expanded/,"")+(d?" expanded":"");if(d){g.style.display="block";g.style.height=0;start=0;end=k;}else{start=k;end=0;}f.fx(g,"height",start,end,10,100,"px",(d?function(){g.style.height="auto";microstrategy.eventManager.notifyOrphanBones("oncontentexpand",g);}:function(){g.style.display="none";}));}}};}if(this.isMiniSearchBox||this.isDesktopSearchBox){this.sbSearch.title=T.title=microstrategy.descriptors.getDescriptor(9246);}else{if(this.elSearchOptions){var H=microstrategy.findChildWithAtt(this.elSearchOptions,"div","n","types"),F=microstrategy.findChildWithAtt(this.elSearchOptions,"div","n","types_web"),G=microstrategy.findChildWithAtt(this.elSearchOptions,"div","n","types_us");var Y=this.searchDomain&&this.searchDomain==3;if(Y){if(F){H.removeChild(F);}var E=microstrategy.findChildWithAtt(this.elSearchOptions,"div","n","location");if(E){E.parentNode.removeChild(E);}var D=microstrategy.findChildWithAtt(this.elSearchOptions,"div","n","deRef");if(D){D.parentNode.removeChild(D);}}else{if(G){H.removeChild(G);H=F;var E=microstrategy.findChildWithAtt(this.elLocation,"div","n","rootFolderType_0");if(E&&this.rootFolderType=="0"&&this.rootFolderName!=undefined){E.getElementsByTagName("span")[0].innerHTML=this.rootFolderName;E.style.display="block";}microstrategy.findChildWithAtt(this.elSearchOptions,"input","id","rootFolderType_"+this.rootFolderType).checked="checked";microstrategy.findChildWithAtt(this.elSearchOptions,"input","id","dereferenceshortcut").checked=this.dereferenceshortcut=="1";}}this.elTypesCheckboxes=microstrategy.findChildrenWithAtt(Y?G:F,"input","type","checkbox");if(this.objectType.length>0){var I=this.objectType;var P=this.allowedObjectTypesData,c=document.createElement("span"),b='<div><input id="objectType_#type#" name="objectType" value="#type#" type="checkbox"><label class="mstrIcon-lv mstrIcon-lv-#css#" for="objectType_#type#">#desc#</label></div>';for(var W=0,Q=P.length;W<Q;W++){var L=P[W],J=L.t,a=L.d;c.innerHTML=b.replace(/#type#/g,J).replace(/#css#/,this.t2css({t:J,st:J})).replace(/#desc#/,a);var K=c.firstChild.firstChild;if(mstr.$A.find(I,J)){K.checked="checked";}this.elTypesCheckboxes.push(K);H.appendChild(c.firstChild);}}microstrategy.findChildWithAtt(this.elSearchOptions,"input","id","dateSubType_"+this.dateSubType).checked="checked";microstrategy.findChildWithAtt(this.elSearchOptions,"select","id","created").selectedIndex=parseInt(this.created)-1;microstrategy.findChildWithAtt(this.elSearchOptions,"select","id","intervalUnit").selectedIndex=parseInt(this.intervalUnit)-1;microstrategy.findChildWithAtt(this.elSearchOptions,"input","id","intervalValue").value=this.intervalValue;microstrategy.findChildWithAtt(this.elSearchOptions,"input","id","startDate").value=this.startDate;microstrategy.findChildWithAtt(this.elSearchOptions,"input","id","endDate").value=this.endDate;microstrategy.findChildWithAtt(this.elSearchOptions,"input","id","ownerType_"+this.ownerType).checked="checked";microstrategy.findChildWithAtt(this.elSearchOptions,"textarea","id","description").value=this.description;var Z=microstrategy.findChildWithAtt(this.elSearchOptions,"select","name","nameWildcards");this.elNameWildcards=this.elNameWildcards||Z.cloneNode(true);if(Z){if(!this.pqse){Z.options[0]=null;}else{this.elNameWildcards.options[1]=null;Z.parentNode.replaceChild(this.elNameWildcards.cloneNode(true),Z);}Z.selectedIndex=mstr.$A.find(this.pqse?mstrSearch.SEARCH_TYPES:mstrSearch.OLD_SEARCH_TYPES,parseInt(this.nameWildcards));}if(this.elSearchOptions){var V=this.elSearchOptions;var B=V.getElementsByTagName("input"),S=V.getElementsByTagName("textarea"),e=V.getElementsByTagName("select");for(var R=0,U=B.length;R<U;R++){if(B[R].type=="text"){B[R].onkeyup=function(){microstrategy.bone(f.id).updateOptions(this);};}else{B[R].onclick=function(){microstrategy.bone(f.id).updateOptions(this);};}}for(var R=0,U=e.length;R<U;R++){e[R].onchange=function(){microstrategy.bone(f.id).updateOptions(this);};}for(var R=0,U=S.length;R<U;R++){S[R].onkeyup=function(){LimitTextAreaMaxLength(this,100);f.blockBegin=1;microstrategy.bone(f.id).updateOptions(this);};}}}}this.restoreFromCookie();if(!this.elResultPlaceholder){this.elResultPlaceholder=document.getElementById("mstrWeb_footer");}var O=function(g){try{g.focus();}catch(d){}};if(this.searchPattern&&this.searchPattern!=""){T.value=this.searchPattern;this.hasSearchPattern=T.value&&(T.value.length>0);this.showClearIcon();window.setTimeout(function(){O(T);f.forceSearch();},200);}else{this.updateTipText();if(!this.isMiniSearchBox){window.setTimeout(function(){O(T);},200);}else{this.updateTipText();}this.elSuggestInput.value="";}}}catch(C){microstrategy.errors.log(C);}};mstrSearch.prototype.restoreFromCookie=function(){try{if(this.elSearchOptions){var J=this.elSearchOptions;var E=J.getElementsByTagName("input"),F=J.getElementsByTagName("textarea"),H=J.getElementsByTagName("select");for(var D=0,G=E.length;D<G;D++){var I=E[D],B=I.name,K=I.value;if(I.type=="text"){I.value=this[B];}else{I.checked=new RegExp("(^|,)"+K+"($|,)").test(this[B]);}}for(var D=0,G=H.length;D<G;D++){var A=H[D],K=this[A.name];A.value=K;if(A.id=="created"){this["dateType"]=K=="0"?1:2;}this.restoreDateSubsection(A);}for(var D=0,G=F.length;D<G;D++){F[D].value=this[F[D].name];}}}catch(C){microstrategy.errors.log(C);}};mstrSearch.prototype.restoreDateSubsection=function(C){try{if(C.id=="created"){var B=C.value;var E=document.getElementById("createdOptions"),F=B=="0"?68:E.offsetHeight,A=B=="0"?0:E.scrollHeight||68;this.fx(E,"height",F,A,10,100,"px");this.prepareCalendar();}}catch(D){microstrategy.errors.log(D);}};mstrSearch.prototype.addAdminInfo=function(C){try{var B=microstrategy.adminInfo;return C.replace("#",(B&&B.length>0?" ("+B+")":""));}catch(A){microstrategy.errors.log(A);}};mstrSearch.prototype.showSearchInfoIcon=function requestResults(D){if(this.isMiniSearchBox&&!this.isDesktopSearchBox||this.qse){return ;}var B=this;D=D==false?false:true;var A=B.elInfoIcon;if(A){A.style.display=D?"block":"none";return ;}A=document.createElement("div");A.className="mstrSearchModeInfoIcon";B.elInfoIcon=A;B.elSuggestPlaceholder.parentNode.appendChild(B.elInfoIcon);var C=microstrategy.descriptors.getDescriptor(9264);elSearchInfo=document.createElement("div");elSearchInfo.className="mstrSearchModeInfo"+(mstr.utils.ISIE7||mstr.utils.ISIE8?" ie78":"");elSearchInfo.innerHTML='<div class="mstrSearchModeInfoText">'+this.addAdminInfo(C)+'</div><div class="mstrSearchModeInfoTipIcon"></div>';B.elInfoIcon.appendChild(elSearchInfo);B.elSearchInfo=elSearchInfo;};mstrSearch.prototype.onwinresize=function(){try{if(!this.isMiniSearchBox&&!this.isDesktopSearchBox){this.availableHeight=this.getAvailableHeight();var C=this.elResultPlaceholder.offsetHeight;var A=this.availableHeight;this.fx(this.elResultPlaceholder,"height",C,A,10,100,"px");if(!this.atTop&&!microstrategy.resizeAtBodyLoading){this.positionSearchBox(false);}microstrategy.resizeAtBodyLoading=false;}}catch(B){microstrategy.errors.log(B);return false;}};mstrSearch.prototype.getAvailableHeight=function(E){try{var H=mstr.utils.BoxModel,A=H.getBrowserWindowHeight(document),G=parseInt(H.position(E?document.getElementById("mstrWeb_content"):this.elResultPlaceholder).top,10),C=25,F=15;if(E){return A-G;}var B=microstrategy.findChildWithAtt(this.elem,"div","name","folderAllModes");return Math.min((A-G-C-F),Math.max(B&&B.scrollHeight,100));}catch(D){microstrategy.errors.log(D);return false;}};mstrSearch.prototype.positionSearchBox=function(D){try{var C=this;if(C.moving){return ;}if(C.isMiniSearchBox||C.isDesktopSearchBox){return ;}if(!D){C.searchBoxTop=C.getAvailableHeight(true)*0.4;C.elem.style.marginTop=C.searchBoxTop+"px";C.centered=true;}else{if(!C.atTop){var E=C.searchBoxTop||0,A=0;C.moving=true;C.fx(C.elem,"marginTop",E,A,10,100,"px",function(){C.atTop=true;});}}}catch(B){microstrategy.errors.log(B);}};mstrSearch.prototype.updateQuickSearchEnabled=function(){this.qse=microstrategy.useQuickSearch();this.pqse=this.qse;this.qse=this.qse&&(mstr.$A.find(mstrSearch.QUICK_SEARCH_TYPES,parseInt(this.nameWildcards))>-1);this.doAutoComplete=this.qse&&microstrategy.enableSearchAutoComplete;this.searchDelay=Math.max(0,microstrategy.searchAutoCompleteDelay);};mstrSearch.prototype.syncInputWithSuggest=function(){return ;this.elSuggestInput.selectionEnd=this.target.selectionEnd;this.elSuggestInput.visibility=(this.target.value.length>this.target.size)?"hidden":"visible";if(mstr.utils.ISWK){this.target.blur();this.target.focus();}};mstrSearch.prototype.getRootFolderName=function(){return{0:this.rootFolderName,7:microstrategy.descriptors.getDescriptor(2),20:microstrategy.descriptors.getDescriptor(3),39:microstrategy.descriptors.getDescriptor(9163)}[this.rootFolderType]||microstrategy.descriptors.getDescriptor(9163);return this.rootFolderName;};mstrSearch.prototype.updateTipText=function(){this.tipText=this.rootFolderType!=null?microstrategy.descriptors.getDescriptor(4325)+": "+this.getRootFolderName():this.tipText;this.target.onblur();};mstrSearch.prototype.hasUserInput=function hasUserInput(){var A=this.hasSearchPattern;A=A||(this.elDescription&&!mstr.utils.String.isEmpty(this.elDescription.value))||this.ownerType==2||this.dateType!=1&&(this.dateSubType==1&&!mstr.utils.String.isEmpty(this.intervalValue)||this.dateSubType==2&&!mstr.utils.String.isEmpty(this.startDate));return A;};mstrSearch.prototype.forceSearch=function forceSearch(){if(!this.hasUserInput()){return ;}this.elSuggestInput.value="";this.hidePopup();this.last_searchPattern=null;this.currentPage=1;this.blockBegin=1;this.requestResults();};mstrSearch.prototype.requestSuggestion=function requestSuggestion(A){this.positionSearchBox(true);var B={taskId:"getSearchSuggestions",keyword:A};this.xhr.request("post",mstrApp.taskURL||mstrConfig.taskURL,this.callbacks.suggest(this),B);};mstrSearch.prototype.delayedRequestSuggestion=function requestSuggestion(A){if(this.tmrRS){window.clearTimeout(this.tmrRS);}if(this.tmrRR){window.clearTimeout(this.tmrRR);}var B=this;this.tmrRS=window.setTimeout(function(){B.requestSuggestion(A);},this.searchDelay);};mstrSearch.prototype.requestResults=function requestResults(){if(!this.hasUserInput()){return ;}if(!this.searchPattern){this.searchPattern="";}var B=this;this.positionSearchBox(true);if(this.showInfoIconOnce){this.showInfoIconOnce=false;}else{this.showSearchInfoIcon(false);}var C=function(G){if(!B.isMiniSearchBox){return G.toString();}var H=[],E=mstrSearch.DEFAULT_OBJECT_TYPE;for(var F in E){if(mstr.$A.find(G,E[F])>-1){H.push(E[F]);}}return H.toString();};var A=function(){var G="";if(B.isMiniSearchBox){return G;}if(B.dereferenceshortcut=="1"){return G;}if(!B.elTypesCheckboxes){return G;}var E=microstrategy.findChildWithAtt(B.elSearchOptions,"input","id","objectType_18");if(!E||!E.checked){return G;}var H=[];for(var F=0;F<B.elTypesCheckboxes.length;F++){H.push(B.elTypesCheckboxes[F].value);}return H.toString();};var D={taskEnv:"juil_xhr",taskId:"searchMetadata",searchId:this.blockBegin>this.blockCount?this.searchId:"",quickSearch:this.qse,fields:this.fields,styleName:(this.showAsPopup?this.styleName4Json:this.styleName),searchPattern:this.last_searchPattern||this.searchPattern,objectType:C(this.objectType),targetObjectType:A(),rootFolderType:this.rootFolderType,rootFolderID:(this.rootFolderType=="0"?this.rootFolderID:""),dereferenceshortcut:this.dereferenceshortcut,searchDomain:this.searchDomain,servletName:mstrApp&&mstrApp.name,supportOMD:this.supportOMD,maxObjects:this.maxObjects,blockCount:this.blockCount,blockBegin:this.blockBegin,nameWildcards:this.nameWildcards,recursive:this.recursive,sortKey:this.qse?-1:6,dateType:this.dateType,created:this.created,dateSubType:this.dateSubType,intervalUnit:this.intervalUnit,intervalValue:this.intervalValue,startDate:this.startDate,endDate:this.endDate,ownerType:this.ownerType,description:this.description};if(this.showAsPopup){D.includeObjectDesc=this.showAsPopup;D.includeAncestorInfo=this.showAsPopup;}this.xhr.request("post",mstrApp.taskURL||mstrConfig.taskURL,this.showAsPopup?this.callbacks.searchPop(this):this.callbacks.search(this),D);this.showSpinnerIcon();};mstrSearch.prototype.delayedRequestResults=function requestResults(){if(this.tmrRR){window.clearTimeout(this.tmrRR);}var A=this;this.tmrRR=window.setTimeout(function(){A.requestResults();},this.searchDelay);};mstrSearch.prototype.handleSearchErrorAndModeSwitching=function(xhr){var me=this;if(me.qse){var code=xhr.getResponseHeader("X-MSTR-TaskErrorCode"),msg=xhr.getResponseHeader("X-MSTR-TaskFailureMsg")||"";if(!code||code==-2147209051){return ;}SESVC_E_SEARCH_ENGINE_NOT_STARTED=-2147212073;SESVC_E_PROJECT_SEARCH_DISABLED=-2147212154;if(code==SESVC_E_SEARCH_ENGINE_NOT_STARTED||code==SESVC_E_PROJECT_SEARCH_DISABLED){microstrategy.isQuickSearchEnabled=false;me.updateQuickSearchEnabled();me.nameWildcards={16:1,2:2,4:4,8:8}[me.nameWildcards];me.onload();this.showInfoIconOnce=true;}else{var elError=this.elError||document.createElement("div");elError.innerHTML='<div class="mstrSearchError"><div style="padding:20px; color:##880000;">'+me.addAdminInfo(msg)+"</div>";"</div>";if(!this.elError){this.elError=elError;}if(this.isMiniSearchBox||this.isDesktopSearchBox){this.popupContainer.innerHTML=this.elError.firstChild.innerHTML;}else{this.elResultPlaceholder.innerHTML=this.elError.innerHTML;this.elIncFetchPlaceholder.innerHTML="";}}}else{var flag=eval("("+xhr.responseText+")").qsr;if(microstrategy.enableQuickSearch&&flag){microstrategy.isQuickSearchEnabled=true;me.updateQuickSearchEnabled();me.nameWildcards={1:16,2:2,4:4,8:8}[me.nameWildcards];me.onload();}}};mstrSearch.prototype.callbacks={suggest:function(A){return{success:function(D){for(var C in A){this[C]=A[C];}if(!A.hasSearchPattern){A.clear();A.hidePopup();return ;}if(!D){this.xhr.xhr.abort();A.requestSuggestion();return ;}A.sItems=D.items||[];var B=A.sItems.length;for(var C=0;C<B;C++){A.sItems[C].tp=mstrSearch.OBJECT_TYPE_SUGGESTION;}if(B){A.selectedSuggestionIndex=null;A.renderSuggestionPopup(A.sItems);}else{A.hidePopup();}var E=D.items&&D.items[0]&&D.items[0].n.toLowerCase();if(E){A.elSuggestInput.value=E.replace(new RegExp("^"+A.searchPattern,"i"),A.target.value);A.syncInputWithSuggest();}else{E=A.searchPattern;}A.suggest=E;if(A.last_searchPattern!=E){A.last_searchPattern=E;window.setTimeout(function(){A.requestResults();},0);}},failure:function(){},complete:function(B){A.hideSpinnerIcon();A.handleSearchErrorAndModeSwitching(B);}};},search:function(me){return{success:function(res){try{for(var i in me){this[i]=me[i];}if(!me.hasUserInput()){me.clear();me.hidePopup();return ;}if(!res){this.xhr.xhr.abort();me.requestResults();return ;}var html=res.html;if(res.ts==0){html='<div class="mstrSearchNotice"><div class="mstrSearchNoticeText">'+microstrategy.descriptors.getDescriptor(9202).replace("###"," <b>"+mstr.utils.String.escape4HTMLText(this.getRootFolderName())+"</b>").replace("##","<b>"+mstr.utils.String.escape4HTMLText(me.searchPattern)+"</b> ")+"</div></div>";}me.searchId=res.searchId||"";me.totalSize=me.getTotalSize(res.ts);me.blockBegin=res.bb;me.rsData=[html,me.totalSize,res.bb];me.elResultPlaceholder.innerHTML=html;me.updatePageNumber();me.updateIncFetch(me.rsData);var scripts=me.elResultPlaceholder.getElementsByTagName("SCRIPT");for(var i=0,len=scripts.length;i<len;i++){var inlineJS=scripts[i][mstr.utils.ISWK?"innerHTML":(mstr.utils.ISFF?"textContent":"text")];eval(inlineJS.split("<!--").join("").split("-->").join(""));}microstrategy.registerNewBones();if(microstrategy.bones[this.folderBoneId]){microstrategy.bone(this.folderBoneId).onreload();}this.onwinresize();}catch(err){microstrategy.errors.log(err);}},failure:function(xhr){},complete:function(xhr){me.hideSpinnerIcon();me.handleSearchErrorAndModeSwitching(xhr);}};},searchPop:function(A){return{success:function(C){for(var B in A){this[B]=A[B];}if(!A.hasSearchPattern){A.clear();A.hidePopup();return ;}if(!C){this.xhr.xhr.abort();A.requestResults();return ;}A.rItems=C.items||[{t:0,dssid:"",n:microstrategy.descriptors.getDescriptor(9135)}];A.renderResultsPopup(A.rItems);},failure:function(){alert(xhr.status+" : "+xhr.statusText);},complete:function(B){A.hideSpinnerIcon();A.handleSearchErrorAndModeSwitching(B);}};}};mstrSearch.prototype.cancel=function(){this.xhr.cancel();};mstrSearch.prototype.processInput=function(E){try{E=(E||window.event);var C=E.keyCode,A=this.target.value;this.searchPattern=A;this.blockBegin=1;if(!this.doAutoComplete&&C!=13){return ;}if(C==13||A.length<this.minKeyLength){if(C==13&&this.selectedIndex>-1&&this.rItems){if(this.executeObject(this.rItems[this.selectedIndex])){return ;}}if(!this.hasSearchPattern){this.clear();}this.hidePopup();this.forceSearch();return ;}else{var B=A;switch(C){case 38:case 40:if(this.updateSelectedIndex(E)){this.delayedRequestResults();}else{if(this.tmrRR){window.clearTimeout(this.tmrRR);}}break;case 13:case 27:this.hidePopup(E);this.cancel();break;case 37:break;case 39:if(this.elSuggestInput.value&&this.target.value!=this.elSuggestInput.value){this.target.value=this.elSuggestInput.value;}break;default:this.showClearIcon();if(!this.enableSuggestion){return ;}this.showLoadingIcon(true);this.showSpinnerIcon(true);this.elSuggestInput.value="";this.delayedRequestSuggestion(B);this.showLoadingIcon(true);}}}catch(D){microstrategy.errors.log(D);}};mstrSearch.prototype.switchSearchStyle=function(A){switch(A){case"list":this.styleName="FolderStyleQuickSearchResults";break;case"icon":this.styleName="FolderStyleQuickSearchResultsIcon";break;}if(this.hasUserInput()){this.requestResults();}};mstrSearch.prototype.showCurtainOverResults=function(){var A=this.elCurtain;if(!A){A=this.elCurtain=(document.createElement("div"));A.className="mstrSearchResultsCurtain"+(mstr.utils.ISIE7||mstr.utils.ISIE8?" ie78":"");}var B=A.style,C=this.elResultPlaceholder;C.appendChild(A);if(mstr.utils.ISIE7){B.height=C.offsetHeight+"px";B.width=C.offsetWidth+"px";}B.display="block";};mstrSearch.prototype.hideCurtainOverResults=function(){if(this.elCurtain){this.elCurtain.style.display="none";}};mstrSearch.prototype.showSpinnerIcon=function(A){this.sbSpinner.className=this.sbSpinner.className.replace(/ show/gi,"")+" show";if(this.useCurtainOverResults){this.showCurtainOverResults();}};mstrSearch.prototype.hideSpinnerIcon=function(A){this.sbSpinner.className=this.sbSpinner.className.replace(/ show/gi,"");this.hideCurtainOverResults();};mstrSearch.prototype.showClearIcon=function(A){this.sbClear.className=this.sbClear.className.replace(/ show/gi,"")+" show";};mstrSearch.prototype.hideClearIcon=function(A){this.sbClear.className=this.sbClear.className.replace(/ show/gi,"");};mstrSearch.prototype.clear=function(A){this.hideClearIcon();this.hideSpinnerIcon();this.searchPattern="";this.last_searchPattern="";this.hasSearchPatten=false;this.target.value="";this.elSuggestInput.value="";this.elResultPlaceholder.innerHTML="";if(this.fetch){this.fetch.parentNode&&this.fetch.parentNode.removeChild(this.fetch);}this.hidePopup();};mstrSearch.prototype.showLoadingIcon=function(A){if(this.loadingIcon&&this.showSuggestionLoadingIcon){this.loadingIcon.style.display=A?"block":"none";}};mstrSearch.prototype.goToSearchPage=function(B){B="&srchStr="+(B?encodeURIComponent(mstr.utils.String.escape4HTMLText(B)):"");B+="&folderId="+this.rootFolderID;B+="&folderType="+this.rootFolderType;B+="&folderName="+this.rootFolderName;B+="&nameWildcards="+this.nameWildcards;if(typeof (mstrUpdateManager)!="undefined"){microstrategy.updateBrowserSetting("rootFolderName",this.rootFolderName,true);microstrategy.updateBrowserSetting("rootFolderType",this.rootFolderType,true);microstrategy.updateBrowserSetting("rootFolderID",this.rootFolderID,true);microstrategy.updateBrowserSetting("qsGUID",this.getGUID(),true);}var A=createDynamicForm(microstrategy.servletName+"?evt=3040"+B+"&src="+microstrategy.servletName+".3040");submitForm(A);delete A;};mstrSearch.prototype.renderPopupContainer=function(){try{var D=this;var A=document.createElement("div");A.setAttribute("scriptclass","mstrSearch");A.setAttribute("n","mstrSearchPopupContainer");A.id=this.id+"_mstrSuggestPopupContainer";A.className="mstrSuggestPopupContainer"+(mstr.utils.ISIE7||mstr.utils.ISIE8?" ie":"");A.onmouseover=function(){var F=D.selectedItem,G=F&&parseInt(F.getAttribute("t"))>mstrSearch.OBJECT_TYPE_SUGGESTION;if(G){D.selectedIndex=-1;D.selectedItem=null;}};var B=document.createElement("div");B.className="mstrSuggestPopupLoading";A.appendChild(B);this.loadingIcon=B;this.popupContainer=A;var E=microstrategy.findAncestorWithTag(this.target,"DIV");if(E){E.style.position="relative";E.style.zIndex=1;}this.target.parentNode.appendChild(A);return A;}catch(C){microstrategy.errors.log(C);}};mstrSearch.prototype.buildPopup=function(C){try{var E=document.createElement("div");E.id=C.id;E.className="mstrSuggestPopup "+C.cssClass;if(this.showAsPopup&&C.label!=null){E.innerHTML='<label class="label">'+C.label+"</label>";}var B=C.items||[];for(var D=0,A=B.length;D<A;D++){E.appendChild(this.renderPopupItem(B[D],D));}return E;}catch(F){microstrategy.errors.log(F);}};mstrSearch.prototype.renderSuggestionPopup=function(A){try{this.selectedIndex=-1;this.hidePopup();this.suggestList=this.buildPopup({items:A,label:microstrategy.descriptors.getDescriptor(8953),id:"mstrSuggestPopup_"+this.id,cssClass:"suggest"});this.popupContainer.appendChild(this.suggestList);this.positionPopup();this.showLoadingIcon(false);}catch(B){microstrategy.errors.log(B);}};mstrSearch.prototype.renderResultsPopup=function(B){try{if(this.selectedSuggestionIndex!=undefined){this.selectedIndex=B.length+this.selectedSuggestionIndex;}var F="mstrSearchResultsPopup_"+this.id,D=this.buildPopup({items:B,label:microstrategy.descriptors.getDescriptor(6595),id:F});var A=document.getElementById(F),C=this.popupContainer;if(A){C.replaceChild(D,A);}else{C.insertBefore(D,C.lastChild);}this.resultList=D;}catch(E){microstrategy.errors.log(E);}};mstrSearch.prototype.renderPopupItem=function(P,G){try{var M=this;var O=document.createElement("div");O.setAttribute(mstrSearch.ITEM_IDX,G);O.setAttribute("t",P.tp||P.t);O.setAttribute("ty","pi");O.className="mstrSuggestPopupItem";O.onmouseover=function(R){var S=parseInt(this.getAttribute("t"))>mstrSearch.OBJECT_TYPE_SUGGESTION;if(M.selectedItem){M.selectedItem.className=M.selectedItem.className.replace(mstrSearch.selected_regex,"");}M.selectedIndex=parseInt(this.getAttribute(mstrSearch.ITEM_IDX));this.className+=mstrSearch.selected_CssClass;};O.onmouseout=function(R){this.className=this.className.replace(mstrSearch.selected_regex,"");M.selectedItem=this;};O.onmousedown=function(R){M.onClickPopupItem(R);};var N=this.renderPopupItemIcon(P.icon||this.t2css(P));var C=document.createElement("span");C.className="mstrSuggestPopupItemName";var K=(this.last_searchPattern||this.searchPattern),L=K.split(" "),B=function(R){return new RegExp("("+R.replace(/[*]/g,"\\*").replace(/[?]/g,"\\?")+")","gi"),"<b>$1</b>";};C.innerHTML=mstr.utils.String.escape4HTMLText(P.n);if(mstr.$A.find([2],parseInt(this.nameWildcards))>-1){try{C.innerHTML=C.innerHTML.replace(B(K));}catch(J){}}else{for(var G=0,I=L.length;G<I;G++){try{C.innerHTML=C.innerHTML.replace(B(L[G]));}catch(J){}}}var Q="",A=P.anc&&P.anc.items,D=A&&A.length;if(D>0){for(var G=0;G<D-1;G++){Q+=A[G].n+" > ";}Q+=A[D-1].n;}Q+=(Q.length==0?"":" > ")+C.innerHTML;var H=P.desc,F=120;if(H){Q+="\r\n\r\n"+H.substring(0,F)+(H.length>F?"...":"");}O.title=Q;O.appendChild(N);O.appendChild(C);return O;}catch(E){microstrategy.errors.log(E);}};mstrSearch.prototype.t2css=function(B){var A="";A={4:"m",256:"fi",257:"cg",768:"g",769:"gp",774:"gpgs",776:"cb",779:"cb",8704:"u",8705:"ug",14080:"d",14081:"rw avm"}[B.st];if(!A){A={1:"fi",2:"t",3:"g",4:"m",8:"f",10:"pr",18:"sc",44:"sr",55:"rw",0:"null"}[B.t];}if(B.dvm&&B.t==55){A+=" "+{2048:"avm",8192:"avm"}[B.dvm];}if(A){A+=(B.isc?"_sc":"");}return A;};mstrSearch.prototype.getTargetPopupItem=function(A){var B=null;A=A||window.event;if(A){B=A.target||A.srcElement;if(B&&B.getAttribute){if(B.getAttribute(mstrSearch.ITEM_IDX)==null){B=findTarget(B,"t");}}}return B;};mstrSearch.prototype.onClickPopupItem=function(C){C=C||window.event;if(mstr.$E.button(C,window)!=1){cancelEvent(C);stopEventBubbling(C);return false;}var D=this.getTargetPopupItem(C),B=D&&D.getAttribute("t"),A=D&&D.getAttribute("acidx");if(B==mstrSearch.OBJECT_TYPE_SUGGESTION){this.updateSearchInput(C);}else{if(B>0){this.commands=new mstrSearchCommands(this);this.commands.execute(this.rItems[A]);}}};mstrSearch.prototype.executeObject=function(A){if(A){iframe.showWaitPage();this.commands=this.commands||new mstrSearchCommands(this);this.commands.execute(A);}else{return false;}};mstrSearch.prototype.renderPopupItemIcon=function(C){try{if(C){var A=document.createElement("span"),D=C.split("_");A.className="mstrIcon-lv mstrIcon-lv-"+D[0];if(D.length==2){var B=document.createElement("span");B.className=D[1];A.appendChild(B);}return A;}else{return this.renderSuggestionPopupItemIcon();}}catch(E){microstrategy.errors.log(E);}};mstrSearch.prototype.renderSuggestionPopupItemIcon=function(){var A=document.createElement("span");A.className="mstrIcon-lv mstrIcon-lv-search";return A;};mstrSearch.prototype.positionPopup=function(D,A){try{var D=D||this.target,A=A||this.popupContainer;if(this.showAsPopup){A.style.width=(mstr.utils.BoxModel.getBrowserWindowWidth(document)-mstr.utils.BoxModel.position(D).left)+"px";}else{var C=microstrategy.findAncestorWithAtt(D,mstr.utils.ISIE7?"className":"class","SearchBox-Wrapper")||D;A.style.width=(C.offsetWidth)+"px";}if(this.showSuggestAsPopup){if(A&&!this.isDesktopSearchBox){document.body.appendChild(A);A.style.top=(mstr.utils.BoxModel.position(D).top+mstr.utils.BoxModel.position(D).height-(mstr.utils.ISIE7?3:0))+"px";A.style.left=(mstr.utils.BoxModel.position(D).left-(mstr.utils.ISIE7?5:2))+"px";A.style.position="absolute";}}else{A.style.position="static";}}catch(B){microstrategy.errors.log(B);}};mstrSearch.prototype.hidePopup=function(D){try{D=D||window.event;var B=this.resultList,C=this.suggestList;if(B&&B.parentNode){if((D&&(D.type=="mousedown"||D.type=="click"||D.keyCode==27)||this.last_searchPattern!=this.suggest)&&B&&B.id){B.parentNode.removeChild(B);delete this.resultList;}}if(C&&C.parentNode){C.parentNode.removeChild(C);delete this.suggestList;}this.showLoadingIcon(false);this.last_searchPattern="";}catch(A){microstrategy.errors.log(A);}};mstrSearch.prototype.updateSearchInput=function(B){try{B=B||window.event;var C=B.target||B.srcElement;if(C&&C.getAttribute){if(C.getAttribute(mstrSearch.ITEM_IDX)==null){C=microstrategy.findAncestorWithAtt(C,mstrSearch.ITEM_IDX,this.selectedIndex);}if(C&&C.getAttribute&&C.getAttribute(mstrSearch.ITEM_IDX)!=null){this.target.value=C.textContent||C.innerText;if(this.ok){this.ok.click();}}}this.elSuggestInput.value=this.target.value;this.searchPattern=this.target.value;this.last_searchPattern=this.elSuggestInput.value;this.requestResults();}catch(A){microstrategy.errors.log(A);}};mstrSearch.prototype.updateSelectedIndex=function(F){try{var I=this.popupContainer;if(!I||!this.resultList&&!this.suggestList){return ;}F=F||window.event;var E=(F||window.event).keyCode;if(E==38||E==40||E==13){var D=null,H=this.selectedIndex,A=microstrategy.findChildrenWithAtt(I,"div","ty","pi");var G=function(J){if(J>-1){D=A[J];if(D){D.className=D.className.replace(mstrSearch.selected_regex,"");}}};G(H);switch(E){case 40:this.selectedIndex=(H>=A.length-1)?A.length-1:H+1;break;case 38:this.selectedIndex=(H<=0)?-1:H-1;break;case 13:this.hidePopup();this.selectedIndex=-1;return ;}D=A[this.selectedIndex];if(!D){return false;}D.className+=mstrSearch.selected_CssClass;var B=false;if(D.getAttribute("t")=="-1"){this.target.value=D.textContent||D.innerText;this.elSuggestInput.value=this.target.value;if(this.last_searchPattern!=this.elSuggestInput.value){B=true;this.last_searchPattern=this.elSuggestInput.value;}this.selectedSuggestionIndex=this.selectedIndex-(this.rItems&&this.rItems.length||0);}else{this.selectedItem=D;B=false;}return B;}}catch(C){microstrategy.errors.log(C);}};mstrSearch.prototype.ondocumentclick=function(C){try{if(mstr.$E.button(C||window.event,window)!=1&&!this.isMiniSearchBox){return false;}var B=this;window.setTimeout(function(){if(B.suggestList||B.resultList){B.hidePopup(C);}B.onwinresize();},300);}catch(A){microstrategy.errors.log(A);}};mstrSearch.prototype.prepareCalendar=function prepareCalendar(){if(asDescriptors.length==0){var A=microstrategy.descriptors;self.asDescriptors=["",A.getDescriptor(1956),A.getDescriptor(1957),A.getDescriptor(1958),A.getDescriptor(1959),A.getDescriptor(1960),A.getDescriptor(1961),A.getDescriptor(1962),A.getDescriptor(1963),A.getDescriptor(1964),A.getDescriptor(1965),A.getDescriptor(1966),A.getDescriptor(1967),A.getDescriptor(1968),A.getDescriptor(1969),A.getDescriptor(1970),A.getDescriptor(1971),A.getDescriptor(1972),A.getDescriptor(1973),A.getDescriptor(1974),];self.Month_Names=[A.getDescriptor(3852),A.getDescriptor(3853),A.getDescriptor(3854),A.getDescriptor(3855),A.getDescriptor(3856),A.getDescriptor(3857),A.getDescriptor(3858),A.getDescriptor(3859),A.getDescriptor(3860),A.getDescriptor(3861),A.getDescriptor(3862),A.getDescriptor(3863)];}};mstrSearch.prototype.toggleOptions=function toggleOptions(C){var A=this.elSearchOptions;var B=C.getAttribute("v")||0;B=Math.abs(B-1);C.setAttribute("v",B);if(B){A.style.display="block";A.style.height=0;start=0;end=580;}else{start=580;end=0;}this.fx(A,"height",start,end,10,100,"px",(B?function(){A.style.height="auto";}:function(){A.style.display="none";}));if(B==0&&this.qse){this.requestResults();}};mstrSearch.prototype.updateOptions=function updateOptions(D){var G=D.name,C=D.value,F=this;switch(D.tagName.toLowerCase()){case"select":case"textarea":F[G]=C;if(D.id=="created"){F.dateType=C=="0"?1:2;}this.restoreDateSubsection(D);break;case"input":switch(D.type){case"text":if(!this.isValid(D)){return false;}case"radio":F[G]=C;if(G=="rootFolderType"){F.updateTipText();}break;case"checkbox":if(G=="dereferenceshortcut"){F[G]=D.checked?"1":"0";break;}var E=function(J,I){var K=[];for(var L=0,H=J.length;L<H;L++){if(J[L].checked||I){K.push(J[L].value);}}return K;};var B=E(this.elTypesCheckboxes,false);if(B.length==0){B=E(this.elTypesCheckboxes,true);}F[G]=B.sort().toString();break;}break;}this.updateQuickSearchEnabled();if(!this.qse){this.hidePopup();}else{if(this.doAutoComplete){this.delayedRequestResults();}}microstrategy.updateCookieSetting(G,F[G],true);microstrategy.updateBrowserSetting(G,F[G],true);if(mstr.utils.ISIE7&&!this.qse){var A=document.createElement("img");document.body.appendChild(A);window.setTimeout(function(){A.parentNode.removeChild(A);},0);}};mstrSearch.prototype.isValid=function(C){try{var A=C.value||"",E=C.getAttribute("dt")||1,B=mstr.utils.LocaleParser,G=B._getMethodLookup()[E],F=G&&B[G](A);C.style.color="";C.title="";if(!F){C.style.color="#f00";C.title=microstrategy.descriptors.getDescriptor(5717);}return F;}catch(D){microstrategy.errors.log(D);}};mstrSearch.prototype.fx=function fx(J,B,D,H,E,G,M,A){D=parseInt(D,10);H=parseInt(H,10);E=E||50;G=G||500;M=M||"";var L=Math.max(Math.ceil(G/E),1),K=J.style,I=0,F=function(){++I;K[B]=D+I*(H-D)/L+M;if(I>=L){if(A){A();}window.clearInterval(C);}};var C=window.setInterval(function(){F();},E);};mstrSearch.prototype.getTotalSize=function(A){return Math.min(microstrategy.maxSearchResults,A||this.totalSize);};mstrSearch.prototype.updatePageNumber=function(){this.pageNumber=Math.ceil(this.getTotalSize()/this.blockCount);this.currentPage=Math.max(1,Math.ceil(this.blockBegin/this.blockCount));};mstrSearch.prototype.updateIncFetch=function(C){if(!C||this.pageNumber<=1){if(!this.fetch){return ;}this.fetch.style.display="none";return ;}if(!this.fetch){this.fetch=this.buildIncFetch();this.elIncFetchPlaceholder.appendChild(this.fetch);}if(this.fetch){this.totalSize=C[1];this.blockBegin=C[2];var I=this.totalSize,H=this.blockBegin,E=this.blockCount;var B=this.pageNumber,F=this.currentPage;var G=function(J){return(J==F)?" on":"";};var A=function(Q){var T=Q.pageNumber,P=Q.currentPage,R=Q.ifSize,V=Math.floor(R/2);var J=Math.max(Math.min(P-V,T-R+1),1),L=Math.min(J+R-1,T);var N="";for(var M=J;M<=L;M++){var U=M==Q.currentPage?(B>R?"microstrategy.bone('"+Q.id+"').toggleIncFetchPopup(true)":""):"microstrategy.bone('"+Q.id+"').fetchPage("+M+")";var K="",S="",O="";if(B>R&&M==Q.currentPage){K="<div></div>";S=microstrategy.descriptors.getDescriptor(5879);O=" dd";}N+='<div class="IncFetchButton pg'+G(M)+O+'" onmousedown="'+U+'" title="'+S+'">'+M+K+"</div>";}return N;};this.pageBar.innerHTML=A(this);this.fetchInfo.innerHTML=(B>this.ifSize?" "+microstrategy.descriptors.getDescriptor(5972).replace("##","").replace("###",this.pageNumber):"");this.fetchInfo.style.display=(I>0)?"block":"none";this.fetchInput.setAttribute("size",String(this.totalSize).length);this.fetchInput.setAttribute("maxlength",String(this.totalSize).length);var D=" disabled";this.fetchFirst.className=this.fetchFirst.className.replace(D,"")+(H>=E?"":D);this.fetchPrevious.className=this.fetchPrevious.className.replace(D,"")+(H>=E?"":D);this.fetchNext.className=this.fetchNext.className.replace(D,"")+(H+E<=I?"":D);this.fetchLast.className=this.fetchLast.className.replace(D,"")+(H+E<=I?"":D);this.fetch.style.display=this.pageNumber>1?"block":"";if(!this.fetch.offsetParent){this.elIncFetchPlaceholder.appendChild(this.fetch);}}};mstrSearch.prototype.buildIncFetch=function(){var B=this;var A=document.createElement("span");A.innerHTML='<div class="mstrIncFetch" ty="if"><div class="mstrIncFetchPopupWrapper"><div class="mstrIncFetchPopup" ty="d" id="mstrIncFetchPopup"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><span>'+microstrategy.descriptors.getDescriptor(5878)+'</span></td><td><input type="text" id="mstrIncFetchInput" value="" maxlength="3" class="mstrIncFetchInput" ty="in" ></td><td><input type="button" src="../images/1ptrans.gif" class="mstrIncFetchApply" title="'+microstrategy.descriptors.getDescriptor(2398)+'" ty="ap"><input type="button" src="../images/1ptrans.gif" class="mstrIncFetchCancel" title="'+microstrategy.descriptors.getDescriptor(2399)+'"></td><td></td></tr></tbody></table></div></div><div class="IncFetchButton"><div class="btnArrow f" title="'+microstrategy.descriptors.getDescriptor(162)+'"></div></div><div class="IncFetchButton"><div class="btnArrow p" title="'+microstrategy.descriptors.getDescriptor(5961)+'"></div></div><div id="pageBar"></div><div class="pageInfo" onmousedown="microstrategy.bone(\''+this.id+'\').toggleIncFetchPopup(true)" title="'+microstrategy.descriptors.getDescriptor(5879)+'" ty="pg"></div><div class="IncFetchButton"><div class="btnArrow n" title="'+microstrategy.descriptors.getDescriptor(3012)+'"></div></div><div class="IncFetchButton"><div class="btnArrow l" title="'+microstrategy.descriptors.getDescriptor(163)+'"></div></div></div>';this.fetch=A.firstChild;delete A;this.fetchPopupWraper=this.fetch.firstChild;this.fetchPopup=this.fetch.firstChild.firstChild;this.fetchInfo=microstrategy.findChildrenWithAtt(this.fetch,"div",microstrategy.HTMLATTR_OBJTYPE,"pg")[0];this.pageBar=this.fetchInfo.previousSibling;this.fetchLast=this.fetch.lastChild;this.fetchLast.onmousedown=function(C){if(this.className.indexOf("disabled")>-1){return false;}return B.fetchBlock(C,2);};this.fetchNext=this.fetchLast.previousSibling;this.fetchNext.onmousedown=function(C){if(this.className.indexOf("disabled")>-1){return false;}return B.fetchBlock(C,1);};this.fetchPrevious=this.fetchNext.previousSibling.previousSibling.previousSibling;this.fetchPrevious.onmousedown=function(C){if(this.className.indexOf("disabled")>-1){return false;}return B.fetchBlock(C,-1);};this.fetchFirst=this.fetchPrevious.previousSibling;this.fetchFirst.onmousedown=function(C){if(this.className.indexOf("disabled")>-1){return false;}return B.fetchBlock(C,-2);};this.fetchInput=microstrategy.findChildrenWithAtt(this.fetch,"input",microstrategy.HTMLATTR_OBJTYPE,"in")[0];this.fetchInput.onkeyup=function(D){D=D||window.event;if(D.keyCode==13){B.fetchApply.onclick(D);stopEventBubbling(D);cancelEvent(D);}else{if(D.keyCode==27){B.toggleIncFetchPopup(false);}}var C=B.fetchInput.value.replace(/\s/g,"");if(isNaN(C)||/[^\d]/.test(C)||C>B.pageNumber){B.fetchInput.style.color="#f00";B.fetchApply.disabled=true;}else{B.fetchInput.style.color="#000";B.fetchApply.disabled=false;}return false;};this.fetchApply=microstrategy.findChildrenWithAtt(this.fetch,"input",microstrategy.HTMLATTR_OBJTYPE,"ap")[0];this.fetchApply.onclick=function(C){B.fetchBlock(C,0);B.toggleIncFetchPopup(false);return false;};this.fetchCancel=this.fetchApply.nextSibling;this.fetchCancel.onclick=function(C){B.toggleIncFetchPopup(false);return false;};return this.fetch;};mstrSearch.prototype.fetchPage=function(A){this.fetchInput.value=A;this.fetchBlock(null,0);};mstrSearch.prototype.fetchBlock=function(C,B){switch(B){case 0:var A=parseInt(this.fetchInput.value);if(isNaN(A)||/[^\d]/.test(A)||A>this.pageNumber){return false;}this.blockBegin=(A-1)*this.blockCount+1;break;case 1:case -1:this.blockBegin+=B*this.blockCount;break;case 2:this.blockBegin=(this.pageNumber-1)*this.blockCount+1;break;case -2:this.blockBegin=1;}this.fetchNewBlock=true;this.requestResults();this.toggleIncFetchPopup(false);return false;};mstrSearch.prototype.toggleIncFetchPopup=function(B){var C=this.fetchPopup,D=45,E=0,A=0;if(B&&!this.fetchPopupVisible){C.style.height=0;this.fetchInput.value="";this.fetchInput.focus();this.fetchPopupVisible=true;A=D;}else{if(this.fetchPopupVisible){E=D;this.fetchPopupVisible=false;}}if(this.fetch.offsetTop+this.elem.offsetHeight>mstr.utils.BoxModel.getBrowserWindowHeight(document)-D){C.style.bottom=0;C.style.top="auto";}else{C.style.top="25px";C.style.bottom="auto";}this.fx(C,"height",E,A,10,100,"px");};mstrSearch.prototype.xhr={encodeParams:function encodeParams(D){var A=-1;var B=[];if(D){for(var C in D){B[++A]=C+"="+encodeURIComponent(D[C]);}}return B.join("&");},appendUrlParams:function appendUrlParams(C,A,B){if(C!=="GET"||!B){return A;}return A+"?"+this.encodeParams(B);},sendXhr:function sendXhr(F,G,C,E,B){G=G.toUpperCase();var D=mstrApp;if(typeof (microstrategy)!="undefined"&&microstrategy&&microstrategy.validateRandNum!=null&&microstrategy.validateRandNum.length>0){E.validateRandNum=microstrategy.validateRandNum;}if(!E.validateRandNum&&mstrApp&&mstrApp.validateRandNum&&mstrApp.validateRandNum.length>0){E.validateRandNum=mstrApp.validateRandNum;}if(B){E.taskContentType=E.taskContentType||"json";E.taskEnv=E.taskEnv||"xhr";E.xts=new Date().getTime();C=C||mstrApp.taskURL||mstrConfig.taskURL;C=microstrategy.addJSessionID(C);}var A=D.persistTaskParams;F.open(G,this.appendUrlParams(G,C,E),true);if(G!=="POST"){E=null;}else{E=this.encodeParams(E);F.setRequestHeader("Content-type","application/x-www-form-urlencoded");}F.send(E);},createXhr:function createXhr(){var A=[function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}];for(var C=0,B=A.length;C<B;C++){var E;try{E=A[C]();}catch(D){continue;}createXhr=A[C];return E;}throw new Error("mstrSearch.xhr: Could not create an XHR object.");},evalResponse:function evalResponse(rt){var _rtn=null;try{_rtn=eval("("+rt+")");}catch(ex){_rtn=rt;}return _rtn;},err_c:{MSI_SERVER_NAME_NOT_INITIALIZED:2147760371,MSI_INVALID_SESSION_ID:2147760372,E_MSI_USERMGR_USER_NOTFOUND:2147758245,E_MSI_CONNECT_FAILED:2147759877},isSessionExpiredError:function(A){var B=A&&A.getResponseHeader("X-MSTR-TaskErrorCode");B=(B<0)?(4294967296+parseInt(B,10)):B;switch(B){case this.err_c.MSI_SERVER_NAME_NOT_INITIALIZED:case this.err_c.MSI_INVALID_SESSION_ID:case this.err_c.E_MSI_USERMGR_USER_NOTFOUND:case this.err_c.E_MSI_CONNECT_FAILED:return true;}return false;},isTask:true,queue:[],requestInProgress:false,retryDelay:1,cancel:function(){if(this.requestInProgress){var A=this.xhr;if(A){delete A.onreadystatechange;if(A.readystate!==4){A.abort();}this.xhr=null;}this.requestInProgress=false;}},request:function request(H,D,G,F,B,A){if(this.requestInProgress&&!B){this.queue.push({method:H,baseUrl:D,callback:G,params:F});}else{if(this.requestInProgress){this.cancel();}this.requestInProgress=true;var E=this.createXhr(),C=this;E.onreadystatechange=function(){if(E.readyState!==4){return ;}try{if(E.status===200){C.response=C.evalResponse(E.responseText);if(G.success){G.success(C.response);}}else{if(mstrApp&&mstrApp.onSessionExpired&&C.isSessionExpiredError(E)){mstrApp.onSessionExpired();}else{if(G.failure){G.failure(E);}}}}catch(I){}finally{if(G.complete){G.complete(E);}C.advanceQueue();}};this.xhr=E;this.sendXhr(E,H,D,F,this.isTask);}},advanceQueue:function advanceQueue(){if(this.queue.length===0){this.requestInProgress=false;return ;}var A=this.queue.shift();this.request(A.method,A.baseUrl,A.callback,A.params,true);}};mstrSearchCommandsScript=true;mstrSearchCommands.prototype={};mstrSearchCommands.prototype.appName=microstrategy.servletName;mstrSearchCommands.FEATURES={ExecuteCubeReport:"web-execute-cube-report",CreateAnalysis:"create-analysis"};mstrSearchCommands.prototype.exec=function(A,B){switch(cmd){case"openFolder":case"run":this.execute(B);break;case"edit":this.designMode=1;this.execute();break;case"del":case"rename":default:break;}};mstrSearchCommands.prototype.execute=function(H){var M={FILTER:1,ATTR:12,FORM:21,DIM:14,METRIC:4,PROMPT:10,REPORT:3,FOLDER:8},F={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776},P={Browse:1,UseExecute:2,Read:4,Write:8,Delete:16,Control:32,Use:64,Execute:128,FullControl:255,Inheritable:536870912};this.appName=microstrategy.servletName;var L=H||this.selectedItem,N=parseInt(L.tp||L.t),O=parseInt(L.stp||L.st),J=L.dssid||L.did,B=L.viewMedia||L.dvm,A=L.visMode||0;var D={};switch(N){case 1:switch(O){case 256:D={evt:3113,filterID:J,src:this.appName+".3113"};break;case 257:openCustomGroupEditor(J);return ;break;}break;case 3:if(this.designMode){D={reportID:J,evt:3005,src:this.appName+".3005",reportDesignMode:this.designMode};break;}var Q=1;switch(O){case F.REPORT_CUBE:if(!this.parentBone.isFeatureAvailable(mstrSearchCommands.FEATURES.CreateAnalysis)){return ;}D={evt:3104,src:this.appName+".3104",executionMode:1,rwDesignMode:0,objectType:3,objectID:J,rwCreateFlags:16,rwViewMode:2048,fromPh:0};this.sendForm(D);return ;case F.REPORT_GRID:Q=1;break;case F.REPORT_GRAPH:Q=2;break;case F.REPORT_GRIDGRAPH:Q=3;break;}D={reportID:J,evt:4001,src:this.appName+".4001",visMode:A,reportViewMode:Q};break;case 8:D={evt:2001,folderID:J,src:this.appName+".2001"};break;case 55:var G={Reserved:0,ViewStatic:1,ViewInteractive:2,ViewEditable:4,ViewFlash:8,ExportExcel:16,ExportPDF:32,ExportHTML:64,ExportFlash:128,ExportExcelPlainText:256,ExportCSV:512,ExportPlainText:1024,ViewAnalysis:2048,HTML5Dashboard:8192,All:134217727};var E={DATA:1,DESIGN:2,PDF:3,EXCEL:4,SAVE:5,DETAILS:6,FLASH_EXPORT:7,FLASH_VIEW:8,FLASH_BINARY_VIEW:9};var C={};C[G.ExportPDF]=E.PDF;C[G.ExportExcel]=E.EXCEL;C[G.ExportFlash]=E.FLASH_EXPORT;var K={};K[G.ViewStatic]=2048001;K[G.ViewInteractive]=2048001;K[G.ViewEditable]=2048001;K[G.ExportHTML]=3130;K[G.ExportExcel]=3069;K[G.ExportFlash]=3069;K[G.ExportPDF]=3069;K[G.ViewAnalysis]=2048001;K[G.HTML5Dashboard]=3140;var I=2048001;if(O==14081){if(this.designMode){I=3104;D={evt:I,objectID:J,src:this.appName+"."+I,rwDesignMode:this.designMode,executionMode:2};}else{if(B>8){I=K[B];D={evt:I,documentID:J,src:this.appName+"."+I};if(B===G.HTML5Dashboard){if(mstr.utils.ISIE9Pre){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}}else{D.executionMode=C[B]||0;}}else{I=2048001;D={evt:I,documentID:J,src:this.appName+"."+I,visMode:A||0,currentViewMedia:B||2};}}}else{if(O==14080){var D={evt:32001,documentID:J,src:this.appName+".32001"};}}break;case 10:D={evt:3119,objectID:J,src:this.appName+".2048001"};break;case 2:break;case 34:var D={};switch(O){case 8704:D={evt:3114,src:this.appName+".3114",userId:J};break;case 8705:D={evt:3115,src:this.appName+".3115",groupId:J};break;}break;case 44:var D={evt:3121,sRoleId:J,src:this.appName+".3121"};break;default:return false;}this.sendForm(D);};mstrSearchCommands.prototype.sendForm=function(C){var A=[];for(var D in C){A.push(D+"="+C[D]);}var B=createDynamicForm(microstrategy.servletName+"?"+A.join("&"));B.method="POST";submitForm(B);delete B;};function mstrSearchCommands(A){this.parentBone=A;return this;}mstrMsgBoxImplScript=true;mstrMsgBoxImpl.prototype=new mstrEditorImpl();mstrMsgBoxImpl.prototype.okButton=null;mstrMsgBoxImpl.prototype.cancelButton=null;mstrMsgBoxImpl.prototype.applyButton=null;mstrMsgBoxImpl.MSG_WARNING="warning";mstrMsgBoxImpl.MSG_ERROR="error";mstrMsgBoxImpl.MSG_INFO="info";mstrMsgBoxImpl.MSG_INFO_WARNING="infowarning";mstrMsgBoxImpl.MSG_INPUT="input";mstrMsgBoxImpl.MSG_EXPORT_LINK="exportLink";mstrMsgBoxImpl.MSG_PREF_WARNING="prefwarning";mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID="msgPref";mstrMsgBoxImpl.MSG_TEXT_ONLY="textonly";mstrMsgBoxImpl.prototype.onload=function(){try{mstrEditorImpl.prototype.onload.call(this);this.okButton=microstrategy.subObjectFind(this.elem,["INPUT"],"ok");this.cancelButton=microstrategy.subObjectFind(this.elem,["INPUT"],"cancel");this.applyButton=microstrategy.subObjectFind(this.elem,["INPUT"],"apply");this.setDefaultLabel(this.okButton);this.setDefaultLabel(this.cancelButton);this.setDefaultLabel(this.applyButton);if(window.clipboardData!=null){this.body.onkeydown=new Function("e","microstrategy.bone('"+this.id+"').onkeydown(e);");}}catch(A){microstrategy.errors.log(A);return false;}};mstrMsgBoxImpl.prototype.setDefaultLabel=function(A){if(A){if(A.getAttribute("value")){A.setAttribute("defaultValue",A.getAttribute("value"));}}};mstrMsgBoxImpl.prototype.onkeydown=function(C){try{if(!C){C=window.event;}if(C.ctrlKey&&C.keyCode==67){var A=new RegExp("<br>","gi");var D=this.body.innerHTML.replace(A,"\r\n");D=D.replace(/&nbsp;/gi," ");window.clipboardData.setData("Text",D);}}catch(B){microstrategy.errors.log(B);return false;}};mstrMsgBoxImpl.prototype.setTitle=function(D){try{var B=microstrategy.findChildWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);var C=B.firstChild;if(C){if(D!=null&&D.length&&D.length!=0){C.innerHTML=D;}else{C.innerHTML=microstrategy.descriptors.getDescriptor("3610");}}}catch(A){microstrategy.errors.log(A);return false;}};mstrMsgBoxImpl.prototype.setMessage=function(F,A){try{var E=document.getElementById("msgContent");E.innerHTML="";if(E!=null){if(A==mstrMsgBoxImpl.MSG_INPUT){var B=document.createElement("INPUT");B.id=this.id+"_input";B.maxLength=256;B.size=28;E.appendChild(B);}else{E.innerHTML=F;}}var C=document.getElementById("msgIcon");if(C!=null){C.className="";C.innerHTML="";if(A==mstrMsgBoxImpl.MSG_INPUT){C.style.height="auto";C.innerHTML=F;}else{if(A!=null){C.style.height="32px";C.className="mstrMsgBoxMsgIcon-"+A;}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrMsgBoxImpl.prototype.initInput=function(D,H,B,A){try{var F=document.getElementById("msgContent");F.innerHTML="";if(F!=null){var I=document.createElement("INPUT");I.id=this.id+"_input";I.maxLength=A;I.size=B;I.value=H;F.appendChild(I);}var G=document.getElementById("msgIcon");if(G!=null){G.className="";G.innerHTML="";G.style.height="auto";G.innerHTML=D;}var C=document.getElementById("msgPrefContainer");if(C!=null){C.style.display="none";}}catch(E){microstrategy.errors.log(E);return false;}};mstrMsgBoxImpl.prototype.cleanBeforeInit=function(){var C=document.getElementById("msgContent");if(C!=null){C.style.paddingLeft="0px";C.style.width="320px";}var B=document.getElementById("msgIcon");if(B!=null){B.style.paddingLeft="0px";}var A=document.getElementById("iframeDiv");if(A){A.style.display="none";}this.cancelButton.value="Cancel";};mstrMsgBoxImpl.prototype.setTextOnlyContentWidth=function(){var A=document.getElementById("msgContent");if(A!=null){A.style.paddingLeft="0px";A.style.width="400px";}};mstrMsgBoxImpl.prototype.setButtonDisplay=function(B,A,C){if(B){var D="none";if(A){D=(A&C)?"inline":"none";}B.style.display=D;}};mstrMsgBoxImpl.prototype.setButtonDisplays=function(A){this.setButtonDisplay(this.okButton,A,microstrategy.OK_BUTTON);this.setButtonDisplay(this.cancelButton,A,microstrategy.CANCEL_BUTTON);this.setButtonDisplay(this.applyButton,A,microstrategy.APPLY_BUTTON);};mstrMsgBoxImpl.prototype.setButtonFocus=function(B){var A=null;if(B===microstrategy.CANCEL_BUTTON){A=this.cancelButton;}else{if(B===microstrategy.APPLY_BUTTON){A=this.APPLY_BUTTON;}else{if(B===microstrategy.OK_BUTTON){A=this.okButton;}}}if(A){A.className+=" hot";}};mstrMsgBoxImpl.prototype.setEval=function(A,B){if(A){A.clickFunc=null;A.setAttribute("eval","");if(typeof (B)==="function"){A.clickFunc=B;}else{A.setAttribute("eval",B);}}};mstrMsgBoxImpl.prototype.setLabel=function(B,A){if(!B){return ;}B.setAttribute("value",A||B.getAttribute("defaultValue")||String.fromCharCode(160));};mstrMsgBoxImpl.prototype.setButtons=function(B,I,C,G,F){try{if(B!=null){this.setButtonDisplays(B);}var E={Ok:I,Cancel:C,Apply:G};for(var A in E){var H=A.toLowerCase()+"Button";this.setEval(this[H],E[A]);this.setLabel(this[H],F&&F[A]);}}catch(D){microstrategy.errors.log(D);return false;}};mstrMsgBoxImpl.prototype.show=function(B,C){try{if(B!=false){this.elem.style.left="-1px";this.elem.style.top="-1px";}mstrEditorImpl.prototype.show.call(this);if(C!=null){this.showCurtain(C-1);this.elem.style.zIndex=C;}this.elem.style.visibility="visible";if(this.applyButton&&this.applyButton.style.display=="inline"){this.applyButton.focus();}else{if(this.okButton&&this.okButton.style.display=="inline"){this.okButton.focus();}else{this.cancelButton.focus();}}}catch(A){microstrategy.errors.log(A);return false;}};mstrMsgBoxImpl.prototype.hide=function(){try{if(!this.elem){return ;}this.setTitle("");this.setButtonDisplays(null);mstrEditorImpl.prototype.hide.call(this);}catch(A){microstrategy.errors.log(A);return false;}};mstrMsgBoxImpl.prototype.getInputValue=function(){try{var A=microstrategy.findChildWithAtt(this.elem,"input",microstrategy.HTMLATTR_ID,this.id+"_input");if(A){return A.value;}return null;}catch(B){microstrategy.errors.log(B);return false;}};mstrMsgBoxImpl.hideMessage=function(button,messageBoxID){try{messageBoxID=messageBoxID||"msgBox";var bone=microstrategy.bones[messageBoxID];if(bone){bone.hide();}var buttonEval=null;if(button&&button.getAttribute("eval")!=null&&typeof (button.getAttribute("eval"))!="undefined"&&button.getAttribute("eval").length>0){buttonEval=button.getAttribute("eval");}if(buttonEval){eval(buttonEval);}else{if(button&&button.clickFunc){button.clickFunc();}}}catch(err){microstrategy.errors.log(err);}};mstrMsgBoxImpl.prototype.setCssClass=function(A){try{this.elem.className="mstrMsgBox "+(A||"");}catch(B){microstrategy.errors.log(B);}};mstrMsgBoxImpl.prototype.setHelpHref=function(D,A){try{var G=microstrategy.findChildWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);var C=G.firstChild.nextSibling;var E=C.firstChild;if(!A){E.setAttribute("href",D);}else{var B=E.href.split("#");B[1]=D;E.setAttribute("href",B.join("#"));}}catch(F){microstrategy.errors.log(F);}};mstrMsgBoxImpl.prototype.setPreference=function(G){try{var H=microstrategy.findChildWithAtt(this.elem,"TD",(bIsW3C)?"class":"className","mstrDialogButtonBar"),F=microstrategy.findChildWithAtt(this.elem,"TD",(bIsW3C)?"class":"className","mstrDialogBody"),B=document.getElementById("msgPrefContainer"),C=mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID;if(G&&!B){B=document.createElement("TD");H.parentNode.insertBefore(B,H);B.setAttribute("id","msgPrefContainer");var A=document.createElement("INPUT");A.setAttribute("type","checkbox");B.appendChild(A);A.id=C;var E=document.createElement("SPAN");B.appendChild(E);E.innerHTML=microstrategy.descriptors.getDescriptor("8636");}if(B){B.style.display=G?"":"none";F.setAttribute("colSpan",G?"2":"1");document.getElementById(C).checked=false;}}catch(D){microstrategy.errors.log(D);}};function mstrMsgBoxImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}
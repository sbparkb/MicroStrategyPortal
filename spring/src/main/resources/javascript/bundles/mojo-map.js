(function(){var C="xviPopopNode";function A(G){var H={};H[C]=G;return H;}mstrmojo.ui.menus._IsMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._IsMenuPopup",{init:function E(G){this._super(G);var J=this.popupConfig;if(!J){throw new Error("Cannot instantiate popup without supplying the popupConfig property.");}this.addDisposable(J);var H=mstrmojo.all[J.hostId],I=J.hostElement;if(J.isHostedWithin&&H&&I){H.addSlots(A(I));this.slot=C;}},closeAllMenus:function F(){var G=this.opener;if(G&&G.closePopup){G.closePopup();}if(G&&G.closeAllMenus){G.closeAllMenus();}},open:function B(H,G){if(this._super){this._super(H,G);}},close:function D(G){if(this.slot===C){this.opener.removeSlots(A(null));}if(this._super){this._super(G);}this.destroy();var H=mstrmojo.all[this.popupConfig.hostId];if(H){H.closePopup();}}});}());mstrmojo.gm.GMEnums={};mstrmojo.gm.DualAxisSubAxisBit={PRIMARY:0,SECONDARY:1};mstrmojo.gm.StackExetrmeId={PRIMARY_Y_AXIS:-2,SECONDARY_Y_AXIS:-18,PRIMARY_X_AXIS:-1,SECONDARY_X_AXIS:-17};mstrmojo.gm.FormNameType={OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4};mstrmojo.gm.EnumSelectionOptionLevel={GLOBAL:1,ITSELF:2,ATTS_METRIC_COMBINATION:3,METRIC_AXIS:4,METRIC:5,AXIS:6,COLOR_BY:7,ALL_SHAPE:8,ITSELF_RESOLVED:9};mstrmojo.gm.EnumLabelRotation={VERTICAL:2,HORIZONTAL:0,AUTOMATIC:-1};mstrmojo.gm.EnumIdentityType={LEGEND:Math.pow(2,0),GRAPH_SHAPE:Math.pow(2,1),X_AXIS:Math.pow(2,2),Y_AXIS:Math.pow(2,3),X2_AXIS:Math.pow(2,4),Y2_AXIS:Math.pow(2,5),GRID_LINE:Math.pow(2,6),TREND_LINE:Math.pow(2,7),REF_LINE:Math.pow(2,8),DATA_LABEL:Math.pow(2,9),COLOR_SQUARE:Math.pow(2,10),ROW_TITLE:Math.pow(2,11),COL_TITLE:Math.pow(2,12),ROW_HEADER:Math.pow(2,13),COL_HEADER:Math.pow(2,14),LOG_SCALE:Math.pow(2,15),H_MATRIX_LINE:Math.pow(2,16),V_MATRIX_LINE:Math.pow(2,17),LEGEND_TEXT:Math.pow(2,18),SHAPE_COLLECTION:Math.pow(2,19),MINOR_GRID_LINE:Math.pow(2,20),AXIS_SCALE:Math.pow(2,22),AXIS_ORIGIN:Math.pow(2,23),ROWS_BACKGROUND:Math.pow(2,24),COLS_BACKGROUND:Math.pow(2,25),X_NUMERIC:Math.pow(2,26),X_CATEGORY:Math.pow(2,27),Y_NUMERIC:Math.pow(2,28),Y_CATEGORY:Math.pow(2,29),X_METRIC_AXIS_TITLE:Math.pow(2,30),Y_METRIC_AXIS_TITLE:Math.pow(2,31),VIZ_BOX_TITLE:Math.pow(2,32),REF_LINE_LABEL:Math.pow(2,33),LINE_MARKER:Math.pow(2,34),X_AXIS_ORIGIN_LABEL:Math.pow(2,35),Y_AXIS_ORIGIN_LABEL:Math.pow(2,36),X_AXIS_ORIGIN_LINE:Math.pow(2,37),Y_AXIS_ORIGIN_LINE:Math.pow(2,38),Y_ATTRIBUTE_AXIS_TITLE:Math.pow(2,39),ROW_HEADER_TEXT:Math.pow(2,40),ROW_TITLE_TEXT:Math.pow(2,41),COL_HEADER_TEXT:Math.pow(2,42),COL_TITLE_TEXT:Math.pow(2,43),VIZ_BOX_CONTAINER:Math.pow(2,44),X_ATTRIBUTE_AXIS_TITLE:Math.pow(2,45),AXIS_ORIGIN_DEFINE:Math.pow(2,46)};mstrmojo.gm.EnumGMZoneIds={ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10};mstrmojo.gm.EnumClickType={NONE:-1,LEFT_CLICK:1,RIGHT_CLICK:2,DOUBLE_CLICK:3};mstrmojo.gm.EnumLegendSlot={RIGHT_TOP:1,RIGHT_MIDDLE:2,RIGHT_BOTTOM:3,LEFT_TOP:4,LEFT_MIDDLE:5,LEFT_BOTTOM:6,LEFT:7,RIGHT:8};mstrmojo.gm.EnumAxisType={ATTRIBUTE:0,METRIC:1};mstrmojo.gm.EnumGraphType={UNDEFINED:-1,AREA:1,BAR:2,LINE:3,SCATTER:4,BUBBLE:5,PIE:6,GRID:7};mstrmojo.gm.EnumContextMenu={SEPARATOR:0,KEEP_ONLY:1,EXCLUDE:2,SORT_ASCENDING:3,SORT_DESCENDING:4,CLEAR_SORT:5,SHOW_DATA:6,SWITCH_THEME:7,KEEP_ONLY_AND_SHOW:8,CLOSE_LEGEND:9,OPEN_LEGEND:10,AXIS_SCALE:11,DRILL_TO:100,CHART_TYPE:200,AREA_ABS:201,AREA_STACKED:202,AREA_PERCENT:203,BAR_SBS:204,BAR_ABS:205,BAR_STACKED:206,BAR_PERCENT:207,LINE_ABS:208,LINE_STACKED:209,LINE_PERCENT:210,BUBBLE:211,SCATTER:212,H_AREA_ABS:213,H_AREA_STACKED:214,H_AREA_PERCENT:215,H_BAR_SBS:216,H_BAR_ABS:217,H_BAR_STACKED:218,H_BAR_PERCENT:219,H_LINE_ABS:220,H_LINE_STACKED:221,H_LINE_PERCENT:222,GRID:223,CIRCLE:224,SQUARE:225,PIE:226,TICKER:227,RING:228,CANVAS:229,SVG:230,LARGE_ABL:231,OUTPUT_EXTREMES:232,COMBINATION:233,ENABLE_PARTIAL_RENDERING:234,DISABLE_PARTIAL_RENDERING:235,OUTPUT_DATA_COUNT:236,ENABLE_TIMER:239,DISABLE_TIMER:240,ENABLE_CE_TIMER:241,DISABLE_CE_TIMER:242};mstrmojo.gm.EnumColorRankMode={RANK_MODE_VALUE:0,RANK_MODE_TOP:1,RANK_MODE_BOTTOM:2,RANK_MODE_TOP_PERCENT:3,RANK_MODE_BOTTOM_PERCENT:4};mstrmojo.gm.EnumColorByType={NULL:0,ATT:1,METRICS_ITEM:2,METRICS:3,ATT_METRICS:4};mstrmojo.gm.EnumDockPosition={TOP:1,RIGHT:2,BOTTOM:3,LEFT:4};mstrmojo.gm.EnumXAxisLabelStatus={NORMAL:1,STAGGER:2,ROTATE:3,HORI_DROP:4};mstrmojo.gm.EnumABLDirection={HORIZONTAL:1,VERTICAL:2};mstrmojo.gm.EnumMetricsPosition={MetricsByRow:0,MetricsByColumn:1,MetricsByAxis:2,MetricsByBreakBy:3,MetricsBySlice:4,MetricsByXAxis:5,MetricsByYAxis:6};mstrmojo.gm.EnumDrawingAPI={GET_CHART_WIDTH:0,GET_CHART_HEIGHT:1,GET_ROW_HEADER:2,GET_COLUMN_HEADER:3,CREATE_UNIT_Y_AXIS:4,CREATE_UNIT_X_AXIS:5,GET_FULL_FLEDGED_CHART:6,GET_ROW_SPAN:7,GET_COLUMN_SPAN:8,GET_METRICS_ON_X:9,GET_METRICS_ON_Y:10,GET_METRICS_ON_SIZE_BY:11,UPDATE_MINI_CHART:12,UPDATE_X_AXIS:13,UPDATE_Y_AXIS:14,MAX_RADIUS_CALC:15,GET_EXTRA_COLUMN_HEADER:16,UPDATE_COLUMN_HEADER:17,UPDATE_ROW_HEADER:18,LAYOUT_ALL_X_AXIS_LABELS:19,LAYOUT_ONE_X_AXIS_LABELS:20};mstrmojo.gm.WidgetPropertyTag={FIT_TO:"FitTo",AXIS_SCALE:"MinMax",SHAPE:"Shape",SUB_TYPE:"Subtype",DATA_LABEL:"DataLabel",DATA_LABELS_PLACEMENT:"DataLabelPalcement",METRIC_LEVEL_DATA_LABEL:"mtcLvlDataLabel",BANDING:"Banding",LEGEND_VISIBLE:"LegendVisibleness",COL_ALIGNMENT:"Columnalignment",ROW_ALIGNMENT:"Rowalignment",MAX_SIZE_TYPE:"SizeType",MAX_SIZE_VALUE:"SizeValue",MIN_SIZE_TYPE:"minSizeType",MIN_SIZE_VALUE:"minSizeValue",OUTSIDE_BORDER:"OutSideBorder",AXES:"AxisLine",MATRIX_LINES:"MatrixLine",GRID_LINES:"GridLine",SELECTION_TYPE:"SelectionType",SELECTIONS:"Selections",LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr",SCALE_CHART_HEIGHT:"rr",SCALE_CHART_WIDTH:"cr",SCALE_ROW_HEADERS:"rvr",SCALE_COL_HEADERS:"chr",SCALE_Y:"yr",SCALE_X:"xr",SCALE_Y2:"y2r",SCALE_X2:"x2r",SCALE_ALL:"scales",SCALE_V_EXTRA_LINE:"vExtraLine",SORT_ORDER:"so",SORT_INDEX:"si",AXIS_SCALE_DATA:"AxisScale",AXIS_SCALE_REAL_MIN:"rMin",AXIS_SCALE_REAL_MAX:"rMax",AXIS_SCALE_MANUAL_MIN:"mMin",AXIS_SCALE_MANUAL_MAX:"mMax",AXIS_SCALE_AUTO_MIN:"autoMin",AXIS_SCALE_AUTO_MAX:"autoMax",SINGLE_AXIS_SCALE_TYPE:"scaleType",LOG_SCALE:"logScale",GROUP_INFO:"groupInfo",METRIC_SHAPES:"metricShapes",AXIS_ORIGIN:"axisOrigin",AXIS_ORIGIN_AUTO:"axOriAuto",AXIS_ORIGIN_VALUE:"axOriValue",TREND_LINE_DEF:"trdDef",REF_LINE_DEF:"refDef",TREND_TYPE:"trdTp",TREND_LEVEL:"trdLvl",TREND_ENABLED:"trdEnabled",TREND_INCLUDE_BREAK_BY:"trdIncBB",TREND_POLY_DEGREE:"trdDgr",TREND_FORECAST_ENABLED:"trdFstEnabled",TREND_BWD_FORECAST:"trdBwdFst",TREND_FWD_FORECAST:"trdFwdFst",TREND_SEASONALITY:"trdSeason",TREND_BUBBLE_FORE_DEF:"trdBbForeDef",TREND_BUBBLE_FORE_FWD:"trdBbForeFwd",TREND_BUBBLE_FORE_BWD:"trdBbForeBwd",TREND_BUBBLE_FORE_ENABLED:"trdBbForeEnabled",TREND_BUBBLE_MAX:"trdBbMax",TREND_BUBBLE_MIN:"trdBbMin",REF_TYPE:"refTp",REF_LEVEL:"refLvl",REF_ENABLED:"refEnabled",REF_SHOW_LABEL:"refLbShw",REF_LABEL_TYPE:"refLbTp",REF_CONST_VALUE:"refCstVl",REF_LINE_NAME:"refLnName",TREND_REF_LINE_THICKNESS:"trdRefLnThk",TREND_REF_LINE_COLOR:"trdRefLnClr",TREND_REF_LINE_STYLE:"trdRefLnStyle",TREND_REF_LINE_COMBINED_STYLE:"trdRefLnCmbStyle",FORMATS_ON_COMBINATION:"fmtOnComb",PARTIAL_RENDER:"prtRdn"};mstrmojo.gm.FormatingPropertyTag={IS_DEFAULT_VALUE:"_default",MODIFIED_DEF_FILL_COLOR:"modDefFillClr",ALL_SHAPE_FORMAT:"allShpFmt",SHAPE_LINE_THICKNESS:"shpLnThk",SHAPE_LINE_COLOR:"shpLnClr",SHAPE_LINE_STYLE:"shpLnStyle",SHAPE_LINE_COMBINED_STYLE:"shpLnCmbStyle",SHAPE_FILL_COLOR:"shpFillClr",SHAPE_FILL_COLOR_DEFAULT:"shpFillClr_default",SHAPE_FILL_STYLE:"shpFillStyle",SHAPE_FILL_TRANSPARENCY:"shpFillTrans",SHAPE_FILL_EFFECT:"shpFillEff",SHAPE_BORDER_COLOR:"shpBdrClr",SHAPE_BORDER_STYLE:"shpBdrStyle",SHAPE_BORDER_COMBINED_STYLE:"shpBdrCmbStyle",SHAPE_BORDER_THICKNESS:"shpBdrThk",LINE_MARKER_SHOW:"lnMkShw",LINE_MARKER_SHAPE:"lnMkShp",LINE_MARKER_SIZE:"lnMkSz",LINE_MARKER_COLOR:"lnMkClr",LINE_MARKER_COLOR_EQUAL:"lnMkClrEq",LINE_MARKER_BORDER_COLOR:"lnMkBdrClr",PIE_EXPLODE:"pieExpl",DATA_LABELS_SHOW:"dlShw",DATA_LABELS_FONT_FAMILY:"dlFntFml",DATA_LABELS_FONT_SIZE:"dlFntSz",DATA_LABELS_FONT_STYLE:"dlFntStyle",DATA_LABELS_FONT_COLOR:"dlFntClr",REF_LABELS_FONT_FAMILY:"rfLnFntFml",REF_LABELS_FONT_SIZE:"rfLnFntSz",REF_LABELS_FONT_STYLE:"rfLnFntStyle",REF_LABELS_FONT_COLOR:"rfLnFntClr",LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",ALL_LINE_SHOW:"allLnShw",ALL_LINE_COLOR:"allLnClr",ALL_LINE_STYLE:"allLnStyle",ALL_LINE_COMBINED_STYLE:"allLnCmbStyle",ALL_LINE_THICKNESS:"allLnThk",ALL_AXIS_ORIGIN_LINE_SHOW:"axOriLnShw",ALL_AXIS_ORIGIN_LINE_COLOR:"axOriLnClr",ALL_AXIS_ORIGIN_LINE_COMBINED_STYLE:"axOriLnCmbStyle",X_AXIS_ORIGIN_LINE_SHOW:"xAxOriLnShw",X_AXIS_ORIGIN_LINE_COLOR:"xAxOriLnClr",X_AXIS_ORIGIN_LINE_STYLE:"xAxOriLnStyle",X_AXIS_ORIGIN_LINE_COMBINED_STYLE:"xAxOriLnCmbStyle",X_AXIS_ORIGIN_LINE_THICKNESS:"xAxOriLnThk",Y_AXIS_ORIGIN_LINE_SHOW:"yAxOriLnShw",Y_AXIS_ORIGIN_LINE_COLOR:"yAxOriLnClr",Y_AXIS_ORIGIN_LINE_STYLE:"yAxOriLnStyle",Y_AXIS_ORIGIN_LINE_COMBINED_STYLE:"yAxOriLnCmbStyle",Y_AXIS_ORIGIN_LINE_THICKNESS:"yAxOriLnThk",ALL_AXIS_LINE_SHOW:"allAxLnShw",ALL_AXIS_LINE_COLOR:"allAxLnClr",ALL_AXIS_LINE_STYLE:"allAxLnStyle",ALL_AXIS_LINE_COMBINED_STYLE:"allAxLnCmbStyle",ALL_AXIS_LINE_THICKNESS:"allAxLnThk",ALL_AXIS_TITLE_SHOW:"allAxTtShw",ALL_AXIS_TITLE_CONTENT:"allAxTtCtt",ALL_AXIS_TITLE_FONT_COLOR:"allAxTtFntClr",ALL_AXIS_TITLE_FONT_FAMILY:"allAxTtFntFml",ALL_AXIS_TITLE_FONT_STYLE:"allAxTtFntStyle",ALL_AXIS_TITLE_FONT_SIZE:"allAxTtFntSz",ALL_AXIS_LABELS_FONT_SIZE:"allAxLbFntSz",ALL_AXIS_LABELS_FONT_FAMILY:"allAxLbFntFml",ALL_AXIS_LABELS_FONT_STYLE:"allAxLbFntStyle",ALL_AXIS_LABELS_FONT_COLOR:"allAxLbFntClr",ALL_AXIS_LABELS_ROTATION:"allAxLbRtt",ALL_AXIS_LABELS_SHOW:"allAxLbShw",X_AXIS_LINE_SHOW:"xAxLnShw",X_AXIS_LINE_COLOR:"xAxLnClr",X_AXIS_LINE_STYLE:"xAxLnStyle",X_AXIS_LINE_COMBINED_STYLE:"xAxLnCmbStyle",X_AXIS_LINE_THICKNESS:"xAxLnThk",X_AXIS_TITLE_SHOW:"xAxTtShw",X_AXIS_TITLE_CONTENT:"xAxTtCtt",X_AXIS_TITLE_FONT_COLOR:"xAxTtFntClr",X_AXIS_TITLE_FONT_FAMILY:"xAxTtFntFml",X_AXIS_TITLE_FONT_STYLE:"xAxTtFntStyle",X_AXIS_TITLE_FONT_SIZE:"xAxTtFntSz",X_AXIS_LABELS_FONT_SIZE:"xAxLbFntSz",X_AXIS_LABELS_FONT_FAMILY:"xAxLbFntFml",X_AXIS_LABELS_FONT_STYLE:"xAxLbFntStyle",X_AXIS_LABELS_FONT_COLOR:"xAxLbFntClr",X_AXIS_LABELS_ROTATION:"xAxLbRtt",X_AXIS_LABELS_SHOW:"xAxLbShw",Y_AXIS_LINE_SHOW:"yAxLnShw",Y_AXIS_LINE_COLOR:"yAxLnClr",Y_AXIS_LINE_STYLE:"yAxLnStyle",Y_AXIS_LINE_COMBINED_STYLE:"yAxLnCmbStyle",Y_AXIS_LINE_THICKNESS:"yAxLnThk",Y_AXIS_TITLE_SHOW:"yAxTtShw",Y_AXIS_TITLE_CONTENT:"yAxTtCtt",Y_AXIS_TITLE_FONT_COLOR:"yAxTtFntClr",Y_AXIS_TITLE_FONT_FAMILY:"yAxTtFntFml",Y_AXIS_TITLE_FONT_STYLE:"yAxTtFntStyle",Y_AXIS_TITLE_FONT_SIZE:"yAxTtFntSz",Y_AXIS_LABELS_FONT_SIZE:"yAxLbFntSz",Y_AXIS_LABELS_FONT_FAMILY:"yAxLbFntFml",Y_AXIS_LABELS_FONT_STYLE:"yAxLbFntStyle",Y_AXIS_LABELS_FONT_COLOR:"yAxLbFntClr",Y_AXIS_LABELS_ROTATION:"yAxLbRtt",Y_AXIS_LABELS_SHOW:"yAxLbShw",ALL_FILL_COLOR:"allFillClr",ALL_FILL_TRANSPARENCY:"allFillTrans",BG_COLOR:"bgFillClr",BG_FILL_EFFECT:"bgFillEff",BG_FILL_STYLE:"bgFillStyle",BG_FILL_TRANSPARENCY:"bgFillTrans",ROW_HEADER_FILL_COLOR:"rwHdrFillClr",ROW_HEADER_FILL_EFFECT:"rwHdrFillEff",ROW_HEADER_FILL_STYLE:"rwHdrFillStyle",ROW_HEADER_FILL_TRANSPARENCY:"rwHdrFillTrans",COLUMN_HEADER_FILL_COLOR:"colHdrFillClr",COLUMN_HEADER_FILL_EFFECT:"colHdrFillEff",COLUMN_HEADER_FILL_STYLE:"colHdrFillStyle",COLUMN_HEADER_FILL_TRANSPARENCY:"colHdrFillTrans",ALL_MATRIX_LINES_SHOW:"allMatrixLnShw",ALL_MATRIX_LINES_COLOR:"allMatrixLnClr",ALL_MATRIX_LINES_THICKNESS:"allMatrixLnThk",ALL_MATRIX_LINES_STYLE:"allMatrixLnStyle",ALL_MATRIX_LINES_COMBINED_STYLE:"allMatrixLnCmbStyle",V_MATRIX_LINES_SHOW:"vMatrixLnShw",V_MATRIX_LINES_COLOR:"vMatrixLnClr",V_MATRIX_LINES_THICKNESS:"vMatrixLnThk",V_MATRIX_LINES_STYLE:"vMatrixLnStyle",V_MATRIX_LINES_COMBINED_STYLE:"vMatrixLnCmbStyle",H_MATRIX_LINES_SHOW:"hMatrixLnShw",H_MATRIX_LINES_COLOR:"hMatrixLnClr",H_MATRIX_LINES_THICKNESS:"hMatrixLnThk",H_MATRIX_LINES_STYLE:"hMatrixLnStyle",H_MATRIX_LINES_COMBINED_STYLE:"hMatrixLnCmbStyle",OUTSIDE_BORDER_SHOW:"outBdrShw",OUTSIDE_BORDER_COLOR:"outBdrClr",OUTSIDE_BORDER_STYLE:"outBdrStyle",OUTSIDE_BORDER_THICKNESS:"outBdrThk",OUTSIDE_BORDER_COMBINED_STYLE:"outBdrCmbStyle",GRID_LINE_AUTO:"gridLineAuto",ALL_GRID_LINES_SHOW:"allGridLnShw",ALL_GRID_LINES_COLOR:"allGridLnClr",ALL_GRID_LINES_THICKNESS:"allGridLnThk",ALL_GRID_LINES_STYLE:"allGridLnStyle",ALL_GRID_LINES_COMBINED_STYLE:"allGridLnCmbStyle",AUTO_GRID_LINES_COLOR:"autoGridLnClr",AUTO_GRID_LINES_COMBINED_STYLE:"autoGridLnCmbStyle",MAJOR_GRID_LINES_SHOW:"majorGridLnShw",MAJOR_GRID_LINES_COLOR:"majorGridLnClr",MAJOR_GRID_LINES_THICKNESS:"majorGridLnThk",MAJOR_GRID_LINES_STYLE:"majorGridLnStyle",MAJOR_GRID_LINES_COMBINED_STYLE:"majorGridLnCmbStyle",MINOR_GRID_LINES_SHOW:"minerGridLnShw",MINER_GRID_LINES_COLOR:"minerGridLnClr",MINER_GRID_LINES_THICKNESS:"minerGridLnThk",MINER_GRID_LINES_STYLE:"minerGridLnStyle",MINER_GRID_LINES_COMBINED_STYLE:"minerGridLnCmbStyle",ALL_ROW_COLUMN_SHOW:"allRwColShw",COLUMN_TEXT_SHOW:"colTxtShw",ROW_TEXT_SHOW:"rwTxtShw",COLUMN_HEADER_SHOW:"colHdrShw",ROW_HEADER_SHOW:"rwHdrShw",COLUMN_VALUES_SHOW:"colVlShw",ROW_VALUES_SHOW:"rwVlShw",ALL_TEXT_FONT_COLOR:"allTxtFntClr",ALL_TEXT_FONT_SIZE:"allTxtFntSz",ALL_TEXT_FONT_FAMILY:"allTxtFntFml",ALL_TEXT_FONT_STYLE:"allTxtFntStyle",ALL_ROW_COLUMN_TEXT_FONT_COLOR:"allRwColTxtFntClr",ALL_ROW_COLUMN_TEXT_FONT_SIZE:"allRwColTxtFntSz",ALL_ROW_COLUMN_TEXT_FONT_FAMILY:"allRwColTxtFntFml",ALL_ROW_COLUMN_TEXT_FONT_STYLE:"allRwColTxtFntStyle",ALL_ROW_COLUMN_TEXT_ALIGNMENT_HORIZONTAL:"allRwColTxtAlignH",ALL_ROW_COLUMN_TEXT_ALIGNMENT_VERTICAL:"allRwColTxtAlignV",ROW_TEXT_TEXT_FONT_COLOR:"rwTxtTxtFntClr",ROW_TEXT_TEXT_FONT_SIZE:"rwTxtTxtFntSz",ROW_TEXT_TEXT_FONT_FAMILY:"rwTxtTxtFntFml",ROW_TEXT_TEXT_FONT_STYLE:"rwTxtTxtFntStyle",ROW_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"rwTxtTxtAlignH",ROW_TEXT_TEXT_ALIGNMENT_VERTICAL:"rwTxtTxtAlignV",COLUMN_TEXT_TEXT_FONT_COLOR:"colTxtTxtFntClr",COLUMN_TEXT_TEXT_FONT_SIZE:"colTxtTxtFntSz",COLUMN_TEXT_TEXT_FONT_FAMILY:"colTxtTxtFntFml",COLUMN_TEXT_TEXT_FONT_STYLE:"colTxtTxtFntStyle",COLUMN_TEXT_TEXT_ALIGNMENT_HORIZONTAL:"colTxtTxtAlignH",COLUMN_TEXT_TEXT_ALIGNMENT_VERTICAL:"colTxtTxtAlignV",ROW_HEADER_TEXT_FONT_COLOR:"rwHdrTxtFntClr",ROW_HEADER_TEXT_FONT_SIZE:"rwHdrTxtFntSz",ROW_HEADER_TEXT_FONT_FAMILY:"rwHdrTxtFntFml",ROW_HEADER_TEXT_FONT_STYLE:"rwHdrTxtFntStyle",ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"rwHdrTxtAlignH",ROW_HEADER_TEXT_ALIGNMENT_VERTICAL:"rwHdrTxtAlignV",COLUMN_HEADER_TEXT_FONT_COLOR:"colHdrTxtFntClr",COLUMN_HEADER_TEXT_FONT_SIZE:"colHdrTxtFntSz",COLUMN_HEADER_TEXT_FONT_FAMILY:"colHdrTxtFntFml",COLUMN_HEADER_TEXT_FONT_STYLE:"colHdrTxtFntStyle",COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL:"colHdrTxtAlignH",COLUMN_HEADER_TEXT_ALIGNMENT_VERTICAL:"colHdrTxtAlignV",ROW_VAVLUE_TEXT_FONT_COLOR:"rwVlTxtFntClr",ROW_VAVLUE_TEXT_FONT_SIZE:"rwVlTxtFntSz",ROW_VAVLUE_TEXT_FONT_FAMILY:"rwVlTxtFntFml",ROW_VAVLUE_TEXT_FONT_STYLE:"rwVlTxtFntStyle",ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"rwVlTxtAlignH",ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"rwVlTxtAlignV",COLUMN_VAVLUE_TEXT_FONT_COLOR:"colVlTxtFntClr",COLUMN_VAVLUE_TEXT_FONT_SIZE:"colVlTxtFntSz",COLUMN_VAVLUE_TEXT_FONT_FAMILY:"colVlTxtFntFml",COLUMN_VAVLUE_TEXT_FONT_STYLE:"colVlTxtFntStyle",COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL:"colVlTxtAlignH",COLUMN_VAVLUE_TEXT_ALIGNMENT_VERTICAL:"colVlTxtAlignV",TITLE_FONT_COLOR:"ttlFntClr",TITLE_FONT_SIZE:"ttlFntSz",TITLE_FONT_FAMILY:"ttlFntFml",TITLE_FONT_STYLE:"ttlFntStyle",COLOR_SQUARE_COLOR:"clrSqrClr"};mstrmojo.gm.EnumAxis={DssAxisReserved:0,DssAxisRows:1,DssAxisColumns:2,DssAxisPages:3,DssAxisChapters:4,DssAxisAll:5};mstrmojo.gm.EnumCombinedLineStyle={NONE:99,THIN:1,THICK:2,DASHED:3,DOTTED:4};mstrmojo.gm.EnumSizeByType={SQUARE:1,CIRCLE:4};mstrmojo.gm.EnumTheme={DARK:0,LIGHT:1};mstrmojo.gm.EnumFitTo={CONTENT:1,PANEL:2,COMPACT:3};mstrmojo.gm.EnumAxisScale={GLOBAL:0,PERROWCOL:1,PERCELL:2,CUSTOM:3,DIFFERENT:4};mstrmojo.gm.EnumShape={GENERIC:-1,AREA:0,BAR:1,LINE:2,STEPLINE:3,CIRCLE:4,RECTANGLE:5,SQUARE:6,TICK:7,PIESLICE:8,POLYGON:9,PIE:10,RING:11,DEFAULT:12,BULLET:13};mstrmojo.gm.EnumSubtype={AUTO:1,ABSOLUTE:2,STACKED:3,CLUSTERED:4,PERCENT:5};mstrmojo.gm.EnumDataLabels={HIDE:1,SHOW_VALUE_ONLY:2,SHOW_TEXT_ONLY:3};mstrmojo.gm.EnumDataLabelPlacements={AUTOMATIC:1,GENERIC:2,RESERVED:3};mstrmojo.gm.EnumLegend={SHOW:0,HIDE:1,MINIMIZED:2};mstrmojo.gm.EnumLegendMode={RESTORED:1,MINIMIZED:2};mstrmojo.gm.EnumTextAlignH={LEFT:0,MIDDLE:1,RIGHT:2};mstrmojo.gm.EnumTextAlignV={TOP:0,MIDDLE:1,BOTTOM:2};mstrmojo.gm.EnumMaxSizeType={AUTO:1,MANUAL:2,AUTO_FIT:3};mstrmojo.gm.EnumMinSizeType={AUTO:1,MANUAL:2,PROPORTIONAL:3};mstrmojo.gm.EnumAxes={SHOW_BOTH:1,SHOW_NONE:2,SHOW_X:3,SHOW_Y:4};mstrmojo.gm.EnumMatrixLines={SHOW_ALL:1,SHOW_NONE:2,SHOW_HORIZONTAL:3,SHOW_VERTICAL:4};mstrmojo.gm.EnumGridLines={AUTO:1,SHOW:2,HIDE:3,SHOW_MAJOR_ONLY:4};mstrmojo.gm.LineMarkerShape={Circle:4,Square:1};mstrmojo.gm.ShapeFillType={Solid:0,Gradient:14,Pattern:3};mstrmojo.gm.ShapeFillEffect={None:1,Bevel:2};mstrmojo.gm.Enum3DGMapping={SizeType:"9999_1002",SizeValue:"9999_1003",lgdBgFillClr:"6_564",lgdBgFillStyle:"6_10002",lgdBgFillEff:"6_608",lgdFntSz:"9_603",lgdFntFml:"9_576",lgdFntStyle:"9_584",lgdFntClr:"9_574",LegendVisibleness:"9999_116",xAxShw:"9999_124",xAxTtCtt:"293_9999",xAxTtFntClr:"293_574",xAxTtFntFml:"293_576",xAxTtFntStyle:"293_584",xAxLbFntSz:"272_603",xAxLbFntFml:"272_576",xAxLbFntStyle:"272_584",yAxShw:"9999_125",yAxTtCtt:"299_9999",yAxTtFntClr:"299_574",yAxTtFntFml:"299_576",yAxTtFntStyle:"299_584",yAxLbFntSz:"296_603",yAxLbFntFml:"296_576",yAxLbFntStyle:"296_584",bgFillClr:"1_564",bgFillEff:"1_879",bgFillTrans:"1_608",outBdrClr:"1_588"};mstrmojo.gm.EnumRefLineModelType={MAX:1,MIN:2,AVG:3,MED:4,FIRST:5,LAST:6,CONST:7};mstrmojo.gm.EnumTrendLineModelType={BEST_FIT:256,LINEAR:257,LOG:258,EXP:259,POW:260,POLY:261};mstrmojo.gm.EnumTrendRefLevel={DssModelLevelReserved:0,DssModelLevelPerCell:1,DssModelLevelPerRow:2,DssModelLevelPerColumn:3,DssModelLevelPerPanel:4,DssModelLevelLastOne:5};mstrmojo.gm.EnumTimeRole={None:0,YearOfDecade:3083,QuarterOfYear:2826,MonthOfYear:2825,MonthOfQuarter:2569,WeekOfYear:2824,WeekOfQuarter:2568,WeekOfMonth:2312,DayOfYear:2823,DayOfQuarter:2567,DayOfMonth:2311,DayOfWeek:2055,HourOfDay:1798,MinuteOfDay:1797,MinuteOfHour:1541,SecondOfDay:1796,SecondOfHour:1540,SecondOfMinute:1284};mstrmojo.gm.EnumTrendRefModelLabels={DssModelLabelsReserved:-1,DssModelLabelsNone:0,DssModelLabelsType:1,DssModelLabelsMetric:2,DssModelLabelsValue:4};mstrmojo.gm.EnumTRFManipulations={AddTRLine:"141",RemoveTRLine:"142",UpdateTRLine:"143",UpdateForecastInfo:"144"};mstrmojo.gm.EnumShapeFormatStatus={NORMAL:0,PER_COLORBY:1,PER_SHAPE:2};(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());(function(){mstrmojo.requiresDescs(5774,2266,2287,2496,2495,2493,2267,2498,2500,2279,2491,2476,2271,2478,2268,2492,2273,2280,2490,2488,2494,2487,2269,2477,2499,2292,2489,2281,2484,2483,2480,2497,2274,2485,2486,2282,2481,2479,2482,2290,2293);var A=[{n:mstrmojo.desc(5774,"No Fill"),id:"transparent"},{n:mstrmojo.desc(2266,"Black"),id:"#000000"},{n:mstrmojo.desc(2287,"Brown"),id:"#993300"},{n:mstrmojo.desc(2496,"Olive Green"),id:"#333300"},{n:mstrmojo.desc(2495,"Dark Green"),id:"#003300"},{n:mstrmojo.desc(2493,"Dark Teal"),id:"#003366"},{n:mstrmojo.desc(2267,"Dark Blue"),id:"#000080"},{n:mstrmojo.desc(2498,"Indigo"),id:"#333399"},{n:mstrmojo.desc(2500,"Grey-80%"),id:"#333333"},{n:mstrmojo.desc(2279,"Dark Red"),id:"#800000"},{n:mstrmojo.desc(2491,"Orange"),id:"#ff6600"},{n:mstrmojo.desc(2476,"Dark Yellow"),id:"#808000"},{n:mstrmojo.desc(2271,"Green"),id:"#008000"},{n:mstrmojo.desc(2478,"Teal"),id:"#008080"},{n:mstrmojo.desc(2268,"Blue"),id:"#0000ff"},{n:mstrmojo.desc(2492,"Blue-Grey"),id:"#666699"},{n:mstrmojo.desc(2273,"Grey-50%"),id:"#808080"},{n:mstrmojo.desc(2280,"Red"),id:"#ff0000"},{n:mstrmojo.desc(2490,"Light Orange"),id:"#ff9900"},{n:mstrmojo.desc(2488,"Lime"),id:"#99cc00"},{n:mstrmojo.desc(2494,"Sea Green"),id:"#339966"},{n:mstrmojo.desc(2487,"Aqua"),id:"#33cccc"},{n:mstrmojo.desc(2269,"Light Blue"),id:"#3366ff"},{n:mstrmojo.desc(2477,"Violet"),id:"#800080"},{n:mstrmojo.desc(2499,"Grey-40%"),id:"#969696"},{n:mstrmojo.desc(2292,"Pink"),id:"#ff00ff"},{n:mstrmojo.desc(2489,"Gold"),id:"#ffcc00"},{n:mstrmojo.desc(2281,"Yellow"),id:"#ffff00"},{n:mstrmojo.desc(2484,"Bright Green"),id:"#00ff00"},{n:mstrmojo.desc(2483,"Turquoise"),id:"#00ffff"},{n:mstrmojo.desc(2480,"Sky Blue"),id:"#00ccff"},{n:mstrmojo.desc(2497,"Plum"),id:"#993366"},{n:mstrmojo.desc(2274,"Grey-25%"),id:"#c0c0c0"},{n:mstrmojo.desc(2485,"Rose"),id:"#ff99cc"},{n:mstrmojo.desc(2486,"Tan"),id:"#ffcc99"},{n:mstrmojo.desc(2282,"Light Yellow"),id:"#ffff99"},{n:mstrmojo.desc(2481,"Light Green"),id:"#ccffcc"},{n:mstrmojo.desc(2479,"Light Turquoise"),id:"#ccffff"},{n:mstrmojo.desc(2482,"Pale Blue"),id:"#99ccff"},{n:mstrmojo.desc(2290,"Lavender"),id:"#cc99ff"},{n:mstrmojo.desc(2293,"White"),id:"#ffffff"}];var E=[];mstrmojo.util.ui.ColorPicker={getBasicColors:function B(){return A.slice();},getCustomColors:function D(){return E.slice();},addCustomColor:function C(G){var F=function(H){return H.id===G;};if(!A.filter(F)[0]&&!E.filter(F)[0]){E.push({n:G,id:G});if(E.length>8){E.shift();}}}};}());(function(){function B(L,Q,N){var M,O;M=0;if(N){M=Math.max(L,L-Q);M=Math.max(M,-Q);}else{M=L-Q;}if(M===0){this.mIsShown=false;return 1;}var P=M;O=1;while(M<1){M*=10;O/=10;}while(M>=10){M/=10;O*=10;}if(M<1.8){O*=2;O/=10;}else{if(M<3.1){O*=4;O/=10;}else{if(M<4.6){O*=5;O/=10;}else{if(M>=8.1){O*=2;}}}}return O;}function K(P){var L,N;this.mStep=B.call(this,this.mMaximum,this.mMinimum,P.mAlwaysIncludeZero);this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:this.mMinTick;if(P.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}var M=this.mMaxTick-this.mMinTick;if(this.mStep>=M){return ;}L=Math.floor((this.mMaxTick-this.mMinTick+this.mStep/100)/this.mStep)+1;for(N=1;N<L-1;++N){var O=this.mMinTick+N*this.mStep;this.mTicks.push(O);}}function C(M){var L;this.mMaxTick=1;this.mStep=this.mMinimum<0?0.2:0.1;if(M.mUseCustomMinMax){this.mMaxTick=M.mAxisMaxValue;this.mMinTick=M.mAxisMinValue;this.mMaxTick=Math.min(1,this.mMaxTick);this.mMinTick=Math.max(-1,this.mMinTick);this.mStep=0.1;}else{if(this.mMaximum>=0.5){this.mMaxTick=1;this.mMinTick=Math.floor(this.mMinimum/this.mStep)*this.mStep;this.mMinTick=(this.mMinTick*this.mMinimum<0)?0:(this.mMinTick>0?0:this.mMinTick);if(this.mMinimum<-0.5){this.mMinTick=-1;}}else{if(this.mMaximum>0){this.mMaxTick=Math.ceil(this.mMaximum/this.mStep)*this.mStep;this.mMinTick=-1;}else{this.mStep=0.1;this.mMaxTick=0;this.mMinTick=-1;}}}for(L=this.mMinTick+this.mStep;L+0.01<this.mMaxTick;L+=this.mStep){this.mTicks.push(Math.round(L*100)/100);}}function I(L){return Math.log(L)/Math.log(10);}function H(O){var N,L,M;this.mStep=1;if(this.mMaximum<=0){this.mMinTick=1;this.mMaxTick=10;return ;}if(this.mMinimum<=0){L=this.mMaximum>1?0:-1;this.mMinTick=Math.pow(10,L);if(O.mUseCustomMinMax){this.mMaxTick=this.mMaximum;N=Math.floor(I.call(this,this.mMaximum));if(I.call(this,this.mMaximum)===N){N--;}}else{N=Math.ceil(I.call(this,this.mMaximum));this.mMaxTick=Math.pow(10,N);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}return ;}if(O.mUseCustomMinMax){N=I.call(this,this.mMaximum);L=I.call(this,this.mMinimum);this.mMaxTick=this.mMaximum;this.mMinTick=this.mMinimum;}else{N=Math.ceil(I.call(this,this.mMaximum));L=Math.floor(I.call(this,this.mMinimum));this.mMaxTick=Math.pow(10,N);this.mMinTick=Math.pow(10,L);}for(M=L+1;M<N;++M){this.mTicks.push(Math.pow(10,Math.floor(M)));}}function J(L){this.mTicks.splice(0,this.mTicks.length);if(this.mIsPercent){return C.call(this,L);}if(L.mUseLogarithmicScale){return H.call(this,L);}K.call(this,L);}function G(Q){if(Q.mUseCustomMinMax||Q.mUseLogarithmicScale){return ;}var M=0.1,O=false,L=false,P=[];this.GetTicks(P);if(P.length>=2){var N=P.length;L=((Math.abs(this.mMaximum-P[N-2])<M*this.mStep));O=((Math.abs(this.mMinimum-P[1])<M*this.mStep));if(this.mIsPercent){L=false;}}if(L&&O){this.mMinTick=this.mMinimum;this.mMaxTick=this.mMaximum;Q.mUseMinValue=Q.mShowMinLabel=true;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(L){this.mMaxTick=this.mMaximum;Q.mUseMaxValue=Q.mShowMaxLabel=true;}else{if(O){this.mMinTick=this.mMinimum;Q.mUseMinValue=Q.mShowMinLabel=true;}else{}}}if(Q.mAlwaysIncludeZero){this.mMaxTick=(this.mMaximum<0)?0:this.mMaxTick;this.mMinTick=(this.mMinimum>0)?0:this.mMinTick;}}mstrmojo.chart.common.ScalePlate=mstrmojo.provide("mstrmojo.chart.common.ScalePlate",{mOptions:{mShowMinLabel:true,mShowMaxLabel:true},isStackedChart:false,mStep:0,mIsPercent:false,mMinimum:0,mMaximum:0,mMaxTick:0,mMinTick:0,mTicks:[],clear:function F(){this.isStackedChart=this.mIsPercent=false;this.mMinimum=this.mMaximum=0;this.mMinTick=this.mMaxTick=0;this.mStep=0;this.mTicks=[];},GetTicks:function A(M){if(this.mOptions.mShowMinLabel){M.push(this.mMinTick);}var L;for(L=0;L<this.mTicks.length;++L){M.push(this.mTicks[L]);}if(this.mOptions.mShowMaxLabel){M.push(this.mMaxTick);}},getMaxMinTickValue:function D(O,N,L,M){this.computeTicks(O,N,L,M);return{Max:this.mMaxTick,Min:this.mMinTick};},computeTicks:function E(Q,P,L,N){this.mMinimum=N;this.mMaximum=L;this.mIsPercent=!!(P&1);this.isStackedChart=!!(P&2);var O=1e-14;if(!Q.mUseLogarithmicScale&&this.isStackedChart){this.mMinimum=Math.min(this.mMinimum,0);this.mMaximum=Math.max(this.mMaximum,0);}if(Q.mDrawCustomLine){this.mMinimum=Math.min(this.mMinimum,Q.mAxisCustomValue);this.mMaximum=Math.max(this.mMaximum,Q.mAxisCustomValue);}if(this.mIsPercent&&this.mMinimum===this.mMaximum&&1===this.mMaximum){if(this.mMinimum===1){this.mMinimum=0;}}if(Math.abs(this.mMinimum-this.mMaximum)<O){if(this.mMinimum<-O||this.mMinimum>O){var M=Math.abs(this.mMinimum)*0.5;this.mMaximum=this.mMaximum+M;this.mMinimum=this.mMinimum-M;}else{this.mMinimum=-6;this.mMaximum=6;}}J.call(this,Q);if(Q.mUseLogarithmicScale&&this.isStackedChart){this.mMaximum=Q.mDrawCustomLine?Math.max(this.mMaximum+this.mMinTick,Q.mAxisCustomValue):this.mMaximum+this.mMinTick;this.mMinimum=Math.min(this.mMinimum,0);this.mTicks.splice(0,this.mTicks.length);H.call(this,Q);}G.call(this,Q);}});}());(function(){function Q(U,R,S){if(U.nodeType===3&&R){return U;}else{var T=(R&&U.nodeType===1&&U.lastChild)?U.lastChild:F(U,S);return T?D(T,S):null;}}function F(S,R){return(S===R)?null:(S.previousSibling||F(S.parentNode,R));}function D(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.lastChild){return D(S.lastChild);}else{return D(F(S,R));}}}function I(R){return R.textContent||R.nodeValue||R.innerText;}function M(U,R,S){if(U.nodeType===3&&R){return U;}else{var T=(R&&U.nodeType===1&&U.firstChild)?U.firstChild:B(U,S);return T?E(T,S):null;}}function B(S,R){return(S===R)?null:(S.nextSibling||B(S.parentNode,R));}function E(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.firstChild){return E(S.firstChild);}else{return E(B(S,R));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function P(T,U){var R=0,S;if(T.nodeType===1){if(window.getSelection){S=document.createRange();S.selectNode(T);R=S.toString().length;}else{S=document.body.createTextRange();S.moveToElementText(T);R=S.text.length;}}else{R=I(T).length;}return U===R?this.EDGE.EDGE_END:(U===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function K(U,S){if(!U.offsetParent){return ;}var T=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(U);R.collapse(S);T.removeAllRanges();T.addRange(R);}else{R.moveToElementText(U);R.collapse(S);R.select();}},collapseOnTextNode:function L(U,V){var T=this.getSelection(),S=this.getRange();if(window.getSelection){var R=M(U,true);S.setStart(R,V);S.collapse(true);T.removeAllRanges();T.addRange(S);}else{S.moveToElementText(U);S.collapse(true);S.move("character",V);S.select();}},collapseOnTextNodeIE:function C(S,T){var U=M(S,true),R;while(U!==null){R=I(U).length;if(R>=T){this.collapseOnTextNode(U,T);break;}else{T-=R;U=M(U,false);}}},getRangeInfo:function J(X,e){var Z=null,l,c=this.getRange(),b;if(X&&X===c.startContainer){var g=c.startContainer.firstChild,U=g&&g.firstChild,d=U&&U.firstChild;if(d){c.setStart(d,c.startOffset);c.setEnd(d,c.endOffset);}}if(window.getSelection){var W=function(n,p,o){var m=n.cloneRange();m.collapse(o);m.setStartBefore(p);return m.toString().length;},S=c.startContainer,f=c.startOffset;if(S.nodeType===1){f=W(c,S,true);}Z={collapsed:c.collapsed,startContainer:S,startOffset:e?e.startOffset:f};if(!c.collapsed){var V=c.endContainer,R=c.endOffset;if(V.nodeType===1){R=W(c,V,false);}Z.endContainer=V;Z.endOffset=R;}Z.range=c;}else{var k,a,Y=function(p,q){var o=p.duplicate(),m=document.body.createTextRange(),n;o.collapse(q);n=o.parentElement();m.moveToElementText(n);m.setEndPoint("EndToStart",o);return{container:n,offset:m.text.length};},h=Y(c,true),T;Z={collapsed:(c.compareEndPoints("StartToEnd",c)===0),startContainer:h.container,startOffset:h.offset};if(!Z.collapsed){T=Y(c,false);Z.endContainer=T.container;Z.endOffset=T.offset;}}return Z;},collapse:function O(S){if(window.getSelection){var T=this.getSelection();if(S){T.collapseToStart();}else{T.collapseToEnd();}}else{var R=this.getRange();R.collapse(S);R.select();}},selectSingleNode:function H(T){var S=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(T);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(T);R.select();}},selectMultipleNodes:function N(W,S,X,U){var V=this.getSelection(),T=this.getRange();if(window.getSelection){T.setStart(W,S);T.setEnd(X,U);V.removeAllRanges();V.addRange(T);}else{W=(W.nodeType===3)?W.parentNode:W;T.moveToElementText(W);T.move("character",S);X=(X.nodeType===3)?X.parentNode:X;var R=document.body.createTextRange();R.moveToElementText(X);R.move("character",U);T.setEndPoint("EndToStart",R);T.select();}},getSelection:function G(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});}());(function(){mstrmojo.boxmodel=mstrmojo.provide("mstrmojo.boxmodel",{rangeIntersect:function E(J,H,I,G){if(J<I){return I<=H;}if(J>I){return J<=G;}return true;},px2Inches:function C(H,G){G=parseInt(G,10);return mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep).format(parseFloat((G/H.zf/H.dpi).toFixed(4)));},offset:function F(I,H){var L=I,G=0,K=0;while(I){G+=I.offsetLeft;K+=I.offsetTop;I=I.offsetParent;if(I===H){break;}}var J;for(J=L&&L.parentNode;J&&J!==H;J=J.parentNode){if(J.scrollTop){K-=J.scrollTop;}if(J.scrollLeft){G-=J.scrollLeft;}}return{left:G,top:K};},convert2px:function D(K,I){if(!/px$/.test(I)){var H=document.createElement("img"),G=H.style,J;G.zIndex=-1;G.left=I;K.appendChild(H);J=G.pixelLeft;K.removeChild(H);return J+"px";}return I;},getEdgeQuadrantByPoint:function B(I,H){var G=H.x-I.x,M=H.y-I.y,J=I.w,L=I.h,K=[["Left","Bottom"],["Top","Right"]];if(M>L/J*G){K=K[0];}else{K=K[1];}return(M<-L/J*G+L)?K[0]:K[1];},isPtInPolygon:function A(I,K){var G=I.x,J=I.y,H=false;K.forEach(function(N,L){var M=K[L-1]||K[K.length-1];if((N.y>=J)!==(M.y>=J)){if((G<(M.x-N.x)*(J-N.y)/(M.y-N.y)+N.x)){H=!H;}}});return H;}});}());(function(){var L=false;var X=null;var K=null;var D=null;var G=null;var Z=null;var O="3.21";mstrmojo._CanLoadMapExternalScript=mstrmojo.provide("mstrmojo._CanLoadMapExternalScript",{_mixinName:"mstrmojo._CanLoadMapExternalScript",callback:null,mixinParentMapObj:null,setPremiere:function P(a){L=a;},isPremiere:function C(){return L;},setPremiereKey:function A(a){X=a;},getPremiereKey:function Q(){return X;},setTrialKey:function J(a){G=a;},getTrialKey:function E(){return G;},setLocaleLang:function N(a){K=a;},getLocaleLang:function I(){return K;},setLocaleRegion:function W(a){D=a;},getLocaleRegion:function Y(){return D;},setChannel:function V(a){Z=a;},getChannel:function H(){return Z;},loadExternalScript:function M(c,d){var a,b=this.getChannel();if(window.location.protocol==="https:"){a="https://maps-api-ssl.google.com/maps/api/js?v="+O+"&libraries=drawing,geometry";}else{a="http://maps.google.com/maps/api/js?v="+O+"&libraries=drawing,geometry";}a+="&language="+this.getLocaleLang()+"&region="+this.getLocaleRegion();if(this.isPremiere()){a=a+"&client="+this.getPremiereKey();}else{a=a+"&key="+this.getTrialKey();}if(!!b){a+="&channel="+b;}this.callback=c;this.mixinParentMapObj=d;mstrmojo._LoadsScript.requiresExternalScripts([{url:a,callbackParamName:"callback",forceReload:true}],this.loadMarkerScript,this);},loadMarkerScript:function T(){mstrmojo.googleMapLibLoaded=true;mstrmojo.invalidateCls("mstrmojo.gmaps.CustomMarker");mstrmojo.invalidateCls("mstrmojo.gmaps.CircleMarker");mstrmojo.invalidateCls("mstrmojo.gmaps.TextMarker");mstrmojo.invalidateCls("mstrmojo.gmaps.DensityOverlay");mstrmojo.requiresCls("mstrmojo.gmaps.CustomMarker","mstrmojo.gmaps.TextMarker","mstrmojo.gmaps.CircleMarker","mstrmojo.gmaps.DensityOverlay");var b=this;this.loadGoogleMapVisCss();var a=window.setInterval(function(){if(b.isGoogleMapVisCssLoaded()){window.clearInterval(a);b.loadMap();}},50);},loadMap:function B(){var d,b,a=[],c,g,f,e=mstrmojo.gmaps.loadScriptListeners.length;this.callback.call(this.mixinParentMapObj);a.push({caller:this.mixinParentMapObj,method:this.callback});for(d=0;d<e;d++){g=mstrmojo.gmaps.loadScriptListeners[d];f=false;for(b=0;b<a.length;b++){c=a[b];if(g.caller===c.caller&&g.method===c.method){f=true;break;}}if(!f){g.method.call(g.caller);a.push({caller:g.caller,method:g.method});}}},isOIVM:function S(){return(mstrApp&&mstrApp.isExpress);},loadCoreCss:function F(){var d=document.styleSheets;if(d){var b,c;for(b=0;b<d.length;b++){c=d[b];if(c.id==="mojocore"){return ;}}}var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href","../javascript/mojo/css/core.css"+((window.mstrConfig&&mstrConfig.webVersion)?"?v="+mstrConfig.webVersion:""));a.setAttribute("id","mojocore");document.getElementsByTagName("head")[0].appendChild(a);},isGoogleMapVisCssLoaded:function R(){var c=document.styleSheets;if(c){var a,b;for(a=0;a<c.length;a++){b=c[a];if((b.id=="googleMapVis")||(!!b.ownerNode&&b.ownerNode.id=="googleMapVis")){return true;}}}return false;},loadGoogleMapVisCss:function U(){if(this.isGoogleMapVisCssLoaded()){return ;}var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",mstrmojo.getStyleRoot()+"/mstr/googleMap.css"+((window.mstrConfig&&mstrConfig.webVersion)?"?v="+mstrConfig.webVersion:""));a.setAttribute("id","googleMapVis");document.getElementsByTagName("head")[0].appendChild(a);}});}());mstrmojo.chart.model.enums.EnumDSSGraphProperty={DssGraphTextContent:9999,DssGraphContent:9999,DssGraphPropertyReserved:0,DssGraphAutoFitO1:4,DssGraphAutoFitO2:5,DssGraphAutoFitX:6,DssGraphAutoFitY1:7,DssGraphAutoFitY2:8,DssGraphGroupSpacing:10,DssGraphRiserWidth:11,DssGraphColorBySeries:12,DssGraphCurveColorAsSeries:13,DssGraphSDMOVAFactor:14,DssGraph2DAngle:18,DssGraph2DDepth:20,DssGraphDepthMode:21,DssGraph2ScaleDirectionX:22,DssGraph2ScaleDirectionY1:23,DssGraph2ScaleDirectionY2:24,DssGraph2ExcludeZeroX:25,DssGraph2ExcludeZeroY1:26,DssGraph2ExcludeZeroY2:27,DssGraphFormatDataTextX:28,DssGraphFormatDataTextY1:29,DssGraphFormatDataTextY2:30,DssGraphFormatX:33,DssGraphFormatY1:34,DssGraphFormatY2:35,DssGraphFormatZ:36,DssGraphGridLineO1:37,DssGraphGridLineO2:38,DssGraphGridLineX:39,DssGraphGridLineY1:40,DssGraphGridLineY2:41,DssGraphLabelModeO1:48,DssGraphLabelModeO2:49,DssGraphLegendLocation:52,DssGraphTitleXLocation:54,DssGraphTitleY1Location:55,DssGraphTitleY2Location:56,DssGraph2LogScaleX:57,DssGraph2LogScaleY1:58,DssGraph2LogScaleY2:59,DssGraphMarkerShape:60,DssGraphMarkerSize:61,DssGraph2DPlaceX:65,DssGraph2DPlaceY1:66,DssGraph2DPlaceY2:67,DssGraphConnectLine:68,DssGraphShowStepLine:70,DssGraph2ScaleEndX:74,DssGraph2ScaleEndY1:75,DssGraph2ScaleEndY2:76,DssGraph2DScaleFreqO1:87,DssGraph2DScaleFreqO2:88,DssGraph2DScaleFreqX:89,DssGraph2DScaleFreqY1:90,DssGraph2DScaleFreqY2:91,DssGraphScaleX:92,DssGraphScaleY1:93,DssGraphScaleY2:94,DssGraphShowSDDataLineType:96,DssGraphSDRiserType:97,DssGraphShowSDLine:98,DssGraphShowSDCurve:99,DssGraphShowSDLinrCorr:101,DssGraphShowSDLinrExp:102,DssGraphShowSDLinrFormula:103,DssGraphShowSDLinrLine:104,DssGraphShowSDLinrLog:105,DssGraphShowSDLinrNatLog:106,DssGraphShowSDLinrNPoly:107,DssGraphSDPolyFactor:108,DssGraphShowSDMeanLine:109,DssGraphShowSDMOVALine:110,DssGraphShowSDSTDDLine:111,DssGraphShowDataText:113,DssGraphShowDivBiPolar:114,DssGraphShowErrorBar:115,DssGraphShowLegendText:116,DssGraphShow2DO1Label:117,DssGraphShow2DO1:-117,DssGraphShow2DO2:118,DssGraphOffScaleTypeX:119,DssGraphOffScaleTypeY1:120,DssGraphOffScaleTypeY2:121,DssGraphShowQuadrants:122,DssGraphShowRiserShadows:123,DssGraphShow2DXTitle:124,DssGraphShow2DY1Title:125,DssGraphShow2DY2Title:126,DssGraphShow2DXLabel:127,DssGraphShow2DX:-127,DssGraphShow2DY1Label:128,DssGraphShow2DY1:-128,DssGraphShow2DY2Label:129,DssGraphShow2DY2:-129,DssGraphShowZeroLineX:130,DssGraphShowZeroLineY1:131,DssGraphShowZeroLineY2:132,DssGraph2DSideO1:133,DssGraph2DSideO2:134,DssGraph2DSideX:135,DssGraph2DSideY1:136,DssGraph2DSideY2:137,DssGraph2DSDSplitY:140,DssGraphStaggerO1:142,DssGraphStaggerO2:143,DssGraphStaggerX:144,DssGraphStaggerY1:145,DssGraphStaggerY2:146,DssGraphUniformBorders:148,DssGraphPieDepthValue:192,DssGraphPieHoleSizeValue:198,DssGraphPieInset:200,DssGraphPiesPerRowValue:201,DssGraphPieRotationValue:202,DssGraphShowFeeler:204,DssGraphShowLBLFeelerLabel:205,DssGraphShowLBLFeeler:-205,DssGraphShowLBLPie:206,DssGraphShowLBLRing:207,DssGraphDeleteSlice:208,DssGraphDetachSlice:209,DssGraphPieRestore:210,DssGraphPieTiltValue:211,DssGraphPieTiltOn:212,DssGraphShowPolarCoordinateAxis:215,DssGraphShowPolarConnectLines:218,DssGraphStockDataValueType:222,DssGraphShowBubbleGrid:245,DssGraphSDShowDataText:247,DssGraphShowTitleSeries:248,DssGraphConnectStackBars:249,DssGraphLegendBox:250,DssGraphLinkColors:260,DssGraph3DCustomView:265,DssGraph3DGridFloor:277,DssGraph3DGridLWall:278,DssGraph3DGridRiser:279,DssGraph3DGridRWall:280,DssGraph3DColTitleLocation:285,DssGraph3DLYTitleLocation:287,DssGraph3DRowTitleLocation:288,DssGraph3DRYTitleLocation:289,DssGraph3DScalefreqX:299,DssGraph3DScalefreqY:300,DssGraph3DScalefreqZ:301,DssGraphShow3DScatterLine:308,DssGraphShow3DLineToLWall:309,DssGraphShow3DLineToFloor:310,DssGraphShow3DLineToRWall:311,DssGraphSD3DRiserType:312,DssGraphShow3DShowDataLabelsBox:313,DssGraph3DOffScaleTypeX:314,DssGraph3DOffScaleTypeY:315,DssGraph3DOffScaleTypeZ:316,DssGraphShow3DCHeader:318,DssGraphShow3DColTitle:319,DssGraph3DShowDataText:320,DssGraphShow3DLNumber:321,DssGraphShow3DLYTitle:322,DssGraphShow3DRNumber:323,DssGraphShow3DRYTitle:324,DssGraphShow3DRHeader:325,DssGraphShow3DRowTitle:326,DssGraphShow3DFloor:327,DssGraphShow3DLegend:328,DssGraphShow3DLWall:329,DssGraphShow3DRWall:330,DssGraph3DViewStruct:337,DssGraphACMColorModel:549,DssGraphLegendItems:554,DssGraphSeriesColor:556,DssGraphReverseGroup:558,DssGraphReverseSeries:559,DssGraphSeriesByColumn:560,DssGraphAreaBackColor:561,DssGraphAreaTransparency:563,DssGraphAreaColor:564,DssGraphAreaPattern:566,DssGraphAreaSFX:567,DssGraphFontAlign:570,DssGraphFontTransparency:573,DssGraphFontColor:574,DssGraphFontName:576,DssGraphFontRotation:578,DssGraphVirtualFontSize:583,DssGraphFontStyle:584,DssGraphType:585,DssGraphLineTransparency:587,DssGraphLineColor:588,DssGraphLinePattern:589,DssGraphVirtualLineWidth:591,DssGraphFootnoteLocation:592,DssGraphFrameLocation:593,DssGraphSubTitleLocation:594,DssGraphTitleLocation:595,DssGraphShowfootnote:596,DssGraphShowSubtitle:597,DssGraphShowTitle:598,DssGraphFontBox:601,DssGraphFontSize:603,DssGraphLockFontSize:604,DssGraphLineWidth:605,DssGraphAreaAlpha:608,DssGraphLineAlpha:609,DssGraphFontAlpha:610,DssGraphAreaCustomBevelEffect:612,DssGraphFormatDataTextAdv:616,DssGraphFormatXAdv:618,DssGraphFormatY1Adv:619,DssGraphFormatY2Adv:620,DssGraphFormatZAdv:621,DssGraphMiddleValue:630,DssGraphSplitYPosition:631,DssGraphAxisShowUserLine:632,DssGraphAxisUserLineValue:633,DssGraphAxisUserLineAxis:634,DssGraphMarkerLayout:637,DssGraphPieDataValueLoc:638,DssGraphPieDataLabelLoc:639,DssGraph2DOrdSpaceMode:642,DssGraphLegendLock:644,DssGraphGridStepY1:645,DssGraphGridStepY2:646,DssGraphGridStepX:647,DssGraphDataTextShowConnectLine:652,DssGraphGridLineZ:658,DssGraphScaleZ:659,DssGraphStaggerZ:660,DssGraph2ScaleEndZ:662,DssGraph2ExcludeZeroZ:663,DssGraph2ScaleDirectionZ:664,DssGraphGridStepZ:665,DssGraphGaugeInfo:668,DssGraphGaugeFancyBox:669,DssGraphSDMarkerSize:671,DssGraphSDMarkerShape:683,DssGraphMetric1:690,DssGraphMetric2:691,DssGraphStockStyle:692,DssGraph2ScaleDirectionY3:693,DssGraph2ExcludeZeroY3:694,DssGraphGridLineY3:697,DssGraphFormatY3Adv:699,DssGraphGridStepY3:701,DssGraphOffScaleTypeY3:702,DssGraphShow2DY3:704,DssGraph2DSideY3:706,DssGraphStaggerY3:707,DssGraph2DPlaceY3:709,DssGraph2ScaleEndY3:710,DssGraph2DScaleFreqY3:713,DssGraphScaleY3:714,DssGraph2ScaleDirectionY4:715,DssGraph2ExcludeZeroY4:716,DssGraphGridLineY4:719,DssGraphFormatY4Adv:721,DssGraphGridStepY4:723,DssGraphOffScaleTypeY4:724,DssGraphShow2DY4:726,DssGraph2DSideY4:728,DssGraphStaggerY4:729,DssGraph2DPlaceY4:731,DssGraph2ScaleEndY4:732,DssGraph2DScaleFreqY4:735,DssGraphScaleY4:736,DssGraphSpiderLines:739,DssGraphPolarStartAngle:740,DssGraphMetric3:742,DssGraphRadarCircularDataLines:782,DssGraphRemoteAxis:784,DssGraphConnectFirstLast:790,DssGraphGaugeShowAxisLabelsOutside:791,DssGraphGaugeShowNeedle:792,DssGraphTailShape:793,DssGraphPieForceRound:794,DssGraphGaugeStyleValue:795,DssGraphGaugeBorderStyleValue:796,DssGraphGaugeBorderThicknessValue:797,DssGraphGaugeRangeThicknessValue:798,DssGraphGaugeRangeStartAngleValue:799,DssGraphGaugeRangeStopAngleValue:800,DssGraphGaugeNeedleStyleValue:801,DssGraphCurvedLines:804,DssGraphAreaBevelEffect:879,DssGraphFontAntiAlias:881,DssGraphFormatDataTextY3:695,DssGraphFormatDataTextY4:717,DssGraphColorPalette:10000,DssGraphOriContent:10001,DssGraphFillEffect:10002,DssGraphGradient:10003,DssGraphSDShowToolTip:10004,DssGraphSDToolTip:10005,DssGraphSDRegressionType:10006,DssGraph2LogScale:10007,DssGraphManualMajor:10008,DssGraphManualMinor:10009,DssGraph2ScaleDirection:10010,DssGraphShow2DAxisLine:10011,DssGraph2ExcludeZero:10012,DssGraph2ScaleUseMax:10013,DssGraph2ScaleUseMin:10014,DssGraph2ScaleMax:10015,DssGraph2ScaleMin:10016,DssGraphShow2DAxisLabels:10017,DssGraph2ScaleEndMax:10018,DssGraph2ScaleEndMin:10019,DssGraphShow2DAxisMajor:10020,DssGraphShow2DAxisMinor:10021,DssGraph2DSide:10022,DssGraphStyleMajor:10023,DssGraphStyleMinor:10024,DssGraphCountMajor:10025,DssGraphCountMinor:10026,DssGraphShowTotalValue:10027,DssGraph2DPie:10028,DssGraphShowDataValue:10029,DssGraphShowDVPercent:10030,DssGraphShowDataLabel:10031,DssGraphShowPieLabelOnSide:10032,DssGraphShowMarker:10033,DssGraphShowMetric1:10034,DssGraphShowMetric2:10035,DssGraphShowMetric3:10036,DssGraphMetric1Style:10037,DssGraphMetric2Style:10038,DssGraphMetric3Style:10039,DssGraphShowLine:10040,DssGraphShowToolTip:10041,DssGraphToolTip:10042,DssGraphAxisAutoFit:10043,DssGraphAxisStagger:10044,DssGraphAxisScaleFreq:10045,DssGraphMetric1Value:10046,DssGraphMetric2Value:10047,DssGraphMetric3Value:10048,DssGraph2AxisFormatText:10049,DssGraph2AxisFormatDataText:10050,DssGraphDPI:10051,DssGraphDocSize:10052,DssGraphAutoArrange:10053,DssGraph2DSplitYAutomatic:10054,DssGraphHistogramRangeMin:10055,DssGraphHistogramRangeMax:10056,DssGraphHistogramBuckets:10057,DssGraphGaugeSAngle:10058,DssGraphGaugeEAngle:10059,DssGraphGaugeThickness:10060,DssGraphGauge1Show:10061,DssGraphGauge1Min:10062,DssGraphGauge1Max:10063,DssGraphGauge2Show:10064,DssGraphGauge2Min:10065,DssGraphGauge2Max:10066,DssGraphGauge3Show:10067,DssGraphGauge3Min:10068,DssGraphGauge3Max:10069,DssGraphGauge4Show:10070,DssGraphGauge4Min:10071,DssGraphGauge4Max:10072,DssGraphGauge5Show:10073,DssGraphGauge5Min:10074,DssGraphGauge5Max:10075,DssGraphAxisDataTextPlace:10076,DssGraphAxisNumberFormat:10077,DssGraphAxisDataNumberFormat:10078,DssGraphAxisHasErrorBar:10079,DssGraphAxisHasMiddleValue:10080,DssGraphHeight:10081,DssGraphWidth:10082,DssGraphPicture:10083,DssGraph3DTurnXCounterClockwise:10084,DssGraph3DTurnYCounterClockwise:10085,DssGraph3DTurnZCounterClockwise:10086,DssGraph3DTurnXClockwise:10087,DssGraph3DTurnYClockwise:10088,DssGraph3DTurnZClockwise:10089,DssGraph3DMoveXTowardsOrigin:10090,DssGraph3DMoveYTowardsOrigin:10091,DssGraph3DMoveZTowardsOrigin:10092,DssGraph3DMoveXAwayFromOrigin:10093,DssGraph3DMoveYAwayFromOrigin:10094,DssGraph3DMoveZAwayFromOrigin:10095,DssGraph3DDecreaseCubeX:10096,DssGraph3DDecreaseCubeY:10097,DssGraph3DDecreaseCubeZ:10098,DssGraph3DIncreaseCubeX:10099,DssGraph3DIncreaseCubeY:10100,DssGraph3DIncreaseCubeZ:10101,DssGraph3DDecreaseWallX:10102,DssGraph3DDecreaseWallY:10103,DssGraph3DDecreaseWallZ:10104,DssGraph3DIncreaseWallX:10105,DssGraph3DIncreaseWallY:10106,DssGraph3DIncreaseWallZ:10107,DssGraph3DPanXLeft:10108,DssGraph3DPanYUp:10109,DssGraph3DRelative:10110,DssGraph3DPanXRight:10111,DssGraph3DPanYDown:10112,DssGraph3DAbsolute:10113,DssGraph3DZoomIn:10114,DssGraph3DIncreasePerspectiveDistortion:10115,DssGraph3DStepSize:10116,DssGraph3DZoomOut:10117,DssGraph3DDecreasePerspectiveDistortion:10118,DssGraph3DInitMatrix:10119,DssGraphGaugeQBShow:10120,DssGraphGaugeQBStart:10121,DssGraphGaugeQBStop:10122,DssGraphEnhancedSeriesEffect:10123,DssGraphLocale:10124,DssGraph3DViewStructName:10125,DssGraphLabelsDistance:10126,DssGraphLegendDetails:10127,DssGraphDefaultsInitialized:10128,DssGraphShow3DAxisMajor:10129,DssGraphGradientColorMode:10130,DssGraphLegendDetailsNEW:10131,DssGraphFrameLocationNEW:10132,DssGraph3DColTitleLocationNEW:10133,DssGraph3DRowTitleLocationNEW:10134,DssGraphLabelsDistanceNEW:10135,DssGraphDocSizeNEW:10136,DssGraphUseManualHistogramBuckets:10137,DssGraphFontSize100:10138,DssGraphUseSpecialSeries:10140,DssGraphIsOnlyAdditionalMetrics:10170};mstrmojo.VisEnum={ControlType:{BUTTON:"button",LASSO_SELECTOR:"lasso-selector",LASSO_RESIZER:"lasso-resizer",SPLITTER:"splitter",GM_ROW_HEADER:"rh",GM_ROW_HEADER_TEXT:"rhtext",GM_ROW_HEADER_EXTRA:"rhext",GM_COL_HEADER:"ch",GM_COL_HEADER_TEXT:"chtext",GM_COL_HEADER_EXTRA:"chext",GM_YAXIS:"y",GM_XAXIS:"x",GM_YLABEL:"y-label",GM_XLABEL:"x-label",GM_ROW_HEADER_TITLE:"rht",GM_ROW_HEADER_TITLE_TEXT:"rhttext",GM_COL_HEADER_TITLE:"cht",GM_COL_HEADER_TITLE_TEXT:"chttext",GM_MINI_CHART:"chart",GM_TEXT_BODY:"text-body",GM_SHAPE:"shape",GM_MARKER:"marker",GM_SET_SHAPE:"set-shape",GM_YAXIS2:"y2",GM_XAXIS2:"x2",GM_TREND_LINE:"trendLine",GM_TREND_LINE_HOVER:"trendLineHover",GM_TREND_LINE_SELECT:"trendLineSelect",GM_REF_LINE:"referenceLine",GM_REF_LINE_HOVER:"referenceLineHover",GM_REL_LINE_SELECT:"referenceLineSelect",GM_HIGHLIGHT_BOX:"highlight-box",GM_AXIS_TEXT:"axis-text",GM_AXIS_WORD:"axis-word",GM_SVG_X_NUMERIC:"svg-x-numeric",GM_SVG_X_CATEGORY:"svg-x-category",GM_SVG_Y_NUMERIC:"svg-y-numeric",GM_SVG_Y_CATEGORY:"svg-y-category",GM_X_NUMERIC:"x-numeric",GM_X_CATEGORY:"x-category",GM_Y_NUMERIC:"y-numeric",GM_Y_CATEGORY:"y-category",GM_SVG_CHART:"svg-chart",GM_DATA_LABEL:"data-label",GM_YAXIS_LINE:"y-line",GM_XAXIS_LINE:"x-line",GM_YAXIS2_LINE:"y2-line",GM_XAXIS2_LINE:"x2-line",LGD_TITLE:"lgd-title",LGD_TEXT:"lgd-text",LGD_COLORBOX:"lgd-colorbox",LGD_COLORBOX_CTN:"lgd-colorbox-ctn",LGD_CANVAS:"lgd-canvas",LINE_CONTAINER:"line-ctn",GM_V_MATRIX_LINE:"v-line",GM_H_MATRIX_LINE:"h-line",GM_V_CHART_LINE:"v-ctline",GM_H_CHART_LINE:"h-ctline",GM_CHART_ROW:"ct-row",GM_CHART_COL:"ct-col",GM_H_GRID_LINE:"h-gline",GM_V_GRID_LINE:"v-gline",GM_H_MINOR_GRID_LINE:"h-gline-minor",GM_V_MINOR_GRID_LINE:"v-gline-minor",GM_ORIGIN_LINE:"originLine",GM_ORIGIN_LABEL:"origin-label",GM_ORIGIN_LINE_H:"origin-line-h",GM_ORIGIN_LINE_V:"origin-line-v",GM_ORIGIN_LABEL_H:"origin-label-h",GM_ORIGIN_LABEL_V:"origin-label-v",GM_DUMMY_A:"dummy-a",GM_V_EXTRA_LINE:"v-extra-line",GM_REF_LABEL:"ref-label",GM_RIGHT_BORDER:"border-r",GM_BOTTOM_BORDER:"border-b"},GMDropZoneID:{ROWS:1,COLUMNS:2,XAXIS:3,YAXIS:4,BREAKBY:5,SLICEBY:6,COLORBY:7,SIZEBY:8,TOOLTIP:9,ANGLEBY:10},NETWORK_LOCAL_PROPS:{ZOOM_FACTOR:"zf",NODE_POSITION:"np"},NETWORK_PROPERTIES:{showLegend:"showLegend",showEdgeDirection:"showedgearrow",showTransition:"animatelayout",nodeSizeAggregation:"nodesizeaggfunc",minNodeSize:"minns",maxNodeSize:"maxns",themeType:"th",circleLabelFont:"BubFnt",modifiedNodes:"mn",layoutMode:"layout",legendPosition:"legendposition",dragMode:"mode",bubbleStyle:"bbs",propsCategory:"pc",lgdBgFillClr:"lgdBgFillClr",lgdBgFillTrans:"lgdBgFillTrans",lgdFntClr:"lgdFntClr",lgdFntSz:"lgdFntSz",lgdFntFml:"lgdFntFml",lgdFntStyle:"lgdFntStyle"},NETWORK_LAYOUT:{CIRCULAR:"circular",LINEAR:"linear",FORCE_DIRECTED:"forceDirected"},NETWORK_DRAG_MODE:{pan:0,select:1},NETWORK_AGGREGATION_METHOD:{"Count of":0,"Sum of":1,"Average of":2,"Min of":3,"Max of":4},NETWORK_MIN_NODE_SIZE_TYPE:{PROPORTIONAL:1,FULL_RANGE:2,ADJUSTED_RANGE:3},NETWORK_MAX_NODE_SIZE_TYPE:{AUTOMATIC:1,MANUAL:2},NETWORK_FORCE_DIRECTED_LAYOUT_EDGE_CURVATURE:[0,0.2],HEATMAP_PROPERTIES:{showLegend:"showLegend",deleteButton:"ed",showMetricValues:"mv",labelSize:"lb",layout:"la",themeType:"th",headerType:"he",deletedList:"dl",refreshType:"rt",metricList:"ml",colorByType:"cbt",absoluteFixed:"abs",blendColor:"blc",background:"bg",legendBackground:"lbg",headerColors:"hcl",fonts:"fts",propsCategory:"pc",attrColorByOpacity:"acbo",metricColorByOpacity:"mcbo"},HEATMAP_LABEL_SIZE:{On:0,Off:1,Proportional:2},MAPS_PROPERTIES:{SHOW_LEGEND:"showLegend"},VIS_CARDLIMIT:{GRID:250,NON_GRID:8000},GMLegendDataType:{COLOR_BY:1,SIZE_BY:2},GMLegendFormatingPropertyTag:{LEGEND_BG_COLOR:"lgdBgFillClr",LEGEND_BG_FILL_STYLE:"lgdBgFillStyle",LEGEND_BG_FILL_EFFECT:"lgdBgFillEff",LEGEND_BG_FILL_TRANSPARENCY:"lgdBgFillTrans",LEGEND_FONT_SIZE:"lgdFntSz",LEGEND_FONT_FAMILY:"lgdFntFml",LEGEND_FONT_STYLE:"lgdFntStyle",LEGEND_FONT_COLOR:"lgdFntClr",LEGEND_BORDER_SHOW:"lgdBdrShw",LEGEND_BORDER_COLOR:"lgdBdrClr",LEGEND_BORDER_THICKNESS:"lgdBdrThk",LEGEND_BORDER_LINE_STYLE:"lgdBdrStyle",LEGEND_BORDER_LINE_COMBINED_STYLE:"lgdBdrCmbStyle",COLOR_SQUARE_COLOR:"clrSqrClr"},LegendPropertyTag:{LEGEND_MODE:"lm",LEGEND_POSITION:"LegendPosition",SCALE_LEGEND_WIDTH:"lwr"},EnumLegendMode:{RESTORED:1,MINIMIZED:2},EnumColorRankMode:{INVALID:-1,VALUE:0,TOP:1,BOTTOM:2,TOP_PERCENT:3,BOTTOM_PERCENT:4},FormNameDisplayType:{OFF:0,ON:1,FORM_NAME_ONLY:2,SHOW_ATT_NAME_ONCE:3,AUTO:4},SERVER_JSON_ERROR_TYPE:{EMPTY_DATA:0,NO_DATASET:1,AE_ERROR:2,NO_TEMPLATE_UNIT:3},NETWORK_CIRCLE_BORDER_WIDTH:8,IMAGELAYOUT_PROPERTIES:{DISPLAY_MODE:"mt",MAX_SIZE_TYPE:"ty",MAX_SIZE_VALUE:"val",MIN_SIZE_TYPE:"mst",MIN_SIZE_VALUE:"msv",MAP_FILE_PATH:"mf",SHAPE_FILL_OPC_PER:"shapeFillTrans",SHAPE_FILL_COLOR:"shapeClr",SHAPE_BORDER_STYLE:"shapeBorderCmbStyle",SHAPE_BORDER_COLOR:"shapeBorderClr",DATA_LABEL_SWITCH:"dls",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle",BLANK_MAP_BORDER_STYLE:"blankMapBorderStyle",BLANK_MAP_BORDER_COLOR:"blankMapBorderClr",BLANK_MAP_COLOR:"blankMapClr",DEFAULT_MAP_COLOR:"dftMapClr",DEFAULT_BUBBLE_COLOR:"dftBubbleClr",DEFAULT_MAP_BORDER_COLOR:"dftMapBorderClr",DEFAULT_BUBBLE_BORDER_COLOR:"dftBubbleBorderClr",LEGEND_FONT_SIZE:"lgFntSz",LEGEND_FONT_FAMILY:"lgFntFml",LEGEND_FONT_COLOR:"lgFntClr",LEGEND_FONT_STYLE:"lgFntStyle",LEGEND_BACKGROUND_COLOR:"lgBgClr",LEGEND_OPC_PER:"lgBgFillTrans",LEGEND_POSITION:"lgPos",LEGEND_SHOW:"lgShow",LEGEND_MODE:"lgMode",LEGEND_SCALE:"lgScale",H_MATRIX_LINE_COLOR:"hMatrixLnClr",V_MATRIX_LINE_COLOR:"vMatrixLnClr",ALL_MATRIX_LINE_COLOR:"allMatrixLnClr",H_MATRIX_LINE_STYLE:"hMatrixLnCmbStyle",V_MATRIX_LINE_STYLE:"vMatrixLnCmbStyle",ALL_MATRIX_LINE_STYLE:"allMatrixLnCmbStyle"}};mstrmojo.chart.enums.EnumFontStyle={FS_NORMAL:0,FS_BOLD:1,FS_ITALIC:2,FS_BOTH:3,FS_UNDERLINE:4,FS_STRIKETHROUGH:8};mstrmojo.mstr.EnumNodeDimty={NodeDimtyReserved:0,NodeDimtyNone:1,NodeDimtyContinuation:2,NodeDimtyExclusiveContinuation:3,NodeDimtyOutputLevel:4,NodeDimtyBreakBy:5,NodeDimtyEmbedded:6,NodeDimtyUnspecified:7};mstrmojo.warehouse.EnumObjectTypes={FILTER:1,METRIC:4,ATTRIBUTE:12,FACT:13,DIMENSION:14,TABLE:15,TABLE_LOGICAL_VIEW:151,TABLE_PARTITION:152,FORM:21,COLUMN:26,DBROLE:29,PROJECT:32,TRANSFORMATION:43,DBTABLE:53,LAYER:70,RELATIONSHIP:99,COMPOUND_FORM:1001,RELATIONSHIP_ATTRIBUTE:1002};mstrmojo.mstr.EnumFunction={FunctionCustom:-1,FunctionReserved:0,FunctionPlus:1,FunctionMinus:2,FunctionTimes:3,FunctionDivide:4,FunctionUnaryMinus:5,FunctionEquals:6,FunctionNotEqual:7,FunctionGreater:8,FunctionLess:9,FunctionGreaterEqual:10,FunctionLessEqual:11,FunctionSum:12,FunctionCount:13,FunctionAvg:14,FunctionMin:15,FunctionMax:16,FunctionBetween:17,FunctionLike:18,FunctionAnd:19,FunctionOr:20,FunctionNot:21,FunctionIn:22,FunctionRank:23,FunctionAbs:24,FunctionRunningSum:25,FunctionRunningAvg:26,FunctionMovingSum:28,FunctionMovingAvg:27,FunctionProduct:29,FunctionMedian:30,FunctionMode:31,FunctionStdev:32,FunctionVar:33,FunctionGeomean:34,FunctionEqualEnhanced:35,FunctionNotEqualEnhanced:36,FunctionGreaterEqualEnhanced:37,FunctionLessEqualEnhanced:38,FunctionBetweenEnhanced:39,FunctionBanding:40,FunctionBandingC:41,FunctionBandingP:42,FunctionNotLike:43,FunctionNotBetween:44,FunctionIntersect:45,FunctionIntersectIn:46,FunctionNullToZero:47,FunctionZeroToNull:48,FunctionApplySimple:49,FunctionApplyAggregation:50,FunctionApplyLogic:51,FunctionApplyComparison:52,FunctionApplyRelative:53,FunctionIsNull:54,FunctionIsNotNull:55,FunctionUcase:56,FunctionNotIn:57,FunctionNTile:58,FunctionPercentile:59,FunctionMovingMax:60,FunctionMovingMin:61,FunctionMovingDifference:62,FunctionMovingStdev:63,FunctionExpWghMovingAvg:64,FunctionMovingCount:65,FunctionRunningMax:66,FunctionRunningMin:67,FunctionRunningStdev:68,FunctionRunningCount:69,FunctionExpWghRunningAvg:70,FunctionNotBetweenEnhanced:71,FunctionConcat:72,FunctionFirstInRange:73,FunctionLastInRange:74,FunctionValueSegment:75,FunctionContains:76,FunctionBeginsWith:77,FunctionEndsWith:78,FunctionNotContains:79,FunctionNotBeginsWith:80,FunctionNotEndsWith:81,FunctionCase:82,FunctionCaseV:83,FunctionStdevP:84,FunctionRunningStdevP:85,FunctionMovingStdevP:86,FunctionNTileS:87,FunctionNTileVS:88,FunctionVarP:89,FunctionCurrentDate:90,FunctionDayOfMonth:91,FunctionDayOfWeek:92,FunctionDayOfYear:93,FunctionWeek:94,FunctionMonth:95,FunctionQuarter:96,FunctionYear:97,FunctionCurrentDateTime:98,FunctionCurrentTime:99,FunctionHour:100,FunctionMinute:101,FunctionSecond:102,FunctionMilliSecond:103,FunctionConcatNoBlank:104,FunctionLength:105,FunctionLower:106,FunctionLTrim:107,FunctionPosition:108,FunctionRTrim:109,FunctionSubStr:110,FunctionInitCap:111,FunctionTrim:112,FunctionRightStr:113,FunctionLeftStr:114,FunctionGreatest:115,FunctionLeast:116,FunctionFirst:117,FunctionLast:118,FunctionAdd:134,FunctionAverage:135,FunctionMultiply:136,FunctionBandingM:137,FunctionOLAPSum:138,FunctionOLAPAvg:139,FunctionOLAPCount:140,FunctionOLAPMax:141,FunctionOLAPMin:142,FunctionLag:143,FunctionLead:144,FunctionPercentRank:166,FunctionTuple:1000};mstrmojo.chart.enums.EnumGraphMajorType={GMT_INVALID:0,GMT_CATEGORY:1,GMT_PIE:2,GMT_SCATTER:3,GMT_POLAR:4,GMT_RADAR:5,GMT_BUBBLE:6,GMT_STOCK:7,GMT_HISTOGRAM:8,GMT_GAUGE:9,GMT_FUNNEL:10,GMT_BOX:11,GMT_GANTT:12,GMT_SPECTRAL:13,GMT_TABLE:14,GMT_3D_CATEGORY:15,GMT_3D_SCATTER:16,GMT_GRID:17};(function(){function A(C){return C.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");}mstrmojo._ImageHelper=mstrmojo.provide("mstrmojo._ImageHelper",{getImage:function B(D){var E=mstrApp,C=E.getConfiguration();if(D){if(D.indexOf("\\")>=0){D=D.replace(/\\/g,"/");}D=A(D);if(D===decodeURI(D)){D=encodeURI(D);}}if(C&&D&&D.indexOf("://")===-1){D=C.getHostUrlByProject(E.getCurrentProjectId())+D;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(D)):D;}});}());mstrmojo.LoadedExternalJSURLs={};function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function requiresMethod(B){if(!B){return false;}if(typeof this[B]==="function"){return true;}var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof A==="string"){this.requiresCls(A);return typeof this[B]==="function";}return false;},requiresCls:function req(mixins,callback){if(mixins){if(typeof mixins==="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin,i,len;for(i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof A==="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresExternalScripts(F,G,C){if(F&&F instanceof Array){if(F.length===0){if(G){G.call(C);}return false;}if(F[0]&&F[0].forceReload===false&&mstrmojo.LoadedExternalJSURLs[F[0].url]){F.splice(0,1);return this.requiresExternalScripts(F,G,C);}var A=document.createElement("script"),D=!!document.all,B=F[0].url;if(B.substr(0,7)==="file://"){B=B.substr(7);}else{if(mstrApp.isSingleTier&&B.substr(0,4)!=="http"){B="http:"+B;}}A.type="text/javascript";A.src=B;if(!F[0].callbackParamName){if(D){A.onreadystatechange=function(){if(A.readyState==="loaded"||A.readyState==="complete"){A.onreadystatechange=null;if(F.length>1){mstrmojo.LoadedExternalJSURLs[F.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(F,G);}else{if(F.length===1){mstrmojo.LoadedExternalJSURLs[F[0].url]=true;if(G){G.call(C);}}}}};}else{A.onload=function(){A.onload=null;if(F.length>1){mstrmojo.LoadedExternalJSURLs[F.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(F,G);}else{if(F.length===1){mstrmojo.LoadedExternalJSURLs[F[0].url]=true;if(G){G.call(C);}}}};}}else{if(F[0].callbackParamName.length!==0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy===true){var E=this;window.setTimeout(function(){E.requiresExternalScripts(F,G,C);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+F[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=F;mstrmojo._LoadsScript.callback=G;mstrmojo._LoadsScript.esScritsContext=C;}}document.getElementsByTagName("head")[0].appendChild(A);}}});mstrmojo._ShowsStatus=mstrmojo.provide("mstrmojo._ShowsStatus",{showStatus:function showStatus(A,G,D){var C=this._STATUS;if(!this.hasRendered||!C){return ;}var E=C.style;if(!A){if(this.showingStatus){E.display="none";}}else{if(C){var F=this._STATUS_TXT;if(F){F.innerHTML=G||"";}var B=this._STATUS_BAR;if(B){B.style.width=(D||0)+"%";}if(!this.isStatusBarPositioned){E.top=Math.max((this.scrollboxHeight||0)-50,12)+"px";this.isStatusBarPositioned=true;}if(!this.showingStatus){E.display="block";}}}this.showingStatus=A;},updateStatus:function updateStatus(A,B){this.showStatus(this.showingStatus,A,B);}});mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){mstrmojo.models.template.Title=mstrmojo.declare(null,null,{init:function G(J){this.title=J.title;},getActionType:function(){return this.title.at;},getDrillPath:function(){return this.title.dp;},getHeaderValues:function B(){return this.title.es;},getHeaderName:function F(J){return this.title.es[J].n;},getHeaderId:function F(J){return this.title.es[J].id;},getForms:function E(){return this.title.fs;},getFormId:function D(){return this.title.fid;},getFormType:function I(){return this.title.ftp;},getUnitId:function H(){return this.title.id;},getLinkMap:function C(){return this.title.lm;},getName:function A(){return this.title.n;},getUnitDssType:function(){return this.title.otp;},getSelectorControl:function(){return this.title.sc;}});}());(function(){mstrmojo.ui.editors._HostsControls=mstrmojo.provide("mstrmojo.ui.editors._HostsControls",{_mixinName:"mstrmojo.ui.editors._HostsControls",setFormatSource:function C(E){this.throwAbstractMethodError("setFormatSource");},syncControls:function A(E){var F=this._sync;this._sync=true;E.call(this);this._sync=F;},raiseFormatValueChange:function D(F,G,E){if(this._sync){return false;}this.onGroupValueChange(F,G,E);return true;},onGroupValueChange:function B(F,G,E){}});}());(function(){mstrmojo.vi._MonitorsAppState=mstrmojo.provide("mstrmojo.vi._MonitorsAppState",{onAppStateChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("appStateChange",this.id,"onAppStateChange");}}});}());(function(){mstrmojo.gmaps.MapPropertiesHelper=mstrmojo.provide("mstrmojo.gmaps.MapPropertiesHelper",{getMatchingShape:function A(B,H,G){var F,D,C,E;if(!B){return null;}if(!!H){for(F=0;F<B.length;F++){if(B[F].id==H){D=B[F];break;}}}else{if(!!G){for(F=0;F<B.length;F++){if(!!B[F].custom&&B[F].custom==true&&B[F].roleId==G){if(!C){C=B[F];}if(!!B[F]["default"]&&(B[F]["default"]+"").toLowerCase()==="true"){D=B[F];break;}}else{if(!E&&B[F].roleId==G&&!!B[F]["default"]&&(B[F]["default"]+"").toLowerCase()==="true"){E=B[F];}}}if(!D){if(!!E){D=E;}else{if(!!C){D=C;}}}}}return D;}});}());(function(){mstrmojo._HasPopup=mstrmojo.provide("mstrmojo._HasPopup",{_mixinName:"mstrmojo._HasPopup",_lastOpened:null,openPopup:function A(G,E){var C=!!G&&(typeof G==="string")&&!G.match(/\./)&&!!this[G],D=mstrmojo.registry.ref(C?this[G]:G);if(D&&D.open){if(C){this[G]=D;}if(D.disposable!==false){this.addDisposable(D);}var J=D.slot&&this[D.slot];if(J){if(D.parent!==this){if(this.addChildren){this.addChildren([D]);}else{var I=false,F=D.domNode||D.placeholder;if(F&&typeof F==="string"){F=document.getElementById(F);}if(!F){I=true;F=document.createElement("span");D.placeholder=F;}if(I||(F.parentNode!==J)){J.appendChild(F);}}}}try{D.open(this,E);}catch(H){console.log("Error opening popup: "+H);}this._lastOpened=D;}},closePopup:function B(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}});}());mstrmojo.vi.viz.EnumWidgetTypes={GRID:0,GRAPH_MATRIX:1,HEATMAP:2,NETWORK:3,IMAGELAYOUT:4,ESRIMAP:5,GOOGLEMAP:6,CUSTOM:7};(function(){var M=null;var I={};var G="3.14",C="js.arcgis.com/"+G;mstrmojo._CanLoadESRIMapScript=mstrmojo.provide("mstrmojo._CanLoadESRIMapScript",{_mixinName:"mstrmojo._CanLoadESRIMapScript",callback:null,mixinParentMapObj:null,esriAPIServer:null,setEsriConfig:function N(O){M=O;},getEsriConfig:function H(){return M;},parseEsriAPIServer:function K(){var O=M&&!!M.useESRICloud&&(parseInt(M.useESRICloud)===1),P=M&&M.jsapiurl;if(!O&&P){P=P.trim();P=P.replace(/^.*:\/{2,}/,"");P=P.replace(/\/+$/,"");if(P){this.esriAPIServer="//"+P;return ;}}this.esriAPIServer="//"+C;},loadExternalScript:function A(P,T){this.parseEsriAPIServer();this.callback=P;this.mixinParentMapObj=T;var O=document.createElement("script");O.type="text/javascript";var S=window.location.protocol;if(mstrApp.isSingleTier){S="http:";}O.src=S+this.esriAPIServer+"/init.js";document.getElementsByTagName("head")[0].appendChild(O);var Q=this;if(O.addEventListener){O.addEventListener("load",function R(){O.removeEventListener("load",R);Q.loadMainModule();},false);}else{if(O.readyState){O.onreadystatechange=function(){if(O.readyState==="loaded"||O.readyState==="complete"){O.onreadystatechange=null;Q.loadMainModule();}};}}},loadMainModule:function F(){window.dojo.require("esri.map");window.dojo.require("esri.tasks.query");window.dojo.require("esri.arcgis.utils");var R=window.location.protocol;if(mstrApp.isSingleTier){R="http:";}var Q=R+this.esriAPIServer+"/esri/css/esri.css";this.loadCss("esricss",Q);var P=R+this.esriAPIServer+"/dijit/themes/claro/claro.css";this.loadCss("esriClaro",P);var O=this;this.loadMapVisCss();window.dojo.addOnLoad(function(){var S=window.setInterval(function(){if(O.isMapVisCssLoaded()){window.clearInterval(S);O.loadMap();}},50);});},loadMap:function E(){var S,Q,O=[],R,V,U,P=this.getEsriConfig(),T=mstrmojo.esrimap.loadScriptListeners.length;this.callback.call(this.mixinParentMapObj,P);O.push({caller:this.mixinParentMapObj,method:this.callback});for(S=0;S<T;S++){V=mstrmojo.esrimap.loadScriptListeners[S];U=false;for(Q=0;Q<O.length;Q++){R=O[Q];if(V.caller===R.caller&&V.method===R.method){U=true;break;}}if(!U){V.method.call(V.caller,V.params);O.push({caller:V.caller,method:V.method});}}},loadCss:function J(O,T){var S=document.styleSheets;if(S){var Q,R;for(Q=0;Q<S.length;Q++){R=S[Q];if(R.id===O){return ;}}}var P=document.createElement("link");P.setAttribute("rel","stylesheet");P.setAttribute("type","text/css");P.setAttribute("href",T);P.setAttribute("id",O);document.getElementsByTagName("head")[0].appendChild(P);},isOIVM:function D(){return(mstrApp&&mstrApp.isExpress);},isMapVisCssLoaded:function L(){var Q=document.styleSheets;if(Q){var O,P;for(O=0;O<Q.length;O++){P=Q[O];if((P.id==="googleMapVis")||(!!P.ownerNode&&P.ownerNode.id==="googleMapVis")){return true;}}}return false;},loadMapVisCss:function B(){if(this.isMapVisCssLoaded()){return ;}var O=document.createElement("link");O.setAttribute("rel","stylesheet");O.setAttribute("type","text/css");O.setAttribute("href",mstrmojo.getStyleRoot()+"/mstr/googleMap.css");O.setAttribute("id","googleMapVis");document.getElementsByTagName("head")[0].appendChild(O);}});}());mstrmojo.mstr.EnumDSSXMLObjectTypes={Generic:-2,Unknown:-1,Reserved:0,Filter:1,Template:2,ReportDefinition:3,Metric:4,Style:6,AggMetric:7,Folder:8,SubscriptionDevice:9,Prompt:10,Function:11,Attribute:12,Fact:13,Dimension:14,Table:15,DatamartReport:16,FactGroup:17,Shortcut:18,Resolution:19,Monitor:20,AttributeForm:21,Schema:22,Format:23,Catalog:24,CatalogDefn:25,Column:26,PropertySet:28,DBRole:29,DBLogin:30,DBConnection:31,Project:32,ServerDef:33,User:34,Configuration:36,Request:37,Script:38,Search:39,SearchFolder:40,Datamart:41,FunctionPackageDefinition:42,Role:43,SecurityRole:44,Locale:45,Consolidation:47,ConsolidationElement:48,ScheduleEvent:49,ScheduleObject:50,ScheduleTrigger:51,Link:52,DbTable:53,TableSource:54,DocumentDefinition:55,DrillMap:56,DBMS:57,MDSecurityFilter:58,PromptAnswer:59,PromptAnswers:60,ObjectTag:65,ReservedLastOne:66};mstrmojo.vi.viz.EnumDSSDropZones={Reserved:0,Rows:1,Columns:2,XAxis:3,YAxis:4,BreakBy:5,SliceBy:6,ColorBy:7,SizeBy:8,AdditionalMetrics:9,Angle:10,Grouping:11,GeoAttribute:12,Layout:13,FromItem:14,ToItem:15,ItemSize:16,Latitude:17,Longitude:18};(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());(function(){mstrmojo._CanDrawHeatMap={_mixinName:"mstrmojo._CanDrawHeatMap",callback:null,_map:null,canvas:null,canvasWidth:0,canvasHeight:0,latlngArr:null,originalzIndex:1,themeId:null,onthemeIdChange:function E(){this.themeData=null;},themeLoaded:false,themeData:null,bounds:null,xOffset:0,yOffset:0,locationMap:null,presetThemeData:[[4,5,88,0,3,4,91,0,2,4,96,0,1,5,100,0,1,6,105,0,1,6,105,0,1,8,109,0,0,9,114,0,0,12,119,0,0,15,125,0,0,15,125,0,0,18,130,0,0,21,135,0,0,25,141,0,0,29,146,0,0,29,146,0,0,34,151,0,0,39,156,0,0,45,161,0,0,51,166,0,0,51,166,0,0,57,170,0,0,64,174,0,0,70,179,0,0,77,183,0,0,85,188,0,0,85,188,0,0,92,192,0,0,98,195,0,0,106,199,0,0,111,203,0,0,111,203,0,0,116,205,0,0,121,208,0,0,129,213,0,0,138,218,0,0,138,218,0,0,146,222,0,0,155,228,0,0,163,232,0,0,172,236,0,0,172,236,0,0,179,240,0,0,187,244,0,0,194,247,0,0,202,250,0,0,208,252,0,0,208,252,0,0,214,254,0,0,219,255,0,0,224,255,0,0,228,255,0,0,228,255,0,0,232,255,0,0,234,255,0,0,234,254,0,0,234,251,0,0,234,251,0,0,234,248,0,0,234,246,0,0,234,242,0,0,234,238,0,0,234,238,0,0,234,234,0,0,234,230,0,0,234,225,0,0,234,220,0,0,234,214,0,0,234,214,0,0,233,209,0,0,231,203,0,0,229,196,0,0,227,189,0,0,227,189,0,0,224,183,0,0,222,177,0,0,219,170,0,0,216,164,0,0,216,164,0,0,215,159,0,0,213,155,0,0,211,150,0,0,209,146,0,0,209,146,0,0,207,142,0,0,205,137,0,0,203,133,0,0,201,128,0,0,200,124,0,0,200,124,0,0,197,119,0,0,195,115,0,0,193,111,0,0,192,107,0,0,192,107,0,0,190,103,0,0,189,98,0,0,187,94,0,0,186,91,0,0,186,91,0,0,185,87,0,0,183,83,0,0,183,79,0,0,182,76,0,0,182,76,0,0,181,73,0,0,181,69,0,0,180,67,0,0,179,64,0,0,179,61,0,0,179,61,0,0,179,59,0,1,179,56,0,3,179,54,0,6,180,52,0,6,180,52,0,9,180,50,0,12,181,47,0,15,182,45,0,19,183,43,0,19,183,43,0,22,184,42,0,26,186,39,0,30,187,38,0,35,189,36,0,35,189,36,0,39,190,34,0,44,193,33,0,49,195,32,0,54,197,30,0,59,200,29,0,59,200,29,0,65,202,27,0,70,204,25,0,75,207,24,0,81,209,23,0,81,209,23,0,87,211,22,0,92,214,21,0,98,216,20,0,104,218,19,0,104,218,19,0,109,221,19,0,115,223,18,0,121,226,17,0,127,228,16,0,127,228,16,0,133,231,15,0,139,233,14,0,145,236,14,0,150,238,13,0,157,240,12,0,157,240,12,0,163,242,11,0,168,244,11,0,173,246,10,0,179,247,9,0,179,247,9,0,184,249,9,0,190,251,8,0,196,252,8,0,201,252,7,0,201,252,7,0,206,252,7,0,211,252,6,0,216,252,5,0,220,252,5,0,220,252,5,0,225,252,4,0,229,252,4,0,233,252,3,0,237,252,3,0,241,252,3,0,241,252,3,0,244,252,2,0,248,252,2,0,250,252,1,0,253,252,0,0,253,252,0,0,255,251,0,0,255,250,0,0,255,247,0,0,255,245,0,0,255,245,0,0,255,242,0,0,255,238,0,0,255,235,0,0,255,232,0,0,255,232,0,0,255,227,0,0,255,222,0,0,255,218,0,0,255,213,0,0,255,208,0,0,255,208,0,0,255,203,0,0,255,197,0,0,255,191,0,0,255,186,0,0,255,186,0,0,255,180,0,0,255,174,0,0,255,168,0,0,255,162,0,0,255,162,0,0,255,155,0,0,255,149,0,0,255,143,0,0,255,136,0,0,255,136,0,0,255,130,0,0,255,123,0,0,255,117,0,0,255,110,0,0,255,104,0,0,255,104,0,0,255,98,0,0,255,92,0,0,255,85,0,0,255,80,0,0,255,80,0,0,255,73,0,0,255,67,0,0,255,61,0,0,255,56,0,0,255,56,0,0,255,50,0,0,255,44,0,0,255,40,0,0,255,35,0,0,255,35,0,0,255,30,0,0,255,25,0,0,255,21,0,0,255,18,0,0,255,14,0,0,255,14,0,0,255,10,0,0,255,6,0,0,255,4,0,0,255,1,0,0,255,1,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,1,1,0,255,1,1,0,255,2,2,0,255,2,2,0],[159,159,159,0,158,158,158,0,157,157,157,0,156,156,156,0,155,155,155,0,155,155,155,0,154,154,154,0,153,153,153,0,152,152,152,0,151,151,151,0,151,151,151,0,150,150,150,0,149,149,149,0,148,148,148,0,147,147,147,0,147,147,147,0,146,146,146,0,144,144,144,0,143,143,143,0,142,142,142,0,142,142,142,0,141,141,141,0,140,140,140,0,139,139,139,0,138,138,138,0,137,137,137,0,137,137,137,0,135,135,135,0,134,134,134,0,133,133,133,0,132,132,132,0,132,132,132,0,131,131,131,0,131,130,130,0,130,128,128,0,129,127,127,0,129,127,127,0,130,126,126,0,130,125,125,0,129,123,123,0,129,122,122,0,129,122,122,0,129,121,121,0,129,120,120,0,128,118,118,0,129,117,117,0,129,116,116,0,129,116,116,0,129,115,115,0,129,113,113,0,129,112,112,0,130,111,111,0,130,111,111,0,131,110,110,0,130,108,108,0,131,107,107,0,132,106,106,0,132,106,106,0,132,104,104,0,133,103,103,0,134,102,102,0,134,100,100,0,134,100,100,0,135,99,99,0,137,98,98,0,138,97,97,0,139,95,95,0,140,94,94,0,140,94,94,0,141,93,93,0,141,91,91,0,143,90,90,0,145,89,89,0,145,89,89,0,146,88,88,0,148,87,87,0,149,86,86,0,152,86,86,0,152,86,86,0,153,85,85,0,155,84,84,0,157,84,84,0,159,83,83,0,159,83,83,0,161,82,82,0,164,82,82,0,165,81,81,0,168,81,81,0,169,80,80,0,169,80,80,0,172,79,79,0,174,79,79,0,176,78,78,0,178,77,77,0,178,77,77,0,180,77,77,0,182,76,76,0,185,75,75,0,187,75,75,0,187,75,75,0,189,74,74,0,191,73,73,0,193,73,73,0,195,72,72,0,195,72,72,0,199,72,72,0,200,71,71,0,203,70,70,0,205,70,70,0,207,69,69,0,207,69,69,0,209,68,68,0,211,68,68,0,213,67,67,0,216,66,66,0,216,66,66,0,218,66,66,0,219,65,65,0,222,65,65,0,224,64,64,0,224,64,64,0,226,63,63,0,228,63,63,0,229,62,62,0,232,61,61,0,232,61,61,0,234,61,61,0,235,60,60,0,238,60,60,0,239,59,59,0,240,58,58,0,240,58,58,0,242,58,58,0,244,57,57,0,246,56,56,0,247,56,56,0,247,56,56,0,248,55,55,0,250,55,55,0,251,54,54,0,253,53,53,0,253,53,53,0,253,53,53,0,255,52,52,0,255,54,52,0,255,54,51,0,255,54,51,0,255,56,50,0,255,58,50,0,255,59,49,0,255,62,49,0,255,64,48,0,255,64,48,0,255,66,47,0,255,69,47,0,255,71,46,0,255,75,46,0,255,75,46,0,255,78,45,0,255,80,44,0,255,84,44,0,255,88,43,0,255,88,43,0,255,91,43,0,255,94,42,0,255,98,41,0,255,102,41,0,255,102,41,0,255,106,40,0,255,110,40,0,255,114,39,0,255,118,39,0,255,123,38,0,255,123,38,0,255,127,38,0,255,131,37,0,255,135,36,0,255,140,36,0,255,140,36,0,255,144,35,0,255,149,35,0,255,153,34,0,255,158,34,0,255,158,34,0,255,162,33,0,255,167,33,0,255,171,32,0,255,175,31,0,255,175,31,0,255,181,31,0,255,185,30,0,255,189,30,0,255,193,29,0,255,199,29,0,255,199,29,0,255,203,28,0,255,207,28,0,255,210,27,0,255,215,27,0,255,215,27,0,255,218,26,0,255,222,26,0,255,226,25,0,255,229,25,0,255,229,25,0,255,232,24,0,255,236,24,0,255,239,23,0,255,242,23,0,255,242,23,0,255,245,22,0,255,247,22,0,255,250,21,0,255,251,21,0,255,254,22,0,255,254,22,0,255,255,24,0,255,255,25,0,255,255,28,0,255,255,30,0,255,255,30,0,255,255,33,0,255,255,37,0,255,255,38,0,255,255,42,0,255,255,42,0,255,255,45,0,255,255,49,0,255,255,52,0,255,255,56,0,255,255,56,0,255,255,60,0,255,255,64,0,255,255,69,0,255,255,73,0,255,255,77,0,255,255,77,0,255,255,81,0,255,255,86,0,255,255,90,0,255,255,96,0,255,255,96,0,255,255,101,0,255,255,105,0,255,255,110,0,255,255,115,0,255,255,115,0,255,255,120,0,255,255,125,0,255,255,131,0,255,255,135,0,255,255,135,0,255,255,141,0,255,255,146,0,255,255,151,0,255,255,156,0],[243,127,22,0,243,126,22,0,242,126,22,0,241,125,22,0,241,125,22,0,241,125,22,0,240,124,22,0,240,124,22,0,239,123,22,0,239,123,22,0,239,123,22,0,238,122,22,0,237,121,22,0,237,121,22,0,236,120,21,0,236,120,21,0,235,120,21,0,234,119,21,0,234,119,21,0,233,118,21,0,233,118,21,0,232,118,21,0,231,117,21,0,231,116,21,0,230,116,21,0,229,115,21,0,229,115,21,0,229,115,21,0,228,114,21,0,227,113,20,0,227,113,20,0,227,113,20,0,226,112,20,0,225,112,20,0,224,111,20,0,223,110,20,0,223,110,20,0,222,110,20,0,222,109,20,0,221,108,20,0,220,108,20,0,220,108,20,0,219,107,19,0,218,106,19,0,217,106,19,0,216,105,19,0,215,104,19,0,215,104,19,0,215,104,19,0,214,103,19,0,214,102,19,0,213,102,19,0,213,102,19,0,212,101,19,0,211,99,19,0,210,99,19,0,209,99,19,0,209,99,19,0,208,98,19,0,207,98,19,0,206,97,19,0,205,96,19,0,205,96,19,0,204,95,19,0,204,95,19,0,203,93,18,0,202,92,18,0,201,92,18,0,201,92,18,0,200,91,18,0,199,90,18,0,197,89,18,0,196,89,18,0,196,89,18,0,195,89,18,0,195,88,18,0,193,86,18,0,192,86,18,0,192,86,18,0,191,85,19,0,191,84,19,0,190,83,19,0,189,82,19,0,189,82,19,0,188,82,20,0,187,81,20,0,186,80,20,0,185,79,21,0,183,78,21,0,183,78,21,0,182,77,22,0,181,76,22,0,180,75,22,0,179,74,23,0,179,74,23,0,178,73,23,0,177,72,24,0,175,70,24,0,174,70,25,0,174,70,25,0,173,69,25,0,172,68,26,0,171,67,27,0,169,66,28,0,169,66,28,0,168,65,28,0,167,64,29,0,166,62,29,0,164,61,30,0,163,60,31,0,163,60,31,0,162,59,32,0,161,58,32,0,159,57,33,0,159,56,34,0,159,56,34,0,158,56,35,0,156,54,35,0,154,52,36,0,153,51,37,0,153,51,37,0,152,50,37,0,151,49,38,0,150,48,39,0,149,47,40,0,149,47,40,0,148,46,40,0,145,44,41,0,144,43,41,0,143,42,42,0,142,41,43,0,142,41,43,0,141,41,44,0,140,40,45,0,139,39,45,0,137,38,46,0,137,38,46,0,136,37,47,0,134,35,47,0,133,34,48,0,132,33,49,0,132,33,49,0,131,32,50,0,130,31,51,0,129,30,52,0,127,29,53,0,127,29,53,0,126,28,53,0,124,26,53,0,123,25,54,0,121,24,55,0,120,23,56,0,120,23,56,0,119,22,57,0,119,21,57,0,118,21,58,0,117,21,59,0,117,21,59,0,114,19,59,0,113,19,60,0,112,18,60,0,111,18,61,0,111,18,61,0,110,17,62,0,109,16,63,0,108,16,63,0,107,15,64,0,107,15,64,0,106,14,65,0,105,13,65,0,104,12,65,0,103,11,66,0,102,11,66,0,102,11,66,0,101,10,67,0,100,10,68,0,99,9,68,0,98,9,69,0,98,9,69,0,96,7,68,0,95,7,69,0,95,7,69,0,94,7,70,0,94,7,70,0,93,7,70,0,93,7,71,0,92,7,71,0,91,7,72,0,91,7,72,0,90,7,72,0,88,6,72,0,87,6,72,0,87,6,73,0,86,6,73,0,86,6,73,0,85,6,74,0,84,6,74,0,83,6,75,0,82,6,75,0,82,6,75,0,82,6,75,0,80,5,76,0,79,5,76,0,79,5,77,0,79,5,77,0,79,5,77,0,78,5,77,0,77,5,78,0,76,5,78,0,76,5,78,0,76,5,78,0,75,5,79,0,74,5,79,0,72,4,78,0,72,4,79,0,72,4,79,0,71,4,79,0,70,4,79,0,70,4,80,0,69,4,80,0,69,4,80,0,68,4,80,0,68,4,81,0,67,4,81,0,66,4,81,0,66,4,81,0,65,3,81,0,64,3,81,0,63,3,81,0,63,3,81,0,63,3,81,0,62,3,82,0,62,3,82,0,61,3,82,0,60,4,82,0,60,4,83,0,60,4,83,0,59,4,83,0,59,4,83,0,58,5,83,0,58,4,83,0,58,4,83,0,57,4,83,0,56,5,83,0,56,5,83,0,55,5,84,0,55,5,84,0,55,5,84,0,54,6,84,0,54,6,84,0,53,6,84,0,53,6,84,0,53,7,85,0,52,7,85,0,52,7,85,0,50,6,85,0],[57,62,47,0,58,63,47,0,58,64,47,0,58,64,46,0,59,65,46,0,59,65,46,0,60,66,46,0,61,66,46,0,62,67,46,0,63,68,46,0,63,68,46,0,63,68,45,0,64,70,45,0,65,70,45,0,66,71,45,0,66,71,45,0,67,72,45,0,68,73,45,0,69,73,44,0,70,74,44,0,70,74,44,0,70,74,44,0,72,75,44,0,73,77,44,0,74,77,43,0,74,78,43,0,74,78,43,0,76,79,43,0,77,79,43,0,79,81,43,0,79,81,42,0,79,81,42,0,80,82,42,0,82,83,42,0,83,84,42,0,84,85,42,0,84,85,42,0,85,85,41,0,86,86,41,0,88,88,41,0,89,89,41,0,89,89,41,0,91,89,41,0,91,90,40,0,93,91,40,0,95,92,40,0,96,93,40,0,96,93,40,0,98,95,40,0,98,95,39,0,100,95,39,0,101,97,39,0,101,97,39,0,103,98,39,0,105,99,39,0,106,100,38,0,107,101,38,0,107,101,38,0,109,102,38,0,111,103,38,0,112,103,37,0,114,104,37,0,114,104,37,0,115,106,37,0,117,107,37,0,119,108,37,0,120,109,36,0,121,110,36,0,121,110,36,0,123,111,36,0,125,112,36,0,126,112,35,0,128,114,35,0,128,114,35,0,129,115,35,0,131,116,35,0,133,117,35,0,134,118,34,0,134,118,34,0,136,119,34,0,138,120,34,0,139,121,34,0,140,122,33,0,140,122,33,0,142,123,33,0,144,125,33,0,146,126,33,0,147,126,32,0,149,128,32,0,149,128,32,0,150,129,32,0,152,130,32,0,153,131,31,0,156,132,31,0,156,132,31,0,158,133,31,0,160,134,31,0,161,135,30,0,163,136,30,0,163,136,30,0,164,137,30,0,166,138,30,0,168,139,29,0,169,140,29,0,169,140,29,0,171,141,29,0,173,143,29,0,174,143,28,0,176,145,28,0,178,146,28,0,178,146,28,0,180,147,28,0,181,148,27,0,183,149,27,0,185,150,27,0,185,150,27,0,186,151,27,0,188,152,26,0,189,153,26,0,191,154,26,0,191,154,26,0,192,156,26,0,194,156,25,0,196,157,25,0,197,158,25,0,197,158,25,0,200,160,25,0,202,160,24,0,203,161,25,0,204,162,25,0,206,164,25,0,206,164,25,0,208,165,25,0,209,165,24,0,211,166,24,0,212,168,25,0,212,168,25,0,214,169,25,0,215,169,24,0,217,170,24,0,219,171,25,0,219,171,25,0,220,172,25,0,221,174,24,0,222,175,24,0,224,175,25,0,224,175,25,0,226,176,25,0,227,177,24,0,228,178,24,0,229,179,25,0,230,180,25,0,230,180,25,0,232,180,24,0,233,181,24,0,235,182,25,0,236,183,25,0,236,183,25,0,236,184,24,0,238,185,24,0,239,186,24,0,240,186,24,0,240,186,24,0,241,187,24,0,243,188,24,0,244,189,25,0,245,190,25,0,245,190,25,0,246,191,24,0,247,191,25,0,248,192,25,0,248,193,25,0,249,194,25,0,249,194,25,0,250,194,25,0,251,195,26,0,252,196,26,0,253,197,26,0,253,197,26,0,254,199,26,0,254,199,27,0,255,199,27,0,255,201,28,0,255,201,28,0,255,202,28,0,255,204,29,0,255,205,31,0,255,206,32,0,255,206,32,0,255,208,32,0,255,208,33,0,255,209,35,0,255,211,36,0,255,212,38,0,255,212,38,0,255,213,38,0,255,214,40,0,255,215,41,0,255,216,42,0,255,216,42,0,255,218,43,0,255,219,45,0,255,220,46,0,255,221,48,0,255,221,48,0,255,222,50,0,255,222,51,0,255,223,53,0,255,224,55,0,255,224,55,0,255,225,57,0,255,225,59,0,255,226,60,0,255,227,62,0,255,228,64,0,255,228,64,0,255,229,66,0,255,230,68,0,255,230,69,0,255,231,71,0,255,231,71,0,255,232,73,0,255,233,76,0,255,233,78,0,255,234,79,0,255,234,79,0,255,235,81,0,255,235,83,0,255,236,86,0,255,237,88,0,255,237,88,0,255,236,89,0,255,237,91,0,255,237,94,0,255,238,96,0,255,238,98,0,255,238,98,0,255,239,99,0,255,239,101,0,255,240,104,0,255,240,106,0,255,240,106,0,255,241,108,0,255,241,110,0,255,242,111,0,255,242,113,0,255,242,113,0,255,243,116,0,255,243,118,0,255,244,120,0,255,244,122,0,255,244,122,0,255,245,124,0,255,245,126,0,255,245,128,0,255,246,129,0],[223,145,187,0,223,143,184,0,223,142,182,0,224,141,180,0,225,139,177,0,225,139,177,0,226,138,175,0,227,137,172,0,227,135,169,0,228,134,167,0,228,134,167,0,229,132,164,0,230,131,161,0,230,129,158,0,232,128,156,0,232,128,156,0,232,126,153,0,233,125,150,0,234,123,147,0,235,122,144,0,235,122,144,0,236,120,141,0,237,119,139,0,238,117,135,0,239,116,133,0,240,114,129,0,240,114,129,0,241,112,126,0,242,111,124,0,243,109,121,0,244,108,118,0,244,108,118,0,245,106,115,0,246,104,112,0,247,103,110,0,248,101,107,0,248,101,107,0,249,99,104,0,249,98,102,0,251,96,99,0,251,95,97,0,251,95,97,0,252,93,95,0,253,91,92,0,254,90,91,0,254,88,88,0,255,86,86,0,255,86,86,0,255,85,84,0,255,85,84,0,255,84,83,0,255,84,83,0,255,84,83,0,255,84,82,0,255,84,82,0,255,84,81,0,255,84,81,0,255,84,81,0,255,83,80,0,255,82,79,0,255,83,79,0,255,82,78,0,255,82,78,0,255,83,78,0,255,83,77,0,255,83,78,0,255,82,77,0,255,83,77,0,255,83,77,0,255,82,76,0,255,82,75,0,255,82,75,0,255,82,75,0,255,82,75,0,255,82,75,0,255,82,75,0,255,82,75,0,255,82,75,0,255,82,75,0,255,82,75,0,255,82,74,0,255,82,74,0,255,82,74,0,255,82,74,0,255,82,74,0,255,83,74,0,255,82,74,0,255,82,74,0,255,82,73,0,255,82,73,0,255,83,74,0,255,83,74,0,255,84,74,0,255,83,74,0,255,83,74,0,255,83,74,0,255,83,74,0,255,83,74,0,255,84,75,0,255,84,75,0,255,84,74,0,255,84,75,0,255,84,74,0,255,84,75,0,255,84,75,0,255,84,75,0,255,85,76,0,255,85,76,0,255,86,76,0,255,86,76,0,255,86,76,0,255,86,77,0,255,86,77,0,255,86,77,0,255,87,78,0,255,87,78,0,255,87,78,0,255,88,78,0,255,88,78,0,255,88,79,0,255,88,79,0,255,88,79,0,255,88,81,0,255,88,80,0,255,89,81,0,255,89,81,0,255,89,81,0,255,90,82,0,255,90,82,0,255,91,83,0,255,91,84,0,255,91,84,0,255,92,84,0,255,92,84,0,255,92,85,0,255,93,85,0,255,93,85,0,255,94,87,0,255,94,87,0,255,95,88,0,255,95,88,0,255,95,88,0,255,96,88,0,255,96,89,0,255,97,90,0,255,97,90,0,255,97,90,0,255,98,91,0,255,98,92,0,255,99,93,0,255,99,93,0,255,100,95,0,255,100,95,0,255,100,95,0,255,101,95,0,255,101,96,0,255,102,97,0,255,102,97,0,255,102,97,0,255,103,98,0,255,103,98,0,255,104,100,0,255,104,100,0,255,105,100,0,255,105,101,0,255,106,101,0,255,106,103,0,255,106,103,0,255,107,103,0,255,108,104,0,255,108,104,0,255,109,106,0,255,109,106,0,255,109,106,0,255,110,107,0,255,110,107,0,255,111,109,0,255,112,110,0,255,112,110,0,255,112,110,0,255,113,111,0,255,113,112,0,255,114,113,0,255,114,113,0,255,114,113,0,255,116,114,0,255,116,115,0,255,117,115,0,255,117,115,0,255,118,117,0,255,118,117,0,255,119,118,0,255,120,119,0,255,121,120,0,255,121,120,0,255,121,120,0,255,122,121,0,255,122,121,0,255,123,123,0,255,123,123,0,255,124,124,0,255,124,124,0,255,125,125,0,255,126,126,0,255,126,126,0,255,126,126,0,255,127,127,0,255,128,128,0,255,130,130,0,255,130,130,0,255,131,131,0,255,133,133,0,255,135,135,0,255,136,136,0,255,138,138,0,255,138,138,0,255,140,140,0,255,142,142,0,255,144,144,0,255,146,146,0,255,146,146,0,255,148,148,0,255,150,150,0,255,152,152,0,255,154,154,0,255,154,154,0,255,157,157,0,255,159,159,0,255,161,161,0,255,163,163,0,255,163,163,0,255,166,166,0,255,168,168,0,255,170,170,0,255,172,172,0,255,175,175,0,255,175,175,0,255,177,177,0,255,179,179,0,255,182,182,0,255,184,184,0,255,184,184,0,255,187,187,0,255,188,188,0,255,191,191,0,255,193,193,0,255,193,193,0,255,196,196,0,255,199,199,0,255,202,202,0,255,204,204,0,255,204,204,0,255,206,206,0,255,208,208,0,255,210,210,0,255,213,213,0]],createCanvas:function(){var Y=document.createElement("canvas");Y.id="heatmapcanvas";Y.style.position="absolute";Y.style.top="0px";Y.style.left="0px";this.canvasWidth=Y.width=this.width;this.canvasHeight=Y.height=this.height;Y.style.zIndex=this.originalzIndex;if(!!this.div_){this.div_.appendChild(Y);this.canvas=Y;}},drawDensity:function N(){if(!this.hasMapBoundsChanged()){return ;}this.bounds=this.getBounds();if(this.canvas){this.clearDensity();}else{this.createCanvas();}this.cleanLocationMap();this.createDensity();},getThemeUrl:function T(){var Y;switch(this.themeId){case 5:Y="../style/images/heatmap5.png";break;case 4:Y="../style/images/heatmap4.png";break;case 3:Y="../style/images/heatmap3.png";break;case 2:Y="../style/images/heatmap2.png";break;default:Y="../style/images/heatmap1.png";}return Y;},getThemeFromPreset:function W(){switch(this.themeId){case 5:this.themeData=this.presetThemeData[4];break;case 4:this.themeData=this.presetThemeData[3];break;case 3:this.themeData=this.presetThemeData[2];break;case 2:this.themeData=this.presetThemeData[1];break;default:this.themeData=this.presetThemeData[0];}},createThemeColourGradient:function P(Z){if(Z){var a=this;var Y=new Image();Y.onload=function(){a.drawTheme(this);Y.onload=null;};Y.src=Z;}return null;},dumpThemeColor:function R(){var Z=""+this.themeId+":";if(this.themeData){var Y=this.themeData.length;for(var a=0;a<Y;a++){Z+=this.themeData[a];if(a!=Y-1){Z+=",";}}}console.log(Z);},drawTheme:function A(e){var c=document.createElement("canvas");var b=c.getContext("2d");c.width=e.width;c.height=e.height;b.drawImage(e,0,0,e.width,e.height);var f=b.getImageData(0,3,e.width,1).data;var Y=b.getImageData(0,0,256,1).data,d;for(d=0;d<Y.length;){var Z=Math.floor(e.width*(0.1+0.8*d/1020))*4;Y[d]=f[Z];Y[d+1]=f[Z+1];Y[d+2]=f[Z+2];d+=4;}this.themeData=Y;this.dumpThemeColor();this.cleanLocationMap();this.createDensity();},createColourGradient:function J(){if(!this.themeData){this.getThemeFromPreset();}return this.themeData;},createDefaultColourGradient:function O(){var Z=document.createElement("canvas").getContext("2d");var Y=Z.createLinearGradient(0,0,256,0);Y.addColorStop(0,"magenta");Y.addColorStop(0.25,"blue");Y.addColorStop(0.5,"green");Y.addColorStop(0.75,"yellow");Y.addColorStop(1,"red");Z.fillStyle=Y;Z.fillRect(0,0,256,1);return Z.getImageData(0,0,256,1).data;},clearDensity:function C(){if(!this._canDraw()){return ;}var Y=this.canvas.getContext("2d");Y.clearRect(0,0,this.canvasWidth,this.canvasHeight);},_canDraw:function(){return(this._map&&this.canvas&&this.canvas.getContext("2d"))?true:false;},zeroLayer:function B(Y){this.div_.style.left=Math.floor(Y.x)+"px";this.div_.style.top=Math.floor(Y.y)+"px";},cleanLocationMap:function Q(){this.locationMap={};},addToLocationMap:function M(Z,b,a){var Y=Math.ceil(b);var c=Math.ceil(a);if(!this.locationMap[Y]){this.locationMap[Y]={};}if(!this.locationMap[Y][c]){this.locationMap[Y][c]=[];}this.locationMap[Y][c].push(Z);},createDensity:function X(){var s=this.locations;if(!s||!this.map||!this.canvas){return ;}var c=10;var d=0.25;var g=2*c;var t=this.getTopLeft();if(t){this.zeroLayer(t);}this.canvasWidth=this.canvas.width=this.getDrawingLayerWidth();this.canvasHeight=this.canvas.height=this.height;var Y=this.createColourGradient();if(!Y){return ;}var Z=this.canvas.getContext("2d");var e=0,l;for(var n=0;n<s.length;n++){var m=s[n];var o=this.getScreenPointForLocation(m.position);if(!o||isNaN(o.x)||isNaN(o.y)){continue;}var h=o.x;var f=o.y;this.addToLocationMap(m,h,f);h=this.zeroX(h,t);f=this.zeroY(f,t);l=Z.createRadialGradient(h,f,0,h,f,c);l.addColorStop(0,"rgba(0, 0, 0, 0.10)");l.addColorStop(1,"transparent");Z.fillStyle=l;Z.fillRect(h-c,f-c,g,g);}var q=Z.getImageData(0,0,this.canvasWidth,this.canvasHeight);var b=q.data;for(var k=0;k<b.length;){var r=b[k+3]*4;b[k]=Y[r];b[k+1]=Y[r+1];b[k+2]=Y[r+2];b[k+3]=Math.min(255,b[k+3]*5);k+=4;}Z.putImageData(q,0,0);Z.fillRect(0,0,this.canvasWidth,this.canvasHeight);},getAttrsFromLocationMap:function U(a,Z){var Y=a-this.xOffset;var b=Z-this.yOffset;if(this.locationMap[Y]&&this.locationMap[Y][b]){return this.locationMap[Y][b];}return[];},getAttrsFromLocationMapRange:function L(Y,d,Z){var b=[];for(var c=Y-Z;c<Y+Z;c++){for(var a=d-Z;a<d+Z;a++){b=b.concat(this.getAttrsFromLocationMap(c,a));}}return b;},positionCanvas:function D(Y){if(!this.canvas){return ;}this.canvas.style.left=parseInt(Y.x)+"px";this.canvas.style.top=parseInt(Y.y)+"px";},getBounds:function G(){return null;},getTopLeft:function V(){return null;},getScreenPointForLocation:function S(Y){return null;},hasMapBoundsChanged:function F(){return true;},zeroX:function I(Y,Z){return Y;},zeroY:function H(Z,Y){return Z;},getDrawingLayerWidth:function K(){return this.width;}};})();mstrmojo.chart.model.enums.EnumDSSGraphObject={DssGraphNull:-3,DssGraphBackground:1,DssGraphFrame:2,DssGraphFootnote:3,DssGraphSubtitle:4,DssGraphTitle:5,DssGraphLegendArea:6,DssGraphLegendLine:7,DssGraphLegendMarker:8,DssGraphLegendText:9,DssGraphCurve:257,DssGraphDataLine:258,DssGraphDataMarker:259,DssGraphDataText:260,DssGraphDivBiPolar:261,DssGraphErrorBar:262,DssGraphLinrExp:263,DssGraphLinrLine:264,DssGraphLinrLog:265,DssGraphLinrNatLog:266,DssGraphLinrNPoly:267,DssGraphLinrText:268,DssGraphMeanLine:269,DssGraphMovAvgLine:270,DssGraphO1Body:271,DssGraph2DO1Label:272,DssGraphO1Major:273,DssGraphO1Minor:274,DssGraphO1Super:275,DssGraphO1Title:276,DssGraphO2Body:277,DssGraph2DO2Label:278,DssGraphO2Major:279,DssGraphO2Minor:280,DssGraphO2Title:281,DssGraphConnectDataLine:282,DssGraphRiser:286,DssGraphRiserShadow:287,DssGraphStdDevLine:288,DssGraphX1Body:289,DssGraphX1Label:290,DssGraphX1Major:291,DssGraphX1Minor:292,DssGraphXTitle:293,DssGraphY1Body:295,DssGraphY1Label:296,DssGraphY1Major:297,DssGraphY1Minor:298,DssGraphY1Title:299,DssGraphY2Body:301,DssGraphY2Label:302,DssGraphY2Major:303,DssGraphY2Minor:304,DssGraphY2Title:305,DssGraph3DShowColumnHeaders:318,DssGraph3DShowLeftHeaders:321,DssGraph3DShowRightHeaders:323,DssGraph3DShowRowHeaders:325,DssGraphOBPBox:329,DssGraphOBPMedian:330,DssGraphOBPStem:331,DssGraphOBPTail:332,DssGraphPieFeelerLine:337,DssGraphPieFeelerLabel:338,DssGraphPieGroupLabel:339,DssGraphPieRingLabel:340,DssGraphPieSlice:341,DssGraphSeriesTitle:398,DssGraphConnectStackLine:399,DssGraphDataTextStackTotal:401,DssGraphOPILBLValue:418,DssGraphUserLine1:414,DssGraphUserLine2:415,DssGraphUserLine3:416,DssGraphUserLine4:417,DssGraphDataTextConnectLine:431,DssGraphGauge:444,DssGraphGaugeTitle:450,DssGraphGaugeRange:451,DssGraphY3Body:477,DssGraphY3Label:478,DssGraphY3Major:479,DssGraphY3Minor:480,DssGraphY4Body:483,DssGraphY4Label:484,DssGraphY4Major:485,DssGraphY4Minor:486,DssGraph3DColHeader:512,DssGraph3DColTitle:515,DssGraph3DDataText:518,DssGraph3DRowHeader:552,DssGraph3DRowTitle:555,DssGraph3DRYHeader:558,DssGraph3DRYTitle:561,DssGraphGaugeBorder:1319,DssGraphGaugeNeedleBase:1320,DssGraphGaugeNeedleBaseLine:1330,DssGraphZBody:10003,DssGraphTrendLine:10004,DssGraphY1RightBody:10005,DssGraphY1RightTitle:10006,DssGraphReferenceLine:10007,DssGraphStraightLine:10008,DssGraphTargetLine:10009,DssGraphRefLineText:10010,DssGraphTrendLineText:10011,DssGraphUserLabel1:100100,DssGraphUserLabel2:100101,DssGraphUserLabel3:100102,DssGraphUserLabel4:100103,DssGraphX2Body:100200,DssGraphX2Label:100201,DssGraphX2Major:100202,DssGraphX2Minor:100203,DssGraphX2Title:100204};(function(){function AI(Ao,Ap){return Ap||(Ao||window).event;}mstrmojo.PositionType=null;var Al=!!document.all,AG=document.documentMode,r=navigator.userAgent,k=false,g=false,e=false,d=false,R=false,t=false;if(Al){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){k=!!r.match(/MSIE 6/);g=((!!r.match(/MSIE 7/)&&!AG)||AG===7);e=(AG===8);d=(AG===9);R=(AG===10);t=(!AG||AG<=9);}else{k=!!r.match(/MSIE 6/);g=!!r.match(/MSIE 7/);e=!!r.match(/MSIE 8/);d=!!r.match(/MSIE 9/);R=!!r.match(/MSIE 10/);t=!R;}}var c=!Al&&!!r.match(/Firefox/),m=0,s=!!r.match(/Android/),Ac=!!r.match(/iPad/),AM=!!r.match(/iPhone/),AU=!!document.createTouch||s,q=!!r.match(/PlayBook/),O=!!r.match(/Windows Phone/),Am=!Al&&!!r.match(/Trident.*rv/),b=c?"-moz-":(Al||Am)?"":"-webkit-",AH=c?"Moz":(R||Am)?"":Al?"ms":"webkit",AR=((R||Am)?"t":"T"),AL=AH+AR+"ransition";function Ag(){return AH+AR+"ransform";}function AE(){return AL+"Property";}function S(){return AL+"Duration";}function N(){return(R||c)?"transitionend":"webkitTransitionEnd";}function f(){return AH+"BoxShadow";}var Aj=Ag(),AZ=AE(),z=S(),A=N(),o=f();function AQ(){if(!m&&c){var Ao=r.match(/.*Firefox\/([\d|\.]*).*/);if(Ao){m=parseFloat(Ao[1]);}}return m;}function AW(){var Ap=0,At=0,Aq=window,Ar=document,Ao=Ar.body,As=Ar.documentElement;if(typeof Aq.pageYOffset==="number"){At=Aq.pageYOffset;Ap=Aq.pageXOffset;}else{if(Ao&&(Ao.scrollLeft||Ao.scrollTop)){At=Ao.scrollTop;Ap=Ao.scrollLeft;}else{if(As&&(As.scrollLeft||As.scrollTop)){At=As.scrollTop;Ap=As.scrollLeft;}}}return{x:Ap,y:At};}function AF(Ao){Ao=Ao||0;Ao=String(Ao);return((Ao.indexOf("%",0))!==-1)?Ao:(Ao+"px");}function AO(Aq,Au,At,As,Ar){if(!mstrmojo.dom.isWinPhone){As=(As||false||this.isHWAccelerated);}else{As=false;}var Ap=Ar+(As?"3d":"")+"(",Ao=As?(","+At+")"):")";return Ap+Aq+","+Au+Ao;}var Aa=2,V=3;function u(Au,At,Ax){var Aw=Au.style,Aq=Aw.display,As=this.windowDim(),Ar=AW();Aw.display="block";var Av=As.w-Au.clientWidth,Ay=Math.max(As.h-Au.clientHeight,0),Ao={4:0,5:Av,3:Av/2},Ap={1:0,3:Ay/2,2:Ay};Aw.left=Ao[At]+Ar.x+"px";Aw.top=Ap[Ax]+Ar.y+"px";Aw.display=Aq;}function n(Ar,Aq,As,Ao){if(Ar.addEventListener){return Ar.addEventListener(Aq,As,!!Ao);}As._id=As._id||n.guid++;Ar.events=Ar.events||{};var Ap=Ar.events[Aq];if(!Ap){Ap=Ar.events[Aq]={};if(Ar["on"+Aq]){Ap[0]=Ar["on"+Aq];}}Ap[As._id]=As;function At(Aw){Aw=Aw||window.event;var Av=this.events[Aw.type],Au;for(Au in Av){Av[Au].call(this,Aw);}}Ar["on"+Aq]=At;}n.guid=1;function h(Aq,Ap,Ar,Ao){if(!Aq){return ;}if(Aq.removeEventListener){Aq.removeEventListener(Ap,Ar,!!Ao);}else{if(Aq.events&&Aq.events[Ap]){delete Aq.events[Ap][Ar._id];}}}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:r,isIE:Al,isIE6:k,isIE7:g,isIE8:e,isIE9:d,isIE10:R,isIEW3C:Am,isNSIE:t,isDXIE:t,isFF:c,isWK:!!r.match(/AppleWebKit/),isSafari:!!r.match(/Safari/)&&!r.match(/Chrome/),isChrome:!!r.match(/AppleWebKit/)&&r.match(/Chrome/),isHWAccelerated:!s,isAndroid:s,isIPad:Ac,isPlayBook:q,isWinPhone:O,isMobile:Ac||AM||O||s,supportsTouches:AU,TOUCHSTART:AU?"touchstart":"mousedown",TOUCHMOVE:AU?"touchmove":"mousemove",TOUCHEND:AU?"touchend":"mouseup",TOUCHCANCEL:AU?"touchcancel":"",RESIZE:AU?"orientationchange":"resize",CSS3_PREFIX:b,CSS3_BOXSHADOW:o,CSS3_TRANSFORM:Aj,CSS3_TRANSITION:AL,CSS3_TRANSITION_PROPERTY:AZ,CSS3_TRANSITION_DURATION:z,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},htmlFeatures:{FILE_READER:"fr"},MOUSE_BUTTON:{LEFT:1,RIGHT:2},supports:function B(Ao){var Ap=this.isFF&&AQ();switch(Ao){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||Ap>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||Ap>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);case this.htmlFeatures.FILE_READER:return !!(window.FileReader);}return false;},getOSInfo:function AN(){var At="Unknown",Ap=navigator.appVersion,As=navigator.userAgent,Ar=At;var Ao=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];var Aq;for(Aq=0;Aq<Ao.length;Aq++){var Av=Ao[Aq];if(Av.r.test(As)){Ar=Av.s;break;}}var Au=At;if(/Windows/.test(Ar)){Au=/Windows (.*)/.exec(Ar)[1];Ar="Windows";}switch(Ar){case"Mac OS X":Au=/Mac OS X (10[\.\_\d]+)/.exec(As)[1];break;case"Android":Au=/Android ([\.\_\d]+)/.exec(As)[1];break;case"iOS":Au=/OS (\d+)_(\d+)_?(\d+)?/.exec(Ap);Au=Au[1]+"."+Au[2]+"."+(Au[3]|0);break;}return{name:Ar,version:Au};},transEndEvtNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},replace:function p(Aq,Ao){if(Aq&&Ao){var Ap=Aq.parentNode;if(Ap){Ap.replaceChild(Ao,Aq);}}return Ao;},attachEvent:function X(Aq,Ap,Ar,Ao){if(Aq.addEventListener){return Aq.addEventListener(Ap,Ar,!!Ao);}return Aq.attachEvent("on"+Ap,Ar);},detachEvent:function AY(Aq,Ap,Ar,Ao){if(!Aq){return ;}if(Aq.removeEventListener){Aq.removeEventListener(Ap,Ar,!!Ao);}else{Aq.detachEvent("on"+Ap,Ar);}},attachMarkupEvent:function x(Ar,Aq,Ao){var Ap=function(As){mstrmojo.all[Ar].captureDomEvent(Ao,window,As);};this.attachEvent(Aq,Ao,Ap);return Ap;},attachOneTimeEvent:function W(Ar,Ap,As,Ao){var Aq=function(At){As(At);if(Ao){h(this,Ap,Aq);}else{mstrmojo.dom.detachEvent(this,Ap,Aq);}};if(Ao){n(Ar,Ap,Aq);}else{this.attachEvent(Ar,Ap,Aq);}Ar=null;return Aq;},attachMouseMoveEvents:function D(Ar,Ao){var Aq=this,Ap=function(As){if(Ao){Ao(As);}Aq.detachEvent(document,"mousemove",Ar);Aq.detachEvent(document,"mouseup",Ap);};Aq.attachEvent(document,"mousemove",Ar);Aq.attachEvent(document,"mouseup",Ap);},captureDomEvent:function AK(At,Ar,Ap,As,Aq){var Ao=mstrmojo.all[At];if(Ao){Ao.captureDomEvent(Ar,Ap,As,Aq);}},translate:function L(Aq,Ap,At,As,Ao,Ar){Ao=(Ao&&" "+Ao)||"";Aq.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(Ap,At,As,Ar)+Ao;},createTranslateString:function P(Ao,Ar,Aq,Ap){Ao=AF(Ao);Ar=AF(Ar);Aq=AF(Aq);return AO(Ao,Ar,Aq,Ap,"translate");},createScaleString:function w(Ao,Ar,Aq,Ap){Ao=Ao||0;Ar=Ar||0;Aq=Aq||0;return AO(Ao,Ar,Aq,Ap,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function C(Aq,Ao,Ar,At){var Ap=Aq.id+"-"+Ao,As=this._bufferConnects[Ap];if(!As){As=this._bufferConnects[Ap]={elId:Aq.id,eventName:Ao,timer:null,bufferSize:At,listeners:[],callback:function(Au){mstrmojo.dom._callback(Au,mstrmojo.global,Ap);return true;}};this.attachEvent(Aq,Ao,As.callback);}As.listeners.push(Ar);},_callback:function Af(As,Ao,Aq){var Ar=this._bufferConnects[Aq],At=Ar&&Ar.timer;if(Ar&&!At){var Ap=(Ar.bufferSize===null)?this._bufferSize:Ar.bufferSize;if(Ar.bufferSize){Ar.timer=Ao.setTimeout(function(){mstrmojo.dom.updateBuffers(Aq);},Ap);}else{mstrmojo.dom.updateBuffers(Aq);}}},updateBuffers:function H(Ar){var As=this._bufferConnects[Ar],Ap=As&&As.listeners,Ao=(Ap&&Ap.length)||0,Aq;for(Aq=0;Aq<Ao;Aq++){Ap[Aq]();}if(As&&As.timer){delete As.timer;}},detachBufferedEvent:function AC(Ap,At,Au){if(!Ap){return ;}var Aw=Ap.id+"-"+At,Aq=this._bufferConnects[Aw],As=Aq&&Aq.listeners,Av=(As&&As.length)||0,Ar;if(Av){for(Ar=Av-1;Ar>-1;Ar--){if(As[Ar]===Au){As.splice(Ar,1);}}if(!As.length){this.detachEvent(Ap,At,Aq.callback);delete this._bufferConnects[Aw];if(Aq.timer){var Ao=mstrmojo.global;Ao.clearTimeout(Aq.timer);}}}},eventTarget:function AA(Ao,Ap){Ap=AI(Ao,Ap);return Ap.target||Ap.srcElement;},isMac:function y(){return this.getOSInfo().name.toLowerCase().indexOf("mac")>=0;},isMetaKey:function J(Ao,Ar){var Aq=this.getOSInfo().name.toLowerCase().indexOf("mac")>=0,Ap=AI(Ao,Ar)||{};return(Ap.ctrlKey&&!Aq)||(Ap.metaKey&&Aq);},ctrlKey:function Ai(Ao,Ap){return(AI(Ao,Ap)||{}).ctrlKey;},shiftKey:function AB(Ao,Ap){return(AI(Ao,Ap)||{}).shiftKey;},metaKey:function Z(Ao,Ap){return(AI(Ao,Ap)||{}).metaKey;},getButton:function AS(Ao,Ap){return((Number(AI(Ao,Ap).button))===2)?2:1;},isPrimaryMouseBtn:function Ad(Ap,Ao){return this.getButton(Ao||window,Ap)===1;},getMousePosition:function l(Ar,Aq){Aq=Aq||window;var Ap,Au;if(mstrmojo.dom.isIE){Ar=Ar||Aq.event;var As=document,Ao=As.body,At=As.documentElement;Ap=Ar.clientX+Ao.scrollLeft+(At.scrollLeft||0);Au=Ar.clientY+Ao.scrollTop+(At.scrollTop||0);}else{Ap=Ar.pageX;Au=Ar.pageY;}return{x:Ap,y:Au};},position:function AT(Ap,Aq){var At={x:0,y:0,w:0,h:0};if(Ap&&Ap.getBoundingClientRect){try{At=Ap.getBoundingClientRect();}catch(As){At={left:0,top:0,right:0,bottom:0,height:0,width:0};}At={x:At.left,y:At.top,w:At.right-At.left,h:At.bottom-At.top};if(this.isIE6||this.isIE7){var Ao=Ap.ownerDocument;if(Ao){var Av=Ao.documentElement,Au=Av.getBoundingClientRect();At.x-=Au.left;At.y-=Au.top;}}}if(Aq){var Ar=AW();At.x+=Ar.x;At.y+=Ar.y;}return At;},delta:function F(Aq,Ao){Ao=Ao||document.body;var Ap=this.position(Aq),Ar=this.position(Ao);return{x:Math.round(Ap.x-Ar.x),y:Math.round(Ap.y-Ar.y)};},windowDim:function Q(){var Ao=0,Aq=0,Ar=window,As=document,At=As.documentElement,Ap=As.body;if(typeof (Ar.innerWidth)=="number"&&typeof (Ar.innerHeight)=="number"){Ao=Ar.innerWidth;Aq=Ar.innerHeight;}else{if(At&&(At.clientWidth||At.clientHeight)){Ao=At.clientWidth;Aq=At.clientHeight;}else{if(Ap&&(Ap.clientWidth||Ap.clientHeight)){Ao=Ap.clientWidth;Aq=Ap.clientHeight;}}}return{w:Ao,h:Aq};},center:function AJ(Ao){u.call(this,Ao,V,V);},bottomCenter:function E(Ao){u.call(this,Ao,V,Aa);},clearBrowserHighlights:function K(Ao){Ao=Ao||self;if(!Ao.getSelection){var Au=Ao.document,At=Au&&Au.selection,Ar=At&&At.empty;if(Ar){try{At.empty();}catch(Aq){}}}else{var Ap=Ao.getSelection,As=Ap&&Ao.getSelection();if(As&&!As.isCollapsed){if(As.empty){As.empty();}else{if(As.removeAllRanges){As.removeAllRanges();}}}}},findAncestorByAttr:function AP(As,Aq,Ap,Ao){var At=Ap?As:As&&As.parentNode;while(At&&(At!==Ao)){var Ar=At.getAttribute&&At.getAttribute(Aq);if(Ar!=null){return{node:At,value:Ar};}At=At.parentNode;}return null;},findAncestorByName:function Ah(Aq,At,Ap,Ao){At=At&&At.toLowerCase();var Ar=Ap?Aq:Aq&&Aq.parentNode;while(Ar&&(Ar!==Ao)){var As=Ar.nodeName;if(As&&(As.toLowerCase()===At)){return Ar;}Ar=Ar.parentNode;}return null;},contains:function I(Ar,As,Ap,Ao){var Aq=As;if(!Ap){Aq=Aq.parentNode;}while(Aq){if(Aq===Ar){return true;}if(Aq===Ao){break;}Aq=Aq.parentNode;}return false;},toggleSelection:function An(Ap,Ao){Ap.setAttribute("unselectable",Ao?"off":"on");mstrmojo.css.toggleClass(Ap,"unselectable",!Ao);Ap.onselectstart=function(){return Ao;};if(!Ao){this.clearBrowserHighlights();}},preventDefault:function U(Ao,Ap){Ap=Ap||Ao.event;if(Ap.preventDefault){Ap.preventDefault();}else{Ap.returnValue=false;}},stopPropogation:function M(Ao,Ap){Ap=Ap||Ao.event;if(Ap.stopPropagation){Ap.stopPropagation();}else{Ap.cancelBubble=true;}},firstTouch:function AV(Ao,Ap){return Ap&&Ap.touches&&Ap.touches.length?Ap.touches[0]:(Ap||Ao.event);},firstChangedTouch:function Ab(Ao,Ap){return Ap&&Ap.changedTouches&&Ap.changedTouches.length?Ap.changedTouches[0]:(Ap||Ao.event);},isLandscape:function T(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function AX(Ao){while(Ao){var Ap=Ao.mstrmojoId;if(Ap!==null&&Ap!==undefined){return mstrmojo.all[Ap];}Ao=Ao.parentNode;}return null;},setCaret:function G(Ao,Aq){if(Ao.setSelectionRange){Ao.focus();Ao.setSelectionRange(Aq,Aq);}else{if(Ao.createTextRange){var Ap=Ao.createTextRange();Ap.move("character",Aq);Ap.select();}}},setInputSelection:function Y(Ao){if(Ao.select){Ao.focus();Ao.select();}else{if(Ao.createTextRange){Ao.createTextRange().select();}}},setElementSelection:function a(Aq){if(window.getSelection){var Ao=document.createRange(),Ap=window.getSelection();Ao.selectNodeContents(Aq);Ap.removeAllRanges();Ap.addRange(Ao);}else{if(document.body.createTextRange){var Ar=document.body.createTextRange();Ar.moveToElementText(Aq);Ar.select();}}},getHorizontalScroll:function Ak(){return AW().x;},getVerticalScroll:function AD(){return AW().y;},removeNode:function Ae(Aq){var Ap=document.getElementById(Aq),Ao=Ap&&Ap.parentNode;if(Ao){return Ao.removeChild(Ap);}}});}());(function(){function D(K){var J=this.h.idx;if(J!==-1){return this.t.es[J][K];}return"";}mstrmojo.models.template.Header=mstrmojo.declare(null,null,{init:function H(J){this.h=J.h;this.t=J.t;},getName:function A(){return D.call(this,"n");},getElementId:function I(){return D.call(this,"id");},getObjectId:function B(){return D.call(this,"oid");},getElementIndex:function G(){return this.h.idx;},getActionType:function F(){return this.h.at;},isTotal:function E(){return this.h.otr===1;},getFormIndex:function C(){return this.h.fi;}});}());mstrmojo.vi.viz.EnumVisualizationTemplates={UNKNOWN_GRAPHMATRIX_TYPE:-1,GRID:0,HEATMAP:1,GOOGLEMAP:2,PIE:3,RING:4,GRAPHMATRIXVERTICALBARSTACKED:6,GRAPHMATRIXVERTICALBARCLUSTERED:7,GRAPHMATRIXVERTICALBARPERCENT:8,GRAPHMATRIXHORIZONTALBARSTACKED:9,GRAPHMATRIXHORIZONTALBARCLUSTERED:10,GRAPHMATRIXHORIZONTALBARPERCENT:11,GRAPHMATRIXVERTICALLINESTACKED:12,GRAPHMATRIXVERTICALLINECLUSTERED:13,GRAPHMATRIXVERTICALLINEPERCENT:14,GRAPHMATRIXHORIZONTALLINESTACKED:15,GRAPHMATRIXHORIZONTALLINECLUSTERED:16,GRAPHMATRIXHORIZONTALLINEPERCENT:17,GRAPHMATRIXSCATTERCIRCLEMM:18,GRAPHMATRIXSCATTERGRIDCIRCLEAA:19,GRAPHMATRIXBUBBLECIRCLEMM:21,GRAPHMATRIXBUBBLEGRIDCIRCLEAA:22,GRAPHMATRIXSCATTERSQUAREAM:23,GRAPHMATRIXSCATTERSQUAREMM:24,GRAPHMATRIXSCATTERGRIDSQUAREAA:25,GRAPHMATRIXBUBBLESQUAREAM:26,GRAPHMATRIXBUBBLESQUAREMM:27,GRAPHMATRIXBUBBLEGRIDSQUAREAA:28,GRAPHHORIZONTALBARCLUSTERED:29,GRAPHMATRIXVERTICALAREASTACKED:30,GRAPHMATRIXVERTICALAREAPERCENT:31,GRAPHMATRIXVERTICALAREACLUSTERED:32,GRAPHMATRIXHORIZONTALAREASTACKED:40,GRAPHMATRIXHORIZONTALAREAPERCENT:41,GRAPHMATRIXHORIZONTALAREACLUSTERED:42,GRAPHHORIZONTALBARDUALAXISCLUSTERED:33,GRAPHHORIZONTALBARDUALAXISABSOLUTE:34,GRAPHHORIZONTALLINEABSOLUTE:35,GRAPHHORIZONTALLINEDUALAXISABSOLUTE:36,GRAPHHORIZONTALAREAABSOLUTE:37,GRAPHHORIZONTALAREADUALAXISABSOLUTE:38,GRAPHVERTICALBARCLUSTERED:39,GRAPHVERTICALBARDUALAXISCLUSTERED:43,GRAPHVERTICALBARDUALAXISABSOLUTE:44,GRAPHVERTICALBARDUALAXISSTACKED:45,GRAPHVERTICALLINEABSOLUTE:46,GRAPHVERTICALLINESTACKED:47,GRAPHVERTICALLINEPERCENT:48,GRAPHVERTICALLINEDUALAXISABSOLUTE:49,GRAPHVERTICALLINEDUALAXISSTACKED:50,GRAPHVERTICALAREAABSOLUTE:51,GRAPHVERTICALAREAPERCENT:52,GRAPHVERTICALAREASTACKED:53,GRAPHVERTICALAREADUALAXISABSOLUTE:54,GRAPHVERTICALAREADUALAXISSTACKED:55,GRAPHCOMBINATIONBARAREA:56,GRAPHCOMBINATIONBARAREADUALAXIS:57,NETWORK:58,IMAGELAYOUT:59,GOOGLEMAPDENSITY:60,GRAPHMATRIXPIE:61,GRAPHMATRIXRING:62,GRAPHHORIZONTALBARABSOLUTE:63,GRAPHHORIZONTALBARPERCENT:64,GRAPHHORIZONTALBARSTACKED:65,GRAPHVERTICALBARABSOLUTE:66,GRAPHVERTICALBARPERCENT:67,GRAPHVERTICALBARSTACKED:68,ESRIMAP:69,GRAPHMATRIXVERTICALBARAUTOMATIC:70,GRAPHMATRIXHORIZONTALBARAUTOMATIC:71,GRAPHMATRIXVERTICALLINEAUTOMATIC:72,GRAPHMATRIXHORIZONTALLINEAUTOMATIC:73,GRAPHMATRIXVERTICALAREAAUTOMATIC:74,GRAPHMATRIXHORIZONTALAREAAUTOMATIC:75};mstrmojo.chart.model.enums.EnumDSSObjectType={DssTypeUnknown:-1,DssTypeReserved:0,DssTypeGeneric:5,DssTypeFormatBAD:46,DssTypeFilter:1,DssTypeTemplate:2,DssTypeReportDefinition:3,DssTypeMetric:4,DssTypeStyle:6,DssTypeAggMetric:7,DssTypeFolder:8,DssTypeDevice:9,DssTypePrompt:10,DssTypeFunction:11,DssTypeAttribute:12,DssTypeFact:13,DssTypeDimension:14,DssTypeTable:15,DssTypeDatamartReport:16,DssTypeFactGroup:17,DssTypeShortcut:18,DssTypeResolution:19,DssTypeMonitor:20,DssTypeAttributeForm:21,DssTypeSchema:22,DssTypeFormat:23,DssTypeCatalog:24,DssTypeCatalogDefn:25,DssTypeColumn:26,DssTypePropertyGroup:27,DssTypePropertySet:28,DssTypeDBRole:29,DssTypeDBLogin:30,DssTypeDBConnection:31,DssTypeProject:32,DssTypeServerDef:33,DssTypeUser:34,DssTypeTransmitter:35,DssTypeConfiguration:36,DssTypeRequest:37,DssTypeScript:38,DssTypeSearch:39,DssTypeSearchFolder:40,DssTypeDatamart:41,DssTypeFunctionPackageDefinition:42,DssTypeRole:43,DssTypeSecurityRole:44,DssTypeLocale:45,DssTypeConsolidation:47,DssTypeConsolidationElement:48,DssTypeScheduleEvent:49,DssTypeScheduleObject:50,DssTypeScheduleTrigger:51,DssTypeLink:52,DssTypeDbTable:53,DssTypeTableSource:54,DssTypeDocumentDefinition:55,DssTypeDrillMap:56,DssTypeDBMS:57,DssTypeMDSecurityFilter:58,DssTypePromptAnswer:59,DssTypePromptAnswers:60,DssTypeGraphStyle:61,DssTypeChangeJournalSearch:62,DssTypeNCSObjects:255,DssTypeReservedLastOne:63};mstrmojo.vi.viz.EnumVizStyles={GRAPH_MATRIX:"GraphMatrixVisualizationStyle",NETWORK:"NetworkVisualizationStyle",HEAT_MAP:"VIHeatMapVisualizationStyle",GOOGLE_MAP:"GoogleMapVisualizationStyle",ESRI_MAP:"ESRIMapVisualizationStyle",IMAGE_LAYOUT:"ImageLayoutVisualizationStyle"};(function(){mstrmojo.models.template.MetricValue=mstrmojo.declare(null,null,{init:function G(H){this.data=H.data;this.value=H.value;},getValue:function B(){return this.value.v;},getThresholdType:function D(){return this.value.ty;},getRawValue:function A(){return this.value.rv;},getCSS:function C(){return this.data.css[this.value.cni].n;},getThresholdValue:function F(H){if(this.value.ti===undefined){return H;}return this.data.th[this.value.ti].n;},getFillColor:function E(H){if(this.value.ci===undefined){return H;}return this.data.fc[this.value.ci].n;}});}());mstrmojo.chart.model.enums.EnumDSSGraphDataTextShowType={DssGraphDataTextNone:0,DssGraphDataTextValue:1,DssGraphDataTextLabel:2,DssGraphDataTextBoth:3,DssGraphDataTextAbs:4,DssGraphDataTextAbsValue:5,DssGraphDataTextAbsBoth:7,DssGraphDataTextTotal:8,DssGraphDataTextZValue:16,DssGraphDataTextPercent:32,DssGraphDataTextYValue:64,DssGraphDataTextInternal:128,DssGraphDataTextSeriesDependent:256,DssGraphDataTextQualityObjectMode:512};mstrmojo.vi.models.EnumDragSources={DATASETS:1,VIZ_EDITOR:2,FILTERS:3,ALL_OBJECT_LIST:4,VIZ:5};mstrmojo.mstr.EnumDataType={DataTypeUnknown:-1,DataTypeReserved:0,DataTypeInteger:1,DataTypeUnsigned:2,DataTypeNumeric:3,DataTypeDecimal:4,DataTypeReal:5,DataTypeDouble:6,DataTypeFloat:7,DataTypeChar:8,DataTypeVarChar:9,DataTypeLongVarChar:10,DataTypeBinary:11,DataTypeVarBin:12,DataTypeLongVarBin:13,DataTypeDate:14,DataTypeTime:15,DataTypeTimeStamp:16,DataTypeShort:21,DataTypeLong:22,DataTypeMBChar:23,DataTypeBool:24,DataTypePattern:25,DataTypeBigDecimal:30,DataTypeCellFormatData:31,DataTypeInt64:34};mstrmojo.gmaps.MapEnums={};mstrmojo.gmaps.EnumMapType={Marker:"1",Bubble:"2",Area:"3",Density:"4",Path:"5"};mstrmojo.gmaps.PropertyTypes={mapType:"mtp",clusterMode:"mc",shapeFile:"lid",mapStyle:"dv",themeType:"dms",markerType:"mtp",redrawType:"rosa",legendSwitch:"ls",legendWidthScale:"lwr"};mstrmojo.gmaps.EnumGeographicRole={EnumGeographicRoleNone:"0",EnumGeographicRoleCity:"1",EnumGeographicRoleState:"2",EnumGeographicRoleCountry:"3",EnumGeographicRoleLocation:"4",EnumGeographicRoleLatitiude:"5",EnumGeographicRoleLongitude:"6",EnumGeographicRoleOther:"7",EnumGeographicRoleZipCode:"8",EnumGeographicRoleCounty:"9",EnumGeographicRoleLastOne:"10"};mstrmojo.gmaps.EnumClusterMode={MOBILE_OFF:"0",MOBILE_ON:"1",ON:"2",OFF:"3",PIE:"4"};mstrmojo.gmaps.EnumZoomBehavior={Keep:"0",Automatic:"1"};mstrmojo.gmaps.EnumDataLabel={DATA_LABEL_SHOW:"dlShw",DATA_LABEL_SHOW_ALL:"dlShwAll",DATA_LABEL_FONT_SIZE:"dlFntSz",DATA_LABEL_FONT_FAMILY:"dlFntFml",DATA_LABEL_FONT_COLOR:"dlFntClr",DATA_LABEL_FONT_STYLE:"dlFntStyle"};mstrmojo.gmaps.EnumDataLabelShowOption={NONE:0,SHOW_TEXT:1,SHOW_VALUE:2,SHOW_BOTH:3};mstrmojo.gmaps.MarkerAlignOption={CENTER:0,TOP:1,LEFT:2,RIGHT:3,BOTTOM:4,TOP_LEFT:5,TOP_RIGHT:6,BOTTOM_LEFT:7,BOTTOM_RIGHT:8};(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources");function D(H){this.cleanUpAfterTarget(H);var G=H.tgtData;if(G){delete H.tgtData;}var I=this.getContextDragData(H);if(I&&I.setAvatarClass){I.setAvatarClass("");}}mstrmojo.vi.ui._IsDropTarget=mstrmojo.provide("mstrmojo.vi.ui._IsDropTarget",{_mixinName:"mstrmojo.vi.ui._IsDropTarget",dropZone:true,getDropAvatarIcon:function B(G){return"add";},getContextDragData:function F(G){return G.getCtxtDragData();},cleanUpAfterTarget:mstrmojo.emptyFn,ondragenter:function A(G){var H=this.getContextDragData(G);if(H&&H.setAvatarClass){H.setAvatarClass(this.getDropAvatarIcon(G));}if(this._super){this._super(G);}},ondragleave:function E(G){D.call(this,G);if(this._super){this._super(G);}},ondrop:function C(G){D.call(this,G);if(this._super){this._super(G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.models.template.Header");mstrmojo.models.template.Headers=mstrmojo.declare(null,null,{init:function D(K){var O=this.isRow=K.isRow,J=this.data=K.data,L=J.gts,G=J.ghs,F=this.hs=O?G.rhs:G.chs,M=this.i=K.i,N=0,I;this.titles=O?L.row:L.col;this.headers=F.items&&F.items[M]&&F.items[M].items;if(O&&this.headers){N=this.titles.length-this.headers.length;if(N){for(I=M-1;I>=0;I--){var E=F.items[I].items,H=E.length-this.headers.length;if(H>0){this.headers=E.slice(0,H).concat(this.headers);if(this.titles.length===this.headers.length){break;}}}}}},size:function B(){var E=this.headers;return(!E?0:E.length);},getHeader:function C(H){var F=this.headers,G=F&&F[H],E=H;if(G&&mstrApp&&mstrApp.isVI){E=isNaN(G.tui)?G.ui:G.tui;}return G&&new mstrmojo.models.template.Header({h:G,t:this.titles[this.isRow?E:this.i]});},getCSS:function A(F){var E=this.headers;return E&&this.data.css[E[F].cni].n;},getHeaderCell:function(F){var E=this.headers;return E&&E[F];}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var E=mstrmojo.dom,M=mstrmojo.hash,B,I=mstrmojo.global.document,K="mousedown",P="mousemove",R="mouseup";function G(Y){if(E.isPrimaryMouseBtn(Y)){B.startDragCheck(self,Y);}}var V,Q,A="mstrmojo-dnd-avatar",U;function F(Z,Y){if(Y!==undefined&&Y!==null){Q.innerHTML=Y;}U.left=Z.x+"px";U.top=Z.y+"px";}function L(Z,Y){if(!V){V=I.createElement("div");U=V.style;V.className=A;V.innerHTML='<div class="'+A+'-inner"></div>';Q=V.firstChild;I.body.appendChild(V);}F(Z,Y);U.display="block";}function S(){if(U){U.display="none";}}function H(Y){var Z=++B.ctxt.moveCount;if(Z>=B.minMoves){B.stopDragCheck();if((Y.buttons===1||Y.buttons===undefined||E.isIE9)&&(Y.which===1||Y.button===0||E.isIE8)){B.startDrag(self,Y);}}}function O(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDragCheck();delete B.ctxt;}}function D(Y){B.onDragMove(self,Y);}function C(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDrag(window,Y);}}function N(b){var Z=mstrmojo.hash.copy(b,{}),a=Z.hWin=Z.hWin||window,Y=Z.e=Z.e||a.event;Z.node=E.eventTarget(a,Y);Z.pos=E.getMousePosition(Y,a);return Z;}function J(Z){var Y=E.findWidget(Z);while(Y){if(Y.draggable){return Y;}Y=Y.parent;}return null;}function T(Y){var a=Y.src,Z=J(a.node);if(!Z){return null;}if(Z.getDragAction){Y.action=Z.getDragAction(Y);}a.widget=Z;a.data=Z.getDragData&&Z.getDragData(Y);if(Z.isDragValid){if(!Z.isDragValid(Y)){if(!Z.shouldDragBubble||Z.shouldDragBubble(Y)!==true){Y.src.node=Z.domNode.parentNode;return T(Y);}return null;}}if(Z.ondragstart){Z.ondragstart(Y);}return Z;}function X(a,Z){var Y=E.findWidget(a),b=Z.tgt&&Z.tgt.widget;while(Y){if(Y.dropZone){if(Y===b){return Y;}if(Y.allowDrop&&Y.allowDrop(Z)){return Y;}}Y=Y.parent;}return null;}function W(){if(this.set){this.set("allowingDrop",false);}}mstrmojo.dnd=mstrmojo.dnd||mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){E.attachEvent(I,K,G);mstrmojo.dndEnabled=true;}},disable:function(){mstrmojo.dndEnabled=false;E.detachEvent(I,K,G);},startDragCheck:function(Y,Z){delete this.ctxt;var a=N({hWin:Y,e:Z});this.ctxt={src:a,moveCount:0,last:M.copy(a.pos),getDirection:function(b){return !!this.dir[b];},getCtxtDragData:function(){var b=this.src;return(b&&b.data)||{};},getCtxtDropData:function(){var b=this.tgt;return(b&&b.data)||{};}};if(this.minMoves){E.attachEvent(I,P,H);E.attachEvent(I,R,O);}else{this.startDrag(Y,Z);}},stopDragCheck:function(){E.detachEvent(I,P,H);E.detachEvent(I,R,O);},startDrag:function(Y,b){var Z=this.ctxt;Z.id=mstrmojo.now();var a=T(Z);if(!a){return ;}E.clearBrowserHighlights(Y);E.preventDefault(self,b);E.attachEvent(I,P,D);E.attachEvent(I,R,C);var d=window.mstrApp;if(d&&d.setInteractive){this._changeAppStatus=d.setInteractive(false);}if(!a.ownAvatar){var c=Z.src;L(c.pos,c.data&&c.data.html);}},stopDrag:function(Y,f){E.detachEvent(I,P,D);E.detachEvent(I,R,C);var b=this.ctxt,a=b.tgt||{},Z=N({hWin:Y,e:f,data:a.data}),d=X(Z.node,b);Z.widget=d;b.tgt=Z;if(d){if(d.ondrop){d.ondrop(b);}else{W.call(d);}}var c=b.src.widget;if(c&&c.ondragend){c.ondragend(b);}if(c&&!c.ownAvatar){S();}if(this._changeAppStatus){window.mstrApp.setInteractive(true);delete this._changeAppStatus;}},onDragMove:function(c,f){if(E.isSafari){E.clearBrowserHighlights();}var Y=this.ctxt,b=Y.tgt||{},Z=b.widget,d=N({hWin:c,e:f,data:b.data}),k=d.widget=X(d.node,Y),h=Y.last,a=d.pos;Y.dir={x:a.x>h.x,y:a.y>h.y};Y.last=M.copy(d.pos);Y.tgt=d;if(Z!==k){if(Z){if(Z.ondragleave){Z.ondragleave(Y);}else{W.call(Z);}}if(k){Y.tgt.data=(k.getDropData&&k.getDropData(Y))||{};if(k.ondragenter){k.ondragenter(Y);}else{if(k.set){k.set("allowingDrop",true);}}}}if(k){if(k.ondragover){k.ondragover(Y);}}var g=Y.src.widget;if(g&&g.ondragmove){g.ondragmove(Y);}if(g&&!g.ownAvatar){F(d.pos);}}});B=mstrmojo.dnd;B.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var D=mstrmojo.dom,L=mstrmojo.hash;var O=100;var F=D.supportsTouches?0.5:1;var G=1;var R=100;var P={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var M=L.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[D.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[D.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[D.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[D.CSS3_TRANSITION]=this.decelerating?(D.CSS3_PREFIX+"transform 0.2s linear"):"";}},L.copy(P));var H=L.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},L.copy(P));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function N(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=L.copy(D.isSafari?M:H,L.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}D.attachEvent(U,D.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){D.detachEvent(T,D.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function J(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}D.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=D.getMousePosition(D.firstTouch(T,V),T);this.dragging=false;D.attachEvent(window,D.TOUCHMOVE,this._tmCallback);D.attachEvent(window,D.TOUCHEND,this._teCallback);},touchesMoved:function E(b,d){var Z=D.getMousePosition(D.firstTouch(b,d),b);D.preventDefault(b,d);if(!this.dragging){var T=5,h=Math.abs;if((this.scrollsHoriz&&h(Z.x-this.pos.x)>T)||(this.scrollsVert&&h(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},f={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=f;this.maxPos={x:Math.max(f.x-Y.x,0),y:Math.max(f.y-Y.y,0)};this.showScroll();}}if(this.dragging){D.stopPropogation(b,d);var c=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(c.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(c.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),g=this.lastDragTime;this.nextLastDragTime=g;this.lastDragTime=U;if((U-g)>R){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function I(T,U){D.preventDefault(T,U);D.detachEvent(window,D.TOUCHMOVE,this._tmCallback);D.detachEvent(window,D.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;D.stopPropogation(T,U);if((new Date())-this.lastDragTime<=R){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=D.getMousePosition(D.firstChangedTouch(Y,Z),Y),c=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-c.x,y:W.y-c.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),d=T?(new Date())-T:0,V={x:d?Number(b.x*O*F/d).toFixed(2):0,y:d?Number(b.y*O*F/d).toFixed(2):0};var a=this,U=function(e){return(a.scrollsHoriz&&Math.abs(e.x)>=G)||(a.scrollsVert&&Math.abs(e.y)>=G);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,O);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=b?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=b?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function K(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function Q(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(W){mstrmojo.hash.copy(W,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var W=this;this.delayTimer=window.setTimeout(function(){W._start();W=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function U(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var W=this.ease;if(typeof W==="string"){this.ease=mstrmojo.registry.ref(W);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var X=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Y(){if(X){X.exec();X.counter++;if(X.counter>=X.steps){X._end();X=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function T(){if(this.getTarget){this.target=this.getTarget();}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var X=this.target;if(X&&this.slot&&X.scriptClass){var Y=X[this.slot];if(Y){this.widget=X;this.target=Y;}}}}}if(!this.target){var W=this;while(W=W.parent){if(!W||W.domNode){break;}}if(W){this.widget=W;this.target=W[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(Z,a){var X=Z.children,W=(X&&X.length)||0,Y;for(Y=0;Y<W;Y++){X[Y][a]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(Z){this._super(Z);var Y=this.children;mstrmojo.registry.refArray(Y);var W=(Y&&Y.length)||0,X;for(X=0;X<W;X++){Y[X].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function U(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Y=this.props,Z;for(Z in Y){var X=Y[Z],W=X.ease;if(typeof W==="string"){X.ease=mstrmojo.registry.ref(W,{dontInst:true});}}this._super();},exec:function P(){var Z=this.props,a;for(a in Z){var X=Z[a],W=(X.ease||mstrmojo.ease.sin)(this.counter,X.start,X.stop-X.start,this.steps-1);if(X.fn){W=X.fn(W);}if(X.suffix){W+=X.suffix;}var Y=X.isStyle===false?this.target:this.target.style;Y[a]=W;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var a=this.srcProp,Y;if(a){var W=this.widget||this.parent;Y=W&&W[a];if((Y!=null)&&(typeof (Y)!=="string")){Y=String(Y);}}this.stop=Y;this._dynStop=true;}if(this.stop==null){this.stop="";}var Z=this.target,b=null,X=1;if(Z){Z.innerHTML="";b=document.createTextNode("");Z.appendChild(b);X=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=b;this.charGroupSize=X;},exec:function(){var X=this.targetTextNode;if(!X){return ;}var W;if(this.counter>=this.steps-1){W=this.stop;}else{if(this.counter===0){W="";}else{W=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}X.nodeValue=W;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function U(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(W){if(W==null){W=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(W*100,10)+")";}else{this.target.style.opacity=W;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function U(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function V(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Y,X,Z){var W=Math.pow(10,Z||2);if(X){return parseInt(W*Y/X,10)/W;}return parseInt(W*Y,10)/W;}mstrmojo.ease={linear:function L(X,W,Z,Y){if(X===Y){return W+Z;}if(X===0){return W;}return W+Z*I(X,Y);},sin:function A(X,W,Z,Y){return W+Z*Math.sin((Math.PI/2)*X/Y);},cos:function B(X,W,Z,Y){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},sincos:function K(X,W,Z,Y){if(X>Y/2){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}return W+Z*Math.sin((Math.PI/2)*X/Y);},cossin:function Q(X,W,Z,Y){if(X>Y/2){return W+Z*Math.sin((Math.PI/2)*X/Y);}return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},bounce:function G(X,W,Z,Y){if((X/=Y)<(1/2.75)){return Z*(7.5625*X*X)+W;}if(X<(2/2.75)){return Z*(7.5625*(X-=(1.5/2.75))*X+0.75)+W;}if(X<(2.5/2.75)){return Z*(7.5625*(X-=(2.25/2.75))*X+0.9375)+W;}return Z*(7.5625*(X-=(2.625/2.75))*X+0.984375)+W;},shake:function J(X,W,Z,Y){if(X<Y/2){return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*X/Y;}return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*(1-X/Y);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;mstrmojo.ui._IsIncFetchList=mstrmojo.provide("mstrmojo.ui._IsIncFetchList",{_mixinName:"mstrmojo.ui._IsIncFetchList",ifDataHelper:null,supportsIncFetch:false,isFetching:false,initScroll:function A(){var G=this.ifDataHelper,F=this,E=this.scrollNode||this.domNode;this.supportsIncFetch=G&&G.hasNext();if(G&&this.supportsIncFetch){this._scroll=function D(){if(E.offsetHeight+E.scrollTop>=E.scrollHeight){F.raiseEvent({name:"incFetch",id:F.id});}};C.attachEvent(E,"scroll",this._scroll);this.attachEventListener("incFetch",this.id,function(H){if(!this.supportsIncFetch||this.isFetching){return ;}if(this.preNext){this.preNext();}this.set("isFetching",true);G.next({complete:function(I){if(F.postNext){F.postNext();}F.set("isFetching",false);},success:function(I){F.addItems(I.items);},failure:function(I){F.supportsIncFetch=false;mstrmojo.alert("Error in fetching next: "+I);}});});}},addItems:function B(D){if(this._super){this._super(D);}if(!this.ifDataHelper.hasNext()){this.supportsIncFetch=false;var E=this.scrollNode||this.domNode;C.detachEvent(E,"scroll",this._scroll);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;function D(J,I){var G=[];if(J){var F;for(F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function E(L,F,N){if(C.isPrimaryMouseBtn(N.e)){var I=N.hWin,J=N.e,G=C.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=C.ctrlKey(I,J),O=C.shiftKey(I,J);if(K||O){C.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}}},premouseup:function B(H,K,G){var F=G.hWin,J=G.e,L=C.ctrlKey(F,J),I=C.shiftKey(F,J);if(L||I){C.clearBrowserHighlights(F);}},onadd:function A(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=D(K,G),J;for(J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function A(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){var H;for(H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);var J,N;for(J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var F=mstrmojo.dom;function G(N,P,M,Q){var O=new XMLHttpRequest();O.onload=function(){if(this.status===200){var U=new Uint8Array(this.response);var T=U.length;var R=new Array(T);while(T--){R[T]=String.fromCharCode(U[T]);}var V=R.join("");var S=window.btoa(V);M.src="data:image/png;base64,"+S;M.origNode=N;N.parentNode.replaceChild(M,N);}if(Q){Q();}};O.onerror=O.onabort=O.ontimeout=function(){if(Q){Q();}};O.open("GET",P,true);O.responseType="arraybuffer";O.send();}function I(Q){var O=this.getRootDivForPDF().getElementsByTagName("img"),N=O.length,P=0,R,M=function(){P++;if(P===N){if(Q){Q();}}};for(R=0;R<N;R++){var S=O[R];G(S,S.src,S.cloneNode(true),M);}}function L(M){if(M&&M[1]==="matrix"){return M[2].split(",").map(function(O){return parseFloat(O.trim());});}else{if(M&&M[1]==="matrix3d"){var N=M[2].split(",").map(function(O){return parseFloat(O.trim());});return[N[0],N[1],N[4],N[5],N[12],N[13]];}}}function K(O){var M=this.getCssTransform?this.getCssTransform():F.CSS3_TRANSFORM;function N(T){var R=mstrmojo.css.getStyleValue(T,M);var P=R?L(R.match(/(matrix|matrix3d)\((.+)\)/)):null;var Q=P||[1,0,0,1,0,0];if(Q.join(",")!=="1,0,0,1,0,0"){T.exportHack=mstrmojo.hash.copy({left:T.style.left,top:T.style.top,transform:R},T.exportHack);T.style.left=((parseInt(T.style.left,10)||0)+Q[4])+"px";T.style.top=((parseInt(T.style.top,10)||0)+Q[5])+"px";T.style[M]="none";}if(T.style.clip.match(/^rect\(auto,? auto,? auto,? auto\)$/)){T.exportHack=mstrmojo.hash.copy({clip:T.style.clip},T.exportHack);T.style.clip="auto";}if(T.children){for(var S=0;S<T.children.length;S++){N(T.children[S]);}}}N(O);}function A(O){var M=this.getCssTransform?this.getCssTransform():F.CSS3_TRANSFORM;function N(Q){if(Q.exportHack){if(Q.exportHack.transform){Q.style.left=Q.exportHack.left;Q.style.top=Q.exportHack.top;Q.style[M]=Q.exportHack.transform;}if(Q.exportHack.clip){Q.style.clip=Q.exportHack.clip;}delete Q.exportHack;}if(Q.children){for(var P=0;P<Q.children.length;P++){N(Q.children[P]);}}}N(O);}function H(){var M=this.getRootDivForPDF().getElementsByTagName("img"),N;for(N=0;N<M.length;N++){var O=M[N];if(O.origNode){O.parentNode.replaceChild(O.origNode,O);delete O.origNode;}}}function C(S){var M=new jsPDF("l","pt","letter"),Q={top:25,bottom:60,left:60},P={w:792-2*Q.left,h:612-2*Q.top};var O=Math.min(P.w/S.width,P.h/S.height),R={h:(P.w-S.width*O)/2,v:(P.h-S.height*O)/2},N=[S.toDataURL("image/png"),Q.left+R.h,Q.top+R.v,S.width*O,S.height*O,"JPEG",null,"SLOW"];M.addImage.apply(M,N);return M;}mstrmojo.gmaps._CanExportPDF=mstrmojo.provide("mstrmojo.gmaps._CanExportPDF",{isClientExport:true,getExtraNodeForPDF:function J(){return[];},getRootDivForPDF:function B(){return this.parent.domNode;},preExportHook:function E(M){if(M){M();}},postExportHook:mstrmojo.emptyFn,hideMapTools:mstrmojo.emptyFn,showMapTools:mstrmojo.emptyFn,replaceImage:G,replaceMapTiles:I,substituteStyles:K,reviveStyles:A,reviveImages:H,exportVisualization:function D(O){if(O!=3){return ;}if(mstrApp.isSingleTier){var P=this;var M=this.toolbar.domNode.style.display;this.hideMapTools();this.toolbar.domNode.style.display="none";setTimeout(function(){var R=P.getRootDivForPDF().getBoundingClientRect();var T=window.FormWrapper.getScreenCapture();T="data:image/png;base64,".concat(T);P.toolbar.domNode.style.display=M;P.showMapTools();mstrApp.showWait({showCancel:true});if(mstrmojo.all.waitBox){var Q=mstrmojo.all.waitBox.cancelBtn.onclick;mstrmojo.all.waitBox.cancelBtn.onclick=function(){mstrApp.hideWait();mstrmojo.all.waitBox.cancelBtn.onclick=Q;};}var S=new Image();S.onload=function(){var W=document.createElement("canvas");W.width=R.width;W.height=R.height;var V=W.getContext("2d");var Y;try{Y=(S.width/document.body.getBoundingClientRect().width)||1;}catch(Z){Y=1;}V.drawImage(S,R.left*Y,(R.top-30)*Y,R.width*Y,R.height*Y,0,0,R.width,R.height);var U=C(W);window.FormWrapper.saveToLocalDisk(btoa(U.output()),".pdf",P.parent.title||"visualization");mstrApp.hideWait();};S.src=T;},100);}else{mstrApp.showWait({showCancel:true});if(mstrmojo.all.waitBox){var N=mstrmojo.all.waitBox.cancelBtn.onclick;mstrmojo.all.waitBox.cancelBtn.onclick=function(){mstrApp.hideWait();mstrmojo.all.waitBox.cancelBtn.onclick=N;};}if(!window.jsPDF||!window.html2canvas||!window.canvg){this.loadScripts();}else{this.renderVis();}}},loadScripts:function(){var N=[];N.push({url:"../javascript/libraries/html2canvas.js"});N.push({url:"../javascript/libraries/html2canvas.svg.js"});N.push({url:"../javascript/libraries/jspdf.js"});N.push({url:"../javascript/libraries/canvg/rgbcolor.js"});N.push({url:"../javascript/libraries/canvg/StackBlur.js"});N.push({url:"../javascript/libraries/canvg/canvg.js"});var M=this;M.requiresExternalScripts(N,function(){M.renderVis();});},renderVis:function(){var P=this,O={useCORS:true,pagesplit:true,logging:false},M=this.toolbar.domNode.style.display;this.toolbar.domNode.style.display="none";this.hideMapTools();function N(W){var S=C(W);var U=true,T="dataurlnewwindow",R=(P.parent.title||"visualization")+".pdf";if(U){T="save";}else{var Q=2097152,V=S.output("dataurlstring");if(V.length*2>Q){T="save";}}S.output(T,R);mstrApp.hideWait();P.toolbar.domNode.style.display=M;P.showMapTools();if(P.postExportHook){P.postExportHook();}}O.onrendered=function(U){var R=0,Q=P.getExtraNodeForPDF();if(Q.length>0){var S=function(V){canvg(U,Q[V].outerHTML,{ignoreClear:true,ignoreDimensions:true,renderCallback:function(){R++;if(R>=Q.length){N(U);}else{S(V+1);}}});};try{S(0);}catch(T){N(U);}}else{N(U);}};if(this.preExportHook){this.preExportHook(function(){html2canvas(P.getRootDivForPDF(),O);});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var E=mstrmojo.dom;var P=mstrmojo.dom;var O="mousedown";function S(U){var T=U[U.hotSlot||"domNode"];if(T){if(!U._closeCallback){var W=U.id,V=function(X){return function(Z){var Y=mstrmojo.all[W];if(Y&&!Y.ignoreHover){Y["auto"+X](Z,self);}};};U._uncloseCallback=V("Unclose");U._closeCallback=V("Close");}E.attachEvent(T,"mouseover",U._uncloseCallback);E.attachEvent(T,"mouseout",U._closeCallback);}}function B(U){if(U._closeCallback){var T=U[U.hotSlot||"domNode"];if(T){E.detachEvent(T,"mouseover",U._uncloseCallback);E.detachEvent(T,"mouseout",U._closeCallback);}}}function F(V,U){var T=V;while(T){if(T.open||T.openPopup){if(T.set){T.set("ignoreHover",U);}else{T.ignoreHover=U;}}T=T.opener||T.parent;if(T&&T.shouldPropagateLockHover&&!T.shouldPropagateLockHover()){break;}}}function D(){var T=this._lockHoverCallback;if(T){E.detachEvent(document.body,O,T,true);delete this._lockHoverCallback;}}mstrmojo._CanAutoClose=mstrmojo.provide("mstrmojo._CanAutoClose",{autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function Q(){this._super();if(this.autoCloses){S(this);}this.oncloseOnClickChange();},onautoClosesChange:function L(){var T=(this.autoCloses)?S:B;T(this);},oncloseOnClickChange:function H(){if(!this.curtainNode){return ;}var V=this,U="click",T=(mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp());if(T){U="touchstart";}E.attachEvent(V.curtainNode,U,function(){V.close();if(T){mstrmojo.touchManager.notify([]);}});},autoUnclose:function G(){var T=this._autoCloseTimer;if(T){self.clearTimeout(T);delete this._autoCloseTimer;}},autoClose:function J(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var T=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[T].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function R(T){D.call(this);this._super(T);},lockHover:function N(){F(this,true);if(!this._lockHoverCallback){var U=this.id,T=this._lockHoverCallback=function(V){mstrmojo.all[U]._unlockHoverCheck(V,self);};if((E.isIE7||E.isIE8)&&window.event&&(window.event.type===O)&&this.opener){this.opener._ignoreMousedown=true;}E.attachEvent(document.body,O,T,true);}},unlockHover:function M(){F(this,false);D.call(this);},_unlockHoverCheck:function C(X,T){var U=this.opener;if(U&&U._ignoreMousedown){delete U._ignoreMousedown;return ;}var W=E.eventTarget(T,X);if(!P.contains(this.domNode,W,true,document.body)){var V=P.findWidget(W);while(V){if(V===this){return ;}V=V.parent||V.opener;}if(U&&U.onPopupAutoClosed){U.onPopupAutoClosed(X,T);}this.close();}},open:function I(U,T){if(this.autoCloses){this.autoUnclose();}this._super(U,T);if(this.locksHover){this.lockHover();}},close:function K(T){if(this.locksHover){this.unlockHover();}this._super(T);},shouldPropagateLockHover:function A(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox=mstrmojo.provide("mstrmojo._HasScrollbox",{_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,scrollInterval:50,scrollboxNode:undefined,scrollTo:function F(L,K){var J=this.scrollboxNode;J.scrollLeft=L.x;J.scrollTop=L.y;if(K){this.notifyScrollListeners(L);}},connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount===1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L&&L.hasOwnProperty(J)){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(K){var N=K||this.getScrollPos(),M=N.y,L=N.x;this.scrollboxTop=M;this.scrollboxLeft=L;this.scrollboxRight=L+this.scrollboxWidth;this.scrollboxBottom=M+this.scrollboxHeight;var J=this.scrollListeners,O;for(O in J){J[O].onscroll(this);}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=L?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=L?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom,E=100;function I(K,J){return function(L){mstrmojo.all[K][(J?"move":"show")+"Tooltip"](L,self);};}function A(){var K=this.tooltipNode||this.domNode,M=this.id,J,L="_ontooltip"+(this.isDynamicTooltip?"move":"over");if(!this._ontooltipout){this._ontooltipout=function(N){mstrmojo.all[M].hideTooltip(N,self);};}if(!this[L]){this[L]=I(M,this.isDynamicTooltip);}K=[].concat(K);for(J=0;J<K.length;J++){K[J].removeAttribute("title");B.attachEvent(K[J],(this.isDynamicTooltip?"mousemove":"mouseover"),this[L]);B.attachEvent(K[J],"mouseout",this._ontooltipout);}}mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,isDynamicTooltip:false,tooltipNode:null,tooltipOpenDelay:700,hasOpenTooltip:false,postBuildRendering:function(){var J=this._super();if(this.useRichTooltip){A.call(this);}return J;},onuseRichTooltipChange:function H(){if(this.hasRendered){var K=this.tooltipNode||this.domNode,J;if(this.useRichTooltip){A.call(this);}else{if(this._ontooltipout){if(K&&K.constructor!==Array){K=[K];}for(J=0;J<K.length;J++){B.detachEvent(K[J],this.isDynamicTooltip?"mousemove":"mouseover",this["_ontooltip"+(this.isDynamicTooltip?"move":"over")]);B.detachEvent(K[J],"mouseout",this._ontooltipout);}}this.hideTooltip();}}},showTooltip:function G(M,L){var K=this;if(!K.hasOpenTooltip&&(!mstrApp.isInteractive||mstrApp.isInteractive&&mstrApp.isInteractive())){mstrmojo.requiresCls("mstrmojo.tooltip");if(this.updateTooltipConfig){this.updateTooltipConfig(M);}window.clearTimeout(this._tooltipTimeOut);if(mstrmojo.dom.isIE){var N={};for(var J in M){N[J]=M[J];}M=N;}var O=this.richTooltip?this.richTooltip.areaId:undefined;this._tooltipTimeOut=window.setTimeout(function(){if(K._closeTooltipTimeout){window.clearTimeout(K._closeTooltipTimeout);delete K._closeTooltipTimeout;}mstrmojo.tooltip.open(K,M,L);K.tooltip.onmouseover=function(){if(K.richTooltip&&K.richTooltip.enableHover){window.clearTimeout(K._closeTooltipTimeout);window.clearTimeout(K._deactivationTimeout);if(K.tooltip){K.tooltip.onmouseout=function(P){if(!B.contains(this.domNode,P.e.toElement||P.e.relatedTarget)){K.hideTooltip();}};}}};K.hasOpenTooltip=true;K._hasActiveArea=true;K._tooltipAreaId=O;window.clearTimeout(K._deactivationTimeout);delete K._deactivationTimeout;},(this._hasActiveArea&&O&&O===this._tooltipAreaId)?0:this.tooltipOpenDelay);}},moveTooltip:function C(J,L){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;mstrmojo.tooltip.close();}var N=this,K=J,M=L;this._tooltipTimeOut=setTimeout(function(){mstrmojo.tooltip.open(N,K,M);},this.tooltipOpenDelay);},hideTooltip:function F(){var J=this;window.clearTimeout(this._tooltipTimeOut);if(this._closeTooltipTimeout){window.clearTimeout(this._closeTooltipTimeout);}if(this._hasActiveArea&&!this._deactivationTimeout){this._deactivationTimeout=window.setTimeout(function(){delete J._deactivationTimeout;delete J._hasActiveArea;delete J._tooltipAreaId;},100);}mstrmojo.requiresCls("mstrmojo.tooltip");if(J.richTooltip&&J.richTooltip.enableHover){this._closeTooltipTimeout=window.setTimeout(function(){mstrmojo.tooltip.close();delete J._closeTooltipTimeout;},E);}else{mstrmojo.tooltip.close();}this.hasOpenTooltip=false;},unrender:function D(M){var N=this.tooltipNode||this.domNode,L;if(N&&N.constructor!==Array){N=[N];}if(N){var O=this._ontooltipover,K=this._ontooltipout,J=this._ontooltipmove;for(L=0;L<N.length;L++){if(O){B.detachEvent(N[L],"mouseover",O);}if(K){B.detachEvent(N[L],"mouseout",K);}if(J){B.detachEvent(N[L],"mousemove",J);}}}this._super(M);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var W=this._sourceFn;if(!W){var V=this.source;if(V!=null){if(typeof (V)=="string"){if(!(V.match("return "))&&!(V.match(/\;\s*\S/))){V="return "+V;}W=new Function(V);}else{if(typeof (V)=="function"){W=V;}}this._sourceFn=W;}}var S,X=this.parent;if(W){try{S=W.apply(X,[]);}catch(U){}}var T=this.setter,Y=this.destination;if(T==null){X[Y]=S;}else{if(typeof (T)=="string"){X[T](Y,S);}else{if(typeof (T)=="function"){T.apply(X,[Y,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var T=this._chains;if(!T){this._parseChains();T=this._chains;}for(var S in T){this._attachChain(T[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var T=this._chains;if(T){for(var S in T){this._detachChain(T[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var U=this._chains;var T=this.source;if(T&&(typeof (T)=="function")){T=T.toString&&T.toString();}if(!T){return ;}function S(b,e,V,X){var W=b,Z;while(Z=W.match(e)){var c=Z[0],a=c.length,d=true;c=c.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Y in U){if(Y.substr(0,a)===c){d=false;break;}else{if(c.indexOf(Y)===0){delete U[Y];}}}if(d){U[c]={host:(V==null)?null:Z[V],parts:Z[X].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}W=W.substr(Z.index+a);}}if(D.test(T)){S(T,O,null,1);}if(R.test(T)){S(T,M,1,2);}if(B.test(T)){S(T,L,1,2);}},_attachChain:function Q(S,U){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var d=S.evt2idx,g=S.idx2evt,Z=S.parts;var e=(U>=0)?U:0,b=this.id,W=mstrmojo.all,c=(U>0)?W[g[e-1].context][Z[e-1]]:(S.host?W[S.host]:this.parent),T=Z[e];var V=mstrmojo.array;while(c&&T){if(c.attachEventListener){var f=c[T+"_bindEvents"]||(T+"Change");if(typeof (f)=="string"){f=[f];}var Y=[];for(var a=0,X=f.length;a<X;a++){Y[a]=c.attachEventListener(f[a],b,"_callback");}for(var a=0;a<f.length;a++){d[c.id+"_"+f[a]]=e;}g[e]={context:c.id,evts:f,subs:Y};}c=c[T];T=S.parts[++e];}},_detachChain:function G(S,T){var U=mstrmojo.all,h=S.idx2evt,d=S.evt2idx,a=this.id;var Y=(T>-1)?T:0,b=h.length;if(Y<b){for(;Y<b;Y++){var Z=h[Y];if(!Z){break;}var W=Z.context,c=U[W],g=Z.evts;if(c&&c.detachEventListener){var k=Z.subs;for(var f=0,V=k.length;f<V;f++){c.detachEventListener(k[f]);}}h[Y]=null;for(var X=0,e=g.length;X<e;X++){delete d[W+"_"+g[X]];}}}},_callback:function I(T){this.exec();if(!T||!T.name||!T.src){return ;}var U=T.src.id+"_"+T.name,W=this._chains;for(var X in W){var V=W[X],S=V.evt2idx[U];if(S!=null){this._detachChain(V,S+1);this._attachChain(V,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var K=mstrmojo.array,D=mstrmojo.hash;function E(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(K.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function J(R){var Q=[],S=R.selectedIndices,P;for(P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function H(V,U){var S=[],Q=V.selectedIndices,X=K.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return J(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}var T=U.length,R;for(R=0;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex===W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V,Q;for(Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U===V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function G(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function F(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=J(this),S=E(this,[P]);if(Q!==true){G(this,S,R);}}},toggleSelect:function O(P,Q){var S,R;if(this.selectedIndices[P]){R=H(this,[P]);}else{S=E(this,[P]);}if(Q!==true){G(this,S,R);}},rangeSelect:function N(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=J(this);if(P!==true){G(this,null,Q);}},select:function L(R,P){var Q=A(this,K.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){G(this,Q.add,Q.rmv);}},addSelect:function B(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=E(this,R);if(P!==true){G(this,Q,null);}return Q;},removeSelect:function M(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=H(this,R);if(P!==true){G(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){G(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof T==="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=K.find(U,V,T[V]);}else{if(T!=null){Q=K.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function C(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!==null&&P!==undefined){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return D.keyarray(this.selectedIndices,true).sort(K.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return K.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,d){if(!Q||!Q.length){return ;}var S=this.items||[],s=this.itemIdField!=null?K.findMulti(S,this.itemIdField,Q):K.indexOfMulti(S,Q),V=Q.length,T=V-s.count,q=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(q&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],f=s.map;if(T&&q){var p=0,e;for(e=0;e<V;e++){if(f[e]==null){R.push(Q[e]);U.push(b+p++);}}this.add(R,b);}var W=[],h;for(h in f){var o=f[h];if(o>=b){o+=X;}W.push(o);}var r=W.concat(U),Y=this.addSelect(r,!d);if(!d){var Z=K.hash(Y),g=this.selectedIndices,a=[],l;for(l in g){if(!Z[l]){a.push(parseInt(l,10));}}var P=this.removeSelect(a,true);G(this,Y,P);}}});}());mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){document.msCSSOMElementFloatMetrics=true;mstrmojo.requiresCls("mstrmojo.hash");var S=mstrmojo.hash,H="containerNode",G="auto",Q="px";var I={v:G,c:undefined,sv:G};function E(c,f,e){var g=this._layoutWidgets[f],l=c.slot||H,h=g.f,k=g.p,d=(h&&h[l]!==undefined),b=(k&&k[l]!==undefined);if(l&&((!e&&d)||b)){return d?h[l]:(g.x*parseInt(k[l],10)/100)+Q;}return c[(f==="h")?"height":"width"];}function K(g,d,b){if(g.ignoreLayout){return ;}var c=(d===G)||d==="NaNpx",f=(b===G)||b==="NaNpx";var e=g.getLayoutOffsets&&g.getLayoutOffsets();if(e){if(!c){d=(parseInt(d,10)-e.h)+Q;}if(!f){b=(parseInt(b,10)-e.w)+Q;}}if(g.setDimensions){g.setDimensions(d,b);}else{if(g.set){if(!c){g.set("height",d);}if(!f){g.set("width",b);}}}}function Z(e){var c=this.children,g,l;for(g=0,l=(c&&c.length)||0;g<l;g++){var d=c[g],m=d.slot||H;if(m){var k=E.call(this,d,"h",e),n=E.call(this,d,"w",e);this.setSlotDimensions(m,k,n);K(d,k,n);var b=E.call(this,d,"h",e),f=E.call(this,d,"w",e);if(b!==k||f!==n){K(d,b,f);}this.setSlotDimensions(m,b,f);}}this.afterLayout();}function B(){var c=this.children,b=this._layoutWidgets;S.forEach(this.slotNames,function(g,k){if(!g||this.skipsSlotLayout(k)){return ;}var f=(b.h&&b.h.getSlotSizeInfo(k,c))||I,d=(b.w&&b.w.getSlotSizeInfo(k,c))||I,e=f.c||d.c;mstrmojo.array.forEach(e,function(h){K(h,f.v,d.v);});this.setSlotDimensions(k,f.sv,d.sv);},this);this.afterLayout();}function D(c){var b=this.layoutConfig.xt?B:Z;b.call(this,c);}function T(k,e,g){var h=k.slot||H,f=e&&e.a;if(!f||f[h]===undefined){return ;}var b=this[h]["offset"+g],c=f[h];if(b===c){return ;}e.x-=(b-c);f[h]=b;}function J(b){this.beforeLayout();var c=this._layoutWidgets,d=b.src;T.call(this,d,c.h,"Height");T.call(this,d,c.w,"Width");D.call(this,true);}function O(d,g){if(!d){return null;}var b=this.children,r=g.toLowerCase(),h=parseInt(this[r],10),l=h,n={},p={},f={},c={},o={},k,m,e,s,q;for(q in d){if(!d.hasOwnProperty(q)){continue;}s=d[q];if(s.match(/px$/)){h-=parseInt(s,10);n[q]=s;}else{if(s.match(/%$/)){p[q]=s;}else{if(s.match(/all/)){o[q]=l;}else{f[q]=s;}}}}if(!S.isEmpty(f)&&!S.isEmpty(p)){for(k=0,m=(b&&b.length)||0;k<m;k++){e=b[k];q=e.slot||H;if(q&&f[q]&&!e.ignoreLayout){if(e.hasRendered){c[q]=this[q]["offset"+g];h-=c[q];}else{c[q]=0;e.attachEventListener((e instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,J);}}}}return{f:S.isEmpty(n)?undefined:n,p:S.isEmpty(p)?undefined:p,a:S.isEmpty(c)?undefined:c,n:S.isEmpty(o)?undefined:o,x:h,getSlotSizeInfo:function(AB,w){if(!d[AB]){return I;}var u=mstrmojo.array.filter(w,function(AD){var AC=AD.slot;return AC===AB||(AB===H&&!AC);}),z,AA;var t=n[AB];if(t){AA=t;}var y=p[AB];if(y){AA=(this.x*parseInt(y,10)/100)+Q;}if(f[AB]){AA=c[AB];if(AA){AA+=Q;}else{AA=G;}z=G;}var x=o[AB];if(x){AA=z=x+Q;}AA=AA||"0px";return{v:AA,c:u,sv:z||AA};}};}function R(c){var b=this.domNode;if(!b||!this.layoutConfig){return ;}b.style[c]=this[c];this.doLayout();}mstrmojo._HasLayout=mstrmojo.provide("mstrmojo._HasLayout",{_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",ignoreLayout:false,beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function V(b){this._super(b);this.layoutConfig=S.clone(this.layoutConfig);},preBuildRendering:function C(){var d=this.cssText||"";var b=this.height;if(b&&b!==G){d+="height:"+this.height+";";}var c=this.width;if(c&&c!==G){d+="width:"+this.width+";";}this.cssText=d;return(this._super)?this._super():true;},postBuildRendering:function W(){this.doLayout();return this._super();},modifyLayoutConfig:function Y(d,c){var b=this.layoutConfig=this.layoutConfig||{};b.h=S.copy(d,b.h);b.w=S.copy(c,b.w);this.doLayout();},getLayoutOffsets:mstrmojo.emptyFn,set:function P(d,b){var c=this._super(d,b);if(d==="visible"&&this._pendingLayoutOnVisible){delete this._pendingLayoutOnVisible;this.doLayout();}return c;},doLayout:function A(){var b=this.layoutConfig;if(!b||(this.height===G&&this.width===G)){return ;}if(b.xt){if(!this.visible){this._pendingLayoutOnVisible=true;return ;}}this.beforeLayout();this._layoutWidgets={h:O.call(this,b.h,"Height"),w:O.call(this,b.w,"Width")};D.call(this,false);this.widgetResized();},browserResized:function F(b){this.setDimensions(b.h,b.w);return true;},onwidthChange:function N(){R.call(this,"width");},onheightChange:function M(){R.call(this,"height");},skipsSlotLayout:function(b){return false;},adjustParentDimensions:function L(){var c=this.parent,b=c&&c._layoutWidgets;if(b){T.call(c,this,b.h,"Height");T.call(c,this,b.w,"Width");}},setDimensions:function U(e,c){var d=(e===G)||e==="NaNpx",f=(c===G)||c==="NaNpx";if((!d&&parseInt(this.height,10)!==parseInt(e,10))||(!f&&parseInt(this.width,10)!==parseInt(c,10))){if(!d){this.height=e;}if(!f){this.width=c;}var b=this.domNode,g=b&&b.style;if(g){if(!d){g.height=e;}if(!f){g.width=c;}this.doLayout();}return true;}return false;},setSlotDimensions:function X(e,d,c){var b=this[e]&&this[e].style;if(!b){return ;}if(d!==G&&d!==undefined&&d!=="NaNpx"&&b.height!==d&&parseInt(d)>=0){b.height=d;}if(c!==G&&c!==undefined&&c!=="NaNpx"&&b.width!==c&&parseInt(c)>=0){b.width=c;}}});mstrmojo._HasLayout.getSlotSize=function a(e,f){var c=e&&e.prototype.layoutConfig;if(c){var d=c.h,b=c.w;return{h:(d&&d[f])||undefined,w:(b&&b[f])||undefined};}return null;};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var C=mstrmojo.hash,E=mstrmojo.array;function D(F){return function(G){F[G]=true;};}mstrmojo.rw.model.UpdateKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.UpdateKeysConfig",init:function B(){this.nodes=[];this.selectors={};this.objects={};}});mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig=function A(J){var F={},K={},G={},I={};E.forEach(J,function H(M){var L=M.partialUpdate;if(L){E.forEach(L.nodes,D(K));E.forEach(L.selectors,D(G));E.forEach(L.objects,function(N){if(!I[N.id]||N.flag>I[N.id].flag){I[N.id]=N;}});delete M.partialUpdate;}E.forEach(M.actions,H);});if(!C.isEmpty(K)){F.nodes=C.keyarray(K);}if(!C.isEmpty(G)){F.selectors=C.keyarray(G);}if(!C.isEmpty(I)){F.objects=C.valarray(I);}return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,B=mstrmojo.hash,D="u;",C="-1";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function F(P,O,R){var N,M;for(M in P){N=P[M];if(N.v){var Q=N.v.split(";");if(Q&&Q.length>1){Q[1]=O;if(R&&Q.length>2){Q.pop();}N.v=Q.join(";");}}}return P;},buildElemsCountStr:function K(P,N){P=(!P||!P.length)?[]:P;N=(!N||!N.length)?[]:N;var O=P.length,M=N.length;if(I.find(N,"v",D)>-1){M-=1;}if(I.find(N,"v",C)>-1){M-=1;}if(I.find(P,"v",D)>-1||I.indexOf(P,D)>-1){O=M;}return this.buildElemsCountStrByNum(O,M);},buildElemsCountStrByNum:function K(N,M){if(N===M){if(M===0){return"";}return M.toString();}else{if(M===0){return N+" "+mstrmojo.desc(514);}else{if(N>M){return"("+M+")";}}}return mstrmojo.desc(4891,"").replace("##",String(N)).replace("###",String(M));},browseElements:function G(O,P,N){var M={doNotHold:!(N&&mstrApp.serverProxy),silent:true};mstrApp.serverRequest(mstrmojo.hash.copy(N,P),O,M);},getIdPresentation:function J(P){if(!!P){var O=P.charAt(0),M,N,Q;if((O>="g"&&O<="w")||(O>="V"&&O<="Z")){N=false;for(Q=1;Q<P.length;++Q){if(N){N=false;}else{switch(P.charAt(Q)){case";":return"terseLong";case"\\":N=true;break;}}}return"terse";}if(O>="B"&&O<="Q"){if(P.length>2){M=P.charAt(1);if(M>="A"&&M<="Q"){if(P.charAt(2)===":"){return"oldLong";}}}}if(P.length>=33&&P.charAt(32)===":"){return"old";}}return null;},isNullElem:function H(M){if(!M){return true;}var P=this.getIdPresentation(M),N=false,O;switch(P){case"terse":case"terseLong":O=M.substring(1,M.length).split(";");N=O[0].indexOf(this.TERSE_NULL)>-1;break;case"old":case"oldLong":N=M.indexOf(this.OLD_NULL)>-1;break;}return N;},isNonGroupNull:function(O){var M=O.eid||(O._e&&O._e.id),N=M&&M.split(":")[0];return N&&N===this.NON_GROUP_NULL;},getAttributeId:function L(O){var N,M;if(O){M=O.split(";");N=M[1];}return N;},getElementValue:function A(N){var O,M;if(N){M=N.split(";");if(M.length>2){O=M[0]+" "+M[2];}else{O=M[0];}}return O;},isAttributeIdsLinked:function E(N,M,O){var Q=false,P=B.keyarray(O);I.forEach(P,function(R){if(R===N){I.forEach(O[R],function(S){if(S===M){Q=true;return false;}});}if(Q){return false;}});return Q;},ELEM_ALL_ID:"u;",ELEM_DUMMY_ID:"-1",ELEM_SEPARATOR:"\u001E",OLD_NULL:"~!@@~~!@@~",TERSE_NULL:"\\N",NON_GROUP_NULL:"n00000000000000000000000000000000"});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array;function A(E){var D=(E&&E.gts&&E.gts.col)||[],G=(E&&E.gts&&E.gts.row)||[];var F=C.filter(D.concat(G),function(H){return H.otp===-1;})[0];return{tpltProp:E.prop,mxProp:C.map((F&&F.es)||[],function(H){var I={};I[H.oid]=mstrmojo.hash.copy(H.prop,{n:H.n,t:H.otp});return I;})};}mstrmojo._IsDocumentTemplate=mstrmojo.provide("mstrmojo._IsDocumentTemplate",{_mixinName:"mstrmojo._IsDocumentTemplate",gridInfo:null,tmsProps:null,update:function B(D){if(D&&D.data){this.gridInfo=D.data.gsi;this.tmsProps=A(D.data);}if(this._super){return this._super(D);}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,B=mstrmojo.hash;mstrmojo.models.datasets.DataInterface=mstrmojo.provide("mstrmojo.models.datasets.DataInterface",{getFormsByAttrId:function A(F,E){var D=[];E=E||[];B.forEach(E,function(G){C.forEach(G.att||[],function(H){if(H.did===F){D=D.concat(H.fs||[]);return false;}});});D=C.filter(D,function(G){return !!G.obf;});return C.distinct(D,"fid");}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,M=mstrmojo.hash;function J(U){if(U!==null){return(U.constructor!==Array)?[U]:U;}return null;}function F(e,c,Y){if(!c){return null;}var f=[],V=e.selectedIndices,U=e.allIdx,a=e.noneIdx;if(e.multiSelect&&(a>-1)&&(I.indexOf(c,a)>-1)){return f;}var X,Z,d=e.items,b=e.itemIdField,W=e.selectedItems,h;if(e.multiSelect&&(U>-1)&&(I.indexOf(c,e.allIdx)>-1)){for(X=0,Z=d.length;X<Z;X++){if(!V[X]){f.push(X);V[X]=true;e.selectedIndex=X;e.selectedItem=d[X];}}}else{for(X=0,Z=c.length;X<Z;X++){var g=c[X];if(!V[g]){V[g]=true;if(Y){f.push({idx:g,positions:Y});}else{f.push(g);}e.selectedIndex=g;h=e.selectedItem=d[g];if(W){W[h[b]]=h;}}}}return f;}function D(X,U){var W=[],Y=X.selectedIndices,Z=X.selectedItems,V;for(V in Y){delete Y[V];if(U){W.push({idx:parseInt(V,10),positions:U});}else{W.push(parseInt(V,10));}}X.selectedIndex=-1;X.selectedItem=null;if(Z){X.selectedItems={};}return W;}function T(e,d,Y){if(!d){return null;}var a=[],V=e.selectedIndices,g=I.indexOf,U=e.allIdx,b=e.noneIdx,c=e.itemIdField,W=e.selectedItems;if(e.multiSelect&&(((U>-1)&&(g(d,U)>-1))||((b>-1)&&(g(d,b)>-1)))){return D(e);}if(d.length>0&&V[U]){if(g(d,U)<0){d.push(U);}}var Z=d.length,X;for(X=0;X<Z;X++){var f=d[X];if(V[f]){delete V[f];if(Y){a.push({idx:f,positions:Y});}else{a.push(f);}if(W){delete W[e.items[f][c]];}if(e.selectedIndex===f){e.selectedIndex=-1;e.selectedItem=null;}}}return a;}function C(X,Y,V,U){if(U){return ;}if(this.raiseEvent){if((X&&X.length)||(Y&&Y.length)){try{this.raiseEvent({name:"selectionChange",added:X,removed:Y});}catch(W){T(this,X);F(this,Y);throw W;}}}}function B(V){var W=this.itemIdField,U=this.items;if(typeof V==="object"&&W){return I.find(U,W,V[W]);}return I.indexOf(U,V);}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,noneIdx:-1,itemIdField:"",items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(U){this._super(U);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function K(d){d=J(d);if(!d){return ;}var a=this.items,U=this.items.length,W=this.selectedItems,Y=[],V;a=this.items=a.concat(d);V=a.length;if(W){var Z=this.itemIdField,X,c;for(X=U;X<a.length;X++){c=a[X];if(W[c[Z]]){Y.push(X);}}}if(Y&&Y.length){F(this,Y);}if(V>U){var b=this.itemsContainerNode;if(b){b.innerHTML+=this._buildItemsMarkup(U,V-1).join("");}}},addSelectedItems:function S(U){this.selectItems(U,false);},setSelectedItems:function L(U){this.selectItems(U,true);},selectItems:function R(c,e){c=J(c);if(!c){return ;}if(e&&this.selectedItems){this.selectedItems={};}var W=this.selectedItems,a=this.itemIdField,U=[],Y=this.items.length,Z=[],V=this.allowUnlistedValues,d,b,X;for(X=0;X<c.length;X++){d=c[X];b=B.call(this,d);if(b<0){if(W===null){if(V){U.push(d);b=Y++;Z.push(b);}}else{W[d[a]]=d;}}else{Z.push(b);}}if(U.length>0){this.addItems(U);}if(Z.length>0){if(e){this.select(Z);}else{this.addSelect(Z);}}},unselectItems:function A(V){V=J(V);if(!V){return ;}var a=this.selectedItems,W=[],Z=this.itemIdField,Y,U,X;if(a===null){return ;}for(X=0;X<V.length;X++){Y=V[X];if(a){delete a[Y[Z]];}U=B.call(this,Y);if(U<0){W.push(U);}}if(W.length>0){this.removeSelect(W);}},getSelectedItems:function G(){if(this.selectedItems){return M.valarray(this.selectedItems);}return I.get(this.items,M.keyarray(this.selectedIndices,true));},singleSelect:function(V,W,U){if(V!==-1){this.select([V],W,U);}},singleSelectByField:function O(V,W,U){this.singleSelect(I.find(this.items,W,V),U);},toggleSelect:function Q(U){var W,V;if(this.selectedIndices[U]){V=T(this,[U]);}else{W=F(this,[U]);}C.call(this,W,V,[U]);},select:function(W,V,U){W=J(W);if(!W){return ;}var Y=D(this,U),a=F(this,W,U),X;if(this.selectionPolicy!=="reselect"){for(X=Y.length-1;X>=0;X--){var Z=I.indexOf(a,Y[X]);if(Z>-1){Y.splice(X,1);a.splice(Z,1);}}}C.call(this,a,Y,W,V);},rangeSelect:function H(V,U){var a=this.selectedIndex,Y=a,Z=this.allIdx,W=[],X;if(V===Z||this.selectedIndices[Z]){W.push(Z);}else{if(Y===-1&&this.selectedIndices){for(X in this.selectedIndices){Y=parseInt(X,10);break;}}Y=Y===-1?0:Y;if(Y>V){Y=V;V=a;}for(X=Y;X<=V;X++){W.push(X);}}this.select(W,U);this.selectedIndex=a;},clearSelect:function(U){C.call(this,null,D(this),[],U);if(!U){this.raiseEvent({name:"clearSelection"});}},addSelect:function(X,U,V){X=J(X);if(!X){return ;}var W=F(this,X,V),Z=null,Y=this.noneIdx;if(this.multiSelect&&(Y>-1&&I.indexOf(X,Y)>-1)){Z=T(this,X);}C.call(this,W,Z,X,U);},removeSelect:function(W,U,V){W=J(W);if(!W){return ;}C.call(this,null,T(this,W,V),W,U);},_set_selectedIndices:function P(W,c,U){if(this.selectedItems){this.selectedItems={};}var V=this.selectedIndices;if(V===c){return false;}if(!V){V={};this.selectedIndices=V;}if(!c){c={};}var a=this.selectedIndex,Z=[],b;for(b in V){if(!c[b]){b=parseInt(b,10);delete V[b];Z.push(b);if(a===b){this.selectedIndex=-1;this.selectedItem=null;}}}var f=[],d=this.items,Y=this.itemIdField,e;for(b in c){if(!V[b]){b=parseInt(b,10);V[b]=true;f.push(b);this.selectedIndex=b;e=this.selectedItem=d[b];if(this.selectedItems){this.selectedItems[e[Y]]=e;}}}if(U!==true){var X=[];for(b in c){if(V[b]){b=parseInt(b,10);X.push(b);}}C.call(this,f,Z,X);}return(f.length||Z.length);},_set_selectedIndex:function N(X,V,U){var W={};if(V>-1){W[V]=true;}return this._set_selectedIndices("selectedIndices",W,U);},_set_selectedItem:function E(X,W,V){var U=B.call(this,W);if((U<0)&&(W!==null&&W!==undefined)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(W));U=this.items.length-1;}return this._set_selectedIndex("selectedIndex",U,V);},_addSelections:function(U){return F(this,U);},_removeAll:function(){return D(this);}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var H=mstrmojo.array,B=mstrmojo.hash,J=B.isEmpty;var G=1;function D(Q){return(typeof Q==="object")?Q:{};}function E(R,Q){B.forEach(Q,function(S,V){var T=R[V];if(T===undefined){delete Q[V];return true;}S=Q[V]=D(S);T=R[V]=D(T);if(J(S)&&J(T)){throw (G);}else{if(J(T)){delete R[V];if(J(R[V])){E(R,Q);}}else{if(J(S)){delete R[V];if(J(R[V])){E(R,Q);}}else{try{E(R[V],Q[V]);}catch(U){switch(U){case G:R[V]=Q[V]={};break;}}}}}});}function I(Q){B.forEach(Q,function(R){B.forEach(R,function(U,S){var T=U.include,W=U.exclude;if(J(T)||J(W)){return true;}if(!J(T)&&!J(W)){try{E(W,T);}catch(V){switch(V){case G:R[S]={};break;}}}});});return Q;}function F(S,R,Q){B.forEach(S,function(U,T){if(U===true||J(U)){Q.push(R+T);}else{F(U,R+T+".",Q);}});return Q;}function P(Q){B.forEach(Q,function(R){B.forEach(R,function(U,S){var T=[];F(U.include,"",T);F(U.exclude,"!",T);R[S]=T.join(";");});});return Q;}function K(Q,R){B.forEach(Q,function(S,U){var T=R[U];if(T!==undefined){if(S!==true&&T!==true){K(S,T);}else{if(S===true&&T!==true){R[U]=true;}else{if(S!==true&&T===true){Q[U]=true;}}}}});}function L(R,S){var Q=true;B.forEach(R,function(Y,T){var W=S[T];if(W){var U=Y.include,Z=Y.exclude,X=W.include,V=W.exclude;if(!J(V)&&!J(Z)){Q=false;return Q;}if(!J(X)&&!J(U)){K(X,U);}}return Q;});return Q;}function C(S,Q){Q=Q||{};if(S){var R=Q;H.forEach(S.split("."),function(W,U,T,V){R[W]=V?true:{};R=R[W];});}return Q;}mstrmojo.rw.model.RetrievalKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.RetrievalKeysConfig",init:function M(){this.nodes=[];this.filters={};},addNode:function A(R,T){var S=this.filters,Q=S[R];if(!Q){this.nodes.push(R);Q=S[R]={data:{},defn:{}};}if(T){if(L(Q,T)){S[R]=B.mergeHashes(Q,T);}else{throw ("The new filters for node key ## cannot be merged with the filters currently defined".replace("##",R));}}return this;}});mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig=function O(T){var Q={},U={},S={};H.forEach(T,function R(W){var V=W.partialRetrieval;if(V){H.forEach(V.nodes,function(X){U[X]=true;});S=B.mergeHashes(S,V.filters);delete W.partialRetrieval;}H.forEach(W.actions,R);});if(!J(U)){Q.nodes=B.keyarray(U);}if(!J(S)){Q.filters=P(I(S));}return Q;};mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters=function N(R){var Q=function(T){var S={};B.forEach(T,function(W,V){var U=S[V]={serialized:W,include:{},exclude:{}};H.forEach(W.split(";"),function(Y){var X=Y.indexOf("!")===0;Y=X?Y.slice(1):Y;C(Y,X?U.exclude:U.include);});});return S;};return{data:Q(R.data),defn:Q(R.defn)};};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var B=mstrmojo.hash;mstrmojo.Base=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Base",init:function A(C){B.copy(C,this);if(this.postApplyProperties){this.postApplyProperties();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var N=/\{\@(en@)?([^\}]+)\}/gm,J=/\</gm,R=/\>/gm,E=/\S/,Q=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],F=new RegExp("(\\"+Q.join("|\\")+")","g"),S={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},C={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#039;",'"':"&quot;"},M={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'},D={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#039;",'"':"&quot;","\u20ac":"&#8364;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&#039;":"'","&quot;":'"',"&#8364;":"\u20ac"};var L=function(V){if(V===null){return"null";}var W=typeof V;if(W!=="object"){return W;}if(V.length===undefined){return"object";}return"array";};var T={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function G(W,Z,Y){var V;Y=Y||[];if(!W){return"";}var X=[];for(V in Z){if(mstrmojo.array.indexOf(Y,V)===-1){X.push(V.k||V);}}return W.replace(new RegExp(X.join("|"),"g"),function(a){var b=Z[a];return b.v||b;});},trim:function P(V){return(V&&V.replace)?V.replace(/^\s+/,"").replace(/\s+$/,""):V;},startsWith:function U(W,V){return W.length>=V.length&&W.substring(0,V.length)==V;},ellipsize:function A(X,W){var V=this.trim(X.substr(0,(W||1)-1));if(V!==X){V+="&hellip;";}return V;},isEmpty:function I(V){return(V===null)||(V===undefined)||!(E.test(V));},regEscape:function O(V){return V.replace(F,"\\$1");},encodeXMLAttribute:function(V){return mstrmojo.string.multiReplace(V,S);},encodeHtmlString:function(W,V,X){if(!W||!W.replace){return W;}if(X){return mstrmojo.string.multiReplace(W,D);}return mstrmojo.string.multiReplace(W,C,V?[" "]:[]);},decodeHtmlString:function(W,V){return V?mstrmojo.string.multiReplace(W,K):mstrmojo.string.multiReplace(W,M);},htmlAngles:function(V){if(!mstrmojo.string.isEmpty(V)){V=String(V);return V.replace(J,"&lt;").replace(R,"&gt;");}return V;},apply:function H(V,X){if(!V){return"";}var W=this;return V.replace(N,function Y(b,c,d){var Z;try{Z=mstrmojo.hash.walk(d,X);}catch(a){}Z=(Z===null||Z===undefined)?"":Z;return(!!c)?W.encodeHtmlString(Z,true):Z;});},json2xml:function(V,l,m){if(!(l instanceof Array)){l=[l];}var W=m&&m.isSerializable,k=(m.convertBoolean!==false),p=m&&m.skipFunctions,h,b;var d=[],Z=[],c,Y,a;for(h=0,b=l.length;h<b;h++){var g=l[h];for(c in g){if(p&&typeof g[c]==="function"){continue;}if(W){var o=W(c,l,h);if(o!==true){if(o===false){continue;}else{if(o.att){d.push(o.att);}if(o.child){Z.push(o.child);}continue;}}}Y=g[c];a=L(Y);switch(a){case"array":var e,f;Z.push("<"+c+">");for(e=0,f=Y.length;e<f;e++){var X=m.getArrItemName(c,Y,e)||e;Z.push(this.json2xml(X,Y[e],m));}Z.push("</"+c+">");break;case"object":Z.push(this.json2xml(c,Y,m));break;case"string":d.push(c+'="'+mstrmojo.string.encodeXMLAttribute(Y)+'"');break;case"boolean":d.push(c+'="'+(k?(Y?"-1":"0"):Y)+'"');break;case"null":if(!m.skipNull){d.push(c+'="'+m.nullValue+'"');}break;default:d.push(c+'="'+Y+'"');break;}}}return"<"+V+" "+d.join(" ")+">"+Z.join("")+"</"+V+">";},escape4HTMLText:function B(c){if(!c||!c.replace){return c;}var Z=/"/gm;var X="&quot;";var d=/&/gm;var b="&amp;";var a=/</gm;var V="&lt;";var Y=/>/gm;var W="&gt;";return c.replace(d,b).replace(Z,X).replace(a,V).replace(Y,W);},parseUri:function(Z,W){W=W||T;var V=W.parser[((W.strictMode)?"strict":"loose")].exec(Z),Y={},X=14;while(X--){Y[W.key[X]]=V[X]||"";}Y[W.q.name]={};Y[W.key[12]].replace(W.q.parser,function(b,a,c){if(a){Y[W.q.name][a]=c;}});return Y;},removeSpecialChars:function(V){return V.replace(/[^a-zA-Z0-9]/g,"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.vi.ui.rw.SelectionType={EMPTY:"empty",ATTS:"att",METRICS:"metric",COL_HEADERS:"col-headers",ROW_HEADERS:"row-headers",METRIC_VALUES:"metric-values"};var D=function(Z){var Y=(mstrApp.docModelData&&mstrApp.docModelData.mid)||"";return Z.k+"-"+Y;},M={},Q=mstrmojo.hash,V=mstrmojo.array,S=function(a){var Y=Q.keyarray(a).sort(),Z=[],b;V.forEach(Y,function(c){b=[];V.forEach(a[c],function(d){b.push(this.model.getNormalizedFormElementId(d.id));},this);Z.push(c+"-"+b.sort().join("@"));},this);return Z.join("#");},X=function(Y){var Z=S.call(this,Y);if(!this._viSelections[Z]){this._viSelections[Z]=Y;M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}},C=function(Z){var a=S.call(this,Z),Y=this._viSelections[a];if(Y){delete this._viSelections[a];M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}return Y;},K=function(Z,Y,b){var a={};a[Z]=[{id:Y,n:b}];return a;},O=mstrmojo.vi.ui.rw.SelectionType;mstrmojo.vi.ui.rw._HasVisSelections=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisSelections",{_mixinName:"mstrmojo.vi.ui.rw._HasVisSelections",init:function(Y){if(this._super){this._super(Y);}this._viSelections={};},update:function F(Z){var Y=true;if(this._super){Y=this._super(Z);}Q.copy(M[D(this)],this);return Y;},onSelectionChange:function L(Y){if(this._super){this._super(Y);}},_viSelections:{},_selectionType:O.EMPTY,getSelectionType:function(){return this._selectionType;},isSingleAttrSelection:function(){var Z=null,Y;if(this.getSelectionType()===O.ATTS){Y=this.getSelections();if(Y.length>1){return !Y.some(function(a){if(!Z){Z=a[0].tid;return false;}return Z!=a[0].tid;},this);}return true;}return false;},isSingleSelection:function(){return(this._viSelections&&Q.keyarray(this._viSelections).length===1);},getSelectionSize:function U(){return(this._viSelections&&Q.keyarray(this._viSelections).length)||0;},getSelectionHash:function E(){return this._viSelections;},getSelections:function I(){var Y=[],Z;Q.forEach(this._viSelections,function(a){Z=[];Y.push(Z);Q.forEach(a,function(b,c){V.forEach(b,function(d){Z.push({tid:c,eid:d.id,v:d.n});});});});return Y;},isMetricValueSelected:function G(Y){return !!this._viSelections[S.call(this,Y)];},isAttSelected:function B(Z,Y){return this.isMetricValueSelected(K(Z,Y));},addAttributeSelection:function N(Z,Y,a){if(this._selectionType!==O.ATTS){this.clearSelections();this._selectionType=O.ATTS;}var b=K.call(this,Z,Y,a);X.call(this,b);return b[Z];},removeAttributeSelection:function W(Z,Y){return C.call(this,K.call(this,Z,Y));},addMetricValueSelection:function J(Y){if(this._selectionType!==O.METRICS){this.clearSelections();this._selectionType=O.METRICS;}X.call(this,Y);},removeMetricValueSelection:function R(Y){return C.call(this,Y);},clearSelections:function A(){if(this._super){this._super();}this._viSelections={};this._selectionType=O.EMPTY;},clearSelectionsCache:function H(){M={};},clearUnitSelections:function A(Z){if(this._super){this._super();}var Y={};Q.forEach(this._viSelections,function(b,a){if(Q.keyarray(b)[0]!==Z){Y[a]=b;}});this._viSelections=Y;},endSelections:function P(){M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};this.onSelectionChange(this.getSelectionHash());},addSelectionsFromExpression:function T(a){this.clearSelections();this._selectionType=a.type;var Y=this,Z=function(g){var h=20,e=19,f=function(k){return k.nds.length===1?h:k.fn;},d=function(k){return parseInt(k.et,10)===5||parseInt(f(k),10)===e;},b=function(k){V.forEach(k.es,function(l){Y.addAttributeSelection(k.a.did,l.v,l.n);});},c=function(m){var l={},k=function(o){V.forEach(o.es,function(n){Q.copy(K.call(Y,o.a.did,n.v,n.n),l);});};if(m.nds){V.forEach(m.nds,k);}else{if(m.es){k(m);}}Y.addMetricValueSelection(l);};if(d(g)){g={nds:[g]};}V.forEach(g.nds,function(k){if(d(k)){if(a.type===O.ATTS){b(k);}else{c(k);}}else{Z(k);}});};Z(a.data);}});mstrmojo.vi.ui.rw._HasVisSelections.VisSelectionType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.models.template.Title");mstrmojo.models.template.Titles=mstrmojo.declare(null,null,{init:function D(G){var F=this.gridData=G.data,E=F.gts;this.titles=G.isRow?E.row:E.col;},size:function C(){return this.titles.length;},getTitle:function B(E){return new mstrmojo.models.template.Title({title:this.titles[E]});},getCSS:function A(E){return this.gridData.css[this.titles[E].cni].n;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array;function B(){var H=this.buildConfig=this.buildConfig||{};H.pk=this.k;H.fgk=this.defn&&this.defn.fgk;return H;}mstrmojo._HasBuilder={builder:null,postBuildRendering:function D(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function F(){return this.model.getChildren(this.node,false);},buildChildren:function E(H){if(!this.builder||!this.model){return false;}var J=this.children;if(J&&J.length){this.set("children",[]);}var I=this.builder.build(this.getChildren(),this.model,B.call(this));if(!H){this.addChildren(I);}this.builtChildren=true;return H?I:true;},rebuildChildren:function C(K){var H=this.children.slice(0),I=this.model,J=[];K=K||H.slice(0);K.forEach(function(P){var N=G.indexOf(H,P),O=P.k;if(N===-1){throw new Error("Invalid child requested rebuild in mstrmojo._HasBuilder::rebuildChild.");}this.removeChildren(P);P.destroy();J.push(O);},this);var L=I.getChildrenByKey(this.node,false,J);var M=this.builder.build(L,I,B.call(this));this.addChildren(M);return M;},rebuildChild:function A(H){return this.rebuildChildren([H])[0];}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var C=function(R){var Q=(mstrApp.docModelData&&mstrApp.docModelData.mid)||"";return R.k+"-"+Q;},E={},L=mstrmojo.array;mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",{_mixinName:"mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights",postBuildRendering:function G(){this._super();this.setup();if(!this.getExp()){if(E[C(this)]){this.highlight.apply(this,E[C(this)]);}else{this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}},getExp:function(){var Q=this.model.data,R=Q&&Q.sc&&Q.sc.exp;return R;},clearsBrushingOnHighlight:true,brushSub:null,clearSub:null,getAssociatedNodes:function B(){var Q=this.defn.an;return Q&&Q.length>0?Q:[];},hasAssociatedNodes:function K(){var Q=this.getAssociatedNodes();return Q.length>0;},getDocModelForEvent:function P(){return this.model&&this.model.docModel;},setup:function H(){var Q=this.getDocModelForEvent(),R=this.id;if(Q){[this.brushSub,this.clearSub].forEach(function(S){if(S){S.clear();}});this.brushSub=Q.attachEventListener("brushing",R,this.onBrushing);this.clearSub=Q.attachEventListener("clearBrush",R,this.onClearBrushing);}},handlesMultiSelection:function I(){return(this._super&&this._super())||this.getAssociatedNodes().length>0;},getHighlightKeys:function F(){var R=[],Q=this.getAssociatedNodes();Q.forEach(function(S){R.push(S.k);});return R;},onSelectionChange:function J(R){var S=false;if(this._super){S=this._super(R);}var Q=this.getDocModelForEvent();if(this.clearsBrushingOnHighlight){Q.raiseEvent({name:"clearBrush",from:this});}if(this.handlesMultiSelection()&&!S){Q.raiseEvent({name:"brushing",from:this,keys:this.getHighlightKeys()});return true;}return false;},onBrushing:function A(R){var Q=R.keys.slice();if(Q.indexOf(this.k)!==-1){if(this.highlight){var S=R.from;this.highlight(S.getSelectionType(),S.getSelectionHash());Q.push(S.k);this.getDocModelForEvent().raiseEvent({name:"clearBrush",from:this,excludeKeys:Q});}else{throw new Error(this.scriptClass+" must implement highlight method.");}}},onClearBrushing:function O(R){var Q=false;if(L.indexOf(R.excludeKeys,this.k)===-1){if(this._super){Q=this._super(R);}if(!Q){var S=this.getAssociatedNodes();if(L.find(S,"k",R.from.k)!==-1){this.clearSelections(true);}}}return true;},highlight:function D(){E[C(this)]=arguments;if(this._super){this._super.apply(this,arguments);}},clearSelections:function N(){delete E[C(this)];if(this._super){this._super.apply(this,arguments);}},updateAssociatedNodesOnMove:function M(){this.clearSelections(true);this.endSelections();delete this.defn.an;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array,E=mstrmojo.desc(2412,"Default"),H=mstrmojo.desc(3433,"Font"),B=mstrmojo.desc(3434,"Number"),C=mstrmojo.desc(3435,"Alignment"),A=mstrmojo.desc(2886,"Borders"),F=mstrmojo.desc(3905,"Background");var L=[{n:E,v:"pru"}];G.forEach(["Arial","Arial Black","Arial Narrow","Arial Unicode MS","Batang","Book Antiqua","Bookman Old Style","Comic Sans MS","Courier New","Garamond","Haettenschweiler","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Map Symbols","Marlett","Monotype Corsiva","Monotype Sorts","MS Gothic","MS Outlook","Microsoft Sans Serif","MT Extra","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings"],function(M){L.push({n:M,v:M});});function K(N,M,O){return(M&&M>=N)?K(N,M-O,O).concat(M):[];}var J=K(2,12,1);J=J.concat(K(14,24,2));J=J.concat(K(36,48,12));J=J.concat(K(72,72,1));var D=[{n:E,v:"pru"}];G.forEach(J,function(M){D.push({n:String(M),v:String(M)});});mstrmojo._FormatDefinition={Formats:[{n:H},{n:B},{n:C},{n:mstrmojo.desc(3436,"Color and Lines")}],FormatTarget:[{n:mstrmojo.desc(7942,"Element Header"),v:1,p:"header_format"},{n:mstrmojo.desc(7943,"Element Value"),v:2,p:"grid_format"},{n:mstrmojo.desc(7944,"Individual Items Header"),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945,"Individual Items Value"),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:B},{n:C},{n:H},{n:A},{n:F}],MetricHeaderFormats:[{n:B},{n:C},{n:H},{n:A},{n:F},{n:mstrmojo.desc(12139,"Chart")}],NumberFormatCategory:{Automatic:-3,Default:-2,General:9,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7},DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0"}},Families:L,Sizes:D,SizesInVI:D.slice(7,19),Styles:[{n:E,v:"pru"},{n:mstrmojo.desc(3440,"Regular"),v:"0,0"},{n:mstrmojo.desc(2718,"Bold"),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719,"Italic"),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441,"Bold Italic"),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:E,v:-2},{n:mstrmojo.desc(2378,"General"),v:9},{n:mstrmojo.desc(2050,"Fixed"),v:0},{n:mstrmojo.desc(2051,"Currency"),v:1},{n:mstrmojo.desc(2052,"Date"),v:2},{n:mstrmojo.desc(2170,"Time"),v:3},{n:mstrmojo.desc(2053,"Percentage"),v:4},{n:mstrmojo.desc(2054,"Fraction"),v:5},{n:mstrmojo.desc(2055,"Scientific"),v:6},{n:mstrmojo.desc(2056,"Custom"),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:"-1,234.12",v:1,f:"#,##0.00"},{n:"-1,234.12",r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:"1,234.12",r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:"(1,234.12)",v:3,f:"#,##0.00;(#,##0.00)"},{n:"(1,234.12)",r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:"-$1,234.12",v:1,f:'"$"#,##0.00'},{n:"-$1,234.12",r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:"$1,234.12",r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:"($1,234.12)",v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:"($1,234.12)",r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194,"Left"),v:0},{n:mstrmojo.desc(2195,"Right"),v:1},{n:mstrmojo.desc(2183,"Left with space"),v:2},{n:mstrmojo.desc(2182,"Right with space"),v:3}],Date:[{n:mstrmojo.desc(2231,"4/7"),v:"m/d"},{n:mstrmojo.desc(2232,"04/07"),v:"mm/dd"},{n:mstrmojo.desc(2233,"4/7/98"),v:"m/d/yy"},{n:mstrmojo.desc(2234,"04/07/98"),v:"mm/dd/yy"},{n:mstrmojo.desc(2235,"04/07/1998"),v:"mm/dd/yyyy"},{n:mstrmojo.desc(2236,"7-Apr"),v:"d-mmm"},{n:mstrmojo.desc(2237,"7-Apr-98"),v:"d-mmm-yy"},{n:mstrmojo.desc(2238,"Apr-98"),v:"mmm-yy"},{n:mstrmojo.desc(2239,"Apr '98"),v:"mmm 'yy"},{n:mstrmojo.desc(2240,"April 1998"),v:"mmmm yyyy"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243,"April 7, 1998"),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244,"15:41"),v:"h:mm"},{n:mstrmojo.desc(2245,"3:41 PM"),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246,"15:41:46"),v:"h:mm:ss"},{n:mstrmojo.desc(2247,"3:41:46 PM"),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250,"04/07/98 15:41"),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248,"04/07/98 3:41 PM"),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:E,v:"pru"},{n:mstrmojo.desc(4601,"Horizontal"),v:0},{n:mstrmojo.desc(5156,"-90 Degree"),v:-90}],Horizontal:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2378,"General"),v:1},{n:mstrmojo.desc(2194,"Left"),v:2},{n:mstrmojo.desc(2193,"Center"),v:3},{n:mstrmojo.desc(2195,"Right"),v:4},{n:mstrmojo.desc(2068,"Justify"),v:6}],Vertical:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2256,"Top"),v:1},{n:mstrmojo.desc(2067,"Center"),v:2},{n:mstrmojo.desc(2257,"Bottom"),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:E,v:"pru"},{n:mstrmojo.desc(2258,"None"),v:0},{n:mstrmojo.desc(2259,"Dashed"),v:3},{n:mstrmojo.desc(2260,"Dotted"),v:4},{n:mstrmojo.desc(2261,"Hair"),v:7},{n:mstrmojo.desc(2262,"Thin"),v:1},{n:mstrmojo.desc(2264,"Thick"),v:5},{n:mstrmojo.desc(2265,"Double"),v:6}],extractModel:function(O,Q,N){var S=N||this.DefaultFormat,R;for(R in O){var M=O[R];if(!M.attachEventListener){if(!mstrmojo.hash.isEmpty(M)){Q[R]=M;}}else{var P;for(P in M){if(S[R]&&S[R][P]){if(!Q[R]){Q[R]={};}Q[R][P]=M[P];}}}}},getAvailableFonts:function I(){var M={success:function(O){if(O.name==="fontPicker"){var N=[{n:E,v:"pru"}];mstrmojo.array.forEach(O.shortcuts,function(P){N.push({n:P.attributes[1].value,v:P.attributes[1].value});});mstrmojo._FormatDefinition.Families=N;}}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,M,{taskId:"getSystemPickerJson",name:"fontPicker"},false,null,true);},getStandardFormat:function(N,M){var P=mstrmojo.hash.clone(M||this.DefaultFormat),O;N=N||{};for(O in P){N[O]=N[O]||{};}for(O in N){if(!N[O].attachEventListener){N[O]=mstrmojo.hash.make(N[O],mstrmojo.Obj);}}return N;},saveFormatModel:function(Q,W,N,X){var V=X||this.DefaultFormat,S,M;for(S=0;S<N.length;S++){var R=N[S],P=W[R]||null,U=Q[R];if(U===undefined){delete W[R];continue;}for(M in V){var T=V[M],O;if((!P&&!U)||(P&&!P[M]&&!U[M])){continue;}for(O in T){if(U[M]===undefined||U[M]===""||U[M][O]==="pru"||U[M][O]===undefined){if(P&&P[M]&&(P[M][O]!==undefined&&P[M][O]!==null&&P[M][O]!=="pru")){P[M][O]="pru";}}else{P=P||{};P[M]=P[M]||{};P[M][O]=U[M][O];}}}if(P){W[R]=P;}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var H="#000000",E=Math.round;function N(X){return("0"+parseInt(X,10).toString(16)).slice(-2);}mstrmojo.color=mstrmojo.provide("mstrmojo.color",{rgbStr2rgb:function V(X){return X.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i).slice(1);},rgbStr2hex:function F(X){if(X.indexOf("rgb")>=0){var Y=this.rgbStr2rgb(X);return"#"+this.rgb2hex(Y[0],Y[1],Y[2]);}return X;},rgb2hex:function B(Z,Y,X){return N(Z)+N(Y)+N(X);},rgb2hsv:function U(X,e,k){var a=Math.min(X,e,k),l=Math.max(X,e,k),c=0,o,n;n=l/255;o=(l!==0)?(parseFloat(l)-parseFloat(a))/parseFloat(l):0;if(o===0){c=0;}else{var f=l-a,Y=(l-X)/f,Z=(l-e)/f,m=(l-k)/f;if(X===l){c=m-Z;}else{if(e===l){c=2+Y-m;}else{c=4+Z-Y;}}c=c/6;if(c<0){c=c+1;}}return[E(c*360),E(o*100),E(n*100)];},rgb2hsl:function D(X,c,d){X/=255;c/=255;d/=255;var e=Math.max(X,c,d),Z=Math.min(X,c,d),Y=(e+Z)/2,a,k;if(e===Z){a=k=0;}else{var f=e-Z;k=Y>0.5?f/(2-e-Z):f/(e+Z);switch(e){case X:a=(c-d)/f+(c<d?6:0);break;case c:a=(d-X)/f+2;break;case d:a=(X-c)/f+4;break;}a/=6;}return[a,k,Y];},hsl2rgb:function C(d,k,c){var a=function a(h,g,b){if(b<0){b+=1;}if(b>1){b-=1;}if(b<1/6){return h+(g-h)*6*b;}if(b<1/2){return g;}if(b<2/3){return h+(g-h)*(2/3-b)*6;}return h;},X,e,f;if(k===0){X=e=f=c;}else{var Y=c<0.5?c*(1+k):c+k-c*k,Z=2*c-Y;X=a(Z,Y,d+1/3);e=a(Z,Y,d);f=a(Z,Y,d-1/3);}return[E(X*255),E(e*255),E(f*255)];},hsl2hex:function I(Z,Y,X){return"#"+mstrmojo.array.map(this.hsl2rgb(Z,Y,X),function(a){return N(a);}).join("");},hex2rgb:function P(a){var X=this.fixFullHexValue("#"+a.replace("#","")),Y=[],Z;X=X.replace("#","");for(Z=0;Z<3;Z++){Y.push(parseInt(X.substr(Z*2,2),16));}return Y;},hex2bgr:function K(X){return this.hex2rgb(X).reverse();},hex2hsv:function S(Y){var X=this.hex2rgb(Y);return this.rgb2hsv(X[0],X[1],X[2]);},hex2hsl:function W(X){return this.rgb2hsl.apply(this,this.hex2rgb(X));},hsv2rgb:function G(f,u,n){f=f/360;u=u/100;n=n/100;var X,k,m;if(u===0){X=n*255;k=n*255;m=n*255;}else{var a=f*6;if(a===6){a=0;}var e=Math.floor(a);var Z=n*(1-u);var Y=n*(1-u*(a-e));var o=n*(1-u*(1-(a-e)));var l,c,d;switch(e){case 0:l=n;c=o;d=Z;break;case 1:l=Y;c=n;d=Z;break;case 2:l=Z;c=n;d=o;break;case 3:l=Z;c=Y;d=n;break;case 4:l=o;c=Z;d=n;break;default:l=n;c=Z;d=Y;break;}X=l*255;k=c*255;m=d*255;}return[E(X),E(k),E(m)];},hsv2hex:function L(a,Z,X){var Y=this.hsv2rgb(a,Z,X);return this.rgb2hex(Y[0],Y[1],Y[2]);},getContrastingColor:function M(a,Y,X){var Z=this.hex2rgb(a);return(((Z[0]*299)+(Z[1]*587)+(Z[2]*114))/1000<125)?Y:X;},getHighlightColor:function R(f,d){var X,e,h,k,l=this.hex2rgb(!d?"#FFCE7F":"#EFE6D8"),c=parseInt(f[0],10),Z=parseInt(f[1],10),n=parseInt(f[2],10),a=parseInt(l[0],10),Y=parseInt(l[1],10),m=parseInt(l[2],10);X=(c*a)/255;e=(Z*Y)/255;h=(n*m)/255;k=c*0.3+Z*0.59+n*0.11;if(k<85){X=X+(63*(85-k)/85);X=X>255?255:X;e=e+(63*(85-k)/85);e=e>255?255:e;h=h+(63*(85-k)/85);h=h>255?255:h;}return"#"+this.rgb2hex(E(X),E(e),E(h));},get3DBorderColor:function Q(Z,d){var Y=parseInt(Z[0],10)*0.3+parseInt(Z[1],10)*0.59+parseInt(Z[2],10)*0.11;var c=parseInt(Z[0],10);var a=parseInt(Z[1],10);var X=parseInt(Z[2],10);switch(d){case"light":if(Y>150){c=c*0.9;a=a*0.9;X=X*0.9;}else{c=c*0.6+102;a=a*0.6+102;X=X*0.6+102;}break;case"dark":if(Y>10){c=c*0.4;a=a*0.4;X=X*0.4;}else{c=c*0.8+30;a=a*0.8+30;X=X*0.8+30;}break;}return"#"+this.rgb2hex(E(c),E(a),E(X));},encodeColor:function J(X,Y){if(Y!==undefined&&(X===null||X.length===0||X==="undefined")){X=Y;}if(X==="transparent"){return -1;}if(parseInt(X,10)===-2){return -2;}if(X.substring(0,1)==="#"){X=X.substring(1);}return parseInt(X.substring(4)+X.substring(2,4)+X.substring(0,2),16);},decodeColor:function A(X){X=parseInt(X,10);if(X===0){return H;}var Y=16777216+(X&255)*65536+(X&65280)+(X&16711680)/65536;return"#"+Y.toString(16).substring(1).toUpperCase();},fixFullHexValue:function T(X){if(X&&X.length===4){return X.replace(/([0-9a-f])/ig,"$1$1");}return X;},findMidColorHex:function O(a,Z){var b=this.hex2rgb(a),X=this.hex2rgb(Z),Y=[];b.forEach(function(c,d){Y.push(parseInt((c+X[d])/2,10));});return("#"+this.rgb2hex(Y[0],Y[1],Y[2]));}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo.array;mstrmojo.fe._IsRelationTreeNode=mstrmojo.provide("mstrmojo.fe._IsRelationTreeNode",{createSetHtml:'<span class="mstrmojo-textset mstrmojo-create-set-text" mstrAttach:click >'+mstrmojo.desc(12034,"Create a Set")+"</span>",syncRootOperator:function(){var F=this.parent,H=function(){var J=this.parent,I=[];if(J){I=J.ctxtBuilder.itemWidgets;}return I;},E,D,B,C,G;if(F){E=H.call(this);B=E.length;D=A.find(E,"noRelationOperator",true)!==-1;for(C=0;C<B;C++){G=E[C];G&&G.set("noRelationOperator",D);}this.set("noRelationOperator",D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.models.template.Titles","mstrmojo.models.template.MetricValue","mstrmojo.models.template.Headers","mstrmojo.models.datasets.DataInterface");var O=mstrmojo.array,U=mstrmojo.hash,D=mstrmojo.string,E=mstrmojo.models.datasets.DataInterface,g=D.decodeHtmlString;var G=-1,F=1,W=2,P=3;var N=1,H=2,c=3;function b(l){var m={};U.forEach(l,function(p,o){var n=[];O.forEach(p,function(q){n.push({fillColor:q.fillclr,text:q.n});});m[o]=n;});return m;}function k(o){var z=this.getTotalRows(),q=this.data,t=[],w=q.gts.col[0],n=w?w.es:[],y=n.length,r=0;o=U.copy(o,{minAttribute:1,minMetric:1});if(z<o.minAttribute||y<o.minMetric){throw"Error";}do{var m=this.getRowHeaders(r),p,l={},u=m.size();for(p=0;p<u;p++){while(p<u&&m.getHeader(p).getFormIndex()!==undefined){p++;}if(p<u){var s=m.getHeader(p);l[s.t.n]=s.getName();}}for(p=0;p<n.length;p++){var x=this.getMetricValue(r,p).value;l[n[p].n]={v:x.v,rv:x.rv};}t.push(l);r++;}while(r<z);return t;}function K(m){var l=[],n=this.data.gts.row;O.forEach(n,function(p,o){O.forEach(m,function(q){if(p.id===q.id){l[o]=true;}});});return l;}function Q(AO){var w=this.getTotalRows(),AQ=this.data,u=[],y=AQ.gts.col[0],q=y?y.es:[],AF=q.length,t,AJ=0;AO=U.copy(AO,{minAttribute:1,minMetric:1,colorByInfo:[],hasTitleName:false,hasSelection:false,needDecode:false});if(w<AO.minAttribute||AF<AO.minMetric){throw"Error";}var l=AO.needDecode,AL=AO.hasTitleName,AK=AO.hasSelection,AR=AO.hasThreshold,AD=AO.colorByInfo;var AP=AR?b(AQ.th):undefined;t=K.call(this,AD);do{var n=this.getRowHeaders(AJ),p={},AH,AG=[],AN=AD.length,m={headers:[],values:[],colorInfo:[]};for(AH=0;AH<n.size();AH++){var AI=n.getHeader(AH),AA=AI.getName(),AT=AI.t,s={name:l?g(AA):AA};if(AL){var AS=AT&&AT.n;s.tname=l?g(AS):AS;}if(AK){var AC=AT&&AT.id,x=AI.getElementId();s.attributeSelector={n:AA,tid:AC,eid:x,isSelectAttr:true};p[AC]=[{n:AA,id:x}];}if(AN&&t[AH]===true){var z=AI.getElementId();AG.push(z);}m.headers.push(s);}if(AN){m.colorInfo=AG;}for(AH=0;AH<q.length;AH++){var AE=this.getMetricValue(AJ,AH).value,AM={v:AE.v,rv:AE.rv};if(AR){var r=AP[AH],o=r&&r[AE.ti];if(o){AM.threshold=o;}}if(AL){var AB=this.getColTitles().titles[0].es[AH].n;AM.name=l?g(AB):AB;}m.values.push(AM);}if(AK){m.metricSelector=p;}u.push(m);AJ++;}while(AJ<w);return u;}function A(AE){var AH=this.data,p=this.getTotalRows(),q=AH.gts.col[0],n=q?q.es:[],t=n.length,u={},w=[],y,z=0,x;AE=U.copy(AE,{minAttribute:1,minMetric:1,descKey:"name",childrenKey:"children",hasTitleName:false,hasSelection:false,needDecode:false,nestedLevel:undefined,colorByInfo:[]});if(p<AE.minAttribute||t<AE.minMetric){throw"Error";}var o=AE.descKey,r=AE.childrenKey,l=AE.needDecode,AB=AE.hasTitleName,AA=AE.hasSelection,m=AE.nestedLevel||0,AG=AE.hasThreshold,s=AE.colorByInfo,AC=s.length;var AF=AG?b(AH.th):undefined;u[o]="root";y=K.call(this,s);var AD=function(AZ,AJ,AQ,AS,AM){var AN=(AZ[r]=AZ[r]||[]),Aa=AJ.getHeader(AQ),Ac=Aa&&Aa.t,AX=Ac&&Ac.id,AV=Aa&&Aa.getName(),AR=AJ&&AJ.headers&&AJ.headers.length||0,Ab,AU=Aa&&Aa.getElementId(),AI=O.filterOne(AN,function(Ae){return(Ae._eid===AU);});Ab=O.some(y,function(Af,Ae){return Af&&((AQ-Ae)%AR===0);});if(AC&&Ab){w.push(AU);}if(!AI||(AQ===m-1)){AI={_eid:AU};var AP=(Aa!==undefined);if(AP){AI[o]=l?g(AV):AV;}if(AB&&AP){var Ad=Ac&&Ac.n;AI.tname=l?g(Ad):Ad;}if(AA&&AP){AI.attributeSelector={n:AV,tid:AX,eid:AU,isSelectAttr:true};}AN.push(AI);}if(AA&&AP){AM[AX]=[{n:AV,id:AU}];}if(AQ<AJ.size()-1&&(!m||(AQ<m-1))){AD.call(this,AI,AJ,AQ+1,AS,AM);}else{var AT=this.getMetricValue(AS,0).value;if(AT){AI.value=AT.rv;AI.formattedValue=AT.v;}if(AC){AI.colorInfo=w;w=[];}AI.values=[];for(x=0;x<n.length;x++){var AY=this.getMetricValue(AS,x).value,AK={v:AY.v,rv:AY.rv};if(AG){var AO=AF[x],AL=AO&&AO[AY.ti];if(AL){AK.threshold=AL;}}if(AB){var AW=this.getColTitles().titles[0].es[x].n;AK[o]=l?g(AW):AW;}AI.values.push(AK);}if(AA){AI.metricSelector=AM;}}};do{AD.call(this,u,this.getRowHeaders(z),0,z,{});z++;}while(z<p);return u;}function C(l,m){var n=[];O.forEach((l.row||[]).concat(l.col||[]),function(o){if((o.id===m)&&(o.fs)){n=n.concat(o.fs);}});return n;}mstrmojo.models.template.DataInterface=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.models.template.DataInterface",data:null,init:function(l){this.data=l;},getRowTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:true});},getColTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:false});},getTotalRows:function V(){if(this.data.eg){return 0;}var n=this.data,m=n&&n.ghs,l=m&&m.rhs,o=l&&l.items;return(o&&o.length)||0;},getTotalColHeaderRows:function T(){var l=this.data.ghs.chs.items;return(l&&l.length)||0;},getTotalCols:function Y(){return this.getColHeaders(0).size();},getRowHeaders:function J(l){return new mstrmojo.models.template.Headers({data:this.data,i:l,isRow:true});},getColHeaders:function a(l){return new mstrmojo.models.template.Headers({data:this.data,i:l,isRow:false});},getMetricValue:function I(n,l){var m=this.data;return new mstrmojo.models.template.MetricValue({data:m,value:m.gvs.items&&m.gvs.items[n].items[l]});},getColumnHeaderCount:function M(){var l=this.data.gvs.items;return l?l[0].items.length:0;},getCSSString:function f(){return this.data.cssString;},isEmpty:function S(){var l=this.data.gsi;return !l||(!l.rows.length&&!l.cols.length&&!l.mx.length);},getAggregatePadding:function e(){var m=this.data.gsi&&this.data.gsi.fmts,n=function(p,o){return p+o;},l=function(p){var o=0;return["ch","rh","va"].map(function(q){var r=false;return p.map(function(s){if(m[q]&&m[q].hasOwnProperty(s)){if(!r){r=true;o++;}return m[q][s];}return 0;}).reduce(n)/p.length;}).reduce(n)/(o||1);};if(!m){return null;}return{v:l(["tp","bp"]),h:l(["rp","lp"])};},getColResizeScenario:function B(){var l=this.data;if(l.afw){return F;}else{if(l.afc===false){return P;}else{return W;}}},getColResizeInfo:function L(q){var r=this.data,o={v:this.getColResizeScenario(),widths:null};var s=r.gsi,m=r.gts||{},w=[],p=r.twm||{},t=p.top||[],u=p.bottom||[],n=0,l=function(y,x){if(s){s[y].every(function(AA){var AB=AA.did,AC=C(m,AB),z=E.getFormsByAttrId(AB,q);(AC.length?AC:[]).forEach(function(AF,AE){var AG=z[O.find(z,"fid",AF.id)],AD=(u&&u[n])||{};w.push({n:AA.n+(z.length?(" - "+AG.fnm):""),did:AB,depth:AE+1,t:AA.t||4,width:parseInt(AD.w||0,10),widthModel:{top:(t&&t[n])||{},bottom:AD}});n++;});return !x;});}};l("rows",false);l("mx",s.tma===1);o.widths=w;return o;},getRowResizeScenario:function R(){return !!this.data.rh?P:W;},getRowResizeInfo:function X(){var m=this.data,l=m.rh;return{v:this.getRowResizeScenario(),height:(l===undefined||l==="")?m.xrh:l};},getColumnHeaderData:function h(){var r=this.data,x=r.gts,w=r.gts.rec,y=[],m=[],t=x.row;O.forEach(t,function(AA){var z=AA.fs,AB=AA.otp===G;if(z&&z.length>1){O.forEach(z,function(){y.push(AA);});}else{y.push(AA);}if(AB){m=AA.es;}});var q=x.col;if(q&&q.length>0){var p=r.ghs,n=p.chs,l=n.items,u=l[l.length-1].items,o=function o(z){var AA=z.pi,AB=AA&&AA.ci,AC=AA&&AA.ri;if(z.mix!==undefined){return z;}if(AC===undefined||AB===undefined){return ;}return o(l[AC].items[AB]);};O.forEach(q,function(z){var AA=z.otp===G;if((AA&&(!w||t.length===0))){y.push(z);}if(AA){m=z.es;}});var s=y.length;O.forEach(u,function(z){delete z._ridx;});if(m.length>0){O.forEach(u,function(AC){var z=o(AC);var AD=z?z.mix:(AC.pi?0:AC.idx),AB=m[AD]||m[0];var AA=AB._ridx=AB._ridx||[];if(AA.length===0){O.forEach(u,function(AF,AG){var AE=o(AF);if(!z||AE.mix===AD){AA.push(s+AG);}});}y.push(AB);});}}else{if(m.length>0){y.push(m[0]);}}return y;},getUnitById:function Z(n){var m=this.data.gsi,l=null;[m.rows,m.cols,m.mx].some(function(o,p){if(p===2){p=-2;}o.some(function(q,r){if(q.did===n){l={axis:p+1,depth:r+1,unit:q};}return !!l;});return !!l;});return l;},getRawData:function d(l,m){switch(l){case H:return k.call(this,m);case c:return Q.call(this,m);}return A.call(this,m);}});mstrmojo.models.template.DataInterface.inflateGridData=function(n){var o=n.gvs,m=n.ghs;if(n.egt===undefined&&(n.eg===undefined||n.eg===null)&&!!o&&U.isEmpty(o)){var l={v:"",rv:""},p={items:(m.chs.cws||[0]).map(function(){return l;})};o.items=m.rhs.items?m.rhs.items.map(function(){return p;}):[];o.show=true;}};mstrmojo.models.template.DataInterface.ENUM_GRID_RESIZE={FIT_TO_WINDOW:F,FIT_TO_CONTENTS:W,FIXED:P};mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT={TREE:N,ROWS:H,ROWS_ADV:c};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.vi.ui.rw._HasVisSelections");var D=mstrmojo.hash;var E=mstrmojo.vi.ui.rw.SelectionType;function L(T){var N=[],R,P,O=K.call(this),Q=!!T?T.length:0,S,U;for(R=0;R<Q;R++){S=T[R];U=this.model.getLinkedAttributes(S)||[];U=[S].concat(U);for(P=0;P<U.length;P++){if(O.hasOwnProperty(U[P])){N.push({id:S,columnIndex:O[U[P]]});break;}}}return N;}function K(){var Q=this.primaryModel,T=Q.getRowTitles(),R,P,N=T.size(),O={},S;if(N>0){for(P=0;P<N;P++){S=T.getTitle(P);R=S.getUnitId();O[R]=P;}}return O;}function B(Q,N,P){var S,O,R=!!Q?Q.length:0;for(O=0;O<R;O++){S=Q[O];if(M.call(this,S,N,P)){return S;}}return null;}function M(N,O,T){var U,P=this.primaryModel,V,S,R,Q;if(!N){return false;}Q=N.attributes;if(!!Q&&(Q.rowIndex===undefined)&&this.updatePolygonGraphicInfo){this.updatePolygonGraphicInfo(N);}U=!!Q?Q.rowIndex:-1;if(U!==-1){V=P.getRowHeaders(U);S=V.getHeader(T);if(S){R=S.getElementId();if(this.model.compareElementsId(R,O)){return true;}}}return false;}function I(S){var W=S[D.keyarray(S)[0]],T=D.keyarray(W),Y=[],Q=this.getAllGraphics(),X=L.call(this,T),V,O,Z,U,R,P,N;if(!X||X.length===0){return Y;}for(U in S){if(S.hasOwnProperty(U)){Z=S[U];O=null;N=false;for(R=0;R<X.length;R++){V=X[R];if(Z.hasOwnProperty(V.id)){P=Z[V.id][0].id;if(R===0){O=B.call(this,Q,P,V.columnIndex);if(O){N=true;}else{break;}}else{N=M.call(this,O,P,V.columnIndex);if(!N){break;}}}}if(N){Y.push(O);}}}return Y;}function G(W){var Y,c,a,N,X,T,P,Q,S=this.getAllGraphics(),R=K.call(this),Z,b=[],V,U,O;for(Y in W){if(W.hasOwnProperty(Y)){c=W[Y];for(a in c){O=this.model.getLinkedAttributes(a)||[];O=[a].concat(O);if(c.hasOwnProperty(a)){N=c[a];T=N.length;for(V=0;V<T;V++){X=N[V];P=X.id;for(U=0;U<O.length;U++){if(R.hasOwnProperty(O[U])){Z=R[O[U]];Q=B.call(this,S,P,Z);if(!!Q&&!Q.addedToResult){Q.addedToResult=true;b.push(Q);}break;}}}}}}}for(V=0;V<b.length;V++){delete b[V].addedToResult;}return b;}mstrmojo.gmaps._SupportMapBrushesAndHighlights=mstrmojo.provide("mstrmojo.gmaps._SupportMapBrushesAndHighlights",{_mixinName:"mstrmojo.gmaps._SupportMapBrushesAndHighlights",_highlights:[],mapSelectionType:E.METRICS,init:function J(N){if(this._super){this._super(N);}this._selectionType=this.mapSelectionType;},getDocModelForEvent:function H(){return this.parent.parent.model;},highlight:function C(T,R,N){if(this._super){this._super.apply(this,arguments);}var S,O,U,Q,P=this.parent.esriMap,V=this.getHighlightedGraphics(this.geoPosition);this.parent.doClearRectangle(true);if(!N){this.clearHighlights();this.parent.clearMarkerSelections();}if(T===E.METRICS){U=I.call(this,R);}else{if(T===E.ATTS){U=G.call(this,R);}}if(!!U&&U.length>0){Q=U.length;for(S=0;S<Q;S++){O=U[S];this.handleSelection(O,null,true);}}this._highlights=U||[];},clearSelections:function F(){if(this._super){this._super();}this._selectionType=this.mapSelectionType;this.clearHighlights();this.parent.clearMarkerSelections();},clearHighlights:function A(){var O,R,P=this._highlights.length,Q,N;if(P>0){for(O=0;O<P;O++){R=this._highlights[O];this.clearHighlight(R);}}if(!this.currentSelections||this.currentSelections.length===0){Q=this.getSelectionHash();for(N in Q){if(Q.hasOwnProperty(N)){delete Q[N];}}}this._highlights=[];}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var T=mstrmojo.dom,K=mstrmojo.string,X=mstrmojo.array;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:T.isNSIE?"block":"table",DISPLAY_CELL:T.isNSIE?"block":"table-cell",MINHEIGHT:T.isIE6?"height":"minHeight",addClass:function L(e,d){if(e){if(d.constructor!==Array){d=[d];}var Z=e.className||"",g=" "+Z+" ",a=false,Y=d.length,b;for(b=0;b<Y;b++){var f=d[b];if(!g.match(new RegExp("\\s"+f+"\\s"))){Z+=" "+f;a=true;}}if(a){e.className=K.trim(Z);}}return e;},removeClass:function N(c,b){if(!c){return ;}if(b.constructor!==Array){b=[b];}var Z=" "+(c.className||"")+" ",Y=b.length,a;for(a=0;a<Y;a++){Z=Z.replace(new RegExp("\\s"+b[a]+"\\s","g")," ");}c.className=K.trim(Z);},addWidgetCssClass:function M(d,b){var Z=d.cssClass,c=(Z&&Z.split(" "))||[],a;b=[].concat(b);for(a=0;a<b.length;a++){var Y=b[a];if(X.indexOf(c,Y)===-1){c.push(Y);}}d.cssClass=c.join(" ");},removeWidgetCssClass:function F(e,c){var Z=e.cssClass,d=(Z&&Z.split(" "))||[],b;c=[].concat(c);for(b=0;b<c.length;b++){var Y=c[b];var a=X.indexOf(d,Y);if(a!==-1){d.splice(a,1);}}e.cssClass=d.join(" ");},toggleClass:function S(a,Z,Y){if(Y){this.addClass(a,Z);}else{this.removeClass(a,Z);}},applyShadow:function G(c,d,b,a,Y){var Z=c.style;if(T.isDXIE){Z.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+d+"px, OffY="+b+"px, Color='"+Y+"')";}else{if(T.isFF||T.isWK||T.isIE10){Z[T.CSS3_BOXSHADOW]=d+"px "+b+"px "+a+"px "+Y;}}},removeShadow:function B(Z){var Y=Z.style;if(T.isFF||T.isWK||T.isIE10){Y[T.CSS3_BOXSHADOW]="";}},setOpacity:function U(Z,b){if(T.isDXIE&&!T.isIE9){var c=Z.currentStyle.filter;var Y=null;if(c.length>0){Y=Z.filters["DXImageTransform.Microsoft.Alpha"];}if(Y){Y.opacity=b;Y.enabled=(b!==100);}else{if(b<100){var a="progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")";Z.style.filter=(c||"")+" "+a;}}}else{Z.style.opacity=b/100-(T.isIE9?0.00001:0);}},buildGradient:function O(Z,b,Y){if(T.supports(T.cssFeatures.GRADIENTS)){var a={};if(T.isDXIE){a.n="filter";a.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+Z+",StartColorStr='"+b+"',EndColorStr='"+Y+"')";}else{if(T.isFF){a.n="background-image";a.v="-moz-linear-gradient("+((Z===0)?"top":"left")+","+b+","+Y+")";}else{if(T.isWK){a.n="background";a.v="-webkit-gradient(linear,"+((Z===0)?"left top, left bottom":"left top, right top")+",from("+b+"),to("+Y+"))";}else{if(T.isIE10||T.isIEW3C){a.n="background";a.v="linear-gradient("+((Z===0)?"to bottom":"to right")+","+b+","+Y+")";}}}}return a;}return null;},buildRoundCorners:function Q(d,c){if(T.supports(T.cssFeatures.ROUND_CORNERS)){var Z=d+"px";var f=Z+(c?" "+Z+" 0 0":"")+";";if(T.isFF||T.isWinPhone||T.isIE10){return"border-radius:"+f;}if(T.isWK){if(!c){return"-webkit-border-radius:"+Z+";";}var e=["left","right"],b=[],Y=-1,a;for(a=0;a<2;a++){b[++Y]="-webkit-border-top-"+e[a]+"-radius:"+Z;b[++Y]="-webkit-border-bottom-"+e[a]+"-radius:0";}return b.join(";");}}return"";},getBorderWidthsOrPaddings:function D(Z,e){var f={t:0,r:0,b:0,l:0,h:0,w:0};if(!Z){return f;}var c=Z.split(" "),Y=c.length,d;for(d=0;d<Y;d++){c[d]=Math.round(e*parseFloat(c[d])/72);}if(Y<4){if(Y===1){c[1]=c[2]=c[3]=c[0];}else{c[3]=c[1];if(Y===2){c[2]=c[0];}}}f.t=c[0];f.r=c[1];f.b=c[2];f.l=c[3];f.h=f.t+f.b;f.w=f.l+f.r;return f;},getBorderWidths:function H(Z,Y){return this.getBorderWidthsOrPaddings(Z,Y);},getPaddings:function C(Z,Y){return this.getBorderWidthsOrPaddings(Z,Y);},parkAfterFade:function A(Y){var Z=Y.target.style;if(Z.opacity===0){Z.left="-10000px";window.setTimeout(function(){Z.opacity=0.99;},0);return true;}return false;},getStyleValue:function I(Y,c){var a=(c==="float"),b;if(Y.currentStyle){c=a?"styleFloat":c;b=Y.currentStyle[c];}else{if(document.defaultView&&document.defaultView.getComputedStyle){c=a?"cssFloat":c;var Z=document.defaultView.getComputedStyle(Y,null);b=Z?Z[c]:null;}}return b;},getComputedStyle:function R(Y,a){var Z=(window.getComputedStyle)?function(b,c){return window.getComputedStyle(b,c||null);}:function(b){return b.currentStyle||{};};mstrmojo.css.getComputedStyle=Z;return Z(Y,a);},getCssTextFromObj:function E(a){var Z="",Y;for(Y in a){Z+=Y+":"+a[Y]+";";}return Z;},onTransitionEnd:function W(a,Y){var Z="transition",b=window.Modernizr;if(b.testProp(Z)){T.attachOneTimeEvent(a,T.transEndEvtNames[b.prefixed(Z)],Y);}else{window.setTimeout(Y,0);}},flashClass:function P(Z,Y,b){this.toggleClass(Z,Y,true);var a=this;window.setTimeout(function(){a.toggleClass(Z,Y,false);},b);},convertCssToCamelCase:function J(Y){return Y.replace(/\-([a-z])/gi,function(Z,a){return a.toUpperCase();});},printCSSInfo:function V(c){var g=document.styleSheets,l=g.length,d,e;for(e=0;e<l;e++){var f=g[e],h=f.cssRules,a=h?h.length:0,k=0;for(d=0;d<a;d++){var Y=h[d].selectorText;if(Y){try{k+=Y.split(",").length;}catch(b){}}}var Z=f.href;if(!c||(Z&&X.indexOf(Z,c)>-1)){console.log("Stylesheet: "+Z||"Inline CSS Block");console.log("Total rules: "+a);console.log("Total selectors: "+k);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string","mstrmojo.array");var N=mstrmojo.locales,I=mstrmojo.string,Q=window.mstrConfig,F=mstrmojo.array,K=function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},R=function(){return mstrmojo.locales.number.DECIMALSEPARATOR;},C=Q.units,T={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},A={1:"cm",2:"in",3:"mm",4:"pt",5:"pc",6:"px"},E={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var G=96;String.prototype.reverse=function(){var W="",V;for(V=this.length;V>0;--V){W+=this.charAt(V-1);}return W;};function M(V,X){V=V||"";X=X||V.match(/\".+?\"/g)||[];for(var W=0;W<X.length;W++){V=V.replace(X[W],X[W].substring(1,X[W].length-1).replace(/\$/g,"$$$$"));}return V;}function U(a){var V=86400000,Z=new Date(1900,0,1,0,0,0,0),W=Math.floor(a)-1,Y=a-W-1;if(a>=59){W--;}var X=new Date(Z.getTime()+(W*V));X.setTime(X.getTime()+Y*V+500);return X;}function H(Z,g,l){var a={"d+":Z.getDate(),"h+|H":Z.getHours(),"s+":Z.getSeconds()},V=N.datetime,b;if(/(y+)/.test(g)){var Y=Z.getFullYear().toString(),f=RegExp.$1,X=f.length===2,W=Y.length;g=g.replace(f,Y.substr(X?W-2:0,X?2:W));}if(/(^\[h\])/.test(g)&&l){g=g.replace(RegExp.$1,""+(Math.floor(l*24)));}if(/(\"?:\"?mm)/.test(g)){var c=Z.getMinutes();g=g.replace(RegExp.$1,":"+(RegExp.$1.length===1?c:("00"+c).substr(c.toString().length)));}if(/(AM\/PM)/.test(g)){var h=a["h+"],d=h>11;a["h+"]=h-(d?12:0);g=g.replace(RegExp.$1,d?"PM":"AM");}for(b in a){if(new RegExp("("+b+")").test(g)){g=g.replace(RegExp.$1,RegExp.$1.length===1?a[b]:("00"+a[b]).substr((a[b].toString()).length));}}if(/(mmmm)/.test(g)){g=g.replace(RegExp.$1,V.MONTHNAME_FULL[Z.getMonth()]);}else{if(/(mmm)/.test(g)){g=g.replace(RegExp.$1,V.MONTHNAME_SHORT[Z.getMonth()].substr(0,3));}else{if(/((m|M)+)/.test(g)){var e=(Z.getMonth()+1).toString();g=g.replace(RegExp.$1,RegExp.$1.length===1?e:("00"+e).substr(e.length));}}}return M(g);}function O(W,Z){var X=0,V=Z.length,Y=0;for(;X<V;X++){if(Z[X]==="0"){Y++;}else{if(Z[X]==="#"){if(Y<W){Y++;}}else{continue;}}}return Y;}mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function D(V){var Y=K(),X=new RegExp("^(-)?[0-9]{1,3}(\\"+Y+"[0-9]{3})*$"),W=new RegExp("^(-)?[0-9]+$");return(String(V).indexOf(Y)&&X.test(V))||W.test(V);},isNumeric:function P(Y,Z){var X=R(),a=K(),W=new RegExp("^(-)?[0-9]{1,3}(\\"+a+"[0-9]{3})*(\\"+X+"[0-9]+)?$"),V=new RegExp("^(-)?[0-9]*(\\"+X+")?[0-9]+$");return(String(Y).indexOf(a)&&W.test(Y))||V.test(Y);},parseInteger:function L(V,W){if(!this.isInt(V)){return Number.NaN;}return parseInt(this.toString(V,true),W);},parseNumeric:function B(V){if(!this.isNumeric(V)){return Number.NaN;}return parseFloat(this.toString(V,true));},inNumericRange:function S(W,X,V){W=this.parseNumeric(W);V=(V!=null)?this.parseNumeric(String(V)):Number.NaN;X=(X!=null)?this.parseNumeric(String(X)):Number.NaN;if(V!=Number.NaN&&(W>V||isNaN(W))){return 1;}if(X!=Number.NaN&&(W<X||isNaN(W))){return -1;}return 0;},convertToUSUnits:function(Y,X,W){var V=Y;X=X||C;switch(parseInt(X,10)){case T.CM:V=parseFloat(this.toString(Y))/2.54+"";break;case T.MM:V=parseFloat(this.toString(Y))/25.4+"";break;case T.PT:V=parseFloat(this.toString(Y))/72+"";break;case T.PC:V=parseFloat(this.toString(Y))/6+"";break;case T.PX:V=parseFloat(this.toString(Y))/G+"";break;}return W?V:this.toLocaleString(V);},convertToLocalUnits:function(Y,X,W){var V;X=X||C;switch(parseInt(X,10)){case T.CM:V=(parseFloat(this.toString(Y))*2.54).toFixed(4)+"";break;case T.MM:V=(parseFloat(this.toString(Y))*25.4).toFixed(4)+"";break;case T.PT:V=(parseFloat(this.toString(Y))*72).toFixed(4)+"";break;case T.PC:V=(parseFloat(this.toString(Y))*6).toFixed(4)+"";break;case T.PX:V=(parseFloat(this.toString(Y))*G)+"";break;default:V=parseFloat(this.toString(Y)).toFixed(4)+"";}return W?V:this.toLocaleString(V);},convertUnits:function(W,X,V){return this.convertToLocalUnits(this.convertToUSUnits(V,W,true),X,true);},toLocaleString:function(V){return(V+"").replace(".",R());},toString:function(X,V){if(V===true){var W=this.getThousandSepRegex();if(W){X=String(X).replace(W,"");}}return String(X).replace(R(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(K().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(X,W){var V=W;if(W=="."||W=="*"||W=="\\"){V="\\"+W;}return X.reverse().replace(/(\d{3})/g,"$1"+W).reverse().replace(new RegExp("^(-)?"+V),"$1");},format:function(Z,Y,c,V){var b="",a=(Y>0)?".":"",W=[];c=(c)?c:"";for(var X=0;X<Y;X++){W.push("0");}W=W.join("");switch(Z){case E.GENERAL:b="0.00";break;case E.PERCENT:b="0"+a+W+"%";break;case E.SCIENTIFIC:b="0"+a+W+"E+00";break;default:b='"'+c+'"#,##0'+a+W;}return this.formatByMask(b,V);},getDecimalLength:function J(X){var V=X.indexOf("."),Y=0;if(V!==-1){var W=X.substr(V+1,X.length).match(/\d+/);if(W&&W.length>0){Y=W[0].length;}}return Y;},formatByMask:function(AB,AR){var y,r;if(isNaN(AR)){y=new Date(AR);if(isNaN(y)){return AR;}r=true;}if(AB==="General"){return String(parseFloat(AR).toFixed(2));}var q=String(AB).split(";"),l="",Y=q[0],h="\u00A4",AK=/"[^"]*"/g,k=(AB&&AB.replace(AK,h).replace(/\[.*\]/g,h))||"",AQ=["m","y","d","h","s"],AG=false;F.forEach(AQ,function(m){AG=AG||k.indexOf(m,0)!==-1;});if(AG){if(window.SSF){l=window.SSF.format(AB,AR);}if(l!==""){return l;}else{return H(r?y:U(AR),AB,AR);}}var AF=Y.indexOf("E+"),e=Y.indexOf("%"),u=Y.match(/\".+?\"/g),w=Y.indexOf("?/?")>-1,z=(AF!=-1)?E.SCIENTIFIC:((e!=-1)?E.PERCENT:((u)?E.CURR:w?E.FRACTION:E.FIXED)),p="",AM="",n=false,W=new String(AR),d=this.parseNumeric(AR)||parseFloat(AR);if(u){if(Y.match(/\[\$.+?\]/g)){for(var f=0;f<u.length;f++){Y=Y.replace(u[f],u[f].substring(1,u[f].length-1));if(u[f].match(/\[\$.+?\]/g)){u[f]=u[f].replace(/\[\$.+?\]/g,u[f][u[f].indexOf("[$")+2]);}}Y=Y.replace(/\[\$.+?\]/g,'"#"'.replace("#",Y[Y.indexOf("[$")+2]));}p=M(Y,u);p=p.replace(Y.replace(/\".+?\"/g,""),h);}if(d<0){W=W.substring(1,W.length);d=-d,n=true;if(q.length>1){var b=q[1].replace(/\[.*\]/,"");AM=M(b.replace(q[0],h));}}var c=function(AU,m){return(m)?m.replace(h,AU):"-"+AU;};if(z==E.FRACTION){var AJ,AI,AP,o=10,x,t=0,AD,AL,Z,X=false,AA;if(AB.indexOf("# ")>-1){X=true;}for(AJ=5;AJ>0;AJ--){AA="/";for(AI=0;AI<AJ;AI++){AA+="?";}if(AB.indexOf(AA)>-1){for(AI=1;AI<AJ;AI++){o*=10;}break;}}if(X){t=Math.floor(Number(d));d-=t;}AL=o/2;AP=-1;AD=d*o;for(AJ=o-1;AJ>=2;AJ--){Z=(AD*AJ)/o;Z=Z-Math.floor(Z);Z=Z*o;if(Math.abs(Z-o)<Z){Z=Math.abs(Z-o);}Z=Z/AJ;if(Z<AL){AL=Z;AP=AJ;}else{if((Z==AL)&&(Z==0)){AL=Z;AP=AJ;}}}x=Math.round(AP*AD/o);for(AJ=AP;AJ>=2;AJ--){if((x%AJ==0)&&(AP%AJ==0)){x=x/AJ;AP=AP/AJ;break;}}if(AP==o){AP=1;x=0;}if(x==0){AP=1;}if(x==AP){if(X){l=""+(t+1);}else{l="1";}}else{if(X&&t>0){if(x==0){l=t;}else{l=t+" "+x+"/"+AP;}}else{if(x==0){l="0";}else{l=x+"/"+AP;}}}if(n){l=c(l,AM);}}else{if(z==E.SCIENTIFIC){if(d!=0){var AS=Math.floor(Math.log(d)/Math.LN10),AH=d/Math.pow(10,AS),AT=Y.substring(0,AF),g=AT.indexOf("."),AC=Y.length-Y.indexOf("E+")-(""+Math.abs(AS)).length-2,AJ,V=AS<0;AS=Math.abs(AS);for(AJ=0;AJ<AC;AJ++){AS="0"+AS;}l+=Number(AH).toFixed((g!=-1)?AT.length-g-1:0);l=((n)?c(l,AM):l)+"E"+(V?"-":"+")+AS;}else{l="0";}}else{if(z==E.PERCENT){Y=Y.substring(0,Y.length-1);W=String(d*100);}var g=Y.indexOf("."),a=0,AO,s=g>=0?Y.substring(0,g):Y;if(s.match(/[#0\?],$/)){d/=1000;W=String(d);}AO=this.getDecimalLength(W);if(g!=-1){a=O(AO,Y.substr(g+1,Y.length));}l=String(parseFloat(W).toFixed(Math.min(a,20)));var AN=l.split(".");var AE=Y.replace(/"[^"]*"/g,"").match(/[#\d]+[^\.\d#]+[#\d]+/);if(AE!==null){AN[0]=this.addSeparators(AN[0],K());}l=AN.join(R());if(z==E.CURR){l=p.replace(h,l);if(l===p&&window.SSF){l=window.SSF.format(AB,AR);}}if(z==E.PERCENT){l+="%";}if(n){l=c(l,AM);}}}return l;},validateFormat:function(V){var W=true,X=String(V).split(";");if(X[1]&&X[1].indexOf(X[0])<0){W=false;}return W;},generateUniqueID:function(V){var X="0123456789ABCDEF".split(""),Y=[];for(var W=0;W<V;W++){Y[W]=X[0|Math.random()*16];}return Y.join("");},countOfDecimals:function(W,X){var V=String(W);return V.length-(V.indexOf(X!==undefined?X:R())+1);}});mstrmojo.num.UNIT=T;mstrmojo.num.UNIT_SYMBOL=A;})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.hash");var M=mstrmojo.string,L=mstrmojo.hash,E=mstrmojo.dom;var R=mstrmojo.usesFrames?null:document.createElement("span");var J=/mstrAttach:([\w,]+)/g;var Q;function U(a){if(Q===undefined){Q=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return a.replace(J,function Z(g,k){var c=k.split(","),d=[],b=c.length,f;for(f=0;f<b;f++){var h=c[f];if(h){if(Q){if(h.indexOf("mouse")>-1){continue;}else{if(h==="click"){h="touchend";}}}d.push("on"+h+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+h+"', self, event)\"");}}return d.join(" ");});}var N="preBuildRendering",C="buildRendering",B="postBuildRendering";function X(b){var a=b.markupString;if(a.match(/mstrAttach:/)){a=U(a);if(b.markupString===b.constructor.prototype.markupString){b.constructor.prototype.markupString=a;}}var Z=M.apply(a,b);if(Z){if(mstrmojo.usesFrames){var c=(b.domNode&&b.domNode.ownerDocument)||window.document;if(!R||R.ownerDocument!==c){R=c.createElement("span");}}R.innerHTML=Z;var e=R.removeChild(R.firstChild);e.mstrmojoId=b.id;return e;}return null;}function A(b){var a=b.markupSlots,Z,c;if(a){Z={};for(c in a){Z[c]=a[c].call(b);}}return Z;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{markupString:null,markupMethods:null,markupSlots:null,onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function Y(){if((this[N]&&this[N]()===false)||(this[C]()===false)||(this[B]&&this[B]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var Z="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,Z)){this.raiseEvent({name:Z});}return true;},buildDom:function T(){return X(this);},postBuildDom:null,preBuildRendering:mstrmojo.emptyFn,buildRendering:function F(){var Z=this.domNode,a=this.buildDom();this.domNode=a;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(A(this));this.paint();if(a){var d=Z;if(!d){d=this.placeholder;if(d){if(typeof d==="string"){d=document.getElementById(d);}delete this.placeholder;}}if(d){E.replace(d,a);}}var b="onchildRenderingChange",c=this.parent;if(c&&c[b]){c[b](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function S(b){if(this.hasRendered){if(!b){try{var Z=this.domNode;if(Z.parentNode){Z.parentNode.removeChild(Z);}if(mstrmojo.dom.isIE&&Z.outerHTML!=="undefined"){Z.outerHTML="";}}catch(a){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function K(){var a=this.markupMethods;if(!a){return ;}var d=this,e=function(k){var h=a[k];if(h){try{h.apply(d,[true]);}catch(g){throw new Error(["Error in markup method.","Script class: "+d.scriptClass,"Widget id: "+d.id,"Method name: "+k,"Err: "+g.message].join("\n\n"));}}};var c=a.sequence,Z,b,f;if(c){Z=c.length||0;for(b=0;b<Z;b++){e(c[b]);}}else{for(f in a){e(f);}}},redraw:function P(){return false;},refresh:function D(Z){if(this.hasRendered){if(this.redraw()!==true){var a=this.domNode;this.unrender(true);this.placeholder=a;if(Z){Z();}this.render();}}},set:function I(c,Z){this._super(c,Z);if(this.domNode){var a=this.markupMethods,b=a&&a["on"+c+"Change"];if(b){b.apply(this);}}return this;},slotNames:null,addSlots:function G(a){var Z=this.slotNames,b;if(!Z){Z={};this.slotNames=Z;}for(b in a){this[b]=a[b];Z[b]=true;}},removeSlots:function H(Z){if(Z){var a=this.slotNames,b;for(b in Z){delete this[b];if(a){delete a[b];}}}},captureDomEvent:function W(b,Z,c,a){if(this.enabled!==false){this.raiseEvent(mstrmojo._HasMarkup.newDomEvent(b,Z,c||Z.event,a));}},playEffect:function V(a){var Z=this[a];if(Z&&Z.constructor===Object){Z=mstrmojo.insert(mstrmojo.hash.clone(Z));Z.widget=this;this[a]=Z;}if(Z){Z.play();}}});mstrmojo._HasMarkup.addMarkupMethods=function O(a,Z){a.prototype.markupMethods=L.copy(Z,L.copy(a.prototype.markupMethods));};mstrmojo._HasMarkup.MSTRDomEventType=null;mstrmojo._HasMarkup.newDomEvent=function(c,Z,b,a){return{name:c,hWin:Z,e:b,config:a,ctrlKey:E.ctrlKey(Z,b),shiftKey:E.shiftKey(Z,b),metaKey:E.isMetaKey(Z,b),cancel:function(){E.stopPropogation(Z,b);},preventDefault:function(){E.preventDefault(Z,b);},getTarget:function(){return E.eventTarget(Z,b);}};};}());(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.string","mstrmojo.StringBuffer");mstrmojo._XMLNode=mstrmojo.declare(null,null,{nodeName:null,init:function N(O){mstrmojo.hash.copy(O,this);},addChild:function F(P){var O=new mstrmojo._XMLNode({nodeName:P});return this.appendNode(O);},appendNode:function J(O){if(O){if(!this.children){this.children=[];}this.children.push(O);O.parent=this;}return O;},addAttribute:function L(O,P){if(O!=null){if(!this.attributes){this.attributes={};}this.attributes[O]=P;}return this;},addText:function M(O){this._addToStringMember("text",O);return this;},addRawXML:function K(O){this._addToStringMember("rawXML",O);return this;},getXMLString:function I(){var O=new mstrmojo.StringBuffer();this.buildXMLString(O);return O.toString();},buildXMLString:function E(O){O=O||new mstrmojo.StringBuffer();O.append("<").append(this.nodeName).append(" ");this._buildAttributesXMLString(O).append(">").append(((this.text!=null)?this._escapeString(this.text):"")).append(((this.rawXML!=null)?this.rawXML:""));this._buildChildrenXMLString(O).append("</").append(this.nodeName).append(">");return O;},_buildAttributesXMLString:function D(O){var Q=this.attributes;if(Q){var R;for(R in Q){if(Q[R]!=null){var P=String(Q[R]);switch(R){case"et":case"nt":case"dmt":case"ddt":case"fnt":case"tp":case"stp":break;default:P=this._escapeString(P);}O.append(R+'="'+P+'" ');}}}return O;},_escapeString:function C(O){return mstrmojo.string.escape4HTMLText(O);},_buildChildrenXMLString:function H(P){var R=this.children;var O=R&&R.length;if(O){var Q;for(Q=0;Q<O;Q++){if(R[Q]&&R[Q].buildXMLString){R[Q].buildXMLString(P);}}}return P;},_addToStringMember:function A(O,Q){var P=this[O];if(P==null){this[O]=Q;}else{this[O]=P+Q;}}});mstrmojo.XMLBuilder=mstrmojo.declare(null,null,{root:null,curNode:null,addChild:function F(O){if(!this.root){this.currentNode=this.root=new mstrmojo._XMLNode({nodeName:O});}else{this.currentNode=this.currentNode.addChild(O);}return this;},appendNode:function J(O){if(!this.root){this.currentNode=this.root=O;}else{this.currentNode=this.currentNode.appendNode(O);}return this;},addAttribute:function L(O,P){if(this.currentNode){this.currentNode.addAttribute(O,P);}else{alert("no root node");}return this;},addText:function M(O){if(this.currentNode){this.currentNode.addText(O);}else{alert("no root node");}return this;},addRawXML:function K(O){if(this.currentNode){this.currentNode.addRawXML(O);}else{alert("no root node");}return this;},closeElement:function G(){this.currentNode=this.currentNode.parent;},toString:function B(){if(this.root){return this.root.getXMLString();}return"";}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.locales");var c=mstrmojo.array,P=mstrmojo.meta.TP,G=mstrmojo.meta.STP,O=mstrmojo.hash,F={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1,RLS:15},B={};var W;for(W in F){B[F[W]]=true;}var a={};a[F.AQ]="a";a[F.AL]="a";a[F.AC]="a";a[F.AE]="a";a[F.MQ]="m";a[F.MC]="m";a[F.F]="f";a[F.R]="r";a[F.XML]="p";var K={};K[F.MQ]=["not","m","fn","fnt","cs","dmy","idcsi"];K[F.MC]=["not","m","fn","fnt","m2","m3","p","dmy","idcsi"];K[F.AE]=["not","a","fn","es","a2","fm2","p"];K[F.AQ]=["not","a","fm","fn","cs"];K[F.AL]=["not","a","fm","fn","cs"];K[F.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];K[F.R]=["not","r"];K[F.F]=["not","f"];K[F.XML]=["not","n","p"];var M={};M[F.MQ]="METRIC_FNS";M[F.MC]="METRIC_FNS";M[F.AQ]="FORM_FNS";M[F.AL]="FORM_FNS";M[F.AC]="FORM_FNS";M[F.AE]="ELEM_FNS";var N={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43,CONS:47},b={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776,REPORT_EMMACUBE:779,CONS:12032,NDE:12033},T={a:N.ATTR,a2:N.ATTR,m:N.METRIC,m2:N.METRIC,r:N.REPORT,f:N.FILTER,p:N.PROMPT},U={f:b.FILTER};var V={};V[F.MQ]=N.METRIC;V[F.MC]=N.METRIC;V[F.AQ]=N.ATTR;V[F.AL]=N.ATTR;V[F.AC]=N.ATTR;V[F.AE]=N.ATTR;V[F.F]=N.FILTER;V[F.R]=N.REPORT;var J=function(d){var H=d.length,g={},e;for(e=0;e<H;e++){var h=d[e];g[h.did]=h.n;}return g;},E=function(e){var H=e.length,f;for(f=0;f<H;f++){var d=e[f];if("tp" in d){d.t=d.tp;}}return e;},X=function(e,g){var H=e.length,f;for(f=0;f<H;f++){var d=e[f];if("tp" in d){if(g){d.t=g;}else{delete d.t;}}}return e;},Z=function(d,f){if(!f){f=[];}f.length=0;var e,H;for(e=0,H=d.length;e<H;e++){f[e]=d[e];}return f;},L={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};var R={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:F,ETs:B,ET2TGT:a,ET2COND:K,ET2TP:V,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21,SEARCH:158},FN_MRP:{BETWEEN:3,EXCLUDE_TOP:4,EXCLUDE_BOTTOM:5,BETWEEN_DESCENDING:13},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:N,STP:b,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},BFTP:{RESERVED:0,HIDDEN:-1,DATETIME:1,NUMBER:2,TEXT:3,PICTURE:4,URL:5,EMAIL:6,TAG:7,DATE:8,TIME:9,SYMBOL:10,BIGDECIMAL:11,PHONENUMBER:12},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":b.PROMPT,1:b.PROMPT_LONG,2:b.PROMPT_LONG,3:b.PROMPT_LONG,4:b.PROMPT_DOUBLE,5:b.PROMPT_DOUBLE,6:b.PROMPT_DOUBLE,7:b.PROMPT_DOUBLE,8:b.PROMPT_STRING,9:b.PROMPT_STRING,10:b.PROMPT_STRING,14:b.PROMPT_DATE,15:b.PROMPT_DATE,16:b.PROMPT_DATE,21:b.PROMPT_LONG,22:b.PROMPT_LONG,23:b.PROMPT_STRING,24:b.PROMPT_BOOLEAN,30:b.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0,34:0},fnCstCount:function A(e,d){var g=this.FN,h=this.FN_MRP,H=this.FNT;if(d===H.DEF||d===undefined){switch(e){case g.BETWEEN:case g.NOT_BETWEEN:return 2;case g.IS_NULL:case g.IS_NOT_NULL:return 0;}}else{if(d===H.PER||d===H.RANK){switch(e){case h.BETWEEN:case h.BETWEEN_DESCENDING:return 2;}}}return 1;},fn_List:function S(d,H){var e=this.FN;return d==e.IN_LIST||d==e.NOT_IN_LIST;},fn_AC_MC:function Y(d,H){var e=this.FN;return(d==e.EQUAL)||(d==e.NOT_EQUAL)||(d==e.GREATER)||(d==e.LESS)||(d==e.GREATER_EQUAL)||(d==e.LESS_EQUAL);},fnName:function Q(h,g,d,f){var H=this[M[h]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[f]]||H["*"];}if(h===F.MQ){H=H.concat(mstrmojo.locales.expression.MetricRP);}var e=c.find(H,"did",(d||1)+this.FN_SEP+g);if(e>-1){return H[e].n;}return"";},findTargets:function I(o,f,q){if(!q){q={};}if(o){var n;for(n in T){var z=o[n];if(z){if(!z[P]){z[P]=T[n];}if(!z[G]&&U[n]){z[G]=U[n];}q[z[f]]=z;}}if(o.dmy){var l=this.TP.ATTR,r=this.DMY_TP.ATTR,e=o.dmy.uts,y,d;for(y=0,d=(e&&e.length)||0;y<d;y++){var m=e[y];if(m&&m.utp===r){var g=m.utgt;if(!g.t){g.t=l;}q[g[f]]=g;}}}var H=o.nds,p,w;for(p=0,w=(H&&H.length)||0;p<w;p++){this.findTargets(H[p],f,q);}var s=o.cs,x=s&&s.length;if(x){for(p=0;p<x;p++){this.findTargets(s[p],f,q);}}}return q;},onLocaleUpdated:function(){var d=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=O.copy(J(d.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=Z(X(d.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":X(c.filter(d.Metric.concat(d.MetricRP),function(e){return e.did&&(c.find(R["0"],"did",e.did)<0);}))};H.FORM_FNS={0:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["0"],"did",e.did)<0);})),1:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["1"],"did",e.did)<0);})),2:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["0"],"did",e.did)<0)&&(c.find(L["1"],"did",e.did)<0);}))};H.DIMTYLEVELS=Z(X(d.DimtyLevels),H.DIMTYLEVELS);},getSortedObjectsByTypeGroup:function D(f){var H=0,d=1,e=2;function g(h){switch(h.t){case N.METRIC:return d;case N.ATTR:case N.DIM:case N.CONS:return H;case N.FILTER:return h.st===b.CUSTOMGROUP?H:e;default:return e;}}return f.slice(0).sort(function(n,m){var o=g(n)-g(m);if(o){return o;}var l=n.n.toUpperCase(),k=m.n.toUpperCase(),h=l.localeCompare(k);if(h){return h;}return n.n.localeCompare(m.n);});},mapBaseFormTypeToDataType:function C(e){e=parseInt(e);if(e===NaN){return -1;}var d=this.BFTP,H=this.DTP;switch(e){case d.DATETIME:return H.TIMESTAMP;case d.DATE:return H.DATE;case d.TIME:return H.TIME;case d.NUMBER:return H.REAL;case d.TEXT:return H.CHAR;case d.BIGDECIMAL:return H.BIGDECIMAL;default:return H.CHAR;}}});mstrmojo.expr.onLocaleUpdated();}());(function(){mstrmojo.requiresCls("mstrmojo.locales");var X=function(){return mstrmojo.locales.datetime;},L=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},now:Date.now||function D(){return new Date().getTime();},isDate:function Y(b,f,a){var d=this.parseDate(b,a);var e=!!(d&&this.doesDateExist(d.month,d.day,d.year));if(f){if(e){var c=this.formatDateInfo(d,X().DATEOUTPUTFORMAT);if(a){return{match:d.match,formatted:c};}return c;}return null;}return !!e;},formatDateInfo:function R(d,f){if(!f){return"";}var a=d.day,e=d.month,c=d.year;var b=f.replace(/dd/g,this.formatInteger(a,2)).replace(/d/g,Number(a)).replace(/yyyy/g,Number(c)).replace(/yy/g,this.formatInteger(Number(c)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,X().MONTHNAME_FULL[Number(e)-1]).replace(/\~\~\~\~/g,X().MONTHNAME_SHORT[Number(e)-1]).replace(/\@\@/g,this.formatInteger(e,2)).replace(/\^/g,Number(d.month));return b;},parseDate:function Z(m,f,k){if(m==null){return false;}if(typeof m!=="string"){m=String(m);}m=L.trim(m);var a=this.CACHE.PARSEDATE[f?"CONTAINS":"EQUALS"],c=a[m];if(c||(c===null)){return c;}var b=null;var h;if(k){h=[k];}else{h=[].concat(X().DATEINPUTFORMATS);h.unshift(X().DATEOUTPUTFORMAT);}var d,e;for(d=0,e=h.length;d<e;d++){var g=this._buildRegExp4DateFormat(h[d]),l=g&&m.match(f?g.reContains:g.reEquals);if(l){b={match:l[0],year:g.yearIndex&&this.fourDigitYear(l[g.yearIndex]),day:g.dayIndex&&parseInt(Number(l[g.dayIndex]),10),month:g.monthIndex&&this.numericMonth(l[g.monthIndex])};break;}}a[m]=b;return b;},isTime:function I(b,e,a){var f=this.parseTime(b,a);var d=!!(f&&this.doesTimeExist(f.hour,f.min,f.sec));if(e){if(d){var c=this.formatTimeInfo(f,X().TIMEOUTPUTFORMAT);if(a){return{match:f.match,formatted:c};}return c;}return null;}return !!d;},parseTime:function J(n,f,l){if(n==null){return false;}if(typeof n!=="string"){n=String(n);}n=L.trim(n);var a=this.CACHE.PARSETIME[f?"CONTAINS":"EQUALS"],c=a[n];if(c||(c===null)){return c;}var b=null;var k;if(l){k=[l];}else{k=[].concat(X().TIMEINPUTFORMATS);k.unshift(X().TIMEOUTPUTFORMAT);}var d,e;for(d=0,e=k.length;d<e;d++){var h=this._buildRegExp4TimeFormat(k[d]),m=h&&n.match(f?h.reContains:h.reEquals);if(m){var g=h.ampmIndex&&m[h.ampmIndex];b={match:m[0],hour:h.hourIndex&&this.capitalHour(m[h.hourIndex],g),min:h.minIndex&&parseInt(Number(m[h.minIndex]),10),sec:h.secIndex&&parseInt(Number(m[h.secIndex]),10)};break;}}a[n]=b;return b;},formatTimeInfo:function S(d,b){if(!b){return"";}var c=!(Number(d.hour)%12)?12:(Number(d.hour)%12),a=b.replace(/HH/g,this.formatInteger(d.hour,2)).replace(/H/g,Number(d.hour)).replace(/hh/g,this.formatInteger(c,2)).replace(/h/g,c).replace(/mm/g,this.formatInteger(Number(d.min)||0,2)).replace(/m/g,Number(d.min)||0).replace(/ss/g,this.formatInteger(Number(d.sec)||0,2)).replace(/s/g,Number(d.sec)||0).replace(/a/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME).replace(/tt/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME).replace(/AM\/PM/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME);return a;},doesTimeExist:function G(f,b,e){var d=parseInt(f,10);if(d>=0&&d<=23){var a=parseInt(b,10);if(a>=0&&a<=59){if(!e){return true;}var c=parseInt(e,10);if(c>=0&&c<=59){return true;}}}return false;},capitalHour:function C(a,b){a=parseInt(Number(a),10);if(b&&(b.match(X().AM_NAME)||b.match(/AM/i))){return a%12;}if(b&&(b.match(X().PM_NAME)||b.match(/PM/i))){return 12+(a%12);}return a;},getTimeStamp:function O(){var b=new Date();var a=[b.getMonth()+1,b.getDate(),b.getFullYear()];var e=[b.getHours(),b.getMinutes(),b.getSeconds()];var d=(e[0]<12)?"AM":"PM";e[0]=(e[0]<12)?e[0]:e[0]-12;e[0]=e[0]||12;for(var c=1;c<3;c++){if(e[c]<10){e[c]="0"+e[c];}}return a.join("-")+" "+e.join(":")+" "+d;},isDateAndOrTime:function V(a,b){return this.isDateTime(a,b)||this.isDate(a,b)||this.isTime(a,b);},isDateTime:function B(l,a){var e=this.parseDateAndOrTime(l),h=e&&e.date,d=e&&e.time,g=!!h&&!!d&&this.doesDateExist(h.month,h.day,h.year)&&this.doesTimeExist(d.hour,d.min,d.sec);if(a){if(g){var b=this.formatDateInfo(h,X().DATEOUTPUTFORMAT),c=this.formatTimeInfo(d,X().TIMEOUTPUTFORMAT),k=l.indexOf(h.match),f=l.indexOf(d.match);return(f<k)?c+" "+b:b+" "+c;}return null;}return !!g;},parseDateAndOrTime:function Q(b,a,f){var c=this.parseDate(b,true,a);var d=L.trim((c&&c.match)?b.replace(c.match,""):b),e=this.parseTime(d,false,f);if(!c&&!e){return null;}return{date:c,time:e};},inDateTimeRange:function P(c,e,h){var b=this.parseDateAndOrTime(c),f=b&&b.date,k=b&&b.time;if(!f&&!k){return 0;}if(e!=null){var d=this.parseDateAndOrTime(e);if(f&&d&&d.date){var l=this.compareDate(f,d.date);if(l<0){return -1;}if(l==0){if(k&&d.time&&(this.compareTime(k,d.time)<0)){return -1;}}}}if(h!=null){var a=this.parseDateAndOrTime(h);if(f&&a&&a.date){var g=this.compareDate(f,a.date);if(g>0){return 1;}if(g==0){if(k&&a.time&&(this.compareTime(k,a.time)>0)){return 1;}}}}return 0;},compareDate:function A(c,a){if(c===a){return 0;}var d=typeof c==="string"?this.parseDate(c):c,b=typeof a==="string"?this.parseDate(a):a;if(!d){return -1;}if(!b){return 1;}return(d.year-b.year)||(d.month-b.month)||(d.day-b.day)||0;},compareTime:function K(b,a){if(b===a){return 0;}var d=typeof b==="string"?this.parseTime(b):b,c=typeof a==="string"?this.parseTime(a):a;if(!d){return -1;}if(!c){return 1;}return(d.hour-c.hour)||(d.min-c.min)||(d.sec-c.sec)||0;},compareDateTime:function U(b,a){return this.compareDate(b,a)||this.compareTime(b,a);},compareDateAndOrTime:function E(h,f){if(h===f){return 0;}var b=typeof h==="string"?this.parseDateAndOrTime(h):h,a=typeof f==="string"?this.parseDateAndOrTime(f):f;if(!b){return -1;}if(!a){return 1;}var g=b.date,e=a.date,d=b.time,c=a.time;return this.compareDate(g,e)||this.compareTime(d,c);},_buildRegExp4DateFormat:function N(c){if(!c){return null;}var e=this.REGEXPS.DATES[c];if(!e){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=X().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=X().MONTHNAME_SHORT.join("|");}e=this.REGEXPS.DATES[c]={};e.formatStr=c;var b=e.reStr=c.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");e.reEquals=new RegExp("^"+b+"$");e.reContains=new RegExp("^"+b+"\\b");var f=[{key:"monthIndex",index:c.indexOf("M")},{key:"dayIndex",index:c.indexOf("d")},{key:"yearIndex",index:c.indexOf("y")}];f.sort(function(h,g){return h.index-g.index;});var a=1,d;for(d=0;d<3;d++){e[f[d].key]=f[d].index>-1?a++:null;}}return e;},_buildRegExp4TimeFormat:function F(d){if(!d){return null;}var f=this.REGEXPS.TIMES[d];if(!f){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[X().AM_NAME,X().PM_NAME,String(X().AM_NAME).toLowerCase(),String(X().PM_NAME).toLowerCase()].join("|");}f=this.REGEXPS.TIMES[d]={};f.formatStr=d;var c=d.replace(/\'\'/g,'"');var g=c.match(/\'(.+?)\'/g);c.replace(/\'(.+?)\'/g,"*");c=c.replace(/([^H|h|m|s|z|Z|a|t|\s|A|P|M|\/])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/g,"("+this.REGEXPSTR_AMPM+")").replace(/AM\/PM/,"("+this.REGEXPSTR_AMPM+")").replace(/tt/g,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");var e,a;for(e=1,a=(g&&g.length)||0;e<a;e++){c=c.replace(/\*/,g[e]);}c=c.replace(/\"/g,"'");f.reEquals=new RegExp("^"+c+"$");f.reContains=new RegExp(c);var h=[{key:"hourIndex",index:d.search(/h|H/)},{key:"minIndex",index:d.indexOf("m")},{key:"secIndex",index:d.indexOf("s")},{key:"ampmIndex",index:d.search(/tt|a|AM\/PM/)},{key:"zoneIndex",index:d.search(/z|Z/)}];h.sort(function(l,k){return l.index-k.index;});var b=1;for(e=0;e<5;e++){f[h[e].key]=h[e].index>-1?b++:null;}}return f;},doesDateExist:function M(d,a,b){var c=new Date(b,d-1,a);return b==c.getFullYear()&&d==c.getMonth()+1&&a==c.getDate();},fourDigitYear:function T(b){b=parseInt(Number(b),10);if(!isNaN(b)){var a=(X().TWODIGITYEARSTART%100)||0;if(b>=0&&b<=a){b=2000+b;}else{if(b>a&&b<100){b=1900+b;}}}return b;},numericMonth:function W(e){var d=parseInt(Number(e),10),c=mstrmojo.array;if(!isNaN(d)){return d;}var a=(e&&e.length)||0,b=-1;if(a){if(a<=3){b=c.indexOf(X().MONTHNAME_SHORT,e);}if(b===-1){b=c.indexOf(X().MONTHNAME_FULL,e);}}return b+1;},formatInteger:function H(c,b){var f=String(c),e=Math.max(b-f.length,0);if(e>0){var a=[f],d;for(d=1;d<=e;d++){a.push("0");}f=a.reverse().join("");}return f;},getFirstDateOfMonth:function(b,a){return new Date(b,a-1,1);},getDateObject:function(g,a,f,c,e,b){g=g||0;a=a||1;f=f||1;c=c||0;e=e||0;b=b||0;return new Date(g,a-1,f,c,e,b);},getDateFromDateInfo:function(a){return this.getDateObject(a.date&&a.date.year,a.date&&a.date.month,a.date&&a.date.day,a.time&&a.time.hour,a.time&&a.time.min,a.time&&a.time.sec);},getDateJson:function(a){return{year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),min:a.getMinutes(),sec:a.getSeconds()};},isLeapYear:function(a){return !(a%400)||(!(a%4)&&!!(a%100));},getDaysOfMonth:function(c,a){var b=[31,28,31,30,31,30,31,31,30,31,30,31];if(a==2&&this.isLeapYear(c)){return 29;}return b[a-1];},getPreMonth:function(b,a){if(a===1){return{y:b-1,m:12};}return{y:b,m:a-1};},getNextMonth:function(b,a){if(a===12){return{y:b+1,m:1};}return{y:b,m:a+1};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.gm.GMEnums");var A=mstrmojo.gm.EnumIdentityType;mstrmojo.gm.GMIdentities=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GMIdentities"});mstrmojo.gm.HeaderCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.HeaderCellIdentity",eid:undefined,v:undefined,tid:undefined,n:undefined,tui:undefined,fid:undefined,o:undefined,isRowAttribute:undefined,at:undefined,dei:undefined,dpt:undefined});mstrmojo.gm.GeneralIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.GeneralIdentity",objType:undefined});mstrmojo.gm.TitleCellIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.TitleCellIdentity",tid:undefined,fid:undefined,n:undefined,tui:undefined,isRowAttribute:undefined,otp:undefined,init:function(B){this.fid=B.fid;this.tid=B.id;this.isRowAttribute=B.isRowAttribute;if(B.isRowAttribute){this.objType=A.ROW_TITLE;}else{this.objType=A.COL_TITLE;}this.n=B.n;this.otp=B.otp;this.ost=B.ost;this.tui=B.tui;}});mstrmojo.gm.MetricAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.MetricAxisTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AttributeAxisTitleIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AttributeAxiTitleIdentity",init:function(B){this._super(B);}});mstrmojo.gm.AxisIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.AxisIdentity",isNumericAxis:undefined,metricIdxArr:undefined,attrIdArr:undefined});mstrmojo.gm.ColorSquareIdentity=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.ColorSquareIdentity",init:function(B){this._super(B);this.comb=this.getElementsCombination();},getElementsCombination:function(){var B,F=this.token,C,H,G,E,I,D;if(F){D=[];C=F.levels;H=F.elements;G=F.types;B=C.length;for(E=0;E<B;E++){I={eid:H[E],tid:C[E]};if(G){I.tp=G[E];}D.push(I);}return D;}return undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.chart.common.DSSTimeUtil=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSTimeUtil",DaysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],DaysBeforeMonth:[0,31,59,90,120,151,181,212,243,273,304,334],DateAbove1970:[1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1971,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1997,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1973,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981,1971,1972,1973,1974,1997,1976,1977,1978,1973,1980,1981,1971,1977,2012,1974,1997,1981,1988,1978,1973,1974,1992,1971,1977,1978,1996,1997,1981]});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.array");var H=mstrmojo,F=H.array,A="00000000000000000000000000000000",E=-1;function J(K){return K.t===4&&K.id!==A;}function G(L){var K,M=(L&&L.length)||0;if(M===0){return false;}for(K=0;K<M;K++){if(!J(L[K])){return false;}}return true;}mstrmojo.VisProps=null;mstrmojo.vi.viz.DropZoneHelper=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.vi.viz.DropZoneHelper",getXml:function B(){return"";},setData:function I(K){},isMetric:function(K){return J(K);},isMetricZone:function(K){return G(K);},getMetricCountInZone:function D(L){var K=0;F.forEach(L,function(M){if(J(M)){K++;}});return K;}});mstrmojo.vi.viz.DropZoneHelper.METRIC_NAMES_ID=A;mstrmojo.vi.viz.DropZoneHelper.isMetricNames=function C(K){return(parseInt(K.did,10)===E)||(K.id===A)||(K.did===A);};}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var D=mstrmojo.registry,K=mstrmojo.array,I=mstrmojo.publisher;function G(Q,R){if(R){R.parent=Q;var P=D.ref(R);if(R!==P){delete R.parent;}return P;}return null;}function L(Q,R){var P=R.alias;if(P!==null&&P!==""){Q[P]=R;}}function N(Q,R){var P=R.alias;if(R.parent===Q){delete R.parent;}if((P!==null&&P!=="")&&(Q[P]===R)){delete Q[P];}}function A(T,Q){var P=Q&&Q.length,S,R;if(P){S=[];for(R=0;R<P;R++){var U=G(T,Q[R]);if(!U){continue;}S.push(U);L(T,U);}}return S;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,children:null,postCreateChildren:mstrmojo.emptyFn,onaddChild:null,onremoveChild:null,initChildren:function F(){var P="children",Q=this[P];if(!Q){return ;}this[P]=null;this._set_children(P,Q,true);this.postCreateChildren();},_set_children:function E(S,Q,P){var R=this.children;if(Q!==R){if(R){this.removeChildren(null,P);}this.addChildren(Q,0,P);}return false;},destroyChildren:function C(S){var R=this.children,P=(R&&R.length)||0,Q;if(P){for(Q=P-1;Q>-1;Q--){var T=R[Q];if(T&&T.destroy){T.destroy(S);if(!S){N(this,T);}}}if(!S){R.length=0;}}},invalidateChildren:function B(){mstrmojo.array.forEach(this.children,function(P){P.invalidate();});},invalidate:function H(){this.invalidateChildren();},addChildren:function O(U,Q,R){if(!U){return U;}var T=U.constructor===Array,P=A(this,T?U:[U]);if(P&&P.length){var S=this.children||[];if(Q===null||Q===undefined){Q=S.length;}this.children=K.insert(S,Q,P);if(!R&&(this.onaddChild||I.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:P,index:Q});}}return T?P:(P&&P[0]);},removeChildren:function J(V,R){var T=this.children,U=V?[V]:(this.children||[]).concat(),Q=U.length,P=-1,S;if(Q){for(S=Q-1;S>-1;S--){N(this,U[S]);}if(V){P=K.removeItem(T,V);}else{if(T){T.length=0;P=0;}}if(!R&&(this.onremoveChild||I.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:U,index:P});}}return P;},removeAndDestroyChild:function M(R,P,Q){if(R){if(R.parent!==this){throw"Unable to remove an object that is not in the children collection.";}this.removeChildren(R,P);R.destroy(Q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;this.preHandleEvent(H);var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){this.postHandleEvent(H);C.publish(this.id,M,H);}return H;},preHandleEvent:mstrmojo.emptyFn,postHandleEvent:mstrmojo.emptyFn,attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var A=false,D="mstrmojo.Binding",I="bindings",H=mstrmojo.registry;function B(K){var L;for(L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function C(K,M){if(!A){mstrmojo.requiresCls(D);A=true;}var N;for(N in K){var J=K[N];if(J===null||J===undefined){continue;}var L=typeof J;if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=H.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function E(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[I]);if(K){delete this[I];this._set_bindings(I,K);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children,J=(M&&M.length)||0;if(J){var L;for(L=0;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function G(){var J=this.bindings;if(J){B(J);delete this.bindings;}},_set_bindings:function F(L,J){var K=this[I];if(J!==K){if(K){B(K);}this[I]=J;if(J){C(J,this);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});}());(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");if(F.params&&!F.params.sessionState&&mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){F.params.sessionState=mstrApp.sessionState;}H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){if(J.mstrerr){J.code=J.mstrerr.code;J.message=J.mstrerr.message;}E.response(G,true,J);},failure:function(J){E.response(G,false,{code:J.getResponseHeader("X-MSTR-TaskErrorCode"),message:J.getResponseHeader("X-MSTR-TaskFailureMsg")});},complete:function(){delete D[G];},textResponse:F.callback.textResponse},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.QueuedXHR");var F=mstrmojo.hash;function J(K,L){return function(){if(K[L]){K[L]();}};}var B=[];function H(L){var K;switch(L.cacheLevel){case mstrmojo.AjaxCall.CACHELEVEL_LOCAL:if(L._cache==null){L._cache=[];}K=L._cache;break;default:if(B==null){B=[];}K=B;break;}return K;}function E(N){var M=H(N);var P={cache:M,idx:-1},O=N.params;if("xts" in O){delete O.xts;}for(var L=0,K=M.length;L<K;L++){var Q=M[L];if(Q&&F.equals(Q.url,N.url)&&F.equals(Q.params,O)){P.idx=L;break;}}return P;}function C(L){var K=H(L),M=F.copy(L.params);delete M.xts;K.push({url:L.url,params:M,res:F.copy(L.response)});}function D(K){var L=E(K);if(L&&L.idx>=0){K.response=L.cache[L.idx].res;return true;}return false;}mstrmojo.AjaxCall=mstrmojo.declare(mstrmojo.QueuedXHR,null,{scriptClass:"mstrmojo.AjaxCall",method:"POST",url:"",params:null,onsuccess:null,onerr:null,oncomplete:null,oncancel:null,readCache:false,writeCache:false,cacheLevel:"",_cache:null,useQueue:false,init:function I(K){this._super(K);F.copy(K,this);},send:function A(){var K=this;if(this.readCache&&D(this)){this.onsuccess();return ;}this.request(this.method,this.url,{success:function(){if(K.writeCache){C(K);}if(K&&K.onsuccess){K.onsuccess();}},failure:J(K,"onerr"),complete:J(K,"oncomplete")},this.params,!this.useQueue);},cancel:function G(){this._super();if(this.oncancel){this.oncancel();}}});mstrmojo.AjaxCall.CACHELEVEL_GLOBAL="global";mstrmojo.AjaxCall.CACHELEVEL_LOCAL="local";})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var C=mstrmojo.dom,B=C.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function A(E,I,D){var G=(E&&E.tree)||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}return true;}},mstrmojo.hash.copy(mstrmojo.ListSelector)));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var E=mstrmojo.dom;function B(I){return E.contains(this.getMovingHandle(),I.src.node,true,document.body);}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function G(){return this.domNode;},getMovingTarget:function H(){return this.domNode;},isDragValid:function A(I){return B.call(this,I)||(this._super&&this._super(I))||false;},ondragstart:function C(J){if(B.call(this,J)){var K=this.getMovingHandle(),I=this.getMovingTarget().style;this._leftPos=parseInt(I.left,10);this._topPos=parseInt(I.top,10);this._hWidth=K.clientWidth;this._hHeight=K.clientHeight;}if(this._super){this._super();}},ondragmove:function F(L){if(B.call(this,L)){var M=L.tgt.pos,J=L.src.pos,K=this.getMovingTarget().style,I=E.windowDim();K.left=this.left=Math.min(Math.max(this._leftPos+M.x-J.x,-this._hWidth+40),I.w-40)+"px";K.top=this.top=Math.min(Math.max(this._topPos+M.y-J.y,-this._hHeight+20),I.h-20)+"px";}if(this._super){this._super();}},ondragend:function D(I){if(B.call(this,I)){delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var B=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(mstrmojo.Base,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",id:"",init:function I(J){this.disposables=[];this._super(J);B.add(this);if(this.postCreate){this.postCreate();}},addDisposable:function G(M){var K=this.disposables,L,J;if(M.constructor===Array){for(L=0,J=M.length;L<J;L++){K.push(M[L]);}}else{K.push(M);}return M;},destroyDisposables:function D(J){F.forEach(this.disposables,function(K){if(K.destroy){K.destroy(J);}else{if(K.clear){K.clear();}}});this.disposables=[];},throwAbstractMethodError:function A(J){throw new Error(this.scriptClass+" must implement "+J+".");},destroy:function H(J){if(this.destroyed){return ;}this._super(J);this.destroyDisposables(J);B.remove(this);delete this.parent;this.destroyed=true;}});var C=mstrmojo.Obj;C.free=function E(J){if(J instanceof C){J.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.vi.viz.DropZoneHelper");var V=mstrmojo,I=V.array,T=V.vi.viz.EnumDSSDropZones,N=V.hash,M;function C(b,a){var c=b.getDropZoneItems(a);return c[0];}function R(b,a){var c=C(b,a);return c?c.id:"";}mstrmojo.vi.viz.MapHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.MapHelper",widget:null,data:null,vp:null,geoAttribute:null,latitude:null,longitude:null,angle:null,colorBy:null,sizeBy:null,tooltip:null,mapType:null,useAttributeForm:null,supportAreaMap:true,defaultView:null,init:function S(a){this._super(a);this.tooltip=[];this.data=this.data||{};this.vp=this.data.vp||{};},setWidget:function W(a){this.widget=a;var b=a.model.data.vp;this.geoAttribute=R(a,T.GeoAttribute);this.latitude=R(a,T.Latitude);this.longitude=R(a,T.Longitude);this.angle=R(a,T.Angle);this.colorBy=R(a,T.ColorBy);this.sizeBy=R(a,T.SizeBy);this.tooltip=a.getDropZoneItems(T.AdditionalMetrics).map(function(c){return c.id;});this.mapType=b.mtp;this.useAttributeForm=b.af;this.defaultView=b.dv;},getGeoUnit:function P(){return C(this.widget,T.GeoAttribute);},getLatitudeUnit:function H(){return C(this.widget,T.Latitude);},getLongitudeUnit:function L(){return C(this.widget,T.Longitude);},getAngleUnit:function A(){return C(this.widget,T.Angle);},getColorByUnit:function B(){return C(this.widget,T.ColorBy);},getSizeByUnit:function K(){return C(this.widget,T.SizeBy);},getTooltipUnits:function G(){return this.widget.getDropZoneItems(T.AdditionalMetrics);},setMapType:function(a){this.mapType=a;},setUseAttributeForm:function J(a){this.useAttributeForm=a?M.USE_ATTRIBUTE_FORM:M.USE_ATTRIBUTE;},getGeoForm:function F(d,b){var a=d&&d.fs,c=null;if(!b){b=function(){return true;};}if((d.otp===12||d.t===12)&&a){I.forEach(a,function(e){if(b(e)){c=e;return false;}});}return c;},getLatitudeForm:function Z(a){return this.getGeoForm(a,function(b){return M.isLatitude(b.fnm,b.fgr)&&b.obf;});},getLongitudeForm:function D(a){return this.getGeoForm(a,function(b){return M.isLongitude(b.fnm,b.fgr)&&b.obf;});},getXml:function O(){return M.getXmlFromJson(this.vp);}});M=mstrmojo.vi.viz.MapHelper;M.USE_ATTRIBUTE="0";M.USE_ATTRIBUTE_FORM="1";M.MTP_MARKER="1";M.MTP_BUBBLE="2";M.MTP_AREA="3";M.MTP_DENSITY="4";M.MTP_PATH="5";M.canShowColorByZone=function(a){return a===M.MTP_MARKER||a===M.MTP_BUBBLE||a===M.MTP_AREA||a===M.MTP_PATH;};M.canShowSizeByZone=function(a){return a===M.MTP_BUBBLE;};M.supportImageThreshold=function(a){return a!==M.MTP_BUBBLE&&a!==M.MTP_AREA;};M.isLatitude=function Y(b,a){return a===5||(b&&b.toLowerCase().indexOf("latitude")>-1);};M.isLongitude=function X(b,a){return a===6||(b&&b.toLowerCase().indexOf("longitude")>-1);};M.getXmlFromJson=function E(a){var b=new mstrmojo.XMLBuilder();b.addChild("widgetProps");b.addChild("fmt");N.forEach(a,function(c,d){b.addChild(d);b.addAttribute("value",c);b.closeElement();});b.closeElement();b.closeElement();return b.toString();};M.getMapTypeByElementCount=function Q(a){return a>500?M.MTP_DENSITY:M.MTP_MARKER;};M.isGeoRoleSupportArea=function U(d){var c=1,e=3,g=2,b=8,f=9,a=7;return d===e||d===g||d===b||d===f||d===c||d===a;};}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.chart.common.DSSTimeUtil");var H=24*60*60*1000;var A=60*60*1000;var L=60*1000;var C=1000;var K=24;var D=24*60;var J=24*60*60;var B=new mstrmojo.chart.common.DSSTimeUtil();mstrmojo.chart.common.DSSDateTime=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSDateTime",mnYear:1899,mnMonth:12,mnDay:30,mnHour:0,mnMinute:0,mnSecond:0,mnMillisecond:0,mnWeek:-1,mnDayOfWeek:-1,init:function P(T){if(!T||!T.ifTime){this.mnYear=1899;this.mnMonth=12;this.mnDay=30;this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;this.mnWeek=-1;this.mnDayOfWeek=-1;return ;}var S=0;var V=23242571;var R=-693593;if(T.ifTime>V){this.mnYear=65535;this.mnMonth=12;this.mnDay=30;S=T.ifTime-Math.floor(T.ifTime);}else{if(T.ifTime<R){this.mnYear=1;this.mnMonth=1;this.mnDay=1;S=Math.abs(T.ifTime)+Math.ceil(T.ifTime);}else{if(T.ifTime>0){var W=this.DAYSToYMD(Math.floor(T.ifTime));this.mnYear=W.year;this.mnMonth=W.month;this.mnDay=W.day;S=T.ifTime-Math.floor(T.ifTime);}else{if(T.ifTime<0){var W=this.DAYSToYMD(Math.ceil(T.ifTime));this.mnYear=W.year;this.mnMonth=W.month;this.mnDay=W.day;S=Math.abs(T.ifTime)+Math.ceil(T.ifTime);}}}}S*=H;var U=S+0.5;if(U==H){U--;}if(U>0){this.mnHour=Math.floor(U/A);U-=this.mnHour*A;this.mnMinute=Math.floor(U/L);U-=this.mnMinute*L;this.mnSecond=Math.floor(U/C);U-=this.mnSecond*C;this.mnMillisecond=Math.floor(U);}else{this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;}this.mnWeek=-1;this.mnDayOfWeek=-1;this.Sanitize();},Sanitize:function O(){var R=false;if(this.mnHour==24&&this.mnMinute==0&&this.mnSecond==0){R=true;this.mnHour=0;}if(this.mnMonth<1){this.mnMonth=1;}else{if(this.mnMonth>12){this.mnMonth=12;}}if(this.mnDay<1){this.mnDay=1;}else{if(this.mnDay>B.DaysInMonth[this.mnMonth-1]){this.mnDay=B.DaysInMonth[this.mnMonth-1];if(this.mnMonth==2&&this.IsLeapYear(this.mnYear)){this.mnDay++;}}}if(this.mnHour<0){this.mnHour=0;}else{if(this.mnHour>23){this.mnHour=23;}}if(this.mnMinute<0){this.mnMinute=0;}else{if(this.mnMinute>59){this.mnMinute=59;}}if(this.mnSecond<0){this.mnSecond=0;}else{if(this.mnSecond>59){this.mnSecond=59;}}if(this.mnMillisecond<0){this.mnMillisecond=0;}else{if(this.mnMillisecond>999){this.mnMillisecond=999;}}if(R){var S=this.ToMilliseconds();S=S+H;this.init({ifTime:this.MillisecondsToDATE(S)});}},IsLeapYear:function Q(R){return((R&3)==0)&&((R%100)!=0||(R%400)==0);},ToMilliseconds:function I(){var R=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var S=R*H;S+=this.mnHour*A+this.mnMinute*L+this.mnSecond*C+this.mnMillisecond;return S;},MillisecondsToDATE:function E(S){var R=Math.floor(S/H);var T=(S-R*H)/H;if(T<0){R--;T+=1;}return R>=0?R+T:R-T;},DAYSToYMD:function N(T){var W=0;var Y=0;var S=0;T+=693959;var V=Math.floor(T/365);var U=T-V*365;var X=Math.floor(V/4)-Math.floor(V/100)+Math.floor(V/400);U=U-X;if(U<0){V--;U+=365;while(U<=0){V--;U+=365;}}var R=T-(V*365+Math.floor(V/4)+(V%4?1:0)-Math.floor((V-1)/100)+Math.floor((V-1)/400));if(R==365&&!this.IsLeapYear(V)){W=V+1;Y=1;S=1;return{year:W,month:Y,day:S};}if(R==-1){W=V-1;Y=12;S=31;return{year:W,month:Y,day:S};}W=V;Y=12;while(R<B.DaysBeforeMonth[Y-1]){Y--;}S=R-B.DaysBeforeMonth[Y-1]+1;if(Y>2&&this.IsLeapYear(W)){S--;if(S==0){Y--;S=B.DaysInMonth[Y-1];if(Y==2){S++;}}}return{year:W,month:Y,day:S};},YMDToDAYS:function G(U,T,S){if(T<1||T>12){return 0;}var R=U*365+Math.floor(U/4)+(U%4?1:0)-Math.floor((U-1)/100)+Math.floor((U-1)/400);R+=B.DaysBeforeMonth[T-1];if(T>2&&this.IsLeapYear(U)){R++;}R+=S-1;R-=693959;return R;},ToDATE:function F(){var S=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var R=this.mnHour/K+this.mnMinute/D+this.mnSecond/J+this.mnMillisecond/H;if(S>=0){return S+R;}else{return S-R;}},DateTimeOrder:function M(R){if(this.mnYear>R.mnYear){return 1;}else{if(this.mnYear<R.mnYear){return -1;}}if(this.mnMonth>R.mnMonth){return 1;}else{if(this.mnMonth<R.mnMonth){return -1;}}if(this.mnDay>R.mnDay){return 1;}else{if(this.mnDay<R.mnDay){return -1;}}if(this.mnHour>R.mnHour){return 1;}else{if(this.mnHour<R.mnHour){return -1;}}if(this.mnMinute>R.mnMinute){return 1;}else{if(this.mnMinute<R.mnMinute){return -1;}}if(this.mnSecond>R.mnSecond){return 1;}else{if(this.mnSecond<R.mnSecond){return -1;}}if(this.mnMillisecond>R.mnMillisecond){return 1;}else{if(this.mnMillisecond<R.mnMillisecond){return -1;}}return 0;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([\- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')}};var H=mstrmojo.validation,B=H.TRIGGER,b=H.STATUSCODE,A={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,17:3,18:3,21:2,22:2,23:3,24:4,25:3,30:5,34:5};H.VALIDATOR={DEMO:function N(e){var d=parseInt(e,10),f=mstrmojo.validation.STATUSCODE;if(d===0||d===1||d>10){return{code:f.VALID};}return{code:f.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function I(d){var e=String(d).replace(/[^\d]/g,"");if(e.length<10){return{code:b.INVALID,msg:mstrmojo.desc(9203,"A telephone number must contain at least 10 digits.")};}if(!H.REGEXP.PHONE_NUMBER.test(d)){return{code:b.INVALID,msg:mstrmojo.desc(9204,"The telephone number contains invalid characters.")};}return{code:b.VALID};},VALIDATE_ZIPCODE:function G(d){var f="",e=this.dtp;if(!H.REGEXP.US_ZIP.test(d)){if(H.isNumeric(e)||H.isInt(e)){f=mstrmojo.desc(9208,"A zip code must be 5 digits or 5+4 digits.");}else{if(H.isString(e)){f=mstrmojo.desc(9206,"The zip code is invalid");}}return{code:b.INVALID,msg:f};}return{code:b.VALID};},VALIDATE_EMAIL:function T(d){var e=d.indexOf("@");if(e===-1){return{code:b.INVALID,msg:mstrmojo.desc(9197,"The email address is missing an at sign (@).")};}if(d.substring(e).indexOf(".")===-1){return{code:b.INVALID,msg:mstrmojo.desc(9198,"The email address is missing a period on the domain.")};}return H.REGEXP.EMAIL_ADDRESS.test(d)?{code:b.VALID}:{code:b.INVALID,msg:mstrmojo.desc(9207,"The email address is invalid.")};},VALIDATE_SSN:function Q(d){var f=this.dtp,e;if(H.isNumeric(f)||H.isInt(f)){e=String(d).replace(/[^\d]/g,"");if(e.length!==9){return{code:b.INVALID,msg:mstrmojo.desc(9209,"A Social Security Number must be 9 digits.")};}}if(!H.REGEXP.SOCIAL_SECURITY_NUMBER.test(d)){return{code:b.INVALID,msg:mstrmojo.desc(9210,"The Social Security Number is invalid.")};}return{code:b.VALID};}};H.isInt=function D(d){return A[d]===1;};H.isNumeric=function Y(d){return A[d]===2||A[d]===5;};H.isString=function J(d){return A[d]===3;};var C=window.mstrConfig,L=C.listSep,S=mstrmojo.expr,M=S.DTP,Z=mstrmojo.num,U=mstrmojo.string,F=mstrmojo.date;function P(m,n){var h=m.dtp,l=m.constraints,p=l.allowedFormatChars||"",g=(A[h]===1),d=(A[h]===2),e=(A[h]===6),o=mstrmojo.locales.number.THOUSANDSEPARATOR,f=mstrmojo.locales.number.DECIMALSEPARATOR,k;if(g){if(!m._intRegExp){p+="0-9-"+(m.isList?L:"")+o;m._intRegExp=new RegExp("[^"+p+"]");}k=m._intRegExp;}if(d){if(!m._numericRegExp){p+="0-9-"+(m.isList?L:"")+f+o;m._numericRegExp=new RegExp("[^"+p+"]");}k=m._numericRegExp;}return !!k&&k.test(n);}function c(m,o){var h=m.dtp,l=m.constraints,g=(A[h]===1),d=(A[h]===2),e=(A[h]===6),f=l.min,n=l.max,k;if(f===undefined&&n===undefined){return false;}if(g||d){return Z.inNumericRange(o,f,n)!==0;}if(e){return F.inDateTimeRange(o,f,n)!==0;}return false;}function K(e,d){return !Z.isNumeric(d);}function R(g,e){var f=(g.dtp===M.DATE),d=(g.dtp===M.TIME);return(f?!F.isDate(e):(d?!F.isTime(e):!F.isDateAndOrTime(e)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:M.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function W(d){this._super(d);if(!this.constraints){this.constraints={};}var e=this.constraints;if(!e.hasOwnProperty("trigger")){e.trigger=B.NONE;}},_set_value:function(k,f){var g=this.value,e=(g!==f);if(e){this.value=f;var h=this.constraints.trigger,d=(h&B.VALUESET)>0;if(d){this.validate(f);}}return e;},validate:function O(){var f=(this.value!==null&&this.value!==undefined)?this.value:"",k=this.isList?f.split(L):[f],h,e,l,d=k.length,g;for(g=0;g<d;g++){h=this.doValidation(k[g]);e=(h.code>b.VALID);if(e){if(d>1){h.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",k[g]||" ");}break;}}l=e?"onInvalid":"onValid";if(!e&&this.autoFormat){this.format();}this.set("validationStatus",h);if(this[l]){this[l](h);}},format:function X(){var k=this.dtp,f=(A[k]===6);if(!f){return ;}var m=mstrConfig.listSep,p=this.value||"",e=this.isList?p.split(m):[p],o=k===14,n=[],d,g=mstrmojo.locales.datetime,l=e.length,h;for(h=0;h<l;h++){p=e[h];d=F.parseDateAndOrTime(p);if(d){if(o&&d.date){n.push(F.formatDateInfo(d.date,g.DATEOUTPUTFORMAT));}else{n.push((d.date?F.formatDateInfo(d.date,g.DATEOUTPUTFORMAT):"")+" "+(d.time?F.formatTimeInfo(d.time,g.TIMEOUTPUTFORMAT):""));}}}this.set("value",n.join(m));},isValid:function V(){var d=this.validationStatus;if(!d){this.validate();}return this.validationStatus.code===b.VALID;},clearValidation:function a(){this.set("validationStatus",{code:b.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function E(s){var o=this.constraints,p=o.regExp,f=o.validator,d={id:this.id,code:b.VALID,msg:""},n=this.dtp,m=(A[n]===1),e=(A[n]===2||A[n]===5),g=(A[n]===3),h=(A[n]===6),l=U.isEmpty(s),q=String(s).length,k="",u=mstrmojo.locales.validation;if(this.required&&l){d.code=b.INVALID_EMPTY;d.msg=u.requiredFieldError;return d;}s=U.trim(s);if(!l&&P(this,s)){if(m){k=u.integerDataType;}if(e){k=u.numericDataType;}if(h){k=u.dateDataType;}d.code=b.INVALID_CHAR;d.msg=u.invalidCharError.replace("#",k);return d;}if(!l&&h&&R(this,s)){d.code=b.INVALID_BAD_DATESTRING;d.msg=u.invalidDateStringError;return d;}if(!l&&(e||m)&&K(this,s)){d.code=b.INVALID_BAD_NUMERICFORMAT;d.msg=u.invalidNumericFormatError;return d;}if(!l&&(m||e||h)&&c(this,s)){d.code=b.INVALID_OUTOFRANGE;if(o.min!==null&&o.max!==null){k=u.outofRangeError.replace("# ","").replace("##",o.min).replace("###",o.max);}else{if(o.min!==null){k=u.noLessMinError.replace("##",o.min).replace("# ","");}else{if(o.max!==null){k=u.noGreaterMaxError.replace("###",o.max).replace("# ","");}}}d.msg=k;return d;}if(g&&o.minLen!==null&&o.maxLen!==null){if(q<o.minLen||q>o.maxLen){d.code=b.INVALID;d.msg=mstrmojo.desc(9211).replace(/#/,o.minLen).replace(/##/,o.maxLen);return d;}}if(p&&!p.test(s)){d.code=b.INVALID_REGEX;d.msg=mstrmojo.desc(9205);return d;}var t=f&&f.apply(this,[s]);if(t){d.code=t.code;d.msg=t.msg;return d;}return d;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css");var G=mstrmojo.array,F=mstrmojo.expr,H=mstrmojo.css;mstrmojo._IsExprNode=mstrmojo.provide("mstrmojo._IsExprNode",{ind:function B(){var L=this.parent;if(L&&L.indent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.indent(K);}}},out:function D(){var L=this.parent;if(L&&L.outdent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.outdent(K);}}},andOrTxt:function A(){var M=this.parent,K=M&&M.data,L="",N=this.data;if(K&&(K.et===F.ET.ANDOR)&&K.fn){L=K.fn+(N&&N.not?"_"+F.FN.NOT:"");L=F.BRANCH_FNS[L];}return'<span class="mstrmojo-text mstrmojo-andor">'+L+"</span>";},getPrefixAndOrToolsMarkup:function(){return('<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5896,"Ungroup Conditions")+"</span>");},premousedown:function J(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e);if(this.prefixHoverNode&&mstrmojo.dom.contains(this.prefixHoverNode,L,false)){mstrmojo.dom.stopPropogation(K.hWin,K.e);return ;}if(this._super){this._super(K);}},isSelectableArea:function E(K){return true;},childIndex:function I(){var M=this.parent,K=M&&M.data,L=K&&K.nds,N=this.data;if(L&&N){return G.indexOf(L,N);}return -1;},toggleGroupBorder:function C(K){H.toggleClass(this.parent.itemsContainerNode.childNodes[this.childIndex()-1].firstChild,"upgroup",K);H.toggleClass(this.domNode,"downgroup",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var H=mstrmojo.hash,E=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=H.clone(I);O.data=M;O.parent=N;return E.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length),N,I;for(N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L,O,I,R;for(O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}var M,Q,K;for(M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},H.copy(mstrmojo.ListBuilder)));}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.fx");var Y=mstrmojo.css,H=mstrmojo.dom,O=mstrmojo.array,K={v:{styleDim:"height",styleDir:"top",dimension:"h",position:"y",scroll:"scrollTop",scrollDimension:"scrollHeight",cls:"vertical",hostCls:"hasVertical",scrollNodeCls:"hasVertical"},h:{styleDim:"width",styleDir:"left",dimension:"w",position:"x",scroll:"scrollLeft",scrollDimension:"scrollWidth",cls:"horizontal",hostCls:"hasHorizontal",scrollNodeCls:"hasHorizontal"}},W="scrollingMode",R="scrolling",b=3;var L=H.getOSInfo().name.toLowerCase().indexOf("mac")>=0;function J(){return(this.scrollbarHostNode||(this.scrollNode&&this.scrollNode.parentNode));}function P(d,c){var k=H.eventTarget(c,d),g=this.scrollNode,f=H.position(g),h=this.scrollTrackNodes,e=this.scrollBarNodes,l=function l(t){var r=k===h[t];if(r){var u=K[t],m=e[t],w=H.position(m),o=H.getMousePosition(d,c)[u.position],p=o-w[u.position],n=p>0?1:-1,s=g[u.scrollDimension],x=Math.abs(p-(w.h/2))*(s/f[u.dimension]),q={};q[u.scroll]={isStyle:false,start:g[u.scroll],stop:g[u.scroll]+(n*Math.min(s/3,500,x)),ease:mstrmojo.ease.linear};(new mstrmojo.fx.AnimateProp({props:q,duration:200,interval:10,target:g})).play();}};l.call(this,"h");l.call(this,"v");}function B(d,c){var g=this.scrollNode,f=d.type==="mousewheel",e=f?-1:1;mstrmojo.array.forEach(["h","v"],function(p){var n=K[p],k=f?"wheelDelta":"delta",m=d[k+{h:"X",v:"Y"}[p]]*e,l=Math.abs(m),h=m/l,o=l===3&&H.isFF&&!L;g[n.scroll]+=o?h*40:m;});H.stopPropogation(c,d);H.preventDefault(c,d);}function a(h){var g=K[h],f=this.scrollNode,e=H.position(f),d=e[g.dimension],k=f[g.scrollDimension],c=Math.ceil(d)/k;return A(c,d,k);}function A(d,c,e){return(!isNaN(d)&&d<1)&&(Math.abs(c-e)>b);}function C(AA){var s="px",m=K[AA],e=this.scrollNode,n=J.call(this),AB=H.position(e),o=AB[m.dimension],u=e[m.scrollDimension],d=Math.ceil(o)/u,z=this.scrollBarNodes,k=z[AA],q=this.scrollTrackNodes,r=q[AA],x=A(d,o,u),f=m.cls;if(!k){r=q[AA]=document.createElement("div");var g=this,p=function(AD){P.call(g,AD);},l=function(AD){B.call(g,AD);},w=function(AF,AD,AE){H.attachEvent(AF,AD,AE);g.installedEventListeners.push({e:AF,evt:AD,fn:AE});};w(r,"click",p);r.className="mstrmojo-scrolltrack "+f;k=z[AA]=document.createElement("div");k.className="mstrmojo-scrollbar "+f;r.appendChild(k);n.appendChild(r);var y=mstrApp.isSingleTier?"mousewheel":"wheel";w(r,y,l);w(k,y,l);}var AC=k.style,h=(e[m.scroll]/e[m.scrollDimension]),c=H.delta(e,J.call(this))[m.position],t=r.style;if(x){t[m.styleDir]=c+s;AC[m.styleDim]=(d*o)+s;AC[m.styleDir]=(o*h)+s;}Y.toggleClass(n,m.hostCls,x);Y.toggleClass(e,m.scrollNodeCls,x);return x;}function G(){return !(mstrApp.isSingleTier&&L);}mstrmojo.ui._HasScroller=mstrmojo.provide("mstrmojo.ui._HasScroller",{_mixinName:"mstrmojo.ui._HasScroller",hasCustomScrollbar:null,draggable:true,ownAvatar:true,scrollNode:undefined,scrollbarHostNode:undefined,scrollBarNodes:undefined,setupScrollNodes:mstrmojo.emptyFn,installedEventListeners:null,init:function T(c){this._super(c);if(this.hasCustomScrollbar===null){this.hasCustomScrollbar=G();}this.installedEventListeners=[];},onRender:function I(){if(this._super){this._super();}this.updateScrollbars();this.addScrollNodeProperties();},addScrollNodeProperties:function F(){var d=this.scrollNode;if(d){var c=H.attachMarkupEvent(this.id,d,"scroll");this.installedEventListeners.push({e:d,evt:"scroll",fn:c});}if(!this.hasCustomScrollbar){Y.addClass(d,"mstrmojo-sb-show-default");return ;}if(d){Y.addClass(J.call(this),"mstrmojo-scrollbar-host");Y.addClass(d,"mstrmojo-scrollNode");}},updateScrollbars:function Z(){if(!this.hasRendered){return ;}this.setupScrollNodes();if(!this.hasCustomScrollbar){if(this.scrollNode){this.scrollNode.style.overflowX=a.call(this,"h")?"scroll":"hidden";}return ;}if(this.scrollNode){this.scrollBarNodes=this.scrollBarNodes||{};this.scrollTrackNodes=this.scrollTrackNodes||{};var c=this.scrollNode.style;c.overflowY=C.call(this,"v")?"scroll":"hidden";c.overflowX=C.call(this,"h")?"scroll":"hidden";}},onscroll:function V(){var l=this.scrollNode;if(l&&this.hasCustomScrollbar){var g=function g(m){var o=parseInt(m);return o===null||isNaN(o)?0:o;},h=H.position(l),k=h.h-g(Y.getStyleValue(l,"padding-bottom")),d=h.w-g(Y.getStyleValue(l,"padding-right")),f=this.scrollBarNodes,e=f.v,c=f.h;if(l.scrollHeight-k>0){e.style.top=((k-H.position(e).h)*(l.scrollTop/(l.scrollHeight-k)))+"px";}if(l.scrollWidth-d>0){c.style.left=((d-H.position(c).w)*(l.scrollLeft/(l.scrollWidth-d)))+"px";}}if(this._super){this._super();}if(this.onScrollEnd){this.onScrollEnd();}},getDragData:function E(d){var g=this.scrollNode,f=H.position(g),e=d.src.node,c=this.scrollBarNodes;if(this.isDraggingScrollBar(d)){return{isScrollBar:true,direction:e===c.v?"v":"h",scrollTop:g.scrollTop,scrollLeft:g.scrollLeft,conversionRatio:{y:g.scrollHeight/f.h,x:g.scrollWidth/f.w}};}return(this._super&&this._super(d));},isDragValid:function D(c){return this.isDraggingScrollBar(c)||(this._super&&this._super(c))||false;},isDraggingScrollBar:function S(d){var e=d.src.node,c=this.scrollBarNodes;return !!c&&(e===c.v||e===c.h);},ondragstart:function X(c){if(this.isDraggingScrollBar(c)){Y.addClass(c.src.node,R);Y.addClass(J.call(this),W);}if(this._super){this._super(c);}},shouldDragBubble:function Q(c){var d=c.src.node,e=this.scrollTrackNodes;return !!e&&(d===e.v||d===e.h);},ondragmove:function N(d){if(this.isDraggingScrollBar(d)){var n=d.tgt,c=d.src,o=n.pos,e=c.pos,k=c.node,h=this.scrollNode,m=this.scrollBarNodes,l=c.data,g={y:(o.y-e.y),x:(o.x-e.x)},f=l.conversionRatio;if(k===m.v){h.scrollTop=l.scrollTop+(g.y*f.y);}else{h.scrollLeft=l.scrollLeft+(g.x*f.x);}}if(this._super){this._super(d);}},ondragend:function N(c){if(this.isDraggingScrollBar(c)){Y.toggleClass(c.src.node,R,false);Y.toggleClass(J.call(this),W,false);}if(this._super){this._super(c);}},widgetResized:function M(){if(this._super){this._super();}this.updateScrollbars();},unrender:function U(c){O.forEach(this.installedEventListeners,function(d){H.detachEvent(d.e,d.evt,d.fn);});delete this.scrollNode;delete this.scrollbarHostNode;delete this.scrollBarNodes;delete this.scrollTrackNodes;this._super(c);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.fx.AnimateProp");var S=mstrmojo.css;var Q=10;function C(W,Z,Y){W.pauseScrollRendering(true);var X=W.scrollboxNode,V=W.animate?W.scrollEffect:null;if(V&&V.play){if(V.isPlaying){V.cancel();}V.props={scrollTop:{start:X.scrollTop,stop:Z,isStyle:false}};V.onEnd=function(){W.pauseScrollRendering(false,null,Y);};V.play();}else{X.scrollTop=Z;W.pauseScrollRendering(false,null,Y);}}function K(c,e,V){var W=4;if(!V){V=0;}var f=Math.round(c.renderBlockSize/2);c.fillAt(Math.max(0,e-f),e+f);var b=c.itemsContainerNode,a=b.childNodes[e],Z=c.listMapper.itemOffsetTop(c,b,null,a),d=parseInt(c.scrollboxNode.clientHeight/2,10)-a.offsetHeight/2,X=Math.max(0,c.spacerMargin+Z-d);if(Math.abs(c.scrollboxNode.scrollTop-X)>2){C(c,X,c.renderOnScroll?function(){if(V<=W){K(c,e,V++);}}:null);}else{var Y=c.animate?c.scrollEffect:null;if(Y&&Y.isPlaying&&Y.cancel){Y.cancel();c.pauseScrollRendering(false);}}}function J(X){var Y=X.itemsContainerNode,V=Y.lastChild,W=V?V.offsetTop+V.offsetHeight-Y.firstChild.offsetTop:0;return W;}function U(W){var V=J(W),X=Math.max(0,parseInt((W.scrollboxNode.clientHeight-V)/2,10));C(W,Math.max(0,W.spacerMargin-X));}function H(X){var V=X.selectedIndex,W=V>-1;X.set("hasSelection",W);if(!X.domNode){return ;}if(W){K(X,V);}else{U(X);}}function E(W){var Y=W.scrollboxNode,V=J(W),X=V>Y.clientHeight/2;S.toggleClass(W.upArrowNode,["enabled"],X);S.toggleClass(W.downArrowNode,["enabled"],X);}function N(V,W){var X=V.scrollboxNode;X.scrollTop=Math.min(Math.max(X.scrollTop+W,0),X.scrollHeight-X.offsetHeight);}function B(W,V){if(!W._scrollInter){var X=Q*(V?-1:1);W._scrollInter=window.setInterval(function(){N(W,X);},50);}}function R(V){if(V._scrollInter){window.clearInterval(V._scrollInter);V._scrollInter=null;}}mstrmojo._IsDial=mstrmojo.provide("mstrmojo._IsDial",{markupString:'<div id="{@id}" class="mstrmojo-Dial {@cssClass}" style="position:relative;"><div class="mstrmojo-Dial-uparrow"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], true)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], true)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"></div><div class="mstrmojo-Dial-scrollbox {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-Dial-spacer" style="{@spacerCssText}"><div class="mstrmojo-Dial-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div></div></div><div class="mstrmojo-Dial-dnarrow" onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], false)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], false)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.childNodes[1];},spacerNode:function(){return this.domNode.childNodes[1].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},upArrowNode:function(){return this.domNode.childNodes[0];},downArrowNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){S.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);}},animate:true,itemsEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:500,interval:25,slot:"itemsContainerNode",preStart:function(){var W=this.widget[this.slot],V=(W&&W.offsetWidth)||0;this.props=V?{left:{start:-V,stop:0,suffix:"px",isStyle:true}}:{};},revertOnCancel:false},scrollEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:250,interval:25,slot:"scrollboxNode",revertOnCancel:false},multiSelect:false,holdJumpOnly:true,audibles:{"*":true,hasSelection:false},initSpacer:function I(){var V=(this.cssText||"").match(/height:\s*(\d*)px/);if(V){this.spacerMargin=parseInt(Number(V[1])/2,10);var W=this.spacerMargin+"px";this.spacerCssText="padding-top: "+W+"; padding-bottom: "+W+";";}else{this.spacerMargin=0;delete this.spacerCssText;}},center:function T(){H(this);},preBuildRendering:function(){this.initSpacer();return this._super();},postBuildRendering:function D(){this._super();this.center();E(this);},refreshScroll:function G(){this.center();E(this);},prechange:function O(V){this._super(V);if(this.hasRendered){if(!this.multiSelect||(V&&V.added&&V.added.length)){this.center();}}},onclickarrow:function A(X,W,V){N(this,Q*(V?-1:1));},onmouseoverarrow:function L(X,W,V){if(!this.holdJumpOnly){B(this,V);}},onmouseoutarrow:function M(X,W,V){R(this);},onmousedownarrow:function F(X,W,V){if(this.holdJumpOnly){B(this,V);}},onmouseuparrow:function P(X,W,V){R(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.string","mstrmojo.css");var K=mstrmojo.css,N=mstrmojo.string,H=mstrmojo.dom,L=13,C=27;function I(S){if(this._editComplete){return ;}var W,Q=false,V=this.text,T=false;if(S===C){W=V;T=true;Q=true;}if(!S||(!this.allowNewLine&&S===L)){var R=this[this.editableSlot],U=R.innerText||R.textContent||"";if(!this.allowNewLine){W=U.replace(/\n/g,"");}else{W=U;}Q=true;if(!this.allowEmptyText&&W.length===0){W=V;T=true;}}if(Q){this._editComplete=true;W=W.replace(/\u00A0/g,"\u0020");this.text=W;this.set("isEditing",false);this.onTextEditComplete(W!==V,V);delete this._editComplete;}if(T){this.refresh();}}function E(Q){var R={dblclick:"editOnDoubleClick",click:"editOnClick"};if(this[R[Q.name]]&&Q.getTarget()===this[this.editableSlot]){this.set("isEditing",true);}}function F(S,R,Q){if(typeof R["on"+Q]!=="function"){H.attachMarkupEvent(S,R,Q);}}mstrmojo._HasEditableText=mstrmojo.provide("mstrmojo._HasEditableText",{_mixinName:"mstrmojo._HasEditableText",editableSlot:"domNode",editButtonSlot:null,isEditing:false,editOnClick:true,allowEmptyText:false,allowNewLine:false,editOnDoubleClick:false,onTextEditComplete:mstrmojo.emptyFn,postBuildRendering:function A(){this._super();var S=this.editableSlot,Q=this[S],T=this[this.editButtonSlot||S];K.addClass(Q,"hasEditableText");this.text=this.text||Q.innerText||Q.textContent||"";Q.innerHTML=N.encodeHtmlString(this.text,true).replace(/ (?= )/g,"&nbsp;");var R=this.id;if(this.editOnClick){F(R,T,"click");}F(R,T,"dblclick");F(R,Q,"blur");F(R,Q,"keyup");F(R,Q,"keydown");},onclick:function P(Q){E.call(this,Q);if(this._super){this._super(Q);}},ondblclick:function G(Q){E.call(this,Q);},onblur:function M(){I.call(this);},onkeyup:function B(R){var Q=window.event||R.e;I.call(this,Q.keyCode);},onkeydown:function J(R){var Q=window.event||R.e;if(Q.keyCode===L){I.call(this,Q.keyCode);R.cancel();}},_set_text:function D(S,Q){var R=this.text;this.text=Q;if(this.hasRendered){this[this.editableSlot].innerHTML=N.encodeHtmlString(Q||"",true);}return(R!==Q);},onisEditingChange:function O(){if(this.hasRendered){var Q=this[this.editableSlot],R=!!this.isEditing;Q.contentEditable=R;Q.spellcheck=false;K.toggleClass(Q,"editable",R);if(R){Q.focus();H.setElementSelection(Q);}else{Q.blur();Q.scrollLeft=0;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,K="mstrmojo-itemwrap",J="&nbsp;",I=mstrmojo.array;function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function N(l,Z,k,o,W,c,q,n){if(!Z){return{start:0,end:0};}var e=this.wrapperNodes(l),g=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,f=k+o,d=e[0].offsetTop,b;for(var m=1;m<=Y;m++){b=e[g].offsetTop-d+n;if(b<k){X=g;}else{if(b>f){V=g;}}var a=Math.round(Z/Math.pow(2,m+1));g+=(b>k)?-a:a;g=Math.min(Math.max(0,g),Z-1);}return{start:X,end:V};},findWrapper:function L(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function F(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function S(c,V,X,b,W){var Y=this._nd2iw(c,V,X),d,a,e;if(Y){a=this._iw2idx(c,V,Y);d=a;e=this.itemOffsetTop(c,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+e+Z/2){d++;e+=Z;}}else{return c.dropCuePos;}return{left:0,top:e,idx:d,idxActual:a};},getWrapperCss:function(V){return K;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function P(e,b,h,d,a,l){var m=this.itemWrapperPrefix(h),g=this.itemWrapperSuffix,Z=m+this.itemWrapperPrefill+g,Y=[this.markupPrefix],W=1,V=h.selectedIndices||{},o=function n(p,k){for(var q=p;q<k;q++){Y[W++]=m;var r=b.build(h,d,e[q],q);if(V[q]){r=r.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=r;Y[W++]=g;}};var c=(e&&e.length)||0;a=a&&b?Math.min(a,c):0;if(a){o(0,a);}l=l&&b?Math.min(l,c-a):0;var f=c-l;for(var X=a;X<f;X++){Y[W++]=Z;}if(l){o(f,c);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,g,d,n,f,W,b,m){var e=(g&&g.length)||0,l=this.wrapperNodes(X),o=f.itemStatus,V=mstrmojo.css,Z=n.selectedIndices||{};for(var c=W,h=Math.min(b+1,e),a=0;c<h;c++){if(o[c]!==A){l[c].innerHTML=d.build(n,f,g[c],c);if(Z[c]){var Y=l[c].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===m){break;}}}return a;},onadd:function O(e,V,Z,f){if(V&&f){var a=f.value.length,b=this.wrapperNodes(V),d=b[f.index],Y=this.getWrapperCss(e);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=J;if(d){this.wrapperParentNode(V).insertBefore(W,d);}else{this.wrapperParentNode(V).appendChild(W);}}T(e,this);}},onremove:function Q(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var d=X.value.length;for(var Z=X.index+d-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function R(g,X,c,k){if(X&&k){var d=this.wrapperNodes(X);if(d){var W=mstrmojo.css,l=c.itemStatus,h;for(var b=0,V=k.removed,f=V&&V.length;b<f;b++){h=V[b];if(l[h]){W.removeClass(d[h].firstChild,["selected"]);}}for(var Z=0,e=k.added,Y=e&&e.length;Z<Y;Z++){h=e[Z];if(l[h]){W.addClass(d[h].firstChild,["selected"]);}}}}},_nd2iw:function E(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}if(X===V){break;}Y=X;X=Y.parentNode;}}return null;},_iw2idx:function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=I.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;},toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,e=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=e.clientHeight,d=e.scrollTop,Y=d;if(V<d){Y=V;}else{if(d+W-b<V){Y=Math.min(V,V-W+b);}}e.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.hash","mstrmojo.css");var F=mstrmojo.hash,C=mstrmojo.css;var D="open";function E(G){return G?G.popupConfig.hostElement:null;}mstrmojo.ui.menus._HasMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._HasMenuPopup",F.copy(mstrmojo._HasPopup));mstrmojo.ui.menus._HasMenuPopup.openPopup=function A(I,G){var H=this._lastOpened;if(H){this.closePopup();}mstrmojo._HasPopup.openPopup.call(this,I,G);C.addClass(E(I),D);};mstrmojo.ui.menus._HasMenuPopup.closePopup=function B(){C.removeClass(E(this._lastOpened),D);mstrmojo._HasPopup.closePopup.call(this);};}());(function(){mstrmojo.requiresCls("mstrmojo.css");var F=mstrmojo.css,E="px",J="hasOwnAvatar",I={x:0,y:0};function B(L){var K=this.createAvatar(L.src.node,L);if(K){F.addClass(K,[this.avatarCssClass,J]);this.avatar=L.avatar=document.body.appendChild(K);}}function C(){var K=this.avatar;if(K){K.parentNode.removeChild(K);delete this.avatar;F.removeClass(K,[this.avatarCssClass,J]);}}mstrmojo._HasOwnAvatar=mstrmojo.provide("mstrmojo._HasOwnAvatar",{_mixinName:"mstrmojo._HasOwnAvatar",draggable:true,ownAvatar:true,avatarCssClass:"",restrictedToAxis:undefined,isDragValid:function H(K){if(this._super){return this._super(K);}return false;},ondragstart:function D(K){B.call(this,K);this.positionAvatar(K.src.pos,K);if(this._super){this._super(K);}},ondragmove:function A(K){this.positionAvatar(K.tgt.pos,K);if(this._super){this._super(K);}},ondragend:function A(K){C.call(this);if(this._super){this._super(K);}},createAvatar:mstrmojo.emptyFn,positionAvatar:function G(O,L){var N=this.avatar.style,M=this.restrictedToAxis,K=(L&&L.dragOffsets)||I;if(M!=="y"){N.left=O.x+K.x+E;}if(M!=="x"){N.top=O.y+K.y+E;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var G=mstrmojo.dom,J=mstrmojo.css,H="selected";function B(S,T,U,R,W){var V=W.listHooks[S];if(V&&V.call(W,T,U,R)){return ;}J.toggleClass(T,H,S==="select");}function I(U,T,S){var V=this[U],R=V?V.split(T):[];this[U]=mstrmojo.array.distinct(R.concat(S.split(T))).join(T);}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},useListModKeys:false,init:function Q(R){this._super(R);this._shiftStartIndex=-1;},getItemMarkup:function O(S,R){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';},getItemDisplayName:function E(R){return R.n||"";},getItemProps:function K(V,R){var S=!!this.selectedIndices[R],W={tag:"div",sel:S,cls:"",n:this.getItemDisplayName(V),style:"",idx:R,addCls:function T(Y){I.call(this,"cls"," ",Y);},addStyle:function U(Y){I.call(this,"style",";",Y);},title:V.title||""};if(S){W.addCls(H);}var X=V.cls;if(X){W.addCls(X);}return W;},itemRenderer:{render:function A(S,R,T){S._renderIdx=R;return mstrmojo.string.apply(T.getItemMarkup(S,R),T.getItemProps(S,R));},select:function L(S,T,R,U){B("select",S,T,R,U);},unselect:function D(S,T,R,U){B("unselect",S,T,R,U);}},onclick:function P(R){try{var T=this.getItemFromTarget(R.getTarget());if(T){R.cancel();this.doItemSelect(T,R||{});}}catch(S){mstrApp.onerror(S);}},doItemSelect:function F(k,b){var R=b.hWin,h=b.e,c=k._renderIdx,W=k._positionIdx,S=G.isMetaKey(R,h),Z=G.shiftKey(R,h),Y=this.multiSelect,U=this.useListModKeys,d=this._shiftStartIndex,X=this.selectedIndices;if(Y&&U&&Z&&d>-1){var g=[],T=[],V=Math.min(d,c),l=Math.max(d,c),f;for(f=0;f<this.items.length;f++){if(V<=f&&f<=l){if(!X[f]){g.push(f);}}else{if(X[f]){T.push(f);}}}this.addSelect(g);this.removeSelect(T);}else{if(Y&&(!U||S)){var a=(X[c])?"remove":"add";this[a+"Select"](c,false,W);}else{this.singleSelect(c,false,W);}this._shiftStartIndex=c;}},onclearSelection:function N(){this._shiftStartIndex=-1;},getItemNodeFromTarget:function C(S){var R=G.findAncestorByAttr(S,"idx",true,this.domNode);return(R&&R.node)||null;},getItemFromTarget:function M(T){var S=this.getItemNodeFromTarget(T),R=S&&parseInt(S.getAttribute("idx"),10);if(R!==null&&!isNaN(R)&&this.items){return this.items[R];}return undefined;}});mstrmojo._IsList.SELECTED_CLS=H;}());(function(){mstrmojo.requiresCls("mstrmojo.css");var A=mstrmojo.css;mstrmojo.ui._HasUITheme=mstrmojo.provide("mstrmojo.ui._HasUITheme",{_mixinName:"mstrmojo.ui._HasUITheme",themeClassName:"",postBuildRendering:function B(){var D=this.themeClassName;if(D){this.onthemeClassNameChange({value:D});}return this._super();},onthemeClassNameChange:function C(D){var F=this.domNode;if(F){var G=D.value,E=D.valueWas;if(G){A.addClass(F,D.value);}if(E){A.removeClass(F,D.valueWas);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","fx"],RW:[]};J.RW=["z-index"].concat(J.T.concat(J.D));var D=mstrmojo.dom,O=mstrmojo.css;function N(T,V,S){var U=T[V]||[];U.push(S);T[V]=U;}function L(W,V){var U=((W&&W.fmts)||null);if(V){var Y=W.thresholds,T=Y&&Y[V];if(T){var X={},Z;for(Z in U){X[Z]=T[Z]||U[Z];}for(Z in T){var S=T[Z];X[Z]=(typeof S==="string")?(S+" !important"):S;}U=X;}}return U;}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(T){var S=true;this.invisible=!!(T&&T.data&&T.data.invisible);if(this._super){S=this._super(T);}return S;},buildCSSFormatString:function H(U,d){var h=this.formatHandlers[U],l=h.src?d[h.src]:d;if(!l){return null;}var b=h.props||h;if(!b){return null;}var X=[],g=-1;var V=b.length-1;for(V;V>=0;V--){var k=b[V];var c=J[k]||[k];var a=c.length-1;for(a;a>=0;a--){k=c[a];var T=l[k];if(T!==undefined){if(k==="fx"){var Y=T,S={};var e=Y.gd;if(e){this.formatGradient(e,S);}var W=parseInt(Y.rt,10);if(W){if(W===1||W===3){this.formatTextRotation(Y.rt,S);}}if(Y.ds){this.formatDropShadow(Y,S);}var Z;for(Z in S){X[++g]=Z+":"+S[Z].join(" ");}}else{X[++g]=k+":"+T;}}}}if(this.invisible){X.push("visibility:hidden");}return X.join(";")+";";},applyCSSFormatToNode:function I(U,S){var V=this[U],T=V&&V.style;if(T){this.buildCSSFormatString(U,S).split(";").forEach(function(W){var X=W.split(":");T[O.convertCssToCamelCase(X[0])]=X[1];});}},clearSlotBackgroundCSS:function F(T){var U=this[T],S=U&&U.style;if(S){S.background="transparent none 0 0 no-repeat";S.filter="none";}},preBuildRendering:function B(){this._super();var V=this.formatHandlers,S=this.getFormats();if(V&&S){var W=this.defn=this.defn||{},X=this.getCacheKey(),U=W[X];if(!U){U=W[X]={};for(var T in V){var Z=T+"CssText";this[Z]=U[Z]=this.buildCSSFormatString(T,S)||"";}}else{var Y;for(Y in U){this[Y]=U[Y];}}}return true;},formatGradient:function P(S,U){var T=O.buildGradient(S.t,S.sc,S.ec);if(T){N(U,T.n,T.v);}},formatDropShadow:function K(W,U){if(D.supports(D.cssFeatures.DROP_SHADOW)){var V=W.ds;if(D.isDXIE){N(U,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+V+",OffY="+V+")");}else{var S=[V,V],T=parseInt(W.rt,10);if(T===1||T===3){S[((T===1)?1:0)]=-V;}N(U,(D.isWK?"-webkit-":"")+"box-shadow",S.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(T,S){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){N(S,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+T+")");}else{var U=(T===1)?90:-90;N(S,D.CSS3_PREFIX+"transform-origin","top left");N(S,D.CSS3_PREFIX+"transform","rotate("+U+"deg)");}}},getFormats:function R(){if(!this.fmts){this.fmts=L.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function Q(){delete this.defn[this.getCacheKey()];},unrender:function M(S){if(this.thresholdId){this.fmts=null;}this._super(S);}});mstrmojo._Formattable.getBorderWidths=function(W){var V=W.getFormats(),S=(V.border)?V.border.match(/(\d*|\d*\.\d*)pt/)[0]:V["border-width"],U=W.model,T=U.docModel;return O.getBorderWidths(S,(T&&T.dpi)||U.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.css");mstrmojo.vi.ui._HasMask=mstrmojo.provide("mstrmojo.vi.ui._HasMask",{_mixinName:"mstrmojo.vi.ui._HasMask",isMasked:false,onisMaskedChange:function A(){if(!this.hasRendered){return ;}var B=this.maskNode,C=this.isMasked;B.style.display=C?"block":"none";mstrmojo.css.toggleClass(B,"masked",C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.color","mstrmojo.hash","mstrmojo.array");var AC=mstrmojo.color,V=mstrmojo.hash,BF=mstrmojo.array,BB=mstrmojo.css,d=mstrmojo.num;var BD=1,Al=2,Am=3,Az=4,AT=5,AU=6;var BK="FormattingFont",I="FormattingAppearance",X="FormattingAlignment",Aa="FormattingSize",Q="FormattingPatterns",F="FormattingBorder",Ay="FormattingOrder",E="FormattingView",O="FormattingSelector",Ao="Template Formatting",L="FormattingPadding",Aj="AnalyticalEngineProperties",Ar="RWDocumentProperties",A8="FormattingPage",N="Mobile",T="VLDB Select";var Ai=1;var g="n",M="h",BG="w",AA="wm",A5="pw",W="ml",A6="mr",s="upwalw",p="ff",Ad="fsz",A9="fw",AB="fit",BA="fun",m="fst",r="fc",U="alh",q="alv",AX="atw",AH="atd",a="textOverflow",Ah="bc",D="bgs",H="btc",Ag="brc",AQ="bbc",o="blc",k="bts",BI="brs",A0="bbs",AW="bls",AN="borderColor",Av="borderStyle",c="zIndex",AO="showTitleBar",h="title",Au="ctrlStyle",u="ctrlOrientation",At="ctrlOrientationBehavior",f="ctrlMultiselect",C="ciwm",A7="cmcy",Aw="sec",n="easow",AG="layoutXml",J="lockAspectRatio",Af="ism",e="shw",Ax="mg",BH="lhv",Y="gridVPadding",Ac="gridHPadding",Ab="ln",AF="sar",B="hnv",AZ="iw",AV="ih",AJ="tsp",AR="visible",R="rf",BJ="jad",Ak="jdc",A1="fs",A4="ssc",b="sstyle",z="hgl";function P(BL){return BL;}function AL(BL){return parseInt(BL,10);}var y={name:"encode",_def:P};y[Am]=function(BL){return BL?1:0;};y[Al]=function(BL){if(BL==="transparent"){return -1;}if(BL.length===4){BL=BL.replace(/([0-9a-f])/ig,"$1$1");}BL=AC.rgbStr2hex(BL);return parseInt(BL.substring(5)+BL.substring(3,5)+BL.substring(1,3),16);};y[Az]=AL;y[BD]=function(BL){if(typeof BL==="number"){return d.toLocaleString(BL);}return P(BL);};y[AU]=function(BN){if(BN==="none"){return 0;}var BM=BN.match(/([0-9]+[,\.]?[0-9]*pt)/)[0],BL=BN.match(/pt ([\w\W]*)/)[1];if(BM==="2pt"){return 5;}switch(BL){case"solid":return 1;case"dashed":return 3;case"dotted":return 4;default:throw new Error("Invalid border style value in FormatModel::encodeValue.");}};var BE={name:"decode",_def:P};BE[Am]=function(BL){return parseInt(BL,10)===1;};BE[Al]=function(BL){if(BL===-1){return"transparent";}if(typeof BL==="number"){return AC.decodeColor(BL);}if(BL.length===4){return BL.replace(/([0-9a-f])/ig,"$1$1");}return AC.rgbStr2hex(BL);};BE[Az]=AL;BE[AU]=function(BN){if(BN===undefined||BN===0){return"none";}var BM="1pt",BL="solid";if(BN===5){BM="2pt";}if(BN===3){BL="dashed";}else{if(BN===4){BL="dotted";}}return BM+" "+BL;};function A2(){return this.pn.toLowerCase();}function AI(BL,BN,BO){var BM=document.createElement("div");BM.style[BO||BN]=BL[BN];return BM;}function G(BL){return function(){return AC.rgbStr2hex(BL.apply(this,arguments));};}function Ae(){var BL=A2.call(this);return BL==="underline"?BL:"line-through";}var Aq={name:"extract"},S=Aq._def=function(BL,BN,BO){var BM=AI(BL,BN||this.getFormatBlockName(),BO);return BM.style[this.getCssName()];};Aq[Al]=G(S);function t(BL){return S.call(this,BL,this.getFormatBlockName())===A2.call(this);}function A(BL){var BM=S.call(this,BL,this.getFormatBlockName(),this.getCssName());return BM.indexOf(Ae.call(this))>-1;}function Ap(BL){var BM=this.getFormatBlockName();return AC.rgbStr2hex(S.call(this,BL,BM,BM+this.pn));}var BC={name:"resolve"},Z=BC._def=function(BL,BO,BN,BP){BN=BN||this.getFormatBlockName();var BM=AI(BL,BN);BM.style[BP||this.getCssName()]=BO;return BM.style[BB.convertCssToCamelCase(BN)];};BC[Al]=function(BL,BN,BM,BO){if(BN.or!==undefined){return BN;}return AC.rgbStr2hex(Z.call(this,BL,BN,BM,BO));};function AP(BL,BM){return Z.call(this,BL,BM?A2.call(this):"normal");}function AM(BM,BO){var BN=(BM[this.getFormatBlockName()]||"").split(" "),BL=Ae.call(this);if(BO){if(BN.indexOf(BL)===-1){BN.push(BL);}}else{BN=BN.filter(function(BP){return BP!==BL;});}return Z.call(this,BM,BN.join(" "));}var AY={name:"update"},A3=AY._def=function(BL,BM){BL[this.getFormatBlockName()]=this.resolve(BL,BM);return BL;};var AK={};AK[g]={ps:I,pn:"Name",pt:BD};AK[M]={ps:Aa,pn:"Height",pt:BD};AK[BG]={ps:Aa,pn:"Width",pt:BD};AK[AA]={ps:Aa,pn:"WidthMode",pt:Az};AK[A5]={ps:A8,pn:"PageWidth",pt:BD};AK[W]={ps:A8,pn:"MarginLeft",pt:BD,fn:"margin-left"};AK[A6]={ps:A8,pn:"MarginRight",pt:BD,fn:"margin-right"};AK[s]={ps:A8,pn:"UsePageWidthAsLayoutWidth",pt:Am};AK[p]={ps:BK,pn:"Name",pt:BD,fn:"font",cn:"fontFamily",extract:function(){return S.apply(this,arguments).replace(/['"]/g,"");}};AK[Ad]={ps:BK,pn:"Size",pt:Az,fn:"font",cn:"fontSize"};AK[A9]={ps:BK,pn:"Bold",pt:Am,fn:"font",cn:"fontWeight",extract:t,resolve:AP};AK[AB]={ps:BK,pn:"Italic",pt:Am,fn:"font",cn:"fontStyle",extract:t,resolve:AP};AK[BA]={ps:BK,pn:"Underline",pt:Am,fn:"text-decoration",extract:A,resolve:AM};AK[m]={ps:BK,pn:"Strikeout",pt:Am,fn:"text-decoration",extract:A,resolve:AM};AK[r]={ps:BK,pn:"Color",pt:Al};AK[U]={ps:X,pn:"Horizontal",pt:Az,fn:"text-align"};AK[AX]={ps:X,pn:"TextWrap",pt:Am,fn:"white-space"};AK[AH]={ps:X,pn:"TextDirection",pt:Az};AK[q]={ps:X,pn:"Vertical",pt:Az};AK[a]={ps:Aa,pn:"TextOverflow",pt:Am};AK[Ah]={ps:Q,pn:"FillColor",pt:Al,x:Ai,fn:"background-color",update:function(BL,BN){var BM=BL.fx;if(BN.or!==undefined){if(!BM){BM=BL.fx={};}var BO=BM.gd=BM.gd||{};BO.ec=BN.c2;BO.sc=BN.c1;BO.t=BN.or;delete BL[this.getFormatBlockName()];BL.fx=BM;}else{if(BM){delete BM.gd;}A3.call(this,BL,BN);}return BL;}};AK[D]={ps:Q,pn:"FillStyle",pt:Az};AK[A4]={ps:Q,pn:"SelectorSelectionColor",pt:Al};AK[b]={ps:Q,pn:"SelectorSelectionFillStyle",pt:Az};AK[H]={ps:F,pn:"TopColor",pt:Al,fn:"border",extract:Ap};AK[Ag]={ps:F,pn:"RightColor",pt:Al,fn:"border",extract:Ap};AK[AQ]={ps:F,pn:"BottomColor",pt:Al,fn:"border",extract:Ap};AK[o]={ps:F,pn:"LeftColor",pt:Al,fn:"border",extract:Ap};AK[AN]={ps:F,pn:["TopColor","RightColor","BottomColor","LeftColor"],pt:Al,fn:"border",extract:Ap,resolve:G(function(BL,BN){var BO=this.getFormatBlockName(),BM=Z.call(this,BL,BN,BO,BO+"Color"),BP=BM.indexOf("rgb");if(BP>-1){BM=BM.slice(0,BP)+AC.rgbStr2hex(BM.slice(BP));}return BM;})};AK[Av]={ps:F,pn:["TopStyle","RightStyle","BottomStyle","LeftStyle"],pt:AU,fn:"border",extract:Ap,resolve:function(BL,BO){var BM=BO.split(" "),BP=this.getFormatBlockName();BL[BP]=Z.call(this,BL,BM[0],BP,BP+"Width");var BN=Z.call(this,BL,BM[1]||"none",BP,BP+"Style"),BQ=BN.indexOf("rgb");if(BQ>-1){BN=BN.slice(0,BQ)+AC.rgbStr2hex(BN.slice(BQ));}if(BN.indexOf("#")===-1&&BN.indexOf("transparent")===-1){BN+=" transparent";}return BN;}};AK[k]={ps:F,pn:"TopStyle",pt:AU,fn:"border",extract:Ap};AK[BI]={ps:F,pn:"RightStyle",pt:AU,fn:"border"};AK[A0]={ps:F,pn:"BottomStyle",pt:AU,fn:"border",extract:Ap};AK[AW]={ps:F,pn:"LeftStyle",pt:AU,fn:"border",extract:Ap};AK[c]={ps:Ay,pn:"ZIndex",pt:Az,fn:"z-index"};AK[AO]={ps:E,pn:"ShowTitleBar",pt:Am};AK[h]={ps:E,pn:"Title",pt:BD};AK[Au]={ps:O,pn:"Style",pt:Az};AK[u]={ps:O,pn:"Orientation",pt:Az};AK[At]={ps:O,pn:"OrientationBehavior",pt:Az};AK[f]={ps:O,pn:"Multiselect",pt:Am};AK[C]={ps:O,pn:"ItemWidthMode",pt:Az};AK[A7]={ps:O,pn:"MetricConditionType",pt:Az};AK[Aw]={ps:O,pn:"ShowElementCount",pt:Az};AK[n]={ps:O,pn:"ExportAsShownOnWeb",pt:Az};AK[AG]={ps:Aa,pn:"LayoutXML",pt:AT};AK[J]={ps:Aa,pn:"LockAspectRatio",pt:Am};AK[Af]={ps:Aa,pn:"ImageSizeMode",pt:Az};AK[AV]={ps:Aa,pn:"ImageHeight",pt:BD};AK[AZ]={ps:Aa,pn:"ImageWidth",pt:BD};AK[AJ]={ps:Ar,pn:"layoutBarPosition",pt:Am};AK[A1]={ps:Ar,pn:"ExecutionFullScreenMode",pt:Am};AK[AR]={ps:I,pn:"Visible",pt:Am};AK[Ab]={ps:Ao,pn:"LongNames",pt:BD};AK[AF]={ps:Aj,pn:"ShowAllRows",pt:BD};AK[B]={ps:Aj,pn:"HideNullZeroValues",pt:BD};AK[Ac]={ps:L,pn:["LeftPadding","RightPadding"],pt:BD};AK[Y]={ps:L,pn:["TopPadding","BottomPadding"],pt:BD};AK.rowsshw={ps:Ao,pn:"ShowRowHeaders",pt:BD};AK.rowsmg={ps:Ao,pn:"MergeCells",pt:BD};AK.rowslhv={ps:Ao,pn:"LockRowHeaders",pt:BD};AK.colsshw={ps:Ao,pn:"ShowColumnHeaders",pt:BD};AK.colsmg={ps:Ao,pn:"MergeColumnCells",pt:BD};AK.colslhv={ps:Ao,pn:"LockColumnHeaders",pt:BD};AK[R]={ps:N,pn:"RefreshFrequency",pt:Az};AK[BJ]={ps:T,pn:"Join Across Datasets",pt:Az};AK[Ak]={ps:T,pn:"MCE Join To Get Data Combination",pt:Az};AK[z]={ps:I,pn:"Highlight",pt:Az};BF.forEach(V.keyarray(AK),function(BL){var BM=AK[BL];BM.getFormatBlockName=function(){var BO=this.fn;if(!BO){var BN=this.pn;BO=BN.charAt(0).toLowerCase()+BN.substr(1);}return BO;};BM.getCssName=function(){var BN=this.getFormatBlockName.call(this),BO=this.cn;if(!BO){BO=BB.convertCssToCamelCase(BN);}return BO;};BF.forEach([y,BE,Aq,BC,AY],function(BN){var BO=BN.name;BM[BO]=BM[BO]||BN[BM.pt]||BN._def;});});function As(BO,BN,BL){var BM=BL[BO.ps]=BL[BO.ps]||{};BN=BO.encode(BN);BF.forEach([].concat(BO.pn),function(BP){BM[BP]=BN;});return BL;}function AE(BR,BQ,BL){var BP=BR.x;if(BP){if((BP&Ai)>0){var BO=!!BQ.c1,BN=0;if(BO){As(BR,BQ.c1,BL);var BM=BL[Q];BM.GradientColor=BR.encode(BQ.c2);BM.GradientAngle=BQ.or?0:90;BM.GradientXOffset=0;BM.GradientYOffset=0;BN=2;}else{if(BR.encode(BQ)===-1){BN=1;}else{As(BR,BQ,BL);}}return As(AK[D],BN,BL);}}return null;}mstrmojo.models.FormatModel={getFormatUpdate:function AS(BM,BP,BL){var BO=AK[BM];if(!BO){throw new Error("Invalid property "+BM+" in FormatModel::getFormatUpdate.");}BL=BL||{};var BN=AE.call(this,BO,BP,BL);if(BN){return BN;}return As(BO,BP,BL);},getFormatPropertyInfo:function l(BL){return AK[BL];},getValueFromUpdate:function K(BM,BN){var BP=AK[BM],BL=null;try{BL=BN[BP.ps][BP.pn];}catch(BO){}return BL;},getGradientValues:function AD(BM){var BL=BM.fx&&BM.fx.gd;if(BL){var BO={c1:BL.sc,c2:BL.ec,or:BL.t};return BO;}if(BM[D]===2){var BN={c1:BM.bc,c2:BM.gdc,or:BM.gda===90?0:1};return BN;}return null;},decodeValue:function x(BL,BM){return AK[BL].decode(BM);},updateFormatBlock:function An(BL,BM,BN){return AK[BM].update(BL,BN);},getFormatBlockValue:function w(BL,BM){return AK[BM].extract(BL);},GradientType:null,FormatObjectType:null,PROPERTY_INFO_TYPE:null,ENUM_PROPERTY_NAMES:{NAME:g,HEIGHT:M,WIDTH:BG,WIDTH_MODE:AA,PAGE_WIDTH:A5,MARGIN_LEFT:W,MARGIN_RIGHT:A6,USE_PAGE_WIDTH_AS_LAYOUT_WIDTH:s,FONT_FAMILY:p,FONT_SIZE:Ad,FONT_WEIGHT:A9,FONT_STYLE:AB,UNDERLINE:BA,LINE_THROUGH:m,COLOR:r,TEXT_ALIGN:U,VERTICAL_ALIGN:q,TEXT_WRAP:AX,TEXT_DIRECTION:AH,TEXT_OVERFLOW:a,BACKGROUND_COLOR:Ah,FILL_STYLE:D,BORDER_TOP_COLOR:H,BORDER_RIGHT_COLOR:Ag,BORDER_BOTTOM_COLOR:AQ,BORDER_LEFT_COLOR:o,BORDER_TOP_STYLE:k,BORDER_RIGHT_STYLE:BI,BORDER_BOTTOM_STYLE:A0,BORDER_LEFT_STYLE:AW,BORDER_COLOR:AN,BORDER_STYLE:Av,Z_INDEX:c,SHOW_TITLE_BAR:AO,TITLE:h,CONTROL_STYLE:Au,CONTROL_ORIENTATION:u,CONTROL_ORIENTATION_BEHAVIOR:At,CONTROL_MULTISELECT:f,CONTROL_ITEM_WIDTH_MODE:C,CONTROL_METRIC_CONDITION_TYPE:A7,CONTROL_SHOW_ELEMENT_COUNT:Aw,CONTROL_EXPORT_AS_SHOWN_ON_WEB:n,LAYOUT_XML:AG,LOCK_ASPECT_RATIO:J,IMAGE_SIZE_MODE:Af,SHOW_HEADER:e,MERGE_HEADER:Ax,LOCK_HEADER:BH,LONG_NAME:Ab,SHOW_ALL_ROWS:AF,HIDE_NULL:B,IMAGE_WIDTH:AZ,IMAGE_HEIGHT:AV,VISIBLE:AR,LAYOUT_TAB_POSITION:AJ,GRID_VERTICAL_PADDING:Y,GRID_HORIZONTAL_PADDING:Ac,REFRESH:R,JOIN_ACROSS_DATASET:BJ,MCE_JOIN_TO_GET_DATA_COMBINATION:Ak,FULL_SCREEN_MODE:A1,SELECTOR_SELECTION_COLOR:A4,SELECTOR_SELECTION_FILL_STYLE:b,VIZ_HIGHLIGHTING:z}};}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.Obj");function B(J,I){this.raiseEvent({name:"viCompBuilt",type:J,widget:I});}mstrmojo.vi.models.VIComponentMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.VIComponentMap",init:function G(I){this._super(I);this.relativePanels={};this.comps={};},addRelativePanel:function H(I){this.relativePanels[I]=true;},isRelativePanel:function F(I){return !!this.relativePanels[I];},isComponent:function C(J,I){return this.getComponentKey(J)===I;},getComponent:function A(I){return this.comps[I];},getComponentKey:function D(J){var I=this.getComponent(J);return(I&&I.k)||"";},createComponent:function E(L,K,J){B.call(this,L);var I=new K(J);this.comps[L]=I;B.call(this,L,I);return I;}});mstrmojo.vi.models.VIComponentMap.TYPES={FILTER_STACK:1,FILTER_PANEL:2,PAGEBY_STACK:3,PAGEBY_PANEL:4,VIZ_CONTENT:5,MAIN_CONTENT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9,toXml:function A(){var K=this,D=function(Q,R){return" "+Q+'="'+R+'"';},C=function(Q,R){return D(Q,mstrmojo.string.encodeXMLAttribute(R));},G=new mstrmojo.StringBuffer(),E=function(R,S){var Q=mstrmojo.string.multiReplace(S.disp_n,{"&nbsp;":" "});R.append("<e"+C("ei",S.ei)+C("disp_n",Q)+D("emt",S.emt)+"/>");};var I=this.prms,B=I&&I.length;if(B||K.aopam!=K.DO_NOT_ANSWER){G.append("<hl"+D("mid",K.mid)+D("srct",K.srct)+D("aopam",K.aopam)+">");if(B){G.append("<prms>");for(var F=0;F<B;F++){var P=I[F];G.append("<prm"+D("id",P.id)+D("am",P.am)+D("pt",P.pt));if(P.orid){G.append(D("orid",P.orid)+D("ortp",P.ortp));}G.append(">");switch(P.am){case K.DO_NOT_ANSWER:case K.CLOSE:case K.USE_DEFAULT_ANSWER:case K.SAME_PROMPT:break;case K.STATIC:G.append('<pa ia="1"><es>');var O=P.pa.es,N=O&&O.length||0;for(var J=N-1;J>=0;--J){var H=O[J];E(G,H);}G.append("</es></pa>");break;case K.DYNAMIC:case K.ALL_VALID_UNITS:case K.CURRENT_UNIT:case K.DYNAMIC_OR_SAME_PROMPT:var M=P.pa;if(M){G.append('<pa ia="1">');var L=M.a;if(L){G.append("<a"+D("id",L.id)+C("n",L.n)+">");}if(P.pt===1){G.append(mstrmojo.string.encodeXMLAttribute(M.v));}else{G.append("<es"+D("dispForms",L&&L.dispForms>=0?L.dispForms:"")+">");var O=M.es;N=O&&O.length||0;for(var J=N-1;J>=0;--J){var H=O[J];E(G,H);}G.append("</es>");if(L){G.append("</a>");}}G.append("</pa>");}break;}G.append("</prm>");}G.append("</prms>");}G.append("</hl>");}return G.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func","mstrmojo._ImageHelper","mstrmojo.rw.model.RetrievalKeysConfig","mstrmojo.rw.model.UpdateKeysConfig");var a=mstrmojo.hash,A=a.copy,R=mstrmojo.array,AO=mstrmojo.dom,s=mstrmojo.func,AG=[mstrmojo.desc(8445,"Loading")],Ah=mstrmojo.array.ensureArray,N=0;function T(BF){BF=BF||{};BF.preserveUndo=true;return BF;}function Ae(BJ,BK,BF){if(this.blockRequests){throw ("The data service is currently ignoring all requests to the server.");}var BG=N++,BI=this.getTxUpdates(BG);BF=BF||{};BF.src=Ae.caller.name;if(!mstrmojo.string.isEmpty(BI)){BJ.updateChanges=BI;}BJ.zoomFactor=this.model.getZoomFactor();var BH=this.cmdMgr;if(!BF.preserveUndo&&BH){BH.onSubmitUpdates();}mstrApp.serverRequest(BJ,this.wrapCallback(BK,BG),BF);}function L(BH,BG,BF){a.copy({unitType:BG.defn&&BG.defn.t,unitKey:BG.k},BH);if(BF.layoutKey){a.copy({toKey:BF.layoutKey,analysisSectionType:BF.analysisSectionType},BH);}else{a.copy({toKey:BF.parentKey},BH);}return BH;}function Aj(BG){BG=BG||{};var BF=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(BF){BG.styleName="RWDocumentMobileStyle";BG.availableWidth=BF.w;BG.availableHeight=BF.h;}else{BG.innerWidth=mstrmojo.dom.windowDim().w;BG.innerHeight=mstrmojo.dom.windowDim().h;}return BG;}function BA(BG){var BF=BG&&BG.style,BH=BF&&BF.params;return BH&&BH.treesToRender;}function B(BF,BG){return{act:"moveUnit",toKey:BF,unitType:BG};}function Ai(BF){return BF.split("\u001E")[2];}function K(BG,BK){if(BG!==mstrmojo.DocDataService.UNDO_KEY){return BG;}if(!this.undoSectionKey){var BJ=this.undoSectionKey=this.model.getNextKey(),BH=this.undoFGKey=this.model.getNextKey();BK.addActions({act:"addUndoSection",cbKey:this.cbKey,nodeKey:BJ,fgKey:BH});var BI=this;BK.addCallbacks({failure:function BF(){delete BI.undoSectionKey;}});}return this.undoSectionKey;}function Ad(BH,BG){var BF={dsid:BH.dsid,formula:BH.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BH.tokenStreamXML),name:BH.alias,afb:BH.afb,sfb:BH.sfb};if(BG){BF.Ids=["$GUID_135"];}return this.getAddDerivedMetricToDatasetAction(BF);}function AF(BI,BL,BG,BM,BF,BH){var BJ=[this.getNodeKeyFromKeyContext(BL)];if(!BH){BJ=Ah(BM).concat(BJ);}var BK={act:BI,keyContext:BL,tgtKey:BG,partialRetrieval:{nodes:BJ}};if(!BF){BK.partialUpdate={selectors:[Ai(BL)]};}return BK;}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.DocDataService",defaultStyle:{params:{treesToRender:2}},cmdMgr:null,stid:-1,blockRequests:false,init:function Ab(BF){this._super(BF);this.cmdMgr=this.model.controller.cmdMgr;},wrapCallback:function AU(BJ,BG){var BH=this;return s.wrapMethods({success:function BI(BK){if(BK){BH.model.bs=BH.rwb=BK.bs||BH.rwb;BH.msgId=BK.mid||BH.msgId;BH.cbKey=BK.cbKey||BH.cbKey;if(BK.stid!==undefined){BH.stid=BK.stid;}}BH.clearTxUpdates(BG);},failure:function BF(){BH.resetTxUpdates(BG);}},BJ);},getNodeKeyFromKeyContext:function V(BF){return BF.split("\u001E")[1];},refresh:function Ao(BH,BI){var BG=!!BH.useRefreshProgress,BF=BG?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:AG;delete BH.useRefreshProgress;BH=Aj(BH);Ae.call(this,A(BH,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false}),BI,{showProgress:true,hideProgress:true,progressStateText:BF,useRefreshProgress:BG});},saveRW:function Ar(BF,BG){Ae.call(this,A(BF,{taskId:"saveRW",msgID:this.msgId}),BG);},saveThresholds:function e(BG,BH,BF){Ae.call(this,A(BG,{taskId:"saveThresholds"}),BH,BF);},getThresholds:function A4(BG,BH,BF){Ae.call(this,A(BG,{taskId:"getThresholds"}),BH,BF);},browseElements:function AC(BF,BG){Ae.call(this,A(BF,{taskId:"browseElements",styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30}),BG);},removeUnit:function U(BG,BH){var BF=A(BG,{act:"removeUnit"});this.submitTemplateUpdates(BF.nodeKey,BF,BH);},removeLayout:function AJ(BG,BF,BH){this.submitUpdates({act:"removeLayout",unitKey:BG,isCurrent:BF},BH);},moveLayout:function q(BH,BF,BG){this.submitUpdates(this.getMoveNodeAction(BH,BF,BG),mstrmojo.DocDataService.EMPTY_CALLBACK,mstrmojo.DocDataService.SUPPRESS_DATA);},getMacroCopyNodeAction:function Af(BG,BF,BI){var BH={act:"macroCopyUnit",newKey:BI,partialRetrieval:this.newRetrievalKeysConfig().addNode(BI)};L(BH,BG,BF);return BH;},getMacroMoveNodeAction:function y(BG,BF){var BH={act:"macroMoveUnit",partialRetrieval:this.newRetrievalKeysConfig().addNode(BG.k)};L(BH,BG,BF);return BH;},getMoveNodeAction:function m(BJ,BF,BG){var BI=BJ.defn,BH=BI?BI.t:mstrmojo.EnumRWUnitType.LAYOUT;var BK=B(BF,BH);BK.unitKey=BJ.k;if(BG!==undefined){BK.index=BG;}return BK;},getMoveControlAction:function Z(BI,BG,BF){var BH=B(BG,mstrmojo.EnumRWUnitType.SELECTOR);BH.keyContext=BI;if(BF){BH.partialRetrieval={nodes:Ah(BF)};}return BH;},addMoveControlAction:function H(BI,BH,BG,BF){BI.addActions(this.getMoveControlAction(BH,K.call(this,BG,BI),BF));},getSetCtrlSourceAction:function AD(BG,BH,BF){return{act:"setControlSource",keyContext:BG,unitId:BH,unitType:BF,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BG)),partialUpdate:{selectors:[Ai(BG)]}};},getRemoveCtrlTargetAction:function F(BH,BG,BI,BF){return AF.call(this,"removeControlTarget",BH,BG,BI,BF);},getClearCtrlTargetAction:function A0(BF){return{act:"clearControlTarget",keyContext:BF};},getAddCtrlTargetAction:function Am(BJ,BG,BK,BL,BF,BH){var BI=AF.call(this,"addControlTarget",BJ,BG,BK,BF,BH);BI.isUC=!BL;return BI;},getAddCtrlTargetDatasetAction:function Ax(BG,BF){return{act:"addControlTargetDataset",keyContext:BG,tgtDid:BF};},getRemoveCtrlTargetDatasetAction:function d(BG,BF){return{act:"removeControlTargetDataset",keyContext:BG,tgtDid:BF};},getClearCtrlTargetDatasetAction:function AI(BF){return{act:"clearControlTargetDataset",keyContext:BF};},getChangeControlElementSource:function A9(BG,BF){return{act:"changeControlElementSource",keyContext:BG,ctlElementSrc:BF};},getSetAttributesJoinTypeAction:function AY(BF,BG){return{act:"setAttributesJoinType",nodeKey:BF,value:BG,partialRetrieval:this.newRetrievalKeysConfig().addNode(BF)};},getSetMetricJoinTypeAction:function AQ(BH,BJ,BF,BG,BI){return{act:"setMetricJoinType",nodeKey:BH,unitId:BJ,dataType:BF,unitType:BG,value:BI,partialRetrieval:this.newRetrievalKeysConfig().addNode(BH)};},getTxUpdates:function AN(BG){var BF=this.model;return BF&&BF.getTransactionUpdates&&BF.getTransactionUpdates(BG);},clearTxUpdates:function Ac(BG){var BF=this.model;if(BF&&BF.clearTransactionUpdates){BF.clearTransactionUpdates(BG);}},resetTxUpdates:function C(BG){var BF=this.model;if(BF&&BF.resetTransactionUpdates){BF.resetTransactionUpdates(BG);}},loadDocLayout:function J(BH,BJ,BI){var BG={act:"setCurrentLayout",unitKey:BH.layoutKey,disablePU:true},BF={style:{params:{treesToRender:3}},params:Aj.call(this)};if(BI){BI.add(BG,BJ,BF);}else{this.submitUpdates(BG,BJ,BF);}},checkMissingCredentials:function t(BF,BG){Ae.call(this,A(BF,{taskId:"checkMissingCredentials"}),BG);},setCurrentDocLayout:function Al(BF,BJ,BI){var BH={act:"setCurrentLayout",unitKey:BF},BG={config:{silent:(BJ===null)}};BJ=BJ||null;if(BI){BI.add(BH,BJ,BG);}else{this.submitUpdates(BH,BJ,BG);}if(window.mstrMobileApp!==undefined){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function A1(BF,BG){Ae.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:BF},BG);},requestPanelChangeDeferred:function A8(BL,BK,BF,BG,BI,BJ){var BH={act:"setCurrentPanel",unitKey:BK};if(BF){BH.partialRetrieval={nodes:BF.split(",")};}BL.add(BH,BJ,{config:{showProgress:BI,hideProgress:BI,progressStateText:AG},style:{params:{treesToRender:BG?3:0}}});},getGraphSelectionAction:function D(BJ,BF,BH,BM,BL,BG){var BK=this.model.getCurrentLayoutDef(),BN=(BK&&BK.dzf)||1,BI={act:"graphSelector",nodeKey:BJ,sliceID:BH,x:Math.round(BM/BN),y:Math.round(BL/BN)};if(BG){BI.usePartialUpdate="0";}else{BI.partialUpdate={selectors:BF.split("\u001E")};}return BI;},getSelectorElementsAction:function n(BH){var BG={act:"setSelectorElements",keyContext:BH.ck,ctlKey:BH.ctlKey,elemList:mstrmojo.string.decodeHtmlString(BH.eid),isVisualization:!!BH.isDocVis},BF=BH.include;if(BF!==undefined){BG.include=!!BF;}if(BH.tks){BG.tks=BH.tks;}if(BH.disablePU){BG.usePartialUpdate="0";}else{if(BH.ignoreTargetData){BG.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BH.ck));}else{BG.partialUpdate={selectors:BH.ctlKey.split("\u001F")};}}return BG;},getUpdateTransactionAction:function BD(BG){var BF={act:"updateTransaction"};if(BG){if(BG.ctlKey){BF.partialUpdate={selectors:[BG.ctlKey]};}}return BF;},getSelectorFromGMAction:function k(BG){var BF={act:"setSelectorFromGM",keyContext:BG.ck,ctlKey:BG.ctlKey,keepOnly:!!BG.keepOnly,selectorObjects:BG.selectorObjects,isVisualization:!!BG.isDocVis,include:!!BG.include};if(BG.tks){BF.tks=BG.tks;}if(BG.disablePU){BF.usePartialUpdate="0";}else{BF.partialUpdate={selectors:[BG.ctlKey]};}return BF;},getGMViewFilterAction:function AB(BG){var BF={act:"keepOnlyGM",selectorObjects:BG.selectorObjects,isVisualization:!!BG.isDocVis,keepOnly:!!BG.keepOnly};if(BG.tks){BF.tks=BG.tks;}if(BG.disablePU){BF.usePartialUpdate="0";}else{BF.partialUpdate={selectors:[BG.ctlKey]};}return BF;},setMultiDocSelectorElements:function z(BF,BG,BI){var BH={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:BG,selectorObjects:BF};Ae.call(this,BH,BI,{showWait:true,hideWait:true,delay:true});},setDocSelectorTexts:function Q(BK,BM,BO,BL,BN,BG,BF,BH,BJ){var BI={taskId:"setDocSelectorTexts",rwb:this.rwb,unitKeyContext:BK,ctlTexts:BM,ctlKey:BO,zoomFactor:BG};if(AO.isAndroid||BF){BI.taskId="androidSetDocSelectorElements";}if(BL!==null&&BL!==undefined){BI.include=BL;}if(BH!==null&&BH!==undefined){BI.usePartDisplay=BH;}if(BJ!==null&&BJ!==undefined){BI.treesToRender=BJ;}Ae.call(this,BI,BN);},getSelectorExpressionAction:function o(BH){var BG={act:"setSelectorExpression",keyContext:BH.ck,ctlType:BH.type,objId:BH.srcid,objType:BH.srct,expFunction:BH.f,expFunctionType:BH.ft,include:!!BH.include,qt:BH.qt,unset:!!BH.unset};if(BH.disablePU){BG.usePartialUpdate="0";}else{BG.partialUpdate={selectors:[BH.ckey]};}if(BH.changeQual){BG.changeQual=BH.changeQual;}var BF=BH.cs;if(BF!==null&&BF!==undefined){BG.expConstants=BF;BG.dataType=BH.dtp;}if(BH.fid){BG.fid=BH.fid;}return BG;},getMultiUnitSelectorAction:function A6(BF){return{act:"multiUnitSelection",keyContext:BF.ck,sels:BF.selections,partialUpdate:{selectors:[BF.ctlKey]}};},getRemoveCtrlAction:function Ag(BG,BF){return{act:"removeControl",key:BG,partialUpdate:{selectors:[BG]},partialRetrieval:{nodes:Ah(BF)}};},getAddCtrlAction:function AX(BM,BK,BG,BL,BH,BN,BF,BI,BO){if(isNaN(BO)){BO=1;}var BJ={act:"addControl",parentKey:BM,nodeKey:BK,ctlKey:BG,isUC:!!BH,unitType:BN||-1,unitId:BF||"",targetKeys:Ah(BI),ctlType:BO,gpType:BO,partialRetrieval:{nodes:Ah(BL)}};if(!BJ.isUC){BJ.partialUpdate={selectors:[BG]};}return BJ;},getSaveGraphPropertiesAction:function h(BF,BG){return{act:"saveGraphProperties",nodeKey:BF,properties:BG};},getSelectorIncludeAction:function At(BG){var BF=BG.ckey;return{act:"setSelectorInclude",keyContext:BG.ck,ctlKey:BF,ctlType:BG.type,include:BG.include,partialUpdate:{selectors:[BF]}};},getSelectorShowAllAction:function O(BF){return{act:"setSelectorShowAll",keyContext:BF.ck,ctlKey:BF.ckey,ctlType:BF.type,showAll:BF.showAll,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BF.ck))};},getUnsetSelectorAction:function c(BI){var BH=BI.ckey,BF=BI.ck,BG={act:"unsetSelector",keyContext:BF,ctlKey:BH,ctlType:BI.type};if(BI.ignoreTargetData){BG.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BF));}else{BG.partialUpdate={selectors:[BH]};}return BG;},getChangeFilteringAction:function Aq(BF,BI,BH,BG){return{act:"changeFiltering",nodeKey:BF,filterMode:BI,isUC:BH,partialRetrieval:{nodes:(BG?Ah(BG):[])}};},getAddDerivedMetricToDatasetAction:function Aw(BF){return{act:"addDerivedMetricToDataset",dsid:BF.dsid,formula:BF.formula,isTokenStream:BF.isTokenStream,name:BF.name,newObjectIds:BF.Ids,afb:BF.afb,sfb:BF.sfb};},getEditDocUnitPropAction:function x(BF){return{act:"editDocUnitProp",dsid:BF.dsid,formId:BF.formId,unitId:BF.unitId,unitType:BF.unitType,prop:BF.prop,value:BF.value};},getRWGraphImage:function BC(BJ,BN){var BI=mstrApp,BF=this.id,BG={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:BJ.k,sliceID:parseInt(BJ.sid,10),width:parseInt(BJ.w,10),height:parseInt(BJ.h,10)};if(BI.onMobileDevice()&&BI.useBinaryFormat){window.setTimeout(function(){Ae.call(mstrmojo.all[BF],BG,BN,T());},0);}else{if(BJ.encodeImage){BG.taskContentEncoding="base64";delete BG.taskEnv;Ae.call(this,BG,{success:function BO(BP){BN.success("data:image/png;base64,"+BP);},failure:function BH(BP){(BN.failure||BI.onerror)(BP);}},T());}else{var BL=BI.getConfiguration(),BK=BI.getCurrentProjectId(),BM=new mstrmojo.StringBuffer();BG.__ts__=new Date().getTime();BG.sessionState=BI.getSessionState(BK);a.forEach(BG,function(BP,BQ){BM.append(BQ+"="+encodeURIComponent(BP));});BN.success(BL.getTaskUrlByProject(BK)+"?"+BM.toString("&"));}}},getImage:function BB(BG){var BH=mstrApp,BF=BH.getConfiguration();if(BF&&BG&&BG.indexOf("://")===-1){BG=BF.getHostUrlByProject(BH.getCurrentProjectId())+BG;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(BG)):BG;},setGridDisplayMode:function p(BH,BG,BI,BF){a.copy({params:{suppressData:true}},BF);this.submitUpdates({act:"setGridDisplayMode",unitKey:BH,displayMode:BG},BI,BF);},setDocZoom:function G(BF,BG){this.submitUpdates(A(BF,{act:"setDocZoom",disablePU:true}),BG,{style:{params:{treesToRender:3}}});},sortGrid:function AH(BF,BG){this.submitTemplateUpdates(BF.nodeKey,A({act:"sort"},BF),BG);},getAdvSortData:function Aa(BF,BG){this.rwExecute(A(BF,{styleName:"RWGridStyle"}),BG);},rwExecute:function A3(BF,BG){Ae.call(this,A(BF,{taskId:"RWExecute",rwb:this.rwb,messageID:this.msgId}),BG);},pivot:function l(BF,BG){this.submitTemplateUpdates(BF.nodeKey,{act:"pivot",unitId:BF.unitId,unitType:BF.unitType,attFormId:BF.attFormId,axis:BF.axis,unitPos:BF.unitPos},BG);},resizeXtabColumn:function Az(BF,BG){this.submitUpdates([this.getUpdateTemplateAction(BF.nodeKey,BF),{act:"format",unitType:52,unitKey:BF.nodeKey,formatType:1,format:{FormattingSize:{WidthMode:2}}}],BG);},showTotals:function S(BF,BG){this.submitTemplateUpdates(BF.nodeKey,{act:"showTotals",unitId:BF.unitId,unitType:BF.unitType,subtotalType:BF.subtotalType,clearSubtotalType:BF.clearSubtotalType},BG);},drillGrid:function AE(BF,BG){this.submitUpdates(this.getDrillGridAction(BF),BG,{config:{showProgress:true,hideProgress:true,progressStateText:AG,delay:true}});},getDrillGridAction:function A5(BG){var BF={act:"gridDrillWithin",messageID:this.msgId,nodeKey:BG.nodeKey,sliceId:BG.sliceId,drillPathIndex:BG.drillPathIndex,drillPathKey:BG.drillPathKey,elementList:BG.drillElements,retainParent:BG.retainParent,partialUpdate:{nodes:[BG.nodeKey]}};if(BG.x){BF.x=BG.x;BF.y=BG.y;}return BF;},changeDocGroupBy:function M(BH,BI,BF){var BG={act:"changeDocGroupBy",disablePU:true};if(BH.flags){BG.flags=BH.flags;}if(BH.groupbyKey){BG.gbKey=BH.groupbyKey;BG.elemId=BH.elementId;}else{BG.gbUnits=BH.gbUnits;}this.submitUpdates(BG,BI,{config:BF,style:{params:{treesToRender:3}},params:Aj.call(this)});},retrieveServerJson:function b(BH,BQ,BI){var BK=this.model,BL=BK.controller,BO={},BF,BG,BM;var BN=BH.nodes;if(BN){BO.partialRetrieval=BN;}var BP=BH.slices;if(BP){BO.slices=BP;}if(BI){BF=BI.style;BG=BI.config;BM=BI.params;}if(!BG){BG={showProgress:true,hideProgress:true,progressStateText:AG};}var BR=BH.style=a.clone(this.defaultStyle);A(BF.params,BR.params);var BJ={taskId:"getServerJSONResults",styleName:"ServerJsonRWDStyle",compress:1,rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(BO),treesToRender:BR.params.treesToRender};A(BM,BJ);BG.preserveUndo=(BI&&BI.preserveUndo)||false;Ae.call(this,BJ,BQ,BG);},downloadGridData:function I(BG,BH){var BF={act:"gridIncrementalFetch",nodeKey:BG.nodeKey,rowPosition:BG.rowPosition,maxRows:BG.maxRows,colPosition:BG.colPosition,sliceId:BG.sliceId,maxColumns:BG.maxColumns,partialRetrieval:this.newRetrievalKeysConfig().addNode(BG.nodeKey)};if(BG.partialUpdate){BF.partialUpdate=BG.partialUpdate;}this.submitUpdates(BF,BH,a.copy(T(),{noUpdate:true,config:{silent:true}}));},txMarkRows:function AM(BF,BG){Ae.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:BF.nodeKey,sliceId:BF.sliceId,rowOrdinal:BF.rowOrdinal,actionType:BF.actionType},BG);},txChangeData:function r(BF,BG){Ae.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:BF.nodeKey,sliceId:BF.sliceId,cells:BF.cells,autoRefresh:BF.autoRefresh},BG);},sendTransactionActions:function Y(BG,BH){var BF={taskId:"DocTransaction",rwb:this.rwb,keyContext:BG.keyContext,actions:BG.actions,messageID:this.msgId};if(BG.txrcd){BF.isPending=BG.txrcd.pending;BF.timestamp=BG.txrcd.timestamp;}Ae.call(this,BF,BH,{silent:!!BH});},newUpdate:function Av(BH,BG){var BF=new mstrmojo.DocDataService.Update(BG);BF.ds=this;BF.cmd=BH;return BF;},newUpdateWithoutCmd:function g(BG){var BF=new mstrmojo.DocDataService.Update(BG);BF.ds=this;return BF;},newRetrievalKeysConfig:function AW(){return new mstrmojo.rw.model.RetrievalKeysConfig();},newUpdateKeysConfig:function P(){return new mstrmojo.rw.model.UpdateKeysConfig();},submitCmd:function A2(BG,BF){this.newUpdate(BG,BF).submit();},submitUpdates:function AZ(BO,BT,BL){BO=Ah(BO);var BK={actions:BO},BF,BI,BQ,BH=false;R.forEach(BO,function BN(BV){if(BV.disablePU){BH=true;delete BV.disablePU;}R.forEach(BV.actions,BN);return !BH;});if(!BH){var BG=mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig(BO),BS=mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig(BO);if(!a.isEmpty(BG)){BK.partialRetrieval=BG;}if(!a.isEmpty(BS)){BK.partialUpdate=BS;}}if(BL){BF=BL.style;BI=BL.config;BQ=BL.params;}if(!BI){BI={showProgress:true,hideProgress:true,progressStateText:AG};}if(!BF){BK.style=this.defaultStyle;}else{var BU=BK.style=a.clone(this.defaultStyle);A(BF.params,BU.params);}BK.style.name=(BF&&BF.name)||mstrApp.styleName;var BM={taskId:"mojoRWManipulation",rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(BK)};A(BQ,BM);BI.preserveUndo=(BL&&BL.noUpdate)||false;var BP=this,BR=true,BJ=s.override({success:function(BV,BW){if(BV.status===2){BR=false;BP.submitUpdates([],BT,BL);}else{BR=true;return this._super(BV,BW);}},complete:function(){if(this._super&&BR){this._super();}}},A(BT));if(!(BL&&BL.hideCancel)){BI.waitBoxCfg=a.copy({showCancel:true},BI.waitBoxCfg);}if(BL&&BL.message){BI.waitBoxCfg=a.copy({message:BL.message},BI.waitBoxCfg);}Ae.call(this,BM,BJ,BI);},submitTemplateUpdates:function u(BF,BH,BI,BG){this.submitUpdates(this.getUpdateTemplateAction(BF,BH),BI,BG);},getUpdateTemplateAction:function AT(BF,BH,BG){return{act:"updateTemplate",keyContext:BF,partialRetrieval:this.newRetrievalKeysConfig().addNode(BF,BG),actions:Ah(BH)};},addUpdateTemplateAction:function A7(BH,BF,BG){BH.addActions(this.getUpdateTemplateAction(BF,BG));},applySegment:function AK(BG,BF,BH){Ae.call(this,{taskId:"applySegment",rwb:this.rwb,segmentID:BG,nodeKey:BF},BH);},getPageByTree:function AL(BF){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},BF);},getUserDICubeInfo:function W(BF,BG){Ae.call(this,{taskId:"getUserDICubeInfo",cubeIds:BF.join(",")},BG);},applySorts:function Au(BG,BH,BF,BI){Ae.call(this,{taskId:"applySorts",key:BG,sortType:BH,sortList:BF},BI,mstrmojo.DocDataService.PROGRESS_CONFIG);},getAddNewDerivedMetricToDatasetSubmitFunc:function As(BG){var BF=this;return function(BJ){var BK=BF.model,BI=BK.controller,BH=a.copy(BJ,BG),BL=[Ad.call(BF,BH,false)],BM=BK.getDatasetsUpdateCallback();BI.submitUndoRedoUpdates(BL,null,BM,{style:{params:{treesToRender:1}}});};},getAddNewDerivedMetricToXtabSubmitFunc:function Ak(BG){var BF=this;return function(BK){var BL=BF.model,BJ=BL.controller,BI=a.copy(BK,BG),BH=BI.idx,BN=[],BO=s.wrapMethods(BL.getDatasetsUpdateCallback(),BJ._getXtabCallback(BI.host));BN.push(Ad.call(BF,BI,true));if(BI.replace){BN.push(BF.getUpdateTemplateAction(BI.nodeKey,[BI.host.model.getRemoveTemplateUnitAction({did:BI.replace.did,t:BI.replace.t})]));}else{BH++;}var BM=BF.getUpdateTemplateAction(BI.nodeKey,[BI.host.model.getAddTemplateUnitAction({did:"$GUID_135",t:4},BI.dsid,BI.zoneid,BH),{act:"renameUnit",id:"$GUID_135",type:4,name:BI.alias,isDynamicAlias:true}]);BN.push(BM);BJ.submitUndoRedoUpdates(BN,null,BO);};},getAddNewDerivedMetricToDropzoneSubmitFunc:function AA(BG){var BF=this;return function(BM){var BN=BF.model,BO=BN.controller,BQ=a.copy(BM,BG),BS=BQ.host.zonesModel,BT=BQ.idx,BL=[],BH=[],BR={id:BQ.zoneid},BP={did:"$GUID_135",t:4},BU=s.wrapMethods(BN.getDatasetsUpdateCallback(),BO._getXtabCallback(BQ.host));BL.push(Ad.call(BF,BQ,true));if(BQ.replace){var BJ={did:BQ.replace.did,t:BQ.replace.t};BH.push(BS.getRemoveDropZoneUnitAction(BR,BJ));}else{BT++;}BH.push(BS.getAddDropZoneUnitAction(BR,BP,BT,{datasetId:BQ.dsid}));var BI=(BG.zoneid===4)?1:2,BK=BS.getAddMetricNameAction(BG.host,BI);if(BK){BL.push(BK);}if(!BQ.replace&&BS.gmZones){BK=BS.gmZones.getUpdateGroupInfoActionForNewMetric(BG.zoneid,BT,true);if(BK){BL.push(BK);}}BS.checkAndAddThresholdAction(BQ.zoneid,BP,BH);BL.push(BF.getUpdateTemplateAction(BQ.nodeKey,BH));BO.submitUndoRedoUpdates(BL,null,BU);};},getEditDerivedMetricSubmitFunc:function f(BG){var BF=this;return function(BJ){var BL=BF.model,BI=BL.controller,BH=a.copy(BJ,BG),BK=BG.nodeKey,BM={act:"editDM",formula:BH.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BH.tokenStreamXML),afb:BG.afb,sfb:BG.sfb,dsid:BH.dsid||"",did:BH.did},BN=[BL.addUpdateObjects(BM,{id:BH.did,type:4,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE})],BO=s.wrapMethods(BL.getDatasetsUpdateCallback(),BI.getPartialUpdateCallback());if(BK){BN.push(BF.getUpdateTemplateAction(BK,[{act:"renameUnit",id:BH.did,type:4,name:BH.alias,isDynamicAlias:true}]));}else{BM.name=BH.alias;}BI.submitUndoRedoUpdates(BN,null,BO);};},resetSelections:function Ay(BG,BF,BH){Ae.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:BG||"",usePartDisplay:BF?"0":"1",treesToRender:BF?3:2},BH);},setPreference:function E(BF,BG){Ae.call(this,{taskId:"setPreference",prefs:BF},BG);},getObjectInfo:function AR(BF,BG){Ae.call(this,A(BF,{taskId:"getObjectInfo"}),BG,T());},addSuppressData:function An(BF){if(BA(BF)===mstrmojo.DocDataService.EnumTreesToRender.NONE){a.copy({params:{suppressData:true}},BF);}},uploadImageToServer:function(BH,BI){var BG={taskId:"importImage",imageFieldName:"imageData",isEdit:1,fieldKey:BH.fieldKey,fieldName:BH.fieldName,imageName:encodeURIComponent(BH.imageName),imageSize:BH.imageSize,nodeKey:BH.nodeKey,sectionKey:BH.sectionKey};if(mstrApp.isSingleTier){var BF=";base64,";BG.rwNodeKey=BH.fieldGroupKey;BG.imageData=BH.base64Str.split(BF)[1]||BH.base64Str;mstrApp.serverRequest(BG,BI);}else{BG.msgID=this.msgId;BG.imageData=BH.imageData;mstrmojo.xhr.upload("POST",mstrConfig.taskURL,BI,BG);}}});mstrmojo.DocDataService.Update=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DocDataService.Update",actions:null,callback:null,extras:null,init:function Ab(BF){A(BF,this);this.actions=this.actions||[];this.callback=this.callback||{};this.extras=this.extras||{};},addActions:function AV(BF){this.actions=this.actions.concat(Ah(BF));},addCallbacks:function Ap(BF){this.callback=s.wrapMethods(this.callback,BF);},addExtras:function AP(BG){var BF=BA(BG),BH=BA(this.extras);this.extras=A(BG,this.extras);if(BF!==undefined&&BH!==undefined){this.extras.style.params.treesToRender|=BH;}},addUpdate:function AS(BF){this.add(BF.actions,BF.callback,BF.extras);},setTreesToRender:function BE(BF){if(BF){this.addExtras({style:{params:{treesToRender:BF}}});}return this.extras.style.params.treesToRender;},add:function X(BG,BH,BF){if(BG){this.addActions(BG);}if(BH){this.addCallbacks(BH);}if(BF){this.addExtras(BF);}},submit:function w(){var BG=this.actions,BH=this.callback,BF=this.extras;if(this.cmd){this.cmd.submit(BG,BH,BF);}else{this.ds.submitUpdates(BG,BH,BF);}}});mstrmojo.DocDataService.PUInfoType=null;mstrmojo.DocDataService.ExtrasType=null;mstrmojo.DocDataService.PROGRESS_CONFIG={showProgress:true,hideProgress:true,progressStateText:AG,delay:true};mstrmojo.DocDataService.UNDO_KEY="undo";mstrmojo.DocDataService.REQUEST_DEFN_DATA={style:{params:{treesToRender:3}}};mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION={style:{params:{treesToRender:1}}};mstrmojo.DocDataService.REQUEST_ONLY_DATASETS={style:{params:{treesToRender:0}}};mstrmojo.DocDataService.SUPPRESS_DATA={params:{suppressData:true}};mstrmojo.DocDataService.EMPTY_CALLBACK={success:mstrmojo.emptyFn};mstrmojo.DocDataService.CopyMoveDestinationType=null;mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS={FORMAT_CHANGE:1,DATA_CHANGE:2};mstrmojo.DocDataService.EnumTreesToRender={NONE:0,DEFN:1,DATA:2,BOTH:3};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var E=mstrmojo.hash;mstrmojo.esrimap.ESRIDensityLayerAdaptee=null;function G(){if(!!mstrmojo.esrimap.ESRIDensityLayerAdaptee){return ;}mstrmojo.esrimap.ESRIDensityLayerAdaptee=mstrmojo.declare(esri.layers.Layer,[mstrmojo._CanDrawHeatMap],{scriptClass:"mstrmojo.esrimap.ESRIDensityLayerAdaptee",div_:null,mapViewer:null,_connects:null,visible:true,init:function O(P){E.copy(P,this);if(P.map){this._map=P.map;this.loaded=true;}},_setMap:function(Q,P){this.div_=document.createElement("DIV");if(!this.div_){return ;}this.div_.id="canvasparent";this.div_.style.border="none";this.div_.style.borderWidth="0px";this.div_.style.margin="0px";this.div_.style.cursor="pointer";this.visible?this.showLayer():this.hideLayer();P.appendChild(this.div_);this._connects=[];this._connects.push(dojo.connect(Q,"onPan",this,this._panHandler));this._connects.push(dojo.connect(Q,"onExtentChange",this,this._extentChangeHandler));this._connects.push(dojo.connect(Q,"onZoomStart",this,this.clearDensity));this._connects.push(dojo.connect(Q,"onClick",this,this.handleMouseClick));this._connects.push(dojo.connect(Q,"onMouseMove",this,this.handleMouseMove));this.drawDensity();return this.div_;},_unsetMap:function(Q,P){dojo.forEach(this._connects,function(R){dojo.disconnect(R);});if(this.div_){this.div_.parentNode.removeChild(this.div_);this.div_=null;}this._map=this.canvas=this._connects=null;},showLayer:function H(){if(!this.div_){return ;}this.div_.style.visibility="visible";this.show();},hideLayer:function N(){if(!this.div_){return ;}this.div_.style.visibility="hidden";this.hide();},_panHandler:function(P,Q){this.positionCanvas(Q);},_extentChangeHandler:function(P,S,R,Q){if(!R&&this.canvas){this.positionCanvas({x:0,y:0});this.clearDensity();}this.drawDensity();},cluster:null,handleMouseClick:function K(Q){var R=Q.screenPoint;this.cluster=this.getAttrsFromLocationMapRange(Math.ceil(R.x),Math.ceil(R.y),5);if(this.cluster.length>0){var P=this.cluster[0];if(this.mapViewer.parent.enableClickSelect){this.mapViewer.handleDensitySelection(this.cluster);this.mapViewer.parent.handleSingleSelection(true);}}else{this.mapViewer.hideInfoWindow();this.mapViewer.onMapClick();}},handleMouseMove:function(P){var R=event.screenPoint;this.cluster=this.getAttrsFromLocationMapRange(Math.ceil(R.x),Math.ceil(R.y),5);if(this.cluster.length>0){var Q=this.cluster[0];if(this.mapViewer.parent.enablePopup){this.mapViewer.showTooltip(P,Q);this.mapViewer.infoWindowVisible=true;}}else{if(this.mapViewer.infoWindowVisible){this.mapViewer.hideTooltip();this.mapViewer.infoWindowVisible=false;}}},handleMouseMove:function(P){var R=event.screenPoint;this.cluster=this.getAttrsFromLocationMapRange(Math.ceil(R.x),Math.ceil(R.y),5);if(this.cluster.length>0){var Q=this.cluster[0];if(this.mapViewer.parent.enablePopup){this.mapViewer.showTooltip(P,Q);this.mapViewer.infoWindowVisible=true;}}else{if(this.mapViewer.infoWindowVisible){this.mapViewer.hideTooltip();this.mapViewer.infoWindowVisible=false;}}},getTopLeft:function M(){if(!this._map&&!!this.mapViewer.parent){return new esri.geometry.Point(0,0,this.mapViewer.parent.esriMap.spatialReference);}return this._map.position;},getScreenPointForLocation:function J(P){return esri.geometry.toScreenGeometry(this._map.extent,this._map.width,this._map.height,P);},getBounds:function L(){var P=this._map&&this._map.extent;return P;},hasMapBoundsChanged:function I(){return true;}});}mstrmojo.esrimap.ESRIDensityLayer=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.esrimap.ESRIDensityLayer",densityLayer:null,init:function F(H){this._super(H);G();this.densityLayer=this.addDisposable(new mstrmojo.esrimap.ESRIDensityLayerAdaptee(H));},showLayer:function A(){this.densityLayer.showLayer();},hideLayer:function D(){this.densityLayer.hideLayer();},addLayer:function B(H){H.addLayer(this.densityLayer);},removeLayer:function C(H){H.removeLayer(this.densityLayer);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Obj","mstrmojo.string","mstrmojo.hash","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty");var D=mstrmojo.array,P=mstrmojo.expr,J=P.ET,I=P.TP,K=mstrmojo.mstr.EnumNodeDimty,N=P.ET2TGT,M=P.ET2COND,B=mstrmojo.meta.TP;function O(S,A){var R=(A&&A.did)?A.did.split(P.FN_SEP):null,E=R&&parseInt(R[0],10),Q=R&&parseInt(R[1],10),T=S.et;S.fnt=E;S.fn=Q;if(T!=J.AE&&P.fn_List(Q,E)){S.et=J.AL;S.a2=null;S.cs=null;}else{if(T==J.AL&&!P.fn_List(Q,E)){S.et=J.AQ;S.cs=null;}else{if(T==J.MC&&!P.fn_AC_MC(Q,E)){S.et=J.MQ;S.m2=null;}else{if(T==J.AC&&!P.fn_AC_MC(Q,E)){S.et=J.AQ;S.a2=null;}}}}switch(Q){case P.FN.IS_NULL:case P.FN.IS_NOT_NULL:S.a2=null;S.a3=null;S.fm2=null;S.fm3=null;S.m2=null;S.m3=null;S.cs=null;break;case P.FN.BETWEEN:case P.FN.NOT_BETWEEN:break;default:S.a3=null;S.fm3=null;S.m3=null;while(S.cs&&S.cs.length>1){S.cs.pop();}}}function F(W,X,Y){var E=true,A=2+X;switch(Y.t){case I.PROMPT:var U=W.cs,V;if(!U){U=[];W.cs=U;}U[X]={};V=U[X];V.p=Y;W["a"+A]=null;W["m"+A]=null;switch(W.et){case J.AC:W.et=J.AQ;break;case J.MC:W.et=J.MQ;break;}break;case I.METRIC:W["a"+A]=null;W.cs=null;W.et=J.MC;W["m"+A]=Y;break;case I.ATTR:W["m"+A]=null;W.cs=null;W.et=J.AC;W["a"+A]=Y;W["fm"+A]=null;break;default:W["a"+A]=null;W["m"+A]=null;var U=W.cs;if(!U){U=[];W.cs=U;}if("did" in Y){W["a"+A]=null;W["fm"+A]=null;W["m"+A]=null;if(U[X]&&U[X].p){U[X].p=null;}}else{if(Y&&Y.v!=null){U[X]=Y;}else{if(U[X]){U=U.splice(X,1);}}E=false;}if(!Y.skipET){switch(W.et){case J.MC:W.et=J.MQ;break;case J.AC:W.et=J.AQ;break;case J.AL:if(!("did" in Y)&&Y.v){var Q,S=Y.dtp,U=[];Q=Y.v.split(mstrConfig.listSep);for(var R=0,T=Q.length;R<T;R++){U.push({v:mstrmojo.string.trim(Q[R]),dtp:S});}W.cs=U;}break;}}}return E;}var H={};H[J.AQ]={target:1,fm:1,fn:1,cs:1};H[J.AL]={target:1,fm:1,fn:1,cs:1};H[J.AE]={target:1,fn:1,es:1};H[J.AC]={target:1,a2:1,a3:1,fm:1,fm2:1,fm3:1,fn:1};H[J.MQ]={target:1,fn:1,cs:1,dmy:1};H[J.MC]={target:1,fn:1,m2:1,m3:1,dmy:1};H[J.F]={target:1};H[J.R]=H[J.F];H[J.XML]={target:1};var G=function(A){return A!==null&&A!==undefined;};var L=function(W){if(!W||!G(W.et)){return false;}var V=true,A=H[W.et],T=W.cs,S;V=V&&(!A.target||W[N[W.et]]);V=V&&(!A.fm||W.fm);V=V&&(!A.fn||G(W.fn));var R=P.fnCstCount(W.fn,W.fnt);if(V&&A.cs){for(S=0;S<R;S++){V=V&&T&&G(T[S]);}}if(V){var U=[N[W.et],"fm"];for(var E=0;E<2;E++){for(S=0;S<R;S++){var X=U[E]+(2+S);V=V&&(!A[X]||W[X]);}}}V=V&&(!A.es||W.es&&(W.es.length>0));var Q=W.dimtyTypes;V=V&&(!A.dmy||Q[K.NodeDimtyUnspecified]||Q[K.NodeDimtyNone]||(Q[K.NodeDimtyOutputLevel]&&W.dmy&&W.dmy.uts&&(W.dmy.uts.length>0)));return V;};mstrmojo.ConditionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ConditionModel",completed:false,init:function(A){if(this._super){this._super(A);}this._updateCompleted();},edit:function(m,Y){var S=this[m],l=true;this.etWas=this.et;switch(m){case"not":Y=!!(Y&&Y.did===P.FN.NOT);S=!!this.not;if(Y===S){return ;}this.not=!!Y||null;break;case"target":var AB=this.et;if(Y){switch(Y[B]){case I.ATTR:case I.CONS:S=this.a;if(AB!==J.AQ&&AB!==J.AE){this.et=J.AQ;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}if(AB!==J.AE){this.fn=null;this.fnt=null;}this.fm=null;this.fm2=null;this.fm3=null;this.cs=null;break;case I.METRIC:S=this.m;if((AB!==J.MQ)&&(AB!==J.MC)){this.et=J.MQ;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.r=null;this.f=null;this.cs=null;this.dmt=K.NodeDimtyUnspecified;}this.m2=null;break;case I.REPORT:S=this.r;if(AB!==J.R){this.et=J.R;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.f=null;}break;case I.FILTER:S=this.f;if(AB!==J.F){this.et=J.F;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;}break;case I.PROMPT:S=this.prms&&this.prms[0];if(AB!==J.XML){this.et=J.XML;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}break;}}this.es=null;this[N[this.et]]=Y;break;case"fm":if(Y&&Y[B]==="fn"){this.et=J.AE;this.fm=null;O(this,Y);}else{this.fm=Y;if(Y&&(this.et==J.AE)){this.et=J.AQ;}this.fnt=null;this.fn=null;this.cs=null;this.a2=null;this.fm2=null;}break;case"fm2":case"fm3":this[m]=Y;break;case"fn":O(this,Y);break;case"es":var AE=this.es;if(Y&&Y.removed&&AE){D.removeItems(AE,Y.itemIdField,Y.removed);}if(Y&&Y.added){if(!AE){AE=Y.added.concat();this.es=AE;}else{D.insert(AE,AE.length,Y.added);}}break;case"c0":l=F(this,0,Y);break;case"c1":l=F(this,1,Y);break;case"dmy":var y=this.dmy;if(!y){y={cc:true,fres:true,uts:[]};this.dmy=y;}var t=y&&y.uts;if(!t){t=[];y.uts=t;this.dmt=K.NodeDimtyOutputLevel;}var Q={};Q[P.TP.ATTR]=true;Q[P.TP.DIM]=true;if(Y&&Y.removed){var f=[],A=false,W=[],R=false;for(var k=0,T=Y.removed,E=T.length;k<E;k++){var V=T[k],AA=V[B] in Q;if(AA){R=true;}else{A=true;}var h=AA?W:f;h.push(V);}if(A){D.removeItems(t,"did",f);}if(R){var AD={};for(var d=0,Z=t&&t.length;d<Z;d++){var X=t[d];if(X&&X.utgt){AD[X.utgt.did]=d;}}var U=[];for(var z=0,x=W.length;z<x;z++){var g=AD[W[z].did];if(g>-1){U.push(g);}}U.sort(D.numSorter);for(var s=U.length-1;s>-1;s--){t.splice(U[s],1);}}}if(Y&&Y.added){var AF=[],o=P.DMY_TP.DIM,q=P.DMY_TP.ATTR;for(var AC=0,w=Y.added,e=w.length;AC<e;AC++){var p=w[AC];AF.push((p[B] in Q)?{utgt:p,utp:p[B]===I.DIM?o:q,agg:1,flt:2,gb:true,rps:0,n:p.n}:p);}D.insert(t,t.length,AF);}break;}this._updateCompleted();if(l){this.raiseEvent({name:"edit",prop:m,value:Y,valueWas:S});}},get:function C(){var A=M[this.et]||[];A.push("et");return mstrmojo.hash.copyProps(A,this);},_updateCompleted:function(){this.set("completed",L(this));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip","mstrmojo.css");mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",slot:"",alias:"",parent:null,init:function A(C){this._super(C);var D=this.parent;if(!D||D.hasInitBindings){this.initBindings();}},destroy:function B(C){if(this.hasRendered){this.unrender(C);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn,widgetResized:mstrmojo.emptyFn});mstrmojo.Widget.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};mstrmojo.Widget.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};mstrmojo.Widget.topMarkupMethod=function(){var C=this.top;if(C){this.domNode.style.top=C;}};mstrmojo.Widget.leftMarkupMethod=function(){var C=this.left;if(C){this.domNode.style.left=C;}};mstrmojo.Widget.heightMarkupMethod=function(){var C=this.height;if(C){this.domNode.style.height=C;}this.widgetResized();};mstrmojo.Widget.widthMarkupMethod=function(){var C=this.width;if(C){this.domNode.style.width=C;}this.widgetResized();};mstrmojo.Widget.enabledMarkupMethod=function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.StepperContentProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.StepperContentProvider",item:null,renderer:null,min:null,max:null,interval:1,minField:"min",maxField:"max",valField:"value",intField:"interval",canLoop:false,next:mstrmojo.emptyFn,prev:mstrmojo.emptyFn,hasPrev:mstrmojo.emptyFn,hasNext:mstrmojo.emptyFn,renderItemAt:mstrmojo.emptyFn,setVal:mstrmojo.emptyFn,getVal:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var K=mstrmojo.hash;var P=0;var F=[];var J={};var L=false;function I(T){var U=T.callback;if(U.submission){U.submission(T.id,this.userInteractionRequired(T),T);}this.submitRequest(T);}function G(){if(F.length&&!L){I.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(d,a,U,V){if(U){this.cancelRequests();}var X=this.id,Y=this.transport,T=mstrmojo.now()+a.taskId+P++,W=d.canceled||mstrmojo.emptyFn;d.canceled=function(e){W();d.complete(true);return Y.cancelRequest(e);};d=mstrmojo.func.wrapMethods(d,{complete:function(e){mstrmojo.all[X].deleteRequest(e);}});var Z=!K.isEmpty(this._requests),b=this.createRequest(T,d,a,V),c=(L||Z)&&!V.doNotHold;if(c){F.push(b);}else{I.call(this,b);}return T;},hasRequests:function O(){return !K.isEmpty(this._requests)||L;},createRequest:function Q(V,X,W,T){var U=this._requests;if(!U){U=this._requests={};}U[V]={id:V,callback:X,params:W,config:T};return U[V];},submitRequest:function M(T){this.transport.serverRequest(this.id,T.id,T);},cancelRequests:function S(){var T=false;K.forEach(this._requests,function(U){if(U.gotResponse===undefined){T|=U.callback.canceled(U.id);}});this._requests={};F=[];return T;},cancelRequest:function B(X){var U=false,W=this._requests[X],V,T=F.length;for(V=0;V<T;V++){if(F[V]===W){break;}}if(V<T){F.splice(V,1);delete this._requests[X];U|=W.callback.canceled(W.id);}return U;},response:function A(X,T,V){$MAPF(false,"AndroidServerTransport","transportRequest");var W=this.getRequest(X);if(W){W.gotResponse=true;var Y=W.callback,U=(T&&!V.mstrerr)?"success":"failure";try{if(Y[U]){Y[U](V,W);}}finally{Y.complete(X);}}G.call(this);},deleteRequest:function N(U){var T=this._requests;delete T[U];},getRequest:function H(U){var T=this._requests;return T&&T[U];},userInteractionRequired:function C(T){return false;},addLoadingGraph:function D(T){J[T]=true;L=true;},removeLoadingGraph:function R(T){delete J[T];if(K.isEmpty(J)){L=false;G.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array");var B=mstrmojo.array;mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",path:mstrConfig.taskURL,serverRequest:function(C,D){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(C,D,{silent:true});}else{mstrmojo.xhr.request("POST",this.path,D,C,undefined,this.XServer,this.baseParams);}},fetchFolderContents:function(C,D,G){var E=C.blockCount,F={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:E,includeAncestorInfo:"true",includeObjectDesc:C.includeObjectDesc};if(C.folderLinksContextId){F.folderLinksContextId=C.folderLinksContextId;}if(C.sId){F.sessionState=C.sId;}if(D.fid){F.rootFolderID=D.fid;}else{if(D.fty){F.rootFolderType=D.fty;}}if(C.browsableTypes){F.objectType=C.browsableTypes;}if(D.blockBegin){F.blockBegin=D.blockBegin;}if(D.searchPattern){if(C.enableQuickSearch){F.quickSearch=C.enableQuickSearch;}F.searchPattern=D.searchPattern;if(D.recursive){F.recursive=D.recursive;}}this.serverRequest(F,G);},newFolder:function(F,G,E,C){var D={taskId:"createFolder",taskContentType:"json",folderID:F,name:G,description:E};this.serverRequest(D,C);},loadObjects:function A(G,H,C,F){var D=[],E=[];B.forEach(G,function(I){D.push(I.did);E.push(I.t);});if(G.length>0&&F){this.serverRequest({taskId:"getObjectInfo",objectIDs:D.join(","),objectTypes:E.join(","),includeDetails:true},H,C);}else{H.success();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.gmaps.MapEnums");var D=mstrmojo.gmaps.EnumClusterMode,E=50;mstrmojo.esrimap.ClusterLayerWrapper=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.esrimap.ClusterLayerWrapper",clusterLayer:null,clusterMode:null,clusterTolerance:50,clusterData:[],clusters:[],clusterLabelColor:"#000",clusterResolution:1,singleTemplate:null,sr:null,markerType:1,zoomEnd:null,unload:null,layerRemove:null,smallClusterCount:10,mediumClusterCount:100,offsetY:11,iRadius:15,oRadius:25,iDiameter:null,iCircleRings:[],oCircleRings:[],numberOfPoints:2999,visible:true,mapExtent:null,mapWidth:null,mapHeight:null,init:function C(H){this.clusterTolerance=H.clusterTolerance||this.clusterTolerance;this.clusterData=H.clusterData||this.clusterData;this.clusters=[];this.clusterLabelColor=H.clusterLabelColor||this.clusterLabelColor;this.singleTemplate=H.singleTemplate||(new esri.InfoTemplate({title:"",content:"{*}"}));this.sr=H.sr||(new esri.SpatialReference({wkid:102100}));this.markerType=H.markerType||this.markerType;this.visible=H.visible;this.mapViewer=H.mapViewer;this.clusterMode=H.mapViewer.clusterMode;this.clusterLayer=new esri.layers.GraphicsLayer({visible:H.visible});if(this.clusterMode===D.PIE){this.hasAngleMetric=!!this.mapViewer.dropZones.angle;var G=new esri.geometry.Circle({center:esri.geometry.Point([0,this.offsetY*(-1)],new esri.SpatialReference({wkid:102100})),radius:this.iRadius,numberOfPoints:this.numberOfPoints}),F=new esri.geometry.Circle({center:esri.geometry.Point([0,this.offsetY*(-1)],new esri.SpatialReference({wkid:102100})),radius:this.oRadius,numberOfPoints:this.numberOfPoints});this.iCircleRings=G.rings[0];this.oCircleRings=F.rings[0];this.iDiameter=this.iRadius*2;}},renderClusterLayer:function A(G){this.mapExtent=G.extent;this.mapWidth=G.width;this.mapHeight=G.height;this.clusterResolution=G.extent.getWidth()/G.width;this._createAndShowClusters();var F=this;this.zoomEnd=G.on("zoom-end",function(){F.clusterResolution=F.clusterLayer._map.extent.getWidth()/F.clusterLayer._map.width;F.mapExtent=this.extent;F.mapWidth=this.width;F.mapHeight=this.height;F._clear();F._createAndShowClusters();F.mapViewer.populateDataLabelMetricValues();});this.unload=G.on("unload",function(){if(F.zoomEnd){F.zoomEnd.remove();}});this.layerRemove=G.on("layer-remove",function(H){if(!!H&&H.layer===F.clusterLayer&&F.zoomEnd){F.zoomEnd.remove();}});},_clear:function(){this.clusterLayer.clear();this.clusters.length=0;},_createAndShowClusters:function(){this.clusters=this._createAllClusters(this.clusterData);this._showAllClusters(this.clusters);},_createAllClusters:function(H){var M,G,F,N,L=[],K,I,J=H.length;for(I=0;I<J;I++){M=H[I];G=false;F=L.length;for(K=0;K<F;K++){N=L[K];if(this._clusterTest(M,N)){this._clusterAddPoint(M,N);G=true;break;}}if(!G){L.push(this._clusterCreate(M));}}return L;},_clusterTest:function(G,F){var H=(Math.sqrt(Math.pow((F.x-G.x),2)+Math.pow((F.y-G.y),2))/this.clusterResolution);return(H<=this.clusterTolerance);},_clusterAddPoint:function(K,G){var H,F,L,J=K.attributes,I=G.attributes;H=I.clusterCount;F=(K.x+(G.x*H))/(H+1);L=(K.y+(G.y*H))/(H+1);G.x=F;G.y=L;I.clusterCount++;if(!K.hasOwnProperty("attributes")){J={};}J.clusterId=I.clusterId;if(!I.geoIndices){I.geoIndices=[];}if(!I.longGeoIndices){I.longGeoIndices=[];}I.geoIndices.push(J.geoIndex);I.longGeoIndices.push(J.longGeoIndex);if(!I.rowIndices){I.rowIndices=[];}I.rowIndices.push(J.rowIndex);if(!I.columnIndices){I.columnIndices=J.columnIndices;}if(this.clusterMode===D.PIE){G.points.push(K);if(this.hasAngleMetric){G.angleMetricSum+=K.absAngleMetricVal;}}},_clusterCreate:function(I){var G=this.clusters.length+1,F,H=I.attributes,J;if(!H){H={};}H.clusterId=G;F={x:I.x,y:I.y,attributes:{clusterCount:1,clusterId:G,geoIndices:[H.geoIndex],longGeoIndices:[H.longGeoIndex],rowIndices:[H.rowIndex],columnIndices:H.columnIndices,infoWindowContent:I.infoWindowContent,singleSymbol:I.singleSymbol,layerKey:H.layerKey,dlTextName:I.dlTextName,symbolSize:I.symbolSize}};if(this.clusterMode===D.PIE){F.points=[I];if(this.hasAngleMetric){F.angleMetricSum=I.absAngleMetricVal;}}for(J in H){if(H.hasOwnProperty(J)){F.attributes[J]=H[J];}}return F;},_showAllClusters:function(H){var G,F,I;this.mapViewer.dataLabelsConfig.length=0;for(G=0,F=H.length;G<F;G++){I=H[G];this._showCluster(I);}},_showCluster:function(G){var F=new esri.geometry.Point(G.x,G.y,this.sr);this.mapViewer.dataLabelsConfig.push(this._createDataLabelConfig(G.attributes,F));this._createAndAddGraphic(G,F);},_createAndAddGraphic:function(M,K){var G=M.attributes,J=this.singleTemplate.setContent(G.infoWindowContent),F=G.clusterCount,H,I,L;if(F===1){L=new esri.Graphic(K,G.singleSymbol,G,J);this.clusterLayer.add(L);}else{L=(this.clusterMode===D.PIE)?this._addRingPieGraphics(M,K,J):this._addPictureGraphic(G,K,J);this.clusterLayer.add(L);H=new esri.symbol.TextSymbol(F).setColor(new dojo.Color(this.clusterLabelColor)).setOffset(0,7).setFont(new esri.symbol.Font("8pt","Arial"));I=new esri.Graphic(K,H,G,J);I.refGraphic=L;L.labelGraphic=I;this.clusterLayer.add(I);}},_createDataLabelConfig:function(G,H){var I={},F=G.clusterCount;if(F===1){I={text:G.dlTextName,rowIndex:G.rowIndex,mapPoint:H,symbolSize:G.symbolSize};}else{I={rowIndex:G.rowIndex,mapPoint:H,symbolSize:{width:E,height:E},disableLabel:true};}return I;},_addPictureGraphic:function(G,J,I){var F=G.clusterCount,K,H;if(F<this.smallClusterCount){H=mstrmojo.getStyleRoot()+"/images/blue_highlight@2x.png";}else{if(F<this.mediumClusterCount){H=mstrmojo.getStyleRoot()+"/images/orange_highlight@2x.png";}else{H=mstrmojo.getStyleRoot()+"/images/red_highlight@2x.png";}}K=new esri.Graphic(J,new esri.symbol.PictureMarkerSymbol(H,E,E).setOffset(0,this.offsetY),G,I);return K;},_addRingPieGraphics:function(L,N,K){var I=L.attributes,J=I.clusterCount,F=this.mapViewer.parent.regularStroke,H,G,M;if(J<this.smallClusterCount){H=new dojo.Color([0,150,255,0.75]);}else{if(J<this.mediumClusterCount){H=new dojo.Color([255,147,0,0.75]);}else{H=new dojo.Color([255,38,0,0.75]);}}G=new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,this.iDiameter,F,H).setOffset(0,this.offsetY);M=new esri.Graphic(N,G,I,K);M.sliceGraphics=this._addSliceGraphics(L,N,M);M.isPieCluster=true;return M;},_addSliceGraphics:function(M,P,Q){var L=[],R,O=M.points,K=O.length,H=this.numberOfPoints/K,I=0,G=0,F,J,N=K-1;for(J=0;J<N;J++){F=O[J];if(this.hasAngleMetric&&M.angleMetricSum!==0){j=this.numberOfPoints*F.absAngleMetricVal/M.angleMetricSum;if(j===0){continue;}G+=Math.floor(j);}else{G=Math.floor((J+1)*H);}R=this._createSliceGraphic(P,F,I,G);R.refGraphic=Q;L.push(R);I=G;this.clusterLayer.add(R);}G=this.numberOfPoints-1;R=this._createSliceGraphic(P,O[N],I,G);R.refGraphic=Q;L.push(R);this.clusterLayer.add(R);return L;},_createSliceGraphic:function(U,P,N,H){var L=this.iCircleRings,Q=this.oCircleRings,T=new esri.geometry.toScreenGeometry(this.mapExtent,this.mapWidth,this.mapHeight,U),F=this.mapViewer.parent.regularStroke,R,K,I,G,S=[],O,M=0,J=2*(H-N+1)-1;for(O=N;O<=H;O++){S[M++]=[Q[O][0]+T.x,Q[O][1]+T.y];S[J--]=[L[O][0]+T.x,L[O][1]+T.y];}S.push([Q[N][0]+T.x,Q[N][1]+T.y]);R=new esri.geometry.Polygon({rings:[S],spatialReference:undefined});K=P.singleSymbol.color;I=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,F,K);G=new esri.Graphic(new esri.geometry.toMapGeometry(this.mapExtent,this.mapWidth,this.mapHeight,R),I,P.attributes,P.infoWindowContent);G.isSlice=true;return G;},destroy:function B(F){if(this.unrenderred){return ;}this.unload.remove();this.layerRemove.remove();this._super(F);}});}());(function(){var E=1;var a=2;var D=3;var G=4;var N=5;var U=6;var B=7;var I=8;var Z=9;mstrmojo.gmaps.MapManipulation=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.gmaps.MapManipulation",viewerLayer:null,_key:null,model:null,init:function S(b){this._super(b);},addXmlAttr:function X(b,d){try{return" "+b+'="'+d+'"';}catch(c){return 0;}},addXmlAttrEncoded:function M(d,g){if(!g){return"";}var c=[];var b=g.length;var f;for(var e=0;e<b;e++){f=g.charAt(e);switch(f){case">":c.push("&gt;");break;case"<":c.push("&lt;");break;case"&":c.push("&amp;");break;case"\u0009":c.push("&#x09;");break;case"\n":c.push("&#x0A;");break;case"\r":c.push("&#x0D;");break;case'"':c.push("&quot;");break;default:c.push(f);break;}}return" "+d+'="'+c.join("")+'"';},getDocModel:function T(){if(!this.model){this.model=this.viewerLayer.getDocModel();}return this.model;},isOIVM:function Q(){return mstrApp&&(mstrApp.isExpress||mstrApp.isVI);},getElementIDByIndex:function Y(c,b){var d=this.viewerLayer.data.gts.row[b].es;if(c>=0&&c<d.length){return d[c].id;}return null;},getExecutionScope:function(){if(this.isOIVM()){return"2";}return microstrategy.EXECUTION_SCOPE;},getMsgId:function(){if(this.isOIVM()){return mstrApp.docModel.mid;}return this.viewerLayer.msgID;},getSelectionInfo:function(l){var q=false;q=!l||!l.elementIndex||l.elementIndex.length===0;var d=q?"":l.elementIndex.sort().join("_");if(this.viewerLayer.currentSelectedIndex==d){return ;}this.viewerLayer.currentSelectedIndex=d;var h=l.pos[0],b=this.viewerLayer.data.gts.row[h].sc;if(b===undefined){return ;}var o=this.viewerLayer.getGeoColumnAttribute();var m=this.viewerLayer.model;if(!!mstrApp&&!!mstrApp.isVI&&m&&m.supportsViewFilterActions&&!m.supportsViewFilterActions(o)){return ;}var e=b.tks,n=b.ck,s=b.ckey,g=b.showall||b.all,r,p=[],f=q?0:l.elementIndex.length,c="\x1e";if(mstrApp&&mstrApp.isVI&&!g&&q){return ;}var k;for(k=0;k<f;k++){p.push(this.viewerLayer.data.gts.row[h].es[l.elementIndex[k]].id);}r=q?"OA:(All)":p.join(c);return{targetKeys:e,elementsList:r,controlKeyContext:n,controlKey:s};},addAction:function J(g,h,f,d,b,e){d=d||[];b=b||[];var c=microstrategy.updateManager.createActionObject(g,h,f,d,b,[]);if(e){e.push(c);}else{microstrategy.updateManager.add([c]);microstrategy.updateManager.flushAndSubmitChanges();}},applySelection:function C(b){if(this.isOIVM()){this.applySelectionOIVM(b);}else{this.applySelectionIM(b);}},applySelectionIM:function V(h){var b=this.getSelectionInfo(h),d=[],f=b&&b.targetKeys,e=b&&b.elementsList,c=b&&b.controlKey,g=b&&b.controlKeyContext;if(b&&this.viewerLayer.isViewerSliceable()){this.addAction(null,mstrUpdateManager.SET_CUR_CTL_ELEMENTS,h.beanPath,["2048130","2048127","2048137","2048138","2048018"],[c,e,g,"1","false"],d);microstrategy.updateManager.add(d);microstrategy.updateManager.flushAndSubmitChanges();}},applySelectionOIVM:function R(c){var b=this.getSelectionInfo(c);if(b&&!!b.targetKeys){this.getDocModel().slice({type:mstrmojo.EnumRWUnitType.GRID,ck:b.controlKeyContext,ctlKey:b.controlKey,tks:b.targetKeys,suppressIW:true,eid:b.elementsList});}},execHL:function A(h,d,e){try{var b=this.viewerLayer.data.gts.row[e].lm[0];var g=b.links;if(!d){d=b.di;}var c=g[d];if(c){this[!c.url?"execDynamiclLink":"execUrlLink"](b,c,h,e);}}catch(f){microstrategy.errors.log(f);}},execDynamiclLink:function F(b,d,g,e){var c=this.buildLinkXml(b,d,g,e);console.log(c);var f=this.linkDrillTargetOpenInNewWindow();if(this.isOIVM()){this.execDynamiclLinkOIVM(d,c,f);}else{this.execDynamiclLinkIM(d,c,f);}},execDynamiclLinkOIVM:function P(d,b,c){try{var g=d.target,k=g&&g.t,h,f=g.did;switch(parseInt(k,10)){case 55:if(parseInt(g.st,10)===14081){h={evt:2048001,objectID:f};}else{h={evt:32001,documentID:f};}break;case 3:h={evt:4001,reportID:f,reportViewMode:g.st==769?2:1};}if(h){if(b){h.linkAnswers=b;}this.linkDrill(h,d,c);}}catch(e){console.log(e);}},linkDrill:function L(d,c,b){mstrmojo.form.send(d,null,"POST",b?"_blank":null);},execDynamiclLinkIM:function W(g,f,l){try{var k=null;var e=[g.target.did];var b=null;if(g.target.t==microstrategy.DSSTYPE_RPT_DEFINITION){b=mstrUpdateManager.RUN_REPORT;k=["1001"];if(f){k.push("4222");e.push(f);}k.push("4115");e.push(microstrategy.getReportViewMode(g.target.st));}else{if(g.target.t==microstrategy.DSSTYPE_DOC_DEFINITION){if(g.target.st==microstrategy.DSSSUB_TYPE_RW){b=mstrUpdateManager.RUN_RW_DOCUMENT;k=["2048001"];if(f){k.push("2048140");e.push(f);}}else{b=mstrUpdateManager.RUN_DOCUMENT;k=["1001"];if(f){k.push("32351");e.push(f);}}}}var h=microstrategy.updateManager;var d=h.useIframe;var m=h.newWindow;h.useIframe=false;h.newWindow=l;if(h.hasChangesToSubmit()){h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}h.add([h.createActionObject(this.elem,b,"",k,e,[])]);h.flushAndSubmitChanges();h.acknowledgeRequest();h.newWindow=m;h.useIframe=d;}catch(c){microstrategy.errors.log(c);}},execUrlLink:function H(b,d,k,e){try{var h=null;var c=d.url;if(c.indexOf("&CurrentElement")>-1&&k){var g=this.getElementIDByIndex(k.currAtt,k);c=d.url.replace("&CurrentElement",g);}h=mstrmojo.form.createDynamicForm(c);if(this.linkDrillTargetOpenInNewWindow()){h.target="_blank";}h.submit();return ;}catch(f){if(microstrategy){microstrategy.errors.log(f);}else{console.log(f);}}},buildLinkXml:function K(z,g,k,y){var w;try{var AA=this,x=this.viewerLayer.getCurrentSelections(y);var l=function(AB,AC){return AA.addXmlAttr(AB,AC);};var t=function(AB,AC){return AA.addXmlAttrEncoded(AB,AC);};var e="<hl"+l("mid",this.getMsgId())+l("srct",this.getExecutionScope())+l("aopam",g.daMode)+">";var c=g.ans;if(c!==null){e+="<prms>";for(w=0,cnt=c.length;w<cnt;w++){var r=c[w];var o=r.pid;var p=r.m;var h=r.values;var n=r.dispNames;e+="<prm"+l("id",o)+l("am",p);if(r.po&&r.po.did){e+=l("orid",r.po.did)+l("ortp",r.po.t);}e+=">";var d=null,b=null,m=null,q=null,s,u;switch(p){case a:case D:case I:case E:break;case N:if(h!==null){e+='<pa ia="1"><es>';for(s=0;s<h.length;s++){e+="<e"+l("ei",h[s])+t("disp_n",n[s])+l("emt","1")+"/>";}e+="</es></pa>";}break;case G:case Z:e+='<pa ia="1">';e+="<es "+l("dispForms","")+">";for(var u=0;u<x.length;u++){d=this.getElementIDByIndex(x[u],y);if(!d){continue;}e+="<e"+t("ei",d)+l("emt","1")+"/>";}e+="</es></pa>";break;case B:e+='<pa ia="1"><attGroups><attGroup>';q=this.viewerLayer.data.gts.row[y];for(u=0;u<x.length;u++){d=this.getElementIDByIndex(x[u],y);if(!d){continue;}e+="<a"+l("id",q.id)+t("n",q.n)+">";e+="<es "+l("dispForms","")+"><e"+t("ei",d)+l("emt","1")+"/></es>";e+="</a>";}e+="</attGroup></attGroups></pa>";break;case U:b=r.attrs;if(x!==null&&x.length>0){e+='<pa ia="1">';m=this.viewerLayer.data.gts.row[this.geoPosition];d=this.getElementIDByIndex(x[0],y);if(d){q=this.attMap[m];e+="<a"+l("id",q.id)+t("n",q.n)+"><es "+l("dispForms",q.displayFormsMap)+"><e"+t("ei",d)+l("emt","1")+"/></es></a>";}e+="</pa>";}break;}e+="</prm>";}e+="</prms>";}e+="</hl>";return e;}catch(f){microstrategy.errors.log(f);return null;}},linkDrillTargetOpenInNewWindow:function O(){var b=this.viewerLayer.getLinkDetails();if(this.viewerLayer.isPrimaryGrid()){return b&&b.onw;}else{var c=this.viewerLayer.getPrimaryGridViewer().getLinkDetails();if(c&&c.onw){return b&&b.onw;}else{return true;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj");var B={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4};mstrmojo.ui.PopupConfig=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ui.PopupConfig",ENUM_CORNERS:B,isHostedWithin:true,position:null,hostProxyCssClass:"",hostId:"",hostElement:null,anchorElement:null,popupHandlers:null,alignment:null,alignWithAnchor:false,useTooltip:false,init:function E(F){this.clear();this._super(F);},setAlignment:function C(F,G){this.alignment={host:F,popup:G};},addPopupHandlers:function D(F,H,G){this.popupHandlers[F]={open:H,close:G};},clear:function A(){this.popupHandlers={};var F=this.ENUM_CORNERS;this.alignment={host:F.BOTTOM_LEFT,popup:F.TOP_LEFT};}});mstrmojo.ui.PopupConfig.ENUM_CORNERS=B;}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Model","mstrmojo.hash");mstrmojo.gmaps.ObservableModel=mstrmojo.declare(mstrmojo.Model,[],{scriptClass:"mstrmojo.gmaps.ObservableModel",host:null,widgetProps:null,childModel:null,dv:null,ondvChange:function(){var B=this.host;B.setMapType(this.dv);B.setProperty("dv",this.dv,{suppressData:true});},init:function(D){if(this._super){this._super(D);}var E=this.widgetProps;if(!E){return ;}this.dv=E.dv;var C=this.widgetProps.sgProps,D;if(C){this.childModel={};for(key in C){if(C.hasOwnProperty(key)){D=this.host.getProperties(key);var B=new A({host:this.host,widgetProps:D});this.addDisposable(B);this.childModel[key]=B;}}}},getModel:function(B){if(!B){return this;}else{this.childModel[B];}}});var A=mstrmojo.gmaps.ObservableModel;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom");function Z(a,c){if(!mstrmojo.DocInfoWindow){return ;}var b=a;while(b){if(b instanceof mstrmojo.DocInfoWindow){b[c?"registerScrollLock":"releaseScrollLock"](this);break;}b=b.parent;}}var L=mstrmojo.array,C=mstrmojo.dom,P=mstrmojo.hash,W=mstrmojo.css,F="px";var B=false;function K(a,c){if(!mstrmojo.DocInfoWindow){return ;}var b=a;while(b){if(b instanceof mstrmojo.DocInfoWindow){b[c?"registerLock":"releaseLock"](this);this.lockIW=c?b:null;break;}b=b.parent;}}var A=mstrmojo.ui.PopupConfig.ENUM_CORNERS,T=A.TOP_LEFT,R=A.TOP_RIGHT,H=A.BOTTOM_RIGHT,G=A.BOTTOM_LEFT;function I(a){return(a===G||a===T);}function X(a){return(a===R||a===H);}function N(a){return(a===H||a===G);}function Q(a){return(a===R||a===T);}function U(h,c,p,u){var y=p.x,x=p.y,t=p.w||0,l=p.h||0,b=u.w,q=u.h,s=h.alignment,f=s.popup,e=s.host,w=X(e),z=N(e),r=false,n=false,d=false,o=false;if(I(f)){var g=y+b+(w?t:0);r=c.w<g;}if(Q(f)){var m=x+q+(z?l:0);n=c.h<m;}if(X(f)){var k=y-b+(w?t:0);d=k<0;}if(N(f)){var a=x-q+(z?l:0);o=a<0;}return{top:o,bottom:n,left:d,right:r};}function E(b){var a=this.popupConfig;if(a){P.forEach(a.popupHandlers,function(d,e){var c=d[b?"open":"close"];if(c){c.call(mstrmojo.all[e]||c,!!b);}});}}function J(b){var a=this.popupConfig;if(a&&!a.isHostedWithin){var c=this.hostProxy;if(c){c.style.display=b?"":"none";}}}function Y(a){return a!==undefined&&a!==null&&!isNaN(a);}mstrmojo._IsPopup={visible:false,lockIWForScroll:false,disposable:true,opener:null,onOpen:mstrmojo.emptyFn,onClose:mstrmojo.emptyFn,popupConfig:null,hostProxy:undefined,open:function M(c,a){E.call(this,true);if(this.updatePopupConfig){this.updatePopupConfig(a,c);}else{P.forEach(a,function(f,e){this.set(e,f);},this);}var b="popup-mid-render";this.set("opener",c);if(!this.hasRendered){var d=this.visible;this.visible=false;this.render();W.addClass(this.domNode,b);this.set("visible",d);}if(this.nudge){this.domNode.style.top="-10000px";}J.call(this,true);this.set("visible",true);if(this.lockIWForScroll){Z.call(this,this.opener,true);}if(a&&a.lockIW){K.call(this,a.lockIW,true);}if(this.nudge){this.nudge();}this.adjustCornersForPopupOverflow();this.onOpen();W.removeClass(this.domNode,b);},adjustCornersForPopupOverflow:function V(){var m=this.popupConfig;if(!m){return false;}var AJ=(m.includeScroll!==undefined)?m.includeScroll:true;var p=m.position||C.position(m.anchorElement||m.hostElement,AJ);if(!m.isHostedWithin){var z=this.hostProxy,s=this.hostProxy=document.createElement("div");document.body.appendChild(s);s.appendChild(this.domNode);if(z){z.parentNode.removeChild(z);}var e=s.style,t={x:"left",y:"top",w:"width"};s.className=m.hostProxyCssClass;e.position="absolute";e.background="none";e.height="0";L.forEach(["x","y","w"],function(AM){var AL=p[AM];if(Y(AL)){e[t[AM]]=AL+F;}});}var AG=m.ENUM_CORNERS,x=AG.BOTTOM_LEFT,k=AG.BOTTOM_RIGHT,h=AG.TOP_RIGHT,AC=AG.TOP_LEFT;var AD=U(m,C.position(document.body),p,C.position(this.domNode)),y=AD.right,q=AD.bottom,d=AD.left,w=AD.top,AB=m.alignment,r=AB.popup,AK=AB.host,g=r,c=AK;if(y||d){if(I(c)){c=Q(c)?h:k;}else{if(X(c)){c=Q(c)?AC:x;}}if(y&&I(g)){g=Q(g)?h:k;}else{if(d&&X(g)){g=Q(g)?AC:x;}}}if(q||w){if(I(c)){c=Q(c)?x:AC;}else{if(X(c)){c=Q(c)?k:h;}}if(q&&Q(g)){g=I(g)?x:k;}else{if(w&&N(g)){g=I(g)?AC:h;}}}if(w||y||q||d){if(B){console.log("Overflow directions: "+JSON.stringify(AD));}this._orgalgn={host:AK,popup:r};m.setAlignment(c,g);}if(!m.isHostedWithin){if(Y(p.y)&&Y(p.h)){this.hostProxy.style.top=(p.y+(N(g)?(m.alignWithAnchor===true?p.h:0):(m.alignWithAnchor===true?0:p.h)))+F;}}var AA=N(c),AF=X(c),AE=N(g),o=X(g),l="auto",b="100%",a="0";var u=l,AH=l,n=l,f=l;if(AE){n=AA?a:b;}else{u=AA?b:a;}if(o){AH=AF?a:b;}else{f=AF?b:a;}var AI=this.domNode.style;AI.top=u;AI.right=AH;AI.bottom=n;AI.left=f;return true;},close:function O(b){if(this.onClose){this.onClose(b);}J.call(this,false);if(this.lockIWForScroll){Z.call(this,this.opener,false);}this.set("visible",false);this.set("opener",null);if(this.lockIW){K.call(this,this.lockIW,false);}E.call(this,false);var a=this._orgalgn;if(a){this.popupConfig.setAlignment(a.host,a.popup);}},buildRendering:function D(){var a=this._super();if(a){if(!this.parent&&!this.domNode.parentElement){document.body.appendChild(this.domNode);}}return a;},unrender:function S(a){if(this.popupConfig&&!this.popupConfig.isHostedWithin&&this.hostProxy){document.body.removeChild(this.hostProxy);delete this.hostProxy;}this._super(a);}};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport");var BasicAggMap={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"},RankMap={"8107C326DD9911D3B98100C04F2233EA":"Rank"},OLAPAggMap={D221F90EB35540E3A1204ED6CC9A8267:"Avg",D221F90FB35540E3A1204ED6CC9A8267:"Count",D221F910B35540E3A1204ED6CC9A8267:"Max",D221F911B35540E3A1204ED6CC9A8267:"Min",D221F90DB35540E3A1204ED6CC9A8267:"Sum"},MovingAggMap={"8107C32ADD9911D3B98100C04F2233EA":"Avg","8107C350DD9911D3B98100C04F2233EA":"Count","8107C34BDD9911D3B98100C04F2233EA":"Max","8107C34CDD9911D3B98100C04F2233EA":"Min","8107C32BDD9911D3B98100C04F2233EA":"Sum"},RunningAggMap={"8107C329DD9911D3B98100C04F2233EA":"Avg","8107C354DD9911D3B98100C04F2233EA":"Count","8107C351DD9911D3B98100C04F2233EA":"Max","8107C352DD9911D3B98100C04F2233EA":"Min","8107C328DD9911D3B98100C04F2233EA":"Sum"},BandingMap={"8107C337DD9911D3B98100C04F2233EA":"Banding","8107C338DD9911D3B98100C04F2233EA":"BandingC","8107C339DD9911D3B98100C04F2233EA":"BandingP"};function _sortFunctions(fcts){var fs=function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);},i,len;fcts=fcts.sort(fs);for(i=0,len=fcts.length;i<len;i++){fcts[i].fns=fcts[i].fns.sort(fs);}return fcts;}function getFuncCatIndex(fcts,funcDid){var len=fcts.length,ci;for(ci=0;ci<len;ci++){var fns=fcts[ci].fns;if(mstrmojo.array.find(fns,"did",funcDid)>-1){return ci;}}return -1;}function buildTaskParams(params){var qse=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();params=mstrmojo.hash.copy(params,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false});if(qse){params.quickSearch=qse;params.nameWildcards=16;params.sortKey=-1;}return params;}function serverRequest(callback,taskParams){if(mstrApp.serverRequest){mstrApp.serverRequest(taskParams,callback);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(callback,taskParams,false,{});}}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getServerProxy:function getServerProxy(){if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}return this.serverProxy;},getMetricDefintion:function getMetricDefintion(params,callbacks){var taskParams={taskId:"getMetricDefinition",metricId:params.id,outputFlags:65599};if(params.msgID){taskParams.msgID=params.msgID;}serverRequest.call(this,callbacks,taskParams);},validateMetric:function validateMetric(params,callbacks){var taskParams={taskId:"validateMetric",metricId:params.metricId,tokenStreamXML:params.tokenStreamXML,metricXML:params.metricXML,outputFlags:327695};if(mstrmojo.string.isEmpty(params.metricId)){taskParams.isNew=true;}if(params.msgID){taskParams.msgID=params.msgID;}if(params.formID){taskParams.frmid=params.formID;}if(params.isIDForm){taskParams.isIDForm=params.isIDForm;}if(params.objectType){taskParams.objectType=params.objectType;}serverRequest.call(this,callbacks,taskParams);},getMetricComponents:function getMetricComponents(params,callbacks){var me=this,mc=this.metricComponents;if(!this.noCache&&mc&&mc.items.length==mc.sz){callbacks.success(mc);return ;}callbacks.success=mstrmojo.func.composite([callbacks.success,function(res){if(me.metricComponents&&me.metricComponents.items){me.metricComponents.items.push(res.items);}else{me.metricComponents=res;}}]);var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||24,objectType:params.objectType||"12,13,43"});serverRequest.call(this,callbacks,taskParams);},getAttributes:function getAttributes(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||26,objectType:12});serverRequest.call(this,callbacks,taskParams);},getFacts:function getFacts(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||29,objectType:13});serverRequest.call(this,callbacks,taskParams);},getMetrics:function getMetrics(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||5,objectType:4});if(params.isVerify){taskParams.nameWildcards=2;}serverRequest.call(this,callbacks,taskParams);},getFunctions:function getFunctions(callbacks){var me=this,wss=window.sessionStorage,fcts=this.functions||(wss&&wss.getItem("functions")),localeId=wss&&wss.getItem("mstrLocaleId"),cLocaleId=mstrApp&&mstrApp.localeId;if(fcts&&localeId==cLocaleId){fcts=_sortFunctions(eval("("+fcts+")").fncs);callbacks.success(fcts);}else{var cb={failure:callbacks.failure,textResponse:true},taskParams={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2|2147483648,includeFunctionHelpTopic:true};cb.success=function(res){if(typeof res==="string"||!mstrApp.isSingleTier){if(wss){wss.setItem("functions",res);wss.setItem("mstrLocaleId",cLocaleId);}me.functions=res;fcts=_sortFunctions(eval("("+res+")").fncs);}else{fcts=_sortFunctions(res.fncs);me.functions=JSON.stringify(res);}callbacks.success(fcts);};serverRequest.call(this,cb,taskParams);}},getAggFunctions:function getAggFunctions(){if(this._aggFunctions){return this._aggFunctions;}var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.array.filter(fcts[this.getBasicCategoryIndex(fcts)].fns,function(item){var did=item.did,retVal;if(did!=="B2C0FA4020C711D6AD1400C04F0423DE"&&did!=="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=BasicAggMap[did];}return retVal;});return fcts;},getOLAPAggFunctions:function getOLAPAggFunctions(type){var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.array.filter(fcts[this.getOLAPCategoryIndex(fcts)].fns,function(item){switch(type){case"moving":return MovingAggMap[item.did];case"running":return RunningAggMap[item.did];case"olap":default:return OLAPAggMap[item.did];}return false;});return fcts;},getFunctionCatList:function getFunctionCatList(){if(this._functionCatList){return this._functionCatList;}var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.hash.make(fcts,mstrmojo.Arr);this._functionCatList=fcts;return fcts;},getCategoryIndex:function getCategoryIndex(funcDid,fcts){return getFuncCatIndex(fcts||this.getFunctionCatList(),funcDid);},getBasicCategoryIndex:function getBasicCategoryIndex(fcts){var Agg_Func_Greatest="B2C0FA4020C711D6AD1400C04F0423DE";return getFuncCatIndex(fcts||this.getFunctionCatList(),Agg_Func_Greatest);},getDataMiningCatIndex:function getDataMiningCatIndex(fcts){var DataMining_Func_MiningModel="F17CD4F3FF134D91B80DDAB9CA73C919";return getFuncCatIndex(fcts||this.getFunctionCatList(),DataMining_Func_MiningModel);},getDateTimeCategoryIndex:function getDateTimeCategoryIndex(fcts){var DateTime_Func_Date="C50F2A4F75AE49D6B20E00224967B500";return getFuncCatIndex(fcts||this.getFunctionCatList(),DateTime_Func_Date);},getStringCategoryIndex:function getStringCategoryIndex(fcts){var String_Func_Concat="6F7DF5FF449111D5BEA300B0D01A55EF";return getFuncCatIndex(fcts||this.getFunctionCatList(),String_Func_Concat);},getOLAPCategoryIndex:function getBasicCategoryIndex(fcts){var OLAP_Func_Avg="D221F90EB35540E3A1204ED6CC9A8267";return getFuncCatIndex(fcts||this.getFunctionCatList(),OLAP_Func_Avg);},getInternalCategoryIndex:function getInternalCategoryIndex(fcts){var INTER_Func_Band="8107C337DD9911D3B98100C04F2233EA";return getFuncCatIndex(fcts||this.getFunctionCatList(),INTER_Func_Band);},getFunctionDetails:function getFunctionDetails(params,callbacks){var taskParams={taskId:"getSystemFunctions",functionId:params.did,includeFunctionDetails:true,includeFunctionHelpTopic:true};serverRequest.call(this,callbacks,taskParams);},getTransformations:function getTransformations(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||38,objectType:43});serverRequest.call(this,callbacks,taskParams);},getFilters:function getFilters(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||4,objectType:1});serverRequest.call(this,callbacks,taskParams);},getAttributeForms:function getAttributeForms(params,callbacks){var taskParams={taskId:"getAttributeForms",attributeID:params.attributeID,displayedForms:params.displayedForms,styleName:"WidgetElementListStyle"};serverRequest.call(this,callbacks,taskParams);},getSubtotalFunctions:function getSubTotalFunctions(params,callbacks){var taskParams=buildTaskParams({objectType:"1025,1026",searchPattern:""});serverRequest.call(this,callbacks,taskParams);},isBasicAggMap:function isBasicAggMap(did){var retVal=!!BasicAggMap[did];if(did==="B2C0FA4020C711D6AD1400C04F0423DE"||did==="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=false;}return retVal;},isOLAPAgg:function isOLAPAgg(did){return !!OLAPAggMap[did];},isMovingAgg:function isMovingAgg(did){return !!MovingAggMap[did];},isRunningAgg:function isRunningAgg(did){return !!RunningAggMap[did];},isBanding:function isBanding(did){return !!BandingMap[did];},isOLAP:function isOLAP(did){var fcts=this.getFunctionCatList(),olapFns=fcts[this.getOLAPCategoryIndex(fcts)].fns;return mstrmojo.array.find(olapFns,"did",did)>-1;},isRank:function isRank(did){return !!RankMap[did];},isScalar:function isScalar(fctOi){return(fctOi||{}).sqt===3;},getFunctionHelpTopic:function getFunctionHelpTopic(h){return'<a href="'+((mstrApp.helpUrl||"../help/")+"FunctionsRef/index.html?context=functionsref&topic="+(h||""))+'" target="_new">'+mstrmojo.desc(5811,"Details ...")+"</a>";},sortFunctions:function sortFunctions(functions){var allfuncs={},fs=function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);};mstrmojo.array.forEach(functions,function(funcs){mstrmojo.array.forEach(funcs&&funcs.fns,function(func){if(func&&func.did){allfuncs[func.did]=func;}});});return mstrmojo.hash.valarray(allfuncs).sort(fs);}});}());(function(){mstrmojo.requiresCls("mstrmojo.StepperContentProvider","mstrmojo.num");var A=mstrmojo.num;function B(G,F){var H=F?G.max:G.min,D=F?G.min:G.max,E=G.getVal(F?1:-1);return(H===null||(F?(E<=H):(E>=H))||(D!==null&&G.canLoop));}function C(H,G){var F=H.min,D=H.max,E=H.getVal(G?1:-1);if((G&&D!==null&&E>D)||(!G&&F!==null&&(E<F))){if(H.canLoop){E=((E-F)%(D-F+1))+F;E=(E>=F)?E:E+(D-F+1);}else{return ;}}H.item[H.valField]=H.curVal=E;H.onTraverse();}mstrmojo.NumStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.NumStepperContentProvider",curVal:null,init:function(E){this._super(E);var F=this.item,D=function(I){var H=I&&F[I];return(H===null||H===undefined);},G=function(I,K,H){var J=H&&D.call(this,K)?null:F[K];if(J!==null&&J!==undefined){this[I]=J;}};G.call(this,"min",this.minField,true);G.call(this,"max",this.maxField,true);G.call(this,"interval",this.intField);this._initCurrent();},_initCurrent:function(){var E=this.item,F=this.curVal=E[this.valField];if(F===null||F===undefined){var D=this.min;this.curVal=D!==null?D:0;}},next:function(){C(this,true);},prev:function(){C(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},renderItemAt:function(F){var E=this.getVal(F),D=this.renderer;return D?D.render(E,this):E;},getVal:function(D){return this.curVal+(this.interval*(D||0));},setVal:function(F){var G=this.min,D=this.max,E=this.getVal();if(typeof F!=="number"||isNaN(F)||F===E||A.inNumericRange(F,G,D)!==0){return ;}this.item[this.valField]=this.curVal=F;this.onTraverse();},onTraverse:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui._HasScroller","mstrmojo.css");var C=mstrmojo.css,E=mstrmojo.desc(14058,"Show Details"),A=mstrmojo.desc(14059,"Hide Details"),F=mstrmojo.desc(14060,"We are sorry for the inconvenience. Please {contact} your administrator for help.").replace("{",'<span class="dyn-link">').replace("}","</span>");mstrmojo.ui.editors.ErrorDialogContent=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",markupString:'<div class="mstrmojo-error-content" mstrAttach:click><div class="scroll-container"><div>{@shortDesc}</div><div>'+F+'</div><div class="toggle-details-link" >'+E+'</div><div class="error-details">{@en@longDesc}</div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild;},contactNode:function(){return this.domNode.firstChild.children[1].getElementsByClassName("dyn-link")[0];},toggleDetailsNode:function(){return this.domNode.firstChild.children[2];}},markupMethods:{onshowDetailsChange:function(){var H=this.showDetails;this.toggleDetailsNode.innerHTML=H?A:E;C.toggleClass(this.domNode,"show-details",H);this.updateScrollbars();}},shortDesc:undefined,longDesc:undefined,showDetails:false,init:function G(H){this._super(H);this.shortDesc=this.shortDesc||mstrmojo.desc(14061,"An error has occurred");},onclick:function B(H){var J=H.getTarget(),I,K=this.longDesc;if(J===this.contactNode){I="mailto:?subject="+encodeURI("Issue: "+this.shortDesc)+(K?("&body="+encodeURI("Detail:\r\n"+K)):"");mstrApp.openPage(I,"_self");}else{if(J===this.toggleDetailsNode){this.set("showDetails",!this.showDetails);}}},setupScrollNodes:function D(){this.scrollNode=this.scrollNode;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo._ListSelections");var E=mstrmojo.dom;mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" tstid="{@tstid}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function G(){return this.domNode.firstChild;},scrollboxNode:function A(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},autoHide:false,itemsContainerNode:null,_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,init:function J(K){this._super(K);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},buildRendering:function D(){this.itemsHtml="";var K=(this.renderOnScroll?this.items&&((this.renderIndex+1)*this.renderBlockSize):this.items&&this.items.length);if(K){this.itemsHtml=this._buildItemsMarkup(0,K-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_buildItemsMarkup:function B(K,N,U,L,V,M){var W=[],Q=0;W[Q++]=U||"";var P=this.itemRenderer,T=P&&P.render;if(T&&typeof T==="function"){var R=this.items,S=Math.min(N+1,((R&&R.length)||0)),O;for(O=K;O<S;O++){W[Q++]=V||"";W[Q++]=T(R[O],O,this);W[Q++]=M||"";}}W[Q+1]=L||"";return W;},onselectionChange:function H(V){if(!V){return ;}var S=this.itemRenderer;if(!S){return ;}var O=S.unselect,R=this.items||[],W=V.removed,N,M,L,P,X;if(O&&W){for(P=0,X=W.length;P<X;P++){N=W[P];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){O(L,R[N],M,this);}}}var K=S.select,U=V.added,Q,T;if(K&&U){for(Q=0,T=U.length;Q<T;Q++){N=U[Q];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){K(L,R[N],M,this);}}}if(this.onchange){this.onchange({added:V.added,removed:V.removed});}},_set_items:function C(N,K){this.renderIndex=0;if(this.autoHide){this.set("visible",!!(K&&K.length));}var M=this.items;this.items=K;if(M!==K){var L=this.hasRendered;if(L){this.unrender(false);}this.clearSelect();if(L){this.render();}return true;}return false;},onItemContextMenu:mstrmojo.emptyFn,oncontextmenu:function F(K){E.preventDefault(window,K.e);var M=K.getTarget(),L=this.getItemFromTarget&&this.getItemFromTarget(M);if(L){if(this.onItemContextMenu(L,K)){K.cancel();}}},_getItemNode:function I(K){var L=this.itemsContainerNode;return(L&&L.childNodes[K])||null;},renderOnScroll:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(K,N,G,L){var I=K.domNode,M=I.offsetWidth,D=K.scrollableIncFetch;var E=K.hasAnimation&&(!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5),J=L?1:-1,F=parseInt(M,10)*J,H=E?500:0;A(0,-F,H,{target:G,duration:H,preStart:function(){this.target.style.overflowY="hidden";},onEnd:function(){this.target.style.display="none";}});A(F,0,H,{target:N,preStart:function(){this.target.style.display="block";this.target.style.overflowY=(D?"visible":"auto");}});if(K.waiting){A(0,-F,H,{widget:K,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}else{if(this.scrollableIncFetch){E.style.overflowY="visible";}}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,hasAnimation:true,scrollableIncFetch:false,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var C=mstrmojo.css,A=mstrmojo.dom,F=mstrmojo.string,E=function(H){this._super&&this._super(H);A.stopPropogation(H.hWin,H.e);},G=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.DynamicNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.fe.DynamicNode",markupString:'<div id="{@id}" class="mstrmojo-dynamic {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-dynamic-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-dynamic-prefix-text"  mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">'+G+'<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-onhoverparent mstrmojo-dynamicNode" title="'+mstrmojo.desc(13229,"Add this condition to the target list of a selector.")+'"><span class="mstrmojo-dynamicNode-info"><span class="mstrmojo-textset"></span></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" ></img></span><span class="mstrmojo-textset mstrmojo-rename-text" mstrAttach:click >'+mstrmojo.desc(1388,"Rename")+"</span>"+G+"</div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},dynamicNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.lastChild.firstChild.lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},createSetNode:function(){return this.domNode.lastChild.lastChild;},renameNode:function(){return this.domNode.lastChild.childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.dynamicNode,["selected"],this.selected);},onisEditingChange:function(){C.toggleClass(this.domNode,["renaming"],this.isEditing);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=this.data.ph.n;},onglowChange:function(){var H=this;C.toggleClass(H.dynamicNode,["glow"],this.glow);if(this.glow){setTimeout(function(){C.toggleClass(H.dynamicNode,["glow"],false);H.glow=false;},1000);}},onnoRelationOperatorChange:function(){C.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){C.toggleClass(this.dynamicNode,["noRelation"],this.noRelation);}},editableSlot:"textNode",editButtonSlot:"renameNode",init:function(H){var J=H.data;if(J){var I=H.tree.nameFactory;if(J.ph.n){I.setName(J.ph.n,this);}else{J.ph.n=I.getNewName(this,mstrmojo.desc(12033,"Dynamic Condition")+" ");}}this._super(H);},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;this.text=H.ph.n;}return J;},preclick:function D(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.createSetOptNode,I,true)&&!this.noRelationOperator&&!this.noRelation){J="createSetOpt";}else{if(A.contains(this.createSetNode,I,true)&&!this.noRelation){J="createSet";}else{if(A.contains(this.renameNode,I,true)){this.set("isEditing",true);}}}}H.part=J;},isEmpty:function(){var I=this.data,H=I&&I.ph;return !(H&&H.n);},del:function B(){var I=this.parent,H=this.tree.nameFactory;if(I&&I.remove&&this.data){I.remove(this.data);H.removeName(this.data.ph.n);}},onkeyup:E,onkeydown:E,onTextEditComplete:function(){var J=this.tree,K=J.nameFactory,H=F.trim(this.text||""),I=this.data.ph.n;if(H&&H!==I){if(K.isNameExist(H)){K.names[H].set("glow",true);this.set("isEditing",true);}else{K.changeName(I,H,this);this.data.ph.n=H;}}},isSelectableArea:function(H){return mstrmojo.dom.contains(this.dynamicNode,H,true);},avatarCssCls:"mstrmojo-FE mstrmojo-dynamicNode",getAvatarNode:function(){return this.dynamicNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.array","mstrmojo._HasChildren");var G=mstrmojo.array;function E(P){if(!this.shouldPropagateEnabled){return ;}var O=this._disabledChildren;G.forEach(P,function(Q){if(Q.enabled){O.push(Q.id);Q.set("enabled",false);}});}function J(){G.forEach(this._disabledChildren,function(O){var P=mstrmojo.all[O];if(P&&P.parent===this){P.set("enabled",true);}},this);this._disabledChildren=[];}mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",containerNode:null,preserveChildDomOrder:true,shouldPropagateEnabled:false,init:function M(P){this._super(P);this._disabledChildren=[];this.attachEventListener("addChild",this.id,function(Q){if(this.shouldPropagateEnabled&&!this.enabled){E.call(this,Q.value);}});if(this.children){this.initChildren();}var O=this.parent;if(!O||O.hasInitBindings){this.initBindings();}},destroy:function H(O){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(O);},unrender:function I(Q){var R=this.children,O=(R&&R.length)||0,P;for(P=O-1;P>-1;P--){R[P].unrender(true);}this._super(Q);},postBuildRendering:function A(){if(this._super()!==false){this.renderChildren();return true;}return false;},renderChildren:function L(){var Q=this.children,O=(Q&&Q.length)||0,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}}},childRenderCheck:function D(P){if(P&&!P.hasRendered){var O=P.slot||this.defaultChildSlot;return !!this[O];}return false;},addChildren:function N(R,P,Q){var O=this._super(R,P,Q);if(O){this.childRenderOnAddCheck(O);}return O;},removeChildren:function F(V,R){var U=V?[V]:(this.children||[]),O=U.length,S;for(S=O-1;S>-1;S--){var Q=U[S],P=Q&&Q.domNode;if(P){var T=this[(Q.slot||this.defaultChildSlot)];if(P.parentNode===T){T.removeChild(P);}}}return this._super(V,R);},childRenderOnAddCheck:function B(Q){if(this.hasRendered&&Q){var O=Q.length,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}else{if(R&&R.hasRendered){this.onchildRenderingChange(R);}}}}},onchildRenderingChange:function K(O){var W=O&&O.domNode;if(!W){return ;}var P=this.defaultChildSlot,V=O.slot||P,Y=this[V],Q=this.children;if(!Y){if(W.parentNode){W.parentNode.removeChild(W);}}else{if(W.parentNode===Y){return ;}if(!this.preserveChildDomOrder){Y.appendChild(W);}else{var R,U;for(U=Q.length-1;U>=0;U--){var X=Q[U];if(X===O){break;}if(V===(X.slot||P)){var Z=X.domNode;if(Z&&Z.parentNode===Y){R=Z;}}}if(R){Y.insertBefore(W,R);}else{Y.appendChild(W);}}}if(mstrmojo.publisher.hasSubs(this.id,"childrenRendered")){var S=Q.length,T;for(T=0;T<S;T++){if(!Q[T].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}},propagateChildProps:function C(S){var R=this[S],Q=this.children||[],O=Q.length,P;for(P=0;P<O;P++){Q[P].set(S,R);}}});mstrmojo.Container.enabledMarkupMethod=function(){mstrmojo.Widget.enabledMarkupMethod.apply(this,arguments);if(this.shouldPropagateEnabled){if(this.enabled){J.call(this);}else{E.call(this,this.children);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.string");function C(H,D,E){var K=[];var G=H.optionRenderer,I=G&&G.render;if(I&&typeof I==="function"){var L=H.options,J=Math.min(E,((L&&L.length)||0)),F;for(F=D;F<J;F++){K.push(I(L[F],F,H));}}return K.join("");}mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,options:null,optionValueField:"v",optionNameField:"n",idx:-1,renderedOptions:"",markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onidxChange:function(){var D=this.domNode.getElementsByTagName("select");if(D&&D.length){D[0].selectedIndex=this.idx;}},onvalueChange:function(){var I=this.selectNode,G=I.options,F=this.value,E,H;for(H=0;H<G.length;H++){var D=G[H].value.toString()===F;if(D){E=H;if(F!==""){mstrmojo.css.toggleClass(G[H],"selected",D);}break;}}if(I.length>0&&E>0&&this.unset){if(this.options[0].v==="-1"){I.remove(0);E--;}this.unset=false;}this.set("idx",E);},onwidthChange:function(){var D=this.width;if(D>=0){this.selectNode.style.width=D+"px";}}},_set_selected:function(G,D){var E=this.selectNode,F=this[G]!==D;this[G]=D;if(E){this.set("value",D);}return F;},preBuildRendering:function A(){var F=this;if(F.unset){F.idx=0;}var E=F.options,D=(E&&E.length)||0;if(D){F.renderedOptions=C(F,0,D);}return this._super();},optionRenderer:{render:function(E,D,F){return mstrmojo.string.apply(F.getOptionMarkup(E),F.getOptionProps(E,D));}},getOptionMarkup:function(D){return'<option value="{@en@v}" class="{@cls}" style="{@style}" {@sel}>{@en@n}</option>';},getOptionProps:function B(F,D){var G=this,H=F[G.optionValueField],E=D===parseInt(G.idx,10);G.selected=G.value=E?H.toString():G.value;return{cls:E?"selected":"",v:H===undefined?"":H,n:F[G.optionNameField]||"",style:"",sel:E?"selected":""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.Widget;mstrmojo.ui.Checkbox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.Checkbox",markupString:'<div id="{@id}" class="mstrmojo-ui-Checkbox {@cssClass}" mstrAttach:click></div>',markupMethods:{onvisibleChange:C.visibleMarkupMethod,oncheckedChange:function B(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},onenabledChange:C.enabledMarkupMethod},checked:false,onclick:function A(){this.set("checked",!this.checked);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.dom");var H=mstrmojo.color,F=mstrmojo.dom;var G=68.5,I=77.5,C=83;function A(L,K){var J=F.getMousePosition(L,window);return{x:J.x-K.x-I,y:J.y-K.y-I};}function B(L){var K=this._hsl,J=K[0],N=K[1],P=K[2],Q=J*2*Math.PI;var M=this.hueHandleNode.style;M.left=Math.round(Math.sin(Q)*G+I)+"px";M.top=Math.round(-Math.cos(Q)*G+I)+"px";var O=this.slHandleNode.style;O.left=Math.round(C*(0.5-N)+I)+"px";O.top=Math.round(C*(0.5-P)+I)+"px";this.slNode.style.backgroundColor=H.hsl2hex(J,1,0.5);if(!L){this.onColorPicked(H.hsl2hex(J,N,P));}}mstrmojo.ui.editors.controls.ColorWheel=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",markupString:'<div id="{@id}" class="mstrmojo-ui-ColorWheel {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="cwHue"></div><div class="cwColorField"></div><div class="cwHandle"><div></div></div><div class="cwHandle"><div></div></div></div>',markupSlots:{slNode:function(){return this.domNode.childNodes[1];},hueHandleNode:function(){return this.domNode.childNodes[2];},slHandleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,oncolorChange:function(){this._hsl=H.hex2hsl(this.color);B.call(this,true);}},slNode:null,hueHandleNode:null,slHandleNode:null,color:"#ffffff",onColorPicked:function E(J){},onmousedown:function D(M){var O=this,J=F.position(this.domNode),P=this._hsl,L=M.e,N=A(L,J),Q=Math.max(Math.abs(N.x),Math.abs(N.y))*2>C,K=function(S){var V=A(S,J),R=P[0],T=P[1],U=P[2];if(Q){R=Math.atan2(V.x,-V.y)/(2*Math.PI);if(R<0){R+=1;}}else{T=Math.max(0,Math.min(1,-(V.x/C)+0.5));U=Math.max(0,Math.min(1,-(V.y/C)+0.5));}O._hsl=[R,T,U];B.call(O);F.stopPropogation(window,S);return false;};F.attachMouseMoveEvents(K);K(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,G=mstrmojo.array;function F(H,J){var I={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[H]||{};if(typeof J==="object"){mstrmojo.hash.copy(J,I);}return I;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,forceResetCache:false,onUpdateSearchParams:mstrmojo.emptyFn,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(4326,"Case Sensitive")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},searchNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;},optionNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function E(H){var J=this;var I=J.searchTimer;if(I){window.clearTimeout(I);}J.searchTimer=window.setTimeout(function(){J.onkeyupDelayed(H);delete J._searchTimer;},parseInt(H.e.keyCode||H.e.charCode,10)===13?0:J.searchDelay);},onkeyupDelayed:function A(I){var H=I.hWin,K=I.e||H.event;var J=mstrmojo.string.trim(this.inputNode.value);if(this.searchNode){C.toggleClass(this.searchNode,["clear"],J.length>0);}this.showTaskError=false;this.click2Search=false;if(J.length==0||this.autoSubmit||this.onEnter&&K.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(I){var H=I.hWin,K=I.e||H.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var J=this.optionNode.parentNode.style;J.display=J.display=="block"?"none":"block";}break;case"sbSearch":if(this.inputNode.value.length>0){this.clearSearch();}break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);var I=this.searchCache,H=this.rootID;if(I&&I[H]){I[H][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache(this.forceResetCache);var I=this.searchCache[this.rootID];if(I){var H=I[B]||"";this.inputNode.value=H;if(H.length>0){if(H.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(I){var H=this.contentWidget||this;H.set("items",I[0]);if(this.supportIncFetch){var J=I[1],L=I[2],K=this.blockCount;H.set("ifs",{np:Math.floor(J/K)+((J%K>0)?1:0),cp:Math.floor(L/K)+((L%K>0)?1:0)});}},_onsearch:function(H){this.getRootID();this._setupCache();var K=mstrmojo.string.trim(this.inputNode.value);if(K.length===0){H=true;}var L=this.token[this.taskId];if(L.test(K)){}if(this.searchPattern==K&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var M=this.rootID,J=this.searchCache[M];if((K.length<this.minSearchLength&&!this.click2Search)&&!H){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(J[M]);this.searchPattern=K;}}else{this.searchPattern=K;J[B]=this.searchPattern;var I=this.filterCache(K,J,H);if((this.click2Search||I===null)&&!H){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(I);}}J[B]=K;},_setupCache:function(J){var K=this.searchCache,I=this.rootID;if(K&&(J||!K[I])){K[I]=K[I]||{};var H=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];K[I][I]=[H,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",serverRequest:function D(H,I){mstrmojo.xhr.request("POST",this.path,I,H,undefined,this.XServer,this.baseParams);},fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var H=this,I=F.apply(this,[this.taskId]);I.searchPattern=this.searchPattern;this.onUpdateSearchParams(I);var J={success:function(K){var L=K.items||K.es||[];L=[L,K.totalSize||K.sz||0,K.blockBegin||K.bb];mstrmojo.all[H.id].searchCache[H.rootID][(I.searchPattern.length==0?H.rootID:H.buildIndex(I.searchPattern))]=L;H._notifyContentWidget(L);},failure:function(K){if(H.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+K.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(H.spinnerNode){H.spinnerNode.style.display="none";}if(H.postFetch){H.postFetch();}}};this.serverRequest(I,J);},fetchPage:function(H){this.blockBegin=H*this.blockCount+1;this.fetch();},filterCache:function(J,M,I){var H=M&&M[I?this.rootID:this.buildIndex(J)];if(H){return H;}var K=this.token[this.taskId];if(K.test(J)||this.totalSize>this.blockCount){return null;}var O=J.replace(/.$/,"");H=M&&M[this.buildIndex(O)];while(H===undefined&&(O=O.replace(/.$/,"")).length>0){H=M&&M[this.buildIndex(O)];}if(H!==undefined){if(H[1]>this.blockCount){return null;}var L=H[0],N=[];G.forEach(L,function(P){if(P.n.search(new RegExp(J,this.matchCase?"":"i"))>-1){N.push(P);}});this.totalSize=N.length;return(M[this.buildIndex(J)]=[N,N.length,this.blockBegin].concat());}return null;},buildIndex:function(H){if(H.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?H.toUpperCase():H+"::0";},init:function(H){if(this._super){this._super(H);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var C=mstrmojo.dom,B=mstrmojo.hash,E=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);},onselectedChange:function(){E.toggleClass(this.domNode,"selected",this.selected);},ontextChange:function(){this.textNode.innerHTML=this.text;},ontitleChange:function(){this.domNode.title=this.title;},onwidthChange:mstrmojo.Widget.widthMarkupMethod},oniconClassChange:function D(J){var K=this.domNode;if(this.hasRendered&&K){K.className=K.className.replace(J.valueWas,"")+" "+J.value;}},onclick:mstrmojo.emptyFn,ontouchend:function I(J){this.onclick(J);}});mstrmojo.Button.newIconButton=function H(L,O,M,J,N){var K={scriptClass:"mstrmojo.Button",title:L,cssClass:O,text:"",onclick:M};if(J){K.bindings=J;}B.copy(N,K);return K;};function F(M,N,J,P){var L=[];if(J){L.push(J);}var O=P&&P.cssClass;if(O){L.push(O);delete P.cssClass;}var K={scriptClass:"mstrmojo.Button",cssClass:L.join(" "),text:M};if(N){K.onclick=N;}return B.copy(P,K);}mstrmojo.Button.newInteractiveButton=function G(M,N,P,O){var L={glowClass:"glow"};if(P&&(C.isFF||C.isWK)){B.copy({onmousedown:function J(){E.applyShadow(this.domNode,0,0,10,P);},onmouseup:function K(){E.removeShadow(this.domNode);}},L);}return F(M,N,"mstrmojo-InteractiveButton",B.copy(O,L));};mstrmojo.Button.newWebButton=function A(K,J,M,L){return F(K,J,"mstrmojo-WebButton"+(M?" hot":""),L);};mstrmojo.Button.newActionButton=function(K,L,M){var J=mstrmojo.Button.newWebButton(K,L,false,M);J.cssClass=J.cssClass+" action-button";return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var E=mstrmojo.Widget;mstrmojo.ui._IsPulldown=mstrmojo.provide("mstrmojo.ui._IsPulldown",{scriptClass:"mstrmojo.ui._IsPulldown",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click><div class="mstrmojo-ui-Pulldown-text {@cssTextClass}" title="{@title}" style="{@labelCssText}">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function D(){return this.domNode.firstChild;},containerNode:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:E.visibleMarkupMethod,onheightChange:E.heightMarkupMethod,onwidthChange:E.widthMarkupMethod,onvalueChange:function F(){this.selectedNode.innerHTML=this.value||"";},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},getPopupList:mstrmojo.emptyFn,anchorSlot:"selectedNode",postBuildRendering:function B(){this._super();this.getPopupList().set("items",this.items);var G=this.selectedIndex,H=this.selectedIndices;if(G!==undefined){this.set("selectedIndex",G);}if(H!==undefined){this.set("selectedIndices",mstrmojo.hash.copy(H||{}));}},onitemsChange:function C(){var G=this.getPopupList();if(G){G.set("items",this.items);}},onPopupWidgetOpened:function(){var G=this.getPopupList();if(G&&(!G.items||G.items.length===0)){G.close();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.css","mstrmojo.string","mstrmojo._IsExprNode","mstrmojo._HasPopup","mstrmojo.Widget");var O=mstrmojo.dom,B=mstrmojo.css,E=mstrmojo.string.htmlAngles,M=mstrmojo.expr,N=M.ET,K=M.FN,A=M.BRANCH_FNS[K.NOT],D={};D[K.BETWEEN]=1;D[K.NOT_BETWEEN]=1;var C={"*":function(Q,P){return Q?('<span class="mstrmojo-unknown">'+(E(Q.n||Q.xml)||"...")+"</span>"):null;}};function H(Q,P,S,R){return S&&((R?'<span class="mstrmojo-ListIcon t'+R+'"></span>':"")+'<span class="mstrmojo-text mstrmojo-embedobj">'+E(S)+"</span>");}C[N.R]=function(Q,P){return H(Q,P,Q.r&&Q.r.n,Q.r&&Q.r.t);};C[N.F]=function(Q,P){return H(Q,P,Q.f&&Q.f.n,Q.f&&Q.f.t);};C[N.XML]=function(Q,P){return H(Q,P,Q.n||Q.p&&Q.p.n||Q.xml,Q.p&&Q.p.t);};C[N.AE]=function(V,S){var R=[];if(V&&V.a&&V.a.n){R.push('<span class="mstrmojo-text mstrmojo-attr">'+E(V.a.n)+"</span>");if(V.fn!==M.FN.IN_LIST){R.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(V.et,V.fn,V.fnt))+"</span>");}var U=V.es,P=U&&U.length||0;if(P){R.push('<span class="mstrmojo-elems">');var Q=R.length;for(var T=0;T<P;T++){R[Q++]='<span class="mstrmojo-text mstrmojo-elem">';R[Q++]=E(U[T].n);if(T<P-1){R[Q++]=", ";}R[Q++]="</span>";}R[Q++]="</span>";}else{R.push('<span class="mstrmojo-text mstrmojo-emptyelems">(Empty)</span>');}}return R.join("");};C[N.AQ]=function(W,X){var T=[];if(W&&W.a&&W.a.n){T.push('<span class="mstrmojo-text mstrmojo-attr">'+E(W.a.n)+"</span>");if(W.fm&&W.fm.n){T.push('<span class="mstrmojo-text mstrmojo-form">'+E(W.fm.n)+"</span>");if(W.fn!=null){T.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(W.et,W.fn,W.fnt,W.fm.dtp))+"</span>");var P=M.fnCstCount(W.fn,W.fnt);if(W.et===N.AC){if(P>=1){if(W.a2&&W.a2.n){T.push('<span class="mstrmojo-text mstrmojo-attr2">'+E(W.a2.n)+"</span>");if(W.fm2&&W.fm2.n){T.push('<span class="mstrmojo-text mstrmojo-form2">'+E(W.fm2.n)+"</span>");}}if(P>1){T.push('<span class="mstrmojo-text mstrmojo-btwn">'+X.betweenText+"</span>");if(W.a3&&W.a3.n){T.push('<span class="mstrmojo-text mstrmojo-attr3">'+E(W.a3.n)+"</span>");if(W.fm3&&W.fm3.n){T.push('<span class="mstrmojo-text mstrmojo-form3">'+E(W.fm3.n)+"</span>");}}}}}else{if(W.et===N.AL){var U=W.cs,Y=[];for(var R=0,V=U.length;R<V;R++){Y.push(U[R].v);}T.push('<span class="mstrmojo-text mstrmojo-c1">'+Y.join(mstrConfig.listSep)+"</span>");}else{if(P>=1){var U=W.cs,S=U&&U[0];T.push('<span class="mstrmojo-text mstrmojo-c1">'+E(S&&S.p&&S.p.n||S&&S.v)+"</span>");if(P>1){var Q=U&&U[1];T.push('<span class="mstrmojo-text mstrmojo-btwn">'+X.betweenText+"</span>");T.push('<span class="mstrmojo-text mstrmojo-c1">'+E(Q&&Q.p&&Q.p.n||Q&&Q.v)+"</span>");}}}}}}}return T.join("");};C[N.AC]=C[N.AQ];C[N.AL]=C[N.AQ];C[N.MQ]=function(f,g){var e=[],Z=f&&f.m,l=Z&&Z.n;if(l){var Q=f.fnt,U=M.FNT.PER,c=M.FNT.RANK;l=Q===U?mstrmojo.desc(2787,"Percentage of ##").replace("##",l):Q===c?mstrmojo.desc(2788,"Rank of ##").replace("##",l):l;e.push('<span class="mstrmojo-text mstrmojo-metric">'+E(l)+"</span>");if(f.fn!=null){e.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(f.et,f.fn,Q,M.DTP.REAL))+"</span>");var X=M.fnCstCount(f.fn,Q);if(f.et==M.ET.MC){if(X>=1){var k=(f.m2&&f.m2.n)||"?";e.push('<span class="mstrmojo-text mstrmojo-m2">'+E(k)+"</span>");if(X>1){e.push('<span class="mstrmojo-text mstrmojo-btwn">'+g.betweenText+"</span>");var S=(f.m3&&f.m3.n)||"?";e.push('<span class="mstrmojo-text mstrmojo-m3">'+E(S)+"</span>");}}}else{if(X>=1){var R=f.cs,a=R&&R[0];var P=function(h){var d=h.v;if(f.fnt==U){if(d.replace){h.v=d.replace(/%$/,"");}d=h.v+"%";}return d;};e.push('<span class="mstrmojo-text mstrmojo-c1">'+E(a&&a.p&&a.p.n||a&&a.v&&P(a))+"</span>");if(X>1){var Y=R&&R[1];e.push('<span class="mstrmojo-text mstrmojo-btwn">'+g.betweenText+"</span>");e.push('<span class="mstrmojo-text mstrmojo-c2">'+E(Y&&Y.p&&Y.p.n||Y&&Y.v&&P(Y))+"</span>");}}}var b=f.dmy&&f.dmy.uts,W=b&&b.length;if(W){e.push('<span class="mstrmojo-text mstrmojo-at">'+g.atText+"</span>");e.push('<span class="mstrmojo-dmy">');for(var V=0;V<W;V++){var T=b[V];e.push('<span class="mstrmojo-text mstrmojo-dmyunit">');e.push(E(T.utgt?T.utgt.n:T.n));if(V<W-1){e.push(",");}e.push("</span>");}e.push("</span>");}}}return e.join("");};C[N.MC]=C[N.MQ];function G(P){var Q=P.data;if(Q.not){return'<span class="mstrmojo-text mstrmojo-not">'+A+"</span>";}return"";}function F(P){var R=P.data,Q=C[R&&R.et]||C["*"];return G(P)+((Q&&Q(R,P))||('<span class="mstrmojo-text">'+P.emptyText+"</span>"));}mstrmojo.ConditionNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){B.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},oneditableChange:function(){B.toggleClass(this.textNode,["editable"],this.editable);},onselectedChange:function(){B.toggleClass(this.condNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=F(this);this.textPostfixNode.innerHTML=this.getConditionTextPostfix();}},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),init:function L(P){this._super(P);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());},getConditionTextPostfix:function(){return"";},del:function J(){var P=this.parent;if(P&&P.remove&&this.data){P.remove(this.data);}},isEmpty:function(){var Q=this.data,P=Q&&Q.et,R=P&&mstrmojo.expr.ET2TGT[P];return !(R&&Q[R]);},isSelectableArea:function(P){return O.contains(this.condNode,P,true);},preclick:function I(P){var R=null,Q=O.eventTarget(P.hWin,P.e);if(O.contains(this.prefixNode,Q,true)){R="andor";}else{if(O.contains(this.textNode,Q,true)){R="condition";}else{if(O.contains(this.textPostfixNode,Q,true)){O.stopPropogation(P.hWin,P.e);return false;}}}P.part=R;}});mstrmojo.ConditionNode.getFunctionNode=F;})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var a=mstrmojo.hash,f=mstrmojo.array,e=mstrmojo.boxmodel,c=mstrmojo.dom;function A(k,m,h){var l=k.listSelector;if(l){l[m](k,k.itemsContainerNode,h);}}function L(k,h){var l=k.lastPagePos;if(!l||l.dragId!==h){l=e.offset(k.itemsContainerNode);l.dragId=h;k.lastPagePos=l;var m=k.scrollboxNode;k.lastScrollPos={left:m.scrollLeft,top:m.scrollTop,width:m.clientWidth,height:m.clientHeight};}}function O(m,p,k){var l=p&&p.node;if(l===m.dropCueNode||l===m.dropCueNode.firstChild){return m.dropCuePos;}var n=m.listMapper;var h=n&&n.whereDrop(m,m.itemsContainerNode,l,p.pos,{left:m.lastPagePos.left-m.lastScrollPos.left,top:m.lastPagePos.top-m.lastScrollPos.top,width:m.lastScrollPos.width,height:m.lastScrollPos.height});var o=m.dropCuePos;return((k!==false)&&o&&h&&(o.idx===h.idx)&&(o.left===h.left)&&(o.top===h.top))?o:h;}var g="attachEventListener";function D(k,h){if(k.makeObservable){h=h||[];if(!h[g]){mstrmojo.hash.make(h,k.itemsScriptClass||mstrmojo.Arr);}}return h;}function H(k,h){if(h&&h[g]){k._sub_its=h;k._sub_add=h[g]("add",k.id,"preadd");k._sub_rmv=h[g]("remove",k.id,"preremove");}}function G(h){if(h._sub_its){var k=mstrmojo.publisher;k.unsubscribe(h._sub_add);k.unsubscribe(h._sub_rmv);delete h._sub_add;delete h._sub_rmv;delete h._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var k=this.dropCueNode,h=k&&k.style;if(!h){return ;}var m=this.dropCuePos,l=!!m;if(l){h.left=m.left+"px";h.top=m.top+"px";}h.display=l?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}},onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Z(n){this._super(n);this.items=this.initItems(this.items);var m=this.selectedIndices,k=this.selectedIndicesList,l=this.selectedIndex,p=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(m||k||(l>-1)||p){this.initSelections(m,k,l,p);}if(this.postInitItems){this.postInitItems();}},initItems:function I(h){return D(this,h);},preBuildRendering:function W(){var n=this.listBuilder,q=n.newContext(this);this.ctxtBuilder=q;var k=this.markupSlots,m=!!(this.renderOnScroll&&this.renderBlockSize&&k&&k.scrollboxNode),l=this.items,h=(l&&l.length)||0,o=m?this.firstRenderBlockSize:h,p=m?this.firstRenderBlockSize:0;this._eros=m;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(l,n,this,q,o,p).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function E(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}H(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var n=mstrmojo.all[q];n.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],h=k.length;l<h;l++){var p=k[l],m=this[p];if(m&&m.constructor===Object){m=mstrmojo.insert(mstrmojo.hash.clone(m));m.widget=this;this[p]=m;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function X(m){G(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],h=l.length;k<h;k++){var n=this[l[k]];if(n&&n.isPlaying){n.cancel();}}this._super(m);},pauseScrollRendering:function P(l,h,k){if(l!==false){l=true;}if(this.paused===!!l){return ;}this.paused=!!l;if(l){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(h,k);}},onscroll:function K(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var h=this;this._fillTmr=self.setTimeout(function(){h.fill();h=null;},50);}}if(this._super){this._super();}},fill:function b(h,n){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var o=(this.items&&this.items.length)||0;if(!o){if(n){n();}}else{var l=this.scrollboxNode,p=this.itemsContainerNode,m=mstrmojo.boxmodel.offset(p,l),r=this.listMapper,q=r.findScrollRange(p,o,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||l.scrollTop,l.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||l.scrollLeft,l.clientWidth,m.left,m.top);if(this.fillAt(q.start,q.end)){if(h){h();}var k=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[k].fill(h,n);},100);}else{if(n){n();}}}},fillAt:function M(l,k){var h=this.listMapper;if(h){return h.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,l,k,this.renderBlockSize);}else{return false;}},add:function R(k,h){if(!k||!k.length){return -1;}var l=this.items;if(h==null){h=a.min(this.selectedIndices,false,true);if(h!==null&&h!==undefined){h++;}}if(h==null||h===-1){h=(l&&l.length)||0;}if(l&&l.add){l.add(k,h);}else{this.set("items",l?f.insert(l.concat(),h,k):k);}return h;},preadd:function B(l){if(this.hasRendered){var o=this.listMapper;if(o){o.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var n=this.listBuilder;if(n){n.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var m=l.index,h=l.value.length;this.fillAt(m,m+h-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function U(h){if(h==null){return -1;}if(h.constructor!==Array){return this._remove(h);}var l=this.items;if(l){var k;if(l.remove){for(k=h.length-1;k>-1;k--){l.remove(h[k],1);}}else{l=l.concat();for(k=h.length-1;k>-1;k--){l.splice(h[k],1);}this.set("items",l);}return h[0];}return -1;},_remove:function U(l){var k=this.items;if(!k||(l==null)){return -1;}var h;if(!isNaN(l)){h=l;}else{h=this.itemIndex(l);}if(h>-1){if(k.remove){k.remove(h,1);}else{k=k.concat();k.splice(h,1);this.set("items",k);}}return h;},duplicate:function Y(o,k,l){var m=this.items,h=-1;if(!m||(o==null)){return -1;}if(!isNaN(o)){if(k===null||k===undefined){k=o+1;}o=m[o];}else{if(k===null||k===undefined){k=this.itemIndex(o)+1;}}if(o){var n;n=a.copy(l,a.clone(o));h=this.add([n],k);}return h;},preremove:function N(k){if(this.hasRendered){var m=this.listMapper;if(m){m.onremove(this,this.itemsContainerNode,this.ctxtBuilder,k);}var l=this.listBuilder;if(l){l.onremove(this,this.ctxtBuilder,k);}var h=this.listSelector;if(h){h.onremove(this,k);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(k);}if(this._super){this._super(k);}},move:function S(m,s){function q(u,t){u=parseInt(u,10);return t===1||(s>=u&&s<u+t);}var r=(this.items&&this.items.length)||0;if(s===-1||s==null||isNaN(s)){s=r;}else{s=Math.min(s,r);}var l,h,o,n;if(m.constructor===Array){h=m;o=m;n=(h&&h.length)||0;if(q(m[0],m.length)){return false;}l=f.get(this.items,m);}else{if(typeof (m)==="object"){l=[m];n=1;h=this.itemIndex(l[0]);o=[h];if(q(h,1)){return false;}}else{h=m;o=[m];n=1;if(q(h,1)){return false;}l=[this.items[h]];}}var p=0;for(var k=0;k<n;k++){if(o[k]<=s){s--;p++;}}if(p==o.length){s++;}if(l[0]!=null){this.remove(h);this.add(l,s);}return true;},itemIndex:function F(h){if(h==null){return -1;}var k=this.itemIdField;return k?f.find(this.items,k,h[k]):f.indexOf(this.items,h);},prechange:function T(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var m=0,h=k.length;m<h;m++){var n=k[m];if(n&&n.onchange){n.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function J(p,h){var o=this.items;h=this.initItems(h);this.items=h;if(o!==h){var m=this,l=function(){if(m.autoHide){m.set("visible",!!(h&&h.length));}m=null;},k=this.hasRendered;if(k){this.refresh(l);}else{l();}}return o!==h;},premousedown:function d(h){A(this,"premousedown",h);},premouseup:function Q(h){A(this,"premouseup",h);},scrollTo:function V(k){var h,l=this.listMapper;if(l&&l.toItem){if(!isNaN(k)){h=k;}else{h=this.itemIndex(k);}if(h>=0){l.toItem(this,h);}}},draggable:false,getDragData:function(n){L(this,n.id);var l=O(this,n.src),k=l&&l.idxActual;if((k>-1)&&this.selectedIndices[k]){var m=this.sortSelectedIndices(),h=f.get(this.items,m)||[];switch(h.length){case 1:return a.copy({html:h[0][this.itemDisplayField],index:m[0]},a.copy(h[0]));case 0:return null;default:return a.copy({html:h.length+" selections",indices:m},h);}}},dropZone:false,ondragenter:function(h){L(this,h.id);this.set("dropCuePos",O(this,h.tgt));},ondragover:function(h){this.set("dropCuePos",O(this,h.tgt));},ondragleave:function(h){this.set("dropCuePos",null);},isDragValid:function C(h){return h&&h.src&&h.src.data;},ondragstart:function(h){if(!(h&&h.src&&h.src.data)){return false;}},allowCopy:false,ondragend:function(m){var k=m&&m.tgt,h=k&&k.widget;if(h===this){}else{if(this.tree&&h&&h.tree===this.tree){if(!this.allowCopy||!c.ctrlKey(k.hWin,k.e)){var l=m.src&&m.src.data;if(l&&(l.indices||(l.index!==null))){this.remove(l.indices||l.index);}}}}},ondrop:function(r){var w=r&&r.src,q=w&&w.data;if(q){var l=O(this,r.tgt,false),t=l&&l.idx,m=(q&&q.constructor===Array),k=this.sortSelectedIndices();var o=this.items;t=Math.min(t,o&&o.length)||0;var u=true;if(w.widget===this){u=this.move(k,t);f.forEach(k,function(s){if(s<=t){t--;}});}else{this.add(m?q:[q],t);}if(u){var p=m?q.length:1,h={};for(var n=0;n<p;n++){h[t+n]=true;}this.set("selectedIndices",h);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string");var B=mstrmojo.string;mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",allowHTML:false,text:"",title:"",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" title="{@title} "mstrAttach:click></div>',markupMethods:{ontitleChange:function(){this.domNode.title=this.title;},ontextChange:function(){var C=this.text;C=B.isEmpty(C)?"":C.toString();this.domNode.innerHTML=this.allowHTML?C:B.encodeHtmlString(C,true);},oncssTextChange:mstrmojo.Widget.cssTextMarkupMethod,onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod},autoHide:false,_set_text:function A(E,C){if(this.autoHide){this.set("visible",(C!==null)&&(C!=="")&&(C!==undefined));}var D=this.text;this.text=C;return(D!==C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget");var R=["(",")","{","}","-","+","*","/","<",">","|","~",","],G={" ":true,"@":true},Q=null;function J(V){if(!Q){Q={};var U,T;for(U=0,T=R.length;U<T;U++){Q[R[U]]=true;}}return Q.hasOwnProperty(V);}function S(V){if(!V){return false;}var T=V.length,U,W;for(U=0;U<T;U++){W=V.charAt(U);if(J(W)||G[W]){return true;}}return false;}function A(T){return S(T)?"["+T+"]":T;}var M={8:true,9:true,10:true};var C=function(U,T){return M[U]&&!/^\".*\"$/.test(T)?'"'+T+'"':T;};var D=function(U,T,V){var W=typeof V==="undefined"?true:M[V];return U.tp===261&&T.length>=2&&W?(/^\s+$/.test(T.substr(1,T.length-2))?T:T.substr(1,T.length-2)):T;};mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,null,{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}"></span>',active:false,markupMethods:{ondataChange:function(){var U=this.data,T=mstrmojo.string.encodeHtmlString(String(U.v));if(U.v===","){this.domNode.innerHTML=T+"&nbsp;";}else{if(U.tp===259&&U.v==="Desc"){this.domNode.innerHTML="&nbsp;"+T;}else{this.domNode.innerHTML=T;}}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());mstrmojo.css.toggleClass(this.domNode,["nfn"],!this.isFunction());mstrmojo.css.toggleClass(this.domNode,["invalid"],U.sta===-1);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},isMstrO:function P(){return !!this.data.oi||!!this.data.rfd;},isFunction:function B(){return this.isMstrO()&&(this.data.oi&&this.data.oi.t==11);},brackets:A,length:function E(){return this.data.v.toString().length;},isDelimiter:function O(){return this.data.isDelimiter||(this.length()===1&&J(this.data.v));},split2Tokens:function H(W){var V=this.data,U=V&&V.v.toString(),X=U.substring(0,W),T=U.substring(W);return[{v:X,isNew:true},{v:T,isNew:true}];},mergeTo:function I(U){var W=this.data,V=W&&W.v.toString(),T=U.data.v.toString();return{v:V+T,isNew:true};},brackets:A,setItemInfo:function N(T){var U=this.data;U.v=this.brackets(T.n);U.oi=T;U.sta=1;U.isNew=true;this.set("data",U);this.paint();},spliceContent:function K(Z,X,U){var Y=this.data,W=Y&&Y.v.toString(),a=W.substring(0,Z);X=(X===null||X===undefined)?(W.length-Z):X;var T=W.substring(Z+X),V=a+(U||"")+T;Y.v=V;Y.isNew=true;Y.sta=1;Y.ift=(this.isAttributeToken()||Y.at)&&(Y.v.indexOf("@")>=0);if(Y.ift){Y.at=Y.oi||Y.at;}else{delete Y.at;}delete Y.oi;delete Y.exv;delete Y.extp;delete Y.tp;this.set("data",Y);this.paint();},isAttributeToken:function F(){return this.data&&this.data.oi&&this.data.oi.t===12;},setFormInfo:function L(U){var V=this.data,T=V.oi||V.at;V.v=this.brackets(T.n)+"@"+this.brackets(U.n);V.exv=U.did;V.extp=8;V.sta=1;V.isNew=true;V.oi=V.at;delete V.at;this.set("data",V);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=J;mstrmojo.ME.MetricToken.brackets=A;mstrmojo.ME.MetricToken.quotes=C;mstrmojo.ME.MetricToken.unquotes=D;mstrmojo.ME.MetricToken.QUOTABLE_DATATYPES=M;mstrmojo.ME.MetricToken.argDelimiter={".":",",",":";"}[mstrConfig&&mstrConfig.decimalSep]||",";})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click tstid="{@tstid}"/><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.func","mstrmojo.DocDataService");var R=mstrmojo.hash.copy,c=mstrmojo.array.forEach,m=mstrmojo.func,I=m.wrapMethods;var F=2,U=1,f=1,k=2,a=3;var A={FIRST:1,MIDDLE:2,LAST:3};var l={BUSY:1,INTERIM:2,DONE:3,SILENT:4,CANCELED:5};var S=R(mstrmojo.DocDataService.SUPPRESS_DATA,{preserveUndo:true,config:{silent:true}});function G(){c(this._delayRemovedCmds,function(t){t.discard();});this._delayRemovedCmds=null;}function V(){this.cmds=this.cmds.concat(this._delayRemovedCmds);this._delayRemovedCmds=null;}function J(u){var t=this.cmds,w=this.pos;this._delayRemovedCmds=t.splice(w+1);if(w>=this.size-1){t.shift().discard();}t.push(u);this.pos=t.length-1;}function r(t,u){t.reset();throw new Error(u||"Invalid state.");}mstrmojo.vi.controllers.UICmdMgr=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmdMgr",cmds:null,pos:-1,size:20,_delayRemovedCmds:null,controller:null,dataService:null,model:null,state:U,STATE:{EXECUTING:F,IDLE:U},CMD_PHASE:A,init:function n(t){R(t,this);this.cmds=[];},execute:function d(w){if(this.state===F){r(this);}try{w=R(w,{mgr:this,undoUIState:this.model.getUIState(),action:k});var t=this.curCmd=new mstrmojo.vi.controllers.UICmd(w);J.call(this,t);this.state=F;t.execute();}catch(u){this.reset();throw u;}},getInterimCmd:function B(){if(this.state===F){var t=this.cmds[this.pos];if(t.state===l.INTERIM){return t;}}return null;},undo:function T(w){if(this.canUndo()){this.state=F;try{var t=this.curCmd=this.cmds[this.pos--];t.action=f;t.redoUIState=this.model.getUIState();t.undoRedo(w);}catch(u){this.reset();throw u;}}},redo:function H(){if(this.canRedo()){this.state=F;try{var t=this.curCmd=this.cmds[++this.pos];t.action=a;t.undoUIState=this.model.getUIState();t.undoRedo();}catch(u){this.reset();throw u;}}},onSuccess:function b(t){if(this.state===U){r(this);}if(t!==this.curCmd){r(this,"Wrong command");}this.state=U;G.call(this);this.controller.onCmdMgrChanged();},onFailure:function q(){G.call(this);this.reset();},onCancel:function Z(u,w){this.state=U;var t=!!u.submitCount;if(t){this.undo(w);}else{this.pos--;}this.cmds.pop();u.discard();if(t){G.call(this);}else{V.call(this);}this.controller.onCmdMgrChanged();},reset:function e(){c(this.cmds,function(t){t.discard();});this.cmds.length=0;this.pos=-1;this.state=U;this.controller.onCmdMgrChanged();},resetState:function Y(){this.state=U;},canUndo:function X(){return this.state===U&&this.pos>=0;},canRedo:function L(){return this.state===U&&this.pos<this.cmds.length-1;},onSubmitUpdates:function P(){if(this.state===U){this.cmds.splice(this.pos+1);this.controller.onCmdMgrChanged();}},isUndoRedo:function C(){var t=this.curCmd||{};if(this.state===F&&(t.action===f||t.action===a)){return true;}return false;}});function W(t,w,u){if(w.stid==="undefined"){u.submission=function(AA,x,y){var AB=y.params,z=JSON.parse(AB.params);z.actions[0].stid=t.action===f?t.undoStateId:t.redoStateId;AB.params=JSON.stringify(z);};}return u;}function E(u,z){var w=u.mgr;z.disablePU=true;var y=W(u,z,{success:function x(){u.state=l.DONE;},failure:function t(){w.onFailure();}});u.state=l.SILENT;w.dataService.submitUpdates(z,y,S);w.onSuccess(u);}function g(AE,z){var AD=AE.urInfo,AC=AD.puKeys,AJ=AD.puObjs,AA=AD.puFilters,AF=AE.mgr,AB=AF.model,AG=AF.dataService;if(AC||AJ){if(AC){z.partialRetrieval={nodes:AC,filters:AA};}if(AJ){AB.addUpdateObjects(z,AJ);}}else{z.disablePU=true;}var x=W(AE,z,{success:function AI(){AE.state=l.DONE;AF.onSuccess(AE);AB.restoreUIState(AE.action===f?AE.undoUIState:AE.redoUIState);},failure:function w(){AF.onFailure();},complete:function u(){AF.resetState();}}),t=AD.callback||AB.getRebuildCallback(),AH=I(t,x),y=R(AD.extras);if(z.act==="undo"&&y!==undefined){y.hideCancel=true;if(z.killJob){y.message=mstrmojo.desc(14586,"Canceling...");}}AE.state=l.BUSY;AG.submitUpdates(z,AH,y);}function N(x){var t=x.urInfo,u=x.mgr.model;if(!t.extras){var w=(t.treesToRender!==undefined)?t.treesToRender:x._treesFromRes;if(!t.disablePU&&!x._hasFullUpdate&&(!t.puKeys||!t.puKeys.length)){w=0;t.callback=I(u.getDatasetsUpdateCallback(),t.callback);}t.extras={style:{params:{treesToRender:w}}};}}mstrmojo.vi.controllers.UICmd=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmd",mgr:null,redoStateId:null,undoStateId:null,execute:mstrmojo.getMissingFn(),discard:mstrmojo.emptyFn,action:null,state:l.INTERIM,urInfo:null,getStateValue:function Q(u,t){return this.action===f?t:u;},init:function n(t){R(t,this);this._treesFromRes=0;this.urInfo=this.urInfo||{};this.submitCount=0;},undoRedo:function h(AA){var w=this,y,u=this.urInfo,t=u.silent,AB,x=this.mgr,z=x.dataService;if(w.action===a){y={act:"redo",stid:w.redoStateId};AB=u.redo;}else{if(w.action===f){y={act:"undo",stid:w.undoStateId,killJob:AA};AB=u.undo;}else{r(this.mgr);}}if(AB){z.blockRequests=true;try{t=!!AB.call(w)||t;}finally{z.blockRequests=false;}}if(t){E(w,y);}else{g(w,y);}},submitUpdate:function O(u,t){this.submit(u.actions,u.callback,u.extras,t);},submit:function M(y,AI,x,AG){var AD=this,AE=AD.mgr,AA=AE.model,AF=AE.dataService,AC=mstrmojo.array.ensureArray(y);AI=AI?R(AI):AA.getRebuildCallback();AD.state=l.BUSY;function z(AJ,AK){return !(AJ&&AJ[AK]&&AJ[AK].length);}if(AD._hasFullUpdate||AC.some(function(AJ){return AJ.disablePU;})||AC.every(function(AK){var AL=AK.partialRetrieval,AJ=AK.partialUpdate;return z(AL,"nodes")&&z(AJ,"nodes")&&z(AJ,"selectors")&&z(AJ,"objects");})){AD._hasFullUpdate=true;}m.override({submission:function w(){if(AD.submitCount===0){AD.undoStateId=AF.stid;}AD.submitCount++;},success:function AH(AN,AO){if(AD.action!==k){r(AE);}AD.redoStateId=AN.stid;var AM=!AG||AG===A.LAST;if(AM){AD.state=l.DONE;}else{AD.state=l.INTERIM;}var AL=AD.urInfo;if(!AL.disablePU){var AJ=AL.puKeys||[],AP=AN.pukeys&&AN.pukeys.split("\u001E");if(AP&&AP.length){AJ=AJ.concat(AP);var AK=AL.extraPuKeys;if(AK){AJ=AJ.concat(AK);delete AL.extraPuKeys;}}if(AJ.length){AL.puKeys=AJ;}}AD._treesFromRes|=(AN.defn?1:0)|(AN.data?2:0);if(this._super){this._super(AN,AO);}if(AM){AD.completeSubmit();}},failure:function u(AJ,AM){var AL=(x&&x.skipUICmdMgrOnFailure)||[],AK=parseInt(AJ.code||(AJ.getResponseHeader&&AJ.getResponseHeader("X-MSTR-TaskErrorCode"),10));if(AL.indexOf(AK)===-1&&AL.indexOf(mstrmojo.mstr.EnumWebAPIErrorCodes.E_UNUSED)===-1){AE.onFailure();}if(this._super){this._super(AJ,AM);}},canceled:function AB(AJ){if(this._super){this._super(AJ);}window.setTimeout(function(){AD.cancel(true);},0);},complete:function t(){if(!AG||AG===A.LAST){AE.resetState();}if(this._super){this._super();}}},AI);AF.submitUpdates(y,AI,x);},submitInterim:function p(u,w,t){this.submit(u,w,t,A.MIDDLE);},resetCmdMgrOnComplete:function o(){this._resetMgr=true;},completeSubmit:function K(){var u=this,w=u.mgr,t=w.model;if(!u.completed){u.completed=true;u.state=l.DONE;w.onSuccess(u);N(u);u.redoUIState=t.getUIState();if(u._resetMgr){w.reset();}}},cancel:function D(t){this.state=l.CANCELED;N(this);this.mgr.onCancel(this,t);},submitSilent:function s(w){var y=this,z=y.mgr,x=z.model,AA=z.dataService;y.state=l.SILENT;z.onSuccess(y);y.redoUIState=x.getUIState();var AB={submission:function u(){y.undoStateId=AA.stid;y.submitCount++;},success:function AC(AD){y.state=l.DONE;y.redoStateId=AD.stid;},failure:function t(){z.onFailure();}};AA.submitUpdates(w,AB,S);}});mstrmojo.vi.controllers.UICmd.CMD_PHASE=A;mstrmojo.vi.controllers.UICmd.STATES={BUSY:F,IDLE:U};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var h=1,S=2;var E=2,K=4,D=5;var V=1,N=4;var f=mstrmojo.array;function H(k,l){return k[((l===h)?"row":"col")];}function B(k,m){var l=m.lm;return l&&l[k.mix||0];}function b(l,q,x){var u=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:2,aopam:q.daMode});var r=q.ans,w=r&&r.length;if(w){var s=u.prms=[],m=0;for(m=0;m<w;m++){var AB=r[m];var n=AB.pid,p=parseInt(AB.m,10),AA={id:n,am:p,pt:AB.pt};s.push(AA);if(AB.po){AA.orid=AB.po.did;AA.ortp=AB.po.t;}switch(p){case u.DO_NOT_ANSWER:case u.CLOSE:case u.USE_DEFAULT_ANSWER:case u.SAME_PROMPT:break;case u.STATIC:var k=AB.es,y=(k&&k.length)||0,t;AA.pa={es:[]};for(t=y-1;t>=0;--t){var o=k[t];AA.pa.es.push({ei:o.id,disp_n:o.n,emt:1});}break;case u.DYNAMIC:case u.ALL_VALID_UNITS:case u.CURRENT_UNIT:case u.DYNAMIC_OR_SAME_PROMPT:if(x.els){A.call(this,AB,x,AA,p,u);}else{J.call(this,AB,x,AA,p,u);}break;}}}return u;}function A(r,l,k,q,p){var o=r.dunits,m=l.els,n=k.pa={};f.forEach(m,function(s){if(f.find(o,"id",s.id)>=0){if(q!==p.DYNAMIC&&q!==p.DYNAMIC_OR_SAME_PROMPT){n.a={id:s.id,n:s.disp_n,dispForms:s.dfi};}if(r.pt===1){n.v=s.v;}else{n.es=[];n.es.push({ei:s.ei,emt:s.emt,disp_n:s.disp_n});}}});}function J(y,t,x,o,q,p){var r=y.dunits;if(r&&r.length&&t){var s=x.pa={};var n=t,m=(t.mix!==undefined)&&(t._lp||t._tp);if(m){n=t._lp||t._tp;}var l=parseInt(n.axis,10);while(n){var u=this.getPTitle(n,l);if(u&&f.find(r,"id",u.id)>=0){if(o!==q.DYNAMIC&&o!==q.DYNAMIC_OR_SAME_PROMPT){s.a={id:u.id,n:u.n,dispForms:u.dfi};}if(y.pt===1){s.v=n.v;break;}else{var k=n._e.id,w=n._e.n;s.es=[];s.es.push({ei:k,emt:1,disp_n:w});}if(o===q.CURRENT_UNIT){break;}}n=this.getPCellParentNode(n,l);if(m&&!n&&l===h){l=S;n=t._tp;}}}}function Q(m){var l=this.getCellTitleInfo(m[0]),o=[],q=function(r){if(r){if(mstrApp.useBinaryFormat){if(r._e){o.push(r.axis+"A"+(r.ui+1)+"A"+r._e.id);}q(r._p);}else{o.push(r.axis+"A"+(r.ui+1)+"A"+r.o);}}},n,k;if(!l.isSrcTitle){for(n=0,k=m.length;n<k;n++){var p=m[n];if(p.mix!==undefined&&(p._lp||p._tp)){q(p._lp);q(p._tp);}else{q(p);}}}return(mstrApp.useBinaryFormat)?o:o.join(",");}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function R(){return this.data.mid;},getCellTitleInfo:function c(l,o){var m=o?o.gts:this.data.gts;var n=null;if(l&&l.mix===undefined){n=H(m,l.axis)[l.tui||l.ui];}else{var k=function(r){var p=(r&&r.length)||0,q;for(q=p-1;q>=0;--q){if(parseInt(r[q].otp,10)===-1){return r[q];}}return null;};n=k(m.col)||k(m.row);}return{isSrcTitle:!!l&&(l.o===undefined)&&!((l.mix!==undefined)&&(l._lp||l._tp)),title:n};},getCellInfo:function I(l){var k=this.getCellTitleInfo(l),m={isTitle:false,isHeader:false,isMetric:false};if(l&&(l.hasOwnProperty("mix")||l.otp===-1)){m.isMetric=true;if(l._e){m.isHeader=true;}}if(k.isSrcTitle){m.isTitle=true;}return m;},getCellLinksInfo:function e(l,m){if(!m){var k=this.getCellTitleInfo(l);m=k&&k.title;}return B(l,m);},getAllDrillPathsForCell:function Z(l,m){if(!m){var k=this.getCellTitleInfo(l);m=k&&k.title;}return m.dp||[];},getCellDrillsInfo:function G(k,m){var l=this.getAllDrillPathsForCell(k,m);return l&&l[k.mix||0];},getLinkDrillAction:function O(k){return this.getActionObject(k);},getAction:function U(k){return this.getActionObject(k);},getActionObject:function L(l){var k=l[0]&&l[0].at,m=null;if(k){if((k&N)>0){m={h:"onLink",a:this.getLinkAction(l[0])};}else{if((k&V)>0){m={h:"onDrill",a:this.getDrillAction(l)};}}}return m;},getSortAction:function F(z,s){var o=this.getCellTitleInfo(z),w=o.title,y=this.data.gts[((z.axis===h)?"row":"col")+"SubPos"],l=[],n=w.axis,q,u,t,x,AA;s=(s===null||s===undefined)?!(z&&z.so):s;if(o.isSrcTitle){q=E;u=w.id;t=w.otp;x=w.fid;}else{q=K;t=4;n=f.find(this.data.gts.col,"otp",-1)>-1?h:S;y=this.data.gts.rowSubPos;AA=w.stt;var r,k;do{r=z._e;if(r){if(r.oid){u=r.oid;}else{k=r.id.replace(/;/g,"\\;");l.push(k);}}z=z._p;}while(z);}var p={sortType:q,axis:n,isAsc:s,unitID:u,unitType:t,elementList:l.join(";"),subTotalsPos:y};if(u){p.unitID=u;}if(x){p.formId=x;}if(AA){p.sortType=D;p.stt=AA;}var m;if((q===K)||(q===D)){m=["","",p.elementList||"",p.axis];}else{m=[p.formId,"21","",p.axis];}m=[p.unitType,p.unitID].concat(m);p.sortKey=m.join("!");return p;},getSubTotalsPos:function X(){var k=this.data.gts;if(k){return[k.rowSubPos,k.colSubPos];}return[0,0];},getPivotAction:function M(y,m){var w=false,z=y.hasOwnProperty("mix"),k=z?null:y.axis,x=(z?y.idx:y.ui)+1,l=(y.otp===-1);if(!isNaN(m)){k=parseInt(m,10);x=1;if(z){z=false;l=true;}}else{var q=(m==="u"||m==="l"||m==="b");if(!z){var p=H(this.data.gts,k),o=0,n={},s=false;mstrmojo.array.forEach(p,function(AA){if(n[AA.id]){n[AA.id].frm++;}else{o++;n[AA.id]={pos:o,frm:1};if(AA.id===y.id){s=true;}else{if(s){return false;}}}});x=n[y.id].pos;var t=y.fix;if(t){if(!q||t>1){if(q||t!==n[y.id].frm){x=t;w=true;}}}}if(m==="b"){x=1;}else{x=x+(q?-1:1);}}var r={act:"pivot",unitPos:x};if(w){r.attFormId=y.fid;}else{if(!z){r.axis=k;}}if(!l){var u=z?y._e:y;if(!w){r.unitType=u.otp;}r.unitId=z?u.oid:y.id;}return r;},isPvtButtonVisible:function d(r,m){var o=r.axis,n=H(this.data.gts,o),q=r.ui,l=r.hasOwnProperty("mix");if(m==="b"&&q===0){return false;}if(!isNaN(m)){if(parseInt(m,10)===o){return false;}if(l){return !!n[r.ui]._hid;}return true;}var p=n[r.ui].es,k=l?p.length:n.length;if(k===1){return false;}if(o===(l?S:h)){if(m==="u"||m==="d"){return false;}}else{if(m==="l"||m==="r"){return false;}}if(l?r._e===p[0]:q===0){if(m==="l"||m==="u"){return false;}}if(l?r._e===p[k-1]:q===k-1){if(m==="r"||m==="d"){return false;}}return true;},getDrillAction:function C(k,m){var l=m||this.getCellDrillsInfo(k[0]);return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,isWithin:l.within,drillPathKey:l.k,drillPathIndex:l.dpi,drillElements:Q.call(this,k)};},isVis:function a(){if(this.xtab){return this.xtab.isVis&&this.xtab.isVis();}else{var k=this.controller&&this.controller.view;if(k&&k.isVis){return k.isVis();}}return false;},getPTitle:function g(m,l){var k;if(this.isVis()){k=m.titleInfo;}else{k=H(this.data.gts,l)[m.tui];}return k;},getPCellParentNode:function P(m,l){var k;if(this.isVis()){k=(l==h)?m._lp:m._tp;}else{k=m._p;}return k;},getLinkAction:function T(m,l){var k,n;if(this.isVis()){m=m.node;n=m.titleInfo;}else{k=this.getCellTitleInfo(m);n=k.title;}return this.getLinkActionImpl(m,n,l);},getLinkActionImpl:function Y(x,s,u){var m=B(x,s),t=m&&m.links,y=(m&&m.onw)?"_blank":"";if(u===null||u===undefined){u=(m&&m.di)||0;}var p=t&&t[u];if(!p){return null;}var n={linkInfo:p,linkTarget:y};var k=p.url;if(k){var o="&CurrentElement";if(x&&s&&k.indexOf(o)>-1){k=k.replace(o,x._e.id);}n.url=k;}else{var q=p.target,w,l;switch(parseInt(q&&q.t,10)){case 55:if(parseInt(q.st,10)===14081){if(q.dvm&(8192|2048)&&!((q.dvm&2048&&mstrApp.features["run-vi-flash"]))){w=3140;if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(12187,"To work with HTML5 dashboards, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}}else{w=2048001;}l="objectID";}else{w=32001;l="documentID";}break;case 3:w=4001;l="reportID";n.reportViewMode=((parseInt(q.st,10)===769)?2:1);break;default:return null;}n.evt=w;n[l]=q.did;n.srcMsgId=this.getMessageId();var r=b.call(this,m,p,x);if(r){n.link=r;}return n;}},getDownloadAction:function W(n,l,p,m,o,k){return{xtabId:o,rowPosition:n,maxRows:l,colPosition:p,maxColumns:m,memo:k};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.elementHelper");var r="Metrics",E=2,Z=mstrmojo.array,H=mstrmojo.hash,T=mstrmojo.elementHelper;function P(AE){if(!AE){return false;}var AC=this.scm,y="\u001E",AA,x,AB,z,w,AD=false;for(x in AC){AB=AC[x];z=AB.cgb;for(AA in z){w=AE[z[AA]];if(w){if(!AB.tks){AB.tks=w;AD=true;}else{if(AB.tks&&(AB.tks.indexOf(w)<0)){AB.tks+=y+w;AD=true;}}}}}return AD;}function d(){var x=this.data,w=x.gts;if(!w){return ;}var y;Z.forEach([w.row,w.col],function(z){Z.forEach(z,function(AA){if(AA.sc){y=y||{};y[AA.id||r]=AA.sc;if(AA.fid){y[AA.id+"_"+AA.fid]=AA.sc;}}});});this.scm=y;P.call(this,this.docModel.getCGBMap());}function u(w,x){var y=this.getDataService();y[w].apply(y,x);}function R(AC,AD,AL){var AB=AD||T.getIdPresentation(AC),AK,AI;switch(AB){case"terse":case"terseLong":AK=AC.substring(1,AC.length).split(";");return"h"+AK[0]+";"+AK[1]+(AL?";"+AL:"");case"old":AC=AC.replace(/\*:/g,"*COLON*");AK=AC.split(":");return("h"+AK[1]+(AK[2]?":"+AK[2]:"")+";"+AK[0]+(AL?";"+AL:"")).replace(/\*COLON\*/g,"*:");case"oldLong":var AF=0,w,AJ,AH=[],AE=[],AA,z,y,AG=function AG(){if(AF<0){return null;}var AO=false,AM=-1,AP,AN=null;for(AA=AF;AA<AC.length;AA++){AP=AC.charAt(AA);if(AP==="*"&&!AO){AO=true;}else{if(AP===":"&&!AO){AM=AA;break;}else{AO=false;}}}if(AM===-1){AN=AC.substring(AF);AF=-1;}else{AN=AC.substring(AF,AM);AF=AM+1;}return AN;};y=AG();if(y!=="BB"&&y!=="BF"){return AC;}AI=AG();if(y==="BF"){AI=AG();}w=parseInt(AG(),10);AJ=parseInt(AG(),10);for(z=0;z<AJ;z++){AE[z]=parseInt(AG(),10);AG();}for(z=0;z<AJ;z++){var x=AG();if(AE[z]<w&&AE[z]>=0){AH[AE[z]]=x;}}return"h"+AH.join(":")+";"+AI+(AL?";"+AL:"");}return AC;}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function n(w){this._super(w);var x=this;this.docModel.attachEventListener("CGBMapChange",this.id,function(y){if(x.xtab.onCBGMapChange){x.xtab.onCGBMapChange(y);}});},ondataChange:function g(){d.call(this);},getMessageId:function F(){return this.docModel.mid;},getDataService:function G(){return this.docModel.getDataService();},getAction:function X(AK,AA,AF){var AI=AK[0],x=AI&&AI.at;var z;if(x){if((x&E)>0){var y=this.getCellTitleInfo(AI),AG=y&&y.title,w=AG&&AG.id,AH=this.scm;this.sti={titleId:w||r};var AE=(w&&AH[w])||AH[r],AD=function(){var AL=[];Z.forEach(AK,function(AM){if(AM._e&&AM._e.id){AL.push(AM._e.id);}});return AL.join("\u001E");};if(AE){var AJ=this.xtab,AB=(AJ.allowToggleSelections&&AE.all&&AF),AC=(y.isSrcTitle||AB);this.sti.deselectCurrent=AB;z={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:AA,ck:AE.ck,tks:AE.tks,eid:AC?"OA:(All)":AD(),ctlKey:AE.ckey,sliceId:AJ.sid,isUConDS:AE.isUConDS,ifw:AE.ifw}};}}}if(!z){z=this._super(AK);}if(z&&z.a){z.a.sliceId=this.xtab.sid;}return z;},getDownloadAction:function l(AA,y,AC,z,AB,x,w){var AD=this._super(AA,y,AC,z,AB,x);AD.sliceId=this.xtab.sid;if(w&&w.name==="TransactionUpdates"){if(AD.partialUpdate){if(AD.partialUpdate.selectors){AD.partialUpdate.selectors.push(w.ctlKey);}else{AD.partialUpdate.selectors=[w.ctlKey];}}else{AD.partialUpdate={selectors:[w.ctlKey]};}}return AD;},getDrillAction:function f(x,z){var y=this._super(x,z),w=this.getCellTitleInfo(x[0]);if(y&&y.isWithin){y.attrObj=w.title;}y.srcMsgId=this.docModel.mid;return y;},sort:function p(x,y){var w=this.xtab;x.stp=x.stp||this.getSubTotalsPos();x.subTotalsPos=x.stp;x.nodeKey=w.k;x.treeType=w.treeType||1;u.call(this,"sortGrid",arguments);},getAdvSortData:function Q(w,x){u.call(this,"getAdvSortData",arguments);},pivot:function I(w,x){u.call(this,"pivot",arguments);},removeUnit:function O(w,x){u.call(this,"removeUnit",arguments);},getTotalsAction:function J(w,z,x){var y=this.getPivotAction(w);y.act="showTotals";y.subtotalType=z;y.clearSubtotalType=x;return y;},getRemoveAxisTotalsAction:function b(x,w){return{act:"removeAxisTotals",axis:w,subtotalType:x};},showTotals:function B(w,x){u.call(this,"showTotals",arguments);},drillGrid:function W(w,x){u.call(this,"drillGrid",arguments);},downloadGridData:function c(w,x){u.call(this,"downloadGridData",arguments);},loadLayout:function a(w){this.docModel.loadLayout(w);},resizeXtabColumn:function L(w,x){u.call(this,"resizeXtabColumn",arguments);},submitTemplateActions:function o(w,x,y){u.call(this,"submitTemplateUpdates",arguments);},getDerivedMetricAction:function h(w,x){return{did:w._e.oid,um:w.um,alias:w._e.n,n:w._e.n,v:w.um?w.formula:w._e.v,mix:w.mix,cmd:x,model:this};},getAddTemplateUnitAction:function C(AA,AC,y,w){var x=AA.t,AB=this.data.gsi,z={act:"addUnit",unitId:AA.did,unitType:x,unitPos:++w,dsId:AC,isFirst:!AB||(AB.cols.length===0&&AB.rows.length===0)};if(x!==4||!AB||!AB.mx.length){z.axis=y;}return z;},getRemoveTemplateUnitAction:function m(w){return{act:"removeUnit",unitId:w.did||w.id,unitType:w.t||4};},getRenameTemplateUnitAction:function m(AA,y,w,x){var z={act:"renameUnit",id:AA,type:y,name:w};if(x){z.isDynamicAlias=true;}return z;},doesNameExistOnTemplate:function A(y,AC,AA,x){var AB=y.node.data.gsi,w=AA===4,z=w?AB.mx:AB.rows.concat(AB.cols);return z.some(function(AD){return AD.did!==AC&&(w||AD.t===AA)&&AD.n===x;});},getPivotUnitAction:function M(y,w,z,x){w++;return{act:"pivot",unitId:String(z||""),unitType:x||"",axis:y,unitPos:w};},getShowTotalsUnitAction:function U(z,x,y,w){return{act:"showTotals",unitId:String(z||""),unitType:x||"",subtotalType:y,clearSubtotalType:w};},getSortGridAction:function q(z,x,y,w){return{sortKey:x,subTotalsPos:z,axis:y,isAsc:w};},getColumnResizeAction:function N(z,w,x,y,AA){return{act:"changeXtabColumnWidth",unitId:z,unitType:w,width:x||0,depth:y||1,ec:AA};},getNormalizedFormElementId:function t(x,w){return R(x,null,w);},compareNormalizedElementsId:function k(x,w){if(x===w){return true;}else{if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}if(T.isAttributeIdsLinked(T.getAttributeId(x),T.getAttributeId(w),this.docModel.als&&this.docModel.als.idLinks||{})){return T.getElementValue(x)===T.getElementValue(w);}}return false;},compareElementsId:function S(AA,z){if(!this.docModel.als){return this.compareElementsIdInSingleGrid(AA,z);}var y=T.getIdPresentation(AA),x=T.getIdPresentation(z),w=R(AA,y),AB=R(z,x);return this.compareNormalizedElementsId(w,AB);},compareElementsIdInSingleGrid:function Y(z,y){var x=T.getIdPresentation(z),w=T.getIdPresentation(y);if(x!==w||x==="oldLong"||x==="terseLong"){return R(z,x)===R(y,w);}return z===y;},getLinkedAttributes:function e(w){var x=[],y;if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}y=this.docModel.als&&this.docModel.als.idLinks||{};return y[w];},getCellDataUnion:function V(y){var z=this,x=y.hasOwnProperty("mix"),AA=[],AB,w=function w(AD){var AC=z.getCellTitleInfo(AD),AF=AC.title,AE=AF&&AF.id;if(AE){AB={};if(AD.stt){AB.isSubtotal=true;}AA.push(H.copy(AB,{tid:AE,eid:AD._e&&AD._e.id,v:AD.v}));}};if(y){if(!x){w(y);}else{Z.forEach([y._lp,y._tp],function(AC){var AD=AC;while(AD&&AD!==AD._p){w(AD);AD=AD._p;}});}}return AA;},getObjectInfo:function D(w){var x;Z.forEach((this.data.gsi.cols||[]).concat(this.data.gsi.rows||[]),function(y){if(y.did===w){x=y;}});return x;},supportsViewFilterActions:function K(w){if(this.data&&this.data.gsi){var x=this.getObjectInfo(w);return x&&!x.de&&(x.t!==1)&&(x.t!==47||x.st===12033);}return false;},getSelectorControlMapInfo:function s(){var x=[],z=this.data.gsi,y=[],w;if(this.scm){H.forEach(z,function(AA){if(AA instanceof Array){y=y.concat(AA);}});H.forEach(this.scm,function(AB,AA){w=Z.find(y,"did",AA);if(w!==-1){x.push({did:AA,n:y[w].n,sc:AB});}});}return x;},getShowDefinedSubtotalsAction:function(){return{act:"showDefinedSubtotals"};}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr");var R=mstrmojo.func,N=mstrmojo.hash,K=mstrmojo.array,H=mstrmojo.vi.controllers.UICmd.STATES,F={SHARED:0,SEPARATE:1},I={AND:19,OR:20},X=function X(b,a){var Y={},Z=function(e,d){var c=[];if(!d){return e;}K.forEach((d||[]),function(f){c.push(f);});K.forEach((e||[]),function(g){var f=K.find(d,"id",g.id);if(!~f){c.push(g);}});return c;};N.forEach(a,function(c,d){Y[d]=c;});N.forEach(b,function(c,d){Y[d]=Z(c,a[d]);});return Y;},D=function D(Y){var Z=[];N.forEach(Y,function(a){Z.push({ft:I.AND,d:a});});return Z;},G=function(Z){var Y={},a=function(b){var c=N.keyarray(b)[0];return{id:c,d:b[c][0]};};N.forEach(Z,function(e){var d={},b=a(e),c=d[b.id];if(b.id){if(!c){d[b.id]=c=[];}c.push(b.d);}Y=X(Y,d);},this);return[{ft:I.OR,d:Y}];},C=function C(e){var a=this.model,d,c=[],Z=this.getSelectionType(),Y=mstrmojo.vi.ui.rw.SelectionType,f=true,b=false;if(!N.isEmpty(e)){if(Z===Y.METRICS){d=D.call(this,e);}else{d=G.call(this,e);}}N.forEach(d,function(g){f=false;var h=[];N.forEach(g.d,function(k,o){if(a.supportsViewFilterActions(o)){b=true;var l=[],n={id:o,elems:l},m=a.getObjectInfo(o);if(m){n.t=m.t;n.st=m.st;if(m.st===12033){n.attId=m.attId;}}K.forEach((k||[]),function(p){l.push(p.id);});h.push(n);}});if(h.length){c.push({ft:g.ft,d:h});}});c.hasElements=b;c.clearSelections=f;return c;},U=function U(b){var c=this.selectorControl,Z,Y,a=this;if(c){if(b.clearSelections||b.hasElements){Z=this.controller;c.exp=null;if(Z.onGridSelector){Y=function(){Z.onGridSelector(a,{type:mstrmojo.EnumRWUnitType.GRID,ck:c.ck,tks:c.tks,ctlKey:c.ckey,sliceId:this.sid,isUConDS:c.isUConDS,ct:c.ct,selections:b});};if(this.multiUnitCtrlInterval){window.clearInterval(this.multiUnitCtrlInterval);this.multiUnitCtrlInterval=null;}if(Z.cmdMgr.state===H.BUSY){this.multiUnitCtrlInterval=window.setInterval(function(){if(Z.cmdMgr.state!==H.BUSY){window.clearInterval(a.multiUnitCtrlInterval);if(!a.destroyed){a.multiUnitCtrlInterval=null;Y();}}},1000);}else{Y();}}}}},B=function B(a){var Y={type:mstrmojo.vi.ui.rw.SelectionType.ATTS,data:a},Z=function(b,c){if(parseInt(b.fn,10)===22&&parseInt(c,10)===19){Y.type=mstrmojo.vi.ui.rw.SelectionType.METRICS;}K.forEach((b.nds||[]),function(d){Z(d,b.fn);});};Z(a,null);return Y;},V=function V(){return this.parent.model.getCurrentLayoutDef().cgbMap;},J=function J(){var Y=V.call(this),Z=[];N.forEach(Y,function(b,a){if(this.k===b){Z.push(a);}},this);return Z;},W=function W(){var Y=this.controller&&this.controller.cmdMgr;if(Y&&Y.isUndoRedo()){return true;}return false;};mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",selectorControl:null,multiUnitCtrlInterval:null,postBuildRendering:function S(){this._super&&this._super();var Y=this.findSelectorControl();if(W.call(this)){this.clearSelections();}if(Y&&!N.isEmpty(Y.exp)&&this.addSelectionsFromExpression){this.addSelectionsFromExpression(B(Y.exp));if(this.highlight){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}},findSelectorControl:function Q(){if(this._super){return this._super();}else{this.throwAbstractMethodError("findSelectorControl");}},handlesMultiSelection:function E(Y){return(this._super&&this._super(Y))||!!this.selectorControl;},onSelectionChange:function L(Z){var b=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),a=false;if(this._super){a=this._super(Z);}if(b.length>0){this.singleUnitSelect();a=true;}else{if(!!this.selectorControl){var Y=C.call(this,Z);U.call(this,Y);return true;}}return a;},singleUnitSelect:function A(){if(this._super){this._super();}},clearAllSelections:function P(){return this.selectorControl&&this.selectorControl.showall;},onClearBrushing:function T(Y){if(this.selectorControl){return true;}if(this._super){return this._super(Y);}return false;},getFilterType:function M(){return this.defn.ins||F.SHARED;},switchFilterType:function O(k){var f=this,h,g=f.getFilterType(),d=f.parent.model,c,b={actions:[]},l,a=V.call(f),Y,e=false;if(g!==k){h=J.call(f);if(h.length>0&&g===F.SHARED){l=h[0];c=d.getSourceControls(f.parent,l);K.forEach(c,function(n,o){if(o!==0){Y=d.getNextKey();a[Y]=f.k;b.actions.push(d.redoFilterAssociations(true,n.control.ckey,n.sourceKey,f.k,l,Y));e=true;}}.bind(f));}else{var Z;K.forEach(h,function(n,o){c=d.getSourceControls(f.parent,n);if(o===0){Z=n;}else{delete a[n];b.actions.push(d.redoFilterAssociations(false,c[0].control.ckey,c[0].sourceKey,f.k,n,Z));e=true;}}.bind(f));}b.actions.push(d.getUnitFormatAction(f,1,{FormattingSelector:{IndependentNodeSelector:k}},true));var m=false;b.callback=({success:function(){f.defn.ins=m?g:k;m=!m;}});if(e){b.callback=R.wrapMethods(b.callback,d.getRebuildCallback());}}b.extras={style:{params:{treesToRender:3}}};return b;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasEditableText","mstrmojo.css");var B=mstrmojo.css;mstrmojo.EditableLabel=mstrmojo.declare(mstrmojo.Label,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.EditableLabel",autoApplyDelay:-1,markupString:'<div id="{@id}" class="mstrmojo-EditableLabel {@cssClass}" title="{@title}" contenteditable="{@isEditing}" style="{@cssText}" mstrAttach:click,mousedown,blur,keydown,keyup></div>',onkeyup:function C(D){this._super(D);if(this._autoApplyTimer){window.clearTimeout(this._autoApplyTimer);}if(this.autoApplyDelay!==-1){var E=this;this._autoApplyTimer=window.setTimeout(function(){E.set("isEditing",false);},this.autoApplyDelay);}},selectable:true});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.EditableLabel,{onselectableChange:function A(){var E=this[this.editableSlot],D=!!this.selectable;E.selectable=D;E.setAttribute("unselectable",!D?"on":"off");B.toggleClass(E,"unselectable",!D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.dom,B=mstrmojo.css,D=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span>"+D+"</div></div>",getPrefixAndOrToolsMarkup:function(){return(D+this._super());},markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},createSetNode:function(){return this.domNode.childNodes[1].lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){B.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noRelation);},onnoCreateSetChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noCreateSet);}},mstrmojo.hash.copy(mstrmojo.ConditionNode.prototype.markupMethods)),init:function(E){if(this._super){this._super(E);}var F=this.data&&this.data.et;if(F){this.set("noCreateSet",F===10||F===12);}},preclick:function C(E){var H=null,G=A.eventTarget(E.hWin,E.e),F=this._super(E);if(A.contains(this.createSetOptNode,G,true)&&!this.noRelationOperator&&!this.noRelation){H="createSetOpt";}else{if(A.contains(this.createSetNode,G,true)&&!this.noRelation){H="createSet";}else{if(A.contains(this.addConditionNode,G,true)){H="addCondition";}}}E.part=H||E.part;return F;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.Button","mstrmojo.dom","mstrmojo.Container");mstrmojo.requiresDescs(1442,2140);var C=mstrmojo.dom;mstrmojo.ui.menus.ToolbarEditor=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._IsMenuPopup,mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.menus.ToolbarEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-ToolbarEditor mstrmojo-ui-MenuEditor {@cssClass}" style="..." mstrAttach:mouseover,mouseout,click><div class="te-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},popupConfig:null,children:null,autoCloses:false,locksHover:true,visible:true,onclick:function B(E){C.stopPropogation(null,E.e);},init:function D(F){this._super(F);var E=this.popupConfig,G=E.contents;if(!G){throw new Error("Cannot open editor without editor content.");}this.cssClass=E.cssClass;this.addChildren(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton mstrButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton mstrButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.ui._HasScroller");var L=mstrmojo.boxmodel,I=mstrmojo.dom,M=mstrmojo.css,O="mstrmojo-Tooltip",A="mstrmojo-scrollNode",E=20;function C(S,T,R){var U="connectScrollbox";if(R){U="dis"+U;}var Q=S&&S.parent;while(Q){if(Q[U]){Q[U](T);}Q=Q.parent;}}function G(){if(!this._paintHandle){var R=this.id,Q=function(V){var Z=mstrmojo.all[R];if(!Z){return ;}delete Z._paintHandle;var T=[O],a=Z.cssClass;if(a){T.push(a);}var S=mstrApp.getThemeClassName&&mstrApp.getThemeClassName(),X=Z.opener;if(X&&X.getTooltipThemeClass){S=X.getTooltipThemeClass();}T.push(S);Z.domNode.className=T.join(" ");var Y=Z.content,U=Z.contentNode,W=Z.arrowNode;U.className=(O+"-content "+A+" "+Z.contentNodeCssClass);U.style.cssText=Z.contentNodeCssText;U.innerHTML=Y;W.style.cssText="";Z.domNode.style.visibility=!!Y?"visible":"hidden";Z.updatePosition();if(!V&&Z.optimizePos){Z.optimizePos();}Z.updateScrollbars();};if(!this._hasPaint){Q(true);this._hasPaint=true;}else{this._paintHandle=window.setTimeout(Q,0);}}}function B(h,c,a,Y){var T=c&&(c.richTooltip||c.tooltip),f=a?I.getMousePosition(a,Y||self):null,Q=T&&(typeof T==="string");var U="",g="",d="",Z=T,X=null,W=mstrmojo.tooltip.POS_TOPLEFT,S=null,b=null;var V=false,R=false;if(T&&!Q){g=T.cssClass||g;U=T.contentNodeCssClass||U;d=T.contentNodeCssText||d;Z=T.content||"";X=T.refNode||X;W=T.posType||W;S=T.left||0;b=T.top||0;V=T.keepArrowXPos||V;R=T.keepArrowYPos||R;}h.set("contentNodeCssClass",U);h.set("cssClass",g);h.set("contentNodeCssText",d);h.set("content",Z);h.set("refNode",X);h.set("posType",W);h.set("left",Q?((f&&f.x)||h.left):S);h.set("top",(Q||!T)?((f&&(f.y+E))||h.top):b);h.set("keepArrowXPos",V);h.set("keepArrowYPos",R);}mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,keepArrowXPos:false,keepArrowYPos:false,posType:"TL",markupString:'<div id="{@id}" class="'+O+' {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout><div class="'+O+'-shadow {@shadowNodeCssClass}"></div><div class="'+O+'-contentWrapper"><div class="'+O+"-content "+A+' {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div><div class="'+O+'-arrow"></div></div>',markupSlots:{containerNode:function(){return this.domNode.children[1];},contentNode:function(){return this.domNode.children[1].firstChild;},shadowNode:function(){return this.domNode.firstChild;},arrowNode:function(){return this.domNode.children[2];}},setupScrollNodes:function D(){this.scrollNode=this.contentNode;this.scrollbarHostNode=this.containerNode;},_previousVisible:false,markupMethods:{onvisibleChange:function(){var R=this.domNode.style,Q=!!this.visible;if(this._previousVisible!==Q){R.visibility="hidden";}R.display=Q?"block":"none";this._previousVisible=Q;if(Q){this.updatePosition();if(this.content){G.call(this);}}},onleftChange:G,ontopChange:G,onrefNodeChange:G,onposTypeChange:G,oncontentNodeCssClassChange:G,oncontentNodeCssTextChange:G,oncontentChange:G,oncssClassChange:G},preBuildRendering:function N(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}return this._super();},updatePosition:function H(V){if(!this.visible&&!V){return ;}var U=this.refNode,T=U?L.offset(U,document.body):{left:I.getHorizontalScroll(),top:I.getVerticalScroll()},m=this.domNode.style,e=this.containerNode,g=e.offsetWidth,Y=e.offsetHeight,R=this.posType,b=R.indexOf("R")>-1,W=R.indexOf("B")>-1,a=this.top!==null?parseInt(this.top,10)+T.top-(W?Y:0):null,S=this.left!==null?parseInt(this.left,10)+T.left-(b?g:((R.indexOf("C")>-1)?Math.floor(g/2):0)):null,k=false,Z=false,c,X,h=I.windowDim(),f=I.getHorizontalScroll()+h.w,Q=I.getVerticalScroll()+h.h,d=this.arrowNode,l=null;if(S!==null){c=Math.min(Math.max(S,0),f-g);m.left=c+"px";k=S!==c;}if(a!==null){X=Math.min(Math.max(a,0),Q-Y);m.top=X+"px";Z=a!==X;}if(k||Z){if((this.keepArrowXPos&&k)||(this.keepArrowYPos&&Z)){l=M.getComputedStyle(d);}if(this.keepArrowXPos&&k){d.style.left=(parseInt(l.left,10)+S-c)+"px";}if(this.keepArrowYPos&&Z){d.style.top=(parseInt(l.top,10)+a-X)+"px";}}M.toggleClass(this.domNode,"offset",k||Z);},_on_tooltip_change:function(Q){B(this,Q&&Q.src);},_set_opener:function(T,S){var R=this.opener,Q=S!==R;if(Q){if(S){C(S,this);}if(R){C(S,this,true);}if(R&&R.detachEventListener){R.detachEventListener(this._richSubs);R.detachEventListener(this._ttpSubs);}if(S&&S.attachEventListener){this._richSubs=S.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=S.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=S;}return Q;},updatePopupConfig:function(Q,R){B(this,R,Q&&Q.e,Q&&Q.win);},onscroll:function K(){if(this.visible&&this.nudge){this.nudge();}this._super();},onmouseover:mstrmojo.emptyFn,onmouseout:mstrmojo.emptyFn});var J=null;mstrmojo.tooltip={POS_TOPLEFT:"TL",POS_BOTTOMLEFT:"BL",POS_TOPRIGHT:"TR",POS_BOTTOMRIGHT:"BR",POS_BOTTOMCENTER:"BC",POS_TOPCENTER:"TC",open:function F(R,T,S,Q){if(!J||!mstrmojo.all[J.id]){J=new mstrmojo.Tooltip();}Q=Q||{};Q.e=T;Q.win=S;J.open(R,Q);R.tooltip=J;},close:function P(){if(J){if(J.opener){J.opener.tooltip=null;}J.close();}}};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo._IsPopup","mstrmojo._CanAutoClose");var C=mstrmojo.dom;mstrmojo.ui.PopupWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.PopupWidget",markupString:'<div id="{@id}" class="mstrmojo-ui-PopupWidget {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="pw-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},autoCloses:true,locksHover:true,closeOnClick:true,visible:true,onclick:function B(D){C.stopPropogation(null,D.e);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var B=mstrmojo.func,C=mstrmojo.dom,F="mstrmojo-popup-widget-hosted";mstrmojo.ui.PopupButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ui.PopupButton",onPopupWidgetClosed:mstrmojo.emptyFn,onPopupWidgetOpened:mstrmojo.emptyFn,anchorSlot:"domNode",isHostedWithin:true,hostedCSSClass:"",destroy:function H(L){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(L);},getPopupWidget:mstrmojo.emptyFn,postCreateChildren:function D(){var L=this.getPopupWidget();if(!L||L._pbCfg){return ;}var M=function M(O,N){return function(){O.apply(N,arguments);};};L.onOpen=B.composite([M(this.onPopupWidgetOpened,this),L.onOpen||mstrmojo.emptyFn]);L.onClose=B.composite([M(this.onPopupWidgetClosed,this),L.onClose||mstrmojo.emptyFn]);L._pbCfg=true;},onclick:function K(L){var N=L.getTarget();if(N===this[this.anchorSlot]||N.parentNode===this[this.anchorSlot]){var M=this.getPopupWidget();if(!M.visible){this.openPopup(M);}else{this.closePopup();}}},onPopupAutoClosed:function I(M,L){if(C.contains(this[this.anchorSlot],C.eventTarget(L,M),true)){return false;}},getPopupHostNode:function J(){return this.containerNode;},getPopupConfig:function G(){var M=[F],L=this.hostedCSSClass;if(L){M.push(L);}return new mstrmojo.ui.PopupConfig({hostId:this.id,hostElement:this.getPopupHostNode(),anchorElement:this[this.anchorSlot],isHostedWithin:this.isHostedWithin,hostProxyCssClass:M.join(" ")});},unrender:function E(L){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);delete this._listenerProc;}this._super(L);},postBuildRendering:function A(){var P=this.getPopupWidget();if(P){var R=this.getPopupConfig();if(!R.isHostedWithin){var N=this.parent||this.opener,M=R.hostProxyCssClass.split(" ");M.push(this.domNode.className);while(N){var Q=N.themeClassName;if(Q){M.push(Q);break;}N=N.parent||N.opener;}R.hostProxyCssClass=M.join(" ");}P.popupConfig=P.addDisposable(R);}var L=P.id,O=this._listenerProc=function(){var S=mstrmojo.all[L];if(S&&S.visible&&S.adjustCornersForPopupOverflow){S.adjustCornersForPopupOverflow();}};if(this.isHostedWithin===false){C.attachEvent(window,"resize",O);}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var M=mstrmojo.Widget,G=mstrmojo.dom,N=mstrmojo.global.document,C=50,B=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:M.visibleMarkupMethod,onheightChange:M.heightMarkupMethod,onwidthChange:M.widthMarkupMethod,onenabledChange:function I(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},preBuildRendering:function J(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function A(O){if(G.contains(this.textNode,O)||O===this.titleNode){return ;}var Q=this.provider,P=((O===this.nextNode)?"Next":"Prev");if(Q["has"+P]()){Q[P.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function E(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function F(O,P){var Q=this;this._holdTimer=setInterval(function(){Q[P](O);},C);},stopStepperInterval:function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function L(O){this.processEvent(O.e.target);},onmousedown:function D(O){if(!this._holdTimer&&!this._startHoldTimer){var P=this;this._startHoldTimer=setTimeout(function(){delete P._startHoldTimer;P.startStepperInterval(O,"onclick");},B);G.attachOneTimeEvent(N,"mouseup",function(){if(P._startHoldTimer){clearTimeout(P._startHoldTimer);delete P._startHoldTimer;}P.stopStepperInterval();},true);}},onselectstart:function K(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");function A(B){return function(){this.domNode.style[B]=this[B]||"";};}mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",titleNodeCssClass:"mstrmojo-popup-title",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}"><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-title {@titleNodeCssClass}">{@title}</div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onleftChange:A("left"),ontopChange:A("top"),onzIndexChange:A("zIndex")}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.TwoColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-TwoColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider"'+D+'></div><div class="vi-col2"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},dividerNode:function B(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"40%",dividerNode:"5px",col2Node:"60%"},xt:true},shouldPropagateEnabled:true,col1Width:"40%",dividerWidth:"5px",col2Width:"60%",init:function F(G){this._super(G);var H=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),I=H.w;I.col1Node=this.col1Width;I.dividerNode=this.dividerWidth;I.col2Node=this.col2Width;},getControl:function E(G){return(this.children||[]).filter(function(H){return H.slot==="col"+G+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K.slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Widget","mstrmojo.css","mstrmojo.dom");var Y=mstrmojo.css,F=mstrmojo.dom;var Z={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};function A(){var c=this.value,b=this.inputNode,d=b.value,a=(c!==null&&c!==undefined)?String(c):"";if(a!==d&&(!this.keepEmpty||d!==this.emptyText)){b.value=a;}if(b.mstrmojoEmpty){Y.removeClass(b,[this.emptyClass]);b.mstrmojoEmpty=null;}}function X(){var a=this.inputNode;a.value=this.emptyText||"";Y.addClass(a,[this.emptyClass]);a.mstrmojoEmpty=true;}function N(){var a=this.inputNode;if(a){this.readingDom=true;this.set("value",a.value);this.readingDom=false;}}function U(a){var b=this;if(a===-1){N.call(this);}else{if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete b._lastTimeoutId;N.call(b);},a||100);}}mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",emptyText:"",keepEmpty:false,emptyClass:"mstrmojo-empty",valueChangeDelay:-1,textValid:true,autoComplete:true,autoCorrect:true,autoCapitalize:true,markupString:'<input id="{@id}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click,keydown  tstid="{@tstid}"/>',markupSlots:{inputNode:function D(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,oncssClassChange:function S(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function O(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function E(){var a=this.inputNode;a.disabled=!this.enabled;Y.toggleClass(a,"disabled",!this.enabled);},onvalueChange:function P(){var a=this.value,b=(a===undefined)||(a===null)||(a==="");if(b){if(!this.hasFocus){X.call(this);}else{this.inputNode.value="";}}else{A.call(this);}if(F.isIE9){this.inputNode.type=b?"text":this.type;}},ontooltipChange:function R(){this.domNode.title=this.tooltip;},onreadOnlyChange:function H(){this.inputNode.readOnly=this.readOnly;},ontextValidChange:function B(){Y.toggleClass(this.inputNode,["err"],!this.textValid);}},postBuildRendering:function V(){this._super();var a=this.inputNode;a.setAttribute("autocomplete",this.autoComplete?"on":"off");a.setAttribute("autocorrect",this.autoCorrect?"on":"off");a.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function Q(){if(this.inputNode&&this.inputNode.offsetParent){try{this.inputNode.focus();}catch(a){}}},prefocus:function M(){this.hasFocus=true;A.call(this);},blur:function T(){this.inputNode.blur();},preblur:function W(){window.setTimeout(function(){},200);this.hasFocus=false;N.call(this);var a=this.value;if(((a===null||a==="")&&this.emptyText)||(this.keepEmpty&&a===this.emptyText)){X.call(this);}},prekeyup:function I(b){var a=b.hWin,c=b.e||a.event;U.call(this,this.valueChangeDelay);var d=Z[c.keyCode];if(this["on"+d]){this["on"+d](b);}},preinput:function J(){U.call(this,this.valueChangeDelay);},prepaste:function K(){U.call(this);},precut:function G(){U.call(this);},setInvalidState:function C(a){this.set("textValid",true);if(a){this.domNode.setAttribute("title",a);}},cleanUp:function L(){this.inputNode.value="";this.set("textValid",false);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.css");var B=mstrmojo.css;var A;var D;mstrmojo.ui.ButtonBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.ButtonBar",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenabledChange:function G(){B.toggleClass(this.domNode,"disabled",!this.enabled);}},cssDisplay:"table",icnCssText:"display:table-row;",items:null,showIcon:true,init:function F(I){this._super(I);var H=["mstrmojo-ui-ButtonBar"];if(!this.showIcon){H.push("btn-text");}B.addWidgetCssClass(this,H);},getItemMarkup:function E(H){if(!D){D=this._super(H);}if(!A){A=D.replace(">{@en@n}<",'title="{@en@n}"><div>&nbsp;</div><');}return this.showIcon?A:D;},getItemProps:function C(J,H){var I=this._super(J,H);var K=J.css;if(K){I.addCls(K);}I.n=J.n||"";return I;}});mstrmojo.ui.ButtonBar.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");mstrmojo.ui.List=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.List",postselectionChange:function C(D){var G=D.added||[],F=G.length,I=D.removed||[],E=I.length;if(E){this.selectionRemoved({added:G,removed:I,isReselect:false});}if(F){var H=function(J){return[].concat(J).sort().join(",");};this.selectionAdded({added:G,removed:I,isReselect:H(G)===H(I)});}},selectionAdded:function A(D){},selectionRemoved:function B(D){}});mstrmojo.ui.List.SelectionChangeEvtType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var D=mstrmojo.dom,F=mstrmojo.array,E=mstrmojo.hash;var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(H,G){if(!A){var I=this.itemField;A=this._super(H).replace(">{@en@n}<",' title="{@en@'+I+'}">{@en@'+I+"}<");}return A;},getItemProps:function C(I,G){var H=this._super(I,G),J=this.itemField;H[J]=I[J];return H;},onclick:function B(G){if(this.disableClick){return false;}var L=this,I=this.parent,K=I.opener,H=D.isMetaKey(G.hWin,G.e);if(H&&!this.multiSelect){this.multiSelect=K.parent.defn.multi;if(this.multiSelect){D.attachOneTimeEvent(document.documentElement,"keyup",function(){var N=L.selectedIndices;if(K){K.suggestionShown=false;if(N&&!E.isEmpty(N)){var M=[];E.forEach(L.selectedIndices,function(P,O){M.push(L.items[O]);});K.handleSuggestionItemSelect(M);}I.close();}L.multiSelect=false;});}}this._super(G);if(!this.multiSelect){K.suggestionShown=false;var J=this.selectedItem;if(J){K.handleSuggestionItemSelect(J);}I.close();}},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems",disableClick:"this.parent.opener.disableClick"}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.ui.editors.controls.ColorList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.editors.controls.ColorList",init:function D(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ColorList");},getItemMarkup:function C(F,E){if(!A){A=this._super(F,E).replace(">{@en@n}<",">{@en@msg}<");}return A;},getItemProps:function B(G,E){var F=this._super(G,E);if(G.id==="transparent"){F.msg=mstrmojo.desc(5774,"No Fill");F.addCls("noFill");}else{F.msg="";G.title=G.n;F.addStyle("background-color:"+G.id);}return F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.string");mstrmojo.DivItemRenderer={render:function(E,C,F){var D=mstrmojo.string.encodeHtmlString((F.getItemName?F.getItemName(E,C):(F.itemDisplayField&&E[F.itemDisplayField])));return'<div mstridx="'+C+'" class="'+F.itemCssClass+(F.selectedIndices[C]?" "+F.itemSelectedCssClass:"")+(E.cssClass?" "+E.cssClass:"")+'" style="'+F.itemCssText+'">'+D+"</div>";},select:function(D,E,C,F){D.className+=" selected";},unselect:function(D,E,C,F){D.className=D.className.replace(/selected/g,"");},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,rangeSelected:false,_findMatch:function(C,D){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(C,D),"mstridx",true,this.itemsNode);},premousedown:function A(C){if(mstrmojo.dom.shiftKey(C.hWin,C.e)){mstrmojo.dom.preventDefault(C.hWin,C.e);}},preclick:function B(L){var H=L.hWin,I=L.e,G=this._findMatch(H,I);if(G){var E=G.node,K=parseInt(G.value,10),J=mstrmojo.dom,C=J.ctrlKey(H,I),D=J.shiftKey(H,I);if(C||D){J.clearBrowserHighlights(H);}if(this.multiSelect&&(this.selectionPolicy==="toggle"||C)){var F=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(K);if(F&&K<this.items.length&&this.selectedIndices[K+1]){K++;}this.selectedIndex=K;this.rangeSelected=false;}else{if(this.multiSelect&&D){this.rangeSelected=true;this.rangeSelect(K);}else{this.singleSelect(K);this.rangeSelected=false;}}}}};mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._RendersItemDivs");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var C=this.itemRenderer;return(C&&C.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var C=this.itemRenderer;return(C&&C.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var C=this.itemRenderer;return(C&&C.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var C=this.itemRenderer;return(C&&C.itemSuffix)||"</td></tr>";},_getItemNode:function(C){var E=this.itemsNode,D=E&&E.rows,F=D&&D[C];return F&&F.cells[0].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.SelectBox=mstrmojo.declare(mstrmojo.ListBase,null,{scriptClass:"mstrmojo.SelectBox",size:10,cssDisplay:"inline",markupString:'<select id="{@id}" class="mstrmojo-SelectBox {@cssClass}" style="{@cssText}" size="{@size}" {@multipleHtml} mstrAttach:keyup,change tstid="{@tstid}">{@itemsHtml}</select>',markupSlots:{itemsContainerNode:function(){return this.domNode;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){this.domNode.disabled=!this.enabled;}},itemCssClass:"mstrmojo-selectbox-item",itemDisplayField:"n",itemIdField:"v",showItemTooltip:false,itemRenderer:{render:function(E,D,F){var G=mstrmojo.string.htmlAngles((F.getItemName)?F.getItemName(E,D):(F.itemDisplayField&&E[F.itemDisplayField]));return'<option class="'+F.itemCssClass+'" value="'+((F.getItemValue)?F.getItemValue(E,D):(F.itemIdField&&E[F.itemIdField]))+'" '+((F.selectedIndices[D])?'selected="true" ':"")+((F.showItemTooltip)?'title="'+mstrmojo.string.encodeXMLAttribute(G)+'"':"")+">"+G+"</option>";},select:function(E,F,D,G){E.selected=true;},unselect:function(E,F,D,G){E.selected=false;}},buildRendering:function C(){this.multipleHtml=this.multiSelect?' multiple="true" ':"";this._super();delete this.multipleHtml;},_getItemNode:function(D){var E=this.scrollboxNode;return E&&E.options[D];},prechange:function A(E){if(this._syncDom){return ;}this._syncDom=true;var H=this.scrollboxNode;if(this.multiSelect){var I=H.options,F=[];for(var G=0,D=I.length;G<D;G++){if(I[G].selected){F.push(G);}}this.select(F);}else{this.singleSelect(H.selectedIndex);}delete this._syncDom;},prekeyup:function(E){var H=this.scrollboxNode,F=false;if(this.multiSelect){var I=H.options;for(var G=0,D=I.length;G<D;G++){if(I[G].selected!==!!this.selectedIndices[G]){F=true;break;}}}else{if(H.selectedIndex!==this.selectedIndex){F=true;}}if(F){var J=E;J.name="change";this.raiseEvent(E);}},onselectionChange:function B(D){if(!this._syncDom){this._super(D);}}});})();(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.VisMenuList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.VisMenuList",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:false,init:function C(D){this._super(D);},getItemProps:function A(F,D){var E=this._super(F,D);E.tag="a";E.addCls("mstrmojo-ui-Menu-item");return E;},onselectionChange:function B(D){this._super(D);this.parent.data.set("valid",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.num","mstrmojo.array");var A=mstrmojo.num,E=mstrmojo.array;var C="?";function B(H,G){var J=G?H.max:H.min,F=G?H.min:H.max,I=H.getValGroup(G?1:-1);return(J===null||(G?(I.every(function(K){return K<=J;})):(I.every(function(K){return K>=J;})))||(F!==null&&H.canLoop));}function D(I,H){var G=I.min,F=I.max,J=I.getValGroup(H?1:-1)||[];if((H&&F!==null&&J.some(function(K){return K>F;})||(!H&&G!==null&&J.some(function(K){return K<G;})))){if(I.canLoop){J.forEach(function(L,K){L=((L-G)%(F-G+1))+G;L=(L>=G)?L:L+(F-G+1);J[K]=L;});}else{return ;}}I.item[I.valField]=I.curValGroup=J;I.onTraverse();}mstrmojo.NumGroupStepperContentProvider=mstrmojo.declare(mstrmojo.NumStepperContentProvider,null,{scriptClass:"mstrmojo.NumGroupStepperContentProvider",curValGroup:null,init:function(F){this._super(F);},_initCurrent:function(){var H=this.item,F=this.curValGroup=H[this.valField];if(F===null||F===undefined){var G=this.min;this.curValGroup=G!==null?[G]:0;}this.curValGroup=E.ensureArray(this.curValGroup);},next:function(){D(this,true);},prev:function(){D(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},getValGroup:function(I){var F=this.curValGroup,G=this.interval,H=[];(F||[]).forEach(function(K,J){H[J]=F[J]+(G*(I||0));});return H;},getVal:function(){var F=null;(this.curValGroup||[]).forEach(function(G){if(F===null){F=G;}else{if(F!==C&&G!==F){F=C;}}});return F;},setVal:function(H){var I=this.min,G=this.max,F=this.curValGroup;if(typeof H!=="number"||isNaN(H)||A.inNumericRange(H,I,G)!==0){return ;}(F||[]).forEach(function(K,J){F[J]=H;});this.onTraverse();},_set_curValGroup:function(J,I){var H=this.min,G=this.max,F=this.getValGroup();if(I.some(function(K){return typeof K!=="number";})||I.some(function(K){return isNaN(K);})||I.every(function(L,K){return L===F[K];})||I.every(function(K){return A.inNumericRange(K,H,G)!==0;})){return false;}this.item[this.valField]=this.curValGroup=I;return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var M=this,L=this._renderTimer=self.setInterval(function(){if(!M){self.clearInterval(L);return ;}var N=M.getPagesToRender();if(N.length>0){M.renderPages(N);}else{M.renderingRows=false;self.clearInterval(M._renderTimer);delete M._renderTimer;if(M.isRenderingComplete()){M.postRenderingCleanup();}M=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],Z=this._pageHeight,b=null,W=this._pageStatus,Y=this;function R(c){var d=W[c];if(d&&d.filled){if(!d.height){if(!b){b=Y.itemsNode.tBodies;}d.height=b[c].offsetHeight;}return d.height;}else{return Z;}}var a=0,S=null,O=null,M=this.scrollboxTop;for(var V=0,X=this._totalPages;V<X;V++){a+=R(V);if(a>=M){S=V;break;}}if(S==null){S=O=X-1;}else{var L=this.scrollboxBottom;for(var T=S+1;T<X;T++){if(a>=L){O=T-1;break;}a+=R(T);}}if(O==null){O=X-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var U=W[Q];if(!U||!U.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var V=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(V[R]&&V[R].filled)){return ;}}var U=this._rowsPerPage,L=R*U,N=Math.min(L+U,this._rc)-1;var T=this.tempTableCont;if(!T){T=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';T.innerHTML=Q;var O=T.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var C=function(S,U,T){var R=S.parent.opener,J=R&&R.showDesc,Q=R&&R.showPath,I=U[S.itemField];var P=mstrmojo.string.escape4HTMLText,V="";if(Q){var M=U.anc&&U.anc.items,O=M&&M.length;if(O>0){for(var L=0;L<O-1;L++){V+=M[L].n+" > ";}V+=P(M[O-1].n);}else{if(U.path){V+=U.path;}}}if(!T){V+=(V.length===0?"":" > ")+P(I);}if(J){var N=U[S.itemDescField],K=120;if(N){V+="\r\n\r\n<br>"+P(N.substring(0,K)+(N.length>K?"...":""));}}return V;};var A=function(I,J,K){I.path=null;if(!J||!K||K.path){if(K&&K.path){I.set("path",K.path);}return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var L=J.path||J.getAttribute("path");if(L){I.set("path",K.path);return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(M){var N=H(M.toString())||"";K.path=N;I.set("path",N);}},{taskId:"getObjectDetails",objectID:K.did,objectType:K.t},undefined);},200);};var H=function(K){var N;if(window.DOMParser){N=(new DOMParser()).parseFromString(K,"text/xml");}else{N=new ActiveXObject("Microsoft.XMLDOM");N.async="false";N.loadXML(K);}var P=N.getElementsByTagName("path")[0],L=P.childNodes,O="";if(L){for(var J=0,I=L.length;J<I;J++){var M=L[J].childNodes&&L[J].childNodes[0];if(M){O+=mstrmojo.string.escape4HTMLText(M.nodeValue)+(J<I-1?"> ":"");}}}return O;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",useRichTooltip:false,itemDescField:"desc",getItemMarkup:function(K,I){var J=this.parent.opener,L=this.useRichTooltip?"":this.buildTooltip(K);return'<div class="mstrmojo-suggest-text '+((J&&J.item2textCss(K))||"")+'" idx="'+I+'" title="'+L+'">'+J.getHighlightedText(J.getSearchPattern(),mstrmojo.string.escape4HTMLText(K[this.itemField]))+"</div>";},getItemProps:function E(){return{};},onmouseover:function(J){var M=this.parent.opener;if(M&&M.showPath){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),I=K.getAttribute("idx"),L=I!=null?this.items[I]:null;if(L&&L.t>-1){this.targetEl=K;this.targetItem=L;this.requestPath(K,L);}}},requestPath:function D(I,K){var J=this.parent.opener;if(K.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function&&J.showFunctionSyntaxAsPath){this.buildFunctionSyntax(K);}else{A(this,I,K);}},buildFunctionSyntax:function G(J){var K=J.path;if(!K&&J.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){var I=function I(P){if(P.did<0){return P.n;}var O=P.pars,M=[],N,L;M.push(P.n);if(O){M.push("(");for(N=0,L=O.length;N<L;N++){M.push(O[N].n);if(N!==(L-1)){M.push(", ");}}M.push(")");}return M.join("");};J.path=I(J);}this.set("path",{path:J.path,excludeSelf:true});},buildTooltip:function B(I,J){return C(this,I,J);},onpathChange:function F(){var I=this.targetEl;I.path=1;var J=this.buildTooltip(this.targetItem,this.path.excludeSelf);if(this.useRichTooltip){this.useRichTooltip=true;this.hasOpenTooltip=false;if(!I.ttp){I.ttp=J;this.showTooltip();}}else{I.title=J;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Label","mstrmojo.ui.List","mstrmojo.array","mstrmojo.css","mstrmojo.Popup");var F=mstrmojo.array,D=mstrmojo.css;function K(V,R){var T,Q,U,S=[];for(T=0,Q=V.length;T<Q;T++){U=V[T];S.push({scriptClass:"mstrmojo.Box",cssClass:"suggestionBlock",children:[{scriptClass:"mstrmojo.Label",text:U.label,cssClass:"layerLabel "+(U.label?"displayMenuTitle":"hideMenuTitle")},{scriptClass:"mstrmojo.ui.List",cssClass:"searchSuggestion "+(U.label?"sub":"top"),alias:"list",items:U.items,onchange:function(){if(!R.opener){return ;}var W=R.opener.suggestionSource;if(W&&W.onSuggestionItemSelected&&this.selectedItem){W.onSuggestionItemSelected(this.selectedItem);if(R.opener&&R.opener.search){R.opener.search.inputNode.value=this.selectedItem.n;}R.close();}}}]});}return{scriptClass:"mstrmojo.Box",alias:"suggestion",cssClass:"suggestionList",children:S};}function N(R){var Q=0;F.forEach(R,function(S){Q+=S.items?S.items.length:0;});return Q;}function J(S,V,Q,W){var U,T=Q,R;F.forEach(S,function(X){if(V){R=X[V]&&X[V].items;}else{R=X.items;}if(!R){return true;}if(T>=0&&T<R.length){if(W){W.call(X,T);}U=R[T];return false;}else{T-=R.length;}});return U;}function I(Q){var T=this.suggestion.children,S=Q,R=this;if(this.selectedNode){D.removeClass(this.selectedNode,"selected");}J(T,"list",S,function(U){R.selectedNode=this.list._getItemNode(U);D.addClass(R.selectedNode,"selected");});}mstrmojo.gmaps.MapSearchWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.gmaps.MapSearchWidget",markupString:'<div id="{@id}" class="mstrmojo-SearchWidget-WithSuggestion {@cssClass}"><div class="searchbox" mstrAttach:keydown></div><div class="suggestion"></div></div>',markupSlots:{searchNode:function(){return this.domNode.firstChild;},popupNode:function(){return this.domNode.lastChild;}},suggestionResults:null,popupOpenConfig:null,suggestionSource:null,displayResults:function(Q){this.set("suggestionResults",Q);this.openPopup("popupRef",this.popupOpenConfig);},clearResults:function(){this.set("suggestionResults",null);this.closePopup();},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",autoCloses:false,autoClose:false,locksHover:true,closeOnClick:true,currentIdx:-1,onOpen:function A(){var Q;this.destroyChildren();this.currentIdx=-1;this.addChildren(K(this.opener.suggestionResults,this));this.refresh();Q=this.opener.domNode;if(Q&&Q.offsetWidth){this.domNode.style.width=Q+"px";}},selectNext:function C(){var S=this.opener.suggestionResults,Q=N(S),R=this.currentIdx;R=++R%Q;I.call(this,R);this.currentIdx=R;return J(S,null,R).n;},selectPrevious:function M(){var S=this.opener.suggestionResults,Q=N(S),R=this.currentIdx;R=(Q+R-1)%Q;I.call(this,R);this.currentIdx=R;return J(S,null,R).n;}},onkeydown:function E(S){var Q=S.hWin,V=S.e||Q.event,T=V.keyCode;if(T===38||T===40){this.search.quickSearch=false;}else{var R=this.popupRef,W=R.suggestion&&R.suggestion.children,U=R.currentIdx;if(T===13&&W){U=U<0?0:U;J(W,"list",U,function(X){this.list.select(X);});this.closePopup();this.search.quickSearch=false;}else{this.search.quickSearch=true;}}},children:[{scriptClass:"mstrmojo.SearchWidget",alias:"search",slot:"searchNode",quickSearch:true,onsearch:function O(){var R=this.getSearchPattern(),S=this.parent,Q=S.suggestionSource;if(this.quickSearch&&R.length>=3&&Q&&Q.getSuggestions){Q.getSuggestions(R,function(T){if(T&&T.length>0){S.displayResults(T);}});}},onArrowUp:function P(){var Q=this.parent.popupRef,R;if(Q.visible){R=Q.selectPrevious();if(R){this.inputNode.value=R;}}},onArrowDown:function H(){var Q=this.parent.popupRef,R;if(Q.visible){R=Q.selectNext();if(R){this.inputNode.value=R;}}},onclear:function B(){this.parent.clearResults();}}],unrender:function G(Q){var R=this.popupRef;if(this.popupToBody&&R.hasRendered){R.unrender(false);}if(this._super){this._super(Q);}},destroy:function L(Q){delete this.suggestionSource;this._super(Q);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller","mstrmojo.css");var F=mstrmojo.css;var C;mstrmojo.ui.CheckList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.CheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{scrollboxNode:function A(){return this.domNode.firstChild;},itemsContainerNode:function I(){return this.domNode.firstChild.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onorientationChange:function L(){F.toggleClass(this.domNode,"horizontal",this.orientation!=="v");},onmultiSelectChange:function J(){F.toggleClass(this.domNode,"radio",!this.multiSelect);},onenabledChange:function H(){F.toggleClass(this.domNode,"disabled",!this.enabled);}},multiSelect:true,orientation:"v",minimumSelectCnt:0,icnCss:"icn",items:null,getItemMarkup:function K(M){if(!C){C=this._super(M).replace(">{@en@n}<",'title="{@tt}"><span>{@en@n}</span><');}return C;},getItemProps:function G(O,M){var N=this._super(O,M);var P=O.css;if(P){N.addCls(P);}N.tt=O.tt||"";N.n=O.n||" ";return N;},setupScrollNodes:function D(){this.scrollNode=this.scrollboxNode;},preselectionChange:function B(N){var O=this.minimumSelectCnt,M=this.getSelectedItems().length,P=N.removed;if(P&&O){if(M<O){this.select(P,true);return false;}}F.toggleClass(this.itemsContainerNode,"disableSelected",M<=O);return true;},buildRendering:function E(){this._super();F.toggleClass(this.itemsContainerNode,"disableSelected",this.getSelectedItems().length<=this.minimumSelectCnt);}});mstrmojo.ui.CheckList.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller");mstrmojo.ui.ScrollableList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function C(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function E(){return this.domNode.firstChild;}},postBuildRendering:function B(){if(this.renderOnScroll){if(!this.onScrollEnd){var G=this.id;this.onScrollEnd=function F(){var H=mstrmojo.all[G];H.doScroll();H.updateScrollbars();};}}if(this._super){this._super();}},renderBlockSize:150,renderIndex:0,onScrollEnd:undefined,doScroll:function A(){if(this.renderOnScroll){var G,H=this.scrollNode,F=(this.renderIndex+1)*this.renderBlockSize;if(F>=this.items.length){return ;}if(mstrmojo.dom.position(H).h===H.scrollHeight){G=this.domNode;}else{G=H;}if((mstrmojo.dom.position(G).h+G.scrollTop)>=G.scrollHeight){this.renderIndex++;var I=this._buildItemsMarkup(this.renderIndex*this.renderBlockSize,((this.renderIndex+1)*this.renderBlockSize)-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");G.innerHTML+=I;this.itemsContainerNode.innerHTML+=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.TextBox");var A=mstrmojo.css,C=mstrmojo.dom;mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur></textarea>',maxLength:256,onkeydown:function B(K){var I=this.inputNode,J=this.value,E=this.maxLength,F=(J&&J.length)||0,M=K.e,L=M.keyCode;this.isDeleteKeys=L===8||L===46;this.isArrowKeys=L===37||L===38||L===39||L===40;if(E!==undefined&&E<=F){var G=I.selectionEnd,H=(G!==undefined)?(G-I.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!H){if(C.isIE7||C.isIE8||C.isIE9){I.blur();window.setTimeout(function(){I.focus();},1);}C.preventDefault(window,M);return false;}}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.TextArea,{oncssClassChange:function D(){A.addClass(this.domNode,this.cssClass||"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo.hash");var A="mstrmojo-TextBoxWithLabel";mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="'+A+' {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur/><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;},lblNode:function(){return this.domNode.firstChild;}}});mstrmojo.TextBoxWithLabel.prototype.markupMethods=mstrmojo.hash.copy({oncssClassChange:function(){var B=this.cssClass;this.domNode.className=A+(B?" "+B:"");},onlabelChange:function(){this.lblNode.innerText=this.label||"";}},mstrmojo.hash.copy(mstrmojo.TextBoxWithLabel.prototype.markupMethods));}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var D=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" style="z-index: 1100;" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},editorNode:null,btnHbox:null,markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(L){if(L){return ;}var J=this.visible,K=J?"block":"none";this.editorNode.style.display=K;if(this.modal){this.curtainNode.style.display=K;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function F(){var J;var K=this.buttons;if(K&&!this.btnHbox){for(J in K){K[J].cssClass=(K[J].cssClass||"")+(this.noButtonCls?"":" mstrmojo-Editor-button");}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:K},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function B(){var J=this.placeholder;if(this._super()){if(!this.parent&&!J){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function E(){var J=this.id;return function(){var K=mstrmojo.all[J];K.resizeDialog();K.positionDialog();};},postBuildRendering:function A(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var K=this._resizeHandler=this.getResizeHandler();D.attachEvent(window,"resize",K);}this.resizeDialog();this.positionDialog();try{this.domNode.focus();}catch(J){}return true;},resizeDialog:function G(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function C(){var K=this,O=K.curtainNode,J=document.body,M=document.documentElement,N=O.style,L=K.curtainPosition;N.width=Math.max(J.clientWidth,M.scrollWidth)+"px";if(L&&L.h){N.height=L.h+"px";}else{N.height=Math.max(J.clientHeight,M.scrollHeight)+"px";}if(L&&L.y){N.top=L.y+"px";}K.raiseEvent({name:"resizeCurtain"});},positionDialog:function H(){var K=this.editorNode,M=this.left,L=this.top;if(!M||!L){D.center(K);var J=K.style;if(this.alignment==="top"){J.top="10px";}if(M){J.left=M;}if(L){J.top=L;}}},destroy:function(K){var J=this._resizeHandler;if(J){D.detachEvent(window,"resize",J);}this._super(K);}});mstrmojo.toast=function I(O,M,Q,J){var P="mojoToast9",N,L=M||3000;if(J&&J.id){P=J.id+"-"+P;}try{mstrmojo.all[P].destroy();}catch(K){}mstrmojo.insert({id:P,scriptClass:"mstrmojo.Label",cssClass:(J&&J.cssClass)?J.cssClass:"toastCss",text:O}).render();N=mstrmojo.all[P].domNode;if(J&&J.dom){J.dom.appendChild(N);}else{document.body.appendChild(N);D.bottomCenter(N);}window.setTimeout(function(){if(Q){Q();}try{mstrmojo.all[P].destroy();}catch(R){}},L);};mstrmojo.mask={show:function(){var J=mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});J.render();document.body.appendChild(J.domNode);},hide:function(){mstrmojo.mask.win.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var B=mstrmojo.dom;mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",itemTitleField:null,defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(H,F){var G=this.items;this.items=F||[];return G!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var G=this.value,F=this.selectedIndex,I=this.items||[],J,H;if(F===undefined||(G!==null&&(F===-1||(F!==-1&&I[F]&&I[F][this.itemIdField]!==G)))){F=mstrmojo.array.find(I,this.itemIdField,G);F=(F>-1)?F:this.defaultSelection;this.selectedIndex=F;}else{if(G===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=J=I[this.selectedIndex];if(J){H=J[this.itemField];}else{H=this.defaultText||"";}this.set("text",H);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function D(){var G=this.value,F=-1;if(G!==null){F=mstrmojo.array.find(this.items,this.itemIdField,G);}if(F>-1){this.selectedItem=this.items[F];this.selectedIndex=F;}},togglePopup:function E(){if(this.popupToBody){var I=B.position(this.popupNode,true),H=this.popupRef,F={left:Math.round(I.x)+"px",top:Math.round(I.y)+"px"};if(!H.hasRendered){delete H.slot;F.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(F,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var G=this.popupRef.domNode;if(G){if(this.fixWidth){G.style.width=(this.domNode.offsetWidth-2)+"px";}else{G.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(F){if(B.getButton(F.hWin,F.e)===B.MOUSE_BUTTON.LEFT){this.togglePopup();}},unrender:function C(F){var G=this.popupRef;if(this.popupToBody&&G.hasRendered){G.unrender(false);}if(this._super){this._super(F);}},itemName:function(H,F,G){return mstrmojo.string.encodeHtmlString(H[G.itemField]);},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var H=this.opener,G=H&&H.popupZIndex,I=(H&&H.popupCssClass)||"",F=this.domNode;if(G){F.style.zIndex=G;}if(I){mstrmojo.css.addClass(F,[I]);}if(H&&H.fixWidth){mstrmojo.css.addClass(F,["fix-width"]);}if(H&&H.fixHeight){mstrmojo.css.addClass(F,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(I,F,G){var H=I[G.itemCSS]||G.parent.opener.item2textCss&&G.parent.opener.item2textCss(I)||"",J=G.parent.opener.itemName;return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+H+'" title="'+I[G.itemTitleField||G.itemField]+'">'+(J(I,F,G)||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",itemTitleField:"this.parent.opener.itemTitleField",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var H=this.parent,I=H.visible,F=H.opener,G=this.selectedItem;if(!F||!G||!I){return ;}F.set("value",G[this.itemIdField]);}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label","mstrmojo.WaitIcon");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div class="mstrmojo-IncFetch-content"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,T=this.parent.parent;if(R===""){T.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);T.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasLayout");mstrmojo.ui.editors.controls.PreviewButton=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.PreviewButton",markupString:'<div id="{@id}" class="mstrmojo-ui-PreviewButton {@cssClass}" style="{@cssText}"><div class="cf" mstrAttach:click><div class="preview"></div><div class="btn">&nbsp;</div></div><div class="host"></div></div>',markupSlots:{previewNode:function(){return this.domNode.firstChild.firstChild;},btnNode:function(){return this.domNode.firstChild.lastChild;},widgetHostNode:function(){return this.domNode.lastChild;},clickableNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{previewNode:"100%",btnNode:"100%",widgetHostNode:"0px"},w:{previewNode:"100%",btnNode:"20px",widgetHostNode:"all"},xt:true},isHostedWithin:false,getLayoutOffsets:function B(){return{h:2,w:2};},anchorSlot:"clickableNode",updatePreview:function C(){throw new Error(this.scriptClass+" must implement updatePreview.");},getPopupHostNode:function A(){return this.widgetHostNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ui.ColumnContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnContainer {@cssClass}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.firstChild;}},markupMethods:{onnextChange:function A(){B.toggleClass(this.domNode,"hasNext",!!this.next);}},active:false,next:null,idx:undefined,updateColumnContainer:function D(){var E=this.next;if(E){E.updateColumnContainer();}},onactiveChange:function C(){B.toggleClass(this.domNode,"active",this.active);var E=this.next;if(E){E.updateColumnContainer();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.editors._HostsControls","mstrmojo._HasLayout","mstrmojo.css");mstrmojo.ui.editors.controls.ControlGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.editors._HostsControls,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ControlGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},shouldPropagateEnabled:true,init:function A(B){this._super(B);mstrmojo.css.addWidgetCssClass(this,"ctrl-group");}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ui.editors.controls.ControlGroup,{onenabledChange:mstrmojo.Container.enabledMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.css");var B=mstrmojo.css;mstrmojo.vi.ui.editors.EditorGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},showDivider:true,isNested:false,isContainer:false,init:function D(E){this._super(E);B.addWidgetCssClass(this,["mstrmojo-vi-EditorGroup","ctrl-group"]);},preBuildRendering:function A(){var E=[];if(this.showDivider){E.push("divide");}if(this.isContainer){E.push("container");}if(E.length){B.addWidgetCssClass(this,E);}return this._super();},getLayoutOffsets:function C(){return{h:0,w:this.isNested?0:18};}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupWidget","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.css");mstrmojo.ui.menus.MenuPopup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.ui.menus._IsMenuPopup],{scriptClass:"mstrmojo.ui.menus.MenuPopup",popupConfig:null,init:function B(D){this._super(D);var C=this.popupConfig;if(!C.contents){throw new Error("Cannot open popup without contents.");}this.cssClass=C.cssClass||"";this.addChildren(C.contents);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-MenuPopup");},shouldPropagateLockHover:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash","mstrmojo.string");mstrmojo.requiresDescs(11038,11935,11936,11937,11856,11938,13138,13230,13260,14633,14636);var C=mstrmojo.hash.copy,P=mstrmojo.css,J=mstrmojo.dom,N=mstrmojo.array,E=mstrmojo.string,Q=function Q(V,T){if(!V){return ;}var S=T&&T.length||0,U;for(U=S;U>0;U--){V=V.replace(new Array(U+2).join("#"),T[U-1]);}return V;},L=function L(T){if(!T){return ;}var Z=this,V=J.position(T.refNode||Z.refNode),Y=J.position(Z.domNode),X=T.position||R.RIGHT,U=0,a=0,S=9+(T.margin!==undefined?T.margin:0),W=" ";switch(X){case R.TOP:a=-Y.h-S;W+="t";break;case R.BOTTOM:a=V.h+S;W+="b";break;case R.LEFT:U=-Y.w-S;W+="l";break;case R.RIGHT:U=V.w+S;W+="r";break;}mstrmojo.hash.forEach(C(T,{left:U,top:a,contentNodeCssClass:W,visible:false}),function(b,c){this[c]=b;},this);this.set("visible",T.invalid);},A=function A(S){var W=this,U,V=S.errorCode,X=S.errorMsg,T=S.args,Y=mstrmojo.vi.ui.rw.selectors.EnumWarningMessages;if(S.invalid){U={content:V!==null?(W.generateContentHTML(Q(Y[V],T))||Y["*"]):X};}return U;};mstrmojo.vi.ui.rw.selectors.EnumWarningMessages=C(mstrmojo.locales.validation,{"*":mstrmojo.desc(11038,"Invalid"),invalidValueVIWarning:mstrmojo.desc(11935,"Invalid characters"),emptyValueVIWarning:mstrmojo.desc(11936,"Please enter a number"),notIntegerVIWarning:mstrmojo.desc(11937,"Please enter an integer"),outOfRangeVIWarning:mstrmojo.desc(11856,"Please enter value between ## and ###."),noMultiSelectionVIWaring:mstrmojo.desc(11938,"This selector does not support multiple selections."),continuousSelectionVIWaring:mstrmojo.desc(13138,"This selector does not support non-continuous selections."),bigDecimalMetricSliderVIWaring:mstrmojo.desc(13230,"Cannot qualify on big decimal value. Please change qualification type to Rank"),unableDisplaySelectionVIWarning:mstrmojo.desc(13260,"Filter cannot display actual selections."),imageSizeExceedLimitVIWarning:mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead."),imageFileTypeNotSupportedVIWarning:mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."),imageOverSizeNoCompessionVIWarning:mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.")});mstrmojo.vi.ui.rw.selectors.EnumWarningPosition={TOP:1,BOTTOM:2,LEFT:3,RIGHT:4};var R=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition;mstrmojo.vi.ui.rw.selectors._HasWarningMessage=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasWarningMessage",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasWarningMessage",warningSlotName:"warning",showWarning:function G(U){var Y=this,a=Y.warningSlotName,c=Y[a],S=U&&U.lasting||6000,X=U.refNode||this.domNode,T=U.highlight!==false,b=U.closeOnClick===false?false:true,Z;if(!c){c=new mstrmojo.Tooltip({refNode:X,highlight:T,closeOnClick:b,updatePopupConfig:null,cssClass:"vi-warning vi-tooltip-V"});Y.addDisposable(c);Y[a]=c;Z=Y.closeOnClick=Y.getCloseOnClickListener();J.attachEvent(document.body,"click",Z);}var W=U.position||R.TOP,V="vi-warning vi-tooltip-";switch(W){case R.TOP:c.cssClass=V+"V";break;case R.BOTTOM:c.cssClass=V+"A";break;case R.LEFT:c.cssClass=V+"D";break;case R.RIGHT:c.cssClass=V+"C";break;}c.open(Y,A.call(Y,U));this.adjustPosition(U);if(T){P.toggleClass(c.refNode,"mstrmojo-Warning",true);}window.clearTimeout(Y._warningTimeOut);Y._warningTimeOut=window.setTimeout(function(){Y.hideWarning();},S);},hideWarning:function H(){var T=this,S=T[T.warningSlotName];if(S&&S.visible&&S.close){if(S.highlight){P.toggleClass(S.refNode,"mstrmojo-Warning",false);}S.close();window.clearTimeout(T._warningTimeOut);delete T._warningTimeOut;}},getCloseOnClickListener:function I(){var S=this;return function(){var T=S[S.warningSlotName];if(T.closeOnClick){S.hideWarning();}};},adjustPosition:function M(S){var T=this;L.call(T[T.warningSlotName],S);},generateContentHTML:function D(S){return E.encodeHtmlString(S,true);},bindWarningHandler:function F(){N.forEach(arguments,function S(U){if(!U||!U.attachEventListener){return ;}var V=U._validationEventListener,T;if(V){U.detachEventListener(V);delete U._validationEventListener;}T=this.getValidationEvtListener();if(T){U._validationEventListener=U.attachEventListener("validationChange",this.id,T);}},this);},getValidationEvtListener:function B(){var T=this;return function S(U){var V=U.value;T[(V&&V.invalid?"show":"hide")+"Warning"](V);};},unrender:function K(S){var T=this[this.warningSlotName];if(T){T.unrender();}this._super(S);},destroy:function O(S){J.detachEvent(document.body,"click",this.closeOnClick);return this._super(S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.tooltip");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.hash,H=mstrmojo.array,C=mstrmojo.tooltip;mstrmojo.ui._HasListTooltip=mstrmojo.provide("mstrmojo.ui._HasListTooltip",{_mixinName:"mstrmojo.ui._HasListTooltip",tooltipOrientation:"horizontal",tooltipOffset:8,tooltipMarkup:'<div class="content" style="{@style}">{@c}</div>',tooltipCss:{},tooltipContrast:false,getTooltipText:function A(I){return I&&(I.ttp||I.n);},showTooltip:function G(W,M){var O=this;if(!O.hasOpenTooltip&&!(O._lastOpened&&O._lastOpened.visible)){var b=E.eventTarget(M,W),X=O.getItemFromTarget(b),R=O.getItemNodeFromTarget(b),d=O.getTooltipText(X),N=O.tooltipCss;if(!d){return ;}var c=E.position(R),V,P,L,T="",U=O.tooltipOffset;if(this.tooltipOrientation==="vertical"){V=c.x+c.w/2;L=C.POS_TOPCENTER;P=c.y+c.h+U;O.tooltipCss=F.copy({cssClass:"vi-regular vi-tooltip-A A-center"},N);}else{var K=E.windowDim(),S=40,Y=c.x+c.w+U,J=c.x-U,a=J-S,I=K.w-(Y+S),Z="vi-regular vi-tooltip-",Q;P=c.y;if(I>=a){V=Y;Q=I;L=C.POS_TOPLEFT;N.cssClass=Z+"C  "+N.rightCssClass;}else{V=J;Q=a;L=C.POS_TOPRIGHT;N.cssClass=Z+"D  "+N.leftCssClass;}T="max-width: "+Q+"px;";}if(O.tooltipContrast){N.cssClass=N.cssClass+" contrast";}if(N&&N.getItemCssClass){N.cssClass=H.filter([N.cssClass,N.getItemCssClass(X)],function(e){return !!e;}).join(" ");}O.richTooltip=F.copy(O.tooltipCss,{content:D.apply(O.tooltipMarkup,{c:d,style:T}),top:P,left:V,posType:L});O.richTooltip.keepArrowXPos=!!O.keepArrowXPos;O.richTooltip.keepArrowYPos=!!O.keepArrowYPos;this._super(W,M);}},onclick:function B(I){var J=this;window.setTimeout(function(){if(J.hasOpenTooltip){J.hideTooltip();}window.clearTimeout(J._tooltipTimeOut);},0);this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.ToolbarEditor","mstrmojo.hash");mstrmojo.ui.menus.ToolbarEditorConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.ToolbarEditorConfig",cssClass:"",contents:null,init:function C(D){this._super(D);this.initBindings();},clear:function A(){this._super();this.contents=null;},newInstance:function B(D){return new mstrmojo.ui.menus.ToolbarEditor(mstrmojo.hash.copy({popupConfig:this},D));}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+(C[B.itemType]?" t_"+C[B.itemType]:"")+(C[B.itemSubType]?" st_"+C[B.itemSubType]:"")+(C[this.itemISC]?" isc":"")+(C[B.itemViewMedia]?" vm_"+C[B.itemViewMedia]:"")+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(F){var E=F[this.itemType],D=F[this.itemSubType],B=" t"+E,C=(parseInt(E,10)===1||parseInt(E,10)===3||parseInt(D,10)===14082)?" st"+D:"",G=F[this.itemISC]?'class="mstrmojo-ListIcon isc"':"",A=(F[this.itemViewMedia]===2048||F[this.itemViewMedia]===8192)?" hvi":"";return'<span class="mstrmojo-ListIcon '+B+C+A+'"><span '+G+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length,B;if(A>0){for(B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+E.substring(0,G)+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc",itemViewMedia:"dvm",useDblSelect:false});}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo._IsDial");mstrmojo.Dial=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsDial],{scriptClass:"mstrmojo.Dial",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){mstrmojo.css.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);},hideIfEmpty:function(){this.onadd();}},hideIfEmpty:false,onadd:function(A){if(this._super){this._super(A);}if(this.hideIfEmpty){if(this.domNode){this.domNode.style.display=(!this.items||this.items.length==0)?"none":"block";}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),({scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E==="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E==="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof G==="object")&&(typeof G.length==="number"));};if(B(F)&&B(E)){var C;for(C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);}());(function(){mstrmojo.requiresCls("mstrmojo.OBList","mstrmojo.ui._IsIncFetchList","mstrmojo.ui._HasScroller");var F=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType;function D(G){return{browseConfig:null,parent:G,next:function(J){var I=this.browseConfig;if(!I){return ;}I.blockBegin+=I.blockCount;var H={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockBegin:I.blockBegin,blockCount:I.blockCount,includeAncestorInfo:true};if(I.folderLinksContextId){H.folderLinksContextId=I.folderLinksContextId;}if(I.includeObjectDesc){H.includeObjectDesc=I.includeObjectDesc;}if(I.rootFolderID){H.rootFolderID=I.rootFolderID;}else{if(I.rootFolderType){H.rootFolderType=I.rootFolderType;}}if(I.browsableTypes){H.objectType=I.browsableTypes;}if(I.searchPattern){H.searchPattern=I.searchPattern;if(I.recursive){H.recursive=I.recursive;}}this.parent.set("waiting",true);if(I.dataProvider){I.dataProvider.serverRequest(H,J);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,J,H);}},hasNext:function(){var H=this.browseConfig;return(H.blockBegin+H.blockCount-1)<H.totalSize;}};}mstrmojo.mstr.ui.IncFetchOBList=mstrmojo.declare(mstrmojo.OBList,[mstrmojo.ui._IsIncFetchList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.mstr.ui.IncFetchOBList",cssClass:"mstrmojo-OBList mstrmojo-IF-OBList",makeObservable:true,renderOnScroll:false,waiting:false,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keypress,mousedown,mouseup,dblclick><div class="scroll-box" style="{@scrollBoxCssText}"><div class="mstrmojo-ListBase2-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onwaitingChange:function(){this.onwaitingChange();}},init:function E(G){if(this._super){this._super(G);}this.ifDataHelper=D(this);if(G.browseConfig){this.ifDataHelper.browseConfig=G.browseConfig;}},onwaitingChange:mstrmojo.emptyFn,addItems:function B(G){var H=this.browseConfig.browsableViewMedias;if(G&&H){var I={};F.forEach(H.split(","),function(J){I[parseInt(J,10)]=true;});G=F.filter(G,function(J){return(J.t!==A.DssTypeDocumentDefinition)||I[J.dvm];});}this.add(G,-1);this.set("waiting",false);if(this._super){this._super(G);}if(this.scrollNode){this.updateScrollbars();}},setupScrollNodes:function C(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo._IsDial");mstrmojo.WidgetDial=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._IsDial],{scriptClass:"mstrmojo.WidgetDial"});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var B=mstrmojo.dom,A={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseover><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(A[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=B.eventTarget(D.hWin,D.e);if(F===this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui._HasListTooltip");mstrmojo.ui.PopupList=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo._IsPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.ui.PopupList",autoCloses:true,locksHover:true,closeOnClick:true,parentDomNode:undefined,markupString:'<div id="{@id}" class="mstrmojo-PopupList {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="mstrmojo-popupList-scrollBar"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function D(){return this.domNode.firstChild.firstChild;},scrollboxNode:function F(){return this.domNode.firstChild;}},setupScrollNodes:function E(){this.scrollNode=this.scrollboxNode;},onOpen:function B(){this._super();this.updateScrollbars();},postBuildRendering:function C(){var H=this._super();if(!this.parent){var G=this.parentDomNode=this.parentDomNode||document.body;G.appendChild(this.domNode);}return H;},closePopup:function A(){this.set("visible",false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui.menus._HasMenuPopup","mstrmojo._CanAutoClose","mstrmojo._IsPopup","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.ui.PopupConfig","mstrmojo.ui._HasScroller","mstrmojo.ui._HasUITheme","mstrmojo.dom","mstrmojo.css","mstrmojo.ui._HasListTooltip");var D=mstrmojo.dom,P=mstrmojo.css,I=mstrmojo.ui.PopupConfig.directionCfg;var Q={};var K=false;function F(V,W){if(V.pop){if(W&&V.ax){window.clearTimeout(this._popupAxTimeout);V.actionFn();this.closeAllMenus();}else{var T=V.fn.call(mstrmojo.all[V.scope],V.ctxt);var U=T.ENUM_CORNERS;T.setAlignment(U.TOP_RIGHT,U.TOP_LEFT);T.hostId=this.id;T.hostElement=this._getItemNode(V._renderIdx);this.openPopup(T.newInstance());}}else{if(V.dsbld!==true){if(V.fn(V,this)!==false){this.closeAllMenus();}}}}function G(T){var U=parseInt(T);return U===null||isNaN(U)?0:U;}mstrmojo.ui.menus.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._IsPopup,mstrmojo.ui.menus._IsMenuPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip,mstrmojo.ui._HasScroller,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.ui.menus.Menu",selectionPolicy:"reselect",locksHover:true,closeOnClick:true,themeClassName:"mojo-theme-dark",icnCss:"mstrmojo-ui-Menu-item-container",popupConfig:null,tooltipCss:{leftCssClass:"menuTooltip",rightCssClass:"menuTooltip"},setupScrollNodes:function(){if(this.popupConfig&&this.popupConfig.supportsScroll){this.scrollNode=this.itemsContainerNode;this.scrollbarHostNode=this.domNode;}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll&&this.hasCustomScrollbar){var V=this.scrollNode;if(!V){return ;}var T=(getComputedStyle&&getComputedStyle(V,null))||V.currentStyle,U=V.offsetWidth-G(T.borderLeftWidth)-G(T.borderRightWidth)-V.clientWidth;V.style.marginRight=-U+"px";V.style.paddingRight=0;}},onscroll:function(){this.closePopup();this._super();},init:function L(V){this._super(V);var T=this.popupConfig;this.items=T.getMenuItems();var U=["mstrmojo-ui-Menu","unselectable"],W=T.menuCssClass;if(W){U.push(W);}P.addWidgetCssClass(this,U);if(T&&T.supportsScroll&&T.maxHeight>0){this.icnCssText=(this.icnCssText||"")+";max-height:"+T.maxHeight+"px";}this.useRichTooltip=!!T.useTooltip;this.tstid=T.tstid;},markupMethods:{onvisibleChange:function J(){var T=this.visible;if(!K||T){P.toggleClass(this.domNode,"visible",T);}}},getItemMarkup:function C(X,T){if(X.getItemMarkup){return X.getItemMarkup.apply(this,[X,T]);}var V=!!X.pop,W=V?"submenu":"item",U=Q[W];if(!U){U=this._super(X,T).replace("{@en@n}",'<div class="micn"></div>{@en@n}');if(V){U=U.replace("{@en@n}",'{@en@n}<div class="arw"></div>');}Q[W]=U;}if(X.tstid){U=U.replace("{@tag}","{@tag} "+mstrmojo.tstid(X)+" ");}return U;},getItemProps:function R(V,T){var U=this._super(V,T);U.tag="a";U.addCls("mstrmojo-ui-Menu-item");U.addCls(V.cls);return U;},adjustCornersForPopupOverflow:function O(){var V=this._super(),Z=this.domNode,Y,X,T,U,W;if(V){Y=D.position(Z);T=Y.y;X=Z.style;U=this.popupConfig;W=U.position||D.position(U.hostElement);if(T<0||(T+Y.h>D.position(document.body).h)){X.top=(-W.y+5)+"px";X.bottom="auto";}}return V;},onmouseover:function E(T){var Y=T.getTarget(),X=this.getItemFromTarget(Y),W=this,V=W._lastOpened,a=V&&this.getItemFromTarget(V.popupConfig.hostElement)._renderIdx,Z=this.getItemNodeFromTarget(Y),U=(a!==undefined&&D.contains(this._getItemNode(a),Y,true,this.domNode));if(X){this._lastHoverIx=X._renderIdx;window.clearTimeout(this._popupTimeOut);window.clearTimeout(this._popupAxTimeout);if(this._lastHoverIx!==a&&!U){this._popupTimeOut=window.setTimeout(function(){if(W._lastOpened&&W._lastOpened.visible){W.closePopup();}if(W.visible&&X.pop){if(X.ax){W._popupAxTimeout=window.setTimeout(function(){P.removeClass(Z,"hlt-ax");F.call(W,X);},0);}else{F.call(W,X);}}},400);if(X.pop&&X.ax){P.addClass(Z,"hlt-ax");}}}},onclick:function S(T){this._evtTarget=T.getTarget();this._super(T);T.cancel();},postselectionChange:function H(T){var U=T.added;if(U){var V=this.items[U[0]];F.call(this,V,!(V.ax&&this._evtTarget.className==="arw"));delete this._evtTarget;}},oncontextmenu:function M(T){D.preventDefault(window,T.e);return false;},postBuildRendering:function N(T){this._super(T);if(this.popupConfig.supportsScroll){var U=this;window.setTimeout(function(){U.updateScrollbars();},10);}},showTooltip:function B(X,W){var V=D.eventTarget(W,X),U=this.getItemNodeFromTarget(V),T=this.getItemFromTarget(V);if(U&&((T&&T.ttp)||(U.scrollWidth>U.clientWidth))){this._super(X,W);}},onClose:function A(T){if(this._super){this._super(T);}this.closePopup();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate","mstrmojo.css","mstrmojo.validation","mstrmojo.vi.ui.rw.selectors._HasWarningMessage");var H=mstrmojo.css,E=mstrmojo.validation,G=E.TRIGGER,J=E.STATUSCODE;function F(L){if((this.constraints.trigger&L)>0){this.validate();}}mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,getInvalidMsg:function K(L){return(L&&L.msg?L.msg:"");},postBuildRendering:function A(){this._super();this._original_tooltip=this.inputNode.title;},prekeyup:function I(L){this._super(L);var P=(this.constraints.trigger&G.ONKEYUP)>0;if(P){var M=this.validationDelay;if(M){this.clearValDelayTimer();var O=this._validateHandler;if(!O){var N=this;this._validateHandler=O=function(){N.validate();if(N._valDelayTimer){window.clearTimeout(N._valDelayTimer);delete N._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(O,M);}else{this.validate();}}},preinput:function D(L){this._super(L);F.call(this,G.ONKEYUP);},preblur:function B(L){this._super(L);F.call(this,G.ONBLUR);},clearValidation:function C(){this._super();var L=this.inputNode;H.removeClass(L,this.constraints.invalidCssClass||"mstrmojo-TextBox-ErrValidation");L.title=this._original_tooltip;},clearValDelayTimer:function(){var L=this._valDelayTimer;if(L){window.clearTimeout(L);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ValidationTextBox,{onvalidationStatusChange:function(){var P=this.validationStatus;if(!P){return ;}var N=this.inputNode,L=(P.code>J.VALID),M=this.constraints.invalidCssClass;H.toggleClass(N,M||"mstrmojo-TextBox-ErrValidation",L);var O=L?this.getInvalidMsg(P):this._original_tooltip;if(!this.useRichTooltip&&O!==undefined&&O!==null){N.setAttribute("title",O);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuPopup","mstrmojo.Button","mstrmojo.dom");mstrmojo.requiresDescs(1442,2140);var E=mstrmojo.dom,G=mstrmojo.array;function B(I,K){var H=2140,M="Cancel",L="this.parent.popupConfig."+(I?"ok":"cancel"),J=K&&K[(I?"ok":"cancel")+"BtnText"];if(I){H=1442;M="Ok";}return mstrmojo.Button.newWebButton(J||mstrmojo.desc(H,M),function(O){var P=this.parent,N=P.popupConfig;P.closeAllMenus();N["fn"+M](N.data,P);E.stopPropogation(O.hWin,O.e);},I,{slot:"btnNode",bindings:{enabled:L+"Enabled",visible:L+"Visible"},cssDisplay:"inline-block"});}mstrmojo.ui.menus.MenuEditor=mstrmojo.declare(mstrmojo.ui.menus.MenuPopup,null,{scriptClass:"mstrmojo.ui.menus.MenuEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-MenuEditor {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="me-content"></div><div class="me-buttons"></div><div class="me-bottom"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;},btnNode:function D(){return this.domNode.children[1];},bottomNode:function D(){return this.domNode.children[2];}},popupConfig:null,init:function F(J){this._super(J);var I=this.popupConfig,H=I.bottomNode;this.data=I.data||{};if(I.onOpen){this.onOpen=I.onOpen;}this.addChildren([B(true,I),B(false)]);if(H){H.slot="bottomNode";this.addChildren(H);}},onOpen:function C(){G.forEach(this.children,function(H){if(H.scriptClass==="mstrmojo.ui.ScrollableContainer"&&H.onOpen){H.onOpen();}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.MenuPopup");mstrmojo.ui.menus.PopupConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.PopupConfig",cssClass:"",contents:null,clear:function A(){this._super();this.contents=null;},close:function C(){([].concat(this.contents)[0]).parent.closeAllMenus();},newInstance:function B(){return new mstrmojo.ui.menus.MenuPopup({popupConfig:this});}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.array","mstrmojo._HasLayout","mstrmojo.ui.ColumnContainer");var E=mstrmojo.dom,G=mstrmojo.hash,C=mstrmojo.array;mstrmojo.ui.ColumnWalk=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.ColumnWalk",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnWalk cf {@cssClass}" mstrAttach:click></div>',layoutConfig:{h:{containerNode:"100%"},xt:true},currentColumn:-1,addNextColumn:function B(K){var J=this.children||[],L=J.length,I=J[L-1];var M=this.addChildren([G.copy(K,{scriptClass:"mstrmojo.ui.ColumnContainer",idx:L})])[0];if(I){I.set("next",M);}},onclick:function A(I){var K=I.getTarget();if(K){var J=this.children;C.forEach(J,function(M,L){if(E.contains(M.domNode,K,true,M.domNode)){this.set("currentColumn",L);}},this);}},oncurrentColumnChange:function D(I){var K=this.children,M=K[I.valueWas],J=K[this.currentColumn],L="active";if(M){M.set(L,false);}J.set(L,true);},removeTrailingContainer:function H(K){var J=this,I=this.children;if(!I||K>=I.length-1){return ;}C.forEach(I.slice(K+1),function(L){J.removeAndDestroyChild(L);});if(K>=0){I[K].set("next",null);}},insertAndRemoveTrailing:function F(J,I){this.removeTrailingContainer(J);this.addNextColumn(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Pulldown");var C={ENTER:13,LEFT:37,UP:38,TAB:9,RIGHT:39,DOWN:40,ESC:27};function D(L,M){var G,J,F,H=[],I,N;try{I=new RegExp(L,"i");}catch(K){I=new RegExp(mstrmojo.string.regEscape(L));}for(G=0,J=M.length;G<J;G++){if(I.test(M[G][this.itemField])){H.push(M[G]);}}return H;}function B(F){return !(F<0||F===undefined||F===null);}mstrmojo.SearchablePulldown=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchablePulldown",popupCssClass:"mstrmojo-SearchablePulldown-Popup",searchEnabled:false,allowCustomInput:false,useItemCssOnInput:false,lastSearchPattern:"",isEditing:false,allItems:null,markupString:'<div id="{@id}" class="mstrmojo-SearchablePulldown mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-SearchablePulldown-boxNode mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><input class="mstrmojo-SearchablePulldown-inputNode" value="{@text}" mstrAttach:keyup,blur/><div class="mstrmojo-SearchablePulldown-iconNode mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mouseover,mouseout></div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;},iconNode:function(){return this.domNode.firstChild.children[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){if(this.inputNode.value!==this.text){this.inputNode.value=this.text;}},onheightChange:function(){this.domNode.style.height=this.height||"";this.boxNode.style.height=this.height||"";},onsearchEnabledChange:function(){this.inputNode.readOnly=this.searchEnabled?false:true;this.items=this.allItems||this.items;},onallowCustomInputChange:function(){if(this.allowCustomInput){this.set("searchEnabled",true);}},onvalueChange:function E(){if(this.useItemCssOnInput&&this.selectedItem){this.inputNode.className="mstrmojo-SearchablePulldown-inputNode "+(this.selectedItem[this.itemCSS]||"");}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),prevalueChange:function(){this.synchronize();},synchronize:function(){var G=this.value,H=this.items||[],I=H[this.selectedIndex],F=-1;if(I&&G===I[this.itemIdField]){this.selectedItem=I;this.set("text",I[this.itemField]);return ;}F=mstrmojo.array.find(this.items,this.itemIdField,G);if(!B(F)&&this.allowCustomInput){this.selectedItem=undefined;this.selectedIndex=undefined;return ;}this.selectedIndex=B(F)?F:this.defaultSelection;this.selectedItem=I=this.items[this.selectedIndex];this.value=I?I[this.itemIdField]:undefined;this.set("text",I?I[this.itemField]:(this.defaultText||""));},preBuildRendering:function A(){if(this._super){this._super();}this.allItems=this.allItems||this.items;this.synchronize();},premousedown:function(F){if(this.searchEnabled&&F.getTarget()===this.iconNode){this.set("items",this.allItems);}this._super(F);},onkeyup:function(M){var J=mstrmojo.string.trim(this.inputNode.value),I=M.e,N=I.keyCode||I.which,L=B(this.selectedIndex)?this.selectedIndex:-1,F=this.allowCustomInput,H=this.items.length;this.isEditing=true;switch(N){case C.ENTER:if(H>0&&!F){this.set("selectedIndex",L===-1?0:L);this.synchronize();}this.closePopup();break;case C.ESC:this.closePopup();this.synchronize();break;case C.UP:if(this.popupRef.visible&&H>0){this.set("selectedIndex",(L+H-1)%H);this.synchronize();}break;case C.DOWN:if(!this.popupRef.visible&&H>0){this.togglePopup();}this.set("selectedIndex",(L+1)%H);this.synchronize();break;default:if(J===this.lastSearchPattern){return ;}var K=[];if(J&&J.length>0&&J.indexOf(this.lastSearchPattern)>-1){K=D.apply(this,[J,this.items]);}else{K=D.apply(this,[J,this.allItems]);}this.set("items",K);if(K.length===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}this.set("selectedIndex",undefined);if(J&&J.length){var G=mstrmojo.array.find(K,this.itemField,J);if(G!==-1){this.set("selectedIndex",G);}}}if(F&&!B(this.selectedIndex)){this.set("value",this.inputNode.value);}this.lastSearchPattern=J;},onblur:function(F){this.isEditing=false;if(!this.searchEnabled){return ;}if(!this.allowCustomInput){this.items=this.allItems;this.synchronize();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo.Label","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ui._HasUITheme","mstrmojo.Button","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.tooltip","mstrmojo.ui.editors.ErrorDialogContent");var h=mstrmojo.func.composite,M=mstrmojo.dom,Z=mstrmojo.Button.newWebButton,C=mstrmojo.css,Y=mstrmojo.all,N=mstrmojo.hash,W=mstrmojo.array;function V(p){if(!this.modal){return ;}var q=window.mstrApp;if(q&&q.modalEditorChange){q.modalEditorChange(this.id,p);}}mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,themeClassName:"mojo-theme-light",useRichTooltip:true,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mouseup,mousedown,click,contextmenu>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function X(){return this.domNode.firstChild;},titlebarNode:function l(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function R(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},helpNode:function m(){return this.showTitle?this.domNode.firstChild.firstChild.children[1]:null;},closeNode:function E(){return this.showTitle?this.domNode.firstChild.firstChild.lastChild:null;},containerNode:function S(){return this.domNode.firstChild.childNodes[2];},buttonNode:function I(){return this.domNode.firstChild.childNodes[3];},curtainNode:function n(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var p=this.zIndex;this.editorNode.style.zIndex=p;this.curtainNode.style.zIndex=p-1;},onvisibleChange:function(s){if(s){return ;}var r=this.visible,q="closeEffect",p="none";if(r){q="openEffect";p="block";}if(this[q]){this.playEffect(q);}else{this.editorNode.style.display=p;if(this.modal){this.curtainNode.style.display=p;}}},onhelpChange:function d(){if(this.showTitle){var q=this.help,p=this.helpNode;if(!q){p.style.display="none";}else{p.style.display="block";}}},onleftChange:function F(){this.editorNode.style.left=this.left||"";},ontopChange:function H(){this.editorNode.style.top=this.top||"";}},open:function Q(q,p){this._super(q,p);V.call(this,true);},close:function f(p){this._super(p);V.call(this,false);},unrender:function B(p){this._super(p);V.call(this,false);},destroy:function g(p){this._super(p);V.call(this,false);},preBuildRendering:function A(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;V.call(this,true);}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function k(){return this.titlebarNode;},getMovingTarget:function U(){return this.editorNode;},onPreClose:function G(){this.hideTooltip();return true;},premousedown:function P(p){var q=p.getTarget();if(q===this.closeNode||q===this.helpNode){C.toggleClass(q,"active",true);}},premouseup:function O(p){var q=p.getTarget();if(q===this.closeNode||q===this.helpNode){C.toggleClass(q,"active",false);}if(p.getTarget()===this.closeNode&&this.onPreClose()){this.close();}},onclick:function c(q){if(q.getTarget()===this.helpNode){if(mstrApp.showHelpTopic){mstrApp.showHelpTopic(this.help);}else{var p=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm#");window.open(p+(this.help||""),"_blank");return false;}}},_set_visible:function b(u,r){var q=(this[u]!==r);if(q){this[u]=r;var t=this._close_handler;if(r){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var s=this;t=this._close_handler=t||function(w){var x=M.eventTarget(self,w);if(x&&x.parentNode&&!M.contains(s.editorNode,x,true,document.body)){s.close();}};M.attachEvent(document.body,"mousedown",t);}}else{var p=this._curtain_handler;if(p){M.detachEvent(window,"resize",p);}if(t){M.detachEvent(document.body,"mousedown",t);}}}return q;},showTooltip:function o(w,u){var s=this,q=M.findAncestorByAttr(M.eventTarget(u,w),"tooltip",true,this.domNode),r=q&&q.value;if(!s.hasOpenTooltip&&r){var p=M.position(q.node);s.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:r,top:Math.max(p.y+40,0),left:Math.max(p.x+4,0),posType:mstrmojo.tooltip.POS_TOPCENTER};this._super(w,u);}}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(p){p=Math.round(p);return["rgb(",p,",",p,",",p,")"].join("");}}},preStart:function(){var q=this.target,p=this.widget;p.editorNode.style.display="block";if(!p.modal){return false;}q.style.display="block";C.setOpacity(q,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var p=this.widget;p.editorNode.style.display="none";return !!p.modal;}};function D(p){return function(){Y[p].destroy();};}function J(q,y,z,AA){var p=y.id||"mojoAlertx9",u,x=y.buttons;W.forEach(x,function(AC){var AB=AC.onclick;AC.onclick=function(AD){var AE=Y[p];if(AB&&AB.call(AC,AD)===false){return ;}AE.destroy();AE=null;};});try{Y[p].destroy();}catch(w){}var r=y.cssClass,s=[];if(r){s.push(r);delete y.cssClass;}if(AA){s.push(AA);}s.push("mstrmojo-alert");u={scriptClass:"mstrmojo.Editor",id:p,width:"475px",zIndex:1000,title:z||mstrmojo.desc(11812,"Notification"),cssClass:s.join(" "),children:[{scriptClass:"mstrmojo.Label",cssClass:"alert-content",text:q,allowHTML:y.allowHTML}],visible:true};var t=new mstrmojo.Editor(N.copy(y,u));t.render();return t;}if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.notify=function L(q,x,r){r=r||{};var y=r.forceClose,w=r.callback||mstrmojo.emptyFn,u=N.copy(x||{},{buttons:y?[mstrmojo.Button.newActionButton((r.buttonText||mstrmojo.desc(8607,"Dismiss")),w)]:null,showTitle:false,modal:false,top:"42px"}),s=r.duration||6000;var t=J(q,u,"",y?"ed-notify":"ed-toast"),p=t.id;if(!y){window.setTimeout(h([w,D(p)]),s);}else{window.setTimeout(function(){if(Y[p]){Y[p].editorNode.style.opacity=0.75;}},6000);}return t;};mstrmojo.confirm=function e(u,q,t){q=q||{};var p=q.confirmBtn||{},s=q.cancelBtn||{},r=[Z(p.t||mstrmojo.desc(219,"Yes"),p.fn,true),Z(s.t||mstrmojo.desc(218,"No"),s.fn)];return J(u,N.copy(t||{},{buttons:r,onPreClose:function(){if(s&&s.fn){s.fn();}return true;}}));};mstrmojo.warn=function K(r,p,q){q=q||{};q.cssClass=(q.cssClass||"")+" mstrmojo-warning";mstrmojo.confirm(r,p,q);};mstrmojo.alert=function a(u,r,t,w,p,s){var q={title:t,zIndex:w,cssClass:p,buttons:[Z(mstrmojo.desc(1442,"OK"),r,true)],onPreClose:function(){if(r){r();}return true;}};N.forEach(q,function(y,x){if(!y){delete q[x];}});return J(u,N.copy(s,q));};mstrmojo.error=function T(t,p,s){var q=t||{};var r=mstrmojo.desc(96,"Error");if(s){r=(s.title)?s.title:mstrmojo.desc(96,"Error");}J("",N.copy(s||{},{buttons:[Z(mstrmojo.desc(1442,"OK"),p,true)],children:[{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",shortDesc:q.shortDesc,longDesc:q.longDesc}]}),r);};}mstrmojo.Editor.ButtonConfigType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var Q=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],X=["width","height"],p="p_fmts";var m="px";var k={getContentHeight:function(s,u){var t=u.ttl&&u.ttl.height;if(s&&t&&!this.floatingToolbar){return Math.max(parseInt(s,10)-parseInt(t,10),0)+m;}return"";},getPortletMinHeight:function(s){return s.ttl.height;},adjustTitleCss:function(){return ;}};var f={getContentHeight:function(s){return s;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(s){s.titlebarNodeClass+=" floating";return ;}};function A(w,t){var u=this.parent,s=w+"DirtyKey";if(u[s]){u[s](t);}}function P(){this.toolbarTitleTextNode.innerHTML=this.title+(this.count?" ("+this.count+")":"");}function h(){var t=this.parent,w=t&&t.defn;if(w&&parseInt(w.t,10)===mstrmojo.EnumRWUnitType.PANEL){var s=t.parent,u=s.defn;if(u&&u.ifp){return s;}}return null;}var R=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,n:"",buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" nm="{@n}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;"></div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){P.call(this);},oncountChange:function(){P.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B","fx","background-color"],shadowNode:["RW","B","fx","background-color"],buttonbarNode:{src:"ttl",props:["background-color"]},titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]}},updateServer:true,fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:k,getCacheKey:function F(){return this._super()+"-portlet";},getFormats:function M(){var t=this.content,s=t&&t.getFormats();return s&&s[p];},updateContentHeight:function d(x){var s=this.getFormats(),t=this.content,w=t.dimNode||t.domNode,u=((s.ttl&&parseInt(s.ttl.height,10))||0);if(w){if(!x){u+=((this.fc||this.isInFilterPanel())?w.offsetHeight:(s.height?parseInt(s.height,10):0));}this.containerNode.style.height=u+m;this.shadowNode.style.height=u+m;}},init:function q(s){this._super(s);var t=this.content;this.n=(s&&s.defn&&s.defn.n)||"";if(t&&t.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var t=this._ts=(this.floatingTitle)?f:k;if(this.isInFilterPanel()){var u=R.clone(this.formatHandlers);u.portletContainerNode=["z-index","height","B","backgroud-color"];u.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=u;}this._super();t.adjustTitleCss(this);var s="display:none;";if(!this.leftToolbar){this.leftToolbarNodeCssText+=s;}if(!this.toolbar){this.toolbarNodeCssText+=s;}var w=mstrmojo._Formattable.getBorderWidths(this);if(w.l||w.t||w.r){this.borderCss="has-border";}},postBuildRendering:function Y(){var w=mstrmojo.dom,AD=this.titleNode,AC=this.onclicktitle;if(this.floatingTitle&&this.titleNode){document.body.appendChild(this.titleNode);var x=mstrmojo.css,z=this.contentNode,AA=this;if(!this._onhover){this._onhovertt=function(){x.addClass(AA.titleNode,["visible"]);AA._onflt=true;return true;};this._onhoverofftt=function(){x.removeClass(AA.titleNode,["visible"]);AA._onflt=false;return true;};this._onhover=function(){var AE=AA.titleNode;x.addClass(AE,["visible"]);var AF=w.position(AA.contentNode,true);AE.style.top=(AF.y-AE.clientHeight+2)+m;AE.style.left=AF.x+m;return true;};this._onhoveroff=function(){x.removeClass(AA.titleNode,["visible"]);return true;};}w.attachEvent(z,"mouseover",this._onhover);w.attachEvent(z,"mouseout",this._onhoveroff);w.attachEvent(AD,"mouseover",this._onhovertt);w.attachEvent(AD,"mouseout",this._onhoverofftt);}if(AD&&AC){w.attachEvent(AD,"click",AC);}if(this._super){this._super();}var y=this.getFormats();this.set("fc",y&&!y.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var s=this.portletContainerNode.style,u=this.shadowNode.style,AB=this.parent;s.width=u.width="99%";s.top=u.top=AB.topStart+m;s.left=u.left=G+m;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(y.left,10)+G*this.orgPos+m;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}if(this.buttonbarNode.clientHeight>0){this.buttonbarNode.style.height=this.buttonbarNode.clientHeight*this.model.getZoomFactor()+"px";}},adjustFPHeight2Fit:function(){var u=mstrmojo.dom,s=u.position(this.titleNode),t=u.position(this.contentNode).y-s.y-s.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height,10)-t+"px";},unrender:function E(u){if(this.floatingTitle&&this.titleNode){var x=this.domNode,s=this.titleNode,w=mstrmojo.dom;if(x&&this._onhover){w.detachEvent(x,"mouseover",this._onhover);}if(x&&this._onhoveroff){w.detachEvent(x,"mouseout",this._onhoveroff);}if(s&&this._onhovertt){w.detachEvent(s,"mouseover",this._onhovertt);}if(s&&this._onhoverofftt){w.detachEvent(s,"mouseout",this._onhoverofftt);}if(s){document.body.removeChild(s);}}if(this._super){this._super(u);}},updateStyle:function(t,s){var x=this.shadowNode.style,u=this.containerNode.style;x.height=u.height=t;x.width=u.width=s;},_createFormats:function V(){var y=this.content&&this.content.getFormats(),w;w=y.p_fmts={};var s,x;for(s in Q){x=Q[s];if(y[x]!==undefined){w[x]=y[x];delete y[x];}}for(s in X){x=X[s];if(y[x]!==undefined){w[x]=y[x];}}y.height=this._ts.getContentHeight(y.height,w);if(mstrmojo.dom.isIE&&w.fx&&w.fx.ds&&!w["background-color"]){w["background-color"]="#ffffff";}var u=w.ttl,t=u&&u["background-color"];if(t){this.titlebarNodeClass=mstrmojo.color.getContrastingColor(t,"light","dark");}},refresh:function r(){if(!this.hasRendered){return ;}var t=this.children,s;for(s=t.length-1;s>=0;s--){t[s].refresh();}},isInFilterPanel:function L(){return(h.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var s=this.getFilterPanel();return s&&s.defn&&parseInt(s.defn.fds,10)===2;}return false;},getFilterPanel:function H(){return h.call(this);},getContainerHeight:function c(){return this.containerNode.clientHeight;},relocate:function C(s){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=s+m;}},setInfoWindowDimensions:function o(x){var t=this.domNode.style,s=this.shadowNode.style,u=this.portletContainerNode.style,w=mstrmojo._Formattable.getBorderWidths(this);x.h-=w.h;x.w-=w.w;s.height=u.height=t.height=x.h+m;s.width=u.width=t.width=x.w+m;x.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function K(s){A.call(this,"add",s);},removeDirtyKey:function J(s){A.call(this,"remove",s);},setDirtyChildren:function Z(){var s=this.content;if(s&&s.setDirtyChildren){s.setDirtyChildren.apply(s,arguments);}}});var W=0,O=1,l=2;function N(s){var t=this.content.defn;if(t){t.set("ds",s);}}function n(s){return{FormattingOrder:{ZIndex:this.getFormats()["z-index"]},FormattingView:{WindowState:s}};}function a(AE,AC,s,AF){var AB=this.content,AD=AB.k,AA=mstrmojo.boxmodel.px2Inches,u=AB.model.docModel||AB.model,AH=u.getZoomProps(),x=this.getFormats(),t=AC!==undefined&&s!==undefined,AG={},y=this,z=n.call(this,AE);if(t){z.FormattingSize={OldHeight:AA(AH,AC),OldWidth:AA(AH,s),Height:AA(AH,parseInt(x.height,10)),Width:AA(AH,parseInt(x.width,10))};}AG.success=function(w){var AI=w&&w.data;if(AI){u.loadPartialData(AI,AD);}N.call(y,AE);var AJ=y.parent;if(AJ.adjustSectionSize&&t){AJ.adjustSectionSize();}};u.updateUnitFormat(AB,1,z,AG,{params:{suppressData:true},config:t?null:{silent:true},preserveUndo:true});if(!t&&!(AF&&AF.all)){u.saveRWProps(AD,props,1,this.loadDataOnResize,AG,true);}}function T(){var z=this.content;if(!z){return ;}var x=function(AD){mstrmojo.array.forEach(AD,function(AE){if(AE.ds!==undefined){AE.set("visible",(AE.ds!==z.defn.ds));}});},AA;if(this.isInFilterPanel()){var u=(parseInt(this.defn.ds,10)===W);z.set("visible",u);this.updateContentHeight(!u);AA=this.leftToolbar;x(AA&&AA.children);var w=this.parent;if(w.refreshFP){w.refreshFP();}}else{var s=z.getFormats(),AB=this.getFormats(),t=this.portletContainerNode.style,AC=this.shadowNode.style,y=this.contentNode.firstChild.style;y.height=s.height;y.width=s.width;AC.height=t.height=AB.height;AC.width=t.width=AB.width;AC.top=t.top=AB.top;AC.left=t.left=AB.left;if(AB["z-index"]!==undefined){AC.zIndex=t.zIndex=AB["z-index"];}AA=this.rightToolbar;x(AA&&AA.children);if(z.resize){z.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function V(){this._super();var t=this.getFormats();var s=parseInt(this.defn.ds,10);if(s===W){t.normHeight=t.height;t.normWidth=t.width;if(t["z-index"]!==null&&t["z-index"]!==undefined){t.normZIndex=t["z-index"];}}if(s!==l){t.normTop=t.top;t.normLeft=t.left;}},onmaximize:function e(){var w=this.parent,z=this.content,y=z&&z.getFormats(),u=this.getFormats(),t=u.height,s=u.width,x=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();z.clearCache();u.height=(parseInt(w.getHeight(),10)-x.h)+m;y.height=this._ts.getContentHeight(u.height,u);u.width=y.width=(w.getWidth()-x.w)+m;u.top=u.left=0;u["z-index"]=w.getMaxZIndex()+1;a.call(this,l,t,s);},onminimize:function b(){var y=this.content,t=y.dimNode||y.domNode,x=y&&y.getFormats(),w=this.getFormats(),u=w.height||t.offsetHeight,s=w.width;this.clearCache();y.clearCache();w.width=x.width=w.normWidth;w.top=w.normTop;w.left=w.normLeft;if(w.normZIndex!==null&&w.normZIndex!==undefined){w["z-index"]=w.normZIndex;}x.height=0;w.height=this._ts.getPortletMinHeight(w);a.call(this,O,u,s);},onrestore:function S(){var x=this.content,w=x&&x.getFormats(),u=this.getFormats(),t=u.height,s=u.width;this.clearCache();x.clearCache();u.height=u.normHeight;w.height=this._ts.getContentHeight(u.height,u);u.width=w.width=u.normWidth;u.top=u.normTop;u.left=u.normLeft;if(u.normZIndex!==null&&u.normZIndex!==undefined){u["z-index"]=u.normZIndex;}a.call(this,W,t,s);},changeWindowState:function I(u){N.call(this,u);var t=this.content,x=n.call(t,u),s=t.model.docModel||t.model;return s.getUnitFormatAction(t,1,x);},oncollapse:function U(s){a.call(this,O,undefined,undefined,s);},onexpand:function D(s){a.call(this,W,undefined,undefined,s);},adjustFP:function g(){var t=(parseInt(this.defn.ds,10)===W);this.content.set("visible",t);this.updateContentHeight(!t);var s=this.parent;if(s.refreshFP){s.refreshFP();}},postBuildRendering:function Y(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,T);}this._super();if(this.isInFilterPanel()){var s=(parseInt(this.defn.ds,10)===W);this.updateContentHeight(!s);}}});mstrmojo.DocPortlet.ST_RESTORE=W;mstrmojo.DocPortlet.ST_MAX=l;mstrmojo.DocPortlet.ST_MIN=O;}());(function(){mstrmojo.requiresCls("mstrmojo.LegacySuggestionList","mstrmojo.ui._HasScroller");var C=mstrmojo.dom;mstrmojo.ui.ScrollableSuggestionList=mstrmojo.declare(mstrmojo.LegacySuggestionList,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-scrollable-suggestlist {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function B(){return this.domNode.firstChild.firstChild;},scrollboxNode:function E(){return this.domNode.firstChild;},scrollNode:function H(){return this.domNode.firstChild;}},onclick:function A(I){var J=this.getItemFromTarget(I.getTarget());if(J){this._super(I);}},onitemsChange:function D(){var I=this;window.setTimeout(function(){I.hideTooltip();I.updateScrollbars();},0);},updateScrollbars:function F(){this._super();var K=this,M=K.scrollNode,I=M.clientWidth,L=K.itemsContainerNode,J=L.clientWidth;L.style.width="auto";window.setTimeout(function(){if(I>J){L.style.width=J+(I-J)+"px";}},10);},useRichTooltip:true,getItemTooltip:function(L,M){var J=C.position(M),K=M.ttp;var I={areaId:L._renderIdx+"text",cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:K,top:J.y,left:J.x+J.w+6,enableHover:false};return I;},showTooltip:function G(I,L){var K=this.targetEl,J=this.targetItem;if(K&&K.ttp){this.richTooltip=this.getItemTooltip(J,K);if(this.richTooltip){this._super(I,L);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz");var A={render:function(F,B,G){var H=(G.htmlName+B),D=G.selectedIndices[B]?"checked ":"",E=D?" selected":"",C=F.v!=="u;"?" nAll":"";return'<div class="'+G.itemCssClass+E+C+'"><input type="'+G.inputType+'" name="'+G.htmlName+'" id="'+H+'" value="'+B+'" '+D+'/><label for="'+H+'" title="'+(F[G.itemTitleField]||"")+'" style="'+G.labelCssText+'">'+F[G.itemDisplayField||"n"]+"</label></div>";},select:function(D,E,B,F){var C=D&&D.firstChild;if(C&&!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);},unselect:function(D,E,B,F){var C=D&&D.firstChild;if(C&&C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);},rowHeight:23};mstrmojo._RendersInputItems=mstrmojo.provide("mstrmojo._RendersInputItems",{inputType:null,htmlName:null,itemRenderer:A,init:function(B){this._super(B);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(E){var D=E.hWin,G=E.e,F=mstrmojo.dom.eventTarget(D,G);if(F&&F.nodeName.match(/input/i)){var C=parseInt(F.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(C);}else{var B=(F.checked)?"add":"remove";this[B+"Select"](C);}}}});mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxBase");mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(D,A,E){var B=D.v!=="u;"?" nAll":"",C=(E.enabled===false);return'<input mstridx="'+A+'" class="'+E.itemCssClass+(E.selectedIndices[A]?" "+E.itemSelectedCssClass:"")+" "+(D.css||"")+B+'" style="'+E.itemCssText+'" type="button"  value="'+D[E.itemDisplayField]+'" '+(C?"disabled ":"")+"/>";};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});}());(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz","mstrmojo.hash");mstrmojo.CheckList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.CheckList",inputType:"checkbox",cssClass:"mstrmojo-CheckList",itemCssClass:"mstrmojo-CheckList-item"});mstrmojo.requiresCls("mstrmojo._InputListHoriz");mstrmojo.CheckListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.CheckListHoriz",inputType:"checkbox",cssClass:"mstrmojo-CheckListHoriz",itemCssClass:"mstrmojo-CheckListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=Y?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=Y?0:U-1;}else{V+=Y?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,disableClick:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(h){var d=this.candidates,a=d&&d.items,X=d&&d.isComplete,g=this._last_hit;if(!this.noCache&&(d||g)){var f=this.filterCandidates(a,h,this.REQUEST_THRESHOLD),b=f.length,e=this.suggestCount,U=false;if(!X&&b<e){var V=g&&g.pattern;if(g&&V&&(h.indexOf(V)>-1)){U=true;var l=this.filterCandidates(g.items,h,this.REQUEST_THRESHOLD),Y=l&&l.length,W=mstrmojo.array,k=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(f,k,l[Z][k])===-1){f.push(l[Z]);}}b=f.length;}}if(!X&&((h.length>2&&b<this.REQUEST_THRESHOLD)||(b<e))){this.requestCandidates(h);return -1;}return(b<e)?f:f.slice(0,e);}this.requestCandidates(h);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(e){if(!e){return ;}var d=X.getSuggestionTarget();if(!d||(V!==d)){return ;}var k=d.getSearchPattern(),a=e.items;X._last_hit={items:a,pattern:U};X.sz=e.sz;if(!X.noCache&&a){var f=(X.candidates&&X.candidates.items)||[],g=[].concat(a),b=a.length,Z;for(Z=0;Z<b;Z++){var Y=g[Z];if(mstrmojo.array.indexOf(f,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=f.concat(a);}}if(k&&k.indexOf(U)>-1){var h=X.filterCandidates(a,k);X.updateSuggestion(h);}},failure:function(Y){if(Y.getResponseHeader){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:(V?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}if(this.autoSelect&&W){W.list.singleSelect(0);}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U,V){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var W=this.zIndex;this.openPopup("ob",{zIndex:(W&&(W+10))||110});this.ob.browser.browse(mstrmojo.hash.copy(V,{folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes}));this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopupCssClss:"",suggestionPopup:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-ObjectInputBox-suggest",autoClose:true,locksHover:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U){mstrmojo.css.addClass(this.domNode,U.suggestionPopupCssClss||"");if(U.autoSelect){this.list.singleSelect(0);}if(U.nudge){U.nudge(this);}}},onClose:function F(){this.list.clearSelect();var U=this.opener;if(U){U.suggestionShown=false;mstrmojo.css.removeClass(this.domNode,U.suggestionPopupCssClss||"");}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.PopupConfig","mstrmojo.ui.menus.MenuEditor");mstrmojo.ui.menus.EditorConfig=mstrmojo.declare(mstrmojo.ui.menus.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.EditorConfig",data:null,fnOk:null,fnCancel:null,okEnabled:true,cancelEnabled:true,okVisible:true,cancelVisible:true,init:function D(E){this._super(E);if(this.data&&!mstrmojo.all[this.data.id]){mstrmojo.hash.make(this.data,mstrmojo.Obj);}this.initBindings();},clear:function A(){this._super();this.data=null;this.fnOk=this.fnCancel=mstrmojo.emptyFn;},newInstance:function C(){return new mstrmojo.ui.menus.MenuEditor({popupConfig:this});},destroy:function B(){if(this.data){this.data.destroy();}this.destroyBindings();this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ui.editors.controls.ValidationTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,null,{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",errRevert:true,dtp:null,validationDelay:3000,orignText:null,trigger:mstrmojo.validation.TRIGGER.ONKEYUP,init:function(B){B=B||{};B.constraints=B.constraints||{};B.constraints.trigger=this.trigger;this._super(B);},prekeyup:function(B){if(B.e.keyCode===13){this.blur();return ;}this._super(B);},onfocus:function(){this.orignText=this.value;},onblur:function(){if(this.value!==this.orignText){this.validate();}},validate:function(){this._super();this.orignText=this.value;this.clearValDelayTimer();},preinput:mstrmojo.emptyFn,postinput:function(){var B=this.doValidation(this.value);if(B.code<=mstrmojo.validation.STATUSCODE.VALID){this.clearValidation();if(!this.errRevert){this.hideTooltip();}}},updateTooltipConfig:function(){this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onInvalid:function(){if(!this.errRevert){this.hideTooltip();this.showTooltip();}else{this.clearValidation();this.set("value",this.orignText);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.Menu","mstrmojo.hash","mstrmojo.array");mstrmojo.ui.menus.MenuItemType=null;var U="separator";mstrmojo.ui.menus.MenuConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.MenuConfig",menus:null,menuCssClass:"",supportsScroll:false,maxHeight:0,hasMenuItems:function Q(){return !!this.menus.length;},getMenuItems:function E(V){return mstrmojo.array.filter(this.menus.slice().reverse(),function(Z,Y,X){var W=X[Y+1];return V||Z.cls!==U||(Y&&W&&W.cls!==U);}).reverse();},getMenuItem:function C(Y){var X=this.menus,V;if(X!==null){for(V=0;V<X.length;V++){var W=X[V];if(W.cls===Y){return W;}}}return null;},absorbMenuItems:function S(V){this.menus=this.menus.concat(V.menus);},addMenuItem:function I(c,Y,a,W,Z){var b,X,V;if(!c||typeof c==="string"){b=c;}else{b=c.n;X=c.ttp;}V={n:b,ttp:X,cls:Y,fn:a,ctxt:W};if(isNaN(Z)||Z>=this.menus.length){this.menus.push(V);}else{this.menus.splice(Z,0,V);}return V;},addCustomMenuItem:function T(a,X,Z,W,V){var Y=this.addMenuItem(a,X,Z,V);Y.getItemMarkup=W;return Y;},addDisabledMenuItem:function O(W,V){this.addNonInteractiveMenuItem(W,V,true);},addNonInteractiveMenuItem:function M(Z,W,V){var X=["non-int"];if(W){X.push(W);}if(V){X.push("disabled");}var Y=this.addMenuItem(Z,X.join(" "),mstrmojo.emptyFn);Y.dsbld=true;},addSeparator:function D(){this.addMenuItem("",U,function(){return false;});},addPopupMenuItem:function R(c,X,b,Y,W,Z){var a=["pop "];if(Y){a.push(Y);}var V=this.addMenuItem(c,a.join(" "),b,W,Z);V.pop=true;V.scope=X;return V;},addActionPopupMenuItem:function L(c,W,a,b,X,V,Z){var Y=this.addPopupMenuItem(c,W,b,(X||"")+" ax",V,Z);Y.actionFn=a;Y.ax=true;},addSubMenuItem:function K(Z,X,W,Y,V){this.addPopupMenuItem(Z,W,Y,X,V);},addEditorMenuItem:function P(Z,W,Y,V,X){this.addPopupMenuItem(Z,W,Y,"",V,X);},getToggleItemStates:function F(d,f,V,b,X,a){var Y,Z,W,c;if(typeof d==="string"){Y=Z=d;W=c="";}else{Y=d.on||"";Z=d.off||"";W=d.ttpOn||"";c=d.ttpOff||"";}var e=[{n:Y,ttp:W,cls:f+" on",fn:b,ctxt:a},{n:Z,ttp:c,cls:f,fn:V,ctxt:a}];if(!X){e.reverse();}return e;},addToggleMenuItem:function J(c,Y,a,X,W,b,V){var Z=this.getToggleItemStates(c,Y,a,X,b,V);return this.addDualStateItem(W,Z[0],Z[1]);},addDualStateItem:function G(W,V,X){return this.addMenuItem({n:V.n,ttp:V.ttp},V.cls,this.getDualStateHandler(W,V,X),V.ctxt);},getDualStateHandler:function H(W,V,X){return function(Z,a){var Y=[V,X];if(Z.cls===V.cls){Y.reverse();}Y[1].fn.call(mstrmojo.all[W],Z,a);Z.n=Y[0].n;Z.ttp=Y[0].ttp;Z.cls=Y[0].cls;};},addRadioMenuGroup:function B(X,c,Y,W,V,b,a){var Z=[];Y.forEach(function(g,d){if(g.separator){this.addSeparator();return ;}var k=g.text,h=(W||"")+" "+(g.cls||"")+(b?"":" radio")+(g.value===X?" on":""),f=function(){if(c.call(this.ctxt,g.value,X,g)===false){return false;}X=g.value;Z.forEach(function(l){l.cls=l.cls.replace(/ on$/,"")+(l.radioValue===X?" on":"");});return true;},e=a?this.addCustomMenuItem(k,h,f,a(g,d),V):this.addMenuItem(k,h,f,V);e.radioValue=g.value;Z.push(e);},this);},clear:function N(){this._super();this.menus=[];},newInstance:function A(V){return new mstrmojo.ui.menus.Menu(mstrmojo.hash.copy({popupConfig:this},V));}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.ui.menus.Menu","mstrmojo._IsList","mstrmojo.vi.ui._HasMask","mstrmojo.dom","mstrmojo.hash","mstrmojo.string","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui._HasListTooltip");var F=mstrmojo.dom;mstrmojo.vi.ui.toolbars.Toolbar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.vi.ui.toolbars.Toolbar",tooltipOrientation:"vertical",init:function G(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-VIToolbar");},selectionPolicy:"reselect",toolbarCfg:null,toolbarClicked:mstrmojo.emptyFn,tooltipCss:null,_set_toolbarCfg:function(L,I){var J=this.toolbarCfg,K=(J!==I);if(K){if(J){J.destroy();}this.toolbarCfg=I;}return K;},getItemProps:function D(K,I){var J=this._super(K,I);J.addCls(K.cls);J.addStyle("display:inline-block");return J;},postBuildRendering:function C(){var I=document.createElement("div");I.className="mstrmojo-VIDND-mask";this.maskNode=this.domNode.appendChild(I);return this._super();},postselectionChange:function(I){var J=I.added;if(J){var K=this.items[J[0]];if(K.tp==="pb"&&K.isMenuClicked){K.menufn(K,this);}else{K.fn(K,this);}}},ontoolbarCfgChange:function H(I){var K=I.valueWas;if(K){K.destroy();}var J=I.value;if(!J){return ;}this.set("items",J.btns);if(this.hasRendered){this.raiseEvent({name:"renderComplete"});}},openMenu:function E(J,I){J.hostId=this.id;J.hostElement=this._getItemNode(I._renderIdx);this.openPopup(J.newInstance());},onclick:function A(I){var K=I.target||F.eventTarget(I.hWin,I.e),J=this.getItemFromTarget(K);if(J&&J.tp==="pb"){if(K&&K.className){J.isMenuClicked=K.className.indexOf("icn")===-1;}}this.toolbarClicked(I);this._super(I);},destroy:function B(J){var I=this.toolbarCfg;if(I){I.destroy();}delete this.items;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo.ui._IsPulldown","mstrmojo.ui.PopupList","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var I=mstrmojo.css,G=mstrmojo.array,F=mstrmojo.dom;mstrmojo.ui.Pulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown],{scriptClass:"mstrmojo.ui.Pulldown",onitemSelected:mstrmojo.emptyFn,allowHTML:true,init:function N(O){this._super(O);I.addWidgetCssClass(this.list,"ctrl-popup-list");},initChildren:function E(){this.children=this.getPopupListConfig();this._super();},getSelectedItem:function H(){var O=this.items;return O&&O[this.selectedIndex];},selectItemByField:function J(P,O){this.set("selectedIndex",G.find(this.items||[],P,O));},getPopupWidget:function D(){return this.list;},getPopupList:function K(){return this.list;},_set_items:function B(R,O){var Q=this.items;this.items=O;delete this.selectedIndex;if(Q!==O){var P=this.hasRendered;if(P){this.refresh();}return true;}return false;},onclick:function M(O){this._super(O);var Q=this,P=Q.getPopupWidget();Q.mw=Q.mw||function(R){if(!F.contains(P.domNode,F.eventTarget(self,R),true,document.body)){P.close();F.detachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Q.mw);}};F.attachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Q.mw);},_set_selectedIndex:function A(T,R){if((R!==0&&!R)||R<0){return false;}var P=this.selectedIndex=R,O=this.getPopupList(),Q=O.items,S=this.selectedNode;O.set("selectedIndex",P);if(S&&Q&&Q[P]){S.innerHTML=this.allowHTML?Q[P].n:mstrmojo.string.encodeHtmlString(Q[P].n);S.title=Q[P].title||"";}this.onitemSelected(Q[P],P);return true;},getPopupListConfig:function C(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,listHooks:{select:function O(R,S,Q){this.parent.set("selectedIndex",Q);this.close();}},getItemProps:function P(S,Q){var R=mstrmojo._IsList.getItemProps.call(this,S,Q);R.style=this.parent.itemCssText||"";return R;}};},children:[]});mstrmojo.ui.Pulldown.newPulldown=function L(P,T,O,S,R){S=S||{};S.items=P;var Q;if(R===true){Q=mstrmojo.hash.copy({scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:O||0},S);}else{Q=new mstrmojo.ui.Pulldown(S);if(O!==undefined){Q.set("selectedIndex",O);}}Q.postselectedIndexChange=function(U){var X=U.value,W=U.valueWas;if(X!==W){var V=this.items;T.call(this,V[X],V[W]);}};return Q;};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.PopupList","mstrmojo.array","mstrmojo.css");var F=mstrmojo.css,E=mstrmojo.array;mstrmojo.ui.editors.controls.ListPreviewButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ListPreviewButton",init:function G(L){this._super(L);var M=this.getListCfg(),K=this.itemValueField;M.alias="list";M.locksHover=true;M.slot="widgetHostNode";M.listHooks={select:function J(N,O){this.parent.set("selectedValue",O[K]);this.close();}};M.setDimensions=mstrmojo.emptyFn;this.addChildren([M]);F.addWidgetCssClass(this.list,"ctrl-popup-list");},getPopupWidget:function D(){return this.list;},items:null,onitemsChange:function H(){var J=this.items;if(J){this.list.set("items",J);}},selectedValue:"",itemValueField:"n",onselectedValueChange:function C(){var K=this.selectedValue,J=this.itemValueField,L=this.list;L.selectItems(E.filter(L.items||[],function(M){return M[J]===K;}),true);this.updatePreview();},updatePreview:function B(){throw new Error(this.scriptClass+" must implement updatePreview.");},getListCfg:function I(){return{scriptClass:"mstrmojo.ui.PopupList",selectionPolicy:"reselect"};},postBuildRendering:function A(){this.onitemsChange();this.onselectedValueChange();return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TreeNode","mstrmojo._IsExprNode","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.expr","mstrmojo._HasOwnAvatar");var F=mstrmojo.array,M=mstrmojo.expr,P=mstrmojo.dom,A=mstrmojo.css;function J(R,Q){var T=R.data,S=T&&T.nds;if(!S){return null;}if(Q){Q.sort(F.numSorter);}else{Q=R.sortSelectedIndices();}if(!Q.length){return null;}return{idxs:Q,nds:F.get(S,Q)};}function N(S){var R=S.ctxtBuilder,U=R&&R.itemWidgets,Q=U&&U[0],T=Q&&Q.data;if(T&&T.not&&(U.length>0)){delete T.not;Q.paint();}}mstrmojo.AndOrNode=mstrmojo.declare(mstrmojo.TreeNode,[mstrmojo._IsExprNode,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.AndOrNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},itemsContainerPrefix:function(){return this.domNode.childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[2].firstChild;},dropCueNode:function(){return this.domNode.childNodes[2].lastChild;},itemsContainerSuffix:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onitemCntChange:function(){A.toggleClass(this.itemsContainerNode,["multi"],this.itemCnt>2);},onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();},ondropCuePosChange:mstrmojo.TreeNode.prototype.markupMethods.ondropCuePosChange},multiSelect:true,itemIdField:null,init:function(Q){this._super(Q);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());var R=this.data;if(R){delete this.data;this._set_data(null,R);}},itemCnt:0,postBuildRendering:function(){var Q;this.set("itemCnt",this.items.length);if(this._super){Q=this._super();}N(this);return Q;},preadd:function L(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},preremove:function O(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},_set_data:function(T,Q){var R=this.data,S=(R!==Q);if(S){this.data=Q;if(Q&&!Q.nds){Q.nds=[];}this.set("items",Q&&Q.nds);}return S;},isDragValid:function K(){return true;},isSelectableArea:function(Q){return false;},getDragData:function(Q){var S=this._super(Q);if(S&&!S.html){var R=S.et&&M.ET2TGT[S.et];S.html=R?S[R]&&S[R].n||"":S.n||"";}return S;},remove:function I(R,S){var Q=this._super(R);if(Q>-1){var T=S||this.suppressConsolidation;if(!T){this.consolidate(false);}}return Q;},move:function(R,Q){this.suppressConsolidation=true;var S;if(this._super){S=this._super(R,Q);}this.suppressConsolidation=false;return S;},consolidate:function E(){var U=this.parent;if(!U||!U.remove){return ;}var S=this.items,R=S&&S.length;if(R<2){var T=R?S[0]:null,Q=this.childIndex();if(T){U.add([T],Q);}U.remove(this.data);}},indent:function G(S,Q){var R=J(this,S);if(!R){return ;}this.remove(R.idxs,true);var W=R.nds,V=Q&&Q.fn||this.data&&this.data.fn,U={et:M.ET.ANDOR,nds:W,fn:V};if(W.length===2&&W[0].not){if(W[1].not){delete W[0].not;delete W[1].not;U.not=true;U.fn=(V===M.FN.AND?M.FN.OR:M.FN.AND);}else{var T=W[0];W[0]=W[1];W[1]=T;}}this.add([U],R.idxs[0]);this.consolidate(false);},outdent:function C(R){var S=this.parent,Q=S&&S.data;if(!Q||Q.et!==M.ET.ANDOR){return ;}var T=J(this,R);if(!T){return ;}this.remove(T.idxs,true);if(this.data.not){T.nds[0].not=true;}S.add(T.nds,this.childIndex());this.consolidate(false);},edit:function D(Z,a,S){if(!Z){return ;}var Y=this.data,X=Y&&Y.fn,R=Z.data,f=R&&R.not;if(!R){R={};Z.data=R;}R.not=!!S;if(X!==a){var Q=Y.nds;if(Q&&Q.length>2){var e=Z.childIndex();if(e>0){this.indent([e-1,e],{fn:a});}}else{Y.fn=a;var V=this.ctxtBuilder,U=V&&V.itemWidgets;for(var T=0,W=(U&&U.length)||0;T<W;T++){var b=U[T];if(b){b.paint();}}}}else{Z.paint();}},preclick:function H(Q){var S=null,R=P.eventTarget(Q.hWin,Q.e);if(R===this.prefixNode){}else{if(P.contains(this.prefixNode,R,true)){S="andor";}}Q.part=S;},createAvatar:function B(S){var R=document.createElement("div"),T=P.findWidget(S),Q=T.getAvatarNode&&T.getAvatarNode();if(!Q){Q=T.condNode.cloneNode(true);Q.style.boxSizing="border-box";Q.style.width=T.condNode.offsetWidth+"px";}R.appendChild(Q);A.addClass(R,T.avatarCssCls||"mstrmojo-FE mstrmojo-ConditionNode");R.style.zIndex=20;return R;},_ndsToMove:J});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.hash","mstrmojo.func","mstrmojo.css","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.mstr.ui.IncFetchOBList");var O=mstrmojo.hash,W=mstrmojo.func,L=mstrmojo.meta.TP,F="5CECE58CC1D549F890EB61C4DB2156A3",T="E0CCB9CF22104A489CBE78D974AFD19E",Q=mstrmojo.chart.model.enums.EnumDSSObjectType,K=mstrmojo.array,D=mstrmojo.dom,X=function(f,g,a){var d=f.scrollableIncFetch,c=d?"mstrmojo.mstr.ui.IncFetchOBList":"mstrmojo.OBList",e={scriptClass:c,items:g.items,multiSelect:a};if(d){e.browseConfig={blockBegin:g.bb,blockCount:g.bc,totalSize:g.sz,folderLinksContextId:f.folderLinksContextId,rootFolderID:g.did,browsableTypes:f.browsableTypes,browsableViewMedias:f.browsableViewMedias,dataProvider:f.dataProvider};e.onwaitingChange=function(){if(f.booklet){f.booklet.set("waiting",this.waiting);}};}var b=mstrmojo.insert(e);b.render();return b;},A=function(c,d,a){var b=mstrmojo.ObjectBrowser.widgetHandler||X;return b(c,d,a);},N={success:function(c){var d=this.ob,b=c.items,e=d.pageCache[d.currentPage],a=e._w;e.items=b;a.set("items",b);this.ob=null;this.item=null;window.clearTimeout(d._btm);d.booklet.set("waiting",false);if(d.scrollableIncFetch&&a.scrollNode){a.initScroll();a.updateScrollbars();}},failure:function(a){window.alert(a.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},S=function(f,e,c){var d=c?-1:1,b=f.pageCache.length,g;for(g=f.currentPage+d;g<b&&g>=0;g+=d){var a=f.pageCache[g];if(a._k===e.k){return{steps:g-f.currentPage,cache:a};}}return null;},C=function(e,d,c,f){var g=e.currentPage+1,b=e.pageCache.length,a;for(a=g;a<b;a++){e.pageCache[a]._w.destroy();delete e.pageCache[a].items;}e.pageCache=e.pageCache.slice(0,g);f._w=c;f._k=d.k;e.pageCache[g]=f;e.cacheChange();},H=function(b){var a=mstrmojo.hash.walk("anc.items.0.items",b);this.set("canGoUp",!(!b.pf||!a));},I=function(e,d,f,c,b){delete e._btm;var a;if(!c){a=A(e,f,e.multiSelect);a.attachEventListener("change",e.id,"navigate");if(e.useDblSelect||e.useBothSglDblSelect){a.attachEventListener("dblclick",e.id,"dblselect");}}else{a=f._w;}e.obList=a;e.booklet.turn(a,b>0);window.setTimeout(function(){e.onBrowsing=false;},300);if(!c){C(e,d,a,f);}e.set("currentFolder",f);e.set("currentPage",e.currentPage+b);e.updateUpButton(f);if(e.scrollableIncFetch&&a.scrollNode){a.initScroll();a.updateScrollbars();}},P=function(c,b,a){var d=S(c,b,false);d=d||S(c,b,true);if(!d){window.clearTimeout(c._btm);c._btm=window.setTimeout(function(){c.booklet.set("waiting",true);},300);a.ob=c;a.item=b;c.getDataProvider().fetchFolderContents(c,b,a);}else{I(c,b,d.cache,true,d.steps);}},B=function(b,c,d,a){P(b,{fid:b.pageCache[b.currentPage].did,blockBegin:c,searchPattern:d,recursive:a},N);},J={success:function(b){var c=this.ob;if(c){window.clearTimeout(c._btm);if(!b.items){b.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var a=function e(f){var k=f.length,g;for(g=0;g<k;g++){var h=f[g];if(h.did===F||h.did===T){h.n=(h.did===F)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(h.items){a(h.items);}}};if(b.did===F||b.did===T){b.n=(b.did===F)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(b.anc&&b.anc.items){a(b.anc.items);}}if(b&&b.items&&c.browsableViewMedias){var d={};K.forEach(c.browsableViewMedias.split(","),function(f){d[parseInt(f,10)]=true;});b.items=K.filter(b.items,function(f){return(f.t!==Q.DssTypeDocumentDefinition)||d[f.dvm];});}if(b&&b.items&&mstrApp&&mstrApp.isSingleTier){b.items=K.filter(b.items,function(f){return(f.st!==772);});}if(b.did&&this.item.k!==b.did){this.item.k=b.did;}I(c,this.item,b,false,1);this.ob=null;this.item=null;}},failure:function(a){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(a);}else{if(a.getResponseHeader){mstrmojo.alert(a.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{mstrmojo.alert(a.message);}}},complete:function(){if(this.ob){this.ob.onBrowsing=false;}}},Z=function(c){var b=c.pageCache.length,a;for(a=0;a<b;a++){c.pageCache[a]._w.destroy();}c.pageCache=[];c.currentPage=-1;c.cacheChange();},M=function(d,c,e){var a=d.onBrowseFolder;if(a){a[0][a[1]](c);}if(c&&parseInt(c.acg,10)===33){return ;}var b={};if(c){b.k=c.did;b.fid=c.did;}else{if(d.rootFolderID){b.k=d.rootFolderID;b.fid=d.rootFolderID;}else{if(d.rootFolderType){b.k=d.rootFolderType;b.fty=d.rootFolderType;}else{if(d.folderLinksContextId){b.k=d.folderLinksContextId;}}}}P(d,b,W.wrapMethods(e,O.copy(J)));},V=function(f,a,c){if(!c){return a;}var d=f.showCompletePath,h=a[0],e,b;while(h){var g;for(g=c.length-1;g>=0;g--){if(h.did===c[g].did){c.splice(g,1);h._isSc=true;}}b=h;h._open=true;h=h.items;h=h&&h[0];if(!h){b.lastLeaf=true;}}if(!d){h=a[0];while(h){if(h._isSc){a[0]=h;break;}h=h.items;h=h&&h[0];}}return a.concat(c);},U=function(b,a,c){b._naviInfo=V(b,a,c);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,browsableViewMedias:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,upButtonVisible:false,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,minSearchLength:2,showCompletePath:true,multiSelect:false,onCloseCB:null,onSelectCB:null,onBrowseFolder:null,scrollableIncFetch:false,useBothSglDblSelect:false,displaySaveLabel:false,useOldSearch:false,getDataProvider:function(){if(!this.dataProvider){this.dataProvider=mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"});}return this.dataProvider;},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"saveLabel",scriptClass:"mstrmojo.Label",cssClass:"msrmojo-save-label",text:mstrmojo.desc(3178,"Save in:"),bindings:{visible:"this.parent.parent.displaySaveLabel"}},{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var a=this.opener.parent.parent,d=this.tree,c=a._naviInfo,b=this.parent.parent.parent.extraDDItems;if(d.items!==c){d._pup=this;this.ob=a;if(b){K.forEach(b,function(e){e.isExtra=true;});c=c.concat(b);}d.set("items",c);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(e,a,b){var d=mstrmojo.WidgetTree.prototype.itemFunction(e,a,b);if(e.isExtra){if(e.cssClass){d.cssClass=e.cssClass;}d.onmousedown=e.onmousedown||mstrmojo.emptyFn;return d;}if(e._open){d.state=1;}d._ll=!!e.lastLeaf;d._pup=b._pup;d.onmousedown=function(f){var g=mstrmojo.dom.eventTarget(f.hWin,f.e),h=this._pup;if(g===this.domNode||g===this.textNode){if(!this._ll){M(h.ob,this.data);}h.close();}};d.markupMethods=O.copy(d.markupMethods);d.markupMethods.onstateChange=function(){var f=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[f]||"closed");this.itemsContainerNode.style.display=(f===1)?"block":"none";};d.useRichTooltip=true;var c=d.postBuildRendering;d.postBuildRendering=function(){if(c){c.call(d);}if(d.textNode.parentNode.clientWidth){d.textNode.style.width=(d.textNode.parentNode.clientWidth-20)+"px";}};d.premouseover=function(h){if(this.useRichTooltip){var g=this.textNode;if(g.clientWidth<g.scrollWidth){var f=D.position(g);this.richTooltip={areaId:this.id,cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.data[this.itemDisplayField],top:f.y-2,left:f.x+f.w+6};}else{this.richTooltip=null;}mstrmojo.dom.stopPropogation(h.hWin,h.e);}return true;};return d;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up One Level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp",visible:"this.parent.parent.upButtonVisible"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",cssClass:"searchBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 3px 0; ",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,forceResetCache:true,bindings:{minSearchLength:"this.parent.parent.minSearchLength",quickSearch:"this.parent.parent.quickSearch"},serverRequest:function(a,b){this.parent.parent.getDataProvider().serverRequest(a,b);},preFetch:function(){this.objectTypes=this.parent.parent.browsableTypes||this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);},onUpdateSearchParams:function G(c){var b=this.parent.parent,a=b.sId;if(a){c.sessionState=a;}if(b.useOldSearch){c.quickSearch=0;c.nameWildcards=1;c.sortKey=6;}}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssClass:"mstrmojo-OB-booklet",alias:"booklet",hasAnimation:false,bindings:{scrollableIncFetch:"this.parent.scrollableIncFetch"}},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(b){var d=parseInt(this.height,10),a=this.np>1,c={target:this.domNode,props:{height:{start:(a?0:d),stop:(a?d:0),suffix:"px"}},onEnd:function(){if(a){this.target.style.overflow="visible";}}},e=new mstrmojo.fx.AnimateProp(c);this.domNode.style.overflow="hidden";mstrmojo.css.toggleClass(this.parent.domNode,"show-inc-fetch",this.visible);e.play();},onifsChange:function(a){var b=this.np;mstrmojo.hash.copy(a.value,this);if(this.np>1){this.children=null;this.refresh();}if((b<=1&&this.np>1)||(b>1&&this.np<=1)||(b===0&&this.np>0)){this.set("visible",this.np>1);}this.cssText="";}}],destroy:function Y(){Z(this);if(this._super){this._super();}},postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var c=this.searchUpBar;if(c&&c.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var a=this.obSearchBox.contentWidget||this.obSearchBox;if(!this.scrollableIncFetch){a.attachEventListener("ifsChange",this.id,function(d){if(!this.scrollableIncFetch){this.obIncFetch.set("ifs",d.value);}});}}if(!this.scrollableIncFetch&&this.obIncFetch){var b=this.obIncFetch;b.attachEventListener("fetch",this.id,function(d){b.cp=d.v;b.children=null;b.refresh();B(this,(d.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}mstrmojo.css.addClass(this.domNode,"mstrmojo-ObjectBrowser");},onSearchItemsChange:function(b){var c=b.value,a=this.pageCache[this.currentPage]._w;if(!c||c.length===0){c=[{did:"empty",n:"("+mstrmojo.desc(2210,"")+")",t:"e"}];}else{if(this.browsableViewMedias){var d={};K.forEach(this.browsableViewMedias.split(","),function(e){d[parseInt(e,10)]=true;});c=K.filter(c,function(e){return(e.t!==Q.DssTypeDocumentDefinition)||d[e.dvm];});}}a.set("items",c);},navigate:function(h){var a=h.src,k=a.selectedItem,c=this.multiSelect,f=c&&a.getSelectedItems(),g=this,b=h.added&&h.added.length,e=h.removed&&h.removed.length,d=c?f.length===1&&(!e||b):!!k;if(d&&k.did==="empty"){return ;}if(d&&parseInt(k[L],10)===8){if(!this.onBrowsing){this.onBrowsing=true;M(this,k);}}else{if((k&&(!this.useDblSelect||this.useBothSglDblSelect))||f){this.select(c?f:k);}}},browseFolder:function(a,b){M(this,{did:a,n:b});},onFishEyeChange:function(a){this.goToPage(a.value);},goToPage:function(a){if(a<this.pageCache.length&&a!==this.currentPage){var c=a>this.currentPage,b=this.pageCache[a];this.set("currentPage",a);this.booklet.turn(b._w,c);this.set("currentFolder",b);H.call(this,b);}},oncurrentPageChange:function(a){if(this.fishEye){this.fishEye.setSelectedIndex(a.value);}var b=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(b.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",b.items||[]);this.obSearchBox.set("totalSize",b.sz);this.obSearchBox.set("rootID",b.did);this.obSearchBox.clearSearch();}if(!this.scrollableIncFetch&&this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(b.sz/b.bc)+((b.sz%b.bc>0)?1:0),cp:Math.floor(b.bb/b.bc)+((b.bb%b.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(b,a){O.copy(b,this);if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}Z(this);M(this,undefined,a);},close:function(){var b=this.ctx||this,a=b.onCloseCB;if(a){a[0][a[1]]();}b.set("visible",false);},select:function(b){var a=this.onSelectCB;if(a){a[0][a[1]](b);}if(this.closeOnSelect){this.close();}},dblselect:function R(b){var c=b&&b.src.selectedItem;if(!c||(c&&c.did==="empty")||c[L]===8){return ;}if(this.useBothSglDblSelect){var a=this.onDblSelectCB;if(a){a[0][a[1]](c);}if(this.closeOnSelect){this.close();}}else{this.select(c);}},goUp:function(){if(this.canGoUp){M(this,{did:this.currentFolder.pf});}},updateUpButton:function E(a){H.call(this,a);},oncurrentFolderChange:function(a){var b=a.value;U(this,b.anc.items,b.sc);},refreshContent:function(a){B(this,a);},onError:null,onheightChange:function(){var a=["titleBar","fishEye","searchUpBar","obIncFetch"],c=0,b;for(b in a){c+=parseInt(this[a[b]].domNode.offsetHeight,10);}this.booklet.set("height",parseInt(this.height,10)-c+"px");}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetTree","mstrmojo.expr","mstrmojo.AndOrNode","mstrmojo.ConditionNode");var F=mstrmojo.expr,B=F.ET;function A(G){var I=G&&G.src,J=I&&I.data,H=J&&J.et;return(H in F.ETs);}mstrmojo.FilterExpr=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.FilterExpr",allowDrop:A,renderOnScroll:false,itemIdField:null,nodeClassMap:{14:mstrmojo.AndOrNode,"*":mstrmojo.ConditionNode},onBlankClick:function(G){this.clearTreeSelect();},onnodemousedown:function(H){var I=mstrmojo.dom.eventTarget(H.hWin,H.e),J=H.src,G=J.listMapper.findIndex(J,J.itemsContainerNode,I),K=G>=0?J.ctxtBuilder.itemWidgets[G]:null;if(!K||(K.isSelectableArea&&!K.isSelectableArea(I))){this.onBlankClick(H);}},getItemIdentityProp:function(G){return G.et;},itemFunction:function(L,I,M){var H=M.tree,J=H.getItemConfig(L,I,M),K=H.nodeClassMap,G=K[H.getItemIdentityProp(L)]||K["*"];return G&&(new G(J));},getItemConfig:function(J,G,K){var H=(J.et===B.ANDOR),I=K.tree||K;return{data:J,tree:I,parent:K,bindings:{prefixedAndOrEditable:"this.parent.editable"},itemFunction:(H)?K.itemFunction:null,draggable:H?I.draggable:false,dropZone:H?I.dropZone:false,allowDrop:H&&I.dropZone?I.allowDrop:null,allowCopy:H?I.allowCopy:false,editable:I.isEditable?I.isEditable(J):I.editable,makeObservable:H&&K.makeObservable,onclick:I.onnodeclick,onadd:I.onnodeadd,onremove:I.onnoderemove};},getDragData:function(G){var I=this._super(G);if(I&&!I.html){var H=I.et&&F.ET2TGT[I.et];I.html=H?I[H]&&I[H].n||"":I.n||"";}return I;},newCondition:function E(K){K=K||{et:B.AQ};var J=this.selectionParentNode,G;J=(J&&J.hasRendered)?J:this;if(J!==this){G=J.add([K]);}else{var I=this.addCondition([K],null,true);G=I.index;J=I.widget;}var H={widget:J,index:G,data:K};if(this.onNew){this.onNew(H);}return H;},addCondition:function D(I,K){var L=this.items,H=L&&L.length,N=I&&I.length;if(!N){return null;}var J,G;if(H&&L[0].et===B.ANDOR){J=this.ctxtBuilder.itemWidgets[0];G=J.add(I,null);}else{if(!H&&(N===1)){J=this;G=0;this.add(I,0);}else{if(H){var M=L[0];this.remove(M);I.unshift(M);}this.add([{et:B.ANDOR,fn:F.FN.AND,nds:I}],0);J=this.ctxtBuilder.itemWidgets[0];G=H?1:0;}}return{widget:J,index:G};},addSingleCondition:function C(H,G){var I=this.addCondition([H],G);return I.widget.ctxtBuilder.itemWidgets[I.index];},ondrop:function(J){if(this._super){this._super(J);}var H=this.items,G=H&&H.length,I=H.concat();if(G>1){if(H.remove){H.remove(0,H.length);}else{this.set("items",null);}this.add([{et:B.ANDOR,fn:F.FN.AND,nds:I}],0);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.expr","mstrmojo.dom","mstrmojo.array","mstrmojo.css");var L=mstrmojo.expr,N=mstrmojo.dom,C=mstrmojo.array,A=mstrmojo.css,F=mstrmojo.fe._IsRelationTreeNode.createSetHtml;var M=function(){var T="noRelationOperator",P=this[T],R=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],S=mstrmojo.array.filter(R,function(U){return U&&U[T]!==P&&U.data.et!==L.ET.RLS;}),O=S.length;for(var Q=0;Q<O;Q++){S[Q].set(T,P);}};mstrmojo.fe.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.AndOrNode",markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',getPrefixAndOrToolsMarkup:function(){return(F+this._super());},markupSlots:mstrmojo.hash.copy({createSetNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupSlots)),markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){A.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupMethods)),removeSet:function G(P){var O=P.childIndex(),Q=P.data,R=[Q];if(O>=0){this.remove(O,true);if(Q.nds&&Q.nds.length>0){R=Q.nds;if(Q.not){R[0].not=true;}}else{delete Q.dmy;delete Q.relation;delete Q.applySubExpr;delete Q.relation;delete Q.useSchema;delete Q.dmt;}this.add(R,O);this.consolidate(false);}},createSet:function E(Q,O){var P=this._ndsToMove(this,Q);if(!P){return ;}this.remove(P.idxs,true);var U=P.nds,T;if(U){if(U.length>1){var S={et:L.ET.ANDOR,nds:U};S.fn=this.data.fn;U=[S];T=S.nds[0].not;}else{var V=U[0];if(V&&V.not&&V.et===L.ET.ANDOR){T=V.not;delete V.not;}}}if(O&&O.rq){var R;if(O.isMetric){R=O.cq;mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],O.rq,R);}else{R=O.rq;R.nds=U;if(T){R.not=T;}}this.add([R],P.idxs[0]);}this.consolidate(false);},preclick:function H(O){var R=null,Q=N.eventTarget(O.hWin,O.e),P=this._super(O);if(N.contains(this.createSetNode,Q,true)&&!this.noRelationOperator){R="createSetOpt";}O.part=R||O.part;return P;},preadd:function I(O){if(this._super){this._super(O);}this.updateRelationOperator();},preremove:function K(O){if(this._super){this._super(O);}this.updateRelationOperator();},consolidate:function B(){this._super();this.updateRelationOperator();},postBuildRendering:function J(){var O=this._super();this.updateRelationOperator();return O;},updateRelationOperator:function D(){var O=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],P=!!C.filterOne(O,function(R){return R&&(R.data.et===L.ET.RLS||(R.data.et===L.ET.ANDOR&&R.noRelationOperator));}),Q=this.parent;this.set("noRelationOperator",P);M.call(this);if(Q&&Q.hasRendered&&Q.updateRelationOperator){Q.updateRelationOperator();}},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.EditableLabel");var A=mstrmojo.css,E=mstrmojo.validation.STATUSCODE;mstrmojo.ui.editors.controls.ComboBox=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",markupMethods:{onenabledChange:function D(){this.txtLabel.set("editOnClick",this.enabled);A.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ComboBox");},updatePreview:function C(){this.txtLabel.set("value",this.selectedValue||"");},updateSelection:function(){this.set("selectedValue",this.txtLabel.value);},validateTextInput:function(F){return true;},txtLabel:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"txtLabel",slot:"previewNode",constraints:{validator:function(){if(!this.parent.validateTextInput(this.value)){return{id:this.id,code:E.INVALID,msg:""};}}},onValid:function(){this.parent.updateSelection();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.css");var C,D=mstrmojo.css;var J=mstrmojo.declare(mstrmojo.ui.PopupList,null,{getItemMarkup:function G(K){if(!C){C=this._super(K).replace(">{@en@n}<","><div>{@en@n}</div><");}return C;},getItemProps:function F(M,K){var L=this._super(M,K);L.addCls("bst"+K);if(K){L.title=M.n;L.n="";}else{L.tt="";}return L;}});mstrmojo.ui.editors.controls.LineStyleButton=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",itemValueField:"id",showThickOption:true,markupMethods:{onenabledChange:function E(){D.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function H(L){this._super(L);var K=["mstrmojo-ui-LineStyle"];if(!this.showThickOption){K.push("no-thick");}D.addWidgetCssClass(this,K);},getListCfg:function I(){return new J({selectionPolicy:"reselect",items:[{n:mstrmojo.desc(2258,"None"),id:"none"},{n:mstrmojo.desc(2259,"Dashed"),id:"1pt dashed"},{n:mstrmojo.desc(2260,"Dotted"),id:"1pt dotted"},{n:mstrmojo.desc(2262,"Thin"),id:"1pt solid"},{n:mstrmojo.desc(2264,"Thick"),id:"2pt solid"}]});},postBuildRendering:function A(){this.borderStyleNode=this.previewNode.appendChild(document.createElement("div"));return this._super();},updatePreview:function B(){var N=this.borderStyleNode,L=this.selectedValue.split(" "),K=this.selectedValue==="conflict";D.toggleClass(this.previewNode,"conflict",K);if(N&&!K){var M=N.style;if(L.length===1){M.borderTopStyle=L[0];}else{M.borderTopWidth=L[0];M.borderTopStyle=L[1];}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.util.ui.ColorPicker","mstrmojo.ui.editors.controls.ColorList","mstrmojo.ui.editors.controls.ColorWheel","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.TextBoxWithLabel","mstrmojo.ui.ButtonBar","mstrmojo.Button","mstrmojo.css");var G=1,Q=2,X=mstrmojo.css,L=mstrmojo.array,I=mstrmojo.util.ui.ColorPicker,B=G,V=0,E=1,K=2,H="txtColor",U="automatic";var D=[{n:mstrmojo.desc(12071,"Color fill"),id:V},{n:mstrmojo.desc(12072,"No fill"),id:E},{n:mstrmojo.desc(12073,"Gradient"),id:K}];function F(){return this.color!==U?this.color:this.autoPreviewColor;}function b(e,d,c){return mstrmojo.Button.newWebButton(e,c,d,{slot:"buttonNode",cssDisplay:"inline-block"});}function M(c){return{scriptClass:"mstrmojo.ui.editors.controls.ColorList",items:c,postselectionChange:function(d){var g=d.added;if(g){var f=this.parent,e=this.items[g[0]].id;f.set("color",e);f.colorChanged(e);}}};}function a(c){return"#"+c.replace("#","");}function N(){var c=this.txtColor1,f=this.txtColor2,d=this.color,e=false,g=this.colorStyle;switch(g.items[g.selectedIndex].id){case V:d=a(c.value);break;case E:d="transparent";break;case K:d={or:this.gradientOrientation.getSelectedItems()[0].id,c1:a(c.value),c2:a(f.value)};e=true;break;}X.toggleClass(this.containerNode,"grad",e);this.set("color",d);}function J(c){this.set("activeColor",c);var d=this[c];L.forEach([1,2],function(f){var e=this[H+f];X.toggleClass(e.domNode,"on",e===d);},this);this.colorWheel.set("color",a(d.value));}function O(c,d,e,f){if(typeof e==="string"){if(e==="transparent"){e="#ffffff";}}else{if(e.c1){e=e["c"+c];}}return{scriptClass:"mstrmojo.TextBoxWithLabel",alias:H+c,cssDisplay:"block",label:d,autoCorrect:false,maxLength:6,size:6,value:e.replace("#",""),bindings:f,onfocus:function(){J.call(this.parent,this.alias);},onvalueChange:function(g){if(!/^[0-9a-fA-F]{0,6}$/.test(g.value)){this.value=g.valueWas;}else{if(this.value.length===6){var h=this.parent;h.colorWheel.set("color",a(this.value));N.call(h);}}}};}function S(){var c=F.call(this),g="this.parent.colorStyle.items[ this.parent.colorStyle.selectedIndex ].id",k=g+" === "+K,f=g+" !== "+E,d=(this.showNoFill&&c==="transparent")?1:0,e=D.slice(0,this.showGradient?3:2),h=0;if(!this.showNoFill){e.splice(1,1);}if(c.c1){d=L.find(e,"id",K);h=c.or?0:1;}this.addChildren([{scriptClass:"mstrmojo.ui.Pulldown",alias:"colorStyle",selectedIndex:d,items:e,onitemSelected:function(){N.call(this.parent);}},{scriptClass:"mstrmojo.ui.ButtonBar",alias:"gradientOrientation",items:[{n:mstrmojo.desc(2066,"Horizontal"),id:1,css:"h"},{n:mstrmojo.desc(2069,"Vertical"),id:0,css:"v"}],selectedIndex:h,bindings:{visible:k},postselectionChange:function(l){if(l.added){N.call(this.parent);}}},{scriptClass:"mstrmojo.Button",cssClass:"simpleButton",text:mstrmojo.desc(11658,"Swap"),bindings:{visible:k},onclick:function(){var n=this.parent,m=n.txtColor1,o=n.txtColor2,l=m.value;m.set("value",o.value);o.set("value",l);N.call(n);}},O(1,mstrmojo.desc(12074,"Color HEX:"),c,{visible:f,label:g+" === "+K+' ? "'+mstrmojo.desc(12075,"Color 1 HEX:")+'" : "'+mstrmojo.desc(12074,"Color HEX:")+'";'}),O(2,mstrmojo.desc(12076,"Color 2 HEX:"),c,{visible:k}),{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",alias:"colorWheel",color:c.c1||c,onColorPicked:function(l){var m=this.parent;m[m.activeColor].set("value",l.replace("#",""));},bindings:{visible:f}},b(mstrmojo.desc(1442,"Ok"),true,function(){var m=this.parent,l=m.color;if(!l.c1){I.addCustomColor(l);}m.colorChanged(l);}),b(mstrmojo.desc(2140,"Cancel"),false,function(){this.parent.colorCanceled();})]);J.call(this,H+"1");}function T(){var d=F.call(this),c=this.sampleNode.style;if(d){if(d.c1){var e=X.buildGradient(d.or,d.c1,d.c2);c[X.convertCssToCamelCase(e.n)]=e.v;}else{c.background=d;}}}mstrmojo.ui.editors.controls.AdvancedColorPicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPicker",markupString:'<div id="{@id}" class="mstrmojo-ui-AdvColorPicker {@cssClass}" style="{@cssText}" mstrAttach:click><div class="acpToolbar"><div class="acpBtn acpSwatchBtn"></div><div class="acpBtn acpPaletteBtn"></div><div class="acpColor"></div></div><div class="acpContent" ></div><div class="acpButtons" ></div></div>',markupSlots:{swatchBtnNode:function(){return this.domNode.firstChild.firstChild;},paletteBtnNode:function(){return this.domNode.firstChild.childNodes[1];},sampleNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.nextSibling;},buttonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onpickerModeChange:function P(){B=this.pickerMode;this.renderContent();},oncolorChange:function A(){T.call(this);},onautoPreviewColorChange:function C(){T.call(this);}},color:"#000fff",showGradient:true,showNoFill:true,showAutomatic:false,autoPreviewColor:null,activeColor:H+"1",swatchBtnNode:null,paletteBtnNode:null,colorStyle:null,gradientOrientation:null,txtColor1:null,txtColor2:null,colorWheel:null,pickerMode:G,init:function R(c){this._super(c);this.pickerMode=B;},renderContent:function W(){this.showPickerForCurrentMode();},showPickerForCurrentMode:function Y(){var e=this;this.removeChildren();var f=B===G;if(f){var d=I.getBasicColors();if(!this.showNoFill){d.shift();}if(this.showAutomatic&&this.color!==U){this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4531,"Automatic"),cssClass:"AutomaticOption",onclick:function c(){e.set("color",U);e.colorChanged(U);}}]);}this.addChildren([mstrmojo.hash.copy({alias:"basicColors"},M(d)),M((mstrApp&&mstrApp.getPreferredColors)?L.map(mstrApp.getPreferredColors(),function(g){return{n:g,id:g};}):[]),M(I.getCustomColors())]);}else{S.call(this);}X.toggleClass(this.swatchBtnNode,"on",f);X.toggleClass(this.paletteBtnNode,"on",!f);this.buttonNode.style.display=f?"none":"block";},colorChanged:mstrmojo.emptyFn,colorCanceled:mstrmojo.emptyFn,onclick:function Z(c){var d=c.getTarget(),e=this.pickerMode;if(d===this.swatchBtnNode){e=G;this.set("pickerMode",e);}else{if(d===this.paletteBtnNode){e=Q;this.set("pickerMode",e);}}}});mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC=U;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo._HasEditableText","mstrmojo.ui.Pulldown");var H=mstrmojo.array,C=mstrmojo.hash,B=19,J=13,D=27;mstrmojo.ui.SearchablePulldown=mstrmojo.declare(mstrmojo.ui.Pulldown,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.ui.SearchablePulldown",editableSlot:"selectedNode",allowCustomText:false,isSearching:false,editOnClick:false,init:function K(P){this._super(P);var M=this.getPopupList();M.renderOnScroll=this.renderOnScroll||M.renderOnScroll;M.renderBlockSize=this.renderBlockSize||M.renderBlockSize;mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-SearchablePulldown");var O=M.constructor.prototype,N=M.getItemProps?M.getItemProps:O.getItemProps,Q=M.getItemMarkup?M.getItemMarkup:O.getItemMarkup;M.getItemProps=function(V,R){var S=this._spft||"",W=V.n,T=W.toUpperCase().indexOf(S);if(T===-1){S="";}var U=N.call(this,V,R);U.before=W.slice(0,T);U.input=W.substring(T,T+S.length);U.after=W.slice(T+S.length,W.length);return U;};M.getItemMarkup=function(S,R){return Q.call(this,S,R).replace("{@en@n}","{@en@before}<span class='sp-highlight'>{@en@input}</span>{@en@after}");};},onclick:function L(M){var P=this.selectedNode,Q=M.getTarget(),R=M.e.offsetX>=(P.offsetWidth-B),O=this.getPopupWidget(),N=O.visible;if(Q===P&&(!N||(N&&R))){this.set("isEditing",!N);this._super(M);}},onPopupWidgetClosed:function F(){this.set("isEditing",false);var P=this.getPopupList(),Q=P._oldItems,N=this.text;delete P._oldItems;if(Q){var M=H.find(Q,"n",N);if(M===-1&&!this.allowCustomText){var O=P.items[0]||Q[0];M=H.find(Q,"n",O.n);}P.set("items",Q);this.set("selectedIndex",M);}},_set_selectedIndex:function E(O,M){if(this.allowCustomText&&M===-1){this.selectedIndex=-1;this.onitemSelected(null,M);}else{this.isSearching=false;this._super(O,M);if(this.hasRendered){var N=this.selectedNode;this.text=N.innerText?N.innerText:N.textContent;}}return true;},onkeydown:function G(N){this._super(N);var M=window.event||N.e;if(M.keyCode===J){this.getPopupList().close();}},onkeyup:function A(O){this._super(O);var M=window.event||O.e,P=M.keyCode,N=this.getPopupList();if(P===D||P===J){N.close();}else{this.processSearch();}},processSearch:function I(){this.isSearching=true;this.hideTooltip();var M=[],O=this.getPopupList(),P=this.selectedNode.innerHTML,Q=O._oldItems||O.items,N=P.toUpperCase();N=N.replace(/<BR>/,"");if(N.length>0){H.forEach(Q,function(R){if(R.n.toUpperCase().indexOf(N)>-1){M.push(C.clone(R));}},this);}else{M=Q;}O._spft=N;if(this.customizeSearchResult){this.customizeSearchResult(M);}O.set("items",M);O.adjustCornersForPopupOverflow();delete O._spft;O._oldItems=Q;O.set("visible",M.length!==0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.EditableLabel","mstrmojo.ui.menus.MenuConfig","mstrmojo.css");var b=mstrmojo.css,N=1,L=2,F=4,c=8,K=16;function E(e){return function(){b.toggleClass(this.menuBtnNode,"active",e);};}function H(f){var l=new mstrmojo.ui.menus.MenuConfig(),k=this.getMenuActions(),e=this.index,m=this.id,g=this.total;if((k&K)>0){this.addNewTabMenuItem(l);}if((k&F)>0){l.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){mstrmojo.all[m].tabDuplicated();});}if((k&L)>0){if(e){l.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){mstrmojo.all[m].tabMoved(true);});}if(e<g-1){l.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){mstrmojo.all[m].tabMoved(false);});}}l.addSeparator();if((k&N)>0){l.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){mstrmojo.all[m].lbl.set("isEditing",true);});}if((k&c)>0){if(g>1){l.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){mstrmojo.all[m].tabDeleted();});}}var h=this.getCustomMenu();if(h&&h.hasMenuItems()){l.addSeparator();l.absorbMenuItems(h);}l.addPopupHandlers(this.id,E(true),E(false));this.showTabMenu(this.updateMenuCfg(l),f);}mstrmojo.vi.ui.tabs.Tab=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.Tab",markupString:'<div id="{@id}" class="mstrmojo-VITab unselectable {@cssClass}" style="{@cssText}" unselectable="on" mstrAttach:click><div><div class="mstrmojo-VITab-tab"></div><div class="mstrmojo-VITab-menu"></div></div></div>',markupSlots:{containerNode:function W(){return this.domNode.firstChild.firstChild;},menuBtnNode:function a(){return this.domNode.firstChild.lastChild;}},markupMethods:{ontitleChange:function Z(){this.lbl.set("text",this.title);},onisSelectedChange:function V(){mstrmojo.css.toggleClass(this.domNode,"selected",this.isSelected);},onzIndexChange:function D(){this.domNode.style.zIndex=this.zIndex;}},zIndex:1,menuBtnNode:null,lbl:null,title:"",index:-1,total:-1,isSelected:false,children:[{scriptClass:"mstrmojo.EditableLabel",alias:"lbl",editOnClick:false,onTextEditComplete:function Q(f,e){if(f){this.parent.titleEdited(this.text,e);}}}],postBuildRendering:function X(){if(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){this.draggable=false;}this._super();},onclick:function d(e){var f=e.getTarget();if(f===this.menuBtnNode){H.call(this,f);}else{if(!this.isSelected){this.tabSelected();}}},getMenuActions:function I(){return 0;},getCustomMenu:function B(){return null;},isDragValid:function A(){return this.parent.children.length>1&&!this.lbl.isEditing;},createAvatar:function S(){var e=document.createElement("div");e.appendChild(this.domNode.cloneNode(true));e.style.margin="-5px 0 0 10px";return e;},allowDrop:function G(e){var f=e.src.widget;return f&&f.parent===this.parent;},ondrop:function Y(e){var f=e.src.data;this.parent.moveTab(f.idx,this.index,f.fromIdx);this._super(e);},ondragenter:function P(f){this._super(f);var g=f.src.data,e=this.index;this.parent.moveTab(g.idx,e);g.idx=e;},ondragover:function T(g){var e=g.tgt.node,f=g.tgtData,h=f&&f.node;if(!f||h!==e){g.tgtData={node:e};if(h){h.style.borderColor="";}}e.style.borderColor="#0fe88f";},getDragData:function C(){var g=this.id,e=this.index;return{setAvatarClass:function f(h){var m=mstrmojo.all[g],k=m.avatar;if(k){var l=[m.avatarCssClass,"hasOwnAvatar",h];k.className=l.join(" ");}},fromIdx:e,idx:e};},getDropAvatarIcon:function R(){return"pivot";},cleanUpAfterTarget:function J(f){var e=f.tgtData&&f.tgtData.node;if(e){e.style.borderColor="";}this._super(f);},onAppStateChange:function U(e){var f=this.lbl,g=e.value===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;f.set("isEditing",false);f.set("editOnDoubleClick",!g);this.draggable=!g;},addNewTabMenuItem:function O(e){this.throwAbstractMethodError("addNewTabMenuItem");},tabSelected:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,tabMoved:mstrmojo.emptyFn,tabDeleted:mstrmojo.emptyFn,tabDuplicated:mstrmojo.emptyFn,showTabMenu:mstrmojo.emptyFn,updateMenuCfg:function M(e){return e;}});mstrmojo.vi.ui.tabs.Tab.ACTIONS={NEW_TAB:K,RENAME:N,MOVE:L,DUPLICATE:F,DELETE:c};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.array","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo._IsDocumentTemplate","mstrmojo.Label","mstrmojo.ui.menus.MenuConfig");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");var T={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};var D=["background-color","fx"],I=mstrmojo.array;mstrmojo.VisBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._IsDocumentTemplate],{scriptClass:"mstrmojo.VisBase",updated:false,waitingForData:false,node:null,skipReRender:false,updateFormatsOnUpdate:true,setModel:function M(Z){this.set("model",Z);},destroy:function W(){var Z=this.model;if(Z&&Z.destroy){Z.destroy();delete this.model;}this._super();},resize:function X(){var Z=this.getFormats();if(parseInt(Z.height,10)===0||parseInt(Z.width,10)===0){this.domNode.style.display="none";}else{this.setDimensions(Z.height,Z.width);this.domNode.style.display="";}},setDimensions:function O(b,a){var Z=this._super(b,a);if(Z&&this.hasRendered&&!this.skipReRender){this.reRender();}return Z;},reRender:function F(){this.unrender();this.render();},getWidth:function B(){return parseInt(this.width,10);},getHeight:function K(){return parseInt(this.height,10);},getLeft:function R(){return parseInt(this.left,10);},getTop:function A(){return parseInt(this.top,10);},buildRendering:function H(){this.height=this.getHeight();this.width=this.getWidth();this.left=this.getLeft();this.top=this.getTop();if(!this.updated){this.update();}this._super();},initFromVisProps:function V(){},postBuildRendering:function(){var Z=this.isEmpty();this._super();this.raiseEvent({name:"toggleCtrlOverlay",visible:Z,controls:this.getVisEmptyMsgControls()});this.applyBackground();return !Z;},applyBackground:function(){var a=this.defn&&this.defn.fmts,f=(a&&a.p_fmts)||a,c={},d,Z,e,b;if(mstrApp.isExpress&&f){d=this.formatHandlers=this.formatHandlers||{};e=d.domNode=d.domNode||[];Z="BG";b=I.indexOf(e,Z);if(b<0){e.push(Z);}I.forEach(D,function(g){if(f[g]){c[g]=f[g];}});this.applyCSSFormatToNode("domNode",c);}},update:function G(c){c=c||this.node;if(c){var Z=c.data;if(Z){this.model.set("data",Z);}this.waitingForData=!!Z.nsj;if(this.waitingForData){var a="ServerJsonRWDStyle";var d=this.model,b=d.getDataService(),e={host:this,nodes:[this.k]},g;if(Z.wid!==undefined){e.slices=[Z.wid];}g=mstrmojo.func.wrapMethods(d.docModel.getUpdateColorMapCallback(),d.docModel.getUpdateThemePaletteCallback(true),d.controller._getXtabCallback(this));b.retrieveServerJson(e,g,{preserveUndo:true,style:{name:a,params:{treesToRender:3}},params:{styleName:a}});this.updated=true;return false;}this.updateContentFormats(c);}if(this.model){var h=this.model&&this.model.docModel;this.initFromVisProps(this.model.vp);if(h&&h.getDocBuilder){var f=h.getDocBuilder().getMojoVisName(c);if(f){c.data.visName=f;}}}this.updated=true;if(this._super){return this._super(c);}return true;},updateContentFormats:function(e){var d=this.parent,c=e.defn,Z=c&&c.fmts;if(this.updateFormatsOnUpdate&&Z){if(this.clearFormats){this.clearFormats();}if(d&&d._createFormats&&!Z.p_fmts){d._createFormats();}Z=(this.getFormats&&this.getFormats())||Z;for(var b in T){if(T.hasOwnProperty(b)){var a=T[b];if(b in Z){this[a]=Z[b];}}}}},isEmpty:function L(){return false;},getVisEmptyMsgControls:function C(){return[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")}];},getModel:function N(){return this.model;},getData:function J(){return this.model.data;},getRowsAndCols:function(){var Z=this.model.data.gts;return(Z.row||[]).concat(Z.col||[]);},getExp:function(){var Z=this.model.data,a=Z&&Z.sc&&Z.sc.exp;return a;},getDocModel:function S(){return this.model&&this.model.docModel;},getTitleRMCPopup:mstrmojo.emptyFn,getMenuHandler:function U(){return mstrmojo.emptyFn;},renderErrorMessage:function Y(Z){this.domNode.innerHTML='<div class="mstrmojo-message">'+Z+"</div>";},getMessageID:function E(){return this.model.docModel.mid||this.model.mid;},performAction:function Q(Z){var b=this.model.getAction(Z),a=b&&b.h;if(a&&this.controller[a]){this.controller[a](this,b.a);return true;}return false;},findSelectorControl:function P(){var a=this.getData(),Z=a&&a.sc;if(Z&&parseInt(Z.ct,10)===6){this.selectorControl=Z;this.isMultiSelect=true;}else{delete this.selectorControl;}return this.selectorControl;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.ui.menus.MenuConfig","mstrmojo.vi.viz.MapHelper");mstrmojo.requiresDescs(11701,3946,11476,13272,13273,5752);var X=mstrmojo.array,Q=mstrmojo.hash,m=mstrmojo.vi.viz.MapHelper,e=mstrmojo.vi.viz.EnumDSSDropZones.GeoAttribute,G=mstrmojo.vi.viz.EnumDSSDropZones.AdditionalMetrics,B=5,n=6,b=1,V={3:2,2:9,9:8};function d(o,r){if(o===b){return V[r];}else{var q;Q.forEach(V,function(s,p){if(s===r){q=p;return false;}});return parseInt(q,10);}}function K(p){var t=mstrmojo.all[this.popupConfig.hostId],o=t.getGridDataViewers(),q,u,s=o?o.length:0,r=this;for(q=0;q<s;q++){u=o[q];u.clearTempSelections();}if(!this.processed){t.restoreSelectionDataOnly();window.setTimeout(function(){if(t.contextMenu!==r&&!!t.contextMenu.mouseOnUnSelectedGraphic){return ;}t.restoreSelectionEffects();t.clearSelectionBackup();},200);}else{t.clearSelectionBackup();}}function M(q,p){var o=0,t=false,s=false,r,u;X.forEach(q.fs,function(w){r=w.fgr;u=w.fnm;if(r>0&&r!==B&&r!==n&&p){o=r;return false;}else{if(r===B||(u&&u.toLowerCase().indexOf("latitude")>-1)){t=true;}else{if(r===n||(u&&u.toLowerCase().indexOf("longitude")>-1)){s=true;}}}});return !!o||(t&&s);}function l(p,u){var r,o,q=p[u],t=q.att,w,z=this.zonesModel,y=z.getZoneModelByZoneId(e),x=[],s=this.isESRIMap;y.items.forEach(function(AA){w=AA.did;return false;});for(r=0,o=t.length;r<o;r++){if((w&&t[r].did!==w)&&M(t[r],s)){x.push(t[r]);}}return x;}function k(p,o){var q=0;if(p){if(p.fgr){return p.fgr;}else{if(p.fs){X.forEach(p.fs,function(r){if(r.fgr>0){if(o){if(m.isGeoRoleSupportArea(r.fgr)){q=r.fgr;return false;}}else{q=r.fgr;return false;}}});return q;}}}}function H(p,t,x){var q=p[t],s=q.att,w,r,u,o;X.forEach(s,function(y){for(r=0,u=y.fs.length;r<u;r++){o=y.fs[r];if(parseInt(o.fgr)===parseInt(x)){w={did:y.did,t:y.t,fgr:x};break;}}if(w){return false;}});return w;}mstrmojo.gmaps._HasContextMenu={_mixinName:"mstrmojo.gmaps._HasContextMenu",EnumContextMenuTargetType:{GeoGraphic:1,BlankSpace:2,DensityGraphic:3,SelectionArea:4},contextMenu:null,selectionBackUp:null,showMenu:function f(o,y){var t=this.getMenuConfig(y),u,s,r=false,x=this.getGridDataViewers(),w,p;if(!t.hasMenuItems()){return false;}else{t.hostId=this.id;t.isHostedWithin=false;t.position=this.getMousePositionFromEvent(o);var q=t.newInstance();q.onClose=K;q.processed=false;this.contextMenu=q;if(y&&y.type===this.EnumContextMenuTargetType.GeoGraphic){u=y.object;r=this.isObjectSelected(u);p=u.attributes.layerKey;}else{if(y&&y.type===this.EnumContextMenuTargetType.DensityGraphic){u=y.object;for(s=0;s<u.length;s++){r=this.isObjectSelected(u[s]);p=u[s].attributes.layerKey;if(r){break;}}}}if(y&&(y.type===this.EnumContextMenuTargetType.GeoGraphic||y.type===this.EnumContextMenuTargetType.DensityGraphic)&&!r){this.backupSelections();this.clearOldSelections();if(x){for(s=0;s<x.length;s++){w=x[s];if(p===w.k){w.addTempSelections(y.object);}}}this.contextMenu.mouseOnUnSelectedGraphic=true;}}this.openPopup(this.contextMenu);return true;},getMenuConfig:function O(w){var s=this.getGridDataViewers(),r,o,u,t=false;if(s){for(o=0;o<s.length;o++){r=s[o];u=r.getSelectedRowIndices(r.getGeoColumnIndex());if(u&&u.length>0){t=true;break;}}}var p=new mstrmojo.ui.menus.MenuConfig(),q=this,x;if((w&&w.type===this.EnumContextMenuTargetType.GeoGraphic)||(w&&w.type===this.EnumContextMenuTargetType.DensityGraphic)){if(mstrApp&&mstrApp.isVI){if(this.canDoMultiSelect()){p.addMenuItem(mstrmojo.desc(11701,"Keep only"),"xt",this.getMenuHandler("keepOnly"));p.addMenuItem(mstrmojo.desc(3946,"Exclude"),"xt",this.getMenuHandler("exclude"));x=l.call(this,this.model.docModel.datasets,q.model.data.datasetId);if(x&&x.length>0){p.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,function(){var AA=x.length,y=new mstrmojo.ui.menus.MenuConfig(),z;for(z=0;z<AA;z++){y.addMenuItem(x[z].n,"xt",q.getMenuHandler("drill"),{drillUnit:x[z]});}return y;},"xt");}p.addSeparator();}p.addMenuItem(mstrmojo.desc(11476,"Show Data"),"xt",this.getMenuHandler("showData"));}}if(this.isMapEnabledAffinityLine()){if(p.hasMenuItems()){p.addSeparator();}if(w&&w.type===this.EnumContextMenuTargetType.GeoGraphic){p.addMenuItem(mstrmojo.desc(13650,"Hide affinity lines"),"xt",this.getMenuHandler("drawAffinityLines",w.object));}else{p.addMenuItem(mstrmojo.desc(13651,"Show affinity lines"),"xt",this.getMenuHandler("showAllAffinityLines"));}}if((t||(w&&w.type===this.EnumContextMenuTargetType.GeoGraphic)||(w&&w.type===this.EnumContextMenuTargetType.DensityGraphic))&&!(mstrApp&&mstrApp.isVI)){if(this.isMapDrillEnabled()){if(p.hasMenuItems()){p.addSeparator();}p.addMenuItem(mstrmojo.desc(5752,"Links"),"xt",this.getMenuHandler("linkDrill"));}}if(t&&w&&w.type===this.EnumContextMenuTargetType.BlankSpace){p.addMenuItem(mstrmojo.desc(1763,"Clear All"),"xt",this.getMenuHandler("clearAll"));}return p;},getMenuHandler:function(o,y){var AB;if(this._super){AB=this._super(o,y);}if(AB!==mstrmojo.emptyFn){return AB;}var x=this,q=y,r={keepOnly:function w(){x.processCommon();x.processKeepOnly();},drill:function AC(AD){x.processCommon();x.processDrillWithin(AD);},exclude:function AA(){x.processCommon();x.processExclude();},showData:function p(){x.processCommon();x.processShowData();},linkDrill:function s(){x.processCommon();x.processDrill();},drawAffinityLines:function t(){x.processCommon();x.drawAffinityLines(q);},showAllAffinityLines:function z(){x.processCommon();x.drawAllAffinityLines();},clearAll:function u(){x.processCommon();x.processRemoveAllSelections();}};if(r.hasOwnProperty(o)){return r[o];}return mstrmojo.emptyFn;},getMousePositionFromEvent:function Y(o){return{x:0,y:0};},getGridDataViewers:function D(){return null;},processCommon:function J(){this.contextMenu.processed=true;},processKeepOnly:function U(){this.updateAfterKeepOnly(true);},processDrillTo:function E(q){var w=this.zonesModel,r=w.getZoneModelByZoneId(e),x=k(r.items[0]),o=this.model.data,p=o.datasetId,o=this.model.data,s=mstrmojo.gmaps.MapPropertiesHelper.getMatchingShape(this.gridParams.config.shapes,null,x),t=d(q,x),u;if(t&&s){u=H(this.model.docModel.datasets,p,t);}if(u){this.processDrillWithin({ctxt:{drillUnit:u}});}},processDrillWithin:function R(r){var AL=r.ctxt.drillUnit,s=this.getSelections(),AE=this.model.data,AD=[],AG=this.zonesModel,y={did:AL.did,t:AL.t},AI={id:e},AF={id:G},t=this.model.docModel.controller._getXtabCallback(this),x=AE.datasetId,AH="00000000000000000000000000000000",AC=0,q=3,AM=this.k,AN,AB,w={datasetId:x,datasetType:x===AH?AC:q},u=AE.vp;if(s.length>0){var p=null,AK=AG.getZoneModelByZoneId(e),AJ=s[s.length-1][0].tid;X.forEach(AK.items,function(AO){if(AO.did===AJ){p=AO;return false;}});if(p){var AA={allowedItems:[AL],idx:0,edge:1,item:AL,removeReplaced:true};var z=this.zonesModel.getDropActions(AK,AA,x);if(z&&z.actions&&z.actions.length>0){AD=AD.concat(z.actions);}}}else{return ;}AB=k(AL,true);if(this.gridParams&&this.gridParams.config&&AB){AN=mstrmojo.gmaps.MapPropertiesHelper.getMatchingShape(this.gridParams.config.shapes,null,AB);if(AN&&AN.sfr){y=H(this.model.docModel.datasets,x,AN.sfr);if(y){X.insert(AD,null,AG.getAddDropZoneUnitsActions(AF,[y],AG.getItemCountInZone(G),w));}}}if(!!u.sa){u.sa=undefined;}if(!!u.mtp){u.mtp=undefined;}if(!!u.sm){u.sm=undefined;}if(AB&&this.isESRIMap){u.sa="1";}var o=[{act:"updateTemplate",keyContext:AM,actions:AD}];o.push(AG.getWidgetPropsAction());this.updateAfterDrill(o,t);},processExclude:function Z(){this.updateAfterKeepOnly(false);},processShowData:function C(){var p=this.getGridDataViewers(),o=p?p.length:0;for(var r=0;r<o;r++){var q=p[r];q.showData();}},processRemoveAllSelections:function L(){if(this.clearMarkerSelections){this.clearMarkerSelections();}},processDrill:function T(){var p=this.getGridDataViewers(),o=p?p.length:0;for(var q=0;q<o;q++){p[q].processDrill();}},isMapEnabledAffinityLine:function g(){for(var o=0;o<this.gridDataViewer.length;o++){if(this.gridDataViewer[o].isAffinityLinesEnabled()){return true;}}return false;},isMapDrillEnabled:function P(){for(var o=0;o<this.gridDataViewer.length;o++){if(this.gridDataViewer[o].isViewerDrillable()){return true;}}return false;},drawAffinityLines:function W(q){if(!q||!q.attributes||!q.attributes.id){return ;}var s,t={},u=q.attributes.id,p=this.getGridDataViewers(),o=p?p.length:0;for(s=0;s<o;s++){var r=p[s];if(q.attributes.layerKey===r.k){t[r.getElementIdWithoutAttributeID(u)]=u;r.startAffinityLinesAnimation(t);}}},drawAllAffinityLines:function N(){var p=this.getGridDataViewers(),o=p?p.length:0;for(var r=0;r<o;r++){var q=p[r];q.drawAffinityLinesUsingSecondaryDataProvider();}},canDoMultiSelect:function c(){var o=this.getGridDataViewers(),s,p,t,r,q=false;if(!!o){s=o.length;for(p=0;p<s;p++){t=o[p];r=t.getGeoColumnAttribute();if(!!r){q=t.model.supportsViewFilterActions(r);}if(!q){return false;}}}return true;},isObjectSelected:function h(t){var r,p=this.getGridDataViewers(),o=p?p.length:0,s=false;for(r=0;r<o;r++){var q=p[r];if(t.attributes.layerKey===q.k){if(q.isSelected(t)){s=true;break;}}}return s;},backupSelections:function F(){var p=this.gridDataViewer,o=p?p.length:0,r;this.backupToolBarSelections();this.backupSelectionAreas();for(var q=0;q<o;q++){r=p[q];r.backupSelections();}},restoreSelectionDataOnly:function I(){if(!this.selectionBackUp){return ;}this.restoreMapSelectionDataOnly();var p=this.gridDataViewer,o=p?p.length:0,r;for(var q=0;q<o;q++){r=p[q];r.restoreSelectionDataOnly();}},restoreSelectionEffects:function A(){if(!this.selectionBackUp){return ;}this.restoreToolbarSelectionEffects();var p=this.gridDataViewer,o=p?p.length:0,r;for(var q=0;q<o;q++){r=p[q];r.restoreSelectionEffects();}this.restoreSelectionAreas();},clearOldSelections:function a(){var p=this.gridDataViewer,o=p?p.length:0,r;for(var q=0;q<o;q++){r=p[q];r.clearSelections();}},clearSelectionBackup:function S(){var p=this.gridDataViewer,o=p?p.length:0,r;this.selectionBackUp=null;for(var q=0;q<o;q++){r=p[q];r.clearSelectionBackup();}},backupToolBarSelections:mstrmojo.emptyFn,restoreMapSelectionDataOnly:mstrmojo.emptyFn,restoreToolbarSelectionEffects:mstrmojo.emptyFn,backupSelectionAreas:mstrmojo.emptyFn,restoreSelectionAreas:mstrmojo.emptyFn};})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig");var D=mstrmojo.string,A=mstrmojo.dom,E=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(){var K=this,J=K.statusList,F=J&&J.length||0,G=K.statusConfig||new mstrmojo.ui.menus.MenuConfig(),L=function(M){return function(N){K.set("status",M);K.onStatusClick(M);};};if(!G.hasMenuItems()&&F){for(var H=0;H<F;H++){var I=J[H];G.addMenuItem(I.n,I.cls||"",L(I),K);}}else{}if(G.hasMenuItems()){G.alignment=K.alignment||{host:E.BOTTOM_LEFT,popup:E.TOP_LEFT};G.hostId=K.id;G.hostElement=K[K.hostElementName]||K.domNode;K.openPopup(G.newInstance());}}function C(){var F=this.statusConfig||this.statusList&&this.statusList.length>1;this.menuButtonNode.style.display=F?"":"none";}mstrmojo.ui.StatusButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.ui.StatusButton",markupString:'<div id="{@id}" class="mstrmojo-StatusButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}"><div class="mstrmojo-Button {@innerIconClass}"  mstrAttach:click><span class="mstrmojo-text"></span></div><div class="menuButton" mstrAttach:click></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},textSpanNode:function(){return this.domNode.firstChild.firstChild;},menuButtonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onstatusChange:function(){this.textSpanNode.innerHTML=D.encodeHtmlString(this.status&&this.status.n||"");},onstatusListChange:function(){C.call(this);},onstatusConfigChange:function(){C.call(this);}},status:null,statusList:null,statusConfig:null,onclick:function(F){var G=A.eventTarget(F.hWin,F.e);if(A.contains(this.menuButtonNode,G,true)){B.call(this);}else{if(A.contains(this.textNode,G,true)){this.onButtonClick(this.status,F);}}},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ui.menus.MenuConfig");var A=mstrmojo.func,J=mstrmojo.desc(2177,"Close");function G(L){return function(N,M){M.openMenu(L,N);};}mstrmojo.ui.menus.ToolbarConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.ui.menus.ToolbarConfig",btns:null,hasCloseButton:false,closeButtonText:J,addCloseButton:function E(L){this.hasCloseButton=true;if(L){this.closeButtonText=L;}},addToolbarBtn:function I(Q,M,P,L,N){var O={n:Q,cls:M,fn:P,ctxt:L};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}return O;},addDisabledToolbarBtn:function I(N,L){var M=this.addToolbarBtn(N,(L||"")+" disabled",mstrmojo.emptyFn);M.dsbld=true;},addToolbarPickerBtn:function B(R,M,P,Q,L,N){var O={n:R,cls:M,fn:P,ctxt:L,tp:"pb",menufn:G(Q||this)};if(isNaN(N)||N>=this.btns.length){this.btns.push(O);}else{this.btns.splice(N,0,O);}},addMenuToolbarBtn:function H(P,L,O,M,N){if(!O&&!this.hasMenuItems()){return ;}this.addToolbarBtn(P,L,A.composite([G(O||this),(N||mstrmojo.emptyFn)]),null,M);},addToggleToolbarButton:function D(S,O,Q,N,M,R,L){var P=this.getToggleItemStates(S,O,Q,N,R,L);this.addDualStateItem(M,P[0],P[1],true);},addDualStateItem:function K(M,L,N,O){this["add"+(O?"ToolbarBtn":"MenuItem")](L.n,L.cls,this.getDualStateHandler(M,L,N),L.ctxt);},getDualStateHandler:function C(M,L,N){var O=this._super(M,L,N);return function(P,Q){O.call(this,P,Q);Q.refresh();};},clear:function F(){this.btns=[];this.hasCloseButton=false;this.closeButtonText=J;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._HasLayout","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.expr","mstrmojo.css");var C=mstrmojo.expr.DTP,B=mstrmojo.css,A="mstrmojo-Stepper-ErrValidation";mstrmojo.ui.editors.controls.Stepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.Stepper",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,mouseup,mousemove,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text"></div><div class="prev">-</div></div>',layoutConfig:{w:{textNode:"100%"},xt:true},textInput:null,init:function E(F){var G=F.provider;this.children=[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"textInput",slot:"textNode",dtp:G.dtp||C.INTEGER,constraints:{validator:G.validator,max:G.max,min:G.min},onValid:function(){var H=this.parent;B.removeClass(H.domNode,A);G.setVal(parseInt(this.value,10)||0);H.updateDisplayText();}}];this._super(F);this.addDisposable(G);B.addWidgetCssClass(this,"mstrmojo-ui-ctrl-Stepper");},postBuildRendering:function(){this.updateDisplayText();this._super();},updateDisplayText:function D(){this.textInput.set("value",this.provider.getVal());}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.ui.ScrollableSuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var M=mstrmojo.dom,O=mstrmojo.css,z=mstrmojo.Enum_Keys,D=mstrmojo.range,c=D.EDGE,r=mstrmojo.ME.MetricToken.isDelimiter,L=mstrmojo.expr,h=mstrmojo.array,H=mstrmojo.hash;function AG(E){return E.ctrlKey||M.isMetaKey(window,E);}mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function N(E){var AH=E.ownerDocument,AI=AH.createElement("span");return AI;},_iw2idx:function P(AH,AK,AJ){var AI=this.wrapperNodes(AK),E=mstrmojo.array.indexOf(AI,AJ);return E===-1?AI.length:E;},itemOffsetLeft:function a(AH,AL,E,AJ){if(!AJ){var AI=this.wrapperNodes(AL);AJ=AI&&AI[E];if(!AJ){return 0;}}var AK=AL.firstChild;if(!AK||(AK===AJ)){return 0;}return AJ.offsetLeft-AK.offsetLeft;},whereDrop:function AF(AP,E,AJ,AO,AH){var AL=this._nd2iw(AP,E,AJ),AQ,AN,AK,AM,AI;if(AL){AN=this._iw2idx(AP,E,AL);AQ=AN;AK=this.itemOffsetLeft(AP,E,null,AL);AM=AL.offsetTop;AI=AL.offsetWidth;if(AO.x>AH.left+AK+AI/2){AQ++;AK+=AI;}}else{return AP.dropCuePos;}return{left:AK,top:AM,idx:AQ,idxActual:AN};}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",containerResizable:false,dropZone:true,suggestionPopupCssClss:"mstrmojo-ME-TokenInputBox-suggest",allowDrop:function C(E){var AH=E.src.data;return !!AH;},ondrop:function(E){E.src.data={v:mstrmojo.ME.MetricToken.brackets(E.src.data.item.n),oi:H.copyProps(["did","n","t"],E.src.data.item),isNew:true};if(this.prepareDropItem){this.prepareDropItem(E);}this.insertTokens([E.src.data]);this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondragenter:function F(E){this.dragdata=E.src.data;this._super(E);this.set("dropCuePos",{left:0,top:0});mstrmojo.css.addClass(this.domNode,"unselectable");},ondragleave:function Q(){this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondropCuePosChange:function S(AH){var AI=AH.value,E=this.dragdata;if(E&&E.setAvatarClass){if(AI){E.setAvatarClass("add");}else{E.setInvalidAvatarClass();}}},makeObservable:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"ondragstart = "return false;" oncontextmenu = "document.oncontextmenu =  mstrmojo.all.{@id}.fnContextMenu;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" onpaste = "return mstrmojo.all.{@id}.handlepasteDirect(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.childNodes[1];},scrollboxNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",items:null,itemFunction:function G(AI,E,AH){return new mstrmojo.ME.MetricToken({data:AI,parent:AH});},listMapper:mstrmojo.ME.SpanListMapper,_set_items:function R(AH,E){if(this._super){this._super(AH,E);}if(!this.tokensCacheInitilized){this.pretokensModify();this.tokensCacheInitilized=true;}},tokensCache:[],tokensCachePointer:0,isDelimiter:r,postBuildRendering:function X(){if(this._super){this._super();}this._eros=false;if(M.isFF){document.body.spellCheck=false;}},fnContextMenu:function I(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},handlekeydown:function V(AM){AM=AM||window.event;var AK=AM.keyCode||AM.charCode,AI=false,AN=D.getRangeInfo();if((AG(AM)||AK===z.LEFT_ARROW||AK===z.RIGHT_ARROW)&&this.doubleByte){this.doubleByte=false;var AL=this.prev_rInfo,AH=AN,AO=AH.startContainer.data.slice(AL.startOffset,AN.startOffset);this.widgetHandleImeInput(AL,AO);return ;}switch(AK){case z.DELETE:if(!this.doubleByte){try{this.widgetHandleDelete(AN);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(AJ){}AI=true;}break;case z.BACKSPACE:if(!this.doubleByte){try{this.widgetHandleBackspace(AN);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(E){}AI=true;}break;case z.ENTER:if(this.breakOnEnterKeyDown&&this.breakOnEnterKeyDown()){break;}case z.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}AI=true;break;case z.ESCAPE:this.endTokenSuggestion();AI=true;break;case 86:if(AG(AM)){this._saveRangeInfo=D.getRangeInfo();if(!this._saveRangeInfo.collapsed){this.widgetHandleDelete(this._saveRangeInfo);this._saveRangeInfo=D.getRangeInfo();}this.clipboardNode.focus();AI=false;}break;case 89:if(AG(AM)){this.widgetHandleUndoRedo("redo");AI=true;}break;case 90:if(AG(AM)){this.widgetHandleUndoRedo("undo");AI=true;}break;case 229:if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=AN;this.prev_items=this.items;}break;default:}if(AI){M.stopPropogation(window,AM);M.preventDefault(window,AM);return false;}return true;},getCharacter:function AB(AH){var E=(M.isIE&&!M.isIE9)?AH.keyCode:AH.charCode;return(E>0)?String.fromCharCode(E):null;},handlekeypress:function A(AJ){AJ=AJ||window.event;var AK=this.getCharacter(AJ),AH=false;if(AK&&!((AK==="c"||AK==="a")&&AG(AJ))){try{this.widgetHandleInput(D.getRangeInfo(),AK);this.raiseChangeEvent({type:"input",character:AK});if(!this.isDelimiter(AK)){if(this.useKeyDelay){var AI=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){AI.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion(true);}}catch(E){}AH=true;}if(AH){M.stopPropogation(window,AJ);M.preventDefault(window,AJ);return false;}return true;},handlekeyup:function Y(AI){var E=AI.keyCode||AI.charCode,AH;if(E===z.LEFT_ARROW||E===z.RIGHT_ARROW){AH=this.findObjectToken();if(AH&&AH===this._saveActiveToken){this.startTokenSuggestion(AH);}else{this.endTokenSuggestion();}}else{if(E===z.UP_ARROW){this.preHighlight();}else{if(E===z.DOWN_ARROW){this.nextHighlight();}}}this._saveRangeInfo=D.getRangeInfo();},handlemouseup:function g(AM){if(this.dropCuePos){return false;}var AI=this.findObjectToken();if(AI&&AI===this._saveActiveToken){this.startTokenSuggestion(AI);}else{this.endTokenSuggestion();}var AK=D.getRangeInfo();if(this.doubleByte){this.doubleByte=false;var AL=this.prev_rInfo,AJ=this._saveRangeInfo,AH=AJ.startContainer.data.slice(AL.startOffset,AJ.startOffset+1);if(AH!==""){var E=this.widgetHandleImeInput(AL,AH);this.prev_items=this.items;AI=M.findWidget(AK.startContainer);if(AI){this._delaySetTextCaretPos(AI.domNode,AK.startOffset);}else{this._delaySetTextCaretPos(E.domNode,AK.startOffset-1);}}this.prev_rInfo=AK;}this._saveRangeInfo=AK;},handlepasteDirect:function w(E){this.clipboardNode.value=E.clipboardData.getData("Text");this.handlepaste(E);M.stopPropogation(window,E);M.preventDefault(window,E);return false;},handlepaste:function e(AL){var AH=this.clipboardNode.value;this.clipboardNode.value="";var AK=[],E=AH&&AH.length,AJ,AI="",AM;if(E>0){for(AJ=0;AJ<E;AJ++){AM=AH.charAt(AJ);if(this.isDelimiter(AM)){if(!mstrmojo.string.isEmpty(AI)){AK.push({v:AI,isNew:true});AI="";}AK.push({v:AM,isDelimiter:true,isNew:true});}else{AI=AI+AM;}}if(!mstrmojo.string.isEmpty(AI)){AK.push({v:AI,isNew:true});AI="";}this.insertTokens(AK);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function AE(){var AH=[],AJ=this.items,AI,E;for(AI=0,E=AJ.length;AI<E;AI++){AH[AI]=AJ[AI].v;}return AH.join("| ");},replaceErrorToken:function k(AJ){var AI=this.items||[],AK=mstrmojo.array.find(AI,"sta",-1),AH,AL=function(AR,AP,AS){var AO=(AR&&AR.items)||[],AN=h.find(AO,"did",AP),AM,AQ;if(AN>-1){AM=AO[AN].fs;AQ=h.filterOne(AM,function(AT){return AT.fnm&&AT.fnm.toUpperCase()===AS.toUpperCase();});}return AQ;},E=function(AR,AP,AQ){var AM={v:AP.n,oi:AP,isNew:true},AO=AR.v&&AR.v.split("@"),AN;if(AO&&AO.length>1){AN=AL(AQ,AP.did,AO[1]);if(AN){AM.exv=AN.fmdid||AN.fid;AM.extp=8;AM.v=mstrmojo.ME.MetricToken.brackets(AP.n)+"@"+AN.fnm;}}return AM;};if(AK>-1){AH=E(AI[AK],AJ,this.candidates);this.remove(AK);this.add([AH],AK);}},widgetHandleDelete:function Z(AK){if(AK.collapsed){var AJ,AI,E,AL=AK.startOffset,AH=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AK.startContainer,false,document.body)){D.collapseOnNode(this.editNode,false);return ;}AJ=D.getEdgeInfo(AK.startContainer,AK.startOffset);AI=M.findWidget(AK.startContainer);E=this.itemIndex(AI.data);if(AJ===c.EDGE_END){E++;AI=AH[E];AL=0;}if(!AI){D.collapseOnNode(this.editNode,false);return ;}if(AI.length()===1){this.remove(E);AI=AH[E];if(AI){D.collapseOnNode(AI.domNode,true);}else{D.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{AI.spliceContent(AL,1);D.collapseOnTextNode(AI.domNode,AL);}}else{this.widgetDeleteTokens(AK);}},widgetHandleBackspace:function q(AK){if(AK.collapsed){var AJ,AI,E,AL=AK.startOffset,AH=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AK.startContainer,false,document.body)){if(AK.startOffset>0&&M.isFF){AI=AH[this.items.length-1];D.collapseOnNode(AI.domNode,false);AK=D.getRangeInfo();AJ=D.getEdgeInfo(AK.startContainer,AK.startOffset);}else{D.collapseOnNode(this.editNode,true);return ;}}AJ=D.getEdgeInfo(AK.startContainer,AK.startOffset);AI=M.findWidget(AK.startContainer);E=this.itemIndex(AI.data);if(AJ===c.EDGE_BEGIN){E--;AI=AH[E];AL=AI.length();}if(!AI){D.collapseOnNode(this.editNode,true);return ;}if(AI.length()===1){this.remove(E);AI=AH[E-1];if(AI){D.collapseOnNode(AI.domNode,false);this.checkMergeTwoTokens(E-1,E);AI=AH[E-1];}else{D.collapseOnNode(this.editNode,true);}}else{AI.spliceContent(AL-1,1);D.collapseOnTextNode(AI.domNode,AL-1);}}else{this.widgetDeleteTokens(AK);}},widgetHandleInput:function s(AL,AM){if(!AL.collapsed){this.widgetDeleteTokens(AL);AL=D.getRangeInfo();}var AI,AN,AO,AP,E,AH,AJ=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AL.startContainer,false,document.body)){this.add([{v:AM,isDelimiter:this.isDelimiter(AM),isNew:true}],0);AN=AJ[0];D.collapseOnTextNode(AN.domNode,1);return ;}AI=D.getEdgeInfo(AL.startContainer,AL.startOffset);AN=M.findWidget(AL.startContainer);AO=this.itemIndex(AN.data);if(this.isDelimiter(AM)){AP={v:AM,isDelimiter:true,isNew:true};if(AI===c.EDGE_MIDDLE){var AK=AN.split2Tokens(AL.startOffset);this.remove(AO);this.add([AK[0],AP,AK[1]],AO);AO=AO+1;}else{AO=(AI===c.EDGE_BEGIN)?AO:AO+1;this.add([AP],AO);}AN=AJ[AO];D.collapseOnNode(AN.domNode,false);}else{AH=AL.startOffset;if(AN.isDelimiter()){E=AJ[(AI===c.EDGE_BEGIN)?AO-1:AO+1];if(E&&!E.isDelimiter()){AN=E;AH=(AI===c.EDGE_BEGIN)?AN.length():0;}}if(!AN.isDelimiter()){AN.spliceContent(AH,0,AM);D.collapseOnTextNode(AN.domNode,AH+1);}else{this.add([{v:AM,isNew:true}],(AI===c.EDGE_BEGIN)?AO:AO+1);AN=AJ[(AI===c.EDGE_BEGIN)?AO:AO+1];D.collapseOnNode(AN.domNode,false);}}},widgetHandleImeInput:function s(AK,AL){if(!AK.collapsed){this.widgetDeleteTokens(AK);AK=D.getRangeInfo();}var AI,AM,AN,AO,E,AH,AJ=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AK.startContainer,false,document.body)){this.clearTokens();this.add([{v:AL,isDelimiter:this.isDelimiter(AL),isNew:true}],0);AJ=this.ctxtBuilder.itemWidgets;AM=AJ[0];D.collapseOnTextNode(AM.domNode,1);this._delaySetCaretPos(AM.domNode,false);return ;}AI=D.getEdgeInfo(AK.startContainer,AK.startOffset);AM=M.findWidget(AK.startContainer);AN=this.itemIndex(AM.data);AH=AK.startOffset;if(AM.isDelimiter()){this.clearTokens();this.set("items",this.prev_items);AJ=this.ctxtBuilder.itemWidgets;E=AJ[(AI===c.EDGE_BEGIN)?AN-1:AN+1];if(E&&!E.isDelimiter()){AM=E;AH=(AI===c.EDGE_BEGIN)?AM.length():0;}}if(!AM.isDelimiter()){AM.spliceContent(AH,0,AL);this._delaySetTextCaretPos(AM.domNode,AH+AL.length);}else{this.add([{v:AL,isNew:true}],(AI===c.EDGE_BEGIN)?AN:AN+1);AM=AJ[(AI===c.EDGE_BEGIN)?AN:AN+1];this._delaySetCaretPos(AM.domNode,false);}this.startTokenSuggestion();return AM;},findObjectToken:function B(){var AK=D.getRangeInfo(),AI=M.findWidget(AK.startContainer);if(!M.contains(this.editNode,AK.startContainer,false,document.body)){return null;}if(!AI||AI===this||!AI.isDelimiter){return null;}if(AI&&!AI.isDelimiter()){return AI;}var AJ=D.getEdgeInfo(AK.startContainer,AK.startOffset),AH=this.ctxtBuilder.itemWidgets,E=this.itemIndex(AI.data);AI=AH[(AJ===c.EDGE_BEGIN)?E-1:E+1];if(AI&&!AI.isDelimiter()){return AI;}return null;},checkMergeTwoTokens:function o(AK,AI){var AJ=this.ctxtBuilder.itemWidgets,AH=AJ[AK],E=AJ[AI];if((AH&&!AH.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([AK,AI]);this.add([AH.mergeTo(E)],AK);D.collapseOnTextNode(AJ[AK].domNode,AH.length());}},insertTokens:function u(AN){var E=0,AH=this.editNode;var AM=this._saveRangeInfo||D.getRangeInfo();if(!AM||!M.contains(AH,AM.startContainer,false,document.body)){this.add(AN);E=this.items.length-1;this._delaySetTextCaretPos(AH,(AH.innerText||AH.textContent).length);}else{var AL=D.getEdgeInfo(AM.startContainer,AM.startOffset),AI=M.findWidget(AM.startContainer);E=this.itemIndex(AI.data);if(AL===c.EDGE_MIDDLE){var AK=AI.split2Tokens(AM.startOffset);this.remove(E);AN.unshift(AK[0]);AN.push(AK[1]);this.add(AN,E);}else{E=(AL===c.EDGE_BEGIN?E:E+1);this.add(AN,E);}E=E+AN.length-1;AI=this.ctxtBuilder.itemWidgets[E];this._delaySetCaretPos(AI.domNode,false);}this.raiseChangeEvent({type:"insert"});var AJ=this;window.setTimeout(function(){AJ._saveRangeInfo=D.getRangeInfo();},50);return E;},insertParenthesisTokens:function y(AH){var E=this;window.setTimeout(function(){var AI=E.insertTokens([{v:"(",isDelimiter:true,isNew:true},{v:")",isDelimiter:true,isNew:true}]);E._delaySetTextCaretPos(E.itemsContainerNode.childNodes[AI]);},AH||50);},clearTokens:function n(E){this.set("items",E||[]);this._saveRangeInfo=null;this._delaySetCaretPos(this.editNode,false);},focus:function t(){var AH=this.ctxtBuilder.itemWidgets,E=AH.length;this._delaySetCaretPos(E>0?AH[E-1].domNode:this.editNode,false);},startTokenSuggestion:function AA(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length===0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[L.TP.FOLDER,L.TP.FACT,L.TP.ATTR,L.TP.FUNCTION,L.TP.FILTER,L.STP.PROMPT_OBJECTS,L.TP.ATTR,L.TP.DIM,L.TP.METRIC,L.TP.ROLE].join(","),getSearchPattern:function U(){var AH=this._saveActiveToken,AJ=AH&&AH.data.v,E=AJ&&AJ.length;if(E>2){if(AJ.charAt(0)==="["){AJ=AJ.substring(1);}if(AJ.charAt(AJ.length-1)==="]"){AJ=AJ.substring(0,AJ.length-1);}}if(AH&&AH.data.ift){var AI=AH.data.v,AK=AI&&AI.indexOf("@");if(AK>=0){AJ=AI.substring(AK);}}return AJ||"";},getSuggestionPos:function b(){var E=this._saveActiveToken,AH=null,AJ,AI;if(E){AJ=E.data&&E.data.ift;AI=mstrmojo.dom.position(E.domNode,true);AH={left:Math.round(AI.x+(AJ?AI.w:0))+"px",top:Math.round(AI.y+AI.h)+"px",zIndex:100};}return AH;},item2textCss:function J(AH){var E=(this._super&&this._super(AH))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr",21:"afm","-99":"br"}[AH.t]||"";E+=AH.da?" da":"";E+=(AH.dm||AH.um)?" dm":"";E+=AH.de?" de":"";E+=AH.fs&&AH.fs.length&&AH.fs.some(function(AI){return AI.fgr>0;})?" g":"";return E;},onBrowserOpen:function p(){this.editNode.blur();},onSuggestionItemSelect:function x(AH){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){if(E.data.ift&&AH.t===21){E.setFormInfo(AH);}else{E.setItemInfo(AH);if(AH.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){this.insertParenthesisTokens();}}this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function AC(E,AI){var AH=this.editNode,AJ=this,AK=function(){AH.focus();AH.focus();D.collapseOnNode(E,AI);AJ._saveRangeInfo=D.getRangeInfo();};window.setTimeout(AK,0);},_delaySetTextCaretPos:function AC(E,AK){var AH=this.editNode,AI=this,AJ=function(){AH.focus();AH.focus();D.collapseOnTextNode(E,AK);AI._saveRangeInfo=D.getRangeInfo();};window.setTimeout(AJ,0);},getCandidatesThroughTaskCall:function W(AH,E){AH.objectType="11,12,13,43,4";AH.rootFolderType=39;AH.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AH,E);},filterCandidates:function m(AK,AJ,E){var AH=this._saveActiveToken,AL=AH&&(AH.data.oi||AH.data.at),AI;if(AL&&AH.data.ift){E=E||this.suggestCount;AJ=mstrmojo.string.regEscape(AJ);AI=h.filter(AK,function(AM){return AM.t===21&&AM.attid===AL.did&&(new RegExp("^"+AJ,"i")).test("@"+AM.n);},{max:E});}else{AI=h.filter(AK,function(AM){return AM.t!==21;});AI=this._super(AI,AJ,E);}return AI;},endTokenSuggestion:function AD(AH){var E=this._saveActiveToken;if(E){if(AH){this.hideSuggestion();}E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function f(AP){var AH=AP.startOffset,E=AP.endOffset,AS=M.findWidget(AP.startContainer),AQ=M.findWidget(AP.endContainer),AL=this.itemIndex(AS.data),AJ=this.itemIndex(AQ.data),AM=[],AN=D.getEdgeInfo(AP.startContainer,AH),AR=D.getEdgeInfo(AP.endContainer,E),AO=(AN===c.EDGE_BEGIN?AL:AL+1),AI=(AR===c.EDGE_END?AJ:AJ-1),AK;if(AS===AQ){if((AN===c.EDGE_BEGIN)&&(AR===c.EDGE_END)){this.remove(AL);AQ=this.ctxtBuilder.itemWidgets[AL===0?AL:AL-1];if(AQ){D.collapseOnNode(AQ.domNode,AL===0);}else{D.collapseOnNode(this.editNode,true);}}else{AS.spliceContent(AH,E-AH);D.collapseOnTextNode(AQ.domNode,AH);}}else{for(AK=AO;AK<=AI;AK++){AM.push(AK);}this.remove(AM);if(AN===c.EDGE_MIDDLE){AS.spliceContent(AH);}if(AR===c.EDGE_MIDDLE){AQ.spliceContent(0,E);}if(AN===c.EDGE_BEGIN){AS=this.ctxtBuilder.itemWidgets[AL===0?AL:AL-1];}if(AS){D.collapseOnNode(AS.domNode,AL===0);}else{D.collapseOnNode(this.editNode,false);}AL=(AN===c.EDGE_BEGIN)?AL-1:AL;this.checkMergeTwoTokens(AL,AL+1);}this.editNode.focus();},oncandidatesChange:function l(){var AH=this.candidates,E=(AH&&AH.items)||[];if(!this.noCache&&AH&&AH.isComplete){this.suggestCount=this.REQUEST_THRESHOLD=E.length;}else{this.suggestCount=mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=20;}},nudge:function(E){var AH=this.getSuggestionPos();if(AH){E.set("left",AH.left);E.set("top",AH.top);}},pretokensModify:function K(){this.tokensCache=this.tokensCache.slice(0,this.tokensCachePointer);var E=this.findObjectToken();this.tokensCache.push({items:H.clone(this.items),rInfo:D.getRangeInfo(),idx:E!==null?this.itemIndex(E.data):-1});this.tokensCachePointer=this.tokensCache.length;},widgetHandleUndoRedo:function d(AI){var AJ,E,AH=function(AL){if(!AL){return ;}AL=AL||{};this.set("items",H.clone(AL.items));var AO=this.ctxtBuilder.itemWidgets,AK=AO[AL.idx],AN=AK&&AK.domNode||this.editNode,AM=AL.rInfo;this._delaySetTextCaretPos(AN,AM&&AM.startOffset||0);};switch(AI){case"undo":AJ=--this.tokensCachePointer;if(AJ>-1){E=this.tokensCache[AJ-1];AH.call(this,E);}else{this.tokensCachePointer=1;}break;case"redo":AJ=this.tokensCachePointer++;if(AJ>-1&&AJ<this.tokensCache.length){E=this.tokensCache[AJ];AH.call(this,E);}else{this.tokensCachePointer=Math.min(Math.max(this.tokensCachePointer,1),this.tokensCache.length);}break;}},resetTokensCache:function T(){this.tokensCache=[];this.tokensCachePointer=-1;this.tokensCacheInitilized=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ME.TokenInputBox");mstrmojo.requiresDescs(13542,13543);var B=mstrmojo.array;var L={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},G={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},H={0:mstrmojo.desc(9565,"Valid Metric Formula."),1:mstrmojo.desc(9106,"Require Validation?"),2:mstrmojo.desc(9566,"Validation in Progress..."),3:mstrmojo.desc(9567,"Validation Failed with Syntax Error!"),4:mstrmojo.desc(9568,"Validation Failed with Object Ambiguity!")};function D(O){if(!O){return L.VALID;}return{"-2147214845":L.ERROR,"-2147214846":L.AMBIGUITY}[O]||L.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricEditBox",vStatus:L.VALID,iStatus:"",showStatus:true,browseItemVisible:true,absorbAmbiguity:true,isObjectVisible:function(O){return true;},markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;}},markupMethods:{onvStatusChange:function(){var P=this.vStatus,O=this.vStatusNode;O.className="mstrmojo-MEBox-vStatus "+G[P];O.innerHTML=(this.getStatusDesc&&this.getStatusDesc(P))||H[P]||"";},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;this.iStatusNode.title=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:0,bindings:{browseItemVisible:"this.parent.browseItemVisible",candidates:"this.parent.candidates"}}],init:function N(O){if(this._super){this._super(O);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function M(){return this.inputBox.getSearchPattern();},getHighlightedText:function I(P,O){return this.inputBox.getHighlightedText(P,O);},item2textCss:function F(O){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[O.t]||"";},handleSuggestionItemSelect:function E(O){var P=this.abiguityDialog;if(O){P.onItemSelect(O);}P.close();},showDesc:true,showPath:true,abiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title",mstrmojo.desc(13542,"Object Ambiguity - ##").replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.list.singleSelect(0);this.label.set("text",mstrmojo.desc(13543,"More than one object with the name '##' were found.").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"},onclick:function(O){mstrmojo._IsList.onclick.call(this,O);}}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:mstrmojo.desc(547,"Select"),onclick:function(){var O=this.parent.parent;O.opener.handleSuggestionItemSelect(O.list.selectedItem);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]},defaultOnTokensModify:function(){this.set("vStatus",L.UNKNOWN);this.set("iStatus","");},postBuildRendering:function A(){this._super();this.inputBox.attachEventListener("tokensModify",this.id,"defaultOnTokensModify");this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function K(O){this.inputBox.set("items",O.items);},replaceErrorToken:function C(O){this.inputBox.replaceErrorToken(O);},handleValidation:function J(O){if(!O){this.set("vStatus",L.ERROR);return ;}O.vs=D(O.rjec);this.set("vStatus",O.vs);this.set("iStatus",O.rjed||"");this.updateInputBoxItems(O);this.inputBox.focus();if(O.vs===L.AMBIGUITY){var W=this,T=O.items,S=B.find(T,"sta",-1),P=T[S].v,U=function(X){W.replaceErrorToken(X);W.set("iStatus","");W.set("vStatus",L.UNKNOWN);if(W.continueValidataion){W.continueValidataion();}};var Q=B.filter(O.srfd.items,this.isObjectVisible);var V=this.parent.candidates,R=V&&V.items;if(R){B.forEach(Q,function(Y){var X=B.find(R,"did",Y.did);if(X===-1){if(this.absorbAmbiguity){R.push(Y);}}else{Y.path=R[X].path;}});}if(Q.length===1){U(Q[0]);return ;}this.openPopup("abiguityDialog",{zIndex:100,items:Q,ambiguousName:P,onItemSelect:U});}else{if(this.postHandleValidation){this.postHandleValidation();}}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=L;}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.Button","mstrmojo.date","mstrmojo.ui.editors.controls.Stepper","mstrmojo.css");var AD=function(){return mstrmojo.locales.datetime;},k=mstrmojo.dom,h=mstrmojo.expr,AA=h.DTP,Z=mstrmojo.date,J=mstrmojo.publisher,e=mstrmojo.hash,m=mstrmojo.array,N=m.removeIndices,l=mstrmojo.css;var AC=0,C=3,M=4,p=5,Q=6;var AE="month",c="day",V="year",X="hour",AH="minute",x="second";var G='<table border="0" cellpadding="0" cellspacing="0">',w="</table>";function O(AI){return'<table border="0" cellpadding="0" cellspacing="0" style="'+AI+'">';}function H(AL,AI,AJ){var AK=Z.getFirstDateOfMonth(AL,AI);return(AK.getDay()-AJ+8)%7;}function n(AL){var AK=Z.parseDateAndOrTime(AL),AM,AI,AJ;if(AK){AJ={};AM=AK.date;AI=AK.time;if(AM){e.copy(AM,AJ);}if(AI){e.copy(AI,AJ);}}return AJ;}function F(AJ,AM,AL,AK,AI){var AN=Z.formatDateInfo({day:AJ,month:AM,year:AL},AD().DATEOUTPUTFORMAT);return Z.inDateTimeRange(AN,AK,AI)===0;}function T(AM,AL,AK){var AJ=AM.decreaseButton,AI=AM.increaseButton,AN="mstrmojo-Calendar";AJ.className=(AN+"-decrease");AI.className=(AN+"-increase");}function W(AM,AJ,AO,AL){var AK=0,AI=AM.length,AN;for(AK=0;AK<AI;AK++){AN=AM[AK];if(AN&&AN.day===AJ&&AN.month===AO&&AN.year===AL){return AK;}}return -1;}function q(AI,AK,AJ){var AL=new Date();return(AL.getFullYear()===AJ)&&((AL.getMonth()+1)===AK)&&(AL.getDate()===AI);}function u(AP,AQ){var AU=AP.dayView.getElementsByTagName("div"),AS=AP.selectedDates,AK=AS[AQ],AT=AP.browseYear,AJ=AP.browseMonth,AM=Z.getDaysOfMonth(AT,AJ),AL=Z.getPreMonth(AT,AJ),AO=Z.getDaysOfMonth(AL.y,AL.m),AI=H(AT,AJ,AP.firstDayOfWeek),AN=((AK.month===AJ)?AK.day+AI-1:(AK.month>AJ?AK.day+AI+AM-1:AI-AO+AK.day-1)),AR=AU[AN];if(AR){b(AR,AP,false);}N(AS,AQ,1);}function B(AI){var AJ=AI.selectedDates;while(AJ.length){u(AI,0);}}function AG(AK,AI){var AJ=K(AK,AI),AL=AK.selectedDates;AL.push({day:AJ.d,month:AJ.m,year:AJ.y});b(AI,AK,true);}function o(AK,AL){if(!AL||!AL.length){return null;}var AN=AK.selectedDates;for(var AJ=0,AI=AL.length;AJ<AI;AJ++){var AM=AL[AJ],AO=r(AK,AM);AN.push({day:AM.d,month:AM.m,year:AM.y});if(AO){b(AO,AK,true);}}}function r(AQ,AS){var AU=AQ.dayView.getElementsByTagName("div"),AL=AU.length,AT=AQ.browseYear,AJ=AQ.browseMonth,AM=Z.getPreMonth(AT,AJ),AN=Z.getDaysOfMonth(AM.y,AM.m),AY=Z.getNextMonth(AT,AJ),AK=Z.getDaysOfMonth(AT,AJ),AI=H(AT,AJ,AQ.firstDayOfWeek);var AO=AI>0?{y:AM.y,m:AM.m,d:AU[0].innerHTML}:{y:AT,m:AJ,d:AU[0].innerHTML},AW=(AU.length-AK-AI)>0?{y:AY.y,m:AY.m,d:AU[AL-1].innerHTML}:{y:AT,m:AJ,d:AU[AL-1].innerHTML},AX=S(AO,AS),AP=S(AS,AW),AR=null;if(AX>=0&&AP>=0){var AV=0;if(AX<AI){AV=-1;}if(AP<(AU.length-AI-AK)){AV=1;}AR=((AV===0)?AS.d+AI-1:(AV===1?AS.d+AI+AK-1:AI-AN+AS.d-1));return AU[AR];}else{return null;}}function f(AQ,AI){var AS=AQ.selectedDates,AK=AS.length;if(!AK){return null;}var AJ=AS[AK-1],AL=K(AQ,AI),AV=S({y:AJ.year,m:AJ.month,d:AJ.day},AL),AW=[],AN=AV>0,AT=Math.abs(AV);for(var AP=0;AP<=AT;AP++){var AO=new Date(AL.y,AL.m-1,AL.d);AO.setDate(AO.getDate()+(AN?-AP:AP));var AU=AO.getFullYear(),AM=AO.getMonth()+1,AR=AO.getDate();if(AQ.isDateDisabled(AR,AM,AU,AQ.min,AQ.max)&&!AQ.canSelectDisabledDate){continue;}AW.push({y:AU,m:AM,d:AR});}return AW;}function S(AL,AK){var AI=new Date(AL.y,AL.m-1,AL.d),AJ=new Date(AK.y,AK.m-1,AK.d);return(AJ-AI)/1000/3600/24;}function K(AK,AI){var AL=AK.browseYear,AN=AK.browseMonth,AM=parseInt(AI.innerHTML,10),AO=parseInt(AI.getAttribute("m"),10),AJ=null;AJ=(AO===0)?{y:AL,m:AN}:(AO===1?Z.getNextMonth(AL,AN):Z.getPreMonth(AL,AN));AJ.d=AM;return AJ;}function g(AI){var AK=AI.selectedDates,AJ=AK.length;return(AJ===0)?null:AK[AJ-1];}function b(AJ,AK,AI){var AL=AK.selectedColor;l.toggleClass(AJ,["selected",AK.selectedCssStyle],AI);AJ.parentNode.style.backgroundColor=AI?AL:"";AJ.style.backgroundColor=AI?AL:"";}function z(AI){return AI.selectedColor?('style="background-color:'+AI.selectedColor+';"'):"";}function P(AI){return(AI.tagName.toLowerCase()==="td")?AI.firstChild:AI;}function R(AJ,AK){var AL=Z.getDateJson(AJ),AI=Z.formatDateInfo(AL,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);if(AK===AA.TIMESTAMP){AI+=" "+Z.formatTimeInfo(this.timeVal,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return AI;}function s(AN,AK){var AI=this.advancedValues,AJ=null;AI.set(AN,AK);switch(AI.baseDate){case C:AJ=new Date();break;case M:break;case p:break;case Q:break;default:return ;}var AL=AI.monthsToAdjust;if(AL>0){AJ.setMonth(AJ.getMonth()+(AI.toAddMonths?AL:-AL));}var AM=AI.daysToAdjust;if(AM>0){AJ.setDate(AJ.getDate()+(AI.toAddDays?AM:-AM));}this.set("value",R.call(this,AJ,this.dtp));}function U(){var AI=this.advancedValues,AJ=["isDyn"];if(AI.baseDate===AC){return null;}AJ.push(AI.baseDate);AJ.push(AI.toAddDays?AI.daysToAdjust:-AI.daysToAdjust);AJ.push(AI.toAddMonths?AI.monthsToAdjust:-AI.monthsToAdjust);AJ.push(0);AJ.push(0);AJ.push(0);AJ.push(0);AJ.push(this.value);AJ.push(this.timeVal.hour);AJ.push(this.timeVal.min);AJ.push(this.timeVal.sec);return AJ.join("::");}function AF(AI){if(AI.value!==undefined&&this.hasRendered){this.updateSelectedDate();}}function I(AK,AJ){var AL=this,AI=function(AM){return AM[0].toUpperCase()+AM.substring(1);};return{scriptClass:"mstrmojo.HBox",cssClass:"dateAdjustBox",alias:AK+"AdjustBox",children:[{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:AJ>=0?0:1,onitemSelected:function(AN,AM){s.call(AL,"toAdd"+AI(AK),AM===0);},items:[{did:0,n:mstrmojo.desc(9424,"plus")},{did:1,n:mstrmojo.desc(9425,"minus")}]},{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:null,height:null,provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,min:0,value:Math.abs(AJ)},onTraverse:function(){s.call(AL,AK+"ToAdjust",this.curVal);}})},{scriptClass:"mstrmojo.Label",text:AK==="days"?mstrmojo.desc(707,"Days"):mstrmojo.desc(710,"Months")}]};}function Y(){this.buttonsNode.style.display=(this.wasAdvanced||this.changeValueOnOK||(this.showAdvanced&&this.isAdvanced)?"block":"none");this.advancedNode.style.display=this.showAdvanced?"block":"none";}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Calendar",cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:c,duration:600,timeDelimiter:":",dtp:AA.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,wasAdvanced:false,showAdvanced:false,isAdvanced:false,dynDateValue:null,canSelectDisabledDate:false,monthNames:function(AI){return AD().MONTHNAME_SHORT[AI];},dayNames:function(AI){return AD().dayShortNames[AI];},min:null,max:null,supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,mouseover,mouseout><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease"></div><div class="mstrmojo-Calendar-increase"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}">{@browseMonth}</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel">00</span><span class="mstrmojo-Calendar-AMPMLabel">AM</span></div><div class="mstrmojo-Calendar-advanced"></div><div class="mstrmojo-Calendar-buttons cf"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){this.monthLabel.innerHTML=this.monthNames(this.browseMonth-1);},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;},ondtpChange:function(){this.timePart.style.display=(this.dtp===AA.TIMESTAMP||this.dtp===AA.TIME)?"block":"none";this.advancedNode.style.display=this.showAdvanced?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:Y,onisAdvancedChange:Y},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].firstChild;},yearView:function(){return this.domNode.childNodes[1].firstChild;},hourView:function(){return this.domNode.childNodes[1].firstChild;},minuteView:function(){return this.domNode.childNodes[1].firstChild;},secondView:function(){return this.domNode.childNodes[1].firstChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},AMPMLabel:function(){return this.domNode.childNodes[2].childNodes[5];},advancedNode:function(){return this.domNode.childNodes[3];},buttonsNode:function(){return this.domNode.childNodes[4];}},init:function AB(AI){if(this._super){this._super(AI);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};},ondynDateValueChange:function t(AI){if(AI.value!==undefined&&this.hasRendered){this.updateSelectedDate();this.buildChildren();}},onminChange:AF,onmaxChange:AF,buildChildren:function a(){var AO=this;if(this.showAdvanced){var AL=this.dynDateValue,AK=this.advancedValues||this.addDisposable(new mstrmojo.Model({})),AR=AL&&AL.split("::")||[],AN=AR[1]||AC,AJ=AR[2]||0,AS=AR[3]||0,AP=function AP(){if(AO.isAdvanced){AO.wasAdvanced=true;AO.changeValueOnOK=true;}AO.set("isAdvanced",!AO.isAdvanced);mstrmojo.css.toggleClass(AO.markupSlots.dayView.call(AO),["ddSelected"],AO.isAdvanced);s.call(AO,"baseDate",AO.isAdvanced?3:0);if(AO.parent&&AO.parent.nudge&&AO.isAdvanced){AO.parent.nudge();}};this.advancedValues=AK;AK.baseDate=parseInt(AN);AK.toAddDays=AJ>=0;AK.daysToAdjust=Math.abs(AJ);AK.toAddMonths=AS>=0;AK.monthsToAdjust=Math.abs(AS);this.isAdvanced=!!this.dynDateValue;if(this.domNode){mstrmojo.css.toggleClass(this.markupSlots.dayView.call(this),["ddSelected"],this.isAdvanced);}if(this.isAdvanced&&this.value){var AI=n(this.value),AM=this.timeVal;if(AI&&AI.hour!==undefined){AM.hour=AI.hour;AM.min=AI.min;AM.sec=AI.sec;}}s.call(AO,"baseDate",this.isAdvanced?3:0);this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.HBox",alias:"checkLabel",slot:"advancedNode",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"checkbox",checked:!!AO.isAdvanced,oncheckedChange:AP},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13844,"Dynamic Date"),onclick:function AQ(){this.parent.checkbox.onclick();}}]},{scriptClass:"mstrmojo.Box",alias:"advancedPanel",slot:"advancedNode",bindings:{visible:"this.parent.isAdvanced"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9423,"Today"),cssClass:"tdLabel"},I.call(this,"days",AJ),I.call(this,"months",AS)]},]);}else{this.destroyChildren(false);}this.addChildren([mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(){AO.parent.close();},false,{slot:"buttonsNode"}),mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){if(AO.changeValueOnOK||AO.isAdvanced||AO.wasAdvanced){AO.updateValue(true);}},true,{slot:"buttonsNode"})]);},preBuildRendering:function A(){this.buildChildren();return this._super();},getSelectedDatesAsString:function E(AJ){var AI=[];m.forEach(this.selectedDates,function(AK){AI.push(Z.formatDateInfo(AK,AJ||AD().DATEOUTPUTFORMAT));});return AI;},updateSelectedDate:function L(AM){var AI=this.value,AJ=this.timeVal,AL=this.selectedDates,AK,AN=function(AP,AO){AP.set("browseYear",AO.year);AP.set("browseMonth",AO.month);AP.updateTimePart();AP.updateView(AP.currentView);if(!AP.changeValueOnOK&&AP.hasRendered&&AP.closeOnValueChange!=true){AP.updateValue();}};if(this.wasAdvanced){this.wasAdvanced=false;this.changeValueOnOK=false;}if(AI){AK=n(AI);if(AK&&AK.hour!==undefined){AJ.hour=AK.hour;AJ.min=AK.min;AJ.sec=AK.sec;}}if((AK&&!this.isMultiSelect)||AM){B(this);}if(AL.length===0){if(!AK){if(this.parent.opener&&this.parent.opener.defaultDate){AK=n(this.parent.opener.defaultDate);}else{AK=Z.getDateJson(new Date());}}if(!this.canSelectDisabledDate&&this.isDateDisabled(AK.day,AK.month,AK.year,this.min,this.max)){if(this.min&&Z.compareDate(AK,this.min)<0){AK=n(this.min);}else{if(this.max&&Z.compareDate(AK,this.max)>0){AK=n(this.max);}}}AL.push(AK);AN(this,AK);}else{AK=AL[0];if(!this.value){AN(this,AK);}}},updateValue:function d(AI){var AK=g(this),AJ="";if(AK){AJ=Z.formatDateInfo(AK,AD().DATEOUTPUTFORMAT);if(this.dtp!==AA.DATE){AJ+=" "+Z.formatTimeInfo(this.timeVal,AD().TIMEOUTPUTFORMAT);}}this.lastValue=AJ;this.set("value",AJ);if(this.showAdvanced){this.set("dynDateValue",AI?U.call(this):null);}if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function y(){var AJ=this.timeVal,AI=AJ.hour||0,AK=(AI%12===0)?12:(AI%12);this.hourLabel.innerHTML=AK;this.minuteLabel.innerHTML=Z.formatInteger(AJ.min||0,2);this.secondLabel.innerHTML=Z.formatInteger(AJ.sec||0,2);this.AMPMLabel.innerHTML=AI<12?" "+AD().AM_NAME:" "+AD().PM_NAME;},premousedown:function(AI){var AK=AI.e,AJ=k.eventTarget(AI.hWin,AK);if(AJ===this.decreaseButton||AJ===this.increaseButton){if(k.isFF){k.stopPropogation(window,AK);}return true;}else{return this.processEvent(AJ,AK);}},premouseup:function(AI){var AK=AI.e;if(AK.ctrlKey||AK.shiftKey){k.clearBrowserHighlights();}var AJ=k.eventTarget(AI.hWin,AK);if(AJ===this.decreaseButton&&!AJ.disabled){this.decrease();return true;}if(AJ===this.increaseButton&&!AJ.disabled){this.increase();return true;}},processEvent:function(AT,Aa){var AL=this.currentView,AM=this.selectedDates,AQ,AV,Ab,AI,AS;if(AT===this.monthLabel){if(AL!==AE){this.switchViewTo(AE);}return true;}if(AT===this.yearLabel){if(AL!==V){this.adjustYearStart();this.switchViewTo(V);return true;}}if(AT===this.hourLabel){if(AL!==X){this.switchViewTo(X);}return true;}if(AT===this.minuteLabel){if(AL!==AH){this.switchViewTo(AH);}return true;}if(AT===this.secondLabel){if(AL!==x){this.switchViewTo(x);}return true;}if(AT===this.AMPMLabel){if(AL!==X){this.switchViewTo(X);}return true;}if(AL===X){var AO=AT.getAttribute("h");AS=parseInt(AT.innerHTML,10);if(!isNaN(AO)&&!isNaN(AS)){AO=parseInt(AO,10);this.timeVal.hour=AS%12+AO*12;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AL===AH){AS=parseInt(AT.innerHTML,10);if(!isNaN(AS)){this.timeVal.min=AS;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AL===x){AS=parseInt(AT.innerHTML,10);if(!isNaN(AS)){this.timeVal.sec=AS;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AL===c){var AZ=this.browseYear,AJ=this.browseMonth,AK;AT=P(AT);Ab=parseInt(AT.innerHTML,10);AI=parseInt(AT.getAttribute("m"),10);if(!isNaN(Ab)&&!isNaN(AI)){AK=(AI===0)?{y:AZ,m:AJ}:(AI===1?Z.getNextMonth(AZ,AJ):Z.getPreMonth(AZ,AJ));if((!this.canSelectDisabledDate&&this.isDateDisabled(Ab,AK.m,AK.y,this.min,this.max))||Aa.button===2){return true;}if(this.isAdvanced){return true;}var AW=W(AM,Ab,AJ,AZ),AU=AM.length>1,AR=this.forceNonEmptySelection,AX=this.isMultiSelect,AP=AX&&Aa.ctrlKey,AY=AX&&Aa.shiftKey,AN=null;if(AY){AN=f(this,AT);B(this);o(this,AN);}else{if(AP){if(AW===-1){AG(this,AT);}else{if(!AR||AU){u(this,AW);}}}else{B(this);if(AU||AW===-1||AR){AG(this,AT);}}}if(this.onselect||J.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(AI===1){this.increase();}else{if(AI===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}else{if(this.showAdvanced){this.checkLabel.checkbox.set("checked",false);s.call(this,"baseDate",0);}}}return true;}if(AL===AE){AT=P(AT);AV=parseInt(AT.getAttribute("m"),10);if(!isNaN(AV)){this.set("browseMonth",AV+1);this.switchViewTo(c);}return true;}if(AL===V){AT=P(AT);AQ=parseInt(AT.innerHTML,10);if(!isNaN(AQ)){this.set("browseYear",AQ);this.switchViewTo(c);}return true;}return true;},decrease:function(){var AK=this.currentView,AN=AK,AM=this.browseYear,AI=this.browseMonth,AJ=this.yearRangStart,AL;switch(AK){case c:AL=Z.getPreMonth(AM,AI);this.set("browseMonth",AL.m);this.set("browseYear",AL.y);break;case AE:this.set("browseYear",AM-1);break;case V:this.yearRangStart=AJ-this.yearViewSize*this.yearViewSize;break;case X:AN=x;break;case AH:AN=X;break;case x:AN=AH;break;}this.switchViewTo(AN,"right");},increase:function(){var AK=this.currentView,AN=AK,AM=this.browseYear,AI=this.browseMonth,AJ=this.yearRangStart,AL;switch(AK){case c:AL=Z.getNextMonth(AM,AI);this.set("browseMonth",AL.m);this.set("browseYear",AL.y);break;case AE:this.set("browseYear",AM+1);break;case V:this.yearRangStart=AJ+this.yearViewSize*this.yearViewSize;break;case X:AN=AH;break;case AH:AN=x;break;case x:AN=X;break;}this.switchViewTo(AN,"left");},updateView:function(AI){var AJ=this[AI+"ViewHTML"]();this[AI+"View"].innerHTML=AJ;},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(AJ,AL){var AP="mstrmojo-Calendar-"+AJ+"View",AO=document.createElement("div"),AI=this[this.currentView+"View"],AM=AJ+"ViewHTML",AN=this[this.currentView+"Label"],AK=this[AJ+"Label"];if(!this.supportedViews[AJ]){return ;}if(!AL){AL=this.sDirMatrix[this.currentView][AJ];}AO.className=AP;AO.innerHTML=this[AM]();this.currentView=AJ;this[AJ+"View"]=AO;mstrmojo.css.toggleClass(AO,["ddSelected"],this.isAdvanced);this._slideIntoView(AI,AO,AL);},_slideIntoView:function(AM,AQ,AK){var AI=this.bodyContainer,AO=(AK==="left"||AK==="right")?AM.offsetWidth:AM.offsetHeight,AJ=(AK==="left"||AK==="right")?"left":"top",AP=(AK==="left"||AK==="up")?AO:-AO,AN=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AM,onEnd:function(){AI.removeChild(AM);}}),AL=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AQ});AQ.style[AJ]=AP+"px";AI.appendChild(AQ);AN.props[AJ]={start:0,stop:-AP,suffix:"px"};AL.props[AJ]={start:AP,stop:0,suffix:"px"};AN.play();AL.play();},dayViewHTML:function(){var AN=this.browseYear,AQ=this.browseMonth,AV=Z.getDaysOfMonth(AN,AQ),AZ=Z.getPreMonth(AN,AQ),AK=Z.getDaysOfMonth(AZ.y,AZ.m),AJ=Z.getNextMonth(AN,AQ),AR=H(AN,AQ,this.firstDayOfWeek),AO=[],AL=z(this),Ab=0,AI=this.selectedDates,AT=this.min,AX=this.max,Ac,AU,AY,AW,Aa=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"";T(this,{d:AK,m:AZ.m,y:AZ.y},{d:1,m:AJ.m,y:AJ.y});AO.push(O(this.cssTextDay));AO.push(this._dayViewTHead());AO.push("<tr>");for(AY=0;AY<AR;AY++){Ac=AK-AR+AY+1;AU=this.isDateDisabled(Ac,AZ.m,AZ.y,AT,AX)?"disabled":"";AO.push("<td "+Aa+'><div class="mstrmojo-Calendar-day-pre '+AU+'" m="-1">');AO.push(Ac);AO.push("</div></td>");Ab++;}for(AY=0;AY<AV;AY++){Ac=AY+1;AU=this.isDateDisabled(Ac,AQ,AN,AT,AX)?" disabled":"";var AM=q(Ac,AQ,AN),AP=AM?" today":"",AS=W(AI,Ac,AQ,AN)!==-1;AP=(this.hilightToday&&AM)?" hilightToday":AP;AO.push("<td "+(AM?('class="'+AP+'" '):" ")+(AS?AL:"")+'><div class="mstrmojo-Calendar-day-cur'+(AS?(" selected "):"")+AU+'" m="0"'+(AS?AL:"")+">");AO.push(AY+1);AO.push("</div></td>");if((++Ab)%7===0){AO.push("</tr><tr>");}}for(AW=Ab;AW<42;AW++){Ac=Ab-AV-AR+1;AU=this.isDateDisabled(Ac,AJ.m,AJ.y,AT,AX)?"disabled":"";AO.push("<td "+Aa+'><div class="mstrmojo-Calendar-day-next '+AU+'" m="1">');AO.push(Ac);AO.push("</div></td>");if((++Ab)%7===0&&Ab!==42){AO.push("</tr><tr>");}}AO.push("</tr>");AO.push(w);return AO.join("");},_dayViewTHead:function(){var AL=[],AM='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',AK="</tr></thead>",AJ=this.firstDayOfWeek-1,AN=this.dayNames,AI;AL.push(AM);for(AI=AJ;AI<AJ+7;AI++){AL.push("<td>");AL.push(AN(AI%7));AL.push("</td>");}AL.push(AK);return AL.join("");},monthViewHTML:function(){var AJ=[],AL=this.browseMonth-1,AK=this.browseYear,AI;T(this,{d:31,m:12,y:AK-1},{d:1,m:1,y:AK+1});AJ.push(O(this.cssTextMonth));AJ.push("<tr>");for(AI=0;AI<12;AI++){AJ.push("<td "+((AI===AL)?z(this):"")+'><div class="mstrmojo-Calendar-month'+((AI===AL)?" selected":"")+'" m="');AJ.push(String(AI));AJ.push('">');AJ.push(this.monthNames(AI));AJ.push("</div></td>");if(AI%3===2){AJ.push("</tr><tr>");}}AJ.pop();AJ.push("</tr>");AJ.push(w);return AJ.join("");},yearViewHTML:function(){var AN=this.yearRangStart,AJ=[],AL=this.browseYear,AM,AI,AK=this.yearViewSize;T(this,{d:31,m:12,y:AN-1},{d:1,m:1,y:AN+AK*AK});AJ.push(O(this.cssTextYear));AJ.push("<tr>");for(AI=0;AI<AK*AK;AI++){AM=AN+AI;AJ.push("<td "+((AL===AM)?z(this):"")+'><div class="mstrmojo-Calendar-year'+((AL===AM)?" selected":"")+'">');AJ.push(AM);AJ.push("</div></td>");if(AI%AK===(AK-1)){AJ.push("</tr><tr>");}}AJ.pop();AJ.push("</tr>");AJ.push(w);return AJ.join("");},hourViewHTML:function(){var AK=[],AJ=this.timeVal.hour,AI;AK.push(G);AK.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AK.push(AD().AM_NAME);AK.push("</div></td></tr>");for(AI=0;AI<12;AI++){AK.push('<td><div class="mstrmojo-Calendar-hour'+((AI===AJ)?" selected":"")+'" h="0">');AK.push((AI===0)?12:AI);AK.push("</div></td>");if(AI===5){AK.push("</tr><tr>");}}AK.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AK.push(AD().PM_NAME);AK.push("</div></td></tr>");for(AI=0;AI<12;AI++){AK.push('<td><div class="mstrmojo-Calendar-hour'+(((12+AI)===AJ)?" selected":"")+'" h="1">');AK.push((AI===0)?12:AI);AK.push("</div></td>");if(AI===5){AK.push("</tr><tr>");}}AK.push("</tr>");AK.push(w);return AK.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(AK,AL){var AJ=[],AI;AJ.push(G);AJ.push("<tr>");for(AI=0;AI<60;AI++){AJ.push('<td><div class="');AJ.push(AL);AJ.push((AI===AK)?' selected">':'">');AJ.push(AI);AJ.push("</div></td>");if(AI%10===9){AJ.push("</tr><tr>");}}AJ.pop();AJ.push("</tr>");AJ.push(w);return AJ.join("");},isDateDisabled:function(AI,AK,AJ){return !F(AI,AK,AJ,this.min,this.max);},unrender:function D(AI){delete this.lastValue;this._super(AI);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui._HasScroller","mstrmojo.vi.ui.toolbars.Toolbar","mstrmojo.ui.menus.ToolbarConfig","mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus.MenuConfig","mstrmojo.TextArea","mstrmojo.Popup","mstrmojo.Box","mstrmojo.VBox","mstrmojo.CheckBox","mstrmojo.RadioList","mstrmojo.Editor","mstrmojo.HBox","mstrmojo.Label","mstrmojo.SelectBox","mstrmojo.TextArea","mstrmojo.HTMLButton","mstrmojo.Popup","mstrmojo.Pulldown","mstrmojo.tooltip","mstrmojo.Button","mstrmojo.gmaps.MapSearchWidget");mstrmojo.requiresDescs(1158,10371,8218,10372,1442,221,10979,10980,10981,10978,9877,8473,9879,9876,11701,3946,145,9880,11476,9881);var K=0,A=0,D=500,N=180,G={NORMAL_STATE:0,SINGLE_SELECT_STATE:1,RECTANGLE_SELECT_STATE:2,ZOOM_STATE:3,AFFINITY_STATE:4,FREE_SELECT_STATE:5,CIRCLE_SELECT_STATE:6,CLEAR_ALL_STATE:7,GRIDS_SELECT_STATE:8,MARKERTYPE:9,CLUSTER:10,MAP_TYPE:11},R={DRILL:1,SINGLE_SELECT:2,RECTANGLE_SELECT:4,EDIT_INFO_WINDOW:8,CLEAR_ALL:16,AFFINITY:32,FREE_SELECT:64,CIRCLE_SELECT:128,ZOOM:256,GRIDS_SELECT:512,KEEP_ONLY:1024,EXCLUDE:2048,SHOW_DATA:4096,SEARCH_BAR:8192,MAP_TYPE:16384},c={MARKER:"1",BUBBLE:"2",POLYGON:"3",DENSITY:"4"},S=mstrmojo.dom,b=mstrmojo.css,O=mstrmojo.tooltip,e="darkTheme",Y=mstrmojo.Enum_Keys;function I(){var k=S.position(this.domNode),l={content:this.tooltipContent,cssClass:"vi-regular vi-tooltip-A",posType:O.POS_TOPLEFT,top:k.y+k.h+3,left:k.x};this.richTooltip=l;}function Z(){var k=this;return function(l){var n=l||window.event,m=n.keyCode||n.charCode;if(m===Y.ESCAPE&&k.isSelectionState()){k.set("state",G.NORMAL_STATE);}};}function L(){var q=new mstrmojo.ui.menus.MenuConfig(),s=this.mapTypeData,r=this,p="mapStylesMenu",t=function(){return'<div class="{@cls}" idx="{@idx}"><div>{@en@n}</div></div>';},u=function(w){return function(){var x=r.googlemap;if(!x||!x.observableModel){return false;}x.observableModel.set("dv",w);return true;};};if(mstrApp&&mstrApp.getThemeClassName){p+=" "+mstrApp.getThemeClassName();}q.menuCssClass=p;q.isHostedWithin=false;for(var m=0;m<s.length;m++){var l=s[m],o=l.v,n=l.n,k={"World Street Map":mstrmojo.desc(13821,"Street"),"Light Gray Map":mstrmojo.desc(13822,"Light gray"),"Relief Map":mstrmojo.desc(13823,"Relief"),"Topographic Map":mstrmojo.desc(11852,"Topographic"),"Physical Map":mstrmojo.desc(13824,"Physical"),"Terrain Map":mstrmojo.desc(8102,"Terrain"),"Satellite View Map":mstrmojo.desc(8068,"Satellite")};q.addCustomMenuItem(k[n],"CSS"+l.type+(l.id||m),u(o),t);}return q;}mstrmojo.gmaps.MapToolbar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.gmaps.MapToolbar",callback:null,TOOLBAR_BUTTON_COUNT:13,formatPopupRef:null,googlemap:null,toolBarActive:false,layersRendered:0,timer:null,clearAllPopup:null,singleSelectPopup:null,metricSelectBox:null,mapTypeSelectBox:null,toolbar:null,$MSM:null,metricsString:"",metricData:[],mapTypeData:[],mapTypeSelList:null,state:G.NORMAL_STATE,leftToolbar:null,rightToolbar:null,SEARCH_BAR_MAX_WIDTH:200,buttonsToCreateFlag:0,toolBarButtonsEnabledState:0,toolBarButtonsSelectedState:0,markupString:'<div id="{@id}-toolbarwrapper" class="toolbarBoxWrapper" mstrAttach:scroll><div class="map-toolbar-searchbar" mstrAttach:mousedown></div><div id="{@id}" class="mstrMapToolBarBox" ><div class="map-toolbar-left" ></div><div class="map-toolbar-right"></div></div></div>',markupSlots:{leftToolbarNode:function(){return this.domNode.lastChild.firstChild;},searchBarNode:function(){return this.domNode.firstChild;},rightToolbarNode:function(){return this.domNode.lastChild.lastChild;},mapToolBarBox:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:{leftToolbarNode:"30px",searchBarNode:"25px",rightToolbarNode:"30px"},w:{leftToolbarNode:"auto",searchBarNode:"100%",rightToolbarNode:"auto"}},xt:true,setupScrollNodes:function F(){this.scrollNode=this.mapToolBarBox;},updateScrollbars:function d(){if(this._super){this._super();}if(this.scrollNode){this.scrollNode.style.overflowX="hidden";}},initMapToolbar:function C(m,p,l,q,o,s,r,k){this.googlemap=m;this.metricData=p;this.buttonsToCreateFlag=l;this.merticSelectPlaceholder=o;this.clearAllPopupPlaceholder=s;this.singleSelectPopupPlaceholder=r;this.metricsString=mstrmojo.desc(1158,"Metrics");this.googlemap.layerChosen=[];for(var n=0;n<this.metricData.length;n++){this.googlemap.layerChosen.push(n);}this.mapTypeData=k;this.createToolBarButtons();},getPropertyValue:function Q(l,m){var k;if(l&&m){if(!window.getComputedStyle){k=parseInt(l[m],10);}else{k=parseInt(l.getPropertyValue(m),10);}}return isNaN(k)?0:k;},searchBarInitialWidth:33,removeSearchMode:function h(){b.removeClass(this.leftToolbarNode,"toolbar_searchMode");b.removeClass(this.rightToolbarNode,"toolbar_searchMode");b.removeClass(this.searchBarNode,"searchbar_searchMode");b.removeClass(this.domNode,"searchbar_searchMode_center");this.searchBarNode.style.width=this.searchBarInitialWidth+"px";},onmousedown:function g(){if(parseInt(this.searchBarNode.offsetWidth)<this.SEARCH_BAR_MAX_WIDTH){this.searchBarInitialWidth=parseInt(this.searchBarNode.offsetWidth);this.googlemap.setSearchMode(true);this.searchBarNode.style.width=Math.min(this.SEARCH_BAR_MAX_WIDTH,this.width)+"px";b.addClass(this.leftToolbarNode,"toolbar_searchMode");b.addClass(this.rightToolbarNode,"toolbar_searchMode");b.addClass(this.searchBarNode,"searchbar_searchMode");b.addClass(this.domNode,"searchbar_searchMode_center");}},createMultiGridLayersBoxPopupRef:function M(){var o=this;return{alias:"metricSelectBox",scriptClass:"mstrmojo.Popup",cssClass:"metricSelectBox",slot:"popupNode",locksHover:true,autoCloses:true,onOpen:function m(){o.set("state",G.GRIDS_SELECT_STATE);this.set("selected",true);var r=this;var w=b.getComputedStyle(o.domNode);var p=o.getPropertyValue(w,"top")+o.getPropertyValue(w,"height");r.domNode.style.maxHeight=((parseInt(o.googlemap.height)-p)*0.9)+"px";var s,q,u;q=parseInt(r.metricContentWrapper.metricContentBox.domNode.offsetHeight);s=K+q;s=Math.min(s,parseInt(r.domNode.style.maxHeight));r.domNode.style.height=s+"px";u=s-A;r.metricContentWrapper.metricContentBox.domNode.style.maxHeight=(u-K)+"px";r.metricContentWrapper.metricContentBox.domNode.style.height=q+"px";r.metricContentWrapper.domNode.style.height=u+"px";r.domNode.style.width=parseInt(r.metricContentWrapper.metricContentBox.metricSelectVBox.domNode.offsetWidth)+"px";var t=o.rightToolbar.showMetricSelectorList.domNode.getBoundingClientRect();this.domNode.style.left=parseInt(t.left,10)+parseInt(t.width,10)-parseInt(r.domNode.style.width,10)+"px";},onClose:function l(){this.set("selected",false);o.set("state",G.NORMAL_STATE);},children:[{alias:"metricContentWrapper",scriptClass:"mstrmojo.Box",cssClass:"metricContentWrapper",children:[{alias:"metricContentBox",scriptClass:"mstrmojo.Box",cssClass:"metricContentBox",children:[{alias:"metricSelectVBox",scriptClass:"mstrmojo.VBox",cssClass:"metricSelectVBox",cssText:"",closeMe:function k(s){var w=S.eventTarget(self,s);var q=S.contains(o.metricSelList.parent.domNode,w,true,o.metricSelList.parent.domNode);if(!q){S.detachEvent(document,"click",o.$MSM);var r=o.metricSelectBox.height;var p=r,u=0;new mstrmojo.fx.AnimateProp({target:o.metricSelectBox.domNode,props:{height:{ease:mstrmojo.ease.sin,start:p,stop:u,suffix:"px"}},duration:D}).play();o.set("state",G.NORMAL_STATE);}},postCreate:function n(){o.layersRendered=o.metricData.length;var u=[],q;var p=mstrmojo.insert({scriptClass:"mstrmojo.CheckBox",cssClass:"allLayer",label:mstrmojo.desc(10371,"All Layers"),alias:"allLayers",cssDisplay:"block",align:"left",postCreate:function(){this.set("checked",true);},onclick:function(){var x;for(q=0;q<o.metricData.length;q++){x=this.parent.children[q+1].children[0];if(this.checked!=x.checked){x.processMe(this.checked);}}}});if(o.metricData.length>1){u.push(p);}for(q=0;q<o.metricData.length;q++){var w=mstrmojo.insert({scriptClass:"mstrmojo.VBox",alias:"layersbox"+q,halign:"left",cssText:"margin-top:3px;margin-bottom:5px;width:100%;",children:[{scriptClass:"mstrmojo.CheckBox",cssClass:"gridLayerNames",label:o.metricData[q].gridName,tooltip:o.metricData[q].gridName,align:"left",cssDisplay:"block",layerIndex:q,processMe:function t(x){o.layersRendered+=(x?1:-1);if(x){o.googlemap.layerChosen.push(this.layerIndex);o.googlemap.addGridLayer(this.layerIndex);}else{var y=mstrmojo.array.indexOf(o.googlemap.layerChosen,this.layerIndex);if(y!=-1){o.googlemap.layerChosen.splice(y,1);}o.googlemap.removeGridLayer(this.layerIndex);if(o.googlemap.noMarkerSelected()){o.googlemap.markerSelected=false;}if(o.drillButton){o.drillButton.set("enabled",o.googlemap.isDrillable()&&o.state==G.NORMAL_STATE);}}this.set("checked",x);this.parent["metricSelector_"+this.layerIndex].set("enabled",x);},postCreate:function(){this.set("checked",true);},onclick:function(x){this.processMe(this.checked);if(this.parent.parent.allLayers){this.parent.parent.allLayers.set("checked",(o.layersRendered==o.metricData.length));}}},{scriptClass:"mstrmojo.RadioList",alias:"metricSelector_"+q,layerIndex:q,cssClass:"layerMetrics",itemTitleField:"n",items:(function s(){if(o.googlemap.gridDataViewer[q].wpMarkerType==c.DENSITY){return[{n:"Marker density",gIdx:-1}];}else{return o.metricData[q].metrics;}})(),postCreate:function r(x){this.selectedIndex=o.googlemap.gridDataViewer[q].selectedMetricIndex;},postselectionChange:function(x){if(this.parent.children[0].checked){var y=this.items[x.added[0]];if(y.gIdx!=-1){o.googlemap.onselectedMetricIndexChange(y.gIdx,x.added[0],y.id);}}}}]});u.push(w);}this.set("children",u);}}]}]}]};},renderEditInfoWindow:function W(){if(!this.leftToolbar){return ;}var k=this.leftToolbar.customInfoWindow;if(!k){return ;}this.formatPopupRef={scriptClass:"mstrmojo.Editor",contentNodeCssClass:"mstrmojo-balloon",alias:"infoWindowEditor",title:mstrmojo.desc(8218,"Edit custom infoWindow"),left:"100px",top:"100px",width:"200px",locksHover:true,onOpen:function(){var p=this.opener.domNode;var m=mstrmojo.dom.position(p);var o=m.y+50;var n=parseInt(k.domNode.style.left)+100;this.set("top",o+"px");this.set("left",n+"px");this.editorNode.style.width="300px";this.editorNode.style.zIndex=9999;this.gridSelectorHBox.gridSelector.previousSelection=0;},children:[{alias:"gridSelectorHBox",scriptClass:"mstrmojo.HBox",halign:"left",cssText:"margin:3px",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(10372,"Select a Grid: "),align:"left"},{alias:"gridSelector",scriptClass:"mstrmojo.SelectBox",bindings:{items:"this.parent.parent.opener.gridNamesSelectorItems"},size:1,selectedIndex:0,previousSelection:0,cssText:"white-space: nowrap; width: 200px",onchange:function l(){if(!this.selectedItem){return ;}this.parent.parent.opener.getGridViewer(this.previousSelection).setInfoWindowHTML(this.parent.parent.desc.value);var m=parseInt(this.selectedItem.v);this.parent.parent.desc.set("value",this.parent.parent.opener.getGridViewer(m).getInfoWindowHTML());this.previousSelection=m;}}]},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",alias:"desc",bindings:{value:function(){if(!this.parent.opener){return"";}else{var m=this.parent.opener.getPrimaryGridViewer();return m.getInfoWindowHTML();}}},cols:80,rows:7},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){var m=this.parent.parent.desc.value;this.parent.parent.opener.getGridViewer(this.parent.parent.gridSelectorHBox.gridSelector.previousSelection).setInfoWindowHTML(m);this.parent.parent.opener.saveCustomInfo();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.close();}}]},{alias:"editInfoWindowTriangle",scriptClass:"mstrmojo.Label",cssClass:"editInfoWindowTriangle"}]};},onstateChange:function B(){var l=this,m=parseInt(this.state,10),k=this.leftToolbar;if((this.buttonsToCreateFlag&R.SINGLE_SELECT)!==0){k.clickSelect.set("enabled",(m===G.NORMAL_STATE||m===G.SINGLE_SELECT_STATE)&&!l.googlemap.isSelectedDensity(l.googlemap.layerChosen));l.googlemap.set("enableClickSelect",m===G.SINGLE_SELECT_STATE);k.clickSelect.set("selected",m===G.SINGLE_SELECT_STATE);}k.rectangleSelect.set("enabled",m===G.NORMAL_STATE||m===G.RECTANGLE_SELECT_STATE);k.clearAll.set("enabled",(!l.googlemap.noPolygonsPresentOnMap()||l.googlemap.markerSelected)&&(m===G.CLEAR_ALL_STATE||m===G.NORMAL_STATE));if((this.buttonsToCreateFlag&R.GRIDS_SELECT)!==0){this.rightToolbar.showMetricSelectorList.set("enabled",m===G.NORMAL_STATE||m===G.GRIDS_SELECT_STATE);this.rightToolbar.showMetricSelectorList.set("selected",m===G.GRIDS_SELECT_STATE);}k.rectangleSelect.set("selected",m===G.RECTANGLE_SELECT_STATE);k.clearAll.set("selected",m===G.CLEAR_ALL_STATE);if((this.buttonsToCreateFlag&R.FREE_SELECT)!==0){k.freeSelect.set("enabled",m===G.NORMAL_STATE||m===G.FREE_SELECT_STATE);k.freeSelect.set("selected",m===G.FREE_SELECT_STATE);l.googlemap.set("enableFreeFormSelect",m===G.FREE_SELECT_STATE);}if((this.buttonsToCreateFlag&R.CIRCLE_SELECT)!==0){k.circleSelect.set("enabled",m===G.NORMAL_STATE||m===G.CIRCLE_SELECT_STATE);k.circleSelect.set("selected",m===G.CIRCLE_SELECT_STATE);l.googlemap.set("enableCircleSelect",m===G.CIRCLE_SELECT_STATE);}if((this.buttonsToCreateFlag&R.KEEP_ONLY)!==0){k.keepOnly.set("enabled",l.googlemap.markerSelected&&l.googlemap.canDoMultiSelect()&&m===G.NORMAL_STATE);}if((this.buttonsToCreateFlag&R.EXCLUDE)!==0){k.exclude.set("enabled",l.googlemap.markerSelected&&l.googlemap.canDoMultiSelect()&&m===G.NORMAL_STATE);}if((this.buttonsToCreateFlag&R.SHOW_DATA)!==0){k.showData.set("enabled",l.googlemap.markerSelected&&m===G.NORMAL_STATE);}if(l.googlemap.drillable){k.drillButton.set("enabled",l.googlemap.isDrillable()&&m===G.NORMAL_STATE);}if(l.googlemap.affinityEnabled){k.affinityLines.set("selected",m===G.AFFINITY_STATE);k.affinityLines.set("enabled",m===G.NORMAL_STATE||m===G.AFFINITY_STATE);}l.googlemap.set("enableRectangleSelect",m===G.RECTANGLE_SELECT_STATE);l.googlemap.set("enablePopup",m===G.NORMAL_STATE);},getRightToolbarConfig:function X(){var l=new mstrmojo.ui.menus.ToolbarConfig(),k=L.call(this);l.addDisposable(k);l.addMenuToolbarBtn(mstrmojo.desc(4157,"STYLES"),"mapTypeSelectVBox",k);return l;},createMessagePopupRef:function H(n,o,p,k){var m=this;return{alias:"messagePopup",scriptClass:"mstrmojo.Popup",cssClass:"messagePopupWindow",slot:"popupNode",locksHover:false,autoCloses:false,children:[{alias:"popupLabel",scriptClass:"mstrmojo.Label",cssClass:"messageLabel",text:n},{alias:"popupVBox",scriptClass:"mstrmojo.HBox",children:[{alias:"okButton",scriptClass:"mstrmojo.Button",cssClass:(mstrApp&&mstrApp.isVI)?"messageBoxOkButton mstrmojo-WebButton hot":"messageBoxOkButton-nonVI",text:o,bindings:{popup:"this.parent.parent"},onclick:function l(){p.call(this);this.popup.close();}},{alias:"cancelButton",scriptClass:"mstrmojo.Button",cssClass:(mstrApp&&mstrApp.isVI)?"messageBoxCancelButton mstrmojo-WebButton":"messageBoxCancelButton-nonVI",text:mstrmojo.desc(221,"Cancel"),bindings:{popup:"this.parent.parent"},onclick:function l(){if(k!=undefined){k.call(this);}else{m.set("state",G.NORMAL_STATE);}this.popup.close();}}]}]};},getLeftToolbar:function E(){var p=this;var q;q=mstrmojo.insert({alias:"toolBarBox",scriptClass:"mstrmojo.HBox",cssClass:"mstrMapToolBarBox",slot:"leftToolbarNode",buttonCount:p.TOOLBAR_BUTTON_COUNT,defaultButtonCount:p.TOOLBAR_BUTTON_COUNT,barLength:520,postCreate:function o(){for(var r=this.children.length-1;r>=0;r--){if(((this.children[r].toolbarButtonType===R.SHOW_DATA)&&(p.buttonsToCreateFlag&R.SHOW_DATA)==0)||((this.children[r].toolbarButtonType===R.EXCLUDE)&&(p.buttonsToCreateFlag&R.EXCLUDE)==0)||((this.children[r].toolbarButtonType===R.KEEP_ONLY)&&(p.buttonsToCreateFlag&R.KEEP_ONLY)==0)||((this.children[r].toolbarButtonType===R.CIRCLE_SELECT)&&(p.buttonsToCreateFlag&R.CIRCLE_SELECT)==0)||((this.children[r].toolbarButtonType===R.FREE_SELECT)&&(p.buttonsToCreateFlag&R.FREE_SELECT)==0)||((this.children[r].toolbarButtonType===R.EDIT_INFO_WINDOW)&&(p.buttonsToCreateFlag&R.EDIT_INFO_WINDOW)==0)||((this.children[r].toolbarButtonType===R.SINGLE_SELECT)&&(p.buttonsToCreateFlag&R.SINGLE_SELECT)==0)||((this.children[r].toolbarButtonType===R.GRIDS_SELECT)&&(p.buttonsToCreateFlag&R.GRIDS_SELECT)==0)){this.children.splice(r,1);continue;}if((this.children[r].toolbarButtonType===R.AFFINITY)&&((p.buttonsToCreateFlag&R.AFFINITY)==0||!p.googlemap.isMapEnabledAffinityLine())){p.googlemap.affinityEnabled=false;this.children.splice(r,1);continue;}if((this.children[r].toolbarButtonType===R.DRILL)&&((p.buttonsToCreateFlag&R.DRILL)==0||!p.googlemap.isMapDrillEnabled())){p.googlemap.drillable=false;this.children.splice(r,1);}}},children:[{alias:"rectangleSelect",scriptClass:"mstrmojo.Button",iconClass:"mstrtbMapRectangleSearch",tooltipContent:mstrmojo.desc(10979,"Rectangular selection tool"),updateTooltipConfig:I,useRichTooltip:true,enabled:true,toolbarButtonType:R.RECTANGLE_SELECT,onclick:function n(){this.set("selected",!this.selected);if(this.selected){p.googlemap.set("enablePopup",false);p.googlemap.set("infoWindowVisible",false);}p.set("state",this.selected?G.RECTANGLE_SELECT_STATE:G.NORMAL_STATE);p.googlemap.hideInfoWindow();window.clearTimeout(p.timer);}},{alias:"circleSelect",scriptClass:"mstrmojo.Button",iconClass:"mstrtbMapCircleSelectButton",tooltipContent:mstrmojo.desc(10980,"Circular selection tool"),updateTooltipConfig:I,useRichTooltip:true,enabled:true,toolbarButtonType:R.CIRCLE_SELECT,onclick:function n(){this.set("selected",!this.selected);if(this.selected){p.googlemap.set("enablePopup",false);p.googlemap.set("infoWindowVisible",false);}p.set("state",this.selected?G.CIRCLE_SELECT_STATE:G.NORMAL_STATE);p.googlemap.hideInfoWindow();}},{alias:"freeSelect",scriptClass:"mstrmojo.Button",iconClass:"mstrtbMapFreeSelectButton",tooltipContent:mstrmojo.desc(10981,"Freeform selection tool"),updateTooltipConfig:I,useRichTooltip:true,enabled:true,toolbarButtonType:R.FREE_SELECT,onclick:function n(){this.set("selected",!this.selected);if(this.selected){p.googlemap.set("enablePopup",false);p.googlemap.set("infoWindowVisible",false);}p.set("state",this.selected?G.FREE_SELECT_STATE:G.NORMAL_STATE);p.googlemap.hideInfoWindow();}},{alias:"clickSelect",scriptClass:"mstrmojo.Pulldown",cssClass:"mstrtbMapSelection",popupToBody:true,height:"30px",tooltipContent:mstrmojo.desc(13938,"Individual element selection tool"),updateTooltipConfig:I,useRichTooltip:true,enabled:!p.googlemap.isSelectedDensity(p.googlemap.layerChosen),toolbarButtonType:R.SINGLE_SELECT,onselectedChange:function l(){var r=this._lastOpened;if(!this.selected&&r&&r.visible){this.closePopup();}},onmousedown:function k(){p.googlemap.set("infoWindowVisible",false);this.set("selected",!this.selected);p.googlemap.set("enablePopup",false);p.set("state",this.selected?G.SINGLE_SELECT_STATE:G.NORMAL_STATE);p.googlemap.hideInfoWindow();},popupRef:p.createMessagePopupRef(mstrmojo.desc(13939,"Please click on the element(s) you want to select."),mstrmojo.desc(8473,"Done"),function(){p.googlemap.handleSingleSelection(true);p.set("state",G.NORMAL_STATE);p.googlemap.set("enablePopup",true);},function(){p.googlemap.handleSingleSelection(false);p.set("state",G.NORMAL_STATE);p.googlemap.set("enablePopup",true);})},{alias:"clearAll",scriptClass:"mstrmojo.Pulldown",popupToBody:true,cssClass:"mstrtbMapClearAll",height:"30px",tooltipContent:mstrmojo.desc(9879,"Remove selections"),updateTooltipConfig:I,useRichTooltip:true,enabled:false,toolbarButtonType:R.CLEAR_ALL,onmousedown:function k(){p.googlemap.hideInfoWindow();this.set("selected",!this.selected);p.set("state",this.selected?G.CLEAR_ALL_STATE:G.NORMAL_STATE);},popupRef:p.createMessagePopupRef(mstrmojo.desc(9876,"Are you sure you wish to remove all selections?"),mstrmojo.desc(1442,"OK"),function(){p.googlemap.clearMarkerSelections();})},{alias:"keepOnly",scriptClass:"mstrmojo.Button",enabled:false,iconClass:"mstrtbMapKeepOnly",tooltipContent:mstrmojo.desc(11701,"Keep Only"),updateTooltipConfig:I,useRichTooltip:true,toolbarButtonType:R.KEEP_ONLY,onmousedown:function k(){p.googlemap.hideInfoWindow();this.set("selected",true);},onmouseup:function m(){this.set("selected",false);p.googlemap.processKeepOnly();}},{alias:"exclude",scriptClass:"mstrmojo.Button",enabled:false,iconClass:"mstrtbMapExclude",tooltipContent:mstrmojo.desc(3946,"Exclude"),updateTooltipConfig:I,useRichTooltip:true,toolbarButtonType:R.EXCLUDE,onmousedown:function k(){p.googlemap.hideInfoWindow();this.set("selected",true);},onmouseup:function m(){this.set("selected",false);p.googlemap.processExclude();}},{alias:"drillButton",scriptClass:"mstrmojo.Button",iconClass:"mstrtbMapDrill",tooltipContent:mstrmojo.desc(145,"Drill"),updateTooltipConfig:I,useRichTooltip:true,enabled:false,toolbarButtonType:R.DRILL,onmousedown:function k(){p.googlemap.hideInfoWindow();this.set("selected",true);},onmouseup:function m(){this.set("selected",false);p.googlemap.processDrill();}},{alias:"customInfoWindow",scriptClass:"mstrmojo.Button",iconClass:"mstrtbMapCustomizeInfoWindow",tooltipContent:mstrmojo.desc(8218,"Edit custom infoWindow"),updateTooltipConfig:I,useRichTooltip:true,toolbarButtonType:R.EDIT_INFO_WINDOW,onclick:function n(){p.googlemap.hideInfoWindow();p.googlemap.openPopup(p.formatPopupRef);}},{alias:"affinityLines",scriptClass:"mstrmojo.Button",enabled:true,iconClass:"mstrtbMapAffinity",tooltipContent:mstrmojo.desc(9880,"Filter affinity lines/arcs"),updateTooltipConfig:I,useRichTooltip:true,toolbarButtonType:R.AFFINITY,onclick:function n(){p.googlemap.hideInfoWindow();this.set("selected",!this.selected);p.googlemap._affinityGlow=!p.googlemap._affinityGlow;p.googlemap.onAffinityAnimationModeChange();p.set("state",this.selected?G.AFFINITY_STATE:G.NORMAL_STATE);}},{alias:"showData",scriptClass:"mstrmojo.Button",enabled:false,iconClass:"mstrtbMapShowData",tooltipContent:mstrmojo.desc(11476,"Show Data"),updateTooltipConfig:I,useRichTooltip:true,toolbarButtonType:R.SHOW_DATA,onmousedown:function k(){p.googlemap.hideInfoWindow();this.set("selected",true);},onmouseup:function m(){this.set("selected",false);p.googlemap.processShowData();}}]});return q;},searchBar:null,createToolBarButtons:function f(){this.leftToolbar=this.getLeftToolbar();var l=this.rightToolbar=mstrmojo.insert({scriptClass:"mstrmojo.HBox",height:"30px",slot:"rightToolbarNode"});if((this.buttonsToCreateFlag&R.GRIDS_SELECT)!==0){l.addChildren({alias:"showMetricSelectorList",scriptClass:"mstrmojo.Pulldown",popupToBody:true,cssClass:"mstrtbMapGridSelector",height:"30px",tooltipContent:mstrmojo.desc(9881,"Multiple grids"),updateTooltipConfig:I,enabled:true,toolbarButtonType:R.GRIDS_SELECT,mapToolbar:this,onmousedown:function k(){this.mapToolbar.googlemap.hideInfoWindow();this.set("selected",!this.selected);},popupRef:this.createMultiGridLayersBoxPopupRef()});}if((this.buttonsToCreateFlag&R.MAP_TYPE)!==0){var n=new mstrmojo.vi.ui.toolbars.Toolbar();n.set("toolbarCfg",this.getRightToolbarConfig());n.alias="mapTypeToolbar";l.addChildren(n);}var m=[this.leftToolbar];if((this.buttonsToCreateFlag&R.SEARCH_BAR)!==0){this.searchBar=new mstrmojo.gmaps.MapSearchWidget({slot:"searchBarNode"});m.push(this.searchBar);}m.push(this.rightToolbar);this.addChildren(m);if(this.searchBar){this.searchBar.suggestionSource=this.googlemap;}},postBuildRendering:function V(){var k=!!this.googlemap.widgetProps?this.googlemap.widgetProps.th:null;if(!!k){if(k==="1"){b.removeClass(this.domNode,e);}else{b.addClass(this.domNode,e);}}this.renderEditInfoWindow();this._super();var l=this;N=parseInt(l.leftToolbarNode.offsetLeft)+parseInt(l.leftToolbarNode.offsetWidth);l.searchBarNode.style.left=N+"px";this.onscroll=function(m){var n=m.target||m.srcElement;var o=n.scrollLeft;l.searchBarNode.style.left=N-o+"px";};S.attachEvent(this.mapToolBarBox,"scroll",this.onscroll);if(!this.escCallbackFunc){this.escCallbackFunc=Z.call(this);S.attachEvent(document,"keydown",this.escCallbackFunc);}},getToolbar:function P(){return this.toolbar;},setToolbarState:function U(k){this.set("state",k);},isSelectionState:function(){var k=this.state;return k===G.SINGLE_SELECT_STATE||k===G.RECTANGLE_SELECT_STATE||k===G.FREE_SELECT_STATE||k===G.CIRCLE_SELECT_STATE;},setToolbarButtonState:function J(k,m,l){switch(k){case R.DRILL:if(this.leftToolbar.drillButton){this.leftToolbar.drillButton.set(m,l);}break;case R.SINGLE_SELECT:this.leftToolbar.clickSelect.set(m,l);break;case R.RECTANGLE_SELECT:this.leftToolbar.rectangleSelect.set(m,l);break;case R.FREE_SELECT:if((this.buttonsToCreateFlag&this.EnumToolbarButtonType.FREE_SELECT)!=0){this.leftToolbar.freeSelect.set(m,l);}break;case R.CIRCLE_SELECT:if((this.buttonsToCreateFlag&this.EnumToolbarButtonType.CIRCLE_SELECT)!=0){this.leftToolbar.circleSelect.set(m,l);}break;case R.EDIT_INFO_WINDOW:break;case R.CLEAR_ALL:this.leftToolbar.clearAll.set(m,l);break;case R.AFFINITY:if(this.leftToolbar.affinityLines){this.leftToolbar.affinityLines.set(m,l);}break;case R.KEEP_ONLY:if(this.leftToolbar.keepOnly){this.leftToolbar.keepOnly.set(m,l);}break;case R.EXCLUDE:if(this.leftToolbar.exclude){this.leftToolbar.exclude.set(m,l);}break;case R.SHOW_DATA:if(this.leftToolbar.showData){this.leftToolbar.showData.set(m,l);}break;default:}},destroy:function a(k){delete this.googlemap;this._super(k);},unrender:function T(k){S.detachEvent(document,"keydown",this.escCallbackFunc);S.detachEvent(this.mapToolBarBox,"scroll",this.onscroll);this.escCallbackFunc=null;this._super(k);}});mstrmojo.gmaps.MapToolbar.TOOLBAR_STATE=G;})();(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.DocPortlet");var L={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"},P,B;mstrmojo.Vis=mstrmojo.declare(mstrmojo.VisBase,null,{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,reRenderOnDimensionChg:true,isVis:function(){return true;},setModel:function Q(R){this._super(R);if(R.data){this.set("model",R.data);}this.xtabModel=R;if(this.controller&&typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function O(){this._super();var R=this.xtabModel;if(R&&R.destroy){R.destroy();delete this.xtabModel;}},setDimensions:function N(T,S){var R=this._super(T,S);if(R&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return R;},buildRendering:function M(){if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function G(){P=this.width;B=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function E(){var R=this.domNode,S={top:0,left:0};if(typeof (mstr)!="undefined"&&mstr.utils.BoxModel){S.top=mstr.utils.BoxModel.getElementSumOffsetTop(R);S.left=mstr.utils.BoxModel.getElementSumOffsetLeft(R);}else{if(typeof (mstrmojo)!="undefined"){S=mstrmojo.boxmodel.offset(R);}}this.offsetTop=S.top;this.offsetLeft=S.left;},update:function F(V){V=V||this.node;if(V){if(V.data){this.set("model",V.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",V.data);}this.model=V.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(V.data.extProps,this);}var T=this.controller,S=T.view,X=(S.hasRendered&&S.getCurrentLayout&&S.getCurrentLayout());if(T.view.fullScreenInfoWindow&&(X&&X.defn.visName)){var W=mstrApp.rootView.getContentDimensions();this.height=W.h+"px";this.width=W.w+"px";}else{this.fmts=V.defn.fmts||V.defn.units[this.model.k].fmts;var R=this.fmts;if(R){for(var U in L){v=L[U];if(U in R){this[v]=R[U];}}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;return true;},getModel:function A(S){if(S){var R=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,S);if(R){return R.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));return{};}}else{return this.model;}},getDataParser:function K(R){return new mstrmojo.Vis.DataParser(this.getModel(R));},renderErrorMessage:function H(R){this.domNode.innerHTML='<div class="mstrmojo-message">'+R+"</div>";},getMessageID:function J(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function D(U){var b=this.xtabModel,a=(b&&b.docModel);var c=false;if(a){var Z=a.defn&&a.defn.layouts,T=null;var S;if(Z){for(S in Z){if(Z[S].loaded){T=Z[S];break;}}}var V=T&&T.units;this.selectorTargets={};if(V&&U.scObjList){for(var S=0;S<U.scObjList.length;S++){var W=U.scObjList[S];var X=W.sc.tks.split("\x1E");for(var R=0;R<X.length;R++){var Y=V[X[R]];if(Y){this.selectorTargets[X[R]]=Y;if(!this.isChildOfIfw(V,Y)){c=true;}}}}}}return c;},isChildOfIfw:function I(R,S){while(S){if(S.ifw){return true;}S=R[S.pnk];}return false;},performAction:function C(R){var T=this.xtabModel.getAction(R),S=T&&T.h;if(S&&this.controller[S]){this.controller[S](this,T.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(R,Y,S){var W=Y;var U=R.getChildren(Y,false);for(var T=0;T<U.length;T++){var X=U[T];if(X.k==S){return X;}else{var V=mstrmojo.Vis.getVisGrid(R,X,S);if(V){Y=W;return V;}}}};mstrmojo.Vis.DataParser=function(T){var a=mstrmojo.Vis;return{getRowTitles:function(){return new a.Titles(T,true);},getColTitles:function(){return new a.Titles(T,false);},findMetricValue:function(f,l){var k=T.ghs.rhs.items;for(var g in k){var h=k[g].items;var d=true;for(var b in f){if(f[b]!=h[b].idx){d=false;break;}}if(d){return new mstrmojo.Vis.MetricValue(T.gvs.items[g].items[l]);}}},getTotalRows:function W(){var b=T.ghs&&T.ghs.rhs&&T.ghs.rhs.items;return(T.eg||!b)?0:b.length;},getTotalColHeaderRows:function U(){return(!T.ghs.chs.items?0:T.ghs.chs.items.length);},getTotalCols:function R(){return this.getColHeaders(0).size();},getRowHeaders:function Z(b){return new a.Headers(T,b,true);},getColHeaders:function Y(b){return new a.Headers(T,b,false);},getMetricValue:function X(c,b){return new a.MetricValue(T,T.gvs.items[c].items[b]);},getColumnHeaderCount:function V(){return T.gvs.items[0].items.length;},getCSSString:function S(){return T.cssString;}};};mstrmojo.Vis.Titles=function(R,W){var V=(W)?R.gts.row:R.gts.col;return{size:function U(){return V.length;},getTitle:function T(X){return new mstrmojo.Vis.Title(V[X]);},getCSS:function S(X){return R.css[V[X].cni].n;}};};mstrmojo.Vis.Headers=function(S,T,X){var Y=(X)?S.gts.row:S.gts.col;var W=(X)?S.ghs.rhs:S.ghs.chs;var U=W.items&&W.items[T].items;return{size:function Z(){return(!U?0:U.length);},getHeader:function R(a){return U&&U[a]&&new mstrmojo.Vis.Header(U[a],X?Y[a]:Y[T]);},getCSS:function V(a){return U&&S.css[U[a].cni].n;},getHeaderCell:function(a){return U&&U[a];}};};mstrmojo.Vis.Title=function(S){return{getActionType:function(){return S.at;},getDrillPath:function(){return S.dp;},getHeaderValues:function R(){return S.es;},getHeaderName:function T(V){return S.es[V].n;},getHeaderId:function T(V){return S.es[V].id;},getForms:function U(){return S.fs;},getFormId:function(){return S.fid;},getFormType:function(){return S.ftp;},getUnitId:function(){return S.id;},getLinkMap:function(){return S.lm;},getName:function(){return S.n;},getUnitDssType:function(){return S.otp;},getSelectorControl:function(){return S.sc;}};};mstrmojo.Vis.Header=function(T,R){return{getName:function V(){return(T.idx===-1)?"":R.es[T.idx].n;},getElementId:function Y(){return(T.idx===-1)?"":R.es[T.idx].id;},getObjectId:function U(){return(T.idx===-1)?"":R.es[T.idx].oid;},getElementIndex:function S(){return T.idx;},getActionType:function X(){return T.at;},isTotal:function W(){return T.otr===1;}};};mstrmojo.Vis.MetricValue=function(R,Y){var X=Y;return{getValue:function S(){return X.v;},getThresholdType:function T(){return X.ty;},getRawValue:function W(){return X.rv;},getCSS:function U(){return R.css[X.cni].n;},getThresholdValue:function Z(a){if(X.ti==undefined){return a;}return R.th[X.ti].n;},getFillColor:function V(a){if(X.ci==undefined){return a;}return R.fc[X.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.tabs.Tab","mstrmojo.dom","mstrmojo.css");var G=mstrmojo.dom,R=mstrmojo.array,d=mstrmojo.css,c="animate",W="31px";function X(){var k=window.Modernizr,h="transition";if(k.testProp(h)){return G.transEndEvtNames[k.prefixed(h)];}return null;}function D(h){return function(){this.menuNode.style.display=h?"block":"none";};}function I(h){return Math.min(h.offsetWidth-h.firstChild.offsetWidth,0);}function S(h){return h.isAlignRight?"right":"left";}function e(h,k){return parseInt(h.style[S(k)],10)||0;}function O(){var k=this.tabContainerNode,l=false,h=false;if(I(k)<0){var n=G.position(k),m=G.position(k.firstChild);l=(m.x<n.x);h=(m.x+m.w>n.x+n.w+0.1);}this.downBtnNode.style.display=l?"block":"none";this.upBtnNode.style.display=h?"block":"none";}function T(h,k){h=(h||[]);if(!h.filter){return R.filter(h,k);}return h.filter(k);}function Q(h,k){h=(h||[]);if(!h.map){return R.map(h,k);}return h.map(k);}function J(z,l){if(this.isStatic){return ;}var x=this.tabContainerNode,w=T(this.children,function(AA){return AA.isSelected;})[0],s=w&&w.domNode;if(!x||!s){return ;}var m=G.position(x),q=x.firstChild,y=I(x),n=e(q,this),k=Math.max(n,y);if(z){if(y<0){var p=G.position(s),r=p.x-m.x,u=p.x+p.w-(m.x+m.w),t=this.isAlignRight,h=function(AA){k=t?k+AA:k-AA;};if(r<0){h(r);}else{if(u>0){h(u);}}}}if(k!==n){var o=X();if(l&&o){d.addClass(q,c);G.attachOneTimeEvent(q,o,function(){d.removeClass(q,c);});}q.style[S(this)]=Math.max(y,Math.min(k,0))+"px";}O.call(this);}function K(h){return h.hasOwnProperty("index");}function H(){var h=this.children,k=0;(h||[]).every(function(m,l){if(!K(m)){return false;}k++;m.index=l;return true;});(h||[]).every(function(l){if(!K(l)){return false;}l.total=k;return true;});}function B(n,k){var r=n.ENUM_CORNERS,o=[r.TOP_RIGHT,r.BOTTOM_RIGHT],p=this.parent;if(p.position!=="bottom"){o.reverse();}n.setAlignment(o[0],o[1]);var m=G.position(p.domNode),h=G.position(k),l=p.menuNode;var q=l.style;q.top=(h.y-m.y)+"px";q.left=(h.x-m.x)+"px";n.addPopupHandlers(p.id,D(true),D(false));n.hostId=p.id;n.hostElement=l;n.isHostedWithin=false;p.openPopup(n.newInstance());}function Y(h){h.raiseEvent({name:"TabsChange"});}mstrmojo.vi.ui.tabs.TabStrip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-VITabStrip {@cssClass}" style="{@cssText}" ><div class="mstrmojo-VITabStrip-tabs"><div style="display:table"><div style="display:table-row"></div></div></div><div class="mstrmojo-VITabStrip-addBtn" mstrAttach:click><div></div></div><div class="mstrmojo-VITabStrip-downBtn" mstrAttach:click,mousedown><div></div></div><div class="mstrmojo-VITabStrip-upBtn" mstrAttach:click,mousedown><div></div></div><div class="mstrmojo-VITabStrip-menuHost"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{tabContainerNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild.firstChild.firstChild;},addBtnNode:function(){return this.domNode.childNodes[1];},addBtnImgNode:function(){return this.domNode.childNodes[1].firstChild;},downBtnNode:function(){return this.domNode.childNodes[2];},upBtnNode:function(){return this.domNode.childNodes[3];},menuNode:function(){return this.domNode.childNodes[4];},maskNode:function(){return this.domNode.lastChild;}},isStatic:false,isAlignRight:true,tabContainerNode:null,downBtnNode:null,upBtnNode:null,menuNode:null,position:"bottom",layoutConfig:{w:{tabContainerNode:"100%",addBtnNode:W},xt:true},onAppStateChange:function V(k){var h=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;if(k.value===h||k.valueWas===h){this.layoutConfig.w.addBtnNode=mstrApp.appState===h?"0px":W;this.doLayout();}},setStatic:function U(h,k){this.isStatic=h;if(!h){J.call(this,true,k);}},setTabs:function C(l,h){this.removeChildren();var m=this,k=l.length;this.addChildren(Q(l,function(p,n){var o=p.k;return m.getTabCfg(l,p,{scriptClass:"mstrmojo.vi.ui.tabs.Tab",index:n,total:k,draggable:!!k,dropZone:!!k,k:o,isSelected:o===h,showTabMenu:B,tabMoved:function(r){var q=this.index;this.parent.moveTab(q,q+(r?-1:1),q);}});}));J.call(this,true);Y(this);},getTabs:function N(){return T(this.children,K);},getTabCfg:function F(k,l,h){return h;},deleteTab:function P(h){var p=this.id,o=this.children[h],n=X(),m=function(){var q=mstrmojo.all[p];q.removeChildren(o);o.destroy();H.call(q);O.call(q);Y(q);};if(n){var l=o.domNode.firstChild,k=l.style;k.width=l.offsetWidth+"px";window.setTimeout(function(){d.addClass(l,c);G.attachOneTimeEvent(l,n,m);k.width=0;},0);}else{m();}},buildRendering:function E(){this._super();d.toggleClass(this.domNode,"alignLeft",!this.isAlignRight);},postBuildRendering:function Z(){var h=this._super();J.call(this,true);return h;},doLayout:function A(){this._super();J.call(this);},setSelectedTab:function b(h){(this.children||[]).forEach(function(k){k.set("isSelected",k.k===h);});Y(this);},getSelectedTab:function M(){var l=null,k=this.children||[],h;for(h=0;h<k.length;h++){if(k[h].isSelected){l=k[h];break;}}return l;},onclick:function g(h){if(h.getTarget()===this.addBtnImgNode){this.addTab();}},addTab:mstrmojo.emptyFn,onmousedown:function f(u){var q=u.getTarget().parentNode,w=(q===this.downBtnNode);if(w||q===this.upBtnNode){var t=this.tabContainerNode,p=t.firstChild,k=I(t),m=e(p,this),o=this.isAlignRight?(w?-10:10):(w?10:-10),l=this.id,r=this,n;if(mstrApp.setInteractive){mstrApp.setInteractive(false);}d.addClass(q,"active");var s=function(){window.clearInterval(n);d.removeClass(q,"active");O.call(mstrmojo.all[l]);if(mstrApp.setInteractive){mstrApp.setInteractive(true);}};G.attachOneTimeEvent(document.body,"mouseup",s);n=window.setInterval(function(){m=Math.min(Math.max(k,m+o),0);p.style[S(r)]=m+"px";if(m===k||m===0){s();}},33);}},moveTab:function L(h,r,p,o){var k=this.children,s=k.splice(h,1)[0];k.splice(r,0,s);H.call(this);var l=this.containerNode,m=l.childNodes,q=l.removeChild(m[h]),n=m[r];if(n){l.insertBefore(q,n);}else{l.appendChild(q);}if(s.isSelected){J.call(this,true,true);}if(!o&&p!==undefined&&p!==r){this.commitTabMove(p,r);Y(this);}},commitTabMove:function a(h,k){throw new Error(this.scriptClass+" must implement commitTabMove.");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.array","mstrmojo.Button","mstrmojo.css","mstrmojo.hash","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.func");mstrmojo.requiresDescs(221,1442,2751,2891,11949,11950,11951,11942,13397,13398,14640,14648);var R=mstrmojo.array,U=mstrmojo.css,N=mstrmojo.hash,O=mstrmojo.func,M=mstrmojo.Button.newWebButton,P=mstrmojo.dom,T="mstrmojo-link-validation",Q="mstrmojo-link-vt",F=function F(V){if(V.old){this.removedLinks.push(V);}this.links.removeChildren(V);},S=function S(){var s=this.dsMap,p=this.docModel,Y=p.datasets,u=function u(k,x,a){var w={n:a||"",did:x||null,parent:k||null,lv:(k?k.lv+1:-1),children:[]};if(k){k.children.push(w);}return w;},e=u(),X,W,V,g,Z,q,l,t,r,o,n,m,c,b,d,h,f;N.forEach(Y,function(a){if(p.isMDXDataset(a)){Z=a.tables;for(o=0,b=Z.length;o<b;o++){q=Z[o];X=u(e,q.did,q.n);X.isMDX=true;for(n=0,d=q.dimensions.length;n<d;n++){l=q.dimensions[n];W=u(X,l.did,l.n);for(m=0,h=l.hierarchies.length;m<h;m++){t=l.hierarchies[m];V=u(W,t.did,t.n);for(c=0,f=t.att.length;c<f;c++){r=t.att[c];g=u(V,r.did,r.n);g.att=r;s[q.did+":"+r.did]=g;}}}}}else{X=u(e,a.did,a.name);X.isMDX=false;R.forEach(a.att,function(k){g=u(X,k.did,k.n);g.att=k;s[a.did+":"+k.did]=g;});}});return e;},B=function B(b,c){b=R.ensureArray(b);var a=this,Z=this.attribute.did,d=this.docModel,X=d.findDatasetIdFromUnit(Z),W="\u001F",V={success:function(f){var h=f.als,e=(d.als&&d.als.links)||{},g=a.dsTree;R.forEach(b,function(r,m){var s={},k={},l=[],n={},q=Z+" "+r,o=R.filter(h[m].ats,function(t){return !d.isInDataset(X,t.at,["att"]);}),p=function p(t,u){if(!n[t]){n[t]={};}if(!n[t][u]){n[t][u]=true;}};R.forEach(o,function(w){var t=w.at,u=w.fms;s[t]=true;if(u){R.forEach(u,function(x){p(t,x.fm);});}});N.keyarray(e).forEach(function(t){if(t===q){R.forEach(e[t],function(u){u=u.split(" ");s[u[0]]=true;p(u[0],u[1]);});}});if(N.keyarray(s).length>0){R.forEach(g.children,function(u){var t=function(w){var x;if(!w.att){return ;}w=w.att;if(s[w.did]){if(!k[w.n]){k[w.n]={};}if(!k[w.n][w.did]){k[w.n][w.did]=[];}k[w.n][w.did].push(u.n);x=N.copy(w,x);x.dsId=u.did;l.push(x);}};if(u.isMDX){R.forEach(u.children,function(w){R.forEach(w.children,function(x){R.forEach(x.children,t);});});}else{R.forEach(u.children,t);}});}a.tgtAttrs[r]=l;a.tgtForms[r]=n;a.namesHash[r]=k;});}},Y={taskId:"validateDocumentLinks",msgID:d.mid,action:1,attributeList:Z,attributeFormList:b.join(W)};mstrApp.serverRequest(Y,O.wrapMethods(V,c));},E=function(Y,a,W,Z){Y.richTooltip=null;if(!Y.isSearching){var X=a&&a.scrollWidth>a.clientWidth;W=X?mstrmojo.desc(14648,"## from ###").replace("##",W):"";if(Z){if(!X){W=mstrmojo.desc(14640,"From ###");}W=W.replace("###",Z);}var V=mstrmojo.dom.position(a);Y.richTooltip={cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:W,top:V.y-6,left:V.x};}},D=function D(c){var d=this,f=function(o){var m=o.fs,p=o.de,n=[];(m||[]).forEach(function(q){if(q.obf&&(!p||q.idf)){n.push({n:q.fnm,v:q.fid,idf:q.idf});}});return n;},g=f(this.attribute),Z=function(p,n){var m=f(p);var q=(d.tgtForms[n]&&d.tgtForms[n][p.did])||{};var o=[];R.forEach(m,function(r){if(q[r.v]){o.push(r);}});return o;},b=function b(n){var m=[];R.forEach(d.tgtAttrs[n],function(o){if(Z(o,n||d.idFormId).length>0){var q=d.namesHash[n],p=o.n;if(q[o.n]&&N.keyarray(q[o.n]).length>1){p=p+" ("+q[o.n][o.did].join(",")+")";}m.push({n:o.n,v:o,tt:p});}});if(m.length===0){m.push({n:mstrmojo.desc(13398,"No valid object"),v:{did:null},cls:"nvo",t:1});}return m;},h=b((c&&c.srcFormId)||this.idFormId),k=function(m,n){return R.find(m.fs,n?"fid":"idf",n||true);},l=function(n){var m=-1;h.forEach(function(p,o){if(p.v.did===n){m=o;}});return m;},W=function(n){var m=h[n];if(!m){return mstrmojo.desc(13397,"Select an attribute");}else{return m.n;}},X=function(n){var o=n.items,m=n.selectedIndex;if(m>=0){if(o[m].idf){return ;}}o.forEach(function(q,p){if(q.idf){n.set("selectedIndex",p);}});};this.links.addChildren({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linkRow",slot:"containerNode",old:!!c,oldMeta:c,getMeta:function(){var m=this.linkFromForm,o=this.linkToAtt,n=this.linkToForm;return{srcAttrId:d.attribute.did,srcFormId:m.items[m.selectedIndex].v,tgtAttrId:o.items[o.selectedIndex]&&o.items[o.selectedIndex].v.did,tgtFormId:n.items[n.selectedIndex]&&n.items[n.selectedIndex].v};},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-attName",text:d.attribute.n,useRichTooltip:true,updateTooltipConfig:function(q){var p=q.target,m=this.text,n=d.datasetId,o=n?d.docModel.datasets[n].name:"";E(this,p,m,o);}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormFromPD",alias:"linkFromForm",value:"ID",isHostedWithin:true,items:g,selectedIndex:k(d.attribute,c&&c.srcFormId),onitemSelected:function(n){var m=this,o=function(){var q=m.parent.linkToAtt;h=b(n.v);q.set("items",h);q.set("selectedIndex",-1);q.set("text",mstrmojo.desc(13397,"Select an attribute"));U.addClass(q.selectedNode,"nvo");},p={success:o};if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!n.idf){X(this.parent.linkToForm);if(!d.tgtForms[n.v]){B.call(d,n.v,p);return ;}}o();}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-linksToLabel",text:mstrmojo.desc(11949,"links to")},{scriptClass:"mstrmojo.ui.SearchablePulldown",cssClass:"mstrmojo-linkToAtt",alias:"linkToAtt",useRichTooltip:true,isHostedWithin:false,items:h,text:W(l(c&&c.tgtAttrId)),selectedIndex:l(c&&c.tgtAttrId),allowCustomText:true,allowEmptyText:true,updateTooltipConfig:function(r){var q=r.target,m=q.getAttribute("tt"),o=this.getSelectedItem(),n=o?o.v.dsId:null,p=n?d.docModel.datasets[n].name:"";if(this.selectedNode===q&&o){m=o.tt;}E(this,q,m,p);},onitemSelected:function(q){if(!q||q.v.did===null){return ;}var p=this.parent.linkToForm,o=this.parent.linkFromForm,n=Z(q.v,o.items[o.selectedIndex].v),r=function r(s,u){var t=R.find(s,u?"v":"idf",u||true);if(t===-1&&s.length>0){t=0;}return t;},m;R.forEach(n,function(s){if(s.idf){m=false;return false;}});if(m){K.call(d,true);}p.set("items",n);p.set("selectedIndex",r(n,!this.hasRendered&&c&&c.tgtFormId));if(this.hasRendered&&this.parent.old){this.parent.oldUpdated=true;}J.call(d);},onPopupWidgetOpened:function a(){if(this.selectedIndex===-1){this.set("text","");}U.removeClass(this.selectedNode,"nvo");},onPopupWidgetClosed:function e(){mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this);if(this.selectedIndex===-1&&this.text===""){this.set("text",mstrmojo.desc(13397,"Select an attribute"));U.addClass(this.selectedNode,"nvo");}else{U.removeClass(this.selectedNode,"nvo");}this.hideTooltip();R.forEach(d.collapseTargets,function(m){m.className="arrow-b";U.removeClass(m.parentNode.parentNode,"collapse");});R.forEach(d.collapseTreeNodes,function(m){delete m.collapse;});R.forEach(this.list.itemsContainerNode.childNodes,function(m){m.style.display="";});},postBuildRendering:function V(){mstrmojo.ui.SearchablePulldown.prototype.postBuildRendering.call(this);if(this.selectedIndex===-1){U.addClass(this.selectedNode,"nvo");}this.list.popupConfig.clear();},getPopupListConfig:function Y(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",width:"170px",tooltipOrientation:"vertical",selectionPolicy:"reselect",useRichTooltip:true,locksHover:true,listHooks:{select:function m(s,t,r){this.parent.set("selectedIndex",r);this.close();}},onclick:function n(AA){try{var s=AA.getTarget(),AB=this.getItemFromTarget(s),x=P.findAncestorByAttr(s,"idx",true,this.domNode);if(AB){AA.cancel();if(s.className==="arrow-b"||s.className==="arrow-r"){var w=this.items,r=this.itemsContainerNode.childNodes,u=function u(AD){var AC;while(AD){AC=AD.className||"";if(AC.indexOf("lv")===0){return window.parseInt(AC.substring(2),10);}AD=AD.firstChild;}return null;},z=function z(AC,AF){var AE=d.dsMap,AD=AE[AC.dsId+":"+AC.did];while(AD){if(AD.lv===AF){return AD;}AD=AD.parent;}return null;},y=function y(){var AL=(s.className==="arrow-b"),AF=s.parentNode.parentNode,AC=u(AF),AG=AB._renderIdx,AD=z(AB.v,AC),AJ=w.length,AI,AE,AH,AK,AN,AM;s.className=AL?"arrow-r":"arrow-b";if(!d.collapseTargets){d.collapseTargets=[];}d.collapseTargets.push(s);U.toggleClass(AF,"collapse",AL);AD.collapse=AL;if(!d.collapseTreeNodes){d.collapseTreeNodes=[];}d.collapseTreeNodes.push(AD);for(AI=AG+1;AI<AJ;AI++){AE=r[AI];AH=u(AE);if(AH<=AC){break;}AK=z(w[AI].v,AH);AN=AK.parent;AM=true;while(AN){if(AN.collapse){AM=false;break;}AN=AN.parent;}AE.style.display=(AM?"":"none");}};y();}else{if(x&&x.node.className.indexOf("item")!==-1){this.doItemSelect(AB,AA||{});}}}}catch(t){mstrApp.onerror(t);}},getItemProps:function o(t,r){var s=mstrmojo._IsList.getItemProps.call(this,t,r);var u=t.cls;if(u){s.addCls(u);}return s;},getItemMarkup:function q(AC,AB){if(AC.v.did===null){return'<{@tag} class="item {@cls}" did="'+AC.v.did+'" idx="{@idx}" style="{@style}">{@n}</{@tag}>';}var AD=[],z=AC.v.did,t=AC.v.dsId,u=t?d.docModel.datasets[t]:null,s=u?u.name:"",AA=AB>0&&this.items[AB-1].v,x=d.dsMap,w=x[AC.v.dsId+":"+z],r=x[(AA&&(AA.dsId+":"+AA.did))];AD.push("</div>");while(w){if(w.lv===-1){break;}if(w.att){var y=w.att.da?"derived-attr":"attr";AD.push('<div class="lv'+w.lv+' dim item {@cls}" tt="'+AC.tt+'" did="'+z+'" dsName="'+s+'" idx="{@idx}" style="{@style}"><div><div class="'+y+'"></div></div>{@n}</div>');}else{if(w!==r){AD.push('<div class="lv'+w.lv+' dim" dtt="'+w.n+'" idx="{@idx}"><div><div class="arrow-b"></div></div>'+w.n+"</div>");}else{break;}}w=w.parent;r=(r&&r.parent)||null;}AD.push("<div>");return AD.reverse().join("");},updateTooltipConfig:function p(x){var w=x.target,t=w.getAttribute("tt"),s=w.getAttribute("dtt"),u=w.getAttribute("dsName"),r=t||s;if(r){E(this,w,r,u);}}};}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormToPD",alias:"linkToForm",value:"ID",isHostedWithin:true,items:[],onitemSelected:function(m){if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!m.idf){X(this.parent.linkFromForm);}}}},M("",function(){F.call(d,this.parent);},false,{cssClass:"mstrmojo-removeLink"})]});this.links.renderChildren();},K=function(V){U.toggleClass(this.editorNode,"mstrmojo-advanced",V);},L=function(Y){var W=this,Z=T,V;try{mstrmojo.all[Z].destroy();}catch(X){}V={scriptClass:"mstrmojo.Editor",id:Z,title:mstrmojo.desc(2751,"Message"),cssClass:"mstrmojo-alert",buttons:[M(mstrmojo.desc(1442,"Ok"),function(){mstrmojo.all[Z].destroy();H.call(W);},true)],children:[{scriptClass:"mstrmojo.Label",text:Y}],visible:true,zIndex:1000};mstrmojo.insert(V).render();},H=function(){var X=this,W=this.illLinks,V=this.links.children,Y=Q;R.forEach(W,function(Z){Z=Z.al;R.forEach(V||[],function(b){var d=b.getMeta(),e=b.linkToAtt,a,c;if(d.srcAttrId===Z.alaid1&&d.tgtAttrId===Z.alaid2){if(!mstrmojo.all[Y]){c=new mstrmojo.Tooltip({id:Y,cssClass:X.themeClassName+" vi-warning vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,updatePopupConfig:null});P.attachEvent(X.editorNode,"click",function(){c.close();U.toggleClass(e.selectedNode,"mstrmojo-Warning",false);});}else{c=mstrmojo.all[Y];}c.close();a=mstrmojo.dom.position(e.selectedNode);c.set("top",a.y-6);c.set("left",a.x);c.set("content",Z.alstmsg);U.toggleClass(e.selectedNode,"mstrmojo-Warning",true);c.open();return false;}});});},A=function(){var V=mstrmojo.all[Q];if(V){V.close();}},J=function J(){this.buttons[0].enabled=true;if(this.btnHbox){this.btnHbox.children[0].set("enabled",true);}},G=function G(){var V=this,W=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-addLink",text:mstrmojo.desc(11950,"Add A Link"),title:mstrmojo.desc(11950,"Add A Link"),onclick:function(){D.call(V);A.call(V);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-showForms",text:mstrmojo.desc(2891,"Show Attribute Forms"),title:mstrmojo.desc(2891,"Show Attribute Forms"),onclick:function(){K.call(V,true);A.call(V);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-hideForms",text:mstrmojo.desc(11951,"Hide Attribute Forms"),title:mstrmojo.desc(11951,"Hide Attribute Forms"),onclick:function(){K.call(V,false);A.call(V);}}],slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linksBox mstrmojo-advanced",alias:"links",slot:"containerNode"}];this.addChildren(W);};mstrmojo.vi.ui.editors.AttributeLinkEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",title:mstrmojo.desc(11942,"Link Attributes"),cssClass:"mstrmojo-att-link",btnAlignment:"right",buttons:null,modal:true,visible:false,help:"link_attributes_editor.htm",attribute:null,tgtAttrs:null,tgtForms:null,docModel:null,datasetId:null,namesHash:null,removedLinks:null,preBuildRendering:function C(){var Y=this,W=this.docModel,X=function(){var Z=(W.als&&W.als.links)||{},a=[];N.keyarray(Z).forEach(function(b){if(b.indexOf(Y.attribute.did+" ")===0){Z[b].forEach(function(c){a.push({srcAttrId:b.split(" ")[0],srcFormId:b.split(" ")[1],tgtAttrId:c.split(" ")[0],tgtFormId:c.split(" ")[1]});});}});return a;},V;this.set("buttons",[M(mstrmojo.desc(1442,"OK"),function(){var g=[],a=Y.links.children,Z=function(){var h=W.controller,k=W.controller.getRefreshCallback();if(g.length>0){h.cmdMgr.execute({execute:function(){this.submit(g,k);},urInfo:{callback:k}});}Y.close();},f=false,c,d;Y.removedLinks.forEach(function(h){c=N.copy(h.oldMeta,{act:"applyAttributeLinking",unlink:true});g.push(c);});(a||[]).forEach(function(h){if(h.old&&h.oldUpdated){c=N.copy(h.oldMeta,{act:"applyAttributeLinking",unlink:true});g.push(c);}if(!h.old||(h.old&&h.oldUpdated)){d=h.getMeta();if(!d.tgtAttrId){return ;}c=N.copy(d,{act:"applyAttributeLinking",unlink:false});g.push(c);}});R.forEach(g,function(h){if(!h.unlink){f=true;return false;}});if(!f){Z();return ;}var e={taskId:"validateDocumentLinks",msgID:W.mid,action:2,manipulationList:'{"ml":'+JSON.stringify(g)+"}"},b={success:function(h){if(h.als&&h.als.length>0){var k="";R.forEach(h.als,function(l){k+=l.al.alstmsg+"\n";});Y.illLinks=h.als;L.call(Y,k);return ;}Z();}};mstrApp.serverRequest(e,b);},true,{enabled:false}),M(mstrmojo.desc(221,"Cancel"),function(){Y.close();})]);G.call(this);V=X(this.attribute.did);if(V.length>0){V.forEach(function(Z){D.call(Y,Z);});J.call(this);}else{D.call(this);}this._super();},close:function I(){A.call(this);this.destroy();}});mstrmojo.vi.ui.editors.AttributeLinkEditor.open=function(b){var W=mstrmojo.insert(N.copy(b,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",tgtAttrs:{},tgtForms:{},namesHash:{},removedLinks:[]})),Z=W.attribute,c=Z.did,V=W.docModel,Y=(V.als&&V.als.links)||{},X=[],a={success:function(){W.set("visible",true);W.render();}};R.forEach(Z.fs,function(d){if(d.idf){W.idFormId=d.fid;return false;}});N.keyarray(Y).forEach(function(e){var d=e.split(" ");if(d[0]===c){X.push(d[1]);}});if(R.indexOf(X,W.idFormId)===-1){X.push(W.idFormId);}W.dsMap={};W.dsTree=S.call(W);B.call(W,X,a);};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.hash","mstrmojo.css");var A=mstrmojo.hash.copy;mstrmojo.ui.editors.controls.AdvancedColorPickerPopup=mstrmojo.declare(mstrmojo.ui.editors.controls.AdvancedColorPicker,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",locksHover:true,init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-AdvColorPickerPopup");},showPickerForCurrentMode:function D(){this._super();var G=this,F=function F(){if(G.visible){G.adjustCornersForPopupOverflow();}};if(this.pickerMode===2){this.colorStyle.markupMethods=A({onselectedIndexChange:F},A(this.colorStyle.markupMethods));}F();},onOpen:function C(){var F=this.parent;this.set("color",F?F.selectedValue:this.color);this.renderContent();this._super();},colorCanceled:function B(){this.close();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.num","mstrmojo.date","mstrmojo.Container","mstrmojo.VBox","mstrmojo.Button","mstrmojo.locales","mstrmojo._FormatDefinition","mstrmojo.mstr.EnumFunction","mstrmojo.ui.editors.controls.ComboBox");var K=mstrmojo.hash,Z=mstrmojo.array,F=mstrmojo.num,H=mstrmojo._FormatDefinition,A=mstrmojo.css,X=mstrmojo.mstr.EnumFunction,J=mstrmojo.locales,G=mstrmojo.Button.newIconButton,M=mstrmojo.date,D=H.NumberFormatCategory,n=H.FixedNegative,E=H.CurrencyNegative,c=H.PercentNegative,I=H.DefaultFormat.FormattingNumber,W,R,b=function b(q,p){return{cls:this.value===q.v?"selected":"",v:q.v||"",n:q.n||"",style:q.r?"color:red;":"color:#fff;",sel:parseInt(this.idx,10)===p?"selected":""};},m={RIGHT:1,LEFT_WITH_SPACE:2,RIGHT_WITH_SPACE:3};var Q=[{n:mstrmojo.desc(4531,"Automatic"),v:-3}].concat(H.Category.slice(2)),a=[{n:"$"},{n:""},{n:""},{n:""},{n:"fr."}];function C(r,q){var p=Z.find(r,"v",q);return p===-1?"":r[p].f;}function L(p){var r=this.parent.parent.parent.myData,q=p.v;r.set("format",C(this.items,q));r.set("negativeNumbers",q);A.toggleClass(this.selectedNode,"red",p.r);}function V(r,s,p){return{scriptClass:"mstrmojo.ui.Pulldown",items:r,onitemSelected:function q(t){var u=this.parent;while(u&&(!u.data||typeof u.data[s]==="undefined")){u=u.parent;}if(u){u.data.set(s,t.v);if(p){u.children[0].preview.preview_label.set("text",t.n);}}}};}function f(z,t,s,AB,y){var AA=K.clone(z),p=t>0?".":"",q=p,r=H.DefaultFormat.FormattingNumber,w;for(w=0;w<t;w++){p+=w%9;q+="0";}for(w=0;w<AA.length;w++){var x=AA[w];if(s){x.n=x.n.replace(/,/g,"");x.f=x.f.replace(/,/g,"");}if(AB&&AB!==r.CurrencyPosition){switch(AB){case m.RIGHT:x.n=x.n.replace(/\$/g,"").replace(/\.\d{2}/g,".12$");x.f=x.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00"$"');break;case m.LEFT_WITH_SPACE:x.n=x.n.replace(/\$/g,"$ ");x.f=x.f.replace(/\$/g,"$ ");break;case m.RIGHT_WITH_SPACE:x.n=x.n.replace(/\$/g,"").replace(/\.\d{2}/g,".12 $");x.f=x.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00" $"');break;default:}}x.n=x.n.replace(/\.\d{2}/g,p);x.f=x.f.replace(/\.\d{2}/g,q);if(y&&y!==r.CurrencySymbol){var u=y.replace(/\$/g,"$$$$");x.n=x.n.replace(/\$/g,u);x.f=x.f.replace(/\$/g,u);}x.cls=x.r?"red":null;}return AA;}function T(r){var p="1"+(r>0?".":"").toString(),s="0"+(r>0?".":"").toString(),q;for(q=0;q<r;q++){p+=q%10;s+="0";}return[p+"E+03",s+"E+0#"];}function P(AD,AF){var x="\u00A4",AB=/"[^"]*"/g,r=AD.match(AB),AG="\u0091",AC=/\[[^\]]*\]/g,p=AD.match(AC),AA,AE;AA=AD.replace(AB,x);AA=AA.replace(AC,AG);var t=AD.indexOf("."),z=F.getDecimalLength(AD),w=Math.max(0,z+AF),s=AD.match(/\d(?!((\d)|(,\d)))/g),q=t!==-1?AD.charAt(t-1):s&&s[0],y=(q||"0")+(w>0?".":"").toString();for(var u=0;u<w;u++){y+="0";}AA=AA.replace(z===0?/\d(?!((\d)|(,\d)))/g:/\d\.\d+/g,y);AA=AA.split(x);AE=AA[0];Z.forEach(r,function(AI,AH){AE+=AI+AA[AH+1];});AA=AE.split(AG);AE=AA[0];Z.forEach(p,function(AI,AH){AE+=AI+AA[AH+1];});return AE;}function N(x,p,w,u,r,q){var t=x.parent.parent.parent,s=f(p,w.decimalPlaces,u,r,q);w.set("format",C(s,w.negativeNumbers.toString()));x.set("items",s);x.set("selectedIndex",Z.find(s,"v",w.negativeNumbers.toString()));t.preview.preview_label.set("text",S(t.myData.format));}function h(){var y=this.parent.parent,AC=y.myData,s=y.formatterContainer,q=Q[y.categoryPicker.selectedIndex].v,AF=this.funcType===X.FunctionLeftStr?1:-1,u=null,x=null,t=false,AE=0,z=null,r=false,AB;switch(q){case D.Fixed:u=s.fixed_hBox.negativeDDL;x=n;t=!AC.thousandSeparator;break;case D.Currency:u=s.currency_hBox2.negativeDDL;x=E;AE=AC.currencyPosition;z=AC.currencySymbol;break;case D.Percentage:u=s.percentage_hBox.negativeDDL;x=c;break;case D.Scientific:r=true;break;case D.Custom:AB=true;break;default:return ;}if(AB){var AD=P(AC.format,AF);y.preview.preview_label.set("text",S(AD));y.formatterContainer.custom_text.set("value",AD);return ;}var w=AC.decimalPlaces,p=w+AF;p=Math.max(0,p);p=Math.min(H.MaxNegativeDidigts,p);AC.set("decimalPlaces",p);if(r){var AA=T(p);AC.set("format",AA[1]);y.preview.preview_label.set("text",AA[0]);}else{N(u,x,AC,t,AE,z);}}function S(AA){var r="\u00A4",w=/"[^"]*"/g,q=AA.match(w),u=AA.replace(w,r),z=["m","y","d","h","s"],y=false,p=new Date(),x=p.getFullYear(),t=p.getMonth(),s=p.getDay(),AC=J.datetime,AB;Z.forEach(z,function(AD){y=y||u.indexOf(AD,0)!==-1;});if(y){u=u.replace(/y{3,}/g,x).replace(/y{1,2}/g,x.toString().slice(2,4));u=u.replace(/m{4,}/g,AC.MONTHNAME_FULL[t-1]).replace(/m{3}/g,AC.MONTHNAME_SHORT[t-1]).replace(/mm/g,"07").replace(/m/g,"7").replace(/7ber/g,"mber");u=u.replace(/d{4,}/g,AC.dayNames[s-1]).replace(/d{3}/g,"Mon").replace(/dd/g,"10").replace(/d/g,"1").replace(/1ay/g,"day");u=u.replace(/hh/g,"08").replace(/h/g,"8");u=u.replace(/ss/g,"04").replace(/s/g,"4");u=u.split(r);AB=u[0];Z.forEach(q,function(AE,AD){AB+=AE+u[AD+1];});return AB;}return F.formatByMask(AA,1234.12);}function o(p,q){return Math.max(Z.find(p,"v",q),0);}function B(r){var q=this.parent.parent.categoryPicker,p=Q.map(function(s){return s.v;}).indexOf(r);q.set("selectedIndex",p);}function l(p,q,s,r){return G(undefined,p,q,undefined,K.copy(r,{useRichTooltip:true,updateTooltipConfig:function(){this.richTooltip={cssClass:"vi-regular vi-tooltip-A A-center",content:s,refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPCENTER,left:15,top:33};}}));}function Y(){if(mstrApp.isSingleTier){var u=this.formatterContainer,t=J.datetime,p={day:7,month:4,year:1998},r={hour:15,min:41,sec:46},s=t&&t.DATEINPUTFORMATS,q=t&&t.TIMEINPUTFORMATS;W=[];R=[];s.forEach(function(w){W.push({v:w,n:M.formatDateInfo(p,w)});});q.forEach(function(w){R.push({v:w,n:M.formatTimeInfo(r,w)});});u.date_ddl.set("items",W);u.time_ddl.set("items",R);}else{W=H.Date;R=H.Time;}}mstrmojo.vi.ui.NumberFormatter=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatter",cssClass:"NumberFormatter-content",formatValue:null,myData:null,oldData:null,categoryPicker:null,formatterContainer:null,preview:null,shortcutRow:null,adjustAfterCategoryChange:mstrmojo.emptyFn,preBuildRendering:function(){if(this._super){this._super();}Y.call(this);var p=this.formatterContainer;if(this.formatValue){p.currency_hBox1.currency_symbol.selectedValue=this.formatValue.currencySymbol;p.fixed_btn.checked=!!this.formatValue.thousandSeparator;A.addWidgetCssClass(p.fraction_ddl,c[Z.find(c,"v",this.formatValue.negativeNumbers)].r?" red":"");}},postBuildRendering:function O(){if(this._super){this._super();}if(this.formatValue){this.categoryPicker.set("selectedIndex",o(this.categoryPicker.items,this.formatValue.category.toString()));}},children:[K.copy({alias:"categoryPicker",cssClass:"nf-category",onitemSelected:function k(AC){if(!this.hasRendered){return ;}var x=this,AA=x.parent,r=AA.formatterContainer,p=AA.shortcutRow,AB=AA.preview.preview_label,z=AC.v,t=z===D.Automatic,q=[],w=AA.myData;Z.forEach(r.children,function(AD){AD.set("visible",false);});AA.border.set("visible",!t);AA.preview.set("visible",!t);["border","moveLeftBtn","moveRightBtn"].forEach(function(AD){p[AD].set("visible",!t);});w.set("category",z);w.set("thousandSeparator",z?I.ThousandSeparator:AA.formatValue.thousandSeparator);switch(z){case D.Currency:N(r.currency_hBox2.negativeDDL,E,w,false,w.currencyPosition,w.currencySymbol);r.currency_hBox1.currency_position.set("selectedIndex",o(H.CurrencyPosition,w.currencyPosition.toString()));q=["currency_hBox1","currency_hBox2"];break;case D.Date:r.date_ddl.set("selectedIndex",o(W,w.format));q=["date_ddl"];break;case D.Time:r.time_ddl.set("selectedIndex",o(R,w.format));q=["time_ddl"];break;case D.Percentage:N(r.percentage_hBox.negativeDDL,c,w,false,0,null);q=["percentage_hBox"];break;case D.Fraction:r.fraction_ddl.set("selectedIndex",o(H.Fraction,w.format));q=["fraction_ddl"];break;case D.Scientific:var u=T(w.decimalPlaces||0);w.set("format",u[1]);AB.set("text",u[0]);break;case D.Custom:var s=w.customText||w.format,y=r.custom_text;w.set("format",s);y.value=s;y.refresh();AB.set("text",S(s));q=["custom_condense","custom_text"];break;case D.Fixed:N(r.fixed_hBox.negativeDDL,n,w,!w.thousandSeparator,0,null);q=["fixed_hBox","fixed_btn"];break;}Z.forEach(q,function(AD){r[AD].set("visible",true);});AA.adjustAfterCategoryChange();}},V(Q,"category")),{scriptClass:"mstrmojo.Box",cssClass:"nf-MiddleRow nf-shortcut",alias:"shortcutRow",border:null,moveLeftBtn:null,moveRightBtn:null,children:[l("nf-shortcut-currency",function e(){B.call(this,D.Currency);},mstrmojo.desc(2051,"Currency"),undefined),l("nf-shortcut-percentage",function e(){B.call(this,D.Percentage);},mstrmojo.desc(2053,"Percentage"),undefined),l("nf-shortcut-fixed",function e(){B.call(this,D.Fixed);this.parent.parent.formatterContainer.fixed_btn.set("checked",true);},mstrmojo.desc(2050,"Fixed"),undefined),{scriptClass:"mstrmojo.Label",cssClass:"shortcut-border",alias:"border"},l("nf-MoveDecimalPoint left",function e(){h.call(this);},mstrmojo.desc(2189,"Increase Decimal"),{funcType:X.FunctionLeftStr,alias:"moveLeftBtn"}),l("nf-MoveDecimalPoint right",function e(){h.call(this);},mstrmojo.desc(2188,"Decrease Decimal"),{funcType:X.FunctionRightStr,alias:"moveRightBtn"})]},{scriptClass:"mstrmojo.Label",alias:"border",cssClass:"nf-border"},{scriptClass:"mstrmojo.Container",alias:"formatterContainer",cssClass:"nf-buttons",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',fixed_hBox:null,fixed_btn:null,currency_hBox1:null,currency_hBox2:null,date_ddl:null,time_ddl:null,percentage_hBox:null,fraction_ddl:null,custom_condense:null,custom_text:null,markupSlots:{containerNode:function U(){return this.domNode;}},children:[{scriptClass:"mstrmojo.HBox",alias:"fixed_hBox",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function k(p){L.call(this,p);}},V([],"format"))]},{scriptClass:"mstrmojo.CheckBox",alias:"fixed_btn",cssClass:"nf-MiddleRow",label:mstrmojo.desc(13898,"Use 1000 Separator(#)").replace("#",J.number.THOUSANDSEPARATOR),onclick:function e(){var q=this.parent.parent;q.myData.set("thousandSeparator",this.checked?-1:0);N(this.parent.fixed_hBox.negativeDDL,n,q.myData,!this.checked,0,null);}},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox1",cssClass:"nf-MiddleRow",visible:true,currency_symbol:null,currency_position:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",alias:"currency_symbol",cssClass:"nf-CurrencySymbol",selectedValue:"$",items:a,postselectedValueChange:function g(q){var u=this,t=u.parent.parent.parent,s=q.value,r=t.myData;r.set("currencySymbol",s);N(this.parent.parent.currency_hBox2.negativeDDL,E,r,false,parseInt(r.currencyPosition,10),s);}},K.copy({cssClass:"nf-CurrencyPosition align-right",alias:"currency_position",onitemSelected:function k(q){var t=this,s=t.parent.parent.parent,r=q.v;s.myData.set("currencyPosition",parseInt(r,10));N(this.parent.parent.currency_hBox2.negativeDDL,E,s.myData,false,parseInt(r,10),s.myData.currencySymbol);}},V(H.CurrencyPosition,"currencyPosition"))]},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox2",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function k(p){L.call(this,p);}},V([],"format"))]},K.copy({alias:"date_ddl",cssClass:"nf-MiddleRow"},V(H.Date,"format",true)),K.copy({alias:"time_ddl",cssClass:"nf-MiddleRow"},V(H.Time,"format",true)),{scriptClass:"mstrmojo.HBox",alias:"percentage_hBox",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function k(p){L.call(this,p);}},V([],"format"))]},K.copy({alias:"fraction_ddl",cssClass:"nf-MiddleRow"},V(H.Fraction,"format",true)),mstrmojo.Button.newWebButton(mstrmojo.desc(13893,"Condense (e.g.10M)"),function(){this.parent.custom_text.set("value",'[>=1000000]#,##0,,"M";[>=1000]#,##0,"K";0');},false,{cssClass:"nf-condense",alias:"custom_condense"}),{scriptClass:"mstrmojo.TextBox",alias:"custom_text",cssClass:"nf-custom",onvalueChange:function d(){var s=this,r=s.parent.parent,q=s.value;r.myData.set("format",q);r.myData.set("customText",q);s.parent.parent.preview.preview_label.set("text",S(q).replace(/\s/g,"&nbsp;"));}}]},{scriptClass:"mstrmojo.HBox",alias:"preview",cssClass:"nf-MiddleRow",preview_label:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"preview_lable",text:mstrmojo.desc(13892,"Preview:")},{scriptClass:"mstrmojo.Label",cssClass:"align-right",alias:"preview_label"}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasPopup","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.ConditionNode","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr");var D=mstrmojo.css,A=mstrmojo.dom,G=mstrmojo.hash,C=function(L){var M=L.data,K=M.dmy&&M.dmy.uts||[],I=K.length,H=[],J;for(J=0;J<I;J++){H.push(K[J].n);}return'<span class="mstrmojo-text">'+H.join(", ")+"</span>";};mstrmojo.fe.RelationNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><span class="mstrmojo-relationNode-inf"><span class="mstrmojo-relation-prefix-text">'+mstrmojo.desc(2790,"Set of").replace(/##/g,"")+'</span><span class="mstrmojo-textset"  mstrAttach:click></span><span class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(2793,"Where").replace(/##/g,"")+'</span><span class="mstrmojo-relation-convert-text"  mstrAttach:click >'+mstrmojo.desc(null,"Convert to Condition")+'</span><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></span><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},convertNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[3];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){D.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){D.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=C(this);}},noRelationOperator:true,children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(H){this.parent.tree.onNew(H);},getItemConfig:function(K,H,L){var I=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,K,H,L),J=L.tree||L;return G.copy({tree:J,rootTree:this.parent.tree,noRelation:true,inRelation:true},I);},prenodeclick:function(H){if(!H||!H.part){return ;}var I=this.rootTree;if(I&&I.onnodeclick&&this.editable){H.editor=I.editor;I.onnodeclick.call(this,H);}}}],premousedown:function(H){if(this._super){this._super(H);}var I=A.eventTarget(H.hWin,H.e);if(!A.contains(this.childTree.domNode,I,true)){this.childTree.clearTreeSelect();}},preselectedChange:function(H){if(!H.value){this.childTree.clearTreeSelect();}},init:function(H){this._super(H);var I=this.data;if(I){delete this.data;this._set_data(null,I);}},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;if(H){this.childTree.set("items",H.nds||[H]);}}return J;},isSelectableArea:function(H){return mstrmojo.dom.contains(this.relationNode,H,true);},preclick:function E(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.textNode,I,true)){J="createSet";}else{if(A.contains(this.convertNode,I,true)){this.parent.removeSet(this);return false;}}}H.part=J;},del:function B(){var H=this.parent;if(H&&H.remove&&this.data){H.remove(this.data);}},newCondition:function F(H){this.childTree.newCondition(H);},avatarCssCls:"mstrmojo-FE mstrmojo-relationNode",getAvatarNode:function(){return this.relationNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.Label","mstrmojo.Obj","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.warehouse.EnumObjectTypes");var G=mstrmojo.expr,C=G.ET,B=mstrmojo.array,E=mstrmojo.string,F=mstrmojo.warehouse.EnumObjectTypes,D=mstrmojo.mstr.EnumNodeDimty;mstrmojo.fe.CreateSetEditor=mstrmojo.declare(mstrmojo.Editor,null,{onOpen:function(){var M=this.model,P=this.condition.data,N=!P.m,J=this.attrsBox.attrsList,H=this.relBox.relPd,Q=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(M.metrics),I=this.appQual;J.set("items",M.attrs);mstrmojo.array.forEach(["relBox","appQual"],function(R){this[R].set("visible",N);},this);if(P.dmt===4&&P.dmy.uts){var K={};B.forEach(P.dmy.uts,function(S){var R=B.find(M.attrs,"did",S.utgt.did);if(R>=0){K[R]=true;}});J.set("selectedIndices",K);}if(N){H.set("items",Q);if(P.relation&&P.relation.guide){var L=P.relation.guide,O=B.find(Q,"did",L.did);H.set("selectedIndex",O>=0?O:0);}else{H.set("selectedIndex",0);}I.set("checked",!!P.applySubExpr);}},onOK:function(){var O=this.model,R=this.condition,T=this.condition.data,L=this.attrsBox.attrsList,H=this.relBox.relPd,J=this.appQual;var V=L.getSelectedItems(),I=[];B.forEach(V,function(X){I.push({utgt:{n:X.n,did:X.did},utp:G.DMY_TP.ATTR,agg:1,flt:2,gb:true,rps:0,n:X.n});});var U;if(H.selectedIndex>0){var M=H.items[H.selectedIndex];U={n:M.n,did:M.did,t:F.METRIC,st:1024};}var K;if(T.et===15){T.dmt=D.NodeDimtyOutputLevel;T.dmy=T.dmy||{};T.dmy.uts=I;K=T.relation=T.relation||{};if(U){K.guide=U;T.useSchema=false;}else{delete K.guide;delete K.rsTp;delete K.joTp;delete K.paTp;delete K.erTp;T.useSchema=true;}T.applySubExpr=J.checked;R.set("data",T);}else{var S={et:15};S.dmt=D.NodeDimtyOutputLevel;S.dmy={};S.dmy.uts=I;K=S.relation={};if(U){K.guide=U;}else{S.useSchema=true;}S.applySubExpr=J.checked;var N=R,P={rq:S,cq:T},Q=[R.childIndex()];if(T.et===C.ANDOR){if(T.nds&&T.nds.length>2){var W=O.childIdx;Q=[W,W-1];}else{N=R.parent;}}else{N=R.parent;P.isMetric=!!T.m;}N.createSet(Q,P);}},children:[{scriptClass:"mstrmojo.Box",alias:"attrsBox",cssClass:"Attributes-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14613,"Select attributes to create the set"),cssClass:"Label"},{scriptClass:"mstrmojo.ui.CheckList",alias:"attrsList",cssClass:"CheckList"}]},{scriptClass:"mstrmojo.Box",alias:"relBox",cssClass:"RelatedBy-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",onitemSelected:function A(H){}}]},{scriptClass:"mstrmojo.ui.Checkbox",alias:"appQual",cssClass:"AppQual-CheckBox",postBuildRendering:function(){this.domNode.innerHTML=E.encodeHtmlString(mstrmojo.desc(12038,"Apply this qualification independently of the relationship filter"));}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float: right; border-collapse: separate; display: table;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(2397,"OK"),onclick:function(){var H=this.editor;H.onOK();H.close();},bindings:{enabled:function(){var I=this.parent.parent.attrsBox.attrsList,H=this.parent.parent.attrsBox.attrsList.selectedIndices;return I.getSelectedItems().length>0;},editor:"this.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent"}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.FilterExpr");var D=mstrmojo.hash,B=mstrmojo.expr.ET;mstrmojo.fe.FilterExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.fe.FilterExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,onConditionEdit:mstrmojo.emptyFn,modifyConditionNode:function(G,F){var H=G.data,E=H.isNew;D.copy(D.clone(F),D.clear(H));delete H.isNew;G.paint();if(H.et===B.MQ||H.et===B.MC){G.set("noCreateSet",true);}if(G.tree.onConditionEdit){G.tree.onConditionEdit(G,E);}},getItemConfig:function(H,E,I){var F=this._super(H,E,I),G=I.tree;return D.copy({onclick:G.prenodeclick,containerResizable:G.containerResizable,ondragend:G.ondragend,ondrop:G.ondrop},F);},ondragenter:function A(E){this.dropCuePos={left:0,top:0,idx:0,idxActual:0};this._super(E);},ondragend:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondragend.call(this,E);}},ondrop:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondrop.call(this,E);}},isEditable:function C(F){if(!this.editable){return false;}var E=false;switch(F&&F.et){case B.R:case B.F:E=false;break;case B.ANDOR:case B.MQ:case B.AQ:case B.AL:case B.AC:case B.MC:case B.AE:E=true;break;case B.XML:E=!F.xml||!!F.ph;}return E;},prenodeclick:function(E){if(!E||!E.part){return ;}if(E.part!=="createSet"&&E.part!=="createSetOpt"&&!(E.part==="andor"?this.prefixedAndOrEditable:this.editable)){return ;}var F=this.tree;if(F.onnodeclick){F.onnodeclick.call(this,E);}},getSelectedItemWidget:function(){var E=function(K){var I=K&&K.ctxtBuilder&&K.ctxtBuilder.itemWidgets,G=K.selectedIndex,F=I&&I.length||0;if(!I){return ;}if(G===-1){for(var H=0;H<F;H++){var J=E(I[H]);if(J){return J;}}}else{return I[G];}};return E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ObjectBrowser");var H=mstrmojo.array;var E=[257,1024,3072,12032];mstrmojo.vi.ui.editors.ObjectPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ObjectPicker",cssClass:"mstrmojo-vi-ObjectPicker",zIndex:9,title:mstrmojo.desc(11496,"Select Object"),help:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:4,supportedTypes:H.hash(E),item:null,OKFn:null,children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",closeable:false,browsableTypes:"8,"+E.join(","),closeOnSelect:false,showCompletePath:false,searchVisible:false,scrollableIncFetch:true,bindings:{rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId"}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btnHBox",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function C(){var J=this.parent.parent;this.parent.parent.close({item:J.item});var I=J.OKFn;if(I){I(J.item);}J.set("item",null);},bindings:{enabled:function B(){return !!this.parent.parent.item;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancle"),onclick:function C(){var I=this.parent.parent;this.parent.parent.close();I.set("item",null);}}]}],preBuildRendering:function A(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];},postBuildRendering:function D(){if(this._super){this._super();}this.browse();},onOBSelect:function F(I){this.set("item",((this.supportedTypes[I.t]||this.supportedTypes[I.st])?I:null));},browse:function G(){this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.fe.FilterExprTree","mstrmojo.fe.AndOrNode","mstrmojo.fe.RelationNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode");var K=mstrmojo.expr.ET;mstrmojo.fe.RelationFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RelationFilterExprTree",nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},getItemIdentityProp:function(L){if(L.ph){return"ph";}if((L.et===10||L.et===12)&&L.dmt===4){return K.RLS;}return L.et;},isEditable:function J(M){var L=false;switch(M&&M.et){case K.RLS:L=true;break;}return L||this._super(M);},getItemConfig:function(O,L,P){var M=this._super(O,L,P),N=(O.et===K.RLS||!!O.relation);if(N){M.itemFunction=P.itemFunction;}return M;},newCondition:function E(M){var L=this.getSelectedItemWidget();if(M&&M.ph&&!M.ph.idx&&microstrategy.bones.rwb_viewer){M.ph.idx=microstrategy.bones.rwb_viewer.nextPhIndex++;}if(L&&L.selected&&L.newCondition){return L.newCondition(M);}else{return this._super(M);}},createSet:function D(M,L){var N=L.rq,O=L.cq;if(N&&O){this.remove(O);if(L.isMetric){mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],N,O);N=O;}else{N.nds=[O];}this.add([N],M[0]);}},removeSet:function G(L){var M=L.data,N=[M];this.remove(M);if(M.nds&&M.nds.length>0){N=M.nds;}else{delete M.dmy;delete M.relation;delete M.applySubExpr;delete M.relation;delete M.useSchema;delete M.dmt;}this.add(N,0);},nameFactory:{counter:1,names:{},clear:function(){this.resetCounter();this.names={};},resetCounter:function C(){this.counter=1;},isNameExist:function I(L){return !!this.names[L];},setName:function H(L,M){this.names[L]=M;},changeName:function B(M,L,N){this.removeName(M);this.setName(L,N);},getNewName:function F(O,N,Q){var P=N||"",M=Q||"",L;while(this.isNameExist(P+this.counter+M)){this.counter++;}L=P+this.counter+++M;this.names[L]=O;return L;},removeName:function A(L){delete this.names[L];this.resetCounter();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.AdvancedColorPickerPopup","mstrmojo.css");var F=mstrmojo.css,E=Math.round;function I(N){var O=this.previewNode,M=O.offsetWidth,P=O.offsetHeight,Q=Math.sqrt(M*M+P*P),L=Math.atan2(P,M)*(-180)/Math.PI;O.style.backgroundColor="#FFFFFF";N.display="block";N.top=E(P/2)+"px";N.left=E((M-Q)/2)+"px";N.width=E(Q)+"px";N[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+E(L)+"deg)";}mstrmojo.ui.editors.controls.ColorPickerButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onselectedValueChange:function(){this.updatePreview();this.colorPicker.set("color",this.selectedValue);},onautoPreviewColorChange:function C(){this.getPopupWidget().set("autoPreviewColor",this.autoPreviewColor);this.updatePreview();},onenabledChange:function G(){F.toggleClass(this.domNode,"disabled",!this.enabled);}},isHostedWithin:false,showGradient:true,showNoFill:true,showAutomatic:false,autoPreviewColor:null,selectedValue:null,init:function K(M){this._super(M);var L=this.colorPicker;L.showGradient=this.showGradient;if(this.showNoFill!==undefined){L.showNoFill=this.showNoFill;L.showAutomatic=this.showAutomatic;}L.showAutomatic=this.showAutomatic;F.addWidgetCssClass(this,"mstrmojo-ColorPickerBtn");},preBuildRendering:function J(){this.colorPicker.showNoFill=this.showNoFill;return this._super();},setDimensions:function H(M,L){this._super(M,L);window.setTimeout(function(){this.updatePreview();}.bind(this),0);},postBuildRendering:function A(){var L=this.noFillNode=document.createElement("div");L.style.display="none";L.className="slash";this.domNode.firstChild.appendChild(L);this._super();},updatePreview:function B(){var P=this.previewNode;if(P){var N=this.selectedValue===mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC?this.autoPreviewColor:this.selectedValue;if(N){var Q=P.style;if(N.c1){var R=F.buildGradient(N.or,N.c1,N.c2);if(R&&R.n){Q[F.convertCssToCamelCase(R.n)]=R.v;}}else{var L=F.buildGradient(0,"0","0");if(L&&L.n){Q[F.convertCssToCamelCase(L.n)]=null;}var O="conflict"===N||("transparent"===N&&!this.showNoFill);F.toggleClass(P,"conflict",O);Q.backgroundColor=!O?N:null;}if(this.showNoFill&&this.noFillNode&&this.enabled){var M=this.noFillNode.style;if("transparent"===N){I.call(this,M);}else{M.display="none";}}}}},getPopupWidget:function D(){return this.colorPicker;},children:[{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",alias:"colorPicker",slot:"widgetHostNode",color:this.selectedValue,isHostedWithin:true,colorChanged:function(L){this.parent.set("selectedValue",L);this.close();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui.tabs.Tab","mstrmojo.ME.MetricEditBox","mstrmojo.array","mstrmojo.hash");var Z=mstrmojo.array,M=mstrmojo.hash,K=mstrmojo.ME.MetricToken.brackets,L=mstrmojo.dom,B=mstrmojo.css,Q=mstrmojo.vi.ui.tabs.Tab.ACTIONS,g=Q.DELETE+Q.RENAME,k=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,D=mstrmojo.string,m="This@ID",T="45C11FA478E745FEA08D781CEA190FE5";function G(q){return{n:q,k:q,ftk:[],vs:1,is:""};}function O(w,x,q,t){var s=w.forms[x]||{},u=w.forms[q],r=w.inputBox;if(x!==q){s.vs=w.vStatus;s.is=w.iStatus;s.ftk=r.items;w.set("vStatus",k.UNKNOWN);}w.set("vStatus",u.vs);w.set("iStatus",u.is);w.updateInputBoxItems({items:u.ftk});if(w.curFormIdx!==q){w.curFormIdx=q;w.tabstrip.setSelectedTab(u.k);}w.raiseEvent({name:"tabSwitch",tks:u.ftk,vs:u.vs,is:u.is,oidx:x,nidx:q,toNewTab:t});}function N(r){var q=r.forms[r.curFormIdx];if(q){q.ftk=r.inputBox.items;q.vs=r.vStatus;q.is=r.iStatus;}}var e=0;function W(q){e=Math.max(q.length-1,e);}function V(){e=0;}function n(q){var r="DESC"+(e?" "+e:"");e++;if(Z.find(q,"n",r)>=0){return n(q);}return r;}function I(u){var s={v:K(u.n),oi:u,isNew:true},r,q;if(u.t===12){r=Z.filter(u.fs,function(t){return t.obf||u.da;}).length;if(r===1){q=u.fs[0];s=M.copy({v:K(u.n)+"@"+K(q.fnm),ift:true,exv:q.fid,extp:8},s);}else{s=M.copy({v:K(u.n)+"@",ift:true},s);}}return s;}function E(r,q){r.set("enabled",!q);var s="mstrmojo-InlineWaitIcon";if(r.iconClass){r.set("iconClass",r.iconClass.replace(new RegExp(s),"")+" "+(q?s:""));}else{mstrmojo.css.toggleClass(r.domNode,s,q);}}var U=function(z){var t=z.items,u=t.length,w=t[t.length-1],s,r,y=[],q="",x;if(t[0]&&t[0].tp!==33){y.push({v:"!",tp:33,lv:4,sta:2});}for(s=0;s<u;s++){r=t[s];if(r.isNew&&!r.oi){q+=r.v;}else{if(!D.isEmpty(q)){y.push({v:q,tp:2,lv:1});q="";}if(r.v&&r.v.indexOf(m)>=0){r.v=r.v.replace("["+m+"]",m);r.exv=T;r.extp=8;delete r.oi;}y.push(r);}}if(!D.isEmpty(q)){y.push({v:q,tp:2,lv:1});q="";}if(w&&w.tp!==-1){y.push({v:"",tp:-1,lv:4,sta:2});}return{items:y};},a=function(s){var q=s.items||[],r=q[q.length-1];if(r&&r.tp===-1){q.pop();}if(q[0]&&(q[0].tp===33||q[0].tp===37)){q.splice(0,1);}Z.forEach(q,function(t){if(t.v&&t.v.indexOf(m)>=0){M.copy({extp:8,exv:T,oi:{n:"This",did:"This",t:12}},t);}});},Y=function(q){if(!q){return k.VALID;}return{"-2147214845":k.ERROR,"-2147214846":k.AMBIGUITY}[q]||k.ERROR;},R=function(s){s=U(s);var r={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true,vtp:true},q={getArrItemName:function(){return"tkn";},isSerializable:function(t){return(r[t])?true:false;}};return D.json2xml("tknstrm",s,q);},F=function(s,w,u,r){var t=R(w),x=function(y){if(y&&y.tks){var z=y.tks;a(z);z.vs=Y(z.rjec);z.tokenXML=t;if(r){r(z);}}},q=function(y){mstrmojo.alert(y.message||y.getResponseHeader&&y.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:t,localSymbolFolderXML:"",metricXML:"",metricId:s||"",isNew:true,objectType:12,isIDForm:u,msgID:mstrApp.getMsgID()},{success:x,failure:q});};mstrmojo.ME.DerivedAttributeFormTab=mstrmojo.declare(mstrmojo.vi.ui.tabs.Tab,null,{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",valid:true,editable:true,postBuildRendering:function S(){if(this._super){this._super();}var q=this,r=q.lbl;r.editOnDoubleClick=this.editable;r.onTextEditComplete=function(t,s){if(q.validate(r.text)){q.titleEdited(r.text,s);}};},onclick:function d(q){var r=mstrmojo.dom.eventTarget(q.hWin,q.e);if(r===this.menuBtnNode){this.tabDeleted();}else{if(!this.isSelected){this.tabSelected();}}},validate:function(q){var r=!/[\[\]\"\\]/g.test(q);if(!r){this.lbl.set("isEditing",true);}this.set("valid",r);return r;},showErrTooltip:function p(u,s){var q=mstrmojo.dom.position(this.domNode),r=this,t=r.errTooltip;if(!t){r.errTooltip=t=new mstrmojo.Tooltip({contentNodeCssClass:"me-tooltip-content up me-err",updatePopupConfig:null});this.addDisposable(t);}t.set("top",q.y+q.h+2);t.set("left",q.x+q.w/2-s);t.set("content",'<div class="content"><span>'+u+"</span></div>");t.open();window.setTimeout(function(){t.close();},2500);},onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.showErrTooltip(mstrmojo.desc(11569,"Input contains invalid character"),95);}}});function f(t,u,w){var s=Z.find(u,"k",w.k);return{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",title:w.n,draggable:false,editable:s!==0,cssClass:"mstrmojo-AEB-Tab "+(s===0?"mstrmojo-AEB-IDTab":""),getMenuActions:function(){return g;},tabSelected:function(){O(t,t.curFormIdx,s);},titleEdited:function r(y,x){if(y!==x){if(Z.find(t.forms,"n",y)>=0){this.showErrTooltip(mstrmojo.desc(7209,"Name already exists"),69);}var z=t.forms[s];z.n=y;}},tabDeleted:function q(){var x=t.forms.length,AA=(t.curFormIdx===x-1)?0:t.curFormIdx,y=t.forms.slice(0),z=y[s];if(z&&z.did){t.delForms.push({n:z.n,did:z.did});}y.splice(s,1);t.curFormIdx=AA;t.set("forms",y);O(t,-1,AA);t.set("dirty",true);}};}mstrmojo.ME.AttributeEditBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,null,{scriptClass:"mstrmojo.ME.AttributeEditBox",markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-AEB-TabStrip"></div><div class="mstrmojo-MEBox-edit mstrmojo-AEB-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{tabstripNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},statusNode:function(){return this.domNode.lastChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;}},forms:null,delForms:[],curFormIdx:0,attrid:null,absorbAmbiguity:false,init:function l(s){var t=this;t.children=[{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",alias:"tabstrip",position:"top",slot:"tabstripNode",isAlignRight:false,getTabCfg:function r(x,y,w){return M.copy(f(t,x,y),w);},addTab:function u(){var y=t.forms,w=y.length,z=n(y),x=y.slice(0);x.push(G(z));t.set("forms",x);O(t,t.curFormIdx,w,true);t.set("dirty",true);},clear:function q(){Z.forEach(this.children,function(w){w.hideTooltip();});}},{scriptClass:"mstrmojo.Button",alias:"clearBtn",slot:"tabstripNode",text:mstrmojo.desc(1763,"Clear All"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-clearAll",onclick:function(){t.inputBox.clearTokens([]);}},{scriptClass:"mstrmojo.Button",alias:"validateBtn",slot:"tabstripNode",text:mstrmojo.desc(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-validate",onclick:function(){t.validateCurrentForm();}}].concat(this.children);this._super(s);},item2textCss:function J(q){return this._super(q)||{21:"afm"}[q.t]||"";},onformsChange:function X(){var q=this.forms,r=q[this.curFormIdx].k;Z.forEach(q,function(s){a({items:s.ftk});});this.tabstrip.setTabs(q,r);W(q);},selectFormTab:function A(q){O(this,this.curFormIdx,q);},postBuildRendering:function S(){if(this._super){this._super();}this.clear();var q=this;this.inputBox.ondrop=function(z){if(!z.src.data||!z.src.data.item){return ;}var y=q.inputBox,u=y.ctxtBuilder.itemWidgets,w=M.copyProps(["did","n","t","fs"],z.src.data.item),t=I(w),x,r,s;z.src.data=t;mstrmojo.ListBase2.prototype.ondrop.call(this,z);if(q.ontokensModify){q.ontokensModify();}x=this.selectedIndices;if(w.t===12&&t.ift&&!t.exv){for(r in x){s=u[r];if(s){y.startTokenSuggestion(s);}}}y.clearSelect(true);B.removeClass(y.domNode,"unselectable");};},clear:function c(){this.curFormIdx=0;this.delForms=[];this.attrid=null;V();this.set("forms",[G("ID")]);this.inputBox.set("items",[]);this.inputBox.resetTokensCache();this.set("vStatus",k.UNKNOWN);this.set("iStatus","");this.tabstrip.clear();},validateCurrentForm:function C(r){var s=this,t=this.validateBtn,q=function(u){E(t,false);s.set("vStatus",u.vs);s.set("iStatus",u.rjed||"");s.updateInputBoxItems({items:u.items});s.statusNode.style.display="block";s.handleValidation(u);if(r){r(u.items,u.vs===k.VALID);}};s.set("vStatus",k.VALIDATING);E(t,true);F(this.attrid,{items:this.inputBox.items},s.curFormIdx===0,q);},validateAllForms:function o(s){var t=this,r=t.forms,q=0,u=function(y){var x=(q===0);if(y){var w=r[q-1];w.ftk=y.items;w.vs=y.vs;w.is=y.rjed||"";w.tokenXML=R({items:y.items});if(y.vs!==k.VALID){t.selectFormTab(q-1);t.handleValidation(y);if(s){s(null,false);}return ;}}if(q===r.length){if(s){s(r,true);}return ;}F(t.attrid,{items:r[q++].ftk},x,u);};N(t);u();},continueValidataion:function P(){this.validateCurrentForm();},getStatusDesc:function b(q){return{0:mstrmojo.desc(11655,"Valid Formula.")}[q];},onvStatusChange:function h(){this.statusNode.style.display=this.vStatus>=k.VALIDATING?"block":"none";},onObjectInsert:function H(t){var u=this.inputBox,s=I(t),q=u.insertTokens([s]),r;if(t.t===12&&s.ift&&!s.exv){r=u.ctxtBuilder.itemWidgets[q];if(r){u.startTokenSuggestion(r);}}}});mstrmojo.ME.AttributeEditBox.preprocessTokenStream=a;mstrmojo.ME.AttributeEditBox.postprocessTokenStream=U;mstrmojo.ME.AttributeEditBox.mapErrorCode=Y;mstrmojo.ME.AttributeEditBox.getTokenStreamXML=R;mstrmojo.ME.AttributeEditBox.validateSyntax=F;mstrmojo.ME.AttributeEditBox.prepareInsertToken=I;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Vis","mstrmojo._HasOwnAvatar");var K=mstrmojo.css,I=mstrmojo.dom,F="px";function B(Q,P){return{x:Q.x-P.x,y:Q.y-P.y};}function M(Q,P){return(Q.x-P.x)*(Q.x-P.x)+(Q.y-P.y)*(Q.y-P.y);}function N(P){var Q=P.src.data;return(!Q||!Q.isScrollBar);}mstrmojo.VisLegend=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.gm.VisLegend",bodyCssClass:"",avatarCssClass:"legend-dragged",dropZoneHighlightCss:"legend-dropZone",ownAvatar:true,draggable:true,dropZone:true,dockedPositions:null,calculateDockedPositions:mstrmojo.emptyFn,widget:null,boundaryNode:null,draggableNodeName:"domLegend",legendMarkup:"",extrasMarkup:"",markupString:'<div id="{@id}" class="{@cssClass}" style="width:{@width}px;height:{@height}px;top:{@top}px;left:{@left}px;position:absolute;" mstrAttach:click,mouseover,mouseout><div class="gm-legend-bg"><div class="{@bodyCssClass}" style="width:{@width}px;height:{@height}px;text-decoration:inherit">{@legendMarkup}</div></div><div class="gm-anchor-point topLeft"></div><div class="gm-anchor-point topRight"></div><div class="gm-anchor-point bottomLeft"></div><div class="gm-anchor-point bottomRight"></div>{@extrasMarkup}</div>',markupSlots:{dropZoneNode:function(){return this.domNode;},domLegend:function(){return this.domNode.firstChild.firstChild;}},postBuildRendering:function(){this._super();this.calculateDockedPositions(this.widget.getWidth(),this.widget.getHeight());this.boundaryNode=this.widget.domNode;this.boundaryPosition=I.position(this.boundaryNode,true);},createAvatar:function D(){return this[this.draggableNodeName];},updateDropZoneNode:function C(R){var P=this.dockedPositions;if(P&&P.length>0){var W=B(R.tgt.pos,this.boundaryPosition);var U=M(W,P[0]),T=0,Q,V;for(Q=1;Q<P.length;Q++){V=M(W,P[Q]);if(V<U){U=V;T=Q;}}if(T!==this.currDockedPositionIdx){var S=this.dropZoneNode.style;S.left=P[T].x+F;S.top=P[T].y+F;if(this.widget.onLegendDropZoneChange){this.widget.onLegendDropZoneChange(P[T],T);}this.currDockedPositionIdx=T;this.updateAlignClass();return true;}}return false;},toggleDropZoneBorder:function O(P){K.toggleClass(this.dropZoneNode,this.dropZoneHighlightCss,P);},isDragValid:N,ondragstart:function E(P){if(!N(P)){return ;}this._super(P);this.toggleDropZoneBorder(true);},ondragmove:function A(P){if(!N(P)){return ;}this.updateDropZoneNode(P);this._super(P);},allowDrop:function H(P){var R=P.src,Q=R&&R.widget;return(Q&&Q!==this&&Q.parent===this.parent);},ondrop:function J(R){var P=this.domLegend;K.removeClass(P,this.avatarCssClass);var S=P.style;S.left="0";S.top="0";this.dropZoneNode.firstChild.appendChild(P);if(this.widget.onLegendDropped){var Q=this.getDockedPosition();this.widget.onLegendDropped(Q&&Q.pos);}R.dropSuccessful=true;},getDockedPosition:function G(){return this.dockedPositions&&this.dockedPositions[this.currDockedPositionIdx];},ondragend:function A(P){if(!N(P)){return ;}this._super(P);if(!P.dropSuccessful){this.ondrop(P);}this.toggleDropZoneBorder(false);},positionAvatar:function L(U){var R=this,Q=this.avatar,S=Q.style,T=this.boundaryPosition;var P=function(V,W){if(V==="x"){if(W<T.x){return T.x;}return Math.min(W,T.x+T.w-R.domNode.offsetWidth);}if(V==="y"){if(W<T.y){return T.y;}return Math.min(W,T.y+T.h-R.domNode.offsetHeight);}};S.left=P("x",U.x)+F;S.top=P("y",U.y)+F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.gmaps.MapToolbar","mstrmojo.dom","mstrmojo.css");var M=115,J=0,D=3,A=0,E=500,H=300,G={NORMAL_STATE:0,SINGLE_SELECT_STATE:1,RECTANGLE_SELECT_STATE:2,ZOOM_STATE:3,AFFINITY_STATE:4,FREE_SELECT_STATE:5,CIRCLE_SELECT:6,CLEAR_ALL_STATE:7,GRIDS_SELECT_STATE:8,MARKERTYPE:9,CLUSTER:10,MAP_TYPE:11},T={MARKER:"1",BUBBLE:"2",POLYGON:"3",DENSITY:"4"},Q=mstrmojo.dom,S=mstrmojo.css,F;mstrmojo.gmaps._CanShowMapToolbar={_mixinName:"mstrmojo.gmaps._CanShowMapToolbar",callback:null,toolbar:null,EnumToolbarButtonType:{DRILL:1,SINGLE_SELECT:2,RECTANGLE_SELECT:4,EDIT_INFO_WINDOW:8,CLEAR_ALL:16,AFFINITY:32,FREE_SELECT:64,CIRCLE_SELECT:128,ZOOM:256,GRIDS_SELECT:512,KEEP_ONLY:1024,EXCLUDE:2048,SHOW_DATA:4096,SEARCH_BAR:8192,MAP_TYPE:16384},TOOLBAR_BUTTON_COUNT:14,layerChosen:[],formatPopupRef:null,googlemap:null,toolBarActive:false,metricSelectBox:null,mapTypeSelectBox:null,toolbar:null,$MSM:null,metricsString:"",metricData:[],mapTypeData:[],mapTypeSelList:null,markerSelected:false,getPropertyValue:function O(U,V){return this.toolbar.getPropertyValue(U,V);},getToolbar:function N(){return this.toolbar;},initMapToolbar:function C(V,Y,W,U,Z,a,X,b){if(this.toolbar){return ;}if(!this.toolbar){this.toolbar=new mstrmojo.gmaps.MapToolbar(U);this.toolbar.slot="toolBarDiv";this.addChildren(this.toolbar);}this.toolbar.initMapToolbar(V,Y,W,U,Z,a,X,b);return this.toolbar;},renderToolbar:function L(){if(!this.toolbar.hasRendered){this.toolbar.render();}this.toolbar.set("height","38px");var Y=175,U=60,Z=6,V=33,W=200,a=this.width-Y-U,X;X=W>a?a:W;X=V<X?X:V;this.toolbar.searchBarNode.style.width=X+"px";this.toolbar.rightToolbarNode.style.paddingLeft=X+Z+"px";},getToolbarState:function K(){return this.toolbar.state;},setToolbarState:function R(U){this.toolbar.setToolbarState(U);},setToolbarButtonState:function I(U,W,V){this.toolbar.setToolbarButtonState(U,W,V);},clearMarkerSelections:function B(){if(!this.toolbar){return ;}this.clearAllLayerSelections();this.doClearRectangle(true);this.set("markerSelected",false);this.toolbar.set("state",G.NORMAL_STATE);},onmarkerSelectedChange:function P(){this.setToolbarButtonState(this.EnumToolbarButtonType.CLEAR_ALL,"enabled",this.markerSelected);}};})();(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.date","mstrmojo.string");var B=mstrmojo.ValidationTextBox.prototype.markupMethods,D=mstrmojo.string,A=function(){return mstrmojo.locales.datetime;},C=mstrmojo.date;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,dynDateValue:null,showAdvanced:false,canSelectDisabledDate:false,isList:false,dtp:14,defaultDate:null,autoFormat:true,enabled:true,min:"",max:"",markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:B.onvalueChange,onenabledChange:B.onenabledChange,onvalidationStatusChange:B.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var H=this.opener,G=H&&H.calendarZIndex,I=this.cal,E=H&&H.calConfig;if(G){this.domNode.style.zIndex=G;}for(var F in E){I.set(F,E[F]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{showAdvanced:"this.parent.opener.showAdvanced",dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",dynDateValue:"this.parent.opener.dynDateValue",enabled:"this.parent.opener.enabled",min:"this.parent.opener.min",max:"this.parent.opener.max",canSelectDisabledDate:"this.parent.opener.canSelectDisabledDate",changeValueOnOK:function(){var F=this.parent.opener.dtp,E=this.parent.opener.changeValueOnOK;return F===15||F===16||E;}},closeOnValueChange:true,onValueUpdate:function(F){var I=this.parent&&this.parent.opener;if(I){var G=I.value,E=window.mstrConfig&&window.mstrConfig.listSep||";",H=I.dtp===15?C.formatTimeInfo(this.timeVal,A().TIMEOUTPUTFORMAT):this.value;if(I.isList&&!D.isEmpty(G)){I.set("value",I.value+E+H);}else{I.set("dynDateValue",this.dynDateValue);I.set("value",H);}I.closePopup();}}}]},onclick:function(E){var F=this._lastOpened,G=this._calendarConfig;if(!G){G={};if(this.calendarToBody){delete this.calendar.slot;G.placeholder=document.body.appendChild(document.createElement("div"));G.nudge=function(){var M=this.opener;if(M){var H=mstrmojo.dom.position(M.popupNode,true),L=this.domNode,P=L.offsetHeight,I=L.offsetWidth,J=mstrmojo.dom.windowDim(),K=H.x,N=H.y;if(N+P>=J.h){N=Math.max(N-P,0);}if(K+I>=J.w){K=Math.max(K-I,0);}var O=L.style;O.top=N+"px";O.left=K+"px";}};}this._calendarConfig=G;}G.lockIW=this;if(F&&F.visible){this.closePopup();}else{this.openPopup("calendar",G);this.calendar.cal.updateSelectedDate(true);}},unrender:function(){this._super();if(this.calendarToBody&&this._calendarConfig){delete this._calendarConfig;}if(this.calendar.hasRendered){this.calendar.unrender();}},_set_value:function(H,F){var G=this.value,E=(G!==F);if(E){this.value=F;this.validate(F);}if(this.showAdvanced&&this.dynDateChanged){this.dynDateChanged=false;E=true;}return E;},_set_dynDateValue:function(H,F){var G=this.dynDateValue,E=(G!==F);if(E){this.dynDateValue=F;this.dynDateChanged=true;}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.css","mstrmojo.registry","mstrmojo.AjaxCall","mstrmojo.hash","mstrmojo.array","mstrmojo.Arr","mstrmojo.expr","mstrmojo.dom","mstrmojo.mstr.EnumDataType","mstrmojo.Label","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.WidgetDial","mstrmojo.Calendar","mstrmojo.DateTextBox","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ValidationTextBox","mstrmojo.ui.CheckList","mstrmojo.ui._HasScroller","mstrmojo.ui.ColumnContainer","mstrmojo.elementHelper");var AT=mstrmojo.css,AM=mstrmojo.registry,M=mstrmojo.hash,c=mstrmojo.mstr.EnumDataType,K=mstrmojo.array,s=K.map,L=mstrmojo.Arr,AP=mstrmojo.expr,b=AP.ET,o=AP.ET2TP,AF=AP.ET2TGT,O=AP.FN,y=AP.FN_MRP,AN=AP.DTP,l=AP.DTP2FN_DTP,AI=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AU=AP.TP,W=AP.STP,U=mstrmojo.elementHelper;var Aa={};Aa[b.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};Aa[b.AL]={target:1,fm:1,fn:1,c0:1};Aa[b.AE]={target:1,fm:1,es:1};Aa[b.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};Aa[b.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};Aa[b.MC]=Aa[b.MQ];Aa["*"]={target:1};var B={};B[b.MQ]={key:"metricFns",def:AP.METRIC_FNS};B[b.MC]={key:"metricFns",def:AP.METRIC_FNS};B[b.AQ]={key:"formFns",def:AP.FORM_FNS};B[b.AL]={key:"formFns",def:AP.FORM_FNS};B[b.AC]={key:"formFns",def:AP.FORM_FNS};B[b.AE]={key:"elemFns",def:AP.ELEM_FNS};var AA=mstrmojo.desc(14084,"Select a filter option or a qualification."),z=mstrmojo.desc(14085,"Select one or more elements."),x=mstrmojo.desc(14086,"Select an operator."),w=mstrmojo.desc(14087,"Enter a value or select an attribute from the list."),u=mstrmojo.desc(14088,"Select an attribute form. When done, click ## button.").replace("##",'""'),t=mstrmojo.desc(14089,"Select a condition."),r=mstrmojo.desc(14090,"Enter a value or select a metric from the list.");var AL=0,AY=1;var H=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;function F(Af){var Ae=true,Ab=Af.model,Ac,Ad=Ab&&AP.fnCstCount(Ab.fn,Ab.fnt);if(!Ab){return ;}switch(Ab.et){case b.AQ:case b.AL:case b.MQ:for(Ac=0;Ac<Ad;Ac++){Ae=Ae&&!Af["invalid"+Ac];}break;}Af.okBtn.set("visible",Ae&&!!Ab.completed);}function J(){var Ac=this.parent,Ab=((Ac&&Ac.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=Ab&&Ab[0];}var Y="dummy",q={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:Y,css:"unselectable"},A={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:Y,css:"unselectable"},AW={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:Y,css:"unselectable"},AJ={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:Y,css:"unselectable"},a={did:"idAttribute",v:"idAttribute",n:mstrmojo.desc(518,"Attribute"),t:Y,css:"unselectable"},AE={did:"idMetric",v:"idMetric",n:mstrmojo.desc(517,"Metric"),t:Y,css:"unselectable"};function m(Ad){if(this.updating){return ;}var Ae=this.multiSelect,Ah=this.selectedItem,Ag=Ad&&Ad.added,Ai=Ad&&Ad.removed;if(!Ae&&Ag&&Ai&&Ag[0]===Ai[0]){return ;}if(Ah&&Ah[AI]===Y){this.updating=true;if(Ae){this.removeSelect([this.selectedIndex]);}else{var Ac=Ai&&Number(Ai[0]);Ac=(Ac==null)?-1:Ac;this.set("selectedIndex",Ac);}this.updating=false;}else{var Ab=this.parent.parent.parent.model;if(Ae){var Af=this.items;Ab.edit(this.alias,{added:Ag&&K.get(Af,Ag),removed:Ai&&K.get(Af,Ai),itemIdField:this.itemIdField});}else{Ab.edit(this.alias,Ah);}}}mstrmojo.rw.ConditionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.rw.ConditionList",allowUnlistedValues:true,itemIdField:"did",getItemProps:function AR(Af,Ab){var Ae=!!this.selectedIndices[Ab],Ag=Af.n,Ad=false;if(Af.t===12){var Ac=K.filter(Af.fs,function(Ah){return Ah.fgr>0;});if(Ac.length>0){Ad=true;}}return M.copy({cls:(Ae?mstrmojo._IsList.SELECTED_CLS:"")+" "+(Af.css||"")+" "+(Af.t?("t"+Af.t+((Af.da||Af.um)?"d":"")+(Ad?"g":"")+(Af.st?(" st"+Af.st):"")):""),n:Ag||"&nbsp;"},this._super(Af,Ab));},onselectionChange:function p(Ab){this._super(Ab);m.call(this,Ab);}});function AD(Ad,Af,Ac){var Ae=Ad.items,Ab=K.indexOf(Ae,Af);if((Ab===0)&&(Ae.length===1)){Ac=mstrmojo.Arr.makeObservable((Ac&&Ac.length)?Ac.concat():[]);Ad.set("items",Ac);}else{if(Ab>-1){Ae.splice(Ab,1);}if(Ac&&Ac.length){K.insert(Ae,(Ab>-1)?Ab:Ae.length,Ac);}Ad.refresh();}}function N(Ab){return mstrmojo.mixin(Ab,{scriptClass:"mstrmojo.rw.ConditionList",cssClass:"mstrmojo-"+Ab.alias,postCreate:J});}function V(Ad,Ab,Ae){var Ac=Ad.cfg;if(Ac){Ac.data=Ad;Ac.parent=Ae;return AM.ref(Ac);}Ac=new mstrmojo.Label({text:Ad.n||"&nbsp;",cssClass:"dial-item "+(Ad.t?("t"+Ad.t):"")});Ac.markupMethods.onselectedChange=function(){AT.toggleClass(this.domNode,["selected"],this.selected);};Ac.data=Ad;Ac.parent=Ae;return Ac;}function f(Ac,Ab){var Ad=Ab+AP.FN_SEP+Ac;return(Ac!=null)?{did:Ad,n:Ad}:null;}function AX(Ab){return Ab.targets?K.filter(Ab.targets,function(Ac){return Ac[AI]===AP.TP.ATTR;}):[];}function Q(Ad,Ac,Ae,Ah){Ad.updating=true;if(Ac){if(Ae!=null){Ad.clearSelect();Ad.set("items",Ae);}var Ag=Ad.itemIdField,Af=Ad.selectedItem;if((Af&&Af[Ag])!=(Ah&&Ah[Ag])){var Ab=Math.max(K.indexOf(s((Ae||[]),function(Ai){return Ai[Ag];}),Ah&&Ah[Ag]),0);Ad.set("selectedIndex",Ab);}}Ad.updating=false;}function AQ(Ab,Ac,Ae,Ad){Ab.updating=true;Ab.clearSelect();K.forEach(Ac,function(Af){Af.title=Af.title||Af.n||"";});if(Ac){Ab.set("items",Ac);}if(Ae&&Ae.length){Ab.setSelectedItems(Ae);}else{if(Ad&&Ad.length){Ab.select(Ad);}}Ab.updating=false;}function AH(Ac,Ab,Ad,Af,Ae){if(Ab){AQ(Ac,Ad,Af,Ae);}}function AG(Ad,Ac){var Ab=Ad.model||{},Ae=Ab.fn;return(Ae!=null)&&((Ab.et===b.MQ)||(Ab.et===b.MC)||(Ab.et===b.AQ)||(Ab.et===b.AL)||(Ab.et===b.AC))&&(AP.fnCstCount(Ae,Ab.fnt)>Ac);}var e={};e[AN.DATE]=1;e[AN.TIME]=1;e[AN.TIMESTAMP]=1;function n(Ab,Ad){var Ac;if(Ad){switch(AF[Ab.et]){case"a":Ac=Ad[b.AC];break;case"m":Ac=Ad[b.MC];break;default:Ac=false;break;}}else{Ac=true;}return Ac&&AP.fn_AC_MC(Ab&&Ab.fn);}function k(Ac){var Af=Ac&&o[Ac.et],Ae=Ac&&Ac.fm&&Ac.fm.dtp,Ab=Ae&&AP.DTP2PROMPT_STP[Ae],Ad={};Ad[Af]=true;if(Ab){Ad[Ab]=true;}return Ad;}function d(Ab){switch(Ab){case c.DataTypeInteger:case c.DataTypeUnsigned:case c.DataTypeDecimal:case c.DataTypeReal:case c.DataTypeDouble:case c.DataTypeFloat:return c.DataTypeNumeric;default:return Ab;}}function C(Ac){var Ae=Ac.model,Aj=Ae&&Ae[AF[Ae.et]]&&Ae[AF[Ae.et]][Ac.columnWalk.target.itemIdField],Ad=Ae&&Ae.fm,Ab=Ad&&Ad.dtp,Ag=n(Ae,Ac.ets);if(this.targetsLastMod&&this.targetsLastMod===Ac.targetsLastMod&&Aj&&Aj===this._lastTargetId&&this.lastFmDtp===Ab&&this.lastFnTp===Ag){return ;}if(!Ag){this.clearSelect();this.set("items",this.items.slice(0,this.preLen));}else{var Ah=k(Ae),Ak=Ae[AF[Ae.et]],Af=Ae.a?[a]:Ae.m?[AE]:[],Al=Af.concat(AP.getSortedObjectsByTypeGroup(K.filter(Ac.targets,function(Am){return(Am.t!==4||Am.did!==Ak.did)&&(Ah[Am[AI]]||Ah[Am[P]]);}))),Ai=this.items.slice(this.preLen);K.forEach(Ai.reverse(),function(Am){this.remove(Am);},this);this.add(Al,-1);}this._lastTargetId=Aj;this.lastFnTp=Ag;this.lastFmDtp=Ab;this.targetsLastMod=Ac.targetsLastMod;}function AK(Au,Al){Au.updating=true;var Ah=Au.parent.parent.parent,At=AG(Ah,Al),An,Ap;if(At){var Ad=Ah.model||{},Af=Ad.cs,Ar=Af&&Af[Al],Ak=Ar&&Ar.v,Ai;C.call(Au,Ah);switch(Ad.et){case b.MQ:case b.MC:Ai=(Ar&&Ar.dtp)||d(Ad.m.dt)||AP.METRIC_DTP;break;case b.AQ:case b.AC:case b.AE:Ai=Ad.fm&&Ad.fm.dtp;break;case b.AL:Ai=Ad.fm&&Ad.fm.dtp;Ak=[];for(An=0,Ap=Af&&Af.length;An<Ap;An++){Ak.push(Af[An].v);}Ak=Ak.join(mstrConfig.listSep);break;}Ai=Ai||AN.CHAR;var Ag=Ad.fn,Am=AP.fn_List(Ag,Ad.fnt),Ao=e[Ai],Aq=Ao&&!Am;var Ac=Au.ctxtBuilder,Ab=Ac&&Ac.itemWidgets,As=Ao?(Aq?Au.calIndex:Au.dtxtIndex):Au.txtIndex,Ae;for(An=0,Ap=Au.preLen;An<Ap;An++){Ae=Ab[An];if(An==As){Ae.set("dtp",Ai);Ae.set("isList",Am);Ae.set("value",Ak);Ae.set("visible",true);try{if(Au.alias!=="c1"){Ae.focus&&Ae.focus();}}catch(Aj){}if(Ag===1||Ag===2){Ae.constraints.min=0;}if(Ae.clearValidation){Ae.clearValidation();}}else{Ae.set("visible",false);}if(Am){Ae.set("hint",mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"));}else{Ae.set("hint","");}}if(Ah.hasPrompt&&Au.selectedItem&&Au.selectedItem.st===AP.STP.PROMPT_STRING){Ah.invalid0=false;}switch(Ad.et){case b.AQ:case b.AL:case b.MQ:if(Ar&&Ar.p){Au.set("selectedItem",Ar.p);}else{Au.set("selectedIndex",As);}break;case b.MC:case b.AC:Au.set("selectedItem",Ad[AF[Ad.et]+(2+Al)]);break;}}Au.updating=false;}function h(){var Ae=this.parent,Ac=Ae.parent.parent.parent,Ad=(this.isValid&&this.isValid())||(!this.isValid&&!mstrmojo.string.isEmpty(this.value)),Ab=Ac.model;Ac["invalid"+Ae.cstIndex]=!Ad;if(!this.updating&&Ad){this.updating=true;if(Ab){Ab.edit(Ae.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}F(Ac);}function AS(){var Ac=this.parent,Ab=Ac.parent;Ab["invalid"+Ac.cstIndex]=false;}function AC(Ab){this.tip.set("text",Ab);}function D(Ad){var Af=this.selectedItem;Ad=K.filter(Ad,function(Ag){return(!Ag.icf);});if(Af){var Ac=K.find(Ad,this.itemIdField,Af[this.itemIdField]);if(Ac>-1){Ad=Ad.concat();Ad.splice(Ac,1);}}AD(this,A,Ad);var Ae=this.items,Ab=Ae.length;if(Ab===1){this.singleSelect(0);}this.parent.updateScrollbars();}function I(Ac){var Ab=[{did:660,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP|mstrmojo.validation.TRIGGER.VALUESET},onValid:h,onInvalid:h,onClearValidation:AS,size:6,visible:false}},{did:154,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:h,visible:false}},{did:23,cfg:{scriptClass:"mstrmojo.DateTextBox",cssText:"margin-left:9px;",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:h,onInvalid:h,onClearValidation:AS,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(Ad){mstrmojo.dom.stopPropogation(Ad.hWin,Ad.e);}},visible:false}}];return N(M.copy(Ac,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:V,selectionPolicy:"reselect",items:Ab.concat(),txtIndex:0,calIndex:2,dtxtIndex:2,preLen:Ab.length,insertUnlistedValuesAt:-1,itemIdField:"did",update:function(){AK(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},itemsEffect:undefined,onchange:m}));}function G(Ab){return N(M.copy(Ab,{insertUnlistedValuesAt:-1,postCreate:function(){J.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var Ad=this.parent,Ac=this.response;if((Ac&&Ac.did)!==Ad.lastAttrId){return ;}D.call(this.parent,Ac.fms||[]);},onerr:function(){AD(this.parent,A,[q]);}});},update:function(){var Am=this.fmPost,Ae=this.parent.parent.parent,Ag=Ae.model,Al=Ag&&Ag["a"+Am],Aj=!!Al,Af,Ai,An,Ad=Ae.disableElementsBrowsing,Ac=Al&&Ad&&Ad(Al);if(Aj){switch(Ag.et){case b.AQ:case b.AL:Ai=Ag.fm;break;case b.AC:Ai=Ag["fm"+Am];break;case b.AE:Ai=f(Ag.fn,1);break;}if(this.lastAttrId!==Al.did){this.lastAttrId=Al.did;Af=[];if(this.isFirstFm){if(!Ac&&(!Al.ilk&&(!Ae.ets||Ae.ets[b.AE]))){Af.push(AW);var Ah=B[b.AE],Ak=Ah&&Ah.key;Af=Af.concat((Ak&&Ae[Ak])||Ah.def||[]);}Af.push(AJ);}if(Ai&&(Ag.et!==b.AE)){Af.push(Ai);}An=this.ajx;An.params.attributeId=Al.did;An.params.otp=Al.t||12;Af.push(A);L.makeObservable(Af);}}if(Ac&&Ag.et===b.AE){Ai=null;}Q(this,Aj,Af,Ai);if(Aj&&An){if(Ae.getAttributeForms){D.call(this,Ae.getAttributeForms(Al.did)||[]);}else{if(Al.fms){D.call(this,Al.fms);}else{if(An){if(An._delayId){window.clearTimeout(An._delayId);delete An._delayId;}An._delayId=window.setTimeout(function(){delete An._delayId;An.send();},500);}}}}}}));}var AB=[AP.STP.PROMPT,AP.STP.PROMPT_OBJECTS,AP.STP.PROMPT_ELEMENTS,AP.STP.PROMPT_EXPRESSION,AP.STP.PROMPT_EXPRESSION_DRAFT];function Z(Ab){if(Ab&&!M.isEmpty(Ab)){var Ac=K.hash(AB);M.forEach(Ab,function(Ae,Ad){if(Ae){Ac[o[Ad]]=true;}});return Ac;}return null;}mstrmojo.rw.ConditionWalkProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.rw.ConditionWalkProvider",browseEs:function S(Ae,Ad,Ag){Ae.openPopup("eb",{zIndex:Ae.parent.zIndex+10,left:Math.round(Ag.x)+"px",top:Math.round(Ag.y)+"px"});var Ac=Ae.eb.browser,Ab=Ae.model,Af=Ab&&Ab.a&&Ab.a.did;if(!Af){return ;}Ac.set("attributeID",Af);Ac.set("selectedItems",Ab.es?M.clone(Ab.es):[]);Ac.initBrowser();},browseObjs:function AV(Ai,Ab,Ac){Ai.openPopup("ob",{zIndex:Ai.parent.zIndex+10,left:Math.round(Ac.x)+"px",top:Math.round(Ac.y)+"px"});var Ad=Ai.ob.browser;Ad.target=Ab;var Ae;switch(Ab.alias){case"dmy":Ae=[AP.TP.ATTR,AP.TP.DIM];break;case"c0":case"c1":var Ag=Ai.model,Af=Ag&&Ag.et,Aj=Ag&&Ag.fm,Ah=Aj&&Aj.dtp||(Ag.m?AP.DTP.DECIMAL:AP.DTP.UNKNOWN);Ae=(Af===b.MQ||Af===b.MC)?[AP.TP.METRIC,AP.DTP2PROMPT_STP[Ah]]:[AP.TP.ATTR,AP.DTP2PROMPT_STP[Ah]];break;default:Ae=Z(Ai.ets);Ae=Ae?M.keyarray(Ae,true):[AP.TP.ATTR,AP.TP.METRIC,AP.STP.REPORT_GRID,AP.STP.REPORT_GRAPH,AP.STP.REPORT_ENGINE,AP.STP.REPORT_TEXT,AP.STP.REPORT_DATAMART,AP.STP.REPORT_BASE,AP.STP.REPORT_GRIDGRAPH,AP.STP.REPORT_NONINTERACTIVE,AP.STP.FILTER].concat(AB);}Ae[Ae.length]=AP.TP.FOLDER;Ad.browse({rootFolderType:Ag&&(Ag.et===b.MQ||Ag.et===b.MC)?5:26,folderLinksContextId:33,onSelectCB:[Ai,"onOBSelect"],browsableTypes:Ae.join(",")});},getFm2NodeProps:function AO(){return{alias:"fm2",children:[G({alias:"fm2",fmPost:2})],updateColumnContainer:function Ab(){var Ac=this.parent.parent;this.fm2.update();AC.call(Ac,u);H.call(this);}};},getC0NodeProps:function E(){var Ab=this;return{alias:"c0",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},I({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},I({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false}],updateColumnContainer:function Ac(){this.c0.update();var Af=this.parent,Ah=Af.parent,Ai=Af.parent.model,Ak=Ai&&Ai.fn,Ag=Ak===O.BETWEEN||Ak===O.NOT_BETWEEN||Ak===y.BETWEEN||Ak===y.BETWEEN_DESCENDING,Ae=Ak===O.EQUAL||Ak===O.NOT_EQUAL||Ak===O.GREATER||Ak===O.GREATER_EQUAL||Ak===O.LESS||Ak===O.LESS_EQUAL,Ad=this.idx,Aj=this.next;this.browseLink.set("visible",Ah.objectBrowsingEnabled&&n(Ai,Ah.ets));this.btwn.set("visible",Ag);this.c1.set("visible",Ag);if(Ag){this.c1.update();}else{Ai.edit("c1",{v:null,dtp:null,skipET:true});}if(Ai.a2&&Ae){if(!(Aj&&Aj.fm2)){Af.insertAndRemoveTrailing(Ad,Ab.getFm2NodeProps());}}else{Af.removeTrailingContainer(Ad);}AC.call(Ah,Ai.a?w:Ai.m?r:"");H.call(this);}};},getFnNodeProps:function AZ(){var Ab=this;return{alias:"fn",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(9579,"Condition")},G({alias:"fn",allowUnlistedValues:false,update:function(){var Ai=this.parent.parent.parent,Ae=Ai.model||{},Aj=Ae.et,Ah,Ak=false,Al,Ad;switch(Aj){case b.AE:Ak=!!Ae.a;break;case b.AQ:case b.AC:case b.AL:Ak=!!(Ae.fm&&Ae.fm.did);Ah=Ak?Ae.fm.dtp:null;break;case b.MQ:case b.MC:Ak=!!Ae.m;Ah=Ak?AP.METRIC_DTP:null;break;}if(Ak){var Am=l[Ah];if((this.lastEt!==Aj)||(this.lastFnDtp!==Am)){this.lastEt=Aj;this.lastFnDtp=Am;var Ag=Aj?B[Aj]:null,Af=Ag&&Ag.key;Al=(Af&&Ai[Af])||Ag.def||[];if(typeof (Al)==="object"){Al=Al[Am]||Al["*"];}}Ad=f(Ae.fn,Ae.fnt||1);}Q(this,Ak,Al,Ad);this.parent.updateScrollbars();}})],updateColumnContainer:function Ac(){this.fn.update();var Ad=this.parent,Ae=Ad.parent,Af=Ae.model,Ah=Af&&Af.fn,Ag=this.next,Ai=Ah===O.IS_NULL||Ah===O.IS_NOT_NULL;if(Ah&&Ai){Ad.removeTrailingContainer(this.idx);}else{if(Ah&&!(Ag&&Ag.c0)){Ad.insertAndRemoveTrailing(this.idx,Ab.getC0NodeProps());}}AC.call(Ae,Af.a?x:Af.m?t:"");Ag=this.next;if(Ag){Ag.updateColumnContainer();}}};},getEsNodeProps:function T(){var Ad=[{scriptClass:"mstrmojo.ui.CheckList",alias:"es",itemIdField:"v",allowUnlistedValues:true,insertUnlistedValuesAt:0,selectionPolicy:"toggle",postCreate:function Ac(){J.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var Ao=this.parent,Ai=this.response;if((Ai&&Ai.did)!==Ao.lastAttrId){return ;}var Ak=(Ai&&Ai.es)?K.filter(Ai.es,function(Ap){return !U.isNullElem(Ap.v);}):[],An=Ao.parent.parent.parent.model&&Ao.parent.parent.parent.model.es,Al=function(Av,Aq){var Au=Av&&Av.length||0,At=Aq&&Aq.length||0,Ap=[],As,Ar;for(As=0;As<At;As++){for(Ar=0;Ar<Au;Ar++){if(Aq[As].n===Av[Ar].n){break;}}if(Ar===Au){Ap.push(Aq[As]);}}return Ap;},Am=function(Ap,Aq,At){var As=[],Ar;K.forEach(Ap,function(Au){Ar=K.filterOne(Aq,function(Av){return Au[At]&&Av[At]&&Au[At]===Av[At];});if(Ar){As.push(Ar);}});return As.length===Ap.length?As:Ap;};An=An&&Am(An,Ak,"v");if(Ao.allowUnlistedValues){var Aj=Al(Ak,An);Ak=(Ao.insertUnlistedValuesAt===0)?Aj.concat(Ak):Ak.concat(Aj);}AQ(Ao,Ak,An,null);Ao.parent.updateScrollbars();},onerr:function(){AD(this.parent,A,[q]);}});},onselectionChange:function Ag(Ai){mstrmojo.ListBase.prototype.onselectionChange.call(this,Ai);m.call(this,Ai);},update:function Af(){var Al=this.parent.parent.parent,Ak=Al.model,Ap=Ak&&Ak.a,Aq=!!Ap&&!Ap.ilk,Ar,Ai,Ao,Am,Aj,As;if(Aq){if(this.lastAttrId!==Ap.did){this.lastAttrId=Ap.did;Ar=Ak.es;Am=Ar&&Ar.length;Ar=Am?Ar.concat():[];Ar.push(A);if(Am){Ao=[];for(Aj=1;Aj<=Am;Aj++){Ao[Aj]=Aj;}}As=this.ajx;Al.updateBrowseElementsParams(As.params,Ap);}else{Ai=Ak.es;}}AH(this,Aq,Ar,Ai,Ao);if(Aq&&As){if(Al.getElements){var An=this;Al.getElements(Ap,{success:function(At){AQ(An,At.es||[],Al.model&&Al.model.es,null);An.parent.updateScrollbars();},failure:function(){AD(An,A,[q]);}});}else{As.send();}}},setupScrollNodes:function Ae(){this.scrollNode=null;}}];if(!mstrApp.isSingleTier){Ad.splice(0,0,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7928,"Browse elements..."),onclick:function Ab(){this.parent.parent.parent.browse(this.parent.es);}});}return{alias:"es",children:Ad,updateList:function(Ai){AH(this.es,true,Ai,this.parent.parent.model.es,null);this.updateScrollbars();},updateColumnContainer:function Ah(){var Ai=this.parent.parent;this.es.update();AC.call(Ai,z);}};},getFmNodeProps:function g(){var Ab=this;return{alias:"fm",children:[G({alias:"fm",fmPost:"",filter:false,isFirstFm:true})],updateColumnContainer:function Ac(){this.fm.update();var Am=this.parent,Ah=Am.parent,Ag=Ah.model,Aj=Ag&&Ag.fm,Al=this.idx,Ak=Ag&&Ag.a,Ae=Ah.disableElementsBrowsing,Ad=Ak&&Ae&&Ae(Ak);var Ai=(Ag.etWas&&Ag.etWas===b.AE)?AY:AL,Af=AL;if(Ag.et===b.AE&&!Ad){Af=AY;}if(Ai!==Af||Af===AL){Am.removeTrailingContainer(Al);if(Af===AL&&Aj){Am.addNextColumn(Ab.getFnNodeProps());}else{if(Af===AY){Am.addNextColumn(Ab.getEsNodeProps());}}}AC.call(Ah,AA);H.call(this);}};},getTargetNodeProps:function R(){var Ab=this;return{alias:"target",target:null,browseLink:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(11859,"Based On")},N({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},onObjBrowsed:function(Ae){if(Ae.st===W.FILTER||Ae.t===AU.REPORT||Ae.t===AU.PROMPT){this.parent.parent.parent.onOK();}},update:function Ad(){var Af=this.parent.parent.parent,Ag=Af.model,Aj=Af.targetsLastMod,Ak=Ag&&Ag.et;if(this.lastModel!==Ag||this.targetsLastMod!==Aj){this.lastModel=Ag;this.targetsLastMod=Aj;var Ae=Af.targets,Al=Af.ets;if(Al&&Ae&&Ae.length){var Ai=Z(Af.ets);Ae=K.filter(Ae,function(Am){return Ai[Am[AI]];});}var Ah=Ag&&Ag[AF[Ak]];Q(this,true,AP.getSortedObjectsByTypeGroup(Ae),Ah);this.parent.updateScrollbars();}}}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.target);}}],updateColumnContainer:function Ac(){this.target.update();var Af=this.parent,Ag=Af.parent,Ah=Ag.model,Aj=Ah&&Ah.et,Ae=this.idx,Ai=this.next;this.browseLink.set("visible",Ag.objectBrowsingEnabled);if(Aj){switch(Aj){case b.AQ:case b.AL:case b.AC:case b.AE:if(Ah.a&&!(Ai&&Ai.fm)){this.parent.insertAndRemoveTrailing(Ae,Ab.getFmNodeProps());}break;case b.MQ:case b.MC:if(Ah.m&&!(Ai&&Ai.fn)){this.parent.insertAndRemoveTrailing(Ae,Ab.getFnNodeProps());}break;case b.R:case b.F:case b.XML:this.parent.removeTrailingContainer(Ae);break;}}Ai=this.next;if(Ai){Ai.updateColumnContainer();}}};}});var X=mstrmojo.rw.ConditionWalkProvider;X.updateOkBtn=F;X.setTip=AC;X.getChildJSON=N;X.updateList=Q;X.fmJson=G;X.cstJson=I;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.array","mstrmojo.hash","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton");var L=mstrmojo.emptyFn,I=mstrmojo.array,C=mstrmojo.hash,E=mstrmojo.gm.EnumCombinedLineStyle;var J={LINE_COLOR:"Clr",LINE_STYLE:"Style"},A={"1pt solid":E.THIN,"2pt solid":E.THICK,"1pt dashed":E.DASHED,"1pt dotted":E.DOTTED,none:E.NONE};function D(P,O){return C.copy(O,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"lineColor",slot:P,selectedValue:"#000000",postselectedValueChange:function(Q){if(this.propName){this.parent.parent.raiseFormatValueChange(this.propName,Q.value,Q.valueWas);}},postclick:function(Q){this.parent.parent.postclick(Q);}});}function K(P){return{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:true,showNoneOption:true,defaultSelectedIndex:3,propName:undefined,alias:"lineStyle",slot:P,postInit:function O(){var Q=["mstrmojo-ui-LineStyle"];if(!this.showNoneOption){Q.push("no-none");}mstrmojo.css.addWidgetCssClass(this,Q);(this.list.items||[]).forEach(function(R){R.v=(A[R.id]!==undefined?A[R.id]:A["not defined"]);});},onshowNoneOptionChange:function(Q){var R=["no-none"];if(!Q.value){mstrmojo.css.addWidgetCssClass(this,R);}else{mstrmojo.css.removeWidgetCssClass(this,R);}var S=this.hasRendered;if(S){this.refresh();}},postselectedValueChange:function(R){this._super();var Q=I.find(this.list.items,"id",R.value);if(Q===-1){Q=this.defaultSelectedIndex;}var S=this.list.items[Q].v;if(this.propName){this.parent.parent.setChildEnable(J.LINE_COLOR,S!==A.none);this.parent.parent.raiseFormatValueChange(this.propName,S,A[R.valueWas]);}},postclick:function(Q){this.parent.parent.postclick(Q);}};}mstrmojo.ui.editors.controls.LineConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.LineConfigGroup",propNames:undefined,postclick:L,hideColorControl:false,showGradient:false,showNoFillInColor:true,showAutomaticInColor:false,showNoneOption:true,lineColorAndStyle:undefined,lineTitle:undefined,init:function N(Q){this._super(Q);var O=[],R;O.push(K("col1Node"));if(!this.hideColorControl){O.push(D("col2Node",{showGradient:this.showGradient,showNoFill:this.showNoFillInColor,showAutomatic:this.showAutomaticInColor}));}else{R={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}var P=[];if(this.lineTitle&&this.lineTitle!==""){P.push(new mstrmojo.Label({text:this.lineTitle}));}P.push(C.copy(R,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"lineColorAndStyle",children:O}));this.addChildren(P);},getChildComp:function M(O){if(O.indexOf(J.LINE_COLOR)!==-1){return this.lineColorAndStyle.lineColor;}if(O.indexOf(J.LINE_STYLE)!==-1){return this.lineColorAndStyle.lineStyle;}return null;},iniChildrenComp:function G(P){I.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);var O=this.lineColorAndStyle.lineStyle;O.showNoneOption=this.showNoneOption;O.postInit();},onshowNoneOptionChange:function(O){this.lineColorAndStyle.lineStyle.set("showNoneOption",O.value);},setChildValue:function F(Q,R){var O=this.getChildComp(Q);if(O===undefined){return false;}var P;switch(O.alias){case"lineColor":if(R!==O.selectedValue){O.set("selectedValue",typeof R==="undefined"?"conflict":R);}break;case"lineStyle":if(typeof R==="undefined"){O.list.clearSelect();this.syncControls(function(){O.set("selectedValue","conflict");});}else{P=I.find(O.list.items,"v",R);if(P===-1){P=O.defaultSelectedIndex;}var S=O.list.items[P].id;if(S!==O.selectedValue){O.set("selectedValue",S);}}break;}},setChildEnable:function H(Q,P){var O=this.getChildComp(Q);if(O!==undefined){O.set("enabled",P);}},setChildrenValue:function B(O){O.forEach(function(P){this.setChildValue(P[0],P[1]);});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Pulldown","mstrmojo.ui.ButtonBar","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.NumGroupStepperContentProvider","mstrmojo._FormatDefinition","mstrmojo.models.FormatModel");var F=mstrmojo._FormatDefinition,R=mstrmojo.models.FormatModel,J=R.ENUM_PROPERTY_NAMES,I=1,E=2,N=4,C=8,H=16;var P;var K;var G={bold:J.FONT_WEIGHT,italic:J.FONT_STYLE,underline:J.UNDERLINE,strikeout:J.LINE_THROUGH};function B(S){return(S&H)>0;}function Q(T){var W=J.FONT_FAMILY,S=T[W]||R.getFormatBlockValue(T,W),U=this.hcgControls.fontFamily;if(S===-1){var V=U&&U.list;if(!V){return ;}V.clearSelect();delete U.selectedIndex;if(U.hasRendered){U.refresh();}}else{U.set("selectedIndex",Math.max(K.map(function(X){return X.n;}).indexOf(S)));}}function O(S){var T=[],U=function(X,Y,V){var W=S[X];if(W===undefined){W=R.getFormatBlockValue(S,X);}if(W){T.push(V);}};U(J.FONT_WEIGHT,"bold",0);U(J.FONT_STYLE,"italic",1);U(J.UNDERLINE,"underline",2);U(J.LINE_THROUGH,"line-through",3);this.hcgControls.fontStyle.select(T);}function L(S){var Y=this.hcgControls,V=J.FONT_SIZE,T=J.COLOR,X=S[V]||R.getFormatBlockValue(S,V),U=Y.fontSize;var W=S[T];if(typeof W==="undefined"||W===null){W=R.getFormatBlockValue(S,T);}if(typeof W==="undefined"||W===null){W="";}if(B(this.visibleControls)){if(X.length){U.provider.set("curValGroup",X);}}else{if(X===-1){U.list.clearSelect();U.selectedValue="";U.updatePreview();}else{U.set("selectedValue",X?(parseInt(X,10)).toString():U.items[0].n);}}Y.fontColor.set("selectedValue",W===""?"conflict":R.decodeValue(J.COLOR,W));}function M(){if(P&&K){return ;}P=F.SizesInVI.map(function(S){return{idx:parseInt(S.n,10),n:S.n};});K=mstrmojo._FormatDefinition.Families.slice(1).map(function(S){return{n:S.n,id:S.n};});}mstrmojo.ui.editors.controls._HasCharacterGroup=mstrmojo.provide("mstrmojo.ui.editors.controls._HasCharacterGroup",{_mixinName:"mstrmojo.ui.editors.controls._HasCharacterGroup",visibleControls:I+E+N,showNoFillInColor:true,hcgControls:null,getHCGControls:function D(U){M();var T=this.hcgControls={},S=this.visibleControls;if((S&I)>0){T.fontFamily=mstrmojo.ui.Pulldown.newPulldown(K,function(W,X){U(J.FONT_FAMILY,W.id,X&&X.id);},0,{isHostedWithin:false});}if((S&E)>0||(S&C)>0){var V=T.fontStyle=new mstrmojo.ui.ButtonBar({multiSelect:true,items:[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}],postselectionChange:function(W){var Y=W.added,Z=this.items[Y?Y[0]:W.removed[0]],X=!!Y;if(Z){U(G[Z.css],X,!X);}}});if((S&C)>0){V.items.pop();}}if((S&N)>0){T.fontSize=B(S)?new mstrmojo.ui.editors.controls.Stepper({provider:new mstrmojo.NumGroupStepperContentProvider({item:{interval:1},curValGroup:[],min:Math.min.apply(Math,P.map(function(W){return W.idx;})),max:Math.max.apply(Math,P.map(function(W){return W.idx;})),container:this,onTraverse:function(){var W=this.container.fontSize;if(W._sync){return ;}this.container.raiseFormatValueChange(J.FONT_SIZE,W.provider.getValGroup());},oncurValGroupChange:function(){var W=this.container.fontSize;if(W.textNode){W.updateDisplayText();}}})}):new mstrmojo.ui.editors.controls.ComboBox({selectedValue:"10",items:P,isHostedWithin:false,validateTextInput:function(W){return(/^[0-9]+(pt)?$/.test(W));},updateSelection:function(){this.set("selectedValue",parseInt(this.txtLabel.value,10).toString());},postselectedValueChange:function(W){U(J.FONT_SIZE,parseInt(W.value,10)+"pt",parseInt(W.valueWas,10)+"pt");}});T.fontColor=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:this.showNoFillInColor,selectedValue:"#000000",postselectedValueChange:function(W){U(J.COLOR,W.value,W.valueWas);}});}return T;},setFormatSource:function A(S){var T=this;this.syncControls(function(){var U=this.visibleControls;if((U&I)>0){Q.call(T,S);}if((U&E)>0||(U&C)>0){O.call(T,S);}if((U&N)>0){L.call(T,S);}});}});mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS={FONT_FAMILY:I,FONT_STYLE:E,FONT_SIZE_AND_COLOR:N,FONT_STYLE_NO_STRIKEOUT:C,FONT_SIZE_USE_STEPPER:H};mstrmojo.ui.editors.controls._HasCharacterGroup.ControlsType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.hash","mstrmojo.array","mstrmojo.ValidationTextBox","mstrmojo.expr");var K=mstrmojo.emptyFn,B=mstrmojo.hash,H=mstrmojo.array,I=mstrmojo.expr.DTP,F={FILL_COLOR:"Clr",FILL_TRANSPARENT:"FillTrans"},C=1,J=2;function N(T,Q,P,S,R){return{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",alias:"fillColor",slot:T,showNoFill:S!==false,showAutomatic:!!R,showGradient:P!==false,selectedValue:"#000000",isHostedWithin:Q||false,postselectedValueChange:function(U){if(this.propName&&this.parent&&this.parent.parent){this.parent.parent.raiseFormatValueChange(this.propName,U.value,U.valueWas);}},postclick:function(U){this.parent.parent.postclick(U);}};}function O(Q){return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillAlpha",slot:Q,col1Width:"100%",col2Width:"10px",children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"fillAlphaText",slot:"col1Node",value:"100",cssText:"text-align:right",dtp:I.INTEGER,required:true,constraints:{min:0,max:100},onvalueChange:function(R){this.valueWas=R.valueWas;},onValid:function P(){if(this.propName&&this.value!==this.valueWas){this.parent.parent.parent.raiseFormatValueChange(this.propName,this.value,this.valueWas);}},postclick:function(R){this.parent.parent.parent.postclick(R);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:"%"}]};}mstrmojo.ui.editors.controls.FillConfigGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.FillConfigGroup",propNames:undefined,postclick:K,visibleControls:C+J,fillColorAndTrans:undefined,init:function M(T){this._super(T);var Q=[],W="col1Node",R=T&&T.colorPickerHostWithin,P=T&&T.showGradient,V=T&&T.showNoFill,S=T&&T.showAutomaticInColor,U;if((this.visibleControls&C)>0){Q.push(N(W,R,P,V,S));W="col2Node";}if((this.visibleControls&J)>0){Q.push(O(W));}if(Q.length===1){U={col1Width:"100%",dividerWidth:"0",col2Width:"0"};}this.addChildren([B.copy(U,{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"fillColorAndTrans",children:Q})]);},getChildComp:function L(P){if(P.indexOf(F.FILL_COLOR)!==-1){return this.fillColorAndTrans.fillColor;}if(P.indexOf(F.FILL_TRANSPARENT)!==-1){return this.fillColorAndTrans.fillAlpha.fillAlphaText;}return undefined;},iniChildrenComp:function E(P){this.propNames=P;H.forEach(P,function(R){var Q=this.getChildComp(R);if(Q!==undefined){Q.propName=R;}},this);},setChildValue:function D(Q,R){var P=this.getChildComp(Q);if(P===undefined){return false;}switch(P.alias){case"fillColor":if(R!==P.selectedValue){P.set("selectedValue",R==="undefined"?"conflict":R);}break;case"fillAlphaText":if(R!==P.value){P.set("value",R==="undefined"?"":R);}break;}},setChildEnable:function G(R,Q){var P=this.getChildComp(R);if(P!==undefined){P.set("enabled",Q);}},setChildrenValue:function A(P){P.forEach(function(Q){this.setChildValue(Q[0],Q[1]);});}});mstrmojo.ui.editors.controls.FillConfigGroup.CTRL_FLAGS={FILL_COLOR:C,FILL_TRANSPARENCY:J};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.css");mstrmojo.ui.editors.controls.CharacterGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,[mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",init:function A(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var H=this,C=this.getHCGControls(function(K,L,J){if(!H._sync){H.raiseFormatValueChange(K,L,J);}}),D=[];Object.keys(C).forEach(function(J){this[J]=C[J];}.bind(this));var B=this.fontFamily,I=this.fontStyle,G=this.fontSize,F=this.fontColor;if(B){D.push(B);}if(I){D.push(I);}if(G){G.slot="col1Node";F.slot="col2Node";D.push({scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[G,F]});}if(D.length){this.addChildren(D);}}});mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS=mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo.ui.ColumnWalk","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ConditionModel","mstrmojo.rw.ConditionWalkProvider");var P=mstrmojo.Widget,H=mstrmojo.array,E=mstrmojo.dom,M=mstrmojo.hash,A=mstrmojo.mstr.EnumNodeDimty,S=mstrmojo.rw.ConditionWalkProvider.updateOkBtn,I=mstrmojo.rw.ConditionWalkProvider.setTip;var C=mstrmojo.desc(11899,"Select a dataset object.");var K=H.hash([A.NodeDimtyOutputLevel]);function D(){var T=this.model;if(T){if(!T.attachEventListener){mstrmojo.hash.make(T,mstrmojo.ConditionModel,{});}T.attachEventListener("edit",this.id,"onmodeledit");}}function L(U,T){if(T&&T.detachEventListener){T.detachEventListener("edit",U.id,"onmodeledit");}}function N(Y,T){var W=T,X=[],V=[],U=[],Z=false;M.forEach(W,function(a){X=X.concat(a.att.filter(function(b){return b.did===Y;}));});Z=X[0]&&X[0].da;X.forEach(function(a){V=V.concat(a.fs||[]);});V.forEach(function(a){if((a.obf||Z)&&U.filter(function(b){return b.did===a.fid;}).length===0){U.push({did:a.fid,dtp:mstrmojo.expr.mapBaseFormTypeToDataType(a.bftp),n:a.fnm,t:a.t});}});return U;}mstrmojo.rw.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.rw.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},walkNode:function(){return this.domNode.children[1];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function J(){P.visibleMarkupMethod.call(this);if(this.visible){this.initWalk();}},onheightChange:P.heightMarkupMethod,onwidthChange:P.widthMarkupMethod},layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",applyNode:"auto"},xt:true},editor:undefined,columnWalk:undefined,tip:undefined,walkProvider:null,objectBrowsingEnabled:true,postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=mstrmojo.insert(mstrmojo.rw.ConditionWalkProvider);}},initWalk:function O(){var T=this.columnWalk,U=this.walkProvider;I.call(this,C);T.removeTrailingContainer(-1);T.addNextColumn(U.getTargetNodeProps());T.target.updateColumnContainer();S(this);},updateBrowseElementsParams:function(W,V){W.attributeID=V.did;W.otp=V.t||12;var U=this.editor,T=U&&U.onUpdateBrowseElementsParams;if(T){T.call(U,W,V);}},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"750px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var T=this.parent;if(T.close){T.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var T=this.parent;if(T.onOK){T.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:C,ignoreLayout:true}],eb:{scriptClass:"mstrmojo.Editor",cssClass:E.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(U){var T=this.parent.opener;T.updateBrowseElementsParams(U,T.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-WebButton hot",cssText:"width: 66px;",onclick:function(){var T=this.parent.parent,U=T&&T.opener;if(U){U.onEBSelect();U.closePopup();}}},{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-WebButton",cssText:"min-width: 66px; margin-left: 11px;",onclick:function(){var T=this.parent.parent,U=T&&T.opener;if(U){U.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,upButtonVisible:true,scrollableIncFetch:true,showCompletePath:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true,minSearchLength:1}]},_set_model:function R(W,T){var U=this.model,V=(T!==U);if(V){L.call(this,U);T.dimtyTypes=this.dimtyTypes||K;this.model=T;D.call(this,T);if(this.hasRendered&&this.visible){this.columnWalk.target.updateColumnContainer();}}return V;},onmodeledit:function G(T){this.columnWalk[T.prop==="c1"?"c0":T.prop].updateColumnContainer();S(this);},browse:function F(V){var X=this.parent.editorNode,W=function(Z,b){var Y=mstrmojo.dom.position(Z,true),a=mstrmojo.dom.position(b,true);return{x:Y.x+Y.w,y:a.y};},T=this.columnWalk,U=this.walkProvider;switch(V&&V.alias){case"target":case"dmy":U.browseObjs(this,V,W(V.alias==="target"?T.target.domNode:this.dmyNode,X));break;case"c0":case"c1":U.browseObjs(this,V,W(T.c0.domNode,X));break;case"es":U.browseEs(this,V,W(T.es.domNode,X));break;}},onOBSelect:function(X){var V=this.ob.browser,Z=V.target;this.closePopup();var U=this.targets,Y=Z.itemIdField,W=U||[],T=H.find(U,Y,X[Y]);if(T===-1){W.push(X);this.targets=W;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}Z.setSelectedItems([X],Z.multiSelect);if(Z.onObjBrowsed){Z.onObjBrowsed(X);}},onEBSelect:function(){var U=this.eb.browser,W=this.columnWalk.es.es;W.set("selectedIndices",{});var T=W.items,V=[];H.forEach(U.selectedItems||[],function(Y){if(H.find(W.items,"v",Y.v)<0){V.push(Y);}});var X=W.insertUnlistedValuesAt||0;if(X<0){X=T.length;}W.set("items",T.slice(0,X).concat(V).concat(T.slice(X)));W.setSelectedItems(U.selectedItems,false);},destroy:function Q(U){var T=this.walkProvider;if(T&&T.destroy){this.walkProvider.destroy();}this._super(U);}});mstrmojo.rw.ConditionWalk.getAttForms=N;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.rw.ConditionWalk","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.expr","mstrmojo.css");var F=mstrmojo.expr.ET.MQ,H=mstrmojo.expr.ET.MC,C=mstrmojo.css,B=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var G=function(K,M){var J=K.et,L=((J===F||J===H)&&!this.inRelation)?"block":"none",I=((M===1)||J!==F)?1:0;C.toggleClass(this.toolNode,"unselectable",J===H);this.toolNode.style.display=L;this.level.set("selectedIndex",I);this.includeExist.set("visible",I===1&&(J===H||J===F));this.includeExist.set("checked",K.idcsi===undefined?false:K.idcsi);};mstrmojo.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,null,{scriptClass:"mstrmojo.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},postCreate:function E(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function I(J){var K=this.parent;if(K&&K.condition&&K.visible){K.includeExist.set("visible",J.v===1);K.condition.level=J.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=B;},oncheckedChange:function(){var J=this.parent;if(J){J.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function A(I){var J=this.condition;if(J&&this.toolNode&&this.visible){G.call(this,J.data,J.tree.level);}if(this._super){this._super(I);}},onmodeledit:function D(I){if(this._super){this._super(I);}if(this.toolNode){G.call(this,this.model.get(),this.model.level);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Dial","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Obj","mstrmojo.CheckBox","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.fe.FilterExprTree","mstrmojo.fe.RelationFilterExprTree","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.StatusButton");var Z=mstrmojo.expr,I=Z.ET,P=Z.BRANCH_FNS,X=mstrmojo.Obj,W=mstrmojo.dom,a=mstrmojo.array,T=mstrmojo.hash,d=mstrmojo.css,C=mstrmojo.warehouse.EnumObjectTypes,K={TEMPLATE:0,DATASET:1},E=mstrmojo.mstr.EnumNodeDimty,R=a.hash([E.NodeDimtyUnspecified,E.NodeDimtyNone]),N=200,H=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(g){a.forEach(this.buttonBar.children[0].children,function(h){h.set("enabled",g);});}function Y(){var g=this.avatar;if(g){g.parentNode.removeChild(g);delete this.avatar;d.removeClass(g,[this.avatarCssClass]);}}mstrmojo.fe.FilterEditorBase=mstrmojo.declare(mstrmojo.Editor,null,{onSave:null,title:mstrmojo.desc(12032,"View Filter Editor"),help:"view_filter_editor_for_report_services_documents.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE",showLimits:true,objectBrowsingEnabled:false,children:null,init:function U(g){this.children=[{alias:"feContent",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-content",postCreate:function(){this.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-exprTool",children:[{scriptClass:"mstrmojo.ui.StatusButton",cssClass:"mstrmojo-FE-addCondition",postCreate:function h(){this.editor=this.parent.parent.parent;this.statusList=this.editor.getAddConditionList();this.status=this.statusList[0];},onButtonClick:function(k){if(k){k.handler.apply(this.editor);}}}]},this.parent.getExpressionContainerCfg()];}},this.getConditionWalkConfig(),{alias:"buttonBar",scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(118,"Save"),onclick:function(){var h=this.editor;M(h);h.close();},bindings:{enabled:function(){return !this.editor.readOnly;},editor:"this.parent.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent.parent"}}]}]}];this._super(g);this.model=this.model||new X();},getExpressionContainerCfg:function(){var g=this;return{alias:"feExpr",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-expr-list",postCreate:function(){this.children=g.getExpressionContentsConfig();},onRender:function(){W.attachMarkupEvent(this.id,this.domNode,"mousedown");},onmousedown:function(h){var k=W.eventTarget(h.hWin,h.e);if(this.isBlankArea(k)){this.clearSelect();}},isBlankArea:function(h){return h===this.domNode;},clearSelect:function(){}};},getExpressionContentsConfig:function(){return[];},getConditionWalkConfig:function(){var h=this;return{scriptClass:"mstrmojo.rw.ConditionWalk",width:"750px",objectBrowsingEnabled:false,dimtyTypes:R,alias:"walk",visible:false,onOK:function g(){var l=this.condition;h.feContent.set("visible",true);this.set("visible",false);h.onConditionEdit(l,this.model.get());B.call(h,true);},close:function k(){h.feContent.set("visible",true);this.set("visible",false);var l=this.condition;if(l.isEmpty()){l.del();}B.call(h,true);},targets:null,targetsLastMod:null,ets:null,condition:null,bindings:{disableElementsBrowsing:"this.parent.disableElementsBrowsing"}};},onConditionEdit:function(h,g){h.tree.modifyConditionNode(h,g);},getAddConditionList:function c(){return[{n:mstrmojo.desc(1994,"Add Condition"),handler:function(){this.mainExpr.newCondition(null,true);}}];},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var g=this.condition,l=g&&g.data&&g.data.not,m=g&&g.parent,h=m&&m.data,k=(h&&h.fn)+(l?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(k)?null:{did:k});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",items:[{did:19,n:P[19]},{did:20,n:P[20]},{did:19+21,n:P["19_21"]},{did:20+21,n:P["20_21"]}],onchange:function(){if(this.opening){return ;}var h=this.parent,g=h.condition,o=this.selectedItem,n=o&&o.did,m=n>21?true:null,l=n-(m?21:0);h.close();var k=g&&g.parent;if(k&&k.data&&k.data.et===I.ANDOR){k.edit(g,l,m);}else{var p=g&&g.data;if(p&&(p.not!==m)){p.not=m;g.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"CreateSet-Editor",title:mstrmojo.desc(12034,"Create a Set"),slot:"containerNode"},_set_busy:function(h,g){if(g){this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");}else{this.set("enabled",true);this.set("iconClass","");}},_set_model:function(m,h){var k=this.model,l=k!==h;if(l){this.model=h;this.modelLastSet=new Date();var g=function(n){return Q(J(n));};h.exprForest=g(h.expr);h.limitExprForest=g(h.limitExpr);if(this.feContent&&this.feContent.feExpr.ve){this.feContent.feExpr.ve.nameFactory.clear();}}return l;},onUpdateBrowseElementsParams:mstrmojo.emptyFn});mstrmojo.fe.ReportFilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var g=this._super();return mstrmojo.mixin({clearSelect:function(){this.re.clearTreeSelect();}},g);},getExpressionContentsConfig:function(){return[{alias:"re",scriptClass:"mstrmojo.fe.ReportFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}}];}});mstrmojo.fe.ReportFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.ReportFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(g){g.data.isNew=true;F(this.editor,g.data,g.widget.ctxtBuilder.itemWidgets[g.index],"condition");},onnodeclick:function A(g){F(g.editor||this.tree.editor,this.data,this,g&&g.part);},allowDrop:function G(g){var k=g&&g.src,m=k&&k.data,l=m&&m.et,h=k&&k.widget&&k.widget.tree;return l&&this!==h;}});mstrmojo.fe.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var g=this._super();return mstrmojo.mixin({isBlankArea:function(h){if(this._super(h)){return true;}return !a.filterOne([this.ve,this.vle],function(k){if(W.contains(k.domNode,h,true)){return true;}});},clearSelect:function(){this.ve.clearTreeSelect();this.vle.clearTreeSelect();}},g);},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11746,"Dataset Level Conditions"),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"true || this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.fe.RWViewFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(g){this.parent.clearSelect(g);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11747,"Template Level Conditions"),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.fe.RWViewLimitExprTree",level:K.TEMPLATE,bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(g){this.parent.clearSelect(g);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);}}];},getConditionWalkConfig:function(){var g=this._super();T.copy({scriptClass:"mstrmojo.fe.ConditionWalk"},g);return g;},getAddConditionList:function c(){var g=this._super();g.push({n:mstrmojo.desc(12055,"Add Dynamic Condition"),handler:function(){this.mainExpr.newCondition({et:I.XML,idc:1,ph:{}},true);}});return g;},onConditionEdit:function(k,h){if(k.tree.level===k.level||k.tree.level===undefined){this._super(k,h);}else{k.parent.remove(k.data);var g=K.TEMPLATE===k.level?this.limitExpr:this.mainExpr;g.addSingleCondition(h);}}});mstrmojo.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RelationFilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(g){g.data.isNew=true;if(!g.data.ph){F(this.editor,g.data,g.widget.ctxtBuilder.itemWidgets[g.index],"condition");}},onnodeclick:function A(g){F(g.editor||this.tree.editor,this.data,this,g&&g.part);},ondragend:function O(k){var h=k&&k.tgt,g=h&&h.widget;if(this.tree&&g&&g.tree&&g.tree!==this.tree){Y.call(this);return ;}this._super(k);},getItemConfig:function(k,g,l){var h=this._super(k,g,l);return T.copy({getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewLimit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(4978,"Move to view limit")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewLimit(w); return false;\" />";}},h);},moveMQNodeToViewLimit:function(k){if(k.data.et!==I.MQ){return ;}var h=T.copy(k.data);k.parent.remove(k.data);var g=this.editor.limitExpr;g.addSingleCondition(h);},allowDrop:function G(g){var k=g&&g.src,n=k&&k.data,m=n&&n.et,l=this.tree,h=k&&k.widget&&k.widget.tree;return m&&(this===l?(h!==l):true);}});mstrmojo.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewLimitExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-limitExpr",validExprTypes:a.hash([I.MQ]),onnodeclick:function A(g){F(this.tree.editor,this.data,this,g&&g.part);},onConditionEdit:function(h,g){this._super(h,g);h.data.mdxUnitId=h.data.m.did;V(h);},addSingleCondition:function(h){var g=this._super(h);V(g);},allowDrop:function(g){var l=g&&g.src,n=l&&l.data,m=n&&n.et,k=this.tree,h=l&&l.widget&&l.widget.tree;if(k===h){return this!==h&&this.data&&(this===l.parent||this.data.mdxUnitId===n.mdxUnitId);}return m===I.MQ;},ondrop:function L(h){var m=h&&h.src,g=m&&m.widget;if(g&&g.tree!==this.tree){var l=m&&m.data;if(l&&l.index!==null){var k=g.ctxtBuilder.itemWidgets[l.index];k.tree.moveMQNodeToViewLimit(k);}m.data=null;}this._super(h);},isEditable:function(g){return g.mdxUnitId&&this._super(g);},ondragend:function S(g){var l=g&&g.tgt,h=l&&l.widget;if(h&&h.tree!==this.tree){var k=g.src&&g.src.data;if(k&&(k.indices||(k.index!==null))){this.remove(k.indices||k.index);}Y.call(this);}else{this._super(g);}},moveMQNodeToViewFilter:function(h){var g=this.editor.mainExpr;h.parent.remove(h.data);g.addSingleCondition(h.data);},getItemConfig:function(k,g,l){k.mdxUnitId=D(k);var h=this._super(k,g,l);return T.copy({cssClass:f(k,g,l)?"per-metric-limit":"",forbidRelation:true,getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewFilter" src="../images/1ptrans.gif" title="'+mstrmojo.desc(9746,"Move to view filter")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewFilter(w); return false;\" />";}},h);}});function F(q,o,p,t){var h=W.delta(p.domNode,q.containerNode);h.y+=(t==="andor"?16:parseInt(p.domNode.offsetHeight,10));var r={condition:p,zIndex:q.zIndex+10,left:h.x+"px",top:h.y+"px"},g;switch(t){case"andor":if(q.skipAndOrPopup){return ;}g="andOrPopupRef";break;case"createSet":case"createSetOpt":var s=q.model.targets;g="createSetPopupRef";r.type=t;r.model={attrs:a.filter(s,function(n){return n.t===C.ATTRIBUTE;}),metrics:a.filter(s,function(n){return n.t===C.METRIC;})};if(t==="createSetOpt"){r.condition=p.parent;r.model.childIdx=p.childIndex();}break;case"condition":var m=q.walk,k=p.textNode.cloneNode(true),l=m.conditionNode.firstChild;d.removeClass(k,"editable");d.addClass(m.conditionNode,"mstrmojo-ConditionNode");if(l.firstChild){l.removeChild(l.firstChild);}l.appendChild(k);m.set("objectBrowsingEnabled",q.objectBrowsingEnabled);m.set("targets",q.model.targets);m.set("targetsLastMod",q.modelLastSet);m.set("ets",p.tree.validExprTypes||q.validExprTypes);m.set("condition",p);m.set("model",T.clone(o));m.set("hasPrompt",q.model.hasPrompt);m.set("disableElementsBrowsing",q.disableElementsBrowsing||m.disableElementsBrowsing);m.set("editor",q);m.set("inRelation",p.inRelation);q.feContent.set("visible",false);m.set("visible",true);m.columnWalk.target.updateScrollbars();B.call(q,false);return ;}q.openPopup(g,r);}function M(h){var g=h.model;g.expr=e(g.exprForest);g.limitExpr=e(b(g.limitExprForest));h.onSave(g);}function Q(h){var g=[];a.forEach(h,function(k){if(!k){return ;}if(k.et===I.ANDOR){k.nds=Q(k.nds);if(k.nds.length===0){return ;}else{if(k.nds.length===1){var l=k.nds[0];if(k.not){l.not=!l.not;}g.push(l);return ;}}}g.push(k);});return g;}function J(g){return g?[g]:[];}function e(g){return g&&g.length===1?g[0]:null;}function b(k){var h=Q(k),g;if(!h[0]||h[0].mdxUnitId){g={et:I.ANDOR,fn:Z.FN.AND,nds:h};}else{g=h[0];}return[g];}function f(h,g,k){return(k===k.tree||k.parent===k.tree)&&!!h.mdxUnitId;}function D(h){if(!("mdxUnitId" in h)){var g;switch(h.et){case I.MQ:g=h.m.did||null;break;case I.ANDOR:a.forEach(h.nds,function(l){var k=D(l);if(g===undefined){g=k;}else{if(g!==k){g=null;return false;}}return true;});break;default:g=undefined;break;}h.mdxUnitId=g;}return h.mdxUnitId;}function V(n){var p=n.tree,o=p.ctxtBuilder.itemWidgets[0],s=n.parent,q=a.indexOf(s.items,n.data),l=s.items[q],h=l.mdxUnitId;if(s===p){return ;}if(s.data.mdxUnitId===h){return ;}if(o.data.mdxUnitId){var k={et:I.ANDOR,fn:Z.FN.AND,nds:[o.data,l]};p.remove(0);p.add([k]);p.ctxtBuilder.itemWidgets[0].ctxtBuilder.itemWidgets[0].remove(l);}else{var m=o,g;a.forEach(o.data.nds,function(u,t){if(u.mdxUnitId===l.mdxUnitId&&o.items[t]!==l){m=o.ctxtBuilder.itemWidgets[t];g=t;return false;}});if(m===s){return ;}if(m.data.et!==I.ANDOR){var r={et:I.ANDOR,fn:Z.FN.AND,nds:[m.data,l]};o.add([r],g+1);o.remove(m.data);}else{m.add([l]);}s.remove(l);}}}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.HBox","mstrmojo.ui.menus.EditorConfig","mstrmojo.mstr.EnumFunction","mstrmojo.DropDownList","mstrmojo.ui.Pulldown","mstrmojo.SearchablePulldown","mstrmojo.ButtonList","mstrmojo.Box","mstrmojo.Label","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.EditableLabel","mstrmojo.CheckBox","mstrmojo.fe.FilterEditor","mstrmojo._FormatDefinition","mstrmojo.num","mstrmojo.locales","mstrmojo.vi.models.VIComponentMap","mstrmojo.func","mstrmojo.dom","mstrmojo.ME.AttributeEditBox","mstrmojo.string","mstrmojo.dom","mstrmojo.models.datasets.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.editors.ObjectPicker","mstrmojo.vi.ui.editors.AttributeLinkEditor","mstrmojo.vi.ui.NumberFormatter");mstrmojo.requiresDescs(1442,1885,1886,2022,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,3993,4564,11494,11495,11496,11497,14612);var n=mstrmojo.mstr.EnumFunction,X=mstrmojo.hash,q=mstrmojo.array,AE=mstrmojo.expr.ET,D=mstrmojo.css,V=mstrmojo.dom,t=mstrmojo.Button.newWebButton,S=mstrmojo.ME.MetricToken.brackets,T=mstrmojo._FormatDefinition,o=mstrmojo.models.datasets.DataInterface,K=mstrmojo.vi.models.VIComponentMap.TYPES,U=mstrmojo.chart.model.enums.EnumDSSObjectType;var Y={SUM:mstrmojo.desc(2131,"Sum"),ADD:mstrmojo.desc(6017,"Add"),AVG:mstrmojo.desc(2122,"Average"),MAX:mstrmojo.desc(2125,"Maximum"),GST:mstrmojo.desc(5869,"Greatest"),MIN:mstrmojo.desc(2127,"Minimum"),LST:mstrmojo.desc(5868,"Least"),CNT:mstrmojo.desc(2123,"Count"),MTP:mstrmojo.desc(5418,"Multiply"),STD:mstrmojo.desc(2130,"Standard Deviation"),PTD:mstrmojo.desc(11494,"Population Standard Deviation")},c={SUM:{n:Y.SUM,t:n.FunctionSum},ADD:{n:Y.ADD,t:n.FunctionPlus},AVG:{n:Y.AVG,t:n.FunctionAvg},MAX:{n:Y.MAX,t:n.FunctionMax},GST:{n:Y.GST,t:n.FunctionGreatest},MIN:{n:Y.MIN,t:n.FunctionMin},LST:{n:Y.LST,t:n.FunctionLeast},TMS:{n:Y.MTP,t:n.FunctionTimes},CNT:{n:Y.CNT,t:n.FunctionCount},GEM:{n:mstrmojo.desc(2124,"Geometric Mean"),t:n.FunctionGeomean},MED:{n:mstrmojo.desc(2126,"Median"),t:n.FunctionMedian},MOD:{n:mstrmojo.desc(2128,"Mode"),t:n.FunctionMode},PDT:{n:mstrmojo.desc(2129,"Product"),t:n.FunctionProduct},STD:{n:mstrmojo.desc(2130,"Standard Deviation"),t:n.FunctionStdev},VAR:{n:mstrmojo.desc(2132,"Variance"),t:n.FunctionVar}},Z=[{n:Y.SUM,t:n.FunctionOLAPSum},{n:Y.AVG,t:n.FunctionOLAPAvg},{n:Y.MIN,t:n.FunctionOLAPMin},{n:Y.MAX,t:n.FunctionOLAPMax},{n:Y.CNT,t:n.FunctionOLAPCount}],AF=[{n:Y.SUM,t:n.FunctionOLAPSum},{n:Y.AVG,t:n.FunctionOLAPAvg},{n:Y.MIN,t:n.FunctionOLAPMin},{n:Y.MAX,t:n.FunctionOLAPMax},{n:Y.CNT,t:n.FunctionOLAPCount}],M=[{n:mstrmojo.desc(1058,"Previous"),t:n.FunctionLag},{n:mstrmojo.desc(1059,"Next"),t:n.FunctionLead},{n:mstrmojo.desc(4046,"First"),t:n.FunctionFirst},{n:mstrmojo.desc(4049,"Last"),t:n.FunctionLast}];function e(AJ,AL,AK,AH){return{scriptClass:"mstrmojo.ui.Pulldown",items:AJ,selectedIndex:AL,onitemSelected:function AI(AM){var AN=this.parent;while(!AN.data||!AN.data[AK]){AN=AN.parent;}AN.data.set(AK,AH?AH(AM):AM.v);}};}function u(AI,AH){return{scriptClass:"mstrmojo.Box",cssClass:"breakByBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13903,"Break by:")},e(AI,AH,"breakBy",function(AJ){return{id:AJ.did,type:AJ.t,dmy:AJ.dmy};})]};}function AC(AK){var AL=AK.metrics,AM=AK.propName,AJ=AK.optionValueField||"id",AH=q.find(AL,AJ,AK.value),AN=function AN(AP){var AO=this.parent;while(!AO.data||!AO.data.hasOwnProperty(AM)){AO=AO.parent;}AO.data.set(AM,AP?{id:AP[AJ],type:4}:{cst:this.text});};return{scriptClass:"mstrmojo.ui.SearchablePulldown",items:AL,selectedIndex:AH,useRichTooltip:true,bindings:AK.bindings,valid:true,allowCustomText:true,allowEmptyText:true,onvalidChange:function AI(){mstrmojo.css.toggleClass(this.domNode,"invalid",!this.valid);if(this.hasRendered){this.hideTooltip();this.showTooltip();}},updateTooltipConfig:function(){if(this.valid){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onitemSelected:AN,onTextEditComplete:function(){AN.call(this,this.items[this.selectedIndex]);},onPopupWidgetOpened:function(){this.set("valid",true);},postkeyup:AK.postkeyup};}function R(AK,AJ,AI){if(AK&&AK.datap){var AH=q.filterOne(AK.datap,function(AM){return AM.tbid===AJ;}),AL=AH&&AH.maps.amps;return q.filterOne(AL,function(AM){return AI===AM.aimp.atid;});}return null;}function h(AH,AL){var AJ=q.filterOne(AH&&AH.afmps,function(AM){return AM.fmid===AL;}),AK=AJ&&(AJ.sqc?AJ:AJ.col.oi),AI;if(AK&&AK.sqc){AI={did:AK.sqc.id,n:mstrmojo.string.decodeHtmlString(AK.cln),coldtp:AK.sqc.dt.tp,georole:AK.geo,timerole:AK.tim,der:AK.sqc.der};}else{if(AK){AI={did:AK.did,n:mstrmojo.string.decodeHtmlString(AK.def.cln),coldtp:AK.def.dt.tp,georole:AJ.geo,timerole:AK.def.dicl.time,der:AK.def.dicl.der};}}return AI;}function C(AI,AH,AK){var AJ={success:function(AL){if(AL&&AL.msgid){mstrApp.serverRequest({taskId:"qBuilder.GetReportXDADefinition",msgid:AL.msgid,bindingflag:2,previewflag:261,browsetype:5},AK);}},failure:function(AL){mstrApp.onerror(AL);}};mstrApp.serverRequest({taskId:"duplicateReportInstance",datasetID:AH,messageID:AI},AJ);}function I(AM,AN,AK){var AI=AM.srcTableId,AP=AM.tgtTableId,AH,AL,AJ=function(AT,AS){var AV="<mpcs><mpc ",AR,AU;for(AR in AS){AU=AS[AR];AV+='$ACT="$VAL" '.replace("$ACT",AR).replace("$VAL",AU);}AV+="/></mpcs>";return{act:"changeEMMAMapping",tbid:AT,dsid:AM.dsid,mapping:AV};},AQ=function(AT){var AU={success:function(){AO();}},AS,AR;AH=R(AT,AI,AM.srcId);AL=R(AT,AP,AM.tgtId);AS=h(AH,AH.afmps[0].fmid);AR=[AJ(AI,{did:AS.did,oid:AL.aimp.atid,fg:1})];AN.getDataService().submitUpdates(AR,AU);},AO=function(){var AR=[],AU={},AS,AT;if(!AH||!AL){return ;}AU[AI]={};AU[AP]={};q.forEach(AH.afmps,function(AY){var AW=q.find(AL.afmps,"fmid",AY.fmid),AZ,AX,AV;if(AW>=0){AS=h(AH,AY.fmid);AT=h(AL,AY.fmid);if(AS.georole!==AT.georole){AV=(AS.georole===0)?AI:AP;AZ=(AS.georole===0)?AS.did:AT.did;AX=AS.georole||AT.georole;AU[AV][AZ]=X.copy({did:AZ,georole:AX},AU[AV][AZ]);}if(AS.timerole!==AT.timerole){AV=(AS.timerole===0)?AI:AP;AZ=(AS.timerole===0)?AS.did:AT.did;AX=AS.timerole||AT.timerole;AU[AV][AZ]=X.copy({did:AZ,timerole:AX},AU[AV][AZ]);}if(AS.der!==AT.der){AX=AS.der|AT.der;AU[AI][AS.did]=X.copy({did:AS.did,drvflg:AX},AU[AI][AS.did]);AU[AP][AT.did]=X.copy({did:AT.did,drvflg:AX},AU[AP][AT.did]);}}});X.forEach(AU,function(AV,AW){X.forEach(AV,function(AX){AR.push(AJ(AW,AX));});});AS=h(AH,AH.afmps[0].fmid);AR.push(AJ(AI,{did:AS.did,oid:AL.aimp.atid}));if(AK){AK(AR);}};C(AN.mid,AM.dsid,{success:AQ});}function W(AM,AJ,AI,AN){var AH=0,AL=[],AK=function(AO){var AP=AI[AH-1];if(AO&&AO.tks&&AP){AL.push({fid:AP.fid,fnm:AP.fnm,ftk:AO.tks.items});}if(AH===AI.length){AN(AL);return ;}AP=AI[AH++];mstrmojo.ME.MetricDataService.validateMetric({metricId:AJ,formID:AP.fid,objectType:12,tokenStreamXML:"",metricXML:"",msgID:AM},{success:AK});};AK();}function y(AH,AI){return{v:S(AH.n)+"@"+S(AI.fnm),tp:275,lv:1,exv:AI.fid,extp:8,oi:{did:AH.did,t:AH.t,n:AH.n}};}mstrmojo.vi.ui.DatasetUnitMenuUtils=mstrmojo.provide("mstrmojo.vi.ui.DatasetUnitMenuUtils",{getAvailableShortcutMetricFunctionsGroup:function AB(AH){return{"12":[[c.AVG,c.CNT,c.MAX,c.MIN,c.STD,c.SUM,c.VAR]],"4":[[c.SUM,c.AVG,c.MIN,c.MAX,c.CNT],[c.GEM,c.MED,c.MOD,c.PDT,c.STD,c.VAR]]}[AH.t];},isAmongFunctions:function A(AI,AH){return AH.some(function(AJ){return AJ.some(function(AK){return AK.t===AI;});});},getMultiSelectionShortcutMetricFunctions:function J(AH){var AI=true;q.forEach(AH,function(AJ){if(4!==AJ.t){AI=false;return false;}return true;});return AI?[c.ADD,c.AVG,c.GST,c.LST,c.TMS]:[];},getRelativeReferenceMenu:function b(AL,AJ,AO,AH){var AK=0,AI=M[AK],AN=0,AM=AO&&AO[AN];return new mstrmojo.ui.menus.EditorConfig({data:{item:AL,relativeRef:AI,breakBy:AM},cssClass:"RelativeReference-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",cssClass:"funcBox",children:[{scriptClass:"mstrmojo.Label",visible:AJ&&AJ.length,text:AJ},e(M,AK,"relativeRef",function(AP){return AP.t;})]},u(AO,AN)],fnOk:function(AP){return AH(AP.item,AP.relativeRef,[AP.breakBy]);}});},getMovingTotalMenu:function B(AR,AL,AN){var AS=1,AK=AF[AS].t,AM=1,AI=mstrmojo.desc(13289,"Starting previous##rows").split("##"),AQ=0,AJ=AL&&AL[AQ];return new mstrmojo.ui.menus.EditorConfig({cssClass:"MovingTotal-MenuEditor",data:{item:AR,funcType:AK,windowSize:AM,breakBy:AJ},contents:[e(AF,AS,"funcType",function(AT){return AT.t;}),{alias:"winSzBox",scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"WinSzPrefix",text:AI[0]},{alias:"winSz",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:mstrmojo.expr.DTP.INTEGER,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:1},postCreate:function AP(){this.set("value",AM);},_ontooltipover:function(){var AT=mstrmojo.all[this.id];AT._hovered=true;AT.showTooltip();},_ontooltipout:function(){var AT=mstrmojo.all[this.id];AT._hovered=false;AT.hideTooltip();},useRichTooltip:true,tooltipOpenDelay:0,onInvalid:function(){var AT=this.validationStatus.msg,AU=!(this.richTooltip&&AT===this.richTooltip.content);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-V",top:-5,refNode:this.domNode,content:AT};if(this._hovered&&AU){this.hideTooltip();this.showTooltip();}},onValid:function(){this.richTooltip=null;this.hideTooltip();},postvalueChange:function AO(){var AT=this.isValid();this.parent.parent.popupConfig.data.set("windowSize",AT?parseInt(this.value,10):0);}},{scriptClass:"mstrmojo.Label",cssClass:"WinSzSuffix",text:AI[1]}]},u(AL,AQ)],bindings:{okEnabled:function(){return !!this.data.windowSize;}},fnOk:function AH(AT){if(AN){AN(AR,AT.funcType,AT.windowSize,[AT.breakBy]);}}});},getRunningTotalMenu:function AA(AK,AN,AI){var AJ=0,AH=Z[AJ].t,AM=0,AL=AN&&AN[AM];return new mstrmojo.ui.menus.EditorConfig({data:{item:AK,func:AH,breakBy:AL},cssClass:"RunningTotal-MenuEditor",contents:[e(Z,AJ,"func",function(AO){return AO.t;}),u(AN,AM)],fnOk:function(AO){return AI(AO.item,AO.func,[AO.breakBy]);}});},getRankMetricEditor:function w(AL,AO,AJ){var AH=[{n:mstrmojo.desc(1886,"Descending"),v:"0"},{n:mstrmojo.desc(1885,"Ascending"),v:"-1"}],AI=0,AK=AH[AI].v,AN=0,AM=AO&&AO[AN];return new mstrmojo.ui.menus.EditorConfig({data:{item:AL,order:AK,breakBy:AM},cssClass:"NewRankMetric-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14612,"Sort:")},e(AH,AI,"order")]},u(AO,AN)],fnOk:function(AP){return AJ(AP.item,AP.order,[AP.breakBy]);}});},insertAddUnitToFilterMenu:function H(AM,AI,AH){var AK=this,AJ=mstrmojo.desc(2022,"Add to Filter"),AL=q.ensureArray(AH).filter(function(AN){return AK.isValidAddToFP(AI,AN);});if(AL.length>0){AM.addMenuItem(AJ,"",function(){AI.addFilterStackSelectors(AL);});}else{AM.addDisabledMenuItem(AJ,"");}},isValidAddToFP:function N(AK,AM){var AI=AK.controller.view.builder,AJ=AI.getLayoutVIMap(AK.getCurrentLayoutKey()).getComponent(K.FILTER_STACK),AN;AN=(!AJ||q.find(AJ.getFilterDefinitions(),"srcid",AM.did)===-1);if(AN&&AM.lock){var AH=AM.fs||[],AL;AN=false;for(AL=0;AL<AH.length;AL++){if(AH[AL].iidx){AN=true;break;}}}return AN;},renameItem:function p(AM,AP,AI,AK){var AL=AM.mstrmojoId,AO=mstrmojo.dom.findWidget(AM);AK=AK||{};if(!AL){var AN=mstrmojo.insert({scriptClass:"mstrmojo.EditableLabel",editOnClick:false,text:AP.n,title:AP.dsc||"",allowEmptyText:AK.allowEmptyText,cssClass:AK.cssClass||"",placeholder:AM,onTextEditComplete:function AH(AQ){if(AQ){return AI(this);}},onmousedown:function AJ(AQ){if(this.isEditing){AQ.cancel();}}});if(AO&&AO.draggable){AN.parent=AO;}AN.render();AL=AN.id;}mstrmojo.all[AL].set("isEditing",true);return mstrmojo.all[AL];},getMultipleMetricsCalculationMenus:function g(AO,AH,AR){var AN=new mstrmojo.ui.menus.MenuConfig(),AT=mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(AO),AL=function(AV,AW,AU){return{dsid:AH,funcType:AW,funcType2:AU,items:AV};};AN.useTooltip=true;AT.forEach(function(AU){AN.addMenuItem(AU.n,"",function(){AR(AL(AO,AU.t));});});if(AO.length===2){var AM=mstrmojo.mstr.EnumFunction,AK=AM.FunctionDivide,AI=AM.FunctionMinus,AQ=AO[0],AP=AO[1],AS=function(AY,AW,AU,AX,AV){AN.addMenuItem(AY,"",function(){AR(AL([AW,AU],AX,AV));});},AJ=[{n:function(AV,AU){return AV.n+"/"+AU.n;},fn:AK},{n:function(AV,AU){return AV.n+"-"+AU.n;},fn:AI},{n:function(AV,AU){return"("+AV.n+"-"+AU.n+")/"+AU.n;},fn:AI,fn2:AK}];AJ.forEach(function(AU){AN.addSeparator();AS(AU.n(AQ,AP),AQ,AP,AU.fn,AU.fn2);AS(AU.n(AP,AQ),AP,AQ,AU.fn,AU.fn2);});}return AN;},getCalculationMetricEditor:function L(AP,AQ,AO){var AJ=[{n:"",css:"operator-plus",funcType:n.FunctionPlus},{n:"",css:"operator-minus",funcType:n.FunctionMinus},{n:"",css:"operator-multiply",funcType:n.FunctionTimes},{n:"",css:"operator-divide",funcType:n.FunctionDivide},{n:"%",css:"operator-percent-diff",funcType:n.FunctionMinus,funcType2:n.FunctionDivide}],AK={m1:AQ.did,m2:AP[0].did,operator:n.FunctionPlus,u1:{id:AQ.did,type:4},u2:null},AI=function(AR){return{}.hasOwnProperty.call(AR,"cst");},AN=function(AR){return typeof AR==="string"&&!!AR.length&&!isNaN(Number(AR));};var AH="this.parent.popupConfig.valid || this.selectedIndex !== -1 || (!!this.selectedNode && this.selectedNode.innerHTML.length === 0)",AM=function AM(){var AR=this.parent.popupConfig;if(AR){AR.set("okEnabled",this[this.editableSlot].innerHTML.length!==0);}};return new mstrmojo.ui.menus.EditorConfig({cssClass:"Calculation-MenuEditor",contents:[AC({metrics:AP,value:AK.m1,propName:"u1",optionValueField:"did",bindings:{valid:AH},postkeyup:AM}),{scriptClass:"mstrmojo.ButtonListHoriz",items:AJ,selectedIndex:0,postselectionChange:function AL(){this.parent.data.set("operator",this.selectedItem.funcType);this.parent.data.set("operator2",this.selectedItem.funcType2);}},AC({metrics:AP,value:null,propName:"u2",optionValueField:"did",bindings:{valid:AH},postkeyup:AM})],data:AK,okEnabled:false,bindings:{valid:function(){var AT=this.data.u1,AS=this.data.u2,AU=this.data.operator;if(!AT||!AS||!AU){return false;}var AR=!(AI(AT)&&AI(AS))&&(!AI(AT)||AN(AT.cst))&&(!AI(AS)||AN(AS.cst));this.set("okEnabled",AR);return AR;}},fnOk:function(AR){return AO(AR.u1,AR.u2,AR.operator,AR.operator2);}});},getFilterEditor:function F(AI){var AN="dfe",AM,AJ={},AL=AI.datasetFilter;function AK(AO){if(!AO.et){return false;}if(AO.et===AE.RLS){return false;}if(AO.p){return false;}if(AO.cs&&AO.cs.some(function(AP){return !!AP.p;})){return false;}return !AO.nds||AO.nds.every(AK);}function AH(){q.forEach(AI.att,function(AP){if(AP.t!==12||AP.da){return ;}AJ[AP.did]={did:AP.did,n:AP.n,t:AP.t,fs:AP.fs};});q.forEach(AI.mx,function(AP){if(AP.um){return ;}AJ[AP.did]={did:AP.did,n:AP.n,t:AP.t};});if(AL){mstrmojo.expr.findTargets(AL,"did",AJ);}var AO={expr:X.clone(AL),targets:X.valarray(AJ)};AM=AN&&window.mstrmojo&&mstrmojo.all[AN];if(!AM){AM=mstrmojo.insert({id:AN,scriptClass:"mstrmojo.fe.ReportFilterEditor",showLimits:false,objectBrowsingEnabled:true});}if(AI.zIndex){AM.set("zIndex",AI.zIndex);}AM.set("title",mstrmojo.desc(12138,"Dataset Filter #").replace("#",AI.datasetName));AM.set("onSave",AI.fnOk);AM.set("model",AO);AM.onUpdateBrowseElementsParams=AI.browseParam;AM.open();}if(AL&&!AK(AL)){mstrmojo.warn(mstrmojo.desc(13527,"The filter contains an advanced condition that cannot be edited."),{confirmBtn:{t:mstrmojo.desc(13528,"Clear existing filter"),fn:function(){AL=null;AH();}}},{title:mstrmojo.desc(11812,"Notification")});}else{AH();}},getCfgForAddUnitFromAllObject:function(AH,AI){var AJ=null,AK=null,AL=[],AM=function(AN,AO){if(!AO){return false;}return q.find((AO.att||[]).concat(AO.mx||[]),"did",AN.did)>-1;};X.forEach(AI,function(AO,AN){if(AO.idd){AJ=AN;AK=AO;return false;}return true;});if(!AJ){AJ="$GUID_141";AL.push({act:"createDataset",mgo:true,prm:true,name:mstrApp.projectName,idd:true,newObjectIds:[AJ]});}q.forEach(AH,function(AN){if(!AM(AN,AK)){AL.push({act:"addUnitToDataset",dsid:AJ,unitId:AN.did,unitType:AN.t});}});return{actions:AL,dsid:AJ};},getAggregateByMenu:function m(AM,AK){var AI=new mstrmojo.ui.menus.MenuConfig(),AJ=function(AQ,AP){var AS,AR;if(AP){var AO=AQ.mexp.args[0];AS=AO.did;AR=AO.t;}else{AS=AQ.did;AR=AQ.t;}return{did:AS,t:AR};},AH=this.getAvailableShortcutMetricFunctionsGroup(AM),AN=AM.mexp?AM.mexp.ft:null,AL=AM.mexp&&this.isAmongFunctions(AN,AH);AH.forEach(function(AO,AP){if(AP!==0){AI.addSeparator();}AO.forEach(function(AQ){AI.addMenuItem(AQ.n,"",function(){AK(AJ(AM,AL),AQ.t);});});});return AI;},showObjectPicker:function l(AI,AH){var AJ="object_picker";return function(){var AK=mstrmojo.all[AJ];if(!AK){AK=new mstrmojo.vi.ui.editors.ObjectPicker({id:AJ});if(AH){AK.supportedTypes=q.hash(AH);AK.ob.browsableTypes="8,"+AH.join(",");}AK.render();}else{if(AH){AK.supportedTypes=q.hash(AH);AK.ob.browsableTypes="8,"+AH.join(",");}AK.browse();}AK.OKFn=AI||mstrmojo.emptyFn;AK.open();};},generateNumberFormat:function s(AM){var AH=T.DefaultFormat.FormattingNumber,AI=T.NumberFormatCategory,AK=AM||{},AJ=AK.nct,AL=AJ===AI.General&&AK.nfs==="General";return{category:(AJ===undefined||AL)?AI.Automatic:AJ,decimalPlaces:AK.ndp===undefined?2:AK.ndp,thousandSeparator:AK.nth?-1:0,currencySymbol:AK.ncs||AH.CurrencySymbol,currencyPosition:AK.ncp||AH.CurrencyPosition,format:AK.nfs||"",negativeNumbers:AK.nnn||AH.NegativeNumbers};},getNumberFormatEditor:function x(AK,AJ,AI){var AH=this.generateNumberFormat(AJ),AL=X.clone(AH),AN=X.clone(AH);return new mstrmojo.ui.menus.EditorConfig({data:AL,bindings:{okEnabled:function(){return !(this.data.category===AN.category&&this.data.format===AN.format);}},cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:AH,myData:AL,oldData:AN,adjustAfterCategoryChange:function(){this.parent.adjustCornersForPopupOverflow();}}],fnOk:function AM(AO){if(!(AO.category===AN.category&&AO.format===AN.format)){return AI(AO,AN);}}});},getHighlightElementHandler:function(AJ,AI,AH){return function(){D.toggleClass(AI,AH||"open",AJ);};},getConfDataTypeMenuCfg:function z(AH,Ac,AU,Ap){var Ak="ToString",Ab="ToNumber",AZ="ToDateTime",AT="keepOriginal",AK="Default",Al={ToString:3,ToNumber:2,ToDateTime:8},AP={ToString:"D1ED29645DEC4DBF99E8E09ED939074B",ToNumber:"399C3EC1041643F1ACE8F2A92B1C1F2F",ToDateTime:"0A558C7295DE42DAA8C5594F1724563F"},AN="_pattern",An="_func",AX="_bft",As="_state",Aq={UNCHANGED:0,TO_CREATE:1,TO_UPDATE:2},AM={n:"Default",v:"Default"},Ai=[{n:"MM-DD-Year",v:"MM-DD-Year"},{n:"MM/DD/Year",v:"MM/DD/Year"},{n:"DD-MM-Year",v:"DD-MM-Year"},{n:"DD/mm/Year",v:"DD/mm/Year"},AM],AJ=[{n:mstrmojo.desc(13772,"Keep Original"),v:AT},{n:mstrmojo.desc(12276,"String"),v:Ak},{n:mstrmojo.desc(2052,"Date"),v:AZ},{n:mstrmojo.desc(3434,"Number"),v:Ab}],AS=X.clone(AJ).slice(1),Aa=Ac.fs.filter(function(Au){return Ac.da||Au.obf;}),At=Aa.length>1,AV=Aa.length>5,AO=false,Aj=false,Ad=[],Ah=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13773,"Select Data Type for New Attribute:")}],Ar={okEnabled:false},Am=function(){var Au=false;Aa.forEach(function(Av){Au=Au||(Ar[Av.fnm+An+As]!==Aq.UNCHANGED)||(Ar[Av.fnm+AN+As]!==Aq.UNCHANGED);});return Au;},Ae=function(Aw,Av){var Au=0;if(Aw.da){q.forEach([Ak,AZ,Ab],function(Az,Ax){var Ay=new RegExp("^\\s*"+Az+"\\s*(<.*>)?\\s*\\((.+)\\)\\s*$","i").exec(Av.f);if(Ay&&Ay[2]){Au=Ax+1;return false;}});}return Au;},Ag=function(Aw,Av){var Ax=AK;if(Ac.da){var Au=new RegExp("^\\s*"+Av+'\\s*<\\s*Pattern\\s*=\\s*"(.+)"\\s*>.*$',"i").exec(Aw.f);if(!mstrmojo.string.isEmpty(Au&&Au[1])){Ax=Au[1];}}return Ax;},Af=function(){return AV?this.parent.parent.parent:(At?this.parent.parent:this.parent);},AY=function(Au){if(AV){Au.formList.updateScrollbars();}},AL=function(A1,A2,A0){var Au=A2.fnm,Ax=AV?A1.formList[A2.fnm+AN]:A1[A2.fnm+AN],Ay=At?Ax.children[1]:Ax,Az=Ar[Au+An],Aw=AO&&(Az===AZ||Az===Ak),Av=Ax.visible!==Aw;if(Av){Ax.set("visible",Aw);if(Aw){AY(A1);}else{Ay.hideTooltip();}}if(A0){Ay.set("text",Ag(A2,Az));Ay.set("items",Az===AZ?Ai:[AM]);}},AW=function(Au){var Av=false;Aa.forEach(function(Aw){if(Ar[Aw.fnm+An]===AZ||Ar[Aw.fnm+An]===Ak){Av=true;return false;}});Au.advancedLabel.set("visible",Av);},AI=function(Ax,Av,Ay,Au){return{scriptClass:"mstrmojo.ui.Pulldown",items:Ax,alias:Ay.fnm+An,selectedIndex:Av,onPopupWidgetOpened:function(){AY(Af.call(this));},onitemSelected:function Aw(A3,A1){var A2=Af.call(this),A4=A2.data,A5=Ay.fnm,A0=A3.v,Az=function(A6){if(A6){return(Ax.length===3?Aq.TO_UPDATE:Aq.TO_CREATE);}return Aq.UNCHANGED;};A4.set(A5+An,A0);A4.set(A5+AN,Ag(Ay,A0));A4.set(A5+AX,A0===AT?Ay.bftp:Al[A0]);A4.set(A5+An+As,Az(A1!==Av));A4.set("okEnabled",Am());AL(A2,Ay,true);AW(A2);}};},AR=function(Aw,Ax,Au){return{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:Aw.fnm+AN,useRichTooltip:true,visible:Au,allowCustomText:true,allowEmptyText:true,onPopupWidgetOpened:function(){AY(Af.call(this));},customizeSearchResult:function(Ay){if(q.find(Ay,"v","Default")===-1&&this.items.length>0){Ay.push(AM);}},onclick:function(Ay){mstrmojo.ui.SearchablePulldown.prototype.onclick.call(this,Ay);this.set("isEditing",true);},updateData:function(A0){var Ay=Af.call(this),Az=Ay.data,A1=Aw.fnm;Az.set(A1+AN,A0);Az.set(A1+AN+As,Ax!==A0?Aq.TO_UPDATE:Aq.UNCHANGED);Az.set("okEnabled",Am());},onitemSelected:function Av(Az,Ay){if(Az){this.updateData(Az.v);}},onkeyup:function(Ay){mstrmojo.ui.SearchablePulldown.prototype.onkeyup.call(this,Ay);var Az=this[this.editableSlot],A0=Az.innerText||Az.textContent;this.updateData(A0);},updateTooltipConfig:function(Az){this.tooltipOpenDelay=Az?500:0;var Ay=V.position(this.domNode);this.richTooltip={content:mstrmojo.desc(14114,'Pattern determines the formatting for the resulting string of characters. You can use the custom numeric, date, and time formatting symbols. <br/> Example: if pattern is defined as "0,000.00" for "1001", it returns the string "1,001.00"'),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:Ay.y-2,left:Ay.x+Ay.w+10};}};},Ao=function(A2,A1,Au,Av,A0){var Ax=Ae(A2,A1),Az=Ag(A1,AJ[Ax].v),Aw=A1.fnm,Ay=AJ;if(Ax>0){Ay=AS;Ax--;}Av[Aw+AN]="";Av[Aw+An]="";Av[Aw+AX]="";Av[Aw+An+As]=Av[Aw+AN+As]=Aq.UNCHANGED;if(A0){Au.push({scriptClass:"mstrmojo.HBox",cssClass:"func-input",alias:Aw+An,children:[{scriptClass:"mstrmojo.Label",text:Aw,useRichTooltip:true,updateTooltipConfig:function(A5){this.tooltipOpenDelay=A5?500:0;var A4=this.domNode;var A3=V.position(A4);if(A4.scrollWidth>A4.offsetWidth){this.richTooltip={content:A4.innerText,posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-V",top:A3.y-A3.h-10,left:A3.x-10};}}},AI(Ay,Ax,A1,true)]});Au.push({scriptClass:"mstrmojo.HBox",cssClass:"pattern-input",alias:Aw+AN,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12078,"Pattern")},AR(A1,Az,true)]});}else{Au.push(AI(Ay,Ax,A1,false));Au.push(AR(A1,Az,false));}};q.forEach(Ac.fs,function(Au){if(AH.als&&AH.als.links[Ac.did+" "+Au.fid]){Aj=true;return false;}});if(At){Aa.forEach(function(Au){Ao(Ac,Au,AV?Ad:Ah,Ar,true);});}else{Ao(Ac,Aa[0],Ah,Ar,false);}if(AV){Ah.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"formList",cssClass:"formList",children:Ad});}Ah.push({scriptClass:"mstrmojo.Label",cssClass:"advancedLabel",alias:"advancedLabel",allowHTML:true,text:"<span>"+mstrmojo.desc(702,"Advanced")+"</span>",onclick:function(){var Av=this.parent,Aw,Au,Ax=true;AO=!AO;D.toggleClass(this.domNode,"expanded",AO);Aa.forEach(function(Ay){AL(Av,Ay,false);Aw=AV?Av.formList[Ay.fnm+AN]:Av[Ay.fnm+AN];Au=At?Aw.children[1]:Aw;if(Aw.visible&&Ax&&!AV){Ax=false;Au.showTooltip();}});}});return new mstrmojo.ui.menus.EditorConfig({data:Ar,cssClass:"ConfDataType-MenuEditor",contents:Ah,onOpen:function(){AY(this);},bindings:{okEnabled:"this.data.okEnabled"},fnOk:function AQ(Aw){var Au=[],Ay=[],Av=false,Ax=function(A1,A2,A0){var A4=[],A3=function(A5){var A6=A5.ftk&&A5.ftk.slice(2,-2);if(!A6){return null;}while((A6.shift()).v!=="("){}return A6;},Az=A3(A0)||[y(Ac,A0)];A4.push({v:"!",tp:33,lv:4});if(A1!==AT){A4.push({v:A1,oi:{did:AP[A1],t:11,st:2816,n:A1}});if(!mstrmojo.string.isEmpty(A2)&&A2!==AK&&(A1===AZ||A1===Ak)){A4.push({v:'<Pattern="'+A2+'">(',tp:"2",lv:1});}else{A4.push({v:"(",tp:"2",lv:1});}A4=A4.concat(Az);A4.push({v:")",tp:"2",lv:1});}else{A4=A4.concat(Az);}A4.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:A4});};if(Aj){Av=true;}else{Aa.forEach(function(Az){if(Aw[Az.fnm+An+As]===Aq.TO_CREATE){Av=true;return false;}else{if(Aw[Az.fnm+An+As]===Aq.TO_UPDATE||(Aw[Az.fnm+AN+As]===Aq.TO_UPDATE&&(Aw[Az.fnm+An]===AZ||Aw[Az.fnm+An]===Ak))){Ay.push(Az);}}});}if(Av){Aa.forEach(function(Az){Au.push({n:Az.fnm,formula:Ax(Aw[Az.fnm+An],Aw[Az.fnm+AN],Az),bft:Aw[Az.fnm+AX]});});Ap(Av,Au);}else{if(Ac.da){W(AH.mid,Ac.did,Ay,function(Az){Az.forEach(function(A0){Au.push({did:A0.fid,formula:Ax(Aw[A0.fnm+An],Aw[A0.fnm+AN],A0),bft:Aw[A0.fnm+AX]});});Ap(Av,Au);});}}}});},getCreateTimeDAEditorCfg:function O(AL,AK){var AJ=function(AP){var AQ=8,AR=1,AO=q.filter(AP.fs,function(AS){return(AP.da||AS.obf)&&(AS.bftp===AQ||AS.bftp===AR);}),AN=q.find(AO,"idf",true);return AO[AN>=0?AN:0];},AH=AJ(AL);if(!AH){return null;}return new mstrmojo.ui.menus.EditorConfig({data:{okEnabled:false},cssClass:"CreateTimeAttribute-MenuEditor",contents:[{scriptClass:"mstrmojo.ui.CheckList",alias:"time_type",items:[{n:mstrmojo.desc(873,"Year"),v:"Year"},{n:mstrmojo.desc(10051,"Quarter of Year"),v:"QuarterOfYear"},{n:mstrmojo.desc(10050,"Quarter"),v:"Quarter"},{n:mstrmojo.desc(10049,"Month of Year"),v:"MonthOfYear"},{n:mstrmojo.desc(871,"Month"),v:"Month"},{n:mstrmojo.desc(10047,"Week of Year"),v:"WeekOfYear"},{n:mstrmojo.desc(10048,"Week"),v:"Week"},{n:mstrmojo.desc(11608,"Day of Year"),v:"DayOfYear"},{n:mstrmojo.desc(10046,"Day of Month"),v:"DayOfMonth"},{n:mstrmojo.desc(10045,"Day of Week"),v:"DayOfWeek"}],onchange:function AI(){var AN=false;X.forEach(this.selectedIndices,function(AO){if(AO){AN=true;return false;}});this.parent.data.set("okEnabled",AN);}}],bindings:{okEnabled:function(){return this.data.okEnabled;}},fnOk:function AM(AS,AT){var AX=AT.time_type,AW=AX.selectedIndices,AU=AX.items,AR=[],AN=[],AO="@form",AQ={Year:"6F7DF5F8449111D5BEA300B0D01A55EF",Quarter:"6F7DF5F7449111D5BEA300B0D01A55EF",Concat:"6F7DF5FF449111D5BEA300B0D01A55EF",QuarterStartDate:"59E10CE2ADDD4A6DAC2416A72999A9ED",Month:"6F7DF5F6449111D5BEA300B0D01A55EF",ToString:"D1ED29645DEC4DBF99E8E09ED939074B",MonthStartDate:"7C63D4E70B2741C3A5B54A2EFD40961B",Week:"6F7DF5F5449111D5BEA300B0D01A55EF",WeekStartDate:"44681336D0DB4E43AC333FFB3CC4400D",DayOfMonth:"6F7DF5F2449111D5BEA300B0D01A55EF",DayOfWeek:"6F7DF5F3449111D5BEA300B0D01A55EF",DayOfYear:"6F7DF5F4449111D5BEA300B0D01A55EF"},AV=function(AY){switch(AY){case"Year":return{ID:["Year","(",AO,")"]};case"Quarter":return{ID:["Year","(",AO,") * 10 + ","Quarter","(",AO,")"],DESC:["Concat",'("Q", ',"Quarter","(",AO,")",', ", ", ',"Year","(",AO,"))"],DATE:["QuarterStartDate","(",AO,")"]};case"QuarterOfYear":return{ID:["Quarter","(",AO,")"],DESC:["Concat",'("Q", This@ID)']};case"Month":return{ID:["Year","(",AO,") * 100 + ","Month","(",AO,")"],DESC:["ToString",'<Pattern="mmm yyyy">(',AO,")"],DATE:["MonthStartDate","(",AO,")"]};case"MonthOfYear":return{ID:["Month","(",AO,")"],DESC:["ToString",'<Pattern="mmmm">(',AO,")"]};case"Week":return{ID:["Year","(",AO,") * 100 + ","Week","(",AO,")"],DESC:["Concat",'("W", ',"Week","(",AO,'), ", ", ',"Year","(",AO,"))"],DATE:["WeekStartDate","(",AO,")"]};case"WeekOfYear":return{ID:["Week","(",AO,")"]};case"DayOfMonth":return{ID:["DayOfMonth","(",AO,")"]};case"DayOfWeek":return{ID:["DayOfWeek","(",AO,")"],DESC:["ToString",'<Pattern="ddd">(',AO,")"]};case"DayOfYear":return{ID:["DayOfYear","(",AO,")"]};}},AP=function(AY,Aa,Ac){var Ab=[{v:"!",tp:33,lv:4}],AZ;Ac.forEach(function(Ae,Ad){if(Ae===AO){Ab.push(y(AY,Aa));}else{AZ=AQ[Ae];if(AZ){Ab.push({v:AZ,oi:{did:AZ,t:11,st:2816,n:AZ}});}else{Ab.push({v:Ae,tp:"2",lv:1});}}});Ab.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Ab});};X.forEach(AW,function(AY,AZ){if(AY){AN=[];X.forEach(AV(AU[AZ].v),function(Aa,Ab){AN.push({n:Ab,formula:AP(AL,AH,Aa),bft:(Ab==="DATE"?8:0)});});AR.push({isTokenStream:true,forms:AN,name:AL.n+" ("+AU[AZ].n+")"});}});return AK(AR);}});},RefreshAndCloseAllObjectBrowserCallback:function(AI,AH){return mstrmojo.func.wrapMethods(AH.getDatasetsUpdateCallback(),{success:function(){if(q.find(AI,"act","createDataset")!==-1){AH.controller.datasetsPanel.set("allObjectBrowserOpened",false);}}});},getUnitFromDataset:function a(AI,AK,AH){var AJ=null;X.forEach(AI,function(AM){var AL=AM.att||[];if(AH===4){AL=AM.mx||[];}q.forEach(AL,function(AN){if(AN.did===AK){AJ=AN;return false;}});if(AJ){return false;}});return AJ;},getDatasetFromId:function P(AH,AI){var AJ=null;X.forEach(AH,function(AK){if(AK.did===AI){AJ=AK;return false;}});return AJ;},getDatasetFromAttributeId:function P(AH,AI){var AJ=null;X.forEach(AH,function(AK){if(q.find(AK.att,"did",AI)>=0){AJ=AK;return false;}});return AJ;},getSortedDatasetUnits:function E(AH){var AI=function AI(AJ){return AJ.t===U.DssTypeMetric?2:1;};AH=AH.concat();AH.sort(function(AM,AK){var AN=AI(AM)-AI(AK),AL=AM.n.toUpperCase(),AJ=AK.n.toUpperCase();return AN!==0?AN:(AL!==AJ?AL.localeCompare(AJ):AM.n.localeCompare(AK.n));});return AH;},getUnitCssClass:function(AI){var AH=AI.t;if(AI.fs&&AI.fs.length&&AI.fs.some(function(AJ){return AJ.fgr>0;})){AH+="g";}else{if((AI.dm||AI.um)||AI.da){AH+="d";}else{if(AI.de){AH+="de";}}}if((AI.t===47&&AI.st===12033)||(AI.t===12&&AI.st&&AI.st===3076)){AH+=(" st"+AI.st);}return"ic"+AH;},hasMultiForms:function k(AI,AH){return o.getFormsByAttrId(AI,AH).length>1;},getDisplayFormsMenu:function G(AT,AR,AL,AQ){var AP=[],AS=[],AK=[],AN=[{n:mstrmojo.desc(2411,"Off"),v:0},{n:mstrmojo.desc(2410,"On"),v:1},{n:mstrmojo.desc(8504,"Form Name Only"),v:2},{n:mstrmojo.desc(8505,"Show Attribute Name Once"),v:3},{n:mstrmojo.desc(4531,"Automatic"),v:4}];var AM=AR.model.data,AH=AM.gts,AO;q.forEach((AH.row||[]).concat(AH.col||[]),function(AU){if(AU.id===AT.did){AS=AS.concat(AU.fs);}});AO=o.getFormsByAttrId(AT.did,AL);q.forEach(AO||[],function(AV){var AW=AV.fid;if(q.find(AP,"id",AW)<0){AP.push({id:AW,n:AV.fnm});var AU=q.find(AS,"id",AW);if(AU>-1){AK[AP.length-1]=true;}}});return new mstrmojo.ui.menus.EditorConfig({data:{item:AT,oldSelected:X.copy(AK,{})},contents:[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:AP,selectedIndices:AK},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11918,"Display attribute form names:")},{alias:"longNames",scriptClass:"mstrmojo.ui.Pulldown",items:AN,selectedIndex:q.find(AN,"v",AM.lnm||0),onitemSelected:function AI(AU){this.v=String(AU.v);}}],okBtnText:mstrmojo.desc(1442,"Ok"),fnOk:function AJ(AZ,Ad){var AY=Ad.fs,AW=AY.selectedIndices,Ab=AY.items,Ah=[],Aa=[],Ae=[];if(!AY.getSelectedItems().length){mstrmojo.alert("Please select at least one form!");return ;}var AV=AZ.oldSelected,Ag=AW,AX,Ac={},Af={};for(AX=0;AX<Ab.length;AX++){if(AV[AX]&&!Ag[AX]){Ac[AX]=true;}else{if(!AV[AX]&&Ag[AX]){Af[AX]=true;}}}X.forEach(Ac,function(Ai,Aj){if(Ai){Aa.push({act:"removeForm",unitId:AT.did,attFormId:Ab[Aj].id});}});var AU=AR.model.data.gts;(AU.row||[]).concat(AU.col||[]).forEach(function(Ai){if(Ai.id===AT.did){(Ai.fs||[]).forEach(function(Aj){if(q.find(AP,"id",Aj.id)<0){Aa.push({act:"removeForm",unitId:AT.did,attFormId:Aj.id});}});}});X.forEach(Af,function(Ai,Aj){if(Ai){Ah.push({act:"addForm",unitId:AT.did,attFormId:Ab[Aj].id,unitPos:0});}});Ae.push({act:"putProperties",prs:"Template Formatting",pr:"LongNames",v:Ad.longNames.v});if(AQ){AQ([{act:"updateTemplate",keyContext:AR.k,partialRetrieval:{nodes:[AR.k]},actions:Aa.concat(Ah).concat(Ae)}]);}}});},getAttributeLinkMenu:function d(AT,AW,AR,AV,AM){var AX=-2147483648,AO=AV.datasets,AP=AO[AR],AU=AP.tables||[],AH={},AQ=[],AK=(AW.fs&&AW.fs[0])||{},AS=[],AN=779,AJ=AW.art>1,AI=!AJ&&X.keyarray(AO).length>1,AL=function(){mstrmojo.vi.ui.editors.AttributeLinkEditor.open({attribute:AW,docModel:AV,datasetId:AR});};if((AP.st!==AN)||AU.length<=1||AW.da){if(AI){AT.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AL);}return ;}q.forEach(AP.att,function(Aa){var Ab=true,AZ=null,AY=(Aa.fs&&Aa.fs[0])||{};if(Aa.da){return ;}if(AK.der===AX||AY.der===AX||AK.fgr===-1||AY.fgr===-1||AK.ftr===-1||AY.ftr===-1){return ;}if(AK.fgr&&AY.fgr&&AK.fgr!==AY.fgr){return ;}if(AK.ftr&&AY.ftr&&AK.ftr!==AY.ftr){return ;}q.forEach(AU,function(Ac){var Ad=q.find(Ac.attRefs,"did",AW.did),Ae=q.find(Ac.attRefs,"did",Aa.did);if(Ad>=0&&q.indexOf(AQ,Ac.did)<0){AQ.push(Ac.did);}if(Ae>=0){AZ=Ac.did;}if(Ad>=0&&Ae>=0){Ab=false;}});if(Ab&&!Aa.hide){AH[Aa.did]=AZ;AS.push(Aa);}});if(AS.length>0&&AP.hcs!==true){AT.addEditorMenuItem(mstrmojo.desc(13172,"Map Attributes"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mapAttribute",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:AS,listHooks:{select:function AY(AZ,Aa){AV.warnForEditStandaloneDS(AP,function(){q.forEach(AQ,function(Ab){I({dsid:AR,srcId:AW.did,srcTableId:Ab,tgtId:Aa.did,tgtTableId:AH[Aa.did]},AV,AM);});});}}}]}]});});}if(AI){AT.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AL);}},isDocumentLevelItem:function r(AH){return AH&&(AH.um||AH.da||(AH.t===47&&AH.st===12033));},isLegalObjectName:function Q(AH){var AI=/["\[\]\\]/g;if(AH.match(AI)){return false;}return true;},validateName:function f(AI,AJ,AH){if(this.isLegalObjectName(AI)){AJ();}else{mstrmojo.alert(mstrmojo.desc(8622,"The # cannot contain the reserved characters ##.").replace("##","'[', ']', '\"' and '\\'").replace("#",mstrmojo.desc(945,"Name")),AH,mstrmojo.desc(1388,"Rename"));}},hasCGorCon:function AG(AH){return AH.att.some(function(AJ){var AL=(AJ.t===1||AJ.t===47),AK=(AJ.t===12&&AJ.de),AI=(AJ.t===47&&AJ.st===12033);return(AL&&!AI||AK);});},hasOldDEOverDatasets:function(AK,AJ){var AI=false,AH;X.forEach(AJ,function(AL){AH=q.find((AL.att||[]),"did",AK);if(AH!==-1&&AL.att[AH].de){AI=true;return false;}});return AI;},getMarkGeoRoleEditorCfg:function AD(AH,At,Ab,AY,A2,A4){var AX=268435456,Az=536870912,AM=1073741824,Al=268435456,Aw=805306368,Ar=805306368,Af=1879048192,A3=-2147483648,Au=0,Av=1,AO=2,AW=3,Aa=4,AU=5,A1=6,AR=7,Ad=8,Ac=9,An=10,AK=2,Ak=3,As={v:Au,n:mstrmojo.desc(2057,"None")},A5={v:AW,n:mstrmojo.desc(7674,"Country"),der:AX},Aq={v:AO,n:mstrmojo.desc(7676,"State"),parents:[A5],der:Az},AS={v:Ac,n:mstrmojo.desc(12919,"County"),parents:[A5,Aq]},Ax={v:Av,n:mstrmojo.desc(7675,"City"),parents:[A5,Aq],der:AM},Ag={v:Ad,n:mstrmojo.desc(7677,"Zip Code"),parents:[A5,Aq,Ax]},AZ={v:AU,n:mstrmojo.desc(7696,"Latitude")},Ao={v:A1,n:mstrmojo.desc(7697,"Longitude")},AV={v:Aa,n:mstrmojo.desc(7675,"City")+", "+mstrmojo.desc(7676,"State")},Aj={v:An,n:mstrmojo.desc(12973,"Area Code")},Am={v:AR,n:mstrmojo.desc(2056,"Custom")},AT={ID:[As,A5,Aq,AS,Ax,Ag,AZ,Ao,AV,Aj,Am],ID_NUMERIC:[As,Ag,Aj,AZ,Ao],NON_ID:[As,A5,Aq,AS,Ax,Ag,AV,Aj,Am],NON_ID_NUMERIC:[As,Ag,Aj]},Ah=q.filter(At.fs,function(A6){return(A6.bftp===AK||A6.bftp===Ak)&&A6.der!==A3;});var Ap=(Ah.length>1),AJ=q.find(Ah,"idf",true),AL=(AJ===-1?0:AJ),Ai=Ah[AL],AQ,AI,Ae,AN=[],AP=function(A6){var A7=(A6.idf?"ID":"NON_ID")+(A6.bftp===AK?"_NUMERIC":"");return AT[A7];},A0=function(A7,A6){return q.find(AP(A6),"v",A7);};if(Ah.length===0||q.find(At.fs,"fgr",-1)!==-1||Ai.der===A3){return null;}q.forEach(Ah,function(A8,A6){var A7=X.clone(A8);A7.n=A7.fnm;AN.push(A7);if(A8.fgr){Ai=A7;AL=A6;}});AQ=Ai.fid;Ae=Ai.fgr||0;AI=A0(Ae,Ai);return new mstrmojo.ui.menus.EditorConfig({data:{item:At,geoForm:Ai,geoRole:Ae},cssClass:"MarkGeoRole-MenuEditor",contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13522,"Select Attribute Form:"),visible:Ap},{scriptClass:"mstrmojo.ui.Pulldown",items:AN,selectedIndex:AL,alias:"formList",visible:Ap,onitemSelected:function Ay(A8){var A6=this.parent.data,A7=this.parent.geoRoleList;if(A6.geoForm.fid!==A8.fid){A6.set("geoForm",A8);A6.set("geoRole",A8.fgr);A7.set("items",AP(A8));A7.set("selectedIndex",A0(A8.fgr,A8));}}},{scriptClass:"mstrmojo.ToolSeparator",visible:Ap,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13523,"Select Geographic Type:")},{scriptClass:"mstrmojo.ui.Pulldown",items:AP(Ai),selectedIndex:AI,alias:"geoRoleList",onitemSelected:function Ay(BC){var BB=this.parent,A6=BB.data,BD=BB.geoDrvList;var A8=[],BA=[],A7=Ai.der,A9;A6.set("geoRole",BC.v);q.forEach(BC.parents,function(BE,BF){A9=BE;A8.push({n:A9.n,der:A9.der});if((A7&A9.der)!==0){BA[BF]=true;}});BD.set("items",A8);BD.set("selectedIndices",BA);q.forEach(["geoDrvSeparator","geoDrvLabel","geoDrvList"],function(BE){BB[BE].set("visible",A8.length>0);});}},{scriptClass:"mstrmojo.ToolSeparator",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},alias:"geoDrvSeparator"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13524,"(Optional) Create Additional Attributes:"),alias:"geoDrvLabel"},{scriptClass:"mstrmojo.ui.CheckList",alias:"geoDrvList"}],fnOk:function(A9,A8){var A6=function(BF){var BE=function(BJ){var BK="<mpcs>";q.forEach(BJ,function(BL){BK+='<mpc did="'+BL.did+'" n="'+BL.n+'" georole="'+BL.georole+'" drvflg="'+BL.drvflg+'" />';});BK+="</mpcs>";return BK;},BA=function(BJ,BL,BN,BK){var BM=function(BR,BO,BQ){var BP=R(BF,BR,BO),BS=h(BP,BQ);return BS&&BS.did;};A2.forEach(function(BO,BP){var BQ=BM(BO.did,At.did,BL.fid);if(BQ){BJ[BP]=BJ[BP]||[];BJ[BP].push({did:BQ,n:BL.fnm,georole:BN,drvflg:BK});}});},BC=[],BI=[],BG=A8.geoDrvList,BB=0,BD=false,BH={2:Al,1:Aw,9:Ar,8:Af}[A9.geoRole]||0;X.forEach(BG.selectedIndices,function(BK,BJ){if(BK){BB|=BG.items[BJ].der;}});BB&=BH;if(Ai.fgr!==A9.geoRole||Ai.fid!==A9.geoForm.fid||Ai.der!==BB){if(Ap&&Ai.fid!==A9.geoForm.fid){if(Ai.fgr!==Au){BA(BI,Ai,Au,0);if(Ai.der>0){BD=true;}}}if(A9.geoForm.fgr!==A9.geoRole||A9.geoForm.der!==BB){BA(BI,A9.geoForm,A9.geoRole,BB);if((BB&A9.geoForm.der)!==A9.geoForm.der){BD=true;}}if(BI.length>0){BI.forEach(function(BK,BJ){BC.push({act:"changeEMMAMapping",dsid:Ab,tbid:A2[BJ].did,mapping:BE(BK)});});A4(BC,BD);}}},A7=function(){C(AH.mid,Ab,{success:A6});};if(!AY){mstrmojo.warn(mstrmojo.desc(13525,"Modifications to this dataset will affect other reports, documents, and dashboards that share the dataset. Do you want to continue?"),{},{buttons:[t(mstrmojo.desc(219,"Yes"),function(){A7();},true,{width:"60px"}),t(mstrmojo.desc(221,"Cancel"),function(){})]});}else{A7();}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.elementHelper","mstrmojo.func","mstrmojo.VisEnum","mstrmojo.num","mstrmojo.array","mstrmojo.VisMenuList","mstrmojo.mstr.EnumFunction","mstrmojo._HasMarkup","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.models.FormatModel","mstrmojo.css","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.ui.DatasetUnitMenuUtils");mstrmojo.requiresClsP("mstrmojo.ui.menus","MenuConfig","EditorConfig");var o=document.getElementById("vis-measure-canvas"),A=document.getElementById("vis-measure-span"),AD={},Y={},s={},S=mstrmojo.dom,d=mstrmojo.elementHelper,r=mstrmojo.vi.ui.DatasetUnitMenuUtils,AB=mstrmojo.VisEnum.EnumColorRankMode,AC=mstrmojo.chart.model.enums.EnumDSSObjectType,c=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,J=mstrmojo.chart.enums.EnumFontStyle,T=mstrmojo.hash,R=mstrmojo.func.wrapMethods,x=mstrmojo.VisEnum,e=x.SERVER_JSON_ERROR_TYPE;var q=64,f=128,O=4,m=5,w=6,y=7,k=mstrmojo,l=k.array,u=mstrmojo.array,P=k.desc,AA=k.mstr.EnumFunction,a=mstrmojo.vi.enums.EnumDerivedElementType,Z=k._HasMarkup,F=k.css;mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869);function AF(AL,AK){var AM=p.pluck(AK,"tid"),AN=p.pluck(AK,"eid"),AJ=(AL.getDocModel&&AL.getDocModel())||p.getPropertyByPath(AL,"model.docModel");if(p.getPropertyByPath(AJ,"getColorBy") instanceof Function){return AJ.getColorBy(AM,AN);}}function AE(AJ,AL,AN){var AM=AL.id,AK=AL.getHost();if(AK&&AK.observableModel){AJ.forEach(function(AP){var AO=AK.observableModel[AP];if(AO){AO.attachEventListener("valueChanged",AM,AN);}});}}function U(AK){var AJ={SINGLE:[{text:P(358,"Absolute"),value:AA.FunctionAbs,n:P(358,"Absolute"),v:AA.FunctionAbs}],PAIR:[{text:P(6017,"Add"),value:AA.FunctionAdd,n:P(6017,"Add"),v:AA.FunctionAdd},{text:P(2122,"Average"),value:AA.FunctionAverage,n:P(2122,"Average"),v:AA.FunctionAverage},{text:P(5868,"Least"),value:AA.FunctionLeast,n:P(5868,"Least"),v:AA.FunctionLeast},{text:P(5869,"Greatest"),value:AA.FunctionGreatest,n:P(5869,"Greatest"),v:AA.FunctionGreatest},{text:"A-B",value:AA.FunctionMinus+";0",n:"A-B",v:AA.FunctionMinus+";0"},{text:"B-A",value:AA.FunctionMinus+";1",n:"B-A",v:AA.FunctionMinus+";1"},{text:"A/B",value:AA.FunctionDivide+";0",n:"A/B",v:AA.FunctionDivide+";0"},{text:"B/A",value:AA.FunctionDivide+";1",n:"B/A",v:AA.FunctionDivide+";1"}],MORE:[{text:P(6017,"Add"),value:AA.FunctionAdd,n:P(6017,"Add"),v:AA.FunctionAdd},{text:P(2122,"Average"),value:AA.FunctionAverage,n:P(2122,"Average"),v:AA.FunctionAverage},{text:P(5868,"Least"),value:AA.FunctionLeast,n:P(5868,"Least"),v:AA.FunctionLeast},{text:P(5869,"Greatest"),value:AA.FunctionGreatest,n:P(5869,"Greatest"),v:AA.FunctionGreatest}]};return AJ[AK];}function B(AK,AJ){return !!(((AK&&AK.at)||0)&AJ);}function N(AJ){return !AJ.selCells.some(function(AK){var AL=AJ.getCellForNode(AK);return d.isNonGroupNull(AL)||!B(AL,q)||AL.dei!==undefined||AJ.model.isRecursiveAttribute(AL.tid);});}function I(AK){var AJ;return !AK.selCells.some(function(AL){AJ=AK.getCellForNode(AL);return(d.isNonGroupNull(AJ)||!B(AJ,f))||AK.model.isRecursiveAttribute(AJ.tid);});}function E(AM,AL,AO,AN,AK){var AJ=AO&&AO.func;if((AJ===AN)||(typeof AN==="string"&&AN.indexOf(AJ)===0&&AN.indexOf(";0")>0)){return ;}if(AK){AM.editDECalculation(AL,AN);}else{AM.derivedElementCalculation(AL,AN);}}function M(AV,AT,AR){var AU=AT&&AT.es,AJ=(AU&&AU.length)||AV.selCells.length,AM=(AJ===1)?"SINGLE":((AJ===2)?"PAIR":"MORE"),AS=U(AM),AL=(AT&&AT.func),AN,AW=AV.selCells,AK,AQ,AP,AO;if(AM==="PAIR"){if(AT){AO=AU[0].v>AU[1].v;if(AO){AP=AU[0].n;AQ=AU[1].n;AS[4]={value:AA.FunctionMinus+";1",v:AA.FunctionMinus+";1"};AS[5]={value:AA.FunctionMinus+";0",v:AA.FunctionMinus+";0"};AS[6]={value:AA.FunctionDivide+";1",v:AA.FunctionDivide+";1"};AS[7]={value:AA.FunctionDivide+";0",v:AA.FunctionDivide+";0"};}else{AQ=AU[0].n;AP=AU[1].n;}}else{AQ=AR(AW[0]);AP=AR(AW[1]);}AS[O].text=AQ+" - "+AP;AS[m].text=AP+" - "+AQ;AS[w].text=AQ+" / "+AP;AS[y].text=AP+" / "+AQ;AS[O].n=AQ+" - "+AP;AS[m].n=AP+" - "+AQ;AS[w].n=AQ+" / "+AP;AS[y].n=AP+" / "+AQ;}for(AN in AS){if(typeof AS[AN].value==="string"&&AS[AN].value.indexOf(AL)===0&&AS[AN].value.indexOf(";0")>0){AK=AS[AN];break;}if(AS[AN].value===AL){AK=AS[AN];break;}}return{items:AS,selectedItem:AK};}function V(AJ,AM){if(!AJ){return AJ;}if(AM.length===1){return AJ[AM[0]];}var AL=(AM&&AM.length)||0,AK;for(AK=0;AK<AL;AK++){AJ=AJ[AM[AK]];if(!AJ){break;}}return AJ;}function z(AL,AK,AJ){return AL.every(function(AM){return AM.ttp===AK||AM.ttp===AJ;});}function AI(AK,AN,AO){var AM=(AN&&AN.length)||0,AL,AJ,AP=AK;for(AL=0;AL<AM-1;AL++){AJ=AN[AL];if(!AP[AJ]){AP[AJ]={};}AP=AP[AJ];}AP[AN[AM-1]]=AO;}function X(AR){var AS,AQ,AM,AO,AJ,AP=this.model.docModel.datasets,AK=false,AN=false,AL={isDM:false};for(AS in AP){if(AP.hasOwnProperty(AS)){AQ=AP[AS].mx;l.forEach((AQ||[]),function(AT){if(AT.did===AR){if(AT.um||AT.rdm){AN=true;}AK=true;return false;}});if(AK){break;}}}if(AN){AJ=this.model.data.gts.col;AM=(AJ&&AJ[AJ.length-1]);if(AM&&AM.otp===-1){AO=AM.es;}l.forEach((AO||[]),function(AT){if(AT.oid===AR){AL={isDM:true,id:AT.id};return false;}});}return AL;}function H(AJ,AM){var AP=[],AL={act:"updateElementsPropertiesMap",epm:AP},AN=[],AK={},AR=[AK],AQ=this;AP.push({epmk:AN,epmv:AR});AJ.forEach(function(AT){var AU=AT.tid,AS=AU===-1,AV={ob:{did:AS?"":AU}};AN.push(AV);});if(AM&&AM.indexOf("default")<0){AK.v={vv:AM};}var AO=[];AK.k={chn:AO};AJ.forEach(function(AU){var AV=AU.tid,AS=AV===-1,AT;if(AS){AT=X.call(AQ,AU.eid);if(AT.isDM){AO.push({emt:2,ei:AT.id});}else{AO.push({emt:2,mt:{did:AU.eid,tp:4,ql:0}});}}else{AO.push({emt:1,ei:AU.eid,at:{did:AV,tp:AU.tp,ql:0}});}});return AL;}function C(AN,AL){var AM="00000000000000000000000000000000",AK=AN&&AN.dropZones,AJ=l.find(AK,"id",AL);return AJ===-1?[]:l.filter(AK[AJ].items,function(AO){return AO.t===4&&AO.id!==AM;});}function b(AK,AJ){return function(){var AL=new k.ui.menus.MenuConfig();AL.addNonInteractiveMenuItem(mstrmojo.desc(11859,"Based on"),"xt",true);AL.addRadioMenuGroup(null,AK,AJ,"checkMark",undefined,true);return AL;};}mstrmojo.VisUtility=mstrmojo.provide("mstrmojo.VisUtility",{getCache:function(){return JSON.stringify(s);},getUpdateColorMapAction:function(AK,AJ){return H.call(this,AK,AJ);},measureTextSize:function(AK,AJ,AL){return{width:this.measureTextWidth(AK,AJ,AL),height:this.measureTextHeight(AK,AJ,AL)};},measureTextWidth:function(AM,AL,AN,AK,AJ){if(S.isIE||S.isIEW3C){return this.measureTextWidthWithSpan(AM,AL,AN,AK,AJ);}return this.measureTextWidthWithCanvas(AM,AL,AN);},measureTextWidthWithCanvas:function(AM,AN,AQ,AO){AO=AO||false;if(AM===""){return 0;}if(AM===" "){AM="\u00A0";}var AP=AN.fontFamily,AS=AN.fontSize,AL=AN.fontStyle,AR=AN.fontWeight;if(typeof AS==="number"){AS+="pt";}AL=AL||"normal";AR=AR||"normal";AQ=AQ||0;var AK=AO?undefined:V(AD,[AP,AS,AL,AR,AM]);if(!AK){if(!o){o=document.createElement("canvas");o.width=0;o.height=0;o.id="vis-measure-canvas";o.style.position="absolute";o.style.top="0";o.style.fontSize="medium";document.body.appendChild(o);}var AJ=o.getContext("2d");AJ.font=AL+" "+AR+" "+AS+" "+AP;AK=Math.ceil(AJ.measureText(AM).width);AI(AD,[AP,AS,AL,AR,AM],AK);}return AK+AQ;},measureTextWidthWithSpan:function(AL,AM,AQ,AS,AN){if(AL===""){return 0;}if(AL===" "){AL="\u00A0";}var AO=AM.fontFamily,AT=AM.fontSize,AK=AM.fontStyle,AP=AM.fontWeight;if(typeof AT==="number"){AT+="px";}AK=AK||"normal";AP=AP||"normal";AS=AS||"auto";AQ=AQ||0;AN=!!AN;if(typeof AS==="number"){AS+="px";}var AJ=V(Y,[AO,AT,AK,AP,AS,AL]);if(!AJ){var AR;if(!A){A=document.createElement("span");AR=A.style;A.id="vis-measure-span";AR.position="absolute";AR.top="0";AR.visibility="hidden";AR.width="auto";AR.height="auto";if(AN){AR.whiteSpace="nowrap";}else{AR.whiteSpace="normal";}document.body.appendChild(A);}AR=A.style;if(AN){AR.whiteSpace="nowrap";}else{AR.whiteSpace="normal";}AR.width="auto";AR.height=AS;AR.fontFamily=AO;AR.fontSize=AT;AR.fontStyle=AK;AR.fontWeight=AP;A.innerHTML=AL;AJ=Math.ceil(A.clientWidth);AI(Y,[AO,AT,AK,AP,AS,AL],AJ);}return AJ+AQ;},measureTextHeight:function(AL,AM,AR,AT,AJ,AO,AN){if(AL===""){return 0;}if(AL===" "){AL="\u00A0";}var AP=AM.fontFamily,AV=AM.fontSize,AK=AM.fontStyle,AQ=AM.fontWeight;AJ=AJ||"normal";AN=!!AN;if(typeof AV==="number"){AV+="px";}AK=AK||"normal";AQ=AQ||"normal";AT=AT||"auto";AR=AR||0;if(typeof AT==="number"){AT+="px";}var AU=AO?undefined:V(s,[AP,AV,AK,AQ,AT,AL]);if(!AU){var AS;if(!A){A=document.createElement("span");AS=A.style;A.id="vis-measure-span";AS.position="absolute";AS.top="0";AS.visibility="hidden";AS.width="auto";AS.height="auto";if(AN){AS.whiteSpace="nowrap";}else{AS.whiteSpace="normal";}document.body.appendChild(A);}AS=A.style;if(AN){AS.whiteSpace="nowrap";}else{AS.whiteSpace="normal";}AS.heigth="auto";AS.width=AT;AS.fontFamily=AP;AS.fontSize=AV;AS.fontStyle=AK;AS.fontWeight=AQ;AS.wordBreak=AJ;A.innerHTML=AL;AU=A.clientHeight;if(!AO){AI(s,[AP,AV,AK,AQ,AT,AL],AU);}}return AU+AR;},getVisEmptyMsg:function(AJ){var AK="";switch(AJ){case"AE_ERROR":AK='<div class="gm-vis-msg-container"><div class="gm-vis-msg-vcenter"><div class="gm-vis-msg-hcenter"><div style="padding:25px"><div class="gm-warning-icon" style="padding-bottom:18px"></div><div style="padding-bottom:8px">'+mstrmojo.desc(14436,"Unable to load visualization.")+"</div><div>"+mstrmojo.desc(14437,"Use a filter to reduce the data and try again.")+"</div></div></div></div></div>";break;case"NODATA_OTHERERROR":AK='<div class="gm-vis-msg-container"><div class="gm-vis-msg-vcenter"><div class="gm-vis-msg-hcenter"><div>'+(this.errorMsg||mstrmojo.desc(12093,"Filter excludes all data"))+"</div></div></div></div>";break;default:AK='<div class="mstrmojo-Label dropMsg" style="display: block;" >'+mstrmojo.desc(11668,"Drag objects here.")+"</div>";}return AK;},applyStyles2DomNode:function(AO,AR){var AJ,AP=AO.style;if(Object.prototype.hasOwnProperty.call(AR,"backgroundColor")&&AR.backgroundColor!==""&&AR.backgroundColor!=="transparent"){var AN=1;if(Object.prototype.hasOwnProperty.call(AR,"opacity")&&AR.opacity!==""){AN=AR.opacity;}var AK=AR.backgroundColor,AQ=function AQ(AS){if(isNaN(AS)){AS=0;}AS%=16777216;return{b:AS%256,g:(AS>>8)%256,r:(AS>>16)%256};},AM="";if(AK){var AL=function AL(AT,AU){if(AT==="transparent"){return"rgba(0,0,0,0)";}AT=this.parseCSSColor(AT,false);var AS=AQ(AT);return"rgba("+AS.r+" ,"+AS.g+" ,"+AS.b+" ,"+AU+" )";}.bind(this);if(AK.c1!==undefined&&AK.c2!==undefined&&AK.or!==undefined){AM=(F.buildGradient(AK.or,AL(AK.c1,AN),AL(AK.c2,AN))).v;}else{AM=AL(AK,AN);}AP.background=AM;}}else{AP.backgroundColor="rgba(0,0,0,0)";}for(AJ in AR){if(AJ!=="backgroundColor"&&AJ!=="opacity"&&Object.prototype.hasOwnProperty.call(AR,AJ)&&AR[AJ]&&AR[AJ]!==""){AP[AJ]=AR[AJ];}}},parseCSSColor:function(AN,AK){var AJ,AL;if(AN.length===7){if(AK===true){AJ=AN[5]+AN[6]+AN[3]+AN[4]+AN[1]+AN[2];}else{AJ=AN.slice(1);}}else{AJ=[];var AM=AN.slice(1);if(AK===true){for(AL=2;AL>=0;AL--){AJ.push(AM[AL]);AJ.push(AM[AL]);}}else{for(AL=0;AL<3;AL++){AJ.push(AM[AL]);AJ.push(AM[AL]);}}AJ=AJ.join("");}return parseInt(AJ,16);},positionDomNode:function(AL,AN){var AK,AQ,AO,AM=["width","height","top","left","right","bottom"],AP=AM.length,AJ=AL.style;for(AK=0;AK<AP;AK++){AQ=AM[AK];AO=AN[AQ];if(AO!==undefined){if((typeof AO)==="number"){AO+="px";}AJ[AQ]=AO;}}},getComputedFontStyle:function G(AL){var AJ=mstrmojo.css.getComputedStyle(AL);var AM={};AM.fontFamily=AJ.fontFamily;AM.fontSize=AJ.fontSize;AM.fontStyle=AJ.fontStyle;AM.fontWeight=AJ.fontWeight;AM.fontVariant=AJ.fontVariant;var AK=parseInt(AJ.paddingLeft)||0,AN=parseInt(AJ.paddingLeft)||0;AM.bonus=AK+AN;return AM;},splitWordIfTooLong:function(AT,AR,AM){var AP=[];var AQ=AT.length;var AN;for(AN=0;AN<AQ;AN++){var AK=AT[AN];while(true){var AU=this.measureTextWidth(AK,AM);if(AU>AR){var AS=(AR/AU)*AK.length;var AJ=Math.max(Math.round(AS),1);while(AJ>0){var AO=AK.substr(0,AJ);var AL=Math.round(this.measureTextWidth(AO,AM));if(AL<=AR||AJ===1){AP.push(AO);break;}else{AJ--;}}AK=AK.substr(AJ,AK.length-AJ);}else{AP.push(AK);break;}}}return AP;},truncateTextToLineWithWordWrap:function Q(Aj,Ac,Aa,AP,Ab,AT){var AX=Aj.split(" "),Ad=AX.length;if(!AT){AX=this.splitWordIfTooLong(AX,Aa,Ac);}var Aq,AV=[],Al=[],AJ=0,AN=AX.length,As=this.measureTextWidth(" ",Ac),AM=0,AS=false,AZ=(Ad===AX.length);Al.push(0);for(Aq=0;Aq<AN;Aq++){var Ah=this.measureTextWidth(AX[Aq],Ac);if(!AT&&Ah>Aa){var AK=AX[Aq];var Ao=(Aa/Ah)*AK.length;AX[Aq]=AK.substr(0,parseInt(Ao,10));Ah=Aa;}AV.push(Ah);AJ+=Ah;Al.push(AJ);if(Aq!==AN-1){AJ+=As;}}var An,Ap,Af=AP;for(An=0,Ap=0;Ap<Al.length;){var AR=Al[Ap]-Al[An];if(An>0&&Ap!==An){AR-=As;}var AQ=Al[Ap+1]-Al[An];if(An>0&&Ap+1!==An){AQ-=As;}if(AR<=Aa&&((Ap+1===Al.length)||(AQ>Aa))){AM=Math.max(AM,AR);Af--;if(Af===0||Ap===AN){break;}else{An=Ap;Ap++;}}else{Ap++;}}if(Ap>AN){Ap=AN;}var AU=Al[Ap]-Al[An];if(An>0&&Ap!==An){AU-=As;}var Ai;if(Ap>=AN&&AU<Aa){Ai=AX.join(" ");}else{AS=true;AM=Aa;Ai=AX.slice(0,Ap).join(" ");var AW=this.measureTextWidth("...",Ac);if(AU+AW<=Aa){if(AU+As+AW>Aa){Ai+="...";}else{var Ar=AX[Ap],AY;for(var Ae=1;Ae<Ar.length;Ae++){AY=this.measureTextWidth(Ar.substr(0,Ae),Ac);if(AU+As+AY+AW>Aa){break;}}Ai+=" "+Ar.substr(0,Ae-1)+"...";}}else{if(Ai.charAt(Ai.length-1)===" "){Ai=Ai.substr(0,Ai.length-1);}var Ag=Ai.lastIndexOf(" ");var AL=Ai.length-1-Ag;if(AL===3){Ai=Ai.substr(0,Ai.length-3)+" ...";}else{var Ak=0,AO="",Am=0;while(Ak<AW&&Ai.length>Am){Am++;AO=Ai.substr(Ai.length-Am,Ai.length);Ak=this.measureTextWidth(AO,Ac);}Ai=Ai.substr(0,Ai.length-Am)+"...";}}}if(Ab){return{text:Ai,truncated:AS,maxLineLen:AM,canWordWrap:AZ};}return Ai;},measureSuperTextWidth:function AH(AK,AL,AJ,AM){return AK?this.measureTextWidth("<sup>"+AL+"</sup>",AJ,AM):this.measureTextWidth(AL,AJ,AM);},splitTokenIfTooLong:function h(AU,AS,AM){var AQ=[];var AR=AU.length;var AN,AK,AV,AP,AW;for(AN=0;AN<AR;AN++){AK=AU[AN];AP=AK.isSuper;while(true){AV=AK.v;if(AK.textWidth!==undefined){AW=AK.textWidth;}else{AW=AK.textWidth=this.measureSuperTextWidth(AP,AV,AM);}if(AW>AS){var AT=(AS/AW)*AV.length;var AJ=Math.max(Math.round(AT),1);while(AJ>0){var AO=AV.substr(0,AJ);var AL=Math.round(this.measureSuperTextWidth(AP,AO,AM));if(AL<=AS||AJ===1){AQ.push({v:AO,isSuper:AP,textWidth:AL});break;}else{AJ--;}}AK={v:AV.substr(AJ,AV.length-AJ),isSuper:AP};}else{AQ.push(AK);break;}}}return AQ;},truncateTextToLineWithWordWrapForTokens:function W(AT,AN,Am,Ae,An,AZ){var Ah=AT.length;AT=this.splitTokenIfTooLong(AT,Am,AN);var Al,AY=[],AJ=0,Ac=AT.length,AK=0,Ad=false,AP=(Ah===AT.length),AR,AW,Af,AL,Aj,AS,AX;if(AZ&&!AP){return{canWordWrap:AP};}AY.push(0);for(Al=0;Al<Ac;Al++){AR=AT[Al];Af=AR.v;AW=AR.isSuper;if(AR.textWidth!==undefined){AL=AR.textWidth;}else{AL=AR.textWidth=this.measureSuperTextWidth(AW,Af,AN);}if(AL>Am){var Ak=(Am/AL)*Af.length;AR.v=Af.substr(0,parseInt(Ak,10));AL=AR.textWidth=Am;}AJ+=AL;AY.push(AJ);}var AV,Ag,AU=Ae;for(AV=0,Ag=0;Ag<AY.length;){var AQ=AY[Ag]-AY[AV];var AO=AY[Ag+1]-AY[AV];if(AQ<=Am&&((Ag+1===AY.length)||(AO>Am))){AK=Math.max(AK,AQ);AU--;if(AU===0||Ag===Ac){break;}else{AV=Ag;Ag++;}}else{Ag++;}}if(Ag>Ac){Ag=Ac;}var Ab=AY[Ag]-AY[AV];var Ao;if(Ag>=Ac&&Ab<Am){Ao=AT;}else{Ad=true;AK=Am;Ao=AT.slice(0,Ag);var AM=this.measureTextWidth("...",AN);if(Ab+AM<=Am){AS=AT[Ag];Af=AS.v;AW=AS.isSuper;for(Aj=1;Aj<Af.length;Aj++){AX=this.measureSuperTextWidth(AW,Af.substr(0,Aj),AN);if(Ab+AM+AX>Am){break;}}if(Aj>1){AR={v:Af.substr(0,Aj-1),isSuper:AW};AR.textWidth=this.measureSuperTextWidth(AW,AR.v,AN);Ao.push(AR);Ao.push({v:"...",textWidth:AM});}}else{var Aa=0,Ai;for(Al=Ao.length-1;Al>=0;Al--){AR=Ao[Al];Af=AR.v;AW=AR.isSuper;Ai=0;for(Aj=Af.length-1;Aj>=0;Aj--){Ai=this.measureSuperTextWidth(AW,Af.substr(Aj),AN);if(Aa+Ai>=AM){break;}}if(Aj>=0){break;}else{Aa+=Ai;}}if(Al>=0){if(Aj>0){AR.v=Af.substr(0,Aj);AR.textWidth=this.measureSuperTextWidth(AW,AR.v,AN);Ao=Ao.slice(0,Al+1);}else{if(Aj===0){Ao=Ao.slice(0,Al);}}Ao.push({v:"...",textWidth:AM});}else{Ao=[{v:"...",textWidth:AM}];}}}if(An){return{text:Ao,truncated:Ad,maxLineLen:AK,canWordWrap:AP};}return Ao;},getRankMode:function g(AP){var AR=1,AQ=2,AO=3,AK=4,AM=5,AJ=6,AN=7,AL=AB.INVALID;if(AP){if(z(AP,AO,AQ)){AL=AB.TOP_PERCENT;}else{if(z(AP,AO,AR)){AL=AB.BOTTOM_PERCENT;}else{if(z(AP,AJ,AK)){AL=AB.BOTTOM;}else{if(z(AP,AJ,AM)){AL=AB.TOP;}else{if(z(AP,AN)){AL=AB.VALUE;}}}}}}return AL;},getColorByTitle:function L(AK,AJ){if(AJ===AB.BOTTOM_PERCENT||AJ===AB.TOP_PERCENT){AK=mstrmojo.desc(2787,"Percentage of ##").replace("'##'",AK);}else{if(AJ===AB.BOTTOM||AJ===AB.TOP){AK=mstrmojo.desc(2788,"Rank of ##").replace("'##'",AK);}}return AK;},getColorByFormatStr:function t(AK,AJ){if(AJ===AB.BOTTOM_PERCENT||AJ===AB.TOP_PERCENT){AK="0%;(0%)";}else{if(AJ===AB.BOTTOM||AJ===AB.TOP){AK="";}}return AK;},getColorByItems:function AG(AJ,AT,Aa,AW,AR,AP,AX){var AV=[],Ab,AL,AQ=mstrmojo.num,AO,AS;if(AJ===undefined||AJ.length===0){return AV;}var Ad=true;if(AJ.length>1){if(AJ[0].ceil===AJ[1].flr){Ad=false;}else{Ad=true;}}for(Ab=0;Ab<AJ.length;Ab++){var Ac=AJ[Ab],AN={},AK=Ac.ceil,AZ=Ac.flr;if((Ab===0&&Ad)||(Ab===AJ.length-1&&!Ad)){if(AT===AB.BOTTOM_PERCENT||AT===AB.TOP_PERCENT){AN.flr=AZ/100;AN.ceil=1;}else{if(AT===AB.TOP||AT===AB.BOTTOM){AZ+=1;AN.flr=Math.floor(AZ);AN.ceil=AR;}else{AN.flr=AZ;AN.ceil=Aa;}}AS=AN.ceil;}else{if((Ab===0&&!Ad)||(Ab===AJ.length-1&&Ad)){if(AT===AB.BOTTOM_PERCENT||AT===AB.TOP_PERCENT){AN.flr=0;AN.ceil=AK/100;}else{if(AT===AB.TOP||AT===AB.BOTTOM){AN.flr=0;AN.ceil=Math.floor(AK);}else{AN.flr=AW;AN.ceil=AK;}}AO=AN.flr;}else{if(AT===AB.BOTTOM_PERCENT||AT===AB.TOP_PERCENT){AZ=AZ/100;AK=AK/100;}else{if(AT===AB.TOP||AT===AB.BOTTOM){AZ+=1;AZ=Math.floor(AZ);AK=Math.floor(AK);}}AN.flr=AZ;AN.ceil=AK;}}if(AT===AB.TOP||AT===AB.BOTTOM){AN.ceil=AN.ceil>AR?AR:AN.ceil;}if(AP){AN.label=AQ.formatByMask(AP,AN.flr)+" - "+AQ.formatByMask(AP,AN.ceil);}else{AN.label=AN.flr+" - "+AN.ceil;}if(Ac.fmt&&Ac.fmt.bc){AN.color=Ac.fmt.bc;}else{AN.color=AX;}AV.push(AN);}AV=AV.filter(function(Ae){return Ae.flr<=Ae.ceil&&!(Ae.flr>AS||Ae.ceil<AO);});if(AT===AB.TOP||AT===AB.BOTTOM){AL=AR;}else{if(AV.length>0){if(Ad){AL=AV[0].ceil-AV[(AV.length-1)].flr;}else{AL=AV[(AV.length-1)].ceil-AV[0].flr;}}}var AY=0,AU,AM;for(Ab=0;Ab<AV.length;Ab++){if(Ab===AV.length-1){AV[Ab].scopePercent=1-AY;}else{if(AT===AB.TOP||AT===AB.BOTTOM){AM=AV[Ab].ceil-AV[Ab].flr+1;}else{AM=AV[Ab].ceil-AV[Ab].flr;}AU=AM/AL;AV[Ab].scopePercent=AU;AY+=AU;}}return AV;},getDefaultColorByItems:function(AM,AK,AL){var AJ={};AJ.label=AL+" - "+AK;AJ.flr=AL;AJ.ceil=AK;AJ.color=AM;AJ.scopePercent=1;return[AJ];},getNumberFormat:function(AM,AK){var AN=AM.nf,AL=AM.gvs;function AJ(){var AQ=(AL&&AL.items&&AL.items[0]&&AL.items[0].items)||[],AP=AQ[AK]||{},AO=AP.nfs;return typeof AO==="string"?AO:"";}if(typeof AN[AK].nfs!=="string"){AN[AK].nfs=AJ();}return AN[AK].nfs;},hasOnlyMetricsOnColumn:function(AK){var AJ=(AK&&AK.gts&&AK.gts.col)||[];return AJ.every(function(AL){return AL.otp===AC.DssTypeUnknown&&(AL.es||[]).every(function(AM){return AM.otp===AC.DssTypeMetric;});});},hasNoMetricOnRow:function(AK){var AL=(AK&&AK.gts&&AK.gts.row)||[],AJ=function(AM){return AM.otp!==AC.DssTypeMetric;};return AL.every(AJ);},isOnExpressMode:function(){return mstrApp.isExpress;},modifyScExp:function(AR,AJ,AV,AP){if(!AR||!AJ){return ;}var AM=AR.nds,AQ,AK,AS,AU,AT,AO,AN,AL;u.forEach(AM||[],function(AW){AQ=AW.nds;u.forEach(AQ||[],function(AX){AK=AX.es;u.forEach(AK||[],function(AY){AU=AY.v;AO=AP[AU];if(!AO){AO=AV.getNormalizedFormElementId(AU);AP[AU]=AO;}u.forEach(AJ||[],function(AZ){AS=AZ.es;u.forEach(AS||[],function(Aa){AL=false;AT=Aa.id;if(AT===AU){AL=true;}else{AN=AP[AT];if(!AN){AN=AV.getNormalizedFormElementId(AT);AP[AT]=AN;}if(AO===AN){AL=true;}}if(AL){AY.v=Aa.id;AY.n=Aa.n;return false;}});if(AL){return false;}});});});});},modifyScExpDeprecated:function(AP,AQ,AN,AL){if(!AP||!AQ){return ;}var AM=AP.nds,AK,AJ,AO;u.forEach(AM||[],function(AR){AK=AR.nds;u.forEach(AK||[],function(AS){AJ=AS.es;u.forEach(AJ||[],function(AT){u.forEach(AQ||[],function(AU){u.forEach(AU||[],function(AV){AO=AV.es;u.forEach(AO||[],function(AW){if(AN.call(AL,AW.id,AT.v)){AT.v=AW.id;AT.n=AW.n;}});});});});});});},getMouseOffset:function(AK){var AJ=(AK.offsetX!==undefined)?AK.offsetX:(AK.layerX),AL=(AK.offsetY!==undefined)?AK.offsetY:(AK.layerY);return{x:AJ,y:AL};},translateLineStyle:function(AJ){var AL=["none","solid","solid","dashed","dotted"],AK=["1px","1px","2px","1px","1px"];return{width:AK[AJ]||"0px",style:AL[AJ]||"none"};},getGroupAndCalculationContextMenuForDataPoints:function(AS,Ag){var AU,AW=[],AL=[],Ad=[],AQ=Ag.fnCellName,AY=Ag.fnUnique,AP=Ag.fnMakeNode,Ab=AS.getCellForNode.bind(AS),Ai=Ag.selection;var AO=new k.ui.menus.MenuConfig(),AK=new k.ui.menus.MenuConfig(),Aa=new k.ui.menus.MenuConfig(),Af=new k.ui.menus.MenuConfig();function Ah(Aj){AS.selCells=AW[Aj].selCells;AS.derivedElementGroup(Ab(AS.selCells[0]));}function AR(Al){AS.selCells=AL[Al].selCells;var Ak=Ab(AL[Al].selCells[0]),Aj=AS.getDEInfo(Ak);AS.derivedElementsEdit(Ab(AS.selCells[0]),Aj);}function AX(Ak){AS.selCells=AL[Ak].selCells;var Aj=Ab(AL[Ak].selCells[0]);AS.removeQuickDE(Aj);}function AV(Ak){AS.selCells=AL[Ak].selCells;var Aj=Ab(AL[Ak].selCells[0]);AS.renameDEList(Aj);}function AZ(Aj){E(AS,Ab(AS.selCells[0]),null,Aj,false);}function AJ(Aj){E(AS,Ab(AS.selCells[0]),null,Aj,true);}function AN(Ak){var Aj=Ab(AL[Ak].selCells[0]);AS.removeQuickDE(Aj);}function Ae(Ak){var Aj=Ab(AL[Ak].selCells[0]);AS.editDECalculation(Aj);}function AT(Aj){Aj=Aj||[];function Ak(Ao){var Al=Ao.extra||{},Ap=Ao.setup||mstrmojo.emptyFn,Am=Ao.action||mstrmojo.emptyFn,An=[];Ap(An,Al);Am(An,Al);}Aj.forEach(Ak);}var AM=[{name:"group",setup:function(Aj){AW.forEach(function(Ak){AS.selCells=AW[Ak.v].selCells;if(!Object.prototype.hasOwnProperty.call(AL,Ak.v)&&N(AS)){Aj.push(Ak);}});},action:function(Ak){var Aj;if(Ak.length===1){Aj=Ak[0].v;AO.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){AS.selCells=AW[Aj].selCells;AS.derivedElementGroup(Ab(AS.selCells[0]));});}if(Ak.length>1){AO.addPopupMenuItem(mstrmojo.desc(1911,"Group"),AS.id,b(Ah,Ak),"xt");}}},{name:"edit-group",setup:function(Aj){AL.forEach(function(An){var Am=Ab(AL[An.v].selCells[0]),Al=AS.getDEInfo(Am),Ak=Al&&Al.de;if(Ak&&Ak.t===a.LIST){Aj.push(An);}});},action:function(Ak){var Aj,Am,Al;if(Ak.length===1){Aj=AL[Ak[0].v].selCells;Am=Ab(Aj[0]);Al=AS.getDEInfo(Am);AK.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){AS.selCells=Aj;AS.derivedElementsEdit(Ab(AS.selCells[0]),Al);});AK.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){AS.selCells=Aj;AS.removeQuickDE(Am);});Af.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){AS.selCells=Aj;AS.renameDEList(Am);});}if(Ak.length>1){AK.addPopupMenuItem(mstrmojo.desc(13395,"Edit Group..."),AS.id,b(AR,Ak),"xt");AK.addPopupMenuItem(mstrmojo.desc(12195,"Ungroup"),AS.id,b(AX,Ak),"xt");Af.addPopupMenuItem(mstrmojo.desc(13968,"Rename Group..."),AS.id,b(AV,Ak),"xt");}}},{name:"calculation",setup:function(Aj){Ad.forEach(function(Am,Al,Ak){AS.selCells=Ak[Am.v].selCells;var Ao=Ab(AS.selCells[0]),An=AS.getDEInfo(Ao),Ap=An&&An.de;if(!(Ap&&Ap.t===a.RESIDUE)&&I(AS)){Aj.push(Am);}});},action:function(Aj){if(Aj.length===1){AO.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),AS.id,function(){var Ak=Aj[0].v,Al=new k.ui.menus.MenuConfig();AS.selCells=Ad[Ak].selCells;Al.addRadioMenuGroup(null,AZ,M(AS,null,AQ).items,"checkMark",undefined,true);return Al;},"xt");}if(Aj.length>1){AO.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),AS.id,function(){return new mstrmojo.ui.menus.EditorConfig({cssClass:"base-on-calculation-editor",data:{},contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:Aj,selectedIndex:0,onitemSelected:function(Ak){var Al=Ak.v;AS.selCells=Ad[Al].selCells;this.parent.checkList.set("items",[]);this.parent.checkList.set("items",M(AS,null,AQ).items);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(Al,Ak){E(AS,Ab(AS.selCells[0]),null,Ak.checkList.selectedItem.v,false);}});});}}},{name:"edit-calculation",setup:function(Aj){AL.forEach(function(An){var Am=Ab(AL[An.v].selCells[0]),Al=AS.getDEInfo(Am),Ak=Al&&Al.de;if(Ak&&Ak.t===a.CALCULATION){Aj.push(An);}});},action:function(Aj){function Ak(){var Al=Aj[0].v;AS.selCells=AL[Al].selCells;var Ap=Ab(AS.selCells[0]),Ao=AS.getDEInfo(Ap),Aq=Ao&&Ao.de,An=M(AS,Aq,AQ),Am=new k.ui.menus.MenuConfig();Am.addRadioMenuGroup(An.selectedItem.value,AJ,An.items,"checkMark",undefined,true);return Am;}if(Aj.length===1){Aa.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),AS.id,Ak,"xt");Aa.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){var Al=Aj[0].v;AS.selCells=AL[Al].selCells;var Am=Ab(AS.selCells[0]);AS.removeQuickDE(Am);});Af.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){var Al=Aj[0].v;AS.selCells=AL[Al].selCells;var Am=Ab(AS.selCells[0]);AS.editDECalculation(Am);});}if(Aj.length>1){Aa.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),AS.id,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11859,"Based on")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"attrList",items:Aj,selectedIndex:0,onitemSelected:function(Ao){var Ap=Ao.v;AS.selCells=AL[Ap].selCells;var An=Ab(AS.selCells[0]),Am=AS.getDEInfo(An),Aq=Am&&Am.de;var Al=M(AS,Aq,AQ);this.parent.checkList.set("items",[]);this.parent.checkList.set("items",Al.items);this.parent.checkList.set("selectedItem",Al.selectedItem);this.parent.data.set("valid",false);}},{scriptClass:"mstrmojo.VisMenuList",alias:"checkList"}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:function(Am,Al){E(AS,Ab(AS.selCells[0]),null,Al.checkList.selectedItem.v,true);}});});Aa.addPopupMenuItem(mstrmojo.desc(12197,"Delete Calculation"),AS.id,b(AN,Aj),"xt");Af.addPopupMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),AS.id,b(Ae,Aj),"xt");}}}];AU=AY(Ai);AU.forEach(function(Ak){var Am=AP(Ak),Aj=Ab(Am),Al,An,Ao;if(!AS.model.supportsViewFilterActions(Aj.tid)){return ;}Al=Aj.dei===undefined?AW:AL;An=Aj.tid;Ao=AS.model.getObjectInfo(An).n;if(Al[An]===undefined){Al[An]={};Al[An].selCells=[];Al.push({n:Ao,v:An,text:Ao,value:An});}Al[An].selCells.push(Am);if(Ad[An]===undefined){Ad[An]={};Ad[An].selCells=[];Ad.push({n:Ao,v:An,text:Ao,value:An});}Ad[An].selCells.push(Am);});var Ac=this.getPropertyByPath(AS,"model.data.visName")||this.getPropertyByPath(AS,"model.data.vis.vn");if(Ac==="VIHeatMapVisualizationStyle"){AM.splice(2,2);}AT(AM);return{createDe:AO,editGroup:AK,editCalculation:Aa,renameDe:Af};},getGroupAndCalculationContextMenu:function(AR,Af,Ac){var Ae=AR,AY=Ac.skipSingleAttrCheck||Ae.isSingleAttrSelection(),AM=false,AO=Ae.isSingleSelection(),AS=Ae.getDEInfo(Af),AN=AS&&AS.deObject,Ab=AS&&AS.de,AW=AN&&Ae.getOthersDEInfo(AN),AU=Ae.getSelections(),Aa=true,AQ=Ac.fnCellName,Ad=this.getPropertyByPath(Ae,"model.data.visName")||this.getPropertyByPath(Ae,"model.data.vis.vn");var AP=new k.ui.menus.MenuConfig(),AK=new k.ui.menus.MenuConfig(),AV=new k.ui.menus.MenuConfig(),AZ=new k.ui.menus.MenuConfig();Ae.selCells=Ac.selection;if(AR.model.supportsViewFilterActions(Af.tid)){if((AM||AY)&&B(Af,q)&&N(Ae)){AP.addMenuItem(mstrmojo.desc(1911,"Group"),"xt",function(){AR.derivedElementGroup(Af);});}if(AO&&Ab&&Ab.t===a.LIST){AK.addMenuItem(mstrmojo.desc(13395,"Edit Group..."),"xt",function(){AR.derivedElementsEdit(Af,AS);});AK.addMenuItem(mstrmojo.desc(12195,"Ungroup"),"xt",function(){AR.removeQuickDE(Af);});AZ.addMenuItem(mstrmojo.desc(13968,"Rename Group..."),"xt",function(){AR.renameDEList(Af);});}var AT=function(Ag){E(Ae,Af,Ab,Ag,false);},AX=function(Ag){E(Ae,Af,Ab,Ag,true);};if(AW&&!AO&&AY){l.forEach(AU,function(Ag){if(Ag[0]&&Ag[0].eid.indexOf(AW.id)>-1){Aa=false;return false;}});}if(Ad!=="VIHeatMapVisualizationStyle"&&!(AO&&Ab&&Ab.t===a.RESIDUE)&&(AM||AY)&&B(Af,f)&&I(Ae)){var AJ=function(){var Ag=new k.ui.menus.MenuConfig(),Ah=M(Ae,null,AQ);Ag.addRadioMenuGroup(null,AT,Ah.items,"checkMark",undefined,true);return Ag;};AP.addPopupMenuItem(mstrmojo.desc(5188,"Calculation"),this.id,AJ,"xt");}if(AO&&Ab&&Ab.t===a.CALCULATION){var AL=function(){var Ag=new k.ui.menus.MenuConfig(),Ah=M(Ae,Ab,AQ);Ag.addRadioMenuGroup(Ah.selectedItem.value,AX,Ah.items,"checkMark",undefined,true);return Ag;};AV.addPopupMenuItem(mstrmojo.desc(12196,"Edit Calculation"),this.id,AL,"xt");AV.addMenuItem(mstrmojo.desc(12197,"Delete Calculation"),"xt",function(){AR.removeQuickDE(Af);});AZ.addMenuItem(mstrmojo.desc(13967,"Rename Calculation..."),"xt",function(){AR.editDECalculation(Af);});}}return{createDe:AP,editGroup:AK,editCalculation:AV,renameDe:AZ};},isHostedPopupNode:function(AN,AL,AK,AJ){var AO=AK?AN:AN&&AN.parentNode;while(AO&&(AO!==AJ)){var AM=AO.getAttribute&&AO.getAttribute(AL);if(AM!==null&&AM.indexOf("mstrmojo-popup-widget-hosted")>=0){return true;}AO=AO.parentNode;}return false;},applyStyle2Legend:function(AM,AL,AK){var AJ,AO={},AN={};for(AJ in AM){if(AJ.indexOf("font")>=0||AJ.indexOf("color")>=0||AJ.indexOf("textDecoration")>=0){AO[AJ]=AM[AJ];}else{AN[AJ]=AM[AJ];}}if(AL){AL.style.background="";this.applyStyles2DomNode(AL,AN);}if(AK){this.applyStyles2DomNode(AK,AO);}},mergeMenuConfigs:function K(AK,AJ){function AL(AN,AO,AM){if(!AO){return ;}if(!AM&&AN.hasMenuItems()&&AO.hasMenuItems()){AN.addSeparator();}if(AO.hasMenuItems()){AN.absorbMenuItems(AO);}}return AJ.reduce(function(AM,AN){AL(AM,AK[AN.name],AN.noSeparator);return AM;},new mstrmojo.ui.menus.MenuConfig());},absorbMenuItems:function(AK,AJ,AL){AK.addDisposable(AJ);AK.absorbMenuItems(AJ);if(AL&&AJ.menus.length>0){AK.addSeparator();}},addWheelListener:(function(){var AM=mstrmojo.dom,AL=AM.attachEvent,AK=AM.preventDefault,AN;function AJ(AR,AQ,AS,AP){var AO=(AN==="wheel")?AS:function(AT){if(!AT){AT=window.event;}var AV={originalEvent:AT,target:AT.target||AT.srcElement,type:"wheel",deltaMode:(AT.deltaMode!==undefined?AT.deltaMode:1),deltaX:0,deltaZ:0,preventDefault:function(){AK(window,AT);}},AU=this;if(AN==="mousewheel"){AV.deltaY=-AT.wheelDelta;if(AT.wheelDeltaX!==undefined){AV.deltaX=-AT.wheelDeltaX;}}else{AV.deltaY=AT.detail;}return AS.call(AU,AV);};return AL(AR,AQ,AO,AP);}if(Object.prototype.hasOwnProperty.call(document.createElement("div"),"onwheel")){AN="wheel";}else{AN=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";}return function(AP,AQ,AO){return AJ(AP,AN,AQ,AO);};}()),isNearZero:function(AK,AJ){AJ=AJ||5;var AL=1/Math.pow(10,AJ);return(Math.abs(AK)<AL);},hasMergedRowCells:function(AJ){return false;},getMockUpThresholds:function(AL,AM){var AJ=[{tid:1,n:"threshold 0",scope:1,rtp:2,rtxt:"",fmt:{bc:"#cc2525",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,flr:0,ceil:10},{tid:2,n:"threshold 1",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e34b4b",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"10%",dtp:5},{v:"30%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:10,ceil:30},{tid:3,n:"threshold 2",scope:1,rtp:2,rtxt:"",fmt:{bc:"#e97d7d",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"30%",dtp:5},{v:"50%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:30,ceil:50},{tid:4,n:"threshold 3",scope:1,rtp:2,rtxt:"",fmt:{bc:"#79d479",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"50%",dtp:5},{v:"70%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:50,ceil:70},{tid:5,n:"threshold 4",scope:1,rtp:2,rtxt:"",fmt:{bc:"#57ba57",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"70%",dtp:5},{v:"90%",dtp:5}],fn:3,fnt:3}],fn:19},ttp:3,flr:70,ceil:90},{tid:6,n:"threshold 5",scope:1,rtp:2,rtxt:"",fmt:{bc:"#2ca02c",bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:"4C051DB611D3E877C000B3B2D86C964F",n:"Profit"},cs:[{v:"90%",dtp:5}],fn:5,fnt:3}],fn:19},ttp:1,flr:90,ceil:100}];l.forEach(AJ,function(AO){var AN=AO.expr.nds[0].m;AN.did=AL;AN.n=AM;});var AK={};AK[AL]=AJ;return AK;},generateThresholdsInfo:function(AL,AQ,AJ,AN){var AP=AJ.length,AK=[],AT,AM,AU=0,AS=0;for(var AO=0;AO<AP;AO++){AM=Math.round(AN[AO]*100);AS=AU;AU=AM||100;AT={tid:AO+1,n:"threshold "+AO,scope:1,rtp:2,rtxt:"",fmt:{bc:AJ[AO],bgs:0},expr:{et:14,nds:[{et:10,dmt:7,m:{did:AL,n:AQ},cs:[{v:AM+"%",dtp:5}],fn:2,fnt:3}],fn:19},ttp:1,ceil:AU,flr:AS};AK.push(AT);}var AR={};AR[AL]=AK;return AR;},psPt2CssPt:function(AL,AK){var AJ=parseInt(AL,10)*0.75;if(AK instanceof Function){AJ=AK(AJ);}return AJ+"pt";},captureEventOnce:function(AO,AN,AJ,AM,AL){function AK(AP){AN.call(AJ,Z.newDomEvent(AO,window,AP||window.event),AL);S.detachEvent(AM,AO,AK);}AL=AL||{};AM=AM||document;S.attachEvent(AM,AO,AK);},getPropertyByPath:function(AN,AM,AJ){var AK,AL;if(typeof AM!=="string"){return AJ;}AK=AM.split(".");AL=AK.every(function(AP){var AO=AN[AP];if(AO!==undefined){AN=AO;return true;}return false;});return AL?AN:AJ;},mergeHashes:function(){return Array.prototype.slice.apply(arguments).reduce(function(AJ,AK){if(AK){Object.keys(AK).forEach(function(AL){AJ[AL]=AK[AL];});}return AJ;},{});},toggleControlEnabled:function(AJ,AK){[].concat(AJ).forEach(function(AL){AL.set("enabled",!!AK);});},findInArray:function(AM,AL,AK){var AO=-1,AN,AJ;if(!Array.isArray(AM)){return AO;}for(AN=AK===undefined?0:AK,AJ=AM.length;AN<AJ;AN+=1){if(AL(AM[AN])){return AN;}}return AO;},arrayUnique:function(AJ,AK){if(!Array.isArray(AJ)){return AJ;}return AJ.filter(function(AL,AM){return p.findInArray(AJ,function(AN){return AK(AL,AN);},AM+1)===-1;});},range:function(AJ,AN,AM){AM=AM||1;var AL,AK=[];for(AL=AJ;AL!==AN;AL+=AM){AK.push(AL);}return AK;},drawDashLine:function D(AR,AL,AP,AK,AN,AJ,AQ){var AO=(AL===AK),AM;AR.beginPath();AR.moveTo(AL,AP);if(AO){AM=0;AP+=AJ;while(AP<=AN){if(AM%2===0){AR.lineTo(AL,AP);AP+=AQ;}else{AR.moveTo(AL,AP);AP+=AJ;}AM++;}if(AM%2===0){AR.lineTo(AK,AN);}}else{AM=0;AL+=AJ;while(AL<=AK){if(AM%2===0){AR.lineTo(AL,AP);AL+=AQ;}else{AR.moveTo(AL,AP);AL+=AJ;}AM++;}if(AM%2===0){AR.lineTo(AK,AN);}}AR.stroke();},repeat:function(AL,AM){var AJ=[],AK;AM=Math.max(0,AM);for(AK=0;AK<AM;AK+=1){AJ[AK]=AL;}return AJ;},isHierarchyObject:function(AJ){return(AJ&&AJ.t)===AC.DssTypeDimension;},selectPropertyPanel:function(AK,AL){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AK.getDocModel().selectVIUnit(AK.parent.id,true);var AJ=AK.edtModel;if(AJ){AJ.selectTargetByValue(AL);}},pluck:function(AK,AJ){if(!l.isArray(AK)){return AK;}return AK.map(function(AL){return AL&&AL[AJ];});},pick:function(AK,AJ){return AJ.reduce(function(AM,AL){AM[AL]=AK[AL];return AM;},{});},isColorManuallySet:function(AL,AK){var AJ=AF(AL,AK);if(AJ){return AJ.isManual;}},getCombColor:function(AL,AK){var AJ=AF(AL,AK);if(AJ){return AJ.color;}},setColorPickerShowAutomatic:function(AK,AJ){AK.children[0].fillColor.colorPicker.showAutomatic=AJ;},getCharGroupValueChangeCb:function(AJ){var AK=(function(){var AL={};AL[c.FONT_WEIGHT]=J.FS_BOLD;AL[c.FONT_STYLE]=J.FS_ITALIC;AL[c.UNDERLINE]=J.FS_UNDERLINE;AL[c.LINE_THROUGH]=J.FS_STRIKETHROUGH;return function(AM,AN){return AM^AL[AN];};}());return function(AM,AL){if(AJ instanceof Function){AJ=AJ();}if(!AJ){return ;}switch(AM){case c.COLOR:AJ.fontColor.fill.value.setValue(AL);break;case c.FONT_SIZE:AJ.fontSize.setValue(AL);break;case c.FONT_FAMILY:AJ.fontFamily.setValue(AL);break;case c.FONT_WEIGHT:case c.FONT_STYLE:case c.UNDERLINE:case c.LINE_THROUGH:AJ.fontStyle.setValue(AK(AJ.fontStyle.getValue(),AM));break;}};},getMetricsInDropZone:C,addLegendFontChangeListeners:function(AK,AL){var AJ=["lgdFntClr","lgdFntSz","lgdFntFml","lgdFntStyle"];AE(AJ,AK,AL);},addLegendBackgroundChangeListeners:function(AK,AL){var AJ=["lgdBgFillClr","lgdBgFillTrans"];AE(AJ,AK,AL);},isValidDropZone:function(AJ){if(AJ===undefined){return false;}var AL=Object.keys(AJ).filter(function(AM){return AM!=="visProp";});var AK=T.copyProps(AL,AJ);return AJ&&!T.equals(AK,{});},getDrillCandidates:function(AO){var AL=AO.modelData,AM=AO.model,AK=AM.docModel.datasets,AJ=AL.gts,AN=AL.datasetId,AP=AK[AN],AQ=AP.att||[];return AQ.filter(function(AT){var AS=AT.did,AU=AJ.row||[],AR=AJ.col||[];return AU.concat(AR).every(function(AV){return AV.id!==AS&&AT.hide!==true;});});},getDrillMenuItemsCallback:function(AK,AL,AJ){return function(){var AN=p.getDrillCandidates(AK),AM=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350});AN.forEach(function(AO){AM.addMenuItem(AO.n,"xt",AL,T.copy(AJ,{drillUnit:AO}));});return AM;};},doDrill:function(AL,AZ,AU,Aa){var Ab=AL;function AR(Ad){return Ad.model.controller.cmdMgr;}function AX(){return{success:function Ad(){p.visPrint("reaise");this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}var AK=Ab.model,AY=(Ab.getDocModel&&Ab.getDocModel())||Ab.model.docModel,AW=AY.getDataService(),AO=AW.newUpdate();var AQ=true;if(AY.prefs&&AY.prefs.rtprnt){AQ=parseInt(AY.prefs.rtprnt,10)===1;}else{if(AK.xtab.defn.tkp!==undefined){AQ=parseInt(AK.xtab.defn.tkp,10)===-1;}}Aa=Aa||{};Aa.keepParent=AQ;var AP=AU.call(AL,AZ,Aa);var AS=Ab.zonesModel,Ac=AS.getUpdateCallback(),AT=Ab.model.controller||AY.controller,AM=AT._getXtabCallback(Ab);AO.add(AP,R(Ac,AM));var AJ=AK.getSelectorDataFromViewFilter(Ab.model.data.vfexpr).concat({keepOnly:true,data:Ab.getSelections()}),AV=AY.getKeepOnlyOrExcludeAction(Ab.k,AJ);AO.add(AV,AX.call(Ab));AR(Ab).execute({execute:function AN(){this.submitUpdate(AO);},urInfo:{callback:AO.callback}});},strStartsWith:function(AL,AK,AJ){AJ=AJ||0;return AL.lastIndexOf(AK,AJ)===AJ;},changeWidgetBackground:function(AL,AM,AK){var AJ=AL.parent;if(AJ&&AM!==AK){AJ.changeUnitFormats(false,1,AL.getFormats(),c.BACKGROUND_COLOR,AM,AK);AJ.raiseEvent({name:"BEMFormatChange",propertyName:c.BACKGROUND_COLOR,value:AM,isTitle:false});}},translateGridError:function(AK,AJ){if(AJ===undefined){AJ=e.AE_ERROR;}if(AJ===e.EMPTY_DATA){AK=mstrmojo.desc(12093,"Filter excludes all data");}if(AJ===e.NO_DATASET||AJ===e.NO_TEMPLATE_UNIT){AK=mstrmojo.desc(11668,"Drag objects here.");}if(!AK){AK=mstrmojo.desc(13687,"Unknown error");}return{msg:AK,type:AJ};},hasValidValueInMetric:function(AL,AJ){var AK=p.getPropertyByPath(AL,"model.data.gsi.mx");if(AK===undefined||AK.length<=AJ||AJ<0){return false;}var AM=AK[AJ];return["min","max"].every(function(AN){var AO=AM[AN];return AO!==undefined&&AO!==null&&AO!=="";});},renderWidgetErrorRSD:function(AM,AO,AK){var AQ=document.createElement("div");var AP='<div style="display: table; height: 100%; width: 100%; background-color:#F5F5F2; border: solid 1px #A7A7A7; box-sizing: border-box;"><div style="display: table-cell; vertical-align: middle; text-align: center; color: #000000; font-size: 14pt;">'+AO+"</div></div>";AQ.innerHTML=AP;AQ=AQ.firstChild;var AJ=AM.width,AL=AM.height;if(AJ!==undefined){AQ.style.width=AJ+"px";}if(AL!==undefined){AQ.style.height=AL+"px";}var AN=AM.domNode;if(AN){AK.forEach(function(AR){AN["on"+AR]=undefined;});while(AN.firstChild){AN.removeChild(AN.firstChild);}AN.appendChild(AQ);}else{AM.parent.domNode.appendChild(AQ);}},visPrint:function(){var AJ=mstrmojo.VisUtility.enableInVis;if(AJ&&window.mstr_profile&&mstr_profile.enabled&&console){Function.prototype.apply.call(console.log,console,arguments);}},hasCGorCon:function(AM,AJ){var AL=AJ&&AJ.did,AK=AM.model.data.datasetId||"",AN=null;if(AL){AN=r.getDatasetFromAttributeId(AM.model.docModel.datasets,AL);}else{if(AK){AN=r.getDatasetFromId(AM.model.docModel.datasets,AK);}}return AN&&r.hasCGorCon(AN);},findElementsByAttribute:function n(AL,AN,AM,AJ){AJ=!!AJ;var AO=[];if(AM.constructor!==Array){AM=[AM];}var AP=function(AQ){if(AJ){return AQ.identity&&AQ.identity.tlOpt&&AQ.identity.tlOpt[AN];}else{return AQ.getAttribute(AN);}};function AK(AS){var AQ=AP(AS),AR;if(AS.hasChildNodes()){AR=AS.firstChild;while(AR){if(AR.nodeType===1){AQ=AP(AR);if(AM.indexOf(AQ)!==-1){AO.push(AR);}else{AK(AR);}}AR=AR.nextSibling;}}}AK(AL);return AO;}});mstrmojo.VisUtility.enableInVis=true;var p=mstrmojo.VisUtility;}());(function(){mstrmojo.requiresCls("mstrmojo.gm.GMEnums","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.VisEnum.GMLegendFormatingPropertyTag","mstrmojo.VisUtility");var N=mstrmojo.gm.EnumTRFManipulations;var J=mstrmojo.array,C=mstrmojo.hash,M=mstrmojo.func.wrapMethods,G=mstrmojo.func.composite,I=mstrmojo.VisEnum.GMLegendFormatingPropertyTag;var D={silent:false,undo:mstrmojo.emptyFn,redo:mstrmojo.emptyFn};function K(O){return O.model.controller.cmdMgr;}function L(){return(this.getDocModel&&this.getDocModel())||this.model.docModel;}function H(){return{success:function O(){this.raiseEvent({name:"regenerateToolbar"});}.bind(this)};}function E(P,R){var O,U,Q,S,T={};T.tks=this.k;T.selectorObjects=P;T.keepOnly=!!R;T.isDocVis=true;O=L.call(this);U=O.getDataService();Q=U.getGMViewFilterAction(T);S=O.getSliceCallback(T);return{action:Q,callbacks:S};}function B(Q,P){var O,S,R;O=L.call(this);R=O.getDataService();if(!this.isXMLDirty()){R.submitUpdates(Q,P);}else{S=this.getPersistAction();R.submitUpdates([Q,S],P);this.resetXMLDirtyFlag();}}function A(){var b=this.modelData||this.model.data,S=b.k,Z,Y="FormattingWidget",U,T,X,P,Q,R=[],W=[],V=this.edtModel;if(!b){console.log("warning: modelData is missing");return null;}var a=function(d,f){var c=T.createElement(f),e;if(d instanceof Object){for(e in d){if(d.hasOwnProperty(e)){var g=a(d[e],e);if(g){c.appendChild(g);}}}}else{c.setAttribute("value",d);}return c;};var O=function(c){return c.replace(/</g,"&lt;").replace(/"/g,"&quot;");};W=!!V&&!!V.getActionsWithUpdateProperty?V.getActionsWithUpdateProperty():[];X=this.createWidgetPropsXML?this.createWidgetPropsXML():null;if(!X||X.length===0){U=this.getProperties();if(this.useCompatibleXML){T=(new DOMParser()).parseFromString("<widgetProps></widgetProps>","text/xml");T.firstChild.appendChild(a(U,"fmt"));}else{T=(new DOMParser()).parseFromString("<props><widgetProps></widgetProps></props>","text/xml");T.firstChild.firstChild.appendChild(a(U,"fmt"));}X=(new XMLSerializer()).serializeToString(T);}P=O(X);Q={act:"setProperty",nodeKey:S,prs:Y,pri:4,v:P};R.push(Q);if(!!W){R=R.concat(W);}return R;}function F(P,Q,O,T){if(!(T instanceof Function)){return D;}var S=this.id;function R(U){return function(){var W=mstrmojo.all[S],V=W.getProperties();V[P]=U;T.call(W,U,true);W.getDocModel().selectVIUnit(W.parent.id,true);};}return{silent:true,undo:R(O),redo:R(Q)};}mstrmojo._VizSelectionHelper=mstrmojo.provide("mstrmojo._VizSelectionHelper",{postBuilderingCalled:false,listenToUpdateColorMap:function(R){if(mstrmojo.VisUtility.isOnExpressMode()){return ;}var Q=this,P,O=(Q.getDocModel&&Q.getDocModel())||Q.model.docModel;if(O){return O.attachEventListener("colorMapChanged",Q.id,function(T){P=Q.parent&&Q.parent.parent;if(Q.forceUpdateColorMap||(P&&P.isPanelDisplaying())){R.call(Q);}else{var S=P.attachEventListener("panelDisplaying",Q.id,function(U){if(Q.postBuilderingCalled){R.call(Q);}P.detachEventListener(S);});}});}},detachUpdateColorMapListener:function(P){if(!P){return ;}var O=(this.getDocModel&&this.getDocModel())||this.model.docModel;O.detachEventListener(P);},updateTargets:function(P){var S={},Q=this,O=L.call(this);S.fromGM=true;S.type=1;S.src=this.k;S.selectorObjects=P;function R(V){var T=Q.modelData||Q.model.data,U=T.sc;if(U!==undefined){return U[V];}return undefined;}S.keepOnly=true;S.ck=R.call(this,"ck");S.keyContext=S.ck;S.tks=R.call(this,"tks");S.ckey=R.call(this,"ckey");S.isDocVis=true;S.include=true;S.showall=R.call(this,"showall");O.slice(S);},updateAfterViewFilter:function(Q,O){var V,U,P,T,S,W,R;V=L.call(this);U=V.getDataService();T=E.call(this,Q,O);P=T.action;S=T.callbacks;R=this.model.controller||V.controller;if(this.currKeepOnlyAction){W=[C.clone(this.currKeepOnlyAction)];}else{W=E.call(this,[],false).action;}this.currKeepOnlyAction=P;R.submitUndoRedoUpdates([P],W,S);},updateAfterKeepOnly:function(Q){var P=L.call(this),O=this.model.controller||P.controller,R=M(O._getXtabCallback(this),H.call(this));O.applyKeepOnly(this,R,{keepOnly:Q,data:this.getSelections()},Q?-2:undefined);},updateAfterDrill:function(O,Y){var V=this,Z=L.call(this),X=Z.getDataService(),R=X.newUpdate(),Q=this.getSelections(),U=this.model.getSelectorDataFromViewFilter(V.model.data.vfexpr).concat({keepOnly:true,data:Q}),P=Z.getKeepOnlyOrExcludeAction(V.k,U),S=V.model.controller||Z.controller,T=S._getXtabCallback(V);R.add(O,M(Y,T));R.add(P,H.call(V));K(V).execute({execute:function W(){this.submitUpdate(R);},urInfo:{callback:R.callback}});},updateAfterSort:function(R){var P=this,O=L.call(this),S=O.getDataService(),T=O.getSliceCallback({tks:P.k});K(P).execute({execute:function Q(){var V=S.newUpdate(this,undefined),U={act:"sortGM",nodeKey:P.k,subActions:R};V.add(U,T,undefined);if(P.isXMLDirty()){V.addActions(P.getPersistAction());}this.submitUpdate(V,undefined);},urInfo:{callback:T}});},updateAfterAction:function(T,O,P,a,X){if(!T){return ;}var V=this,Q=V.parent&&V.parent.id,b=V.model.docModel,U=V.model.controller||b.controller,Z,Y,S={},W,R=X||D;if(P){Z=mstrmojo.emptyFn;W=function(){this.submitSilent(T);};}else{Z=b.getSliceCallback({tks:this.k});Z.success=G([Z.success,function(){b.selectVIUnit(Q,true);}]);W=function(){this.submit(T,Z,S);};}Y=U._getXtabCallback(V);if(O){Z=M(Z,O);Y=M(Y,O);}Y.success=G([Y.success,function(){b.selectVIUnit(Q,true);}]);if(P){C.copy(mstrmojo.DocDataService.SUPPRESS_DATA,S);}if(a){C.copy(mstrmojo.DocDataService.REQUEST_DEFN_DATA,S);}K(this).execute({execute:W,urInfo:{silent:R.silent,callback:Y,redo:R.redo,undo:R.undo}});},getProperties:mstrmojo.emptyFn,getSetPropertiesAction:A,updateAfterPropertiesChange:function(P,Q,O,R){this.updateAfterAction(A.call(this),P,Q,O,R);},setProperty:function(V,R,T){var P=T.callback,Q=!!T.suppressData,X=T.requestDefinition,S=T.clientUndoRedoCallback,W=this.getProperties(),O=W[V],U;if(V===I.COLOR_SQUARE_COLOR){if(this.colorSqureIdentity){this.updateColorMap(this.colorSqureIdentity.comb,R);}}else{if(W&&(W[V]===undefined||W[V].toString()!==R.toString())){W[V]=R;U=F.call(this,V,R,O,S);this.updateAfterPropertiesChange(P,Q,X,U);}}},showData:function(O){if(!this.gridData){this.gridData=this.model.data;}mstrmojo.vi.ui.ViewDataDialog.open(this.parent,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.VisUtility");var R=mstrmojo.css,A=mstrmojo.VisUtility,H=mstrmojo.array,D=mstrmojo.string,I="vis-tooltip",N=20,P=165,L=350,E=350,G="px";function Q(){var U=this.domNode;U.innerHTML="";var S=document.createElement("div");S.className=I+"-container";var V=document.createElement("table");V.className=I+"-table";for(var T=0;T<3;T++){V.appendChild(document.createElement("COL"));}S.appendChild(V);this.domNode.appendChild(S);return V;}function K(T){var S=[],U=false;H.forEach(T,function(V){if(!V.isSuper){S.push(V.v);}else{U=true;S.push("<sup>"+V.v+"</sup>");}});return{hasSuper:U,htmlText:S.join("")};}mstrmojo.VisTooltip=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.VisTooltip",init:function O(S){this._super(S);R.addWidgetCssClass(this,(S&&S.widgetClass)?[S.widgetClass,I]:I);},toggle:function M(S){var T=mstrApp.isAppStatePrintPreview&&mstrApp.isAppStatePrintPreview();if(this.domNode){this.domNode.style.display=S&&!T?"block":"none";}},displayInfo:function C(V,c,S){var U=this.domNode,d=Q.call(this),a=false,T=0,b=0,W=10,Z=false,Y=d.childNodes[0],X=d.childNodes[2];V.forEach(function(o){var u,n,x,r,e,m,s,q,y,p,w,t;if(!Z){var g=d.insertRow(-1),l=g.insertCell(-1),k=g.insertCell(-1),h=g.insertCell(-1);g.className=I+"-tr";l.className=I+"-name";k.className=I+"-space";h.className=I+"-value";if(o===null){R.addClass(g,"separator");a=true;}else{if(a){R.addClass(g,"below-separator");}if(!S){k.innerHTML=":";}u=o.n;t=!o.skipEncode;l.innerHTML=t?D.encodeHtmlString(u,true):u;x=A.getComputedFontStyle(l);r=Math.ceil(A.measureTextWidth(l.innerHTML,x,x.bonus));s=U.offsetHeight>=E?1:2;if(r>P){q=A.truncateTextToLineWithWordWrap(u,x,P,s,true);if(q.canWordWrap){l.innerHTML=t?D.encodeHtmlString(q.text,true):q.text;}else{q=A.truncateTextToLineWithWordWrap(u,x,P,1);l.innerHTML=t?D.encodeHtmlString(q,true):q;}}T=Math.min(Math.max(T,r),P);n=o.v;p=o.isTrendLineFuncToken;if(p){y=K(n);}if(!p||!y.hasSuper){if(p){n=y.htmlText;}h.innerHTML=t?D.encodeHtmlString(n,true):n;e=A.getComputedFontStyle(h);m=Math.ceil(A.measureTextWidth(h.innerHTML,e,e.bonus,null,true));if(m>P){q=A.truncateTextToLineWithWordWrap(n,e,P,o.noTruncate?100:s,true);if(!q.canWordWrap){q=A.truncateTextToLineWithWordWrap(n,e,P,1,true);}h.innerHTML=t?D.encodeHtmlString(q.text,true):q.text;m=q.maxLineLen;}b=Math.min(Math.max(b,m),P);}else{h.innerHTML=y.htmlText;e=A.getComputedFontStyle(h);m=0;H.forEach(n,function(z){z.textWidth=A.measureSuperTextWidth(z.isSuper,z.v,e,e.bonus);m+=z.textWidth;});m=Math.ceil(m);if(m>P){q=A.truncateTextToLineWithWordWrapForTokens(n,e,P,o.noTruncate?100:s,true,true);if(!q.canWordWrap){q=A.truncateTextToLineWithWordWrapForTokens(n,e,P,1,true);}h.innerHTML=K(q.text).htmlText;m=q.maxLineLen;}b=Math.min(Math.max(b,m),P);}Y.style.width=T+"px";X.style.width=b+"px";w=T+b+W;d.style.width=mstrmojo.dom.isIE9?(w+2)+"px":w+"px";a=false;}if(U.offsetHeight>=E){var f=d.lastChild;f&&f.removeChild(f.lastChild);Z=true;}}});if(c){this.moveTo(c.x,c.y);}},moveTo:function(a,Z){var Y=mstrmojo.dom.position(document.body),W=this.domNode,b=W.offsetWidth,X=W.offsetHeight,V=Y.x+Y.w,c=Y.y+Y.h,T=a+N,S=Z+N;if(T>V-b||S>c-X){if(T<=V-b){S=c-X;}else{if(S<=c-X){T=V-b;}else{T=V-b;S=Z-N-X;}}}var U=W.style;U.left=T+G;U.top=S+G;},doLayout:function B(S){var U=this.domNode.getElementsByTagName("table")[0];if(!U){return ;}var V=R.getComputedStyle(this.domNode),T=S-parseInt(V.paddingLeft,10)-parseInt(V.paddingRight,10);T-=U.rows[0].cells[0].offsetWidth;T-=10;U.getElementsByClassName(I+"-value").forEach(function(W){W.style.maxWidth=T+G;});},posTo:function J(T){var S=this.domNode.style;S.left=T.x+G;S.top=T.y+G;},renderErrMsg:function F(S){Q.call(this).insertRow(-1).insertCell(-1).innerText=S;}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales");mstrmojo.requiresCls("mstrmojo.chart.enums.EnumFontStyle");mstrmojo.requiresCls("mstrmojo.VisUtility");mstrmojo.requiresClsP("mstrmojo.chart.common","DSSDateTime","ScalePlate");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphDataTextShowType","EnumDSSGraphObject");var g=mstrmojo.chart,c=g.model,q=mstrmojo.VisUtility,Q=g.enums,E=Q.EnumFontStyle,S=c.enums,AA=S.EnumDSSGraphProperty,X=S.EnumDSSGraphDataTextShowType,AB=S.EnumDSSGraphObject;var F=mstrmojo.gm.EnumDataLabels;var V=[["xAxLbFntClr","yAxLbFntClr","dlFntClr","lgdFntClr"],["xAxLbFntFml","yAxLbFntFml","dlFntFml","lgdFntFml"],["xAxLbFntSz","yAxLbFntSz","dlFntSz","lgdFntSz"],["xAxLbFntStyle","yAxLbFntStyle","dlFntStyle","lgdFntFml"]];var r=[["majorGridLnThk","minerGridLnThk","majorGridLnThk","minerGridLnThk"],["majorGridLnClr","minerGridLnClr","majorGridLnClr","minerGridLnClr"],["majorGridLnStyle","minerGridLnStyle","majorGridLnStyle","minerGridLnStyle"]];var Y=[["bgFillClr"],["bgFillStyle"],["bgFillTrans"]];function U(AK){switch(AK){case AA.DssGraphFontColor:return 0;case AA.DssGraphFontName:return 1;case AA.DssGraphFontSize:return 2;case AA.DssGraphFontStyle:return 3;case AA.DssGraphFontSize100:return 4;default:return -1;}}function w(AK){switch(AK){case AA.DssGraphAreaColor:return 0;case AA.DssGraphFillEffect:return 1;case AA.DssGraphAreaAlpha:return 2;}return -1;}function y(AK){var AL;switch(AK){case AB.DssGraphX1Body:case AB.DssGraphX1Label:case AB.DssGraphX1Major:case AB.DssGraphX1Minor:case AB.DssGraphUserLabel3:case AB.DssGraphUserLine3:AL="X1";break;case AB.DssGraphX2Body:case AB.DssGraphX2Label:case AB.DssGraphX2Major:case AB.DssGraphX2Minor:case AB.DssGraphUserLabel4:case AB.DssGraphUserLine4:AL="X2";break;case AB.DssGraphY1Body:case AB.DssGraphY1Label:case AB.DssGraphY1Major:case AB.DssGraphY1Minor:case AB.DssGraphUserLabel1:case AB.DssGraphUserLine1:AL="Y1";break;case AB.DssGraphY2Body:case AB.DssGraphY2Label:case AB.DssGraphY2Major:case AB.DssGraphY2Minor:case AB.DssGraphUserLabel2:case AB.DssGraphUserLine2:AL="Y2";break;case AB.DssGraphZBody:AL="Z";break;case AB.DssGraphO1Body:case AB.DssGraph2DO1Label:case AB.DssGraphO1Major:case AB.DssGraphO1Minor:AL="O1";break;case AB.DssGraphO2Body:case AB.DssGraph2DO2Label:case AB.DssGraphO2Major:case AB.DssGraphO2Minor:AL="O2";break;default:AL="No_Axis";break;}return AL;}function d(AK,AL){if(!!AK===false){return undefined;}return undefined;}function W(AP,AK){if(!!AP===false){return undefined;}var AU,AS,AR=AK.isVertical!==undefined?AK.isVertical:true,AM=AK.isGridChart||false,AV=AK.isPieShape||false,AQ={Name:0,Value:0},AN=AP.gaid,AO=AP.goid,AL=AP.gsid,AT=AP.v;if(!!AN===false){return undefined;}switch(AN){case AA.DssGraphShowLBLFeeler:if(AV){AQ.Name="DataLabel";if((AT&X.DssGraphDataTextValue)!==0){AQ.Value=F.SHOW_VALUE_ONLY;}else{if((AT&X.DssGraphDataTextLabel)!==0){AQ.Value=F.SHOW_TEXT_ONLY;}else{AQ.Value=F.HIDE;}}}break;case AA.DssGraphAreaColor:case AA.DssGraphFillEffect:case AA.DssGraphAreaAlpha:AS=w.call(this,AN);if(AS<0){return undefined;}if(AO===AB.DssGraphBackground){AQ.Name=Y[AS][0];if(AQ.Name.search("Trans")!==-1){AQ.Value=AT/255*100;}else{AQ.Value=AT;}}break;case AA.DssGraphShowLegendText:AQ.Name="LegendVisibleness";AQ.Value=AT===0?false:true;break;case AA.DssGraphSDShowDataText:AQ.Name="ShowSeriesDataLabel";AQ.Value=AT!==0;break;case AA.DssGraphShowDataText:if(AV===false){AQ.Name="DataLabel";AQ.Value=F.HIDE;if(AT&X.DssGraphDataTextValue){AQ.Value=F.SHOW_VALUE_ONLY;}else{if(AT&X.DssGraphDataTextLabel){AQ.Value=F.SHOW_TEXT_ONLY;}}}break;case AA.DssGraphFontColor:case AA.DssGraphFontName:case AA.DssGraphFontSize100:case AA.DssGraphFontSize:case AA.DssGraphFontStyle:AQ.Value=AT;AU=y.call(this,AO);AS=U.call(this,AN);if(AS<0){return undefined;}if(AS===4){AS=3;AQ.Value/=100;}if(AU==="No_Axis"){if(AO===AB.DssGraphDataText){if(AV){return undefined;}AQ.Name=V[AS][2];}else{if(AO===AB.DssGraphPieFeelerLabel||AO===AB.DssGraphPieFeelerLabel){if(AV===false){return undefined;}AQ.Name=V[AS][2];}else{if(AO===AB.DssGraphLegendText){AQ.Name=V[AS][3];}else{return undefined;}}}}else{if(AU[0]==="X"){AQ.Name=V[AS][0];}else{if(AU[0]==="Y"){AQ.Name=V[AS][1];}else{if(AU[0]==="O"){AQ.Name=AR?V[AS][0]:V[AS][1];}else{return undefined;}}}}break;}return AQ;}var T,k=String.fromCharCode,AE=mstrmojo.locales.datetime,AJ=0,L=document.getElementById("measureText"),B={},h={};var o=0.03,K=0,R=0,H=0.2;function p(AL){var AK,AM=[],AN;for(AK=0;AK<=AL;AK++){AN=AK.toString(16);if(AN.length===1){AN="0"+AN;}AM[AK]=AN;}T=AM;return AM;}function AH(AK){var AL=parseFloat(AK);if(isNaN(AL)===false&&AL!==undefined&&AL!==null){return AL;}return 0;}function D(AK){AK=AK.replace(/ddd/g,"EEE");AK=AK.replace(/AM\/PM/g,"a");AK=AK.replace(/tt/g,"a");AK=AK.replace(/:'/g,":");AK=AK.replace(/'\/'/g,"/");AK=AK.replace(/\\/g,"");var AL,AN=true,AM=AK.length;for(AL=0;AL<AM;AL++){if(AK[AL]==="h"||AK[AL]==="H"||AK[AL]===":"){AN=true;}else{if(AK[AL]===" "&&AN){AN=true;}}if(AK[AL]==="m"&&AN){AK=AK.substring(0,AL)+"M"+AK.substring(AL+1);}}return AK;}mstrmojo.chart.common.Utility=mstrmojo.provide("mstrmojo.chart.common.Utility",{point2D:{},rect2D:{},tripleId:{create:function M(AL,AP,AN,AM,AO){if(AL===null||AL===undefined){AL=-3;}if(AP===null||AP===undefined){AP=-3;}if(AN===null||AN===undefined){AN=-3;}var AK={mObjectId:AL,mSeriesId:AP,mGroupId:AN};if(AM!==undefined&&AM!==null){AK.angleByIndex=AM;}if(AO!==undefined&&AO!==null){AK.sliceById=AO;}return AK;},walks:function m(AO,AM){if(!!AO===false||!!AM===false){return null;}if(AO.length===1){return AM[AO[0]];}var AN=(AO&&AO.length)||0,AL,AK=AO[AL];for(AL=0;AL<AN;AL++){if(AM[AK]===undefined){AM[AK]={};}AM=AM[AK];}return AM;},equal:function a(AK,AL){return(AK.mObjectId===AL.mObjectId&&AK.mSeriesId===AL.mSeriesId&&AK.mGroupId===AL.mGroupId);},reset:function s(AM,AO,AN,AL,AK,AP){AM.mObjectId=AO!==undefined?AO:-3;AM.mSeriesId=AN!==undefined?AN:-3;AM.mGroupId=AL!==undefined?AL:-3;if(AK!==undefined&&AK!==null){AM.angleByIndex=AK;}if(AP!==undefined&&AP!==null){AM.sliceById=AP;}return AM;}},transformProperty:function A(AK,AM,AL){if(AM===0){return W.call(this,AK,AL);}return d.call(this,AK,AL);},abbreviateNumber:function b(AU,AK){var AV,AL,AW="",AN=(AU<0),AX=(this.isIntegar(AU)===false);if(AX){AK++;}if(AU<0){AK++;}var AQ=AN?-AU:AU;var AR=0;if(AQ>=1e+27){AQ=999;AW="Y";}else{if(AQ>=1e+24){AQ/=1e+24;AW="Y";}else{if(AQ>=1e+21){AQ/=1e+21;AW="Z";}else{if(AQ>=1000000000000000000){AQ/=1000000000000000000;AW="E";}else{if(AQ>=1000000000000000){AQ/=1000000000000000;AW="P";}else{if(AQ>=1000000000000){AQ/=1000000000000;AW="T";}else{if(AQ>=1000000000){AQ/=1000000000;AW="B";}else{if(AQ>=1000000){AQ/=1000000;AW="M";}else{if(AQ>=1000){AQ/=1000;AW="K";}else{if(AQ>=1){AR++;}else{if(AQ>=0.001){AR++;}else{if(AQ>=0.000001){AR++;}else{if(AQ>=1e-9){AR++;}else{if(AQ>=1e-12){AR++;}else{AN=false;}}}}}}}}}}}}}}if(this.isIntegar(AQ)===false){AV=AQ.toString();var AM=5,AP=2,AY;AL=AV.indexOf(".");AY=AV.length-AL-1;if(AY>AM||(AY>AP&&AY>AL)){if(AY>AM&&AK-AY<0){AP=Math.max(AP,Math.min(AP,AK-AY));}else{AP=Math.max(1,Math.min(AP,AK-AY));}AQ=AQ.toFixed(AP);}}AV=AQ.toString();if(this.isIntegar(AQ)===false){var AT=AV.length-1;AL=AV.indexOf(".");if(AL!==-1){if(AL>=AT){AV=AV.substring(0,AL);}else{var AS,AO=true;for(AS=AT;AS>AL&&AO;--AS){if(AV[AS]!=="0"){AO=false;}}if(AO){AV=AV.substring(0,AL);}}}}if(AN){AV="-"+AV;}AV+=AW;return AV;},getScalePlate:function AG(AK){AK=AK||false;this.mScalePlate=mstrmojo.chart.common.ScalePlate;if(AK){this.mScalePlate.clear();}return this.mScalePlate;},prepareScalePlateOptions:function AD(AM,AL,AN){var AK={mUseLogarithmicScale:AM,mAlwaysIncludeZero:!AM&&(AL||!!(AN&1)||!!(AN&2)),mShowMinLabel:true,mShowMaxLabel:true,mDrawCustomLine:false,mAxisMinValue:0,mAxisMaxValue:0,mAxisCustomValue:0,mUseCustomMinMax:false};return AK;},evaluateTextMargin:function P(AK){this.mTextMargins=this.mTextMargins||{};var AL=this.mTextMargins;if(AL[AK]){return AL[AK];}var AM=[];AM[0]=Math.floor(AK*o+0.5);AM[1]=Math.floor(AK*K+0.5);AM[2]=Math.max(Math.floor(AK*R+0.5),1);AL[AK]=AM;return AM;},AlmostZero:function z(AK){return(Math.abs(AK)<0.000001);},isValidNumber:function J(AK){if(typeof AK==="number"){if(AK===0){return true;}return !!AK;}return false;},isIntegar:function l(AK){return AK===+AK&&AK===(AK|0);},HasArrayIntersection:function O(AL,AK){var AM;for(AM=0;AM<AL.length;AM++){if(AK.indexOf(AL[AM])!==-1){return true;}}return false;},EscapeString:function C(AK){var AM='"',AL='\\"',AN=new RegExp(AM,"g");return String(AK).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"\\\\").replace(AN,AL).replace(/\r\n/g,"<br/>").replace(/\r/g,"<br/>").replace(/\n/g,"<br/>");},EscapeStringForJSON:function N(AK){var AM='"',AL='\\"',AN=new RegExp(AM,"g");return String(AK).replace(/\\/g,"\\\\").replace(AN,AL).replace(/\r/g,"\\r").replace(/\n/g,"\\n");},TrimLastComma:function AF(AL){var AK;if(!AL.buf||AL.len===-1){return ;}AK=AL.len;var AM=String(AL.buf[AK]);if(AM&&AM[AM.length-1]===","){AL.buf[AK]=AM.slice(0,-1);}},decodeUTF8:function f(AK){var AL="",AN=0,AP=0,AO=0,AM=0;while(AN<AK.length){AP=AK.charCodeAt(AN);if(AP<128){AL+=k(AP);AN++;}else{if((AP>191)&&(AP<224)){AO=AK.charCodeAt(AN+1);AL+=k(((AP&31)<<6)|(AO&63));AN+=2;}else{AO=AK.charCodeAt(AN+1);AM=AK.charCodeAt(AN+2);AL+=k(((AP&15)<<12)|((AO&63)<<6)|(AM&63));AN+=3;}}}return AL;},formatDateTimeValue:function e(AL,AQ){var AO=new mstrmojo.chart.common.DSSDateTime({ifTime:AQ});var AK="";var AN="";var AR=0;while(AR<AL.length){var AM=1;switch(AL.charAt(AR)){case"[":AR++;while(AR<AL.length&&AL.charAt(AR)!=="]"){AN+=AL.charAt(AR);AR++;}if(AN.length>0&&(AN[0]===">"||AN[0]==="<"||AN[0]==="=")){AN="";}AR++;break;case"y":AR++;while(AR<AL.length&&AL.charAt(AR)==="y"){AM++;AR++;if(AM===4){break;}}if(AM===1||AM===2){AK+=this.fillZeroToWidth(AO.mnYear%100,2);}else{if(AM===3){AK+=this.fillZeroToWidth(AO.mnYear%100,2);AR--;}else{if(AM===4){AK+=AO.mnYear;}}}break;case"M":AR++;while(AR<AL.length&&AL.charAt(AR)==="M"){AM++;AR++;}if(AM<3){AK+=this.fillZeroToWidth(AO.mnMonth,AM);}else{if(AM===3){AK+=AE.MONTHNAME_SHORT[AO.mnMonth];}else{AK+=AE.MONTHNAME_FULL[AO.mnMonth];}}break;case"d":AR++;while(AR<AL.length&&AL.charAt(AR)==="d"){AM++;AR++;}if(AM<3){AK+=this.fillZeroToWidth(AO.mnDay,AM);}else{if(AM===3){AK+=AE.dayShortNames[AO.mnDay];}else{AK+=AE.dayNames[AO.mnDay];}}break;case"h":AR++;while(AR<AL.length&&AL.charAt(AR)==="h"){AM++;AR++;}var AP=AO.mnHour;if(AP===0){AP=12;}if(AP>12){AP-=12;}AK+=this.fillZeroToWidth(AP,AM);break;case"H":AR++;while(AR<AL.length&&AL.charAt(AR)==="H"){AM++;AR++;}AK+=this.fillZeroToWidth(AO.mnHour,AM);break;case"m":AR++;while(AR<AL.length&&AL.charAt(AR)==="m"){AM++;AR++;}AK+=this.fillZeroToWidth(AO.mnMinute,AM);break;case"s":AR++;while(AR<AL.length&&AL.charAt(AR)==="s"){AM++;AR++;}AK+=this.fillZeroToWidth(AO.mnSecond,AM);break;case"S":AR++;while(AR<AL.length&&AL.charAt(AR)==="S"){AM++;AR++;}AK+=this.fillZeroToWidth(AO.mnMillisecond,AM);break;case"a":AP=AO.mnHour;if(AP<12){AK+=AE.AM_NAME;}else{AK+=AE.PM_NAME;}AR++;break;default:AK+=AL.charAt(AR++);break;}}if(AN.length!==0){AK='<SPAN STYLE="COLOR: '+AN+'" >'+AK+"</SPAN>";}return AK;},fillZeroToWidth:function n(AO,AM){var AL="",AN=AL+AO;var AK=AN.length;while(AK<AM){AN="0"+AN;AK++;}return AN;},updateCache:function AI(AL,AO,AP){var AN=(AO&&AO.length)||0,AM,AK,AQ=AL;for(AM=0;AM<AN-1;AM++){AK=AO[AM];if(!AQ[AK]){AQ[AK]={};}AQ=AQ[AK];}AQ[AO[AN-1]]=AP;},measureTextHeight:function(AP,AM,AT,AQ,AK){var AS,AO=AP;if(AO===" "){AO="\u00A0";}AK=AK||"pt";if(typeof AT==="number"){AT=AT+AK;}var AL="none",AR="normal";if(AQ&E.FS_ITALIC){AL="italic";}if(AQ&E.FS_BOLD){AR="bold";}var AN={fontFamily:AM,fontSize:AT,fontStyle:AL,fontWeight:AR};if(h&&h.H&&h.H[AM]&&h.H[AM][AT]&&h.H[AM][AT][AQ]){AS=h.H[AM][AT][AQ];}else{AS=q.measureTextHeight("H",AN,1);this.updateCache(h,["H",AM,AT,AQ],AS);}return AS;},measureText:function x(AR,AO,AX,AS,AM){var AL=true,AK,AV=AX+1;var AQ=AR;if(AQ===" "){AQ="\u00A0";}AM=AM||"pt";if(typeof AX==="number"){AX=AX+AM;}if(B&&B[AQ]&&B[AQ][AO]&&B[AQ][AO][AX]&&B[AQ][AO][AX][AS]){return B[AQ][AO][AX][AS];}if(AL){var AN="normal",AT="normal";if(AS&E.FS_ITALIC){AN="italic";}if(AS&E.FS_BOLD){AT="bold";}var AP={fontFamily:AO,fontSize:AX,fontStyle:AN,fontWeight:AT};if(h&&h.H&&h.H[AO]&&h.H[AO][AX]&&h.H[AO][AX][AS]){AV=h.H[AO][AX][AS];}else{AV=q.measureTextHeight("H",AP,true);this.updateCache(h,["H",AO,AX,AS],AV);}AK=q.measureTextWidth(AR,AP,0);}else{if(!L){var AU=document.createElement("div");AU.id="measureText";AU.style.position="absolute";AU.style.top="0";AU.style.visibility="hidden";AU.style.height="auto";AU.style.width="auto";document.body.appendChild(AU);L=AU;}L.innerHTML="";L.appendChild(document.createTextNode(AQ));L.style.fontFamily=AO;L.style.fontSize=AX;L.style.fontWeight="normal";L.style.fontStyle="none";if(AS&E.FS_ITALIC){L.style.fontStyle="italic";}if(AS&E.FS_BOLD){L.style.fontWeight="bold";}AK=L.scrollWidth+1;AV=L.scrollHeight+1;}var AW={Width:AK,Height:AV};this.updateCache(B,[AQ,AO,AX,AS],AW);return AW;},ReplaceDecimalPoint:function AC(AL,AK){return AL.replace(".",AK);},ReplaceMinusSign:function u(AK,AL){return AK.replace("-",AL);},insert:function G(AL,AK,AM){if(typeof AL==="string"&&typeof AK==="string"&&AM<=AL.length){return AL.substr(0,AM)+AK+AL.substr(AM);}return AL;},InsertThousandSeparator:function t(AM,AN,AR){var AK=AR.mstrDecimalPoint;var AL=AM.indexOf(AK);if(AL===-1){AL=AM.length;}var AO=0;while(AO<AL&&!this.chk_val(AM.charAt(AO))){AO++;}var AQ=AM;var AP;for(AP=AL-3;AP>AO;AP-=3){AQ=this.insert(AQ,AN,AP);}return AQ;},chk_val:function I(AK){return/^\d+$/.test(AK);},hFormatValue:function Z(AX,AO,Ai,A7){var AV=0;var Aq=0;var Ae=AX.length;var BF=false;if(!A7){A7={};var Ao=window.navigator.userLanguage||window.navigator.language;var BQ=Ao.split("-");this.mstrLanguageCode=BQ[0];this.mstrCountryCode=BQ[1]||BQ[0];A7.mstrThousandSeparator=mstrmojo.locales.number.THOUSANDSEPARATOR||",";A7.mstrCurrencySymbol="$";A7.mstrDecimalPoint=mstrmojo.locales.number.DECIMALSEPARATOR||".";A7.mstrPercentSign="%";A7.mstrMinusSign="-";}while(AV<Ae){if(AX.charAt(AV)==='"'){AV++;while(AV<Ae&&AX.charAt(AV)!=='"'){AV++;}}else{if(AX.charAt(AV)==="["){AV++;var Ap="";while(AV<Ae&&AX.charAt(AV)!=="]"){Ap+=AX.charAt(AV);AV++;}if(Ap.length>1&&(Ap.charAt(0)===">"||Ap.charAt(0)==="<"||Ap.charAt(0)==="=")){var AL=-1;var A9=0;switch(Ap.charAt(0)){case">":if(Ap.charAt(1)>="0"&&Ap.charAt(1)<="9"){AL=1;A9=1;}else{if(Ap.charAt(1)==="="&&Ap.length>2&&Ap.charAt(2)>="0"&&Ap.charAt(2)<="9"){AL=2;A9=2;}}break;case"=":if(Ap.charAt(1)>="0"&&Ap.charAt(1)<="9"){AL=3;A9=1;}else{if(Ap.charAt(1)==="="&&Ap.length>2&&Ap.charAt(2)>="0"&&Ap.charAt(2)<="9"){AL=3;A9=2;}}break;case"<":if(Ap.charAt(1)>="0"&&Ap.charAt(1)<="9"){AL=5;A9=1;}else{if(Ap.charAt(1)==="="&&Ap.length>2&&Ap.charAt(2)>="0"&&Ap.charAt(2)<="9"){AL=4;A9=2;}}break;}if(AL>0){var AZ=Ap.substr(A9);var BI=parseFloat(AZ);if((AL===1&&AO>BI)||(AL===2&&AO>=BI)||(AL===3&&AO===BI)||(AL===4&&AO<=BI)||(AL===5&&AO<BI)){BF=true;}}}}else{if(AX.charAt(AV)===";"){if(BF){Ae=AV;break;}else{Aq=AV+1;AV++;}}else{AV++;}}}}if(!BF){Aq=0;}AV=Aq;var Av=false;while(AV<Ae){if(AX.charAt(AV)==='"'){AV++;while(AV<Ae&&AX.charAt(AV)!=='"'){AV++;}}else{if(AX.charAt(AV)==="["){AV++;while(AV<Ae&&AX.charAt(AV)!=="]"){AV++;}}else{if(AX.charAt(AV)==="y"||AX.charAt(AV)==="M"||AX.charAt(AV)==="d"||AX.charAt(AV)==="h"||AX.charAt(AV)==="H"||AX.charAt(AV)==="m"||AX.charAt(AV)==="s"||AX.charAt(AV)==="S"){Av=true;break;}else{AV++;}}}}if(Av){var BD="";if(BF){BD=AX.substr(Aq,Ae-Aq);}else{BD=AX;}return mstrmojo.num.formatByMask(BD,AO);}var BH;var Am;var As=false;var AR=false;var BC=false;var Ad=false;var BN=[];var Ah="K";var Aa=0;var A8=false;var AY=0;var BO="";var AS="";var Al="";var A6="";var AW=0;var BK=0;var BJ=false;var BA=A7.mstrCurrencySymbol;var A1=A7.mstrThousandSeparator;var Ax=A7.mstrDecimalPoint;var BB=A7.mstrPercentSign;var A5=A7.mstrMinusSign;AV=Aq;var Ak="";if(AO<0&&!BF){while(AV<Ae&&AX.charAt(AV)!==";"){if(AX.charAt(AV)==='"'){AV++;while(AV<Ae&&AX.charAt(AV)!=='"'){AV++;}}AV++;}AV++;if(AV>=Ae){if(AO<0){BO+="-";}AV=Aq;}}var BP=false;while(AV<Ae){var Ar=false;switch(AX.charAt(AV)){case"[":AV++;while(AV<Ae&&AX.charAt(AV)!=="]"){Al+=AX.charAt(AV);AV++;}if(Al.length>0&&(Al.charAt(0)===">"||Al.charAt(0)==="<"||Al.charAt(0)==="=")){Al="";}AV++;break;case'"':AV++;while(AV<Ae&&AX.charAt(AV)!=='"'){if(AX.charAt(AV)==="K"){BC=true;Ah="K";}else{if(BP){AS+=AX.charAt(AV);}else{BO+=AX.charAt(AV);}}AV++;}AV++;break;case"#":case"0":var Ac=AX.charAt(AV);BP=true;var Ag=1;AV++;while(AV<Ae&&AX.charAt(AV)===Ac){Ag++;AV++;}if(AV+1<Ae&&AX.charAt(AV)==="-"&&AX.charAt(AV+1)===Ac){Ad=true;BN.push(Ag);AV++;while(true){Ag=0;while(AV<Ae&&AX.charAt(AV)===Ac){Ag++;AV++;}BN.push(Ag);if(AV>=Ae||AX.charAt(AV)!=="-"){break;}AV++;}}while(AV<Ae){if(AX.charAt(AV)===","){if(AV+1<Ae&&AX.charAt(AV+1)===Ac){As=true;}else{break;}}else{if(AX.charAt(AV)!==Ac){break;}}AV++;}break;case".":BP=true;AV++;Aa=0;while(AV<Ae&&AX.charAt(AV)==="0"){Aa++;AV++;}if(Aa===0){while(AV<Ae&&AX.charAt(AV)==="#"){Aa++;AV++;}}break;case"E":BK=6;while(AV<Ae&&AX.charAt(AV)!=="0"){if(AX.charAt(AV)==="+"&&AV<Ae&&AX.charAt(AV+1)==="0"){AR=true;}else{A6+=AX.charAt(AV);}AV++;}AW=0;while(AV<Ae&&AX.charAt(AV)==="0"){AW++;AV++;}break;case"%":BK=4;AV++;break;case"(":AV++;BO+="(";break;case")":AV++;AS+=")";break;case"-":AV++;if(AO<0){BO+=A5;}break;case"?":AV++;break;case"/":if(AV>Aq&&AX.charAt(AV-1)==="?"&&AV+1<Ae&&AX.charAt(AV+1)==="?"){BK=5;A8=false;Am=AV-1;while(Am>Aq&&AX.charAt(Am)==="?"){Am--;}while(Am>Aq&&AX.charAt(Am)===" "){Am--;}if(Am>=Aq&&(AX.charAt(Am)==="#"||AX.charAt(Am)==="0")){A8=true;}AY=0;AV++;while(AV<Ae&&AX.charAt(AV)==="?"){AY++;AV++;}}else{AV++;}break;case",":if(AV>Aq&&(AX.charAt(AV-1)==="0"||AX.charAt(AV-1)==="#")){if(AV+1<Ae&&(AX.charAt(AV+1)==="K"||AX.charAt(AV+1)==="k")){BC=true;Ah=AX.charAt(AV+1);AV++;}}Am=AV+1;while(Am<Ae){if(AX.charAt(Am)===","){Am++;continue;}else{break;}}if(Am===Ae||AX.charAt(Am)==="."){BJ=true;}if(BJ||(!BJ&&AV+1<Ae&&AX.charAt(AV+1)===",")){while(AV<Ae&&AX.charAt(AV)===","){AO/=1000;AV++;}AV--;}AV++;break;case";":Ar=true;break;case"$":if(BP){AS+=BA;}else{BO+=BA;}AV++;break;default:if(BP){AS+=AX.charAt(AV);}else{BO+=AX.charAt(AV);}AV++;}if(Ar){break;}}if(AO<0){AO=-AO;}var Az="";if(Ad){var Au=0;for(BH=0;BH<BN.length;BH++){Au+=BN[BH];}Az=Ak=this.fillZeroToWidth(Au,AO.toFixed());for(BH=0;BH<BN.length-1;BH++){Au-=BN[BH];var At=Az.length-Au;Az=Az.slice(0,At)+"-"+Az.slice(At);}}else{switch(BK){case 0:if(BC){AO/=1000;}var A3=AO;if(A3<0){A3=-A3;}var AK=0;while(A3>=10){A3/=10;AK++;}if(AK>=15){Az=Ak=this.fillZeroToWidth((AO<0?-AO:AO),10);var An=Az.indexOf(".");if(An!==-1){Az=Az.slice(0,An)+Az.slice(An+1);}Az=Az.substr(0,16);if(Az.charAt(15)>="5"){var AU=14;while(AU>=0&&Az.charAt(AU)==="9"){Az=Az.slice(0,AU)+"0"+Az.slice(AU+1);AU--;}var AP=Az.charAt(AU);AP++;if(AU>=0){Az=Az.slice(0,AU)+AP+Az.slice(AU+1);}else{Az="1"+Az;}}Az=Az.substr(0,15);var BG;for(BG=AK-14;BG>0;BG--){Az+="0";}if(AO<0){Az=A5+Az;}}else{Ak+=(AO+Math.pow(0.1,Aa+6)).toFixed(Aa);Az=Ak;Az=this.ReplaceDecimalPoint(Az,Ax);if(AO<0){Az=this.ReplaceMinusSign(Az,A5);}}if(As){Az=this.InsertThousandSeparator(Az,A1,A7);}if(BC){Az+=Ah;}break;case 5:if(BC){AO/=1000;}var Aj=10;for(BH=1;BH<AY;BH++){Aj*=10;}var AM={numerator:0,denominator:1};var AT={numerator:1,denominator:1};var AQ={numerator:1,denominator:2};var Ay={numerator:0,denominator:1};var Af=AO>=0;var A4=Math.abs(AO);var A2=parseInt(A4,10);A4-=A2;while(AQ.denominator<Aj){if(Math.abs(AH.call(AQ)-A4)<1e-15){Ay=AQ;break;}if(AH.call(AQ)>A4){AT=AQ;}else{AM=AQ;}AQ.denominator=AM.denominator+AT.denominator;AQ.numerator=AM.numerator+AT.numerator;}if(AQ.denominator>=Aj){if(A4-AH.call(AM)<AH.call(AT)-A4){Ay=AM;}else{Ay=AT;}}if(A2>0){Ay.numerator+=A2*Ay.denominator;}if(Ay.denominator===0){A8=false;}var BE=false;var A0=false;var BM=Ay.numerator;if(A8){A2=Math.floor(Ay.numerator/Ay.denominator);BM=Ay.numerator%Ay.denominator;A0=A0||(BM!==0);if(A2>0){BE=true;Ak+=A2;if(A0){Ak+=" ";}}}if(!A0&&!BE&&BM===0){Ak+="0";}else{if(!A0&&BE&&BM===0){AJ++;}else{Ak+=BM;Ak+="/";Ak+=Ay.denominator;}}Az=Ak;if(!Af){Az=A5+Az;}if(As){Az=this.InsertThousandSeparator(Az,A1,A7);}if(BC){Az+=Ah;}break;case 4:AO*=100;Ak+=(AO+Math.pow(0.1,Aa+6)).toFixed(Aa);Az=Ak;Az=this.ReplaceDecimalPoint(Az,Ax);if(AO<0){Az=this.ReplaceMinusSign(Az,A5);}if(As){Az=this.InsertThousandSeparator(Az,A1,A7);}Az+=BB;break;case 6:var Aw=AO;var BL=0;if(Aw>1){while(Aw>=10){Aw/=10;BL++;}}else{if(Aw!==0){while(Aw<1){Aw*=10;BL--;}}}Ak+=(Aw+Math.pow(0.1,Aa+6)).toFixed(Aa);Ak+=A6;if(AR&&BL>=0){Ak<<"+";}if(BL<0){Ak<<"-";BL=-BL;}Ak+=this.fillZeroToWidth(BL,AW);Az=Ak;Az=this.ReplaceDecimalPoint(Az,Ax);if(AO<0){Az=this.ReplaceMinusSign(Az,A5);}break;}}var AN=BO+Az+AS;var Ab=false;if(Al.length!==0&&Ab){AN='<SPAN STYLE="COLOR: '+Al+'" >'+AN+"</SPAN>";}return AN;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.color","mstrmojo.VisUtility","mstrmojo.gmaps.MapEnums","mstrmojo.chart.enums.EnumFontStyle");var N=mstrmojo.color,I=mstrmojo.VisUtility,B=mstrmojo.gmaps.EnumDataLabel,G=mstrmojo.gmaps.EnumDataLabelShowOption,E=mstrmojo.chart.enums.EnumFontStyle,M=mstrmojo.gmaps.MarkerAlignOption,F=2,H=4,A=10,L=["bottom","top","left","right"];function Q(U,T,S,R){return U>this.intsecXmax||T>this.screenHeight||(U+S<this.intsecXmin)||(T+R<0);}function D(V,U,T,S){var R={};R.rowStart=Math.floor(U/A);R.colStart=Math.floor(V/A);R.rowEnd=Math.floor((U+S)/A);R.colEnd=Math.floor((V+T)/A);return R;}function P(X,V){var Z;if(V.x<X.x){Z=V;V=X;X=Z;}var a=X.x,T=a+X.w,W=X.y,S=W+X.h,Y=V.x,U=V.y,R=U+V.h;return Y<=T&&U<=S&&R>=W;}function K(X){if(!X||X.length<=0){return 0;}var Y=0,R=X.length,W,V,T,U,S;for(W=0;W<R-1;W++){V=X[W][0];T=X[W][1];U=X[W+1][0];S=X[W+1][1];Y+=(V*S-U*T);}V=X[R-1][0];T=X[R-1][1];U=X[0][0];S=X[0][1];Y+=(V*S-U*T);return Math.abs(Y);}function O(U){var T,W=(U&&U.length)||0,V,R=Number.NEGATIVE_INFINITY,S=-1;if(W===1){return 0;}for(T=0;T<W;T++){V=K(U[T]);if(V>R){R=V;S=T;}}return S;}function C(W,T){var V,U,S=W[B.DATA_LABEL_FONT_STYLE],R={fontFamily:W[B.DATA_LABEL_FONT_FAMILY],fontSize:W[B.DATA_LABEL_FONT_SIZE]};if(S&E.FS_BOLD){R.fontWeight="bold";}else{R.fontWeight="normal";}if(S&E.FS_ITALIC){R.fontStyle="italic";}else{R.fontStyle="normal";}if((S&E.FS_STRIKETHROUGH)&&(S&E.FS_UNDERLINE)){V="line-through underline";}else{if(S&E.FS_STRIKETHROUGH){V="line-through";}else{if(S&E.FS_UNDERLINE){V="underline";}else{V="none";}}}R.textDecoration=V;U=W[B.DATA_LABEL_FONT_COLOR];if(T){U=U==="transparent"?[0,0,0,0]:N.decodeColor(U);R.color=new dojo.Color(U);}else{R.color=U==="transparent"?"rgba(0,0,0,0)":N.decodeColor(U);}return R;}function J(T,R){var S=new T(R.fontSize);S.setFamily(R.fontFamily);if(R.fontWeight==="bold"){S.setWeight(T.WEIGHT_BOLD);}if(R.fontStyle==="italic"){S.setStyle(T.STYLE_ITALIC);}S.setDecoration(R.textDecoration);return S;}mstrmojo.gmaps._MapDataLabel=mstrmojo.provide("mstrmojo.gmaps._MapDataLabel",{_mixinName:"mstrmojo.gmaps._MapDataLabel",getCentroidOfPolygon:function(b){var U=O(b);if(U<0){return null;}b=b[U];var R=0,Z,V=b.length,T,a,Y,X,W,S=[0,0];for(T=0;T<V-1;T++){a=b[T][0];Y=b[T][1];X=b[T+1][0];W=b[T+1][1];Z=(a*W-X*Y);R+=Z;S[0]+=(a+X)*Z;S[1]+=(Y+W)*Z;}a=b[V-1][0];Y=b[V-1][1];X=b[0][0];W=b[0][1];Z=(a*W-X*Y);R+=Z;S[0]+=(a+X)*Z;S[1]+=(Y+W)*Z;R=R*3;S=[S[0]/R,S[1]/R];return S;},populateDataLabelMetricValues:function(){var V,Y,Z,X,W,R=this.data.gvs&&this.data.gvs.items,U=this.parent.dataLabelMetricConfig,T=this.dataLabelsConfig,S=(T&&T.length)||0;if(!U||!R){return ;}W=U.index;for(V=0;V<S;V++){if(!T[V].disableLabel){Y=T[V].rowIndex;T[V].values=[];if(Y!==undefined&&R[Y]){Z=R[Y].items;X=Z&&Z[W];if(X){T[V].values.push(X.v);}}}}},initParas:function(){var R=this.parent,S=R.getWidth(),T=R.getHeight();this.cellMatrix={};this.rectPool={};this.screenWidth=S;this.screenHeight=T;this.intsecXmin=0;this.intsecXmax=S;this.isMarkerMapType=this.isMarkerMap();},setGlobalOption:function(U,T,S,R){this.showAllDataLabel=U[B.DATA_LABEL_SHOW_ALL];this.dlShowOption=T;this.isEsriMap=S;this.dlFontStyle=R;this.dlFontHeight=I.measureTextHeight("Style",R);if(S){this.dlFont=J(esri.symbol.Font,R);}},buildDataLabelLayer:function(){if(!this.supportDataLabel()||!this.parent){return ;}this.initParas();var U,T,a,b,W=this.scriptClass==="mstrmojo.esrimap.ESRIMapViewer",V=this.isMarkerMapType?L:["center"],d=V.length,c=this.parent,S=this.dataLabelsConfig,R=(S&&S.length)||0,Z=c.widgetProps,X=Z[B.DATA_LABEL_SHOW];if(X===G.NONE||R<=0){this.removeDataLabelLayer();return ;}this.clearDataLabelLayer();this.createDataLavelLayer();a=C(Z,W);this.setGlobalOption(Z,X,W,a);try{this.updateScreenPoint(S);}catch(Y){this.removeDataLabelLayer();return ;}if(this.isMarkerMapType){this.addMarkerRectange();}for(U=0;U<R;U++){if(!S[U].disableLabel){for(T=0;T<d;T++){b=this.getLabelsRectConfig(S[U],V[T]);if(this.canBeShown(b)){this.drawDataLabels(b.labels,b.mapPoint);break;}}}}},evaluateLabels:function(Y){var V,U,W,S=this.dlFontStyle,R={width:0},X=(Y&&Y.length)||0,T=[];for(V=0;V<X;V++){U=Y[V];if(U){W=I.measureTextWidth(U,S);if(R.width<W){R.width=W;}T.push({label:U,width:W});}}R.height=T.length*this.dlFontHeight;return{labels:T,size:R};},getLabelsRectConfig:function(S,R){var T;switch(this.dlShowOption){case G.SHOW_TEXT:T=[S.text];break;case G.SHOW_VALUE:T=S.values||[];break;case G.SHOW_BOTH:T=[S.text].concat(S.values||[]);break;}return this.addLabelRect(S,T,R);},addLabelRect:function(r,R,u){var k,t,Z,V,c,Y,f,e,W,T,m,l=this.isEsriMap,o=l?-1:1,d=this.dlFontHeight,s=this.isMarkerMapType,h=r.screenPoint,X=r.symbolSize&&r.symbolSize.alignOption,b=this.evaluateLabels(R),S=b.size.width,a=b.size.height,U=S/2,q=a/2,p=b.labels,g=p.length;if(g===0){return null;}m={labels:[],mapPoint:r.mapPoint,index:"label#"+r.rowIndex};V=h.x-U;c=h.y-q;if(s){Y=r.markerRect;W=Y.w/2;T=Y.h/2;f=Y.x+W;e=Y.y+T;V=f-U;c=e-q;switch(u){case"left":V=f-W-S-H;break;case"top":c=e-T-a-H;break;case"right":V=f+W+H;break;case"bottom":c=e+T+H;break;}}m.rect={x:V,y:c,w:S,h:a};for(k=0;k<g;k++){if(l){t=0;Z=q-(k+0.8)*d;}else{t=-p[k].width/2;Z=-q+k*d;}if(s){switch(u){case"left":t-=U+W+H;break;case"top":Z-=(q+T+H)*o;break;case"right":t+=U+W+H;break;case"bottom":Z+=(q+T+H)*o;break;}switch(X){case M.TOP:Z+=T*o;break;case M.TOP_LEFT:t+=W;Z+=T*o;break;case M.TOP_RIGHT:t-=W;Z+=T*o;break;case M.LEFT:t+=W;break;case M.RIGHT:t-=W;break;case M.BOTTOM:Z-=T*o;break;case M.BOTTOM_LEFT:t+=W;Z-=T*o;break;case M.BOTTOM_RIGHT:t-=W;Z-=T*o;break;}}m.labels.push({label:p[k].label,xOffset:t,yOffset:Z});}return m;},canBeShown:function(e){if(!e){return false;}var V,W,U,R,S,c,Z,Y,d,f,b,a,k,m,X,T=this.cellMatrix,g=this.rectPool;X=e.index;S=e.rect;c=S.x;Z=S.y;Y=S.w;d=S.h;f=c-F;b=Z-F;a=Y+F*2;k=d+F*2;if(Q.call(this,f,b,a,k)){return false;}if(this.showAllDataLabel){return true;}V=D(f,b,a,k);for(W=V.rowStart;W<=V.rowEnd;W++){for(U=V.colStart;U<=V.colEnd;U++){if(T[W]&&T[W][U]){R=T[W][U];for(m in R){if(R.hasOwnProperty(m)&&P({x:f,y:b,w:a,h:k},g[m])){return false;}}}}}g[X]=S;for(W=V.rowStart;W<=V.rowEnd;W++){for(U=V.colStart;U<=V.colEnd;U++){if(!T[W]){T[W]={};}if(!T[W][U]){T[W][U]={};}T[W][U][X]=true;}}return true;},addMarkerRectange:function(){var f,k,h,e,U,a,d,b,X,Y,V,Z,W,T=this.cellMatrix,g=this.rectPool,R=this.showAllDataLabel,S=this.dataLabelsConfig,c=(S&&S.length)||0;for(f=0;f<c;f++){k=S[f];Z="marker#"+k.rowIndex;h=k.symbolSize;d=h.width;b=h.height;e=k.screenPoint;U=e.x-d/2;a=e.y-b/2;switch(h.alignOption){case M.TOP:a=e.y;break;case M.TOP_LEFT:U=e.x;a=e.y;break;case M.TOP_RIGHT:U=e.x-d;a=e.y;break;case M.LEFT:U=e.x;break;case M.RIGHT:U=e.x-d;break;case M.BOTTOM:a=e.y-b;break;case M.BOTTOM_LEFT:U=e.x;a=e.y-b;break;case M.BOTTOM_RIGHT:U=e.x-d;a=e.y-b;break;}W={x:U,y:a,w:d,h:b};k.markerRect=W;if(R||Q.call(this,U,a,d,b)){continue;}g[Z]=W;X=D(U,a,d,b);for(Y=X.rowStart;Y<=X.rowEnd;Y++){for(V=X.colStart;V<=X.colEnd;V++){if(!T[Y]){T[Y]={};}if(!T[Y][V]){T[Y][V]={};}T[Y][V][Z]=true;}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.num","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.color","mstrmojo.chart","mstrmojo.chart.common.Utility");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphObject");var o=mstrmojo,p=mstrmojo.array,P=mstrmojo.hash,H=mstrmojo.num,G=mstrmojo.VisUtility,a=mstrmojo.chart,K=a.enums,b=K.EnumGraphMajorType,J=a.common.Utility,T=a.model,M=T.enums,x=M.EnumDSSGraphObject,AB=mstrmojo.VisEnum.ControlType,y=o.gm,U=mstrmojo.gm.EnumTextAlignH,r=mstrmojo.gm.EnumTextAlignV,w=";",k=",",A="_tmsp",L=" ",Y=-20,l=mstrmojo.gm.EnumSelectionOptionLevel,AD=mstrmojo.gm.EnumShape,f=mstrmojo.color,I=mstrmojo.gm.EnumIdentityType,R=0.00001,D,Z=Math.pow(2,30),c=Math.pow(2,60);var e=["Reserved",mstrmojo.desc(2125,"Maximum"),mstrmojo.desc(2127,"Minimum"),mstrmojo.desc(2122,"Average"),mstrmojo.desc(2126,"Median"),mstrmojo.desc(4046,"First"),mstrmojo.desc(4049,"Last"),mstrmojo.desc(7194,"Constant")];function m(AJ,AI){var AK,AH=AJ.length;if(AH!==AI.length){return false;}for(AK=0;AK<AH;AK++){if(AJ[AK]!==AI[AK]){return false;}}return true;}function AC(AK,AI,AL){var AJ=false,AM=AL+A,AH=AK[AM],AN=AI[AM];if(AI[AL]===undefined){AJ=true;}else{if((AN===undefined&&AH!==undefined)||(AN!==undefined&&AH!==undefined&&AN<AH)){AJ=true;}}if(AJ){AI[AL]=AK[AL];if(AN!==undefined){AI[AM]=AH;}}}function AG(AI,AH){var AJ;for(AJ in AI){if(AI.hasOwnProperty(AJ)){AC(AI,AH,AJ);}}return AH;}function W(AL){var AK={},AJ,AI=[],AH;p.forEach(AL,function(AM){if(AM!==undefined){AI.push(AM);}});AH=AI.length;if(AH===1){return AI[0];}for(AJ=0;AJ<AH;AJ++){AG(AI[AJ],AK);}return AK;}function AA(AH){return{n:AH,s:AH.toString(),on:AH};}function X(AJ,AH,AL){if(AH===AJ){return 0;}var AI=AH-AJ,AK=1;while(AI<1){AI*=10;AK/=10;}while(AI>=10){AI/=10;AK*=10;}if(AI<1.8){AK*=0.2;}else{if(AI<3.1){AK*=0.4;}else{if(AI<4.6){AK*=0.5;}else{if(AI>=8.1){AK*=2;}}}}if(AL){AK=Math.round(AK);if(AK<1){AK=1;}}return AK;}function B(AK,AO,AQ,AI){var AM=[];if(AK===AO){if(AK<0){AM.push(mstrmojo.gm.GMUtility.formatNumber(AK,"nearest"));}AM.push({n:0,s:"0",on:0});if(AK>0){AM.push(mstrmojo.gm.GMUtility.formatNumber(AK,"nearest"));}return AM;}var AH=AI>0?AI:X(AK,AO,AQ);var AJ=Math.ceil(AO/AH)*AH;if(AJ-AO>=AH*0.9){AJ=Math.floor(AO/AH)*AH;}var AN=Math.floor(AK/AH)*AH;if(AK-AN>=AH*0.9){AN=Math.ceil(AK/AH)*AH;}var AP=Math.floor((AJ-AN+AH/100)/AH)+1,AL;for(AL=0;AL<AP;++AL){AM.push(mstrmojo.gm.GMUtility.formatNumber(AN+AL*AH,"nearest"));}return AM;}function S(AH,AK){var AJ;AH.mMaxTick=1;if(this.mChartContextPtr.mIsGraphMatrix){AH.mStep=this.mMinimum<0?0.2:0.1;if(AK.mUseCustomMinMax){var AI=AK;AH.mMaxTick=AI.mAxisMaxValue;AH.mMinTick=AI.mAxisMinValue;AH.mMaxTick=Math.min(1,AH.mMaxTick);AH.mMinTick=Math.max(-1,AH.mMinTick);AH.mStep=0.1;}else{if(this.mMaximum>=0.5){AH.mMaxTick=1;AH.mMinTick=Math.floor(this.mMinimum/AH.mStep)*AH.mStep;AH.mMinTick=(AH.mMinTick*this.mMinimum<0)?0:(AH.mMinTick>0?0:AH.mMinTick);if(this.mMinimum<-0.5){AH.mMinTick=-1;}}else{if(this.mMaximum>0){AH.mMaxTick=Math.ceil(this.mMaximum/AH.mStep)*AH.mStep;AH.mMinTick=-1;}else{AH.mStep=0.1;AH.mMaxTick=0;AH.mMinTick=-1;}}}}else{AH.mMinTick=(this.mMinimum<0)?-1:0;if(u.call(this,AH)){return ;}AH.mStep=this.mMajorGrid.mUseManualGrid?this.mMajorGrid.mGridInterval:(AH.mMaxTick-AH.mMinTick)/10;}for(AJ=AH.mMinTick+AH.mStep;AJ+a.gModuleMain.mTolerance<AH.mMaxTick;AJ+=AH.mStep){AH.mTicks.push(Math.round(AJ*100)/100);}}function O(AH,AM){var AL,AI,AO=AM,AN=AO.mDrawCustomLine,AJ=AO.mAxisCustomValue,AK;AH.mStep=1;if(this.mMaximum<=0){AH.mMinTick=1;AH.mMaxTick=10;if(AN&&AJ<=1){AO.mAxisCustomValue=AH.mMinTick;}return ;}if(this.mMinimum<=0){AI=this.mMaximum>1?0:-1;AH.mMinTick=Math.pow(10,AI);if(AO.mUseCustomMinMax){AH.mMaxTick=this.mMaximum;AL=Math.floor(g.call(this,this.mMaximum));if(g.call(this,this.mMaximum)===AL){AL--;}}else{AL=Math.ceil(g.call(this,this.mMaximum));AH.mMaxTick=Math.pow(10,AL);}for(AK=AI+1;AK<AL;++AK){AH.mTicks.push(Math.pow(10,Math.floor(AK)));}if(AN&&AJ<=0){AO.mAxisCustomValue=Math.max(AH.mMinTick,AO.mAxisCustomValue);}return ;}if(AO.mUseCustomMinMax){AL=g.call(this,this.mMaximum);AI=g.call(this,this.mMinimum);AH.mMaxTick=this.mMaximum;AH.mMinTick=this.mMinimum;}else{AL=Math.ceil(g.call(this,this.mMaximum));AI=Math.floor(g.call(this,this.mMinimum));AH.mMaxTick=Math.pow(10,AL);AH.mMinTick=Math.pow(10,AI);}for(AK=AI+1;AK<AL;++AK){AH.mTicks.push(Math.pow(10,Math.floor(AK)));}if(AN&&AJ<=0){AO.mAxisCustomValue=AH.mMinTick;}}function s(AR,AM){var AJ=AM,AH,AK;AR.mStep=d.call(this,this.mMaximum,this.mMinimum,AJ.mAlwaysIncludeZero);AR.mMaxTick=Math.ceil(this.mMaximum/AR.mStep)*AR.mStep;AR.mMinTick=Math.floor(this.mMinimum/AR.mStep)*AR.mStep;AR.mMinTick=(AR.mMinTick*this.mMinimum<0)?0:AR.mMinTick;if(AJ.mAlwaysIncludeZero){AR.mMaxTick=(this.mMaximum<0)?0:AR.mMaxTick;AR.mMinTick=(this.mMinimum>0)?0:AR.mMinTick;}var AL=AR.mMaxTick-AR.mMinTick;if(AR.mStep>=AL){return ;}if(u.call(this,AR)){return ;}AH=Math.floor((AR.mMaxTick-AR.mMinTick+AR.mStep/100)/AR.mStep)+1;var AN=this.mNumberFormat;for(AK=1;AK<AH-1;++AK){var AP=AR.mMinTick+AK*AR.mStep,AQ,AI,AO;if(AR.mStep<1&&AN.mFormatType===4&&AN.mCustomFormat.indexOf("%")!==-1){AQ=AP*100;if(!J.isIntegar(AQ)){AI=Math.round(AQ);AO=Math.abs(AQ-AI);if(AO<R){AP=AI/100;}}}AR.mTicks.push(AP);}}function C(AR,AL){var AQ=AL,AK,AH,AO,AJ,AN,AM,AI,AP;AR.mMaxTick=AQ.mAxisMaxValue;AR.mMinTick=AQ.mAxisMinValue;if(u.call(this,AR)){return ;}if(!V.call(this)||this.mMajorGrid.mUseManualGrid){AR.mStep=d.call(this,AR.mMaxTick,AR.mMinTick,false);AK=AR.mMaxTick-AR.mMinTick;if(AR.mStep>=AK){return ;}AH=Math.floor(AK/AR.mStep);if(!(this.mChartContextPtr.mIsTimeSeriesChart)&&AK===AH*AR.mStep){for(AJ=1;AJ<AH;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}else{AK=AR.mMaxTick-AR.mMinTick;AO=10;AN=false;for(AJ=3;AJ<AH;++AJ){AM=AK/AJ;while(AM<1){AM*=10;}while(AM>=10){AM/=10;}if(AM===Math.floor(AM)){AO=AJ;AN=true;break;}}if(AN){AR.mStep=AK/AO;for(AJ=1;AJ<AO;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}else{AI=Math.ceil((AR.mMinTick+AR.mStep/100)/AR.mStep)*AR.mStep;AP=Math.floor((AR.mMaxTick-AR.mStep/100-AI)/AR.mStep)+3;for(AJ=0;AJ<AP-2;++AJ){AR.mTicks.push(AI+AJ*AR.mStep);}}}}else{AK=AR.mMaxTick-AR.mMinTick;AO=10;for(AJ=6;AJ<=9;++AJ){AM=AK/AJ;while(AM<10){AM*=10;}while(AM>=100){AM/=10;}if(AM===Math.floor(AM)){AO=AJ;break;}}AR.mStep=AK/AO;for(AJ=1;AJ<AO;++AJ){AR.mTicks.push(AR.mMinTick+AJ*AR.mStep);}}}function E(AH,AL){var AK,AI,AJ;AH.mMaxTick=AL.mAxisMaxValue;if(AH.mMaxTick<=this.mMinimum){this.mMinimum=AH.mMaxTick-1;}AH.mStep=d.call(this,AH.mMaxTick,this.mMinimum,AL.mAlwaysIncludeZero&&(AH.mMaxTick>0));AK=(AL.mAlwaysIncludeZero&&(this.mMinimum>0))?0:this.mMinimum;if(V.call(this)){AH.mMinTick=AH.mMaxTick-Math.ceil((AH.mMaxTick-AK)/AH.mStep)*AH.mStep;}else{AH.mMinTick=Math.floor(AK/AH.mStep)*AH.mStep;}if(u.call(this,AH)){return ;}AI=Math.floor((AH.mMaxTick-AH.mStep/100-AH.mMinTick)/AH.mStep)+2;for(AJ=1;AJ<AI-1;++AJ){AH.mTicks.push(AH.mMinTick+AJ*AH.mStep);}}function h(AH,AM){var AI,AL,AJ,AK;AH.mMinTick=AM.mAxisMinValue;if(AH.mMinTick>=this.mMaximum){this.mMaximum=AH.mMinTick+1;}AH.mStep=d.call(this,this.mMaximum,AH.mMinTick,AM.mAlwaysIncludeZero&&(AH.mMinTick<0));AI=(AM.mAlwaysIncludeZero&&(this.mMaximum<0))?0:this.mMaximum;if(V.call(this)){AH.mMaxTick=AH.mMinTick+Math.ceil((AI-AH.mMinTick)/AH.mStep)*AH.mStep;}else{AH.mMaxTick=Math.ceil(AI/AH.mStep)*AH.mStep;}if(u.call(this,AH)){return ;}AL=Math.ceil((AH.mMinTick+AH.mStep/100)/AH.mStep)*AH.mStep;AJ=Math.floor((AH.mMaxTick-AL+AH.mStep/100)/AH.mStep)+2;for(AK=0;AK<AJ-2;++AK){AH.mTicks.push(AL+AK*AH.mStep);}}function d(AX,AR,AJ){var AQ,AL;if(this.mMajorGrid.mUseManualGrid){return this.mMajorGrid.mGridInterval;}AQ=0;if(AJ){AQ=Math.max(AX,AX-AR);AQ=Math.max(AQ,-AR);}else{AQ=AX-AR;}if(AQ===0){this.mIsShown=false;return 1;}if(AQ>=1&&AQ<=4&&parseInt(AQ)===AQ){var AY=this.PrimaryMetricIndex,AM=AY.length;for(var AT=0;AT<AM;AT++){var AP=this.mChartContextPtr.mDatasetPtr,AS=AP.dataProvider,AK=AS.getSeriesCount(),AO=AS.getGroupCount(),AI=AY[AT],AN,AV;for(var AW=0;AW<AK;AW++){AN=AS.getMetricIndexForSeries(AW);if(AN===AI){AV=true;for(var AU=0;AU<AO;AU++){var AZ=AP.GetData(AW,AU);if(parseInt(AZ)!==AZ){AV=false;break;}}}if(AV){return 1;}}}}var AH=AQ;AL=1;while(AQ<1){AQ*=10;AL/=10;}while(AQ>=10){AQ/=10;AL*=10;}if(AQ<1.8){AL*=2;AL/=10;}else{if(AQ<3.1){AL*=4;AL/=10;}else{if(AQ<4.6){AL*=5;AL/=10;}else{if(AQ>=8.1){AL*=2;}}}}AL=this.postProcessStep(AL,AH);return AL;}function u(AH){if(this.mChartContextPtr.mIsGraphMatrix){return false;}var AI=this.mMajorGrid;return AI.mUseManualGrid&&(AI.mGridInterval<(AH.mMaxTick-AH.mMinTick)/30);}function g(AH){return Math.log(AH)/Math.log(10);}function V(){return(this.mGraphMajorType===b.GMT_HISTOGRAM||this.mGraphMajorType===b.GMT_POLAR)&&this.mTripleId.mObjectId===x.DssGraphX1Body;}function z(AK){var AL=this,AH=AL.id,AJ=AK.metricId,AI=new o.ui.menus.MenuConfig();(AK.options).forEach(function(AM){if(AM!==y.EnumRefLineModelType.CONST){AI.addMenuItem(e[AM],"xt",function(){AL.toggleRefLineEnabled(AJ,AM,true);});}else{AI.addEditorMenuItem(e[y.EnumRefLineModelType.CONST],AH,function(){return new mstrmojo.ui.menus.EditorConfig({data:{},contents:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"constVal",dtp:mstrmojo.expr.DTP.FLOAT,constraints:{trigger:mstrmojo.validation.TRIGGER.ONBLUR},onEnter:function(){this.validate();}}],fnOk:function(AO,AN){var AP=AN.constVal;if(AP.isValid()){AL.toggleRefLineEnabled(AJ,AM,true,AP.value);}}});});}});return AI;}function t(AJ){var AK=this,AI=AJ.metricId,AH=new o.ui.menus.MenuConfig();(AJ.options).forEach(function(AN){var AL=AN.refType,AM=e[AL]+((AL===y.EnumRefLineModelType.CONST)?("-["+H.toLocaleString(AN.c)+"]"):"");AH.addMenuItem(AM,"xt",function(){AK.toggleRefLineEnabled(AI,AL,false,0,AN.modix);});});return AH;}function AE(AL,AH){var AK=AL.GMController,AI=AK.getForbiddenShapeForMetric(AH),AJ=[];[{text:mstrmojo.desc(12097,"Bar"),value:AD.BAR},{text:mstrmojo.desc(2059,"Line"),value:AD.LINE},{text:mstrmojo.desc(9738,"Area"),value:AD.AREA},{text:mstrmojo.desc(12100,"Circle"),value:AD.CIRCLE},{text:mstrmojo.desc(12101,"Square"),value:AD.SQUARE},{text:mstrmojo.desc(12102,"Tick"),value:AD.TICK}].forEach(function(AM){if(AI.indexOf(AM.value)<0){AJ.push(AM);}});return AJ;}function q(AI,AH){return function(AK,AJ){if(AK!==AJ){AH({ctxt:{sp:AK,mid:AI}});}};}function AF(AK){var AI=AK.options,AH=this.getMenuHandler("changeShape"),AJ=new mstrmojo.ui.menus.MenuConfig();AJ.addRadioMenuGroup(AK.currValue,q(AK.metricId,AH),AI,"checkMark",undefined,true);return AJ;}mstrmojo.gm.GMUtility=mstrmojo.provide("mstrmojo.gm.GMUtility",{mTimers:[],mUseTimer:true,timerId:0,startTimer:function Q(AI){if(this.mUseTimer){var AH=this.timerId++;this.mTimers.push({timeStamp:new Date(),timerId:AH,desc:AI.functionName+": "+AI.purpose});return AH;}},endTimer:function F(AH){if(this.mUseTimer){var AL,AK=this.mTimers;if(AH===undefined){AL=AK.pop();}else{var AJ,AI;for(AJ=0;AJ<AK.length;AJ++){AI=AK[AJ];if(AI.timerId===AH){AL=AI;AK.splice(AJ,1);AJ--;}}}if(AL){G.visPrint("%c"+AL.desc+": "+(new Date()-AL.timeStamp)+"ms","color: blue");}}},computeTicksForPercentchart:function(AI,AH,AJ){return B(AI,AH,false,AJ);},computeTicksForFlexMinMax:function(AI,AH,AJ,AK){return B(AI,AH,AJ,AK);},formatNumber:function(AJ,AI,AH){return AA(AJ,AI,AH===undefined?3:AH);},sizeCalculator:{sum:function(AH,AL,AM){var AJ,AI=0,AK=0;if(AM===undefined){AM=AH.length;}AL=AL||1;for(AJ=0;AJ<AM;AJ++){if(AH[AJ]>0){AK+=AH[AJ];AI+=1;}}if(AI>1){AK+=(AI-1)*AL;}return AK;},add:function(AJ,AH,AI){AI=AI||1;if(AH>0){AJ+=(AH+AI);}return AJ;},minus:function(AJ,AH,AI){if(AH>0){AJ-=(AH+AI);}return AJ;}},replaceSpecialChars:function(AH){AH=AH.replace(/&/g,"&amp;");AH=AH.replace(/</g,"&lt;");AH=AH.replace(/>/g,"&gt;");AH=AH.replace(/"/g,"&quot;");return AH;},restoreSpecialChars:function(AH){AH=AH.replace(/&nbsp;/g," ");AH=AH.replace(/&lt;/g,"<");AH=AH.replace(/&gt;/g,">");AH=AH.replace(/&quot;/g,'"');AH=AH.replace(/&amp;/g,"&");return AH;},removeExtraSpace:function(AH){return AH.replace(/ {2,}/g," ");},stringToJSON:function(AH){if(AH===undefined){return undefined;}if(typeof AH==="string"){AH=AH.replace(/'/g,'"');return JSON.parse(AH);}return AH;},everythingToString:function(AI){if(AI===undefined){return undefined;}var AH;if(typeof AI==="object"){AH=JSON.stringify(AI.jsonObj||AI);}else{AH=AI.toString();}AH=AH.replace(/"/g,"'");return AH;},compareElementObj:function(AL,AI){var AK=AL.tid.toString(),AH=AI.tid.toString(),AM=AL.eid,AJ=AI.eid;if(AK!==AH){return AK>AH?1:-1;}if(AM===AJ){return 0;}return AM>AJ?1:-1;},isEqualComb:function(AI,AH){var AM=true,AL,AK=AI.length,AJ=AH.length;if(AK!==AJ){return false;}if(AI.length>1){AI.sort(this.compareElementObj);}if(AH.length>1){AH.sort(this.compareElementObj);}for(AL=0;AL<AK;AL++){if(this.compareElementObj(AI[AL],AH[AL])!==0){AM=false;break;}}return AM;},serializeCombination:function(AI){var AH="";if(AI.length>1){AI.sort(this.compareElementObj);}p.forEach(AI,function(AJ){if(AH!==""){AH+=w;}AH+=(AJ.tid+k+AJ.eid);});return AH;},deserializeCombination:function(AI){var AJ=AI.split(w),AH=[];p.forEach(AJ,function(AN){var AK=AN.split(k);var AM=AK[0];var AL=AK[1];AH.push({tid:AM,eid:AL});});return AH;},getElementCombinationForMetric:function(AH){var AI=[];AI.push({tid:-1,eid:AH});return AI;},getResolvedFormatsObject:function(AH){return W(AH);},isDigitalArrayEqual:function(AI,AH){return m.call(this,AI,AH);},indexOf:function(AI,AK){var AJ,AH=AI.length;for(AJ=0;AJ<AH;AJ++){if(m(AI[AJ],AK)){return AJ;}}return -1;},parseAxisScaleData:function(AL){var AJ,AM,AI,AH=AL.split(","),AK=[];for(AJ=0,AM=AH.length;AJ<AM;AJ++){AI=AH[AJ].split(":");AK.push(AI);}return AK;},parseCSSColor:function(AL,AI){var AK=AL.slice(1),AH=[],AJ;if(AK.length===6){if(AI===true){AH[0]=AK[4];AH[1]=AK[5];AH[2]=AK[2];AH[3]=AK[3];AH[4]=AK[0];AH[5]=AK[1];}else{for(AJ=0;AJ<6;AJ++){AH[AJ]=AK[AJ];}}}else{if(AI===true){for(AJ=2;AJ>=0;AJ--){AH.push(AK[AJ]);AH.push(AK[AJ]);}}else{for(AJ=0;AJ<3;AJ++){AH.push(AK[AJ]);AH.push(AK[AJ]);}}}return parseInt("0x"+AH.join(""),16);},RGB_BRG_Switch:function(AI){var AK=(AI>>16)&255,AJ=(AI>>8)&255,AH=(AI>>0)&255;return(AH<<16)|(AJ<<8)|(AK<<0);},encodeColor:function(AI){if(AI===undefined||AI===null||AI==="transparent"||AI==="default"){return AI;}var AJ=false,AH={};if(AJ){if(typeof AI==="object"){AH.c1=this.RGB_BRG_Switch(f.encodeColor(AI.c1));AH.c2=this.RGB_BRG_Switch(f.encodeColor(AI.c2));AH.or=AI.or;return AH;}return this.RGB_BRG_Switch(f.encodeColor(AI));}if(typeof AI==="object"){AH.c1=f.encodeColor(AI.c1);AH.c2=f.encodeColor(AI.c2);AH.or=AI.or;return AH;}return f.encodeColor(AI);},checkEquality:function(AI,AH){if(typeof AI==="object"&&AI.c1!==undefined){if(AI.c1!==AH.c1){return false;}if(AI.c2!==AH.c2){return false;}if(AI.or!==AH.or){return false;}return true;}return AI===AH;},decodeColor:function(AI){if(AI===undefined||AI===null||AI==="transparent"||AI==="default"){return AI;}var AJ=false,AH={};if(AJ){if(typeof AI==="object"){AH.c1=f.decodeColor(this.RGB_BRG_Switch(AI.c1));AH.c2=f.decodeColor(this.RGB_BRG_Switch(AI.c2));AH.or=AI.or;return AH;}return f.decodeColor(this.RGB_BRG_Switch(AI));}if(typeof AI==="object"){AH.c1=f.decodeColor(AI.c1);AH.c2=f.decodeColor(AI.c2);AH.or=AI.or;return AH;}return f.decodeColor(AI);},getTrendLineToggleHandler:function(AH,AJ,AI){return function(){AH.switchOnOffTrendLineForMetric(AJ,AI);};},getTrendLineToggleState:function(AH,AI){return AH.queryTrendLineStatusForMetric(AI);},getEditTrendLineHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(I.TREND_LINE,AI);};},getEditRefLineHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(I.REF_LINE,AI);};},getEditAxisScaleHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(I.AXIS_SCALE,AI);};},getEditAxisOriginHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(I.AXIS_ORIGIN_DEFINE,AI);};},getEditLogScaleHandler:function(AH,AI){return function(){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");AH.raiseEventCMSelection(I.LOG_SCALE,AI);};},getOptionObjArr:function(AH,AJ,AL){if(!D){D=mstrmojo.gm.GMUtility;}var AI={},AK;if(AJ!==undefined){AJ=AJ.toLowerCase();if(AJ==="x1"){AJ="x";}else{if(AJ==="y1"){AJ="y";}}}if(AH.length>1||(AL&&AH.length===1)){if(AJ==="x"){AI.opt=mstrmojo.desc(11712,"Bottom Axis");AI.key="XAxis";}else{if(AJ==="x2"){AI.opt=mstrmojo.desc(11710,"Top Axis");AI.key="X2Axis";}else{if(AJ==="y"){AI.opt=mstrmojo.desc(11715,"Left Axis");AI.key="YAxis";}else{if(AJ==="y2"){AI.opt=mstrmojo.desc(11713,"Right Axis");AI.key="Y2Axis";}else{if(AJ==="z"){AI.opt=mstrmojo.desc(12090,"SizeBy");AI.key="SizeBy";}}}}}AI.optLvl=l.AXIS;AI.mos=this.getMetricFormatFromIndexArray(AH);}else{if(AH.length===1){AK=this.getMetricFormat(AH[0]);AI.opt=AK.n;AI.mos=[AK];AI.key=AK.mId;AI.comb=D.getElementCombinationForMetric(AK.mId);AI.optLvl=l.METRIC;if(AJ==="z"){AI.sizeBy=true;}}}return AI;},filterInValidMetricIndex:function(AI){var AH=[];p.forEach(AI,function(AJ){if(AJ!==Y){AH.push(AJ);}});return AH;},fillBackgroundDiv:function(AI){var AH=document.createElement("div");AH.setAttribute("class","gm-bk-div");AH.style.backgroundColor="rgba(0,0,0,0)";AI.appendChild(AH);},getSubMenu:function(AM,AN,AL,AK){var AJ=AE(AM,AK),AH=AM.getMenuHandler("changeShape"),AI=AM.GMController.getOnTheFlyShapeForMetric(AK);if(AJ.length>1){AN.addSubMenuItem(mstrmojo.desc(11972,"Change Shape"),"",AM.id,AF,{currValue:AI,options:AJ,metricId:AL});}else{AN.addRadioMenuGroup(AI,q(AL,AH),AJ,"checkMark",undefined,true);}},getReferenceLineSubMenu:function(AI,AM,AN,AH){var AO=mstrmojo.gm.EnumSubtype,AL=AI.GMController.chartSubType;if(AN&&AL===AO.PERCENT){return ;}var AP=AI.id,AJ=AI.getAvailableRefLineTypes(AH)||[];if(AJ.length>0){AM.addSubMenuItem(mstrmojo.desc(13021,"Add Reference Line"),"xt",AP,z,{metricId:AH,options:AJ});}var AK=AI.getExistingRefLineOptions(AH)||[];if(AK.length>0){AM.addMenuItem(mstrmojo.desc(13659,"Edit Reference Line"),"xt",D.getEditRefLineHandler(AI,AH));AM.addSubMenuItem(mstrmojo.desc(13022,"Remove Reference Line"),"xt",AP,t,{metricId:AH,options:AK});}},reverseMapping:function n(AI){var AK={},AJ,AH=AI.length;for(AJ=0;AJ<AH;AJ++){AK[AI[AJ]]=AJ;}return AK;},longIntAnd:function(AI,AH){var AJ;if(AI===AH){return AI;}if(AI>c||AH>c){throw new Error("Operand exceeds valid data range.");}if(AI<Z&&AH<Z){return AI&AH;}if(AI>=Z||AH>=Z){if(AI<AH){AJ=AI;AI=AH;AH=AJ;}}var AL=Math.floor(AI/Z),AK=Math.floor(AH/Z),AN=AI-AL*Z,AM=AH-AK*Z;return(AN&AM)+(AL&AK)*Z;},longIntOr:function(AI,AH){var AJ;if(AI===AH){return AI;}if(AI<Z&&AH<Z){return AI|AH;}if(AI<AH){AJ=AI;AI=AH;AH=AJ;}AJ=this.longIntAnd(AI,AH);return AH-AJ+AI;},parseNumeric:function(AH){return +AH||parseFloat(AH);},fillTextInDiv:function(AH,AQ,AS,AI,AT,AJ,AV,AL,AO){if(AI===undefined){AI=AH.offsetWidth;}if(AT===undefined){AT=AH.offsetHeight;}if(AL===undefined){AL=U.MIDDLE;}if(AO===undefined){AO=r.MIDDLE;}if(AJ===undefined){AJ=false;}var AP,AR,AN,AU=AJ?"gm-text-body":"gm-text-body-nowrap",AK=false,AM;AP=G.measureTextWidth(AS,AV,6);AM=G.measureTextWidth("...",AV,6);if(AP>AI&&AM>AI){return ;}AN=document.createElement("div");AN.setAttribute("class",AU);AN.setAttribute("type",AB.GM_TEXT_BODY);AN.identity=AQ;G.applyStyles2DomNode(AN,AV);AN.innerHTML=AS;AH.appendChild(AN);if(AJ){if(AP>AI){AR=AN.offsetHeight;}else{AR=G.measureTextHeight(AS,AV,4);}}else{AR=G.measureTextHeight(AS,AV,4);AK=AP>AI;}AP=Math.min(AP,AI);AN.style.width=AP+"px";if(AJ){AK=AN.scrollWidth>AP||AN.scrollHeight>AR;}if(AK){AN.setAttribute("title",AS);}else{AN.setAttribute("title","");}switch(AL){case U.LEFT:AN.style.left="0px";AN.style.textAlign="left";break;case U.MIDDLE:AN.style.left=((AI-AP)>>1)+"px";break;case U.RIGHT:AN.style.right="0px";AN.style.textAlign="right";break;}switch(AO){case r.TOP:AN.style.top="0px";break;case r.MIDDLE:AN.style.top=((AT-AR)>>1)+"px";break;case r.BOTTOM:AN.style.bottom="0px";break;}},updateTextColorAndAlignment:function(AH,AJ,AK){var AL=AH.firstChild,AM=AL.style,AI=AH.clientWidth,AN=AL.clientWidth,AP=AH.clientHeight,AO=AL.clientHeight;AM.left="auto";AM.right="auto";switch(AJ){case U.LEFT:AM.left="0px";break;case U.MIDDLE:AM.left=((AI-AN)>>1)+"px";break;case U.RIGHT:AM.right="0px";break;}AM.top="auto";AM.bottom="auto";switch(AK){case r.TOP:AM.top="0px";break;case r.MIDDLE:AM.top=((AP-AO)>>1)+"px";break;case r.BOTTOM:AM.bottom="0px";break;}},toggleDisplay:function(AI,AH){if(!AI){return ;}if(AH){AI.style.display="block";}else{AI.style.display="none";}},isTrendLineAvailableForMetric:function(AL,AM,AP){var AW=false,AT=mstrmojo.gm.EnumSubtype,AO=o.gm.EnumShape,AU=AL.GMController,AQ=AU.chartSubType,AV=AL.model.data.dz,AJ=AV.XAxis,AH=AV.YAxis,AK=AV.BreakBy,AN=AV.SliceBy,AR=AP,AI=AU.getChartInfo(),AS=AU.getBreakByAttrsID().length>0||(AI.isABL&&((AJ.MetricNames!==undefined)||(AH.MetricNames!==undefined)||(AK.MetricNames!==undefined)||(AN.MetricNames!==undefined)));if(AR===undefined){AR=AU.getOnTheFlyShapeForMetric(AM);}if(AI.isABL&&AQ===AT.PERCENT){AW=true;}if(AS&&!AI.isBubbleOrScatter&&(AR===AO.BAR||AQ===AT.STACKED||(AQ===AT.AUTO&&AR===AO.AREA))){AW=true;}if(AI.isABL){if(AJ.TemplateUnit&&AJ.TemplateUnit.length>1){AW=true;}if(AH.TemplateUnit&&AH.TemplateUnit.length>1){AW=true;}if(AJ.TemplateUnit===undefined&&AH.TemplateUnit===undefined){AW=true;}}AW=AW||this.isIgnoredMetric(AL,AM);return !AW;},isTrendLineAvailableForAnyMetric:function(AJ){var AI=AJ.model.data.gsi.mx,AH;for(AH in AI){if(this.isTrendLineAvailableForMetric(AJ,AH)){return true;}}return false;},isIgnoredMetric:function(AK,AI){var AJ=AK.GMController,AL,AH;if(AJ.bubbleSeriesNum!==undefined){AL=AJ.getMetricsOnYAxis();AH=AL.indexOf(AI);if(AH>=AJ.bubbleSeriesNum){return true;}AL=AJ.getMetricsOnXAxis();AH=AL.indexOf(AI);if(AH>=AJ.bubbleSeriesNum){return true;}}return false;},getAxisMetricsInfo:function(AM){var AH=AM.model.data.dz,AN=AM.model.data.gsi.mx,AI,AJ,AL=[];if(!AH||!AH.ColorBy||!AN){return AN;}var AK=function(AO){return(AO&&AO.TemplateMetric)||[];};AI=AK(AH.YAxis).concat(AK(AH.XAxis));p.forEach(AN,function(AO){AJ=false;p.forEach(AI,function(AP){if(AO.did===AP.id){AJ=true;return false;}});if(AJ){AL.push(AO);}});return AL;},isInvalidTemplate:function N(AK){if(AK.eg){return false;}var AI=AK.gts;var AH=AI.row.length===0&&AI.col.length===0;p.forEach(AI.row,function(AN){if(AN.otp===-1){AH=true;}});var AM=AI.col;if(AM.length>0){var AJ,AL=AM.length-1;for(AJ=0;AJ<AL;AJ++){if(AM[AJ].otp===-1){AH=true;}}}return AH;},isNoData:function(AH){return AH.eg!==undefined;},getInvalidTemplateErrMsg:function(AH){return AH||mstrmojo.desc(12094,"The Graph Matrix requires:")+"\n"+mstrmojo.desc(12095,"- at least one attribute to be placed on the row or column axis")+"\n"+mstrmojo.desc(12096,"- all metrics to be placed on the column axis, below any attributes");},initColorPickerBtnWithGradientDir:function(AI,AJ){mstrmojo.func.override({showPickerForCurrentMode:function AH(){this._super();if(this.pickerMode===2&&typeof this.color!=="object"){var AK=this.gradientOrientation,AL=AJ.getChartInfo().dirc===mstrmojo.gm.EnumABLDirection.VERTICAL;AK.set("selectedIndex",p.find(AK.items,"id",AL?0:1));}}},AI.colorPicker);},generateToolTipContent:function(AQ,AL,AH,AM,AO,AN,AT){var AK,AI,AJ,AP,AR,AS;for(AK=AQ;AK<AL;AK++){AI=AM[AK];AP=AO[AK];if(AK>AQ){AJ=AM[AK-1];AR=AO[AK-1];if(AI.id===AJ.id){if(AP===""){continue;}if(AI.fid===AJ.fid&&AP.idx===AR.idx){continue;}if(AI.n===""){AN[AN.length-1].v+=L+AP.n;continue;}}}if(AT){AN.push({n:AI.n,tid:AI.id,v:AP.n});}else{AS=AH===undefined?AI.isRowAttribute:AH;AN.push({n:AI.n,tid:AI.id,v:AP.n,eid:AP.id,tp:AI.otp,axis:AS?1:2,tui:AI.tui,ui:AI.tui,dpt:AI.tui+1,at:AP.at,isRowAttribute:AS,dei:AP.dei,o:AP.o});}}},getAttributeFormCnt:function(AH){var AI;if((AH.fcnt===undefined||AH.fcnt===null)&&AH.fs){AH.fcnt=AH.fs.length||1;}if(AH.fcnt!==undefined&&AH.fcnt!==null){AI=AH.fcnt;}else{if(AH.t===47){AI=1;}else{AI=AH.cs!==undefined?AH.cs:AH.rs;}}return AI;},isTrueForBoolValue:function(AH){return AH===true||AH==="true";},computeTicksForAxis:function(AK,AI){var AJ=AK.mOptions,AL,AH={mTicks:[]};if(AI){AL=P.copy(AJ);P.copy(AI,AL);}else{AL=AJ;}if(AK.mIsPercent){S.call(AK,AH,AL);return AH;}if(AL.mUseLogarithmicScale){O.call(AK,AH,AL);return AH;}if(AK.mGraphMajorType===b.GMT_BUBBLE&&AK.mTripleId.mObjectId===x.DssGraphZBody){AH.mMinTick=AL.mUseMinValue?AL.mAxisMinValue:AK.mMinimum;AH.mMaxTick=AL.mUseMaxValue?AL.mAxisMaxValue:AK.mMaximum;if(AK.mMinTick>=AK.mMaxTick){AH.mMaxTick=AH.mMinTick+1;}return AH;}if(!AL.mUseMaxValue&&!AL.mUseMinValue){s.call(AK,AH,AL);}else{if(AL.mUseMaxValue&&AL.mUseMinValue){C.call(AK,AH,AL);}else{if(AL.mUseMaxValue){E.call(AK,AH,AL);}else{h.call(AK,AH,AL);}}}return AH;},computeTicksForLogScale:function(AJ){var AI=AJ.mOptions,AH={mTicks:[]};O.call(AJ,AH,AI);return AH;},destroyDisposable:function(AH,AI){if(AI){p.removeItem(AH.disposables,AI);AI.destroy();}},handleDestroy:function(AK,AJ){if(!AK){return ;}var AL,AI=0,AH=AK.disposables,AM=(AH&&AH.length)||0;while(AI<AM){AL=AH[AI];if(!AL.scriptClass||AJ.indexOf(AL.scriptClass)<0){this.destroyDisposable(AK,AL);}if(AH.length<AM){AM=AH.length;}else{AI++;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo.VisEnum","mstrmojo.VisUtility","mstrmojo.gm.GMUtility","mstrmojo.color","mstrmojo.ui.menus.EditorConfig","mstrmojo.ui.menus.ToolbarEditorConfig","mstrmojo.vi.ui.editors.EditorGroup","mstrmojo.ui.editors.controls.LineConfigGroup","mstrmojo.ui.editors.controls.FillConfigGroup","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.CharacterGroup","mstrmojo.ui.editors.controls.AdvancedColorPicker");var Z=mstrmojo,I=Z.dom,K=Z.hash,a=Z.array,A=Z.css,k=Z.VisEnum.ControlType,h=mstrmojo.gm,F=mstrmojo.color,U=h.GMUtility,R=Z.VisUtility,l=h.FormatingPropertyTag,e=mstrmojo.models.FormatModel,c=e.ENUM_PROPERTY_NAMES,P=mstrmojo.chart.enums.EnumFontStyle,f=mstrmojo.VisEnum.GMLegendFormatingPropertyTag,G=mstrmojo.VisEnum.NetworkLegendFormattingCategory,V=mstrmojo.ui.editors.controls.AdvancedColorPicker,W={GLOBAL:"glb",FORMATTING:"fmt"},D={FONT_COMP:"FntCmp",FONT_FAMILY:"FntFml",FONT_STYLE:"FntStyle",FONT_SIZE:"FntSz",FONT_COLOR:"FntClr",LINE_COMP:"LnCmp",SHOW:"Shw",COLOR:"Clr",STYLE:"Style",THICKNESS:"Thk"};function N(s,p){var o=this.widget,q=o.domToolbarPH,r=this;o._lastOpened=null;q.innerHTML="";document.body.appendChild(q);A.toggleClass(q,mstrApp.getThemeClassName(),true);this.configureLegendPopup(p,q);o.toolEditor=p.newInstance({unrender:function(){}});o.toolEditorClosefn=function(t){var w=t.target,u=o.toolEditor.domNode;if(!I.contains(u,w,true,u)&&!R.isHostedPopupNode(w,"class",true,document.body)){r.hideToolbar();}};I.attachEvent(document.body,"mousedown",o.toolEditorClosefn,true);o.openPopup(this.widget.toolEditor);A.toggleClass(document.body,"hasToolbarPopup",true);}function L(p,o){var q;if(o===W.GLOBAL){q=this.readGlobalProperty(p);}else{if(o===W.FORMATTING){q=this.widget.getPropertiesOfFormatable();}}if(p.slice(-3)===D.COLOR){if(p!==l.COLOR_SQUARE_COLOR||o!==W.GLOBAL){q=U.decodeColor(q);}}return q;}function Q(p,o){var q=this;if(o===W.GLOBAL){return function(s){var r=L.call(q,p,W.GLOBAL);if(p===l.COLOR_SQUARE_COLOR){r=r.color;}if(!K.equals(s,r)){if(p.indexOf(D.COLOR)!==-1){s=U.encodeColor(s);}q.writeGlobalProperty(p,s);}};}return function(t,r){var s=L.call(q,p,W.FORMATTING);if(t!==s){if(p.indexOf(D.COLOR)!==-1){t=F.encodeColor(t);}q.widget.writeFormatableProperties(p,t,r);}};}function O(p,o){p=p||[];o=o||"";a.forEach(p,function(q){q.cssDisplay="inline-block";});return{scriptClass:"mstrmojo.HBox",cssClass:o,children:p};}function d(p,q){p=p||[];var o=new mstrmojo.Box({children:p,cssText:q});return o;}function B(s,t,o){var r="white-space: nowrap; width: 50px;";if(s===mstrmojo.desc(3905,"Background")||s===mstrmojo.desc(6242,"Color")){r="white-space: nowrap;";}else{if(s===mstrmojo.desc(2885,"Fill")){r="white-space: nowrap; margin-right: 9px;";}}var p=new mstrmojo.Label({text:s}),q=d(p,r);return O([q,t],o);}function b(p,q,o){var r=this;p=p||{};if(p.propNames===undefined){p.propNames=q;}p.onGroupValueChange=function(s,u,t){if(u!==t&&u!==undefined){(Q.call(r,s,o))(u,t);}};return p;}function S(q,p,o){var r=this;a.forEach(p,function(s){var t=L.call(r,s,o);if(t!==undefined){q.setChildValue(s,t);}});}function C(o,r,q,p){p=b.call(this,p,r,q);K.copy({width:"140px",height:"22px",colorPickerHostWithin:true},p);var s=new mstrmojo.ui.editors.controls.FillConfigGroup(p);if(s){s.iniChildrenComp(r);S.call(this,s,r,q);}if(typeof o==="string"){return B(o,s,(p||[]).rowContainerCSSClass);}return s;}function Y(q,p,o){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-ui-ToolBoxBackgroundFill",children:[C.call(this,mstrmojo.desc(2885,"Fill"),q,p,K.copy({rowContainerCSSClass:"mstrmojo-ui-rowContainer"},o))]}]});}function m(s,q,u,t,p){var r=L.call(this,u,t),w=this;var o=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:!!p,isHostedWithin:true,width:"40px",selectedValue:r,showNoFill:false,postselectedValueChange:function(x){(Q.call(w,u,t))(x.value,x.valueWas);}});if(s){o.alias=s;}if(typeof q==="string"){return B(q,o);}return o;}function n(p){var o;if(p.listenToUpdateColorMap instanceof Function){o=p.listenToUpdateColorMap(function(){p.raiseEvent({name:"colorByColorChange",type:"invalidateCache"});if(o&&p.detachUpdateColorMapListener instanceof Function){p.detachUpdateColorMapListener(o);}});}}function g(q,p){var o=L.call(this,q,p),r=this;return new mstrmojo.ui.menus.ToolbarEditorConfig({cssClass:"cbsquare-colorpicker",contents:[new mstrmojo.ui.editors.controls.AdvancedColorPicker({showAutomatic:!o.isDefaultColor,color:o.color,colorChanged:function(s){s=(this.showAutomatic&&s===V.VAL_AUTOMATIC)?"default":s;n(r.widget);(Q.call(r,q,p))(s,o.color);r.hideToolbar();},colorCanceled:function(){r.hideToolbar();}})]});}function T(u,p){var o={},t=L.call(this,p+D.FONT_STYLE,W.GLOBAL),r=L.call(this,p+D.FONT_COLOR,W.GLOBAL),q=L.call(this,p+D.FONT_FAMILY,W.GLOBAL),s=L.call(this,p+D.FONT_SIZE,W.GLOBAL);if(t!==undefined){o[c.FONT_WEIGHT]=(!isNaN(t)&&((t&P.FS_BOLD)>0));o[c.FONT_STYLE]=(!isNaN(t)&&((t&P.FS_ITALIC)>0));o[c.UNDERLINE]=(!isNaN(t)&&((t&P.FS_UNDERLINE)>0));o[c.LINE_THROUGH]=(!isNaN(t)&&((t&P.FS_STRIKETHROUGH)>0));}if(r!==undefined){o[c.COLOR]=r;}if(s!==undefined){o[c.FONT_SIZE]=s;}if(q!==undefined){o[c.FONT_FAMILY]=q;}u.setFormatSource(o);}function H(p,o){var q=null;if(o.indexOf(D.FONT_FAMILY)!==-1){q=p.fontFamily;}else{if(o.indexOf(D.FONT_STYLE)!==-1){q=p.fontStyle;}else{if(o.indexOf(D.FONT_SIZE)!==-1){q=p.fontSize;}else{if(o.indexOf(D.FONT_COLOR)!==-1){q=p.fontColor;}}}}return q;}function M(r,q,o){var p={bold:P.FS_BOLD,italic:P.FS_ITALIC,underline:P.FS_UNDERLINE,strikeout:P.FS_STRIKETHROUGH},s=this;q.forEach(function(t){var u=H(r,t);if(u){u.propName=t;if(t.indexOf(D.FONT_STYLE)!==-1){u.postselectionChange=function(w){var z=w.added,AA=u.items[(z&&z[0]!==undefined)?z[0]:w.removed[0]],y=!!z,x=L.call(s,t,o),AB=(x===undefined?0:x);if(y){AB=AB|p[AA.css];}else{AB=AB&(~p[AA.css]);}u.parent.raiseFormatValueChange(t,AB,x);};}else{if(t.indexOf(D.FONT_FAMILY)!==-1){u.postselectedIndexChange=function(w){var z=w.value,y=w.valueWas;if(z!==y){var x=u.items;u.parent.raiseFormatValueChange(t,x[z].id,x[y]&&x[y].id);}};}else{if(t.indexOf(D.FONT_SIZE)!==-1){u.postselectedValueChange=function(w){var y=parseInt(w.value,10)+"pt",x=parseInt(w.valueWas,10)+"pt";if(y!==x){u.parent.parent.raiseFormatValueChange(t,y,x);}};}else{u.postselectedValueChange=function(w){u.parent.parent.raiseFormatValueChange(t,w.value,w.valueWas);};}}}}});}function X(p,s,r,q){var w=this;q=q||{};if(q.propNames===undefined){q.propNames=s;}if(q.onGroupValueChange===undefined){q.onGroupValueChange=function(x,z,y){if(z!==y&&z!==undefined){(Q.call(w,x,W.GLOBAL))(z,y);}};}var o={cssClass:"mstrmojo-ui-ToolbarCharacter cf",layoutConfig:null,width:"381px",height:"22px"};q=K.copy(o,q);var u=new mstrmojo.ui.editors.controls.CharacterGroup(q),t=H(u,l.LEGEND_FONT_COLOR);t.showNoFill=false;M.call(this,u,s,r);T.call(this,u,p);return u;}function J(s,r){var x=r.firstChild,AB=x?x.offsetWidth:0,p=x?x.offsetHeight:0,t=document.body.offsetWidth,AA=document.body.offsetHeight,u=10,w=5,z=5;if(x){x.style.left="0";x.style.right="auto";x.style.top="0";x.style.bottom="auto";}var y={w:AB,h:0};var q=p>0;if(q){y.h=p;}else{return false;}if(q){r.style.left=s.x+"px";r.style.top=s.y-p-u/2+"px";}if(s.x+y.w>t){r.style.left=s.x-AB+"px";}if(q){var o=0;if(s.y-p-u/2<w){o=w;r.style.top=o+"px";}else{if(s.y+u/2>AA){o=Math.max(AA-u-p,w);r.style.top=o+"px";}}}}function E(o,r,q,p){return new mstrmojo.ui.menus.ToolbarEditorConfig({contents:[{scriptClass:"mstrmojo.vi.ui.editors.EditorGroup",showDivider:false,children:[X.call(this,o,r,q,p)]}]});}mstrmojo._FormateVisLegend=mstrmojo.provide("mstrmojo._FormateVisLegend",{_mixinName:"mstrmojo._FormateVisLegend",widget:null,readGlobalProperty:undefined,writeGlobalProperty:undefined,configureLegendPopup:undefined,init:function(o){this.widget=null;if(this._super){this._super(o);}if(this.widget&&!this.widget.domToolbarPH){var p;p=document.createElement("div");p.setAttribute("class","gm-menu-placeholder");this.widget.domToolbarPH=p;}},handleRMCOnLegend:function(AA){var t=AA.getTarget(),u=AA.e,y={x:u.pageX,y:u.pageY},x=t.getAttribute("type"),p,w,r,s=this,q=this.widget;AA.cancel();AA.preventDefault();if(mstrApp.isAppStatePresentation()||!mstrApp.allowWebDashboardDesign()){return ;}var z,o=function(AB){switch(AB){case k.LGD_COLORBOX_CTN:case k.LGD_COLORBOX:if(AB===k.LGD_COLORBOX){t=t.parentNode;}w=t.firstChild.identity;if(w&&w.comb){this.widget.colorSqureIdentity=w;this.selectColorBox(t,this.fmtMode);p=g.call(this,l.COLOR_SQUARE_COLOR,W.GLOBAL);y=this.adjustColorPickerPos(t);if(!y.alignLeft){r=p.ENUM_CORNERS;p.setAlignment(r.BOTTOM_LEFT,r.TOP_RIGHT);}}break;case k.LGD_TITLE:case k.LGD_TEXT:this.selectText(true);var AC=[l.LEGEND_FONT_SIZE,l.LEGEND_FONT_FAMILY,l.LEGEND_FONT_STYLE,l.LEGEND_FONT_COLOR];p=E.call(this,"lgd",AC,W.GLOBAL);z="lgd";break;default:this.selectLegendBody();var AD=[l.LEGEND_BG_COLOR,l.LEGEND_BG_FILL_TRANSPARENCY];p=Y.call(this,AD,W.GLOBAL);z="lgd";break;}if(p){N.call(this,y,p);if(!!z){mstrApp.rootCtrl.docCtrl.selectViPanel("propertiesPanel");q.parent.selectVIUnit();var AE=q.edtModel._targetPulldown;if(AE){AE.selectItemByField("v",z);}}}};o.call(this,x);J.call(this,y,this.widget.domToolbarPH);},hideToolbar:function(){var p=this.widget,q=p.domToolbarPH,s=q.firstChild,o=q.parentNode;if(s){q.removeChild(s);}if(o){o.removeChild(q);}var r=p.toolEditor;if(r){r.unrender=function(){r._super();};r.destroy();r.unrender=function(){};delete p.toolEditor;A.toggleClass(document.body,"hasToolbarPopup",false);A.toggleClass(q,mstrApp.getThemeClassName(),false);}if(p.toolEditorClosefn){I.detachEvent(document.body,"mousedown",p.toolEditorClosefn,true);delete p.toolEditorClosefn;}},highlightText:function(o){throw new Error("subclass need to implement highlightText function");}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.VisEnum","mstrmojo.VisLegend","mstrmojo.VisUtility","mstrmojo.gm.GMEnums","mstrmojo.gm.GMIdentities","mstrmojo.gm.GMUtility","mstrmojo.array","mstrmojo.string","mstrmojo.hash","mstrmojo._FormateVisLegend","mstrmojo.ui._HasScroller");var Ag=mstrmojo,Ad=Ag.gm,AB=Ag.dom,Ac=Ag.css,R=Ag.hash,AO=Ag.VisUtility,Z=Ad.GMUtility,O=mstrmojo.array,X=mstrmojo.string,e=Ad.ColorSquareIdentity,C=Ag.VisEnum.ControlType,k=Ad.EnumLegendSlot,AM=Ad.EnumDockPosition,o=Ad.EnumLegendSlot,AG=Ad.EnumIdentityType,AE=Ad.EnumShape,AY=Ag.VisEnum.GMLegendDataType,I=mstrmojo.desc(13966,"Size by:"),x="px",E=1.35,Y=0.75,V=5,J=20,m=J,AF=5,A=5,y=16,d=15,G=16,AJ=20,s=15,Ae=1,AA="setAttribute",l=3,g=2,P=8,r=15,AT=14,u=1,Q=2,f=4,Ah=8,Af=16,K=10,AV=3,AK=50,AQ=-3,t=5,AR="gm-legend-lock-icon",AN=mstrmojo.desc(14442,"This metric has its axis scale set to custom min and max values"),N="http://www.w3.org/2000/svg",w="\u2026",M=/[ \-]/;function AS(An,Ap,Ai,Aq){if(!An){return ;}var Ak,At,Al,As,Ao=An.style,Au=Ap===AM.TOP,Aj=Ap===AM.BOTTOM,Ar=Ap===AM.LEFT,Am=Ap===AM.RIGHT;if(Au||Aj){Ak=Ai;At=1;Al=-1;As=AQ;if(Aj){As+=Aq;}}else{if(Ar||Am){Ak=1;At=Aq;As=-1;Al=AQ;if(Am){Al+=Ai;}}}Ao.cssText="left:"+Al+x+";top:"+As+x+";width:"+Ak+x+";height:"+At+x+";";}function H(Aj){var Ai=String(Aj);return Ai.indexOf(" ")>=0||Ai.indexOf("-")>=0;}function W(Ak,Aj,Al){var Ai=typeof Ak==="string"?Z.restoreSpecialChars(Ak):Ak;return AO.measureTextWidth(Ai,Aj,Al);}function AI(Am,Al,Aj,Ai){var Ak=W(Al,Aj,K);Am.setAttribute("measureWidth",Ak);if(Ak>Ai){Ak=Ai;}else{Am.style.overflow="visible";}Am.setAttribute("displayWidth",Ak);Am.style.width=Ak+x;return Ak;}function B(Aj){var Ai;if(Aj.textContent&&typeof (Aj.textContent)!==undefined){Ai=Aj.textContent;}else{Ai=Aj.innerText;}return Ai;}function a(Ak){var Aj=Ak.getAttribute("measureWidth"),Ai=Ak.getAttribute("displayWidth");if(!Aj){Ak[AA]("title","");}Aj=parseFloat(Aj,10);Ai=parseFloat(Ai,10);if((Aj-Ai)>0.1){Ak[AA]("title",B(Ak));}else{Ak[AA]("title","");}}function AL(Am,Ai,Aj,Al){var Ak=document.createElement("div");Ak[AA]("class","gm-legend-underLine");Ak.style.width=Al-K+x;Ak.style.left=Ai+5+x;Ak.style.top=Aj+x;Am.appendChild(Ak);}function AX(Al,Ai,Aj){var Ak=document.createElement("div");Ak[AA]("class","gm-legend-underLine-anchorPoint");Ak.style.left=Ai+x;Ak.style.top=Aj-3+x;Al.appendChild(Ak);}function AH(Al,Ai,Aj,Ak){AL(Al,Ai,Aj,Ak);AX(Al,Ai,Aj);}function n(Ak,Av,Ar,Ap,At){var Aq,Al,As,Ai,Au=Z.restoreSpecialChars(Ak.innerHTML),Ao=Au.length,Am=0,Aj=Ao,An=false;if(Ak.scrollHeight>1.5*G){Aq=W(Ak.innerHTML,Av,K);Al=Aq-Ar+K;if(Al>At){while((Aj-Am)>1){As=(Am+Aj)>>1;Ai=Au.substring(0,As)+w;Aq=W(Ai,Av,K);Al=Aq-Ar+K;if(Al>At){Aj=As;}else{Am=As;}}Ak.innerHTML=X.encodeHtmlString(Au.substring(0,Am)+w,true);Ak[AA]("title",Au);An=true;Aq=W(Ak.innerHTML,Av,K);Al=Aq-Ar+K;}AL(Ak,0,Ap+G,(Al<At)?Al:At);}if(Ar>At){Ak[AA]("title",Au);}else{if(!An){Ak[AA]("title","");}}}function z(Ai,Ar,An,Aj,Aq,As){var Ak,Am,Ao,Ap,Al=document.createElement("div");Al[AA]("class","gm-legend-textcell");Al[AA]("type",C.LGD_TEXT);Al.style.lineHeight=d+x;if(Aq){Ap=AI(Al,Ar,As,Aq);}if(Aj&u){Ak=(AJ+AT)/2+An*AJ;Ao=y;}else{Ak=(s+AT)/2+An*s;if(Aj&Ah){if(Aj&Af){Ao=0;}else{Ao=r;}}else{if(Aj&f){Ao=P;}else{Ao=0;}}}Am=Ap||r+K;Al.innerHTML=Ar;Al.identity={objType:AG.LEGEND_TEXT};AH(Ai,Ao,Ak,Am);this.textDivs.push(Al);Ai.appendChild(Al);}function Aa(Ai,Al){var Aj,An,Am,Ak=0;if(Ai){Am=Ai.elements;for(Aj=0,An=Am.length;Aj<An;Aj++){Ak=Math.max(Ak,W(Am[Aj].label,Al,K));}Ak+=y+A*2+AV;}return Ak;}function U(Al,Ak){var Ao,Ai,An,Am=Al.items,Aj=0;if(!Am){return 0;}Ao=Am.length;An=Al.custMetrics;for(Ai=0;Ai<Ao;Ai++){if(An&&An.indexOf(Am[Ai])!==-1){Aj=Math.max(Aj,W(Am[Ai],Ak,K)+P);}else{Aj=Math.max(Aj,W(Am[Ai],Ak,K));}}return Aj;}function AP(Al,Ak){var Ai,An,Am,Aj=0;if(Al){Am=Al.elements;An=Am.length;if(Al.caseFlag===1){Aj=U(Al,Ak);}else{if(Al.caseFlag===0){for(Ai=0;Ai<An;Ai++){Aj=Math.max(Aj,W("Max: "+Am[Ai].v,Ak,K));}Aj+=s*l;Aj=Math.max(Aj,U(Al,Ak));}else{if(Al.caseFlag===2){for(Ai=0;Ai<An;Ai++){Aj=Math.max(Aj,W(Am[Ai].v,Ak,K));}Aj+=s*An+r;Aj=Math.max(Aj,U(Al,Ak));}else{if(Al.caseFlag===3){for(Ai=0;Ai<An;Ai++){Aj=Math.max(Aj,W(Am[Ai].v,Ak,K));}Aj+=s*t;}}}}Aj=Math.max(Aj,W(I,Ak,K));Aj+=A*3;}return Aj;}function c(At,Al,Ax){if(!At||!At.length||At.length<1){return 0;}var Am,Aj,Aw,Ai,Ap,As,Ao,Ar,Aq,Ak,An,Av=m+2*Ae,Au=Av;for(Am=0;Am<At.length;Am++){Ao=At[Am];if(Ao.dataType===AY.COLOR_BY){Ar=Ao.dataObj;if(Ar){Ak=2*AF+G;Aw=Z.removeExtraSpace(Ar.item);As=W(Aw,Ax,K);if((As+2*A>Al-2*Ae)&&H(Aw)){Ak+=G;}Ai=Ar.elements;Aj=Ai.length;Ak+=A;Ak+=g;Av+=Ak+AJ*Aj;Au+=Ak+(Aj>0?AJ:0);}}else{if(Ao.dataType===AY.SIZE_BY){Aq=Ao.dataObj;if(Aq){An=2*AF+G;Aw=Z.removeExtraSpace(Aq.item);As=W(Aw,Ax,K);if((As+2*A>Al-2*Ae)&&H(Aw)){An+=G;}Ap=Aq.caseFlag;if(Ap===1){Aj=0;}else{if(Ap===0){Aj=2;}else{if(Aq.caseFlag===2||Ap===3){Aj=Aq.elements.length;}}}Aj+=(Aq.items&&Aq.items.length)||0;An+=s*Aj;An+=A;An+=g;Av+=An;Au+=An;}}}}return{height:Av,minHeight:Au};}function Ab(Ai,Aj){var Al=0,Ak=0;O.forEach(Ai||[],function(Am){var An;if(Am.dataType===AY.COLOR_BY){An=Aa(Am.dataObj,Aj);if(An>Al){Al=An;}}else{if(Am.dataType===AY.SIZE_BY){An=AP(Am.dataObj,Aj);if(An>Ak){Ak=An;}}}});return Math.max(Al,Ak)+2*Ae;}function h(Aj,Ap,An,Am){var Ak=c(Aj,Ap,Am),Ai=Ak.height,Ao=An-V*2,Al={};Al.autoCollapse=Ak.minHeight>Ao;Al.minHeight=Ak.minHeight;Al.width=Ap;Al.height=Math.min(Ai,Ao);if(Ai>Ao){Al.cutBy=Ai-Ao;}return Al;}function F(Aj,Ak){var Al=Aj.decodedColor||Aj.color,Ai;if(Al.c1){Ai=Ac.buildGradient(Al.or,Al.c1,Al.c2);Ak.style[Ac.convertCssToCamelCase(Ai.n)]=Ai.v;}else{Ak.style.backgroundColor=Al;}if(Aj.image){Ak.style.backgroundImage=Aj.image;}Ak.identity=new e({objType:AG.COLOR_SQUARE,parentIdentity:this.identity,token:Aj.token,decodedColor:Aj.decodedColor,encodedColor:Aj.encodedColor,isDefaultColor:Aj.isDefaultColor});}function AU(){var Ax,Au,As,Ai,At,Az,Aj,Aq,Ao,Al,A1=document,A0=this.triBtn,Aw=this.closeBtn,An=this.cbContainer,Ak=this.sb1Container,Av=this.sb2Container,Ap=this.cbTableContainer,Am=null,Ay=this.height-m-A-2*Ae,Ar=this.width-2*A-2*Ae;A0[AA]("class","gm-legend-tri-button-collapsed");if(this.autoCollapse){A0[AA]("title",mstrmojo.desc(13682,"There is not enough space to display the legend"));}else{A0[AA]("title",mstrmojo.desc(13683,"Maximize Legend"));}Aw.style.display="none";this.splitter.style.display="none";this.domNode.style.overflow="hidden";for(Ax=0;this.dataArray&&Ax<this.dataArray.length;Ax++){Ai=this.dataArray[Ax];if(Ai.dataType===AY.COLOR_BY){Am=Ai.dataObj;break;}}An.style.display=Am?"block":"none";Ak.style.display="none";Av.style.display="none";if(Am){As=Am.elements;Au=As.length;At=this.cbTitle;At.style.display="none";An.style.top=m+x;An.style.width=Ar+x;Ap.style.top="0px";Az=this.cbTable;Az.innerHTML="";for(Ax=0;Ax<Au;Ax++){Aj=A1.createElement("tr");Aq=A1.createElement("td");Al=A1.createElement("div");Ao=A1.createElement("div");Al[AA]("class","gm-legend-colorbox-ctn-div");Al[AA]("type",C.LGD_COLORBOX_CTN);Al[AA]("title",As[Ax].label);Ao[AA]("class","gm-legend-colorbox-div");Ao[AA]("type",C.LGD_COLORBOX);F.call(this,As[Ax],Ao);Aj[AA]("class","gm-legend-tr");Aj.style.height=AJ+x;Aq[AA]("class","gm-legend-colorbox");Al.appendChild(Ao);Aq.appendChild(Al);Aj.appendChild(Aq);Az.appendChild(Aj);if(Az.offsetHeight+AJ>Ay){break;}}Az.style.top="0px";Az.style.marginLeft="0px";Ap.style.top=A+x;Ap.style.height=Az.offsetHeight+x;}An.style.height=Ay+x;}function p(Ak,Aj,Am,Ai){var Al=document.createElementNS(N,"circle");Al.setAttribute("cx",Aj);Al.setAttribute("cy",Am);Al.setAttribute("r",Ai);Al.setAttribute("class","gm-legend-sizeby-circle");Ak.appendChild(Al);}function AD(Ak,Al,Ao,Aj,An,Ap,Am){var Ai=document.createElementNS(N,"line");Ai.setAttribute("x1",Al);Ai.setAttribute("y1",Ao);Ai.setAttribute("x2",Aj);Ai.setAttribute("y2",An);Ai.style.strokeWidth=Ap;if(Am){Ai.setAttribute("class",Am);}Ak.appendChild(Ai);}function AZ(Aj,Ax){var Aw,Ak,Am,An,Al,Ai,Av,Ao,Ay,Ap,At=Math.PI,Aq=Ax.elements,Ar=Aq.length,As=Ar*s,Au=Aj.getContext("2d"),Az={LINE_COLOR:"#b0b0b0",MIN_WIDTH:1,MAX_WIDTH:10},A0=AO.getPropertyByPath(this,"widget.model.data.visName")||AO.getPropertyByPath(this,"widget.model.data.vis.vn");switch(A0){case"GraphMatrixVisualizationStyle":if(this.shapeType===AE.SQUARE||this.shapeType===AE.TICK||this.shapeType===AE.LINE||this.shapeType===AE.BAR||this.shapeType===AE.AREA||this.shapeType===AE.RECTANGLE){Ap="rectangle";}else{Ap="circle";}break;case"VIHeatMapVisualizationStyle":Ap="rectangle";break;default:Ap="circle";break;}switch(Ax.caseFlag){case 0:Au.save();if(mstrApp.getThemeClassName().indexOf("dark")>=0){Au.strokeStyle="rgba(116, 116, 117, 0.7)";Au.fillStyle="rgba(116, 116, 117, 0.7)";}else{Au.strokeStyle="rgba(188, 188, 189, 0.7)";Au.fillStyle="rgba(188, 188, 189, 0.7)";}As=s*l;Ay=Math.floor(s*0.75+0.5);Ak=Math.floor(Ay/3.5+0.5);if(Ap==="circle"){An=Ay+1;Al=s;Au.beginPath();Au.arc(An,Al,Ay,0,2*At,false);Au.fill();Au.stroke();An=2*An+2*Ak;Al=Math.floor(0.53*s+0.5);Au.beginPath();Au.arc(An,Al,Ak,0,2*At,false);Au.fill();Au.stroke();}else{An=1;Al=s-Ay;Au.beginPath();Au.fillRect(An,Al,2*Ay,2*Ay);An=2*Ay+2+Ak;Al=Math.floor(0.53*s-Ak+0.5);Au.beginPath();Au.fillRect(An,Al,2*Ak,2*Ak);}Au.translate(0.5,0.5);Au.lineWidth=1;Au.strokeStyle="#9C9C9C";An=2*Ay+3*Ak+3;Al=Math.floor(0.53*s+0.5);Au.beginPath();Au.moveTo(An,Al);Au.lineTo(As,Al);Au.stroke();An=2*Ay+2;Al=Math.floor(1.53*s-Ak+0.5);Au.beginPath();Au.moveTo(An,Al);Au.lineTo(An+Ak,Al+Ak);Au.lineTo(As,Al+Ak);Au.stroke();Au.restore();break;case 1:break;case 2:Am=parseInt(Aq[0].diameter,10);Am=Math.min(Am,As);Au.fillStyle="#ADADAC";Au.strokeStyle="#ADADAC";if(Ap==="circle"){An=As>>1;Al=An;Au.arc(An,Al,Am>>1,0,2*At,false);Au.fill();Au.stroke();}else{An=(As-Am)>>1;Al=An;Au.rect(An,Al,Am,Am);Au.fill();Au.stroke();}break;case 3:Ai=Az.MIN_WIDTH;Av=(Ar===1?0:(Az.MAX_WIDTH-Az.MIN_WIDTH)/(Ar-1));As=Aj.width;Ao=s;An=0;Al=s/2;Au.strokeStyle=Az.LINE_COLOR;for(Aw=0;Aw<Ar;Aw++){Au.lineWidth=Ai;Au.beginPath();Au.moveTo(An,Al);Au.lineTo(As-An,Al);Au.stroke();Al+=Ao;Ai+=Av;}break;default:break;}}function AW(Aj,Ar){var Ap=1,Ai,An=1.5*G,Aq=Aj.innerHTML,Ao=Z.restoreSpecialChars(Aq),Ak=Ao.split(M),As,Al;var Am=function(At){Al=Ao[At];return Al!==undefined?Al:"";};if(Aj.scrollHeight>An){if(!Ak[0]){return 0;}Ai=Ak[0]+Am(Ak[0].length);while(Ak[Ap]!==undefined){As=Ai+Ak[Ap];As+=Am(As.length);Aj.innerHTML=Z.replaceSpecialChars(As);if(Aj.scrollHeight>An){break;}Ai=As;Ap++;}Aj.innerHTML=Aq;}else{Ai=Ao;}return W(Ai,Ar,K);}function b(Ay,Aw,Ax,As){var Av,Ak,An,Am,Ar,Au,Aq=Aw.elements,At=Aq.length,Ap=[],Az=document,Ai=Az.createDocumentFragment(),Al=false,Ao=this.styles,Aj=Ax;switch(As){case 0:if(At>0){Ap.push({v:"Min: "+Aq[At-1].v});Ap.push({v:"Max: "+Aq[0].v});At=2;}break;case 1:Aq=Aw.items;O.forEach(Aq,function(A0){Ap.push({v:A0});});break;case 3:Ap=Aq;break;default:Ap=Aq;Al=true;break;}At=Ap.length;for(Av=0;Av<At;Av++){Ak=Az.createElement("tr");Ak[AA]("class","gm-legend-tr2");Ak.style.height=s+x;if(Al){An=Az.createElement("td");z.call(this,An,Ap[Av].sign,Av,Q|Ah|Af);An[AA]("class","gm-legend-sign");Ak.appendChild(An);Aj-=r;}Am=Az.createElement("td");Am[AA]("class","gm-legend-desc");if(Aw.custMetrics&&Aw.custMetrics.indexOf(Ap[Av].v)!==-1){z.call(this,Am,Ap[Av].v,Av,Q|f,Aj-P,Ao);Au=parseInt(Am.lastChild.style.width,10);Ar=Az.createElement("div");Ar.setAttribute("class",AR);Ar.setAttribute("title",AN);Am.appendChild(Ar);Ar.style.top=(s-8)/2+Av*s+x;Am.lastChild.style.marginLeft=Au+x;}else{if(Al){z.call(this,Am,Ap[Av].v,Av,Q|Ah,Aj,Ao);}else{z.call(this,Am,Ap[Av].v,Av,Q,Aj,Ao);}}Ak.appendChild(Am);Ai.appendChild(Ak);}Ay.appendChild(Ai);}function T(){var Ak="."+AR,Ai=this.domLegend.querySelectorAll(Ak),Aj;O.forEach(Ai,function(Al){Aj=Al.parentNode;if(Aj){Aj.removeChild(Al);}});}function S(){var BB,A3,BG=0,BH,Ay,A5,Az,Al,A9,BC,Ap,BF,BA,Ai=this.width-2*Ae,At=Ai-2*A,An=document,Ak=this.triBtn,A4=this.closeBtn,A2=this.cbContainer,Au=this.cbTableContainer,BI=this.sb1Container,Ao=this.sb2Container,As,Aq,Am,Ar,A7,Aw,A6=this.cutBy,A1=m,BD=0,A0=this.styles,A8,BE,Ax=(G+AT)/2,Aj,Av;Ak[AA]("class","gm-legend-tri-button");Ak[AA]("title",mstrmojo.desc(13684,"Minimize Legend"));A4.style.display="block";A4[AA]("title",mstrmojo.desc(12002,"Hide Legend"));this.updateSplitter();T.call(this);this.domNode.style.overflow="visible";A2.style.display="none";BI.style.display="none";Ao.style.display="none";for(A3=0;this.dataArray&&A3<this.dataArray.length;A3++){Aq=this.dataArray[A3];A7=null;Aw=null;if(Aq.dataType===AY.COLOR_BY){A7=Aq.dataObj;if(A7){A2.style.display="block";Az=Z.removeExtraSpace(A7.item);Al=A7.elements;BB=Al.length;A2.style.top=A1+x;A2.style.width=At+x;BF=0;if(BD===0){Ac.addClass(this.sepLine1,"toggleHide");BD++;}BH=this.cbTitle;BH.style.display="block";AI(BH,Az,A0,At);BH.innerHTML=X.encodeHtmlString(Az,true);BF+=BH.offsetHeight+2*AF;Aj=AW(BH,A0);n(BH,A0,Aj,Ax,At);AH(BH,0,Ax,(Aj<At)?Aj:At);Ay=this.cbTable;Ay.style.display="block";Ay.style.width=(At-AV)+x;Ay.style.marginLeft=AV+x;Ay.innerHTML="";Ay.appendChild(this.fillColorByTable(A7,0));A9=AJ*BB+1;Au.style.top=BF+x;Ay.style.display="table";BF+=A9+A;if(A6){BF-=A6;A9-=A6;}A2.style.height=BF+x;Au.style.height=A9+x;A1+=BF+g;}}else{if(Aq.dataType===AY.SIZE_BY){Aw=Aq.dataObj;if(Aw){BG++;if(BG===1){Am=BI;Ar=this.sb1Title;A5=this.sb1MetricNamesTable;Ay=this.sb1DataTable;As=this.sb1Canvas;}else{Am=Ao;Ar=this.sb2Title;A5=this.sb2MetricNamesTable;Ay=this.sb2DataTable;As=this.sb2Canvas;}Am.style.display="block";Az=Z.removeExtraSpace(Aw.item);Al=Aw.elements;BB=Al.length;Am.style.top=A1+x;Am.style.width=At+x;BF=0;if(BD===0){Ac.addClass(this.sepLine2,"toggleHide");BD++;}if(Aw.caseFlag===0){BC=l*s;Ap=2*s;}else{if(Aw.caseFlag===3){BC=t*s;Ap=BB*s;}else{BC=BB*s;Ap=BC;}}BH=Ar;BH.innerHTML=X.encodeHtmlString(Az,true);BE=Aw.custMetrics&&Aw.custMetrics.indexOf(Az)!==-1;if(BE){Av=At-P;}else{Av=At;}AI(BH,Az,A0,Av);if(BE){A8=An.createElement("div");A8.setAttribute("class",AR);A8.setAttribute("title",AN);Am.appendChild(A8);A8.style.top=(BH.offsetHeight-8)/2+AF+g+x;A8.style.left=BH.offsetWidth+"px";}Aj=AW(BH,A0);n(BH,A0,Aj,Ax,Av);AH(BH,0,Ax,(Aj<Av)?Aj:Av);BF+=BH.offsetHeight+2*AF;BA=At;A5.innerHTML="";if(Aw.items&&Aw.items.length>0){A5.style.display="block";b.call(this,A5,Aw,BA,1);}else{A5.style.display="none";}A5.style.top=BF+x;A5.style.left="0"+x;A5.style.width=BA+x;BF+=A5.offsetHeight;if(BC>0){BA-=BC+A;}Ay.innerHTML="";if(Aw.elements&&Aw.elements.length>0){Ay.style.display="block";b.call(this,Ay,Aw,BA,Aw.caseFlag);}else{Ay.style.display="none";}As.style.position="absolute";As.style.top=BF+x;As.style.marginLeft=A+x;Ay.style.top=BF+x;Ay.style.left=(BC+A)+x;Ay.style.width=BA+x;BF+=Ay.offsetHeight+A;Am.style.height=BF+x;Ay.style.display="table";As.width=BC;As.height=Ap;AZ.call(this,As,Aw);A1+=BF+g;}}}}}function q(){var Ai,Aj=this.textDivs,Ak=Aj.length;for(Ai=0;Ai<Ak;Ai++){a(Aj[Ai]);}}mstrmojo.gm.GMLegend=mstrmojo.declare(mstrmojo.VisLegend,[mstrmojo._FormateVisLegend,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.gm.GMLegend",cssClass:"gm-legend",dropZoneHighlightCss:"gm-legend-slot",dockedPositions:[{pos:o.LEFT_TOP},{pos:o.LEFT_MIDDLE},{pos:o.LEFT_BOTTOM},{pos:o.RIGHT_TOP},{pos:o.RIGHT_MIDDLE},{pos:o.RIGHT_BOTTOM}],dockPos:AM.LEFT,GMW:0,GMH:0,isMinimal:false,shapeType:undefined,legendMarkup:'<div class="gm-legend-tri-button"></div><div class="gm-legend-close-button"></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><div class="gm-legend-table-container"><table class="gm-legend-table"></table></div></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-container"><div class="gm-legend-separator-line" style="width:{@coreWidth}px"></div><div class="gm-legend-title" type="lgd-title" style="line-height:{@lineHeight}px; max-height:{@maxHeight}px"></div><table class="gm-legend-table"></table><table class="gm-legend-table"></table><canvas type="lgd-canvas"></canvas></div><div class="gm-legend-resizer-v" draggable="false"></div><div class="gm-legend-resizeRect"></div>',init:function AC(Aj){this.styles={};this.cutBy=null;this.dataArray=null;this.textDivs=[];var Ak=Aj.placeholder,Ai=Ak.style;if(Ak){this.cssClass=Ak.getAttribute("class");if(!this.cssClass){this.cssClass="";}if(Aj.hasOwnProperty("width")===false){Aj.width=(Ai&&Ai.width)||Ak.clientWidth;}if(Aj.hasOwnProperty("height")===false){Aj.height=(Ai&&Ai.height)||Ak.clientHeight;}if(Aj.hasOwnProperty("left")===false){Aj.left=Ak.offsetLeft;}if(Aj.hasOwnProperty("top")===false){Aj.top=Ak.offsetTop;}}this._super(Aj);},setupScrollNodes:function L(){this.scrollNode=this.cbTableContainer;},getSplitterDockPos:function(){return(this.currDockedPositionIdx<3)?AM.RIGHT:AM.LEFT;},updateAlignClass:function(){var Am=this.getDockedPosition(),An=Am&&Am.pos,Ak=(An===o.RIGHT_MIDDLE||An===o.RIGHT_TOP||An===o.RIGHT_BOTTOM||An===o.RIGHT),Ai=this.domLegend,Aj=this.domNode,Al=this.resizeRect;if(Ak){Ac.removeClass(Ai,"gm-align-left");Ac.addClass(Ai,"gm-align-right");Ac.toggleClass(Ai,"gm-legend-alignRight",true);Ac.toggleClass(Ai,"gm-legend-alignLeft",false);Ac.toggleClass(Aj,"gm-legend-alignRight",true);Ac.toggleClass(Aj,"gm-legend-alignLeft",false);Ac.toggleClass(Al,"gm-legend-alignRight",true);Ac.toggleClass(Al,"gm-legend-alignLeft",false);}else{Ac.removeClass(Ai,"gm-align-right");Ac.addClass(Ai,"gm-align-left");Ac.toggleClass(Ai,"gm-legend-alignRight",false);Ac.toggleClass(Ai,"gm-legend-alignLeft",true);Ac.toggleClass(Aj,"gm-legend-alignRight",false);Ac.toggleClass(Aj,"gm-legend-alignLeft",true);Ac.toggleClass(Al,"gm-legend-alignRight",false);Ac.toggleClass(Al,"gm-legend-alignLeft",true);}},postBuildRendering:function(){this._super();var Au=this.styles,Aw=this.domNode,Al=this.domLegend.childNodes,Ap=Al[2],An=Al[3],Av=Al[4],Az={objType:AG.LEGEND};this.addSlots({triBtn:Al[0],closeBtn:Al[1],cbContainer:Al[2],sepLine1:Ap.firstChild,cbTitle:Ap.childNodes[1],cbTableContainer:Ap.childNodes[2],cbTable:Ap.childNodes[2].firstChild,sb1Container:An,sepLine2:An.firstChild,sb1Title:An.childNodes[1],sb1MetricNamesTable:An.childNodes[2],sb1DataTable:An.childNodes[3],sb1Canvas:An.childNodes[4],sb2Container:Av,sepLine3:Av.firstChild,sb2Title:Av.childNodes[1],sb2MetricNamesTable:An.childNodes[2],sb2DataTable:Av.childNodes[3],sb2Canvas:Av.childNodes[4],splitter:Al[5],resizeRect:Al[6]});Ad.GMLegend.applyHTML5Props(Au);this.bgColor=Au.background||Au.backgroundColor||"transparent";AO.applyStyle2Legend(Au,Aw,this.domLegend);var Ao=this.getSplitterDockPos(),Ay=this.width-2*A-2*Ae,Aq=this.cbTitle,Aj=Aq.style,Ak=this.sb1Title,Am=this.sb2Title,Ax=Ak.style,Ai=Am.style,At=this.sepLine1,As=this.sepLine2,Ar=this.sepLine3;At.style.width=Ay+x;As.style.width=Ay+x;Ar.style.width=Ay+x;Aj.lineHeight=G+x;Ax.lineHeight=G+x;Ai.lineHeight=G+x;Aj.maxHeight=2*G+x;Ax.maxHeight=2*G+x;Ai.maxHeight=2*G+x;Aq.identity={objType:AG.LEGEND_TEXT,parentIdentity:Az};Ak.identity={objType:AG.LEGEND_TEXT,parentIdentity:Az};Am.identity={objType:AG.LEGEND_TEXT,parentIdentity:Az};this.dockPos=Ao;this.identity=Aw.identity=Az;this.updateAlignClass();},feedData:function(Ai,Aj){this.dataArray=Ai;this.isMinimal=Aj;this.textDivs=[];Ad.GMLegend.applyHTML5Props(this.styles);this.autoCollapseLegend();if(Aj||this.autoCollapse){AU.call(this);this.draggable=false;}else{S.call(this);this.draggable=true;}q.call(this);this.updateScrollbars();},autoCollapseLegend:function(){this.autoCollapse=this.minHeight&&(this.minHeight>(this.GMH-V*2));},updateColorBySquare:function(Ak){var Al,Am,Aj,Ai;if(Ak){Ai=this.domNode.querySelectorAll(".gm-legend-colorbox-div");Al=Ak.elements;Am=Math.min(Al.length,Ai.length);for(Aj=0;Aj<Am;Aj++){F.call(this,Al[Aj],Ai[Aj]);}}},updateContainerSize:function(Ai,Aj){this.GMW=Ai;this.GMH=Aj;this.calculateDockedPositions(Ai,Aj);},updateAfterResize:function(){Ad.GMLegend.applyHTML5Props(this.styles);var An=0,Am=this.width,Ao=this.cbContainer,Aq=this.sb1Container,Ak=this.sb2Container,Al=this.sepLine1,Aj=this.sepLine2,Ai=this.sepLine3,Ap=Am-2*A-2*Ae;O.forEach(this.dataArray||[],function(Ar){if(Ar.dataType===AY.COLOR_BY){if(Ar.dataObj){if(Ao){Ao.style.width=Ap+x;}}}else{if(Ar.dataType===AY.SIZE_BY){if(Ar.dataObj){An++;if(An===1&&Aq){Aq.style.width=Ap+x;}if(An===2&&Ak){Ak.style.width=Ap+x;}}}}});if(Al){Al.style.width=Ap+x;}if(Aj){Aj.style.width=Ap+x;}if(Ai){Ai.style.width=Ap+x;}this.domLegend.style.width=this.width+x;this.domLegend.style.height=this.height+x;},updateStyle:function(Ai){this.styles=Ai;this.bgColor=Ai.background||Ai.backgroundColor||"transparent";AO.applyStyle2Legend(Ai,this.domNode,this.domLegend);},updateTitleLineHeight:function(){var Aj=this.cbTitle,Am=Aj.style,Ak=this.sb1Title,Ai=this.sb2Title,An=Ak.style,Al=Ai.style;Ad.GMLegend.applyHTML5Props(this.styles);Am.lineHeight=G+x;An.lineHeight=G+x;Al.lineHeight=G+x;Am.maxHeight=2*G+x;An.maxHeight=2*G+x;Al.maxHeight=2*G+x;},getSplitterPosition:function(Ak){var Aj=Ak.src.startPos+Ak.tgt.pos.x-Ak.src.pos.x,Am=Ak.src.posInfo,Al=Am&&Am.min,Ai=Am&&Am.max;if(Al!==undefined){Aj=Math.max(Aj,Al);}if(Ai!==undefined){Aj=Math.min(Aj,Ai);}return Aj;},positionResizeRect:function(Ai,Aj){var Al=Ai.src.posInfo.dockPosition===AM.LEFT,Am=Aj-AQ,An=Al?Am:0,Ak=Al?this.width-Am:Am;this.resizeRect.style.left=(An-1)+x;this.resizeRect.style.width=(Ak-2)+x;},updateLegendSlot:function(Al,Ai){var Ak=this.getDockedPosition(),Aj=Ak&&Ak.pos;if(Aj!==Al){this.currDockedPositionIdx=Ai;this.dockPos=this.getSplitterDockPos();this.updateDropZonePosition();this.updateAlignClass();this.updateSplitter();this.widget.onLegendDropZoneChange(this.getDockedPosition());}},ondragstart:function(Ai){var Ak=Ai.src.e.target,Aj=Ai.src.data;if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(false);}if(Ak===this.splitter){Ai.src.startPos=Ak.offsetLeft;Ai.src.posInfo=this.getSplitterInfo(Ak);this.positionResizeRect(Ai,Ai.src.startPos);Ac.addClass(this.resizeRect,"resizing");}else{this.cbTableScrollTop=this.cbTableContainer.scrollTop;this._super(Ai);if(!Aj||!Aj.isScrollBar){this.clearSelectedTargets();Ac.toggleClass(this.domNode,"gm-legend-hover",false);Ac.toggleClass(this.domLegend,"active",false);this.cbTableContainer.scrollTop=this.cbTableScrollTop;this.domLegend.style.background=this.bgColor;this.isDragging=true;}}},ondragmove:function D(Ai){var Ak=Ai.src.e.target,Aj;if(Ak===this.splitter){Aj=this.getSplitterPosition(Ai);Ak.style.left=Aj+x;this.positionResizeRect(Ai,Aj);}else{this._super(Ai);}},ondragend:function(Ai){var Ak=Ai.src.e.target;if(Ak===this.splitter){Ac.removeClass(this.resizeRect,"resizing");this.splitterMoved(this.getSplitterPosition(Ai)-Ai.src.startPos,Ai.src.posInfo);}else{this._super(Ai);var Aj=Ai.src.data;if(!Aj||!Aj.isScrollBar){this.cbTableContainer.scrollTop=this.cbTableScrollTop;this.domLegend.style.background="transparent";this.isDragging=false;}delete this.cbTableScrollTop;}if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},onscroll:function(){var Aj,An,Am=this.scrollNode.scrollTop,Al,Ak,Ai;if(this.prevScrpllTop===Am){return ;}An=(this.dataArray&&this.dataArray.length)||0;for(Aj=0;Aj<An;Aj++){Ak=this.dataArray[Aj];if(Ak.dataType===AY.COLOR_BY){Ai=Ak.dataObj;break;}}if(Ai){Al=this.cbTable;Al.innerHTML="";Al.appendChild(this.fillColorByTable(Ai,Math.floor(Am/AJ)));this.prevScrpllTop=Am;this.scrollNode.scrollTop=Am;this._super();}},fillColorByTable:function(Ay,Ao){var Az,Aw,Ak,An,Am,Ap,Aq,Ar=this.styles,Ai,Au=this.cutBy,As=this.width-2*Ae-2*A,At,Al,Aj,A0,Av;At=Ay.elements;Aw=At.length;Ai=document.createDocumentFragment();Al=As-y-AV;Aj=0;A0=AJ*Aw;Av=Ao*AJ;function Ax(A1){Ak=document.createElement("tr");An=document.createElement("td");Ak.style.height=A1+x;An[AA]("class","gm-legend-colorbox");Ak.appendChild(An);Ai.appendChild(Ak);}if(Ao>0){Ax(Av);}for(Az=Ao;Az<Aw;Az++){Ak=document.createElement("tr");An=document.createElement("td");Am=document.createElement("td");Ap=document.createElement("div");Aq=document.createElement("div");Ap[AA]("class","gm-legend-colorbox-ctn-div");Ap[AA]("type",C.LGD_COLORBOX_CTN);Aq[AA]("class","gm-legend-colorbox-div");Aq[AA]("type",C.LGD_COLORBOX);F.call(this,At[Az],Aq);Ak[AA]("class","gm-legend-tr");Ak.style.height=AJ+x;An[AA]("class","gm-legend-colorbox");Am[AA]("class","gm-legend-desc");z.call(this,Am,At[Az].label,Az,u,Al,Ar);Ap.appendChild(Aq);An.appendChild(Ap);Ak.appendChild(An);Ak.appendChild(Am);Ai.appendChild(Ak);Aj+=AJ;if(Au&&(Au+Aj-AJ)>A0){Ax(A0-Aj-Av);break;}}return Ai;},calculateDockedPositions:function(Aj,Am){var Al,Ao=this.getWidth(),Ai=this.getHeight(),Ak=this.dockedPositions,An=function(Ap){switch(Ap.pos){case k.LEFT_TOP:Ap.x=0;Ap.y=V;break;case k.LEFT_MIDDLE:Ap.x=0;Ap.y=Math.max(V,(Am-Ai)>>1);break;case k.LEFT_BOTTOM:Ap.x=0;Ap.y=Math.max(0,Am-Ai-V);break;case k.RIGHT_TOP:Ap.x=Aj-Ao;Ap.y=V;break;case k.RIGHT_MIDDLE:Ap.x=Aj-Ao;Ap.y=Math.max(V,(Am-Ai)>>1);break;case k.RIGHT_BOTTOM:Ap.x=Aj-Ao;Ap.y=Math.max(0,Am-Ai-V);break;}};for(Al=0;Al<Ak.length;Al++){An(Ak[Al]);}this.updateDropZonePosition();},updateDropZonePosition:function(){var Ai=this.getDockedPosition(),Aj=this.dropZoneNode.style;Aj.left=Ai.x+x;Aj.top=Ai.y+x;},updateDropZoneNode:function(Ai){this._super(Ai);this.dockPos=this.getSplitterDockPos();this.updateSplitter();},onmouseover:function(Ai){var Ak=this.domLegend,Ao=Ai.getTarget(),Al=Ao.getAttribute("type"),An=this.widget,Aj;if(this.isDragging){return ;}var Am=R.copy(this.styles);Am.opacity+=0.4;AO.applyStyles2DomNode(this.domNode,Am);if(AB.contains(Ak,Ao,true)){Ac.addClass(Ak,"active");}if(Al===C.LGD_COLORBOX){Ao=Ao.parentNode;Al=Ao.getAttribute("type");}if(Al===C.LGD_COLORBOX_CTN){Aj=Ao.firstChild.identity;if(!Aj||!Aj.comb){return ;}Ac.toggleClass(Ao,"hover-colorsquare",true);return ;}if(An.formattingMode){switch(Al){case C.LGD_TITLE:case C.LGD_TEXT:Ac.toggleClass(Ak,"hover-txt",true);break;default:Ac.toggleClass(this.domNode,"gm-legend-hover",true);break;}}},onmouseout:function(Aj){var Al=this.domLegend,Ai=Aj.e.toElement||Aj.e.relatedTarget,Ao=Aj.getTarget(),Am=Ao.getAttribute("type"),An=this.widget,Ak;AO.applyStyles2DomNode(this.domNode,this.styles);if(!AB.contains(Al,Ai,true)){Ac.removeClass(Al,"active");}if(Am===C.LGD_COLORBOX){Ao=Ao.parentNode;Am=Ao.getAttribute("type");}if(Am===C.LGD_COLORBOX_CTN){Ak=Ao.firstChild.identity;if(!Ak||!Ak.comb){return ;}Ac.toggleClass(Ao,"hover-colorsquare",false);return ;}if(An.formattingMode||An.isOnFormattingMode){switch(Am){case C.LGD_COLORBOX_CTN:case C.LGD_COLORBOX:break;case C.LGD_TITLE:case C.LGD_TEXT:Ac.toggleClass(Al,"hover-txt",false);break;default:Ac.toggleClass(this.domNode,"gm-legend-hover",false);break;}}},onclick:function(Ai){var Al=Ai.getTarget(),Aj=Al.getAttribute("type"),Ak=this.widget;if(Al===this.triBtn){if(!this.autoCollapse){this.raiseEvent({name:"gm-legend-clicked",action:(this.isMinimal?"restore":"minimize")});}}else{if(Al===this.closeBtn){this.raiseEvent({name:"gm-legend-clicked",action:"close"});}else{if(Aj===C.LGD_COLORBOX){Al=Al.parentNode;Aj=Al.getAttribute("type");}if(Ak.formattingMode||Ak.isOnFormattingMode){if(Aj===C.LGD_COLORBOX_CTN){this.selectColorBox(Al,true);}else{if(Aj===C.LGD_TEXT||Aj===C.LGD_TITLE){this.selectText();}else{this.selectLegendBody();}}}else{this.clearSelectedColorBox();}}}AB.stopPropogation(null,Ai.e);},attachClearEvent:function(){if(this.clearSelectTargetfn){return ;}var Aj=this,Ai=this.domLegend;this.clearSelectTargetfn=function(An){var Am=An.target,Ak=Aj.widget.toolEditor,Al;if(!AB.contains(Ai,Am,true,Ai)){if(Ak){Al=Ak.domNode;if(!AB.contains(Al,Am,true,Al)){Aj.clearSelectedTargets();}}else{Aj.clearSelectedTargets();}}};AB.attachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);},clearSelectedColorBox:function(){var Ai=this.selectedColorBox;if(Ai){Ac.toggleClass(Ai,"select",false);Ac.toggleClass(Ai,"selectfmt",false);this.selectedColorBox=undefined;}},clearSelectedText:function(){Ac.removeClass(this.domNode,"select-txt");},clearSelectedLegendBody:function(){Ac.removeClass(this.domNode,"gm-legend-select");},clearSelectedTargets:function(){this.clearSelectedColorBox();this.clearSelectedText();this.clearSelectedLegendBody();if(this.clearSelectTargetfn){AB.detachEvent(document.body,"mousedown",this.clearSelectTargetfn,true);delete this.clearSelectTargetfn;}},selectColorBox:function(Ak,Aj){var Ai=Ak.firstChild.identity;if(!Ai||!Ai.comb){return ;}this.clearSelectedText();this.clearSelectedLegendBody();if(this.selectedColorBox!==Ak){this.clearSelectedColorBox();this.selectedColorBox=Ak;if(Aj){Ac.toggleClass(Ak,"selectfmt",true);}else{Ac.toggleClass(Ak,"select",true);}this.attachClearEvent();}},selectText:function(){this.clearSelectedColorBox();this.clearSelectedLegendBody();Ac.addClass(this.domNode,"select-txt");this.attachClearEvent();},selectLegendBody:function(){this.clearSelectedColorBox();this.clearSelectedText();Ac.addClass(this.domNode,"gm-legend-select");this.attachClearEvent();},adjustColorPickerPos:function(Ai){var Al=AB.position(Ai),Aj=0,Ak={};if(this.currDockedPositionIdx<3){Ak.x=Al.x+Al.w+Aj;Ak.alignLeft=true;}else{Ak.x=Al.x-Aj;Ak.alignLeft=false;}Ak.y=Al.y+Al.h+Aj;return Ak;},getSplitterInfo:function(An){if(!An){return{};}var Aj=this.dockPos,Am={},Al=this.width,Ai=AK,Ak=Math.floor(this.GMW/3);Am.dockPosition=Aj;if(Aj===AM.LEFT){Am.min=Math.min(Al-Ak,0);Am.max=Math.max(Al-Ai,0);}else{if(Aj===AM.RIGHT){Am.min=Ai;Am.max=Ak;}}Am.min+=AQ;Am.max+=AQ;return Am;},splitterMoved:function(Ai,Aj){if(Ai===0){return ;}if(Aj.dockPosition===AM.LEFT){Ai=-Ai;}this.raiseEvent({name:"gm-legend-resized",position:Ai});this.updateSplitter();if(this.widget&&this.widget.setInteractive){this.widget.setInteractive(true);}},updateSplitter:function(){AS(this.splitter,this.dockPos,this.width,this.height);this.resizeRect.style.height=this.height-2+x;}});Ad.GMLegend.applyHTML5Props=function(Ak){var Al=parseInt(Ak.fontSize,10)||8,Aj;if(Ak.fontSize.indexOf("px")>=0){Al=Math.floor(Al*Y+0.5);}Aj=Math.floor(Al/Y*E+0.5);G=Math.max(Al,8)+9;AT=Math.floor(Al/Y+0.5);d=Math.max(Aj,15);AJ=Math.max(Aj,20)+2;s=Math.max(Aj,14)+2;Ae=parseInt(Ak.borderWidth,10)||1;var Ai=parseInt(Ak.tbHeight,10);m=isNaN(Ai)?J:Ai;};Ad.GMLegend.getLegendSize4MinMode=function(Aj,Ak){var Am,Al,Ai=m+2*Ae;if(Aj){Al=Aj.elements;Am=Al.length;Ai+=AJ*Am;Ai+=2*A;}Ai=Math.min(Ai,Ak-V*2);return{width:y+5+7+2*Ae,height:Ai};};Ad.GMLegend.getLegendSize=function(Aw,Al,Ai,Ao,Ay,Ap){var Aq,Aj,Ax,An,Am=Ao-V*2,Au=0,Ak=0,At={},As,Ar,Av;if(!Aw||!Aw.length||Aw.length<1){return{};}if(Al!==undefined){if(!Ap){Ap=Math.floor(Ab(Aw,Ay)*Al);}An=Math.min(Ap,Math.floor(Ai/3));An=Math.max(An,50);return h(Aw,An,Ao,Ay);}An=Math.min(Math.floor(0.2*Ai),300);for(Aq=0;Aq<Aw.length;Aq++){Ar=Aw[Aq];if(Ar.dataType===AY.COLOR_BY){As=Aa(Ar.dataObj,Ay);if(As>Au){Au=As;}}else{if(Ar.dataType===AY.SIZE_BY){As=AP(Ar.dataObj,Ay);if(As>Ak){Ak=As;}}}}Aj=Math.max(Au,Ak)+2*Ae;At.width=Math.min(Aj,An);At.scale=At.width/Aj;Av=c(Aw,At.width,Ay);Ax=Av.height;At.autoCollapse=Av.minHeight>Am;At.minHeight=Av.minHeight;At.height=Math.min(Ax,Am);if(Ax>Am){At.cutBy=Ax-Am;}return At;};}());(function(){mstrmojo.requiresCls("mstrmojo.gm.GMLegend","mstrmojo.dom","mstrmojo.css","mstrmojo.gm.GMEnums");var J=mstrmojo.emptyFn,E=mstrmojo.dom,H=mstrmojo.css,I=mstrmojo.gm,C=mstrmojo.gmaps,G=mstrmojo.gm.EnumLegendSlot,B=I.EnumDockPosition,D=5;function A(L,K){return{x:L.x-K.x,y:L.y-K.y};}function F(){var L=this.widget.getWidth(),N=this.widget.getHeight(),M=this.getWidth(),K=this.getHeight(),O={};O.x=L-M;O.y=Math.max(D,(N-K)>>1);return O;}mstrmojo.gmaps.MapLegend=mstrmojo.declare(mstrmojo.gm.GMLegend,null,{scriptClass:"mstrmojo.gmaps.MapLegend",cssClass:"gm-legend vis-map-legend",draggableNodeName:"domNode",calculateDockedPositions:J,getSplitterDockPos:function(){return this.curSplitterDockPos||B.LEFT;},getSplitterInfo:function(Q){if(!Q){return{};}var O=this.getSplitterDockPos(),R=A(E.position(this.domNode),this.boundaryPosition),N=this.width,K=this.GMW,L=50,M=Math.floor(K/3),P={};P.dockPosition=O;if(O===B.LEFT){P.min=Math.min(0,Math.max(-R.x,N-M));P.max=Math.max(0,N-L);}else{if(O===B.RIGHT){P.min=L;P.max=Math.min(M,K-R.x);}}return P;},splitterMoved:function(K,L){if(K!=0&&L.dockPosition===B.LEFT){var M=A(E.position(this.domNode),this.boundaryPosition);this.dropZoneNode.style.left=(M.x+K)+"px";}this._super&&this._super(K,L);},adjustColorPickerPos:J,updateDropZoneNode:function(K){return true;},onmouseover:function(K){this._super&&this._super(K);var N=A(E.getMousePosition(K.e),E.position(this.domNode)),L=this.curSplitterDockPos,M=N.x>(this.getWidth()>>1);if(M&&(L!==B.RIGHT)){this.curSplitterDockPos=B.RIGHT;this.updateSplitter();}else{if(!M&&(N.x<=L!==B.LEFT)){this.curSplitterDockPos=B.LEFT;this.updateSplitter();}}},updateSplitter:function(){this.dockPos=this.getSplitterDockPos();this._super();},postBuildRendering:function(){this._super();var K=this.dropZoneNode.style,L=F.call(this);K.left=L.x+"px";K.top=L.y+"px";this.parentNode=this.domNode.parentNode;this.boundaryNode=this.widget.getLegendBoundaryNode();this.boundaryPosition=E.position(this.boundaryNode,true);},getDockedPosition:function(){var L=A(E.position(this.domNode),this.boundaryPosition),K=this.widget.getWidth();if(L.x<=(K>>1)){L.pos=G.RIGHT;}else{L.pos=G.LEFT;}return L;},ondrop:function(L){var N=this,M=N.domNode,Q=N.boundaryPosition,P=function(S){if(S.x<Q.x){S.x=Q.x;}else{S.x=Math.min(S.x,Q.x+Q.w-N.getWidth());}if(S.y<Q.y){S.y=Q.y;}else{S.y=Math.min(S.y,Q.y+Q.h-N.getHeight());}return S;},R=A(P(L.tgt.pos),this.boundaryPosition),O=M.style;H.removeClass(M,this.avatarCssClass);O.left=R.x+"px";O.top=R.y+"px";this.parentNode.appendChild(M);if(this.widget.onLegendDropped){var K=this.getDockedPosition();this.widget.onLegendDropped(K&&K.pos);}L.dropSuccessful=true;}});C.MapLegend.applyHTML5Props=I.GMLegend.applyHTML5Props;C.MapLegend.getLegendSize4MinMode=I.GMLegend.getLegendSize4MinMode;C.MapLegend.getLegendSize=I.GMLegend.getLegendSize;}());(function(){var Y=1;var AL=2;var Aq=4;var AF=8;var AT=10;var Q=90,Aw=-90,AS=180,x=-180;mstrmojo.requiresCls("mstrmojo.num","mstrmojo.hash","mstrmojo.array","mstrmojo.VisUtility","mstrmojo.VisEnum","mstrmojo.gm.GMLegend","mstrmojo.gm.EnumLegendSlot","mstrmojo.gm.GMUtility","mstrmojo.gmaps.MapManipulation","mstrmojo._VizSelectionHelper","mstrmojo.chart.enums.EnumFontStyle","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights","mstrmojo.gmaps._SupportMapBrushesAndHighlights","mstrmojo.vi.viz.MapHelper","mstrmojo.elementHelper");var Al=mstrmojo.array,Ae=mstrmojo.hash,Aa=mstrmojo.num,AG=mstrmojo.VisUtility,Ax=mstrmojo.gm,R=Ax.GMLegend,Ad=Ax.GMUtility,c=mstrmojo.VisEnum,F=mstrmojo.chart.enums.EnumFontStyle,An=c.GMLegendDataType,At=c.GMLegendFormatingPropertyTag,Ah=c.LegendPropertyTag,P=c.MAPS_PROPERTIES,AD=Ax.EnumLegendSlot,s=mstrmojo.vi.ui.rw.SelectionType,o=mstrmojo.elementHelper;function Ar(A2,A1){A2.fontWeight=(A1&F.FS_BOLD?"bold":"normal");A2.fontStyle=(A1&F.FS_ITALIC?"italic":"normal");if((A1&F.FS_STRIKETHROUGH)&&(A1&F.FS_UNDERLINE)){A2.textDecoration="line-through underline";}else{if(A1&F.FS_STRIKETHROUGH){A2.textDecoration="line-through";}else{if(A1&F.FS_UNDERLINE){A2.textDecoration="underline";}}}}var Ak={lgdBgFillClr:[15461355,1710618],lgdBgFillStyle:[0,0],lgdBgFillEff:[1,1],lgdBgFillTrans:[100,80],lgdFntSz:["11px","11px"],lgdFntFml:["Verdana","Verdana"],lgdFntStyle:[0,0],lgdFntClr:[6710886,16777215],lgdBdrShw:[false,false],lgdBdrClr:[11579568,5855577],lgdBdrThk:["1px","1px"],lgdBdrLnStyle:[0,0],lm:[0,0],LegendPosition:[2,2],lwr:[1,1]};function AZ(A1){var A2={};Ae.keyarray(Ak).forEach(function(A3){A2[A3]=Ak[A3][A1];});return A2;}function AV(A3){var A5=this.data,A4=A5.nf||[],A2=A4.length,A1;if(A3>=0&&A3<A2){A1=AG.getNumberFormat(A5,A3);return A1.replace(/\'/g,'"');}return"";}function m(){var BB=this.dropZones&&this.dropZones.colorBy,A6=this.data,A9=A6&&A6.gsi,BA=A9&&A9.mx,BC=A9&&A9.thresholds;if(BB&&BC){var A1,A2;Al.forEach(BA,function(BF,BE){if(BF.did===BB){A1=BF;A2=BE;}});if(A1){var A3=BC[BB],A5=A3&&A3[0],A4=function(){return A5.rtp===4;};if(A5&&(A4()||(A5.fmt&&A5.fmt.bc))){var A8=AG.getRankMode(A3),A7=AG.getColorByFormatStr(AV.call(this,A2),A8),BD=AG.getColorByItems(A3,A8,A1.max,A1.min,A1.cnt,A7,this.getLegendProperty(At.LEGEND_BG_COLOR));if(A4()){Al.forEach(BD,function(BF,BE){BF.image="url("+A3[BE].rtxt+")";});}return{item:AG.getColorByTitle(A1.n,A8),elements:BD};}}}}function Av(){var A5=this.dropZones&&this.dropZones.sizeBy,A8=this.data,BC=A8&&A8.gsi,BE=BC&&BC.mx,BF=BC&&BC.thresholds;if(A5&&BF){var A9,A2;Al.forEach(BE,function(BH,BG){if(BH.did===A5){A9=BH;A2=BG;}});if(A9){var BA=AV.call(this,A2),A7=[],A3=A9.min,A4=A9.max,BD=(A4-A3)/4;for(var A6=0;A6<5;++A6){A7.push(Aa.formatByMask(BA,A4-A6*BD));}var BB={item:A9.n},A1;if(A7.length>1){A1=BB.elements=[];Al.forEach(A7,function(BG){A1.push({sign:"<",v:BG});});if(A1.length===5){A1[0].sign="=";A1[4].sign="=";}BB.caseFlag=0;}else{if(A7.length===1){BB.elements=[{diameter:12,shape:"circle",sign:"=",v:A7[0]}];BB.caseFlag=2;}}return BB;}}}function W(A3,A4,A7,BA,A9,A5){var A8=A3,A6=A8.primaryModel,A2=A6.getRowHeaders(A9).getHeader(BA).getElementId(),A1={x:0,y:0,h:60,w:0};if(mstrApp.docModel){A8.infoWindowRenderedSub=mstrApp.docModel.attachEventListener("infoWindowRendered",A8.id,function(BB){A5&&A5(BB);if(A8.infoWindowRenderedSub&&mstrApp.docModel){mstrApp.docModel.detachEventListener(A8.infoWindowRenderedSub);A8.infoWindowRenderedSub=null;}});mstrApp.docModel.slice({type:mstrmojo.EnumRWUnitType.GRID,sPos:A1,ck:A7.ck,ctlKey:A7.ckey,tks:A7.tks,eid:A2});Ae.forEach(A4,function(BC,BB){mstrApp.docModel.showInfoWin(BC);});}}function p(A7){var A5=null;if(A7&&A7.tks){var A3=mstrApp.docModel,A2=A7.tks.split("\u001E");if(!A3){return A5;}for(var A4=0,A1=A2.length;A4<A1;++A4){var A6=A3.getTargetDefn(A2[A4]);if(A6[A2[A4]]&&A6[A2[A4]].ifw){if(!A5){A5=[];}A5.push(A2[A4]);}}}return A5;}function q(BF){var A5=this.primaryModel,A8=BF.unitId,A9=!!BF.isAttr,BC=BF.excludes||[],A6=A5.getRowTitles(),BA,A1,A2,A4,A7,A3,BE,BB=0,BD=[];for(A4=0,A7=A6.size();A4<A7;A4++){BA=A6.getTitle(A4);A1=BA.getForms();if(A9){if(BA.getUnitId()!==A8){BB+=A1.length;}else{for(A3=0,BE=A1.length;A3<BE;A3++,BB++){A2=A1[A3];if(BC&&BC.length>0){if(Al.indexOf(BC,A2.id)===-1){BD.push(BB);}}else{BD.push(BB);}}}}else{for(A3=0,BE=A1.length;A3<BE;A3++,BB++){A2=A1[A3];if(A2.id===A8){BD.push(BB);}}}}return BD;}mstrmojo.gmaps.MapDataViewer=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._VizSelectionHelper,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw.selectors._BrushesAndHighlights,mstrmojo.gmaps._SupportMapBrushesAndHighlights],{scriptClass:"mstrmojo.gmaps.MapDataViewer",beanPath:null,command:null,currentSelections:null,data:null,DEFAULT_COLOR:"#FE766A",defaultInfoWindowHTML:"",gridParams:null,highlightedGraphics:null,idMarkerMap:null,infoWindowHTML:"",isPrimary:false,k:null,layerIndex:0,maxRadius:50,maxValue:-Infinity,minMaxMap:null,minRadius:4,msgID:null,parent:null,selectedMetricIndex:0,bubbleSizeMetricIndex:-1,angleMetricIndex:-1,selectedRowIndices:null,widgetProps:null,model:null,visible:true,validBubble:false,primaryModel:null,bubbleMode:false,attributeFormIndices:null,applyThreshold:true,dropZones:null,selectionBackUp:null,enumDefault:-1,enumNumber:2,enumText:3,enumImage:4,enumUrl:5,enumQuickSymbol:10,init:function AW(A1){this._super(A1);this.command=this.addDisposable(new mstrmojo.gmaps.MapManipulation({viewerLayer:this,_key:this.k}));if(mstrApp&&mstrApp.isVI){this.initLegendProperties();}},handleMetricSelectionChange:function AE(){},performDrill:function A(A3){var A2=this.getSelectedRowIndices(A3);if(A2===undefined||!A2 instanceof Array||A2.length===0){A2=this.getTempSelectedRowIndices(A3);if(A2.length===0){return ;}}var A1=this.data.ghs.rhs.items[A2[0]].items[A3].at;if(A1===undefined||isNaN(A1)){return ;}if((A1&Aq)>0){this.command.execHL(null,null,A3);}},getGeoObjectExt:mstrmojo.emptyFn(),filterElements:function Ag(A4,A3,BD){var A8=this.primaryModel,A1=A8.getTotalRows(),A6,A9,BC=new RegExp(A4,"i"),BE,A7,BB=[],A5=false,A2,BA;BE=q.call(this,A3);if(BE&&BE.length>0){for(A6=0,A9=A1;A6<A9;A6++){Al.forEach(BE,function(BF){A7=A8.getRowHeaders(A6).getHeader(BF);A2=A7.getName();BA={n:A2,v:A6,id:A7.getElementId()};if(BC.test(A2)){if(BD&&BD(BA)){A5=true;BB.push(BA);return false;}else{BB.push(BA);}return false;}});if(A5){break;}}}return BB;},getCurrentSelections:function S(A1){if(!this.currentSelections){this.currentSelections={};}if(!this.currentSelections.hasOwnProperty(A1)){this.currentSelections[A1]=[];}return this.currentSelections[A1];},getDocModel:function L(){return this.model&&this.model.docModel;},getDrillStatus:function V(){var A1=false;if(this.enablePolygon){A1|=this.getDrillStatusByColumnIndex(this.geoPosition);}if(this.enableMarker){A1|=this.getDrillStatusByColumnIndex(this.latIndex);}return A1;},getDrillStatusByColumnIndex:function M(A2){var A3=this.getSelectedRowIndices(A2);if(A3===undefined||!A3 instanceof Array||A3.length===0){return false;}var A1=this.data.ghs.rhs.items[A3[0]].items[A2].at;if(A1===undefined||isNaN(A1)){return false;}if((A1&Aq)>0){return true;}if(this.data.gts.row[A2].dp){return true;}return false;},getGeoColumnIndex:function X(){return -1;},getGeoColumnAttribute:function d(){var A2=this.getGeoColumnIndex(),A1=this.primaryModel,A3;A3=A1.getRowTitles().getTitle(A2);if(!!A3){return A3.getUnitId();}return null;},getHighlightedGraphics:function Az(A1){if(!this.highlightedGraphics){this.highlightedGraphics={};}if(!this.highlightedGraphics.hasOwnProperty(A1)){this.highlightedGraphics[A1]=[];}return this.highlightedGraphics[A1];},getInfoWindowHTML:function E(){return this.infoWindowHTML;},getLinkDetails:function U(){var A1=this.getGeoColumnIndex();return this.data.gts.row[A1].lm[0];},getMetricSelectorIndex:function As(){return this.selectedMetricIndex;},getPrimaryGridViewer:function AC(){return this.parent.getPrimaryGridViewer();},getLayerGridName:function g(){return this.data&&this.data.n;},getRowAxisAttributeIndex:function Ap(A4){var A5=this.data.gts.row;var A3;if(typeof (A4)=="undefined"||A4>=A5.length){return -1;}var A1=-1;var A2={};for(A3=0;A3<=A4;A3++){if(typeof (A2[A5[A3].id])=="undefined"){A2[A5[A3].id]=1;A1++;}}return A1;},getSelectedRowIndices:function a(A1){if(!this.selectedRowIndices){this.selectedRowIndices={};}if(!this.selectedRowIndices.hasOwnProperty(A1)){this.selectedRowIndices[A1]=[];}return this.selectedRowIndices[A1];},getWidgetProps:function Af(){return this.widgetProps;},initMapProperty:function r(){var A1;for(A1 in this.columnIndices){if(this.columnIndices.hasOwnProperty(A1)){this.columnIndices[A1]=-1;}}this.geoPosition=-1;},initMetricSelectorIndex:function Ao(A5){if(!!mstrApp&&!!mstrApp.isVI){this.selectedMetricIndex=-1;}if(this.data.eg||!A5){return ;}var A7=this.justMetricId(A5),A6=this.data.gts.col,A4,A3,A1=A6.length,A2,A8;for(A4=0;A4<A1;A4++){A2=A6[A4];if(A2.otp===-1){A8=A2.es;jl=A8.length;for(A3=0;A3<jl;A3++){if(A7===this.justMetricId(A8[A3].id)){this.selectedMetricIndex=A3;break;}}}}},initBubbleSizeMetricIndex:function Am(A6){if(this.data.eg||!A6){return ;}var A2=this.justMetricId(A6),A7=this.data.gts.col,A5,A4,A1=A7.length,A3,A8;for(A5=0;A5<A1;A5++){A3=A7[A5];if(A3.otp===-1){A8=A3.es;jl=A8.length;for(A4=0;A4<jl;A4++){if(A2===this.justMetricId(A8[A4].id)){this.bubbleSizeMetricIndex=A4;break;}}}}},initAngleMetricIndex:function AR(A6){if(this.data.eg||!A6){return ;}var A1=this.justMetricId(A6),A7=this.data.gts.col,A5,A4,A2=A7.length,A3,A8;for(A5=0;A5<A2;A5++){A3=A7[A5];if(A3.otp===-1){A8=A3.es;jl=A8.length;for(A4=0;A4<jl;A4++){if(A1===this.justMetricId(A8[A4].id)){this.angleMetricIndex=A4;break;}}}}},initMapDisplayMetrics:function B(){this.initMetricSelectorIndex(this.dropZones.colorBy);this.initBubbleSizeMetricIndex(this.dropZones.sizeBy);this.initAngleMetricIndex(this.dropZones.angle);if(!this.dropZones.colorBy&&!this.dropZones.sizeBy){this.bubbleSizeMetricIndex=this.selectedMetricIndex;}},isAffinityLinesEnabled:function AY(){return false;},isPrimaryGrid:function t(){return this.isPrimary;},isValidLatLng:function Ai(A2,A1){if(isNaN(A2)||isNaN(A1)){return false;}if(parseInt(A2)<Aw||parseInt(A2)>Q||parseInt(A1)<x||parseInt(A1)>AS){return false;}return true;},isViewerDrillable:function z(){if(this.data.eg){return false;}if(this.data.eg||this.primaryModel.getTotalRows()==0){return false;}var A2=this.getGeoColumnIndex(),A3=this.data.ghs.rhs.items[0].items[A2],A1;if(!!A3){A1=A3.at;if(A1===undefined||isNaN(A1)){return false;}if((A1&Aq)>0){return true;}}return false;},isViewerSliceable:function AQ(){var A2=this.getGeoColumnIndex(),A3=this.data.ghs.rhs.items[0].items[A2],A1;if(!!A3){A1=A3.at;if(A1===undefined||isNaN(A1)){return false;}if((A1&AL)>0){return true;}}return false;},justMetricId:function AH(A2){var A1;if(A2.indexOf("CD:")===0){A1=A2.match(/(CD:=?)([0-9a-zA-Z]*)/)[2];}else{if(A2.indexOf("i")===0){A1=A2.match(/(i=?)([0-9a-zA-Z]*)(?=;)/)[2];}else{A1=A2;}}return A1;},populateBubbleVariables:function AK(){if(!this.bubbleMode){return ;}var A1=this.primaryModel.getTotalCols();if(this.bubbleSizeMetricIndex>=0&&this.bubbleSizeMetricIndex<A1){this.populateMinMax(this.bubbleSizeMetricIndex);var A2=this.minMaxMap[this.bubbleSizeMetricIndex];this.maxValue=A2.max;this.validBubble=(this.maxValue!=Infinity);}},resetData:function AA(A1){this.data=A1;this.primaryModel=this.addDisposable(new mstrmojo.models.template.DataInterface(this.data));},setInfoWindowHTML:function e(A1){this.infoWindowHTML=A1;this.widgetProps.iwd=escape(this.replaceInfoWindowHTMLMacros());},parseInfoWindowHTML:function f(){var A8=this.infoWindowHTML,BG="",A9=0,BC=A8.indexOf("${",A9),A5=A8.indexOf("}",BC+1),A2,BA,BD={},BF=this.data.gts.row,A7=this.data.gts.col,A6,BE,A1,BB,A4,A3;for(A6=0;A6<BF.length;A6++){BE=BF[A6];BD[BE.id+"|"+BE.fid]=BE.n;BD[BE.fid]=BE.n;}for(A6=0;A6<A7.length;A6++){A1=A7[A6];if(A1.otp===-1){BB=A1.es;for(A3=0;A3<BB.length;A3++){A4=BB[A3];BD[A4.id]=A4.n;}break;}}while(BC>=0&&A5>BC){A2=A8.substring(BC+2,A5);if(BD.hasOwnProperty(A2)){BG+=A8.substring(A9,BC+2)+BD[A2];}else{BG+=A8.substring(A9,A5);}A9=A5;BC=A8.indexOf("${",A9);A5=A8.indexOf("}",BC+1);}BG+=A8.substring(A9);this.infoWindowHTML=BG;},replaceInfoWindowHTMLMacros:function Ac(){var BA=this.infoWindowHTML,BH="",BB=0,BE=BA.indexOf("${",BB),A6=BA.indexOf("}",BE+1),A2,BC,A5={},BG=this.data.gts.row,A9=this.data.gts.col,BF,A1,A7,BD,A4,A3;for(A7=0;A7<BG.length;A7++){BF=BG[A7];A5[this.parent.replaceSpace(BF.n)]=BF.id+"|"+BF.fid;}for(A7=0;A7<A9.length;A7++){A1=A9[A7];if(A1.otp===-1){BD=A1.es;for(A3=0;A3<BD.length;A3++){A4=BD[A3];A5[this.parent.replaceSpace(A4.n)]=A4.id;}break;}}while(BE>=0&&A6>BE){A2=BA.substring(BE+2,A6);var A8=A2.indexOf(":");if(A8>=0){A2=A2.substring(0,A8)+" "+A2.substring(A8+1);}A2=this.parent.replaceSpace(A2);if(A5.hasOwnProperty(A2)){BH+=BA.substring(BB,BE+2)+A5[A2];}else{BH+=BA.substring(BB,A6);}BB=A6;BE=BA.indexOf("${",BB);A6=BA.indexOf("}",BE+1);}BH+=BA.substring(BB);return BH;},selectedMetricIndexChange:function N(A1,A2){this.selectedMetricIndex=A1;if(this.bubbleMode){this.bubbleSizeMetricIndex=A1;}this.handleMetricSelectionChange();},getThresholdString:function Aj(BA,A8,BF,A9,BJ){var BB=BF;if(!this.applyThreshold){return BB;}var A4=BJ?BJ:this.primaryModel,A2=A4.getMetricValue(BA,A8);if(!A2||!A2.value){return BB;}var BI=A2.value,A1=this.data.gsi&&this.data.gsi.thresholds,A6,A5,BC=A4.getColTitles(),BD=BC.size(),A7,BE,A3,BH,BG;if(this.data.th&&this.data.fc){if(A9){BB=A2.getFillColor(BF);}else{BB=A2.getThresholdValue(BF);}}else{if(!!A1){if(!!BI&&BI.hasOwnProperty("ti")){for(BH=0;BH<BD;BH++){A7=BC.getTitle(BH);if(A7.getUnitDssType()===-1){var BK=A7.getHeaderValues();BE=BK[A8];if(!!BE){A3=this.justMetricId(BE.id);}break;}}A6=A1[A3];if(!!A6&&!!A6[BI.ti]){A5=A6[BI.ti];if(A9){BB=(A5.fmt&&A5.fmt.bc)?A5.fmt.bc:BF;}else{if(A2.getThresholdType()===this.enumImage||A2.getThresholdType()===this.enumUrl){BB=A5.rtxt||BF;}else{if(A2.getThresholdType()===this.enumText||A2.getThresholdType()===this.enumQuickSymbol){BB=(A5.fmt&&A5.fmt.fc)?A5.fmt.fc:BF;}else{BB=(A5.fmt&&A5.fmt.bc)?A5.fmt.bc:BF;}}}}}}}return BB;},getObjInfo:function AJ(A8){var BG=this.primaryModel,BC,BK=BG.getRowTitles(),BF=this.getAttrFormIndices(),A3,BA,A5=BF.length,A1,BI,BC,A7,A9,A6,A2,BE,BH,BD,A4,BJ,BB;BC=BG.getRowHeaders(A8);A1=BC.size();BI=[];for(A6=0;A6<A5;A6++){A3=BF[A6];BA=A3.length;BH=BK.getTitle(A6);BD=BH.getName();A4=BH.getUnitId();for(BE=0;BE<BA;BE++){A2=A3[BE];if(A2<A1){A7=BC.getHeader(A2);BJ=A7.getName();BB=A7.getElementId();BI.push({n:BD,tid:A4,v:BJ,eid:BB});}}}return BI;},getSelectedObjectMetricInfo:function AX(A7){var A1,A3,A2={},A5=this.getObjInfo(A7),A6=A5.length,A4;for(A1=0;A1<A6;A1++){A3=A5[A1];A4=A3.v;if(A2[A3.tid]&&A2[A3.tid][0]&&A2[A3.tid][0].n){A4=A2[A3.tid][0].n+":"+A3.v;}A2[A3.tid]=[{id:A3.eid,n:A4}];}return A2;},addMetricSelections:function b(){var A4=this.getSelectedRowIndices(this.getGeoColumnIndex());if(A4===undefined||!A4 instanceof Array||A4.length===0){return ;}var A3,A2,A5,A1=A4.length;for(A2=0;A2<A1;A2++){A5=A4[A2];A3=this.getSelectedObjectMetricInfo(A5);this.addMetricValueSelection(A3);}},addAttributeSelections:function AP(){var A1=this.getGeoColumnIndex(),A6=this.getSelectedRowIndices(A1);if(A6===undefined||!A6 instanceof Array||A6.length===0){return ;}var A5,A3,A7,A2=A6.length,A4;for(A3=0;A3<A2;A3++){A7=A6[A3];A5=this.getObjInfo(A7);A4=A5[A1];this.addAttributeSelection(A4.tid,A4.eid,A4.v);}},addVisSelection:function J(A3){if(!this.parent.isVI()){return ;}var A8,A2,A5,A6,A1=this.getGeoColumnIndex(),A4,A7=function(A9){if(!!this.dropZones.geoAttribute){delete A9[this.dropZones.latitude];delete A9[this.dropZones.longitude];}};if(!!A3&&A3 instanceof Array){A2=A3.length;for(A5=0;A5<A2;A5++){A8=A3[A5];if(this.getSelectionType()===s.ATTS){A6=this.getObjInfo(A8);A4=A6[A1];this.addAttributeSelection(A4.tid,A4.eid,A4.v);}else{if(this.getSelectionType()===s.METRICS){A6=this.getSelectedObjectMetricInfo(A8);this.addMetricValueSelection(A6);}}}}else{if(this.getSelectionType()===s.ATTS){A6=this.getObjInfo(A3);A4=A6[A1];this.addAttributeSelection(A4.tid,A4.eid,A4.v);}else{if(this.getSelectionType()===s.METRICS){A6=this.getSelectedObjectMetricInfo(A3);A7.call(this,A6);this.addMetricValueSelection(A6);}}}},calculateBubbleRadius:function D(A1){if(isNaN(A1)){return this.minRadius;}if(A1<0){if(this.wpMapSizingStyle==="1"){return this.minRadius;}else{A1=Math.abs(A1);}}return Math.max(this.maxRadius*Math.sqrt(A1/this.maxValue),this.minRadius);},calculateBubbleSize:function AU(A8){var A1=AT,A4,A7=this.primaryModel,A3,A6,A5,A2=A7.getTotalCols();if(this.bubbleSizeMetricIndex>=0&&this.bubbleSizeMetricIndex<A2){A4=A7.getMetricValue(A8,this.bubbleSizeMetricIndex);A6=A4.getValue();A5=A4.getRawValue();A3=parseFloat(!A5?this.parent.stripNumberFormat(A6):A5);if(this.validBubble){A1=this.calculateBubbleRadius(A3);}}return A1;},getAngleMetricValue:function T(A6){var A5=this.primaryModel,A1=A5.getTotalCols(),A4,A3,A2=0;if(this.angleMetricIndex>=0&&this.angleMetricIndex<A1){A4=A5.getMetricValue(A6,this.angleMetricIndex);A3=A4.getValue();A2=A4.getRawValue();A2=parseFloat(!A2?this.parent.stripNumberFormat(A3):A2);if(isNaN(A2)){A2=0;}}return A2;},removeVisSelection:function Au(A3){if(!this.parent.isVI()){return ;}var A7,A2,A5,A6,A1=this.getGeoColumnIndex(),A4;if(!!A3&&A3 instanceof Array){A2=A3.length;for(A5=0;A5<A2;A5++){A7=A3[A5];if(this.getSelectionType()===s.ATTS){A6=this.getObjInfo(A7);A4=A6[A1];this.removeAttributeSelection(A4.tid,A4.eid);}else{if(this.getSelectionType()===s.METRICS){A6=this.getSelectedObjectMetricInfo(A7);this.removeMetricValueSelection(A6);}}}}else{if(this.getSelectionType()===s.ATTS){A6=this.getObjInfo(A3);A4=A6[A1];this.removeAttributeSelection(A4.tid,A4.eid);}else{if(this.getSelectionType()===s.METRICS){A6=this.getSelectedObjectMetricInfo(A3);this.removeMetricValueSelection(A6);}}}},getAttrFormIndices:function I(){if(!!this.attributeFormIndices){return this.attributeFormIndices;}var A7=this,A8=A7.primaryModel,A6=A8.getRowTitles(),A4,A3,A2=[],A1=A6.size();if(A1>0){var A9=0;for(A4=0;A4<A1;A4++){var A5=A6.getTitle(A4).getForms();A2.push([]);if(A5){for(A3=0;A3<A5.length;A3++){A2[A4].push(A9++);}}else{A9++;}}}else{A2=null;}this.attributeFormIndices=A2;return A2;},findSelectorControl:function y(){var A2=this.data,A1=A2&&A2.sc;if(A1&&parseInt(A1.ct,10)===6){this.selectorControl=A1;this.isMultiSelect=true;}else{delete this.selectorControl;}this.controller=!!this.model?this.model.controller:null;this.sid=this.data.sid;return this.selectorControl;},showData:function(A1){if(this.k!=this.parent.k){return ;}if(!this.parent.gridData){this.parent.gridData=this.data;}mstrmojo.vi.ui.ViewDataDialog.open(this.parent.parent,true);},postBuildRendering:function A0(){if(!!mstrApp&&!!mstrApp.isVI&&this._super){this._super();this.attachEventListener("regenerateToolbar",this.parent.parent.id,"generateToolbar");}},onClearBrushing:function AB(A1){},endSelections:function AO(){if(!!mstrApp&&!!mstrApp.isVI&&this._super){this._super();}},destroy:function G(){if(!!mstrApp&&mstrApp.isVI){var A1=mstrApp.rootCtrl.docCtrl.model;if(this.brushSub){A1.detachEventListener(this.brushSub);}if(this.clearSub){A1.detachEventListener(this.clearSub);}}if(this._super){this._super();}},isSelected:function Ay(A2){var A1=false,A3=this.getSelectedRowIndices(this.getGeoColumnIndex()),A4=-1;if(A2&&A2.attributes){if(A2.attributes.hasOwnProperty("rowIndex")){A4=A2.attributes.rowIndex;}else{if(A2.attributes.hasOwnProperty("rowIndices")){A4=A2.attributes.rowIndices[0];}}if(A4>=0&&mstrmojo.array.indexOf(A3,A4)>=0){A1=true;}}return A1;},getElementIdWithoutAttributeID:function Ab(A1){var A4=o.getIdPresentation(A1);var A3="";var A5=0;var A2;switch(A4){case"terse":case"terseLong":for(A2=0;A2<A1.length;A2++){if(A1.charAt(A2)===";"){A5++;}if(A5===1){continue;}A3=A3+A1.charAt(A2);}return A3;case"old":for(A2=0;A2<A1.length;A2++){if(A1.charAt(A2)===":"){A5++;continue;}if(A5===0){continue;}A3=A3+A1.charAt(A2);}return A3;case"oldLong":for(A2=0;A2<A1.length;A2++){if(A1.charAt(A2)===":"){A5++;}if(A5===1){continue;}A3=A3+A1.charAt(A2);}return A3;}return A1;},initLegendProperties:function u(){var A2=(mstrmojo.all.rootView.themeClassName.indexOf("light")>=0);this.defaultsLegendPop=AZ(A2?0:1);this.colorByInfo=m.call(this);this.sizeByInfo=Av.call(this);var A1=this.legendProperty={};A1.fontFamily=this.getLegendProperty(At.LEGEND_FONT_FAMILY);A1.fontSize=this.getLegendProperty(At.LEGEND_FONT_SIZE);Ar(A1,this.getLegendProperty(At.LEGEND_FONT_STYLE));A1.color=Ad.decodeColor(this.getLegendProperty(At.LEGEND_FONT_COLOR));A1.backgroundColor=Ad.decodeColor(this.getLegendProperty(At.LEGEND_BG_COLOR));A1.opacity=this.getLegendProperty(At.LEGEND_BG_FILL_TRANSPARENCY)/100;A1.tbHeight=0;if(this.getLegendProperty(At.LEGEND_BORDER_SHOW)){A1.borderWidth=AG.translateLineStyle(this.getLegendProperty(At.LEGEND_BORDER_LINE_STYLE)).width;A1.borderStyle=AG.translateLineStyle(this.getLegendProperty(At.LEGEND_BORDER_LINE_STYLE)).style;A1.borderColor=Ad.decodeColor(this.getLegendProperty(At.LEGEND_BORDER_COLOR));}},getLegendProperty:function(A2){var A3,A1=this.getWidgetProps();switch(A2){case P.SHOW_LEGEND:A3=A1.ls===undefined||A1.ls.toString()==="true";break;case Ah.SCALE_LEGEND_WIDTH:A3=parseFloat(A1.lwr);break;}if(A3===undefined||((typeof A3)==="number"&&isNaN(A3))){A3=this.defaultsLegendPop[A2];}return A3;},hEvalSize4Legend:function(){var A5,A6=this.parent,A3=this.colorByInfo,A2=this.sizeByInfo,A4=A6.getWidth(),A1=A6.getHeight();if(this.getLegendProperty(P.SHOW_LEGEND)===false){this.legendW=this.legendH=0;}else{A5=R.getLegendSize([{dataType:An.COLOR_BY,dataObj:A3},{dataType:An.SIZE_BY,dataObj:A2}],this.getLegendProperty(Ah.SCALE_LEGEND_WIDTH),A4,A1,this.legendProperty);this.legendCutBy=A5.cutBy;this.legendW=A5.width;this.legendH=A5.height;}},resizeLegend:function(A4,A8){var A5,A6=this.parent,A3=A6.getWidth(),A1=A6.getHeight(),A2=A8/this.legendW+1,A7=this.getLegendProperty(Ah.SCALE_LEGEND_WIDTH);if(A4){A7*=A2;this.legendW+=A8;A5=R.getLegendSize([{dataType:An.COLOR_BY,dataObj:this.colorByInfo},{dataType:An.SIZE_BY,dataObj:this.sizeByInfo}],A7,A3,A1,this.legendProperty,this.legendW);this.legendH=A5.height;this.legendCutBy=A5.cutBy;this.setLegendProperty(Ah.SCALE_LEGEND_WIDTH,A7);}},setLegendProperty:function(A2,A1){switch(A2){case Ah.SCALE_LEGEND_WIDTH:this.parent.setProperty(A2,A1,{suppressData:true});break;}},getLegendStyles:function(){return this.legendProperty;},isLegendMinimized:function(){return false;},getLegendSize:function(){return{width:this.legendW,height:this.legendH,cutBy:this.legendCutBy};},startAffinityLinesAnimation:function H(A1){return ;},drawAffinityLinesUsingSecondaryDataProvider:function h(){return ;},backupSelections:function O(){var A1=this.getGeoColumnIndex();this.selectionBackUp={};this.selectionBackUp.currentSelections=[].concat(this.getCurrentSelections(A1));this.selectionBackUp.selectedRowIndices=[].concat(this.getSelectedRowIndices(A1));this.selectionBackUp.highlightedGraphics=[].concat(this.getHighlightedGraphics(A1));},restoreSelectionEffects:function w(){var A2=this.getGeoColumnIndex(),A4=this.getHighlightedGraphics(A2),A3=A4?A4.length:0;for(var A1=0;A1<A3;A1++){this.highlightGraphic(A4[A1]);}},restoreSelectionDataOnly:function k(){if(!this.selectionBackUp){return ;}var A3=this.getGeoColumnIndex(),A2,A4;if(!this.currentSelections){this.currentSelections={};}if(!this.selectedRowIndices){this.selectedRowIndices={};}if(!this.highlightedGraphics){this.highlightedGraphics={};}this.currentSelections[A3]=this.selectionBackUp.currentSelections;this.selectedRowIndices[A3]=this.selectionBackUp.selectedRowIndices;this.highlightedGraphics[A3]=this.selectionBackUp.highlightedGraphics;var A1=this.getSelectedRowIndices(A3);this.addVisSelection(A1);},clearSelectionBackup:function n(){this.selectionBackUp=null;},addTempSelections:function AN(A3){var A1=mstrmojo.array.ensureArray(A3),A7,A6,A8=A1.length,BD,A4,BC,BB,A9,BA,A2,A5;A5=this.getGeoColumnIndex();BA=this.getTempSelectedRowIndices(A5);A2=this.getTempHighlightedGraphics(A5);for(A7=0;A7<A8;A7++){BD=A1[A7];if(BD.attributes){if(BD.attributes.hasOwnProperty("rowIndices")){A4=BD.attributes.rowIndices;BC=BD.attributes.geoIndices;for(A6=0;A6<A4.length;A6++){BB=A4[A6];BA.push(BB);}A2.push(BD);this.addVisSelection(A4);}else{if(BD.attributes.hasOwnProperty("rowIndex")){BB=BD.attributes.rowIndex;BA.push(BB);A2.push(BD);this.addVisSelection(BB);}}}}},clearTempSelections:function AI(){var A3,A1,A4;A4=this.getGeoColumnIndex();A3=this.getTempSelectedRowIndices(A4);A1=this.getTempHighlightedGraphics(A4);this.removeVisSelection(A3);for(var A2=0;A2<A1.length;A2++){this.clearHighlight(A1[A2]);}A3.length=0;A1.length=0;},getTempSelectedRowIndices:function Z(A1){if(!this.tempSelectedRowIndices){this.tempSelectedRowIndices={};}if(!this.tempSelectedRowIndices.hasOwnProperty(A1)){this.tempSelectedRowIndices[A1]=[];}return this.tempSelectedRowIndices[A1];},getTempHighlightedGraphics:function K(A1){if(!this.tempHighlightedGraphics){this.tempHighlightedGraphics={};}if(!this.tempHighlightedGraphics.hasOwnProperty(A1)){this.tempHighlightedGraphics[A1]=[];}return this.tempHighlightedGraphics[A1];},generateSelectorControlInfoWindowContent:function l(A3){var A2=document.createElement("div");if(!!A3){A3.set("autoCloses",false);A3.set("locksHover",false);A2.className="fusionTableInfoWindow";var A4=A3.children[0],A1=A4&&A4.content;A3.containerNode.style.top=0;A3.containerNode.style.left=0;if(A1){A2.appendChild(A1.containerNode);A3.close();}else{A2.appendChild(A3.domNode);}if(A4){A2.style.height=A4.defn.fmts.height;A2.style.width=A4.defn.fmts.width;A2.style.position="relative";}else{A2.style.height="125px";A2.style.width="200px";A2.style.overflow="auto";}}return A2;},unrender:function AM(){this.tempSelectedRowIndices=null;this.tempHighlightedGraphics=null;if(this._super){this._super();}}});var C=mstrmojo.gmaps.MapDataViewer;C.showPanelStackInfoWindows=W;C.findPanelStackAsInfoWindowSelectorTarget=p;})();if(typeof (mstrmojo.gmaps)=="undefined"){mstrmojo.gmaps={};}(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.VisTooltip","mstrmojo.VisUtility","mstrmojo.gmaps._MapDataLabel","mstrmojo.gmaps.MapDataViewer","mstrmojo.models.template.DataInterface","mstrmojo.gmaps.MapPropertiesHelper","mstrmojo.gmaps.MapEnums");var $MOJO=mstrmojo,$CSS=$MOJO.css,$DOM=$MOJO.dom,$HASH=$MOJO.hash,$GMAPS=$MOJO.gmaps,$MDV=$GMAPS.MapDataViewer,$EnumMarkerType=$GMAPS.EnumMapType,$EnumClusterMode=$GMAPS.EnumClusterMode,$EnumGeographicRole=$GMAPS.EnumGeographicRole,VisUtil=mstrmojo.VisUtility,propHelper=$GMAPS.MapPropertiesHelper;var FEATURE_LAYER_QUERY_LIMIT=500;var _steps;var ATTRIBUTE_DELIMITER=",";var MIN_INFO_WINDOW_WIDTH=100,MAX_INFO_WINDOW_WIDTH=600,MIN_INFO_WINDOW_HEIGHT=50,MAX_INFO_WINDOW_HEIGHT=600,CONTENT_WIDTH_PADDING=26,CONTENT_HEIGHT_PADDING=20,MIN_LATITUDE=-90,MAX_LATITUDE=90;var INFO_WINDOW_CONTENT_NODE="esri-info-content-";function getInfoWindowId(){return INFO_WINDOW_CONTENT_NODE+this.id;}function isTextGraphic(g){if(g.symbol&&g.symbol.declaredClass=="esri.symbol.TextSymbol"){return true;}else{return false;}}function isClusteredGraphic(g){var isTextGraphic=g.symbol&&g.symbol.declaredClass==="esri.symbol.TextSymbol",isClusteredGraphic=false;if(!isTextGraphic){if(g.attributes.clusterCount){isClusteredGraphic=true;}}return isClusteredGraphic;}function isOneTierMac(){return mstrApp.isSingleTier&&mstrmojo.dom.getOSInfo().name.toLowerCase().indexOf("mac")>=0;}function getInfoWindowTitle(ifw){if(ifw&&ifw.children[0]){return ifw.children[0].title;}return"";}function blinkGraphic(graphic){var count=0,me=this,status=graphic.isHighlighted,interval=setInterval(function(){count++;me[status?"clearHighlight":"highlightGraphic"](graphic);status=!status;if(count===8){clearInterval(interval);}},200);}function verifyProtocol(m){if("https:"===window.location.protocol&&(-1!==m.search(/^http\:\/\/server\.arcgisonline\.com/i)||-1!==m.search(/^http\:\/\/services\.arcgisonline\.com/i)||-1!==m.search(/^http\:\/\/.+\.arcgis\.com/i))){m=m.replace(/http:/i,"https:");}return m;}function verifyGeoRole(attribute,skipNone){var _rtn=false,forms=attribute.fs,index,form,geoRole;for(index=0;index<forms.length;index++){form=forms[index];geoRole=form.fgr.toString();if((skipNone||geoRole!==$EnumGeographicRole.EnumGeographicRoleNone)&&geoRole!==$EnumGeographicRole.EnumGeographicRoleLatitiude&&geoRole!==$EnumGeographicRole.EnumGeographicRoleLongitude){_rtn=true;break;}}return _rtn;}function formatAttribute(attributes,rowIndex){var rowTitles=this.data.gts.row,rowHeaders=this.data.ghs.rhs.items[rowIndex].items,attrTitle,k,rowCell,rowCellTitle,rowCellValue;for(k=0;k<rowHeaders.length;k++){rowCell=rowHeaders[k];rowCellTitle=rowTitles[k].n;rowCellValue=this.parent.trimString(rowTitles[k].es[rowCell.idx].n);attrTitle=this.parent.replaceSpace(rowCellTitle);if(!attributes[attrTitle]){attributes[attrTitle]=rowCellValue;}}return attributes;}function getSymbolColor(rowIndex,defaultcolor){var colorString=this.getThresholdString(rowIndex,this.selectedMetricIndex,defaultcolor||this.DEFAULT_COLOR,true),dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;return dojoColor;}function getHoverColor(color){var DELTA=25,minchn=Math.min(Math.min(color.r,color.g),color.b),maxchn=Math.max(Math.max(color.r,color.g),color.b),isDarker=minchn>255-maxchn;["r","g","b"].forEach(function(channel){if(isDarker){color[channel]=color[channel]-DELTA<0?0:color[channel]-DELTA;}else{color[channel]=color[channel]+DELTA<0?0:color[channel]+DELTA;}});color.a=0.7;return color;}mstrmojo.esrimap.ESRIMapViewer=mstrmojo.declare(mstrmojo.gmaps.MapDataViewer,[mstrmojo.gmaps._MapDataLabel],{scriptClass:"mstrmojo.esrimap.ESRIMapViewer",wpMapSizingStyle:"0",columnIndices:{state:-1,zip:-1},densityLayer:null,densityLocations:null,enableSelect:false,enableMarker:false,enablePolygon:false,enableDensity:false,_extent:null,geoElements:{},secondaryGeoElements:{},geoPosition:-1,geoSecondaryRolePosition:-1,infoWindowUseGrid:true,infoWindowVisible:false,previousTooltip:null,latIndex:-1,longIndex:-1,_markerElementIDs:null,markerLayer:null,markerLayerWrapper:null,polygonLayer:null,rowIndex2Graphics:null,useIncremetalFetch:false,points:null,previousState:null,savedSliceInfo:null,validBubble:false,viewCache:null,webmapConfig:null,basemapConfig:null,wpDensityTheme:null,wpDisPlayAffinityLines:false,clusterMode:$EnumClusterMode.OFF,clusterThreshold:500,isClustered:false,useCustomShape:false,useAttribute:false,viewerEventListeners:null,DEFAULT_COLOR:"#81BEF7",_features:[],_returnedQuery:0,_shapeToRowIndexMap:null,unrenderred:false,convertedNameMap:null,maxScale:0,minScale:0,tooltipWin:null,init:function init(props){this._super(props);this.primaryModel=this.addDisposable(new mstrmojo.models.template.DataInterface(this.data));this.loadWidgetProps();this.initMapDisplayMetrics();if(!this.tooltipWin){this.tooltipWin=new $MOJO.VisTooltip({widgetClass:"esriMap"});this.tooltipWin.render();}},loadWidgetProps:function loadWidgetProps(){this.viewerEventListeners=[];this.enableMarker=false;this.enablePolygon=false;this.enableDensity=false;this.bubbleMode=false;var props=this.widgetProps;if(!props){return false;}if($HASH.keyarray(props).length===0){props.sm="0";props.sa="1";}if(props.iwd){this.infoWindowHTML=unescape(props.iwd);this.parseInfoWindowHTML();}var property=props.at;if(property){this.applyThreshold=(property==="1");}if(!props.sa&&!props.mtp&&!props.sm){var rowCount=this.primaryModel.getTotalRows();props.mtp=this.widgetProps.mtp=(rowCount>500?$EnumMarkerType.Density:$EnumMarkerType.Marker);}if(!!props.mtp){if(props.mtp===$EnumMarkerType.Marker){this.enableMarker=true;}else{if(props.mtp===$EnumMarkerType.Bubble){this.enableMarker=true;this.bubbleMode=true;property=props.mbs;if(property){this.maxRadius=parseInt(property,10)/2;}property=props.mss;if(property){this.wpMapSizingStyle=property;}}else{if(props.mtp===$EnumMarkerType.Area){this.enablePolygon=true;}else{if(props.mtp===$EnumMarkerType.Density){if(this.parent.isCanvasSupported()){this.enableDensity=true;this.wpDensityTheme=parseInt(props.dms,10);}else{this.enableMarker=true;this.enableDensity=false;var property=props.at;if(property){this.applyThreshold=(property==="1");}mstrmojo.alert(mstrmojo.desc(9281,"Density Maps is not supported on this Browser version."));}}}}}}else{if(!!props.sm&&props.sm=="1"){this.enableMarker=true;}else{if(!!props.sa&&props.sa=="1"){this.enablePolygon=true;}}}if(this.enableMarker&&!(this.dropZones.latitude&&this.dropZones.longitude)&&!!props.sa&&props.sa=="1"){this.enablePolygon=true;this.enableMarker=false;}if(props.aff==="1"){this.wpDisPlayAffinityLines=true;}if(props.mc){this.clusterMode=props.mc;switch(this.clusterMode){case $EnumClusterMode.ON:case $EnumClusterMode.PIE:case $EnumClusterMode.MOBILE_ON:this.isClustered=true;break;case $EnumClusterMode.OFF:case $EnumClusterMode.MOBILE_OFF:default:this.isClustered=false;break;}}if(props.af&&parseInt(props.af,10)===0){this.useAttribute=true;}},handleMetricSelectionChange:function handleMetricSelectionChange(){if(this.enableMarker){this.adjustMarkerColor();}if(this.enablePolygon){this.adjustPolygonColor();}},addDensity:function addDensity(point,attributes,simpleHTML,geoPosition){if(this.densityLocations===null){this.densityLocations=[];}this.densityLocations.push({position:point,attributes:attributes,geoPosition:geoPosition,infoWindowContent:simpleHTML});},adjustMarkerColor:function adjustMarkerColor(){var g;if(this.markerLayer===null){return ;}this.populateBubbleVariables();var defaultSymbol=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,255,255,0.35]),1),new dojo.Color([125,125,125,0.35]));var graphics=this.markerLayer.graphics;var numGraphics=graphics.length;var symbol;for(g=0;g<numGraphics;g++){var graphic=graphics[g];if(isTextGraphic(graphic)||isClusteredGraphic(graphic)){continue;}symbol=graphic.symbol;var rowIndex=graphic.attributes.rowIndex;var rowValue=this.data.gvs.items&&this.data.gvs.items[rowIndex].items;var rowCell;var type=this.enumNumber;if(rowValue!=undefined&&rowValue instanceof Array){rowCell=rowValue[this.selectedMetricIndex];type=rowCell.ty;}var colorString,dojoColor;if(!this.bubbleMode){switch(type){case this.enumImage:case this.enumUrl:var imageString=this.getThresholdString(rowIndex,this.selectedMetricIndex,"no",false);if(imageString!="no"){if(symbol instanceof esri.symbol.PictureMarkerSymbol){symbol.setUrl(imageString);}else{symbol=new esri.symbol.PictureMarkerSymbol(imageString,20,20);}}break;case this.enumText:case this.enumQuickSymbol:colorString=this.getThresholdString(rowIndex,this.selectedMetricIndex,"#ffffff",false);dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;symbol=new esri.symbol.TextSymbol(this.parent.getQuickSymbol(rowCell.v)).setColor(dojoColor).setAlign(esri.symbol.Font.ALIGN_START).setFont(new esri.symbol.Font("12pt").setWeight(esri.symbol.Font.WEIGHT_BOLD));break;case this.enumNumber:default:colorString=this.getThresholdString(rowIndex,this.selectedMetricIndex,this.DEFAULT_COLOR,true);dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;if(symbol instanceof esri.symbol.SimpleMarkerSymbol){symbol=graphic.symbol.setColor(dojoColor);}else{symbol=new esri.symbol.SimpleMarkerSymbol();symbol.setColor(dojoColor);}symbol.setStyle(esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND);symbol.setOutline(this.parent.regularStroke);break;}}else{colorString=this.getThresholdString(rowIndex,this.selectedMetricIndex,this.DEFAULT_COLOR,true);dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;symbol=new esri.symbol.SimpleMarkerSymbol();symbol.setColor(dojoColor);symbol.setStyle(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE);var size=this.calculateBubbleSize(rowIndex);symbol.setSize(size);symbol.setOutline(this.parent.regularStroke);}graphic.setSymbol(symbol);}this.markerLayer.refresh();},adjustPolygonColor:function adjustPolygonColor(){var g;if(this.polygonLayer===null){return ;}var graphics=this.polygonLayer.graphics;var numGraphics=graphics.length;for(g=0;g<numGraphics;g++){var graphic=graphics[g];var rowIndex=graphic.attributes.rowIndex;var colorString=this.getThresholdString(rowIndex,this.selectedMetricIndex,this.DEFAULT_COLOR,true);var dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;graphic.setSymbol(graphic.symbol.setColor(dojoColor));}this.polygonLayer.refresh();},calculateBubbleSize:function calculateBubbleSize(rowIndex){var radius=this._super(rowIndex);return 2*radius;},clearPoints:function clearPoints(){this.points=new esri.geometry.Multipoint(this.parent.esriMap.spatialReference);},clearAllHighlight:function clearAllHighlight(){var i,j,highlightedGraphics,hilightCount,g;for(i in this.highlightedGraphics){if(this.highlightedGraphics[i] instanceof Array){highlightedGraphics=this.highlightedGraphics[i];hilightCount=highlightedGraphics.length;for(j=0;j<hilightCount;j++){g=highlightedGraphics[j];g.isSelected=false;this.clearHighlight(g);}}}},createDensityMap:function createDensityMap(){this.cleanDensityMap();var parent=this.parent;this.densityLayer=new mstrmojo.esrimap.ESRIDensityLayer({width:parseInt(parent.width),height:parseInt(parent.height),map:parent.esriMap,mapViewer:this,themeId:this.wpDensityTheme,bounds:this._extent,locations:this.densityLocations,originalzIndex:this.layerIndex,visible:false});this.densityLayer.addLayer(parent.esriMap);},cleanDensityMap:function cleanDensityMap(){if(this.densityLayer){this.densityLayer.removeLayer(this.parent.esriMap);this.densityLayer.destroy();this.densityLayer=null;}},createGridInfoWindow:function createGridInfoWindow(div,dataRows,geoColumnIndices){var table=div.childNodes[0],data=this.data,parent=this.parent,cell,header,tui,idx,td,titleSpan,i,j,k,tr,cssStyle,thead,numRowAttributes,numColAttributes,tbody,numRows,metricValues,numMetrics,numAttributes,rowIndex,rowHeaders,attributeName,metricValue,thresholdType;if(!table){table=parent.createEmptyGridInfoWindowTable();div.appendChild(table);cssStyle=parent.createInfoTabDivCSSStyle();if(cssStyle!==null){div.appendChild(cssStyle);}}table.id=getInfoWindowId.call(this);while(!!table&&table.rows.length>0){table.deleteRow(table.rows.length-1);}if(table.tHead){thead=table.tHead;while(thead.rows.length>0){thead.deleteRow(thead.rows.length-1);}tr=thead.insertRow(thead.rows.length);numRowAttributes=data.ghs.rhs.items&&data.ghs.rhs.items.length>0?data.ghs.rhs.items[0].items.length:0;numColAttributes=data.ghs.chs.items&&data.ghs.chs.items.length>0?data.ghs.chs.items[0].items.length:0;for(i=0;i<numRowAttributes;i++){if(this.canSkipItem(i,geoColumnIndices)){continue;}td=tr.insertCell(tr.cells.length);titleSpan=document.createElement("span");titleSpan.innerHTML=parent.getAttributeName(i);td.appendChild(titleSpan);}for(i=0;i<numColAttributes;i++){td=tr.insertCell(tr.cells.length);cell=data.ghs.chs.items[0].items[i];tui=cell.tui;idx=cell.idx;header=data.gts.col[tui].es[idx];titleSpan=document.createElement("span");titleSpan.innerHTML=header.n;td.appendChild(titleSpan);}}tbody=table.tBodies[0];numRows=dataRows.length;metricValues=data.gvs.items;numMetrics=!!metricValues?metricValues[0].items.length:0;numAttributes=data.ghs.rhs.items[0].items.length;for(i=0;i<numRows;i++){rowIndex=dataRows[i];tr=tbody.insertRow(tbody.rows.length);rowHeaders=data.ghs.rhs.items[rowIndex].items;for(j=0;j<numAttributes;j++){if(this.canSkipItem(j,geoColumnIndices)){continue;}cell=rowHeaders[j];if(!cell||cell.idx<0){td=tr.insertCell(tr.cells.length);td.innerHTML=" ";continue;}idx=cell.idx;td=tr.insertCell(tr.cells.length);attributeName=data.gts.row[j].es[idx].n;if(j===this.geoPosition&&i>0){td.innerHTML="    ";}else{td.innerHTML="    "+attributeName+"    ";}}for(k=0;k<numMetrics;k++){metricValue=metricValues[rowIndex].items[k].v;thresholdType=metricValues[rowIndex].items[k].ty;td=tr.insertCell(tr.cells.length);if(thresholdType===this.enumImage){td.innerHTML='    <img src="'+metricValue+'"/>    ';}else{td.innerHTML="    "+metricValue+"    ";}}}},createLookup:function createLookup(){var dataLookup={},rowIndex,rowHeader=this.data.ghs.rhs.items,rowGeoHeader,name;for(rowIndex=0;rowIndex<rowHeader.length;rowIndex++){rowGeoHeader=rowHeader[rowIndex].items[this.geoPosition];name=this.data.gts.row[this.geoPosition].es[rowGeoHeader.idx].n;name=this.parent.trimString(name);name=name.toLowerCase?name.toLowerCase():name;if(!!dataLookup[name]){continue;}dataLookup[name]={rowIndex:rowIndex,geoIndex:rowGeoHeader.idx};}return dataLookup;},getCssClass:function getCssClass(cssIndex){if(cssIndex<0||cssIndex>this.data.css.length){return"";}return this.data.css[cssIndex].n;},canSkipItem:function canSkipItem(idx,skipIndices){var rowTitles=this.data.gts.row,tooltipElements=this.dropZones.tooltips,unitId=rowTitles[idx].id,rowHeaders=this.data.ghs.rhs.items[0].items,rowCell=rowHeaders[idx],titleLength=rowTitles.length,headerLength=rowHeaders.length,rowCellTitle=titleLength<headerLength?rowTitles[rowCell.tui].n:rowTitles[idx].n;if(!tooltipElements||mstrmojo.array.indexOf(tooltipElements,unitId)<0){if(!!this.dropZones.geoAttribute&&(this.isIndexGeoPosition(idx,skipIndices)||this.strContainsLatLng(rowCellTitle))){return true;}}return false;},showMetric:function showMetric(){if(this.data.gts.col.length===1&&this.data.gts.col[0].otp===-1){return true;}return false;},getDefaultInfoWindowTemplate:function getDefaultInfoWindowTemplate(skipIndices){var contentHTML='<table id="'+getInfoWindowId.call(this)+'" class="nonGridInfoWindow">',rowHeaders=this.data.ghs.rhs.items[0].items,rowTitles=this.data.gts.row,rowCell,rowCellTitle,j,k,lastAttrIdx,attIdx,titleLength=rowTitles.length,headerLength=rowHeaders.length,keepCheck=true,parent=this.parent,showMetric=this.showMetric(),itemSkip=[];if(!showMetric&&skipIndices.length===headerLength){keepCheck=false;}for(k=0;k<headerLength&&keepCheck;k++){if(this.canSkipItem(k,skipIndices)){itemSkip[k]=true;}}for(k=headerLength-1;k>=0;k--){if(!itemSkip[k]){break;}}lastAttrIdx=k;for(k=0;k<headerLength;k++){if(itemSkip[k]){continue;}if(!showMetric&&(k===lastAttrIdx)){contentHTML+='<tr class="lastRow">';}else{contentHTML+="<tr>";}rowCell=rowHeaders[k];attIdx=titleLength<headerLength?rowCell.tui:k;rowCellTitle=rowTitles[attIdx].n;contentHTML+="<th>"+parent.getAttributeName(attIdx)+":</th><td> ${"+parent.replaceSpace(rowCellTitle)+"}</td>";contentHTML+="</tr>";}if(showMetric){rowHeaders=this.data.gts.col[0].es;for(j=0;j<rowHeaders.length;j++){contentHTML+=j<rowHeaders.length-1?"<tr>":'<tr class="lastRow">';rowCellTitle=rowHeaders[j].n;contentHTML+="<th>"+rowCellTitle+":</th><td>${"+parent.replaceSpace(rowCellTitle)+"}</td>";contentHTML+="</tr>";}}contentHTML+="</table>";return contentHTML;},getExtent:function getExtent(){return this._extent;},getGeoColumnIndex:function getGeoColumnIndex(){if(this.enablePolygon){return this.geoPosition;}if(this.enableMarker||this.enableDensity){return this.latIndex;}},getGraphics:function getGraphics(){if(this.enablePolygon===true){return this.polygonLayer&&this.polygonLayer.graphics;}else{return null;}},handleClickEvent:function handleClickEvent(evt){if(this.parent.enableClickSelect){this.handleSelection(evt.graphic,evt.ctrlKey);this.parent.handleSingleSelection(true);if(VisUtil.isOnExpressMode()){this.handlePanelStackInfoWindow(evt.graphic,null,evt.screenPoint);}}dojo.stopEvent(evt);},handleMouseMoveEvent:function handleMouseMoveEvent(evt){evt.graphic.isHover=true;if(this.parent.enablePopup){this.parent.set("infoWindowVisible",true);this.showTooltip(evt);}},handleMouseOutEvent:function handleMouseOutEvent(evt){evt.graphic.isHover=false;if(this.parent.enablePopup){this.clearHighlight(evt.graphic);if(this.infoWindowVisible){this.hideTooltip(evt);}}},handleMouseUpEvent:function handleMouseUpEvent(evt){if(!this.parent.toolbarStateChanged&&this.parent.isRightClick(evt)){var evtGraphic=evt.graphic;if(evtGraphic&&!evtGraphic.isSelected){this.handleSelection(evt.graphic,evt.ctrlKey);}}this.parent.handleMouseUp(evt);},handleDensitySelection:function handleDensitySelection(cluster){if(!this.parent.enableClickSelect){return ;}var geoIndex,rowIndex,columnIndices=cluster[0].attributes.columnIndices,columnIndex=columnIndices[0],geoCount=cluster.length,index;var currentSelections=this.getCurrentSelections(columnIndex);var selectedRowIndices=this.getSelectedRowIndices(columnIndex);if(!this.previousState){this.previousState={};this.previousState.columnIndex=columnIndex;this.previousState.currentSelections=currentSelections.slice(0);this.previousState.selectedRowIndices=selectedRowIndices.slice(0);this.previousState.highlightedGraphics=[];this.previousState.mapObjectsState={selectedObj:[],unselectedObj:[]};this.previousState.stateChangedMarker=[];}var isAdd=true;var map=this.parent.esriMap;for(index=0;index<geoCount;index++){geoIndex=cluster[index].attributes.geoIndex;rowIndex=cluster[index].attributes.rowIndex;var i=mstrmojo.array.indexOf(selectedRowIndices,rowIndex);if(i!=-1){if(this.parent.isCtrl||selectedRowIndices.length<=1){currentSelections.splice(i,1);selectedRowIndices.splice(i,1);this.removeVisSelection(rowIndex);}else{this.removeVisSelection(selectedRowIndices);selectedRowIndices.splice(0,selectedRowIndices.length,rowIndex);currentSelections.splice(0,currentSelections.length,geoIndex);this.addVisSelection(rowIndex);}}else{if(this.parent.isCtrl){currentSelections.push(geoIndex);selectedRowIndices.push(rowIndex);this.addVisSelection(rowIndex);}else{this.removeVisSelection(selectedRowIndices);selectedRowIndices.splice(0,selectedRowIndices.length,rowIndex);currentSelections.splice(0,currentSelections.length,geoIndex);this.addVisSelection(rowIndex);}}}this.savedSliceInfo={pos:columnIndices,elementIndex:currentSelections,setViewDataFlag:false,applyControl:true,beanPath:this.beanPath};},handleDensityExtentDraw:function handleDensityExtentDraw(geometry){var map=this.parent.esriMap,columnIndex=this.latIndex,currentSelections,selectedRowIndices,point,i,j,selection=[],location;currentSelections=this.getCurrentSelections(columnIndex);selectedRowIndices=this.getSelectedRowIndices(columnIndex);for(i=0,len=this.densityLocations.length;i<len;i++){location=this.densityLocations[i];j=mstrmojo.array.indexOf(selectedRowIndices,location.attributes.rowIndex);if(j==-1&&geometry.contains(location.position)){currentSelections.push(location.attributes.geoIndex);selectedRowIndices.push(location.attributes.rowIndex);this.addVisSelection(location.attributes.rowIndex);}}if(this.enableSelect){var sliceInfo={pos:[this.latIndex,this.longIndex],elementIndex:currentSelections,setViewDataFlag:false,applyControl:true,beanPath:this.beanPath};this.command.applySelection(sliceInfo);}this.parent.markerSelected=((currentSelections.length>0)?true:false);},handleExtentDraw:function handleExtentDraw(geometry){if(this.enableMarker&&this.markerLayer){this.handleMarkerExtentDraw(geometry);}if(this.enablePolygon){this.handlePolygonExtentDraw(geometry);}if(this.enableDensity){this.handleDensityExtentDraw(geometry);}this.endSelections();},handleMarkerExtentDraw:function handleMarkerExtentDraw(geometry){var map=this.parent.esriMap,columnIndex=this.latIndex,highlightedGraphics=this.getHighlightedGraphics(columnIndex),currentSelections=this.getCurrentSelections(columnIndex),selectedRowIndices=this.getSelectedRowIndices(columnIndex),graphics=this.markerLayer.graphics,numGraphics=graphics.length;var geoIndices,rowIndices,geoCount,rowCount,g,i,j;for(i=0;i<numGraphics;i++){g=graphics[i];if(isTextGraphic(g)){continue;}j=mstrmojo.array.indexOf(selectedRowIndices,g.attributes.rowIndex);if(j==-1&&geometry.contains(g.geometry)){if(isClusteredGraphic(g)){geoIndices=g.attributes.geoIndices;rowIndices=g.attributes.rowIndices;geoCount=geoIndices.length;rowCount=rowIndices.length;for(j=0;j<geoCount;j++){currentSelections.push(geoIndices[j]);}for(j=0;j<rowCount;j++){selectedRowIndices.push(rowIndices[j]);}this.addVisSelection(rowIndices);}else{currentSelections.push(g.attributes.geoIndex);selectedRowIndices.push(g.attributes.rowIndex);this.addVisSelection(g.attributes.rowIndex);}g.isSelected=true;this.highlightGraphic(g);highlightedGraphics.push(g);}}if(this.enableSelect){var sliceInfo={pos:[this.latIndex,this.longIndex],elementIndex:currentSelections,setViewDataFlag:false,applyControl:true,beanPath:this.beanPath};this.command.applySelection(sliceInfo);}this.parent.markerSelected=((currentSelections.length>0)?true:false);},handlePolygonExtentDraw:function handlePolygonExtentDraw(geometry){var i,j;var graphic;var map=this.parent.esriMap;var highlightOutline=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,255],0.35),2);var columnIndex=this.geoPosition;var highlightedGraphics=this.getHighlightedGraphics(columnIndex);var currentSelections=this.getCurrentSelections(columnIndex);var selectedRowIndices=this.getSelectedRowIndices(columnIndex);var graphics=this.polygonLayer.graphics;var numGraphics=graphics.length;var isIntersected=false;for(i=0;i<numGraphics;i++){var g=graphics[i];j=mstrmojo.array.indexOf(selectedRowIndices,g.attributes.rowIndex);if(j===-1){isIntersected=this.intersects(geometry,g.geometry);}if(isIntersected){this.updatePolygonGraphicInfo(g);currentSelections.push(g.attributes.geoIndex);selectedRowIndices.push(g.attributes.rowIndex);this.addVisSelection(g.attributes.rowIndex);g.isSelected=true;this.highlightGraphic(g);highlightedGraphics.push(g);}}if(this.enableSelect){var sliceInfo={pos:[this.geoPosition],elementIndex:currentSelections,setViewDataFlag:false,applyControl:true,beanPath:this.beanPath};this.command.applySelection(sliceInfo);}this.parent.markerSelected=((currentSelections.length>0)?true:false);},intersects:function intersects(geometry1,geometry2){var isIntersected=false,rings,ring,ringNumber,i,j,pointNumber,point,mapPoint;if(!geometry1||!geometry2){return false;}if(geometry1.getExtent().intersects(geometry2.getExtent())){rings=geometry2.rings;ringNumber=rings?rings.length:0;for(i=0;i<ringNumber;i++){ring=rings[i];pointNumber=ring?ring.length:0;for(j=0;j<pointNumber;j++){point=ring[j];mapPoint=new esri.geometry.Point(point[0],point[1],geometry2.spatialReference);if(geometry1.contains(mapPoint)){isIntersected=true;break;}}if(isIntersected){break;}}if(!isIntersected){rings=geometry1.rings;ringNumber=rings?rings.length:0;for(i=0;i<ringNumber;i++){ring=rings[i];pointNumber=ring?ring.length:0;for(j=0;j<pointNumber;j++){point=ring[j];mapPoint=new esri.geometry.Point(point[0],point[1],geometry1.spatialReference);if(geometry2.contains(mapPoint)){isIntersected=true;break;}}if(isIntersected){break;}}}}return isIntersected;},handleSelection:function handleSelection(evtGraphic,isCtrl,isAdd){if(!this.parent.enableClickSelect){return ;}var geoIndices,rowIndices,geoIndex,rowIndex,columnIndices=evtGraphic.attributes.columnIndices,columnIndex=columnIndices[0],highlightedGraphics=this.getHighlightedGraphics(columnIndex),currentSelections=this.getCurrentSelections(columnIndex),selectedRowIndices=this.getSelectedRowIndices(columnIndex),hgLen=highlightedGraphics.length,geoCount,sliceInfo,sliceGraphic,i,il,j,isRemove,isClear,isClustered;if(isTextGraphic(evtGraphic)){evtGraphic=evtGraphic.refGraphic;}isClustered=isClusteredGraphic(evtGraphic);if(isClustered){geoIndices=evtGraphic.attributes.geoIndices;rowIndices=evtGraphic.attributes.rowIndices;}else{geoIndices=[evtGraphic.attributes.geoIndex];rowIndices=[evtGraphic.attributes.rowIndex];}geoCount=geoIndices.length;if(!this.previousState){this.previousState={};this.previousState.columnIndex=columnIndex;this.previousState.currentSelections=currentSelections.slice(0);this.previousState.selectedRowIndices=selectedRowIndices.slice(0);this.previousState.highlightedGraphics=highlightedGraphics.slice(0);this.previousState.mapObjectsState={selectedObj:[],unselectedObj:[]};this.previousState.stateChangedMarker=[];}isRemove=!!evtGraphic.isSelectionItem&&(isCtrl||(!isCtrl&&selectedRowIndices.length===geoCount));isClear=!isCtrl&&(!evtGraphic.isSelectionItem||(evtGraphic.isSelectionItem&&selectedRowIndices.length!==geoCount));if((!isAdd)&&isRemove){for(i=0;i<geoCount;i++){geoIndex=geoIndices[i];rowIndex=rowIndices[i];j=mstrmojo.array.indexOf(selectedRowIndices,rowIndex);if(j!==-1){currentSelections.splice(j,1);selectedRowIndices.splice(j,1);this.removeVisSelection(rowIndex);}}for(i=0;i<hgLen;i++){rowIndex=highlightedGraphics[i].attributes.rowIndex;j=mstrmojo.array.indexOf(rowIndices,rowIndex);if(j!==-1){highlightedGraphics.splice(i--,1);hgLen--;}}evtGraphic.isSelected=false;this.clearHighlight(evtGraphic);}else{if((!isAdd)&&isClear){this.removeVisSelection(selectedRowIndices);selectedRowIndices.splice(0,selectedRowIndices.length);currentSelections.splice(0,currentSelections.length);this.previousState.mapObjectsState.unselectedObj.splice(0,this.previousState.mapObjectsState.unselectedObj.length);this.clearAllHighlight();highlightedGraphics.splice(0,hgLen);}for(i=0;i<geoCount;i++){geoIndex=geoIndices[i];rowIndex=rowIndices[i];j=mstrmojo.array.indexOf(selectedRowIndices,rowIndex);if(j===-1){currentSelections.push(geoIndex);selectedRowIndices.push(rowIndex);this.addVisSelection(rowIndex);}}if(evtGraphic.isPieCluster){for(i=0,il=evtGraphic.sliceGraphics.length;i<il;i++){sliceGraphic=evtGraphic.sliceGraphics[i];if(!sliceGraphic.isSelectionItem){highlightedGraphics.push(sliceGraphic);}}}else{highlightedGraphics.push(evtGraphic);}this.previousState.mapObjectsState.unselectedObj.push(evtGraphic);evtGraphic.isSelected=true;this.highlightGraphic(evtGraphic);}sliceInfo={pos:columnIndices,elementIndex:currentSelections,setViewDataFlag:false,applyControl:true,beanPath:this.beanPath};this.savedSliceInfo=sliceInfo;},onMapClick:function onMapClick(evt){var map=this.parent,clearAllIsDisabled=map.isClearAllDisabled();if(map.enablePopup&&!clearAllIsDisabled){map.clearAllLayerSelections();}},hideInfoWindow:function hideInfoWindow(){if(this.parent.enablePopup){this.parent.esriMap.infoWindow.hide();this.infoWindowVisible=false;}},hideTooltip:function hideTooltip(){if(this.parent.enablePopup){var win=this.tooltipWin.domNode;if(win&&win.parentNode){this.tooltipWin.toggle(false);win.parentNode.removeChild(win);win.innerHTML="";this.previousTooltip=null;}this.infoWindowVisible=false;}},strContainsLatLng:function strContainsLatLng(str){if(!!str&&(str.toLowerCase().indexOf("latitude")>-1||str.toLowerCase().indexOf("longitude")>-1)){return true;}return false;},findMappableAttributes:function findMappableAttributes(rowAttributes,geoAttrIndics){var numTemplateUnits=rowAttributes.length,latFormId=this.dropZones.latitude,longFormId=this.dropZones.longitude,attrId=this.dropZones.geoAttribute,formId,i;function findGeo(attrId){for(i=0;i<numTemplateUnits;i++){if(!this.useAttribute){if(rowAttributes[i].id===attrId){formId=rowAttributes[i].fid;if(formId===latFormId){this.latIndex=i;}else{if(formId===longFormId){this.longIndex=i;}else{geoAttrIndics.push(i);}}}}else{if(rowAttributes[i].id===latFormId){this.latIndex=i;}else{if(rowAttributes[i].id===longFormId){this.longIndex=i;}}}}if(this.latIndex<0||this.longIndex<0){return false;}return true;}function findGeoOnTemplate(){var numTemplateUnits=rowAttributes.length,i,tmpLatIdx=-1,tmpLongIdx=-1,tmpAttrId={};for(i=0;i<numTemplateUnits;i++){if(!this.useAttribute){formId=rowAttributes[i].fid;if(formId===latFormId){tmpLatIdx=i;tmpAttrId[rowAttributes[i].id]=true;}else{if(formId===longFormId){tmpLongIdx=i;tmpAttrId[rowAttributes[i].id]=true;}}}}if(tmpLatIdx>=0&&tmpLongIdx>=0&&$HASH.keyarray(tmpAttrId).length===1){return $HASH.keyarray(tmpAttrId)[0];}return null;}if(findGeo.call(this,attrId)){return true;}var tmpGeoAttrId=findGeoOnTemplate.call(this);if(tmpGeoAttrId){return findGeo.call(this,tmpGeoAttrId);}return false;},initMarkerMap:function initMarkerMap(createMode){if(!createMode){if(this.enableMarker){this.markerLayer.show();this.showDataLabelLayer();}if(this.enableDensity){this.densityLayer.showLayer();}this.parent.hideWait();return ;}var i,rowIndex,columnHeaderColumnIndex,columnHeaderRowIndex,validSymbol,symbol,pointInfo,graphic,infoTemplate,formId,rowHeaderElements,rowHeaderElement,latitudeElement,longitudeElement,latitude,longitude,latitudeId,longitudeId,geoIndex,longGeoIndex,attributes,elementValue,values,columnHeaderName,thresholdType,type,dojoColor,cell,cellName,cellElement,fnCreateSymbol,textSybmolText,symbolSize,bubbleSize,colorString,imageString,point,idkey,dlTextName,me=this,textSymbolStyle={fontFamily:"Serif",fontSize:"12pt",fontWeight:"bold",fontStyle:"normal"},geoAttrIndics=[],dataLabelsConfig=this.dataLabelsConfig=[],rowHeaders=this.data.ghs.rhs.items,columnHeaders=this.data.ghs.chs.items,pointsData=[],graphicsData=[],map=this.parent.esriMap,data=this.data.gvs.items,rowCount=this.primaryModel.getTotalRows(),rowAttributes=this.data.gts.row,columnMetrics=this.data.gts.col;this.clearPoints();this.idMarkerMap={};this._markerElementIDs={};this.parent.populateOriginalPosition();this.populateBubbleVariables();this.longIndex=-1;this.latIndex=-1;this.rowIndex2Graphics={};if(!this.findMappableAttributes(rowAttributes,geoAttrIndics)){this.parent.hideWait();this.parent.updateMapExtent();if(console&&console.log){console.log("No Mappable attributes present on the report.");}return ;}infoTemplate=this.populateInfoTemplate(" ",[this.latIndex,this.longIndex]);if(!this.enableDensity&&this.isClustered){try{mstrmojo.requiresCls("mstrmojo.esrimap.ClusterLayerWrapper");}catch(e){this.parent.hideWait();this.isClustered=false;}}else{if(this.enableDensity){try{mstrmojo.requiresCls("mstrmojo.esrimap.ESRIDensityLayer");}catch(e){this.parent.hideWait();mstrmojo.alert("Unable to load ESRIDensityLayer.");}}}fnCreateSymbol=function(rowIndex,style,size){var colorStr=me.getThresholdString(rowIndex,me.selectedMetricIndex,me.DEFAULT_COLOR,true),color=new dojo.Color(colorStr),markerSymbol=new esri.symbol.SimpleMarkerSymbol();color.a=0.75;markerSymbol.setStyle(style);markerSymbol.setColor(color);markerSymbol.setOutline(me.parent.regularStroke);if(style===esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE&&size){markerSymbol.setSize(size);}return markerSymbol;};for(rowIndex=rowCount-1;rowIndex>=0;rowIndex--){validSymbol=true;rowHeaderElements=rowHeaders[rowIndex].items;latitudeElement=rowHeaderElements[this.latIndex];if(!latitudeElement||latitudeElement.idx<0){continue;}latitude=this.parent.stripNumberFormat(rowAttributes[this.latIndex].es[latitudeElement.idx].n);latitudeId=rowAttributes[this.latIndex].es[latitudeElement.idx].id;if(latitudeId.indexOf("DB:")===0||this.parent.trimString(latitude)===""){continue;}longitudeElement=rowHeaderElements[this.longIndex];if(!longitudeElement||longitudeElement.idx<0){continue;}longitude=this.parent.stripNumberFormat(rowAttributes[this.longIndex].es[longitudeElement.idx].n);longitudeId=rowAttributes[this.longIndex].es[longitudeElement.idx].id;if(longitudeId.indexOf("DB:")===0||this.parent.trimString(longitude)===""){continue;}if(!this.isValidLatLng(latitude,longitude)){continue;}if(latitudeId===longitudeId){idkey=latitudeId;}else{idkey=latitudeId+"|"+longitudeId;}if(this.idMarkerMap[idkey]){continue;}attributes={};dlTextName="";for(i=0;i<rowHeaderElements.length;i++){rowHeaderElement=rowHeaderElements[i];if(rowHeaderElement.idx<0){continue;}if(i===this.latIndex){geoIndex=rowHeaderElement.idx;}if(i===this.longIndex){longGeoIndex=rowHeaderElement.idx;}elementValue=rowAttributes[i].es[rowHeaderElement.idx].n;attributes[this.parent.replaceSpace(rowAttributes[i].n)]=elementValue;if(geoAttrIndics.indexOf(i)>=0){dlTextName+=!dlTextName?elementValue:" "+elementValue;}}values=!!data?data[rowIndex].items:[];for(columnHeaderColumnIndex=0;columnHeaderColumnIndex<values.length;columnHeaderColumnIndex++){columnHeaderName=null;for(columnHeaderRowIndex=0;columnHeaderRowIndex<columnHeaders.length;columnHeaderRowIndex++){cellElement=columnHeaders[columnHeaderRowIndex].items[columnHeaderColumnIndex];cellName=columnMetrics[cellElement.tui].es[cellElement.idx].n;if(columnHeaderName===null){columnHeaderName=cellName;}else{columnHeaderName+=" "+cellName;}}if(!columnHeaderName){continue;}thresholdType=values[columnHeaderColumnIndex].ty;if(!thresholdType||thresholdType===this.enumNumber){attributes[this.parent.replaceSpace(columnHeaderName)]=values[columnHeaderColumnIndex].v;}else{attributes[this.parent.replaceSpace(columnHeaderName)]=values[columnHeaderColumnIndex].rv;}}attributes.rowIndex=rowIndex;attributes.geoIndex=geoIndex;attributes.longGeoIndex=longGeoIndex;attributes.columnIndices=[this.latIndex,this.longIndex];attributes.layerKey=this.k;cell=values[this.selectedMetricIndex];type=!!cell&&this.applyThreshold?cell.ty:this.enumDefault;if(!this.enableDensity){if(!this.bubbleMode){switch(type){case this.enumText:case this.enumQuickSymbol:colorString=this.getThresholdString(rowIndex,this.selectedMetricIndex,"#ffffff",false);dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;textSybmolText=this.parent.getQuickSymbol(cell.v);symbol=new esri.symbol.TextSymbol(textSybmolText).setColor(dojoColor).setFont(new esri.symbol.Font("12pt").setWeight(esri.symbol.Font.WEIGHT_BOLD));symbolSize=VisUtil.measureTextSize(textSybmolText,textSymbolStyle);break;case this.enumImage:case this.enumUrl:imageString=this.getThresholdString(rowIndex,this.selectedMetricIndex,"no",false);if(imageString!=="no"){symbol=new esri.symbol.PictureMarkerSymbol(imageString,20,20);symbolSize={width:20,height:20};}else{validSymbol=false;}break;default:symbol=fnCreateSymbol(rowIndex,esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND);symbolSize={width:16,height:16};break;}}else{bubbleSize=this.calculateBubbleSize(rowIndex);symbol=fnCreateSymbol(rowIndex,esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,bubbleSize);symbolSize={width:bubbleSize,height:bubbleSize};}}if(validSymbol){point=new esri.geometry.Point(longitude,latitude,this.parent.esriMap.spatialReference);if(this.isWebMercator(map.spatialReference)){point=esri.geometry.geographicToWebMercator(point);}if(point){this.points.addPoint(point);}if(!this.enableDensity){if(this.isClustered){pointInfo={x:parseFloat(point.x),y:parseFloat(point.y),attributes:attributes,infoWindowContent:this.infoWindowHTML,singleSymbol:symbol,dlTextName:dlTextName,symbolSize:symbolSize};if(this.dropZones.angle){pointInfo.absAngleMetricVal=Math.abs(this.getAngleMetricValue(rowIndex));}pointsData.push(pointInfo);this.idMarkerMap[idkey]=symbol;}else{graphic=new esri.Graphic(point,symbol,attributes,infoTemplate);graphicsData.push(graphic);this.idMarkerMap[idkey]=graphic;this.rowIndex2Graphics[rowIndex]=graphic;dataLabelsConfig.push({text:dlTextName,rowIndex:rowIndex,mapPoint:point,symbolSize:symbolSize});}}else{this.addDensity(point,attributes,this.infoWindowHTML,this.geoPosition);}this._markerElementIDs[this.parent.getElementIdWithoutAttributeID(idkey)]=point;}}var markerLayer=this.markerLayer,markerType=1,markerLayerWrapper=this.markerLayerWrapper;if(!this.enableDensity){if(!markerLayer){if(this.isClustered){if(this.bubbleMode){markerType=2;}if(markerLayerWrapper){markerLayerWrapper.destroy();}markerLayerWrapper=new mstrmojo.esrimap.ClusterLayerWrapper({clusterData:pointsData,clusterTolerance:50,clusterLabelColor:"#fff",singleTemplate:infoTemplate,sr:map.spatialReference,markerType:markerType,visible:true,mapViewer:this});markerLayer=markerLayerWrapper.clusterLayer;this.markerLayerWrapper=markerLayerWrapper;}else{markerLayer=new esri.layers.GraphicsLayer({visible:true});try{for(i=0;i<graphicsData.length;i++){markerLayer.add(graphicsData[i]);}}catch(evt){this.parent.hideWait();console.log("error adding marker to layer:"+evt.name+":"+evt.description);}}if(!!markerLayer){this.markerLayer=markerLayer;}}try{map.addLayer(markerLayer,this.layerIndex);this.viewerEventListeners.push(dojo.connect(this.markerLayer,"onClick",this,this.handleClickEvent));this.viewerEventListeners.push(dojo.connect(this.markerLayer,"onMouseMove",this,this.handleMouseMoveEvent));this.viewerEventListeners.push(dojo.connect(this.markerLayer,"onMouseOut",this,this.handleMouseOutEvent));this.viewerEventListeners.push(dojo.connect(this.markerLayer,"onMouseUp",this,this.handleMouseUpEvent));this.viewerEventListeners.push(dojo.connect(map,"onClick",this,this.onMapClick));this.viewerEventListeners.push(dojo.connect(map.infoWindow,"onHide",this,this.onHideInfoWindow));}catch(e){this.parent.hideWait();console.log("error adding layer to map:"+e.name+":"+e.description);}}else{try{this.createDensityMap();this.markerLayer=null;}catch(e){this.parent.hideWait();console.log("error adding density layer to map:"+e.name+":"+e.description);}}if(this.points&&this.points.points.length>0){if(this.points.points.length===1){this._extent=this.getExtentForSingleMarker(latitude,longitude);}else{this._extent=this.points.getExtent();}if(createMode){this.parent.updateMapExtent();}}else{this.parent.hideWait();this.parent.showMapLayer();}if(!this.enableDensity&&this.isClustered){markerLayerWrapper.renderClusterLayer(map);}this.populateDataLabelMetricValues();this.buildDataLabelLayer();},escapeSingleQuote:function escapeSingleQuoate(str){return str.replace("'","''");},failToLoadPolygon:function failToLoadPolygon(errMsg){this.parent.hideWait();if(console&&console.log&&!!errMsg){console.log(errMsg);}this.polygonLayer=null;this.removeDataLabelLayer();this.parent.showMapLayer();},initPolygonMap:function initPolygonMap(createMode){if(!createMode){this.polygonLayer.show();this.showDataLabelLayer();this.parent.hideWait();return ;}if(isOneTierMac()){FEATURE_LAYER_QUERY_LIMIT=50;}this._shapeToRowIndexMap={};this.rowIndex2Graphics={};var i,j,k;this.parent.populateOriginalPosition();this.initMapProperty();var map=this.parent.esriMap;var me=this;var rowAttributes=this.data.gts.row;var numAttributes=rowAttributes.length;var geoAttributeName,geoRole;var geoAttributeID,attribute;for(i=0;i<numAttributes;i++){attribute=rowAttributes[i];if(this.geoPosition<0){if((!this.parent.useESRICloud&&this.parent.esriAttributeMapping[attribute.id])||(this.parent.useESRICloud&&this.dropZones.geoAttribute===attribute.id)){if(verifyGeoRole(attribute)){this.geoPosition=i;}}}if(this.geoPosition>=0){geoAttributeName=attribute.n;geoAttributeID=attribute.id;this.geoElements=this.data.ghs.rhs.items;break;}}if(this.geoPosition<0){for(i=0;i<numAttributes;i++){attribute=rowAttributes[i];if(this.dropZones.geoAttribute==attribute.id&&!!this.widgetProps.lid){if(verifyGeoRole(attribute,true)){this.geoPosition=i;}}if(this.geoPosition>=0){geoAttributeName=attribute.n;geoAttributeID=attribute.id;this.geoElements=this.data.ghs.rhs.items;break;}}}if(this.geoPosition<0){this.parent.updateMapExtent();this.failToLoadPolygon("No Mappable attributes present on the report.");return ;}var mappedValue=null,queryTask,geoGraphicsLayer=null;this.polygonLayer=null;if(this.parent.useESRICloud){this.initWebMapConfig();mappedValue=this.webmapConfig;if(!mappedValue||!mappedValue.ml){this.failToLoadPolygon();return ;}dojo.map(this.parent.operationalLayers,function(layer,index){if(layer.url==mappedValue.ml){geoGraphicsLayer=layer.layerObject;}});}else{this.basemapConfig=this.parent.esriAttributeMapping[geoAttributeID];if(this.basemapConfig){this.basemapConfig.ml=verifyProtocol(this.basemapConfig.ml);}mappedValue=this.basemapConfig;if(mappedValue!==undefined&&mappedValue.ml!==undefined){queryTask=new esri.tasks.QueryTask(""+mappedValue.ml);}else{this.failToLoadPolygon();return ;}}var sf=this.parent.trimString(mappedValue.sf);if(sf&&sf.length>0){this.secondField=sf;}this.outFieldsArr=eval(mappedValue.qf);if(!!this.secondField){this.outFieldsArr.push(this.secondField);}this.esriField=mappedValue.ea;this.convertedNameMap={};if(this.geoElements.length>FEATURE_LAYER_QUERY_LIMIT){this.useIncremetalFetch=true;_steps=Math.ceil(this.geoElements.length/FEATURE_LAYER_QUERY_LIMIT);try{this.createShapesUsingIncrementFetching();}catch(err){this.failToLoadPolygon();console.log("error : "+err);}return ;}if(!geoGraphicsLayer){geoGraphicsLayer=new esri.layers.FeatureLayer(mappedValue.ml,{outFields:["*"]});map.addLayer(geoGraphicsLayer,this.layerIndex);}if(!geoGraphicsLayer){this.failToLoadPolygon();return ;}var queryWhere=this.buildQueryWhere(0,this.geoElements.length,geoRole);geoGraphicsLayer.setDefinitionExpression(queryWhere);geoGraphicsLayer.mode=esri.layers.FeatureLayer.MODE_SNAPSHOT;geoGraphicsLayer.setVisibility(false);this.addPolygonListeners(geoGraphicsLayer,true);this.polygonLayer=geoGraphicsLayer;var query=new esri.tasks.Query();query.returnGeometry=true;query.outFields=this.outFieldsArr;query.outSpatialReference=this.parent.esriMap.spatialReference;var idString,rowGeoHeader,rowHeaders=this.data.ghs.rhs.items;query.where="1=1";this.polygonLayer.queryFeatures(query,function(featureSet){me.updateScales(geoGraphicsLayer.minScale,geoGraphicsLayer.maxScale);me.onQueryFeatureLayerComplete.call(me,featureSet.features);},function(error){me.failToLoadPolygon("queryTask error:"+error.name+":"+error.description);if(!!error.description&&error.description.indexOf("esri.config.defaults.io.proxyUrl is not set")>-1){mstrmojo.alert("Query request too large. Please configure proxy setting in the esriconfig.xml and try again");}else{mstrmojo.alert("queryTask error:"+error.name+":"+error.description);}});},updateScales:function updateScales(minScale,maxScale){if(this.destroyed){return ;}this.minScale=minScale;this.maxScale=maxScale;console&&console.log("ESRIMAPViewer: minScale = "+this.minScale+":maxScale = "+this.maxScale);this.parent.updateScales(minScale,maxScale);},convertName:function convertName(s,geoRole){var map=this.parent,names=map.getEsriConfig().nameConversions;if(!names){return s;}var i,name,value,role,convertedName=s;for(i=0;i<names.length;i++){conversion=names[i];name=map.trimString(names[i].n);role=names[i].georole;value=map.trimString(names[i].value);if(name===s&&(!role||geoRole===role)){convertedName=value;this.convertedNameMap[value]=name;}}return map.trimString(convertedName);},checkName:function checkName(i,georole){return this.escapeSingleQuote(this.convertName(this.getElementValue(i,this.geoPosition),georole));},buildQueryWhere:function buildQueryWhere(start,end,geoRole){var idString,rowGeoHeader,rowHeaders=this.data.ghs.rhs.items,queryWhere,firstOne=true;queryWhere=this.esriField+" in (";for(var i=start;i<end;i++){idString=this.getIdStringForRow(i);idString=idString.toLowerCase?idString.toLowerCase():idString;if(!!this._shapeToRowIndexMap[idString]){continue;}rowGeoHeader=rowHeaders[i].items[this.geoPosition];this._shapeToRowIndexMap[idString]={rowIndex:i,geoIndex:rowGeoHeader.idx};if(firstOne){queryWhere+="'"+this.checkName(i,geoRole)+"'";firstOne=false;}else{queryWhere+=", '"+this.checkName(i,geoRole)+"'";}}queryWhere+=")";return queryWhere;},getGeoObjectExt:function getGeoObjectExt(rowIndex,blink){var graphics=this.rowIndex2Graphics[rowIndex];if(graphics&&blink){blinkGraphic.call(this,graphics);}if(this.enableMarker){return{center:new esri.geometry.Point(graphics.geometry.getLongitude(),graphics.geometry.getLatitude()),type:$EnumMarkerType.Marker};}else{if(this.enablePolygon){return{center:graphics.geometry.getCentroid(),bound:graphics.geometry.getExtent(),type:$EnumMarkerType.Area};}}},setVisibility:function setVisibility(visible){if(!this.visible){return ;}if(this.enablePolygon&&!!this.polygonLayer){this.polygonLayer.setVisibility(visible);}else{if(this.enableMarker&&!!this.markerLayer){this.markerLayer.setVisibility(visible);}else{if(this.enableDensity&&!!this.densityLayer){if(visible){this.densityLayer.showLayer();}else{this.densityLayer.hideLayer();}}}}},getElementValue:function getElementValue(row,col){var rowGeoHeader=this.data.ghs.rhs.items[row].items[col];return this.parent.trimString(this.data.gts.row[col].es[rowGeoHeader.idx].n);},getIdStringForRow:function getIdStringForRow(rowIndex){var idString="";idString+=this.getElementValue(rowIndex,this.geoPosition);if(this.geoSecondaryRolePosition!=-1){idString+=ATTRIBUTE_DELIMITER+this.getElementValue(rowIndex,this.geoSecondaryRolePosition);}return idString;},getMapType:function getMapType(){if(this.enableDensity){return $EnumMarkerType.Density;}else{if(this.enableMarker){if(this.bubbleMode){return $EnumMarkerType.Bubble;}else{return $EnumMarkerType.Marker;}}else{if(this.enablePolygon){return $EnumMarkerType.Area;}}}return -1;},getMapConfigVal:function getMapConfigVal(){return this.parent.useESRICloud?this.webmapConfig:this.basemapConfig;},createShapesUsingIncrementFetching:function createShapesUsingIncrementFetching(){var map=this.parent.esriMap,me=this,mappedValue=this.getMapConfigVal(),queryTask=new esri.tasks.QueryTask(mappedValue.ml);this._returnedQuery=0;this._features=[];var firstOne,idString,rowGeoHeader,rowHeaders=this.data.ghs.rhs.items;for(var step=0;step<_steps;step++){var start=step*FEATURE_LAYER_QUERY_LIMIT;var end=Math.min(start+FEATURE_LAYER_QUERY_LIMIT,this.geoElements.length);var query=new esri.tasks.Query();query.returnGeometry=true;query.outFields=this.outFieldsArr;query.outSpatialReference=this.parent.esriMap.spatialReference;query.where=this.buildQueryWhere(start,end);queryTask.execute(query,function onQueryComplete(featureSet){me.onIncrementalQueryFeaturesComplete.call(me,featureSet.features);},function onQueryError(err){console&&console.log("Error incremental fetching :");me.onIncrementalQueryFeaturesComplete.call(me,[]);});}},onIncrementalQueryFeaturesComplete:function onIncrementalQueryFeaturesComplete(features){this._returnedQuery++;if(features.length>0){this._features=this._features.concat(features);}if(this._returnedQuery==_steps){var finalFeatures=this._features;var mappedValue=this.getMapConfigVal(),outFieldsArr=eval(mappedValue.qf);var fields=[];fields.push({name:"ObjectID",alias:"ObjectID",type:"esriFieldTypeOID"});mstrmojo.array.forEach(outFieldsArr,function(field){fields.push({name:field,alias:field,type:"esriFieldTypeString"});});var sf=this.parent.trimString(mappedValue.sf);if(sf&&sf.length>0){fields.push({name:sf,alias:sf,type:"esriFieldTypeString"});}var layerDefinition={geometryType:"esriGeometryPolygon",objectIdField:"ObjectID",drawingInfo:{renderer:{type:"simple",symbol:{color:[255,255,255,125],outline:{color:[255,255,255,255],width:1,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}},fields:fields};var featureCollection={layerDefinition:layerDefinition,featureSet:{features:finalFeatures,geometryType:"esriGeometryPolygon"}};try{var geoGraphicsLayer=new esri.layers.FeatureLayer(featureCollection,{mode:esri.layers.FeatureLayer.MODE_SNAPSHOT});geoGraphicsLayer.setVisibility(false);}catch(e){console.log("Error creating feature layer : "+e);return ;}this.parent.esriMap.addLayer(geoGraphicsLayer,this.layerIndex);this.addPolygonListeners(geoGraphicsLayer);this.polygonLayer=geoGraphicsLayer;var me=this;if(finalFeatures.length<1){this.failToLoadPolygon("Returned featureSet is empty.");return ;}me.polygonLayer.applyEdits(finalFeatures,null,null,function onApplyEditComplete(evt){me.onQueryFeatureLayerComplete(finalFeatures);},function onApplyEditError(e){console.log("Error adding features to feature layer : "+e);});}},onQueryFeatureLayerComplete:function onQueryFeatureLayerComplete(features){if(this.unrenderred){return ;}if(typeof (console)!="undefined"){console.log("queryTask complete");}if(features.length<1){this.failToLoadPolygon("Returned featureSet is empty.");return ;}var mappedValue=this.getMapConfigVal(),defaultSymbol=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_NULL,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,255,255,0]),0),new dojo.Color([255,255,255,0])),infoTemplate=this.populateInfoTemplate((this.parent.replaceSpace(mappedValue.ea)).toUpperCase()),i,il,renderer=null,me=this,map=me.parent.esriMap,dataLabelsConfig=this.dataLabelsConfig=[],newExtent=null,lastExtent,dataLookup=me._shapeToRowIndexMap,esriGeoName,geoName,secondaryFieldName,idString,geometry,sf,rowIndex,graphic,attributes,colorString,dojoColor,symbol;map.graphics.clear();console.log("featureSet size="+features.length);for(i=0,il=features.length;i<il;i++){graphic=features[i];attributes=graphic.attributes;esriGeoName=attributes[me.esriField]||attributes[me.esriField=me.esriField.toLowerCase()]||attributes[me.esriField=me.esriField.toUpperCase()];if(this.convertedNameMap[esriGeoName]){geoName=this.convertedNameMap[esriGeoName];}else{geoName=esriGeoName;}if(!geoName){this.failToLoadPolygon("Warning: "+me.esriField+" not found in featureSet from ESRI server! Please ensure the field "+me.esriField+" is present in FeatureLayer specified by  <ml> value in esriConfig.xml");return ;}idString=geoName;sf=this.parent.trimString(mappedValue.sf);if(this.geoSecondaryRolePosition!==-1&&sf&&sf.length>0){secondaryFieldName=attributes[sf]||attributes[mappedValue.sf=sf.toLowerCase()]||attributes[mappedValue.sf=sf.toUpperCase()];idString+=ATTRIBUTE_DELIMITER+secondaryFieldName;}idString=this.parent.trimString(idString);if(idString.length===0||!this._shapeToRowIndexMap[idString.toLowerCase?idString.toLowerCase():idString]){console.log("skipping "+idString);continue;}if(!renderer){if(this.geoSecondaryRolePosition===-1||this.secondField.length===0){renderer=new esri.renderer.UniqueValueRenderer(defaultSymbol,me.esriField);}else{renderer=new esri.renderer.UniqueValueRenderer(defaultSymbol,me.esriField,this.secondField);renderer.fieldDelimiter=ATTRIBUTE_DELIMITER;}}if(dataLookup){rowIndex=dataLookup[idString.toLowerCase?idString.toLowerCase():idString].rowIndex;geometry=graphic.geometry;this.populateGraphicAttributes(dataLookup,attributes,idString);if(rowIndex!==undefined){colorString=me.getThresholdString(rowIndex,me.selectedMetricIndex,me.DEFAULT_COLOR,true);dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;if(geometry instanceof esri.geometry.Polyline){symbol=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,dojoColor,1);}else{if(geometry instanceof esri.geometry.Polygon){symbol=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,255,255,0.35]),1),dojoColor);}}if(this.geoSecondaryRolePosition===-1||this.secondField.length===0){renderer.addValue(esriGeoName,symbol);}else{renderer.addValue(esriGeoName+ATTRIBUTE_DELIMITER+secondaryFieldName,symbol);}attributes=formatAttribute.call(this,attributes,rowIndex);graphic.setInfoTemplate(infoTemplate);graphic.setSymbol(symbol);graphic.setAttributes(attributes);if(newExtent===null){newExtent=geometry.getExtent();}else{newExtent=newExtent.union(geometry.getExtent());}}else{console.log("Missing..."+geoName);}dataLabelsConfig.push({text:esriGeoName,rowIndex:rowIndex,mapPoint:this.getMapPoint(geometry.rings,geometry.spatialReference)});this.rowIndex2Graphics[rowIndex]=graphic;}}this.populateDataLabelMetricValues();me.polygonLayer.setRenderer(renderer);me.polygonLayer.redraw();me._extent=newExtent;me.parent.updateMapExtent();lastExtent=me.polygonLayer.lastExtent;if(!!lastExtent&&!!newExtent&&lastExtent.xmin===newExtent.xmin&&lastExtent.xmax===newExtent.xmax&&lastExtent.ymin===newExtent.ymin&&lastExtent.ymax===newExtent.ymax){me.polygonLayer.setVisibility(true);}me.polygonLayer.lastExtent=newExtent;map.graphics.enableMouseEvents();this.buildDataLabelLayer();},isIndexGeoPosition:function isIndexGeoPosition(index,geoColumnIndices){var i;if(!(geoColumnIndices instanceof Array)){return false;}if(index<0){return false;}var results=false;for(i=0;i<geoColumnIndices.length;i++){if(index==geoColumnIndices[i]){results=true;break;}}return results;},populateMinMax:function populateMinMax(metricColumnIndex){if(!this.minMaxMap){this.minMaxMap={};}if(this.minMaxMap.hasOwnProperty(metricColumnIndex)){return ;}var rowHeaders=this.data.ghs.rhs.items;var data=this.data.gvs.items?this.data.gvs.items:[];var rowIndex=0;var minValue=Infinity;var maxValue=-Infinity;for(rowIndex=0;rowIndex<data.length;rowIndex++){var values=data[rowIndex].items;var cell=values[metricColumnIndex];if(!cell){continue;}var type=cell.ty;if(!type||type===this.enumNumber){var cellNumber=parseFloat(!cell.rv?this.parent.stripNumberFormat(cell.v):cell.rv);maxValue=(cellNumber>maxValue)?cellNumber:maxValue;minValue=(cellNumber<minValue)?cellNumber:minValue;}}if(this.wpMapSizingStyle==="0"){this.minMaxMap[metricColumnIndex]={min:Math.min(Math.abs(minValue),Math.abs(maxValue)),max:Math.max(Math.abs(minValue),Math.abs(maxValue))};}else{this.minMaxMap[metricColumnIndex]={min:minValue,max:maxValue};}},processDrill:function processDrillRequest(){if(this.enablePolygon){this.performDrill(this.geoPosition);}if(this.enableMarker||this.enableDensity){this.performDrill(this.latIndex);}},getShapeAttributeGeoRole:function getShapeAttributeGeoRole(){var geoAttrID=this.dropZones.geoAttribute,gts=this.data.gts,form,geoRole,rowItem;if(!gts.row){return -1;}if(!!geoAttrID){for(var row=0;row<gts.row.length;row++){rowItem=gts.row[row];if(rowItem.id==geoAttrID){forms=rowItem.fs;for(index=0;index<forms.length;index++){form=forms[index];geoRole=form.fgr;if(geoRole!=$EnumGeographicRole.EnumGeographicRoleNone&&geoRole!=$EnumGeographicRole.EnumGeographicRoleLatitiude&&geoRole!=$EnumGeographicRole.EnumGeographicRoleLongitude){return geoRole;}}}}}else{for(row=0;row<gts.row.length;row++){rowItem=gts.row[row];forms=rowItem.fs;for(index=0;index<forms.length;index++){form=forms[index];geoRole=form.fgr;if(geoRole!=$EnumGeographicRole.EnumGeographicRoleNone&&geoRole!=$EnumGeographicRole.EnumGeographicRoleLatitiude&&geoRole!=$EnumGeographicRole.EnumGeographicRoleLongitude){return geoRole;}}return geoRole;}}return -1;},getSecondaryFieldRoleAttributeIndex:function getSecondaryFieldRoleAttributeIndex(){var gts=this.data.gts,form,geoRole,rowItem;if(!this.webmapConfig||!gts.row){return -1;}for(row=0;row<gts.row.length;row++){rowItem=gts.row[row];if(rowItem.otp!=12){continue;}forms=rowItem.fs;for(index=0;index<forms.length;index++){form=forms[index];geoRole=form.fgr;if(isNaN(geoRole)||parseInt(geoRole,10)<0||parseInt(geoRole,10)>parseInt($EnumGeographicRole.EnumGeographicRoleLastOne,10)){continue;}if(geoRole==this.webmapConfig.sfr){this.secondaryGeoElements=rowItem.es;return row;}}}console&&console.log("Secondary geo role attribute not found ");return -1;},initWebMapConfig:function initWebMapConfig(){var shapes=this.parent.getEsriConfig().shapes,vp=this.widgetProps,shape=null,i;if(!!vp.lid&&!!shapes){for(i=0;i<shapes.length;i++){if(shapes[i].id==vp.lid){shape=shapes[i];break;}}}else{if(!!shapes){var geoRole=this.getShapeAttributeGeoRole();if(geoRole==-1&&console&&console.log){console.log("Geo role not found in the GeoAttribute. Can not render area.");}for(i=0;i<shapes.length;i++){if(shapes[i].roleId==geoRole&&!!shapes[i]["default"]&&(shapes[i]["default"]+"").toLowerCase()=="true"){shape=shapes[i];break;}}}}if(!!shape){var layers=this.parent.getEsriConfig().layers;var layer=null;this.webmapConfig={};this.webmapConfig.qf=eval(shape.qf);this.webmapConfig.ea=shape.ea;this.webmapConfig.ml=null;this.webmapConfig.sf=shape.sf;this.webmapConfig.sfr=shape.sfr;for(i=0;i<layers.length;i++){if(shape.layerId==layers[i].id){this.webmapConfig.ml=verifyProtocol(layers[i].ml);break;}}}this.geoSecondaryRolePosition=this.getSecondaryFieldRoleAttributeIndex();if(mstrApp&&mstrApp.isVI&&this.geoSecondaryRolePosition==-1&&!!shape&&shape.roleId==$EnumGeographicRole.EnumGeographicRoleCounty){mstrmojo.toast(mstrmojo.desc(13835,"County names are not necessarily unique. Please add State as an attribute in the tooltip drop zone."),300000000,null,{id:this.parent.id,dom:this.parent.domNode,cssClass:"mapToastCss"});}},render:function renderGridLayer(createMode){this.parent.totalLayersRendered++;this.unrenderred=false;this.visible=true;if(this.primaryModel.getTotalRows()==0){this.parent.showMapLayer();if(console&&console.log){console.log("No rows returned for this dataset.");}this.parent.hideWait();return ;}if(this.enableMarker||this.enableDensity){this.initMarkerMap(createMode);if(this.postBuildRendering){this.postBuildRendering();}}else{if(this.enablePolygon){this.useCustomShape=this.isCustomShape();if(this.parent.useESRICloud&&this.useCustomShape){this.initCustomShape(createMode);}else{this.initPolygonMap(createMode);}}else{this.parent.showMapLayer();this.parent.hideWait();if(this.postBuildRendering){this.postBuildRendering();}}}},initCustomShape:function initCustomShape(createMode){if(!createMode){this.polygonLayer.show();this.showDataLabelLayer();this.parent.hideWait();return ;}var me=this,i;var rowAttributes=this.data.gts.row,numAttributes=rowAttributes.length;this.rowIndex2Graphics={};for(i=0;i<numAttributes;i++){var attribute=rowAttributes[i];if(this.dropZones.geoAttribute==attribute.id&&this.geoPosition<0){if(verifyGeoRole(attribute)){this.geoPosition=i;}}}var geoAttributeName,geoAttributeID;if(this.geoPosition<0){for(i=0;i<numAttributes;i++){var attribute=rowAttributes[i];if(this.dropZones.geoAttribute==attribute.id&&!!this.widgetProps.lid){if(verifyGeoRole(attribute,true)){this.geoPosition=i;}}if(this.geoPosition>=0){geoAttributeName=attribute.n;geoAttributeID=attribute.id;this.geoElements=this.data.ghs.rhs.items;break;}}}if(this.geoPosition<0){this.parent.hideWait();this.parent.updateMapExtent();if(console&&console.log){console.log("No Mappable attributes present on the report.");}return ;}var dataLookup=this.createLookup();this.polygonLayer=new esri.layers.GraphicsLayer();this.parent.esriMap.addLayer(this.polygonLayer);var params={taskId:"getESRIKMLConfig",shapeId:this.widgetProps.lid,queryField:Object.keys(dataLookup).join("\u001E").toLowerCase()};var callback={success:function(response){if(me.destroyed){return ;}me.parent.showMapLayer();me.buildCustomShapes(response);if(this.postBuildRendering){this.postBuildRendering();}},failure:function(response){me.parent.showMapLayer();me.parent.hideWait();mstrmojo.alert("KML file request failed! "+response.getResponseHeader("X-MSTR-TaskFailureMsg"));return ;}};var xhr=new mstrmojo.SimpleXHR({isTask:true,async:true});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callback,params);},buildCustomShapes:function buildCustomShapes(shapeDef){if(!this.polygonLayer){this.parent.hideWait();return ;}if(shapeDef.length<1){this.failToLoadPolygon("No custom kml shapes were fetched.");return ;}var i,coordArray,geometry,graphic,shapeItem,name,newExtent=null;this.esriField=this.data.gts.row[this.geoPosition].n;var infoTemplate=this.populateInfoTemplate(this.esriField);var dataLookup=this.createLookup(),colorString,dojoColor,symbol;var dataLabelsConfig=this.dataLabelsConfig=[];for(i=0;i<shapeDef.length;i++){coordArray=[];shapeItem=shapeDef[i];var attributes={};name=shapeItem.name;attributes[this.esriField]=name;this.populateGraphicAttributes(dataLookup,attributes,name);colorString=this.getThresholdString(attributes.rowIndex,this.selectedMetricIndex,this.DEFAULT_COLOR,true);dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;symbol=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,255,255,0.35]),1),dojoColor);if(shapeItem.type=="polygon"||shapeItem.type=="multiPolygon"){if(shapeItem.type=="polygon"){this.getCoordinateArr(shapeItem.data,coordArray);}else{var shapeData=shapeItem.data;for(var j=0;j<shapeData.length;j++){this.getCoordinateArr(shapeData[j],coordArray);}}geometry=new esri.geometry.Polygon(coordArray);graphic=new esri.Graphic(geometry,symbol,attributes,infoTemplate);graphic.isUpdated=true;this.polygonLayer.add(graphic);if(newExtent===null){newExtent=graphic.geometry.getExtent();}else{newExtent=newExtent.union(graphic.geometry.getExtent());}dataLabelsConfig.push({text:name,rowIndex:attributes.rowIndex,mapPoint:this.getMapPoint(coordArray,geometry.spatialReference)});this.rowIndex2Graphics[attributes.rowIndex]=graphic;}}this.populateDataLabelMetricValues();this.initShapeInteraction();this.parent.hideWait();var me=this,fnProceed=function(extent){me._extent=extent;me.parent.updateMapExtent();me.buildDataLabelLayer();};if(newExtent.spatialReference.equals(me.parent.esriMap.extent.spatialReference)){fnProceed(newExtent);}else{require(["esri/tasks/ProjectParameters"],function(ProjectParameters){var geometryService=new esri.tasks.GeometryService(me.parent.getProtocol()+"//tasks.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer"),prjParams=new ProjectParameters();prjParams.geometries=[newExtent,newExtent.getCenter()];prjParams.outSR=me.parent.esriMap.extent.spatialReference;geometryService.project(prjParams,function(outputs){fnProceed(outputs[0].centerAt(outputs[1]));},function(errorMsg){console.log(errorMsg);fnProceed(newExtent);});});}},populateInfoTemplate:function populateInfoTemplate(title,skipIndices){var skip=!!skipIndices?skipIndices:[];this.defaultInfoWindowHTML=this.getDefaultInfoWindowTemplate(skip);if(this.infoWindowHTML===""){this.infoWindowHTML=this.defaultInfoWindowHTML;}var infoTemplate=new esri.InfoTemplate();infoTemplate.setTitle("${"+title+"}");infoTemplate.setContent(this.infoWindowHTML);return infoTemplate;},populateGraphicAttributes:function populateGraphicAttributes(dataLookup,attributes,name){if(!!dataLookup){var rowIndex,dataRow,rowHeaders,rowCell,rowCellTitle,rowCellValue,thresholdType;name=name.toLowerCase?name.toLowerCase():name;rowIndex=attributes.rowIndex=dataLookup[name].rowIndex;attributes.geoIndex=dataLookup[name].geoIndex;attributes.columnIndices=[this.geoPosition];attributes.layerKey=this.k;if(rowIndex!==undefined){attributes=formatAttribute.call(this,attributes,rowIndex);if(this.data.gts.col.length===1&&this.data.gts.col[0].otp===-1){dataRow=this.data.gvs.items[rowIndex].items;rowHeaders=this.data.gts.col[0].es;for(var j=0;j<dataRow.length;j++){rowCell=dataRow[j];rowCellTitle=rowHeaders[j].n;rowCellValue=dataRow[j].v;thresholdType=dataRow[j].ty;if(!thresholdType||thresholdType==this.enumNumber){attributes[this.parent.replaceSpace(rowCellTitle)]=rowCellValue;}else{attributes[this.parent.replaceSpace(rowCellTitle)]=dataRow[j].rv;}}}}}},initShapeInteraction:function initShapeInteraction(){this.addPolygonListeners(this.polygonLayer);},addPolygonListeners:function addPolygonListeners(polygonLayer,useUpdateEnd){var me=this,map=this.parent.esriMap;this.viewerEventListeners.push(dojo.connect(map,"onClick",this,this.onMapClick));this.viewerEventListeners.push(dojo.connect(map.infoWindow,"onHide",this,this.onHideInfoWindow));this.viewerEventListeners.push(polygonLayer.on("mouse-move",function(evt){if(!me.enableSelect){var highlightGraphic=me.updatePolygonGraphicInfo(evt.graphic);if(!!highlightGraphic){me.handleMouseMoveEvent(evt);}}}));this.viewerEventListeners.push(polygonLayer.on("click",function(evt){me.handleClickEvent.call(me,evt);}));this.viewerEventListeners.push(polygonLayer.on("mouse-out",function(evt){if(!me.enableSelect){me.handleMouseOutEvent(evt);}}));this.viewerEventListeners.push(polygonLayer.on("mouse-up",function(evt){me.handleMouseUpEvent(evt);}));if(this.postBuildRendering&&!this.postBldRdrEvent){this.postBldRdrEvent=polygonLayer.on(useUpdateEnd?"update-end":"update",function(){me.postBldRdrEvent.remove();delete me.postBldRdrEvent;me.postBuildRendering();});}},getCoordinateArr:function getCoordinateArr(arr,coorArr){if(Array.isArray(arr)&&Array.isArray(arr[0])&&Array.isArray(arr[0][0])){for(var index=0;index<arr.length;index++){getCoordinateArr(arr[index],coorArr);}}else{if(Array.isArray(arr)&&Array.isArray(arr[0])){coorArr.push(arr);}else{if(Array.isArray(arr)){coorArr.push([arr]);}else{}}}},isCustomShape:function isCustomShape(){var shapes=this.parent.getEsriConfig().shapes,props=this.widgetProps,shapeId,shape,geoRole;if(!!props){shapeId=props.lid;}if(!!shapeId){shape=propHelper.getMatchingShape(shapes,shapeId,null);}else{geoRole=this.getShapeAttributeGeoRole();shape=propHelper.getMatchingShape(shapes,null,geoRole==-1?null:geoRole);}if(!!shape&&shape.custom&&shape.custom==true){if(!shapeId){props.lid=shape.id;}return true;}return false;},resolveCustomizedInfoWindow:function resolveCustomizedInfoWindow(attributes){var input=this.infoWindowHTML;var result="";var baseIndex=0;var startIndex=input.indexOf("${",baseIndex);var endIndex=input.indexOf("}",startIndex+1);var macroName;var transformedMacroName;var replaceValue;while(startIndex>=0&&endIndex>startIndex){macroName=input.substring(startIndex+2,endIndex);var colonIndex=macroName.indexOf(":");if(colonIndex>=0){transformedMacroName=macroName.substring(0,colonIndex)+" "+macroName.substring(colonIndex+1);}else{transformedMacroName=macroName;}transformedMacroName=this.parent.replaceSpace(transformedMacroName);if(attributes.hasOwnProperty(transformedMacroName)){result+=input.substring(baseIndex,startIndex)+attributes[transformedMacroName];}else{result+=input.substring(baseIndex,endIndex+1);}baseIndex=endIndex+1;startIndex=input.indexOf("${",baseIndex);endIndex=input.indexOf("}",startIndex+1);}result+=input.substring(baseIndex,input.length);return result;},retrieveDataRows:function retrieveDataRows(sliceInfo){var dataRows=[],i,k,geoElementIndices,longGeoElementIndices,geoElementCount,pos,longPos,elementDataRows,geoElemIdx,longGeoElemIdx,generatedGeoElementIndices={};if(sliceInfo){geoElementIndices=sliceInfo.elementIndex;geoElementCount=geoElementIndices.length;longGeoElementIndices=sliceInfo.longElementIndex;pos=parseInt(sliceInfo.pos[0],10);longPos=parseInt(sliceInfo.pos[1],10);for(i=0;i<geoElementCount;i++){if(generatedGeoElementIndices.hasOwnProperty(geoElementIndices[i])){continue;}generatedGeoElementIndices[geoElementIndices[i]]=geoElementIndices[i];geoElemIdx=parseInt(geoElementIndices[i],10);longGeoElemIdx=parseInt(longGeoElementIndices[i],10);elementDataRows=[];if(!this.viewCache){this.viewCache={};}if(this.viewCache[pos]===undefined||this.viewCache[pos]===null){this.viewCache[pos]={};}if(this.viewCache[pos]&&this.viewCache[pos][geoElemIdx+"#"+longGeoElemIdx]){elementDataRows=this.viewCache[pos][geoElemIdx+"#"+longGeoElemIdx];}else{var rowHeaders=this.data.ghs.rhs.items;var numRows=rowHeaders.length;for(k=0;k<numRows;k++){var rowHeader=rowHeaders[k].items;var cellHeader=rowHeader[pos];var longCellHeader=rowHeader[longPos];if(cellHeader&&cellHeader.idx==geoElemIdx&&longCellHeader&&longCellHeader.idx==longGeoElemIdx){if(!!sliceInfo.sfv&&sliceInfo.sfv!=this.getElementValue(k,this.geoSecondaryRolePosition)){continue;}elementDataRows.push(k);}}this.viewCache[pos][geoElemIdx+"#"+longGeoElemIdx]=elementDataRows;}dataRows=dataRows.concat(elementDataRows);}}return dataRows;},onInfoWindowRendered:function onInfoWindowRendered(evt,pt,ifw){var map=this.parent.esriMap,id=evt.id,w=mstrmojo.all[id],title=getInfoWindowTitle(w),newDiv=this.generateSelectorControlInfoWindowContent(w);ifw.setContent(newDiv);ifw.setTitle(title);ifw.show(pt,map.getInfoWindowAnchor(pt));ifw.resize(newDiv.clientWidth,newDiv.clientHeight);},showInfoWindow:function showInfoWindow(evt,locationObject){if(!this.parent.enablePopup){return ;}var map=this.parent.esriMap,ifw=map.infoWindow;var geoIndices,evtGraphic,columnIndices,infoWindowContent,columnIndex,highlightedGraphics,highlightSymbol,div,content,title="",highlightGraphic,p,dataRows,sliceInfo,secondaryFieldValue=null,longGeoIndices=null;if(!ifw.defaultWidth){ifw.defaultWidth=ifw.domNode.firstChild.scrollWidth||MIN_INFO_WINDOW_WIDTH;}if(!ifw.defaultHeight){ifw.defaultHeight=ifw.domNode.firstChild.scrollHeight||MIN_INFO_WINDOW_HEIGHT;}$CSS.removeClass(ifw.domNode,"mstrmojo-ESRIMap");if(!this.enableDensity){evtGraphic=evt.graphic;columnIndices=evtGraphic.attributes.columnIndices;if(isTextGraphic(evtGraphic)||isClusteredGraphic(evtGraphic)){geoIndices=evtGraphic.attributes.geoIndices;if(evtGraphic.attributes.longGeoIndices){longGeoIndices=evtGraphic.attributes.longGeoIndices;}}else{geoIndices=[evtGraphic.attributes.geoIndex];longGeoIndices=[evtGraphic.attributes.longGeoIndex];}if(this.enablePolygon){var wc,sf;wc=this.getMapConfigVal();sf=wc&&this.parent.trimString(wc.sf);if(this.geoSecondaryRolePosition!=-1&&sf&&sf.length>0){secondaryFieldValue=evtGraphic.attributes[sf]||evtGraphic.attributes[sf.toLowerCase()]||evtGraphic.attributes[sf.toUpperCase()];}longGeoIndices=geoIndices;if(columnIndices.length==1){columnIndices.push(columnIndices[0]);}}this.highlightGraphic(evtGraphic);}else{columnIndices=locationObject.attributes.columnIndices;geoIndices=[locationObject.attributes.geoIndex];if(locationObject.attributes.longGeoIndex){longGeoIndices=[locationObject.attributes.longGeoIndex];}}sliceInfo={pos:columnIndices,elementIndex:geoIndices,longElementIndex:longGeoIndices,setViewDataFlag:false,applyControl:false,sfv:secondaryFieldValue};dataRows=this.retrieveDataRows(sliceInfo);p=evt.screenPoint;if(this.infoWindowHTML!==undefined&&(this.infoWindowHTML!=""&&this.infoWindowHTML!=this.defaultInfoWindowHTML)){if(!!evtGraphic){content=this.resolveCustomizedInfoWindow(evtGraphic.attributes);}else{content=this.resolveCustomizedInfoWindow(locationObject.attributes);}}else{if(dataRows.length==1){if(!!evtGraphic){if(evtGraphic.infoTemplate&&evtGraphic.infoTemplate.content){content=evtGraphic.getContent();}else{content=this.resolveCustomizedInfoWindow(evtGraphic.attributes);}}else{content=this.resolveCustomizedInfoWindow(locationObject.attributes);}}else{if(this.infoWindowUseGrid){content=this.parent.infoTabDiv.cloneNode(true);this.createGridInfoWindow(content,dataRows,columnIndices);div=content;}else{content='<div id="chartDiv" style="width: 300px; height: 150px;" />';}}}if(!!content.innerHTML){ifw.setContent(content.innerHTML);}else{ifw.setContent(content);}ifw.setTitle();ifw.show(p,map.getInfoWindowAnchor(p));infoWindowContent=document.getElementById(getInfoWindowId.call(this));if(infoWindowContent){ifw.resize(ifw.defaultWidth,ifw.defaultHeight);ifw.resize(Math.min(MAX_INFO_WINDOW_WIDTH,Math.max(MIN_INFO_WINDOW_WIDTH,infoWindowContent.scrollWidth+CONTENT_WIDTH_PADDING)),Math.min(MAX_INFO_WINDOW_HEIGHT,Math.max(MIN_INFO_WINDOW_HEIGHT,infoWindowContent.scrollHeight+CONTENT_HEIGHT_PADDING)));}},handlePanelStackInfoWindow:function handlePanelStackInfoWindow(evtGraphic,locationObject,screenPos){if(!this.parent.enablePopup){return ;}var map=this.parent,ifw=map.esriMap.infoWindow,me=this,columnIndex,sc,ifws,attributes;if(evtGraphic.isSelected===false){ifw.hide();map.set("infoWindowVisible",false);this.infoWindowVisible=false;return ;}map.set("infoWindowVisible",true);this.infoWindowVisible=true;if(!ifw.defaultWidth){ifw.defaultWidth=ifw.domNode.firstChild.scrollWidth||MIN_INFO_WINDOW_WIDTH;}if(!ifw.defaultHeight){ifw.defaultHeight=ifw.domNode.firstChild.scrollHeight||MIN_INFO_WINDOW_HEIGHT;}columnIndex=this.getGeoColumnIndex();sc=this.primaryModel.getRowTitles().getTitle(columnIndex).getSelectorControl();ifws=$MDV.findPanelStackAsInfoWindowSelectorTarget(sc);if(ifws){attributes=(!this.enableDensity)?evtGraphic.attributes:locationObject.attributes;$CSS.addClass(ifw.domNode,"mstrmojo-ESRIMap");$MDV.showPanelStackInfoWindows(me,ifws,sc,columnIndex,attributes.rowIndex,function(e){me.onInfoWindowRendered(e,screenPos,ifw);});}},getTooltipContent:function getTooltipContent(evtGraphic,locationObject){var geoIndices,columnIndices,div,content,dataRows,sliceInfo,secondaryFieldValue=null,longGeoIndices=null;if(!this.enableDensity){columnIndices=evtGraphic.attributes.columnIndices;if(isTextGraphic(evtGraphic)||isClusteredGraphic(evtGraphic)){geoIndices=evtGraphic.attributes.geoIndices;if(evtGraphic.attributes.longGeoIndices){longGeoIndices=evtGraphic.attributes.longGeoIndices;}}else{geoIndices=[evtGraphic.attributes.geoIndex];longGeoIndices=[evtGraphic.attributes.longGeoIndex];}if(this.enablePolygon){var wc,sf;wc=this.getMapConfigVal();sf=wc&&this.parent.trimString(wc.sf);if(this.geoSecondaryRolePosition!==-1&&sf&&sf.length>0){secondaryFieldValue=evtGraphic.attributes[sf]||evtGraphic.attributes[sf.toLowerCase()]||evtGraphic.attributes[sf.toUpperCase()];}longGeoIndices=geoIndices;if(columnIndices&&columnIndices.length===1){columnIndices.push(columnIndices[0]);}}}else{columnIndices=locationObject.attributes.columnIndices;geoIndices=[locationObject.attributes.geoIndex];if(locationObject.attributes.longGeoIndex!==undefined){longGeoIndices=[locationObject.attributes.longGeoIndex];}}if(columnIndices==undefined){return ;}sliceInfo={pos:columnIndices,elementIndex:geoIndices,longElementIndex:longGeoIndices,setViewDataFlag:false,applyControl:false,sfv:secondaryFieldValue};dataRows=this.retrieveDataRows(sliceInfo);if(this.infoWindowHTML!==undefined&&(this.infoWindowHTML!==""&&this.infoWindowHTML!==this.defaultInfoWindowHTML)){if(!!evtGraphic){content=this.resolveCustomizedInfoWindow(evtGraphic.attributes);}else{content=this.resolveCustomizedInfoWindow(locationObject.attributes);}}else{if(dataRows.length===1){if(!!evtGraphic){if(evtGraphic.infoTemplate&&evtGraphic.infoTemplate.content){content=evtGraphic.getContent();}else{content=this.resolveCustomizedInfoWindow(evtGraphic.attributes);}}else{content=this.resolveCustomizedInfoWindow(locationObject.attributes);}}else{if(dataRows.length>1){content=this.parent.infoTabDiv.cloneNode(true);this.createGridInfoWindow(content,dataRows,columnIndices);content=content.innerHTML;}else{content='<div id="chartDiv" style="width: 300px; height: 150px;" />';}}}return content;},showTooltip:function showTooltip(evt,locationObject){if(!this.parent.enablePopup||!evt){return ;}if(!evt.graphic&&!locationObject){return ;}var tooltipWin=this.tooltipWin,TOOLTIP_DOM=tooltipWin.domNode,tooltipContent;if(this.previousTooltip===(locationObject||evt.graphic)){tooltipWin.moveTo(evt.pageX,evt.pageY);return ;}if(!this.enableDensity){this.highlightGraphic(evt.graphic);this.previousTooltip=evt.graphic;}else{this.previousTooltip=locationObject;}if(!TOOLTIP_DOM.parentNode){document.body.appendChild(TOOLTIP_DOM);}tooltipContent=this.getTooltipContent(evt.graphic,locationObject);if(tooltipContent==undefined){return ;}TOOLTIP_DOM.innerHTML=tooltipContent;tooltipWin.moveTo(evt.pageX,evt.pageY);tooltipWin.toggle(true);this.infoWindowVisible=true;},onHideInfoWindow:function onHideInfoWindow(){},removePolygonLayer:function removePolygonLayer(){var me=this,map=this.parent.esriMap,layerId,layer,shouldReuseLayer=false;if(!!this.polygonLayer){if(!!map.graphics){map.graphics.clear();}layerId=this.polygonLayer.id;if(!!layerId){layer=map.getLayer(layerId);if(!!layer){if(!!layer.getNode()){dojo.map(me.parent.operationalLayers,function(operationalLayer,index){if(operationalLayer.layerObject===layer){shouldReuseLayer=true;}});if(shouldReuseLayer){layer.hide();}else{map.removeLayer(layer);this.polygonLayer=null;}}else{layer.on("update-end",function(evt){if(!!layerId&&!!map.getLayer(layerId)){map.removeLayer(map.getLayer(layerId));me.polygonLayer=null;}var layerIds=map.graphicsLayerIds,layer;for(var i=2;i<layerIds.length;i++){layer=map.getLayer(layerIds[i]);if(!!layer.getNode()&&layerIds[i]!="drawingLayer"){map.removeLayer(layer);}}});}}}}},getAllGraphics:function getAllGraphics(){if(this.enableMarker&&this.markerLayer){return this.markerLayer.graphics;}if(this.enablePolygon&&this.polygonLayer){return this.polygonLayer.graphics;}},updatePolygonGraphicInfo:function updatePolygonGraphicInfo(graphic){if(graphic.isUpdated){return graphic;}var mappedValue=this.getMapConfigVal(),infoTemplate=this.populateInfoTemplate((this.parent.replaceSpace(mappedValue.ea)).toUpperCase()),dataLookup=this._shapeToRowIndexMap,attributes=graphic.attributes,esriGeoName=attributes[this.esriField]||attributes[this.esriField=this.esriField.toLowerCase()]||attributes[this.esriField=this.esriField.toUpperCase()],secondaryFieldName,idString,colorString,dojoColor,symbol,rowIndex;idString=this.convertedNameMap[esriGeoName]?this.convertedNameMap[esriGeoName]:esriGeoName;if(!idString){this.failToLoadPolygon("Warning: "+this.esriField+" not found in featureSet from ESRI server! Please ensure the field "+this.esriField+" is present in FeatureLayer specified by  <ml> value in esriConfig.xml");return ;}var sf=this.parent.trimString(mappedValue.sf);if(this.geoSecondaryRolePosition!=-1&&sf&&sf.length>0){secondaryFieldName=attributes[sf]||attributes[mappedValue.sf=sf.toLowerCase()]||attributes[mappedValue.sf=sf.toUpperCase()];idString+=ATTRIBUTE_DELIMITER+secondaryFieldName;}idString=this.parent.trimString(idString);if(idString.length==0||!this._shapeToRowIndexMap[idString.toLowerCase?idString.toLowerCase():idString]){console.log("skipping "+idString);return ;}if(dataLookup){rowIndex=dataLookup[idString.toLowerCase?idString.toLowerCase():idString].rowIndex;this.populateGraphicAttributes(dataLookup,attributes,idString);if(rowIndex!==undefined){colorString=this.getThresholdString(rowIndex,this.selectedMetricIndex,this.DEFAULT_COLOR,true);dojoColor=new dojo.Color(colorString);dojoColor.a=0.75;if(graphic.geometry instanceof esri.geometry.Polyline){symbol=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,dojoColor,1);}else{if(graphic.geometry instanceof esri.geometry.Polygon){symbol=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,255,255,0.35]),1),dojoColor);}}attributes=formatAttribute.call(this,attributes,rowIndex);graphic.setInfoTemplate(infoTemplate);graphic.setSymbol(symbol);graphic.setAttributes(attributes);graphic.isUpdated=true;}else{console.log("Missing..."+idString);}}return graphic;},highlightGraphic:function highlightGraphic(graphic){var symbol,shape,labelGraphic,width,height,isSlice;if(graphic.symbol instanceof esri.symbol.TextSymbol){graphic=graphic.refGraphic;}if(graphic.isPieCluster){this.highlightPieClusters(graphic);return ;}symbol=graphic.symbol;if(graphic.geometry instanceof esri.geometry.Polyline){symbol.width=5;graphic.setSymbol(symbol);}else{if(symbol instanceof esri.symbol.PictureMarkerSymbol){if(graphic.isSelected&&!graphic.isSelectionItem){shape=graphic.getShape();if(shape){shape.moveToFront();}labelGraphic=graphic.labelGraphic;if(labelGraphic&&labelGraphic.getShape()){labelGraphic.getShape().moveToFront();}graphic.isSelectionItem=true;}if(!!graphic.isHighlighted){return ;}width=symbol.width;height=symbol.height;symbol.originalWidth=width;symbol.originalHeight=height;symbol.width=width+15;symbol.height=height+15;graphic.setSymbol(symbol);}else{if(!!symbol){isSlice=graphic.isSlice;if(!isSlice&&graphic.geometry instanceof esri.geometry.Polygon){symbol.setOutline(this.parent.selectionStrokePolygon);}else{if(graphic.isSelected&&!graphic.isSelectionItem){if(symbol.style===esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND){symbol.setSize(32);}else{if(!!symbol.setOutline){symbol.setOutline(this.parent.selectionStroke);}}shape=graphic.getShape();if(!isSlice&&shape){shape.moveToFront();}}}if(graphic.isHover){symbol.color.a=0.4;}graphic.setSymbol(symbol);}}}graphic.isHighlighted=true;if(graphic.isSelected){graphic.isSelectionItem=true;}},highlightPieClusters:function highlightPieClusters(graphic){var symbol,shape,sliceGraphics=graphic.sliceGraphics,sliceGraphic,labelGraphic=graphic.labelGraphic,flag=graphic.isSelected&&!graphic.isSelectionItem,i,il=sliceGraphics.length;for(i=0;i<il;i++){sliceGraphic=sliceGraphics[i];symbol=sliceGraphic.symbol;if(flag){symbol.setOutline(this.parent.selectionStroke);shape=sliceGraphic.getShape();if(shape){shape.moveToFront();}sliceGraphic.isSelected=true;sliceGraphic.isSelectionItem=true;}symbol.color.a=0.4;sliceGraphic.setSymbol(symbol);sliceGraphic.isHighlighted=true;}if(flag){shape=graphic.getShape();if(shape){shape.moveToFront();}if(labelGraphic&&labelGraphic.getShape()){labelGraphic.getShape().moveToFront();}graphic.isSelectionItem=true;}graphic.isHighlighted=true;},clearHighlight:function clearHighlight(graphic){var symbol,width,height;if(graphic.symbol instanceof esri.symbol.TextSymbol){graphic=graphic.refGraphic;}if(graphic.isPieCluster){this.clearHighlightPieClusters(graphic);return ;}symbol=graphic.symbol;if(!symbol){return ;}if(graphic.geometry instanceof esri.geometry.Polyline){symbol.width=1;}else{if(symbol instanceof esri.symbol.PictureMarkerSymbol){if(!!graphic.isSelected){return ;}width=symbol.width;height=symbol.height;symbol.width=symbol.hasOwnProperty("originalWidth")?symbol.originalWidth:width;symbol.height=symbol.hasOwnProperty("originalHeight")?symbol.originalHeight:height;}else{if(!!symbol){if(!graphic.isSelected){if(symbol.style===esri.symbol.SimpleMarkerSymbol.STYLE_DIAMOND){symbol.setSize(16);}else{if(!!symbol.setOutline){symbol.setOutline(this.parent.regularStroke);}}if(graphic.isSlice){graphic.refGraphic.isSelected=false;graphic.refGraphic.isSelectionItem=false;graphic.refGraphic.isHighlighted=false;}}symbol.color.a=0.75;}}}graphic.setSymbol(symbol);graphic.isHighlighted=false;if(!graphic.isSelected){graphic.isSelectionItem=false;}},clearHighlightPieClusters:function clearHighlightPieClusters(graphic){var sliceGraphics=graphic.sliceGraphics,flag=!graphic.isSelected&&graphic.isSelectionItem,sliceGraphic,symbol,i,il=sliceGraphics.length;for(i=0;i<il;i++){sliceGraphic=sliceGraphics[i];symbol=sliceGraphic.symbol;if(flag){symbol.setOutline(this.parent.regularStroke);sliceGraphic.isSelected=false;sliceGraphic.isSelectionItem=false;}symbol.color.a=0.75;sliceGraphic.setSymbol(symbol);sliceGraphic.isHighlighted=false;}if(flag){graphic.isSelectionItem=false;}graphic.isHighlighted=false;},setInfoWindowHTML:function setInfoWindowHTML(value){this.infoWindowHTML=value;this.widgetProps.iwd=escape(this.replaceInfoWindowHTMLMacros());},parseInfoWindowHTML:function parseInfoWindowHTML(){var input=this.infoWindowHTML,result="",baseIndex=0,startIndex=input.indexOf("${",baseIndex),endIndex=input.indexOf("}",startIndex+1),macroName,transformedMacroName,dataIDNameTable={},rows=this.data.gts.row,cols=this.data.gts.col,index,row,col,es,colElement,j;for(index=0;index<rows.length;index++){row=rows[index];dataIDNameTable[row.id+"|"+row.fid]=row.n;}for(index=0;index<cols.length;index++){col=cols[index];if(col.otp===-1){es=col.es;for(j=0;j<es.length;j++){colElement=es[j];dataIDNameTable[colElement.id]=colElement.n;}break;}}while(startIndex>=0&&endIndex>startIndex){macroName=input.substring(startIndex+2,endIndex);if(dataIDNameTable.hasOwnProperty(macroName)){result+=input.substring(baseIndex,startIndex+2)+dataIDNameTable[macroName];}else{result+=input.substring(baseIndex,endIndex);}baseIndex=endIndex;startIndex=input.indexOf("${",baseIndex);endIndex=input.indexOf("}",startIndex+1);}result+=input.substring(baseIndex);this.infoWindowHTML=result;},replaceInfoWindowHTMLMacros:function replaceInfoWindowHTMLMacros(){var input=this.infoWindowHTML,result="",baseIndex=0,startIndex=input.indexOf("${",baseIndex),endIndex=input.indexOf("}",startIndex+1),macroName,transformedMacroName,dataNameIDTable={},rows=this.data.gts.row,cols=this.data.gts.col,row,col,index,es,colElement,j;for(index=0;index<rows.length;index++){row=rows[index];dataNameIDTable[this.parent.replaceSpace(row.n)]=row.id+"|"+row.fid;}for(index=0;index<cols.length;index++){col=cols[index];if(col.otp===-1){es=col.es;for(j=0;j<es.length;j++){colElement=es[j];dataNameIDTable[this.parent.replaceSpace(colElement.n)]=colElement.id;}break;}}while(startIndex>=0&&endIndex>startIndex){macroName=input.substring(startIndex+2,endIndex);var colonIndex=macroName.indexOf(":");if(colonIndex>=0){macroName=macroName.substring(0,colonIndex)+" "+macroName.substring(colonIndex+1);}macroName=this.parent.replaceSpace(macroName);if(dataNameIDTable.hasOwnProperty(macroName)){result+=input.substring(baseIndex,startIndex+2)+dataNameIDTable[macroName];}else{result+=input.substring(baseIndex,endIndex);}baseIndex=endIndex;startIndex=input.indexOf("${",baseIndex);endIndex=input.indexOf("}",startIndex+1);}result+=input.substring(baseIndex);return result;},isWebMercator:function(spatialReference){var wkid=spatialReference.wkid;return wkid===102100||wkid===102113||wkid===3857||wkid===3785;},getExtentForSingleMarker:function getExtentForSingleMarker(latitude,longitude){latitude=parseFloat(latitude);longitude=parseFloat(longitude);var minLat,maxLat,minLon,maxLon,parent=this.parent,pntSpaRef=parent.esriMap.spatialReference,deltaDegree=10;minLat=Math.max(latitude-deltaDegree,MIN_LATITUDE+0.1);maxLat=Math.min(latitude+deltaDegree,MAX_LATITUDE-0.1);minLon=longitude-deltaDegree;maxLon=longitude+deltaDegree;var bottomLeft=new esri.geometry.Point(minLon,minLat,pntSpaRef);var topRight=new esri.geometry.Point(maxLon,maxLat,pntSpaRef);if(this.isWebMercator(pntSpaRef)){bottomLeft=esri.geometry.geographicToWebMercator(bottomLeft);topRight=esri.geometry.geographicToWebMercator(topRight);}var points=new esri.geometry.Multipoint(pntSpaRef);points.addPoint(bottomLeft);points.addPoint(topRight);return points.getExtent();},unrender:function unrender(deepClean){if(this.unrenderred){return ;}this.parent.totalLayersRendered--;if(this._super){this._super();}var map=this.parent.esriMap,layerId,listeners=this.viewerEventListeners;if(!!this.densityLayer){this.cleanDensityMap();delete this.densityLocations;}this.clearAllHighlight();if(this.infoWindowVisible){this.hideInfoWindow();}this.rowIndex2Graphics=null;if(deepClean){if(!!this.markerLayer){layerId=this.markerLayer.id;if(!!layerId&&!!map.getLayer(layerId)){map.removeLayer(map.getLayer(layerId));}this.markerLayer=null;}this.removePolygonLayer();this.removeDataLabelLayer();if(this.markerLayerWrapper){this.markerLayerWrapper.destroy();this.markerLayerWrapper=null;}this.parent.removeEventListeners(listeners);if(this.parent.drawingLayer){this.parent.drawingLayer.clear();}this.unrenderred=true;}else{if(this.enableMarker){this.markerLayer.hide();}if(this.enableDensity){this.densityLayer.hideLayer();}if(this.enablePolygon){this.polygonLayer.hide();}this.hideDataLabelLayer();this.visible=false;}if(this.currentSelections){this.currentSelections={};}if(this.selectedRowIndices){this.selectedRowIndices={};}if(this.highlightedGraphics){this.highlightedGraphics={};}},destroy:function destroy(deepClean){if(this.unrenderred){return ;}this.unrender(deepClean);var disposables=this.parent.disposables;for(var i=0,il=disposables.length;i<il;i++){if(this===disposables[i]){delete disposables[i];disposables.splice(i,1);break;}}this._super(deepClean);},supportDataLabel:function(){return this.enablePolygon||this.enableMarker;},isMarkerMap:function(){return this.enableMarker;},getMapPoint:function(points,spatialReference){var position=this.getCentroidOfPolygon(points);return new esri.geometry.Point(position[0],position[1],spatialReference);},createDataLavelLayer:function(){if(!this.dataLabelLayer){this.dataLabelLayer=new esri.layers.GraphicsLayer({id:"DataLabel"});this.parent.esriMap.addLayer(this.dataLabelLayer);}},removeDataLabelLayer:function(){if(this.dataLabelLayer){var map=this.parent.esriMap;map.removeLayer(map.getLayer(this.dataLabelLayer.id));this.dataLabelLayer.clear();this.dataLabelLayer=null;}},clearDataLabelLayer:function(){if(this.dataLabelLayer){this.dataLabelLayer.clear();}},showDataLabelLayer:function(){if(this.dataLabelLayer){this.dataLabelLayer.show();}},hideDataLabelLayer:function(){if(this.dataLabelLayer){this.dataLabelLayer.hide();}},initParas:function(){this._super();var mapPoint,eastLngPoint,westLngPoint,geoScreenRange,parent=this.parent,screenWidth=this.screenWidth,screenHeight=this.screenHeight,mapExtent=parent.esriMap.extent,baseMapSpatialReference=parent.esriMap.spatialReference,isWebMercator=this.isWebMercator(baseMapSpatialReference),geometry=esri.geometry,Point=geometry.Point,eastLng180=isWebMercator?geometry.lngLatToXY(180,0):[180,0],westLng180=isWebMercator?geometry.lngLatToXY(-180,0):[-180,0];mapPoint=new Point(eastLng180[0],eastLng180[1],baseMapSpatialReference);eastLngPoint=geometry.toScreenPoint(mapExtent,screenWidth,screenHeight,mapPoint);mapPoint=new Point(westLng180[0],westLng180[1],baseMapSpatialReference);westLngPoint=geometry.toScreenPoint(mapExtent,screenWidth,screenHeight,mapPoint);geoScreenRange=Math.abs(eastLngPoint.x-westLngPoint.x);this.esriMapExtent=mapExtent;this.intsecXmin=geoScreenRange<screenWidth?(screenWidth-geoScreenRange)/2:0;this.intsecXmax=geoScreenRange<screenWidth?(screenWidth+geoScreenRange)/2:screenWidth;this.geoScreenRange=geoScreenRange;},updateScreenPoint:function(pointsConfig){var i,screenPoint,config,screenWidth=this.screenWidth,screenHeight=this.screenHeight,mapExtent=this.esriMapExtent,geometry=esri.geometry,n=(pointsConfig&&pointsConfig.length)||0;for(i=0;i<n;i++){config=pointsConfig[i];screenPoint=geometry.toScreenPoint(mapExtent,screenWidth,screenHeight,config.mapPoint);this.parseScreenPoint(screenPoint);config.screenPoint=screenPoint;}},parseScreenPoint:function(screenPoint){var xCoord=screenPoint.x,intsecXmin=this.intsecXmin,intsecXmax=this.intsecXmax,geoScreenRange=this.geoScreenRange;if(xCoord>=intsecXmin&&xCoord<=intsecXmax){return ;}xCoord=screenPoint.x%geoScreenRange;while(xCoord<intsecXmin){xCoord+=geoScreenRange;}if(xCoord>=intsecXmin&&xCoord<=intsecXmax){screenPoint.x=xCoord;}},drawDataLabels:function(labels,mapPoint){var k,textSymbol,labelPointGraphic,label,font=this.dlFont,color=this.dlFontStyle.color,m=labels.length,dataLabelLayer=this.dataLabelLayer,Graphic=esri.Graphic,TextSymbol=esri.symbol.TextSymbol;for(k=0;k<m;k++){label=labels[k];textSymbol=new TextSymbol(label.label,font,color);textSymbol.setOffset(label.xOffset,label.yOffset);labelPointGraphic=new Graphic(mapPoint,textSymbol);dataLabelLayer.add(labelPointGraphic);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisBase","mstrmojo.array","mstrmojo.gmaps.MapLegend","mstrmojo.VisEnum","mstrmojo.gmaps.MapEnums","mstrmojo.vi.viz.EnumDSSDropZones");var M=mstrmojo.array,L=mstrmojo.VisEnum,c=L.GMLegendDataType,d=L.MAPS_PROPERTIES,I=mstrmojo.gmaps.MapLegend,W=mstrmojo.vi.viz.EnumDSSDropZones,Z=mstrmojo.gmaps.EnumDataLabel,S=new RegExp(".{32}","g");var F={dlShw:[0],dlShwAll:[false],dlFntFml:["Arial"],dlFntSz:["8pt"],dlFntStyle:[0],dlFntClr:[0]};function a(f,g){var h=g.gsi||{},e=[];if(f){M.forEach((h.rows||[]).concat(h.cols||[]),function(k){if(k.did===f){e=[{id:f,t:k.t}];return false;}});if(!e.length){M.forEach(h.mx||[],function(k){if(k.did===f){e=[{id:f,t:4}];return false;}});}}return e;}function Y(e){var f=this.getData();if(!e||!f.k||f.k===e){return f;}else{return(!!f.sdp?f.sdp[e]:{});}}function J(e){return Y.call(this,e).dz;}function R(e){var f=this.getData();if(!e||!f.k||f.k===e){return f.vp;}else{return(!!f.vp&&!!f.vp.sgProps?f.vp.sgProps[e]:{});}}function X(e){if(!!e&&e.length>0){return e[0].id;}return null;}function H(f){if(!!f&&f.length>0){var k=f.length,h,e=[],g;for(g=0;g<k;g++){h=f[g];e.push(h.id);}return e;}return null;}mstrmojo.VisMapBase=mstrmojo.declare(mstrmojo.VisBase,null,{scriptClass:"mstrmojo.VisMapBase",vpNameMappings:{ga:"ma",lat:"lat",lng:"lng",atf:"atf",mtp:"mtp"},canOnlyDragOnTitleBar:true,observableModel:null,getDropZoneItems:function C(m,n){var o=Y.call(this,n),h=this.vpNameMappings,y=J.call(this,n),g=R.call(this,n),f=[];switch(m){case W.GeoAttribute:if(y&&y.Geo){f=y.Geo.TemplateUnit||[];}else{var s={MARKER:"1",BUBBLE:"2",AREA:"3",DENSITY:"4"},l=(!!g&&g[h.mtp]===s.AREA&&g[h.atf])?g[h.atf]:(!!g&&g[h.ga]);f=a.call(this,l,o);}break;case W.Latitude:if(y&&y.Lat){f=y.Lat.TemplateUnit||[];}else{var x=!!g&&g[h.lat],u=a.call(this,x,o);if(x){f=u.length?u:[{id:x,t:21}];}}break;case W.Longitude:if(y&&y.Long){f=y.Long.TemplateUnit||[];}else{var p=!!g&&g[h.lng],w=a.call(this,p,o);if(p){f=w.length?w:[{id:p,t:21}];}}break;case W.Angle:if(y&&y.AngleBy){f=y.AngleBy.TemplateMetric||[];}else{f=a.call(this,!!g&&g.amt,o);}break;case W.ColorBy:if(y&&y.ColorBy){f=y.ColorBy.TemplateMetric||[];}else{f=a.call(this,!!g&&g.cmt,o);}break;case W.SizeBy:if(y&&y.SizeBy){f=y.SizeBy.TemplateMetric||[];}else{f=a.call(this,!!g&&g.smt,o);}break;case W.AdditionalMetrics:var q=y&&y.AdditionalMetrics;if(q){f=(q.TemplateMetric||[]).concat(q.TemplateUnit||[]).sort(function(r,k){return r.idx-k.idx;});}else{var t=this;var e=!!g&&g.tooltip;e=e?e.match(S):[];M.forEach(e,function(r){var k=a.call(t,r,o);if(k.length){f=f.concat(k);}});}break;}M.forEach(f,function(k){if(!k.did){k.did=k.id;}});return f;},getDropZones:function T(l){var h={};var n=this.getDropZoneItems(W.GeoAttribute,l);h.geoAttribute=X(n);var g=this.getDropZoneItems(W.Latitude,l);h.latitude=X(g);var m=this.getDropZoneItems(W.Longitude,l);h.longitude=X(m);var e=this.getDropZoneItems(W.Angle,l);h.angle=X(e);var o=this.getDropZoneItems(W.ColorBy,l);h.colorBy=X(o);var f=this.getDropZoneItems(W.SizeBy,l);h.sizeBy=X(f);var p=this.getDropZoneItems(W.AdditionalMetrics,l);h.tooltips=H(p);return h;},findSelectorControl:function U(){var h;if(this._super){h=this._super();}var e=this.gridDataViewer,g,f;if(e){for(g=0;g<e.length;g++){f=e[g];if(f.findSelectorControl){f.findSelectorControl();}}}return h;},isClearAllDisabled:function Q(){var e=this.findSelectorControl();if(!!e&&!e.showall){return true;}return false;},clearSelections:function B(){if(this._super){this._super();}var e=this.gridDataViewer,g,f;if(e){for(g=0;g<e.length;g++){f=e[g];if(f.clearSelections){f.clearSelections();}}}},showWait:function E(){if(mstrApp&&mstrApp.showWait){mstrApp.showWait();}else{if(microstrategy&&microstrategy.showWait){microstrategy.showWait(true);}}},hideWait:function O(e){if(mstrApp&&mstrApp.hideWait){mstrApp.hideWait(e);}else{if(microstrategy&&microstrategy.showWait){microstrategy.showWait(false);}}},getLegendBoundaryNode:function(){return this.domNode;},hasColorByOrSizeBy:function(){var g=this.getDropZoneItems(W.ColorBy),e=this.getDropZoneItems(W.SizeBy),h=g&&g.length>0,f=e&&e.length>0;return h||f;},renderLegend:function(){try{var h=this.legendPlaceholder,e=this.getPrimaryGridViewer();if(!this.hasColorByOrSizeBy()||!e.getLegendProperty(d.SHOW_LEGEND)){h.style.display="none";return ;}I.applyHTML5Props(e.getLegendStyles());e.hEvalSize4Legend();var k=e.getLegendSize();h.style.width=k.width+"px";h.style.height=k.height+"px";var g=this.legend=new I({widget:this,placeholder:h,cutBy:k.cutBy,cssClass:"gm-legend vis-map-legend",styles:e.getLegendStyles()});g.render();g.parent=this;g.cutBy=k.cutBy;g.updateContainerSize(this.getWidth(),this.getHeight());this.legendPlaceholder=this.legend.domNode;this.attachLegendListeners();g.feedData([{dataType:c.COLOR_BY,dataObj:e.colorByInfo},{dataType:c.SIZE_BY,dataObj:e.sizeByInfo}],e.isLegendMinimized());}catch(f){window.console.log(f);}},attachLegendListeners:function(){var f=this,g=f.id,e=f.legend;if(e){f.legendClickListener=e.attachEventListener("gm-legend-clicked",g,function(h){f.onLegendClicked(h);});f.legendResizeListener=e.attachEventListener("gm-legend-resized",g,function(h){f.onLegendResized(h.position);});}},toggleLegend:function(e){if(!(mstrApp&&mstrApp.isVI)){return ;}var g=this.legend,f=g&&g.domNode.style;if(e){if(f&&f.display!=="block"){f.display="block";}else{if(!g){this.renderLegend();}}}else{if(f){f.display="none";}}},onLegendClicked:function(f){var g=f.action,e=this.getPrimaryGridViewer();switch(g){case"close":e.setLegendProperty("showLegend",false);this.toggleLegend(false);return ;}},updateLegend:function(){if(this.legend){var f=this.legend,e=this.getPrimaryGridViewer(),h=e.getLegendSize(),g=this.legendPlaceholder;g.style.width=h.width+"px";g.style.height=h.height+"px";f.width=h.width;f.height=h.height;f.cutBy=h.cutBy;f.updateContainerSize(this.getWidth(),this.getHeight());f.feedData([{dataType:c.COLOR_BY,dataObj:e.colorByInfo},{dataType:c.SIZE_BY,dataObj:e.sizeByInfo}],e.isLegendMinimized());f.updateAfterResize();}},onLegendResized:function(f){var e=this.getPrimaryGridViewer();e.resizeLegend(this.legend,f);this.updateLegend();},removeEventListeners:function P(f){var g;if(!!f){for(var e=0;e<f.length;e++){g=f[e];if(!g){continue;}if(!!g.remove){g.remove();}else{dojo.disconnect(g);}}f.length=0;}},unrender:function(){if(this.legendClickListener){this.legendClickListener.clear();this.legendClickListener=null;}if(this.legendResizeListener){this.legendResizeListener.clear();this.legendResizeListener=null;}if(!!this.legend){this.legend.destroy();delete this.legend;}this._super();},createOldFormatWidgetPropsXML:mstrmojo.emptyFn,createNewFormatWidgetPropsXML:function V(){var g="<widgetProps><fmt>";var e,l=this.getPrimaryGridViewer().getWidgetProps();for(e in l){if(e==="sgProps"){continue;}g+="<"+e+' value="'+this.encode(this.encode(l[e]))+'" />';}g+='<sgProps value="';var h="<sgProps>";for(var f=0;f<this.gridDataViewer.length;f++){if(f===this._primaryGridIndex){continue;}l=this.gridDataViewer[f].getWidgetProps();h+='<g k="'+this.gridDataViewer[f].data.k+'">';for(e in l){h+="<"+e+' value="'+l[e]+'" />';}h+="</g>";}h+="</sgProps>";g+=this.encode(this.encode(h));g+='"/>';g+="</fmt></widgetProps>";return g;},createWidgetPropsXML:function A(){if(!this.widgetProps){return null;}if(!this.widgetProps.sgProps){return this.createOldFormatWidgetPropsXML();}return this.createNewFormatWidgetPropsXML();},isVI:function b(){return mstrApp&&mstrApp.isVI;},getVisProps:function D(f){var g=this.getData();if(!f||g.k===f){if(!g.vp){g.vp={};}return g.vp;}var e=g.vp.sgProps;if(e){if(!e[f]){e[f]={};}return e[f];}return{};},getObservableModel:function K(e){return this.observableModel.getModel(e);},replaceSpace:function G(g,f){var e=f;if(e===undefined){e="_";}return g.replace(/ /g,e);},updatePropertiesEditor:function N(){var e,g,f=this.gridParamDownloadListener?this.gridParamDownloadListener.length:0;for(e=0;e<f;e++){g=this.gridParamDownloadListener[e];g.callback.call(g.listener);}this.gridParamDownloadListener=null;},parseDataLabelProperties:function(){var e,f=this.widgetProps;for(e in F){if(F.hasOwnProperty(e)){if(!f[e]){f[e]=F[e][0];}if(e===Z.DATA_LABEL_FONT_COLOR&&!isNaN(f[e])){f[e]=parseInt(f[e]);}else{if(e===Z.DATA_LABEL_FONT_STYLE||e===Z.DATA_LABEL_SHOW){f[e]=parseInt(f[e]);}else{if(e===Z.DATA_LABEL_SHOW_ALL){f[e]=f[e]===true||f[e]==="true";}}}}}},updateDataLabelLayer:function(){var e,f=(this.gridDataViewer&&this.gridDataViewer.length)||0;for(e=0;e<f;e++){this.gridDataViewer[e].buildDataLabelLayer();}},showDataLabelOption:function(){var e,f=(this.gridDataViewer&&this.gridDataViewer.length)||0;for(e=0;e<f;e++){if(this.gridDataViewer[e].supportDataLabel()){return true;}}return false;},showDataLabelText:function(){return !!this.getDropZoneItems(W.GeoAttribute)[0];},showDataLabelValue:function(){return this.dataLabelMetricConfig!==undefined;},getDataLabelMetricConfig:function(){var f,l,g,h=this.getData(),e=h.gts&&h.gts.col,k=this.getDropZoneItems(W.ColorBy)[0];this.dataLabelMetricConfig=undefined;if(k&&e&&e.length===1&&e[0].otp===-1){g=e[0].es;l=g.length;for(f=0;f<l;f++){if(g[f].oid===k.id){this.dataLabelMetricConfig={index:f,name:this.replaceSpace(g[f].n)};return ;}}}},persistDataLabelFormatting:function(k,m){var h=this.id,e=this.widgetProps[k],l=this.zonesModel&&this.zonesModel.getUpdateCallback(),g=function(o){var n=mstrmojo.all[h];n.widgetProps[k]=o;n.updateDataLabelLayer();if(l){l.success();}},f={silent:true,undo:function(){g(e);},redo:function(){g(m);}};g(m);this.updateAfterPropertiesChange(undefined,true,false,f);},getAttributeName:function(l){var m,e,n,h,o,f=this.model.data,k=f.lnm,g=f.gts.row||[];m=g[l];if(m){if(this.isOIVM()){return m.n;}e=m.fs&&m.fs[0];n=(e&&e.n)||"";if(k===2){return n;}o=(f.gsi.rows||[]).concat(f.gsi.cols||[]);M.forEach(o,function(p){if(p.did===m.id){h=p.n;return false;}});if(h===undefined){h=m.dn||m.n;}if(k===1){return n?h+" "+n:h;}return h;}return"";}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.Button","mstrmojo.HBox","mstrmojo.VBox","mstrmojo.SelectBox","mstrmojo.form","mstrmojo.css","mstrmojo.array","mstrmojo.hash","mstrmojo.DocXtabModel","mstrmojo.Box","mstrmojo.Editor","mstrmojo.gmaps.MapToolbar","mstrmojo.gmaps._CanShowMapToolbar","mstrmojo._CanLoadESRIMapScript","mstrmojo.esrimap.ESRIMapViewer","mstrmojo.esrimap.ClusterLayerWrapper","mstrmojo.esrimap.ESRIDensityLayer","mstrmojo.VisMapBase","mstrmojo._VizSelectionHelper","mstrmojo._CanDrawHeatMap","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.viz.EnumDSSDropZones","mstrmojo.gmaps._HasContextMenu","mstrmojo._Formattable","mstrmojo.dom","mstrmojo.Model","mstrmojo.gmaps.ObservableModel","mstrmojo.gmaps.MapEnums","mstrmojo.gmaps._CanExportPDF");mstrmojo.requiresDescs(8268,13250,13251,1158,862,14664);var C=mstrmojo.gmaps.MapToolbar.TOOLBAR_STATE,BZ={NO_DRILL:0,DRILL_DOWN:1,DRILL_UP:2},BT="esri-alt-selection",X="show",BK=mstrmojo.gmaps.EnumMapType,AN=mstrmojo.gmaps.EnumZoomBehavior,k=mstrmojo.vi.viz.EnumDSSDropZones,A7=mstrmojo.dom,A8=mstrmojo.css,A3=mstrmojo.hash;if(!window.console){console={log:function(){}};}var AQ={NONE:0,ALL:1,TOP:2,LEFT:4,BOTTOM:8,RIGHT:16};var r="World Street Map";var AL="<div>"+mstrmojo.desc(13854,"To automatically drill down:")+"</div><div>"+mstrmojo.desc(13855,"Hold ALT, make selection with mouse, and release")+"</div>",W="<div>"+mstrmojo.desc(13856,"To automatically drill up:")+"</div><div>"+mstrmojo.desc(13857,"Hold ALT/CTRL, make selection with mouse, and release")+"</div>";function AI(Bd,Bb){var Bc=dojo.query("div.tooltip")[0];if(Bc===undefined){return ;}if(!Bd){Bc.innerHTML="";}else{if(Bc.innerHTML!==Bd){Bc.innerHTML=Bd;}}if(Bb){A8.addClass(Bc,Bb);}}function BR(Bb){return !!Bb&&!isNaN(Bb.xmin)&&!isNaN(Bb.xmax)&&!isNaN(Bb.ymin)&&!isNaN(Bb.ymax);}function AV(){if(this.getDrillSelectionMode()){if(this.mapDiv){A8.removeClass(this.mapDiv,BT);}this.getToolbar().set("state",C.NORMAL_STATE);this.setDrillSelectionMode(BZ.NO_DRILL);AI();window.removeEventListener("blur",this.clearDrillSelectionFun);delete this.clearDrillSelectionFun;}}function Al(){var Bd,Bb,Bc=this.gridDataViewer;for(Bd=0,Bb=Bc&&Bc.length||0;Bd<Bb;Bd++){if(this.gridDataViewer[Bd].enableDensity){return false;}}return true;}function A0(){if(!!this.observableModel&&!this.observableModel.destroyed){this.observableModel.destroy();}var Bd=this,Bc=this.getProperties(),Bb=new mstrmojo.gmaps.ObservableModel({host:Bd,widgetProps:Bc});return Bb;}function S(Bb){if(Bb.gts){return true;}return false;}function A2(Bp){var B2=this;function Bm(B6){var B5=Math.PI;return B6*B5/180;}function B3(B6,CL,B5,CK){var CB,CI,CA,CC,CH,B8,B7,CF=Bm((B6+B5)/2),CE=Bm((B6-B5)/2),CD=Bm((CL-CK)/2),CN=Math.sin(CF),CM=Math.sin(CE),CG=Math.sin(CD),CJ=6378137,B9=1/298.257;CM=CM*CM;CG=CG*CG;CN=CN*CN;CB=CM*(1-CG)+(1-CN)*CG;CI=(1-CM)*(1-CG)+CN*CG;CA=Math.atan(Math.sqrt(CB/CI));CC=Math.sqrt(CB*CI)/CA;CH=2*CA*CJ;B8=(3*CC-1)/2/CI;B7=(3*CC+1)/2/CB;CB=CH*(1+B9*(B8*CN*(1-CM)-B7*(1-CN)*CM));CB=CB/1000;return CB;}function Bq(B6,B5){return(B6.x-B5.x)*(B6.x-B5.x)+(B6.y-B5.y)*(B6.y-B5.y);}function B0(B7,B5,CB){if(!B7){return 0;}var B9=0,B8=Bq(B5,CB),CA={},B6;for(B6=0;B6<B7.length;B6++){CA.x=B7[B6][0];CA.y=B7[B6][1];if(Bq(CA,CB)<=B8){B9++;}}return B9;}function Bv(B5,CB,CA,B8){var B7=B5*Math.cos(CA)-CB*Math.sin(CA),B6=B5*Math.sin(CA)+CB*Math.cos(CA);if(B8){var B9=Math.sqrt(B7*B7+B6*B6);B7=B7/B9*B8;B6=B6/B9*B8;}return{x:B7,y:B6};}if(B2.enableCircleSelect&&B2.center){var Br=B2.esriMap.toMap(new esri.geometry.Point(Bp.layerX,Bp.layerY,B2.esriMap.spatialReference)),Bs=esri.geometry.webMercatorToGeographic(Br),B1=B2.center,B4=esri.geometry.geographicToWebMercator(B1);if(!B2.indicatorTooltip){B2.indicatorTooltip=new mstrmojo.VisTooltip({placeholder:document.body.appendChild(document.createElement("div")),owner:this});B2.indicatorTooltip.render();}var Bj=B3(Bs.y,Bs.x,B1.y,B1.x);var Bu=B2.gridDataViewer[B2._primaryGridIndex].points&&B2.gridDataViewer[B2._primaryGridIndex].points.points;B2.indicatorTooltip.displayInfo([{n:"Radius",v:Bj.toFixed(2)+" km"},{n:"Selected",v:B0(Bu,Br,B4)+""},{n:"Longitude",v:Bs.x.toFixed(3)},{n:"Latitude",v:Bs.y.toFixed(3)}],{x:Bp.x,y:Bp.y});B2.indicatorTooltip.domNode.onmouseover=function(){B2.indicatorTooltip.toggle(false);};B2.indicatorTooltip.toggle(true);B2.toggleCircleSelectionIndicator(true);var Bo=document.getElementsByTagName("svg")[0],Bd=Bo.getBoundingClientRect(),Bz=B2.cX-Bd.left,Bh=B2.cY-Bd.top,Bx=Bp.x-Bd.left,Bg=Bp.y-Bd.top,Bn=10,Bl=4,By=Math.atan(Bl/Bn),Bi=Math.sqrt(Bl*Bl+Bn*Bn),Bc=Bv(Bx-Bz,Bg-Bh,By,Bi),Bb=Bv(Bx-Bz,Bg-Bh,-By,Bi),Bw=Bx-Bc.x,Bf=Bg-Bc.y,Bt=Bx-Bb.x,Be=Bg-Bb.y,Bk="M "+Bx+" "+Bg+" L"+Bw+" "+Bf+" L"+Bt+" "+Be;B2.circleSelcDec.setAttribute("d",Bk);B2.circleSelcLine.setAttribute("x1",Bz);B2.circleSelcLine.setAttribute("y1",Bh);B2.circleSelcLine.setAttribute("x2",Bx);B2.circleSelcLine.setAttribute("y2",Bg);}}mstrmojo.esrimap.ESRIMap=mstrmojo.declare(mstrmojo.VisMapBase,[mstrmojo._HasPopup,mstrmojo._Formattable,mstrmojo.gmaps._CanShowMapToolbar,mstrmojo._CanLoadESRIMapScript,mstrmojo._VizSelectionHelper,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.gmaps._HasContextMenu,mstrmojo.gmaps._CanExportPDF],{scriptClass:"mstrmojo.esrimap.ESRIMap",iconClass:"",title:"",height:"auto",width:"auto",DEFAULT_COLOR:"#FE766A",drawingLayer:null,mapStylesCache:null,mapStyleReady:false,minZoom:1,minZoomLimit:0,showHomeButton:false,minExtent:null,searchMode:false,destroyed:false,maxScale:0,minScale:0,previousMapStyleId:null,needShowMapContextMenu:false,defaultMapExtent:null,previousExtent:null,refitContent:false,formatHandlers:{domNode:["RW","T"]},isESRIMap:true,mapDeferred:null,mapEventListeners:null,markupString:'<div id="{@id}" class="claro mstrmojo-ESRIMap {@cssClass} {@iconClass}" title="{@title}" sty="esrimap" style="{@domNodeCssText};position:relative;overflow:hidden" mstrAttach:contextmenu,mousedown><div id="{@id}-toolbar"></div><div id="{@id}-clearAllWindow"></div><div id="{@id}-merticSelectDiv"></div><div id="{@id}-clearAllPopupDiv"></div><div id="{@id}-singleSelectPopupDiv"></div><div id="{@id}-map" style="height:{@height}px"></div><div id="{@id}-legend"></div><div id="{@id}-home"></div></div>',markupSlots:{toolBarDiv:function(){return this.domNode.firstChild;},clearAllWindowDiv:function(){return this.domNode.childNodes[1];},merticSelectDiv:function(){return this.domNode.childNodes[2];},clearAllPopupDiv:function(){return this.domNode.childNodes[3];},singleSelectPopupDiv:function(){return this.domNode.childNodes[4];},mapDiv:function(){return this.domNode.childNodes[5];},legendPlaceholder:function(){return this.domNode.childNodes[6];}},oncontextmenu:function As(Bc){var Bf=Bc.e,Be,Bg,Bd=null,Bb;if(Bf&&(this.needShowMapContextMenu||this.toolbarStateChanged)){A7.stopPropogation(window,Bf);A7.preventDefault(window,Bf);}else{Be=Bc.getTarget();Bg=Be.e_graphic;Bd=this.getContextMenuConfigureFromTarget(Bg,Bf.offsetX,Bf.offsetY);Bb=this.getMenuConfig(Bd);if(Bb.hasMenuItems()){A7.stopPropogation(window,Bf);A7.preventDefault(window,Bf);}}return false;},onmousedown:function(Bc){var Be=Bc.e,Bd=this.getToolbar(),Bb=Bd&&Bd.isSelectionState();if(this.isRightClick(Bc)&&Bb){Bd.set("state",C.NORMAL_STATE);this.toolbarStateChanged=true;A7.stopPropogation(window,Be);A7.preventDefault(window,Be);return false;}this.toolbarStateChanged=false;return true;},handleMouseUp:function p(Bb){var Bc=null,Bf,Be,Bg=this.gridDataViewer?this.gridDataViewer.length:0,Bd=null;this.needShowMapContextMenu=false;if(this.isRightClick(Bb)&&!this.toolbarStateChanged){Bc=this.getContextMenuConfigureFromTarget(Bb.graphic,Bb.screenPoint.x,Bb.screenPoint.y);A7.stopPropogation(window,Bb);this.needShowMapContextMenu=this.showMenu(Bb,Bc);return !this.needShowMapContextMenu;}},getContextMenuConfigureFromTarget:function F(Bb,Be,Bc){var Bj=null,Bd,Bf,Bh=this.gridDataViewer?this.gridDataViewer.length:0,Bg=null;if(Bb&&Bb.attributes){Bj={type:this.EnumContextMenuTargetType.GeoGraphic,object:Bb};}else{for(Bd=0;Bd<Bh;Bd++){Bf=this.gridDataViewer[Bd];if(Bf.enableDensity&&Bf.visible){Bg=Bf.densityLayer;break;}}if(Bg){var Bi=Bg.densityLayer?Bg.densityLayer.getAttrsFromLocationMapRange(Math.ceil(Be),Math.ceil(Bc),5):[];if(Bi.length>0){Bj={type:this.EnumContextMenuTargetType.DensityGraphic,object:Bi};}}}if(!Bj){Bj={type:this.EnumContextMenuTargetType.BlankSpace,object:null};}return Bj;},handleSingleSelection:function Am(Bi){for(var Be in this.gridDataViewer){if(!!this.gridDataViewer[Be].previousState){var Bf=this.gridDataViewer[Be];var Bh=Bf.previousState.columnIndex;if(Bi){Bf.command.applySelection(Bf.savedSliceInfo);Bf.endSelections();}else{Bf.currentSelections[Bh]=Bf.previousState.currentSelections;Bf.selectedRowIndices[Bh]=Bf.previousState.selectedRowIndices;Bf.highlightedGraphics[Bh]=Bf.previousState.highlightedGraphics;var Bb=Bf.previousState.mapObjectsState.selectedObj;var Bj=Bf.previousState.mapObjectsState.unselectedObj;for(var Bd in Bb){var Bg=Bb[Bd];Bf.highlightGraphic(Bg);if(!!Bg.attributes.clusterCount){Bf.addVisSelection(Bg.attributes.rowIndices);}else{Bf.addVisSelection(Bg.attributes.rowIndex);}}for(var Bc in Bj){var Bg=Bj[Bc];Bf.clearHighlight(Bg);if(!!Bg.attributes.clusterCount){Bf.removeVisSelection(Bg.attributes.rowIndices);}else{Bf.removeVisSelection(Bg.attributes.rowIndex);}}if(Bf.enablePolygon){Bf.refreshMap();}}Bf.previousState=null;Bf.savedSliceInfo=[];}}this.set("markerSelected",!this.noMarkerSelected());},clearAllLayerSelections:function BP(){for(var Bc=0;Bc<this.gridDataViewer.length;Bc++){var Bd=this.gridDataViewer[Bc],Bb=Bd.getSelectedRowIndices(Bd.getGeoColumnIndex());Bd.clearAllHighlight();Bd.currentSelections={};if(Bd.highlightedGraphics){Bd.highlightedGraphics={};}if(Bb&&Bb.length>0){Bd.selectedRowIndices={};Bd.clearSelections();Bd.endSelections();var Bf;if(Bd.enablePolygon){Bf=[Bd.geoPosition];}else{Bf=[Bd.latIndex,Bd.longIndex];}var Be={pos:Bf,elementIndex:[],setViewDataFlag:false,applyControl:true,beanPath:Bd.beanPath};Bd.command.applySelection(Be);}}},isSelectedDensity:function AE(){return false;},isRightClick:function BS(Bb){var Bc=false;if(Bb.which){Bc=Bb.which===3;}else{if(Bb.button){Bc=Bb.button===2;}}return Bc;},isToolbarPositionFixed:function BD(){return true;},doClearRectangle:function BL(Bb){if(!Bb&&!this.enableRectangleSelect&&!this.enableCircleSelect&&!this.enableFreeFormSelect){return ;}this.clearMap();},noMarkerSelected:function Au(){for(var Bc in this.gridDataViewer){var Bd=this.gridDataViewer[Bc].currentSelections;if(!!Bd){for(var Bb in Bd){if(Bd[Bb]&&Bd[Bb].length>0){return false;}}}}return true;},noPolygonsPresentOnMap:function A5(){return true;},selectedMetricIndex:0,onselectedMetricIndexChange:function Ar(Bd,Bb,Bc){this.gridDataViewer[Bd].selectedMetricIndexChange(Bb,Bc);},useESRICloud:false,enableClickSelect:true,enableRectangleSelect:false,enableFreeFormSelect:false,enableCircleSelect:false,enableZoom:false,operationalLayers:null,rectangleFillSymbol:null,polylineFillSymbol:null,toolBarActive:false,drillable:true,onenableRectangleSelectChange:function Aq(){if(this.esriToolbar===undefined){return ;}if(this.enableRectangleSelect){this.esriToolbar.setFillSymbol(this.rectangleFillSymbol);this.esriToolbar.activate(esri.toolbars.Draw.EXTENT);}else{this.esriToolbar.deactivate(esri.toolbars.Draw.EXTENT);}for(var Bb=0;Bb<this.gridDataViewer.length;Bb++){this.gridDataViewer[Bb].enableSelect=this.enableRectangleSelect;}},onenableFreeFormSelectChange:function o(){if(this.esriToolbar===undefined){return ;}if(this.enableFreeFormSelect){this.esriToolbar.setFillSymbol(this.polylineFillSymbol);this.esriToolbar.activate(esri.toolbars.Draw.FREEHAND_POLYGON);}else{this.esriToolbar.deactivate(esri.toolbars.Draw.FREEHAND_POLYGON);}for(var Bc=0,Bb=this.gridDataViewer.length;Bc<Bb;Bc++){this.gridDataViewer[Bc].enableSelect=this.enableFreeFormSelect;}},onenableCircleSelectChange:function BM(){var Bc=this;if(Bc.esriToolbar===undefined){return ;}if(!this.drawIndicatorListener){this.drawIndicatorListener=A2.bind(this);}if(Bc.enableCircleSelect){Bc.esriToolbar.setFillSymbol(Bc.rectangleFillSymbol);Bc.esriToolbar.activate(esri.toolbars.Draw.CIRCLE);A7.attachEvent(Bc.esriDiv,"mousemove",this.drawIndicatorListener,true);}else{Bc.esriToolbar.deactivate(esri.toolbars.Draw.CIRCLE);A7.detachEvent(Bc.esriDiv,"mousemove",this.drawIndicatorListener,true);delete this.drawIndicatorListener;}for(var Bb=0;Bb<Bc.gridDataViewer.length;Bb++){Bc.gridDataViewer[Bb].enableSelect=Bc.enableCircleSelect;}},setMapType:function q(Bb){this.setMapStyle(Bb);this.currentLayer&&this.currentLayer.setVisibility(true);},isSearchMode:function t(){return this.searchMode;},setSearchMode:function z(Bb){this.searchMode=Bb;},getSuggestions:function Z(Bd,Bf){var Be=this.getProtocol(),Bc=this,Bb=this.locator;if(!Bb){Bb=new esri.tasks.Locator(Be+"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer");Bb.outSpatialReference=this.esriMap.spatialReference;this.locator=Bb;}Bb.suggestLocations({text:Bd}).then(function(Bn){var Bg=[],Bl,Bi=[],Bj=0,Bo,Bs,Bh,Bk,Br,Bq,Bt,Bm;var Bp=function(Bu){if(Bh.rowIndex2Graphics[Bu.v]){Bi.push(Bu);}return Bi.length>=5;};for(Bk=0,Bm=Bc.gridDataViewer.length;Bk<Bm;Bk++){Bi=[];Bh=Bc.gridDataViewer[Bk];Bo=Bh.getWidgetProps();if(Bh.enablePolygon){Bt={unitId:Bo.ma,isAttr:true,excludes:[]};}else{Br=Bh.useAttribute;Bs=(!Br&&Bo.lat)?[Bo.lat,Bo.lng]:[];Bq=Br?Bo.atf:Bo.satf;Bt={unitId:Bq?Bq:Bo.ma,isAttr:Bq?Br:true,excludes:Bs};}if(Bh.visible){Bj++;Bl=[];Bh.filterElements(Bd,Bt,Bp)||[];if(Bi.length>0){mstrmojo.array.forEach(Bi,function(Bu){Bu.cls="elem";Bu.dvi=Bk;Bl.push(Bu);});Bg.push({label:Bh.getLayerGridName(),items:Bl});}}}if(Bj===1&&Bg.length>0){delete Bg[0].label;}if(Bn&&Bn.length>0){Bl=[];mstrmojo.array.forEach(Bn,function(Bu){Bl.push({n:Bu.text,v:Bu.magicKey,cls:"geo",geo:Bu});});Bg.push({items:Bl});}Bf(Bg);});},onSuggestionItemSelected:function O(Bd){var Be=this.esriMap,Bb,Bc;if(Bd&&Bd.geo&&this.locator){this.locator.addressToLocations({address:{SingleLine:Bd.n},magicKey:Bd.v});this.locator.on("address-to-locations-complete",function(Bf){var Bg,Bi,Bh;mstrmojo.array.forEach(Bf.addresses,function(Bj){if(Bj.score>80){Bg=Bj.location;Bi=Bj.extent;Bh=new esri.geometry.Extent(Bi.xmin,Bi.ymin,Bi.xmax,Bi.ymax,Be.spatialReference);return false;}});if(!Bg&&Bf.addresses&&Bf.addresses.length>0){Bg=Bf.addresses[0].location;Bi=Bf.addresses[0].extent;Bh=new esri.geometry.Extent(Bi.xmin,Bi.ymin,Bi.xmax,Bi.ymax,Be.spatialReference);}if(Bg){Be.setExtent(Bh,true);Be.centerAt(Bg);}});}else{if(Bd){Bb=this.gridDataViewer[Bd.dvi];if(Bb){Bc=Bb.getGeoObjectExt(Bd.v,true);if(Bc){if(Bc.center){Be.centerAndZoom(Bc.center,10);}if(Bc.bound){Be.setExtent(Bc.bound,true);}}}}}},enablePopup:true,onenablePopupChange:function f(Bb){this.enablePopup=Bb.value;},infoWindowVisible:true,oninfoWindowVisibleChange:function Ap(){var Bb=dojo.byId(this.domNode.id+"_infowindow");if(typeof Bb=="undefined"||!Bb){return ;}if(this.infoWindowVisible){if(Bb.style.visibility=="hidden"){Bb.style.visibility="";}}else{Bb.style.visibility="hidden";}},enableDebug:true,baseMapUrl:"http://server.arcgisonline.com/ArcGIS/rest/services/ESRI_StreetMap_World_2D/MapServer",baseLayer:null,isBaseMapDynamic:false,esriMapping:{},gridDataViewer:null,gridKeysMap:null,gridNamesSelectorItems:null,_primaryGridIndex:0,registeredSDPKeys:null,initMultipleDataProviders:function AH(Bg){this.loadWidgetPropsAndGridData();if(!this.grids){return ;}this._primaryGridIndex=this.arrangeGridLayersVerticalOrderingOnMap();this.gridDataViewer=[];this.gridNamesSelectorItems=[];this.registeredSDPKeys=[];var Bf,Be,Bi,Bc=this.getDocModel(),Bh;this.gridKeysMap={};if(!!Bg&&!!Bg.beanPath){Bf=Bg.beanPath;}else{if(typeof (microstrategy)!=="undefined"){this.gridBone=microstrategy.bone(Bg.boneId);Bf=this.gridBone&&this.gridBone.getDocViewer().beanPath;}}Bi=mstrApp.getMsgID&&mstrApp.getMsgID();for(var Bd=0,Bb=this.grids.length;Bd<Bb;Bd++){Be=this.grids[Bd].grid1.k;Bh=this.fnGetWidget(Be);this.gridDataViewer[Bd]=new mstrmojo.esrimap.ESRIMapViewer({parent:this,data:this.grids[Bd].grid1,defn:Bh&&Bh.defn,widgetProps:this.grids[Bd].widgetProps,k:Be,beanPath:Bf,msgID:Bi,isPrimary:(Bd===this._primaryGridIndex)?true:false,model:Bh&&Bh.model,layerIndex:Bd,dropZones:this.getDropZones(Be)});this.gridKeysMap[Be]=Bd;this.gridNamesSelectorItems.push({v:Bd,n:this.grids[Bd].grid1.n,id:Be});if(!this.gridDataViewer[Bd].isPrimary){if(Bc){Bc.addSDP(Be,{k:this.grids[this._primaryGridIndex].grid1.k,visName:this.grids[this._primaryGridIndex].grid1.visName});this.registeredSDPKeys.push(Be);}}this.addDisposable(this.gridDataViewer[Bd]);}},fnGetWidget:function(Bc){for(var Bb in mstrmojo.all){if(mstrmojo.all[Bb].k===Bc){return mstrmojo.all[Bb];}}return null;},arrangeGridLayersVerticalOrderingOnMap:function At(){var Bd=[],Bb;this.grids[0].isPrimary=true;for(var Bc=this.grids.length-1;Bc>=0;Bc--){if(this.grids[Bc].widgetProps.mtp===BK.Bubble){Bd.unshift(this.grids.splice(Bc,1)[0]);}else{if(this.grids[Bc].widgetProps.mtp===BK.Marker){Bd.push(this.grids.splice(Bc,1)[0]);}}}for(var Bc=this.grids.length-1;Bc>=0;Bc--){if(this.grids[Bc].widgetProps.mtp===BK.Density&&this.isCanvasSupported()){Bd.unshift(this.grids.splice(Bc,1)[0]);}else{Bd.push(this.grids.splice(Bc,1)[0]);}}for(var Bc=this.grids.length-1;Bc>=0;Bc--){Bd.unshift(this.grids.splice(Bc,1)[0]);}for(var Bc=0;Bc<Bd.length;Bc++){if(Bd[Bc].isPrimary&&Bd[Bc].isPrimary==true){Bb=Bc;}}this.grids=Bd.slice();return Bb;},params:{},gridParams:null,grids:null,gridData:null,enableMarker:false,enablePolygon:false,debug:function b(Bb){if(this.enableDebug){console.log(Bb);}},clearMap:function Ac(){if(this.esriMap!==undefined){if(!!this.esriMap.graphics){this.esriMap.graphics.clear();}if(!!this.esriMap.infoWindow){this.esriMap.infoWindow.hide();}if(!!this.drawingLayer){this.drawingLayer.clear();}}},saveCustomInfo:function Y(){this.persistWidgetProps();this.closePopup();},regularStroke:null,mouseoverStroke:null,selectionStroke:null,populateStrokes:function AZ(){if(!this.regularStroke){this.regularStroke=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,255,255,0.35]),1);this.mouseoverStroke=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,0,0,0.75]),2);this.selectionStroke=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,255,255,0.85]),2);this.selectionStrokePolygon=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,255,255,1]),3);}},isCtrl:false,processMapKeydown:function Af(Be){var Bb;if(window.event){Bb=window.event;}else{Bb=Be;}var Bd=Bb.shiftKey;var Bg=Bb.altKey;var Bf=Bb.ctrlKey;if(Bf){var Bc=this.isCtrl;this.isCtrl=true;if(Bc!=this.isCtrl){console.log("control key status changed to ?"+this.isCtrl);}}if(Bg){if(mstrApp&&mstrApp.isVI&&Al.call(this)){if(window.addEventListener&&!this.getDrillSelectionMode()){this.clearDrillSelectionFun=AV.bind(this);window.addEventListener("blur",this.clearDrillSelectionFun);}if(this.mapDiv){A8.addClass(this.mapDiv,BT);}if(Bf){this.setDrillSelectionMode(BZ.DRILL_UP);AI(W,X);}else{this.setDrillSelectionMode(BZ.DRILL_DOWN);AI(AL,X);}this.getToolbar().set("state",C.RECTANGLE_SELECT_STATE);}return false;}else{}},processMapKeyup:function AM(Bc){var Bb;if(window.event){Bb=window.event;}else{Bb=Bc;}var Bd=Bb.keyCode;if(Bd==17){this.isCtrl=false;}else{if(Bd===18){if(mstrApp&&mstrApp.isVI){AV.call(this);}}}},widgetProps:null,gridBone:null,createOldFormatWidgetPropsXML:function e(){var Bc="<widgetProps><fmt>";var Bb;var Bd=this.gridDataViewer[0].getWidgetProps();for(Bb in Bd){Bc+="<"+Bb+' value="'+this.encode(this.encode(Bd[Bb]))+'" />';}Bc+="</fmt></widgetProps>";return Bc;},encode:function AB(Bd,Bc){var Bf=Bd;if(Bc==null){Bc=false;}if((Bd!=null)&&(Bd.length>0)){Bf="";for(var Be=0,Bb=Bd.length;Be<Bb;Be++){switch(Bd.charAt(Be)){case"&":if((Bd.length!=(Be+1))&&(Bd.charAt(Be+1)=="#")){Bf+="&";}else{Bf+="&amp;";}break;case"<":Bf+="&lt;";break;case">":Bf+="&gt;";break;case"'":Bf+="&#039;";break;case"\n":if(!Bc){Bf+="<br />";}else{Bf+=Bd.charAt(Be);}break;case'"':Bf+="&quot;";break;case" ":if(Be==0||(Be<Bd.length-1&&Bd.charAt(Be+1)==" ")){Bf+="&nbsp;";}else{Bf+=Bd.charAt(Be);}break;default:Bf+=Bd.charAt(Be);break;}}}return Bf;},persistWidgetProps:function u(){if(this.widgetProps){var Bb=this.createWidgetPropsXML();var Bc=[];this.gridBone.setVisualizationSettings(null,null,null,null,Bc,Bb);this.gridBone.um.add(Bc);}},onSecondaryDataSliced:function Ae(Bb,Bd){var Bc=this.gridKeysMap[Bb];this.gridDataViewer[Bc].resetData(Bd);this.gridDataViewer[Bc].unrender(true);this.gridDataViewer[Bc].render(true);},isEmpty:function V(){return false;},getVisEmptyMsgControls:function A(){return[];},update:function AC(Bf){var Be=this._super(Bf);if(Be!==false){this.observableModel=A0.call(this);if(this.getData()&&this.getData().eg){return Be;}var Bc=this.getData(),Bb=Bc.vp,Bh=Bb.sgProps,Bd,Bg;this.upgradeWidgetProperties(Bb);if(!!Bh){for(Bd in Bh){Bg=Bh[Bd];this.upgradeWidgetProperties(Bg);}}}return Be;},getProperties:function U(Bb){return this.getVisProps(Bb);},upgradeWidgetProperties:function Aj(Bb){if(!Bb||A3.keyarray(Bb).length===0){return ;}if(Bb.mtp==BK.Bubble&&Bb.sa!="1"){if(!Bb.separateColorSize&&!!Bb.cmt&&!Bb.smt){Bb.smt=Bb.cmt;}}Bb.separateColorSize="1";},onShow:function BG(){if(!this.domNode||this.domNode.offsetWidth===0||this.domNode.offsetHeight===0||!this.esriMap){return ;}if(!!this.esriDiv){var Be=parseInt(this.esriDiv.style.width),Bd=parseInt(this.esriDiv.style.height),Bc=parseInt(this.width),Bb=parseInt(this.height);if(Be!==Bc||Bd!==Bb){this.esriDiv.style.width=Bc+"px";this.esriDiv.style.height=Bb+"px";if(this.esriMap){this.esriMap.resize();this.esriMap.reposition();}}}},postBuildRendering:function Ba(){if(this.waitingForData){return ;}this._super();if(mstrApp.isSingleTier&&(typeof (FormWrapper)!="undefined")&&parseInt(FormWrapper.testInternetConnection(),10)!=0){var Bg="Unable to download the ESRI map. No Internet connection. You can configure an Internet proxy through your computer's #";var Bd='<a href="" style="color:#7CC5EC" onclick="window.FormWrapper.showProxyEditor(); return false;">'+mstrmojo.desc(7831,"Settings")+"</a>.";Bg=Bg.replace("#",Bd);this.displayError(Bg);return ;}var Bf=this;var Bc=this.getData();this.destroyed=false;this.totalLayersRendered=0;mstrApp.docModel&&mstrApp.docModel.attachEventListener("panelSelected",this.id,function(Bi){var Bk=false,Bj=document.getElementById(Bi.panelId);if(Bj){Bk=Bj.contains(Bf.domNode);if(Bk&&Bi.panelVisible){Bf.onShow();}}});if(this.isLoadingExtraConfig){return ;}if(mstrApp&&mstrApp.esriConfig){if(mstrApp.esriConfig.gridParams){this.gridParams=mstrApp.esriConfig.gridParams;}if(mstrApp.esriConfig.mapStylesCache){this.mapStylesCache=mstrApp.esriConfig.mapStylesCache;}}if(!this.gridParams){var Bb={taskId:"getESRIExtraConfig",key:Bc.k,taskEnv:"xhr",taskContentType:"json"};var Be=this;var Bh={success:function(Bi){delete Be.isLoadingExtraConfig;if(Bi){Be.processData(Bi);Be.buildESRIMap();}else{this.gridParamDownloadListener=null;}},failure:function(Bi){delete Be.isLoadingExtraConfig;this.gridParamDownloadListener=null;Be.hideWait(true);mstrmojo.alert("Error loading Configuration: "+Bi.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.isLoadingExtraConfig=true;mstrApp.serverRequest(Bb,Bh);}else{this.buildESRIMap();}},processData:function w(Bb){var Bc=Bb.extProps;this.gridParams={};mstrmojo.hash.copy(Bc.gridParams,this.gridParams);if(mstrApp){if(!mstrApp.esriConfig){mstrApp.esriConfig={};}mstrApp.esriConfig.gridParams=this.gridParams;}},buildESRIMap:function A4(Bc){if(!!this.gridParams&&!!this.gridParams.err&&this.gridParams.err.length>0){this.displayError(this.gridParams.err);this.hideWait(true);return ;}if(!!this.gridParams.config.useESRICloud&&this.gridParams.config.useESRICloud==1){this.useESRICloud=true;}if(A7.isIE9){this.isClientExport=false;}this.setEsriConfig(this.gridParams.config);var Be=this;document.onkeydown=function(Bg){return Be.processMapKeydown(Bg);};document.onkeyup=function(Bg){return Be.processMapKeyup(Bg);};document.onkeypress=function(Bh){var Bg;if(typeof Bh==="undefined"){Bh=window.event;Bg=Bh.keyCode?Bh.keyCode:undefined;}else{Bg=Bh.keyCode;}if(Bg==13&&!!mstrApp.oi){A7.preventDefault(window,Bh);return false;}};this.scriptClass=this.isOIVM()?"mstrmojo.esrimap.ESRIMapOIVM":"mstrmojo.esrimap.ESRIMap";if(mstrmojo.esriMapLib===undefined){mstrmojo.esriMapLib={};mstrmojo.esrimap.loadScriptListeners=[];this.loadExternalScript(this.loadESRIMap,this);}else{var Bd=this;var Bf=this.loadESRIMap;var Bb=this.gridParams.config;if(typeof (esri)!=="undefined"){this.loadESRIMap(this.gridParams.config);}else{mstrmojo.esrimap.loadScriptListeners.push({caller:Bd,method:Bf,params:Bb});}}},metricData:null,mapTypeData:null,createSlidingToolbar:function Az(){var Bf=this.toolBarDiv.id,Bc=this.clearAllWindowDiv.id,Be=this.merticSelectDiv.id,Bg=this.clearAllPopupDiv.id,Bb=this.singleSelectPopupDiv.id,Bd;Bd=this.EnumToolbarButtonType.RECTANGLE_SELECT|this.EnumToolbarButtonType.FREE_SELECT|this.EnumToolbarButtonType.CIRCLE_SELECT|this.EnumToolbarButtonType.CLEAR_ALL|this.EnumToolbarButtonType.EDIT_INFO_WINDOW|this.EnumToolbarButtonType.GRIDS_SELECT|this.EnumToolbarButtonType.SEARCH_BAR;if(mstrApp&&mstrApp.isVI){Bd^=this.EnumToolbarButtonType.EDIT_INFO_WINDOW;Bd^=this.EnumToolbarButtonType.GRIDS_SELECT;}if(this.useESRICloud){Bd|=this.EnumToolbarButtonType.MAP_TYPE;}this.initMapTypeData();this.initMapToolbar(this,this.metricData,Bd,Bf,Be,Bg,Bb,this.mapTypeData);this.renderToolbar();this.mapDiv.style.height=parseInt(this.height)-this.toolBarDiv.offsetHeight+"px";},hideInfoWindow:function Ab(Bb){if(!!this.esriMap&&!!this.esriMap.infoWindow){this.esriMap.infoWindow.hide();}},initMapTypeData:function BV(){var Bb=this;Bb.mapTypeData=[];mstrmojo.array.forEach(this.mapStylesCache,function(Bc){Bb.mapTypeData.push({src:"../style/images/"+Bb.replaceSpace(Bc)+".jpg",n:Bc,v:Bc,type:"_ESRI_"});});},fullExtent:null,isAsp:function BN(){return(window.location.pathname.indexOf("/asp/")>0)?true:false;},isCanvasSupported:function A9(){var Bb=document.createElement("canvas");return !!(Bb.getContext&&Bb.getContext("2d"));},trimString:function Ay(Bb){return mstr.utils.String.trim(Bb);},setPosition:function BY(){},loadESRIMap:function BE(Bj){if(this.destroyed){return ;}if(this.isOIVM()){this.setPosition();}var Bo,Bi;this.prepareDivs();var Bb=null,Bl;if(!!Bj&&!!Bj.bms){var Bp=Bj.bms;for(Bl=0;Bl<Bp.length;Bl++){if(!!Bp[Bl].key&&Bp[Bl].key=="default"){Bb=Bp[Bl];break;}}}if(!!Bj&&!!Bj.proxyURLs&&Bj.proxyURLs.length>0){var Bk=Bj.proxyURLs[0];esri.config.defaults.io.proxyUrl=Bk.value;esri.config.defaults.io.alwaysUseProxy=(Bk.alwaysUse=="true");}else{if(!!Bb&&!!Bb.proxyURL&&this.trimString(Bb.proxyURL).length>0){esri.config.defaults.io.proxyUrl=Bb.proxyURL;esri.config.defaults.io.alwaysUseProxy=true;}else{if(this.isAsp()){esri.config.defaults.io.proxyUrl="../asp/esriproxy.ashx";}else{esri.config.defaults.io.proxyUrl="../jsp/esriproxy.jsp";}esri.config.defaults.io.alwaysUseProxy=false;}}this.esriMapping=Bj;if(!!Bb){this.isBaseMapDynamic=(Bb.isDyn=="1");this.baseMapUrl=Bb.value;}else{this.baseMapUrl=null;this.isBaseMapDynamic=false;}if(!this.useESRICloud&&(!this.baseMapUrl||this.trimString(this.baseMapUrl).length==0)){var Bc="The map visualization has not been configured properly. Please contact your administrator to resolve this issue.";this.displayError(Bc);return ;}if(!this.useESRICloud){var Be=Bj.pjs;var Bq={},Bf;for(Bo in Be){if(!Bo){continue;}if(Be.hasOwnProperty(Bo)&&!!Be[Bo].at){for(Bl=0;Bl<Be[Bo].at.length;Bl++){Bf=Be[Bo].at[Bl].id;Bq[Bf]=Be[Bo].at[Bl];}}}this.esriAttributeMapping=Bq;}if(!!this.width&&!!this.height){var Bd=Math.max(parseInt(this.width),parseInt(this.height));var Bh=Math.floor(Math.log(Bd)/Math.LN2)-7;this.minZoom=Bh>1?Bh:1;}if(!this.esriMap){this.esriDiv=document.createElement("div");this.tempMapDiv=document.createElement("div");this.esriDiv.style.height=parseInt(this.height)+"px";this.esriDiv.style.width=parseInt(this.width)+"px";this.esriDiv.id=this.id+"-esriMapDiv";this.esriDiv.style.position="absolute";this.esriDiv.style.top="0px";this.esriDiv.style.left="0px";this.mapDiv.appendChild(this.esriDiv);var Bs=this;try{if(this.useESRICloud){this.createWebMap();}else{require(["esri/tasks/locator","esri/graphic","esri/symbols/SimpleMarkerSymbol","esri/symbols/TextSymbol","esri/symbols/PictureMarkerSymbol","esri/dijit/HomeButton","esri/InfoTemplate","esri/toolbars/draw","esri/layers/GraphicsLayer","dojo/_base/connect","esri/SpatialReference","esri/geometry/Point","esri/geometry/Circle","esri/layers/layer"],function(Bu){Bs.esriMap=new esri.Map(Bs.esriDiv.id,{minZoom:Bs.minZoomLimit,wrapAround180:true,smartNavigation:false});Bs.initLayers(Bs.esriMap);});}}catch(Bn){this.hideWait(true);mstrmojo.alert(Bn.stack);return ;}}else{var Bg=this.esriDiv.style.width,Bm=this.esriDiv.style.height;this.esriDiv.style.width=parseInt(this.width)+"px";this.esriDiv.style.height=parseInt(this.height)+"px";this.mapDiv.appendChild(this.esriDiv);if(Bg!==this.esriDiv.style.width||Bm!==this.esriDiv.style.height){this.extentResized=true;this.esriMap.resize();this.esriMap.reposition();}this.doClearRectangle(true);this.destroyGridViewer();if(this.useESRICloud){var Bt=this.getData(),Br=Bt&&Bt.vp&&Bt.vp.dv||null;if(Br!==this.previousMapStyleId){this.setMapStyle(Br);this.previousMapStyleId=Br||null;}}this.initESRIMap();}},setMapStyle:function Ax(Bd){var Be=this.operationalLayers,Bc,Bb;if(typeof Bd=="undefined"||Bd==r){this.baseLayer.setOpacity(1);this.currentLayer=this.baseLayer;}else{this.baseLayer.setOpacity(0);}if(!!Be){for(Bc=0;Bc<Be.length;Bc++){Bb=Be[Bc];if(!!Bd){if(Bb.title==Bd){this.currentLayer=Bb.layerObject;}else{if(!Bb.layerObject.type||Bb.layerObject.type!="Feature Layer"){Bb.layerObject.setVisibility(false);}}}}}},refresh:function A6(){if(this.tempMapDiv&&this.esriDiv){this.tempMapDiv.appendChild(this.esriDiv);}this._super();},createWebMap:function I(){var Bi=this,Bj=this.getDefaultMap(),Bc,Bf=this.gridParams.config.token,Bb=1209600,Be=this.getData(),Bg=Be&&Be.vp&&Be.vp.dv,Bk=false,Bh=[];if(!!Bj){Bc=Bj.id;Bk=Bj.hasOwnProperty("isPublic")&&Bj.isPublic;}if((!Bf||Bf.length==0)&&!Bk){this.fetchTokenFromESRICloud();return ;}if(!!Bc){var Bd={server:"http://www.arcgis.com/sharing/rest",token:Bf,ssl:false,expires:Bb};require(["esri/arcgis/utils","esri/IdentityManager","esri/layers/layer","esri/tasks/locator","esri/toolbars/draw","esri/graphic","esri/symbols/SimpleMarkerSymbol","esri/symbols/TextSymbol","esri/symbols/PictureMarkerSymbol","esri/dijit/HomeButton","esri/InfoTemplate","esri/layers/GraphicsLayer","dojo/_base/connect","esri/SpatialReference","esri/geometry/Point","esri/geometry/Circle"],function(Bn,Bl){if(!Bk){if(!mstrmojo.esrimap.esriTokens){mstrmojo.esrimap.esriTokens=[];}if(mstrmojo.esrimap.esriTokens.indexOf(Bf)<0){Bl.registerToken(Bd);mstrmojo.esrimap.esriTokens.push(Bf);}}if(mstrApp.isSingleTier){Bn.arcgisUrl=Bn.arcgisUrl.replace("file","http");}var Bm=Bi.mapDeferred;if(!Bm){Bm=Bn.createMap(Bc,Bi.esriDiv.id,{mapOptions:{slider:true,zoom:Bi.minZoom,minZoom:Bi.minZoomLimit,smartNavigation:false},ignorePopups:true});Bi.mapDeferred=Bm;}Bm.then(function(Bp){Bh.push(r);var Br=Bp.map,Bo=Br.getLayer(Br.layerIds[0]);if(!Bg||r==Bg){Bi.baseLayer=Bo;Bi.currentLayer=Bi.baseLayer;}Bi.operationalLayers=Bp.itemInfo.itemData.operationalLayers;var Bq=dojo.map(Bi.operationalLayers,function(Bt,Bs){if(!!Bg&&Bt.title==Bg){Bi.currentLayer=Bt.layerObject;}if(!Bt.layerObject.type||Bt.layerObject.type!="Feature Layer"){Bh.push(Bt.title);}});Bi.mapStylesCache=Bh;Bi.previousMapStyleId=Bg;if(mstrApp){if(!mstrApp.esriConfig){mstrApp.esriConfig={};}mstrApp.esriConfig.mapStylesCache=Bi.mapStylesCache;}if(Br.loaded){Bi.initLayers(Br);}else{Bi.mapEventListeners.push(dojo.connect(Br,"onLoad",function(){Bi.initLayers(Br);Bi.mapEventListeners.push(dojo.connect(Bi.esriDiv,"resize",Br,function(){Br.resize();Br.reposition();}));}));}},function(Bo){var Bq;if(mstrApp.isSingleTier){Bq="Unable to create the map. Please check you connection. You can configure an Internet proxy through your computer's #";var Bp='<a href="" style="color:#7CC5EC" onclick="window.FormWrapper.showProxyEditor(); return false;">'+mstrmojo.desc(7831,"Settings")+"</a>.";Bq=Bq.replace("#",Bp);}else{Bq="Unable to download the requested map. Please contact your administrator to resolve this issue.";}Bi.displayError(Bq);return ;});});}},fetchTokenFromESRICloud:function Ah(){var Bb,Bj,Bk,Bf=this;Bb=this.gridParams.config.extrainfo;if(!!Bb&&!!Bb.primaryId&&!!Bb.secondaryId){var Bd="https://www.arcgis.com/sharing/oauth2/token";var Bg="20160";var Bc="client_credentials";Bj=Bb.primaryId;Bk=Bb.secondaryId;var Be={client_id:encodeURIComponent(Bj),client_secret:encodeURIComponent(Bk),grant_type:encodeURIComponent(Bc),expiration:encodeURIComponent(Bg)};var Bh={success:function(Bl){if(!!Bl.error){Bf.displayError(mstrmojo.desc(14664,"Error retrieving token using the given AppID and AppSecret. ")+Bl.error.message);return ;}var Bm=Bl.access_token;Bf.gridParams.config.token=Bm;Bf.createWebMap();Bf.cacheTheTokenInServer(Bj,Bl);Bf.hideWait();},failure:function(Bl){Bf.displayError(mstrmojo.desc(14664,"Error retrieving token using the given AppID and AppSecret. ")+Bl.error);Bf.hideWait();return ;}};var Bi=new mstrmojo.SimpleXHR({isTask:false,async:true});mstrmojo.xhr.request("POST",Bd,Bh,Be);}else{console&&console.log("ExtraInfo not present to fetch token from ESRI Cloud in client authentication mode.");}},cacheTheTokenInServer:function BQ(Bf,Bb){var Bd=this.getData(),Bc={taskId:"getESRIConfig",key:Bd.k,taskEnv:"xhr",taskContentType:"json",tokenJson:JSON.stringify(Bb),id:Bf},Be=this;var Bg={success:function(Bh){if(Bh){if(!!Bh.ec&&Bh.ec==1){console&&console.log("Successfully cached the token in client authentication mode");}else{console&&console.log("Error caching the token on web server in client authentication mode : "+Bh);}}},failure:function(Bh){console&&console.log("Error caching the token on web server in client authentication mode : "+Bh);}};mstrApp.serverRequest(Bc,Bg);},getDefaultMap:function n(){var Bc=this.gridParams.config.webmaps;if(!!Bc){for(var Bb in Bc){if(!!Bc[Bb]["default"]&&Bc[Bb]["default"]==true){return Bc[Bb];}}}return null;},setDrillSelectionMode:function G(Bb){this.isDrillSelectionMode=Bb;},getDrillSelectionMode:function Ai(){return this.isDrillSelectionMode;},initLayers:function BA(Bd){this.minExtent=Bd.extent;this.esriToolbar=new esri.toolbars.Draw(Bd,{showTooltips:false});this.rectangleFillSymbol=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([90,163,192]),2),new dojo.Color([83,212,252,0.6]));this.polylineFillSymbol=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_NULL,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([90,163,192]),2),null);this.mapEventListeners=[];this.mapEventListeners.push(dojo.connect(this.esriToolbar,"onDrawEnd",this,function(Be){this.handleExtentDraw(Be);if(Bc.getDrillSelectionMode()){if(Bc.getSelections()&&Bc.getSelections().length>0){Bc.processDrillTo(Bc.getDrillSelectionMode());}Bc.setDrillSelectionMode(BZ.NO_DRILL);}}));this.esriMap=Bd;var Bc=this;this.mapEventListeners.push(dojo.connect(this.esriMap,"onExtentChange",function(Bm){Bc.showMapLayer();var Bg=Bc.gridDataViewer,Be=AQ.NONE;if(!!Bg){for(var Bh=0,Bl=Bg.length;Bh<Bl;Bh++){Bg[Bh].setVisibility(true);Bg[Bh].buildDataLabelLayer();}}var Bf=Bd.getScale();if(Bc.minScale>0&&Bf>Bc.minScale){Be=Bc.getAreaDirection();Bc.showDirectionToast(Be,3000,null,{id:Bc.id,dom:Bc.domNode});mstrmojo.toast(mstrmojo.desc(13250,"Please zoom in to see all shapes."),3000,null,{id:Bc.id,dom:Bc.domNode,cssClass:"mapToastCss"});}else{if(Bc.maxScale>0&&Bf<Bc.maxScale){Be=Bc.getAreaDirection();Bc.showDirectionToast(Be,3000,null,{id:Bc.id,dom:Bc.domNode});mstrmojo.toast(mstrmojo.desc(13251,"Please zoom out to see all shapes."),3000,null,{id:Bc.id,dom:Bc.domNode,cssClass:"mapToastCss"});}else{if(!Bc.isAreaOverlapsViewPort()){Be=Bc.getAreaDirection();Bc.showDirectionToast(Be,3000,null,{id:Bc.id,dom:Bc.domNode});}else{try{var Bk=Bc.id+"-esriAreaDirectionToast";mstrmojo.all[Bk].destroy();}catch(Bi){}}}}Bc.previousExtent=Bd.extent;var Bj=Bc.deferredExtentConfig;if(Bj){Bd.setExtent(Bj.extent,Bj.includesAll);delete Bc.deferredExtentConfig;}if(Bc.onExtentChanged){Bc.onExtentChanged(Bm);}}));if(this.useESRICloud){this.baseLayer=Bd.getLayer(Bd.layerIds[0]);}else{var Bb;if(this.isBaseMapDynamic){Bb=new esri.layers.ArcGISDynamicMapServiceLayer(this.baseMapUrl);}else{Bb=new esri.layers.ArcGISTiledMapServiceLayer(this.baseMapUrl);}this.currentLayer=this.baseLayer=Bb;Bd.addLayer(Bb);}this.mapEventListeners.push(dojo.connect(Bd,"onMouseMove",this,function(Bf){var Bg=mstrmojo.dom.isIE6;var Be=mstrmojo.dom.position(this.esriDiv,true);this.esriMap.reposition();this.originalY=Be.y;}));this.mapEventListeners.push(dojo.connect(Bd,"onMouseOver",this,function(Be){var Bf;if(this.getDrillSelectionMode()===BZ.DRILL_DOWN){Bf=AL;AI(Bf,X);}else{if(this.getDrillSelectionMode()===BZ.DRILL_UP){Bf=W;AI(Bf,X);}else{Bf=mstrmojo.desc(8268,"Press down to start and let go to finish");AI(Bf);}}}));this.mapEventListeners.push(dojo.connect(Bd,"onMouseDown",this,function(Be){if(Bc.isSearchMode()){Bc.setSearchMode(false);Bc.getToolbar().removeSearchMode();Bc.toolbar.searchBar.clearResults();}if(Bc.enableCircleSelect){Bc.cX=Be.x;Bc.cY=Be.y;Bc.center=esri.geometry.webMercatorToGeographic(Be.mapPoint);}}));this.mapEventListeners.push(dojo.connect(Bd,"onMouseUp",this,function(Be){var Bg=Be.target||Be.srcElement,Bf=this.domNode;if(A7.contains(Bf,Bg)){Bc.handleMouseUp(Be);}if(Bc.indicatorTooltip){delete Bc.center;Bc.indicatorTooltip.toggle(false);Bc.toggleCircleSelectionIndicator(false);}}));mstrApp.docModel&&mstrApp.docModel.attachEventListener("secondaryDataSliced",this.id,function(Be){Bc.onSecondaryDataSliced(Be.key,Be.data);});this.populateStrokes();if(this.useESRICloud){this.initESRIMap();}else{this.mapEventListeners.push(dojo.connect(Bd,"onLoad",this,this.initESRIMap));}},toggleCircleSelectionIndicator:function(Bb){var Bc=document.getElementsByTagName("svg")[0];if(Bb){if(!this.circleSelcDec){this.circleSelcDec=document.createElementNS("http://www.w3.org/2000/svg","path");this.circleSelcLine=document.createElementNS("http://www.w3.org/2000/svg","line");this.circleSelcDec.style.fill="rgb(90, 163, 192)";this.circleSelcLine.style.stroke="rgb(90, 163, 192)";this.circleSelcLine.style.strokeWidth=2;Bc.appendChild(this.circleSelcDec);Bc.appendChild(this.circleSelcLine);}}else{if(this.circleSelcDec){Bc.removeChild(this.circleSelcDec);Bc.removeChild(this.circleSelcLine);delete this.circleSelcDec;delete this.circleSelcLine;}}},getAreaDirection:function BX(){var Bf=this.gridDataViewer,Bd=0,Bh,Bk,Bj,Bb;if(!!Bf){for(var Bg=0;Bg<Bf.length;Bg++){if(!Bf[Bg]){continue;}if(Bf[Bg].getMapType()==BK.Area){var Bc,Bi=Bf[Bg].getGraphics();if(!Bi){continue;}Bh=Bi.length;Bb=this.esriMap.extent.getCenter();Bj=new esri.geometry.Point(Bb.x,this.esriMap.extent.ymin,this.esriMap.spatialReference);for(var Be=0;Be<Bh;Be++){Bc=Bi[Be];if(!Bc.geometry){continue;}Bk=Bc.geometry.getExtent();Bd|=this.pointPosition(Bk,Bj);if(Bd==AQ.ALL){return Bd;}}}}}return Bd;},isAreaOverlapsViewPort:function M(){var Bf=this.gridDataViewer,Bb,Bd,Be=false;if(!!Bf){for(var Bc=0;Bc<Bf.length;Bc++){if(!Bf[Bc]){continue;}if(Bf[Bc].getMapType()==BK.Area){Be=true;Bd=this.esriMap.extent;if(Bd.contains(Bf[Bc].getExtent())||Bd.intersects(Bf[Bc].getExtent())){return true;}else{Be=false;}}}}return !Be;},showDirectionToast:function BW(Bj,Be,Bl,Bk){var Bb="esriAreaDirectionToast",Bf,Bd=Be||3000,Bc,Bi=mstrmojo.css;if(Bk&&Bk.id){Bb=Bk.id+"-"+Bb;}try{mstrmojo.all[Bb].destroy();}catch(Bh){}Bc=mstrmojo.insert({id:Bb,scriptClass:"mstrmojo.Container",markupString:'<div class="areadirection"><div id="top"></div><div id="left"></div><div id="bottom"></div><div id="right"></div></div>',markupSlots:{topNode:function(){return this.domNode.firstChild;},leftNode:function(){return this.domNode.childNodes[1];},bottomNode:function(){return this.domNode.childNodes[2];},rightNode:function(){return this.domNode.lastChild;}},startAnimation:function Bg(Bm){if((Bm&AQ.ALL)!=0){Bi.addClass(this.topNode,"topBlinkAnimation");Bi.addClass(this.leftNode,"leftBlinkAnimation");Bi.addClass(this.bottomNode,"bottomBlinkAnimation");Bi.addClass(this.rightNode,"rightBlinkAnimation");return ;}if((Bm&AQ.TOP)!=0){Bi.addClass(this.topNode,"topBlinkAnimation");}if((Bm&AQ.LEFT)!=0){Bi.addClass(this.leftNode,"leftBlinkAnimation");}if((Bm&AQ.BOTTOM)!=0){Bi.addClass(this.bottomNode,"bottomBlinkAnimation");}if((Bm&AQ.RIGHT)!=0){Bi.addClass(this.rightNode,"rightBlinkAnimation");}}});Bc.render();Bc.startAnimation(Bj);Bf=Bc.domNode;if(Bk&&Bk.dom){Bk.dom.appendChild(Bf);}else{document.body.appendChild(Bf);A7.bottomCenter(Bf);}window.setTimeout(function(){if(Bl){Bl();}try{}catch(Bm){}},Bd);},pointPosition:function Ag(Bg,Bb){var Bf,Be,Bc,Bd;Bf=new esri.geometry.Point(Bg.xmin,Bg.ymax,this.esriMap.spatialReference);Be=new esri.geometry.Point(Bg.xmax,Bg.ymax,this.esriMap.spatialReference);Bc=new esri.geometry.Point(Bg.xmin,Bg.ymin,this.esriMap.spatialReference);Bd=new esri.geometry.Point(Bg.xmax,Bg.ymin,this.esriMap.spatialReference);if(Bg.contains(Bb)){return AQ.ALL;}else{if(this.isLeft(Bc,Bf,Bb)){return AQ.RIGHT;}else{if(this.isLeft(Bf,Be,Bb)){return AQ.BOTTOM;}else{if(this.isLeft(Bd,Bc,Bb)){return AQ.TOP;}else{if(this.isLeft(Be,Bd,Bb)){return AQ.LEFT;}else{return AQ.NONE;}}}}}},isLeft:function AA(Bc,Bb,Bd){return((Bb.x-Bc.x)*(Bd.y-Bc.y)-(Bb.y-Bc.y)*(Bd.x-Bc.x))>0;},showMapLayer:function AW(){var Bb=this.currentLayer;if(!!Bb&&(!Bb.visible||Bb.opacity==0)){Bb.setVisibility(true);Bb.setOpacity(1);}},removeDijit:function B(){var Bb=this.esriDiv.id;dijit.registry.forEach(function(Bc){if(Bc.id.indexOf(Bb)>=0){Bc.destroyRecursive();}});},destroy:function H(Bd){var Bb=this.getDocModel();if(Bb&&this.registeredSDPKeys){for(var Bc in this.registeredSDPKeys){Bb.removeSDP(Bc);}}this.removeEventListeners(this.mapEventListeners);this.mapEventListeners=[];delete this.controller;delete this.edtModel;delete this.builder;delete this.zonesModel;delete this.mixinParentMapObj;this._super(Bd);if(!!this.observableModel){delete this.observableModel.host;this.observableModel.destroy();delete this.observableModel;}if(!!this.esriMap){this.esriMap.destroy();}delete this.mapDeferred;this.destroyed=true;},initMapViewer:function AG(){var Bg,Bi,Be,Bh,Bf,Bd,Bb,Bk=mstrmojo.desc(1158,"Metrics");this.metricData=[];for(Bd=0,Bb=this.gridDataViewer.length;Bd<Bb;Bd++){Bg=this.gridDataViewer[Bd].data;if(!!Bg.eg||!Bg.gts){continue;}Bi=Bg.gts.col;this.metricData[Bd]={metrics:[],gridName:Bg.n};for(Bh=0;Bh<Bi.length;Bh++){Be=Bi[Bh];if(Be.n==Bk){var Bj=Be.es;for(Bf=0;Bf<Bj.length;Bf++){var Bc={v:Bf,n:Bj[Bf].n,id:Bj[Bf].id,gIdx:Bd};this.metricData[Bd].metrics.push(Bc);}break;}}}},createEmptyGridInfoWindowTable:function L(){var Be=document.createElement("table");var Bd=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var Bc="gridInfoWindowTable";Be.className=Bc;Be.setAttribute("cellspacing","0");Be.setAttribute("cellpadding","2");var Bb=document.createElement("tHead");var Bf=document.createElement("tBody");Be.appendChild(Bb);Be.appendChild(Bf);return Be;},prepareDivs:function h(){this.infoTabDiv=document.createElement("div");this.infoTabDiv.id="infoDiv";this.infoTabDiv.style.paddingTop="3px";this.infoTabDiv.style.overflow="auto";var Bb=this.createEmptyGridInfoWindowTable();this.infoTabDiv.appendChild(Bb);var Bc=this.createInfoTabDivCSSStyle();if(Bc!=null){this.infoTabDiv.appendChild(Bc);}},createInfoTabDivCSSStyle:function Ad(Bd){var Be=null,Bb=this.getData(),Bd=Bb.cssString;if(Bd!==undefined){Be=document.createElement("style");Be.type="text/css";var Bc=Be.styleSheet||Be;if(mstrmojo.dom.isWK){if(Bc.firstChild){Bc.firstChild.nodeValue=Bd;}else{Bc.appendChild(document.createTextNode(Bd));}}else{Bc[mstrmojo.dom.isIE?"cssText":"innerHTML"]=Bd;}}return Be;},minMaxMap:null,maxRadius:60,minRadius:3.5,bubbleMode:false,stripNumberFormat:function Q(Bc){var Bd=Bc.replace(this.gridParams.currencySymbol,"");var Bb;do{Bb=Bd;Bd=Bd.replace(this.gridParams.groupingSeparator,"");}while(Bb!=Bd);var Be=Bd.replace(this.gridParams.decimalSeparator,".");return Be;},highlightedGraphics:null,currentSelections:null,selectedRowIndices:null,clearHighlight:function N(){for(var Bb=0;Bb<this.gridDataViewer.length;Bb++){this.gridDataViewer[Bb].clearHighlight();}},addGridLayer:function y(Bb){this.gridDataViewer[Bb].render(false);},removeGridLayer:function Aw(Bb){this.gridDataViewer[Bb].unrender(false);if(this.gridDataViewer[Bb].currentSelections){this.gridDataViewer[Bb].currentSelections={};}if(this.gridDataViewer[Bb].selectedRowIndices){this.gridDataViewer[Bb].selectedRowIndices={};}if(this.gridDataViewer[Bb].highlightedGraphics){this.gridDataViewer[Bb].highlightedGraphics={};}},handleExtentDraw:function BF(Be){if(this.canShowSelectionArea()&&this.drawingLayer){this.drawingLayer.add(new esri.Graphic(Be,this.rectangleFillSymbol));}var Bc=this;var Bf=function(Bi){for(var Bh=0,Bg=Bc.gridDataViewer.length;Bh<Bg;Bh++){Bc.gridDataViewer[Bh].handleExtentDraw(Bi);}Bc.set("enableRectangleSelect",false);Bc.set("enableCircleSelect",false);Bc.set("enableFreeFormSelect",false);Bc.setToolbarState(0);Bc.setToolbarButtonState(Bc.EnumToolbarButtonType.CLEAR_ALL,"enabled",true);};var Bd=this.getProtocol();var Bb=new esri.tasks.GeometryService(Bd+"//utility.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer");esri.geometry.normalizeCentralMeridian([Be],Bb,function(Bg){Bf(Bg[0]);},function(Bg){console.log(Bg);});},geoPosition:-1,geoElements:{},mapLayers:[],originalX:-1,originalY:-1,populateOriginalPosition:function AF(){var Bb=mstrmojo.dom.position(this.esriDiv,true);this.originalX=Bb.x;this.originalY=Bb.y;},idMarkerMap:null,wpDisPlayAffinityLines:false,wpLookupAttId:null,initESRIMap:function x(){this.enableMarker=false;this.enablePolygon=false;this.fullExtent=this.baseLayer.fullExtent;this.hideWait(true);this.initMultipleDataProviders(this.gridParams);this.mapStyleReady=true;this.updatePropertiesEditor();this.getDataLabelMetricConfig();try{for(var Bc=0,Bb=this.gridDataViewer.length;Bc<Bb;Bc++){if(this.gridDataViewer[Bc].eg){continue;}var Bf=this.gridDataViewer[Bc];this.showWait();Bf.render(true);}}catch(Be){this.hideWait(true);console&&console.log("Error redering viewers "+Be);}this.initMapViewer();this.createSlidingToolbar();if(mstrApp&&mstrApp.isVI){this.renderLegend();}if(!this.drawingLayer){this.drawingLayer=new esri.layers.GraphicsLayer({id:"drawingLayer"});this.esriMap.addLayer(this.drawingLayer);}this.esriMap.reorderLayer(this.drawingLayer,0);if(this.showHomeButton){if(this.esriMapHome){this.esriMapHome.destroy();}this.esriMapHome=new esri.dijit.HomeButton({map:this.esriMap},this.id+"-home");var Bd=this;window.setTimeout(function(){Bd.esriMapHome.extent=Bd.esriMap.extent;},100);this.esriMapHome.startup();}},updateScales:function T(Bb,Bc){this.minScale=(this.minScale<=0)?Bb:Math.max(this.minScale,Bb);this.maxScale=(this.maxScale<=0)?Bc:Math.min(this.maxScale,Bc);console&&console.log("ESRIMAP.updateScales: minScale = "+this.minScale+":maxScale = "+this.maxScale);},loadWidgetPropsAndGridData:function BJ(){var Bf=this.getData(),Be,Bd,Bc;this.grids=[];if(!!this.gridParams.boneId&&typeof (microstrategy)!=="undefined"){this.gridBone=microstrategy.bone(this.gridParams.boneId);}this.widgetProps=this.getProperties();this.parseDataLabelProperties();this.grids[0]={grid1:Bf,grid2:null,widgetProps:this.widgetProps};Be=!!Bf.vp&&Bf.vp.ag;if(Be&&Bf.sdp&&Bf.sdp[Be]){this.grids[0].grid2=Bf.sdp[Be];}Bd=1;if(Bf&&Bf.vp&&Bf.vp.sgProps){for(var Bb in Bf.vp.sgProps){if(Bf.sdp&&Bf.sdp[Bb]){this.grids[Bd]={grid1:Bf.sdp[Bb],grid2:null,widgetProps:this.getProperties(Bb)};Be=this.grids[Bd].grid1.ag;if(Be&&Bf.sdp[Be]){this.grids[Bd].grid2=Bf.sdp[Be];}Bd++;}}}},totalLayersRendered:0,updateMapExtent:function An(){if(this.totalLayersRendered!=this.gridDataViewer.length){this.hideWait();return ;}var Bd,Bg,Be=null,Bc=true,Bf=this.esriMap,Bb=this.minExtent;if(this.defaultMapExtent==null){for(Bd=0;Bd<this.gridDataViewer.length;Bd++){if(this.defaultMapExtent==null){this.defaultMapExtent=this.gridDataViewer[Bd].getExtent();}else{this.defaultMapExtent=this.defaultMapExtent.union(this.gridDataViewer[Bd].getExtent());}}}this.refitContent=this.widgetProps.rosa===AN.Automatic;if(this.refitContent===true){for(Bd=0;Bd<this.gridDataViewer.length;Bd++){if(Be===null){Be=this.gridDataViewer[Bd].getExtent();}else{Be=Be.union(this.gridDataViewer[Bd].getExtent());}}if(Be===null){Be=this.defaultMapExtent;}}else{Be=this.previousExtent;Bg=BR(Be);Bc=!Bg;Be=Bg?Be:this.defaultMapExtent;}if(BR(Be)){if(Bb&&(Bb.getWidth()<Be.getWidth()||Bb.getHeight()<Be.getHeight())){Be=Bb.centerAt(Be.getCenter());Bc=false;}if(!this.refitContent||!this.extentResized){Bf.setExtent(Be,Bc);}else{this.deferredExtentConfig={extent:Be,includesAll:Bc};}delete this.extentResized;}else{this.showMapLayer();}this.hideWait();},getGridDataViewers:function m(){return this.gridDataViewer;},getPrimaryGridViewer:function AD(){return this.gridDataViewer[this._primaryGridIndex];},getGridViewer:function d(Bb){if(Bb<0||Bb>=this.gridDataViewer.length){return null;}return this.gridDataViewer[Bb];},markerColumnIndices:{Lat:-1,Long:-1},latIndex:-1,longIndex:-1,findWrapperDom:function AU(){return this.domNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;},isDrillable:function AT(){for(var Bb=0;Bb<this.gridDataViewer.length;Bb++){if(this.gridDataViewer[Bb].getDrillStatus()){return true;}}return false;},getProtocol:function P(){return(mstrApp.isSingleTier)?"http:":window.location.protocol;},getAssociatedNodes:function AS(){var Bb=this.defn.an;return Bb&&Bb.length>0?Bb:[];},getSelections:function AP(){for(var Bc=0;Bc<this.gridDataViewer.length;Bc++){var Bb=this.gridDataViewer[Bc];if(this.k==Bb.k){return Bb.getSelections();}}return null;},getQuickSymbol:function BC(Bc){var Bb;switch(Bc){case"&#9679;":case'<font face="Wingdings">\u006c</font>':Bb="\u25CF";break;case"&#9632;":case'<font face="Wingdings">\u006e</font>':Bb="\u25a0";break;case"&#9830;":case'<font face="Wingdings">\u0074</font>':Bb="\u2666";break;case"&#9670;":case'<font face="Wingdings">\u0075</font>':Bb="\u25C6";break;case"&#10070;":case'<font face="Wingdings">\u0053</font>':Bb="\u2756";break;case"&#9784;":case'<font face="Wingdings">\u005D</font>':Bb="\u2638";break;case"&#10047;":case'<font face="Wingdings">\u007C</font>':Bb="\u273F";break;case"&#8984;":case'<font face="Wingdings">\u007a</font>':Bb="\u2318";break;case"&#10003;":case'<font face="Wingdings">\u0009</font>':Bb="\u2713";break;case"&#10007;":case'<font face="Wingdings">\u000a</font>':Bb="\u2717";break;case"&#8680;":case'<font face="Wingdings">\u00e8</font>':Bb="\u21E8";break;case"&#8679;":case'<font face="Wingdings">\u00e9</font>':Bb="\u21E7";break;case"&#8681;":case'<font face="Wingdings">\u00ea</font>':Bb="\u21E9";break;default:Bb=Bc;}return decodeURI(Bb);},getMousePositionFromEvent:function K(Bc){var Bd,Be,Bb=null;if((Bc.clientX!==undefined)&&(Bc.clientY!==undefined)){Bb={x:Bc.clientX,y:Bc.clientY};}else{for(Bd in Bc){Be=Bc[Bd];if(!!Be&&(Be.clientX!==undefined)&&(Be.clientY!==undefined)){Bb={x:Be.clientX,y:Be.clientY};break;}}}return Bb;},_markerElementIDs:null,checkLookUpAttributeInSecondaryDP:function Aa(){var Bd=this.secData.gvs.items;var Bb=this.secData.gts.row;var Bc=Bb.length;for(i=0;i<Bc;i++){if(Bb[i].id==this.wpLookupAttId){return true;}}return false;},_affinityLines:null,affinityLineLayer:null,DEFAULT_LINE_COLOR:16711680,drawAffinityLinesUsingSecondaryDataProvider:function g(){if(!this.secData){mstrmojo.alert("Secondary data provider could not be found. In order to see the Affinity Lines, please reset the secondary data provider in the design mode.",null,"Affinity Lines Error");return ;}if(this.findSecondaryDPAttrColIndexes()==-1){return ;}if(this.secData.gts.col.length==0){mstrmojo.alert("No Metric is present on the secondary data provider.",null,"Affinity Lines Error");return ;}this.affinityLineLayer=new esri.layers.GraphicsLayer();var Bb;Bb=this.findSecondaryDPSecondMetricIndex();this.computeSecondaryDPMetricMax(0);var Bg=this.secData.gvs.items;var Bi=this.secData.gts.row;var Bd=this.secData.ghs.rhs.items;var Be,Bh;var Bj,Bf;var Bp=this.wpMaxLineThickness;this._affinityLines=new Object();for(rowIndex=0;rowIndex<Bg.length;rowIndex++){var Bo=Bd[rowIndex].items;var Bn=Bo[this.secondaryDPFirstAttrColIndex];var Bm=Bo[this.secondaryDPSecondAttrColIndex];Be=this.getElementIdWithoutAttributeID(Bi[this.secondaryDPFirstAttrColIndex].es[Bn.idx].id);Bh=this.getElementIdWithoutAttributeID(Bi[this.secondaryDPSecondAttrColIndex].es[Bm.idx].id);if(this._markerElementIDs[Be]==null||this._markerElementIDs[Bh]==null){continue;}if(Bb!=-1){Bj=this.getThresoldString(rowIndex,"#FF0000",this.secData,Bb);}else{Bj="#FF0000";}var Bl=Bg[rowIndex].items[0];if(Bl.v){metricCellValue=parseFloat(this.stripNumberFormat(Bl.v));Bf=(metricCellValue*Bp)/this.secondaryDPMetricMaxVal[0]["max"];}else{Bf=1;}var Bk=new esri.geometry.Polyline(this.esriMap.spatialReference);Bk.addPath([this._markerElementIDs[Be],this._markerElementIDs[Bh]]);var Bc=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color(Bj),Bf);Bk.setSymbol(Bc);this.affinityLineLayer.add(Bk);this._affinityLines[Be+Bh]=Bk;}this.esriMap.addLayer(this.affinityLineLayer);},_animationSourceMarkerLines:null,_animationMarkers:null,_affinityAnimationFinished:false,_currentAffinityInterval:0,NO_OF_POINTS:20,_affinityGlow:false,_selectedAffinityMarkers:null,startAffinityLinesAnimation:function J(Bh){if(!this.secData){mstrmojo.alert("Secondary data provider could not be found. In order to see the Affinity Lines, please reset the secondary data provider in the design mode.",null,"Affinity Lines Error");return ;}if(this.findSecondaryDPAttrColIndexes()==-1){return ;}if(this.secData.gts.col.length==0){mstrmojo.alert("No Metric is present on the secondary data provider.",null,"Affinity Lines Error");return ;}var Bb;Bb=this.findSecondaryDPSecondMetricIndex();this.computeSecondaryDPMetricMax(0);var Bg=this.secData.gvs.items;var Bl=this.secData.gts.row;var Bc=this.secData.ghs.rhs.items;var Bd,Bk;var Bm,Bj;if(!this._animationSourceMarkerLines){this._animationSourceMarkerLines=[];}var Bf;for(Bf=this._animationSourceMarkerLines.length;Bf>0;Bf--){this._animationSourceMarkerLines.pop();}for(rowIndex=0;rowIndex<Bg.length;rowIndex++){var Bp=Bc[rowIndex].items;var Bo=Bp[this.secondaryDPFirstAttrColIndex];var Bn=Bp[this.secondaryDPSecondAttrColIndex];Bd=this.getElementIdWithoutAttributeID(Bl[this.secondaryDPFirstAttrColIndex].es[Bo.idx].id);Bk=this.getElementIdWithoutAttributeID(Bl[this.secondaryDPSecondAttrColIndex].es[Bn.idx].id);if(Bh[Bd]==null||this._markerElementIDs[Bk]==null){if(this._affinityLines[Bd+Bk]!=null){Bm=this._affinityLines[Bd+Bk];Bm.setMap(null);}continue;}Bm=this._affinityLines[Bd+Bk];Bm.strokeOpacity=1;Bm.setMap(this.map);if(this.wpDrawArcsLines=="Arcs"){this._animationSourceMarkerLines[this._animationSourceMarkerLines.length]=this.findPointsOnArc(this._markerElementIDs[Bd],this._markerElementIDs[Bk]);}else{this._animationSourceMarkerLines[this._animationSourceMarkerLines.length]=this.findPointsOnLine(this._markerElementIDs[Bd],this._markerElementIDs[Bk]);}}if(!this._animationMarkers){this._animationMarkers=[];}for(Bf=this._animationMarkers.length;Bf>0;Bf--){this._animationMarkers.pop();}this._affinityAnimationFinished=true;if(this._animationSourceMarkerLines.length==0){return ;}for(Bf=0;Bf<this._animationSourceMarkerLines.length;Bf++){var Bi=this._animationSourceMarkerLines[Bf];var Be=this.createAffinityAnimationMarker(Bi[0]);this._animationMarkers[Bf]=Be;}this._currentAffinityInterval=0;this.doAffinityAnimation();},clearAffinityAnimationObjects:function Ak(){if(this._animationMarkers){for(i=0;i<this._animationMarkers.length;i++){this._animationMarkers[i].setMap(null);}for(i=this._animationMarkers.length;i>0;i--){this._animationMarkers.pop();}}this._selectedAffinityMarkers=null;this._affinityAnimationFinished=false;},handleAffinityAnimationMouseClick:function Ao(Bb,Bc){if(!Bb){return ;}if(this._affinityAnimationFinished){this.clearAffinityAnimationObjects();}var Bd=Bc.ctrlKey;if(!this._selectedAffinityMarkers){this._selectedAffinityMarkers=new Object();}if(!Bd){this._selectedAffinityMarkers[Bb.attributes.id]=Bb;Bb.isSelected=true;this.handleAffinityAnimationKeyUp();}else{if(this._selectedAffinityMarkers.hasOwnProperty(Bb.attributes.id)){Bb.isSelected=false;id=Bb.attributes.id;delete this._selectedAffinityMarkers[Bb.attributes.id];}else{this._selectedAffinityMarkers[Bb.attributes.id]=Bb;Bb.isSelected=true;}}},handleAffinityAnimationKeyUp:function BU(){if(!this._affinityAnimationFinished&&this._affinityGlow){var Bb={};var Bc;for(Bc in this._selectedAffinityMarkers){Bb[this.getElementIdWithoutAttributeID(Bc)]=Bc;}this.startAffinityLinesAnimation(Bb);}},moveAffinityAnimationMarker:function E(){var Bd;for(Bd=0;Bd<this._animationSourceMarkerLines.length;Bd++){var Bb=this._animationSourceMarkerLines[Bd];var Bc=this._animationMarkers[Bd];if(this._currentAffinityInterval<this.NO_OF_POINTS){Bc.setPosition(Bb[this._currentAffinityInterval]);}if(this._currentAffinityInterval==0){Bc.setMap(this.map);}}if(this._currentAffinityInterval==this.NO_OF_POINTS-1){for(Bd=0;Bd<this._animationMarkers.length;Bd++){this._animationMarkers[Bd].setMap(null);}clearTimeout(this._glowTimer);}else{this._currentAffinityInterval++;this.doAffinityAnimation();}},doAffinityAnimation:function BB(){var Bb=this;this._glowTimer=setTimeout(function(){Bb.moveAffinityAnimationMarker();},50);},createAffinityAnimationMarker:function AK(Bd){var Bb;var Bc=new google.maps.MarkerImage("images/glow_marker.png",null,null,null,new google.maps.Size(10,8));Bb=new google.maps.Marker({position:Bd,icon:Bc,map:this.map});return Bb;},findPointsOnArc:function BI(Bm,Bd){var Bc=this.NO_OF_POINTS;var Bn=[];var Bb=180/Math.PI;var Bg=Bm.lat()/Bb;var Bt=Bm.lng()/Bb;var Be=Bd.lat()/Bb;var Bs=Bd.lng()/Bb;var Bf=2*Math.asin(Math.sqrt(Math.pow((Math.sin(Bg-Be)/2),2)+Math.cos(Bg)*Math.cos(Be)*Math.pow((Math.sin(Bt-Bs)/2),2)));var Bo;for(Bo=0;Bo<=this.NO_OF_POINTS;Bo++){var Bp=Number(Bo/Bc);var Br=Math.sin((1-Bp)*Bf)/Math.sin(Bf);var Bq=Math.sin(Bp*Bf)/Math.sin(Bf);var Bk=Br*Math.cos(Bg)*Math.cos(Bt)+Bq*Math.cos(Be)*Math.cos(Bs);var Bj=Br*Math.cos(Bg)*Math.sin(Bt)+Bq*Math.cos(Be)*Math.sin(Bs);var Bi=Br*Math.sin(Bg)+Bq*Math.sin(Be);var Bl=Math.atan2(Bi,Math.sqrt(Math.pow(Bk,2)+Math.pow(Bj,2)));var Bh=Math.atan2(Bj,Bk);Bn[Bo]=new google.maps.LatLng(Bl*Bb,Bh*Bb);}return Bn;},findPointsOnLine:function R(Bh,Bi){var Bc=Infinity;var Be;var Bj=[];var Bb;var Bf;var Bg;var Bd;if(Bi.lng()-Bh.lng()!=0){Bc=(Bi.lat()-Bh.lat())/(Bi.lng()-Bh.lng());Be=Bh.lat()-Bc*Bh.lng();Bb=(Bi.lng()-Bh.lng())/this.NO_OF_POINTS;}else{Bb=(Bi.lat()-Bh.lat())/this.NO_OF_POINTS;}for(Bd=0;Bd<=this.NO_OF_POINTS;Bd++){if(Bc==Infinity){Bg=Bh.lng();Bf=Bh.lat()+Bb*Bd;}else{Bg=Bh.lng()+Bb*Bd;Bf=Bc*Bg+Be;}Bj[Bd]=new google.maps.LatLng(Bf,Bg);}return Bj;},getElementIdWithoutAttributeID:function Av(Bb){var Bd="";var Be=0;var Bc;for(Bc=0;Bc<Bb.length;Bc++){if(Bb.charAt(Bc)==":"){Be++;}if(Be==1){continue;}Bd=Bd+Bb.charAt(Bc);}return Bd;},secondaryDPFirstAttrColIndex:-1,secondaryDPSecondAttrColIndex:-1,findSecondaryDPAttrColIndexes:function AO(){var Be=this.secData.gvs.items;var Bb=this.secData.gts.row;var Bd=Bb[0].id;this.secondaryDPFirstAttrColIndex=0;var Bc;for(Bc=1;Bc<Bb.length;Bc++){if(Bb[Bc].id!=Bd){this.secondaryDPSecondAttrColIndex=Bc;break;}}return this.secondaryDPSecondAttrColIndex;},findSecondaryDPSecondMetricIndex:function AY(){var Bb=this.secData.gts.col[0].es;if(Bb.length>1){return 1;}else{return -1;}},secondaryDPMetricMaxVal:null,computeSecondaryDPMetricMax:function AX(Bf){if(!this.secondaryDPMetricMaxVal){this.secondaryDPMetricMaxVal={};}if(this.secondaryDPMetricMaxVal.hasOwnProperty(Bf)){return ;}var Bc=this.secData.ghs.rhs.items;var Bg=this.secData.gvs.items;var Bi=0;var Bh=-Infinity;for(Bi=0;Bi<Bg.length;Bi++){var Bd=Bg[Bi].items;var Bb=Bd[Bf];if(Bb.v){var Be=parseFloat(this.stripNumberFormat(Bb.v));Bh=(Be>Bh)?Be:Bh;}}this.secondaryDPMetricMaxVal[Bf]={max:Bh};},getExecutionScope:function(){return microstrategy.EXECUTION_SCOPE;},getMsgId:function(){return this.gridParams.msgID;},addGridParameterDownloadListener:function A1(Bb,Bc){this.gridParamDownloadListener=this.gridParamDownloadListener||[];this.gridParamDownloadListener.push({listener:Bb,callback:Bc});},unrender:function AR(){if(this.hasRendered){if(this.isOIVM()||(mstrApp&&mstrApp.isVI)){this.clearCache();}document.onkeydown=document.onkeyup=document.onkeypress=null;this.destroyGridViewer();delete this.gridDataViewer;}this._super();},unrenderGridViewer:function D(){if(!this.gridDataViewer){return ;}for(var Bc=0,Bb=this.gridDataViewer.length;Bc<Bb;Bc++){this.gridDataViewer[Bc].unrender(true);}},destroyGridViewer:function BO(){if(!this.gridDataViewer){return ;}for(var Bc=0,Bb=this.gridDataViewer.length;Bc<Bb;Bc++){this.gridDataViewer[Bc].destroy(true);}delete this.gridDataViewer;},canShowSelectionArea:function l(){var Be=false,Bc=this.gridDataViewer,Bb=Bc?Bc.length:0;for(var Bd=0;Bd<Bb;Bd++){if(Bc[Bd].enableDensity&&Bc[Bd].visible){Be=true;}}return Be;},backupToolBarSelections:function c(){if(!this.selectionBackUp){this.selectionBackUp={};this.selectionBackUp.toolbarState=this.toolbar.state;this.selectionBackUp.isMarkerSelected=this.markerSelected;}},restoreToolbarSelectionEffects:function s(){this.set("markerSelected",this.selectionBackUp.isMarkerSelected);this.toolbar.set("state",this.selectionBackUp.toolbarState);},backupSelectionAreas:function a(){if(this.drawingLayer&&this.selectionBackUp){this.selectionBackUp.selectionAreas=(this.selectionBackUp.selectionAreas||[]).concat(this.drawingLayer.graphics);}},restoreSelectionAreas:function BH(){var Bd,Bc;if(this.drawingLayer){if(this.selectionBackUp&&this.selectionBackUp.selectionAreas){Bc=this.selectionBackUp.selectionAreas.length;for(var Bb=0;Bb<Bc;Bb++){Bd=this.selectionBackUp.selectionAreas[Bb];this.drawingLayer.add(Bd);}this.selectionBackUp.selectionAreas.length=0;}}},displayError:function AJ(Bb){this.toolBarDiv.innerHTML='<div class="map-err-message" style = "font-size:15px;height:100px;width:100%;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;text-align:center;z-index:100">'+Bb+"</div>";},drawMarkerLayers:function(){var Bd,Bc,Bb;if(!this.gridDataViewer){return ;}Bb=this.gridDataViewer.length;for(Bc=0;Bc<Bb;Bc++){this.gridDataViewer[Bc].unrender(true);}for(Bc=0;Bc<Bb;Bc++){Bd=this.gridDataViewer[Bc];Bd.loadWidgetProps();Bd.render(true);}},getRootDivForPDF:function(){return this.esriDiv;},getExtraNodeForPDF:function(){var Bb=[];if(!A7.isChrome||(parseInt(this.widgetProps.mc)===2||parseInt(this.widgetProps.mc)===4)){var Bd=this.getRootDivForPDF().getElementsByTagName("svg");for(var Bc=0;Bc<Bd.length;Bc++){Bb.push(Bd[Bc]);}}return Bb;},preExportHook:function(Bb){var Be=this;if(A7.isIE9||A7.isIE10||A7.isIEW3C){Be.substituteStyles(Be.getRootDivForPDF());function Bf(Bk){try{var Bi=document.getElementsByClassName("logo-med")[0]||document.getElementsByClassName("logo-sm")[0];var Bh=mstrmojo.css.getStyleValue(Bi,"backgroundImage");if(A7.isIE9||A7.isIE10||A7.isIEW3C){Bh=Bh.substring(5,Bh.length-2);}else{Bh=Bh.substring(4,Bh.length-1);}Be.replaceImage(Bi,Bh,new Image(),function(){Bk();});}catch(Bj){Bk();}}Be.replaceMapTiles(function(){Bf(Bb);});}else{A8.toggleClass(this.esriDiv,"clientExportAdjust",true);var Bg=this.getRootDivForPDF().getElementsByTagName("svg");for(var Bc=0;Bc<Bg.length;Bc++){var Bd=Bg[Bc];Bd.setAttribute("xmlns","http://www.w3.org/2000/svg");Bd.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");if(A7.isChrome){Bd.style.transform="translate(1px, 1px)";}}this._super(Bb);}},postExportHook:function(){if(A7.isIE9||A7.isIE10||A7.isIEW3C){this.reviveImages();this.reviveStyles(this.getRootDivForPDF());}else{A8.toggleClass(this.esriDiv,"clientExportAdjust",false);var Bd=this;var Be=this.getRootDivForPDF().getElementsByTagName("svg");for(var Bb=0;Bb<Be.length;Bb++){var Bc=Be[Bb];Bc.removeAttribute("xmlns");Bc.removeAttribute("xmlns:xlink");if(A7.isChrome){Bc.parentNode.style.transform=0;}}}},hideMapTools:function(){this._isPanArrows=this.esriMap.isPanArrows;this._isZoomSlider=this.esriMap.isZoomSlider;if(this._isPanArrows){this.esriMap.hidePanArrows();}if(this._isZoomSlider){this.esriMap.hideZoomSlider();}},showMapTools:function(){if(this._isPanArrows){this.esriMap.showPanArrows();}if(this._isZoomSlider){this.esriMap.showZoomSlider();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.esrimap.ESRIMap");mstrmojo.esrimap.ESRIMapOIVM=mstrmojo.declare(mstrmojo.esrimap.ESRIMap,null,{scriptClass:"mstrmojo.esrimap.ESRIMapOIVM",k:null,_w:null,model:null,getWidget:function(F){this.k=F.key;if(!this._w&&F){for(var E in mstrmojo.all){if(mstrmojo.all[E].k===F.key){this._w=mstrmojo.all[E];break;}}}return this._w;},getDocModel:function D(){return this.model&&this.model.docModel;},trimString:function A(E){return mstrmojo.string.trim(E);},setPosition:function B(){if(!!this.node&&!!this.node.defn&&!!this.node.defn.fmts){var E=this.node.defn.fmts,F=this.domNode.style;this.width=parseInt(E.width,10)+"px";this.height=parseInt(E.height,10)+"px";F.width=this.width;F.height=this.height;F.top=parseInt(E.top,10)+"px";F.left=parseInt(E.left,10)+"px";F.position="absolute";}},persistWidgetProps:function C(){if(!this.isOIVM()){return this._super();}var E=this.createWidgetPropsXML();var F=this.getWidget(this.gridParams);this.getDocModel().updateUnitFormat(F,1,{FormattingWidget:{WidgetProps:E}},{success:function(){}},{params:{suppressData:true},config:{silent:true}});}});}());
mstrSaveAsEditorImplScript=true;mstrSaveAsEditorImpl.prototype=new mstrObjectExplorerImpl();mstrSaveAsEditorImpl.prototype.upfolderImg=null;mstrSaveAsEditorImpl.prototype.saveasForm=null;mstrSaveAsEditorImpl.prototype.saveasName=null;mstrSaveAsEditorImpl.prototype.saveasDesc=null;mstrSaveAsEditorImpl.prototype.shouldReturn=null;mstrSaveAsEditorImpl.prototype.selectedClass="selected";mstrSaveAsEditorImpl.prototype.preObj=null;mstrSaveAsEditorImpl.prototype.onload=function(e){try{mstrObjectExplorerImpl.prototype.onload.call(this);var upFolderImgArray=document.getElementsByName("upFolder");for(var i=0;i<upFolderImgArray.length;i++){var upFolderImg=upFolderImgArray[i];upFolderImg.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').onupfolder(e);");}if(this.contents){this.contents.ondblclick=new Function("e","return microstrategy.bone('"+this.id+"').ondblclick(e);");}}catch(err){microstrategy.errors.log(err);return false;}};mstrSaveAsEditorImpl.prototype.ondocumentclick=function(e){try{if(this.currentPicker){this.closePicker(e);}}catch(err){microstrategy.errors.log(err);}};mstrSaveAsEditorImpl.prototype.submitSaveForEnterKey=function(object,saveEventID){var e=window.event;if(e&&e.keyCode==13){var oObj=document.getElementById(object.id);if(oObj){var value=oObj.value.replace(/ /g,"");if(value.length>0){var okButton=document.getElementById(saveEventID);if(okButton){okButton.focus();}}else{if(typeof (showMessage)=="undefined"){var cancelButton=document.getElementById(cancelEventID);if(cancelButton){cancelButton.focus();}}}}}};mstrSaveAsEditorImpl.prototype.onupfolder=function(e){try{if(this.currentPicker){this.closePicker(e);}this.updateAnchorHref(getEventTarget(e));}catch(err){microstrategy.errors.log(err);}return false;};mstrSaveAsEditorImpl.prototype.onmousedown=function(e){try{if(!e){e=window.event;}if(this.currentPicker){this.closePicker(e);}var src=getEventTarget(e);if(src!=this.contents.firstChild){this.updateAnchorHref(src);this.synchObjName(src);}}catch(err){microstrategy.errors.log(err);}return false;};mstrSaveAsEditorImpl.prototype.ondblclick=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);src=this.getObjSpan(src);if(src&&src.tagName.toLowerCase()=="span"){if(this.saveasForm&&this.okBtnId){createHiddenInput(this.saveasForm,this.okBtnId,"OK");this.preSaveSubmit();submitForm(this.saveasForm);}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrSaveAsEditorImpl.prototype.updateAnchorHref=function(src){try{var folderLink=null;if(src.id=="upFolder"){var upFolderAnchor=src.parentNode;if(upFolderAnchor&&upFolderAnchor.tagName.toLowerCase()=="a"){folderLink=upFolderAnchor;}}else{if(src.tagName&&src.tagName.toLowerCase()=="a"){folderLink=src;}}if(folderLink){var doubleEncodeSaveAs=false;if(this.saveasName&&this.saveasName.value){folderLink.href=this.appendParameters(folderLink.href,this.saveasName.id,this.encode(this.saveasName.value));doubleEncodeSaveAs=this.hasDoubleEncoded();}if(this.saveasDesc&&this.saveasDesc.value){folderLink.href=this.appendParameters(folderLink.href,this.saveasDesc.id,this.encode(this.saveasDesc.value));doubleEncodeSaveAs=this.hasDoubleEncoded();}if(doubleEncodeSaveAs){folderLink.href=this.appendParameters(folderLink.href,"doubleEncodeSaveAs","true");}if(this.shouldReturn=="1"){folderLink.href=this.appendParameters(folderLink.href,"shouldReturn","1");}folderLink.href=this.addExtraURL(folderLink.href);}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrSaveAsEditorImpl.prototype.addExtraURL=function(href){return href;};mstrSaveAsEditorImpl.prototype.appendParameters=function(href,paraName,paraValue){try{var pattern=new RegExp("(&"+paraName+"=[^(&|$)]+)|$");return href.replace(pattern,"&"+paraName+"="+paraValue);}catch(err){microstrategy.errors.log(err);}};mstrSaveAsEditorImpl.prototype.synchObjName=function(src){try{src=this.getObjSpan(src,true);if(src&&src.tagName.toLowerCase()=="span"){if(this.saveasName){this.saveasName.value=decode(src.innerHTML);this.saveasName.focus();this.highlightSelectedObj(src);}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrSaveAsEditorImpl.prototype.highlightSelectedObj=function(src){var cn=src.className;if(cn.indexOf(" "+this.selectedClass)==-1){src.className=cn+" "+this.selectedClass;}if(this.preObj&&this.preObj!=src){this.preObj.className=this.preObj.className.replace(" "+this.selectedClass,"");}this.preObj=src;};mstrSaveAsEditorImpl.prototype.preSaveSubmit=function(){if(this.saveasForm){var inputs=this.saveasForm.getElementsByTagName("input");for(var i=0;i<inputs.length;i++){if(inputs[i].type=="checkbox"){box=inputs[i];if(box.checked==true&&box.disabled==true){box.disabled=false;}}}}};mstrSaveAsEditorImpl.prototype.onCancel=function(){if(this.shouldReturn=="1"){var um=microstrategy.updateManager;um.useIframe=false;um.add([um.createActionObject(null,mstrUpdateManager.RETURN_TO,this.beanPath,["3140"],["-1"],[],null)]);um.flushAndSubmitChanges();}else{this.closeEditor();}return false;};mstrSaveAsEditorImpl.prototype.requiresDoubleEncoding=function(input){if(input==null){return false;}var i;for(i=0;i<input.length;i++){if(input.charAt(i)=="%"||input.charAt(i)=="-"){return true;}}return false;};mstrSaveAsEditorImpl.prototype.encodeSpecialChars=function(input){if(input==null){return null;}var i,str;str="";for(i=0;i<input.length;i++){if(input.charAt(i)=="%"){str+="-";}else{if(input.charAt(i)=="-"){str+="--";}else{if(input.charAt(i)=="'"){str+="-27";}else{str+=input.charAt(i);}}}}return str;};mstrSaveAsEditorImpl.prototype.doubleEncode=function(input){input=encodeURIComponent(input);if(this.requiresDoubleEncoding(input)){return this.encodeSpecialChars(input);}return input;};mstrSaveAsEditorImpl.prototype.encode=function(input){return input;};mstrSaveAsEditorImpl.prototype.hasDoubleEncoded=function(){return false;};function mstrSaveAsEditorImpl(id){this.inherits=mstrObjectExplorerImpl;this.inherits(id);delete this.inherits;return this;}
mstrMsgBoxImplScript=true;mstrMsgBoxImpl.prototype=new mstrEditorImpl();mstrMsgBoxImpl.prototype.okButton=null;mstrMsgBoxImpl.prototype.cancelButton=null;mstrMsgBoxImpl.prototype.applyButton=null;mstrMsgBoxImpl.MSG_WARNING="warning";mstrMsgBoxImpl.MSG_ERROR="error";mstrMsgBoxImpl.MSG_INFO="info";mstrMsgBoxImpl.MSG_INFO_WARNING="infowarning";mstrMsgBoxImpl.MSG_INPUT="input";mstrMsgBoxImpl.MSG_EXPORT_LINK="exportLink";mstrMsgBoxImpl.MSG_PREF_WARNING="prefwarning";mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID="msgPref";mstrMsgBoxImpl.MSG_TEXT_ONLY="textonly";mstrMsgBoxImpl.prototype.onload=function(){try{mstrEditorImpl.prototype.onload.call(this);this.okButton=microstrategy.subObjectFind(this.elem,["INPUT"],"ok");this.cancelButton=microstrategy.subObjectFind(this.elem,["INPUT"],"cancel");this.applyButton=microstrategy.subObjectFind(this.elem,["INPUT"],"apply");this.setDefaultLabel(this.okButton);this.setDefaultLabel(this.cancelButton);this.setDefaultLabel(this.applyButton);if(window.clipboardData!=null){this.body.onkeydown=new Function("e","microstrategy.bone('"+this.id+"').onkeydown(e);");}}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.prototype.setDefaultLabel=function(button){if(button){if(button.getAttribute("value")){button.setAttribute("defaultValue",button.getAttribute("value"));}}};mstrMsgBoxImpl.prototype.onkeydown=function(e){try{if(!e){e=window.event;}if(e.ctrlKey&&e.keyCode==67){var regExp=new RegExp("<br>","gi");var text=this.body.innerHTML.replace(regExp,"\r\n");text=text.replace(/&nbsp;/gi," ");window.clipboardData.setData("Text",text);}}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.prototype.setTitle=function(title){try{var titleDiv=microstrategy.findChildWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);var titleSpan=titleDiv.firstChild;if(titleSpan){if(title!=null&&title.length&&title.length!=0){titleSpan.innerHTML=title;}else{titleSpan.innerHTML=microstrategy.descriptors.getDescriptor("3610");}}}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.prototype.setMessage=function(message,msgType){try{var content=document.getElementById("msgContent");content.innerHTML="";if(content!=null){if(msgType==mstrMsgBoxImpl.MSG_INPUT){var msgInput=document.createElement("INPUT");msgInput.id=this.id+"_input";msgInput.maxLength=256;msgInput.size=28;content.appendChild(msgInput);}else{content.innerHTML=message;}}var icon=document.getElementById("msgIcon");if(icon!=null){icon.className="";icon.innerHTML="";if(msgType==mstrMsgBoxImpl.MSG_INPUT){icon.style.height="auto";icon.innerHTML=message;}else{if(msgType!=null){icon.style.height="32px";icon.className="mstrMsgBoxMsgIcon-"+msgType;}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.prototype.initInput=function(labelText,value,length,maxLength){try{var content=document.getElementById("msgContent");content.innerHTML="";if(content!=null){var msgInput=document.createElement("INPUT");msgInput.id=this.id+"_input";msgInput.maxLength=maxLength;msgInput.size=length;msgInput.value=value;content.appendChild(msgInput);}var label=document.getElementById("msgIcon");if(label!=null){label.className="";label.innerHTML="";label.style.height="auto";label.innerHTML=labelText;}var pTD=document.getElementById("msgPrefContainer");if(pTD!=null){pTD.style.display="none";}}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.prototype.cleanBeforeInit=function(){var content=document.getElementById("msgContent");if(content!=null){content.style.paddingLeft="0px";content.style.width="320px";}var label=document.getElementById("msgIcon");if(label!=null){label.style.paddingLeft="0px";}var iframeDiv=document.getElementById("iframeDiv");if(iframeDiv){iframeDiv.style.display="none";}this.cancelButton.value="Cancel";};mstrMsgBoxImpl.prototype.setTextOnlyContentWidth=function(){var content=document.getElementById("msgContent");if(content!=null){content.style.paddingLeft="0px";content.style.width="400px";}};mstrMsgBoxImpl.prototype.setButtonDisplay=function(button,flags,flagToCheck){if(button){var val="none";if(flags){val=(flags&flagToCheck)?"inline":"none";}button.style.display=val;}};mstrMsgBoxImpl.prototype.setButtonDisplays=function(flags){this.setButtonDisplay(this.okButton,flags,microstrategy.OK_BUTTON);this.setButtonDisplay(this.cancelButton,flags,microstrategy.CANCEL_BUTTON);this.setButtonDisplay(this.applyButton,flags,microstrategy.APPLY_BUTTON);};mstrMsgBoxImpl.prototype.setButtonFocus=function(buttonFocus){var btn=null;if(buttonFocus===microstrategy.CANCEL_BUTTON){btn=this.cancelButton;}else{if(buttonFocus===microstrategy.APPLY_BUTTON){btn=this.APPLY_BUTTON;}else{if(buttonFocus===microstrategy.OK_BUTTON){btn=this.okButton;}}}if(btn){btn.className+=" hot";}};mstrMsgBoxImpl.prototype.setEval=function(button,evalScript){if(button){button.clickFunc=null;button.setAttribute("eval","");if(typeof (evalScript)==="function"){button.clickFunc=evalScript;}else{button.setAttribute("eval",evalScript);}}};mstrMsgBoxImpl.prototype.setLabel=function(button,label){if(!button){return ;}button.setAttribute("value",label||button.getAttribute("defaultValue")||String.fromCharCode(160));};mstrMsgBoxImpl.prototype.setButtons=function(flags,okEval,cancelEval,applyEval,buttonLabels){try{if(flags!=null){this.setButtonDisplays(flags);}var btns={Ok:okEval,Cancel:cancelEval,Apply:applyEval};for(var btn in btns){var b=btn.toLowerCase()+"Button";this.setEval(this[b],btns[btn]);this.setLabel(this[b],buttonLabels&&buttonLabels[btn]);}}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.prototype.show=function(positionInMiddle,zIndex){try{if(positionInMiddle!=false){this.elem.style.left="-1px";this.elem.style.top="-1px";}mstrEditorImpl.prototype.show.call(this);if(zIndex!=null){this.showCurtain(zIndex-1);this.elem.style.zIndex=zIndex;}this.elem.style.visibility="visible";if(this.applyButton&&this.applyButton.style.display=="inline"){this.applyButton.focus();}else{if(this.okButton&&this.okButton.style.display=="inline"){this.okButton.focus();}else{this.cancelButton.focus();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.prototype.hide=function(){try{if(!this.elem){return ;}this.setTitle("");this.setButtonDisplays(null);mstrEditorImpl.prototype.hide.call(this);}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.prototype.getInputValue=function(){try{var inputField=microstrategy.findChildWithAtt(this.elem,"input",microstrategy.HTMLATTR_ID,this.id+"_input");if(inputField){return inputField.value;}return null;}catch(err){microstrategy.errors.log(err);return false;}};mstrMsgBoxImpl.hideMessage=function(button,messageBoxID){try{messageBoxID=messageBoxID||"msgBox";var bone=microstrategy.bones[messageBoxID];if(bone){bone.hide();}var buttonEval=null;if(button&&button.getAttribute("eval")!=null&&typeof (button.getAttribute("eval"))!="undefined"&&button.getAttribute("eval").length>0){buttonEval=button.getAttribute("eval");}if(buttonEval){eval(buttonEval);}else{if(button&&button.clickFunc){button.clickFunc();}}}catch(err){microstrategy.errors.log(err);}};mstrMsgBoxImpl.prototype.setCssClass=function(cssClass){try{this.elem.className="mstrMsgBox "+(cssClass||"");}catch(err){microstrategy.errors.log(err);}};mstrMsgBoxImpl.prototype.setHelpHref=function(href,append){try{var titleDiv=microstrategy.findChildWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);var buttonSpan=titleDiv.firstChild.nextSibling;var anchor=buttonSpan.firstChild;if(!append){anchor.setAttribute("href",href);}else{var ah=anchor.href.split("#");ah[1]=href;anchor.setAttribute("href",ah.join("#"));}}catch(err){microstrategy.errors.log(err);}};mstrMsgBoxImpl.prototype.setPreference=function(enablePref){try{var btnsTD=microstrategy.findChildWithAtt(this.elem,"TD",(bIsW3C)?"class":"className","mstrDialogButtonBar"),msgTD=microstrategy.findChildWithAtt(this.elem,"TD",(bIsW3C)?"class":"className","mstrDialogBody"),pTD=document.getElementById("msgPrefContainer"),cbID=mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID;if(enablePref&&!pTD){pTD=document.createElement("TD");btnsTD.parentNode.insertBefore(pTD,btnsTD);pTD.setAttribute("id","msgPrefContainer");var cb=document.createElement("INPUT");cb.setAttribute("type","checkbox");pTD.appendChild(cb);cb.id=cbID;var lb=document.createElement("SPAN");pTD.appendChild(lb);lb.innerHTML=microstrategy.descriptors.getDescriptor("8636");}if(pTD){pTD.style.display=enablePref?"":"none";msgTD.setAttribute("colSpan",enablePref?"2":"1");document.getElementById(cbID).checked=false;}}catch(err){microstrategy.errors.log(err);}};function mstrMsgBoxImpl(id){this.inherits=mstrEditorImpl;this.inherits(id);delete this.inherits;return this;}
lockSetScript=true;function isRetinaChromeDisplay(){if(isMac&&mstr.utils.ISCHROME&&window.matchMedia){var mq=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");return(mq&&mq.matches||(window.devicePixelRatio>1));}return false;}function mstrLockSet(entireGrid,divEntireTable,gridBone){var lockRowHeader=gridBone.commands.queryState("checkLockRowHeader"),lockColHeader=gridBone.commands.queryState("checkLockColHeader"),lockBothHeader=lockRowHeader&&lockColHeader;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){mstrLockSet.MINIMUM_GRID_HEIGHT=36;}this.doResize=true;this.initialized=false;this.quadrants=[];this.backgroundMasks={};this.quadrants[0]=divEntireTable;this.quadrants[1]=lockBothHeader?entireGrid.appendChild(this.cloneQuadrant(gridBone,divEntireTable,"divLock1")):null;this.quadrants[2]=lockColHeader?entireGrid.appendChild(this.cloneQuadrant(gridBone,divEntireTable,"divLock2")):null;this.quadrants[3]=lockRowHeader?entireGrid.appendChild(this.cloneQuadrant(gridBone,divEntireTable,"divLock3")):null;this.table=entireGrid.getElementsByTagName("table")[0];this.gridBone=gridBone;if(this.table){this.topLeftMv=microstrategy.findChildWithAtt(this.table,"td","fg","topLeftMv");}else{this.topLeftMv=null;}if(this.table&&this.quadrants[0]&&(this.quadrants[2]||this.quadrants[3])){this.initQuadrants();this.initialized=true;}mstrLockSet.MAC_RETINA_CHROME=isRetinaChromeDisplay();if(mstrLockSet.IS_IE||mstrLockSet.MAC_RETINA_CHROME){this.lastScrollTop=0;this.lastScrollLeft=0;}this.gridBoneElemOverflow=this.gridBone.elem.style.overflow;this.gridBone.elem.style.overflow="hidden";return this;}mstrLockSet.MINIMUM_GRID_WIDTH=75;mstrLockSet.MINIMUM_GRID_HEIGHT=200;mstrLockSet.IGNORE_SCROLL=false;mstrLockSet.IS_IE=mstr.utils.ISIE8||mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE;mstrLockSet.prototype.gridBone=null;mstrLockSet.prototype.startY=0;mstrLockSet.prototype.timer=null;mstrLockSet.prototype.quad2ClipHeight=0;mstrLockSet.prototype.quad2ClipWidth=0;mstrLockSet.prototype.quad3ClipHeight=0;mstrLockSet.prototype.quad3ClipWidth=0;mstrLockSet.prototype.onmousedown=function(){this.startY=this.quadrants[0].scrollLeft;this.timer=window.setTimeout("microstrategy.bone('"+this.gridBone.id+"').lockSet.onmouseup()",1000);};mstrLockSet.prototype.onmouseup=function(){window.clearTimeout(this.timer);if(this.gridBone.colWidths&&this.startY!=this.quadrants[0].scrollLeft){this.gridBone.onlockscroll();}this.startY=0;};mstrLockSet.prototype.initQuadrants=function(){this.quadrants[0].onmousedown=new Function("e","microstrategy.bone('"+this.gridBone.id+"').lockSet.onmousedown(e)");var i,div;for(i=1;i<4;i++){div=this.quadrants[i];if(div){this.backgroundMasks[i]=document.createElement("div");div.insertAdjacentElement("afterEnd",this.backgroundMasks[i]);this.backgroundMasks[i].style.backgroundColor=this.getBackgroundMaskColor();this.backgroundMasks[i].style.position="absolute";}}};mstrLockSet.prototype.cloneQuadrant=function(gridBone,divEntireTable,name){var dupDiv=divEntireTable.cloneNode(true),gridBoneId=gridBone.id,table;dupDiv.setAttribute("id",gridBoneId+name);dupDiv.setAttribute("name",gridBoneId+name);dupDiv.className=name;dupDiv.style.overflow="auto";table=dupDiv.getElementsByTagName("table")[0];table.getElementsByTagName("tbody")[0].onmousedown=gridBone.addBoneHandler(gridBoneId,"onmousedown");table.getElementsByTagName("tbody")[0].onclick=gridBone.addBoneHandler(gridBoneId,"onclick");return dupDiv;};mstrLockSet.prototype.replaceQuadrants=function(){var gridBone=this.gridBone,divEntireTable=this.quadrants[0],i,oldChild;for(i=1;i<4;i++){if(this.quadrants[i]){oldChild=this.quadrants[i];this.quadrants[i]=this.cloneQuadrant(gridBone,divEntireTable,"divLock"+i);oldChild.parentNode.replaceChild(this.quadrants[i],oldChild);}}this.addScrollEventHandler();};mstrLockSet.prototype.removeQuadrants=function(){var i,q,b;for(i=1;i<4;i++){q=this.quadrants[i];if(q){q.parentNode.removeChild(q);this.quadrants[i]=null;}b=this.backgroundMasks[i];if(b){b.parentNode.removeChild(b);this.backgroundMasks[i]=null;}}if(this.quadrants[0]){if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){this.gridBone.elem.style.height=this.quadrants[0].style.height;}this.quadrants[0].style.cssText="";this.quadrants[0].onmousedown=null;this.quadrants[0].onscroll=null;this.quadrants[0].lockSet=null;}this.gridBone.elem.style.overflow=this.gridBoneElemOverflow;};mstrLockSet.prototype.addScrollEventHandler=function(){if(!this.initialized){return ;}mstrLockSet.trackScrolling();if(this.quadrants[0]){this.quadrants[0].lockSet=this;this.quadrants[0].onscroll=mstrLockSet.trackScrolling;}if(this.quadrants[1]){this.quadrants[1].lockSet=this;this.quadrants[1].onscroll=mstrLockSet.trackScrollingTopCorner;}if(this.quadrants[2]){this.quadrants[2].lockSet=this;this.quadrants[2].onscroll=mstrLockSet.trackScrollingColHeaders;}if(this.quadrants[3]){this.quadrants[3].lockSet=this;this.quadrants[3].onscroll=mstrLockSet.trackScrollingRowHeaders;}};mstrLockSet.prototype.resize=function(replace,width,height){if(!isInDocument(this.table)){return ;}if(!this.doResize){return ;}this.doResize=false;var me=this,fnResize=function(){if(replace){me.replaceQuadrants();}me.resizeGridArea(width,height);me.resizeClippingAreas();me.doResize=true;};if(replace&&mstr.utils.ISCHROME){var style=this.table.style,tableLayout=style.tableLayout;style.tableLayout="auto";window.setTimeout(function(){style.tableLayout=tableLayout;fnResize();},0);}else{fnResize();}};mstrLockSet.prototype.resizeGridArea=function(width,height){var div=this.quadrants[0],bm=mstr.utils.BoxModel,gridAreaWidth,gridAreaHeight,i;if(width){gridAreaWidth=width;}else{gridAreaWidth=this.getAvailableGridAreaWidth(div);}if(height){gridAreaHeight=height;}else{gridAreaHeight=this.getAvailableGridAreaHeight(div)-(mstr.utils.BoxModel.hasScrollbar(div,"x")?mstrLockSet.getScrollbarSize():0);}for(i=0;i<4;i++){if(this.quadrants[i]){if(i>0&&(mstrLockSet.IS_IE||mstrLockSet.MAC_RETINA_CHROME)){this.quadrants[i].style.overflow="hidden";}this.quadrants[i].style.height=gridAreaHeight+"px";this.quadrants[i].style.width=gridAreaWidth+"px";}}if(mstrLockSet.IS_IE||mstrLockSet.MAC_RETINA_CHROME){if(bm.hasScrollbar(div,"y")){var divWidth=(parseFloat(div.style.width)-mstrLockSet.getScrollbarSize())+"px";for(i=1;i<4;i++){if(this.quadrants[i]){this.quadrants[i].style.width=divWidth;}}}}if(this.gridBone.commands.queryState("fittowindow")){var w=null,table;if(this.quadrants[0]){w=(gridAreaWidth-(bm.getElementInnerHeight(this.quadrants[0])<bm.getElementInnerHeight(this.table)?mstrLockSet.getScrollbarSize():0))+"px";this.table.style.width=w;}for(i=1;i<4;i++){table=this.quadrants[i]&&this.quadrants[i].childNodes[0];if(table){table.style.width=w;}}}};mstrLockSet.prototype.resizeClippingAreas=function(){var dataWidth=this.getScrollAreaWidth(this.quadrants[0])-1,dataHeight=this.getScrollAreaHeight(this.quadrants[0])-1,fixedColsWidth=this.getFixedColsWidth(),fixedRowsHeight=this.getFixedRowsHeight();if(fixedRowsHeight>dataHeight){fixedRowsHeight=dataHeight;}if(fixedColsWidth>dataWidth){fixedColsWidth=dataWidth;}if(this.quadrants[1]){this.quadrants[1].style.clip="rect(0px "+fixedColsWidth+"px "+fixedRowsHeight+"px 0px)";var maskStyle=this.backgroundMasks[1].style;maskStyle.top="0px";maskStyle.left="0px";maskStyle.width=fixedColsWidth+"px";maskStyle.height=fixedRowsHeight+"px";maskStyle.zIndex=5;}if(this.quadrants[2]){this.quad2ClipHeight=fixedRowsHeight;if(this.gridBone.commands.queryState("fittowindow")){this.quad2ClipWidth=dataWidth+2;}else{this.quad2ClipWidth=Math.min(this.table.offsetWidth,dataWidth+(mstr.utils.ISIE8?0:2));}}if(this.quadrants[3]){this.quad3ClipHeight=Math.min(this.table.offsetHeight,dataHeight+this.getClipHeightAdjustment(this.quadrants[0]));this.quad3ClipWidth=fixedColsWidth;}window.setTimeout("microstrategy.bone('"+this.gridBone.id+"').lockSet.reclip();",5);};mstrLockSet.prototype.reclip=function(){this.resetScrolling();var maskStyle=null;if(this.quadrants[2]){var left=0,right=this.quad2ClipWidth;if(mstrLockSet.IS_IE||mstrLockSet.MAC_RETINA_CHROME){left+=this.lastScrollLeft;right+=this.lastScrollLeft;this.quadrants[2].style.width=right+1+"px";}this.quadrants[2].style.clip="rect(0px "+right+"px "+this.quad2ClipHeight+"px "+left+"px)";maskStyle=this.backgroundMasks[2].style;maskStyle.top="0px";maskStyle.left=-left+"px";maskStyle.width=right+"px";maskStyle.height=this.quad2ClipHeight+"px";maskStyle.zIndex=3;}if(this.quadrants[3]){var top=0,bottom=this.quad3ClipHeight;if(mstrLockSet.IS_IE||mstrLockSet.MAC_RETINA_CHROME){top+=this.lastScrollTop;bottom+=this.lastScrollTop;this.quadrants[3].style.height=bottom+"px";}this.quadrants[3].style.clip="rect("+top+"px "+this.quad3ClipWidth+"px "+bottom+"px 0px)";maskStyle=this.backgroundMasks[3].style;maskStyle.top=-top+"px";maskStyle.left="0px";maskStyle.width=this.quad3ClipWidth+"px";maskStyle.height=bottom+"px";maskStyle.zIndex=1;}};mstrLockSet.prototype.getScrollAreaHeight=function(div){return Math.min((div.clientHeight+1),parseInt(div.style.height)-(mstr.utils.BoxModel.hasScrollbar(div,"x")?mstrLockSet.getScrollbarSize():0));};mstrLockSet.prototype.getScrollAreaWidth=function(div){var width=div.clientWidth+1;if(!(mstrLockSet.IS_IE||mstrLockSet.MAC_RETINA_CHROME)){width=Math.min(width,parseInt(div.style.width)-(mstr.utils.BoxModel.hasScrollbar(div,"y")?mstrLockSet.getScrollbarSize():0));}return width;};mstrLockSet.prototype.getAvailableGridAreaWidth=function(divEntireTable){var width=mstr.utils.BoxModel.getBrowserWindowWidth(document)-getObjSumLeftScrolled(divEntireTable),fixedColsWidth=this.getFixedColsWidth();if(this.quadrants[3]){if(!bIsIE7){width-=5;}if(width<mstrLockSet.MINIMUM_GRID_WIDTH+fixedColsWidth){width=mstrLockSet.MINIMUM_GRID_WIDTH+fixedColsWidth;}}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){width-=6;if(bIsIE4&&!bIsIE7){width-=7;}if(!bIsIE9){width-=8;}}return width;};mstrLockSet.prototype.getAvailableGridAreaHeight=function(divEntireTable){var bm=mstr.utils.BoxModel,bottom_fetch=microstrategy.findChildWithAtt(document.getElementById("reportViewAllModes"),"DIV",(bIsW3C?"class":"className"),"report-bottom"),height=bm.getBrowserWindowHeight(document)-(bm.getElementSumOffsetTop(divEntireTable,document.body)-getDocumentScrollTop())-getFooterHeight()-bm.getElementOuterHeight(bottom_fetch),fixedRowsHeight=this.getFixedRowsHeight();if(height<mstrLockSet.MINIMUM_GRID_HEIGHT+fixedRowsHeight){height=mstrLockSet.MINIMUM_GRID_HEIGHT+fixedRowsHeight;}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){height-=3;if(!bIsIE9){height-=8;}}return height;};mstrLockSet.prototype.resetScrolling=function(){var q0=this.quadrants[0],q2=this.quadrants[2],q3=this.quadrants[3];if(q3){if(!(mstrLockSet.IS_IE||mstrLockSet.MAC_RETINA_CHROME)){q3.scrollTop=q0.scrollTop;}else{q3.style.top=(0-q0.scrollTop)+"px";this.lastScrollTop=q0.scrollTop;}}if(q2){if(!(mstrLockSet.IS_IE||mstrLockSet.MAC_RETINA_CHROME)){q2.scrollLeft=q0.scrollLeft;}else{q2.style.left=(0-q0.scrollLeft)+"px";this.lastScrollLeft=q0.scrollLeft;}}};mstrLockSet.prototype.getClipHeightAdjustment=function(quadrant4){return mstr.utils.BoxModel.hasScrollbar(quadrant4,"x")?0:mstrLockSet.getScrollbarSize();};mstrLockSet.prototype.getFixedColsWidth=function(){if(this.topLeftMv){return this.topLeftMv.offsetLeft;}var table=this.table,rows=table&&table.rows,len=rows.length;if(len>0&&rows[len-1].getAttribute("o")){return this.table.offsetWidth;}return 0;};mstrLockSet.prototype.getFixedRowsHeight=function(){if(this.topLeftMv){return this.topLeftMv.offsetTop;}var table=this.table,rows=table&&table.rows,len=rows.length,i;for(i=0;i<len;i++){if(rows[i].getAttribute("o")){break;}}i--;if(i>=0){return rows[i].offsetTop+rows[i].offsetHeight;}return 0;};mstrLockSet.prototype.getBackgroundMaskColor=function getBackgroundMaskColor(){if(!getBackgroundMaskColor.v){var p=this.gridBone.elem,css=mstr.utils.CSS,v;while(p){v=css.getStyleValue(p,"backgroundColor");if(v!="rgba(0, 0, 0, 0)"&&v!="transparent"){getBackgroundMaskColor.v=v;return v;}p=p.parentElement;}getBackgroundMaskColor.v="#fff";}return getBackgroundMaskColor.v;};mstrLockSet.getScrollbarSize=function getScrollbarSize(){if(!getScrollbarSize.v){if(mstr.utils.ISWK){getScrollbarSize.v=11;}else{getScrollbarSize.v=SCROLLBAR_SIZE;}}return getScrollbarSize.v;};mstrLockSet.trackScrolling=function(){if(mstrLockSet.IGNORE_SCROLL||!this.lockSet){return ;}mstrLockSet.IGNORE_SCROLL=true;window.clearTimeout(this.lockSet.timer);this.lockSet.reclip();if(!mstrLockSet.MAC_RETINA_CHROME){this.lockSet.timer=window.setTimeout("microstrategy.bone('"+this.lockSet.gridBone.id+"').lockSet.onmouseup()",1000);}else{this.lockSet.timer=window.setTimeout("microstrategy.bone('"+this.lockSet.gridBone.id+"').lockSet.onmouseup()",300);}mstrLockSet.IGNORE_SCROLL=false;};mstrLockSet.trackScrollingRowHeaders=function(){if(mstrLockSet.IGNORE_SCROLL||!this.lockSet||!this.lockSet.quadrants[3]){return ;}mstrLockSet.IGNORE_SCROLL=true;this.lockSet.quadrants[3].scrollLeft=0;var scrollTop=this.lockSet.quadrants[3].scrollTop;this.lockSet.quadrants[0].scrollTop=scrollTop;if(this.lockSet.quadrants[0].scrollTop<scrollTop){this.lockSet.quadrants[3].scrollTop=this.lockSet.quadrants[0].scrollTop;}mstrLockSet.IGNORE_SCROLL=false;};mstrLockSet.trackScrollingColHeaders=function(){if(mstrLockSet.IGNORE_SCROLL||!this.lockSet||!this.lockSet.quadrants[2]){return ;}mstrLockSet.IGNORE_SCROLL=true;this.lockSet.quadrants[2].scrollTop=0;var scrollLeft=this.lockSet.quadrants[2].scrollLeft;if(this.lockSet.quadrants[0]){this.lockSet.quadrants[0].scrollLeft=scrollLeft;}mstrLockSet.IGNORE_SCROLL=false;};mstrLockSet.trackScrollingTopCorner=function(){if(!this.lockSet){return ;}var div=this.lockSet.quadrants[1];if(!div){return ;}div.scrollLeft=0;div.scrollTop=0;};
mstrUserEntityEditorImplScript=true;mstrUserEntityEditorImpl.prototype=new mstrEditorImpl();mstrUserEntityEditorImpl.prototype.initializing=false;mstrUserEntityEditorImpl.prototype.updatedDays=false;mstrUserEntityEditorImpl.prototype.onload=function(tabMgr){try{this.initializing=true;this.initEditor();var pwd=document.getElementById("password");if(pwd){pwd.onclick=new Function("e","var b = microstrategy.bone('"+this.id+"'); return b && b.resetPwd(this);");}this.initSettings();this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.addSettings=function(oCol){try{if(oCol){for(var i=0;i<oCol.length;i++){var oObj=oCol[i];if(oObj.getAttribute(microstrategy.HTMLATTR_CMD_ID)){this.settings.push(oObj);if(oObj.onclick){oObj.onclick();}if(oObj.onchange){oObj.onchange();}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.initSettings=function(){try{this.settings=new Array();var oInputs=this.elem.getElementsByTagName("input");this.addSettings(oInputs);oInputs=this.elem.getElementsByTagName("textarea");this.addSettings(oInputs);}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.updateCheck=function(obj){try{if(obj){switch(obj.getAttribute(microstrategy.HTMLATTR_CMD_ID)){case"chPwd":var oArray=new Array();oArray.push("passwordExpiration");oArray.push("passwordExpirationDays");oArray.push("passwordExpFrequency");var oNeverExp=document.getElementById("passwordAutoExpire0");if(obj.checked&&oNeverExp){oNeverExp.checked=true;}var disable=obj.checked||(oNeverExp&&oNeverExp.checked);for(var i=0;i<oArray.length;i++){this.enableObj(oArray[i],disable);}this.switchCalendarImage(disable);this.enableObj("passwordAutoExpire1",obj.checked);this.enableObj("passwordMustChange",obj.checked);break;case"pwdReq":this.enableObj("passwordNotModifiable",obj.checked);break;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.updateText=function(obj){try{if(obj){switch(obj.getAttribute(microstrategy.HTMLATTR_CMD_ID)){case"nt":case"ldap":case"sso":case"dbId":var enabled=document.getElementById("windowsLogin")&&(document.getElementById("windowsLogin").value.length>0)||document.getElementById("warehouseID")&&(document.getElementById("warehouseID").value.length>0)||document.getElementById("LDAPDN")&&(document.getElementById("LDAPDN").value.length>0)||document.getElementById("SSO")&&(document.getElementById("SSO").value.length>0);this.enableObj("stdAuthDisable",!enabled);case"dbPwd":case"name":case"id":case"pwdExpFreq":if(!this.initializing){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,obj.value);}break;case"pwdExpDays":case"pwdExp":this.updateDate(obj);break;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.updateDate=function(obj){try{if(obj&&!this.initializing){var depObj;var now=new Date();switch(obj.getAttribute(microstrategy.HTMLATTR_CMD_ID)){case"pwdExpDays":if(!/^\d+$/.test(obj.value)){var msg=obj.getAttribute("ERR");showMessage({contents:msg,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});var last=obj.getAttribute("last");if(last){obj.value=last;}}else{obj.value=parseInt(obj.value,10);this.updatedDays=true;var newExp=new Date(now.getTime()+(obj.value*24*60*60*1000)+1);Year=newExp.getFullYear();Month=newExp.getMonth()+1;var dateFormat=obj.getAttribute("format");if(dateFormat){updateDateFormat(dateFormat);}fillTextBox(newExp.getDate(),"passwordExpiration");var depObj=document.getElementById("passwordExpiration");if(depObj){depObj.setAttribute("last",depObj.value);}obj.setAttribute("last",obj.value);}break;case"pwdExp":if(this.updatedDays){this.updatedDays=false;}else{depObj=document.getElementById("passwordExpirationDays");var dateFormat=depObj.getAttribute("format");if(dateFormat){updateDateFormat(dateFormat);}var y=getDateFromFormat(obj.value,sDateFormat,DATE_YEAR);if(y!=0){y=adjustYear(y);}var m=getDateFromFormat(obj.value,sDateFormat,DATE_MONTH)-1;var d=getDateFromFormat(obj.value,sDateFormat,DATE_DAY);var newExp=new Date(y,m,d);var yy=newExp.getYear()%100;yy==(yy<10)?"0"+yy:yy;if((newExp.getDate()!=d)||(obj.value.indexOf(newExp.getDate())<0||obj.value.indexOf(yy)<0)){var msg=obj.getAttribute("ERR");msg=msg.replace("##",obj.value);showMessage({contents:msg,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});var last=obj.getAttribute("last");if(last){obj.value=last;}}else{if(newExp-now<0){var msg=microstrategy.descriptors.getDescriptor("5859");msg=msg.replace("##",obj.value);showMessage({contents:msg,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});var last=obj.getAttribute("last");if(last){obj.value=last;}}else{var count=((newExp.getTime()+1)/1000/60/60/24-now.getTime()/1000/60/60/24);depObj.value=Math.ceil(count);obj.setAttribute("last",obj.value);}}}break;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.updateRadioButton=function(obj){try{if(obj){var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);switch(cmdId){case"pwdNoExp":case"pwdYesExp":var oArray=new Array();oArray.push("passwordExpiration");oArray.push("passwordExpirationDays");oArray.push("passwordExpFrequency");var disabled=(obj.checked&&(cmdId=="pwdNoExp"))||(!obj.checked&&(cmdId=="pwdYesExp"));for(var i=0;i<oArray.length;i++){this.enableObj(oArray[i],disabled);}this.switchCalendarImage(disabled);break;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.applyChanges=function(tabMgr){try{var setting;var evtId;var argId;var argValue;for(var i=0;i<this.settings.length;i++){setting=this.settings[i];evtId=mstrUpdateManager.MODIFY_USER_ENTITY_BASIC;argId=null;argValue=setting.value;switch(setting.getAttribute(microstrategy.HTMLATTR_CMD_ID)){case"name":argId="32768001";break;case"desc":argId="32768002";break;case"id":argId="65536001";break;case"pwd":argId="65536002";break;case"pwdConf":argId="65536012";break;case"chPwd":if(!setting.disabled){argId="65536003";argValue=(setting.checked)?argValue:setting.getAttribute("uncheckvalue");}break;case"pwdReq":if(!setting.disabled){argId="65536004";argValue=(setting.checked)?argValue:setting.getAttribute("uncheckvalue");}break;case"pwdExp":if(!setting.disabled){argId="65536005";}break;case"pwdNoExp":case"pwdYesExp":if(setting.checked){argId="65536014";}break;case"pwdExpDays":if(!setting.disabled){argId="65536013";}break;case"pwdExpFreq":if(!setting.disabled){argId="65536006";}break;case"disable":argId="65536007";argValue=(setting.checked)?argValue:setting.getAttribute("uncheckvalue");break;case"stdDisable":if(!setting.disabled){argId="65536008";argValue=(setting.checked)?argValue:setting.getAttribute("uncheckvalue");}break;case"sso":case"ldap":case"nt":case"dbId":case"dbPwd":evtId=mstrUpdateManager.MODIFY_USER_ENTITY_AUTH;argValue=setting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(argValue!=null){switch(setting.getAttribute(microstrategy.HTMLATTR_CMD_ID)){case"ldap":argId="32768003";break;case"sso":argId="32768010";break;case"nt":argId="65536009";break;case"dbId":argId="65536010";break;case"dbPwd":argId="65536011";break;}}break;}if(argId!=null){tabMgr.getWebEvent(evtId).argNames.push(argId);tabMgr.getWebEvent(evtId).argValues.push(argValue);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.enableObj=function(objId,bDisabled){try{var option=document.getElementById(objId);if(option){option.disabled=bDisabled;if(option.type=="text"){option.className=(bDisabled)?"txtdisabled":"txt";}else{option.className=(bDisabled)?"disabled":"";}var objDep;if((objDep=document.getElementById(option.id+"_label"))){objDep.className=(bDisabled)?"disabledLabel":"";}if((objDep=document.getElementById(option.id+"_btn"))){objDep.disabled=bDisabled;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrUserEntityEditorImpl.prototype.switchCalendarImage=function(bDisabled){var btn=document.getElementById("passwordExpiration_btn");if(btn&&this.disabledCalendarImg&&this.enabledCalendarImg){btn.setAttribute("src",bDisabled?this.disabledCalendarImg:this.enabledCalendarImg);}};mstrUserEntityEditorImpl.prototype.resetPwd=function(pwd){if(!this.initializing){var pwdConf=pwd?document.getElementById("passwordConfirmed"):null;if(pwdConf){pwd.value="";pwdConf.value="";}}};function mstrUserEntityEditorImpl(id){this.inherits=mstrEditorImpl;this.inherits(id);delete this.inherits;return this;}